Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 04:18:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401

 Experiment start at: 2024-08-01 04:31:17.683903
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9865934, 'precision': 0.98659766, 'recall': 0.98659253, 'specificity': 0.98659253, 'f1': 0.98659337, 'auroc': 0.9988631, 'binary_precision': 0.985335, 'binary_recall': 0.98790985, 'binary_specificity': 0.98527515, 'binary_f1_score': 0.9866207}
confusion matrix:
       0      1
0  28237    422
1    347  28354
---- Validation: 
scalar performance:
{'acc': 0.93018305, 'precision': 0.64441514, 'recall': 0.8505964, 'specificity': 0.8505964, 'f1': 0.6956959, 'auroc': 0.9142353, 'binary_precision': 0.29764065, 'binary_recall': 0.7651633, 'binary_specificity': 0.93602955, 'binary_f1_score': 0.4285714}
confusion matrix:
       0     1
0  16988  1161
1    151   492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.942953, 'precision': 0.6960388, 'recall': 0.85663044, 'specificity': 0.85663044, 'f1': 0.7483989, 'auroc': 0.9284227, 'binary_precision': 0.402834, 'binary_recall': 0.7624521, 'binary_specificity': 0.95080876, 'binary_f1_score': 0.52715236}
confusion matrix:
      0    1
0  5702  295
1    62  199
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 04:51:29.305625,epoch time: 0:20:11.621722,used: 0:20:11.621722,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98756975, 'precision': 0.98760533, 'recall': 0.9875735, 'specificity': 0.9875735, 'f1': 0.9875696, 'auroc': 0.99890757, 'binary_precision': 0.9919851, 'binary_recall': 0.9831034, 'binary_specificity': 0.99204355, 'binary_f1_score': 0.9875243}
confusion matrix:
       0      1
0  28428    228
1    485  28219
---- Validation: 
scalar performance:
{'acc': 0.9021924, 'precision': 0.6143943, 'recall': 0.86610746, 'specificity': 0.86610746, 'f1': 0.65682393, 'auroc': 0.9215535, 'binary_precision': 0.23550244, 'binary_recall': 0.8273717, 'binary_specificity': 0.9048433, 'binary_f1_score': 0.3666437}
confusion matrix:
       0     1
0  16422  1727
1    111   532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.817993, 'precision': 0.5796619, 'recall': 0.8317425, 'specificity': 0.8317425, 'f1': 0.5877045, 'auroc': 0.9017561, 'binary_precision': 0.16742425, 'binary_recall': 0.8467433, 'binary_specificity': 0.8167417, 'binary_f1_score': 0.2795699}
confusion matrix:
      0     1
0  4898  1099
1    40   221
early stop counter: 1
val acc:0.9021924138069153, best validation acc: 0.9301830530166626, corresponding to test acc:                         0.9429529905319214 / 0.9429529905319214
after epoch: 2,now: 2024-08-01 05:10:32.275785,epoch time: 0:19:02.970160,used: 0:39:14.591882,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98608786, 'precision': 0.9860883, 'recall': 0.98608756, 'specificity': 0.98608756, 'f1': 0.9860878, 'auroc': 0.99883956, 'binary_precision': 0.98579633, 'binary_recall': 0.9864145, 'binary_specificity': 0.9857606, 'binary_f1_score': 0.98610526}
confusion matrix:
       0      1
0  28245    408
1    390  28317
---- Validation: 
scalar performance:
{'acc': 0.96322906, 'precision': 0.720006, 'recall': 0.70644295, 'specificity': 0.70644295, 'f1': 0.7129823, 'auroc': 0.92716277, 'binary_precision': 0.4601329, 'binary_recall': 0.43079317, 'binary_specificity': 0.9820927, 'binary_f1_score': 0.4449799}
confusion matrix:
       0    1
0  17824  325
1    366  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8663963, 'recall': 0.67382735, 'specificity': 0.67382735, 'f1': 0.73267883, 'auroc': 0.937286, 'binary_precision': 0.76033056, 'binary_recall': 0.35249043, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.4816754}
confusion matrix:
      0   1
0  5968  29
1   169  92
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 05:29:38.108868,epoch time: 0:19:05.833083,used: 0:58:20.424965,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9905335, 'precision': 0.99067473, 'recall': 0.99054104, 'specificity': 0.99054104, 'f1': 0.9905329, 'auroc': 0.9994955, 'binary_precision': 0.99922, 'binary_recall': 0.98184985, 'binary_specificity': 0.99923223, 'binary_f1_score': 0.99045885}
confusion matrix:
       0      1
0  28633     22
1    521  28184
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.76747876, 'recall': 0.7710881, 'specificity': 0.7710881, 'f1': 0.76926994, 'auroc': 0.93253624, 'binary_precision': 0.5506135, 'binary_recall': 0.55832034, 'binary_specificity': 0.98385584, 'binary_f1_score': 0.55444014}
confusion matrix:
       0    1
0  17856  293
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.9225892, 'recall': 0.64659244, 'specificity': 0.64659244, 'f1': 0.7126169, 'auroc': 0.94405603, 'binary_precision': 0.875, 'binary_recall': 0.29501915, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.44126073}
confusion matrix:
      0   1
0  5986  11
1   184  77
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 05:48:46.733644,epoch time: 0:19:08.624776,used: 1:17:29.049741,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9898361, 'precision': 0.98987734, 'recall': 0.9898329, 'specificity': 0.9898329, 'f1': 0.98983586, 'auroc': 0.9993998, 'binary_precision': 0.9855633, 'binary_recall': 0.9942511, 'binary_specificity': 0.9854147, 'binary_f1_score': 0.98988813}
confusion matrix:
       0      1
0  28241    418
1    165  28536
---- Validation: 
scalar performance:
{'acc': 0.9579076, 'precision': 0.71312475, 'recall': 0.8656999, 'specificity': 0.8656999, 'f1': 0.7663886, 'auroc': 0.9443146, 'binary_precision': 0.43474427, 'binary_recall': 0.7667185, 'binary_specificity': 0.96468127, 'binary_f1_score': 0.5548678}
confusion matrix:
       0    1
0  17508  641
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9749121, 'precision': 0.8697961, 'recall': 0.7890181, 'specificity': 0.7890181, 'f1': 0.8239407, 'auroc': 0.95548034, 'binary_precision': 0.7574257, 'binary_recall': 0.5862069, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.6609071}
confusion matrix:
      0    1
0  5948   49
1   108  153
new oracle model saved
early stop counter: 1
val acc:0.9579076170921326, best validation acc: 0.9692954421043396, corresponding to test acc:                         0.9688398838043213 / 0.9749121069908142
after epoch: 5,now: 2024-08-01 06:07:49.328319,epoch time: 0:19:02.594675,used: 1:36:31.644416,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9922246, 'precision': 0.99227214, 'recall': 0.99222887, 'specificity': 0.99222887, 'f1': 0.99222445, 'auroc': 0.99967724, 'binary_precision': 0.9973249, 'binary_recall': 0.98710984, 'binary_specificity': 0.99734783, 'binary_f1_score': 0.9921911}
confusion matrix:
       0      1
0  28580     76
1    370  28334
---- Validation: 
scalar performance:
{'acc': 0.9567369, 'precision': 0.70327616, 'recall': 0.8215906, 'specificity': 0.8215906, 'f1': 0.7471442, 'auroc': 0.9386912, 'binary_precision': 0.41826922, 'binary_recall': 0.67651635, 'binary_specificity': 0.96666485, 'binary_f1_score': 0.51693404}
confusion matrix:
       0    1
0  17544  605
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.82303184, 'recall': 0.85015017, 'specificity': 0.85015017, 'f1': 0.83597696, 'auroc': 0.9580462, 'binary_precision': 0.6584507, 'binary_recall': 0.71647507, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.68623847}
confusion matrix:
      0    1
0  5900   97
1    74  187
early stop counter: 2
val acc:0.9567369222640991, best validation acc: 0.9692954421043396, corresponding to test acc:                         0.9688398838043213 / 0.9749121069908142
after epoch: 6,now: 2024-08-01 06:26:59.098426,epoch time: 0:19:09.770107,used: 1:55:41.414523,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9941597, 'precision': 0.99416363, 'recall': 0.994161, 'specificity': 0.994161, 'f1': 0.9941597, 'auroc': 0.99968785, 'binary_precision': 0.9957707, 'binary_recall': 0.99254435, 'binary_specificity': 0.99577767, 'binary_f1_score': 0.9941549}
confusion matrix:
       0      1
0  28536    121
1    214  28489
---- Validation: 
scalar performance:
{'acc': 0.9641337, 'precision': 0.7382453, 'recall': 0.8704233, 'specificity': 0.8704233, 'f1': 0.78809404, 'auroc': 0.9572443, 'binary_precision': 0.48481882, 'binary_recall': 0.7698289, 'binary_specificity': 0.97101766, 'binary_f1_score': 0.5949519}
confusion matrix:
       0    1
0  17623  526
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.901222, 'recall': 0.7713617, 'specificity': 0.7713617, 'f1': 0.8225689, 'auroc': 0.96635675, 'binary_precision': 0.8218391, 'binary_recall': 0.54789275, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.65747124}
confusion matrix:
      0    1
0  5966   31
1   118  143
new oracle model saved
early stop counter: 3
val acc:0.9641336798667908, best validation acc: 0.9692954421043396, corresponding to test acc:                         0.9688398838043213 / 0.976190447807312
after epoch: 7,now: 2024-08-01 06:46:34.758910,epoch time: 0:19:35.660484,used: 2:15:17.075007,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9922071, 'precision': 0.9923085, 'recall': 0.992213, 'specificity': 0.992213, 'f1': 0.9922068, 'auroc': 0.9997325, 'binary_precision': 0.9995757, 'binary_recall': 0.9848448, 'binary_specificity': 0.9995813, 'binary_f1_score': 0.99215555}
confusion matrix:
       0      1
0  28645     12
1    435  28268
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.78938806, 'recall': 0.6587176, 'specificity': 0.6587176, 'f1': 0.70329565, 'auroc': 0.9514883, 'binary_precision': 0.6023055, 'binary_recall': 0.32503888, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.42222223}
confusion matrix:
       0    1
0  18011  138
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.693649, 'recall': 0.50541365, 'specificity': 0.50541365, 'f1': 0.5004984, 'auroc': 0.95805466, 'binary_precision': 0.42857143, 'binary_recall': 0.011494253, 'binary_specificity': 0.999333, 'binary_f1_score': 0.02238806}
confusion matrix:
      0  1
0  5993  4
1   258  3
better model found
persisted
after epoch: 8,now: 2024-08-01 07:06:05.864335,epoch time: 0:19:31.105425,used: 2:34:48.180432,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99320084, 'precision': 0.9932035, 'recall': 0.993202, 'specificity': 0.993202, 'f1': 0.99320084, 'auroc': 0.9995918, 'binary_precision': 0.994585, 'binary_recall': 0.991813, 'binary_specificity': 0.994591, 'binary_f1_score': 0.9931971}
confusion matrix:
       0      1
0  28501    155
1    235  28469
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.77966195, 'recall': 0.55991554, 'specificity': 0.55991554, 'f1': 0.5932644, 'auroc': 0.94565195, 'binary_precision': 0.5895522, 'binary_recall': 0.12286159, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.20334621}
confusion matrix:
       0   1
0  18094  55
1    564  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.85482705, 'recall': 0.51699126, 'specificity': 0.51699126, 'f1': 0.5225529, 'auroc': 0.9645685, 'binary_precision': 0.75, 'binary_recall': 0.03448276, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.06593406}
confusion matrix:
      0  1
0  5994  3
1   252  9
early stop counter: 1
val acc:0.9670604467391968, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.9581335783004761 / 0.976190447807312
after epoch: 9,now: 2024-08-01 07:25:36.327302,epoch time: 0:19:30.462967,used: 2:54:18.643399,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9922071, 'precision': 0.99226373, 'recall': 0.9922031, 'specificity': 0.9922031, 'f1': 0.9922068, 'auroc': 0.99980944, 'binary_precision': 0.98717195, 'binary_recall': 0.99738693, 'binary_specificity': 0.98701936, 'binary_f1_score': 0.9922532}
confusion matrix:
       0      1
0  28286    372
1     75  28627
---- Validation: 
scalar performance:
{'acc': 0.9441784, 'precision': 0.67421854, 'recall': 0.8668426, 'specificity': 0.8668426, 'f1': 0.73025364, 'auroc': 0.94676715, 'binary_precision': 0.35643566, 'binary_recall': 0.7838258, 'binary_specificity': 0.9498595, 'binary_f1_score': 0.49003407}
confusion matrix:
       0    1
0  17239  910
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8039223, 'recall': 0.6998116, 'specificity': 0.6998116, 'f1': 0.73990124, 'auroc': 0.94948435, 'binary_precision': 0.6331361, 'binary_recall': 0.4099617, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.49767444}
confusion matrix:
      0    1
0  5935   62
1   154  107
early stop counter: 2
val acc:0.9441784024238586, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.9581335783004761 / 0.976190447807312
after epoch: 10,now: 2024-08-01 07:44:58.591867,epoch time: 0:19:22.264565,used: 3:13:40.907964,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9944909, 'precision': 0.99453247, 'recall': 0.99449456, 'specificity': 0.99449456, 'f1': 0.99449086, 'auroc': 0.9998163, 'binary_precision': 0.9992613, 'binary_recall': 0.98972195, 'binary_specificity': 0.9992672, 'binary_f1_score': 0.99446875}
confusion matrix:
       0      1
0  28637     21
1    295  28407
---- Validation: 
scalar performance:
{'acc': 0.9634951, 'precision': 0.7300154, 'recall': 0.792837, 'specificity': 0.792837, 'f1': 0.7571689, 'auroc': 0.9396214, 'binary_precision': 0.47400242, 'binary_recall': 0.6096423, 'binary_specificity': 0.9760317, 'binary_f1_score': 0.5333333}
confusion matrix:
       0    1
0  17714  435
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541387, 'precision': 0.7194575, 'recall': 0.76168835, 'specificity': 0.76168835, 'f1': 0.7384174, 'auroc': 0.9324739, 'binary_precision': 0.45859873, 'binary_recall': 0.55172414, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.5008696}
confusion matrix:
      0    1
0  5827  170
1   117  144
early stop counter: 3
val acc:0.9634950757026672, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.9581335783004761 / 0.976190447807312
after epoch: 11,now: 2024-08-01 08:04:21.770248,epoch time: 0:19:23.178381,used: 3:33:04.086345,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9865934, 'precision': 0.98665464, 'recall': 0.98658925, 'specificity': 0.98658925, 'f1': 0.9865929, 'auroc': 0.9993733, 'binary_precision': 0.9813877, 'binary_recall': 0.99202144, 'binary_specificity': 0.98115706, 'binary_f1_score': 0.98667586}
confusion matrix:
       0      1
0  28118    540
1    229  28473
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.74856323, 'recall': 0.7682656, 'specificity': 0.7682656, 'f1': 0.757995, 'auroc': 0.95021665, 'binary_precision': 0.51293105, 'binary_recall': 0.55520993, 'binary_specificity': 0.9813213, 'binary_f1_score': 0.53323376}
confusion matrix:
       0    1
0  17810  339
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9538191, 'precision': 0.47905296, 'recall': 0.4976655, 'specificity': 0.4976655, 'f1': 0.48818192, 'auroc': 0.9233424, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.995331, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5969  28
1   261   0
early stop counter: 4
val acc:0.966741144657135, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.9581335783004761 / 0.976190447807312
after epoch: 12,now: 2024-08-01 08:23:46.505029,epoch time: 0:19:24.734781,used: 3:52:28.821126,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99558926, 'precision': 0.9955905, 'recall': 0.9955901, 'specificity': 0.9955901, 'f1': 0.99558926, 'auroc': 0.99980664, 'binary_precision': 0.99661374, 'binary_recall': 0.9945652, 'binary_specificity': 0.996615, 'binary_f1_score': 0.9955884}
confusion matrix:
       0      1
0  28559     97
1    156  28548
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75020915, 'recall': 0.8335755, 'specificity': 0.8335755, 'f1': 0.7852099, 'auroc': 0.9594381, 'binary_precision': 0.51152074, 'binary_recall': 0.6905132, 'binary_specificity': 0.97663784, 'binary_f1_score': 0.58769023}
confusion matrix:
       0    1
0  17725  424
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.815505, 'recall': 0.5749608, 'specificity': 0.5749608, 'f1': 0.61472946, 'auroc': 0.95636374, 'binary_precision': 0.6666667, 'binary_recall': 0.1532567, 'binary_specificity': 0.996665, 'binary_f1_score': 0.24922118}
confusion matrix:
      0   1
0  5977  20
1   221  40
early stop counter: 5
val acc:0.9668475985527039, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.9581335783004761 / 0.976190447807312
after epoch: 13,now: 2024-08-01 08:43:12.876174,epoch time: 0:19:26.371145,used: 4:11:55.192271,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9948571, 'precision': 0.9948574, 'recall': 0.9948576, 'specificity': 0.9948576, 'f1': 0.994857, 'auroc': 0.99985665, 'binary_precision': 0.9955348, 'binary_recall': 0.99418217, 'binary_specificity': 0.99553305, 'binary_f1_score': 0.99485797}
confusion matrix:
       0      1
0  28527    128
1    167  28538
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.75268644, 'recall': 0.76856863, 'specificity': 0.76856863, 'f1': 0.76035774, 'auroc': 0.9497805, 'binary_precision': 0.5211679, 'binary_recall': 0.55520993, 'binary_specificity': 0.9819274, 'binary_f1_score': 0.5376505}
confusion matrix:
       0    1
0  17821  328
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.72867846, 'recall': 0.6225163, 'specificity': 0.6225163, 'f1': 0.6574488, 'auroc': 0.9334027, 'binary_precision': 0.4890511, 'binary_recall': 0.256705, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.33668342}
confusion matrix:
      0   1
0  5927  70
1   194  67
early stop counter: 6
val acc:0.9673265218734741, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.9581335783004761 / 0.976190447807312
after epoch: 14,now: 2024-08-01 09:02:33.824926,epoch time: 0:19:20.948752,used: 4:31:16.141023,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9958159, 'precision': 0.9958359, 'recall': 0.9958186, 'specificity': 0.9958186, 'f1': 0.9958159, 'auroc': 0.9998293, 'binary_precision': 0.99919325, 'binary_recall': 0.9924398, 'binary_specificity': 0.9991974, 'binary_f1_score': 0.9958051}
confusion matrix:
       0      1
0  28634     23
1    217  28486
---- Validation: 
scalar performance:
{'acc': 0.9706258, 'precision': 0.7768252, 'recall': 0.786778, 'specificity': 0.786778, 'f1': 0.7817042, 'auroc': 0.9501252, 'binary_precision': 0.5682159, 'binary_recall': 0.58942455, 'binary_specificity': 0.98413134, 'binary_f1_score': 0.578626}
confusion matrix:
       0    1
0  17861  288
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.6977557, 'recall': 0.56321454, 'specificity': 0.56321454, 'f1': 0.5911678, 'auroc': 0.92676413, 'binary_precision': 0.43209878, 'binary_recall': 0.13409962, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.20467836}
confusion matrix:
      0   1
0  5951  46
1   226  35
better model found
persisted
after epoch: 15,now: 2024-08-01 09:21:53.769607,epoch time: 0:19:19.944681,used: 4:50:36.085704,model: dset_te_center0_erm_no_git_version_2024md_08md_01_04_31_17_seed_0_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 4:50:36.085704 at 2024-08-01 09:21:53.769607
persisted model performance metric: 

scalar performance:
{'acc': 0.95653564, 'precision': 0.6977557, 'recall': 0.56321454, 'specificity': 0.56321454, 'f1': 0.5911678, 'auroc': 0.92676413, 'binary_precision': 0.43209878, 'binary_recall': 0.13409962, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.20467836}
confusion matrix:
      0   1
0  5951  46
1   226  35
oracle model performance metric: 

scalar performance:
{'acc': 0.97619045, 'precision': 0.901222, 'recall': 0.7713617, 'specificity': 0.7713617, 'f1': 0.8225689, 'auroc': 0.96635675, 'binary_precision': 0.8218391, 'binary_recall': 0.54789275, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.65747124}
confusion matrix:
      0    1
0  5966   31
1   118  143
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458481 KiB |  13220 MiB | 414146 GiB | 414145 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 408423 GiB | 408423 GiB |
|       from small pool |  41687 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458481 KiB |  13220 MiB | 414146 GiB | 414145 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 408423 GiB | 408423 GiB |
|       from small pool |  41687 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB | 413791 GiB | 413791 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 408082 GiB | 408082 GiB |
|       from small pool |  40679 KiB |     60 MiB |   5709 GiB |   5709 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  14482 MiB |      0 B   |
|       from large pool |  14412 MiB |  14412 MiB |  14412 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 418062 KiB |   1235 MiB | 330158 GiB | 330157 GiB |
|       from large pool | 406502 KiB |   1232 MiB | 324412 GiB | 324412 GiB |
|       from small pool |  11560 KiB |     15 MiB |   5745 GiB |   5745 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8175    |   80797 K  |   80793 K  |
|       from large pool |     187    |    1413    |   37850 K  |   37850 K  |
|       from small pool |    3301    |    7986    |   42946 K  |   42943 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8175    |   80797 K  |   80793 K  |
|       from large pool |     187    |    1413    |   37850 K  |   37850 K  |
|       from small pool |    3301    |    7986    |   42946 K  |   42943 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3639    |   48546 K  |   48546 K  |
|       from large pool |      30    |     604    |   27637 K  |   27637 K  |
|       from small pool |      43    |    3608    |   20909 K  |   20909 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 414146 GiB | 414146 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 408423 GiB | 408423 GiB |
|       from small pool |      0 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 414146 GiB | 414146 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 408423 GiB | 408423 GiB |
|       from small pool |      0 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 413791 GiB | 413791 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 408082 GiB | 408082 GiB |
|       from small pool |      0 KiB |     60 MiB |   5709 GiB |   5709 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14482 MiB |  14482 MiB |  13626 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 330158 GiB | 330158 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 324412 GiB | 324412 GiB |
|       from small pool |      0 KiB |     40 MiB |   5745 GiB |   5745 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |   80797 K  |   80797 K  |
|       from large pool |       2    |    1413    |   37850 K  |   37850 K  |
|       from small pool |       0    |    7986    |   42946 K  |   42946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |   80797 K  |   80797 K  |
|       from large pool |       2    |    1413    |   37850 K  |   37850 K  |
|       from small pool |       0    |    7986    |   42946 K  |   42946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |     637    |     575    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3639    |   48548 K  |   48548 K  |
|       from large pool |       3    |     604    |   27637 K  |   27637 K  |
|       from small pool |       0    |    3608    |   20910 K  |   20910 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 414146 GiB | 414146 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 408423 GiB | 408423 GiB |
|       from small pool |      0 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 414146 GiB | 414146 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 408423 GiB | 408423 GiB |
|       from small pool |      0 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 413791 GiB | 413791 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 408082 GiB | 408082 GiB |
|       from small pool |      0 KiB |     60 MiB |   5709 GiB |   5709 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14482 MiB |  14482 MiB |  13626 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 330158 GiB | 330158 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 324412 GiB | 324412 GiB |
|       from small pool |      0 KiB |     40 MiB |   5745 GiB |   5745 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |   80797 K  |   80797 K  |
|       from large pool |       2    |    1413    |   37850 K  |   37850 K  |
|       from small pool |       0    |    7986    |   42946 K  |   42946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |   80797 K  |   80797 K  |
|       from large pool |       2    |    1413    |   37850 K  |   37850 K  |
|       from small pool |       0    |    7986    |   42946 K  |   42946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |     637    |     575    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3639    |   48548 K  |   48548 K  |
|       from large pool |       3    |     604    |   27637 K  |   27637 K  |
|       from small pool |       0    |    3608    |   20910 K  |   20910 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401

 Experiment start at: 2024-08-01 09:29:40.086009
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9859067, 'precision': 0.9859067, 'recall': 0.98590696, 'specificity': 0.98590696, 'f1': 0.9859067, 'auroc': 0.9984777, 'binary_precision': 0.9862881, 'binary_recall': 0.9855354, 'binary_specificity': 0.98627853, 'binary_f1_score': 0.9859116}
confusion matrix:
       0      1
0  28392    395
1    417  28412
---- Validation: 
scalar performance:
{'acc': 0.91360724, 'precision': 0.63058203, 'recall': 0.8665014, 'specificity': 0.8665014, 'f1': 0.67877483, 'auroc': 0.92581546, 'binary_precision': 0.268591, 'binary_recall': 0.81575036, 'binary_specificity': 0.9172524, 'binary_f1_score': 0.4041222}
confusion matrix:
       0     1
0  16572  1495
1    124   549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92152756, 'precision': 0.6552336, 'recall': 0.8542259, 'specificity': 0.8542259, 'f1': 0.7061846, 'auroc': 0.9358012, 'binary_precision': 0.3206951, 'binary_recall': 0.7807692, 'binary_specificity': 0.92768246, 'binary_f1_score': 0.45464727}
confusion matrix:
      0    1
0  5516  430
1    57  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 09:49:59.532997,epoch time: 0:20:19.446988,used: 0:20:19.446988,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9740003, 'precision': 0.9751458, 'recall': 0.9740174, 'specificity': 0.9740174, 'f1': 0.9739853, 'auroc': 0.9983553, 'binary_precision': 0.99864984, 'binary_recall': 0.9493201, 'binary_specificity': 0.99871475, 'binary_f1_score': 0.97336036}
confusion matrix:
       0      1
0  28751     37
1   1461  27367
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.77649987, 'recall': 0.70012164, 'specificity': 0.70012164, 'f1': 0.7315543, 'auroc': 0.9248049, 'binary_precision': 0.5746888, 'binary_recall': 0.4115899, 'binary_specificity': 0.98865336, 'binary_f1_score': 0.4796537}
confusion matrix:
       0    1
0  17862  205
1    396  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722849, 'precision': 0.9120209, 'recall': 0.70417154, 'specificity': 0.70417154, 'f1': 0.7700509, 'auroc': 0.93302894, 'binary_precision': 0.8492063, 'binary_recall': 0.41153845, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.5544041}
confusion matrix:
      0    1
0  5927   19
1   153  107
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 10:10:09.528728,epoch time: 0:20:09.995731,used: 0:40:29.442719,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9905929, 'precision': 0.9906136, 'recall': 0.9905955, 'specificity': 0.9905955, 'f1': 0.99059284, 'auroc': 0.9991957, 'binary_precision': 0.99399275, 'binary_recall': 0.98716617, 'binary_specificity': 0.9940249, 'binary_f1_score': 0.9905676}
confusion matrix:
       0      1
0  28614    172
1    370  28460
---- Validation: 
scalar performance:
{'acc': 0.89967984, 'precision': 0.6160319, 'recall': 0.8628546, 'specificity': 0.8628546, 'f1': 0.65815556, 'auroc': 0.9309365, 'binary_precision': 0.23930885, 'binary_recall': 0.8231798, 'binary_specificity': 0.9025295, 'binary_f1_score': 0.37081656}
confusion matrix:
       0     1
0  16306  1761
1    119   554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95149857, 'precision': 0.71796834, 'recall': 0.8312479, 'specificity': 0.8312479, 'f1': 0.76087236, 'auroc': 0.9233137, 'binary_precision': 0.44938272, 'binary_recall': 0.7, 'binary_specificity': 0.9624958, 'binary_f1_score': 0.5473684}
confusion matrix:
      0    1
0  5723  223
1    78  182
early stop counter: 1
val acc:0.8996798396110535, best validation acc: 0.9679295420646667, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 3,now: 2024-08-01 10:31:21.907749,epoch time: 0:21:12.379021,used: 1:01:41.821740,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99033254, 'precision': 0.9903344, 'recall': 0.9903333, 'specificity': 0.9903333, 'f1': 0.99033254, 'auroc': 0.9994469, 'binary_precision': 0.99148154, 'binary_recall': 0.98917717, 'binary_specificity': 0.9914895, 'binary_f1_score': 0.990328}
confusion matrix:
       0      1
0  28543    245
1    312  28516
---- Validation: 
scalar performance:
{'acc': 0.9688901, 'precision': 0.7889831, 'recall': 0.6956129, 'specificity': 0.6956129, 'f1': 0.7324097, 'auroc': 0.94998306, 'binary_precision': 0.6, 'binary_recall': 0.4011887, 'binary_specificity': 0.9900371, 'binary_f1_score': 0.48085484}
confusion matrix:
       0    1
0  17887  180
1    403  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.9153929, 'recall': 0.67373866, 'specificity': 0.67373866, 'f1': 0.7409965, 'auroc': 0.9193063, 'binary_precision': 0.8584906, 'binary_recall': 0.35, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.49726772}
confusion matrix:
      0   1
0  5931  15
1   169  91
better model found
persisted
after epoch: 4,now: 2024-08-01 10:53:52.171960,epoch time: 0:22:30.264211,used: 1:24:12.085951,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99199873, 'precision': 0.9920352, 'recall': 0.9920022, 'specificity': 0.9920022, 'f1': 0.9919987, 'auroc': 0.9994215, 'binary_precision': 0.99646497, 'binary_recall': 0.987513, 'binary_specificity': 0.9964914, 'binary_f1_score': 0.9919688}
confusion matrix:
       0      1
0  28685    101
1    360  28470
---- Validation: 
scalar performance:
{'acc': 0.9209178, 'precision': 0.6369673, 'recall': 0.85384166, 'specificity': 0.85384166, 'f1': 0.6863728, 'auroc': 0.9362916, 'binary_precision': 0.28264374, 'binary_recall': 0.781575, 'binary_specificity': 0.92610836, 'binary_f1_score': 0.4151539}
confusion matrix:
       0     1
0  16732  1335
1    147   526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9392523, 'precision': 0.6759378, 'recall': 0.7917553, 'specificity': 0.7917553, 'f1': 0.71652263, 'auroc': 0.9055357, 'binary_precision': 0.36853933, 'binary_recall': 0.63076925, 'binary_specificity': 0.9527413, 'binary_f1_score': 0.46524826}
confusion matrix:
      0    1
0  5665  281
1    96  164
early stop counter: 1
val acc:0.920917809009552, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.9703512787818909 / 0.9722849130630493
after epoch: 5,now: 2024-08-01 11:14:12.404367,epoch time: 0:20:20.232407,used: 1:44:32.318358,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99215496, 'precision': 0.99224985, 'recall': 0.9921599, 'specificity': 0.9921599, 'f1': 0.99215466, 'auroc': 0.99970794, 'binary_precision': 0.999261, 'binary_recall': 0.98504925, 'binary_specificity': 0.99927056, 'binary_f1_score': 0.99210423}
confusion matrix:
       0      1
0  28767     21
1    431  28397
---- Validation: 
scalar performance:
{'acc': 0.95037353, 'precision': 0.6914693, 'recall': 0.83478534, 'specificity': 0.83478534, 'f1': 0.74038243, 'auroc': 0.94702286, 'binary_precision': 0.3940643, 'binary_recall': 0.7102526, 'binary_specificity': 0.9593181, 'binary_f1_score': 0.50689286}
confusion matrix:
       0    1
0  17332  735
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97631323, 'precision': 0.8506284, 'recall': 0.8570707, 'specificity': 0.8570707, 'f1': 0.85381675, 'auroc': 0.96571773, 'binary_precision': 0.71320754, 'binary_recall': 0.72692305, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.71999997}
confusion matrix:
      0    1
0  5870   76
1    71  189
new oracle model saved
early stop counter: 2
val acc:0.9503735303878784, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.9703512787818909 / 0.9763132333755493
after epoch: 6,now: 2024-08-01 11:35:51.767885,epoch time: 0:21:39.363518,used: 2:06:11.681876,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99284923, 'precision': 0.9928516, 'recall': 0.9928485, 'specificity': 0.9928485, 'f1': 0.9928492, 'auroc': 0.99963176, 'binary_precision': 0.991933, 'binary_recall': 0.993791, 'binary_specificity': 0.99190605, 'binary_f1_score': 0.9928611}
confusion matrix:
       0      1
0  28554    233
1    179  28650
---- Validation: 
scalar performance:
{'acc': 0.96003205, 'precision': 0.71933323, 'recall': 0.7718441, 'specificity': 0.7718441, 'f1': 0.74239236, 'auroc': 0.943753, 'binary_precision': 0.45486936, 'binary_recall': 0.5690936, 'binary_specificity': 0.9745946, 'binary_f1_score': 0.5056105}
confusion matrix:
       0    1
0  17608  459
1    290  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.8033823, 'recall': 0.6724663, 'specificity': 0.6724663, 'f1': 0.7179575, 'auroc': 0.9527588, 'binary_precision': 0.63448274, 'binary_recall': 0.35384616, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.45432097}
confusion matrix:
      0   1
0  5893  53
1   168  92
early stop counter: 3
val acc:0.960032045841217, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.9703512787818909 / 0.9763132333755493
after epoch: 7,now: 2024-08-01 11:56:29.984842,epoch time: 0:20:38.216957,used: 2:26:49.898833,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.991426, 'precision': 0.9914379, 'recall': 0.9914243, 'specificity': 0.9914243, 'f1': 0.9914259, 'auroc': 0.9996047, 'binary_precision': 0.98919237, 'binary_recall': 0.9937216, 'binary_specificity': 0.98912704, 'binary_f1_score': 0.9914518}
confusion matrix:
       0      1
0  28474    313
1    181  28648
---- Validation: 
scalar performance:
{'acc': 0.942476, 'precision': 0.68169767, 'recall': 0.8979246, 'specificity': 0.8979246, 'f1': 0.74213845, 'auroc': 0.94976497, 'binary_precision': 0.3692705, 'binary_recall': 0.8499257, 'binary_specificity': 0.9459235, 'binary_f1_score': 0.5148515}
confusion matrix:
       0    1
0  17090  977
1    101  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.78037393, 'recall': 0.8886368, 'specificity': 0.8886368, 'f1': 0.82446617, 'auroc': 0.94737184, 'binary_precision': 0.56948227, 'binary_recall': 0.8038462, 'binary_specificity': 0.97342753, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5788  158
1    51  209
early stop counter: 4
val acc:0.9424759745597839, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.9703512787818909 / 0.9763132333755493
after epoch: 8,now: 2024-08-01 12:16:23.652051,epoch time: 0:19:53.667209,used: 2:46:43.566042,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99411625, 'precision': 0.99412227, 'recall': 0.99411505, 'specificity': 0.99411505, 'f1': 0.9941162, 'auroc': 0.99975276, 'binary_precision': 0.9925657, 'binary_recall': 0.99569875, 'binary_specificity': 0.99253136, 'binary_f1_score': 0.9941297}
confusion matrix:
       0      1
0  28572    215
1    124  28705
---- Validation: 
scalar performance:
{'acc': 0.9479189, 'precision': 0.69019943, 'recall': 0.86999094, 'specificity': 0.86999094, 'f1': 0.7463112, 'auroc': 0.95151436, 'binary_precision': 0.38868478, 'binary_recall': 0.7860327, 'binary_specificity': 0.9539492, 'binary_f1_score': 0.5201573}
confusion matrix:
       0    1
0  17235  832
1    144  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.79587436, 'recall': 0.8753545, 'specificity': 0.8753545, 'f1': 0.83026063, 'auroc': 0.95794666, 'binary_precision': 0.6017964, 'binary_recall': 0.77307695, 'binary_specificity': 0.97763205, 'binary_f1_score': 0.67676765}
confusion matrix:
      0    1
0  5813  133
1    59  201
early stop counter: 5
val acc:0.9479188919067383, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.9703512787818909 / 0.9763132333755493
after epoch: 9,now: 2024-08-01 12:36:48.855741,epoch time: 0:20:25.203690,used: 3:07:08.769732,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9956783, 'precision': 0.9956783, 'recall': 0.99567825, 'specificity': 0.99567825, 'f1': 0.9956783, 'auroc': 0.9998363, 'binary_precision': 0.99562985, 'binary_recall': 0.99573344, 'binary_specificity': 0.99562305, 'binary_f1_score': 0.99568164}
confusion matrix:
       0      1
0  28661    126
1    123  28706
---- Validation: 
scalar performance:
{'acc': 0.93975455, 'precision': 0.67052305, 'recall': 0.8657567, 'specificity': 0.8657567, 'f1': 0.7258892, 'auroc': 0.94342875, 'binary_precision': 0.34940556, 'binary_recall': 0.7860327, 'binary_specificity': 0.9454807, 'binary_f1_score': 0.48376775}
confusion matrix:
       0    1
0  17082  985
1    144  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.8012645, 'recall': 0.9186603, 'specificity': 0.9186603, 'f1': 0.84905046, 'auroc': 0.9617791, 'binary_precision': 0.6086956, 'binary_recall': 0.86153847, 'binary_specificity': 0.97578204, 'binary_f1_score': 0.7133758}
confusion matrix:
      0    1
0  5802  144
1    36  224
early stop counter: 6
val acc:0.9397545456886292, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.9703512787818909 / 0.9763132333755493
after epoch: 10,now: 2024-08-01 12:58:43.854372,epoch time: 0:21:54.998631,used: 3:29:03.768363,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9954006, 'precision': 0.9954108, 'recall': 0.9954023, 'specificity': 0.9954023, 'f1': 0.99540055, 'auroc': 0.99969596, 'binary_precision': 0.99783874, 'binary_recall': 0.99295825, 'binary_specificity': 0.9978463, 'binary_f1_score': 0.99539244}
confusion matrix:
       0      1
0  28726     62
1    203  28625
---- Validation: 
scalar performance:
{'acc': 0.9599253, 'precision': 0.7019054, 'recall': 0.6637834, 'specificity': 0.6637834, 'f1': 0.6805922, 'auroc': 0.9299129, 'binary_precision': 0.4280443, 'binary_recall': 0.3447251, 'binary_specificity': 0.9828417, 'binary_f1_score': 0.381893}
confusion matrix:
       0    1
0  17757  310
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94924265, 'precision': 0.5557111, 'recall': 0.5174429, 'specificity': 0.5174429, 'f1': 0.52235264, 'auroc': 0.91682917, 'binary_precision': 0.15189873, 'binary_recall': 0.046153847, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.07079646}
confusion matrix:
      0   1
0  5879  67
1   248  12
early stop counter: 7
val acc:0.9599252939224243, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.9703512787818909 / 0.9763132333755493
after epoch: 11,now: 2024-08-01 13:21:09.975077,epoch time: 0:22:26.120705,used: 3:51:29.889068,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9958519, 'precision': 0.99586105, 'recall': 0.99585354, 'specificity': 0.99585354, 'f1': 0.9958519, 'auroc': 0.9998662, 'binary_precision': 0.9981878, 'binary_recall': 0.99351346, 'binary_specificity': 0.9981936, 'binary_f1_score': 0.99584514}
confusion matrix:
       0      1
0  28735     52
1    187  28642
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.7403493, 'recall': 0.78877425, 'specificity': 0.78877425, 'f1': 0.76205885, 'auroc': 0.9522186, 'binary_precision': 0.49570552, 'binary_recall': 0.60029715, 'binary_specificity': 0.97725135, 'binary_f1_score': 0.5430107}
confusion matrix:
       0    1
0  17656  411
1    269  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.84016454, 'recall': 0.5529212, 'specificity': 0.5529212, 'f1': 0.58361495, 'auroc': 0.9489191, 'binary_precision': 0.71794873, 'binary_recall': 0.10769231, 'binary_specificity': 0.99815, 'binary_f1_score': 0.18729098}
confusion matrix:
      0   1
0  5935  11
1   232  28
early stop counter: 8
val acc:0.9637140035629272, best validation acc: 0.9688900709152222, corresponding to test acc:                         0.9703512787818909 / 0.9763132333755493
after epoch: 12,now: 2024-08-01 13:43:14.553379,epoch time: 0:22:04.578302,used: 4:13:34.467370,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9931963, 'precision': 0.9932593, 'recall': 0.99320054, 'specificity': 0.99320054, 'f1': 0.9931961, 'auroc': 0.99964124, 'binary_precision': 0.9990173, 'binary_recall': 0.9873738, 'binary_specificity': 0.9990273, 'binary_f1_score': 0.99316144}
confusion matrix:
       0      1
0  28759     28
1    364  28465
---- Validation: 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8195727, 'recall': 0.68147784, 'specificity': 0.68147784, 'f1': 0.72980666, 'auroc': 0.94921064, 'binary_precision': 0.66223407, 'binary_recall': 0.36998513, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.47473785}
confusion matrix:
       0    1
0  17940  127
1    424  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.9480463, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
better model found
persisted
after epoch: 13,now: 2024-08-01 14:06:35.460547,epoch time: 0:23:20.907168,used: 4:36:55.374538,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9959907, 'precision': 0.99599063, 'recall': 0.99599075, 'specificity': 0.99599075, 'f1': 0.9959907, 'auroc': 0.9998701, 'binary_precision': 0.99604523, 'binary_recall': 0.9959416, 'binary_specificity': 0.99603987, 'binary_f1_score': 0.99599344}
confusion matrix:
       0      1
0  28673    114
1    117  28712
---- Validation: 
scalar performance:
{'acc': 0.96136606, 'precision': 0.73141557, 'recall': 0.83476424, 'specificity': 0.83476424, 'f1': 0.7723447, 'auroc': 0.9556254, 'binary_precision': 0.4742684, 'binary_recall': 0.6983655, 'binary_specificity': 0.9711629, 'binary_f1_score': 0.56490386}
confusion matrix:
       0    1
0  17546  521
1    203  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.87866294, 'recall': 0.6007458, 'specificity': 0.6007458, 'f1': 0.652936, 'auroc': 0.9490559, 'binary_precision': 0.7910448, 'binary_recall': 0.20384616, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.32415903}
confusion matrix:
      0   1
0  5932  14
1   207  53
early stop counter: 1
val acc:0.9613660573959351, best validation acc: 0.9705976247787476, corresponding to test acc:                         0.9590718746185303 / 0.9763132333755493
after epoch: 14,now: 2024-08-01 14:29:50.485257,epoch time: 0:23:15.024710,used: 5:00:10.399248,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9942204, 'precision': 0.9942224, 'recall': 0.9942197, 'specificity': 0.9942197, 'f1': 0.9942204, 'auroc': 0.9997507, 'binary_precision': 0.993386, 'binary_recall': 0.9950744, 'binary_specificity': 0.99336505, 'binary_f1_score': 0.9942295}
confusion matrix:
       0      1
0  28596    191
1    142  28687
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.7824633, 'recall': 0.77113104, 'specificity': 0.77113104, 'f1': 0.7766684, 'auroc': 0.95918506, 'binary_precision': 0.5813953, 'binary_recall': 0.5572065, 'binary_specificity': 0.9850556, 'binary_f1_score': 0.569044}
confusion matrix:
       0    1
0  17797  270
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.88729954, 'recall': 0.54949546, 'specificity': 0.54949546, 'f1': 0.5791401, 'auroc': 0.9588809, 'binary_precision': 0.8125, 'binary_recall': 0.1, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.1780822}
confusion matrix:
      0   1
0  5940   6
1   234  26
early stop counter: 2
val acc:0.9696905016899109, best validation acc: 0.9705976247787476, corresponding to test acc:                         0.9590718746185303 / 0.9763132333755493
after epoch: 15,now: 2024-08-01 14:53:09.278951,epoch time: 0:23:18.793694,used: 5:23:29.192942,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_29_39_seed_1_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 5:23:29.192942 at 2024-08-01 14:53:09.278951
persisted model performance metric: 

scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.9480463, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
oracle model performance metric: 

scalar performance:
{'acc': 0.97631323, 'precision': 0.8506284, 'recall': 0.8570707, 'specificity': 0.8570707, 'f1': 0.85381675, 'auroc': 0.96571773, 'binary_precision': 0.71320754, 'binary_recall': 0.72692305, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.71999997}
confusion matrix:
      0    1
0  5870   76
1    71  189
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456826 KiB |  13220 MiB |    815 TiB |    815 TiB |
|       from large pool | 415151 KiB |  13181 MiB |    803 TiB |    803 TiB |
|       from small pool |  41675 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456826 KiB |  13220 MiB |    815 TiB |    815 TiB |
|       from large pool | 415151 KiB |  13181 MiB |    803 TiB |    803 TiB |
|       from small pool |  41675 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |    814 TiB |    814 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    803 TiB |    803 TiB |
|       from small pool |  40676 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14482 MiB |  28098 MiB |  13626 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  28014 MiB |  13608 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466821 KiB |   1235 MiB | 645831 GiB | 645831 GiB |
|       from large pool | 455249 KiB |   1232 MiB | 634283 GiB | 634283 GiB |
|       from small pool |  11572 KiB |     40 MiB |  11547 GiB |  11547 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8207    |  162533 K  |  162530 K  |
|       from large pool |     187    |    1413    |   76270 K  |   76270 K  |
|       from small pool |    3277    |    8018    |   86262 K  |   86259 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8207    |  162533 K  |  162530 K  |
|       from large pool |     187    |    1413    |   76270 K  |   76270 K  |
|       from small pool |    3277    |    8018    |   86262 K  |   86259 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1210    |     575    |
|       from large pool |     602    |     602    |    1168    |     566    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    3660    |   96126 K  |   96126 K  |
|       from large pool |      36    |     605    |   53777 K  |   53777 K  |
|       from small pool |      44    |    3624    |   42349 K  |   42349 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |    815 TiB |    815 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |    815 TiB |    815 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    814 TiB |    814 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14482 MiB |  28098 MiB |  27196 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 645831 GiB | 645831 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 634284 GiB | 634283 GiB |
|       from small pool |      0 KiB |     42 MiB |  11547 GiB |  11547 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76270 K  |   76270 K  |
|       from small pool |       0    |    8018    |   86262 K  |   86262 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76270 K  |   76270 K  |
|       from small pool |       0    |    8018    |   86262 K  |   86262 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    1210    |    1146    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3660    |   96128 K  |   96128 K  |
|       from large pool |       3    |     605    |   53777 K  |   53777 K  |
|       from small pool |       0    |    3624    |   42350 K  |   42350 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |    815 TiB |    815 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |    815 TiB |    815 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    814 TiB |    814 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14482 MiB |  28098 MiB |  27196 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 645831 GiB | 645831 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 634284 GiB | 634283 GiB |
|       from small pool |      0 KiB |     42 MiB |  11547 GiB |  11547 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76270 K  |   76270 K  |
|       from small pool |       0    |    8018    |   86262 K  |   86262 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76270 K  |   76270 K  |
|       from small pool |       0    |    8018    |   86262 K  |   86262 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    1210    |    1146    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3660    |   96128 K  |   96128 K  |
|       from large pool |       3    |     605    |   53777 K  |   53777 K  |
|       from small pool |       0    |    3624    |   42350 K  |   42350 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401

 Experiment start at: 2024-08-01 15:03:43.119996
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98382616, 'precision': 0.98422635, 'recall': 0.98382914, 'specificity': 0.98382914, 'f1': 0.9838229, 'auroc': 0.99881876, 'binary_precision': 0.998199, 'binary_recall': 0.96940804, 'binary_specificity': 0.9982502, 'binary_f1_score': 0.98359287}
confusion matrix:
       0      1
0  29095     51
1    892  28266
---- Validation: 
scalar performance:
{'acc': 0.9587706, 'precision': 0.5695449, 'recall': 0.5306013, 'specificity': 0.5306013, 'f1': 0.5404945, 'auroc': 0.8367386, 'binary_precision': 0.16923077, 'binary_recall': 0.073089704, 'binary_specificity': 0.9881129, 'binary_f1_score': 0.102088176}
confusion matrix:
       0    1
0  17955  216
1    558   44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.6347252, 'recall': 0.528157, 'specificity': 0.528157, 'f1': 0.54083824, 'auroc': 0.87751865, 'binary_precision': 0.30612245, 'binary_recall': 0.06198347, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.10309278}
confusion matrix:
      0   1
0  5963  34
1   227  15
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 15:30:23.069926,epoch time: 0:26:39.949930,used: 0:26:39.949930,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9898806, 'precision': 0.98996043, 'recall': 0.9898815, 'specificity': 0.9898815, 'f1': 0.9898802, 'auroc': 0.99933755, 'binary_precision': 0.99624765, 'binary_recall': 0.98346823, 'binary_specificity': 0.9962948, 'binary_f1_score': 0.9898167}
confusion matrix:
       0      1
0  29040    108
1    482  28674
---- Validation: 
scalar performance:
{'acc': 0.96585524, 'precision': 0.7247016, 'recall': 0.7221743, 'specificity': 0.7221743, 'f1': 0.72343004, 'auroc': 0.91154206, 'binary_precision': 0.4672269, 'binary_recall': 0.46179402, 'binary_specificity': 0.9825546, 'binary_f1_score': 0.4644946}
confusion matrix:
       0    1
0  17854  317
1    324  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709889, 'precision': 0.8140942, 'recall': 0.77275586, 'specificity': 0.77275586, 'f1': 0.7918101, 'auroc': 0.91685116, 'binary_precision': 0.64593303, 'binary_recall': 0.55785125, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.59866965}
confusion matrix:
      0    1
0  5923   74
1   107  135
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 15:51:06.065977,epoch time: 0:20:42.996051,used: 0:47:22.945981,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9918702, 'precision': 0.9919635, 'recall': 0.99187136, 'specificity': 0.99187136, 'f1': 0.9918698, 'auroc': 0.9995849, 'binary_precision': 0.99878275, 'binary_recall': 0.98494357, 'binary_specificity': 0.9987992, 'binary_f1_score': 0.9918149}
confusion matrix:
       0      1
0  29112     35
1    439  28718
---- Validation: 
scalar performance:
{'acc': 0.92867416, 'precision': 0.6268058, 'recall': 0.8121825, 'specificity': 0.8121825, 'f1': 0.67212385, 'auroc': 0.9030448, 'binary_precision': 0.26453674, 'binary_recall': 0.68770766, 'binary_specificity': 0.9366573, 'binary_f1_score': 0.38209507}
confusion matrix:
       0     1
0  17020  1151
1    188   414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.911364, 'precision': 0.616565, 'recall': 0.7794124, 'specificity': 0.7794124, 'f1': 0.65506047, 'auroc': 0.88680774, 'binary_precision': 0.24878837, 'binary_recall': 0.6363636, 'binary_specificity': 0.9224612, 'binary_f1_score': 0.3577236}
confusion matrix:
      0    1
0  5532  465
1    88  154
early stop counter: 1
val acc:0.9286741614341736, best validation acc: 0.9658552408218384, corresponding to test acc:                         0.970988929271698 / 0.970988929271698
after epoch: 3,now: 2024-08-01 16:11:34.939845,epoch time: 0:20:28.873868,used: 1:07:51.819849,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9926077, 'precision': 0.9926603, 'recall': 0.9926084, 'specificity': 0.9926084, 'f1': 0.9926075, 'auroc': 0.99960995, 'binary_precision': 0.9977819, 'binary_recall': 0.9874125, 'binary_specificity': 0.9978043, 'binary_f1_score': 0.99257004}
confusion matrix:
       0      1
0  29084     64
1    367  28789
---- Validation: 
scalar performance:
{'acc': 0.95413625, 'precision': 0.6818505, 'recall': 0.8068652, 'specificity': 0.8068652, 'f1': 0.7259886, 'auroc': 0.92286605, 'binary_precision': 0.3756004, 'binary_recall': 0.6495017, 'binary_specificity': 0.9642287, 'binary_f1_score': 0.47595862}
confusion matrix:
       0    1
0  17521  650
1    211  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.76721525, 'recall': 0.63409424, 'specificity': 0.63409424, 'f1': 0.6762286, 'auroc': 0.9022672, 'binary_precision': 0.56302524, 'binary_recall': 0.2768595, 'binary_specificity': 0.991329, 'binary_f1_score': 0.37119114}
confusion matrix:
      0   1
0  5945  52
1   175  67
early stop counter: 2
val acc:0.9541362524032593, best validation acc: 0.9658552408218384, corresponding to test acc:                         0.970988929271698 / 0.970988929271698
after epoch: 4,now: 2024-08-01 16:33:21.944907,epoch time: 0:21:47.005062,used: 1:29:38.824911,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98761666, 'precision': 0.98765093, 'recall': 0.98761594, 'specificity': 0.98761594, 'f1': 0.9876164, 'auroc': 0.9993588, 'binary_precision': 0.9836049, 'binary_recall': 0.9917687, 'binary_specificity': 0.9834631, 'binary_f1_score': 0.98766994}
confusion matrix:
       0      1
0  28665    482
1    240  28917
---- Validation: 
scalar performance:
{'acc': 0.96399087, 'precision': 0.7242301, 'recall': 0.83042586, 'specificity': 0.83042586, 'f1': 0.765888, 'auroc': 0.94164586, 'binary_precision': 0.45898005, 'binary_recall': 0.68770766, 'binary_specificity': 0.973144, 'binary_f1_score': 0.55053186}
confusion matrix:
       0    1
0  17683  488
1    188  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741946, 'precision': 0.83050525, 'recall': 0.8160609, 'specificity': 0.8160609, 'f1': 0.8231042, 'auroc': 0.9366515, 'binary_precision': 0.6753247, 'binary_recall': 0.6446281, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.6596195}
confusion matrix:
      0    1
0  5922   75
1    86  156
new oracle model saved
early stop counter: 3
val acc:0.9639908671379089, best validation acc: 0.9658552408218384, corresponding to test acc:                         0.970988929271698 / 0.9741945862770081
after epoch: 5,now: 2024-08-01 16:54:13.269646,epoch time: 0:20:51.324739,used: 1:50:30.149650,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9936882, 'precision': 0.99375117, 'recall': 0.9936894, 'specificity': 0.9936894, 'f1': 0.9936881, 'auroc': 0.9997853, 'binary_precision': 0.9993756, 'binary_recall': 0.98799646, 'binary_specificity': 0.99938244, 'binary_f1_score': 0.9936535}
confusion matrix:
       0      1
0  29128     18
1    350  28808
---- Validation: 
scalar performance:
{'acc': 0.9710755, 'precision': 0.77619505, 'recall': 0.6887337, 'specificity': 0.6887337, 'f1': 0.72349083, 'auroc': 0.93186593, 'binary_precision': 0.5724816, 'binary_recall': 0.38704318, 'binary_specificity': 0.9904243, 'binary_f1_score': 0.4618434}
confusion matrix:
       0    1
0  17997  174
1    369  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.8504205, 'recall': 0.66278803, 'specificity': 0.66278803, 'f1': 0.7193558, 'auroc': 0.92690647, 'binary_precision': 0.72727275, 'binary_recall': 0.3305785, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.45454544}
confusion matrix:
      0   1
0  5967  30
1   162  80
better model found
persisted
after epoch: 6,now: 2024-08-01 17:16:22.346901,epoch time: 0:22:09.077255,used: 2:12:39.226905,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9934653, 'precision': 0.9934882, 'recall': 0.9934659, 'specificity': 0.9934659, 'f1': 0.99346524, 'auroc': 0.99970734, 'binary_precision': 0.99689186, 'binary_recall': 0.99001956, 'binary_specificity': 0.9969122, 'binary_f1_score': 0.9934438}
confusion matrix:
       0      1
0  29057     90
1    291  28866
---- Validation: 
scalar performance:
{'acc': 0.9508336, 'precision': 0.6569461, 'recall': 0.7417183, 'specificity': 0.7417183, 'f1': 0.6888609, 'auroc': 0.89532083, 'binary_precision': 0.33015874, 'binary_recall': 0.5182724, 'binary_specificity': 0.96516424, 'binary_f1_score': 0.40336135}
confusion matrix:
       0    1
0  17538  633
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.7785628, 'recall': 0.72060275, 'specificity': 0.72060275, 'f1': 0.74583006, 'auroc': 0.9198244, 'binary_precision': 0.57894737, 'binary_recall': 0.45454547, 'binary_specificity': 0.98666, 'binary_f1_score': 0.5092593}
confusion matrix:
      0    1
0  5917   80
1   132  110
early stop counter: 1
val acc:0.9508336186408997, best validation acc: 0.9710754752159119, corresponding to test acc:                         0.9692258238792419 / 0.9741945862770081
after epoch: 7,now: 2024-08-01 17:36:57.636112,epoch time: 0:20:35.289211,used: 2:33:14.516116,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9854384, 'precision': 0.9854625, 'recall': 0.9854378, 'specificity': 0.9854378, 'f1': 0.9854382, 'auroc': 0.99892855, 'binary_precision': 0.98208445, 'binary_recall': 0.98892206, 'binary_specificity': 0.98195356, 'binary_f1_score': 0.9854914}
confusion matrix:
       0      1
0  28621    526
1    323  28834
---- Validation: 
scalar performance:
{'acc': 0.9337879, 'precision': 0.6478763, 'recall': 0.8758557, 'specificity': 0.8758557, 'f1': 0.70282805, 'auroc': 0.9361716, 'binary_precision': 0.30228254, 'binary_recall': 0.81395346, 'binary_specificity': 0.93775797, 'binary_f1_score': 0.4408457}
confusion matrix:
       0     1
0  17040  1131
1    112   490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.7591087, 'recall': 0.80296075, 'specificity': 0.80296075, 'f1': 0.7790953, 'auroc': 0.91510844, 'binary_precision': 0.53333336, 'binary_recall': 0.6280992, 'binary_specificity': 0.97782224, 'binary_f1_score': 0.5768502}
confusion matrix:
      0    1
0  5864  133
1    90  152
early stop counter: 2
val acc:0.9337878823280334, best validation acc: 0.9710754752159119, corresponding to test acc:                         0.9692258238792419 / 0.9741945862770081
after epoch: 8,now: 2024-08-01 17:58:09.573871,epoch time: 0:21:11.937759,used: 2:54:26.453875,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9944944, 'precision': 0.99453676, 'recall': 0.99449533, 'specificity': 0.99449533, 'f1': 0.99449426, 'auroc': 0.9998468, 'binary_precision': 0.9991691, 'binary_recall': 0.9898141, 'binary_specificity': 0.99917656, 'binary_f1_score': 0.99446964}
confusion matrix:
       0      1
0  29122     24
1    297  28861
---- Validation: 
scalar performance:
{'acc': 0.97267354, 'precision': 0.78989357, 'recall': 0.7208781, 'specificity': 0.7208781, 'f1': 0.75030255, 'auroc': 0.9439037, 'binary_precision': 0.5978022, 'binary_recall': 0.45182723, 'binary_specificity': 0.989929, 'binary_f1_score': 0.5146642}
confusion matrix:
       0    1
0  17988  183
1    330  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730726, 'precision': 0.9121363, 'recall': 0.6846164, 'specificity': 0.6846164, 'f1': 0.7516957, 'auroc': 0.9473759, 'binary_precision': 0.8490566, 'binary_recall': 0.37190083, 'binary_specificity': 0.997332, 'binary_f1_score': 0.51724136}
confusion matrix:
      0   1
0  5981  16
1   152  90
better model found
persisted
after epoch: 9,now: 2024-08-01 18:18:50.423675,epoch time: 0:20:40.849804,used: 3:15:07.303679,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9929679, 'precision': 0.9929773, 'recall': 0.99296826, 'specificity': 0.99296826, 'f1': 0.99296784, 'auroc': 0.9994765, 'binary_precision': 0.9951769, 'binary_recall': 0.99073976, 'binary_specificity': 0.99519676, 'binary_f1_score': 0.9929534}
confusion matrix:
       0      1
0  29007    140
1    270  28887
---- Validation: 
scalar performance:
{'acc': 0.8890428, 'precision': 0.58824545, 'recall': 0.8125895, 'specificity': 0.8125895, 'f1': 0.61838216, 'auroc': 0.8828336, 'binary_precision': 0.18636172, 'binary_recall': 0.730897, 'binary_specificity': 0.8942821, 'binary_f1_score': 0.29699627}
confusion matrix:
       0     1
0  16250  1921
1    162   440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83651227, 'precision': 0.58224326, 'recall': 0.8396133, 'specificity': 0.8396133, 'f1': 0.5967033, 'auroc': 0.9103911, 'binary_precision': 0.17200674, 'binary_recall': 0.8429752, 'binary_specificity': 0.83625144, 'binary_f1_score': 0.28571427}
confusion matrix:
      0    1
0  5015  982
1    38  204
early stop counter: 1
val acc:0.8890427947044373, best validation acc: 0.9726735353469849, corresponding to test acc:                         0.9730725884437561 / 0.9741945862770081
after epoch: 10,now: 2024-08-01 18:39:26.216105,epoch time: 0:20:35.792430,used: 3:35:43.096109,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99559206, 'precision': 0.99562347, 'recall': 0.9955929, 'specificity': 0.9955929, 'f1': 0.995592, 'auroc': 0.99983716, 'binary_precision': 0.99961966, 'binary_recall': 0.9915632, 'binary_specificity': 0.9996226, 'binary_f1_score': 0.9955752}
confusion matrix:
       0      1
0  29135     11
1    246  28912
---- Validation: 
scalar performance:
{'acc': 0.97219414, 'precision': 0.7901486, 'recall': 0.69493294, 'specificity': 0.69493294, 'f1': 0.7323789, 'auroc': 0.93024766, 'binary_precision': 0.6, 'binary_recall': 0.3986711, 'binary_specificity': 0.9911948, 'binary_f1_score': 0.4790419}
confusion matrix:
       0    1
0  18011  160
1    362  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501523, 'precision': 0.60310453, 'recall': 0.5576948, 'specificity': 0.5576948, 'f1': 0.57248527, 'auroc': 0.90728164, 'binary_precision': 0.24060151, 'binary_recall': 0.1322314, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.17066666}
confusion matrix:
      0    1
0  5896  101
1   210   32
early stop counter: 2
val acc:0.9721941351890564, best validation acc: 0.9726735353469849, corresponding to test acc:                         0.9730725884437561 / 0.9741945862770081
after epoch: 11,now: 2024-08-01 18:59:55.187403,epoch time: 0:20:28.971298,used: 3:56:12.067407,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99344814, 'precision': 0.9935294, 'recall': 0.993449, 'specificity': 0.993449, 'f1': 0.99344784, 'auroc': 0.99979043, 'binary_precision': 0.99989575, 'binary_recall': 0.98700094, 'binary_specificity': 0.99989706, 'binary_f1_score': 0.9934065}
confusion matrix:
       0      1
0  29145      3
1    379  28777
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.73277557, 'recall': 0.5946497, 'specificity': 0.5946497, 'f1': 0.63188726, 'auroc': 0.9156326, 'binary_precision': 0.49166667, 'binary_recall': 0.19601329, 'binary_specificity': 0.993286, 'binary_f1_score': 0.28028503}
confusion matrix:
       0    1
0  18049  122
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9559224, 'precision': 0.60863817, 'recall': 0.5309552, 'specificity': 0.5309552, 'f1': 0.54371697, 'auroc': 0.8724601, 'binary_precision': 0.25373134, 'binary_recall': 0.07024793, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.110032365}
confusion matrix:
      0   1
0  5947  50
1   225  17
early stop counter: 3
val acc:0.9677196145057678, best validation acc: 0.9726735353469849, corresponding to test acc:                         0.9730725884437561 / 0.9741945862770081
after epoch: 12,now: 2024-08-01 19:20:31.253802,epoch time: 0:20:36.066399,used: 4:16:48.133806,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99458015, 'precision': 0.9946176, 'recall': 0.99458086, 'specificity': 0.99458086, 'f1': 0.99458003, 'auroc': 0.9997649, 'binary_precision': 0.998962, 'binary_recall': 0.99019104, 'binary_specificity': 0.99897075, 'binary_f1_score': 0.9945572}
confusion matrix:
       0      1
0  29117     30
1    286  28871
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.740437, 'recall': 0.665483, 'specificity': 0.665483, 'f1': 0.69534576, 'auroc': 0.91341734, 'binary_precision': 0.502439, 'binary_recall': 0.34219268, 'binary_specificity': 0.98877335, 'binary_f1_score': 0.40711462}
confusion matrix:
       0    1
0  17967  204
1    396  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94133675, 'precision': 0.5216602, 'recall': 0.5134544, 'specificity': 0.5134544, 'f1': 0.51563025, 'auroc': 0.8753976, 'binary_precision': 0.08108108, 'binary_recall': 0.049586777, 'binary_specificity': 0.977322, 'binary_f1_score': 0.06153846}
confusion matrix:
      0    1
0  5861  136
1   230   12
early stop counter: 4
val acc:0.9680392146110535, best validation acc: 0.9726735353469849, corresponding to test acc:                         0.9730725884437561 / 0.9741945862770081
after epoch: 13,now: 2024-08-01 19:41:24.053386,epoch time: 0:20:52.799584,used: 4:37:40.933390,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9944258, 'precision': 0.9944282, 'recall': 0.99442613, 'specificity': 0.99442613, 'f1': 0.9944258, 'auroc': 0.9997449, 'binary_precision': 0.9956, 'binary_recall': 0.9932442, 'binary_specificity': 0.99560803, 'binary_f1_score': 0.9944207}
confusion matrix:
       0      1
0  29016    128
1    197  28963
---- Validation: 
scalar performance:
{'acc': 0.9743248, 'precision': 0.79464734, 'recall': 0.785172, 'specificity': 0.785172, 'f1': 0.7898249, 'auroc': 0.95412016, 'binary_precision': 0.6030928, 'binary_recall': 0.58305645, 'binary_specificity': 0.98728746, 'binary_f1_score': 0.5929054}
confusion matrix:
       0    1
0  17940  231
1    251  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9778811, 'precision': 0.92848945, 'recall': 0.7485826, 'specificity': 0.7485826, 'f1': 0.8127177, 'auroc': 0.9456028, 'binary_precision': 0.8768116, 'binary_recall': 0.5, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.63684213}
confusion matrix:
      0    1
0  5980   17
1   121  121
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-01 20:02:00.529786,epoch time: 0:20:36.476400,used: 4:58:17.409790,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99337953, 'precision': 0.9934497, 'recall': 0.99338055, 'specificity': 0.99338055, 'f1': 0.9933793, 'auroc': 0.9997215, 'binary_precision': 0.99937516, 'binary_recall': 0.98737866, 'binary_specificity': 0.99938244, 'binary_f1_score': 0.9933407}
confusion matrix:
       0      1
0  29129     18
1    368  28789
---- Validation: 
scalar performance:
{'acc': 0.97283334, 'precision': 0.781806, 'recall': 0.776371, 'specificity': 0.776371, 'f1': 0.7790594, 'auroc': 0.9434979, 'binary_precision': 0.5779661, 'binary_recall': 0.5664452, 'binary_specificity': 0.98629683, 'binary_f1_score': 0.5721476}
confusion matrix:
       0    1
0  17922  249
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9580061, 'precision': 0.66499525, 'recall': 0.55186653, 'specificity': 0.55186653, 'f1': 0.5746718, 'auroc': 0.91475797, 'binary_precision': 0.36486486, 'binary_recall': 0.11157025, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.17088607}
confusion matrix:
      0   1
0  5950  47
1   215  27
early stop counter: 1
val acc:0.9728333353996277, best validation acc: 0.9743248224258423, corresponding to test acc:                         0.9778810739517212 / 0.9778810739517212
after epoch: 15,now: 2024-08-01 20:22:41.020318,epoch time: 0:20:40.490532,used: 5:18:57.900322,model: dset_te_center0_erm_no_git_version_2024md_08md_01_15_03_42_seed_2_23775401
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 5:18:57.900322 at 2024-08-01 20:22:41.020318
persisted model performance metric: 

scalar performance:
{'acc': 0.9778811, 'precision': 0.92848945, 'recall': 0.7485826, 'specificity': 0.7485826, 'f1': 0.8127177, 'auroc': 0.9456028, 'binary_precision': 0.8768116, 'binary_recall': 0.5, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.63684213}
confusion matrix:
      0    1
0  5980   17
1   121  121
oracle model performance metric: 

scalar performance:
{'acc': 0.9778811, 'precision': 0.92848945, 'recall': 0.7485826, 'specificity': 0.7485826, 'f1': 0.8127177, 'auroc': 0.9456028, 'binary_precision': 0.8768116, 'binary_recall': 0.5, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.63684213}
confusion matrix:
      0    1
0  5980   17
1   121  121
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456832 KiB |  13220 MiB |   1243 TiB |   1243 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1226 TiB |   1226 TiB |
|       from small pool |  41681 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456832 KiB |  13220 MiB |   1243 TiB |   1243 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1226 TiB |   1226 TiB |
|       from small pool |  41681 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   1242 TiB |   1242 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1225 TiB |   1225 TiB |
|       from small pool |  40678 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14482 MiB |  41668 MiB |  27196 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  41570 MiB |  27164 MiB |
|       from small pool |     66 MiB |     70 MiB |     98 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466815 KiB |   1235 MiB |    950 TiB |    950 TiB |
|       from large pool | 455249 KiB |   1232 MiB |    933 TiB |    933 TiB |
|       from small pool |  11566 KiB |     42 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8293    |  247056 K  |  247052 K  |
|       from large pool |     187    |    1413    |  116314 K  |  116314 K  |
|       from small pool |    3289    |    8104    |  130741 K  |  130738 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8293    |  247056 K  |  247052 K  |
|       from large pool |     187    |    1413    |  116314 K  |  116314 K  |
|       from small pool |    3289    |    8104    |  130741 K  |  130738 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1781    |    1146    |
|       from large pool |     602    |     602    |    1732    |    1130    |
|       from small pool |      33    |      35    |      49    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |    3703    |  145833 K  |  145833 K  |
|       from large pool |      36    |     605    |   81107 K  |   81107 K  |
|       from small pool |      45    |    3667    |   64725 K  |   64725 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1243 TiB |   1243 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1226 TiB |   1226 TiB |
|       from small pool |      0 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1243 TiB |   1243 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1226 TiB |   1226 TiB |
|       from small pool |      0 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1242 TiB |   1242 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1225 TiB |   1225 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14482 MiB |  41668 MiB |  40766 MiB |
|       from large pool |    850 MiB |  14412 MiB |  41570 MiB |  40720 MiB |
|       from small pool |     52 MiB |     70 MiB |     98 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    950 TiB |    950 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    933 TiB |    933 TiB |
|       from small pool |      0 KiB |     46 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8293    |  247056 K  |  247056 K  |
|       from large pool |       2    |    1413    |  116314 K  |  116314 K  |
|       from small pool |       0    |    8104    |  130741 K  |  130741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8293    |  247056 K  |  247056 K  |
|       from large pool |       2    |    1413    |  116314 K  |  116314 K  |
|       from small pool |       0    |    8104    |  130741 K  |  130741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    1781    |    1717    |
|       from large pool |      38    |     602    |    1732    |    1694    |
|       from small pool |      26    |      35    |      49    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3703    |  145834 K  |  145834 K  |
|       from large pool |       3    |     605    |   81107 K  |   81107 K  |
|       from small pool |       0    |    3667    |   64727 K  |   64727 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 20:24:05 2024]
Finished job 0.
1 of 1 steps (100%) done
