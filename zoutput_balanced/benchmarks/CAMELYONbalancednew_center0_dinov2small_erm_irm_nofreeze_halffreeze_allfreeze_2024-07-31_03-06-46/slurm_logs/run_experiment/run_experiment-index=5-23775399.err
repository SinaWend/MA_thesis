Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 21:08:25 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399

 Experiment start at: 2024-07-31 21:22:18.997171
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9710425, 'precision': 0.9720272, 'recall': 0.9710275, 'specificity': 0.9710275, 'f1': 0.9710268, 'auroc': 0.99850285, 'binary_precision': 0.95063335, 'binary_recall': 0.993728, 'binary_specificity': 0.948327, 'binary_f1_score': 0.9717031}
confusion matrix:
       0      1
0  27180   1481
1    180  28519
---- Validation: 
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8080034, 'precision': 0.5671855, 'recall': 0.84734666, 'specificity': 0.84734666, 'f1': 0.565424, 'auroc': 0.91362333, 'binary_precision': 0.13920662, 'binary_recall': 0.8895801, 'binary_specificity': 0.80511326, 'binary_f1_score': 0.24074073}
confusion matrix:
       0     1
0  14612  3537
1     71   572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8071269, 'precision': 0.5796181, 'recall': 0.84806097, 'specificity': 0.84806097, 'f1': 0.58361274, 'auroc': 0.93094695, 'binary_precision': 0.16501416, 'binary_recall': 0.8927203, 'binary_specificity': 0.8034017, 'binary_f1_score': 0.27854154}
confusion matrix:
      0     1
0  4818  1179
1    28   233
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 21:47:44.714019,epoch time: 0:25:25.716848,used: 0:25:25.716848,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9852336, 'precision': 0.98524773, 'recall': 0.98523563, 'specificity': 0.98523563, 'f1': 0.98523355, 'auroc': 0.9989394, 'binary_precision': 0.98804975, 'binary_recall': 0.98236936, 'binary_specificity': 0.9881019, 'binary_f1_score': 0.98520136}
confusion matrix:
       0      1
0  28319    341
1    506  28194
---- Validation: 
scalar performance:
{'acc': 0.950298, 'precision': 0.6894473, 'recall': 0.86626065, 'specificity': 0.86626065, 'f1': 0.74518275, 'auroc': 0.94022024, 'binary_precision': 0.3871218, 'binary_recall': 0.7760498, 'binary_specificity': 0.95647144, 'binary_f1_score': 0.5165632}
confusion matrix:
       0    1
0  17359  790
1    144  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.8143585, 'recall': 0.8737204, 'specificity': 0.8737204, 'f1': 0.8411469, 'auroc': 0.94194996, 'binary_precision': 0.63897765, 'binary_recall': 0.7662835, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.6968641}
confusion matrix:
      0    1
0  5884  113
1    61  200
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 22:11:51.384930,epoch time: 0:24:06.670911,used: 0:49:32.387759,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9858264, 'precision': 0.9861802, 'recall': 0.9858354, 'specificity': 0.9858354, 'f1': 0.985824, 'auroc': 0.99909806, 'binary_precision': 0.99946266, 'binary_recall': 0.97219414, 'binary_specificity': 0.9994766, 'binary_f1_score': 0.98563987}
confusion matrix:
       0      1
0  28646     15
1    798  27901
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.75753987, 'recall': 0.6372539, 'specificity': 0.6372539, 'f1': 0.6772999, 'auroc': 0.9260594, 'binary_precision': 0.5400593, 'binary_recall': 0.2830482, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.37142858}
confusion matrix:
       0    1
0  17994  155
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.9310043, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
better model found
persisted
after epoch: 3,now: 2024-07-31 22:35:59.713031,epoch time: 0:24:08.328101,used: 1:13:40.715860,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9916667, 'precision': 0.9916743, 'recall': 0.9916686, 'specificity': 0.9916686, 'f1': 0.9916667, 'auroc': 0.9994935, 'binary_precision': 0.99384165, 'binary_recall': 0.9894792, 'binary_specificity': 0.993858, 'binary_f1_score': 0.9916556}
confusion matrix:
       0      1
0  28479    176
1    302  28403
---- Validation: 
scalar performance:
{'acc': 0.960728, 'precision': 0.7188407, 'recall': 0.81690633, 'specificity': 0.81690633, 'f1': 0.7576729, 'auroc': 0.9318625, 'binary_precision': 0.44984162, 'binary_recall': 0.66251945, 'binary_specificity': 0.9712932, 'binary_f1_score': 0.5358491}
confusion matrix:
       0    1
0  17628  521
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97395337, 'precision': 0.8904898, 'recall': 0.74637413, 'specificity': 0.74637413, 'f1': 0.80058914, 'auroc': 0.9450992, 'binary_precision': 0.80246913, 'binary_recall': 0.49808428, 'binary_specificity': 0.994664, 'binary_f1_score': 0.61465716}
confusion matrix:
      0    1
0  5965   32
1   131  130
new oracle model saved
early stop counter: 1
val acc:0.9607279896736145, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9589325785636902 / 0.973953366279602
after epoch: 4,now: 2024-07-31 23:00:14.849833,epoch time: 0:24:15.136802,used: 1:37:55.852662,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9920851, 'precision': 0.99211025, 'recall': 0.99208283, 'specificity': 0.99208283, 'f1': 0.992085, 'auroc': 0.99974215, 'binary_precision': 0.98875237, 'binary_recall': 0.9955051, 'binary_specificity': 0.9886606, 'binary_f1_score': 0.9921172}
confusion matrix:
       0      1
0  28336    325
1    129  28570
---- Validation: 
scalar performance:
{'acc': 0.9382716, 'precision': 0.65689796, 'recall': 0.84128296, 'specificity': 0.84128296, 'f1': 0.70850855, 'auroc': 0.92108023, 'binary_precision': 0.32354948, 'binary_recall': 0.7371695, 'binary_specificity': 0.9453964, 'binary_f1_score': 0.44971535}
confusion matrix:
       0    1
0  17158  991
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94550973, 'precision': 0.6990129, 'recall': 0.83231175, 'specificity': 0.83231175, 'f1': 0.7457539, 'auroc': 0.9423332, 'binary_precision': 0.41111112, 'binary_recall': 0.70881224, 'binary_specificity': 0.95581126, 'binary_f1_score': 0.5203938}
confusion matrix:
      0    1
0  5732  265
1    76  185
early stop counter: 2
val acc:0.9382715821266174, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9589325785636902 / 0.973953366279602
after epoch: 5,now: 2024-07-31 23:24:08.024933,epoch time: 0:23:53.175100,used: 2:01:49.027762,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99320084, 'precision': 0.993201, 'recall': 0.9932014, 'specificity': 0.9932014, 'f1': 0.99320084, 'auroc': 0.9995805, 'binary_precision': 0.9937919, 'binary_recall': 0.9926148, 'binary_specificity': 0.99378794, 'binary_f1_score': 0.993203}
confusion matrix:
       0      1
0  28476    178
1    212  28494
---- Validation: 
scalar performance:
{'acc': 0.96285653, 'precision': 0.7264217, 'recall': 0.79025626, 'specificity': 0.79025626, 'f1': 0.7538847, 'auroc': 0.9279812, 'binary_precision': 0.4669868, 'binary_recall': 0.60497665, 'binary_specificity': 0.97553587, 'binary_f1_score': 0.5271003}
confusion matrix:
       0    1
0  17705  444
1    254  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8390236, 'recall': 0.6241857, 'specificity': 0.6241857, 'f1': 0.67731386, 'auroc': 0.95330584, 'binary_precision': 0.7096774, 'binary_recall': 0.25287357, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.37288135}
confusion matrix:
      0   1
0  5970  27
1   195  66
early stop counter: 3
val acc:0.9628565311431885, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9589325785636902 / 0.973953366279602
after epoch: 6,now: 2024-07-31 23:48:23.662005,epoch time: 0:24:15.637072,used: 2:26:04.664834,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9919456, 'precision': 0.99202096, 'recall': 0.9919505, 'specificity': 0.9919505, 'f1': 0.9919454, 'auroc': 0.9996178, 'binary_precision': 0.99830604, 'binary_recall': 0.9855759, 'binary_specificity': 0.99832505, 'binary_f1_score': 0.99190015}
confusion matrix:
       0      1
0  28610     48
1    414  28288
---- Validation: 
scalar performance:
{'acc': 0.96051514, 'precision': 0.7240518, 'recall': 0.8790507, 'specificity': 0.8790507, 'f1': 0.7788484, 'auroc': 0.95689327, 'binary_precision': 0.45568487, 'binary_recall': 0.79160184, 'binary_specificity': 0.9664995, 'binary_f1_score': 0.57840914}
confusion matrix:
       0    1
0  17541  608
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.86617064, 'recall': 0.8284142, 'specificity': 0.8284142, 'f1': 0.8461545, 'auroc': 0.9360677, 'binary_precision': 0.7467811, 'binary_recall': 0.6666667, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.7044534}
confusion matrix:
      0    1
0  5938   59
1    87  174
new oracle model saved
early stop counter: 4
val acc:0.9605151414871216, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9589325785636902 / 0.9766698479652405
after epoch: 7,now: 2024-08-01 00:12:11.077188,epoch time: 0:23:47.415183,used: 2:49:52.080017,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9927127, 'precision': 0.99275553, 'recall': 0.9927169, 'specificity': 0.9927169, 'f1': 0.99271256, 'auroc': 0.9995094, 'binary_precision': 0.99757254, 'binary_recall': 0.98784184, 'binary_specificity': 0.99759203, 'binary_f1_score': 0.99268335}
confusion matrix:
       0      1
0  28586     69
1    349  28356
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.77533233, 'recall': 0.7111664, 'specificity': 0.7111664, 'f1': 0.7385931, 'auroc': 0.9371221, 'binary_precision': 0.5705522, 'binary_recall': 0.43390357, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.49293286}
confusion matrix:
       0    1
0  17939  210
1    364  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.962146, 'recall': 0.7121434, 'specificity': 0.7121434, 'f1': 0.7872247, 'auroc': 0.9571588, 'binary_precision': 0.94871795, 'binary_recall': 0.42528737, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.5873016}
confusion matrix:
      0    1
0  5991    6
1   150  111
better model found
persisted
after epoch: 8,now: 2024-08-01 00:36:17.253378,epoch time: 0:24:06.176190,used: 3:13:58.256207,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9944212, 'precision': 0.99444246, 'recall': 0.994424, 'specificity': 0.994424, 'f1': 0.9944211, 'auroc': 0.99975073, 'binary_precision': 0.99789494, 'binary_recall': 0.9909417, 'binary_specificity': 0.99790627, 'binary_f1_score': 0.99440616}
confusion matrix:
       0      1
0  28597     60
1    260  28443
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74684393, 'recall': 0.7516542, 'specificity': 0.7516542, 'f1': 0.7492231, 'auroc': 0.95197034, 'binary_precision': 0.5106707, 'binary_recall': 0.5209953, 'binary_specificity': 0.9823131, 'binary_f1_score': 0.51578134}
confusion matrix:
       0    1
0  17828  321
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6459533, 'recall': 0.50349796, 'specificity': 0.50349796, 'f1': 0.4967551, 'auroc': 0.9510573, 'binary_precision': 0.33333334, 'binary_recall': 0.007662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.014981273}
confusion matrix:
      0  1
0  5993  4
1   259  2
early stop counter: 1
val acc:0.9665282964706421, best validation acc: 0.9694550633430481, corresponding to test acc:                         0.975071907043457 / 0.9766698479652405
after epoch: 9,now: 2024-08-01 01:00:17.456715,epoch time: 0:24:00.203337,used: 3:37:58.459544,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99464786, 'precision': 0.9946865, 'recall': 0.99465084, 'specificity': 0.99465084, 'f1': 0.99464774, 'auroc': 0.9997682, 'binary_precision': 0.99922633, 'binary_recall': 0.9900693, 'binary_specificity': 0.9992324, 'binary_f1_score': 0.99462676}
confusion matrix:
       0      1
0  28639     22
1    285  28414
---- Validation: 
scalar performance:
{'acc': 0.97158366, 'precision': 0.7949618, 'recall': 0.7325198, 'specificity': 0.7325198, 'f1': 0.7596882, 'auroc': 0.95594835, 'binary_precision': 0.6083499, 'binary_recall': 0.47589424, 'binary_specificity': 0.9891454, 'binary_f1_score': 0.53403145}
confusion matrix:
       0    1
0  17952  197
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.9687432, 'recall': 0.7313839, 'specificity': 0.7313839, 'f1': 0.8066841, 'auroc': 0.9592849, 'binary_precision': 0.96031743, 'binary_recall': 0.46360153, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.625323}
confusion matrix:
      0    1
0  5992    5
1   140  121
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-01 01:23:51.605506,epoch time: 0:23:34.148791,used: 4:01:32.608335,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9941248, 'precision': 0.9941803, 'recall': 0.99412984, 'specificity': 0.99412984, 'f1': 0.99412465, 'auroc': 0.99982727, 'binary_precision': 0.99964774, 'binary_recall': 0.98860866, 'binary_specificity': 0.999651, 'binary_f1_score': 0.99409753}
confusion matrix:
       0      1
0  28644     10
1    327  28379
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.7831117, 'recall': 0.5933312, 'specificity': 0.5933312, 'f1': 0.6364846, 'auroc': 0.94885683, 'binary_precision': 0.5942029, 'binary_recall': 0.19129083, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.28941175}
confusion matrix:
       0    1
0  18065   84
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547779, 'precision': 0.5768108, 'recall': 0.5109921, 'specificity': 0.5109921, 'f1': 0.5119887, 'auroc': 0.94945306, 'binary_precision': 0.19444445, 'binary_recall': 0.026819924, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.04713805}
confusion matrix:
      0   1
0  5968  29
1   254   7
early stop counter: 1
val acc:0.9678586721420288, best validation acc: 0.9715836644172668, corresponding to test acc:                         0.9768296480178833 / 0.9768296480178833
after epoch: 11,now: 2024-08-01 01:47:38.347774,epoch time: 0:23:46.742268,used: 4:25:19.350603,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99147487, 'precision': 0.9915266, 'recall': 0.99147093, 'specificity': 0.99147093, 'f1': 0.9914746, 'auroc': 0.99972594, 'binary_precision': 0.98668325, 'binary_recall': 0.9964115, 'binary_specificity': 0.98653036, 'binary_f1_score': 0.99152356}
confusion matrix:
       0      1
0  28271    386
1    103  28600
---- Validation: 
scalar performance:
{'acc': 0.8956471, 'precision': 0.6138526, 'recall': 0.891971, 'specificity': 0.891971, 'f1': 0.6555795, 'auroc': 0.9507158, 'binary_precision': 0.23211382, 'binary_recall': 0.88802487, 'binary_specificity': 0.8959171, 'binary_f1_score': 0.36803097}
confusion matrix:
       0     1
0  16260  1889
1     72   571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9354426, 'precision': 0.6879722, 'recall': 0.9095142, 'specificity': 0.9095142, 'f1': 0.74886763, 'auroc': 0.95503247, 'binary_precision': 0.38142622, 'binary_recall': 0.88122606, 'binary_specificity': 0.93780226, 'binary_f1_score': 0.5324074}
confusion matrix:
      0    1
0  5624  373
1    31  230
early stop counter: 2
val acc:0.8956471085548401, best validation acc: 0.9715836644172668, corresponding to test acc:                         0.9768296480178833 / 0.9768296480178833
after epoch: 12,now: 2024-08-01 02:11:15.647571,epoch time: 0:23:37.299797,used: 4:48:56.650400,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9952057, 'precision': 0.99520636, 'recall': 0.99520636, 'specificity': 0.99520636, 'f1': 0.99520564, 'auroc': 0.99977684, 'binary_precision': 0.99602175, 'binary_recall': 0.99439085, 'binary_specificity': 0.9960219, 'binary_f1_score': 0.9952056}
confusion matrix:
       0      1
0  28543    114
1    161  28542
---- Validation: 
scalar performance:
{'acc': 0.9324713, 'precision': 0.65538716, 'recall': 0.8885337, 'specificity': 0.8885337, 'f1': 0.71210617, 'auroc': 0.95197093, 'binary_precision': 0.31674474, 'binary_recall': 0.84136856, 'binary_specificity': 0.9356989, 'binary_f1_score': 0.46022972}
confusion matrix:
       0     1
0  16982  1167
1    102   541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9092362, 'precision': 0.6438996, 'recall': 0.8793496, 'specificity': 0.8793496, 'f1': 0.6941291, 'auroc': 0.93270856, 'binary_precision': 0.29506007, 'binary_recall': 0.8467433, 'binary_specificity': 0.91195595, 'binary_f1_score': 0.43762374}
confusion matrix:
      0    1
0  5469  528
1    40  221
early stop counter: 3
val acc:0.9324712753295898, best validation acc: 0.9715836644172668, corresponding to test acc:                         0.9768296480178833 / 0.9768296480178833
after epoch: 13,now: 2024-08-01 02:34:55.284914,epoch time: 0:23:39.637343,used: 5:12:36.287743,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99522316, 'precision': 0.9952234, 'recall': 0.99522364, 'specificity': 0.99522364, 'f1': 0.99522316, 'auroc': 0.9997766, 'binary_precision': 0.9958143, 'binary_recall': 0.9946347, 'binary_specificity': 0.99581254, 'binary_f1_score': 0.9952242}
confusion matrix:
       0      1
0  28537    120
1    154  28549
---- Validation: 
scalar performance:
{'acc': 0.95274585, 'precision': 0.6754744, 'recall': 0.74901915, 'specificity': 0.74901915, 'f1': 0.7048689, 'auroc': 0.9299214, 'binary_precision': 0.36785328, 'binary_recall': 0.5303266, 'binary_specificity': 0.96771175, 'binary_f1_score': 0.4343949}
confusion matrix:
       0    1
0  17563  586
1    302  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.7728543, 'recall': 0.7758525, 'specificity': 0.7758525, 'f1': 0.7743441, 'auroc': 0.94524914, 'binary_precision': 0.56439394, 'binary_recall': 0.57088125, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.5676191}
confusion matrix:
      0    1
0  5882  115
1   112  149
early stop counter: 4
val acc:0.9527458548545837, best validation acc: 0.9715836644172668, corresponding to test acc:                         0.9768296480178833 / 0.9768296480178833
after epoch: 14,now: 2024-08-01 02:58:07.410759,epoch time: 0:23:12.125845,used: 5:35:48.413588,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99124825, 'precision': 0.99132764, 'recall': 0.9912535, 'specificity': 0.9912535, 'f1': 0.991248, 'auroc': 0.9993047, 'binary_precision': 0.997776, 'binary_recall': 0.98470545, 'binary_specificity': 0.9978016, 'binary_f1_score': 0.9911976}
confusion matrix:
       0      1
0  28594     63
1    439  28264
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7489838, 'recall': 0.7990179, 'specificity': 0.7990179, 'f1': 0.771443, 'auroc': 0.941774, 'binary_precision': 0.5115681, 'binary_recall': 0.61897355, 'binary_specificity': 0.9790622, 'binary_f1_score': 0.5601689}
confusion matrix:
       0    1
0  17769  380
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.90277255, 'recall': 0.73729587, 'specificity': 0.73729587, 'f1': 0.7967061, 'auroc': 0.9222928, 'binary_precision': 0.8278146, 'binary_recall': 0.4789272, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.60679615}
confusion matrix:
      0    1
0  5971   26
1   136  125
early stop counter: 5
val acc:0.966741144657135, best validation acc: 0.9715836644172668, corresponding to test acc:                         0.9768296480178833 / 0.9768296480178833
after epoch: 15,now: 2024-08-01 03:21:42.623872,epoch time: 0:23:35.213113,used: 5:59:23.626701,model: dset_te_center0_erm_no_git_version_2024md_07md_31_21_22_18_seed_0_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 5:59:23.626701 at 2024-08-01 03:21:42.623872
persisted model performance metric: 

scalar performance:
{'acc': 0.97682965, 'precision': 0.9687432, 'recall': 0.7313839, 'specificity': 0.7313839, 'f1': 0.8066841, 'auroc': 0.9592849, 'binary_precision': 0.96031743, 'binary_recall': 0.46360153, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.625323}
confusion matrix:
      0    1
0  5992    5
1   140  121
oracle model performance metric: 

scalar performance:
{'acc': 0.97682965, 'precision': 0.9687432, 'recall': 0.7313839, 'specificity': 0.7313839, 'f1': 0.8066841, 'auroc': 0.9592849, 'binary_precision': 0.96031743, 'binary_recall': 0.46360153, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.625323}
confusion matrix:
      0    1
0  5992    5
1   140  121
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458481 KiB |  13220 MiB | 415962 GiB | 415962 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 410239 GiB | 410238 GiB |
|       from small pool |  41687 KiB |     61 MiB |   5723 GiB |   5723 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458481 KiB |  13220 MiB | 415962 GiB | 415962 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 410239 GiB | 410238 GiB |
|       from small pool |  41687 KiB |     61 MiB |   5723 GiB |   5723 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB | 415564 GiB | 415564 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 409854 GiB | 409854 GiB |
|       from small pool |  40679 KiB |     60 MiB |   5710 GiB |   5710 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14494 MiB |  14494 MiB |  14494 MiB |      0 B   |
|       from large pool |  14422 MiB |  14422 MiB |  14422 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 416014 KiB |   1256 MiB | 332054 GiB | 332053 GiB |
|       from large pool | 406502 KiB |   1252 MiB | 326307 GiB | 326307 GiB |
|       from small pool |   9512 KiB |     15 MiB |   5746 GiB |   5746 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8175    |   80797 K  |   80793 K  |
|       from large pool |     187    |    1413    |   37820 K  |   37820 K  |
|       from small pool |    3301    |    7986    |   42977 K  |   42973 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8175    |   80797 K  |   80793 K  |
|       from large pool |     187    |    1413    |   37820 K  |   37820 K  |
|       from small pool |    3301    |    7986    |   42977 K  |   42973 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3639    |   47622 K  |   47622 K  |
|       from large pool |      30    |     604    |   26743 K  |   26743 K  |
|       from small pool |      42    |    3608    |   20879 K  |   20879 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 415962 GiB | 415962 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 410239 GiB | 410239 GiB |
|       from small pool |      0 KiB |     61 MiB |   5723 GiB |   5723 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 415962 GiB | 415962 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 410239 GiB | 410239 GiB |
|       from small pool |      0 KiB |     61 MiB |   5723 GiB |   5723 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 415564 GiB | 415564 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 409854 GiB | 409854 GiB |
|       from small pool |      0 KiB |     60 MiB |   5710 GiB |   5710 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14494 MiB |  14494 MiB |  13640 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB | 332054 GiB | 332054 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 326308 GiB | 326308 GiB |
|       from small pool |      0 KiB |     36 MiB |   5746 GiB |   5746 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |   80797 K  |   80797 K  |
|       from large pool |       2    |    1413    |   37820 K  |   37820 K  |
|       from small pool |       0    |    7986    |   42977 K  |   42977 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |   80797 K  |   80797 K  |
|       from large pool |       2    |    1413    |   37820 K  |   37820 K  |
|       from small pool |       0    |    7986    |   42977 K  |   42977 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3639    |   47623 K  |   47623 K  |
|       from large pool |       3    |     604    |   26743 K  |   26743 K  |
|       from small pool |       0    |    3608    |   20880 K  |   20880 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 415962 GiB | 415962 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 410239 GiB | 410239 GiB |
|       from small pool |      0 KiB |     61 MiB |   5723 GiB |   5723 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 415962 GiB | 415962 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 410239 GiB | 410239 GiB |
|       from small pool |      0 KiB |     61 MiB |   5723 GiB |   5723 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 415564 GiB | 415564 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 409854 GiB | 409854 GiB |
|       from small pool |      0 KiB |     60 MiB |   5710 GiB |   5710 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14494 MiB |  14494 MiB |  13640 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB | 332054 GiB | 332054 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 326308 GiB | 326308 GiB |
|       from small pool |      0 KiB |     36 MiB |   5746 GiB |   5746 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |   80797 K  |   80797 K  |
|       from large pool |       2    |    1413    |   37820 K  |   37820 K  |
|       from small pool |       0    |    7986    |   42977 K  |   42977 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |   80797 K  |   80797 K  |
|       from large pool |       2    |    1413    |   37820 K  |   37820 K  |
|       from small pool |       0    |    7986    |   42977 K  |   42977 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3639    |   47623 K  |   47623 K  |
|       from large pool |       3    |     604    |   26743 K  |   26743 K  |
|       from small pool |       0    |    3608    |   20880 K  |   20880 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399

 Experiment start at: 2024-08-01 03:33:41.131807
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9830082, 'precision': 0.98346066, 'recall': 0.9830189, 'specificity': 0.9830189, 'f1': 0.98300445, 'auroc': 0.9990331, 'binary_precision': 0.998425, 'binary_recall': 0.96756625, 'binary_specificity': 0.99847156, 'binary_f1_score': 0.98275346}
confusion matrix:
       0      1
0  28744     44
1    935  27893
---- Validation: 
scalar performance:
{'acc': 0.96136606, 'precision': 0.7057055, 'recall': 0.62805194, 'specificity': 0.62805194, 'f1': 0.6567199, 'auroc': 0.9091676, 'binary_precision': 0.43825665, 'binary_recall': 0.268945, 'binary_specificity': 0.9871589, 'binary_f1_score': 0.3333333}
confusion matrix:
       0    1
0  17835  232
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7602008, 'recall': 0.64094025, 'specificity': 0.64094025, 'f1': 0.68071675, 'auroc': 0.92239213, 'binary_precision': 0.5507246, 'binary_recall': 0.2923077, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.38190952}
confusion matrix:
      0   1
0  5884  62
1   184  76
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 03:58:13.604184,epoch time: 0:24:32.472377,used: 0:24:32.472377,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9883539, 'precision': 0.98837864, 'recall': 0.98835146, 'specificity': 0.98835146, 'f1': 0.9883537, 'auroc': 0.99926007, 'binary_precision': 0.9850813, 'binary_recall': 0.9917444, 'binary_specificity': 0.98495847, 'binary_f1_score': 0.9884016}
confusion matrix:
       0      1
0  28354    433
1    238  28591
---- Validation: 
scalar performance:
{'acc': 0.9223052, 'precision': 0.635112, 'recall': 0.8359643, 'specificity': 0.8359643, 'f1': 0.6827973, 'auroc': 0.9147459, 'binary_precision': 0.28042623, 'binary_recall': 0.74294204, 'binary_specificity': 0.92898655, 'binary_f1_score': 0.40716612}
confusion matrix:
       0     1
0  16784  1283
1    173   500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7508068, 'recall': 0.8520874, 'specificity': 0.8520874, 'f1': 0.791604, 'auroc': 0.93850815, 'binary_precision': 0.51344085, 'binary_recall': 0.7346154, 'binary_specificity': 0.9695594, 'binary_f1_score': 0.60443044}
confusion matrix:
      0    1
0  5765  181
1    69  191
early stop counter: 1
val acc:0.9223052263259888, best validation acc: 0.9613660573959351, corresponding to test acc:                         0.9603609442710876 / 0.9603609442710876
after epoch: 2,now: 2024-08-01 04:20:11.059115,epoch time: 0:21:57.454931,used: 0:46:29.927308,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98092544, 'precision': 0.9814326, 'recall': 0.98091376, 'specificity': 0.98091376, 'f1': 0.9809201, 'auroc': 0.99937, 'binary_precision': 0.96598774, 'binary_recall': 0.9969822, 'binary_specificity': 0.96484524, 'binary_f1_score': 0.9812403}
confusion matrix:
       0      1
0  27775   1012
1     87  28742
---- Validation: 
scalar performance:
{'acc': 0.8940235, 'precision': 0.6156408, 'recall': 0.88495547, 'specificity': 0.88495547, 'f1': 0.6572198, 'auroc': 0.94087064, 'binary_precision': 0.23645122, 'binary_recall': 0.8751857, 'binary_specificity': 0.8947252, 'binary_f1_score': 0.37231353}
confusion matrix:
       0     1
0  16165  1902
1     84   589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8300032, 'precision': 0.5854047, 'recall': 0.83956444, 'specificity': 0.83956444, 'f1': 0.59930056, 'auroc': 0.92605114, 'binary_precision': 0.17865804, 'binary_recall': 0.85, 'binary_specificity': 0.8291288, 'binary_f1_score': 0.29525718}
confusion matrix:
      0     1
0  4930  1016
1    39   221
early stop counter: 2
val acc:0.8940234780311584, best validation acc: 0.9613660573959351, corresponding to test acc:                         0.9603609442710876 / 0.9603609442710876
after epoch: 3,now: 2024-08-01 04:41:39.115325,epoch time: 0:21:28.056210,used: 1:07:57.983518,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9928839, 'precision': 0.99290466, 'recall': 0.99288654, 'specificity': 0.99288654, 'f1': 0.9928838, 'auroc': 0.99963856, 'binary_precision': 0.99629784, 'binary_recall': 0.9894554, 'binary_specificity': 0.9963176, 'binary_f1_score': 0.9928648}
confusion matrix:
       0      1
0  28680    106
1    304  28526
---- Validation: 
scalar performance:
{'acc': 0.9431697, 'precision': 0.6722351, 'recall': 0.83391035, 'specificity': 0.83391035, 'f1': 0.7225347, 'auroc': 0.93785214, 'binary_precision': 0.35545722, 'binary_recall': 0.7161961, 'binary_specificity': 0.9516245, 'binary_f1_score': 0.47511086}
confusion matrix:
       0    1
0  17193  874
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.75382125, 'recall': 0.7936603, 'specificity': 0.7936603, 'f1': 0.7720772, 'auroc': 0.94221973, 'binary_precision': 0.5247525, 'binary_recall': 0.61153847, 'binary_specificity': 0.97578204, 'binary_f1_score': 0.56483126}
confusion matrix:
      0    1
0  5802  144
1   101  159
new oracle model saved
early stop counter: 3
val acc:0.9431697130203247, best validation acc: 0.9613660573959351, corresponding to test acc:                         0.9603609442710876 / 0.9605220556259155
after epoch: 4,now: 2024-08-01 05:03:50.981629,epoch time: 0:22:11.866304,used: 1:30:09.849822,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9896557, 'precision': 0.98984987, 'recall': 0.989663, 'specificity': 0.989663, 'f1': 0.9896548, 'auroc': 0.99953496, 'binary_precision': 0.99978757, 'binary_recall': 0.9795345, 'binary_specificity': 0.99979156, 'binary_f1_score': 0.98955745}
confusion matrix:
       0      1
0  28781      6
1    590  28239
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.79814374, 'recall': 0.5661133, 'specificity': 0.5661133, 'f1': 0.6025731, 'auroc': 0.9465803, 'binary_precision': 0.6275862, 'binary_recall': 0.13521545, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.22249387}
confusion matrix:
       0   1
0  18013  54
1    582  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.5416062, 'recall': 0.5013344, 'specificity': 0.5013344, 'f1': 0.49277943, 'auroc': 0.9304426, 'binary_precision': 0.125, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0074626864}
confusion matrix:
      0  1
0  5939  7
1   259  1
better model found
persisted
after epoch: 5,now: 2024-08-01 05:26:04.640547,epoch time: 0:22:13.658918,used: 1:52:23.508740,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98726046, 'precision': 0.9875267, 'recall': 0.9872695, 'specificity': 0.9872695, 'f1': 0.9872589, 'auroc': 0.9990649, 'binary_precision': 0.9991118, 'binary_recall': 0.97540754, 'binary_specificity': 0.9991315, 'binary_f1_score': 0.98711735}
confusion matrix:
       0      1
0  28761     25
1    709  28121
---- Validation: 
scalar performance:
{'acc': 0.9693703, 'precision': 0.7929376, 'recall': 0.7030146, 'specificity': 0.7030146, 'f1': 0.73901725, 'auroc': 0.9254786, 'binary_precision': 0.60737526, 'binary_recall': 0.41604754, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.49382713}
confusion matrix:
       0    1
0  17886  181
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8281784, 'recall': 0.5471519, 'specificity': 0.5471519, 'f1': 0.57430756, 'auroc': 0.91701883, 'binary_precision': 0.6944444, 'binary_recall': 0.09615385, 'binary_specificity': 0.99815, 'binary_f1_score': 0.16891892}
confusion matrix:
      0   1
0  5935  11
1   235  25
better model found
persisted
after epoch: 6,now: 2024-08-01 05:48:11.428575,epoch time: 0:22:06.788028,used: 2:14:30.296768,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9892044, 'precision': 0.98940253, 'recall': 0.98921186, 'specificity': 0.98921186, 'f1': 0.98920345, 'auroc': 0.9994271, 'binary_precision': 0.9994334, 'binary_recall': 0.9789795, 'binary_specificity': 0.9994442, 'binary_f1_score': 0.98910075}
confusion matrix:
       0      1
0  28771     16
1    606  28223
---- Validation: 
scalar performance:
{'acc': 0.9624333, 'precision': 0.68671805, 'recall': 0.54706496, 'specificity': 0.54706496, 'f1': 0.5703458, 'auroc': 0.92907894, 'binary_precision': 0.4060606, 'binary_recall': 0.09955423, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.15990454}
confusion matrix:
       0   1
0  17969  98
1    606  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.53031224, 'recall': 0.5059154, 'specificity': 0.5059154, 'f1': 0.5038289, 'auroc': 0.913013, 'binary_precision': 0.10204082, 'binary_recall': 0.01923077, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.03236246}
confusion matrix:
      0   1
0  5902  44
1   255   5
early stop counter: 1
val acc:0.9624332785606384, best validation acc: 0.9693703055381775, corresponding to test acc:                         0.9603609442710876 / 0.9605220556259155
after epoch: 7,now: 2024-08-01 06:10:08.270719,epoch time: 0:21:56.842144,used: 2:36:27.138912,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98795474, 'precision': 0.98808837, 'recall': 0.98794854, 'specificity': 0.98794854, 'f1': 0.9879538, 'auroc': 0.9995061, 'binary_precision': 0.9802021, 'binary_recall': 0.99604577, 'binary_specificity': 0.9798513, 'binary_f1_score': 0.9880604}
confusion matrix:
       0      1
0  28206    580
1    114  28716
---- Validation: 
scalar performance:
{'acc': 0.95133406, 'precision': 0.6984961, 'recall': 0.86246365, 'specificity': 0.86246365, 'f1': 0.7526001, 'auroc': 0.9479919, 'binary_precision': 0.40597954, 'binary_recall': 0.7667162, 'binary_specificity': 0.9582111, 'binary_f1_score': 0.5308642}
confusion matrix:
       0    1
0  17312  755
1    157  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.76596045, 'recall': 0.7873975, 'specificity': 0.7873975, 'f1': 0.7762053, 'auroc': 0.94681364, 'binary_precision': 0.54964536, 'binary_recall': 0.59615386, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.57195574}
confusion matrix:
      0    1
0  5819  127
1   105  155
new oracle model saved
early stop counter: 2
val acc:0.9513340592384338, best validation acc: 0.9693703055381775, corresponding to test acc:                         0.9603609442710876 / 0.9626168012619019
after epoch: 8,now: 2024-08-01 06:32:03.566912,epoch time: 0:21:55.296193,used: 2:58:22.435105,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9901937, 'precision': 0.99021524, 'recall': 0.9901914, 'specificity': 0.9901914, 'f1': 0.9901936, 'auroc': 0.9995795, 'binary_precision': 0.9871424, 'binary_recall': 0.99334, 'binary_specificity': 0.9870428, 'binary_f1_score': 0.9902316}
confusion matrix:
       0      1
0  28414    373
1    192  28637
---- Validation: 
scalar performance:
{'acc': 0.9528815, 'precision': 0.70362604, 'recall': 0.86612725, 'specificity': 0.86612725, 'f1': 0.7579942, 'auroc': 0.9534786, 'binary_precision': 0.416, 'binary_recall': 0.7726597, 'binary_specificity': 0.95959485, 'binary_f1_score': 0.5408217}
confusion matrix:
       0    1
0  17337  730
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7470045, 'recall': 0.84063303, 'specificity': 0.84063303, 'f1': 0.785183, 'auroc': 0.94454706, 'binary_precision': 0.5068493, 'binary_recall': 0.71153843, 'binary_specificity': 0.9697276, 'binary_f1_score': 0.592}
confusion matrix:
      0    1
0  5766  180
1    75  185
early stop counter: 3
val acc:0.9528815150260925, best validation acc: 0.9693703055381775, corresponding to test acc:                         0.9603609442710876 / 0.9626168012619019
after epoch: 9,now: 2024-08-01 06:54:02.933598,epoch time: 0:21:59.366686,used: 3:20:21.801791,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99369967, 'precision': 0.9937534, 'recall': 0.9937036, 'specificity': 0.9937036, 'f1': 0.99369955, 'auroc': 0.999774, 'binary_precision': 0.9990883, 'binary_recall': 0.9883104, 'binary_specificity': 0.9990968, 'binary_f1_score': 0.99367017}
confusion matrix:
       0      1
0  28761     26
1    337  28492
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.767923, 'recall': 0.7126643, 'specificity': 0.7126643, 'f1': 0.7367714, 'auroc': 0.95315766, 'binary_precision': 0.5566038, 'binary_recall': 0.4383358, 'binary_specificity': 0.98699284, 'binary_f1_score': 0.49044058}
confusion matrix:
       0    1
0  17832  235
1    378  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7660215, 'recall': 0.5613593, 'specificity': 0.5613593, 'f1': 0.5933552, 'auroc': 0.94149375, 'binary_precision': 0.5689655, 'binary_recall': 0.12692308, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.20754719}
confusion matrix:
      0   1
0  5921  25
1   227  33
early stop counter: 4
val acc:0.9672892093658447, best validation acc: 0.9693703055381775, corresponding to test acc:                         0.9603609442710876 / 0.9626168012619019
after epoch: 10,now: 2024-08-01 07:15:54.272614,epoch time: 0:21:51.339016,used: 3:42:13.140807,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9923632, 'precision': 0.9923632, 'recall': 0.9923632, 'specificity': 0.9923632, 'f1': 0.9923632, 'auroc': 0.99949294, 'binary_precision': 0.99236906, 'binary_recall': 0.99236906, 'binary_specificity': 0.9923574, 'binary_f1_score': 0.99236906}
confusion matrix:
       0      1
0  28566    220
1    220  28610
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7548591, 'recall': 0.84008837, 'specificity': 0.84008837, 'f1': 0.7905867, 'auroc': 0.9489161, 'binary_precision': 0.52087915, 'binary_recall': 0.70430905, 'binary_specificity': 0.9758676, 'binary_f1_score': 0.5988629}
confusion matrix:
       0    1
0  17631  436
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.81571734, 'recall': 0.8284658, 'specificity': 0.8284658, 'f1': 0.8219496, 'auroc': 0.9419749, 'binary_precision': 0.6457565, 'binary_recall': 0.6730769, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.65913373}
confusion matrix:
      0    1
0  5850   96
1    85  175
new oracle model saved
early stop counter: 5
val acc:0.9661152362823486, best validation acc: 0.9693703055381775, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 11,now: 2024-08-01 07:37:21.292876,epoch time: 0:21:27.020262,used: 4:03:40.161069,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.994689, 'precision': 0.99472475, 'recall': 0.9946923, 'specificity': 0.9946923, 'f1': 0.99468887, 'auroc': 0.99974257, 'binary_precision': 0.99912506, 'binary_recall': 0.9902532, 'binary_specificity': 0.9991315, 'binary_f1_score': 0.9946694}
confusion matrix:
       0      1
0  28761     25
1    281  28549
---- Validation: 
scalar performance:
{'acc': 0.96798295, 'precision': 0.7670465, 'recall': 0.7967104, 'specificity': 0.7967104, 'f1': 0.7810054, 'auroc': 0.96097416, 'binary_precision': 0.54860187, 'binary_recall': 0.6121842, 'binary_specificity': 0.9812365, 'binary_f1_score': 0.57865167}
confusion matrix:
       0    1
0  17728  339
1    261  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.7937864, 'recall': 0.61603534, 'specificity': 0.61603534, 'f1': 0.66243136, 'auroc': 0.95439124, 'binary_precision': 0.62, 'binary_recall': 0.23846154, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.34444445}
confusion matrix:
      0   1
0  5908  38
1   198  62
early stop counter: 6
val acc:0.9679829478263855, best validation acc: 0.9693703055381775, corresponding to test acc:                         0.9603609442710876 / 0.9708346724510193
after epoch: 12,now: 2024-08-01 07:58:59.735217,epoch time: 0:21:38.442341,used: 4:25:18.603410,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99406415, 'precision': 0.99412245, 'recall': 0.99406844, 'specificity': 0.99406844, 'f1': 0.994064, 'auroc': 0.99984956, 'binary_precision': 0.9996843, 'binary_recall': 0.9884495, 'binary_specificity': 0.9996874, 'binary_f1_score': 0.9940351}
confusion matrix:
       0      1
0  28777      9
1    333  28497
---- Validation: 
scalar performance:
{'acc': 0.9709178, 'precision': 0.82407284, 'recall': 0.6830745, 'specificity': 0.6830745, 'f1': 0.732253, 'auroc': 0.9550042, 'binary_precision': 0.67112297, 'binary_recall': 0.3729569, 'binary_specificity': 0.993192, 'binary_f1_score': 0.4794651}
confusion matrix:
       0    1
0  17944  123
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.64607227, 'recall': 0.50877446, 'specificity': 0.50877446, 'f1': 0.5072648, 'auroc': 0.9270283, 'binary_precision': 0.33333334, 'binary_recall': 0.01923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.036363635}
confusion matrix:
      0   1
0  5936  10
1   255   5
better model found
persisted
after epoch: 13,now: 2024-08-01 08:20:10.530808,epoch time: 0:21:10.795591,used: 4:46:29.399001,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9947758, 'precision': 0.99481034, 'recall': 0.99477875, 'specificity': 0.99477875, 'f1': 0.99477565, 'auroc': 0.9997816, 'binary_precision': 0.9991252, 'binary_recall': 0.990426, 'binary_specificity': 0.99913156, 'binary_f1_score': 0.9947566}
confusion matrix:
       0      1
0  28763     25
1    276  28552
---- Validation: 
scalar performance:
{'acc': 0.9708645, 'precision': 0.7978999, 'recall': 0.7481361, 'specificity': 0.7481361, 'f1': 0.7705177, 'auroc': 0.955055, 'binary_precision': 0.6140036, 'binary_recall': 0.50817233, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.55609757}
confusion matrix:
       0    1
0  17852  215
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.8428304, 'recall': 0.6247367, 'specificity': 0.6247367, 'f1': 0.67837894, 'auroc': 0.96025103, 'binary_precision': 0.7173913, 'binary_recall': 0.25384617, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.375}
confusion matrix:
      0   1
0  5920  26
1   194  66
early stop counter: 1
val acc:0.970864474773407, best validation acc: 0.970917820930481, corresponding to test acc:                         0.9572994112968445 / 0.9708346724510193
after epoch: 14,now: 2024-08-01 08:41:03.639072,epoch time: 0:20:53.108264,used: 5:07:22.507265,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9917384, 'precision': 0.99184704, 'recall': 0.9917437, 'specificity': 0.9917437, 'f1': 0.991738, 'auroc': 0.9996824, 'binary_precision': 0.99933076, 'binary_recall': 0.98414737, 'binary_specificity': 0.99934, 'binary_f1_score': 0.991681}
confusion matrix:
       0      1
0  28769     19
1    457  28371
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7535675, 'recall': 0.724049, 'specificity': 0.724049, 'f1': 0.7377904, 'auroc': 0.95053494, 'binary_precision': 0.527027, 'binary_recall': 0.46359584, 'binary_specificity': 0.98450214, 'binary_f1_score': 0.49328062}
confusion matrix:
       0    1
0  17787  280
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9502095, 'precision': 0.6662209, 'recall': 0.6172527, 'specificity': 0.6172527, 'f1': 0.6367537, 'auroc': 0.9077078, 'binary_precision': 0.3646409, 'binary_recall': 0.25384617, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.29931974}
confusion matrix:
      0    1
0  5831  115
1   194   66
early stop counter: 2
val acc:0.96579509973526, best validation acc: 0.970917820930481, corresponding to test acc:                         0.9572994112968445 / 0.9708346724510193
after epoch: 15,now: 2024-08-01 09:01:33.431869,epoch time: 0:20:29.792797,used: 5:27:52.300062,model: dset_te_center0_erm_no_git_version_2024md_08md_01_03_33_40_seed_1_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 5:27:52.300062 at 2024-08-01 09:01:33.431869
persisted model performance metric: 

scalar performance:
{'acc': 0.9572994, 'precision': 0.64607227, 'recall': 0.50877446, 'specificity': 0.50877446, 'f1': 0.5072648, 'auroc': 0.9270283, 'binary_precision': 0.33333334, 'binary_recall': 0.01923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.036363635}
confusion matrix:
      0   1
0  5936  10
1   255   5
oracle model performance metric: 

scalar performance:
{'acc': 0.9708347, 'precision': 0.81571734, 'recall': 0.8284658, 'specificity': 0.8284658, 'f1': 0.8219496, 'auroc': 0.9419749, 'binary_precision': 0.6457565, 'binary_recall': 0.6730769, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.65913373}
confusion matrix:
      0    1
0  5850   96
1    85  175
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456559 KiB |  13220 MiB |    818 TiB |    818 TiB |
|       from large pool | 414883 KiB |  13181 MiB |    807 TiB |    807 TiB |
|       from small pool |  41675 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456559 KiB |  13220 MiB |    818 TiB |    818 TiB |
|       from large pool | 414883 KiB |  13181 MiB |    807 TiB |    807 TiB |
|       from small pool |  41675 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |    818 TiB |    818 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    806 TiB |    806 TiB |
|       from small pool |  40676 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14468 MiB |  14494 MiB |  28108 MiB |  13640 MiB |
|       from large pool |  14402 MiB |  14422 MiB |  28020 MiB |  13618 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 485521 KiB |   1256 MiB | 670560 GiB | 670560 GiB |
|       from large pool | 475996 KiB |   1252 MiB | 659014 GiB | 659014 GiB |
|       from small pool |   9524 KiB |     36 MiB |  11545 GiB |  11545 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8207    |  162533 K  |  162530 K  |
|       from large pool |     187    |    1413    |   76208 K  |   76208 K  |
|       from small pool |    3277    |    8018    |   86325 K  |   86322 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8207    |  162533 K  |  162530 K  |
|       from large pool |     187    |    1413    |   76208 K  |   76208 K  |
|       from small pool |    3277    |    8018    |   86325 K  |   86322 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     638    |    1211    |     577    |
|       from large pool |     601    |     602    |    1167    |     566    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    3667    |  100328 K  |  100328 K  |
|       from large pool |      41    |     604    |   57500 K  |   57500 K  |
|       from small pool |      41    |    3624    |   42828 K  |   42828 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |    818 TiB |    818 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |    818 TiB |    818 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    818 TiB |    818 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |  14494 MiB |  28108 MiB |  27188 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     50 MiB |     72 MiB |     88 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB | 670560 GiB | 670560 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 659014 GiB | 659014 GiB |
|       from small pool |      0 KiB |     44 MiB |  11546 GiB |  11546 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76208 K  |   76208 K  |
|       from small pool |       0    |    8018    |   86325 K  |   86325 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76208 K  |   76208 K  |
|       from small pool |       0    |    8018    |   86325 K  |   86325 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1211    |    1147    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      25    |      36    |      44    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  100330 K  |  100330 K  |
|       from large pool |       3    |     604    |   57500 K  |   57500 K  |
|       from small pool |       0    |    3624    |   42830 K  |   42830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |    818 TiB |    818 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |    818 TiB |    818 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    818 TiB |    818 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    806 TiB |    806 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |  14494 MiB |  28108 MiB |  27188 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     50 MiB |     72 MiB |     88 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB | 670560 GiB | 670560 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 659014 GiB | 659014 GiB |
|       from small pool |      0 KiB |     44 MiB |  11546 GiB |  11546 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76208 K  |   76208 K  |
|       from small pool |       0    |    8018    |   86325 K  |   86325 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76208 K  |   76208 K  |
|       from small pool |       0    |    8018    |   86325 K  |   86325 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1211    |    1147    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      25    |      36    |      44    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  100330 K  |  100330 K  |
|       from large pool |       3    |     604    |   57500 K  |   57500 K  |
|       from small pool |       0    |    3624    |   42830 K  |   42830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399

 Experiment start at: 2024-08-01 09:11:46.945993
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.977017, 'precision': 0.97786856, 'recall': 0.9770192, 'specificity': 0.9770192, 'f1': 0.9770068, 'auroc': 0.9982456, 'binary_precision': 0.9980661, 'binary_recall': 0.95589095, 'binary_specificity': 0.9981474, 'binary_f1_score': 0.97652334}
confusion matrix:
       0      1
0  29095     54
1   1286  27869
---- Validation: 
scalar performance:
{'acc': 0.89804506, 'precision': 0.5273352, 'recall': 0.56749177, 'specificity': 0.56749177, 'f1': 0.5323385, 'auroc': 0.7324871, 'binary_precision': 0.08216561, 'binary_recall': 0.21428572, 'binary_specificity': 0.9206978, 'binary_f1_score': 0.11878453}
confusion matrix:
       0     1
0  16730  1441
1    473   129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95688415, 'precision': 0.71896267, 'recall': 0.7713671, 'specificity': 0.7713671, 'f1': 0.7419398, 'auroc': 0.9040601, 'binary_precision': 0.45544556, 'binary_recall': 0.57024795, 'binary_specificity': 0.97248626, 'binary_f1_score': 0.50642204}
confusion matrix:
      0    1
0  5832  165
1   104  138
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 09:33:35.423856,epoch time: 0:21:48.477863,used: 0:21:48.477863,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99135566, 'precision': 0.99135923, 'recall': 0.9913554, 'specificity': 0.9913554, 'f1': 0.99135566, 'auroc': 0.9995258, 'binary_precision': 0.9900797, 'binary_recall': 0.9926604, 'binary_specificity': 0.99005044, 'binary_f1_score': 0.99136835}
confusion matrix:
       0      1
0  28857    290
1    214  28943
---- Validation: 
scalar performance:
{'acc': 0.9455601, 'precision': 0.664899, 'recall': 0.8433905, 'specificity': 0.8433905, 'f1': 0.7175615, 'auroc': 0.9154532, 'binary_precision': 0.33895704, 'binary_recall': 0.73421925, 'binary_specificity': 0.9525618, 'binary_f1_score': 0.46379855}
confusion matrix:
       0    1
0  17309  862
1    160  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94069564, 'precision': 0.6834637, 'recall': 0.87199694, 'specificity': 0.87199694, 'f1': 0.73950875, 'auroc': 0.94284815, 'binary_precision': 0.37548637, 'binary_recall': 0.79752064, 'binary_specificity': 0.94647324, 'binary_f1_score': 0.51058203}
confusion matrix:
      0    1
0  5676  321
1    49  193
better model found
persisted
after epoch: 2,now: 2024-08-01 09:54:29.276835,epoch time: 0:20:53.852979,used: 0:42:42.330842,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9919388, 'precision': 0.99205196, 'recall': 0.99193984, 'specificity': 0.99193984, 'f1': 0.99193835, 'auroc': 0.99966264, 'binary_precision': 0.99954724, 'binary_recall': 0.9843257, 'binary_specificity': 0.999554, 'binary_f1_score': 0.9918781}
confusion matrix:
       0      1
0  29135     13
1    457  28699
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.7565697, 'recall': 0.65166104, 'specificity': 0.65166104, 'f1': 0.68938774, 'auroc': 0.91525984, 'binary_precision': 0.5356125, 'binary_recall': 0.31229237, 'binary_specificity': 0.9910297, 'binary_f1_score': 0.39454356}
confusion matrix:
       0    1
0  18008  163
1    414  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.8068735, 'recall': 0.65145695, 'specificity': 0.65145695, 'f1': 0.70029086, 'auroc': 0.89179754, 'binary_precision': 0.64102566, 'binary_recall': 0.30991736, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.4178273}
confusion matrix:
      0   1
0  5955  42
1   167  75
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 10:15:46.440790,epoch time: 0:21:17.163955,used: 1:03:59.494797,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98691344, 'precision': 0.98700446, 'recall': 0.98691463, 'specificity': 0.98691463, 'f1': 0.98691285, 'auroc': 0.9988065, 'binary_precision': 0.9937057, 'binary_recall': 0.9800391, 'binary_specificity': 0.9937901, 'binary_f1_score': 0.98682505}
confusion matrix:
       0      1
0  28966    181
1    582  28575
---- Validation: 
scalar performance:
{'acc': 0.9388483, 'precision': 0.6366424, 'recall': 0.77969486, 'specificity': 0.77969486, 'f1': 0.6789106, 'auroc': 0.89937574, 'binary_precision': 0.28671876, 'binary_recall': 0.6096346, 'binary_specificity': 0.94975513, 'binary_f1_score': 0.3900106}
confusion matrix:
       0    1
0  17258  913
1    235  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.7411957, 'recall': 0.85449374, 'specificity': 0.85449374, 'f1': 0.785466, 'auroc': 0.9059491, 'binary_precision': 0.49311295, 'binary_recall': 0.73966944, 'binary_specificity': 0.969318, 'binary_f1_score': 0.59173554}
confusion matrix:
      0    1
0  5813  184
1    63  179
early stop counter: 1
val acc:0.9388483166694641, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9665010571479797 / 0.9665010571479797
after epoch: 4,now: 2024-08-01 10:37:46.370984,epoch time: 0:21:59.930194,used: 1:25:59.424991,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9938255, 'precision': 0.9938438, 'recall': 0.993826, 'specificity': 0.993826, 'f1': 0.99382544, 'auroc': 0.9996092, 'binary_precision': 0.99689406, 'binary_recall': 0.99073976, 'binary_specificity': 0.9969122, 'binary_f1_score': 0.99380744}
confusion matrix:
       0      1
0  29057     90
1    270  28887
---- Validation: 
scalar performance:
{'acc': 0.9699569, 'precision': 0.75739336, 'recall': 0.7821126, 'specificity': 0.7821126, 'f1': 0.7691263, 'auroc': 0.94241434, 'binary_precision': 0.5287009, 'binary_recall': 0.5813953, 'binary_specificity': 0.9828298, 'binary_f1_score': 0.5537974}
confusion matrix:
       0    1
0  17859  312
1    252  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.8948852, 'recall': 0.62081695, 'specificity': 0.62081695, 'f1': 0.6798415, 'auroc': 0.9270288, 'binary_precision': 0.8194444, 'binary_recall': 0.24380165, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3757962}
confusion matrix:
      0   1
0  5984  13
1   183  59
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 10:59:27.005271,epoch time: 0:21:40.634287,used: 1:47:40.059278,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9936025, 'precision': 0.99360836, 'recall': 0.9936028, 'specificity': 0.9936028, 'f1': 0.9936025, 'auroc': 0.99969566, 'binary_precision': 0.99535346, 'binary_recall': 0.9918373, 'binary_specificity': 0.9953683, 'binary_f1_score': 0.99359226}
confusion matrix:
       0      1
0  29012    135
1    238  28919
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7435462, 'recall': 0.6664237, 'specificity': 0.6664237, 'f1': 0.6970111, 'auroc': 0.93393517, 'binary_precision': 0.5085995, 'binary_recall': 0.34385383, 'binary_specificity': 0.98899347, 'binary_f1_score': 0.41030723}
confusion matrix:
       0    1
0  17971  200
1    395  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.6477699, 'recall': 0.5132956, 'specificity': 0.5132956, 'f1': 0.5164236, 'auroc': 0.9291517, 'binary_precision': 0.33333334, 'binary_recall': 0.02892562, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.05323194}
confusion matrix:
      0   1
0  5983  14
1   235   7
early stop counter: 1
val acc:0.9683055281639099, best validation acc: 0.9699568748474121, corresponding to test acc:                         0.9685847163200378 / 0.9685847163200378
after epoch: 6,now: 2024-08-01 11:20:21.672678,epoch time: 0:20:54.667407,used: 2:08:34.726685,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.994683, 'precision': 0.9946846, 'recall': 0.99468327, 'specificity': 0.99468327, 'f1': 0.994683, 'auroc': 0.99974096, 'binary_precision': 0.99560195, 'binary_recall': 0.99375814, 'binary_specificity': 0.9956083, 'binary_f1_score': 0.9946792}
confusion matrix:
       0      1
0  29018    128
1    182  28976
---- Validation: 
scalar performance:
{'acc': 0.9700634, 'precision': 0.75770664, 'recall': 0.8086682, 'specificity': 0.8086682, 'f1': 0.780645, 'auroc': 0.94640446, 'binary_precision': 0.5275482, 'binary_recall': 0.63621265, 'binary_specificity': 0.98112375, 'binary_f1_score': 0.5768072}
confusion matrix:
       0    1
0  17828  343
1    219  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97259176, 'precision': 0.9064946, 'recall': 0.68040085, 'specificity': 0.68040085, 'f1': 0.74655426, 'auroc': 0.9302794, 'binary_precision': 0.83809525, 'binary_recall': 0.36363637, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5072046}
confusion matrix:
      0   1
0  5980  17
1   154  88
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-01 11:42:05.844974,epoch time: 0:21:44.172296,used: 2:30:18.898981,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9933281, 'precision': 0.99333143, 'recall': 0.9933278, 'specificity': 0.9933278, 'f1': 0.9933281, 'auroc': 0.99963844, 'binary_precision': 0.99209744, 'binary_recall': 0.9945812, 'binary_specificity': 0.9920744, 'binary_f1_score': 0.9933378}
confusion matrix:
       0      1
0  28915    231
1    158  29000
---- Validation: 
scalar performance:
{'acc': 0.9061418, 'precision': 0.61143136, 'recall': 0.8631809, 'specificity': 0.8631809, 'f1': 0.6538536, 'auroc': 0.9237107, 'binary_precision': 0.22947761, 'binary_recall': 0.81727576, 'binary_specificity': 0.9090859, 'binary_f1_score': 0.3583394}
confusion matrix:
       0     1
0  16519  1652
1    110   492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8629588, 'precision': 0.59030867, 'recall': 0.82362914, 'specificity': 0.82362914, 'f1': 0.61526775, 'auroc': 0.8993815, 'binary_precision': 0.19071645, 'binary_recall': 0.78099173, 'binary_specificity': 0.8662665, 'binary_f1_score': 0.30656934}
confusion matrix:
      0    1
0  5195  802
1    53  189
early stop counter: 1
val acc:0.9061418175697327, best validation acc: 0.9700633883476257, corresponding to test acc:                         0.972591757774353 / 0.972591757774353
after epoch: 8,now: 2024-08-01 12:02:54.296620,epoch time: 0:20:48.451646,used: 2:51:07.350627,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9953005, 'precision': 0.99533534, 'recall': 0.9953015, 'specificity': 0.9953015, 'f1': 0.9953004, 'auroc': 0.9998125, 'binary_precision': 0.99955034, 'binary_recall': 0.99104905, 'binary_specificity': 0.999554, 'binary_f1_score': 0.9952816}
confusion matrix:
       0      1
0  29132     13
1    261  28898
---- Validation: 
scalar performance:
{'acc': 0.963618, 'precision': 0.7139983, 'recall': 0.7539436, 'specificity': 0.7539436, 'f1': 0.7320565, 'auroc': 0.93906045, 'binary_precision': 0.44367176, 'binary_recall': 0.5299003, 'binary_specificity': 0.97798693, 'binary_f1_score': 0.48296744}
confusion matrix:
       0    1
0  17771  400
1    283  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535182, 'precision': 0.7077087, 'recall': 0.7934091, 'specificity': 0.7934091, 'f1': 0.7420401, 'auroc': 0.92336977, 'binary_precision': 0.43103448, 'binary_recall': 0.6198347, 'binary_specificity': 0.9669835, 'binary_f1_score': 0.5084745}
confusion matrix:
      0    1
0  5799  198
1    92  150
early stop counter: 2
val acc:0.9636179804801941, best validation acc: 0.9700633883476257, corresponding to test acc:                         0.972591757774353 / 0.972591757774353
after epoch: 9,now: 2024-08-01 12:23:10.413713,epoch time: 0:20:16.117093,used: 3:11:23.467720,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.995918, 'precision': 0.99591815, 'recall': 0.99591804, 'specificity': 0.99591804, 'f1': 0.995918, 'auroc': 0.99982816, 'binary_precision': 0.9962589, 'binary_recall': 0.99557555, 'binary_specificity': 0.99626046, 'binary_f1_score': 0.99591714}
confusion matrix:
       0      1
0  29039    109
1    129  29027
---- Validation: 
scalar performance:
{'acc': 0.9701167, 'precision': 0.7596783, 'recall': 0.7500732, 'specificity': 0.7500732, 'f1': 0.7547759, 'auroc': 0.93551624, 'binary_precision': 0.5354059, 'binary_recall': 0.51495016, 'binary_specificity': 0.9851962, 'binary_f1_score': 0.5249788}
confusion matrix:
       0    1
0  17902  269
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7369448, 'recall': 0.6031859, 'specificity': 0.6031859, 'f1': 0.640793, 'auroc': 0.9104545, 'binary_precision': 0.5048544, 'binary_recall': 0.21487603, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.30144927}
confusion matrix:
      0   1
0  5946  51
1   190  52
better model found
persisted
after epoch: 10,now: 2024-08-01 12:43:41.923881,epoch time: 0:20:31.510168,used: 3:31:54.977888,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.992642, 'precision': 0.9926528, 'recall': 0.9926418, 'specificity': 0.9926418, 'f1': 0.9926419, 'auroc': 0.999645, 'binary_precision': 0.9903721, 'binary_recall': 0.994958, 'binary_specificity': 0.99032557, 'binary_f1_score': 0.99265975}
confusion matrix:
       0      1
0  28867    282
1    147  29008
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.733974, 'recall': 0.6251379, 'specificity': 0.6251379, 'f1': 0.6614635, 'auroc': 0.9229876, 'binary_precision': 0.49211356, 'binary_recall': 0.2591362, 'binary_specificity': 0.9911397, 'binary_f1_score': 0.3394994}
confusion matrix:
       0    1
0  18010  161
1    446  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584869, 'precision': 0.677603, 'recall': 0.5580649, 'specificity': 0.5580649, 'f1': 0.58339334, 'auroc': 0.9041239, 'binary_precision': 0.38961038, 'binary_recall': 0.12396694, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.18808776}
confusion matrix:
      0   1
0  5950  47
1   212  30
early stop counter: 1
val acc:0.9676663279533386, best validation acc: 0.9701166749000549, corresponding to test acc:                         0.9613720178604126 / 0.972591757774353
after epoch: 11,now: 2024-08-01 13:04:50.034326,epoch time: 0:21:08.110445,used: 3:53:03.088333,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9861073, 'precision': 0.986271, 'recall': 0.98610544, 'specificity': 0.98610544, 'f1': 0.9861061, 'auroc': 0.9994598, 'binary_precision': 0.9773998, 'binary_recall': 0.9952329, 'binary_specificity': 0.97697794, 'binary_f1_score': 0.9862358}
confusion matrix:
       0      1
0  28475    671
1    139  29019
---- Validation: 
scalar performance:
{'acc': 0.92931336, 'precision': 0.63760173, 'recall': 0.8590895, 'specificity': 0.8590895, 'f1': 0.6890286, 'auroc': 0.92666495, 'binary_precision': 0.28280407, 'binary_recall': 0.78405315, 'binary_specificity': 0.9341258, 'binary_f1_score': 0.4156759}
confusion matrix:
       0     1
0  16974  1197
1    130   472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92338514, 'precision': 0.65156406, 'recall': 0.8669579, 'specificity': 0.8669579, 'f1': 0.70406866, 'auroc': 0.93074447, 'binary_precision': 0.3115016, 'binary_recall': 0.8057851, 'binary_specificity': 0.92813075, 'binary_f1_score': 0.44930878}
confusion matrix:
      0    1
0  5566  431
1    47  195
early stop counter: 2
val acc:0.9293133616447449, best validation acc: 0.9701166749000549, corresponding to test acc:                         0.9613720178604126 / 0.972591757774353
after epoch: 12,now: 2024-08-01 13:31:22.393155,epoch time: 0:26:32.358829,used: 4:19:35.447162,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99152714, 'precision': 0.99155843, 'recall': 0.9915265, 'specificity': 0.9915265, 'f1': 0.9915271, 'auroc': 0.999538, 'binary_precision': 0.9876816, 'binary_recall': 0.9954728, 'binary_specificity': 0.9875802, 'binary_f1_score': 0.99156195}
confusion matrix:
       0      1
0  28785    362
1    132  29025
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.74997866, 'recall': 0.83132374, 'specificity': 0.83132374, 'f1': 0.7843118, 'auroc': 0.95317245, 'binary_precision': 0.51053286, 'binary_recall': 0.68438536, 'binary_specificity': 0.97826207, 'binary_f1_score': 0.5848119}
confusion matrix:
       0    1
0  17776  395
1    190  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709889, 'precision': 0.867846, 'recall': 0.6815498, 'specificity': 0.6815498, 'f1': 0.7404433, 'auroc': 0.94267553, 'binary_precision': 0.7606838, 'binary_recall': 0.3677686, 'binary_specificity': 0.995331, 'binary_f1_score': 0.49582174}
confusion matrix:
      0   1
0  5969  28
1   153  89
early stop counter: 3
val acc:0.9688382148742676, best validation acc: 0.9701166749000549, corresponding to test acc:                         0.9613720178604126 / 0.972591757774353
after epoch: 13,now: 2024-08-01 13:53:53.646797,epoch time: 0:22:31.253642,used: 4:42:06.700804,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99437433, 'precision': 0.9944313, 'recall': 0.9943754, 'specificity': 0.9943754, 'f1': 0.99437416, 'auroc': 0.99985504, 'binary_precision': 0.999792, 'binary_recall': 0.9889567, 'binary_specificity': 0.9997941, 'binary_f1_score': 0.99434483}
confusion matrix:
       0      1
0  29140      6
1    322  28836
---- Validation: 
scalar performance:
{'acc': 0.96708035, 'precision': 0.7346078, 'recall': 0.7308377, 'specificity': 0.7308377, 'f1': 0.73270583, 'auroc': 0.93433213, 'binary_precision': 0.4864865, 'binary_recall': 0.47840533, 'binary_specificity': 0.98327005, 'binary_f1_score': 0.4824121}
confusion matrix:
       0    1
0  17867  304
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709889, 'precision': 0.8796401, 'recall': 0.6716361, 'specificity': 0.6716361, 'f1': 0.7332262, 'auroc': 0.93732786, 'binary_precision': 0.78504676, 'binary_recall': 0.34710744, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.48137534}
confusion matrix:
      0   1
0  5974  23
1   158  84
early stop counter: 4
val acc:0.9670803546905518, best validation acc: 0.9701166749000549, corresponding to test acc:                         0.9613720178604126 / 0.972591757774353
after epoch: 14,now: 2024-08-01 14:16:12.083912,epoch time: 0:22:18.437115,used: 5:04:25.137919,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99524903, 'precision': 0.99525034, 'recall': 0.9952489, 'specificity': 0.9952489, 'f1': 0.99524903, 'auroc': 0.99985206, 'binary_precision': 0.99448687, 'binary_recall': 0.9960217, 'binary_specificity': 0.9944761, 'binary_f1_score': 0.9952537}
confusion matrix:
       0      1
0  28985    161
1    116  29042
---- Validation: 
scalar performance:
{'acc': 0.948916, 'precision': 0.6772763, 'recall': 0.8668064, 'specificity': 0.8668064, 'f1': 0.7337819, 'auroc': 0.9494785, 'binary_precision': 0.36216217, 'binary_recall': 0.7790698, 'binary_specificity': 0.95454293, 'binary_f1_score': 0.49446493}
confusion matrix:
       0    1
0  17345  826
1    133  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.7444057, 'recall': 0.9179414, 'specificity': 0.9179414, 'f1': 0.80493796, 'auroc': 0.95301163, 'binary_precision': 0.49414518, 'binary_recall': 0.8719008, 'binary_specificity': 0.963982, 'binary_f1_score': 0.63079226}
confusion matrix:
      0    1
0  5781  216
1    31  211
early stop counter: 5
val acc:0.9489160180091858, best validation acc: 0.9701166749000549, corresponding to test acc:                         0.9613720178604126 / 0.972591757774353
after epoch: 15,now: 2024-08-01 14:37:53.705862,epoch time: 0:21:41.621950,used: 5:26:06.759869,model: dset_te_center0_erm_no_git_version_2024md_08md_01_09_11_46_seed_2_23775399
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 5:26:06.759869 at 2024-08-01 14:37:53.705862
persisted model performance metric: 

scalar performance:
{'acc': 0.961372, 'precision': 0.7369448, 'recall': 0.6031859, 'specificity': 0.6031859, 'f1': 0.640793, 'auroc': 0.9104545, 'binary_precision': 0.5048544, 'binary_recall': 0.21487603, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.30144927}
confusion matrix:
      0   1
0  5946  51
1   190  52
oracle model performance metric: 

scalar performance:
{'acc': 0.97259176, 'precision': 0.9064946, 'recall': 0.68040085, 'specificity': 0.68040085, 'f1': 0.74655426, 'auroc': 0.9302794, 'binary_precision': 0.83809525, 'binary_recall': 0.36363637, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5072046}
confusion matrix:
      0   1
0  5980  17
1   154  88
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455233 KiB |  13220 MiB |   1251 TiB |   1251 TiB |
|       from large pool | 413552 KiB |  13181 MiB |   1234 TiB |   1234 TiB |
|       from small pool |  41681 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455233 KiB |  13220 MiB |   1251 TiB |   1251 TiB |
|       from large pool | 413552 KiB |  13181 MiB |   1234 TiB |   1234 TiB |
|       from small pool |  41681 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   1248 TiB |   1248 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1231 TiB |   1231 TiB |
|       from small pool |  40678 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14494 MiB |  41664 MiB |  27188 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  41560 MiB |  27150 MiB |
|       from small pool |     66 MiB |     72 MiB |    104 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 462270 KiB |   1256 MiB |    973 TiB |    973 TiB |
|       from large pool | 450704 KiB |   1252 MiB |    956 TiB |    956 TiB |
|       from small pool |  11566 KiB |     44 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8293    |  247056 K  |  247053 K  |
|       from large pool |     187    |    1413    |  116218 K  |  116218 K  |
|       from small pool |    3289    |    8104    |  130838 K  |  130834 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8293    |  247056 K  |  247053 K  |
|       from large pool |     187    |    1413    |  116218 K  |  116218 K  |
|       from small pool |    3289    |    8104    |  130838 K  |  130834 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1782    |    1147    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      36    |      52    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    3706    |  150213 K  |  150213 K  |
|       from large pool |      38    |     604    |   85422 K  |   85422 K  |
|       from small pool |      44    |    3667    |   64791 K  |   64791 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1251 TiB |   1251 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1234 TiB |   1234 TiB |
|       from small pool |      0 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1251 TiB |   1251 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1234 TiB |   1234 TiB |
|       from small pool |      0 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1248 TiB |   1248 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1231 TiB |   1231 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    896 MiB |  14494 MiB |  41664 MiB |  40768 MiB |
|       from large pool |    844 MiB |  14422 MiB |  41560 MiB |  40716 MiB |
|       from small pool |     52 MiB |     72 MiB |    104 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB |    973 TiB |    973 TiB |
|       from large pool |  24320 KiB |   1252 MiB |    956 TiB |    956 TiB |
|       from small pool |      0 KiB |     44 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8293    |  247056 K  |  247056 K  |
|       from large pool |       2    |    1413    |  116218 K  |  116218 K  |
|       from small pool |       0    |    8104    |  130838 K  |  130838 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8293    |  247056 K  |  247056 K  |
|       from large pool |       2    |    1413    |  116218 K  |  116218 K  |
|       from small pool |       0    |    8104    |  130838 K  |  130838 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1782    |    1718    |
|       from large pool |      38    |     602    |    1730    |    1692    |
|       from small pool |      26    |      36    |      52    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3706    |  150215 K  |  150215 K  |
|       from large pool |       3    |     604    |   85422 K  |   85422 K  |
|       from small pool |       0    |    3667    |   64792 K  |   64792 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 14:39:23 2024]
Finished job 0.
1 of 1 steps (100%) done
