Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 12:55:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233

 Experiment start at: 2024-07-31 13:01:12.925013
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9806485, 'precision': 0.98092556, 'recall': 0.98065877, 'specificity': 0.98065877, 'f1': 0.980646, 'auroc': 0.99846315, 'binary_precision': 0.9926796, 'binary_recall': 0.9684713, 'binary_specificity': 0.9928462, 'binary_f1_score': 0.980426}
confusion matrix:
       0      1
0  28451    205
1    905  27799
---- Validation: 
scalar performance:
{'acc': 0.96104723, 'precision': 0.7205856, 'recall': 0.8200718, 'specificity': 0.8200718, 'f1': 0.75993156, 'auroc': 0.9356589, 'binary_precision': 0.45310855, 'binary_recall': 0.6687403, 'binary_specificity': 0.97140336, 'binary_f1_score': 0.540201}
confusion matrix:
       0    1
0  17630  519
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.87436503, 'recall': 0.8288311, 'specificity': 0.8288311, 'f1': 0.8499664, 'auroc': 0.94509244, 'binary_precision': 0.7631579, 'binary_recall': 0.6666667, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.71165645}
confusion matrix:
      0    1
0  5943   54
1    87  174
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 13:21:00.187987,epoch time: 0:19:47.262974,used: 0:19:47.262974,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98675036, 'precision': 0.9867951, 'recall': 0.9867542, 'specificity': 0.9867542, 'f1': 0.9867501, 'auroc': 0.99886286, 'binary_precision': 0.99165964, 'binary_recall': 0.98177826, 'binary_specificity': 0.99173003, 'binary_f1_score': 0.9866942}
confusion matrix:
       0      1
0  28421    237
1    523  28179
---- Validation: 
scalar performance:
{'acc': 0.9303959, 'precision': 0.6478844, 'recall': 0.8664578, 'specificity': 0.8664578, 'f1': 0.70124114, 'auroc': 0.93444884, 'binary_precision': 0.30337077, 'binary_recall': 0.7978227, 'binary_specificity': 0.93509287, 'binary_f1_score': 0.4395887}
confusion matrix:
       0     1
0  16971  1178
1    130   513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7600726, 'recall': 0.85555804, 'specificity': 0.85555804, 'f1': 0.79928815, 'auroc': 0.94581497, 'binary_precision': 0.53168046, 'binary_recall': 0.7394636, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.61858976}
confusion matrix:
      0    1
0  5827  170
1    68  193
early stop counter: 1
val acc:0.9303959012031555, best validation acc: 0.9610472321510315, corresponding to test acc:                         0.9774688482284546 / 0.9774688482284546
after epoch: 2,now: 2024-07-31 13:40:01.901755,epoch time: 0:19:01.713768,used: 0:38:48.976742,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.989348, 'precision': 0.989457, 'recall': 0.98935384, 'specificity': 0.98935384, 'f1': 0.98934746, 'auroc': 0.99945307, 'binary_precision': 0.9969571, 'binary_recall': 0.9817086, 'binary_specificity': 0.9969991, 'binary_f1_score': 0.9892741}
confusion matrix:
       0      1
0  28572     86
1    525  28177
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7376729, 'recall': 0.7748846, 'specificity': 0.7748846, 'f1': 0.75476265, 'auroc': 0.940205, 'binary_precision': 0.4906417, 'binary_recall': 0.57076204, 'binary_specificity': 0.9790071, 'binary_f1_score': 0.52767795}
confusion matrix:
       0    1
0  17768  381
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9757111, 'precision': 0.9220822, 'recall': 0.74545896, 'specificity': 0.74545896, 'f1': 0.8083563, 'auroc': 0.9512959, 'binary_precision': 0.86577183, 'binary_recall': 0.49425286, 'binary_specificity': 0.996665, 'binary_f1_score': 0.6292683}
confusion matrix:
      0    1
0  5977   20
1   132  129
better model found
persisted
after epoch: 3,now: 2024-07-31 14:00:21.147822,epoch time: 0:20:19.246067,used: 0:59:08.222809,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97602856, 'precision': 0.9770801, 'recall': 0.9760467, 'specificity': 0.9760467, 'f1': 0.97601604, 'auroc': 0.9991493, 'binary_precision': 0.99967086, 'binary_recall': 0.9524075, 'binary_specificity': 0.99968594, 'binary_f1_score': 0.975467}
confusion matrix:
       0      1
0  28649      9
1   1366  27336
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.72123414, 'recall': 0.507473, 'specificity': 0.507473, 'f1': 0.50633866, 'auroc': 0.91533494, 'binary_precision': 0.47619048, 'binary_recall': 0.0155521, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.03012048}
confusion matrix:
       0   1
0  18138  11
1    633  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.91894877, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
better model found
persisted
after epoch: 4,now: 2024-07-31 14:20:49.275521,epoch time: 0:20:28.127699,used: 1:19:36.350508,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98143303, 'precision': 0.98178166, 'recall': 0.9814229, 'specificity': 0.9814229, 'f1': 0.98142934, 'auroc': 0.9992219, 'binary_precision': 0.96901196, 'binary_recall': 0.9947042, 'binary_specificity': 0.96814156, 'binary_f1_score': 0.98169}
confusion matrix:
       0      1
0  27745    913
1    152  28550
---- Validation: 
scalar performance:
{'acc': 0.92794806, 'precision': 0.6477245, 'recall': 0.88544196, 'specificity': 0.88544196, 'f1': 0.70259666, 'auroc': 0.94598347, 'binary_precision': 0.30150753, 'binary_recall': 0.83981335, 'binary_specificity': 0.93107057, 'binary_f1_score': 0.443714}
confusion matrix:
       0     1
0  16898  1251
1    103   540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93831897, 'precision': 0.6908063, 'recall': 0.89085925, 'specificity': 0.89085925, 'f1': 0.7492697, 'auroc': 0.94613075, 'binary_precision': 0.38898757, 'binary_recall': 0.83908045, 'binary_specificity': 0.942638, 'binary_f1_score': 0.53155345}
confusion matrix:
      0    1
0  5653  344
1    42  219
early stop counter: 1
val acc:0.9279480576515198, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9774688482284546
after epoch: 5,now: 2024-07-31 14:40:02.156937,epoch time: 0:19:12.881416,used: 1:38:49.231924,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97827756, 'precision': 0.9786935, 'recall': 0.9782654, 'specificity': 0.9782654, 'f1': 0.9782724, 'auroc': 0.9989688, 'binary_precision': 0.9647911, 'binary_recall': 0.9928233, 'binary_specificity': 0.96370745, 'binary_f1_score': 0.97860646}
confusion matrix:
       0      1
0  27616   1040
1    206  28498
---- Validation: 
scalar performance:
{'acc': 0.6926884, 'precision': 0.54482114, 'recall': 0.8026475, 'specificity': 0.8026475, 'f1': 0.49078393, 'auroc': 0.89524156, 'binary_precision': 0.09373021, 'binary_recall': 0.9206843, 'binary_specificity': 0.6846107, 'binary_f1_score': 0.17013939}
confusion matrix:
       0     1
0  12425  5724
1     51   592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7219559, 'precision': 0.5603491, 'recall': 0.82561016, 'specificity': 0.82561016, 'f1': 0.52528447, 'auroc': 0.9368254, 'binary_precision': 0.124428645, 'binary_recall': 0.93869734, 'binary_specificity': 0.7125229, 'binary_f1_score': 0.21973094}
confusion matrix:
      0     1
0  4273  1724
1    16   245
early stop counter: 2
val acc:0.6926884055137634, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9774688482284546
after epoch: 6,now: 2024-07-31 14:59:01.291451,epoch time: 0:18:59.134514,used: 1:57:48.366438,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99372387, 'precision': 0.99372613, 'recall': 0.9937248, 'specificity': 0.9937248, 'f1': 0.99372387, 'auroc': 0.9996667, 'binary_precision': 0.9950049, 'binary_recall': 0.99243957, 'binary_specificity': 0.99501014, 'binary_f1_score': 0.99372065}
confusion matrix:
       0      1
0  28515    143
1    217  28485
---- Validation: 
scalar performance:
{'acc': 0.9541294, 'precision': 0.70348877, 'recall': 0.8877456, 'specificity': 0.8877456, 'f1': 0.7624993, 'auroc': 0.959839, 'binary_precision': 0.41371158, 'binary_recall': 0.8164852, 'binary_specificity': 0.959006, 'binary_f1_score': 0.54916316}
confusion matrix:
       0    1
0  17405  744
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.8756725, 'recall': 0.8383262, 'specificity': 0.8383262, 'f1': 0.8559178, 'auroc': 0.9660909, 'binary_precision': 0.76495725, 'binary_recall': 0.68582374, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.7232323}
confusion matrix:
      0    1
0  5942   55
1    82  179
new oracle model saved
early stop counter: 3
val acc:0.9541293978691101, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9781080484390259
after epoch: 7,now: 2024-07-31 15:18:05.745087,epoch time: 0:19:04.453636,used: 2:16:52.820074,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9802127, 'precision': 0.9809356, 'recall': 0.98022836, 'specificity': 0.98022836, 'f1': 0.9802057, 'auroc': 0.9994203, 'binary_precision': 0.99978244, 'binary_recall': 0.9606661, 'binary_specificity': 0.9997906, 'binary_f1_score': 0.9798341}
confusion matrix:
       0      1
0  28651      6
1   1129  27574
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75448126, 'recall': 0.58669716, 'specificity': 0.58669716, 'f1': 0.6256531, 'auroc': 0.9384999, 'binary_precision': 0.5373832, 'binary_recall': 0.17884915, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.26837805}
confusion matrix:
       0    1
0  18050   99
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.90955055, 'recall': 0.5456435, 'specificity': 0.5456435, 'f1': 0.57318974, 'auroc': 0.9655671, 'binary_precision': 0.85714287, 'binary_recall': 0.09195402, 'binary_specificity': 0.999333, 'binary_f1_score': 0.16608995}
confusion matrix:
      0   1
0  5993   4
1   237  24
better model found
persisted
after epoch: 8,now: 2024-07-31 15:37:08.531342,epoch time: 0:19:02.786255,used: 2:35:55.606329,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9913006, 'precision': 0.9913668, 'recall': 0.99130476, 'specificity': 0.99130476, 'f1': 0.99130034, 'auroc': 0.9995852, 'binary_precision': 0.99724936, 'binary_recall': 0.985331, 'binary_specificity': 0.99727845, 'binary_f1_score': 0.9912543}
confusion matrix:
       0      1
0  28582     78
1    421  28279
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.7768546, 'recall': 0.734666, 'specificity': 0.734666, 'f1': 0.75384223, 'auroc': 0.94784904, 'binary_precision': 0.57195574, 'binary_recall': 0.4821151, 'binary_specificity': 0.98721695, 'binary_f1_score': 0.5232068}
confusion matrix:
       0    1
0  17917  232
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9792266, 'precision': 0.92040205, 'recall': 0.7985985, 'specificity': 0.7985985, 'f1': 0.8482192, 'auroc': 0.9633311, 'binary_precision': 0.8579235, 'binary_recall': 0.6015326, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.7072072}
confusion matrix:
      0    1
0  5971   26
1   104  157
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-31 15:56:14.051631,epoch time: 0:19:05.520289,used: 2:55:01.126618,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9921374, 'precision': 0.992152, 'recall': 0.99213564, 'specificity': 0.99213564, 'f1': 0.9921373, 'auroc': 0.99968314, 'binary_precision': 0.98963463, 'binary_recall': 0.99470365, 'binary_specificity': 0.9895677, 'binary_f1_score': 0.99216264}
confusion matrix:
       0      1
0  28362    299
1    152  28547
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.76026624, 'recall': 0.78864866, 'specificity': 0.78864866, 'f1': 0.7736399, 'auroc': 0.9536518, 'binary_precision': 0.5349162, 'binary_recall': 0.5956454, 'binary_specificity': 0.9816519, 'binary_f1_score': 0.56364983}
confusion matrix:
       0    1
0  17816  333
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.85687184, 'recall': 0.75078726, 'specificity': 0.75078726, 'f1': 0.79361653, 'auroc': 0.9602553, 'binary_precision': 0.73480666, 'binary_recall': 0.5095785, 'binary_specificity': 0.991996, 'binary_f1_score': 0.6018099}
confusion matrix:
      0    1
0  5949   48
1   128  133
early stop counter: 1
val acc:0.9684439897537231, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9792265892028809 / 0.9792265892028809
after epoch: 10,now: 2024-07-31 16:15:28.812426,epoch time: 0:19:14.760795,used: 3:14:15.887413,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99475247, 'precision': 0.9947604, 'recall': 0.9947542, 'specificity': 0.9947542, 'f1': 0.9947525, 'auroc': 0.9997637, 'binary_precision': 0.9969555, 'binary_recall': 0.99254435, 'binary_specificity': 0.9969641, 'binary_f1_score': 0.9947451}
confusion matrix:
       0      1
0  28570     87
1    214  28489
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.7328768, 'recall': 0.7185202, 'specificity': 0.7185202, 'f1': 0.72544324, 'auroc': 0.95174634, 'binary_precision': 0.48504984, 'binary_recall': 0.4541213, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.4690763}
confusion matrix:
       0    1
0  17839  310
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.88392055, 'recall': 0.6629167, 'specificity': 0.6629167, 'f1': 0.72495335, 'auroc': 0.97047263, 'binary_precision': 0.7962963, 'binary_recall': 0.32950193, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.46612468}
confusion matrix:
      0   1
0  5975  22
1   175  86
early stop counter: 2
val acc:0.964825451374054, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9792265892028809 / 0.9792265892028809
after epoch: 11,now: 2024-07-31 16:34:44.472579,epoch time: 0:19:15.660153,used: 3:33:31.547566,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9942817, 'precision': 0.99429786, 'recall': 0.9942843, 'specificity': 0.9942843, 'f1': 0.9942817, 'auroc': 0.9996053, 'binary_precision': 0.997336, 'binary_recall': 0.9912207, 'binary_specificity': 0.99734783, 'binary_f1_score': 0.99426895}
confusion matrix:
       0      1
0  28580     76
1    252  28452
---- Validation: 
scalar performance:
{'acc': 0.953278, 'precision': 0.68528414, 'recall': 0.78754747, 'specificity': 0.78754747, 'f1': 0.7236395, 'auroc': 0.94176626, 'binary_precision': 0.38469088, 'binary_recall': 0.6096423, 'binary_specificity': 0.9654527, 'binary_f1_score': 0.47172084}
confusion matrix:
       0    1
0  17522  627
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.7994622, 'recall': 0.7070576, 'specificity': 0.7070576, 'f1': 0.74386334, 'auroc': 0.93476367, 'binary_precision': 0.6235955, 'binary_recall': 0.42528737, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.5056948}
confusion matrix:
      0    1
0  5930   67
1   150  111
early stop counter: 3
val acc:0.9532780051231384, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9792265892028809 / 0.9792265892028809
after epoch: 12,now: 2024-07-31 16:54:01.316196,epoch time: 0:19:16.843617,used: 3:52:48.391183,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99527544, 'precision': 0.9952866, 'recall': 0.99527735, 'specificity': 0.99527735, 'f1': 0.9952754, 'auroc': 0.9997442, 'binary_precision': 0.99782866, 'binary_recall': 0.99271804, 'binary_specificity': 0.99783665, 'binary_f1_score': 0.9952668}
confusion matrix:
       0      1
0  28597     62
1    209  28492
---- Validation: 
scalar performance:
{'acc': 0.955513, 'precision': 0.68851733, 'recall': 0.7609525, 'specificity': 0.7609525, 'f1': 0.7180259, 'auroc': 0.93807185, 'binary_precision': 0.393134, 'binary_recall': 0.5520995, 'binary_specificity': 0.9698055, 'binary_f1_score': 0.45924968}
confusion matrix:
       0    1
0  17601  548
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.77977663, 'recall': 0.65416807, 'specificity': 0.65416807, 'f1': 0.69672686, 'auroc': 0.9552523, 'binary_precision': 0.5886525, 'binary_recall': 0.31800765, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.41293532}
confusion matrix:
      0   1
0  5939  58
1   178  83
early stop counter: 4
val acc:0.9555130004882812, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9792265892028809 / 0.9792265892028809
after epoch: 13,now: 2024-07-31 17:13:14.585881,epoch time: 0:19:13.269685,used: 4:12:01.660868,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9946827, 'precision': 0.99468315, 'recall': 0.99468243, 'specificity': 0.99468243, 'f1': 0.9946827, 'auroc': 0.99979806, 'binary_precision': 0.99439436, 'binary_recall': 0.99498326, 'binary_specificity': 0.9943816, 'binary_f1_score': 0.99468875}
confusion matrix:
       0      1
0  28495    161
1    144  28560
---- Validation: 
scalar performance:
{'acc': 0.963708, 'precision': 0.73542327, 'recall': 0.8552018, 'specificity': 0.8552018, 'f1': 0.78156906, 'auroc': 0.95812273, 'binary_precision': 0.4802831, 'binary_recall': 0.7387247, 'binary_specificity': 0.97167885, 'binary_f1_score': 0.58210784}
confusion matrix:
       0    1
0  17635  514
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.79712504, 'recall': 0.66599584, 'specificity': 0.66599584, 'f1': 0.7109674, 'auroc': 0.9535702, 'binary_precision': 0.62237763, 'binary_recall': 0.34099618, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.44059408}
confusion matrix:
      0   1
0  5943  54
1   172  89
early stop counter: 5
val acc:0.9637079834938049, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9792265892028809 / 0.9792265892028809
after epoch: 14,now: 2024-07-31 17:32:48.231794,epoch time: 0:19:33.645913,used: 4:31:35.306781,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99572873, 'precision': 0.99575484, 'recall': 0.99573207, 'specificity': 0.99573207, 'f1': 0.9957287, 'auroc': 0.9997829, 'binary_precision': 0.9995787, 'binary_recall': 0.9918829, 'binary_specificity': 0.9995812, 'binary_f1_score': 0.9957159}
confusion matrix:
       0      1
0  28643     12
1    233  28472
---- Validation: 
scalar performance:
{'acc': 0.97190297, 'precision': 0.8057922, 'recall': 0.7101835, 'specificity': 0.7101835, 'f1': 0.7483235, 'auroc': 0.95438373, 'binary_precision': 0.6315789, 'binary_recall': 0.42923796, 'binary_specificity': 0.991129, 'binary_f1_score': 0.51111114}
confusion matrix:
       0    1
0  17988  161
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.9643997, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
better model found
persisted
after epoch: 15,now: 2024-07-31 17:51:53.614970,epoch time: 0:19:05.383176,used: 4:50:40.689957,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9945084, 'precision': 0.9945266, 'recall': 0.9945065, 'specificity': 0.9945065, 'f1': 0.99450827, 'auroc': 0.9997901, 'binary_precision': 0.99168515, 'binary_recall': 0.9973867, 'binary_specificity': 0.99162626, 'binary_f1_score': 0.99452776}
confusion matrix:
       0      1
0  28421    240
1     75  28624
---- Validation: 
scalar performance:
{'acc': 0.9402405, 'precision': 0.66492665, 'recall': 0.86255383, 'specificity': 0.86255383, 'f1': 0.7199295, 'auroc': 0.93941206, 'binary_precision': 0.33805668, 'binary_recall': 0.7791602, 'binary_specificity': 0.9459474, 'binary_f1_score': 0.47152945}
confusion matrix:
       0    1
0  17168  981
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.79933167, 'recall': 0.83532286, 'specificity': 0.83532286, 'f1': 0.81617284, 'auroc': 0.95531225, 'binary_precision': 0.6122449, 'binary_recall': 0.6896552, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.6486486}
confusion matrix:
      0    1
0  5883  114
1    81  180
early stop counter: 1
val acc:0.9402405023574829, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9584531784057617 / 0.9792265892028809
after epoch: 16,now: 2024-07-31 18:10:45.684766,epoch time: 0:18:52.069796,used: 5:09:32.759753,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9951011, 'precision': 0.995144, 'recall': 0.99510443, 'specificity': 0.99510443, 'f1': 0.995101, 'auroc': 0.9998929, 'binary_precision': 0.9999296, 'binary_recall': 0.9902787, 'binary_specificity': 0.9999302, 'binary_f1_score': 0.9950807}
confusion matrix:
       0      1
0  28658      2
1    279  28421
---- Validation: 
scalar performance:
{'acc': 0.9722222, 'precision': 0.85036045, 'recall': 0.6495943, 'specificity': 0.6495943, 'f1': 0.70669866, 'auroc': 0.9539975, 'binary_precision': 0.72490704, 'binary_recall': 0.30326593, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.42763156}
confusion matrix:
       0    1
0  18075   74
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.904276, 'recall': 0.5722133, 'specificity': 0.5722133, 'f1': 0.6147645, 'auroc': 0.96816033, 'binary_precision': 0.84444445, 'binary_recall': 0.14559387, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.24836601}
confusion matrix:
      0   1
0  5990   7
1   223  38
better model found
persisted
after epoch: 17,now: 2024-07-31 18:30:34.575816,epoch time: 0:19:48.891050,used: 5:29:21.650803,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99478734, 'precision': 0.9948349, 'recall': 0.9947914, 'specificity': 0.9947914, 'f1': 0.9947872, 'auroc': 0.99983966, 'binary_precision': 0.9998944, 'binary_recall': 0.9896875, 'binary_specificity': 0.99989533, 'binary_f1_score': 0.99476475}
confusion matrix:
       0      1
0  28654      3
1    296  28407
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.8707402, 'recall': 0.58001685, 'specificity': 0.58001685, 'f1': 0.6259328, 'auroc': 0.9581251, 'binary_precision': 0.77037036, 'binary_recall': 0.16174184, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.2673522}
confusion matrix:
       0    1
0  18118   31
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7048012, 'recall': 0.5163242, 'specificity': 0.5163242, 'f1': 0.5212806, 'auroc': 0.9584754, 'binary_precision': 0.45, 'binary_recall': 0.03448276, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.06405694}
confusion matrix:
      0   1
0  5986  11
1   252   9
early stop counter: 1
val acc:0.9696679711341858, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9632470607757568 / 0.9792265892028809
after epoch: 18,now: 2024-07-31 18:51:07.197097,epoch time: 0:20:32.621281,used: 5:49:54.272084,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9950837, 'precision': 0.9950838, 'recall': 0.99508405, 'specificity': 0.99508405, 'f1': 0.99508363, 'auroc': 0.99977577, 'binary_precision': 0.9955707, 'binary_recall': 0.99459946, 'binary_specificity': 0.9955686, 'binary_f1_score': 0.9950848}
confusion matrix:
       0      1
0  28532    127
1    155  28546
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.7578615, 'recall': 0.7982341, 'specificity': 0.7982341, 'f1': 0.77641225, 'auroc': 0.95792294, 'binary_precision': 0.5294118, 'binary_recall': 0.61586314, 'binary_specificity': 0.980605, 'binary_f1_score': 0.5693746}
confusion matrix:
       0    1
0  17797  352
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.85989946, 'recall': 0.7038117, 'specificity': 0.7038117, 'f1': 0.7581651, 'auroc': 0.95891273, 'binary_precision': 0.74482757, 'binary_recall': 0.41379312, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.53201973}
confusion matrix:
      0    1
0  5960   37
1   153  108
early stop counter: 2
val acc:0.9681247472763062, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9632470607757568 / 0.9792265892028809
after epoch: 19,now: 2024-07-31 19:10:18.624072,epoch time: 0:19:11.426975,used: 6:09:05.699059,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9949965, 'precision': 0.99502176, 'recall': 0.99499965, 'specificity': 0.99499965, 'f1': 0.9949965, 'auroc': 0.99983203, 'binary_precision': 0.99877137, 'binary_recall': 0.9912207, 'binary_specificity': 0.99877864, 'binary_f1_score': 0.9949817}
confusion matrix:
       0      1
0  28621     35
1    252  28452
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.7833121, 'recall': 0.7607189, 'specificity': 0.7607189, 'f1': 0.77149796, 'auroc': 0.9563631, 'binary_precision': 0.58305085, 'binary_recall': 0.5349922, 'binary_specificity': 0.98644555, 'binary_f1_score': 0.55798864}
confusion matrix:
       0    1
0  17903  246
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.8616663, 'recall': 0.8055924, 'specificity': 0.8055924, 'f1': 0.8310194, 'auroc': 0.96728873, 'binary_precision': 0.739726, 'binary_recall': 0.62068963, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.67499995}
confusion matrix:
      0    1
0  5940   57
1    99  162
early stop counter: 3
val acc:0.9709982872009277, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9632470607757568 / 0.9792265892028809
after epoch: 20,now: 2024-07-31 19:30:29.574807,epoch time: 0:20:10.950735,used: 6:29:16.649794,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_01_12_seed_0_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:29:16.649794 at 2024-07-31 19:30:29.574807
persisted model performance metric: 

scalar performance:
{'acc': 0.96324706, 'precision': 0.904276, 'recall': 0.5722133, 'specificity': 0.5722133, 'f1': 0.6147645, 'auroc': 0.96816033, 'binary_precision': 0.84444445, 'binary_recall': 0.14559387, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.24836601}
confusion matrix:
      0   1
0  5990   7
1   223  38
oracle model performance metric: 

scalar performance:
{'acc': 0.9792266, 'precision': 0.92040205, 'recall': 0.7985985, 'specificity': 0.7985985, 'f1': 0.8482192, 'auroc': 0.9633311, 'binary_precision': 0.8579235, 'binary_recall': 0.6015326, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.7072072}
confusion matrix:
      0    1
0  5971   26
1   104  157
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458481 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |  41687 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458481 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |  41687 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB | 550777 GiB | 550777 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 543185 GiB | 543184 GiB |
|       from small pool |  40679 KiB |     60 MiB |   7592 GiB |   7592 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14412 MiB |  14412 MiB |  14412 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 416014 KiB |   1235 MiB | 439416 GiB | 439416 GiB |
|       from large pool | 406502 KiB |   1232 MiB | 431776 GiB | 431776 GiB |
|       from small pool |   9512 KiB |     15 MiB |   7639 GiB |   7639 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8175    |  107517 K  |  107513 K  |
|       from large pool |     187    |    1413    |   50376 K  |   50376 K  |
|       from small pool |    3301    |    7986    |   57140 K  |   57137 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8175    |  107517 K  |  107513 K  |
|       from large pool |     187    |    1413    |   50376 K  |   50376 K  |
|       from small pool |    3301    |    7986    |   57140 K  |   57137 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3641    |   64573 K  |   64573 K  |
|       from large pool |      30    |     604    |   36795 K  |   36795 K  |
|       from small pool |      42    |    3610    |   27777 K  |   27777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |      0 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |      0 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 550777 GiB | 550777 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 543185 GiB | 543185 GiB |
|       from small pool |      0 KiB |     60 MiB |   7592 GiB |   7592 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 439417 GiB | 439417 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 431777 GiB | 431777 GiB |
|       from small pool |      0 KiB |     38 MiB |   7639 GiB |   7639 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |  107517 K  |  107517 K  |
|       from large pool |       2    |    1413    |   50376 K  |   50376 K  |
|       from small pool |       0    |    7986    |   57140 K  |   57140 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |  107517 K  |  107517 K  |
|       from large pool |       2    |    1413    |   50376 K  |   50376 K  |
|       from small pool |       0    |    7986    |   57140 K  |   57140 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3641    |   64574 K  |   64574 K  |
|       from large pool |       3    |     604    |   36795 K  |   36795 K  |
|       from small pool |       0    |    3610    |   27779 K  |   27779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |      0 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 551249 GiB | 551249 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 543639 GiB | 543639 GiB |
|       from small pool |      0 KiB |     61 MiB |   7610 GiB |   7610 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 550777 GiB | 550777 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 543185 GiB | 543185 GiB |
|       from small pool |      0 KiB |     60 MiB |   7592 GiB |   7592 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 439417 GiB | 439417 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 431777 GiB | 431777 GiB |
|       from small pool |      0 KiB |     38 MiB |   7639 GiB |   7639 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |  107517 K  |  107517 K  |
|       from large pool |       2    |    1413    |   50376 K  |   50376 K  |
|       from small pool |       0    |    7986    |   57140 K  |   57140 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |  107517 K  |  107517 K  |
|       from large pool |       2    |    1413    |   50376 K  |   50376 K  |
|       from small pool |       0    |    7986    |   57140 K  |   57140 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3641    |   64574 K  |   64574 K  |
|       from large pool |       3    |     604    |   36795 K  |   36795 K  |
|       from small pool |       0    |    3610    |   27779 K  |   27779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233

 Experiment start at: 2024-07-31 19:40:44.002490
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98488265, 'precision': 0.98521435, 'recall': 0.9848919, 'specificity': 0.9848919, 'f1': 0.9848803, 'auroc': 0.99900174, 'binary_precision': 0.9980759, 'binary_recall': 0.9716595, 'binary_specificity': 0.99812424, 'binary_f1_score': 0.98469055}
confusion matrix:
       0      1
0  28734     54
1    817  28011
---- Validation: 
scalar performance:
{'acc': 0.9431697, 'precision': 0.6731707, 'recall': 0.8389172, 'specificity': 0.8389172, 'f1': 0.7243272, 'auroc': 0.92704713, 'binary_precision': 0.3569343, 'binary_recall': 0.7265973, 'binary_specificity': 0.9512371, 'binary_f1_score': 0.47870776}
confusion matrix:
       0    1
0  17186  881
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506929, 'precision': 0.7147783, 'recall': 0.8271495, 'specificity': 0.8271495, 'f1': 0.7572446, 'auroc': 0.92841727, 'binary_precision': 0.44334975, 'binary_recall': 0.6923077, 'binary_specificity': 0.96199125, 'binary_f1_score': 0.5405406}
confusion matrix:
      0    1
0  5720  226
1    80  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 20:00:55.603807,epoch time: 0:20:11.601317,used: 0:20:11.601317,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9872952, 'precision': 0.98729515, 'recall': 0.9872952, 'specificity': 0.9872952, 'f1': 0.9872952, 'auroc': 0.9990053, 'binary_precision': 0.98733824, 'binary_recall': 0.98726976, 'binary_specificity': 0.98732066, 'binary_f1_score': 0.98730403}
confusion matrix:
       0      1
0  28422    365
1    367  28462
---- Validation: 
scalar performance:
{'acc': 0.8943437, 'precision': 0.60355884, 'recall': 0.8236085, 'specificity': 0.8236085, 'f1': 0.63975215, 'auroc': 0.89908713, 'binary_precision': 0.21746649, 'binary_recall': 0.7473997, 'binary_specificity': 0.89981735, 'binary_f1_score': 0.33690557}
confusion matrix:
       0     1
0  16257  1810
1    170   503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8988076, 'precision': 0.6218396, 'recall': 0.82397926, 'specificity': 0.82397926, 'f1': 0.66278666, 'auroc': 0.9058687, 'binary_precision': 0.25596818, 'binary_recall': 0.74230766, 'binary_specificity': 0.90565085, 'binary_f1_score': 0.38067064}
confusion matrix:
      0    1
0  5385  561
1    67  193
early stop counter: 1
val acc:0.8943436741828918, best validation acc: 0.9431697130203247, corresponding to test acc:                         0.950692892074585 / 0.950692892074585
after epoch: 2,now: 2024-07-31 20:20:16.239853,epoch time: 0:19:20.636046,used: 0:39:32.237363,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9835983, 'precision': 0.98389816, 'recall': 0.98358935, 'specificity': 0.98358935, 'f1': 0.9835955, 'auroc': 0.99934816, 'binary_precision': 0.97203416, 'binary_recall': 0.9958722, 'binary_specificity': 0.9713065, 'binary_f1_score': 0.9838088}
confusion matrix:
       0      1
0  27961    826
1    119  28710
---- Validation: 
scalar performance:
{'acc': 0.87972254, 'precision': 0.6071769, 'recall': 0.8939898, 'specificity': 0.8939898, 'f1': 0.6428181, 'auroc': 0.9439249, 'binary_precision': 0.21818182, 'binary_recall': 0.90936106, 'binary_specificity': 0.8786185, 'binary_f1_score': 0.35192642}
confusion matrix:
       0     1
0  15874  2193
1     61   612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9318402, 'precision': 0.68160474, 'recall': 0.9074213, 'specificity': 0.9074213, 'f1': 0.74159, 'auroc': 0.95911205, 'binary_precision': 0.36876008, 'binary_recall': 0.88076925, 'binary_specificity': 0.9340733, 'binary_f1_score': 0.5198638}
confusion matrix:
      0    1
0  5554  392
1    31  229
early stop counter: 2
val acc:0.879722535610199, best validation acc: 0.9431697130203247, corresponding to test acc:                         0.950692892074585 / 0.950692892074585
after epoch: 3,now: 2024-07-31 20:39:38.583523,epoch time: 0:19:22.343670,used: 0:58:54.581033,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.986896, 'precision': 0.9871306, 'recall': 0.9869045, 'specificity': 0.9869045, 'f1': 0.98689455, 'auroc': 0.9994911, 'binary_precision': 0.99801326, 'binary_recall': 0.97575444, 'binary_specificity': 0.9980546, 'binary_f1_score': 0.9867583}
confusion matrix:
       0      1
0  28730     56
1    699  28131
---- Validation: 
scalar performance:
{'acc': 0.9684632, 'precision': 0.77692616, 'recall': 0.7318701, 'specificity': 0.7318701, 'f1': 0.7521882, 'auroc': 0.9467143, 'binary_precision': 0.5732143, 'binary_recall': 0.4769688, 'binary_specificity': 0.98677146, 'binary_f1_score': 0.5206813}
confusion matrix:
       0    1
0  17828  239
1    352  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8675991, 'recall': 0.6366116, 'specificity': 0.6366116, 'f1': 0.69468194, 'auroc': 0.9313236, 'binary_precision': 0.7659575, 'binary_recall': 0.2769231, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.40677968}
confusion matrix:
      0   1
0  5924  22
1   188  72
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 20:59:07.727915,epoch time: 0:19:29.144392,used: 1:18:23.725425,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98311234, 'precision': 0.98319316, 'recall': 0.9831079, 'specificity': 0.9831079, 'f1': 0.9831115, 'auroc': 0.99880946, 'binary_precision': 0.9771162, 'binary_recall': 0.98942, 'binary_specificity': 0.9767959, 'binary_f1_score': 0.9832296}
confusion matrix:
       0      1
0  28120    668
1    305  28523
---- Validation: 
scalar performance:
{'acc': 0.924333, 'precision': 0.6437314, 'recall': 0.86419606, 'specificity': 0.86419606, 'f1': 0.69545245, 'auroc': 0.9356717, 'binary_precision': 0.29544207, 'binary_recall': 0.79940563, 'binary_specificity': 0.92898655, 'binary_f1_score': 0.43143547}
confusion matrix:
       0     1
0  16784  1283
1    135   538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92958426, 'precision': 0.67175734, 'recall': 0.87314224, 'specificity': 0.87314224, 'f1': 0.72672164, 'auroc': 0.94906855, 'binary_precision': 0.35225376, 'binary_recall': 0.81153846, 'binary_specificity': 0.934746, 'binary_f1_score': 0.49126893}
confusion matrix:
      0    1
0  5558  388
1    49  211
early stop counter: 1
val acc:0.9243329763412476, best validation acc: 0.9684631824493408, corresponding to test acc:                         0.9661617875099182 / 0.9661617875099182
after epoch: 5,now: 2024-07-31 21:18:33.701978,epoch time: 0:19:25.974063,used: 1:37:49.699488,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9943592, 'precision': 0.99436516, 'recall': 0.9943606, 'specificity': 0.9943606, 'f1': 0.9943592, 'auroc': 0.9996923, 'binary_precision': 0.9962741, 'binary_recall': 0.9924382, 'binary_specificity': 0.99628305, 'binary_f1_score': 0.99435246}
confusion matrix:
       0      1
0  28680    107
1    218  28611
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.73601717, 'recall': 0.87504053, 'specificity': 0.87504053, 'f1': 0.7874867, 'auroc': 0.9523589, 'binary_precision': 0.4803653, 'binary_recall': 0.781575, 'binary_specificity': 0.9685061, 'binary_f1_score': 0.5950226}
confusion matrix:
       0    1
0  17498  569
1    147  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9774412, 'precision': 0.87025094, 'recall': 0.8374305, 'specificity': 0.8374305, 'f1': 0.85299647, 'auroc': 0.96520543, 'binary_precision': 0.7542373, 'binary_recall': 0.6846154, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.7177419}
confusion matrix:
      0    1
0  5888   58
1    82  178
new oracle model saved
early stop counter: 2
val acc:0.9617929458618164, best validation acc: 0.9684631824493408, corresponding to test acc:                         0.9661617875099182 / 0.9774411916732788
after epoch: 6,now: 2024-07-31 21:37:57.193902,epoch time: 0:19:23.491924,used: 1:57:13.191412,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9839454, 'precision': 0.98403025, 'recall': 0.9839405, 'specificity': 0.9839405, 'f1': 0.9839446, 'auroc': 0.99879456, 'binary_precision': 0.97780895, 'binary_recall': 0.99039197, 'binary_specificity': 0.97748905, 'binary_f1_score': 0.9840602}
confusion matrix:
       0      1
0  28138    648
1    277  28553
---- Validation: 
scalar performance:
{'acc': 0.95955175, 'precision': 0.72387695, 'recall': 0.8373996, 'specificity': 0.8373996, 'f1': 0.7675082, 'auroc': 0.95447934, 'binary_precision': 0.4589372, 'binary_recall': 0.70579493, 'binary_specificity': 0.9690043, 'binary_f1_score': 0.5562061}
confusion matrix:
       0    1
0  17507  560
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.75227726, 'recall': 0.7383225, 'specificity': 0.7383225, 'f1': 0.7450735, 'auroc': 0.9333823, 'binary_precision': 0.5265306, 'binary_recall': 0.49615383, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.5108911}
confusion matrix:
      0    1
0  5830  116
1   131  129
early stop counter: 3
val acc:0.9595517516136169, best validation acc: 0.9684631824493408, corresponding to test acc:                         0.9661617875099182 / 0.9774411916732788
after epoch: 7,now: 2024-07-31 21:57:18.454305,epoch time: 0:19:21.260403,used: 2:16:34.451815,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9917905, 'precision': 0.99183726, 'recall': 0.991787, 'specificity': 0.991787, 'f1': 0.9917902, 'auroc': 0.99965787, 'binary_precision': 0.9872165, 'binary_recall': 0.99649656, 'binary_specificity': 0.9870775, 'binary_f1_score': 0.99183476}
confusion matrix:
       0      1
0  28415    372
1    101  28728
---- Validation: 
scalar performance:
{'acc': 0.9335112, 'precision': 0.66460574, 'recall': 0.89899737, 'specificity': 0.89899737, 'f1': 0.72330153, 'auroc': 0.9498502, 'binary_precision': 0.33467975, 'binary_recall': 0.8618128, 'binary_specificity': 0.93618196, 'binary_f1_score': 0.48212802}
confusion matrix:
       0     1
0  16914  1153
1     93   580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.73699933, 'recall': 0.8921977, 'specificity': 0.8921977, 'f1': 0.79219043, 'auroc': 0.95342183, 'binary_precision': 0.481982, 'binary_recall': 0.8230769, 'binary_specificity': 0.96131855, 'binary_f1_score': 0.6079545}
confusion matrix:
      0    1
0  5716  230
1    46  214
early stop counter: 4
val acc:0.9335111975669861, best validation acc: 0.9684631824493408, corresponding to test acc:                         0.9661617875099182 / 0.9774411916732788
after epoch: 8,now: 2024-07-31 22:16:38.367142,epoch time: 0:19:19.912837,used: 2:35:54.364652,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9955915, 'precision': 0.9955992, 'recall': 0.99559295, 'specificity': 0.99559295, 'f1': 0.9955915, 'auroc': 0.99980485, 'binary_precision': 0.9977355, 'binary_recall': 0.99344385, 'binary_specificity': 0.9977421, 'binary_f1_score': 0.995585}
confusion matrix:
       0      1
0  28723     65
1    189  28639
---- Validation: 
scalar performance:
{'acc': 0.9365528, 'precision': 0.6682205, 'recall': 0.88841534, 'specificity': 0.88841534, 'f1': 0.7262906, 'auroc': 0.9491167, 'binary_precision': 0.34287456, 'binary_recall': 0.83655274, 'binary_specificity': 0.9402779, 'binary_f1_score': 0.48639312}
confusion matrix:
       0     1
0  16988  1079
1    110   563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9737351, 'precision': 0.82407415, 'recall': 0.87963206, 'specificity': 0.87963206, 'f1': 0.8493805, 'auroc': 0.96409607, 'binary_precision': 0.65798044, 'binary_recall': 0.77692306, 'binary_specificity': 0.98234105, 'binary_f1_score': 0.71252203}
confusion matrix:
      0    1
0  5841  105
1    58  202
early stop counter: 5
val acc:0.9365528225898743, best validation acc: 0.9684631824493408, corresponding to test acc:                         0.9661617875099182 / 0.9774411916732788
after epoch: 9,now: 2024-07-31 22:35:40.275883,epoch time: 0:19:01.908741,used: 2:54:56.273393,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9947931, 'precision': 0.9948213, 'recall': 0.99479604, 'specificity': 0.99479604, 'f1': 0.99479306, 'auroc': 0.999774, 'binary_precision': 0.9987413, 'binary_recall': 0.9908426, 'binary_specificity': 0.99874943, 'binary_f1_score': 0.99477625}
confusion matrix:
       0      1
0  28751     36
1    264  28565
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.803425, 'recall': 0.66062015, 'specificity': 0.66062015, 'f1': 0.708063, 'auroc': 0.9339417, 'binary_precision': 0.6314286, 'binary_recall': 0.32838038, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.43206257}
confusion matrix:
       0    1
0  17938  129
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.8542809, 'recall': 0.50568515, 'specificity': 0.50568515, 'f1': 0.5007446, 'auroc': 0.93066496, 'binary_precision': 0.75, 'binary_recall': 0.011538462, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.022727273}
confusion matrix:
      0  1
0  5945  1
1   257  3
better model found
persisted
after epoch: 10,now: 2024-07-31 22:54:43.060380,epoch time: 0:19:02.784497,used: 3:13:59.057890,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9944981, 'precision': 0.99450386, 'recall': 0.99449694, 'specificity': 0.99449694, 'f1': 0.994498, 'auroc': 0.9998015, 'binary_precision': 0.9929801, 'binary_recall': 0.99604565, 'binary_specificity': 0.99294823, 'binary_f1_score': 0.99451053}
confusion matrix:
       0      1
0  28584    203
1    114  28715
---- Validation: 
scalar performance:
{'acc': 0.9703842, 'precision': 0.7851094, 'recall': 0.7936641, 'specificity': 0.7936641, 'f1': 0.78931653, 'auroc': 0.95415753, 'binary_precision': 0.5850144, 'binary_recall': 0.6032689, 'binary_specificity': 0.98405933, 'binary_f1_score': 0.5940015}
confusion matrix:
       0    1
0  17779  288
1    267  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.9180293, 'recall': 0.6699766, 'specificity': 0.6699766, 'f1': 0.7375021, 'auroc': 0.9500371, 'binary_precision': 0.8640777, 'binary_recall': 0.3423077, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.4903581}
confusion matrix:
      0   1
0  5932  14
1   171  89
better model found
persisted
after epoch: 11,now: 2024-07-31 23:13:59.117121,epoch time: 0:19:16.056741,used: 3:33:15.114631,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99675435, 'precision': 0.9967594, 'recall': 0.99675566, 'specificity': 0.99675566, 'f1': 0.9967544, 'auroc': 0.99983513, 'binary_precision': 0.9985379, 'binary_recall': 0.9949703, 'binary_specificity': 0.998541, 'binary_f1_score': 0.9967509}
confusion matrix:
       0      1
0  28745     42
1    145  28684
---- Validation: 
scalar performance:
{'acc': 0.9633938, 'precision': 0.7403261, 'recall': 0.8243716, 'specificity': 0.8243716, 'f1': 0.77526, 'auroc': 0.95178425, 'binary_precision': 0.49294245, 'binary_recall': 0.67459136, 'binary_specificity': 0.9741518, 'binary_f1_score': 0.5696361}
confusion matrix:
       0    1
0  17600  467
1    219  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9531099, 'precision': 0.6821602, 'recall': 0.6077324, 'specificity': 0.6077324, 'f1': 0.6338614, 'auroc': 0.9256946, 'binary_precision': 0.397351, 'binary_recall': 0.23076923, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.2919708}
confusion matrix:
      0   1
0  5855  91
1   200  60
early stop counter: 1
val acc:0.9633938074111938, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.970190167427063 / 0.9774411916732788
after epoch: 12,now: 2024-07-31 23:33:21.853315,epoch time: 0:19:22.736194,used: 3:52:37.850825,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.982852, 'precision': 0.98291457, 'recall': 0.9828479, 'specificity': 0.9828479, 'f1': 0.98285127, 'auroc': 0.99884975, 'binary_precision': 0.97759634, 'binary_recall': 0.9883798, 'binary_specificity': 0.97731614, 'binary_f1_score': 0.9829585}
confusion matrix:
       0      1
0  28134    653
1    335  28494
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.7532939, 'recall': 0.7175839, 'specificity': 0.7175839, 'f1': 0.7339289, 'auroc': 0.9395788, 'binary_precision': 0.5269565, 'binary_recall': 0.45022288, 'binary_specificity': 0.98494494, 'binary_f1_score': 0.4855769}
confusion matrix:
       0    1
0  17795  272
1    370  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.8618306, 'recall': 0.57775295, 'specificity': 0.57775295, 'f1': 0.6209849, 'auroc': 0.93711865, 'binary_precision': 0.7592593, 'binary_recall': 0.15769231, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.26114652}
confusion matrix:
      0   1
0  5933  13
1   219  41
early stop counter: 2
val acc:0.965741753578186, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.970190167427063 / 0.9774411916732788
after epoch: 13,now: 2024-07-31 23:52:47.869761,epoch time: 0:19:26.016446,used: 4:12:03.867271,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99658084, 'precision': 0.9965957, 'recall': 0.99658304, 'specificity': 0.99658304, 'f1': 0.99658084, 'auroc': 0.99981284, 'binary_precision': 0.99951154, 'binary_recall': 0.99365246, 'binary_specificity': 0.9995136, 'binary_f1_score': 0.9965734}
confusion matrix:
       0      1
0  28772     14
1    183  28647
---- Validation: 
scalar performance:
{'acc': 0.97241193, 'precision': 0.8163353, 'recall': 0.7446471, 'specificity': 0.7446471, 'f1': 0.77546746, 'auroc': 0.95300233, 'binary_precision': 0.6511628, 'binary_recall': 0.49925706, 'binary_specificity': 0.9900371, 'binary_f1_score': 0.56518084}
confusion matrix:
       0    1
0  17887  180
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8472, 'recall': 0.5567673, 'specificity': 0.5567673, 'f1': 0.58971816, 'auroc': 0.951734, 'binary_precision': 0.73170733, 'binary_recall': 0.115384616, 'binary_specificity': 0.99815, 'binary_f1_score': 0.19933553}
confusion matrix:
      0   1
0  5935  11
1   230  30
better model found
persisted
after epoch: 14,now: 2024-08-01 00:12:25.133794,epoch time: 0:19:37.264033,used: 4:31:41.131304,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99698, 'precision': 0.99698496, 'recall': 0.99698126, 'specificity': 0.99698126, 'f1': 0.99698, 'auroc': 0.9998754, 'binary_precision': 0.9987468, 'binary_recall': 0.99521315, 'binary_specificity': 0.99874943, 'binary_f1_score': 0.9969769}
confusion matrix:
       0      1
0  28751     36
1    138  28691
---- Validation: 
scalar performance:
{'acc': 0.96931696, 'precision': 0.79090333, 'recall': 0.70799387, 'specificity': 0.70799387, 'f1': 0.74186903, 'auroc': 0.95844674, 'binary_precision': 0.60294116, 'binary_recall': 0.42644873, 'binary_specificity': 0.98953897, 'binary_f1_score': 0.49956486}
confusion matrix:
       0    1
0  17878  189
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8841975, 'recall': 0.5475724, 'specificity': 0.5475724, 'f1': 0.5759692, 'auroc': 0.95962965, 'binary_precision': 0.8064516, 'binary_recall': 0.09615385, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.1718213}
confusion matrix:
      0   1
0  5940   6
1   235  25
early stop counter: 1
val acc:0.9693169593811035, best validation acc: 0.9724119305610657, corresponding to test acc:                         0.9611666202545166 / 0.9774411916732788
after epoch: 15,now: 2024-08-01 00:31:54.518372,epoch time: 0:19:29.384578,used: 4:51:10.515882,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9913913, 'precision': 0.9915241, 'recall': 0.9913974, 'specificity': 0.9913974, 'f1': 0.99139076, 'auroc': 0.9996251, 'binary_precision': 0.99978834, 'binary_recall': 0.9830032, 'binary_specificity': 0.99979156, 'binary_f1_score': 0.9913247}
confusion matrix:
       0      1
0  28781      6
1    490  28339
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.7869311, 'recall': 0.61811066, 'specificity': 0.61811066, 'f1': 0.66421205, 'auroc': 0.93763673, 'binary_precision': 0.601476, 'binary_recall': 0.24219911, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.34533897}
confusion matrix:
       0    1
0  17959  108
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7102622, 'recall': 0.51094985, 'specificity': 0.51094985, 'f1': 0.51122755, 'auroc': 0.95226073, 'binary_precision': 0.46153846, 'binary_recall': 0.023076924, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.043956045}
confusion matrix:
      0  1
0  5939  7
1   254  6
early stop counter: 2
val acc:0.9670224189758301, best validation acc: 0.9724119305610657, corresponding to test acc:                         0.9611666202545166 / 0.9774411916732788
after epoch: 16,now: 2024-08-01 00:51:45.928708,epoch time: 0:19:51.410336,used: 5:11:01.926218,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9924153, 'precision': 0.99246895, 'recall': 0.9924118, 'specificity': 0.9924118, 'f1': 0.9924151, 'auroc': 0.9997449, 'binary_precision': 0.9874996, 'binary_recall': 0.99746776, 'binary_specificity': 0.9873558, 'binary_f1_score': 0.99245864}
confusion matrix:
       0      1
0  28424    364
1     73  28755
---- Validation: 
scalar performance:
{'acc': 0.9179296, 'precision': 0.639614, 'recall': 0.88662475, 'specificity': 0.88662475, 'f1': 0.69159913, 'auroc': 0.943136, 'binary_precision': 0.28514653, 'binary_recall': 0.85289747, 'binary_specificity': 0.92035204, 'binary_f1_score': 0.4274013}
confusion matrix:
       0     1
0  16628  1439
1     99   574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7539799, 'recall': 0.9202981, 'specificity': 0.9202981, 'f1': 0.8132726, 'auroc': 0.96123314, 'binary_precision': 0.5135135, 'binary_recall': 0.8769231, 'binary_specificity': 0.96367306, 'binary_f1_score': 0.64772725}
confusion matrix:
      0    1
0  5730  216
1    32  228
early stop counter: 3
val acc:0.9179295897483826, best validation acc: 0.9724119305610657, corresponding to test acc:                         0.9611666202545166 / 0.9774411916732788
after epoch: 17,now: 2024-08-01 01:10:55.749625,epoch time: 0:19:09.820917,used: 5:30:11.747135,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9947758, 'precision': 0.9947909, 'recall': 0.99477375, 'specificity': 0.99477375, 'f1': 0.99477565, 'auroc': 0.99988055, 'binary_precision': 0.9922358, 'binary_recall': 0.99736387, 'binary_specificity': 0.9921837, 'binary_f1_score': 0.9947932}
confusion matrix:
       0      1
0  28561    225
1     76  28754
---- Validation: 
scalar performance:
{'acc': 0.9524013, 'precision': 0.70213693, 'recall': 0.8658782, 'specificity': 0.8658782, 'f1': 0.75660473, 'auroc': 0.94787097, 'binary_precision': 0.4130262, 'binary_recall': 0.7726597, 'binary_specificity': 0.95909667, 'binary_f1_score': 0.5383023}
confusion matrix:
       0    1
0  17328  739
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.8280884, 'recall': 0.8593191, 'specificity': 0.8593191, 'f1': 0.84290636, 'auroc': 0.95807207, 'binary_precision': 0.6678322, 'binary_recall': 0.7346154, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.6996337}
confusion matrix:
      0    1
0  5851   95
1    69  191
early stop counter: 4
val acc:0.9524012804031372, best validation acc: 0.9724119305610657, corresponding to test acc:                         0.9611666202545166 / 0.9774411916732788
after epoch: 18,now: 2024-08-01 01:29:58.075541,epoch time: 0:19:02.325916,used: 5:49:14.073051,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9955915, 'precision': 0.995605, 'recall': 0.99558973, 'specificity': 0.99558973, 'f1': 0.99559146, 'auroc': 0.99989617, 'binary_precision': 0.99319965, 'binary_recall': 0.9980228, 'binary_specificity': 0.9931566, 'binary_f1_score': 0.9956054}
confusion matrix:
       0      1
0  28590    197
1     57  28772
---- Validation: 
scalar performance:
{'acc': 0.95816433, 'precision': 0.71715015, 'recall': 0.8266663, 'specificity': 0.8266663, 'f1': 0.75926507, 'auroc': 0.9493152, 'binary_precision': 0.446273, 'binary_recall': 0.68499255, 'binary_specificity': 0.96834004, 'binary_f1_score': 0.5404455}
confusion matrix:
       0    1
0  17495  572
1    212  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.75056416, 'recall': 0.6183679, 'specificity': 0.6183679, 'f1': 0.657949, 'auroc': 0.95187116, 'binary_precision': 0.53333336, 'binary_recall': 0.24615385, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.33684212}
confusion matrix:
      0   1
0  5890  56
1   196  64
early stop counter: 5
val acc:0.9581643342971802, best validation acc: 0.9724119305610657, corresponding to test acc:                         0.9611666202545166 / 0.9774411916732788
after epoch: 19,now: 2024-08-01 01:49:05.808598,epoch time: 0:19:07.733057,used: 6:08:21.806108,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99401206, 'precision': 0.9940125, 'recall': 0.9940126, 'specificity': 0.9940126, 'f1': 0.9940121, 'auroc': 0.9996449, 'binary_precision': 0.9946858, 'binary_recall': 0.99334025, 'binary_specificity': 0.99468493, 'binary_f1_score': 0.9940126}
confusion matrix:
       0      1
0  28633    153
1    192  28638
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7446448, 'recall': 0.806988, 'specificity': 0.806988, 'f1': 0.7718375, 'auroc': 0.94605803, 'binary_precision': 0.5029308, 'binary_recall': 0.63744426, 'binary_specificity': 0.9765318, 'binary_f1_score': 0.56225425}
confusion matrix:
       0    1
0  17643  424
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.74674296, 'recall': 0.6108438, 'specificity': 0.6108438, 'f1': 0.6498779, 'auroc': 0.92687726, 'binary_precision': 0.5263158, 'binary_recall': 0.23076923, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.32085562}
confusion matrix:
      0   1
0  5892  54
1   200  60
early stop counter: 6
val acc:0.9643543362617493, best validation acc: 0.9724119305610657, corresponding to test acc:                         0.9611666202545166 / 0.9774411916732788
after epoch: 20,now: 2024-08-01 02:08:28.853042,epoch time: 0:19:23.044444,used: 6:27:44.850552,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_19_40_43_seed_1_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:27:44.850552 at 2024-08-01 02:08:28.853042
persisted model performance metric: 

scalar performance:
{'acc': 0.9611666, 'precision': 0.8472, 'recall': 0.5567673, 'specificity': 0.5567673, 'f1': 0.58971816, 'auroc': 0.951734, 'binary_precision': 0.73170733, 'binary_recall': 0.115384616, 'binary_specificity': 0.99815, 'binary_f1_score': 0.19933553}
confusion matrix:
      0   1
0  5935  11
1   230  30
oracle model performance metric: 

scalar performance:
{'acc': 0.9774412, 'precision': 0.87025094, 'recall': 0.8374305, 'specificity': 0.8374305, 'f1': 0.85299647, 'auroc': 0.96520543, 'binary_precision': 0.7542373, 'binary_recall': 0.6846154, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.7177419}
confusion matrix:
      0    1
0  5888   58
1    82  178
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456826 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |  41675 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456826 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |  41675 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   1084 TiB |   1084 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  40676 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  28102 MiB |  13630 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  28014 MiB |  13608 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466821 KiB |   1235 MiB |    839 TiB |    839 TiB |
|       from large pool | 455249 KiB |   1232 MiB |    824 TiB |    824 TiB |
|       from small pool |  11572 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8207    |  216289 K  |  216285 K  |
|       from large pool |     187    |    1413    |  101512 K  |  101512 K  |
|       from small pool |    3277    |    8018    |  114777 K  |  114773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8207    |  216289 K  |  216285 K  |
|       from large pool |     187    |    1413    |  101512 K  |  101512 K  |
|       from small pool |    3277    |    8018    |  114777 K  |  114773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1212    |     577    |
|       from large pool |     602    |     602    |    1168    |     566    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |    3661    |  128853 K  |  128853 K  |
|       from large pool |      36    |     605    |   71590 K  |   71590 K  |
|       from small pool |      45    |    3625    |   57263 K  |   57263 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    839 TiB |    839 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     44 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  216289 K  |  216289 K  |
|       from large pool |       2    |    1413    |  101512 K  |  101512 K  |
|       from small pool |       0    |    8018    |  114777 K  |  114777 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  216289 K  |  216289 K  |
|       from large pool |       2    |    1413    |  101512 K  |  101512 K  |
|       from small pool |       0    |    8018    |  114777 K  |  114777 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3661    |  128855 K  |  128855 K  |
|       from large pool |       3    |     605    |   71590 K  |   71590 K  |
|       from small pool |       0    |    3625    |   57264 K  |   57264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1070 TiB |   1070 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    839 TiB |    839 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     44 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  216289 K  |  216289 K  |
|       from large pool |       2    |    1413    |  101512 K  |  101512 K  |
|       from small pool |       0    |    8018    |  114777 K  |  114777 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  216289 K  |  216289 K  |
|       from large pool |       2    |    1413    |  101512 K  |  101512 K  |
|       from small pool |       0    |    8018    |  114777 K  |  114777 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3661    |  128855 K  |  128855 K  |
|       from large pool |       3    |     605    |   71590 K  |   71590 K  |
|       from small pool |       0    |    3625    |   57264 K  |   57264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233

 Experiment start at: 2024-08-01 02:16:06.865105
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9848038, 'precision': 0.9850038, 'recall': 0.98480517, 'specificity': 0.98480517, 'f1': 0.98480225, 'auroc': 0.9983577, 'binary_precision': 0.9948883, 'binary_recall': 0.97461927, 'binary_specificity': 0.99499106, 'binary_f1_score': 0.98464954}
confusion matrix:
       0      1
0  29002    146
1    740  28416
---- Validation: 
scalar performance:
{'acc': 0.9496085, 'precision': 0.66665655, 'recall': 0.799708, 'specificity': 0.799708, 'f1': 0.7111578, 'auroc': 0.90737927, 'binary_precision': 0.34560144, 'binary_recall': 0.6395349, 'binary_specificity': 0.9598811, 'binary_f1_score': 0.44871795}
confusion matrix:
       0    1
0  17442  729
1    217  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.77330446, 'recall': 0.82808757, 'specificity': 0.82808757, 'f1': 0.7978759, 'auroc': 0.91002524, 'binary_precision': 0.55972695, 'binary_recall': 0.677686, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.61308414}
confusion matrix:
      0    1
0  5868  129
1    78  164
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 02:36:46.499335,epoch time: 0:20:39.634230,used: 0:20:39.634230,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9726777, 'precision': 0.9740883, 'recall': 0.9726833, 'specificity': 0.9726833, 'f1': 0.97265756, 'auroc': 0.99917805, 'binary_precision': 1.0, 'binary_recall': 0.9453666, 'binary_specificity': 1.0, 'binary_f1_score': 0.97191614}
confusion matrix:
       0      1
0  29146      0
1   1593  27565
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7433388, 'recall': 0.5241465, 'specificity': 0.5241465, 'f1': 0.5373214, 'auroc': 0.9139905, 'binary_precision': 0.51724136, 'binary_recall': 0.049833886, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.09090909}
confusion matrix:
       0   1
0  18143  28
1    572  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.95567775, 'recall': 0.5371067, 'specificity': 0.5371067, 'f1': 0.55975705, 'auroc': 0.9114886, 'binary_precision': 0.94736844, 'binary_recall': 0.07438017, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.13793103}
confusion matrix:
      0   1
0  5996   1
1   224  18
better model found
persisted
after epoch: 2,now: 2024-08-01 02:56:45.433570,epoch time: 0:19:58.934235,used: 0:40:38.568465,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9913385, 'precision': 0.99135196, 'recall': 0.99133897, 'specificity': 0.99133897, 'f1': 0.99133843, 'auroc': 0.9993623, 'binary_precision': 0.9939659, 'binary_recall': 0.988682, 'binary_specificity': 0.99399596, 'binary_f1_score': 0.9913169}
confusion matrix:
       0      1
0  28972    175
1    330  28827
---- Validation: 
scalar performance:
{'acc': 0.96132743, 'precision': 0.70559466, 'recall': 0.779261, 'specificity': 0.779261, 'f1': 0.73610294, 'auroc': 0.9289381, 'binary_precision': 0.42512077, 'binary_recall': 0.58471763, 'binary_specificity': 0.9738044, 'binary_f1_score': 0.49230772}
confusion matrix:
       0    1
0  17695  476
1    250  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97146976, 'precision': 0.87107646, 'recall': 0.68774813, 'specificity': 0.68774813, 'f1': 0.746798, 'auroc': 0.91221625, 'binary_precision': 0.76666665, 'binary_recall': 0.38016528, 'binary_specificity': 0.995331, 'binary_f1_score': 0.50828725}
confusion matrix:
      0   1
0  5969  28
1   150  92
new oracle model saved
early stop counter: 1
val acc:0.9613274335861206, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9639365077018738 / 0.9714697599411011
after epoch: 3,now: 2024-08-01 03:16:45.879893,epoch time: 0:20:00.446323,used: 1:00:39.014788,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98145926, 'precision': 0.9819241, 'recall': 0.98145664, 'specificity': 0.98145664, 'f1': 0.9814547, 'auroc': 0.9995164, 'binary_precision': 0.96699935, 'binary_recall': 0.9969476, 'binary_specificity': 0.9659656, 'binary_f1_score': 0.9817451}
confusion matrix:
       0      1
0  28155    992
1     89  29068
---- Validation: 
scalar performance:
{'acc': 0.90603524, 'precision': 0.60848147, 'recall': 0.8486709, 'specificity': 0.8486709, 'f1': 0.64945865, 'auroc': 0.91569287, 'binary_precision': 0.22464456, 'binary_recall': 0.7873754, 'binary_specificity': 0.9099664, 'binary_f1_score': 0.34955752}
confusion matrix:
       0     1
0  16535  1636
1    128   474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9174547, 'precision': 0.64244473, 'recall': 0.8618903, 'specificity': 0.8618903, 'f1': 0.6925932, 'auroc': 0.916873, 'binary_precision': 0.2934947, 'binary_recall': 0.8016529, 'binary_specificity': 0.9221277, 'binary_f1_score': 0.42967886}
confusion matrix:
      0    1
0  5530  467
1    48  194
early stop counter: 2
val acc:0.9060352444648743, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9639365077018738 / 0.9714697599411011
after epoch: 4,now: 2024-08-01 03:36:41.512540,epoch time: 0:19:55.632647,used: 1:20:34.647435,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99200743, 'precision': 0.9920075, 'recall': 0.99200743, 'specificity': 0.99200743, 'f1': 0.9920074, 'auroc': 0.999573, 'binary_precision': 0.99227893, 'binary_recall': 0.9917344, 'binary_specificity': 0.9922805, 'binary_f1_score': 0.9920066}
confusion matrix:
       0      1
0  28922    225
1    241  28916
---- Validation: 
scalar performance:
{'acc': 0.883716, 'precision': 0.58728635, 'recall': 0.8242928, 'specificity': 0.8242928, 'f1': 0.6161033, 'auroc': 0.8899096, 'binary_precision': 0.1834201, 'binary_recall': 0.7607973, 'binary_specificity': 0.88778824, 'binary_f1_score': 0.29557922}
confusion matrix:
       0     1
0  16132  2039
1    144   458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7954801, 'precision': 0.5681743, 'recall': 0.82620025, 'specificity': 0.82620025, 'f1': 0.56378067, 'auroc': 0.901255, 'binary_precision': 0.14344828, 'binary_recall': 0.8595041, 'binary_specificity': 0.79289645, 'binary_f1_score': 0.2458629}
confusion matrix:
      0     1
0  4755  1242
1    34   208
early stop counter: 3
val acc:0.8837159872055054, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9639365077018738 / 0.9714697599411011
after epoch: 5,now: 2024-08-01 03:56:23.873366,epoch time: 0:19:42.360826,used: 1:40:17.008261,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9934996, 'precision': 0.99354494, 'recall': 0.9935001, 'specificity': 0.9935001, 'f1': 0.9934994, 'auroc': 0.9997028, 'binary_precision': 0.998303, 'binary_recall': 0.9886812, 'binary_specificity': 0.998319, 'binary_f1_score': 0.99346876}
confusion matrix:
       0      1
0  29100     49
1    330  28825
---- Validation: 
scalar performance:
{'acc': 0.9707559, 'precision': 0.7676333, 'recall': 0.7230997, 'specificity': 0.7230997, 'f1': 0.7431493, 'auroc': 0.9555808, 'binary_precision': 0.5531062, 'binary_recall': 0.45847178, 'binary_specificity': 0.9877277, 'binary_f1_score': 0.5013624}
confusion matrix:
       0    1
0  17948  223
1    326  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.968745, 'precision': 0.93386126, 'recall': 0.6090039, 'specificity': 0.6090039, 'f1': 0.6680728, 'auroc': 0.9512254, 'binary_precision': 0.89830506, 'binary_recall': 0.21900827, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.35215944}
confusion matrix:
      0   1
0  5991   6
1   189  53
better model found
persisted
after epoch: 6,now: 2024-08-01 04:16:02.534709,epoch time: 0:19:38.661343,used: 1:59:55.669604,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9898978, 'precision': 0.9899173, 'recall': 0.98989713, 'specificity': 0.98989713, 'f1': 0.98989767, 'auroc': 0.9994022, 'binary_precision': 0.98687756, 'binary_recall': 0.9930036, 'binary_specificity': 0.98679066, 'binary_f1_score': 0.9899311}
confusion matrix:
       0      1
0  28761    385
1    204  28954
---- Validation: 
scalar performance:
{'acc': 0.93597186, 'precision': 0.6417841, 'recall': 0.8263918, 'specificity': 0.8263918, 'f1': 0.6907505, 'auroc': 0.92080045, 'binary_precision': 0.29367262, 'binary_recall': 0.7093023, 'binary_specificity': 0.9434814, 'binary_f1_score': 0.4153696}
confusion matrix:
       0     1
0  17144  1027
1    175   427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90815836, 'precision': 0.621117, 'recall': 0.81343424, 'specificity': 0.81343424, 'f1': 0.6627866, 'auroc': 0.8851547, 'binary_precision': 0.2548148, 'binary_recall': 0.7107438, 'binary_specificity': 0.9161247, 'binary_f1_score': 0.37513632}
confusion matrix:
      0    1
0  5494  503
1    70  172
early stop counter: 1
val acc:0.9359718561172485, best validation acc: 0.9707558751106262, corresponding to test acc:                         0.9687449932098389 / 0.9714697599411011
after epoch: 7,now: 2024-08-01 04:35:53.841090,epoch time: 0:19:51.306381,used: 2:19:46.975985,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99516326, 'precision': 0.9951827, 'recall': 0.99516404, 'specificity': 0.99516404, 'f1': 0.9951632, 'auroc': 0.99982893, 'binary_precision': 0.9983433, 'binary_recall': 0.991975, 'binary_specificity': 0.99835306, 'binary_f1_score': 0.99514896}
confusion matrix:
       0      1
0  29097     48
1    234  28925
---- Validation: 
scalar performance:
{'acc': 0.97427154, 'precision': 0.8113119, 'recall': 0.72090054, 'specificity': 0.72090054, 'f1': 0.7577776, 'auroc': 0.9542273, 'binary_precision': 0.64066195, 'binary_recall': 0.4501661, 'binary_specificity': 0.991635, 'binary_f1_score': 0.52878046}
confusion matrix:
       0    1
0  18019  152
1    331  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.87056386, 'recall': 0.5285921, 'specificity': 0.5285921, 'f1': 0.54435194, 'auroc': 0.92388797, 'binary_precision': 0.7777778, 'binary_recall': 0.05785124, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1076923}
confusion matrix:
      0   1
0  5993   4
1   228  14
better model found
persisted
after epoch: 8,now: 2024-08-01 04:56:02.418063,epoch time: 0:20:08.576973,used: 2:39:55.552958,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99301934, 'precision': 0.9931021, 'recall': 0.99302006, 'specificity': 0.99302006, 'f1': 0.99301904, 'auroc': 0.9997598, 'binary_precision': 0.9995135, 'binary_recall': 0.98652035, 'binary_specificity': 0.9995197, 'binary_f1_score': 0.9929744}
confusion matrix:
       0      1
0  29135     14
1    393  28762
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.79503846, 'recall': 0.6016743, 'specificity': 0.6016743, 'f1': 0.64772666, 'auroc': 0.94000953, 'binary_precision': 0.61576355, 'binary_recall': 0.2076412, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.310559}
confusion matrix:
       0    1
0  18093   78
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.8226527, 'recall': 0.53040814, 'specificity': 0.53040814, 'f1': 0.547239, 'auroc': 0.94134545, 'binary_precision': 0.6818182, 'binary_recall': 0.06198347, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.11363636}
confusion matrix:
      0   1
0  5990   7
1   227  15
early stop counter: 1
val acc:0.9704362750053406, best validation acc: 0.9742715358734131, corresponding to test acc:                         0.9628145694732666 / 0.9714697599411011
after epoch: 9,now: 2024-08-01 05:16:04.432648,epoch time: 0:20:02.014585,used: 2:59:57.567543,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9888172, 'precision': 0.9889311, 'recall': 0.98881567, 'specificity': 0.98881567, 'f1': 0.98881656, 'auroc': 0.99969333, 'binary_precision': 0.9815203, 'binary_recall': 0.9963989, 'binary_specificity': 0.9812324, 'binary_f1_score': 0.98890364}
confusion matrix:
       0      1
0  28599    547
1    105  29053
---- Validation: 
scalar performance:
{'acc': 0.9283013, 'precision': 0.6281608, 'recall': 0.82082343, 'specificity': 0.82082343, 'f1': 0.6744955, 'auroc': 0.9284703, 'binary_precision': 0.26662484, 'binary_recall': 0.70598006, 'binary_specificity': 0.93566674, 'binary_f1_score': 0.3870674}
confusion matrix:
       0     1
0  17002  1169
1    177   425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8700112, 'precision': 0.588486, 'recall': 0.7975565, 'specificity': 0.7975565, 'f1': 0.6143047, 'auroc': 0.87292546, 'binary_precision': 0.18974918, 'binary_recall': 0.71900827, 'binary_specificity': 0.8761047, 'binary_f1_score': 0.30025885}
confusion matrix:
      0    1
0  5254  743
1    68  174
early stop counter: 2
val acc:0.9283012747764587, best validation acc: 0.9742715358734131, corresponding to test acc:                         0.9628145694732666 / 0.9714697599411011
after epoch: 10,now: 2024-08-01 05:36:06.886252,epoch time: 0:20:02.453604,used: 3:20:00.021147,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9942028, 'precision': 0.9942165, 'recall': 0.99420327, 'specificity': 0.99420327, 'f1': 0.9942028, 'auroc': 0.99973935, 'binary_precision': 0.9968622, 'binary_recall': 0.99152863, 'binary_specificity': 0.9968779, 'binary_f1_score': 0.99418825}
confusion matrix:
       0      1
0  29056     91
1    247  28910
---- Validation: 
scalar performance:
{'acc': 0.9519523, 'precision': 0.67610323, 'recall': 0.81296444, 'specificity': 0.81296444, 'f1': 0.72243536, 'auroc': 0.93367517, 'binary_precision': 0.36363637, 'binary_recall': 0.66445184, 'binary_specificity': 0.9614771, 'binary_f1_score': 0.47003525}
confusion matrix:
       0    1
0  17471  700
1    202  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9382914, 'precision': 0.66774154, 'recall': 0.8152296, 'specificity': 0.8152296, 'f1': 0.71440434, 'auroc': 0.90367895, 'binary_precision': 0.3488372, 'binary_recall': 0.6818182, 'binary_specificity': 0.948641, 'binary_f1_score': 0.46153843}
confusion matrix:
      0    1
0  5689  308
1    77  165
early stop counter: 3
val acc:0.9519522786140442, best validation acc: 0.9742715358734131, corresponding to test acc:                         0.9628145694732666 / 0.9714697599411011
after epoch: 11,now: 2024-08-01 05:56:40.451696,epoch time: 0:20:33.565444,used: 3:40:33.586591,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.996038, 'precision': 0.99603814, 'recall': 0.9960381, 'specificity': 0.9960381, 'f1': 0.9960381, 'auroc': 0.9998392, 'binary_precision': 0.99632794, 'binary_recall': 0.995747, 'binary_specificity': 0.99632907, 'binary_f1_score': 0.9960374}
confusion matrix:
       0      1
0  29041    107
1    124  29032
---- Validation: 
scalar performance:
{'acc': 0.96580195, 'precision': 0.73355055, 'recall': 0.8361797, 'specificity': 0.8361797, 'f1': 0.7745, 'auroc': 0.9568316, 'binary_precision': 0.47727272, 'binary_recall': 0.6976744, 'binary_specificity': 0.97468495, 'binary_f1_score': 0.5668016}
confusion matrix:
       0    1
0  17711  460
1    182  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713095, 'precision': 0.8221785, 'recall': 0.75904346, 'specificity': 0.75904346, 'f1': 0.7868212, 'auroc': 0.9315243, 'binary_precision': 0.6632124, 'binary_recall': 0.5289256, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.58850574}
confusion matrix:
      0    1
0  5932   65
1   114  128
early stop counter: 4
val acc:0.9658019542694092, best validation acc: 0.9742715358734131, corresponding to test acc:                         0.9628145694732666 / 0.9714697599411011
after epoch: 12,now: 2024-08-01 06:16:41.735010,epoch time: 0:20:01.283314,used: 4:00:34.869905,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9944772, 'precision': 0.9945242, 'recall': 0.99447787, 'specificity': 0.99447787, 'f1': 0.99447715, 'auroc': 0.9998268, 'binary_precision': 0.99937654, 'binary_recall': 0.9895733, 'binary_specificity': 0.99938244, 'binary_f1_score': 0.9944508}
confusion matrix:
       0      1
0  29130     18
1    304  28852
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.8382121, 'recall': 0.5663402, 'specificity': 0.5663402, 'f1': 0.6054359, 'auroc': 0.9500427, 'binary_precision': 0.70434785, 'binary_recall': 0.1345515, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.22594142}
confusion matrix:
       0   1
0  18137  34
1    521  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.9458102, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
early stop counter: 5
val acc:0.9704362750053406, best validation acc: 0.9742715358734131, corresponding to test acc:                         0.9628145694732666 / 0.9714697599411011
after epoch: 13,now: 2024-08-01 06:36:36.544807,epoch time: 0:19:54.809797,used: 4:20:29.679702,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99502605, 'precision': 0.99506295, 'recall': 0.9950268, 'specificity': 0.9950268, 'f1': 0.995026, 'auroc': 0.99980474, 'binary_precision': 0.99937725, 'binary_recall': 0.9906712, 'binary_specificity': 0.99938244, 'binary_f1_score': 0.9950052}
confusion matrix:
       0      1
0  29129     18
1    272  28885
---- Validation: 
scalar performance:
{'acc': 0.9760827, 'precision': 0.82525206, 'recall': 0.74994284, 'specificity': 0.74994284, 'f1': 0.782254, 'auroc': 0.9576882, 'binary_precision': 0.6666667, 'binary_recall': 0.50830567, 'binary_specificity': 0.99158, 'binary_f1_score': 0.5768144}
confusion matrix:
       0    1
0  18018  153
1    296  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.8514668, 'recall': 0.5346237, 'specificity': 0.5346237, 'f1': 0.5546938, 'auroc': 0.95050776, 'binary_precision': 0.73913044, 'binary_recall': 0.07024793, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.12830187}
confusion matrix:
      0   1
0  5991   6
1   225  17
better model found
persisted
after epoch: 14,now: 2024-08-01 06:56:32.913614,epoch time: 0:19:56.368807,used: 4:40:26.048509,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9916815, 'precision': 0.9917445, 'recall': 0.9916827, 'specificity': 0.9916827, 'f1': 0.9916812, 'auroc': 0.9995109, 'binary_precision': 0.9973634, 'binary_recall': 0.985973, 'binary_specificity': 0.9973924, 'binary_f1_score': 0.99163544}
confusion matrix:
       0      1
0  29070     76
1    409  28749
---- Validation: 
scalar performance:
{'acc': 0.9570127, 'precision': 0.6339633, 'recall': 0.61080116, 'specificity': 0.61080116, 'f1': 0.6211084, 'auroc': 0.90439904, 'binary_precision': 0.2929293, 'binary_recall': 0.24086379, 'binary_specificity': 0.9807385, 'binary_f1_score': 0.26435733}
confusion matrix:
       0    1
0  17821  350
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548004, 'precision': 0.4924599, 'recall': 0.49864772, 'specificity': 0.49864772, 'f1': 0.49195805, 'auroc': 0.91274595, 'binary_precision': 0.023809524, 'binary_recall': 0.004132231, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.007042253}
confusion matrix:
      0   1
0  5956  41
1   241   1
early stop counter: 1
val acc:0.9570127129554749, best validation acc: 0.9760826826095581, corresponding to test acc:                         0.9629748463630676 / 0.9714697599411011
after epoch: 15,now: 2024-08-01 07:16:16.678710,epoch time: 0:19:43.765096,used: 5:00:09.813605,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9947688, 'precision': 0.994774, 'recall': 0.9947686, 'specificity': 0.9947686, 'f1': 0.99476886, 'auroc': 0.99982655, 'binary_precision': 0.9931961, 'binary_recall': 0.99636424, 'binary_specificity': 0.993173, 'binary_f1_score': 0.9947777}
confusion matrix:
       0      1
0  28950    199
1    106  29049
---- Validation: 
scalar performance:
{'acc': 0.9410856, 'precision': 0.660264, 'recall': 0.8707919, 'specificity': 0.8707919, 'f1': 0.7164883, 'auroc': 0.94062614, 'binary_precision': 0.32763338, 'binary_recall': 0.79568106, 'binary_specificity': 0.9459028, 'binary_f1_score': 0.4641473}
confusion matrix:
       0    1
0  17188  983
1    123  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.974996, 'precision': 0.8204713, 'recall': 0.87596, 'specificity': 0.87596, 'f1': 0.84574556, 'auroc': 0.95350796, 'binary_precision': 0.6503497, 'binary_recall': 0.76859504, 'binary_specificity': 0.983325, 'binary_f1_score': 0.7045455}
confusion matrix:
      0    1
0  5897  100
1    56  186
new oracle model saved
early stop counter: 2
val acc:0.9410855770111084, best validation acc: 0.9760826826095581, corresponding to test acc:                         0.9629748463630676 / 0.9749959707260132
after epoch: 16,now: 2024-08-01 07:35:57.659820,epoch time: 0:19:40.981110,used: 5:19:50.794715,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9944944, 'precision': 0.99452984, 'recall': 0.9944956, 'specificity': 0.9944956, 'f1': 0.9944943, 'auroc': 0.99964577, 'binary_precision': 0.9987893, 'binary_recall': 0.99019206, 'binary_specificity': 0.9987991, 'binary_f1_score': 0.9944721}
confusion matrix:
       0      1
0  29109     35
1    286  28874
---- Validation: 
scalar performance:
{'acc': 0.9631385, 'precision': 0.71411294, 'recall': 0.7753783, 'specificity': 0.7753783, 'f1': 0.7404319, 'auroc': 0.9414426, 'binary_precision': 0.44245523, 'binary_recall': 0.57475084, 'binary_specificity': 0.97600573, 'binary_f1_score': 0.5}
confusion matrix:
       0    1
0  17735  436
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9770797, 'precision': 0.8702992, 'recall': 0.79773426, 'specificity': 0.79773426, 'f1': 0.8296951, 'auroc': 0.9498866, 'binary_precision': 0.7564767, 'binary_recall': 0.60330576, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.67126435}
confusion matrix:
      0    1
0  5950   47
1    96  146
new oracle model saved
early stop counter: 3
val acc:0.9631385207176208, best validation acc: 0.9760826826095581, corresponding to test acc:                         0.9629748463630676 / 0.9770796895027161
after epoch: 17,now: 2024-08-01 07:55:41.309767,epoch time: 0:19:43.649947,used: 5:39:34.444662,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9967755, 'precision': 0.9967905, 'recall': 0.99677587, 'specificity': 0.99677587, 'f1': 0.9967755, 'auroc': 0.999915, 'binary_precision': 0.99955165, 'binary_recall': 0.9939978, 'binary_specificity': 0.999554, 'binary_f1_score': 0.996767}
confusion matrix:
       0      1
0  29135     13
1    175  28981
---- Validation: 
scalar performance:
{'acc': 0.97272676, 'precision': 0.8025858, 'recall': 0.68235934, 'specificity': 0.68235934, 'f1': 0.7263361, 'auroc': 0.9504796, 'binary_precision': 0.6256983, 'binary_recall': 0.37209302, 'binary_specificity': 0.9926256, 'binary_f1_score': 0.46666667}
confusion matrix:
       0    1
0  18037  134
1    378  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586472, 'precision': 0.5641861, 'recall': 0.506597, 'specificity': 0.506597, 'f1': 0.5044742, 'auroc': 0.9238798, 'binary_precision': 0.16666667, 'binary_recall': 0.016528925, 'binary_specificity': 0.996665, 'binary_f1_score': 0.030075189}
confusion matrix:
      0   1
0  5977  20
1   238   4
early stop counter: 4
val acc:0.9727267622947693, best validation acc: 0.9760826826095581, corresponding to test acc:                         0.9629748463630676 / 0.9770796895027161
after epoch: 18,now: 2024-08-01 08:15:21.707299,epoch time: 0:19:40.397532,used: 5:59:14.842194,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99272776, 'precision': 0.9927294, 'recall': 0.992728, 'specificity': 0.992728, 'f1': 0.99272776, 'auroc': 0.9996495, 'binary_precision': 0.99367744, 'binary_recall': 0.99176896, 'binary_specificity': 0.993687, 'binary_f1_score': 0.9927223}
confusion matrix:
       0      1
0  28962    184
1    240  28918
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.7607727, 'recall': 0.67519706, 'specificity': 0.67519706, 'f1': 0.7087954, 'auroc': 0.9563314, 'binary_precision': 0.5425, 'binary_recall': 0.3604651, 'binary_specificity': 0.989929, 'binary_f1_score': 0.43313375}
confusion matrix:
       0    1
0  17988  183
1    385  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.91008115, 'recall': 0.5943743, 'specificity': 0.5943743, 'f1': 0.6470324, 'auroc': 0.9544214, 'binary_precision': 0.8518519, 'binary_recall': 0.19008264, 'binary_specificity': 0.998666, 'binary_f1_score': 0.31081083}
confusion matrix:
      0   1
0  5989   8
1   196  46
early stop counter: 5
val acc:0.9697437882423401, best validation acc: 0.9760826826095581, corresponding to test acc:                         0.9629748463630676 / 0.9770796895027161
after epoch: 19,now: 2024-08-01 08:35:01.721359,epoch time: 0:19:40.014060,used: 6:18:54.856254,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9962781, 'precision': 0.9962992, 'recall': 0.99627876, 'specificity': 0.99627876, 'f1': 0.9962781, 'auroc': 0.9998895, 'binary_precision': 0.9995857, 'binary_recall': 0.99296933, 'binary_specificity': 0.99958825, 'binary_f1_score': 0.99626654}
confusion matrix:
       0      1
0  29134     12
1    205  28953
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.7585528, 'recall': 0.6339939, 'specificity': 0.6339939, 'f1': 0.6747438, 'auroc': 0.94621027, 'binary_precision': 0.5407166, 'binary_recall': 0.2757475, 'binary_specificity': 0.99224037, 'binary_f1_score': 0.36523655}
confusion matrix:
       0    1
0  18030  141
1    436  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.6957702, 'recall': 0.5234594, 'specificity': 0.5234594, 'f1': 0.5343691, 'auroc': 0.9168081, 'binary_precision': 0.42857143, 'binary_recall': 0.049586777, 'binary_specificity': 0.997332, 'binary_f1_score': 0.08888889}
confusion matrix:
      0   1
0  5981  16
1   230  12
early stop counter: 6
val acc:0.9692643880844116, best validation acc: 0.9760826826095581, corresponding to test acc:                         0.9629748463630676 / 0.9770796895027161
after epoch: 20,now: 2024-08-01 08:55:21.367319,epoch time: 0:20:19.645960,used: 6:39:14.502214,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_02_16_06_seed_2_23857233
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:39:14.502214 at 2024-08-01 08:55:21.367319
persisted model performance metric: 

scalar performance:
{'acc': 0.96297485, 'precision': 0.8514668, 'recall': 0.5346237, 'specificity': 0.5346237, 'f1': 0.5546938, 'auroc': 0.95050776, 'binary_precision': 0.73913044, 'binary_recall': 0.07024793, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.12830187}
confusion matrix:
      0   1
0  5991   6
1   225  17
oracle model performance metric: 

scalar performance:
{'acc': 0.9770797, 'precision': 0.8702992, 'recall': 0.79773426, 'specificity': 0.79773426, 'f1': 0.8296951, 'auroc': 0.9498866, 'binary_precision': 0.7564767, 'binary_recall': 0.60330576, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.67126435}
confusion matrix:
      0    1
0  5950   47
1    96  146
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456832 KiB |  13220 MiB |   1655 TiB |   1655 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1633 TiB |   1633 TiB |
|       from small pool |  41681 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456832 KiB |  13220 MiB |   1655 TiB |   1655 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1633 TiB |   1633 TiB |
|       from small pool |  41681 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   1654 TiB |   1654 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1631 TiB |   1631 TiB |
|       from small pool |  40678 KiB |     60 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  41672 MiB |  27200 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  41570 MiB |  27164 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466815 KiB |   1235 MiB |   1264 TiB |   1264 TiB |
|       from large pool | 455249 KiB |   1232 MiB |   1242 TiB |   1242 TiB |
|       from small pool |  11566 KiB |     44 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8293    |  328774 K  |  328771 K  |
|       from large pool |     187    |    1413    |  154813 K  |  154812 K  |
|       from small pool |    3289    |    8104    |  173961 K  |  173958 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8293    |  328774 K  |  328771 K  |
|       from large pool |     187    |    1413    |  154813 K  |  154812 K  |
|       from small pool |    3289    |    8104    |  173961 K  |  173958 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1783    |    1148    |
|       from large pool |     602    |     602    |    1732    |    1130    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    3704    |  195705 K  |  195705 K  |
|       from large pool |      36    |     605    |  107973 K  |  107973 K  |
|       from small pool |      42    |    3668    |   87731 K  |   87731 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1655 TiB |   1655 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1633 TiB |   1633 TiB |
|       from small pool |      0 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1655 TiB |   1655 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1633 TiB |   1633 TiB |
|       from small pool |      0 KiB |     61 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1654 TiB |   1654 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1631 TiB |   1631 TiB |
|       from small pool |      0 KiB |     60 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  41672 MiB |  40770 MiB |
|       from large pool |    850 MiB |  14412 MiB |  41570 MiB |  40720 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |   1264 TiB |   1264 TiB |
|       from large pool |  24320 KiB |   1232 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     46 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8293    |  328774 K  |  328774 K  |
|       from large pool |       2    |    1413    |  154813 K  |  154813 K  |
|       from small pool |       0    |    8104    |  173961 K  |  173961 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8293    |  328774 K  |  328774 K  |
|       from large pool |       2    |    1413    |  154813 K  |  154813 K  |
|       from small pool |       0    |    8104    |  173961 K  |  173961 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1783    |    1719    |
|       from large pool |      38    |     602    |    1732    |    1694    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3704    |  195706 K  |  195706 K  |
|       from large pool |       3    |     605    |  107973 K  |  107973 K  |
|       from small pool |       0    |    3668    |   87733 K  |   87733 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 08:56:42 2024]
Finished job 0.
1 of 1 steps (100%) done
