Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 14:15:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396

 Experiment start at: 2024-07-31 14:24:29.952236
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9820084, 'precision': 0.9820832, 'recall': 0.98200333, 'specificity': 0.98200333, 'f1': 0.9820075, 'auroc': 0.9986378, 'binary_precision': 0.9762823, 'binary_recall': 0.98805046, 'binary_specificity': 0.97595614, 'binary_f1_score': 0.9821311}
confusion matrix:
       0      1
0  27967    689
1    343  28361
---- Validation: 
scalar performance:
{'acc': 0.9423159, 'precision': 0.6732814, 'recall': 0.88537985, 'specificity': 0.88537985, 'f1': 0.731908, 'auroc': 0.9366825, 'binary_precision': 0.35309795, 'binary_recall': 0.82426125, 'binary_specificity': 0.94649845, 'binary_f1_score': 0.49440297}
confusion matrix:
       0    1
0  17178  971
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7441764, 'recall': 0.8791263, 'specificity': 0.8791263, 'f1': 0.79465336, 'auroc': 0.9350512, 'binary_precision': 0.49759614, 'binary_recall': 0.79310346, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.6115214}
confusion matrix:
      0    1
0  5788  209
1    54  207
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 14:40:33.213252,epoch time: 0:16:03.261016,used: 0:16:03.261016,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98680264, 'precision': 0.986961, 'recall': 0.9868103, 'specificity': 0.9868103, 'f1': 0.9868017, 'auroc': 0.99919856, 'binary_precision': 0.99595386, 'binary_recall': 0.97759897, 'binary_specificity': 0.99602175, 'binary_f1_score': 0.98669106}
confusion matrix:
       0      1
0  28542    114
1    643  28061
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7524196, 'recall': 0.7039813, 'specificity': 0.7039813, 'f1': 0.7253528, 'auroc': 0.92646366, 'binary_precision': 0.5251938, 'binary_recall': 0.4214619, 'binary_specificity': 0.9865006, 'binary_f1_score': 0.4676445}
confusion matrix:
       0    1
0  17904  245
1    372  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98162353, 'precision': 0.93252087, 'recall': 0.8218372, 'specificity': 0.8218372, 'f1': 0.86830175, 'auroc': 0.94291115, 'binary_precision': 0.8802083, 'binary_recall': 0.6475096, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.7461369}
confusion matrix:
      0    1
0  5974   23
1    92  169
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 14:55:14.019890,epoch time: 0:14:40.806638,used: 0:30:44.067654,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9882845, 'precision': 0.9884075, 'recall': 0.9882919, 'specificity': 0.9882919, 'f1': 0.9882839, 'auroc': 0.99908483, 'binary_precision': 0.99638784, 'binary_recall': 0.98014355, 'binary_specificity': 0.9964403, 'binary_f1_score': 0.98819894}
confusion matrix:
       0      1
0  28552    102
1    570  28136
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.79007316, 'recall': 0.6739115, 'specificity': 0.6739115, 'f1': 0.71612465, 'auroc': 0.95002246, 'binary_precision': 0.60263157, 'binary_recall': 0.3561431, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.44770283}
confusion matrix:
       0    1
0  17998  151
1    414  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.9108699, 'recall': 0.7185556, 'specificity': 0.7185556, 'f1': 0.78278255, 'auroc': 0.9333897, 'binary_precision': 0.8455882, 'binary_recall': 0.44061303, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.5793451}
confusion matrix:
      0    1
0  5976   21
1   146  115
better model found
persisted
after epoch: 3,now: 2024-07-31 15:10:22.085565,epoch time: 0:15:08.065675,used: 0:45:52.133329,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98826706, 'precision': 0.9885097, 'recall': 0.9882766, 'specificity': 0.9882766, 'f1': 0.9882658, 'auroc': 0.99954534, 'binary_precision': 0.99960786, 'binary_recall': 0.976937, 'binary_specificity': 0.99961615, 'binary_f1_score': 0.98814243}
confusion matrix:
       0      1
0  28645     11
1    662  28042
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.74208057, 'recall': 0.551864, 'specificity': 0.551864, 'f1': 0.5801227, 'auroc': 0.9348086, 'binary_precision': 0.51492536, 'binary_recall': 0.10730949, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.1776062}
confusion matrix:
       0   1
0  18084  65
1    574  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.97999036, 'recall': 0.5210728, 'specificity': 0.5210728, 'f1': 0.53023213, 'auroc': 0.9498339, 'binary_precision': 1.0, 'binary_recall': 0.042145595, 'binary_specificity': 1.0, 'binary_f1_score': 0.080882356}
confusion matrix:
      0   1
0  5997   0
1   250  11
early stop counter: 1
val acc:0.9659961462020874, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9733141660690308 / 0.9816235303878784
after epoch: 4,now: 2024-07-31 15:24:59.633349,epoch time: 0:14:37.547784,used: 1:00:29.681113,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9911088, 'precision': 0.9911488, 'recall': 0.9911124, 'specificity': 0.9911124, 'f1': 0.9911086, 'auroc': 0.9992454, 'binary_precision': 0.9957794, 'binary_recall': 0.9864121, 'binary_specificity': 0.9958127, 'binary_f1_score': 0.99107355}
confusion matrix:
       0      1
0  28538    120
1    390  28312
---- Validation: 
scalar performance:
{'acc': 0.948063, 'precision': 0.65028936, 'recall': 0.7128423, 'specificity': 0.7128423, 'f1': 0.675226, 'auroc': 0.91953385, 'binary_precision': 0.32, 'binary_recall': 0.46034214, 'binary_specificity': 0.96534246, 'binary_f1_score': 0.37755102}
confusion matrix:
       0    1
0  17520  629
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8460262, 'recall': 0.61868864, 'specificity': 0.61868864, 'f1': 0.6719122, 'auroc': 0.9503564, 'binary_precision': 0.7241379, 'binary_recall': 0.2413793, 'binary_specificity': 0.995998, 'binary_f1_score': 0.36206895}
confusion matrix:
      0   1
0  5973  24
1   198  63
early stop counter: 2
val acc:0.9480630159378052, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9733141660690308 / 0.9816235303878784
after epoch: 5,now: 2024-07-31 15:39:18.634210,epoch time: 0:14:19.000861,used: 1:14:48.681974,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9928173, 'precision': 0.9928943, 'recall': 0.99282247, 'specificity': 0.99282247, 'f1': 0.9928171, 'auroc': 0.99963325, 'binary_precision': 0.9992588, 'binary_recall': 0.9863777, 'binary_specificity': 0.9992672, 'binary_f1_score': 0.9927765}
confusion matrix:
       0      1
0  28636     21
1    391  28312
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.8180529, 'recall': 0.6526834, 'specificity': 0.6526834, 'f1': 0.7039652, 'auroc': 0.9382137, 'binary_precision': 0.660066, 'binary_recall': 0.31104198, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.422833}
confusion matrix:
       0    1
0  18046  103
1    443  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.6432431, 'recall': 0.526151, 'specificity': 0.526151, 'f1': 0.5375158, 'auroc': 0.89098513, 'binary_precision': 0.32608697, 'binary_recall': 0.057471264, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.09771986}
confusion matrix:
      0   1
0  5966  31
1   246  15
better model found
persisted
after epoch: 6,now: 2024-07-31 15:54:15.341767,epoch time: 0:14:56.707557,used: 1:29:45.389531,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98908645, 'precision': 0.9892714, 'recall': 0.9890937, 'specificity': 0.9890937, 'f1': 0.98908556, 'auroc': 0.9994484, 'binary_precision': 0.9989692, 'binary_recall': 0.97919935, 'binary_specificity': 0.9989881, 'binary_f1_score': 0.98898554}
confusion matrix:
       0      1
0  28630     29
1    597  28104
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.8285178, 'recall': 0.5703826, 'specificity': 0.5703826, 'f1': 0.6103486, 'auroc': 0.9487859, 'binary_precision': 0.6865672, 'binary_recall': 0.14307931, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.23680824}
confusion matrix:
       0   1
0  18107  42
1    551  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.96532273, 'recall': 0.5573879, 'specificity': 0.5573879, 'f1': 0.5932502, 'auroc': 0.9555318, 'binary_precision': 0.9677419, 'binary_recall': 0.11494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.20547946}
confusion matrix:
      0   1
0  5996   1
1   231  30
early stop counter: 1
val acc:0.9684439897537231, best validation acc: 0.9709450602531433, corresponding to test acc:                         0.9557366371154785 / 0.9816235303878784
after epoch: 7,now: 2024-07-31 16:08:42.618355,epoch time: 0:14:27.276588,used: 1:44:12.666119,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9898187, 'precision': 0.9898342, 'recall': 0.98981655, 'specificity': 0.98981655, 'f1': 0.9898186, 'auroc': 0.99935484, 'binary_precision': 0.9872808, 'binary_recall': 0.9924401, 'binary_specificity': 0.9871929, 'binary_f1_score': 0.98985374}
confusion matrix:
       0      1
0  28289    367
1    217  28487
---- Validation: 
scalar performance:
{'acc': 0.96227115, 'precision': 0.7206624, 'recall': 0.7637013, 'specificity': 0.7637013, 'f1': 0.7400218, 'auroc': 0.931303, 'binary_precision': 0.45736435, 'binary_recall': 0.5505443, 'binary_specificity': 0.97685826, 'binary_f1_score': 0.49964714}
confusion matrix:
       0    1
0  17729  420
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8160391, 'recall': 0.7787706, 'specificity': 0.7787706, 'f1': 0.79609895, 'auroc': 0.9277319, 'binary_precision': 0.65065503, 'binary_recall': 0.57088125, 'binary_specificity': 0.98666, 'binary_f1_score': 0.6081633}
confusion matrix:
      0    1
0  5917   80
1   112  149
early stop counter: 2
val acc:0.9622711539268494, best validation acc: 0.9709450602531433, corresponding to test acc:                         0.9557366371154785 / 0.9816235303878784
after epoch: 8,now: 2024-07-31 16:23:05.056827,epoch time: 0:14:22.438472,used: 1:58:35.104591,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9928173, 'precision': 0.99283206, 'recall': 0.99281526, 'specificity': 0.99281526, 'f1': 0.9928172, 'auroc': 0.9996395, 'binary_precision': 0.99032897, 'binary_recall': 0.99536633, 'binary_specificity': 0.9902642, 'binary_f1_score': 0.99284124}
confusion matrix:
       0      1
0  28378    279
1    133  28570
---- Validation: 
scalar performance:
{'acc': 0.9509898, 'precision': 0.6859054, 'recall': 0.8321162, 'specificity': 0.8321162, 'f1': 0.73506886, 'auroc': 0.93478394, 'binary_precision': 0.38260135, 'binary_recall': 0.7045101, 'binary_specificity': 0.9597223, 'binary_f1_score': 0.49589488}
confusion matrix:
       0    1
0  17418  731
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9399169, 'precision': 0.6891651, 'recall': 0.858711, 'specificity': 0.858711, 'f1': 0.7423384, 'auroc': 0.9384336, 'binary_precision': 0.38878143, 'binary_recall': 0.77011496, 'binary_specificity': 0.947307, 'binary_f1_score': 0.51670945}
confusion matrix:
      0    1
0  5681  316
1    60  201
early stop counter: 3
val acc:0.9509897828102112, best validation acc: 0.9709450602531433, corresponding to test acc:                         0.9557366371154785 / 0.9816235303878784
after epoch: 9,now: 2024-07-31 16:37:26.887806,epoch time: 0:14:21.830979,used: 2:12:56.935570,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9933577, 'precision': 0.9933678, 'recall': 0.9933559, 'specificity': 0.9933559, 'f1': 0.99335766, 'auroc': 0.99973, 'binary_precision': 0.9913611, 'binary_recall': 0.9954017, 'binary_specificity': 0.9913101, 'binary_f1_score': 0.99337727}
confusion matrix:
       0      1
0  28405    249
1    132  28574
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.7658205, 'recall': 0.8003403, 'specificity': 0.8003403, 'f1': 0.781909, 'auroc': 0.96108395, 'binary_precision': 0.5452055, 'binary_recall': 0.61897355, 'binary_specificity': 0.981707, 'binary_f1_score': 0.5797523}
confusion matrix:
       0    1
0  17817  332
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8648657, 'recall': 0.56804836, 'specificity': 0.56804836, 'f1': 0.6072173, 'auroc': 0.9471345, 'binary_precision': 0.7659575, 'binary_recall': 0.13793103, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.23376623}
confusion matrix:
      0   1
0  5986  11
1   225  36
early stop counter: 4
val acc:0.9692954421043396, best validation acc: 0.9709450602531433, corresponding to test acc:                         0.9557366371154785 / 0.9816235303878784
after epoch: 10,now: 2024-07-31 16:51:55.210235,epoch time: 0:14:28.322429,used: 2:27:25.257999,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99077755, 'precision': 0.9908153, 'recall': 0.9907743, 'specificity': 0.9907743, 'f1': 0.9907773, 'auroc': 0.9996654, 'binary_precision': 0.986698, 'binary_recall': 0.9949829, 'binary_specificity': 0.9865657, 'binary_f1_score': 0.99082315}
confusion matrix:
       0      1
0  28273    385
1    144  28558
---- Validation: 
scalar performance:
{'acc': 0.9608344, 'precision': 0.72175574, 'recall': 0.8409632, 'specificity': 0.8409632, 'f1': 0.7669982, 'auroc': 0.9490694, 'binary_precision': 0.45391476, 'binary_recall': 0.7122862, 'binary_specificity': 0.9696402, 'binary_f1_score': 0.5544794}
confusion matrix:
       0    1
0  17598  551
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94694793, 'precision': 0.68195635, 'recall': 0.7176251, 'specificity': 0.7176251, 'f1': 0.69790274, 'auroc': 0.9202673, 'binary_precision': 0.3873016, 'binary_recall': 0.46743295, 'binary_specificity': 0.96781725, 'binary_f1_score': 0.42361113}
confusion matrix:
      0    1
0  5804  193
1   139  122
early stop counter: 5
val acc:0.9608343839645386, best validation acc: 0.9709450602531433, corresponding to test acc:                         0.9557366371154785 / 0.9816235303878784
after epoch: 11,now: 2024-07-31 17:06:13.694882,epoch time: 0:14:18.484647,used: 2:41:43.742646,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.993288, 'precision': 0.99331605, 'recall': 0.9932909, 'specificity': 0.9932909, 'f1': 0.9932879, 'auroc': 0.99968946, 'binary_precision': 0.9972255, 'binary_recall': 0.98933834, 'binary_specificity': 0.99724346, 'binary_f1_score': 0.9932662}
confusion matrix:
       0      1
0  28580     79
1    306  28395
---- Validation: 
scalar performance:
{'acc': 0.9590783, 'precision': 0.6919043, 'recall': 0.6967935, 'specificity': 0.6967935, 'f1': 0.6943139, 'auroc': 0.9424377, 'binary_precision': 0.40454546, 'binary_recall': 0.41524106, 'binary_specificity': 0.97834593, 'binary_f1_score': 0.40982348}
confusion matrix:
       0    1
0  17756  393
1    376  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9538191, 'precision': 0.65703744, 'recall': 0.5581325, 'specificity': 0.5581325, 'f1': 0.5810755, 'auroc': 0.93056, 'binary_precision': 0.35106382, 'binary_recall': 0.12643678, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.1859155}
confusion matrix:
      0   1
0  5936  61
1   228  33
early stop counter: 6
val acc:0.959078311920166, best validation acc: 0.9709450602531433, corresponding to test acc:                         0.9557366371154785 / 0.9816235303878784
after epoch: 12,now: 2024-07-31 17:20:33.122398,epoch time: 0:14:19.427516,used: 2:56:03.170162,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9950837, 'precision': 0.99508554, 'recall': 0.99508464, 'specificity': 0.99508464, 'f1': 0.9950837, 'auroc': 0.99980867, 'binary_precision': 0.9962633, 'binary_recall': 0.9939031, 'binary_specificity': 0.9962662, 'binary_f1_score': 0.9950818}
confusion matrix:
       0      1
0  28550    107
1    175  28528
---- Validation: 
scalar performance:
{'acc': 0.96466583, 'precision': 0.7348915, 'recall': 0.7664411, 'specificity': 0.7664411, 'f1': 0.7495517, 'auroc': 0.93851, 'binary_precision': 0.4856753, 'binary_recall': 0.55365473, 'binary_specificity': 0.9792275, 'binary_f1_score': 0.51744187}
confusion matrix:
       0    1
0  17772  377
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.7117912, 'recall': 0.60535824, 'specificity': 0.60535824, 'f1': 0.6382708, 'auroc': 0.9173968, 'binary_precision': 0.4566929, 'binary_recall': 0.22222222, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.2989691}
confusion matrix:
      0   1
0  5928  69
1   203  58
early stop counter: 7
val acc:0.9646658301353455, best validation acc: 0.9709450602531433, corresponding to test acc:                         0.9557366371154785 / 0.9816235303878784
after epoch: 13,now: 2024-07-31 17:34:55.670464,epoch time: 0:14:22.548066,used: 3:10:25.718228,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9912657, 'precision': 0.991388, 'recall': 0.9912716, 'specificity': 0.9912716, 'f1': 0.99126524, 'auroc': 0.99970955, 'binary_precision': 0.9993271, 'binary_recall': 0.98320615, 'binary_specificity': 0.999337, 'binary_f1_score': 0.99120116}
confusion matrix:
       0      1
0  28640     19
1    482  28219
---- Validation: 
scalar performance:
{'acc': 0.97270113, 'precision': 0.7960696, 'recall': 0.7796018, 'specificity': 0.7796018, 'f1': 0.78757644, 'auroc': 0.95402545, 'binary_precision': 0.6072607, 'binary_recall': 0.57231724, 'binary_specificity': 0.9868863, 'binary_f1_score': 0.5892714}
confusion matrix:
       0    1
0  17911  238
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.92423934, 'recall': 0.6865722, 'specificity': 0.6865722, 'f1': 0.75544643, 'auroc': 0.94435596, 'binary_precision': 0.875, 'binary_recall': 0.37547892, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.5254691}
confusion matrix:
      0   1
0  5983  14
1   163  98
better model found
persisted
after epoch: 14,now: 2024-07-31 17:49:30.811071,epoch time: 0:14:35.140607,used: 3:25:00.858835,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99605995, 'precision': 0.99607116, 'recall': 0.99606204, 'specificity': 0.99606204, 'f1': 0.9960599, 'auroc': 0.9998723, 'binary_precision': 0.9986342, 'binary_recall': 0.993485, 'binary_specificity': 0.99863905, 'binary_f1_score': 0.9960529}
confusion matrix:
       0      1
0  28618     39
1    187  28516
---- Validation: 
scalar performance:
{'acc': 0.959983, 'precision': 0.71875966, 'recall': 0.84577274, 'specificity': 0.84577274, 'f1': 0.76598364, 'auroc': 0.95596516, 'binary_precision': 0.4475457, 'binary_recall': 0.7231726, 'binary_specificity': 0.96837294, 'binary_f1_score': 0.5529132}
confusion matrix:
       0    1
0  17575  574
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.82445014, 'recall': 0.8315767, 'specificity': 0.8315767, 'f1': 0.82797, 'auroc': 0.9559947, 'binary_precision': 0.66292137, 'binary_recall': 0.6781609, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.6704545}
confusion matrix:
      0    1
0  5907   90
1    84  177
early stop counter: 1
val acc:0.9599829912185669, best validation acc: 0.9727011322975159, corresponding to test acc:                         0.9717162251472473 / 0.9816235303878784
after epoch: 15,now: 2024-07-31 18:04:00.212555,epoch time: 0:14:29.401484,used: 3:39:30.260319,model: dset_te_center0_erm_no_git_version_2024md_07md_31_14_24_29_seed_0_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 3:39:30.260319 at 2024-07-31 18:04:00.212555
persisted model performance metric: 

scalar performance:
{'acc': 0.9717162, 'precision': 0.92423934, 'recall': 0.6865722, 'specificity': 0.6865722, 'f1': 0.75544643, 'auroc': 0.94435596, 'binary_precision': 0.875, 'binary_recall': 0.37547892, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.5254691}
confusion matrix:
      0   1
0  5983  14
1   163  98
oracle model performance metric: 

scalar performance:
{'acc': 0.98162353, 'precision': 0.93252087, 'recall': 0.8218372, 'specificity': 0.8218372, 'f1': 0.86830175, 'auroc': 0.94291115, 'binary_precision': 0.8802083, 'binary_recall': 0.6475096, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.7461369}
confusion matrix:
      0    1
0  5974   23
1    92  169
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458481 KiB |  13220 MiB | 416609 GiB | 416609 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 410887 GiB | 410886 GiB |
|       from small pool |  41687 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458481 KiB |  13220 MiB | 416609 GiB | 416609 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 410887 GiB | 410886 GiB |
|       from small pool |  41687 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB | 416211 GiB | 416211 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 410502 GiB | 410502 GiB |
|       from small pool |  40679 KiB |     60 MiB |   5709 GiB |   5709 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14492 MiB |  14492 MiB |  14492 MiB |      0 B   |
|       from large pool |  14422 MiB |  14422 MiB |  14422 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 418062 KiB |   1256 MiB | 332506 GiB | 332505 GiB |
|       from large pool | 406502 KiB |   1252 MiB | 326761 GiB | 326760 GiB |
|       from small pool |  11560 KiB |     15 MiB |   5745 GiB |   5745 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8175    |   80796 K  |   80792 K  |
|       from large pool |     187    |    1413    |   37850 K  |   37850 K  |
|       from small pool |    3301    |    7986    |   42945 K  |   42942 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8175    |   80796 K  |   80792 K  |
|       from large pool |     187    |    1413    |   37850 K  |   37850 K  |
|       from small pool |    3301    |    7986    |   42945 K  |   42942 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3639    |   47704 K  |   47704 K  |
|       from large pool |      30    |     604    |   26754 K  |   26754 K  |
|       from small pool |      42    |    3608    |   20949 K  |   20949 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 416609 GiB | 416609 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 410887 GiB | 410887 GiB |
|       from small pool |      0 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 416609 GiB | 416609 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 410887 GiB | 410887 GiB |
|       from small pool |      0 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 416211 GiB | 416211 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 410502 GiB | 410502 GiB |
|       from small pool |      0 KiB |     60 MiB |   5709 GiB |   5709 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14492 MiB |  14492 MiB |  13636 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB | 332506 GiB | 332506 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 326761 GiB | 326761 GiB |
|       from small pool |      0 KiB |     44 MiB |   5745 GiB |   5745 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |   80796 K  |   80796 K  |
|       from large pool |       2    |    1413    |   37850 K  |   37850 K  |
|       from small pool |       0    |    7986    |   42945 K  |   42945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |   80796 K  |   80796 K  |
|       from large pool |       2    |    1413    |   37850 K  |   37850 K  |
|       from small pool |       0    |    7986    |   42945 K  |   42945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |     637    |     575    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3639    |   47705 K  |   47705 K  |
|       from large pool |       3    |     604    |   26754 K  |   26754 K  |
|       from small pool |       0    |    3608    |   20950 K  |   20950 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 416609 GiB | 416609 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 410887 GiB | 410887 GiB |
|       from small pool |      0 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 416609 GiB | 416609 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 410887 GiB | 410887 GiB |
|       from small pool |      0 KiB |     61 MiB |   5722 GiB |   5722 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 416211 GiB | 416211 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 410502 GiB | 410502 GiB |
|       from small pool |      0 KiB |     60 MiB |   5709 GiB |   5709 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14492 MiB |  14492 MiB |  13636 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB | 332506 GiB | 332506 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 326761 GiB | 326761 GiB |
|       from small pool |      0 KiB |     44 MiB |   5745 GiB |   5745 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8175    |   80796 K  |   80796 K  |
|       from large pool |       2    |    1413    |   37850 K  |   37850 K  |
|       from small pool |       0    |    7986    |   42945 K  |   42945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8175    |   80796 K  |   80796 K  |
|       from large pool |       2    |    1413    |   37850 K  |   37850 K  |
|       from small pool |       0    |    7986    |   42945 K  |   42945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |     637    |     575    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3639    |   47705 K  |   47705 K  |
|       from large pool |       3    |     604    |   26754 K  |   26754 K  |
|       from small pool |       0    |    3608    |   20950 K  |   20950 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396

 Experiment start at: 2024-07-31 18:11:10.437839
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9797105, 'precision': 0.9800149, 'recall': 0.97970104, 'specificity': 0.97970104, 'f1': 0.979707, 'auroc': 0.9986526, 'binary_precision': 0.96811646, 'binary_recall': 0.9921263, 'binary_specificity': 0.96727574, 'binary_f1_score': 0.9799743}
confusion matrix:
       0      1
0  27844    942
1    227  28603
---- Validation: 
scalar performance:
{'acc': 0.8930096, 'precision': 0.5993135, 'recall': 0.8086113, 'specificity': 0.8086113, 'f1': 0.6335211, 'auroc': 0.89180994, 'binary_precision': 0.21018277, 'binary_recall': 0.717682, 'binary_specificity': 0.8995406, 'binary_f1_score': 0.32514304}
confusion matrix:
       0     1
0  16252  1815
1    190   483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88720596, 'precision': 0.61385906, 'recall': 0.8326367, 'specificity': 0.8326367, 'f1': 0.65144956, 'auroc': 0.908621, 'binary_precision': 0.23871733, 'binary_recall': 0.77307695, 'binary_specificity': 0.8921964, 'binary_f1_score': 0.36479127}
confusion matrix:
      0    1
0  5305  641
1    59  201
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 18:26:18.259298,epoch time: 0:15:07.821459,used: 0:15:07.821459,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9880242, 'precision': 0.9880253, 'recall': 0.98802483, 'specificity': 0.98802483, 'f1': 0.9880242, 'auroc': 0.99910057, 'binary_precision': 0.9889823, 'binary_recall': 0.9870612, 'binary_specificity': 0.98898846, 'binary_f1_score': 0.9880209}
confusion matrix:
       0      1
0  28471    317
1    373  28455
---- Validation: 
scalar performance:
{'acc': 0.9404482, 'precision': 0.66450304, 'recall': 0.8260615, 'specificity': 0.8260615, 'f1': 0.71363425, 'auroc': 0.92470026, 'binary_precision': 0.34053275, 'binary_recall': 0.70282316, 'binary_specificity': 0.9492998, 'binary_f1_score': 0.45877784}
confusion matrix:
       0    1
0  17151  916
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95520467, 'precision': 0.7307897, 'recall': 0.823987, 'specificity': 0.823987, 'f1': 0.7682636, 'auroc': 0.9366796, 'binary_precision': 0.47580644, 'binary_recall': 0.6807692, 'binary_specificity': 0.96720487, 'binary_f1_score': 0.56012654}
confusion matrix:
      0    1
0  5751  195
1    83  177
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 18:42:12.153325,epoch time: 0:15:53.894027,used: 0:31:01.715486,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9920682, 'precision': 0.9920998, 'recall': 0.99207103, 'specificity': 0.99207103, 'f1': 0.99206805, 'auroc': 0.99948317, 'binary_precision': 0.9962221, 'binary_recall': 0.9878937, 'binary_specificity': 0.9962484, 'binary_f1_score': 0.99204034}
confusion matrix:
       0      1
0  28680    108
1    349  28479
---- Validation: 
scalar performance:
{'acc': 0.9489861, 'precision': 0.69158256, 'recall': 0.8605307, 'specificity': 0.8605307, 'f1': 0.74584806, 'auroc': 0.9386717, 'binary_precision': 0.39223152, 'binary_recall': 0.7652303, 'binary_specificity': 0.95583105, 'binary_f1_score': 0.5186304}
confusion matrix:
       0    1
0  17269  798
1    158  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.972446, 'precision': 0.8269769, 'recall': 0.8329847, 'specificity': 0.8329847, 'f1': 0.8299501, 'auroc': 0.94734275, 'binary_precision': 0.6679245, 'binary_recall': 0.6807692, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.6742857}
confusion matrix:
      0    1
0  5858   88
1    83  177
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 18:57:14.488106,epoch time: 0:15:02.334781,used: 0:46:04.050267,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9868266, 'precision': 0.98682666, 'recall': 0.9868269, 'specificity': 0.9868269, 'f1': 0.9868266, 'auroc': 0.99895203, 'binary_precision': 0.98725873, 'binary_recall': 0.9864026, 'binary_specificity': 0.98725116, 'binary_f1_score': 0.9868305}
confusion matrix:
       0      1
0  28420    367
1    392  28437
---- Validation: 
scalar performance:
{'acc': 0.957524, 'precision': 0.7159001, 'recall': 0.83777845, 'specificity': 0.83777845, 'f1': 0.7614323, 'auroc': 0.9361174, 'binary_precision': 0.44289693, 'binary_recall': 0.7087667, 'binary_specificity': 0.96679026, 'binary_f1_score': 0.5451428}
confusion matrix:
       0    1
0  17467  600
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697067, 'precision': 0.82229596, 'recall': 0.77454656, 'specificity': 0.77454656, 'f1': 0.7962887, 'auroc': 0.94428444, 'binary_precision': 0.6636364, 'binary_recall': 0.56153846, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.60833335}
confusion matrix:
      0    1
0  5872   74
1   114  146
better model found
persisted
after epoch: 4,now: 2024-07-31 19:11:52.325347,epoch time: 0:14:37.837241,used: 1:00:41.887508,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9930054, 'precision': 0.9930073, 'recall': 0.9930048, 'specificity': 0.9930048, 'f1': 0.9930054, 'auroc': 0.9996003, 'binary_precision': 0.99220806, 'binary_recall': 0.9938257, 'binary_specificity': 0.992184, 'binary_f1_score': 0.99301624}
confusion matrix:
       0      1
0  28562    225
1    178  28651
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.73645896, 'recall': 0.82112306, 'specificity': 0.82112306, 'f1': 0.7714952, 'auroc': 0.9321829, 'binary_precision': 0.4854369, 'binary_recall': 0.6686478, 'binary_specificity': 0.9735983, 'binary_f1_score': 0.5625}
confusion matrix:
       0    1
0  17590  477
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.82607746, 'recall': 0.8535499, 'specificity': 0.8535499, 'f1': 0.8391895, 'auroc': 0.941208, 'binary_precision': 0.66431093, 'binary_recall': 0.72307694, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.69244933}
confusion matrix:
      0    1
0  5851   95
1    72  188
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 19:29:20.277577,epoch time: 0:17:27.952230,used: 1:18:09.839738,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99437654, 'precision': 0.9943813, 'recall': 0.99437785, 'specificity': 0.99437785, 'f1': 0.99437654, 'auroc': 0.99957573, 'binary_precision': 0.9961015, 'binary_recall': 0.9926463, 'binary_specificity': 0.99610937, 'binary_f1_score': 0.9943709}
confusion matrix:
       0      1
0  28675    112
1    212  28617
---- Validation: 
scalar performance:
{'acc': 0.9425293, 'precision': 0.6752554, 'recall': 0.85861254, 'specificity': 0.85861254, 'f1': 0.72968245, 'auroc': 0.9394771, 'binary_precision': 0.3595271, 'binary_recall': 0.76820207, 'binary_specificity': 0.94902307, 'binary_f1_score': 0.48981526}
confusion matrix:
       0    1
0  17146  921
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.7978618, 'recall': 0.8327214, 'specificity': 0.8327214, 'f1': 0.81420064, 'auroc': 0.95621014, 'binary_precision': 0.60958904, 'binary_recall': 0.6846154, 'binary_specificity': 0.98082745, 'binary_f1_score': 0.6449275}
confusion matrix:
      0    1
0  5832  114
1    82  178
early stop counter: 1
val acc:0.9425293207168579, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9730905294418335 / 0.9730905294418335
after epoch: 6,now: 2024-07-31 19:46:45.831423,epoch time: 0:17:25.553846,used: 1:35:35.393584,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9815503, 'precision': 0.9821949, 'recall': 0.9815631, 'specificity': 0.9815631, 'f1': 0.98154444, 'auroc': 0.9995972, 'binary_precision': 1.0, 'binary_recall': 0.9631261, 'binary_specificity': 1.0, 'binary_f1_score': 0.9812167}
confusion matrix:
       0      1
0  28788      0
1   1063  27765
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7389513, 'recall': 0.514333, 'specificity': 0.514333, 'f1': 0.5189515, 'auroc': 0.94266737, 'binary_precision': 0.51282054, 'binary_recall': 0.029717682, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.056179773}
confusion matrix:
       0   1
0  18048  19
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.92273605, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
better model found
persisted
after epoch: 7,now: 2024-07-31 20:01:00.341529,epoch time: 0:14:14.510106,used: 1:49:49.903690,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98870105, 'precision': 0.98885405, 'recall': 0.9886944, 'specificity': 0.9886944, 'f1': 0.98870003, 'auroc': 0.9996582, 'binary_precision': 0.98039484, 'binary_recall': 0.99736387, 'binary_specificity': 0.980025, 'binary_f1_score': 0.9888066}
confusion matrix:
       0      1
0  28211    575
1     76  28754
---- Validation: 
scalar performance:
{'acc': 0.95373535, 'precision': 0.70899415, 'recall': 0.8880281, 'specificity': 0.8880281, 'f1': 0.7674068, 'auroc': 0.9550991, 'binary_precision': 0.42503864, 'binary_recall': 0.81723624, 'binary_specificity': 0.9588199, 'binary_f1_score': 0.5592272}
confusion matrix:
       0    1
0  17323  744
1    123  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180146, 'precision': 0.8235631, 'recall': 0.8271314, 'specificity': 0.8271314, 'f1': 0.8253362, 'auroc': 0.9460552, 'binary_precision': 0.66159695, 'binary_recall': 0.66923076, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.665392}
confusion matrix:
      0    1
0  5857   89
1    86  174
early stop counter: 1
val acc:0.9537353515625, best validation acc: 0.9641408920288086, corresponding to test acc:                         0.9579439163208008 / 0.9730905294418335
after epoch: 8,now: 2024-07-31 20:15:18.177892,epoch time: 0:14:17.836363,used: 2:04:07.740053,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9861323, 'precision': 0.9864855, 'recall': 0.98614275, 'specificity': 0.98614275, 'f1': 0.98613, 'auroc': 0.9994887, 'binary_precision': 0.999786, 'binary_recall': 0.97249395, 'binary_specificity': 0.99979156, 'binary_f1_score': 0.9859511}
confusion matrix:
       0      1
0  28780      6
1    793  28037
---- Validation: 
scalar performance:
{'acc': 0.9614728, 'precision': 0.6735792, 'recall': 0.5537195, 'specificity': 0.5537195, 'f1': 0.5780372, 'auroc': 0.9200931, 'binary_precision': 0.37931034, 'binary_recall': 0.114413075, 'binary_specificity': 0.99302596, 'binary_f1_score': 0.17579909}
confusion matrix:
       0    1
0  17941  126
1    596   77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9537544, 'precision': 0.478961, 'recall': 0.49772957, 'specificity': 0.49772957, 'f1': 0.48816496, 'auroc': 0.94852954, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5919  27
1   260   0
early stop counter: 2
val acc:0.9614728093147278, best validation acc: 0.9641408920288086, corresponding to test acc:                         0.9579439163208008 / 0.9730905294418335
after epoch: 9,now: 2024-07-31 20:29:36.785020,epoch time: 0:14:18.607128,used: 2:18:26.347181,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9950361, 'precision': 0.99506325, 'recall': 0.9950389, 'specificity': 0.9950389, 'f1': 0.995036, 'auroc': 0.99982333, 'binary_precision': 0.99891627, 'binary_recall': 0.99115473, 'binary_specificity': 0.9989231, 'binary_f1_score': 0.99502033}
confusion matrix:
       0      1
0  28756     31
1    255  28574
---- Validation: 
scalar performance:
{'acc': 0.94978654, 'precision': 0.6964731, 'recall': 0.87882745, 'specificity': 0.87882745, 'f1': 0.75392556, 'auroc': 0.9468858, 'binary_precision': 0.40059346, 'binary_recall': 0.8023774, 'binary_specificity': 0.95527756, 'binary_f1_score': 0.5343889}
confusion matrix:
       0    1
0  17259  808
1    133  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92974544, 'precision': 0.66863376, 'recall': 0.85483646, 'specificity': 0.85483646, 'f1': 0.72102153, 'auroc': 0.93488777, 'binary_precision': 0.34775087, 'binary_recall': 0.77307695, 'binary_specificity': 0.93659604, 'binary_f1_score': 0.47971365}
confusion matrix:
      0    1
0  5569  377
1    59  201
early stop counter: 3
val acc:0.9497865438461304, best validation acc: 0.9641408920288086, corresponding to test acc:                         0.9579439163208008 / 0.9730905294418335
after epoch: 10,now: 2024-07-31 20:44:01.450315,epoch time: 0:14:24.665295,used: 2:32:51.012476,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99489725, 'precision': 0.9949161, 'recall': 0.9948995, 'specificity': 0.9948995, 'f1': 0.99489725, 'auroc': 0.9997233, 'binary_precision': 0.99814945, 'binary_recall': 0.9916401, 'binary_specificity': 0.99815893, 'binary_f1_score': 0.9948842}
confusion matrix:
       0      1
0  28735     53
1    241  28587
---- Validation: 
scalar performance:
{'acc': 0.96750265, 'precision': 0.7643563, 'recall': 0.7835865, 'specificity': 0.7835865, 'f1': 0.773594, 'auroc': 0.95393384, 'binary_precision': 0.5441989, 'binary_recall': 0.5854383, 'binary_specificity': 0.98173463, 'binary_f1_score': 0.5640658}
confusion matrix:
       0    1
0  17737  330
1    279  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.8858924, 'recall': 0.6673808, 'specificity': 0.6673808, 'f1': 0.7297827, 'auroc': 0.9514365, 'binary_precision': 0.8, 'binary_recall': 0.33846155, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.47567567}
confusion matrix:
      0   1
0  5924  22
1   172  88
better model found
persisted
after epoch: 11,now: 2024-07-31 20:58:16.900155,epoch time: 0:14:15.449840,used: 2:47:06.462316,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9882498, 'precision': 0.98825455, 'recall': 0.9882511, 'specificity': 0.9882511, 'f1': 0.9882498, 'auroc': 0.9989603, 'binary_precision': 0.9899749, 'binary_recall': 0.98650664, 'binary_specificity': 0.9899955, 'binary_f1_score': 0.9882377}
confusion matrix:
       0      1
0  28499    288
1    389  28440
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.7347021, 'recall': 0.84791577, 'specificity': 0.84791577, 'f1': 0.77878255, 'auroc': 0.9507173, 'binary_precision': 0.47984266, 'binary_recall': 0.7251114, 'binary_specificity': 0.9707201, 'binary_f1_score': 0.57751477}
confusion matrix:
       0    1
0  17538  529
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97164035, 'precision': 0.80882674, 'recall': 0.88957286, 'specificity': 0.88957286, 'f1': 0.8439064, 'auroc': 0.96080834, 'binary_precision': 0.62650603, 'binary_recall': 0.8, 'binary_specificity': 0.97914565, 'binary_f1_score': 0.70270276}
confusion matrix:
      0    1
0  5822  124
1    52  208
early stop counter: 1
val acc:0.9618996977806091, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.968739926815033 / 0.9730905294418335
after epoch: 12,now: 2024-07-31 21:12:32.875523,epoch time: 0:14:15.975368,used: 3:01:22.437684,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9937691, 'precision': 0.9937756, 'recall': 0.99376786, 'specificity': 0.99376786, 'f1': 0.99376905, 'auroc': 0.99959517, 'binary_precision': 0.99215186, 'binary_recall': 0.9954213, 'binary_specificity': 0.9921145, 'binary_f1_score': 0.9937839}
confusion matrix:
       0      1
0  28560    227
1    132  28697
---- Validation: 
scalar performance:
{'acc': 0.9465315, 'precision': 0.67657137, 'recall': 0.81205, 'specificity': 0.81205, 'f1': 0.72223485, 'auroc': 0.94361997, 'binary_precision': 0.36593318, 'binary_recall': 0.66716194, 'binary_specificity': 0.9569381, 'binary_f1_score': 0.47263157}
confusion matrix:
       0    1
0  17289  778
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7465006, 'recall': 0.8020984, 'specificity': 0.8020984, 'f1': 0.7710515, 'auroc': 0.92567414, 'binary_precision': 0.50931674, 'binary_recall': 0.63076925, 'binary_specificity': 0.97342753, 'binary_f1_score': 0.5635739}
confusion matrix:
      0    1
0  5788  158
1    96  164
early stop counter: 2
val acc:0.9465314745903015, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.968739926815033 / 0.9730905294418335
after epoch: 13,now: 2024-07-31 21:26:49.247437,epoch time: 0:14:16.371914,used: 3:15:38.809598,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99458486, 'precision': 0.994618, 'recall': 0.9945878, 'specificity': 0.9945878, 'f1': 0.9945848, 'auroc': 0.99974954, 'binary_precision': 0.9988454, 'binary_recall': 0.99032193, 'binary_specificity': 0.9988537, 'binary_f1_score': 0.99456537}
confusion matrix:
       0      1
0  28755     33
1    279  28549
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7574424, 'recall': 0.5878161, 'specificity': 0.5878161, 'f1': 0.627084, 'auroc': 0.9473858, 'binary_precision': 0.54464287, 'binary_recall': 0.18127786, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.27201784}
confusion matrix:
       0    1
0  17965  102
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.47901532, 'recall': 0.499075, 'specificity': 0.499075, 'f1': 0.48883948, 'auroc': 0.9432049, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99815, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5935  11
1   260   0
early stop counter: 3
val acc:0.965154767036438, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.968739926815033 / 0.9730905294418335
after epoch: 14,now: 2024-07-31 21:41:06.869170,epoch time: 0:14:17.621733,used: 3:29:56.431331,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99465424, 'precision': 0.9946586, 'recall': 0.9946555, 'specificity': 0.9946555, 'f1': 0.9946543, 'auroc': 0.999797, 'binary_precision': 0.9963109, 'binary_recall': 0.9929932, 'binary_specificity': 0.9963178, 'binary_f1_score': 0.9946493}
confusion matrix:
       0      1
0  28681    106
1    202  28627
---- Validation: 
scalar performance:
{'acc': 0.94034153, 'precision': 0.6745387, 'recall': 0.88179696, 'specificity': 0.88179696, 'f1': 0.73234457, 'auroc': 0.95454776, 'binary_precision': 0.35617325, 'binary_recall': 0.8187221, 'binary_specificity': 0.94487184, 'binary_f1_score': 0.49639642}
confusion matrix:
       0    1
0  17071  996
1    122  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511763, 'precision': 0.72242874, 'recall': 0.88257134, 'specificity': 0.88257134, 'f1': 0.77749556, 'auroc': 0.9506967, 'binary_precision': 0.45356372, 'binary_recall': 0.8076923, 'binary_specificity': 0.9574504, 'binary_f1_score': 0.5809129}
confusion matrix:
      0    1
0  5693  253
1    50  210
early stop counter: 4
val acc:0.9403415322303772, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.968739926815033 / 0.9730905294418335
after epoch: 15,now: 2024-07-31 21:55:19.080441,epoch time: 0:14:12.211271,used: 3:44:08.642602,model: dset_te_center0_erm_no_git_version_2024md_07md_31_18_11_10_seed_1_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 3:44:08.642602 at 2024-07-31 21:55:19.080441
persisted model performance metric: 

scalar performance:
{'acc': 0.9687399, 'precision': 0.8858924, 'recall': 0.6673808, 'specificity': 0.6673808, 'f1': 0.7297827, 'auroc': 0.9514365, 'binary_precision': 0.8, 'binary_recall': 0.33846155, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.47567567}
confusion matrix:
      0   1
0  5924  22
1   172  88
oracle model performance metric: 

scalar performance:
{'acc': 0.9730905, 'precision': 0.82607746, 'recall': 0.8535499, 'specificity': 0.8535499, 'f1': 0.8391895, 'auroc': 0.941208, 'binary_precision': 0.66431093, 'binary_recall': 0.72307694, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.69244933}
confusion matrix:
      0    1
0  5851   95
1    72  188
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456559 KiB |  13220 MiB |    820 TiB |    820 TiB |
|       from large pool | 414883 KiB |  13181 MiB |    808 TiB |    808 TiB |
|       from small pool |  41675 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456559 KiB |  13220 MiB |    820 TiB |    820 TiB |
|       from large pool | 414883 KiB |  13181 MiB |    808 TiB |    808 TiB |
|       from small pool |  41675 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |    819 TiB |    819 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    808 TiB |    808 TiB |
|       from small pool |  40676 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14468 MiB |  14492 MiB |  28104 MiB |  13636 MiB |
|       from large pool |  14402 MiB |  14422 MiB |  28020 MiB |  13618 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 485521 KiB |   1256 MiB | 671481 GiB | 671481 GiB |
|       from large pool | 475996 KiB |   1252 MiB | 659934 GiB | 659933 GiB |
|       from small pool |   9524 KiB |     44 MiB |  11547 GiB |  11547 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8207    |  162533 K  |  162530 K  |
|       from large pool |     187    |    1413    |   76270 K  |   76270 K  |
|       from small pool |    3277    |    8018    |   86263 K  |   86259 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8207    |  162533 K  |  162530 K  |
|       from large pool |     187    |    1413    |   76270 K  |   76270 K  |
|       from small pool |    3277    |    8018    |   86263 K  |   86259 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    1209    |     575    |
|       from large pool |     601    |     602    |    1167    |     566    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    3667    |   99656 K  |   99656 K  |
|       from large pool |      41    |     604    |   57523 K  |   57523 K  |
|       from small pool |      41    |    3624    |   42133 K  |   42133 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |    820 TiB |    820 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    808 TiB |    808 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |    820 TiB |    820 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    808 TiB |    808 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    808 TiB |    808 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |  14492 MiB |  28104 MiB |  27184 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB | 671481 GiB | 671481 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 659934 GiB | 659934 GiB |
|       from small pool |      0 KiB |     44 MiB |  11547 GiB |  11547 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76270 K  |   76270 K  |
|       from small pool |       0    |    8018    |   86263 K  |   86263 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76270 K  |   76270 K  |
|       from small pool |       0    |    8018    |   86263 K  |   86263 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    1209    |    1145    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |   99657 K  |   99657 K  |
|       from large pool |       3    |     604    |   57523 K  |   57523 K  |
|       from small pool |       0    |    3624    |   42134 K  |   42134 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |    820 TiB |    820 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    808 TiB |    808 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |    820 TiB |    820 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    808 TiB |    808 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    808 TiB |    808 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |  14492 MiB |  28104 MiB |  27184 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB | 671481 GiB | 671481 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 659934 GiB | 659934 GiB |
|       from small pool |      0 KiB |     44 MiB |  11547 GiB |  11547 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76270 K  |   76270 K  |
|       from small pool |       0    |    8018    |   86263 K  |   86263 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8207    |  162533 K  |  162533 K  |
|       from large pool |       2    |    1413    |   76270 K  |   76270 K  |
|       from small pool |       0    |    8018    |   86263 K  |   86263 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    1209    |    1145    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |   99657 K  |   99657 K  |
|       from large pool |       3    |     604    |   57523 K  |   57523 K  |
|       from small pool |       0    |    3624    |   42134 K  |   42134 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396

 Experiment start at: 2024-07-31 22:02:13.972047
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9848724, 'precision': 0.9848808, 'recall': 0.98487276, 'specificity': 0.98487276, 'f1': 0.98487234, 'auroc': 0.9986558, 'binary_precision': 0.98694587, 'binary_recall': 0.98274857, 'binary_specificity': 0.98699695, 'binary_f1_score': 0.9848428}
confusion matrix:
       0      1
0  28768    379
1    503  28654
---- Validation: 
scalar performance:
{'acc': 0.94204444, 'precision': 0.6599486, 'recall': 0.8584385, 'specificity': 0.8584385, 'f1': 0.7145806, 'auroc': 0.9221417, 'binary_precision': 0.3279037, 'binary_recall': 0.769103, 'binary_specificity': 0.94777393, 'binary_f1_score': 0.4597815}
confusion matrix:
       0    1
0  17222  949
1    139  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123257, 'precision': 0.6335906, 'recall': 0.8493086, 'specificity': 0.8493086, 'f1': 0.68065083, 'auroc': 0.9108328, 'binary_precision': 0.27672035, 'binary_recall': 0.78099173, 'binary_specificity': 0.9176255, 'binary_f1_score': 0.40864867}
confusion matrix:
      0    1
0  5503  494
1    53  189
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 22:17:48.855151,epoch time: 0:15:34.883104,used: 0:15:34.883104,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9915615, 'precision': 0.9916342, 'recall': 0.99156296, 'specificity': 0.99156296, 'f1': 0.9915612, 'auroc': 0.9993603, 'binary_precision': 0.9976737, 'binary_recall': 0.98542476, 'binary_specificity': 0.99770117, 'binary_f1_score': 0.99151134}
confusion matrix:
       0      1
0  29078     67
1    425  28734
---- Validation: 
scalar performance:
{'acc': 0.9521121, 'precision': 0.67102444, 'recall': 0.7849403, 'specificity': 0.7849403, 'f1': 0.71154886, 'auroc': 0.9094898, 'binary_precision': 0.35540408, 'binary_recall': 0.6063123, 'binary_specificity': 0.96356833, 'binary_f1_score': 0.4481277}
confusion matrix:
       0    1
0  17509  662
1    237  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9390928, 'precision': 0.66461825, 'recall': 0.79185355, 'specificity': 0.79185355, 'f1': 0.70691943, 'auroc': 0.88440573, 'binary_precision': 0.3445946, 'binary_recall': 0.6322314, 'binary_specificity': 0.95147574, 'binary_f1_score': 0.44606414}
confusion matrix:
      0    1
0  5706  291
1    89  153
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 22:32:43.052728,epoch time: 0:14:54.197577,used: 0:30:29.080681,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98986346, 'precision': 0.9898635, 'recall': 0.9898634, 'specificity': 0.9898634, 'f1': 0.9898635, 'auroc': 0.9992446, 'binary_precision': 0.98971474, 'binary_recall': 0.9900202, 'binary_specificity': 0.98970664, 'binary_f1_score': 0.9898675}
confusion matrix:
       0      1
0  28845    300
1    291  28868
---- Validation: 
scalar performance:
{'acc': 0.92952645, 'precision': 0.6250838, 'recall': 0.79897094, 'specificity': 0.79897094, 'f1': 0.6688584, 'auroc': 0.90019, 'binary_precision': 0.26204622, 'binary_recall': 0.6594684, 'binary_specificity': 0.9384734, 'binary_f1_score': 0.37505907}
confusion matrix:
       0     1
0  17053  1118
1    205   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9482289, 'precision': 0.6993166, 'recall': 0.8541055, 'specificity': 0.8541055, 'f1': 0.7512231, 'auroc': 0.93510944, 'binary_precision': 0.40898877, 'binary_recall': 0.75206614, 'binary_specificity': 0.95614475, 'binary_f1_score': 0.52983993}
confusion matrix:
      0    1
0  5734  263
1    60  182
new oracle model saved
early stop counter: 1
val acc:0.9295264482498169, best validation acc: 0.952112078666687, corresponding to test acc:                         0.9390928149223328 / 0.9482288956642151
after epoch: 3,now: 2024-07-31 22:47:34.624289,epoch time: 0:14:51.571561,used: 0:45:20.652242,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98993206, 'precision': 0.9899329, 'recall': 0.9899322, 'specificity': 0.9899322, 'f1': 0.98993206, 'auroc': 0.99937505, 'binary_precision': 0.9905897, 'binary_recall': 0.98926467, 'binary_specificity': 0.9905997, 'binary_f1_score': 0.98992676}
confusion matrix:
       0      1
0  28874    274
1    313  28843
---- Validation: 
scalar performance:
{'acc': 0.95951635, 'precision': 0.6904805, 'recall': 0.7413852, 'specificity': 0.7413852, 'f1': 0.71252733, 'auroc': 0.9241172, 'binary_precision': 0.39740258, 'binary_recall': 0.50830567, 'binary_specificity': 0.97446483, 'binary_f1_score': 0.44606414}
confusion matrix:
       0    1
0  17707  464
1    296  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.93655705, 'recall': 0.6152022, 'specificity': 0.6152022, 'f1': 0.67632484, 'auroc': 0.9427887, 'binary_precision': 0.9032258, 'binary_recall': 0.23140496, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.36842108}
confusion matrix:
      0   1
0  5991   6
1   186  56
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 23:02:25.108330,epoch time: 0:14:50.484041,used: 1:00:11.136283,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98970914, 'precision': 0.9898002, 'recall': 0.9897103, 'specificity': 0.9897103, 'f1': 0.98970866, 'auroc': 0.999007, 'binary_precision': 0.9965226, 'binary_recall': 0.98285145, 'binary_specificity': 0.9965691, 'binary_f1_score': 0.98963976}
confusion matrix:
       0      1
0  29047    100
1    500  28657
---- Validation: 
scalar performance:
{'acc': 0.9440153, 'precision': 0.6108471, 'recall': 0.65869445, 'specificity': 0.65869445, 'f1': 0.62964195, 'auroc': 0.84180266, 'binary_precision': 0.24342857, 'binary_recall': 0.3538206, 'binary_specificity': 0.96356833, 'binary_f1_score': 0.2884225}
confusion matrix:
       0    1
0  17509  662
1    389  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9379708, 'precision': 0.64427185, 'recall': 0.721874, 'specificity': 0.721874, 'f1': 0.6730839, 'auroc': 0.908426, 'binary_precision': 0.30971128, 'binary_recall': 0.4876033, 'binary_specificity': 0.95614475, 'binary_f1_score': 0.37881222}
confusion matrix:
      0    1
0  5734  263
1   124  118
early stop counter: 1
val acc:0.9440153241157532, best validation acc: 0.9595163464546204, corresponding to test acc:                         0.9692258238792419 / 0.9692258238792419
after epoch: 5,now: 2024-07-31 23:17:00.828878,epoch time: 0:14:35.720548,used: 1:14:46.856831,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9903094, 'precision': 0.99039364, 'recall': 0.9903108, 'specificity': 0.9903108, 'f1': 0.990309, 'auroc': 0.9993675, 'binary_precision': 0.99687207, 'binary_recall': 0.98370945, 'binary_specificity': 0.9969121, 'binary_f1_score': 0.990247}
confusion matrix:
       0      1
0  29056     90
1    475  28683
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.7389888, 'recall': 0.75354314, 'specificity': 0.75354314, 'f1': 0.74602705, 'auroc': 0.93898684, 'binary_precision': 0.49375, 'binary_recall': 0.52491695, 'binary_specificity': 0.9821694, 'binary_f1_score': 0.50885665}
confusion matrix:
       0    1
0  17847  324
1    286  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9759577, 'precision': 0.8539429, 'recall': 0.80309886, 'specificity': 0.80309886, 'f1': 0.82635486, 'auroc': 0.9437703, 'binary_precision': 0.723301, 'binary_recall': 0.61570245, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.66517854}
confusion matrix:
      0    1
0  5940   57
1    93  149
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-31 23:31:56.134788,epoch time: 0:14:55.305910,used: 1:29:42.162741,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9928135, 'precision': 0.99281484, 'recall': 0.99281335, 'specificity': 0.99281335, 'f1': 0.9928135, 'auroc': 0.9996544, 'binary_precision': 0.9920556, 'binary_recall': 0.99358666, 'binary_specificity': 0.9920401, 'binary_f1_score': 0.99282056}
confusion matrix:
       0      1
0  28914    232
1    187  28971
---- Validation: 
scalar performance:
{'acc': 0.96111435, 'precision': 0.7091377, 'recall': 0.812076, 'specificity': 0.812076, 'f1': 0.7491044, 'auroc': 0.9342562, 'binary_precision': 0.42997813, 'binary_recall': 0.6528239, 'binary_specificity': 0.97132796, 'binary_f1_score': 0.51846963}
confusion matrix:
       0    1
0  17650  521
1    209  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7539938, 'recall': 0.8500463, 'specificity': 0.8500463, 'f1': 0.7933017, 'auroc': 0.9158367, 'binary_precision': 0.51917404, 'binary_recall': 0.72727275, 'binary_specificity': 0.97281975, 'binary_f1_score': 0.60585195}
confusion matrix:
      0    1
0  5834  163
1    66  176
early stop counter: 1
val acc:0.9611143469810486, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9759576916694641 / 0.9759576916694641
after epoch: 7,now: 2024-07-31 23:46:52.923222,epoch time: 0:14:56.788434,used: 1:44:38.951175,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99051523, 'precision': 0.9905404, 'recall': 0.99051476, 'specificity': 0.99051476, 'f1': 0.9905151, 'auroc': 0.99945307, 'binary_precision': 0.9870585, 'binary_recall': 0.9940664, 'binary_specificity': 0.9869631, 'binary_f1_score': 0.9905501}
confusion matrix:
       0      1
0  28768    380
1    173  28983
---- Validation: 
scalar performance:
{'acc': 0.9393278, 'precision': 0.6382407, 'recall': 0.7823516, 'specificity': 0.7823516, 'f1': 0.6809461, 'auroc': 0.9080734, 'binary_precision': 0.28974158, 'binary_recall': 0.61461794, 'binary_specificity': 0.9500853, 'binary_f1_score': 0.39382648}
confusion matrix:
       0    1
0  17264  907
1    232  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97259176, 'precision': 0.8076285, 'recall': 0.854882, 'specificity': 0.854882, 'f1': 0.82936823, 'auroc': 0.9479933, 'binary_precision': 0.62633455, 'binary_recall': 0.72727275, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.67304015}
confusion matrix:
      0    1
0  5892  105
1    66  176
early stop counter: 2
val acc:0.9393277764320374, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9759576916694641 / 0.9759576916694641
after epoch: 8,now: 2024-08-01 00:02:05.892069,epoch time: 0:15:12.968847,used: 1:59:51.920022,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9939798, 'precision': 0.9939809, 'recall': 0.99398, 'specificity': 0.99398, 'f1': 0.9939798, 'auroc': 0.999685, 'binary_precision': 0.9947446, 'binary_recall': 0.9932094, 'binary_specificity': 0.99475056, 'binary_f1_score': 0.9939764}
confusion matrix:
       0      1
0  28993    153
1    198  28960
---- Validation: 
scalar performance:
{'acc': 0.9700634, 'precision': 0.7592494, 'recall': 0.7492426, 'specificity': 0.7492426, 'f1': 0.7541374, 'auroc': 0.95431817, 'binary_precision': 0.5346021, 'binary_recall': 0.51328903, 'binary_specificity': 0.9851962, 'binary_f1_score': 0.5237288}
confusion matrix:
       0    1
0  17902  269
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.78497314, 'recall': 0.54627, 'specificity': 0.54627, 'f1': 0.57255113, 'auroc': 0.9334865, 'binary_precision': 0.6052632, 'binary_recall': 0.09504132, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.16428572}
confusion matrix:
      0   1
0  5982  15
1   219  23
better model found
persisted
after epoch: 9,now: 2024-08-01 00:18:10.338870,epoch time: 0:16:04.446801,used: 2:15:56.366823,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9930022, 'precision': 0.9930936, 'recall': 0.9930036, 'specificity': 0.9930036, 'f1': 0.9930019, 'auroc': 0.9996859, 'binary_precision': 0.9998609, 'binary_recall': 0.9861445, 'binary_specificity': 0.99986273, 'binary_f1_score': 0.9929553}
confusion matrix:
       0      1
0  29142      4
1    404  28754
---- Validation: 
scalar performance:
{'acc': 0.96633464, 'precision': 0.66275257, 'recall': 0.5288873, 'specificity': 0.5288873, 'f1': 0.5438303, 'auroc': 0.9377611, 'binary_precision': 0.35576922, 'binary_recall': 0.061461795, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.10481586}
confusion matrix:
       0   1
0  18104  67
1    565  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.855834, 'recall': 0.50611496, 'specificity': 0.50611496, 'f1': 0.5023848, 'auroc': 0.946554, 'binary_precision': 0.75, 'binary_recall': 0.012396694, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.024390245}
confusion matrix:
      0  1
0  5996  1
1   239  3
early stop counter: 1
val acc:0.9663346409797668, best validation acc: 0.9700633883476257, corresponding to test acc:                         0.9624940156936646 / 0.9759576916694641
after epoch: 10,now: 2024-08-01 00:33:04.271846,epoch time: 0:14:53.932976,used: 2:30:50.299799,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99078965, 'precision': 0.990791, 'recall': 0.99078953, 'specificity': 0.99078953, 'f1': 0.99078965, 'auroc': 0.9995609, 'binary_precision': 0.990001, 'binary_recall': 0.99159694, 'binary_specificity': 0.9899822, 'binary_f1_score': 0.9907984}
confusion matrix:
       0      1
0  28856    292
1    245  28911
---- Validation: 
scalar performance:
{'acc': 0.9578118, 'precision': 0.6976863, 'recall': 0.8248248, 'specificity': 0.8248248, 'f1': 0.743626, 'auroc': 0.9380479, 'binary_precision': 0.40612647, 'binary_recall': 0.68272424, 'binary_specificity': 0.9669253, 'binary_f1_score': 0.5092936}
confusion matrix:
       0    1
0  17570  601
1    191  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9796442, 'precision': 0.88217473, 'recall': 0.8288094, 'specificity': 0.8288094, 'f1': 0.8532957, 'auroc': 0.9412296, 'binary_precision': 0.7777778, 'binary_recall': 0.6652893, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.71714926}
confusion matrix:
      0    1
0  5951   46
1    81  161
new oracle model saved
early stop counter: 2
val acc:0.9578117728233337, best validation acc: 0.9700633883476257, corresponding to test acc:                         0.9624940156936646 / 0.9796441793441772
after epoch: 11,now: 2024-08-01 00:48:29.358683,epoch time: 0:15:25.086837,used: 2:46:15.386636,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99488884, 'precision': 0.9949187, 'recall': 0.9948898, 'specificity': 0.9948898, 'f1': 0.9948888, 'auroc': 0.99984336, 'binary_precision': 0.9988247, 'binary_recall': 0.9909462, 'binary_specificity': 0.9988334, 'binary_f1_score': 0.9948699}
confusion matrix:
       0      1
0  29111     34
1    264  28895
---- Validation: 
scalar performance:
{'acc': 0.96036863, 'precision': 0.69733375, 'recall': 0.75628036, 'specificity': 0.75628036, 'f1': 0.7224693, 'auroc': 0.92939395, 'binary_precision': 0.4101266, 'binary_recall': 0.538206, 'binary_specificity': 0.97435474, 'binary_f1_score': 0.46551725}
confusion matrix:
       0    1
0  17705  466
1    278  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97275203, 'precision': 0.8087479, 'recall': 0.8549653, 'specificity': 0.8549653, 'f1': 0.83005536, 'auroc': 0.93489045, 'binary_precision': 0.62857145, 'binary_recall': 0.72727275, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.6743295}
confusion matrix:
      0    1
0  5893  104
1    66  176
early stop counter: 3
val acc:0.9603686332702637, best validation acc: 0.9700633883476257, corresponding to test acc:                         0.9624940156936646 / 0.9796441793441772
after epoch: 12,now: 2024-08-01 01:03:17.765995,epoch time: 0:14:48.407312,used: 3:01:03.793948,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9961409, 'precision': 0.9961571, 'recall': 0.99614143, 'specificity': 0.99614143, 'f1': 0.99614084, 'auroc': 0.99983585, 'binary_precision': 0.9990341, 'binary_recall': 0.99324346, 'binary_specificity': 0.99903935, 'binary_f1_score': 0.9961303}
confusion matrix:
       0      1
0  29119     28
1    197  28960
---- Validation: 
scalar performance:
{'acc': 0.9572258, 'precision': 0.66834617, 'recall': 0.69442827, 'specificity': 0.69442827, 'f1': 0.6803139, 'auroc': 0.92191094, 'binary_precision': 0.35622317, 'binary_recall': 0.41362128, 'binary_specificity': 0.9752353, 'binary_f1_score': 0.3827825}
confusion matrix:
       0    1
0  17721  450
1    353  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93749, 'precision': 0.6030896, 'recall': 0.6185214, 'specificity': 0.6185214, 'f1': 0.610127, 'auroc': 0.8925971, 'binary_precision': 0.23571429, 'binary_recall': 0.27272728, 'binary_specificity': 0.9643155, 'binary_f1_score': 0.25287357}
confusion matrix:
      0    1
0  5783  214
1   176   66
early stop counter: 4
val acc:0.9572257995605469, best validation acc: 0.9700633883476257, corresponding to test acc:                         0.9624940156936646 / 0.9796441793441772
after epoch: 13,now: 2024-08-01 01:18:12.364728,epoch time: 0:14:54.598733,used: 3:15:58.392681,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9887658, 'precision': 0.9889177, 'recall': 0.988764, 'specificity': 0.988764, 'f1': 0.9887649, 'auroc': 0.9997257, 'binary_precision': 0.98034984, 'binary_recall': 0.9975307, 'binary_specificity': 0.9799973, 'binary_f1_score': 0.9888657}
confusion matrix:
       0      1
0  28563    583
1     72  29086
---- Validation: 
scalar performance:
{'acc': 0.8975124, 'precision': 0.6077264, 'recall': 0.8820116, 'specificity': 0.8820116, 'f1': 0.6478379, 'auroc': 0.9411653, 'binary_precision': 0.22038917, 'binary_recall': 0.86544853, 'binary_specificity': 0.89857465, 'binary_f1_score': 0.3513149}
confusion matrix:
       0     1
0  16328  1843
1     81   521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8924507, 'precision': 0.62415683, 'recall': 0.8984523, 'specificity': 0.8984523, 'f1': 0.6679651, 'auroc': 0.9366509, 'binary_precision': 0.25259516, 'binary_recall': 0.90495867, 'binary_specificity': 0.89194596, 'binary_f1_score': 0.39495042}
confusion matrix:
      0    1
0  5349  648
1    23  219
early stop counter: 5
val acc:0.8975123763084412, best validation acc: 0.9700633883476257, corresponding to test acc:                         0.9624940156936646 / 0.9796441793441772
after epoch: 14,now: 2024-08-01 01:33:17.701101,epoch time: 0:15:05.336373,used: 3:31:03.729054,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99428856, 'precision': 0.9943485, 'recall': 0.9942901, 'specificity': 0.9942901, 'f1': 0.9942884, 'auroc': 0.99987656, 'binary_precision': 0.9998613, 'binary_recall': 0.98871744, 'binary_specificity': 0.99986273, 'binary_f1_score': 0.9942581}
confusion matrix:
       0      1
0  29140      4
1    329  28831
---- Validation: 
scalar performance:
{'acc': 0.9697971, 'precision': 0.76621103, 'recall': 0.64149654, 'specificity': 0.64149654, 'f1': 0.6830999, 'auroc': 0.9381604, 'binary_precision': 0.5555556, 'binary_recall': 0.29069766, 'binary_specificity': 0.99229544, 'binary_f1_score': 0.3816794}
confusion matrix:
       0    1
0  18031  140
1    427  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.6811867, 'recall': 0.51552844, 'specificity': 0.51552844, 'f1': 0.52046555, 'auroc': 0.9316318, 'binary_precision': 0.4, 'binary_recall': 0.03305785, 'binary_specificity': 0.997999, 'binary_f1_score': 0.061068702}
confusion matrix:
      0   1
0  5985  12
1   234   8
early stop counter: 6
val acc:0.9697970747947693, best validation acc: 0.9700633883476257, corresponding to test acc:                         0.9624940156936646 / 0.9796441793441772
after epoch: 15,now: 2024-08-01 01:47:59.918531,epoch time: 0:14:42.217430,used: 3:45:45.946484,model: dset_te_center0_erm_no_git_version_2024md_07md_31_22_02_13_seed_2_23775396
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 3:45:45.946484 at 2024-08-01 01:47:59.918531
persisted model performance metric: 

scalar performance:
{'acc': 0.962494, 'precision': 0.78497314, 'recall': 0.54627, 'specificity': 0.54627, 'f1': 0.57255113, 'auroc': 0.9334865, 'binary_precision': 0.6052632, 'binary_recall': 0.09504132, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.16428572}
confusion matrix:
      0   1
0  5982  15
1   219  23
oracle model performance metric: 

scalar performance:
{'acc': 0.9796442, 'precision': 0.88217473, 'recall': 0.8288094, 'specificity': 0.8288094, 'f1': 0.8532957, 'auroc': 0.9412296, 'binary_precision': 0.7777778, 'binary_recall': 0.6652893, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.71714926}
confusion matrix:
      0    1
0  5951   46
1    81  161
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455233 KiB |  13220 MiB |   1253 TiB |   1253 TiB |
|       from large pool | 413552 KiB |  13181 MiB |   1236 TiB |   1236 TiB |
|       from small pool |  41681 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455233 KiB |  13220 MiB |   1253 TiB |   1253 TiB |
|       from large pool | 413552 KiB |  13181 MiB |   1236 TiB |   1236 TiB |
|       from small pool |  41681 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   1250 TiB |   1250 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1233 TiB |   1233 TiB |
|       from small pool |  40678 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14492 MiB |  41660 MiB |  27184 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  41560 MiB |  27150 MiB |
|       from small pool |     66 MiB |     70 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 462270 KiB |   1256 MiB |    974 TiB |    974 TiB |
|       from large pool | 450704 KiB |   1252 MiB |    957 TiB |    957 TiB |
|       from small pool |  11566 KiB |     44 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8293    |  247057 K  |  247053 K  |
|       from large pool |     187    |    1413    |  116314 K  |  116314 K  |
|       from small pool |    3289    |    8104    |  130742 K  |  130739 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8293    |  247057 K  |  247053 K  |
|       from large pool |     187    |    1413    |  116314 K  |  116314 K  |
|       from small pool |    3289    |    8104    |  130742 K  |  130739 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1780    |    1145    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    3707    |  149630 K  |  149630 K  |
|       from large pool |      38    |     604    |   85458 K  |   85458 K  |
|       from small pool |      45    |    3668    |   64172 K  |   64172 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1253 TiB |   1253 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1236 TiB |   1236 TiB |
|       from small pool |      0 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1253 TiB |   1253 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1236 TiB |   1236 TiB |
|       from small pool |      0 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1250 TiB |   1250 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1233 TiB |   1233 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    896 MiB |  14492 MiB |  41660 MiB |  40764 MiB |
|       from large pool |    844 MiB |  14422 MiB |  41560 MiB |  40716 MiB |
|       from small pool |     52 MiB |     70 MiB |    100 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1256 MiB |    974 TiB |    974 TiB |
|       from large pool |  24320 KiB |   1252 MiB |    957 TiB |    957 TiB |
|       from small pool |      0 KiB |     48 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8293    |  247057 K  |  247057 K  |
|       from large pool |       2    |    1413    |  116314 K  |  116314 K  |
|       from small pool |       0    |    8104    |  130742 K  |  130742 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8293    |  247057 K  |  247057 K  |
|       from large pool |       2    |    1413    |  116314 K  |  116314 K  |
|       from small pool |       0    |    8104    |  130742 K  |  130742 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    1780    |    1716    |
|       from large pool |      38    |     602    |    1730    |    1692    |
|       from small pool |      26    |      35    |      50    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3707    |  149632 K  |  149632 K  |
|       from large pool |       3    |     604    |   85458 K  |   85458 K  |
|       from small pool |       0    |    3668    |   64173 K  |   64173 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 01:48:58 2024]
Finished job 0.
1 of 1 steps (100%) done
