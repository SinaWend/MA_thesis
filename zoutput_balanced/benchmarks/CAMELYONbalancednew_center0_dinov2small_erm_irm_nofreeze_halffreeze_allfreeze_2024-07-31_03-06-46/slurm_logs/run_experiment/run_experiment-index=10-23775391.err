Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 03:29:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391

 Experiment start at: 2024-07-31 03:35:41.752406
before training, model accuracy: 0.8589006662368774
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.87290794, 'precision': 0.874893, 'recall': 0.8728813, 'specificity': 0.8728813, 'f1': 0.8727337, 'auroc': 0.9546193, 'binary_precision': 0.8477957, 'binary_recall': 0.9092366, 'binary_specificity': 0.83652604, 'binary_f1_score': 0.8774419}
confusion matrix:
       0      1
0  23974   4685
1   2605  26096
---- Validation: 
scalar performance:
{'acc': 0.8445615, 'precision': 0.5369226, 'recall': 0.6427569, 'specificity': 0.6427569, 'f1': 0.5361742, 'auroc': 0.7337396, 'binary_precision': 0.09695683, 'binary_recall': 0.42612752, 'binary_specificity': 0.8593862, 'binary_f1_score': 0.15797059}
confusion matrix:
       0     1
0  15597  2552
1    369   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8636945, 'precision': 0.56711674, 'recall': 0.69983935, 'specificity': 0.69983935, 'f1': 0.58344704, 'auroc': 0.82305074, 'binary_precision': 0.1574074, 'binary_recall': 0.5210728, 'binary_specificity': 0.87860596, 'binary_f1_score': 0.24177776}
confusion matrix:
      0    1
0  5269  728
1   125  136
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 03:49:35.571481,epoch time: 0:13:53.819075,used: 0:13:53.819075,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9180614, 'precision': 0.9185349, 'recall': 0.91807497, 'specificity': 0.91807497, 'f1': 0.9180399, 'auroc': 0.97204185, 'binary_precision': 0.932814, 'binary_recall': 0.9011602, 'binary_specificity': 0.9349897, 'binary_f1_score': 0.91671395}
confusion matrix:
       0      1
0  26794   1863
1   2837  25866
---- Validation: 
scalar performance:
{'acc': 0.9206045, 'precision': 0.5735361, 'recall': 0.6423725, 'specificity': 0.6423725, 'f1': 0.5933453, 'auroc': 0.7849302, 'binary_precision': 0.17118512, 'binary_recall': 0.3437014, 'binary_specificity': 0.94104356, 'binary_f1_score': 0.22854188}
confusion matrix:
       0     1
0  17079  1070
1    422   221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92713326, 'precision': 0.64042634, 'recall': 0.7530949, 'specificity': 0.7530949, 'f1': 0.67662215, 'auroc': 0.8739804, 'binary_precision': 0.3006135, 'binary_recall': 0.5632184, 'binary_specificity': 0.94297147, 'binary_f1_score': 0.39200002}
confusion matrix:
      0    1
0  5655  342
1   114  147
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 04:03:03.243596,epoch time: 0:13:27.672115,used: 0:27:21.491190,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9361053, 'precision': 0.93663824, 'recall': 0.9361181, 'specificity': 0.9361181, 'f1': 0.936087, 'auroc': 0.98000276, 'binary_precision': 0.95207655, 'binary_recall': 0.9185394, 'binary_specificity': 0.9536969, 'binary_f1_score': 0.93500733}
confusion matrix:
       0      1
0  27332   1327
1   2338  26363
---- Validation: 
scalar performance:
{'acc': 0.9093231, 'precision': 0.5871208, 'recall': 0.7197881, 'specificity': 0.7197881, 'f1': 0.6160092, 'auroc': 0.8256229, 'binary_precision': 0.19246377, 'binary_recall': 0.5163297, 'binary_specificity': 0.92324644, 'binary_f1_score': 0.28040543}
confusion matrix:
       0     1
0  16756  1393
1    311   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.923458, 'precision': 0.6525908, 'recall': 0.8299677, 'specificity': 0.8299677, 'f1': 0.7006418, 'auroc': 0.8995328, 'binary_precision': 0.31772575, 'binary_recall': 0.72796935, 'binary_specificity': 0.931966, 'binary_f1_score': 0.44237486}
confusion matrix:
      0    1
0  5589  408
1    71  190
early stop counter: 1
val acc:0.9093230962753296, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 3,now: 2024-07-31 04:16:28.718426,epoch time: 0:13:25.474830,used: 0:40:46.966020,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94238144, 'precision': 0.9437373, 'recall': 0.9424027, 'specificity': 0.9424027, 'f1': 0.9423393, 'auroc': 0.983155, 'binary_precision': 0.96845835, 'binary_recall': 0.91464007, 'binary_specificity': 0.9701654, 'binary_f1_score': 0.9407802}
confusion matrix:
       0      1
0  27803    855
1   2450  26252
---- Validation: 
scalar performance:
{'acc': 0.9102278, 'precision': 0.58932304, 'recall': 0.7247568, 'specificity': 0.7247568, 'f1': 0.6190897, 'auroc': 0.834252, 'binary_precision': 0.19651163, 'binary_recall': 0.525661, 'binary_specificity': 0.92385256, 'binary_f1_score': 0.28607702}
confusion matrix:
       0     1
0  16767  1382
1    305   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92170024, 'precision': 0.6497091, 'recall': 0.82905054, 'specificity': 0.82905054, 'f1': 0.6973535, 'auroc': 0.9064673, 'binary_precision': 0.31198686, 'binary_recall': 0.72796935, 'binary_specificity': 0.93013173, 'binary_f1_score': 0.4367816}
confusion matrix:
      0    1
0  5578  419
1    71  190
early stop counter: 2
val acc:0.9102277755737305, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 4,now: 2024-07-31 04:29:57.573205,epoch time: 0:13:28.854779,used: 0:54:15.820799,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9485007, 'precision': 0.94953907, 'recall': 0.9485226, 'specificity': 0.9485226, 'f1': 0.9484726, 'auroc': 0.98644435, 'binary_precision': 0.97137207, 'binary_recall': 0.9243364, 'binary_specificity': 0.9727089, 'binary_f1_score': 0.9472707}
confusion matrix:
       0      1
0  27872    782
1   2172  26534
---- Validation: 
scalar performance:
{'acc': 0.9133674, 'precision': 0.5944838, 'recall': 0.73238266, 'specificity': 0.73238266, 'f1': 0.6260549, 'auroc': 0.84154665, 'binary_precision': 0.2063208, 'binary_recall': 0.5381026, 'binary_specificity': 0.9266626, 'binary_f1_score': 0.29827586}
confusion matrix:
       0     1
0  16818  1331
1    297   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.923458, 'precision': 0.6533687, 'recall': 0.83363235, 'specificity': 0.83363235, 'f1': 0.70192707, 'auroc': 0.90998054, 'binary_precision': 0.31893688, 'binary_recall': 0.7356322, 'binary_specificity': 0.93163246, 'binary_f1_score': 0.4449595}
confusion matrix:
      0    1
0  5587  410
1    69  192
early stop counter: 3
val acc:0.9133673906326294, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 5,now: 2024-07-31 04:43:23.315060,epoch time: 0:13:25.741855,used: 1:07:41.562654,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95050555, 'precision': 0.9517623, 'recall': 0.95052683, 'specificity': 0.95052683, 'f1': 0.9504727, 'auroc': 0.9880234, 'binary_precision': 0.97579104, 'binary_recall': 0.9240149, 'binary_specificity': 0.97703874, 'binary_f1_score': 0.9491974}
confusion matrix:
       0      1
0  27999    658
1   2181  26522
---- Validation: 
scalar performance:
{'acc': 0.916507, 'precision': 0.59827536, 'recall': 0.7340081, 'specificity': 0.7340081, 'f1': 0.63082033, 'auroc': 0.8473909, 'binary_precision': 0.21384425, 'binary_recall': 0.5381026, 'binary_specificity': 0.9299135, 'binary_f1_score': 0.30605927}
confusion matrix:
       0     1
0  16877  1272
1    297   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9253755, 'precision': 0.6554703, 'recall': 0.8291358, 'specificity': 0.8291358, 'f1': 0.7036618, 'auroc': 0.90989935, 'binary_precision': 0.32363012, 'binary_recall': 0.7241379, 'binary_specificity': 0.9341337, 'binary_f1_score': 0.44733727}
confusion matrix:
      0    1
0  5602  395
1    72  189
early stop counter: 4
val acc:0.9165070056915283, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 6,now: 2024-07-31 04:56:52.960296,epoch time: 0:13:29.645236,used: 1:21:11.207890,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9563633, 'precision': 0.9570585, 'recall': 0.95637906, 'specificity': 0.95637906, 'f1': 0.9563477, 'auroc': 0.99022704, 'binary_precision': 0.9750852, 'binary_recall': 0.93673134, 'binary_specificity': 0.9760268, 'binary_f1_score': 0.9555235}
confusion matrix:
       0      1
0  27970    687
1   1816  26887
---- Validation: 
scalar performance:
{'acc': 0.9145913, 'precision': 0.60128987, 'recall': 0.75326777, 'specificity': 0.75326777, 'f1': 0.635879, 'auroc': 0.8550271, 'binary_precision': 0.21838407, 'binary_recall': 0.5800933, 'binary_specificity': 0.9264422, 'binary_f1_score': 0.3173118}
confusion matrix:
       0     1
0  16814  1335
1    270   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9201023, 'precision': 0.6479707, 'recall': 0.83188146, 'specificity': 0.83188146, 'f1': 0.69570214, 'auroc': 0.9103409, 'binary_precision': 0.3081862, 'binary_recall': 0.7356322, 'binary_specificity': 0.92813075, 'binary_f1_score': 0.43438917}
confusion matrix:
      0    1
0  5566  431
1    69  192
early stop counter: 5
val acc:0.9145913124084473, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 7,now: 2024-07-31 05:10:17.776858,epoch time: 0:13:24.816562,used: 1:34:36.024452,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96011156, 'precision': 0.96065366, 'recall': 0.96012485, 'specificity': 0.96012485, 'f1': 0.96010065, 'auroc': 0.99106586, 'binary_precision': 0.97664934, 'binary_recall': 0.9428263, 'binary_specificity': 0.9774234, 'binary_f1_score': 0.9594398}
confusion matrix:
       0      1
0  28011    647
1   1641  27061
---- Validation: 
scalar performance:
{'acc': 0.9174117, 'precision': 0.6026508, 'recall': 0.7464773, 'specificity': 0.7464773, 'f1': 0.6370729, 'auroc': 0.8561609, 'binary_precision': 0.2216779, 'binary_recall': 0.562986, 'binary_specificity': 0.9299686, 'binary_f1_score': 0.31810194}
confusion matrix:
       0     1
0  16878  1271
1    281   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92154044, 'precision': 0.64905596, 'recall': 0.82713485, 'specificity': 0.82713485, 'f1': 0.696413, 'auroc': 0.90818465, 'binary_precision': 0.31085527, 'binary_recall': 0.7241379, 'binary_specificity': 0.93013173, 'binary_f1_score': 0.43498275}
confusion matrix:
      0    1
0  5578  419
1    72  189
early stop counter: 6
val acc:0.9174116849899292, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 8,now: 2024-07-31 05:23:40.096026,epoch time: 0:13:22.319168,used: 1:47:58.343620,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96133196, 'precision': 0.96158254, 'recall': 0.96134055, 'specificity': 0.96134055, 'f1': 0.9613272, 'auroc': 0.9919958, 'binary_precision': 0.97252256, 'binary_recall': 0.9495488, 'binary_specificity': 0.9731324, 'binary_f1_score': 0.9608984}
confusion matrix:
       0      1
0  27889    770
1   1448  27253
---- Validation: 
scalar performance:
{'acc': 0.9204981, 'precision': 0.60755515, 'recall': 0.7510754, 'specificity': 0.7510754, 'f1': 0.64329374, 'auroc': 0.85989684, 'binary_precision': 0.23120657, 'binary_recall': 0.56920683, 'binary_specificity': 0.93294394, 'binary_f1_score': 0.32884097}
confusion matrix:
       0     1
0  16932  1217
1    277   366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9250559, 'precision': 0.6553036, 'recall': 0.8308014, 'specificity': 0.8308014, 'f1': 0.7036933, 'auroc': 0.9105875, 'binary_precision': 0.32312927, 'binary_recall': 0.72796935, 'binary_specificity': 0.9336335, 'binary_f1_score': 0.4475854}
confusion matrix:
      0    1
0  5599  398
1    71  190
early stop counter: 7
val acc:0.9204980731010437, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 9,now: 2024-07-31 05:37:03.783456,epoch time: 0:13:23.687430,used: 2:01:22.031050,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9625872, 'precision': 0.9629692, 'recall': 0.9625983, 'specificity': 0.9625983, 'f1': 0.9625801, 'auroc': 0.9926139, 'binary_precision': 0.97646046, 'binary_recall': 0.9480872, 'binary_specificity': 0.9771094, 'binary_f1_score': 0.9620647}
confusion matrix:
       0      1
0  28002    656
1   1490  27212
---- Validation: 
scalar performance:
{'acc': 0.9186356, 'precision': 0.60621506, 'recall': 0.7546115, 'specificity': 0.7546115, 'f1': 0.6420099, 'auroc': 0.86015785, 'binary_precision': 0.22822087, 'binary_recall': 0.5785381, 'binary_specificity': 0.93068486, 'binary_f1_score': 0.32732072}
confusion matrix:
       0     1
0  16891  1258
1    271   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92042184, 'precision': 0.64727896, 'recall': 0.8265512, 'specificity': 0.8265512, 'f1': 0.6943617, 'auroc': 0.9092324, 'binary_precision': 0.30731708, 'binary_recall': 0.7241379, 'binary_specificity': 0.9289645, 'binary_f1_score': 0.43150684}
confusion matrix:
      0    1
0  5571  426
1    72  189
early stop counter: 8
val acc:0.9186356067657471, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 10,now: 2024-07-31 05:50:42.012305,epoch time: 0:13:38.228849,used: 2:15:00.259899,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96398187, 'precision': 0.9641562, 'recall': 0.9639908, 'specificity': 0.9639908, 'f1': 0.963979, 'auroc': 0.9930866, 'binary_precision': 0.9733812, 'binary_recall': 0.9541211, 'binary_specificity': 0.97386056, 'binary_f1_score': 0.96365494}
confusion matrix:
       0      1
0  27905    749
1   1317  27389
---- Validation: 
scalar performance:
{'acc': 0.919487, 'precision': 0.6077432, 'recall': 0.7565524, 'specificity': 0.7565524, 'f1': 0.6439969, 'auroc': 0.86371493, 'binary_precision': 0.23114957, 'binary_recall': 0.5816485, 'binary_specificity': 0.93145627, 'binary_f1_score': 0.3308271}
confusion matrix:
       0     1
0  16905  1244
1    269   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91802496, 'precision': 0.64238244, 'recall': 0.8198036, 'specificity': 0.8198036, 'f1': 0.6881164, 'auroc': 0.90788627, 'binary_precision': 0.29807693, 'binary_recall': 0.7126437, 'binary_specificity': 0.9269635, 'binary_f1_score': 0.420339}
confusion matrix:
      0    1
0  5559  438
1    75  186
early stop counter: 9
val acc:0.9194869995117188, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 11,now: 2024-07-31 06:04:07.040746,epoch time: 0:13:25.028441,used: 2:28:25.288340,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96649235, 'precision': 0.9666339, 'recall': 0.9664991, 'specificity': 0.9664991, 'f1': 0.96649015, 'auroc': 0.9938683, 'binary_precision': 0.9749574, 'binary_recall': 0.9576336, 'binary_specificity': 0.9753646, 'binary_f1_score': 0.9662179}
confusion matrix:
       0      1
0  27952    706
1   1216  27486
---- Validation: 
scalar performance:
{'acc': 0.9025117, 'precision': 0.5961517, 'recall': 0.77926636, 'specificity': 0.77926636, 'f1': 0.6299248, 'auroc': 0.866655, 'binary_precision': 0.2058387, 'binary_recall': 0.64696735, 'binary_specificity': 0.91156536, 'binary_f1_score': 0.31231233}
confusion matrix:
       0     1
0  16544  1605
1    227   416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8986897, 'precision': 0.6213696, 'recall': 0.82437384, 'specificity': 0.82437384, 'f1': 0.66224426, 'auroc': 0.9064909, 'binary_precision': 0.25492772, 'binary_recall': 0.743295, 'binary_specificity': 0.9054527, 'binary_f1_score': 0.37964776}
confusion matrix:
      0    1
0  5430  567
1    67  194
early stop counter: 10
val acc:0.902511715888977, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 12,now: 2024-07-31 06:17:32.408415,epoch time: 0:13:25.367669,used: 2:41:50.656009,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9670328, 'precision': 0.9672488, 'recall': 0.96704113, 'specificity': 0.96704113, 'f1': 0.96702933, 'auroc': 0.99405456, 'binary_precision': 0.9774889, 'binary_recall': 0.95613545, 'binary_specificity': 0.9779468, 'binary_f1_score': 0.96669424}
confusion matrix:
       0      1
0  28026    632
1   1259  27443
---- Validation: 
scalar performance:
{'acc': 0.91331416, 'precision': 0.60593015, 'recall': 0.7773584, 'specificity': 0.7773584, 'f1': 0.64314854, 'auroc': 0.8681164, 'binary_precision': 0.22580644, 'binary_recall': 0.63141525, 'binary_specificity': 0.9233016, 'binary_f1_score': 0.33265054}
confusion matrix:
       0     1
0  16757  1392
1    237   406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9082774, 'precision': 0.63070595, 'recall': 0.822047, 'specificity': 0.822047, 'f1': 0.6743387, 'auroc': 0.90691066, 'binary_precision': 0.27417028, 'binary_recall': 0.72796935, 'binary_specificity': 0.9161247, 'binary_f1_score': 0.39832288}
confusion matrix:
      0    1
0  5494  503
1    71  190
early stop counter: 11
val acc:0.913314163684845, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 13,now: 2024-07-31 06:30:55.840497,epoch time: 0:13:23.432082,used: 2:55:14.088091,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96741635, 'precision': 0.96757424, 'recall': 0.96742314, 'specificity': 0.96742314, 'f1': 0.9674139, 'auroc': 0.9942285, 'binary_precision': 0.9763528, 'binary_recall': 0.95808506, 'binary_specificity': 0.9767612, 'binary_f1_score': 0.9671327}
confusion matrix:
       0      1
0  27993    666
1   1203  27498
---- Validation: 
scalar performance:
{'acc': 0.9197531, 'precision': 0.6098373, 'recall': 0.76344067, 'specificity': 0.76344067, 'f1': 0.647072, 'auroc': 0.8668963, 'binary_precision': 0.23482525, 'binary_recall': 0.5956454, 'binary_specificity': 0.9312359, 'binary_f1_score': 0.3368514}
confusion matrix:
       0     1
0  16901  1248
1    260   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9157878, 'precision': 0.6390954, 'recall': 0.8186363, 'specificity': 0.8186363, 'f1': 0.6842143, 'auroc': 0.90705764, 'binary_precision': 0.29153606, 'binary_recall': 0.7126437, 'binary_specificity': 0.924629, 'binary_f1_score': 0.41379312}
confusion matrix:
      0    1
0  5545  452
1    75  186
early stop counter: 12
val acc:0.9197530746459961, best validation acc: 0.9206045269966125, corresponding to test acc:                         0.9271332621574402 / 0.9271332621574402
after epoch: 14,now: 2024-07-31 06:44:17.573775,epoch time: 0:13:21.733278,used: 3:08:35.821369,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9694386, 'precision': 0.9696255, 'recall': 0.9694468, 'specificity': 0.9694468, 'f1': 0.96943593, 'auroc': 0.9946629, 'binary_precision': 0.9791963, 'binary_recall': 0.9593074, 'binary_specificity': 0.9795861, 'binary_f1_score': 0.96914977}
confusion matrix:
       0      1
0  28072    585
1   1168  27535
---- Validation: 
scalar performance:
{'acc': 0.9253406, 'precision': 0.61719376, 'recall': 0.76333314, 'specificity': 0.76333314, 'f1': 0.65557826, 'auroc': 0.8687086, 'binary_precision': 0.24967062, 'binary_recall': 0.58942455, 'binary_specificity': 0.93724173, 'binary_f1_score': 0.35076353}
confusion matrix:
       0     1
0  17010  1139
1    264   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92170024, 'precision': 0.6477091, 'recall': 0.81988883, 'specificity': 0.81988883, 'f1': 0.69409704, 'auroc': 0.90649796, 'binary_precision': 0.30884808, 'binary_recall': 0.70881224, 'binary_specificity': 0.9309655, 'binary_f1_score': 0.43023252}
confusion matrix:
      0    1
0  5583  414
1    76  185
better model found
persisted
after epoch: 15,now: 2024-07-31 06:57:50.256860,epoch time: 0:13:32.683085,used: 3:22:08.504454,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_35_41_seed_0_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 3:22:08.504454 at 2024-07-31 06:57:50.256860
persisted model performance metric: 

scalar performance:
{'acc': 0.92170024, 'precision': 0.6477091, 'recall': 0.81988883, 'specificity': 0.81988883, 'f1': 0.69409704, 'auroc': 0.90649796, 'binary_precision': 0.30884808, 'binary_recall': 0.70881224, 'binary_specificity': 0.9309655, 'binary_f1_score': 0.43023252}
confusion matrix:
      0    1
0  5583  414
1    76  185
oracle model performance metric: 

scalar performance:
{'acc': 0.92713326, 'precision': 0.64042634, 'recall': 0.7530949, 'specificity': 0.7530949, 'f1': 0.67662215, 'auroc': 0.8739804, 'binary_precision': 0.3006135, 'binary_recall': 0.5632184, 'binary_specificity': 0.94297147, 'binary_f1_score': 0.39200002}
confusion matrix:
      0    1
0  5655  342
1   114  147
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205600 KiB |   7837 MiB | 361710 GiB | 361710 GiB |
|       from large pool | 188109 KiB |   7813 MiB | 356160 GiB | 356159 GiB |
|       from small pool |  17491 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205600 KiB |   7837 MiB | 361710 GiB | 361710 GiB |
|       from large pool | 188109 KiB |   7813 MiB | 356160 GiB | 356159 GiB |
|       from small pool |  17491 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 203141 KiB |   7835 MiB | 359743 GiB | 359743 GiB |
|       from large pool | 186659 KiB |   7812 MiB | 354204 GiB | 354204 GiB |
|       from small pool |  16482 KiB |     36 MiB |   5538 GiB |   5538 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  74975 KiB | 724416 KiB | 242815 GiB | 242815 GiB |
|       from large pool |  69938 KiB | 723497 KiB | 237256 GiB | 237256 GiB |
|       from small pool |   5037 KiB |  11093 KiB |   5558 GiB |   5558 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2988    |    7675    |   69869 K  |   69866 K  |
|       from large pool |      84    |     767    |   33482 K  |   33482 K  |
|       from small pool |    2904    |    7589    |   36386 K  |   36383 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2988    |    7675    |   69869 K  |   69866 K  |
|       from large pool |      84    |     767    |   33482 K  |   33482 K  |
|       from small pool |    2904    |    7589    |   36386 K  |   36383 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3607    |   41225 K  |   41225 K  |
|       from large pool |      11    |     349    |   24150 K  |   24150 K  |
|       from small pool |      22    |    3597    |   17074 K  |   17074 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB | 361710 GiB | 361710 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 356160 GiB | 356160 GiB |
|       from small pool |      0 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB | 361710 GiB | 361710 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 356160 GiB | 356160 GiB |
|       from small pool |      0 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB | 359743 GiB | 359743 GiB |
|       from large pool |  16640 KiB |   7812 MiB | 354204 GiB | 354204 GiB |
|       from small pool |      0 KiB |     36 MiB |   5538 GiB |   5538 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 280576 KiB |   8530 MiB |   8530 MiB |   8256 MiB |
|       from large pool | 258048 KiB |   8486 MiB |   8486 MiB |   8234 MiB |
|       from small pool |  22528 KiB |     44 MiB |     44 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 724416 KiB | 242815 GiB | 242815 GiB |
|       from large pool |  30464 KiB | 723497 KiB | 237256 GiB | 237256 GiB |
|       from small pool |      0 KiB |  19176 KiB |   5558 GiB |   5558 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |   69869 K  |   69869 K  |
|       from large pool |       2    |     767    |   33482 K  |   33482 K  |
|       from small pool |       0    |    7589    |   36386 K  |   36386 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |   69869 K  |   69869 K  |
|       from large pool |       2    |     767    |   33482 K  |   33482 K  |
|       from small pool |       0    |    7589    |   36386 K  |   36386 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     371    |     348    |
|       from large pool |      12    |     349    |     349    |     337    |
|       from small pool |      11    |      22    |      22    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3607    |   41226 K  |   41226 K  |
|       from large pool |       2    |     349    |   24150 K  |   24150 K  |
|       from small pool |       0    |    3597    |   17075 K  |   17075 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB | 361710 GiB | 361710 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 356160 GiB | 356160 GiB |
|       from small pool |      0 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB | 361710 GiB | 361710 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 356160 GiB | 356160 GiB |
|       from small pool |      0 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB | 359743 GiB | 359743 GiB |
|       from large pool |  16640 KiB |   7812 MiB | 354204 GiB | 354204 GiB |
|       from small pool |      0 KiB |     36 MiB |   5538 GiB |   5538 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 280576 KiB |   8530 MiB |   8530 MiB |   8256 MiB |
|       from large pool | 258048 KiB |   8486 MiB |   8486 MiB |   8234 MiB |
|       from small pool |  22528 KiB |     44 MiB |     44 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 724416 KiB | 242815 GiB | 242815 GiB |
|       from large pool |  30464 KiB | 723497 KiB | 237256 GiB | 237256 GiB |
|       from small pool |      0 KiB |  19176 KiB |   5558 GiB |   5558 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |   69869 K  |   69869 K  |
|       from large pool |       2    |     767    |   33482 K  |   33482 K  |
|       from small pool |       0    |    7589    |   36386 K  |   36386 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |   69869 K  |   69869 K  |
|       from large pool |       2    |     767    |   33482 K  |   33482 K  |
|       from small pool |       0    |    7589    |   36386 K  |   36386 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     371    |     348    |
|       from large pool |      12    |     349    |     349    |     337    |
|       from small pool |      11    |      22    |      22    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3607    |   41226 K  |   41226 K  |
|       from large pool |       2    |     349    |   24150 K  |   24150 K  |
|       from small pool |       0    |    3597    |   17075 K  |   17075 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391

 Experiment start at: 2024-07-31 07:04:57.236987
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8368162, 'precision': 0.8376255, 'recall': 0.83683395, 'specificity': 0.83683395, 'f1': 0.8367233, 'auroc': 0.9058562, 'binary_precision': 0.8543392, 'binary_recall': 0.81237644, 'binary_specificity': 0.8612915, 'binary_f1_score': 0.83282954}
confusion matrix:
       0      1
0  24794   3993
1   5409  23420
---- Validation: 
scalar performance:
{'acc': 0.8742796, 'precision': 0.50415623, 'recall': 0.51064473, 'specificity': 0.51064473, 'f1': 0.4981047, 'auroc': 0.73178875, 'binary_precision': 0.04340749, 'binary_recall': 0.11887073, 'binary_specificity': 0.9024188, 'binary_f1_score': 0.063593}
confusion matrix:
       0     1
0  16304  1763
1    593    80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9025137, 'precision': 0.528031, 'recall': 0.5445484, 'specificity': 0.5445484, 'f1': 0.532599, 'auroc': 0.79770887, 'binary_precision': 0.09411765, 'binary_recall': 0.15384616, 'binary_specificity': 0.9352506, 'binary_f1_score': 0.11678832}
confusion matrix:
      0    1
0  5561  385
1   220   40
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 07:18:58.083619,epoch time: 0:14:00.846632,used: 0:14:00.846632,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8900132, 'precision': 0.89554644, 'recall': 0.8900563, 'specificity': 0.8900563, 'f1': 0.88963497, 'auroc': 0.94582534, 'binary_precision': 0.942512, 'binary_recall': 0.8308647, 'binary_specificity': 0.9492479, 'binary_f1_score': 0.8831738}
confusion matrix:
       0      1
0  27326   1461
1   4876  23953
---- Validation: 
scalar performance:
{'acc': 0.8928495, 'precision': 0.5300281, 'recall': 0.56891376, 'specificity': 0.56891376, 'f1': 0.53569394, 'auroc': 0.7858989, 'binary_precision': 0.09074187, 'binary_recall': 0.21991085, 'binary_specificity': 0.91791666, 'binary_f1_score': 0.12847222}
confusion matrix:
       0     1
0  16584  1483
1    525   148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90976477, 'precision': 0.5532106, 'recall': 0.5832732, 'specificity': 0.5832732, 'f1': 0.5631584, 'auroc': 0.8418937, 'binary_precision': 0.14114833, 'binary_recall': 0.22692308, 'binary_specificity': 0.9396233, 'binary_f1_score': 0.17404132}
confusion matrix:
      0    1
0  5587  359
1   201   59
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 07:32:32.268445,epoch time: 0:13:34.184826,used: 0:27:35.031458,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90999025, 'precision': 0.91366076, 'recall': 0.91002464, 'specificity': 0.91002464, 'f1': 0.90979517, 'auroc': 0.9612026, 'binary_precision': 0.9528096, 'binary_recall': 0.86284643, 'binary_specificity': 0.9572029, 'binary_f1_score': 0.9055993}
confusion matrix:
       0      1
0  27555   1232
1   3954  24875
---- Validation: 
scalar performance:
{'acc': 0.90240127, 'precision': 0.56616294, 'recall': 0.6561233, 'specificity': 0.6561233, 'f1': 0.5856417, 'auroc': 0.82239544, 'binary_precision': 0.15636148, 'binary_recall': 0.3907875, 'binary_specificity': 0.921459, 'binary_f1_score': 0.22335456}
confusion matrix:
       0     1
0  16648  1419
1    410   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91153723, 'precision': 0.5896202, 'recall': 0.66327465, 'specificity': 0.66327465, 'f1': 0.61191416, 'auroc': 0.86620355, 'binary_precision': 0.20689656, 'binary_recall': 0.3923077, 'binary_specificity': 0.93424153, 'binary_f1_score': 0.27091634}
confusion matrix:
      0    1
0  5555  391
1   158  102
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 07:46:14.022018,epoch time: 0:13:41.753573,used: 0:41:16.785031,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9218099, 'precision': 0.9257356, 'recall': 0.92184496, 'specificity': 0.92184496, 'f1': 0.9216336, 'auroc': 0.97189695, 'binary_precision': 0.96679974, 'binary_recall': 0.8737382, 'binary_specificity': 0.9699517, 'binary_f1_score': 0.9179163}
confusion matrix:
       0      1
0  27922    865
1   3640  25189
---- Validation: 
scalar performance:
{'acc': 0.9123799, 'precision': 0.58315605, 'recall': 0.6827565, 'specificity': 0.6827565, 'f1': 0.60821867, 'auroc': 0.84002495, 'binary_precision': 0.18842444, 'binary_recall': 0.43536404, 'binary_specificity': 0.9301489, 'binary_f1_score': 0.26301616}
confusion matrix:
       0     1
0  16805  1262
1    380   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91927165, 'precision': 0.618347, 'recall': 0.7188026, 'specificity': 0.7188026, 'f1': 0.6493276, 'auroc': 0.881561, 'binary_precision': 0.25948104, 'binary_recall': 0.5, 'binary_specificity': 0.9376051, 'binary_f1_score': 0.3416557}
confusion matrix:
      0    1
0  5575  371
1   130  130
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 07:59:48.279952,epoch time: 0:13:34.257934,used: 0:54:51.042965,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92909956, 'precision': 0.9333966, 'recall': 0.9291342, 'specificity': 0.9291342, 'f1': 0.9289272, 'auroc': 0.97727215, 'binary_precision': 0.97672534, 'binary_recall': 0.87924933, 'binary_specificity': 0.97901905, 'binary_f1_score': 0.9254276}
confusion matrix:
       0      1
0  28184    604
1   3481  25347
---- Validation: 
scalar performance:
{'acc': 0.9174493, 'precision': 0.5990782, 'recall': 0.7168573, 'specificity': 0.7168573, 'f1': 0.6297958, 'auroc': 0.85356665, 'binary_precision': 0.21770026, 'binary_recall': 0.5007429, 'binary_specificity': 0.9329717, 'binary_f1_score': 0.3034669}
confusion matrix:
       0     1
0  16856  1211
1    336   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236223, 'precision': 0.63426876, 'recall': 0.75049675, 'specificity': 0.75049675, 'f1': 0.6702502, 'auroc': 0.8930244, 'binary_precision': 0.28853756, 'binary_recall': 0.56153846, 'binary_specificity': 0.9394551, 'binary_f1_score': 0.38120103}
confusion matrix:
      0    1
0  5586  360
1   114  146
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 08:13:31.731379,epoch time: 0:13:43.451427,used: 1:08:34.494392,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9375347, 'precision': 0.9390752, 'recall': 0.9375553, 'specificity': 0.9375553, 'f1': 0.9374819, 'auroc': 0.9808787, 'binary_precision': 0.9652565, 'binary_recall': 0.9078327, 'binary_specificity': 0.967278, 'binary_f1_score': 0.93566436}
confusion matrix:
       0      1
0  27846    942
1   2657  26171
---- Validation: 
scalar performance:
{'acc': 0.9098186, 'precision': 0.6050629, 'recall': 0.7701212, 'specificity': 0.7701212, 'f1': 0.64104074, 'auroc': 0.8664136, 'binary_precision': 0.22528364, 'binary_recall': 0.61961365, 'binary_specificity': 0.9206288, 'binary_f1_score': 0.3304279}
confusion matrix:
       0     1
0  16633  1434
1    256   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91443765, 'precision': 0.63372916, 'recall': 0.8008733, 'specificity': 0.8008733, 'f1': 0.67629164, 'auroc': 0.90376985, 'binary_precision': 0.28250402, 'binary_recall': 0.6769231, 'binary_specificity': 0.9248234, 'binary_f1_score': 0.39864102}
confusion matrix:
      0    1
0  5499  447
1    84  176
early stop counter: 1
val acc:0.9098185896873474, best validation acc: 0.9174492955207825, corresponding to test acc:                         0.9236223101615906 / 0.9236223101615906
after epoch: 6,now: 2024-07-31 08:27:08.697068,epoch time: 0:13:36.965689,used: 1:22:11.460081,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94354, 'precision': 0.9453278, 'recall': 0.9435643, 'specificity': 0.9435643, 'f1': 0.9434854, 'auroc': 0.984853, 'binary_precision': 0.97373587, 'binary_recall': 0.9117586, 'binary_specificity': 0.97537, 'binary_f1_score': 0.94172865}
confusion matrix:
       0      1
0  28077    709
1   2544  26286
---- Validation: 
scalar performance:
{'acc': 0.915048, 'precision': 0.61229, 'recall': 0.7764097, 'specificity': 0.7764097, 'f1': 0.6505205, 'auroc': 0.8733274, 'binary_precision': 0.23936471, 'binary_recall': 0.62704307, 'binary_specificity': 0.9257763, 'binary_f1_score': 0.34646964}
confusion matrix:
       0     1
0  16726  1341
1    251   422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9173381, 'precision': 0.63838696, 'recall': 0.8042258, 'specificity': 0.8042258, 'f1': 0.68193483, 'auroc': 0.9110949, 'binary_precision': 0.29159802, 'binary_recall': 0.6807692, 'binary_specificity': 0.92768246, 'binary_f1_score': 0.4083045}
confusion matrix:
      0    1
0  5516  430
1    83  177
early stop counter: 2
val acc:0.9150480031967163, best validation acc: 0.9174492955207825, corresponding to test acc:                         0.9236223101615906 / 0.9236223101615906
after epoch: 7,now: 2024-07-31 08:40:44.547025,epoch time: 0:13:35.849957,used: 1:35:47.310038,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9464906, 'precision': 0.94844556, 'recall': 0.94651353, 'specificity': 0.94651353, 'f1': 0.946434, 'auroc': 0.98694015, 'binary_precision': 0.97822934, 'binary_recall': 0.9133828, 'binary_specificity': 0.9796443, 'binary_f1_score': 0.9446946}
confusion matrix:
       0      1
0  28202    586
1   2497  26331
---- Validation: 
scalar performance:
{'acc': 0.9208111, 'precision': 0.61961585, 'recall': 0.77725273, 'specificity': 0.77725273, 'f1': 0.6593431, 'auroc': 0.87705624, 'binary_precision': 0.25409338, 'binary_recall': 0.6225854, 'binary_specificity': 0.93192005, 'binary_f1_score': 0.36089572}
confusion matrix:
       0     1
0  16837  1230
1    254   419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9226555, 'precision': 0.64723146, 'recall': 0.8088398, 'specificity': 0.8088398, 'f1': 0.6921861, 'auroc': 0.91526175, 'binary_precision': 0.3090278, 'binary_recall': 0.6846154, 'binary_specificity': 0.9330642, 'binary_f1_score': 0.42583734}
confusion matrix:
      0    1
0  5548  398
1    82  178
better model found
persisted
after epoch: 8,now: 2024-07-31 08:54:25.823032,epoch time: 0:13:41.276007,used: 1:49:28.586045,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94957995, 'precision': 0.95068055, 'recall': 0.9495981, 'specificity': 0.9495981, 'f1': 0.9495506, 'auroc': 0.9875536, 'binary_precision': 0.97313476, 'binary_recall': 0.92476326, 'binary_specificity': 0.9744329, 'binary_f1_score': 0.9483326}
confusion matrix:
       0      1
0  28051    736
1   2169  26660
---- Validation: 
scalar performance:
{'acc': 0.92278546, 'precision': 0.62619245, 'recall': 0.7932973, 'specificity': 0.7932973, 'f1': 0.66850317, 'auroc': 0.88465726, 'binary_precision': 0.26602176, 'binary_recall': 0.653789, 'binary_specificity': 0.93280566, 'binary_f1_score': 0.3781693}
confusion matrix:
       0     1
0  16853  1214
1    233   440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9200773, 'precision': 0.6467562, 'recall': 0.82404524, 'specificity': 0.82404524, 'f1': 0.6934558, 'auroc': 0.9220549, 'binary_precision': 0.3065574, 'binary_recall': 0.7192308, 'binary_specificity': 0.9288597, 'binary_f1_score': 0.42988506}
confusion matrix:
      0    1
0  5523  423
1    73  187
better model found
persisted
after epoch: 9,now: 2024-07-31 09:07:53.907397,epoch time: 0:13:28.084365,used: 2:02:56.670410,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95209664, 'precision': 0.95316535, 'recall': 0.95211357, 'specificity': 0.95211357, 'f1': 0.95206964, 'auroc': 0.9887804, 'binary_precision': 0.97534645, 'binary_recall': 0.92770916, 'binary_specificity': 0.976518, 'binary_f1_score': 0.95093155}
confusion matrix:
       0      1
0  28112    676
1   2084  26744
---- Validation: 
scalar performance:
{'acc': 0.9255603, 'precision': 0.6317055, 'recall': 0.7997433, 'specificity': 0.7997433, 'f1': 0.67546135, 'auroc': 0.8885989, 'binary_precision': 0.2766089, 'binary_recall': 0.6641902, 'binary_specificity': 0.9352964, 'binary_f1_score': 0.39056355}
confusion matrix:
       0     1
0  16898  1169
1    226   447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91959393, 'precision': 0.65148526, 'recall': 0.8495388, 'specificity': 0.8495388, 'f1': 0.70141053, 'auroc': 0.9250543, 'binary_precision': 0.31357256, 'binary_recall': 0.77307695, 'binary_specificity': 0.92600065, 'binary_f1_score': 0.44617093}
confusion matrix:
      0    1
0  5506  440
1    59  201
better model found
persisted
after epoch: 10,now: 2024-07-31 09:21:29.511314,epoch time: 0:13:35.603917,used: 2:16:32.274327,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95312065, 'precision': 0.95386356, 'recall': 0.9531355, 'specificity': 0.9531355, 'f1': 0.9531026, 'auroc': 0.98940283, 'binary_precision': 0.97240907, 'binary_recall': 0.93277603, 'binary_specificity': 0.973495, 'binary_f1_score': 0.9521803}
confusion matrix:
       0      1
0  28024    763
1   1938  26891
---- Validation: 
scalar performance:
{'acc': 0.92070436, 'precision': 0.62791955, 'recall': 0.81296074, 'specificity': 0.81296074, 'f1': 0.67228717, 'auroc': 0.8938409, 'binary_precision': 0.26784694, 'binary_recall': 0.6968796, 'binary_specificity': 0.9290419, 'binary_f1_score': 0.38696367}
confusion matrix:
       0     1
0  16785  1282
1    204   469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9087979, 'precision': 0.63930327, 'recall': 0.85677767, 'specificity': 0.85677767, 'f1': 0.6870532, 'auroc': 0.9291832, 'binary_precision': 0.28808865, 'binary_recall': 0.8, 'binary_specificity': 0.9135553, 'binary_f1_score': 0.4236253}
confusion matrix:
      0    1
0  5432  514
1    52  208
early stop counter: 1
val acc:0.9207043647766113, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 11,now: 2024-07-31 09:35:06.408017,epoch time: 0:13:36.896703,used: 2:30:09.171030,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95829284, 'precision': 0.9588335, 'recall': 0.9583061, 'specificity': 0.9583061, 'f1': 0.9582814, 'auroc': 0.9911752, 'binary_precision': 0.9747763, 'binary_recall': 0.940999, 'binary_specificity': 0.9756131, 'binary_f1_score': 0.95758986}
confusion matrix:
       0      1
0  28084    702
1   1701  27129
---- Validation: 
scalar performance:
{'acc': 0.9223052, 'precision': 0.6318584, 'recall': 0.8209437, 'specificity': 0.8209437, 'f1': 0.677665, 'auroc': 0.8964833, 'binary_precision': 0.27512923, 'binary_recall': 0.71173847, 'binary_specificity': 0.9301489, 'binary_f1_score': 0.3968517}
confusion matrix:
       0     1
0  16805  1262
1    194   479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90799224, 'precision': 0.63983095, 'recall': 0.86371315, 'specificity': 0.86371315, 'f1': 0.6880588, 'auroc': 0.9323299, 'binary_precision': 0.28843537, 'binary_recall': 0.8153846, 'binary_specificity': 0.9120417, 'binary_f1_score': 0.42613068}
confusion matrix:
      0    1
0  5423  523
1    48  212
early stop counter: 2
val acc:0.9223052263259888, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 12,now: 2024-07-31 09:49:25.399232,epoch time: 0:14:18.991215,used: 2:44:28.162245,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9585879, 'precision': 0.95902836, 'recall': 0.95859927, 'specificity': 0.95859927, 'f1': 0.9585787, 'auroc': 0.9917425, 'binary_precision': 0.97343075, 'binary_recall': 0.9429741, 'binary_specificity': 0.97422445, 'binary_f1_score': 0.9579604}
confusion matrix:
       0      1
0  28045    742
1   1644  27185
---- Validation: 
scalar performance:
{'acc': 0.9138741, 'precision': 0.62256604, 'recall': 0.8265848, 'specificity': 0.8265848, 'f1': 0.6664789, 'auroc': 0.89737487, 'binary_precision': 0.2558381, 'binary_recall': 0.73254085, 'binary_specificity': 0.9206288, 'binary_f1_score': 0.37923077}
confusion matrix:
       0     1
0  16633  1434
1    180   493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8905898, 'precision': 0.6228012, 'recall': 0.86198735, 'specificity': 0.86198735, 'f1': 0.66437787, 'auroc': 0.9336742, 'binary_precision': 0.25381905, 'binary_recall': 0.83076924, 'binary_specificity': 0.8932055, 'binary_f1_score': 0.38883892}
confusion matrix:
      0    1
0  5311  635
1    44  216
early stop counter: 3
val acc:0.913874089717865, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 13,now: 2024-07-31 10:03:13.771831,epoch time: 0:13:48.372599,used: 2:58:16.534844,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95995903, 'precision': 0.96044445, 'recall': 0.95997095, 'specificity': 0.95997095, 'f1': 0.9599492, 'auroc': 0.9916152, 'binary_precision': 0.9755774, 'binary_recall': 0.94359845, 'binary_specificity': 0.9763435, 'binary_f1_score': 0.9593215}
confusion matrix:
       0      1
0  28106    681
1   1626  27203
---- Validation: 
scalar performance:
{'acc': 0.91254, 'precision': 0.62323034, 'recall': 0.83662194, 'specificity': 0.83662194, 'f1': 0.6678052, 'auroc': 0.8972541, 'binary_precision': 0.25630677, 'binary_recall': 0.7548291, 'binary_specificity': 0.9184148, 'binary_f1_score': 0.38267422}
confusion matrix:
       0     1
0  16593  1474
1    165   508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88462776, 'precision': 0.61748475, 'recall': 0.85887605, 'specificity': 0.85887605, 'f1': 0.65637064, 'auroc': 0.9349737, 'binary_precision': 0.24324325, 'binary_recall': 0.83076924, 'binary_specificity': 0.88698286, 'binary_f1_score': 0.37630662}
confusion matrix:
      0    1
0  5274  672
1    44  216
early stop counter: 4
val acc:0.9125400185585022, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 14,now: 2024-07-31 10:17:04.528952,epoch time: 0:13:50.757121,used: 3:12:07.291965,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9605318, 'precision': 0.960618, 'recall': 0.9605369, 'specificity': 0.9605369, 'f1': 0.9605303, 'auroc': 0.9923059, 'binary_precision': 0.9671064, 'binary_recall': 0.95355374, 'binary_specificity': 0.96752006, 'binary_f1_score': 0.96028227}
confusion matrix:
       0      1
0  27852    935
1   1339  27490
---- Validation: 
scalar performance:
{'acc': 0.91051227, 'precision': 0.62141585, 'recall': 0.83843136, 'specificity': 0.83843136, 'f1': 0.66545004, 'auroc': 0.89898384, 'binary_precision': 0.2524655, 'binary_recall': 0.76077265, 'binary_specificity': 0.91609013, 'binary_f1_score': 0.3791188}
confusion matrix:
       0     1
0  16551  1516
1    161   512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88124394, 'precision': 0.6172999, 'recall': 0.8699831, 'specificity': 0.8699831, 'f1': 0.655687, 'auroc': 0.93745244, 'binary_precision': 0.24160346, 'binary_recall': 0.8576923, 'binary_specificity': 0.8822738, 'binary_f1_score': 0.3770076}
confusion matrix:
      0    1
0  5246  700
1    37  223
early stop counter: 5
val acc:0.9105122685432434, best validation acc: 0.9255602955818176, corresponding to test acc:                         0.9195939302444458 / 0.9236223101615906
after epoch: 15,now: 2024-07-31 10:30:50.915408,epoch time: 0:13:46.386456,used: 3:25:53.678421,model: dset_te_center0_erm_no_git_version_2024md_07md_31_07_04_56_seed_1_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 3:25:53.678421 at 2024-07-31 10:30:50.915408
persisted model performance metric: 

scalar performance:
{'acc': 0.91959393, 'precision': 0.65148526, 'recall': 0.8495388, 'specificity': 0.8495388, 'f1': 0.70141053, 'auroc': 0.9250543, 'binary_precision': 0.31357256, 'binary_recall': 0.77307695, 'binary_specificity': 0.92600065, 'binary_f1_score': 0.44617093}
confusion matrix:
      0    1
0  5506  440
1    59  201
oracle model performance metric: 

scalar performance:
{'acc': 0.9236223, 'precision': 0.63426876, 'recall': 0.75049675, 'specificity': 0.75049675, 'f1': 0.6702502, 'auroc': 0.8930244, 'binary_precision': 0.28853756, 'binary_recall': 0.56153846, 'binary_specificity': 0.9394551, 'binary_f1_score': 0.38120103}
confusion matrix:
      0    1
0  5586  360
1   114  146
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197546 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool | 180067 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |  17479 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197546 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool | 180067 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |  17479 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7835 MiB | 724305 GiB | 724304 GiB |
|       from large pool | 178979 KiB |   7812 MiB | 713302 GiB | 713302 GiB |
|       from small pool |  16480 KiB |     36 MiB |  11002 GiB |  11002 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |  16786 MiB |   8256 MiB |
|       from large pool |   8492 MiB |   8492 MiB |  16726 MiB |   8234 MiB |
|       from small pool |     38 MiB |     44 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  46166 KiB | 738183 KiB | 465436 GiB | 465436 GiB |
|       from large pool |  37021 KiB | 736500 KiB | 454399 GiB | 454398 GiB |
|       from small pool |   9145 KiB |  19176 KiB |  11037 GiB |  11037 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7697    |  139715 K  |  139712 K  |
|       from large pool |      79    |     767    |   67375 K  |   67375 K  |
|       from small pool |    2875    |    7616    |   72340 K  |   72337 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7697    |  139715 K  |  139712 K  |
|       from large pool |      79    |     767    |   67375 K  |   67375 K  |
|       from small pool |    2875    |    7616    |   72340 K  |   72337 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     716    |     348    |
|       from large pool |     349    |     349    |     686    |     337    |
|       from small pool |      19    |      22    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3626    |   81618 K  |   81618 K  |
|       from large pool |       9    |     352    |   49381 K  |   49381 K  |
|       from small pool |      27    |    3616    |   32237 K  |   32237 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |      0 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |      0 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB | 724305 GiB | 724305 GiB |
|       from large pool |  16640 KiB |   7812 MiB | 713302 GiB | 713302 GiB |
|       from small pool |      0 KiB |     36 MiB |  11002 GiB |  11002 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 243712 KiB |   8530 MiB |  16786 MiB |  16548 MiB |
|       from large pool | 217088 KiB |   8492 MiB |  16726 MiB |  16514 MiB |
|       from small pool |  26624 KiB |     44 MiB |     60 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 738183 KiB | 465436 GiB | 465436 GiB |
|       from large pool |  30464 KiB | 736500 KiB | 454399 GiB | 454399 GiB |
|       from small pool |      0 KiB |  22399 KiB |  11037 GiB |  11037 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  139715 K  |  139715 K  |
|       from large pool |       2    |     767    |   67375 K  |   67375 K  |
|       from small pool |       0    |    7616    |   72340 K  |   72340 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  139715 K  |  139715 K  |
|       from large pool |       2    |     767    |   67375 K  |   67375 K  |
|       from small pool |       0    |    7616    |   72340 K  |   72340 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      13    |      22    |      30    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3626    |   81620 K  |   81620 K  |
|       from large pool |       2    |     352    |   49381 K  |   49381 K  |
|       from small pool |       0    |    3616    |   32239 K  |   32239 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |      0 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |      0 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB | 724305 GiB | 724305 GiB |
|       from large pool |  16640 KiB |   7812 MiB | 713302 GiB | 713302 GiB |
|       from small pool |      0 KiB |     36 MiB |  11002 GiB |  11002 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 243712 KiB |   8530 MiB |  16786 MiB |  16548 MiB |
|       from large pool | 217088 KiB |   8492 MiB |  16726 MiB |  16514 MiB |
|       from small pool |  26624 KiB |     44 MiB |     60 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 738183 KiB | 465436 GiB | 465436 GiB |
|       from large pool |  30464 KiB | 736500 KiB | 454399 GiB | 454399 GiB |
|       from small pool |      0 KiB |  22399 KiB |  11037 GiB |  11037 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  139715 K  |  139715 K  |
|       from large pool |       2    |     767    |   67375 K  |   67375 K  |
|       from small pool |       0    |    7616    |   72340 K  |   72340 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  139715 K  |  139715 K  |
|       from large pool |       2    |     767    |   67375 K  |   67375 K  |
|       from small pool |       0    |    7616    |   72340 K  |   72340 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      13    |      22    |      30    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3626    |   81620 K  |   81620 K  |
|       from large pool |       2    |     352    |   49381 K  |   49381 K  |
|       from small pool |       0    |    3616    |   32239 K  |   32239 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391

 Experiment start at: 2024-07-31 10:37:47.564935
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8655667, 'precision': 0.8688595, 'recall': 0.86557484, 'specificity': 0.86557484, 'f1': 0.8652679, 'auroc': 0.93124056, 'binary_precision': 0.90375364, 'binary_recall': 0.8183284, 'binary_specificity': 0.91282123, 'binary_f1_score': 0.85892224}
confusion matrix:
       0      1
0  26606   2541
1   5297  23860
---- Validation: 
scalar performance:
{'acc': 0.8665637, 'precision': 0.54678357, 'recall': 0.6716869, 'specificity': 0.6716869, 'f1': 0.5547649, 'auroc': 0.7449173, 'binary_precision': 0.11336855, 'binary_recall': 0.46345514, 'binary_specificity': 0.8799186, 'binary_f1_score': 0.18217434}
confusion matrix:
       0     1
0  15989  2182
1    323   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73248917, 'precision': 0.5019713, 'recall': 0.509902, 'specificity': 0.509902, 'f1': 0.45798713, 'auroc': 0.53973544, 'binary_precision': 0.041746948, 'binary_recall': 0.26859504, 'binary_specificity': 0.75120896, 'binary_f1_score': 0.07226237}
confusion matrix:
      0     1
0  4505  1492
1   177    65
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 10:52:25.447371,epoch time: 0:14:37.882436,used: 0:14:37.882436,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90619856, 'precision': 0.90881157, 'recall': 0.9062067, 'specificity': 0.9062067, 'f1': 0.9060496, 'auroc': 0.9604081, 'binary_precision': 0.94154704, 'binary_recall': 0.86621165, 'binary_specificity': 0.94620186, 'binary_f1_score': 0.9023096}
confusion matrix:
       0      1
0  27578   1568
1   3901  25257
---- Validation: 
scalar performance:
{'acc': 0.91759443, 'precision': 0.5667821, 'recall': 0.6458494, 'specificity': 0.6458494, 'f1': 0.5866092, 'auroc': 0.7686467, 'binary_precision': 0.15586308, 'binary_recall': 0.3554817, 'binary_specificity': 0.93621707, 'binary_f1_score': 0.21670885}
confusion matrix:
       0     1
0  17012  1159
1    388   214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85654753, 'precision': 0.5208923, 'recall': 0.56055504, 'specificity': 0.56055504, 'f1': 0.5183439, 'auroc': 0.6601738, 'binary_precision': 0.07542263, 'binary_recall': 0.23966943, 'binary_specificity': 0.8814407, 'binary_f1_score': 0.11473788}
confusion matrix:
      0    1
0  5286  711
1   184   58
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 11:07:59.487503,epoch time: 0:15:34.040132,used: 0:30:11.922568,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92276686, 'precision': 0.9260475, 'recall': 0.9227774, 'specificity': 0.9227774, 'f1': 0.9226192, 'auroc': 0.97092295, 'binary_precision': 0.96349347, 'binary_recall': 0.878871, 'binary_specificity': 0.9666838, 'binary_f1_score': 0.9192388}
confusion matrix:
       0      1
0  28174    971
1   3532  25627
---- Validation: 
scalar performance:
{'acc': 0.926064, 'precision': 0.57679564, 'recall': 0.64942145, 'specificity': 0.64942145, 'f1': 0.5979977, 'auroc': 0.78516674, 'binary_precision': 0.17574258, 'binary_recall': 0.3538206, 'binary_specificity': 0.9450223, 'binary_f1_score': 0.23484012}
confusion matrix:
       0    1
0  17172  999
1    389  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8730566, 'precision': 0.53522635, 'recall': 0.59293556, 'specificity': 0.59293556, 'f1': 0.5408097, 'auroc': 0.7176789, 'binary_precision': 0.10144927, 'binary_recall': 0.2892562, 'binary_specificity': 0.89661497, 'binary_f1_score': 0.15021458}
confusion matrix:
      0    1
0  5377  620
1   172   70
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 11:22:50.050574,epoch time: 0:14:50.563071,used: 0:45:02.485639,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9330406, 'precision': 0.93605804, 'recall': 0.93305063, 'specificity': 0.93305063, 'f1': 0.9329256, 'auroc': 0.9773191, 'binary_precision': 0.9723916, 'binary_recall': 0.89142287, 'binary_specificity': 0.97467834, 'binary_f1_score': 0.9301485}
confusion matrix:
       0      1
0  28407    738
1   3166  25993
---- Validation: 
scalar performance:
{'acc': 0.9322964, 'precision': 0.5910282, 'recall': 0.6654896, 'specificity': 0.6654896, 'f1': 0.61470354, 'auroc': 0.805328, 'binary_precision': 0.20319432, 'binary_recall': 0.38039866, 'binary_specificity': 0.9505806, 'binary_f1_score': 0.264893}
confusion matrix:
       0    1
0  17273  898
1    373  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8810707, 'precision': 0.5537501, 'recall': 0.64072466, 'specificity': 0.64072466, 'f1': 0.56723636, 'auroc': 0.7685585, 'binary_precision': 0.13450292, 'binary_recall': 0.38016528, 'binary_specificity': 0.901284, 'binary_f1_score': 0.19870408}
confusion matrix:
      0    1
0  5405  592
1   150   92
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 11:37:01.714050,epoch time: 0:14:11.663476,used: 0:59:14.149115,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93698543, 'precision': 0.93894917, 'recall': 0.9369912, 'specificity': 0.9369912, 'f1': 0.9369154, 'auroc': 0.9806409, 'binary_precision': 0.9683514, 'binary_recall': 0.9035223, 'binary_specificity': 0.97046006, 'binary_f1_score': 0.9348142}
confusion matrix:
       0      1
0  28286    861
1   2813  26344
---- Validation: 
scalar performance:
{'acc': 0.93320197, 'precision': 0.5979714, 'recall': 0.6812153, 'specificity': 0.6812153, 'f1': 0.6241984, 'auroc': 0.81923187, 'binary_precision': 0.21602787, 'binary_recall': 0.41196012, 'binary_specificity': 0.9504705, 'binary_f1_score': 0.28342858}
confusion matrix:
       0    1
0  17271  900
1    354  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8826735, 'precision': 0.56891316, 'recall': 0.6891442, 'specificity': 0.6891442, 'f1': 0.5885446, 'auroc': 0.8052746, 'binary_precision': 0.16066483, 'binary_recall': 0.47933885, 'binary_specificity': 0.8989495, 'binary_f1_score': 0.24066392}
confusion matrix:
      0    1
0  5391  606
1   126  116
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 11:51:02.226188,epoch time: 0:14:00.512138,used: 1:13:14.661253,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9436574, 'precision': 0.9449053, 'recall': 0.9436637, 'specificity': 0.9436637, 'f1': 0.9436184, 'auroc': 0.984382, 'binary_precision': 0.96852815, 'binary_recall': 0.91714394, 'binary_specificity': 0.97018355, 'binary_f1_score': 0.94213593}
confusion matrix:
       0      1
0  28276    869
1   2416  26743
---- Validation: 
scalar performance:
{'acc': 0.92979276, 'precision': 0.60391444, 'recall': 0.71639454, 'specificity': 0.71639454, 'f1': 0.6357593, 'auroc': 0.8305831, 'binary_precision': 0.22546013, 'binary_recall': 0.4883721, 'binary_specificity': 0.94441694, 'binary_f1_score': 0.3084995}
confusion matrix:
       0     1
0  17161  1010
1    308   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8692098, 'precision': 0.5724965, 'recall': 0.72972643, 'specificity': 0.72972643, 'f1': 0.59189117, 'auroc': 0.8323252, 'binary_precision': 0.16393442, 'binary_recall': 0.5785124, 'binary_specificity': 0.8809405, 'binary_f1_score': 0.25547445}
confusion matrix:
      0    1
0  5283  714
1   102  140
early stop counter: 1
val acc:0.9297927618026733, best validation acc: 0.9332019686698914, corresponding to test acc:                         0.8826735019683838 / 0.8826735019683838
after epoch: 6,now: 2024-07-31 12:05:21.710323,epoch time: 0:14:19.484135,used: 1:27:34.145388,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9493174, 'precision': 0.95042986, 'recall': 0.9493216, 'specificity': 0.9493216, 'f1': 0.9492864, 'auroc': 0.9868624, 'binary_precision': 0.9728579, 'binary_recall': 0.92444354, 'binary_specificity': 0.9741998, 'binary_f1_score': 0.94803303}
confusion matrix:
       0      1
0  28395    752
1   2203  26954
---- Validation: 
scalar performance:
{'acc': 0.93069834, 'precision': 0.60612494, 'recall': 0.7192714, 'specificity': 0.7192714, 'f1': 0.6384819, 'auroc': 0.8349421, 'binary_precision': 0.22969837, 'binary_recall': 0.49335548, 'binary_specificity': 0.9451874, 'binary_f1_score': 0.31345645}
confusion matrix:
       0    1
0  17175  996
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86985093, 'precision': 0.5808644, 'recall': 0.7637665, 'specificity': 0.7637665, 'f1': 0.60366696, 'auroc': 0.8500669, 'binary_precision': 0.17760181, 'binary_recall': 0.6487603, 'binary_specificity': 0.87877274, 'binary_f1_score': 0.27886322}
confusion matrix:
      0    1
0  5270  727
1    85  157
early stop counter: 2
val acc:0.9306983351707458, best validation acc: 0.9332019686698914, corresponding to test acc:                         0.8826735019683838 / 0.8826735019683838
after epoch: 7,now: 2024-07-31 12:19:27.333037,epoch time: 0:14:05.622714,used: 1:41:39.768102,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9516843, 'precision': 0.95250666, 'recall': 0.95168793, 'specificity': 0.95168793, 'f1': 0.9516626, 'auroc': 0.98791194, 'binary_precision': 0.9718401, 'binary_recall': 0.9303426, 'binary_specificity': 0.97303325, 'binary_f1_score': 0.9506387}
confusion matrix:
       0      1
0  28361    786
1   2031  27126
---- Validation: 
scalar performance:
{'acc': 0.93682414, 'precision': 0.6147338, 'recall': 0.7136023, 'specificity': 0.7136023, 'f1': 0.64611506, 'auroc': 0.8392244, 'binary_precision': 0.24740484, 'binary_recall': 0.47508305, 'binary_specificity': 0.9521215, 'binary_f1_score': 0.32536972}
confusion matrix:
       0    1
0  17301  870
1    316  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88844365, 'precision': 0.5939709, 'recall': 0.7714553, 'specificity': 0.7714553, 'f1': 0.6244219, 'auroc': 0.86199164, 'binary_precision': 0.20365535, 'binary_recall': 0.6446281, 'binary_specificity': 0.89828247, 'binary_f1_score': 0.3095238}
confusion matrix:
      0    1
0  5387  610
1    86  156
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-31 12:33:36.733265,epoch time: 0:14:09.400228,used: 1:55:49.168330,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9553375, 'precision': 0.9563687, 'recall': 0.95534164, 'specificity': 0.95534164, 'f1': 0.9553126, 'auroc': 0.9893596, 'binary_precision': 0.97810507, 'binary_recall': 0.93154305, 'binary_specificity': 0.9791402, 'binary_f1_score': 0.9542564}
confusion matrix:
       0      1
0  28539    608
1   1996  27161
---- Validation: 
scalar performance:
{'acc': 0.9317637, 'precision': 0.615208, 'recall': 0.7455193, 'specificity': 0.7455193, 'f1': 0.651687, 'auroc': 0.84396315, 'binary_precision': 0.2460733, 'binary_recall': 0.54651165, 'binary_specificity': 0.944527, 'binary_f1_score': 0.33935016}
confusion matrix:
       0     1
0  17163  1008
1    273   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87449914, 'precision': 0.5902009, 'recall': 0.7939428, 'specificity': 0.7939428, 'f1': 0.61751574, 'auroc': 0.87022996, 'binary_precision': 0.19365798, 'binary_recall': 0.7066116, 'binary_specificity': 0.881274, 'binary_f1_score': 0.304}
confusion matrix:
      0    1
0  5285  712
1    71  171
early stop counter: 1
val acc:0.9317637085914612, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 9,now: 2024-07-31 12:48:12.679469,epoch time: 0:14:35.946204,used: 2:10:25.114534,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95636666, 'precision': 0.9573506, 'recall': 0.9563698, 'specificity': 0.9563698, 'f1': 0.9563434, 'auroc': 0.99015176, 'binary_precision': 0.97859865, 'binary_recall': 0.9331527, 'binary_specificity': 0.97958696, 'binary_f1_score': 0.95533556}
confusion matrix:
       0      1
0  28553    595
1   1949  27207
---- Validation: 
scalar performance:
{'acc': 0.9319768, 'precision': 0.61708933, 'recall': 0.75125074, 'specificity': 0.75125074, 'f1': 0.6544592, 'auroc': 0.8474581, 'binary_precision': 0.2494432, 'binary_recall': 0.55813956, 'binary_specificity': 0.9443619, 'binary_f1_score': 0.34479222}
confusion matrix:
       0     1
0  17160  1011
1    266   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8761019, 'precision': 0.59349895, 'recall': 0.80469024, 'specificity': 0.80469024, 'f1': 0.6224006, 'auroc': 0.87826073, 'binary_precision': 0.1993205, 'binary_recall': 0.72727275, 'binary_specificity': 0.88210773, 'binary_f1_score': 0.31288886}
confusion matrix:
      0    1
0  5290  707
1    66  176
early stop counter: 2
val acc:0.9319767951965332, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 10,now: 2024-07-31 13:02:22.247728,epoch time: 0:14:09.568259,used: 2:24:34.682793,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9589394, 'precision': 0.95951545, 'recall': 0.9589418, 'specificity': 0.9589418, 'f1': 0.9589266, 'auroc': 0.9911387, 'binary_precision': 0.97581965, 'binary_recall': 0.9412128, 'binary_specificity': 0.9766708, 'binary_f1_score': 0.95820385}
confusion matrix:
       0      1
0  28468    680
1   1714  27442
---- Validation: 
scalar performance:
{'acc': 0.9256379, 'precision': 0.61004883, 'recall': 0.760022, 'specificity': 0.760022, 'f1': 0.6476114, 'auroc': 0.8511698, 'binary_precision': 0.23462567, 'binary_recall': 0.58305645, 'binary_specificity': 0.9369875, 'binary_f1_score': 0.33460435}
confusion matrix:
       0     1
0  17026  1145
1    251   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87225515, 'precision': 0.595467, 'recall': 0.82449937, 'specificity': 0.82449937, 'f1': 0.62444896, 'auroc': 0.8876381, 'binary_precision': 0.20129171, 'binary_recall': 0.77272725, 'binary_specificity': 0.8762715, 'binary_f1_score': 0.31938517}
confusion matrix:
      0    1
0  5255  742
1    55  187
early stop counter: 3
val acc:0.9256379008293152, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 11,now: 2024-07-31 13:16:16.747391,epoch time: 0:13:54.499663,used: 2:38:29.182456,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96096325, 'precision': 0.9615675, 'recall': 0.96096754, 'specificity': 0.96096754, 'f1': 0.96095073, 'auroc': 0.9923178, 'binary_precision': 0.97832817, 'binary_recall': 0.9428307, 'binary_specificity': 0.97910446, 'binary_f1_score': 0.9602515}
confusion matrix:
       0      1
0  28536    609
1   1667  27492
---- Validation: 
scalar performance:
{'acc': 0.92851436, 'precision': 0.61363685, 'recall': 0.75829566, 'specificity': 0.75829566, 'f1': 0.6515361, 'auroc': 0.85427547, 'binary_precision': 0.24198048, 'binary_recall': 0.57641196, 'binary_specificity': 0.9401794, 'binary_f1_score': 0.34086445}
confusion matrix:
       0     1
0  17084  1087
1    255   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8791473, 'precision': 0.6012256, 'recall': 0.83204997, 'specificity': 0.83204997, 'f1': 0.6337336, 'auroc': 0.89064777, 'binary_precision': 0.21235955, 'binary_recall': 0.78099173, 'binary_specificity': 0.8831082, 'binary_f1_score': 0.33392227}
confusion matrix:
      0    1
0  5296  701
1    53  189
early stop counter: 4
val acc:0.9285143613815308, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 12,now: 2024-07-31 13:30:09.714131,epoch time: 0:13:52.966740,used: 2:52:22.149196,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9613234, 'precision': 0.9621246, 'recall': 0.9613284, 'specificity': 0.9613284, 'f1': 0.9613069, 'auroc': 0.9921154, 'binary_precision': 0.9814258, 'binary_recall': 0.9404644, 'binary_specificity': 0.98219246, 'binary_f1_score': 0.9605086}
confusion matrix:
       0      1
0  28626    519
1   1736  27423
---- Validation: 
scalar performance:
{'acc': 0.9308049, 'precision': 0.61697817, 'recall': 0.7578728, 'specificity': 0.7578728, 'f1': 0.65518755, 'auroc': 0.85663784, 'binary_precision': 0.24873829, 'binary_recall': 0.5730897, 'binary_specificity': 0.94265586, 'binary_f1_score': 0.346908}
confusion matrix:
       0     1
0  17129  1042
1    257   345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88235295, 'precision': 0.6032679, 'recall': 0.8317348, 'specificity': 0.8317348, 'f1': 0.6370858, 'auroc': 0.8930174, 'binary_precision': 0.21658987, 'binary_recall': 0.7768595, 'binary_specificity': 0.88661, 'binary_f1_score': 0.33873874}
confusion matrix:
      0    1
0  5317  680
1    54  188
early stop counter: 5
val acc:0.9308049082756042, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 13,now: 2024-07-31 13:44:23.233585,epoch time: 0:14:13.519454,used: 3:06:35.668650,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.962301, 'precision': 0.962734, 'recall': 0.96230364, 'specificity': 0.96230364, 'f1': 0.9622924, 'auroc': 0.99246275, 'binary_precision': 0.976931, 'binary_recall': 0.9469767, 'binary_specificity': 0.9776306, 'binary_f1_score': 0.96172065}
confusion matrix:
       0      1
0  28495    652
1   1546  27611
---- Validation: 
scalar performance:
{'acc': 0.92292124, 'precision': 0.60798436, 'recall': 0.76584613, 'specificity': 0.76584613, 'f1': 0.6456783, 'auroc': 0.86078906, 'binary_precision': 0.23003195, 'binary_recall': 0.59800667, 'binary_specificity': 0.93368554, 'binary_f1_score': 0.33225656}
confusion matrix:
       0     1
0  16966  1205
1    242   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701715, 'precision': 0.5961118, 'recall': 0.8333292, 'specificity': 0.8333292, 'f1': 0.6249125, 'auroc': 0.89731777, 'binary_precision': 0.20168068, 'binary_recall': 0.7933884, 'binary_specificity': 0.87327, 'binary_f1_score': 0.32160804}
confusion matrix:
      0    1
0  5237  760
1    50  192
early stop counter: 6
val acc:0.9229212403297424, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 14,now: 2024-07-31 13:59:17.606677,epoch time: 0:14:54.373092,used: 3:21:30.041742,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96310717, 'precision': 0.9636421, 'recall': 0.9631107, 'specificity': 0.9631107, 'f1': 0.9630967, 'auroc': 0.99284565, 'binary_precision': 0.9794426, 'binary_recall': 0.9460868, 'binary_specificity': 0.9801345, 'binary_f1_score': 0.9624757}
confusion matrix:
       0      1
0  28567    579
1   1572  27586
---- Validation: 
scalar performance:
{'acc': 0.93021894, 'precision': 0.6170338, 'recall': 0.76158535, 'specificity': 0.76158535, 'f1': 0.65569735, 'auroc': 0.86580086, 'binary_precision': 0.24857955, 'binary_recall': 0.5813953, 'binary_specificity': 0.9417754, 'binary_f1_score': 0.34825867}
confusion matrix:
       0     1
0  17113  1058
1    252   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88299406, 'precision': 0.60419035, 'recall': 0.834051, 'specificity': 0.834051, 'f1': 0.6384756, 'auroc': 0.9004116, 'binary_precision': 0.2182448, 'binary_recall': 0.78099173, 'binary_specificity': 0.88711023, 'binary_f1_score': 0.34115526}
confusion matrix:
      0    1
0  5320  677
1    53  189
early stop counter: 7
val acc:0.9302189350128174, best validation acc: 0.9368241429328918, corresponding to test acc:                         0.888443648815155 / 0.888443648815155
after epoch: 15,now: 2024-07-31 14:13:46.115845,epoch time: 0:14:28.509168,used: 3:35:58.550910,model: dset_te_center0_erm_no_git_version_2024md_07md_31_10_37_47_seed_2_23775391
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 3:35:58.550910 at 2024-07-31 14:13:46.115845
persisted model performance metric: 

scalar performance:
{'acc': 0.88844365, 'precision': 0.5939709, 'recall': 0.7714553, 'specificity': 0.7714553, 'f1': 0.6244219, 'auroc': 0.86199164, 'binary_precision': 0.20365535, 'binary_recall': 0.6446281, 'binary_specificity': 0.89828247, 'binary_f1_score': 0.3095238}
confusion matrix:
      0    1
0  5387  610
1    86  156
oracle model performance metric: 

scalar performance:
{'acc': 0.88844365, 'precision': 0.5939709, 'recall': 0.7714553, 'specificity': 0.7714553, 'f1': 0.6244219, 'auroc': 0.86199164, 'binary_precision': 0.20365535, 'binary_recall': 0.6446281, 'binary_specificity': 0.89828247, 'binary_f1_score': 0.3095238}
confusion matrix:
      0    1
0  5387  610
1    86  156
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197552 KiB |   7837 MiB |   1079 TiB |   1079 TiB |
|       from large pool | 180067 KiB |   7813 MiB |   1063 TiB |   1063 TiB |
|       from small pool |  17485 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197552 KiB |   7837 MiB |   1079 TiB |   1079 TiB |
|       from large pool | 180067 KiB |   7813 MiB |   1063 TiB |   1063 TiB |
|       from small pool |  17485 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7835 MiB |   1077 TiB |   1077 TiB |
|       from large pool | 178979 KiB |   7812 MiB |   1061 TiB |   1061 TiB |
|       from small pool |  16481 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8532 MiB |   8532 MiB |  25080 MiB |  16548 MiB |
|       from large pool |   8492 MiB |   8492 MiB |  25006 MiB |  16514 MiB |
|       from small pool |     40 MiB |     44 MiB |     74 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44112 KiB | 738183 KiB | 696479 GiB | 696479 GiB |
|       from large pool |  37021 KiB | 736500 KiB | 679802 GiB | 679802 GiB |
|       from small pool |   7091 KiB |  22399 KiB |  16677 GiB |  16677 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7783    |  211483 K  |  211480 K  |
|       from large pool |      79    |     767    |  102563 K  |  102563 K  |
|       from small pool |    2887    |    7702    |  108920 K  |  108917 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7783    |  211483 K  |  211480 K  |
|       from large pool |      79    |     767    |  102563 K  |  102563 K  |
|       from small pool |    2887    |    7702    |  108920 K  |  108917 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     371    |    1062    |     693    |
|       from large pool |     349    |     349    |    1025    |     676    |
|       from small pool |      20    |      22    |      37    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3667    |  124610 K  |  124610 K  |
|       from large pool |       9    |     352    |   75635 K  |   75635 K  |
|       from small pool |      25    |    3657    |   48975 K  |   48975 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB |   1079 TiB |   1079 TiB |
|       from large pool |  16640 KiB |   7813 MiB |   1063 TiB |   1063 TiB |
|       from small pool |      0 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB |   1079 TiB |   1079 TiB |
|       from large pool |  16640 KiB |   7813 MiB |   1063 TiB |   1063 TiB |
|       from small pool |      0 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB |   1077 TiB |   1077 TiB |
|       from large pool |  16640 KiB |   7812 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 241664 KiB |   8532 MiB |  25080 MiB |  24844 MiB |
|       from large pool | 217088 KiB |   8492 MiB |  25006 MiB |  24794 MiB |
|       from small pool |  24576 KiB |     44 MiB |     74 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 738183 KiB | 696479 GiB | 696479 GiB |
|       from large pool |  30464 KiB | 736500 KiB | 679802 GiB | 679802 GiB |
|       from small pool |      0 KiB |  22399 KiB |  16677 GiB |  16677 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  211483 K  |  211483 K  |
|       from large pool |       2    |     767    |  102563 K  |  102563 K  |
|       from small pool |       0    |    7702    |  108920 K  |  108920 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  211483 K  |  211483 K  |
|       from large pool |       2    |     767    |  102563 K  |  102563 K  |
|       from small pool |       0    |    7702    |  108920 K  |  108920 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |    1062    |    1040    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      12    |      22    |      37    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3667    |  124611 K  |  124611 K  |
|       from large pool |       2    |     352    |   75635 K  |   75635 K  |
|       from small pool |       0    |    3657    |   48976 K  |   48976 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 31 14:14:46 2024]
Finished job 0.
1 of 1 steps (100%) done
