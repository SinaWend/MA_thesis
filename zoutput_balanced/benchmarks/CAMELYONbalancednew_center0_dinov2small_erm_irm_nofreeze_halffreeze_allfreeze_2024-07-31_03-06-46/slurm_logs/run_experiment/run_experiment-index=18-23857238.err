Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 18:12:14 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/18.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=18
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238

 Experiment start at: 2024-07-31 18:23:04.471775
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.70427126, 'precision': 0.7045691, 'recall': 0.70428824, 'specificity': 0.70428824, 'f1': 0.7041746, 'auroc': 0.7674106, 'binary_precision': 0.7126046, 'binary_recall': 0.68557096, 'binary_specificity': 0.72300553, 'binary_f1_score': 0.69882643}
confusion matrix:
       0      1
0  20717   7937
1   9026  19680
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7943806, 'precision': 0.5383107, 'recall': 0.6932831, 'specificity': 0.6932831, 'f1': 0.52285355, 'auroc': 0.7763685, 'binary_precision': 0.09463881, 'binary_recall': 0.58475894, 'binary_specificity': 0.8018073, 'binary_f1_score': 0.16291161}
confusion matrix:
       0     1
0  14552  3597
1    267   376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7732502, 'precision': 0.54099, 'recall': 0.6837988, 'specificity': 0.6837988, 'f1': 0.5229464, 'auroc': 0.76130974, 'binary_precision': 0.1045082, 'binary_recall': 0.5862069, 'binary_specificity': 0.78139067, 'binary_f1_score': 0.1773913}
confusion matrix:
      0     1
0  4686  1311
1   108   153
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 18:41:20.268821,epoch time: 0:18:15.797046,used: 0:18:15.797046,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8106869, 'precision': 0.8107111, 'recall': 0.8106909, 'specificity': 0.8106909, 'f1': 0.8106844, 'auroc': 0.8872501, 'binary_precision': 0.81368864, 'binary_recall': 0.80634713, 'binary_specificity': 0.81503457, 'binary_f1_score': 0.8100012}
confusion matrix:
       0      1
0  23354   5300
1   5559  23147
---- Validation: 
scalar performance:
{'acc': 0.8422733, 'precision': 0.5546694, 'recall': 0.72782856, 'specificity': 0.72782856, 'f1': 0.5601634, 'auroc': 0.80453193, 'binary_precision': 0.12552436, 'binary_recall': 0.60497665, 'binary_specificity': 0.8506805, 'binary_f1_score': 0.20791021}
confusion matrix:
       0     1
0  15439  2710
1    254   389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82885903, 'precision': 0.5642022, 'recall': 0.74029833, 'specificity': 0.74029833, 'f1': 0.5711988, 'auroc': 0.8194257, 'binary_precision': 0.14659686, 'binary_recall': 0.6436782, 'binary_specificity': 0.8369185, 'binary_f1_score': 0.23880598}
confusion matrix:
      0    1
0  5019  978
1    93  168
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 18:58:26.791397,epoch time: 0:17:06.522576,used: 0:35:22.319622,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.842486, 'precision': 0.84252226, 'recall': 0.8424819, 'specificity': 0.8424819, 'f1': 0.84248066, 'auroc': 0.9190849, 'binary_precision': 0.83919704, 'binary_recall': 0.8476466, 'binary_specificity': 0.8373172, 'binary_f1_score': 0.84340066}
confusion matrix:
       0      1
0  23995   4662
1   4373  24330
---- Validation: 
scalar performance:
{'acc': 0.8500426, 'precision': 0.55893, 'recall': 0.7371012, 'specificity': 0.7371012, 'f1': 0.5682224, 'auroc': 0.8171602, 'binary_precision': 0.13346815, 'binary_recall': 0.61586314, 'binary_specificity': 0.8583393, 'binary_f1_score': 0.21939057}
confusion matrix:
       0     1
0  15578  2571
1    247   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8342921, 'precision': 0.57289124, 'recall': 0.77245045, 'specificity': 0.77245045, 'f1': 0.5842954, 'auroc': 0.84891236, 'binary_precision': 0.16083916, 'binary_recall': 0.70498085, 'binary_specificity': 0.83992, 'binary_f1_score': 0.2619217}
confusion matrix:
      0    1
0  5037  960
1    77  184
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 19:15:29.725868,epoch time: 0:17:02.934471,used: 0:52:25.254093,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.86098325, 'precision': 0.8617009, 'recall': 0.8609996, 'specificity': 0.8609996, 'f1': 0.86091805, 'auroc': 0.9351409, 'binary_precision': 0.87799543, 'binary_recall': 0.83871645, 'binary_specificity': 0.8832827, 'binary_f1_score': 0.8579066}
confusion matrix:
       0      1
0  25314   3345
1   4629  24072
---- Validation: 
scalar performance:
{'acc': 0.8855364, 'precision': 0.5742229, 'recall': 0.7367255, 'specificity': 0.7367255, 'f1': 0.5972383, 'auroc': 0.8228062, 'binary_precision': 0.16488889, 'binary_recall': 0.5769829, 'binary_specificity': 0.8964681, 'binary_f1_score': 0.25648117}
confusion matrix:
       0     1
0  16270  1879
1    272   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87104505, 'precision': 0.5930338, 'recall': 0.7897943, 'specificity': 0.7897943, 'f1': 0.6204376, 'auroc': 0.8663054, 'binary_precision': 0.20065789, 'binary_recall': 0.7011494, 'binary_specificity': 0.87843925, 'binary_f1_score': 0.31202045}
confusion matrix:
      0    1
0  5268  729
1    78  183
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 19:32:48.689991,epoch time: 0:17:18.964123,used: 1:09:44.218216,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8756625, 'precision': 0.8760718, 'recall': 0.87567574, 'specificity': 0.87567574, 'f1': 0.87563133, 'auroc': 0.9448153, 'binary_precision': 0.8886807, 'binary_recall': 0.8591436, 'binary_specificity': 0.89220786, 'binary_f1_score': 0.87366253}
confusion matrix:
       0      1
0  25568   3089
1   4043  24660
---- Validation: 
scalar performance:
{'acc': 0.88090676, 'precision': 0.5735424, 'recall': 0.7448294, 'specificity': 0.7448294, 'f1': 0.59562856, 'auroc': 0.8284398, 'binary_precision': 0.1627907, 'binary_recall': 0.59875584, 'binary_specificity': 0.89090306, 'binary_f1_score': 0.25598404}
confusion matrix:
       0     1
0  16169  1980
1    258   385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8628955, 'precision': 0.5925235, 'recall': 0.8075302, 'specificity': 0.8075302, 'f1': 0.6181776, 'auroc': 0.8792263, 'binary_precision': 0.19756839, 'binary_recall': 0.74712646, 'binary_specificity': 0.867934, 'binary_f1_score': 0.31249997}
confusion matrix:
      0    1
0  5205  792
1    66  195
early stop counter: 1
val acc:0.8809067606925964, best validation acc: 0.8855363726615906, corresponding to test acc:                         0.8710450530052185 / 0.8710450530052185
after epoch: 5,now: 2024-07-31 19:50:12.296816,epoch time: 0:17:23.606825,used: 1:27:07.825041,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8854428, 'precision': 0.8864045, 'recall': 0.8854629, 'specificity': 0.8854629, 'f1': 0.8853752, 'auroc': 0.95157385, 'binary_precision': 0.9058832, 'binary_recall': 0.86046755, 'binary_specificity': 0.9104582, 'binary_f1_score': 0.8825915}
confusion matrix:
       0      1
0  26091   2566
1   4005  24698
---- Validation: 
scalar performance:
{'acc': 0.8879843, 'precision': 0.5784557, 'recall': 0.74849355, 'specificity': 0.74849355, 'f1': 0.60358953, 'auroc': 0.8306231, 'binary_precision': 0.17249104, 'binary_recall': 0.59875584, 'binary_specificity': 0.8982313, 'binary_f1_score': 0.26782608}
confusion matrix:
       0     1
0  16302  1847
1    258   385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702461, 'precision': 0.5990081, 'recall': 0.81869483, 'specificity': 0.81869483, 'f1': 0.6285527, 'auroc': 0.8863897, 'binary_precision': 0.20969442, 'binary_recall': 0.7624521, 'binary_specificity': 0.8749375, 'binary_f1_score': 0.32892564}
confusion matrix:
      0    1
0  5247  750
1    62  199
better model found
persisted
after epoch: 6,now: 2024-07-31 20:07:47.872883,epoch time: 0:17:35.576067,used: 1:44:43.401108,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89210254, 'precision': 0.89263856, 'recall': 0.8921155, 'specificity': 0.8921155, 'f1': 0.89206797, 'auroc': 0.95649564, 'binary_precision': 0.907321, 'binary_recall': 0.87358886, 'binary_specificity': 0.910642, 'binary_f1_score': 0.89013547}
confusion matrix:
       0      1
0  26099   2561
1   3628  25072
---- Validation: 
scalar performance:
{'acc': 0.87957644, 'precision': 0.57438093, 'recall': 0.7516413, 'specificity': 0.7516413, 'f1': 0.5966133, 'auroc': 0.8342486, 'binary_precision': 0.16390042, 'binary_recall': 0.61430794, 'binary_specificity': 0.8889746, 'binary_f1_score': 0.25876188}
confusion matrix:
       0     1
0  16134  2015
1    248   395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.858581, 'precision': 0.59299666, 'recall': 0.81993777, 'specificity': 0.81993777, 'f1': 0.6178215, 'auroc': 0.8940997, 'binary_precision': 0.19708738, 'binary_recall': 0.7777778, 'binary_specificity': 0.86209774, 'binary_f1_score': 0.3144849}
confusion matrix:
      0    1
0  5170  827
1    58  203
early stop counter: 1
val acc:0.8795764446258545, best validation acc: 0.8879842758178711, corresponding to test acc:                         0.8702461123466492 / 0.8710450530052185
after epoch: 7,now: 2024-07-31 20:25:37.711035,epoch time: 0:17:49.838152,used: 2:02:33.239260,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8982566, 'precision': 0.8988616, 'recall': 0.898273, 'specificity': 0.898273, 'f1': 0.8982207, 'auroc': 0.959327, 'binary_precision': 0.91460586, 'binary_recall': 0.8787277, 'binary_specificity': 0.91781825, 'binary_f1_score': 0.8963079}
confusion matrix:
       0      1
0  26301   2355
1   3481  25223
---- Validation: 
scalar performance:
{'acc': 0.8784589, 'precision': 0.57600045, 'recall': 0.7615635, 'specificity': 0.7615635, 'f1': 0.5987317, 'auroc': 0.83735216, 'binary_precision': 0.16632777, 'binary_recall': 0.63608086, 'binary_specificity': 0.8870461, 'binary_f1_score': 0.26370084}
confusion matrix:
       0     1
0  16099  2050
1    234   409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537871, 'precision': 0.59208834, 'recall': 0.82659817, 'specificity': 0.82659817, 'f1': 0.6153705, 'auroc': 0.8998644, 'binary_precision': 0.19439252, 'binary_recall': 0.79693484, 'binary_specificity': 0.8562615, 'binary_f1_score': 0.31254694}
confusion matrix:
      0    1
0  5135  862
1    53  208
early stop counter: 2
val acc:0.8784589171409607, best validation acc: 0.8879842758178711, corresponding to test acc:                         0.8702461123466492 / 0.8710450530052185
after epoch: 8,now: 2024-07-31 20:43:25.531348,epoch time: 0:17:47.820313,used: 2:20:21.059573,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90448046, 'precision': 0.9056952, 'recall': 0.9045044, 'specificity': 0.9045044, 'f1': 0.90441257, 'auroc': 0.9635178, 'binary_precision': 0.9281132, 'binary_recall': 0.87705976, 'binary_specificity': 0.931949, 'binary_f1_score': 0.9018646}
confusion matrix:
       0      1
0  26705   1950
1   3529  25176
---- Validation: 
scalar performance:
{'acc': 0.88984674, 'precision': 0.5793139, 'recall': 0.74720764, 'specificity': 0.74720764, 'f1': 0.60500765, 'auroc': 0.8386275, 'binary_precision': 0.1743496, 'binary_recall': 0.5940902, 'binary_specificity': 0.90032506, 'binary_f1_score': 0.2695836}
confusion matrix:
       0     1
0  16340  1809
1    261   382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87456053, 'precision': 0.6048755, 'recall': 0.83377224, 'specificity': 0.83377224, 'f1': 0.6374207, 'auroc': 0.9028857, 'binary_precision': 0.22008547, 'binary_recall': 0.789272, 'binary_specificity': 0.8782725, 'binary_f1_score': 0.34419385}
confusion matrix:
      0    1
0  5267  730
1    55  206
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-31 21:01:22.078652,epoch time: 0:17:56.547304,used: 2:38:17.606877,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9066597, 'precision': 0.9067768, 'recall': 0.9066653, 'specificity': 0.9066653, 'f1': 0.90665376, 'auroc': 0.9651888, 'binary_precision': 0.91384506, 'binary_recall': 0.8981149, 'binary_specificity': 0.9152158, 'binary_f1_score': 0.90591174}
confusion matrix:
       0      1
0  26231   2430
1   2924  25775
---- Validation: 
scalar performance:
{'acc': 0.8682418, 'precision': 0.57212055, 'recall': 0.7667747, 'specificity': 0.7667747, 'f1': 0.59119964, 'auroc': 0.8423923, 'binary_precision': 0.15789473, 'binary_recall': 0.6578538, 'binary_specificity': 0.87569565, 'binary_f1_score': 0.25466585}
confusion matrix:
       0     1
0  15893  2256
1    220   423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83956534, 'precision': 0.58712226, 'recall': 0.83200413, 'specificity': 0.83200413, 'f1': 0.6046316, 'auroc': 0.90625644, 'binary_precision': 0.1832907, 'binary_recall': 0.8237548, 'binary_specificity': 0.8402535, 'binary_f1_score': 0.29986054}
confusion matrix:
      0    1
0  5039  958
1    46  215
early stop counter: 1
val acc:0.8682417869567871, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 10,now: 2024-07-31 21:19:28.635395,epoch time: 0:18:06.556743,used: 2:56:24.163620,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91145396, 'precision': 0.9120399, 'recall': 0.9114698, 'specificity': 0.9114698, 'f1': 0.9114247, 'auroc': 0.96774364, 'binary_precision': 0.92778766, 'binary_recall': 0.8925237, 'binary_specificity': 0.930416, 'binary_f1_score': 0.9098141}
confusion matrix:
       0      1
0  26662   1994
1   3085  25619
---- Validation: 
scalar performance:
{'acc': 0.87744784, 'precision': 0.5750242, 'recall': 0.75953996, 'specificity': 0.75953996, 'f1': 0.5971655, 'auroc': 0.8419759, 'binary_precision': 0.16451092, 'binary_recall': 0.63297045, 'binary_specificity': 0.8861094, 'binary_f1_score': 0.26114854}
confusion matrix:
       0     1
0  16082  2067
1    236   407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549057, 'precision': 0.5934944, 'recall': 0.8308464, 'specificity': 0.8308464, 'f1': 0.61755335, 'auroc': 0.90806067, 'binary_precision': 0.1968135, 'binary_recall': 0.8045977, 'binary_specificity': 0.85709524, 'binary_f1_score': 0.31626505}
confusion matrix:
      0    1
0  5140  857
1    51  210
early stop counter: 2
val acc:0.8774478435516357, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 11,now: 2024-07-31 21:37:35.869179,epoch time: 0:18:07.233784,used: 3:14:31.397404,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91192466, 'precision': 0.9128206, 'recall': 0.9119451, 'specificity': 0.9119451, 'f1': 0.91187966, 'auroc': 0.9683363, 'binary_precision': 0.93227094, 'binary_recall': 0.888556, 'binary_specificity': 0.93533415, 'binary_f1_score': 0.9098887}
confusion matrix:
       0      1
0  26802   1853
1   3199  25506
---- Validation: 
scalar performance:
{'acc': 0.87984246, 'precision': 0.57623446, 'recall': 0.7592796, 'specificity': 0.7592796, 'f1': 0.59929836, 'auroc': 0.84402263, 'binary_precision': 0.1670103, 'binary_recall': 0.62986004, 'binary_specificity': 0.8886991, 'binary_f1_score': 0.26401564}
confusion matrix:
       0     1
0  16129  2020
1    238   405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8582614, 'precision': 0.5958695, 'recall': 0.8344297, 'specificity': 0.8344297, 'f1': 0.6216183, 'auroc': 0.910723, 'binary_precision': 0.20133588, 'binary_recall': 0.8084291, 'binary_specificity': 0.86043024, 'binary_f1_score': 0.3223835}
confusion matrix:
      0    1
0  5160  837
1    50  211
early stop counter: 3
val acc:0.8798424601554871, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 12,now: 2024-07-31 21:55:42.390468,epoch time: 0:18:06.521289,used: 3:32:37.918693,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91455716, 'precision': 0.9151007, 'recall': 0.91457176, 'specificity': 0.91457176, 'f1': 0.9145312, 'auroc': 0.96985734, 'binary_precision': 0.9303225, 'binary_recall': 0.89638716, 'binary_specificity': 0.9327564, 'binary_f1_score': 0.9130396}
confusion matrix:
       0      1
0  26730   1927
1   2974  25729
---- Validation: 
scalar performance:
{'acc': 0.8618561, 'precision': 0.57007325, 'recall': 0.7702192, 'specificity': 0.7702192, 'f1': 0.58681774, 'auroc': 0.8444221, 'binary_precision': 0.15335463, 'binary_recall': 0.6718507, 'binary_specificity': 0.8685878, 'binary_f1_score': 0.24971098}
confusion matrix:
       0     1
0  15764  2385
1    211   432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83700866, 'precision': 0.58587474, 'recall': 0.8306701, 'specificity': 0.8306701, 'f1': 0.6021887, 'auroc': 0.91206264, 'binary_precision': 0.18082422, 'binary_recall': 0.8237548, 'binary_specificity': 0.83758545, 'binary_f1_score': 0.2965517}
confusion matrix:
      0    1
0  5023  974
1    46  215
early stop counter: 4
val acc:0.8618561029434204, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 13,now: 2024-07-31 22:13:47.246974,epoch time: 0:18:04.856506,used: 3:50:42.775199,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9170328, 'precision': 0.9179839, 'recall': 0.91705114, 'specificity': 0.91705114, 'f1': 0.91698796, 'auroc': 0.9712169, 'binary_precision': 0.9381153, 'binary_recall': 0.8931085, 'binary_specificity': 0.9409938, 'binary_f1_score': 0.9150588}
confusion matrix:
       0      1
0  26967   1691
1   3068  25634
---- Validation: 
scalar performance:
{'acc': 0.8733504, 'precision': 0.57461375, 'recall': 0.76716936, 'specificity': 0.76716936, 'f1': 0.5958055, 'auroc': 0.84485674, 'binary_precision': 0.16298021, 'binary_recall': 0.65318817, 'binary_specificity': 0.8811505, 'binary_f1_score': 0.2608696}
confusion matrix:
       0     1
0  15992  2157
1    223   420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85123044, 'precision': 0.59252214, 'recall': 0.8344258, 'specificity': 0.8344258, 'f1': 0.6152487, 'auroc': 0.913396, 'binary_precision': 0.19434306, 'binary_recall': 0.81609195, 'binary_specificity': 0.8527597, 'binary_f1_score': 0.31392777}
confusion matrix:
      0    1
0  5114  883
1    48  213
early stop counter: 5
val acc:0.8733503818511963, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 14,now: 2024-07-31 22:31:48.625873,epoch time: 0:18:01.378899,used: 4:08:44.154098,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9192992, 'precision': 0.91985303, 'recall': 0.91931057, 'specificity': 0.91931057, 'f1': 0.919274, 'auroc': 0.9733888, 'binary_precision': 0.9352599, 'binary_recall': 0.9010732, 'binary_specificity': 0.937548, 'binary_f1_score': 0.91784835}
confusion matrix:
       0      1
0  26872   1790
1   2839  25859
---- Validation: 
scalar performance:
{'acc': 0.8612707, 'precision': 0.57007664, 'recall': 0.7714163, 'specificity': 0.7714163, 'f1': 0.58667636, 'auroc': 0.8464427, 'binary_precision': 0.1532486, 'binary_recall': 0.6749611, 'binary_specificity': 0.8678715, 'binary_f1_score': 0.24978417}
confusion matrix:
       0     1
0  15751  2398
1    209   434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8376478, 'precision': 0.58691305, 'recall': 0.8346683, 'specificity': 0.8346683, 'f1': 0.6037488, 'auroc': 0.91446424, 'binary_precision': 0.18250631, 'binary_recall': 0.8314176, 'binary_specificity': 0.83791894, 'binary_f1_score': 0.29931036}
confusion matrix:
      0    1
0  5025  972
1    44  217
early stop counter: 6
val acc:0.8612707257270813, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 15,now: 2024-07-31 22:49:53.444472,epoch time: 0:18:04.818599,used: 4:26:48.972697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9194038, 'precision': 0.9206096, 'recall': 0.9194253, 'specificity': 0.9194253, 'f1': 0.91934866, 'auroc': 0.97316545, 'binary_precision': 0.9433316, 'binary_recall': 0.89255476, 'binary_specificity': 0.94629586, 'binary_f1_score': 0.917241}
confusion matrix:
       0      1
0  27118   1539
1   3084  25619
---- Validation: 
scalar performance:
{'acc': 0.8730311, 'precision': 0.57410026, 'recall': 0.7655039, 'specificity': 0.7655039, 'f1': 0.59501445, 'auroc': 0.84674364, 'binary_precision': 0.16207832, 'binary_recall': 0.65007776, 'binary_specificity': 0.88093007, 'binary_f1_score': 0.25946617}
confusion matrix:
       0     1
0  15988  2161
1    225   418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85123044, 'precision': 0.5928956, 'recall': 0.8362582, 'specificity': 0.8362582, 'f1': 0.615746, 'auroc': 0.9154954, 'binary_precision': 0.19489981, 'binary_recall': 0.8199234, 'binary_specificity': 0.85259295, 'binary_f1_score': 0.31493744}
confusion matrix:
      0    1
0  5113  884
1    47  214
early stop counter: 7
val acc:0.8730310797691345, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 16,now: 2024-07-31 23:07:56.583606,epoch time: 0:18:03.139134,used: 4:44:52.111831,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9224024, 'precision': 0.92297435, 'recall': 0.9224185, 'specificity': 0.9224185, 'f1': 0.92237806, 'auroc': 0.9739593, 'binary_precision': 0.9387482, 'binary_recall': 0.90391916, 'binary_specificity': 0.9409178, 'binary_f1_score': 0.92100453}
confusion matrix:
       0      1
0  26962   1693
1   2758  25947
---- Validation: 
scalar performance:
{'acc': 0.8595679, 'precision': 0.56996655, 'recall': 0.77428496, 'specificity': 0.77428496, 'f1': 0.5860898, 'auroc': 0.84906983, 'binary_precision': 0.15274878, 'binary_recall': 0.6827372, 'binary_specificity': 0.8658328, 'binary_f1_score': 0.24964458}
confusion matrix:
       0     1
0  15714  2435
1    204   439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8384468, 'precision': 0.58766663, 'recall': 0.8369175, 'specificity': 0.8369175, 'f1': 0.60498846, 'auroc': 0.91723895, 'binary_precision': 0.18381113, 'binary_recall': 0.83524907, 'binary_specificity': 0.838586, 'binary_f1_score': 0.3013131}
confusion matrix:
      0    1
0  5029  968
1    43  218
early stop counter: 8
val acc:0.8595678806304932, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 17,now: 2024-07-31 23:25:31.096197,epoch time: 0:17:34.512591,used: 5:02:26.624422,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9233264, 'precision': 0.9239652, 'recall': 0.9233407, 'specificity': 0.9233407, 'f1': 0.9232992, 'auroc': 0.975816, 'binary_precision': 0.940607, 'binary_recall': 0.90383613, 'binary_specificity': 0.94284517, 'binary_f1_score': 0.92185503}
confusion matrix:
       0      1
0  27021   1638
1   2760  25941
---- Validation: 
scalar performance:
{'acc': 0.8656343, 'precision': 0.57254964, 'recall': 0.77442545, 'specificity': 0.77442545, 'f1': 0.5912025, 'auroc': 0.8508226, 'binary_precision': 0.15806685, 'binary_recall': 0.67651635, 'binary_specificity': 0.87233454, 'binary_f1_score': 0.25625917}
confusion matrix:
       0     1
0  15832  2317
1    208   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8432407, 'precision': 0.59044194, 'recall': 0.8412511, 'specificity': 0.8412511, 'f1': 0.61013293, 'auroc': 0.9171393, 'binary_precision': 0.18911918, 'binary_recall': 0.83908045, 'binary_specificity': 0.8434217, 'binary_f1_score': 0.30866808}
confusion matrix:
      0    1
0  5058  939
1    42  219
early stop counter: 9
val acc:0.8656343221664429, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 18,now: 2024-07-31 23:42:55.599592,epoch time: 0:17:24.503395,used: 5:19:51.127817,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.92642957, 'precision': 0.9266393, 'recall': 0.9264389, 'specificity': 0.9264389, 'f1': 0.9264216, 'auroc': 0.97666323, 'binary_precision': 0.93631047, 'binary_recall': 0.9152383, 'binary_specificity': 0.9376396, 'binary_f1_score': 0.92565453}
confusion matrix:
       0      1
0  26869   1787
1   2433  26271
---- Validation: 
scalar performance:
{'acc': 0.84924436, 'precision': 0.5672517, 'recall': 0.7801912, 'specificity': 0.7801912, 'f1': 0.57950294, 'auroc': 0.8509488, 'binary_precision': 0.14654616, 'binary_recall': 0.7060653, 'binary_specificity': 0.85431707, 'binary_f1_score': 0.24271585}
confusion matrix:
       0     1
0  15505  2644
1    189   454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8275807, 'precision': 0.58440745, 'recall': 0.84040964, 'specificity': 0.84040964, 'f1': 0.59714395, 'auroc': 0.918097, 'binary_precision': 0.17642406, 'binary_recall': 0.8544061, 'binary_specificity': 0.8264132, 'binary_f1_score': 0.29245904}
confusion matrix:
      0     1
0  4956  1041
1    38   223
early stop counter: 10
val acc:0.8492443561553955, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 19,now: 2024-08-01 00:00:46.877650,epoch time: 0:17:51.278058,used: 5:37:42.405875,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9279986, 'precision': 0.92843795, 'recall': 0.9280087, 'specificity': 0.9280087, 'f1': 0.92798126, 'auroc': 0.97734284, 'binary_precision': 0.942316, 'binary_recall': 0.91191024, 'binary_specificity': 0.9441072, 'binary_f1_score': 0.9268638}
confusion matrix:
       0      1
0  27060   1602
1   2528  26170
---- Validation: 
scalar performance:
{'acc': 0.84546614, 'precision': 0.5664431, 'recall': 0.78273547, 'specificity': 0.78273547, 'f1': 0.5772834, 'auroc': 0.8512931, 'binary_precision': 0.14460862, 'binary_recall': 0.7153966, 'binary_specificity': 0.8500744, 'binary_f1_score': 0.24058577}
confusion matrix:
       0     1
0  15428  2721
1    183   460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82502395, 'precision': 0.58434963, 'recall': 0.84457266, 'specificity': 0.84457266, 'f1': 0.5961758, 'auroc': 0.91871476, 'binary_precision': 0.17573872, 'binary_recall': 0.8659004, 'binary_specificity': 0.8232449, 'binary_f1_score': 0.2921784}
confusion matrix:
      0     1
0  4937  1060
1    35   226
early stop counter: 11
val acc:0.845466136932373, best validation acc: 0.8898467421531677, corresponding to test acc:                         0.874560534954071 / 0.874560534954071
after epoch: 20,now: 2024-08-01 00:18:27.325596,epoch time: 0:17:40.447946,used: 5:55:22.853821,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_23_04_seed_0_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:55:22.853821 at 2024-08-01 00:18:27.325596
persisted model performance metric: 

scalar performance:
{'acc': 0.87456053, 'precision': 0.6048755, 'recall': 0.83377224, 'specificity': 0.83377224, 'f1': 0.6374207, 'auroc': 0.9028857, 'binary_precision': 0.22008547, 'binary_recall': 0.789272, 'binary_specificity': 0.8782725, 'binary_f1_score': 0.34419385}
confusion matrix:
      0    1
0  5267  730
1    55  206
oracle model performance metric: 

scalar performance:
{'acc': 0.87456053, 'precision': 0.6048755, 'recall': 0.83377224, 'specificity': 0.83377224, 'f1': 0.6374207, 'auroc': 0.9028857, 'binary_precision': 0.22008547, 'binary_recall': 0.789272, 'binary_specificity': 0.8782725, 'binary_f1_score': 0.34419385}
confusion matrix:
      0    1
0  5267  730
1    55  206
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/18.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461507 KiB | 349766 GiB | 349765 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461507 KiB | 349766 GiB | 349765 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |  17477 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 349744 GiB | 349744 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 342572 GiB | 342571 GiB |
|       from small pool |  16469 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37498 KiB |  87761 KiB | 184828 GiB | 184828 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 177628 GiB | 177628 GiB |
|       from small pool |   7098 KiB |   9902 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7653    |   81089 K  |   81086 K  |
|       from large pool |      76    |     158    |   33765 K  |   33765 K  |
|       from small pool |    2890    |    7575    |   47323 K  |   47320 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7653    |   81089 K  |   81086 K  |
|       from large pool |      76    |     158    |   33765 K  |   33765 K  |
|       from small pool |    2890    |    7575    |   47323 K  |   47320 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3602    |   44608 K  |   44608 K  |
|       from large pool |       9    |      18    |   23011 K  |   23011 K  |
|       from small pool |      21    |    3594    |   21597 K  |   21597 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 349744 GiB | 349744 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 509952 KiB | 509952 KiB | 280576 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  24576 KiB |  43008 KiB |  43008 KiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 184828 GiB | 184828 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 177628 GiB | 177628 GiB |
|       from small pool |      0 KiB |  18293 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7653    |   81089 K  |   81089 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47323 K  |   47323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7653    |   81089 K  |   81089 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47323 K  |   47323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      42    |      20    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   44609 K  |   44609 K  |
|       from large pool |       3    |      18    |   23011 K  |   23011 K  |
|       from small pool |       0    |    3594    |   21598 K  |   21598 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 349766 GiB | 349766 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 342576 GiB | 342576 GiB |
|       from small pool |      0 KiB |  38507 KiB |   7189 GiB |   7189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 349744 GiB | 349744 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 342572 GiB | 342572 GiB |
|       from small pool |      0 KiB |  37503 KiB |   7172 GiB |   7172 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 509952 KiB | 509952 KiB | 280576 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  24576 KiB |  43008 KiB |  43008 KiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 184828 GiB | 184828 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 177628 GiB | 177628 GiB |
|       from small pool |      0 KiB |  18293 KiB |   7200 GiB |   7200 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7653    |   81089 K  |   81089 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47323 K  |   47323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7653    |   81089 K  |   81089 K  |
|       from large pool |       2    |     158    |   33765 K  |   33765 K  |
|       from small pool |       0    |    7575    |   47323 K  |   47323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      42    |      20    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   44609 K  |   44609 K  |
|       from large pool |       3    |      18    |   23011 K  |   23011 K  |
|       from small pool |       0    |    3594    |   21598 K  |   21598 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238

 Experiment start at: 2024-08-01 00:28:32.461656
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.63289714, 'precision': 0.63416326, 'recall': 0.63286126, 'specificity': 0.63286126, 'f1': 0.63199097, 'auroc': 0.6678053, 'binary_precision': 0.6213108, 'binary_recall': 0.68202156, 'binary_specificity': 0.58370095, 'binary_f1_score': 0.65025216}
confusion matrix:
       0      1
0  16803  11984
1   9167  19662
---- Validation: 
scalar performance:
{'acc': 0.86531484, 'precision': 0.4985296, 'recall': 0.49598166, 'specificity': 0.49598166, 'f1': 0.48861003, 'auroc': 0.70246005, 'binary_precision': 0.033282906, 'binary_recall': 0.09806835, 'binary_specificity': 0.893895, 'binary_f1_score': 0.049698796}
confusion matrix:
       0     1
0  16150  1917
1    607    66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88736707, 'precision': 0.5375183, 'recall': 0.5771016, 'specificity': 0.5771016, 'f1': 0.54517627, 'auroc': 0.7891645, 'binary_precision': 0.110124335, 'binary_recall': 0.23846154, 'binary_specificity': 0.9157417, 'binary_f1_score': 0.1506683}
confusion matrix:
      0    1
0  5445  501
1   198   62
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 00:46:56.842559,epoch time: 0:18:24.380903,used: 0:18:24.380903,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7543391, 'precision': 0.75646114, 'recall': 0.7543042, 'specificity': 0.7543042, 'f1': 0.7538128, 'auroc': 0.82875705, 'binary_precision': 0.73332274, 'binary_recall': 0.7999653, 'binary_specificity': 0.7086431, 'binary_f1_score': 0.76519585}
confusion matrix:
       0      1
0  20399   8387
1   5767  23063
---- Validation: 
scalar performance:
{'acc': 0.863127, 'precision': 0.5290425, 'recall': 0.5899775, 'specificity': 0.5899775, 'f1': 0.53000605, 'auroc': 0.7684519, 'binary_precision': 0.08689956, 'binary_recall': 0.29569092, 'binary_specificity': 0.8842641, 'binary_f1_score': 0.13432331}
confusion matrix:
       0     1
0  15976  2091
1    474   199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8859168, 'precision': 0.57891345, 'recall': 0.6977179, 'specificity': 0.6977179, 'f1': 0.60185766, 'auroc': 0.8397882, 'binary_precision': 0.18181819, 'binary_recall': 0.4923077, 'binary_specificity': 0.90312815, 'binary_f1_score': 0.26556015}
confusion matrix:
      0    1
0  5370  576
1   132  128
early stop counter: 1
val acc:0.8631269931793213, best validation acc: 0.8653148412704468, corresponding to test acc:                         0.8873670697212219 / 0.8873670697212219
after epoch: 2,now: 2024-08-01 01:04:34.298322,epoch time: 0:17:37.455763,used: 0:36:01.836666,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8182276, 'precision': 0.8183546, 'recall': 0.8182199, 'specificity': 0.8182199, 'f1': 0.81820685, 'auroc': 0.8957411, 'binary_precision': 0.81218326, 'binary_recall': 0.8282692, 'binary_specificity': 0.8081706, 'binary_f1_score': 0.8201474}
confusion matrix:
       0      1
0  23264   5522
1   4951  23879
---- Validation: 
scalar performance:
{'acc': 0.88676625, 'precision': 0.5556325, 'recall': 0.65230614, 'specificity': 0.65230614, 'f1': 0.57065684, 'auroc': 0.8042493, 'binary_precision': 0.13537997, 'binary_recall': 0.39970282, 'binary_specificity': 0.9049095, 'binary_f1_score': 0.20225564}
confusion matrix:
       0     1
0  16349  1718
1    404   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89622945, 'precision': 0.5951158, 'recall': 0.72700655, 'specificity': 0.72700655, 'f1': 0.6242337, 'auroc': 0.86556697, 'binary_precision': 0.2117117, 'binary_recall': 0.5423077, 'binary_specificity': 0.9117054, 'binary_f1_score': 0.30453563}
confusion matrix:
      0    1
0  5421  525
1   119  141
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 01:22:14.055274,epoch time: 0:17:39.756952,used: 0:53:41.593618,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8478027, 'precision': 0.8478339, 'recall': 0.84780616, 'specificity': 0.84780616, 'f1': 0.84780014, 'auroc': 0.9250759, 'binary_precision': 0.8513135, 'binary_recall': 0.8430747, 'binary_specificity': 0.85253763, 'binary_f1_score': 0.847174}
confusion matrix:
       0      1
0  24542   4245
1   4524  24305
---- Validation: 
scalar performance:
{'acc': 0.89850587, 'precision': 0.5747362, 'recall': 0.6934427, 'specificity': 0.6934427, 'f1': 0.59807897, 'auroc': 0.82061505, 'binary_precision': 0.17050938, 'binary_recall': 0.47251114, 'binary_specificity': 0.9143743, 'binary_f1_score': 0.250591}
confusion matrix:
       0     1
0  16520  1547
1    355   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9025137, 'precision': 0.6112771, 'recall': 0.7652268, 'specificity': 0.7652268, 'f1': 0.6466389, 'auroc': 0.8812647, 'binary_precision': 0.24060151, 'binary_recall': 0.61538464, 'binary_specificity': 0.9150689, 'binary_f1_score': 0.34594595}
confusion matrix:
      0    1
0  5441  505
1   100  160
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 01:39:43.855364,epoch time: 0:17:29.800090,used: 1:11:11.393708,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8681095, 'precision': 0.8689344, 'recall': 0.8681268, 'specificity': 0.8681268, 'f1': 0.8680396, 'auroc': 0.94099224, 'binary_precision': 0.8865623, 'binary_recall': 0.84446216, 'binary_specificity': 0.89179146, 'binary_f1_score': 0.86500025}
confusion matrix:
       0      1
0  25672   3115
1   4484  24345
---- Validation: 
scalar performance:
{'acc': 0.90955174, 'precision': 0.5878346, 'recall': 0.7070393, 'specificity': 0.7070393, 'f1': 0.61569476, 'auroc': 0.8300631, 'binary_precision': 0.19583334, 'binary_recall': 0.48885587, 'binary_specificity': 0.92522275, 'binary_f1_score': 0.279643}
confusion matrix:
       0     1
0  16716  1351
1    344   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9083145, 'precision': 0.6210395, 'recall': 0.77928793, 'specificity': 0.77928793, 'f1': 0.65952426, 'auroc': 0.8922559, 'binary_precision': 0.25897035, 'binary_recall': 0.63846153, 'binary_specificity': 0.92011434, 'binary_f1_score': 0.36847946}
confusion matrix:
      0    1
0  5471  475
1    94  166
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 01:57:05.590133,epoch time: 0:17:21.734769,used: 1:28:33.128477,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8794779, 'precision': 0.87968373, 'recall': 0.87948644, 'specificity': 0.87948644, 'f1': 0.8794632, 'auroc': 0.9495623, 'binary_precision': 0.88870734, 'binary_recall': 0.86780673, 'binary_specificity': 0.89116615, 'binary_f1_score': 0.8781327}
confusion matrix:
       0      1
0  25654   3133
1   3811  25018
---- Validation: 
scalar performance:
{'acc': 0.8983992, 'precision': 0.5866826, 'recall': 0.73773396, 'specificity': 0.73773396, 'f1': 0.61529887, 'auroc': 0.83815074, 'binary_precision': 0.19085887, 'binary_recall': 0.56463593, 'binary_specificity': 0.9108319, 'binary_f1_score': 0.2852853}
confusion matrix:
       0     1
0  16456  1611
1    293   380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.890912, 'precision': 0.6123072, 'recall': 0.81250286, 'specificity': 0.81250286, 'f1': 0.64934146, 'auroc': 0.90126204, 'binary_precision': 0.23773585, 'binary_recall': 0.72692305, 'binary_specificity': 0.89808273, 'binary_f1_score': 0.35829383}
confusion matrix:
      0    1
0  5340  606
1    71  189
early stop counter: 1
val acc:0.8983991742134094, best validation acc: 0.909551739692688, corresponding to test acc:                         0.9083145260810852 / 0.9083145260810852
after epoch: 6,now: 2024-08-01 02:14:22.495166,epoch time: 0:17:16.905033,used: 1:45:50.033510,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8915753, 'precision': 0.89270175, 'recall': 0.8915957, 'specificity': 0.8915957, 'f1': 0.89150107, 'auroc': 0.95668375, 'binary_precision': 0.9139265, 'binary_recall': 0.8647589, 'binary_specificity': 0.9184326, 'binary_f1_score': 0.8886632}
confusion matrix:
       0      1
0  26438   2348
1   3899  24931
---- Validation: 
scalar performance:
{'acc': 0.91931695, 'precision': 0.6063497, 'recall': 0.73427707, 'specificity': 0.73427707, 'f1': 0.6398423, 'auroc': 0.8408655, 'binary_precision': 0.23091726, 'binary_recall': 0.53491825, 'binary_specificity': 0.9336359, 'binary_f1_score': 0.32258064}
confusion matrix:
       0     1
0  16868  1199
1    313   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9170158, 'precision': 0.6412808, 'recall': 0.8187696, 'specificity': 0.8187696, 'f1': 0.6867007, 'auroc': 0.90728676, 'binary_precision': 0.296, 'binary_recall': 0.71153843, 'binary_specificity': 0.92600065, 'binary_f1_score': 0.4180791}
confusion matrix:
      0    1
0  5506  440
1    75  185
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-01 02:31:41.210711,epoch time: 0:17:18.715545,used: 2:03:08.749055,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89872605, 'precision': 0.8992058, 'recall': 0.89873934, 'specificity': 0.89873934, 'f1': 0.89869773, 'auroc': 0.9616039, 'binary_precision': 0.9132373, 'binary_recall': 0.8813389, 'binary_specificity': 0.9161398, 'binary_f1_score': 0.89700454}
confusion matrix:
       0      1
0  26372   2414
1   3421  25409
---- Validation: 
scalar performance:
{'acc': 0.90704376, 'precision': 0.5980058, 'recall': 0.75294626, 'specificity': 0.75294626, 'f1': 0.6310804, 'auroc': 0.8448112, 'binary_precision': 0.21247983, 'binary_recall': 0.5869242, 'binary_specificity': 0.91896826, 'binary_f1_score': 0.31200632}
confusion matrix:
       0     1
0  16603  1464
1    278   395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90267485, 'precision': 0.62931556, 'recall': 0.8407093, 'specificity': 0.8407093, 'f1': 0.67332387, 'auroc': 0.9124111, 'binary_precision': 0.269437, 'binary_recall': 0.77307695, 'binary_specificity': 0.90834177, 'binary_f1_score': 0.39960235}
confusion matrix:
      0    1
0  5401  545
1    59  201
early stop counter: 1
val acc:0.9070437550544739, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 8,now: 2024-08-01 02:49:04.364122,epoch time: 0:17:23.153411,used: 2:20:31.902466,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9026139, 'precision': 0.9033431, 'recall': 0.9026294, 'specificity': 0.9026294, 'f1': 0.9025723, 'auroc': 0.9637625, 'binary_precision': 0.9206769, 'binary_recall': 0.8813001, 'binary_specificity': 0.9239587, 'binary_f1_score': 0.9005583}
confusion matrix:
       0      1
0  26598   2189
1   3422  25407
---- Validation: 
scalar performance:
{'acc': 0.90704376, 'precision': 0.5980058, 'recall': 0.75294626, 'specificity': 0.75294626, 'f1': 0.6310804, 'auroc': 0.8473898, 'binary_precision': 0.21247983, 'binary_recall': 0.5869242, 'binary_specificity': 0.91896826, 'binary_f1_score': 0.31200632}
confusion matrix:
       0     1
0  16603  1464
1    278   395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9058975, 'precision': 0.63500965, 'recall': 0.8515861, 'specificity': 0.8515861, 'f1': 0.6812492, 'auroc': 0.9153723, 'binary_precision': 0.2798913, 'binary_recall': 0.7923077, 'binary_specificity': 0.9108645, 'binary_f1_score': 0.41365463}
confusion matrix:
      0    1
0  5416  530
1    54  206
early stop counter: 2
val acc:0.9070437550544739, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 9,now: 2024-08-01 03:06:40.382830,epoch time: 0:17:36.018708,used: 2:38:07.921174,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9079596, 'precision': 0.9090176, 'recall': 0.90797734, 'specificity': 0.90797734, 'f1': 0.9079026, 'auroc': 0.9667577, 'binary_precision': 0.9299945, 'binary_recall': 0.8824754, 'binary_specificity': 0.93347925, 'binary_f1_score': 0.905612}
confusion matrix:
       0      1
0  26873   1915
1   3388  25440
---- Validation: 
scalar performance:
{'acc': 0.90677696, 'precision': 0.60043055, 'recall': 0.7635369, 'specificity': 0.7635369, 'f1': 0.6347002, 'auroc': 0.84979916, 'binary_precision': 0.21647307, 'binary_recall': 0.60921246, 'binary_specificity': 0.9178613, 'binary_f1_score': 0.31943905}
confusion matrix:
       0     1
0  16583  1484
1    263   410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90686435, 'precision': 0.6365524, 'recall': 0.85392964, 'specificity': 0.85392964, 'f1': 0.68336284, 'auroc': 0.9184649, 'binary_precision': 0.28278688, 'binary_recall': 0.79615384, 'binary_specificity': 0.9117054, 'binary_f1_score': 0.41733867}
confusion matrix:
      0    1
0  5421  525
1    53  207
early stop counter: 3
val acc:0.9067769646644592, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 10,now: 2024-08-01 03:24:43.225483,epoch time: 0:18:02.842653,used: 2:56:10.763827,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91377395, 'precision': 0.9142791, 'recall': 0.9137862, 'specificity': 0.9137862, 'f1': 0.9137493, 'auroc': 0.9702691, 'binary_precision': 0.9289207, 'binary_recall': 0.89624673, 'binary_specificity': 0.93132555, 'binary_f1_score': 0.9122912}
confusion matrix:
       0      1
0  26811   1977
1   2991  25837
---- Validation: 
scalar performance:
{'acc': 0.8962647, 'precision': 0.5928976, 'recall': 0.7695292, 'specificity': 0.7695292, 'f1': 0.62433606, 'auroc': 0.85032105, 'binary_precision': 0.20065944, 'binary_recall': 0.6329866, 'binary_specificity': 0.90607184, 'binary_f1_score': 0.30472103}
confusion matrix:
       0     1
0  16370  1697
1    247   426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89848536, 'precision': 0.6282954, 'recall': 0.85507387, 'specificity': 0.85507387, 'f1': 0.672276, 'auroc': 0.92020214, 'binary_precision': 0.2658228, 'binary_recall': 0.8076923, 'binary_specificity': 0.90245545, 'binary_f1_score': 0.40000004}
confusion matrix:
      0    1
0  5366  580
1    50  210
early stop counter: 4
val acc:0.8962646722793579, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 11,now: 2024-08-01 03:42:32.257506,epoch time: 0:17:49.032023,used: 3:13:59.795850,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91582197, 'precision': 0.9166778, 'recall': 0.9158386, 'specificity': 0.9158386, 'f1': 0.915781, 'auroc': 0.9714478, 'binary_precision': 0.93574417, 'binary_recall': 0.89309376, 'binary_specificity': 0.9385834, 'binary_f1_score': 0.9139217}
confusion matrix:
       0      1
0  27019   1768
1   3082  25747
---- Validation: 
scalar performance:
{'acc': 0.90554965, 'precision': 0.59876454, 'recall': 0.76146984, 'specificity': 0.76146984, 'f1': 0.63241005, 'auroc': 0.8509117, 'binary_precision': 0.21327758, 'binary_recall': 0.6062407, 'binary_specificity': 0.91669893, 'binary_f1_score': 0.31554523}
confusion matrix:
       0     1
0  16562  1505
1    265   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91024816, 'precision': 0.64112926, 'recall': 0.85753447, 'specificity': 0.85753447, 'f1': 0.6894253, 'auroc': 0.9209857, 'binary_precision': 0.2917251, 'binary_recall': 0.8, 'binary_specificity': 0.9150689, 'binary_f1_score': 0.42754367}
confusion matrix:
      0    1
0  5441  505
1    52  208
early stop counter: 5
val acc:0.9055496454238892, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 12,now: 2024-08-01 04:00:09.954670,epoch time: 0:17:37.697164,used: 3:31:37.493014,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9169328, 'precision': 0.91736394, 'recall': 0.916944, 'specificity': 0.916944, 'f1': 0.9169128, 'auroc': 0.97207344, 'binary_precision': 0.9309529, 'binary_recall': 0.90079087, 'binary_specificity': 0.9330971, 'binary_f1_score': 0.9156236}
confusion matrix:
       0      1
0  26862   1926
1   2860  25968
---- Validation: 
scalar performance:
{'acc': 0.8863928, 'precision': 0.586913, 'recall': 0.77370787, 'specificity': 0.77370787, 'f1': 0.61511344, 'auroc': 0.8530183, 'binary_precision': 0.18808912, 'binary_recall': 0.6523031, 'binary_specificity': 0.89511263, 'binary_f1_score': 0.29198536}
confusion matrix:
       0     1
0  16172  1895
1    234   439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8894618, 'precision': 0.6209953, 'recall': 0.85772073, 'specificity': 0.85772073, 'f1': 0.66174114, 'auroc': 0.9226041, 'binary_precision': 0.25058547, 'binary_recall': 0.8230769, 'binary_specificity': 0.8923646, 'binary_f1_score': 0.38420105}
confusion matrix:
      0    1
0  5306  640
1    46  214
early stop counter: 6
val acc:0.8863927721977234, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 13,now: 2024-08-01 04:17:38.171734,epoch time: 0:17:28.217064,used: 3:49:05.710078,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9186858, 'precision': 0.919973, 'recall': 0.91870505, 'specificity': 0.91870505, 'f1': 0.9186259, 'auroc': 0.9737381, 'binary_precision': 0.94339764, 'binary_recall': 0.89093935, 'binary_specificity': 0.94647074, 'binary_f1_score': 0.9164184}
confusion matrix:
       0      1
0  27247   1541
1   3144  25684
---- Validation: 
scalar performance:
{'acc': 0.9019744, 'precision': 0.59635884, 'recall': 0.76462245, 'specificity': 0.76462245, 'f1': 0.6292217, 'auroc': 0.85283434, 'binary_precision': 0.20812437, 'binary_recall': 0.6166419, 'binary_specificity': 0.9126031, 'binary_f1_score': 0.31121108}
confusion matrix:
       0     1
0  16488  1579
1    258   415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9081534, 'precision': 0.63927025, 'recall': 0.8601193, 'specificity': 0.8601193, 'f1': 0.68716943, 'auroc': 0.9235194, 'binary_precision': 0.28767124, 'binary_recall': 0.8076923, 'binary_specificity': 0.9125463, 'binary_f1_score': 0.42424244}
confusion matrix:
      0    1
0  5426  520
1    50  210
early stop counter: 7
val acc:0.9019743800163269, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 14,now: 2024-08-01 04:35:04.521887,epoch time: 0:17:26.350153,used: 4:06:32.060231,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.921376, 'precision': 0.92212987, 'recall': 0.9213915, 'specificity': 0.9213915, 'f1': 0.92134285, 'auroc': 0.9739536, 'binary_precision': 0.94015145, 'binary_recall': 0.90016997, 'binary_specificity': 0.942613, 'binary_f1_score': 0.91972643}
confusion matrix:
       0      1
0  27135   1652
1   2878  25951
---- Validation: 
scalar performance:
{'acc': 0.89471716, 'precision': 0.5923774, 'recall': 0.772303, 'specificity': 0.772303, 'f1': 0.62355375, 'auroc': 0.8544431, 'binary_precision': 0.19935246, 'binary_recall': 0.640416, 'binary_specificity': 0.90418994, 'binary_f1_score': 0.30405647}
confusion matrix:
       0     1
0  16336  1731
1    242   431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9007412, 'precision': 0.6318567, 'recall': 0.8617681, 'specificity': 0.8617681, 'f1': 0.6773258, 'auroc': 0.92414486, 'binary_precision': 0.2723785, 'binary_recall': 0.8192308, 'binary_specificity': 0.9043054, 'binary_f1_score': 0.4088292}
confusion matrix:
      0    1
0  5377  569
1    47  213
early stop counter: 8
val acc:0.8947171568870544, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 15,now: 2024-08-01 04:52:51.509596,epoch time: 0:17:46.987709,used: 4:24:19.047940,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9247258, 'precision': 0.92525125, 'recall': 0.92473805, 'specificity': 0.92473805, 'f1': 0.92470396, 'auroc': 0.9757813, 'binary_precision': 0.94037473, 'binary_recall': 0.9070695, 'binary_specificity': 0.94240654, 'binary_f1_score': 0.9234219}
confusion matrix:
       0      1
0  27130   1658
1   2679  26149
---- Validation: 
scalar performance:
{'acc': 0.8886873, 'precision': 0.58836806, 'recall': 0.77346736, 'specificity': 0.77346736, 'f1': 0.6174208, 'auroc': 0.85442185, 'binary_precision': 0.19108002, 'binary_recall': 0.64933133, 'binary_specificity': 0.8976034, 'binary_f1_score': 0.29527026}
confusion matrix:
       0     1
0  16217  1850
1    236   437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8936513, 'precision': 0.62495035, 'recall': 0.8599071, 'specificity': 0.8599071, 'f1': 0.6675495, 'auroc': 0.9247575, 'binary_precision': 0.2584541, 'binary_recall': 0.8230769, 'binary_specificity': 0.8967373, 'binary_f1_score': 0.39338234}
confusion matrix:
      0    1
0  5332  614
1    46  214
early stop counter: 9
val acc:0.8886873126029968, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 16,now: 2024-08-01 05:10:47.529512,epoch time: 0:17:56.019916,used: 4:42:15.067856,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9279193, 'precision': 0.9285014, 'recall': 0.92793345, 'specificity': 0.92793345, 'f1': 0.92789644, 'auroc': 0.9776186, 'binary_precision': 0.9444865, 'binary_recall': 0.9093999, 'binary_specificity': 0.94646704, 'binary_f1_score': 0.9266112}
confusion matrix:
       0      1
0  27245   1541
1   2612  26218
---- Validation: 
scalar performance:
{'acc': 0.886873, 'precision': 0.587281, 'recall': 0.77395695, 'specificity': 0.77395695, 'f1': 0.6156903, 'auroc': 0.85458773, 'binary_precision': 0.1888172, 'binary_recall': 0.6523031, 'binary_specificity': 0.8956108, 'binary_f1_score': 0.2928619}
confusion matrix:
       0     1
0  16181  1886
1    234   439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8926845, 'precision': 0.6240159, 'recall': 0.85940254, 'specificity': 0.85940254, 'f1': 0.66619027, 'auroc': 0.92552656, 'binary_precision': 0.25659472, 'binary_recall': 0.8230769, 'binary_specificity': 0.89572823, 'binary_f1_score': 0.39122486}
confusion matrix:
      0    1
0  5326  620
1    46  214
early stop counter: 10
val acc:0.8868730068206787, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 17,now: 2024-08-01 05:28:42.548406,epoch time: 0:17:55.018894,used: 5:00:10.086750,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9276243, 'precision': 0.9284501, 'recall': 0.92764115, 'specificity': 0.92764115, 'f1': 0.9275913, 'auroc': 0.977707, 'binary_precision': 0.9474525, 'binary_recall': 0.90558445, 'binary_specificity': 0.9496978, 'binary_f1_score': 0.92604554}
confusion matrix:
       0      1
0  27338   1448
1   2722  26108
---- Validation: 
scalar performance:
{'acc': 0.8829242, 'precision': 0.58498234, 'recall': 0.7747701, 'specificity': 0.7747701, 'f1': 0.61194164, 'auroc': 0.8546951, 'binary_precision': 0.18404654, 'binary_recall': 0.65824664, 'binary_specificity': 0.8912935, 'binary_f1_score': 0.28766236}
confusion matrix:
       0     1
0  16103  1964
1    230   443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8868837, 'precision': 0.61867815, 'recall': 0.85637534, 'specificity': 0.85637534, 'f1': 0.65826905, 'auroc': 0.92565525, 'binary_precision': 0.24597701, 'binary_recall': 0.8230769, 'binary_specificity': 0.8896737, 'binary_f1_score': 0.37876105}
confusion matrix:
      0    1
0  5290  656
1    46  214
early stop counter: 11
val acc:0.8829241991043091, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 18,now: 2024-08-01 05:47:08.668380,epoch time: 0:18:26.119974,used: 5:18:36.206724,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9306616, 'precision': 0.9310174, 'recall': 0.93067265, 'specificity': 0.93067265, 'f1': 0.93064845, 'auroc': 0.9786632, 'binary_precision': 0.943593, 'binary_recall': 0.91619843, 'binary_specificity': 0.9451469, 'binary_f1_score': 0.92969394}
confusion matrix:
       0      1
0  27207   1579
1   2416  26414
---- Validation: 
scalar performance:
{'acc': 0.86819637, 'precision': 0.5790659, 'recall': 0.7842983, 'specificity': 0.7842983, 'f1': 0.60094905, 'auroc': 0.85389245, 'binary_precision': 0.17099963, 'binary_recall': 0.69390786, 'binary_specificity': 0.8746887, 'binary_f1_score': 0.27438307}
confusion matrix:
       0     1
0  15803  2264
1    206   467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.875282, 'precision': 0.61036247, 'recall': 0.8558378, 'specificity': 0.8558378, 'f1': 0.6450946, 'auroc': 0.9257115, 'binary_precision': 0.22890295, 'binary_recall': 0.8346154, 'binary_specificity': 0.87706023, 'binary_f1_score': 0.3592715}
confusion matrix:
      0    1
0  5215  731
1    43  217
early stop counter: 12
val acc:0.8681963682174683, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 19,now: 2024-08-01 06:05:39.118116,epoch time: 0:18:30.449736,used: 5:37:06.656460,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.92915165, 'precision': 0.9298266, 'recall': 0.9291655, 'specificity': 0.9291655, 'f1': 0.9291253, 'auroc': 0.97859895, 'binary_precision': 0.94703376, 'binary_recall': 0.9092549, 'binary_specificity': 0.949076, 'binary_f1_score': 0.9277599}
confusion matrix:
       0      1
0  27322   1466
1   2616  26212
---- Validation: 
scalar performance:
{'acc': 0.8831377, 'precision': 0.58561957, 'recall': 0.77702653, 'specificity': 0.77702653, 'f1': 0.61287796, 'auroc': 0.8537965, 'binary_precision': 0.18513906, 'binary_recall': 0.6627043, 'binary_specificity': 0.89134884, 'binary_f1_score': 0.28942245}
confusion matrix:
       0     1
0  16104  1963
1    227   446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88913953, 'precision': 0.6210842, 'recall': 0.85939157, 'specificity': 0.85939157, 'f1': 0.661849, 'auroc': 0.9258215, 'binary_precision': 0.25058275, 'binary_recall': 0.8269231, 'binary_specificity': 0.89186007, 'binary_f1_score': 0.3846154}
confusion matrix:
      0    1
0  5303  643
1    45  215
early stop counter: 13
val acc:0.8831377029418945, best validation acc: 0.9193169474601746, corresponding to test acc:                         0.917015790939331 / 0.917015790939331
after epoch: 20,now: 2024-08-01 06:23:57.749106,epoch time: 0:18:18.630990,used: 5:55:25.287450,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_00_28_32_seed_1_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:55:25.287450 at 2024-08-01 06:23:57.749106
persisted model performance metric: 

scalar performance:
{'acc': 0.9170158, 'precision': 0.6412808, 'recall': 0.8187696, 'specificity': 0.8187696, 'f1': 0.6867007, 'auroc': 0.90728676, 'binary_precision': 0.296, 'binary_recall': 0.71153843, 'binary_specificity': 0.92600065, 'binary_f1_score': 0.4180791}
confusion matrix:
      0    1
0  5506  440
1    75  185
oracle model performance metric: 

scalar performance:
{'acc': 0.9170158, 'precision': 0.6412808, 'recall': 0.8187696, 'specificity': 0.8187696, 'f1': 0.6867007, 'auroc': 0.90728676, 'binary_precision': 0.296, 'binary_recall': 0.71153843, 'binary_specificity': 0.92600065, 'binary_f1_score': 0.4180791}
confusion matrix:
      0    1
0  5506  440
1    75  185
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461507 KiB | 702662 GiB | 702662 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |  17465 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461507 KiB | 702662 GiB | 702662 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |  17465 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB | 702622 GiB | 702622 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 688215 GiB | 688215 GiB |
|       from small pool |  16466 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    788 MiB | 280576 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     56 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42512 KiB |  87761 KiB | 381860 GiB | 381860 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 367398 GiB | 367398 GiB |
|       from small pool |  11206 KiB |  18293 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7685    |  162707 K  |  162704 K  |
|       from large pool |      76    |     158    |   67834 K  |   67834 K  |
|       from small pool |    2866    |    7607    |   94872 K  |   94870 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7685    |  162707 K  |  162704 K  |
|       from large pool |      76    |     158    |   67834 K  |   67834 K  |
|       from small pool |    2866    |    7607    |   94872 K  |   94870 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      61    |      20    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3620    |   84999 K  |   84999 K  |
|       from large pool |      10    |      23    |   42044 K  |   42044 K  |
|       from small pool |      25    |    3610    |   42954 K  |   42954 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 702662 GiB | 702662 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 702662 GiB | 702662 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 702622 GiB | 702622 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 688215 GiB | 688215 GiB |
|       from small pool |      0 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    788 MiB | 573440 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     56 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 381860 GiB | 381860 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 367398 GiB | 367398 GiB |
|       from small pool |      0 KiB |  21236 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7685    |  162707 K  |  162707 K  |
|       from large pool |       2    |     158    |   67834 K  |   67834 K  |
|       from small pool |       0    |    7607    |   94872 K  |   94872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7685    |  162707 K  |  162707 K  |
|       from large pool |       2    |     158    |   67834 K  |   67834 K  |
|       from small pool |       0    |    7607    |   94872 K  |   94872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      61    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3620    |   85000 K  |   85000 K  |
|       from large pool |       3    |      23    |   42044 K  |   42044 K  |
|       from small pool |       0    |    3610    |   42955 K  |   42955 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB | 702662 GiB | 702662 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB | 702662 GiB | 702662 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 688223 GiB | 688223 GiB |
|       from small pool |      0 KiB |  38507 KiB |  14439 GiB |  14439 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 702622 GiB | 702622 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 688215 GiB | 688215 GiB |
|       from small pool |      0 KiB |  37503 KiB |  14406 GiB |  14406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    788 MiB | 573440 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     56 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 381860 GiB | 381860 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 367398 GiB | 367398 GiB |
|       from small pool |      0 KiB |  21236 KiB |  14461 GiB |  14461 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7685    |  162707 K  |  162707 K  |
|       from large pool |       2    |     158    |   67834 K  |   67834 K  |
|       from small pool |       0    |    7607    |   94872 K  |   94872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7685    |  162707 K  |  162707 K  |
|       from large pool |       2    |     158    |   67834 K  |   67834 K  |
|       from small pool |       0    |    7607    |   94872 K  |   94872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      61    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3620    |   85000 K  |   85000 K  |
|       from large pool |       3    |      23    |   42044 K  |   42044 K  |
|       from small pool |       0    |    3610    |   42955 K  |   42955 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238

 Experiment start at: 2024-08-01 06:34:13.218100
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7365189, 'precision': 0.7365612, 'recall': 0.73651755, 'specificity': 0.73651755, 'f1': 0.7365064, 'auroc': 0.8118434, 'binary_precision': 0.73345065, 'binary_recall': 0.74326086, 'binary_specificity': 0.72977424, 'binary_f1_score': 0.73832315}
confusion matrix:
       0      1
0  21270   7876
1   7486  21672
---- Validation: 
scalar performance:
{'acc': 0.62771, 'precision': 0.5246701, 'recall': 0.68883693, 'specificity': 0.68883693, 'f1': 0.4396279, 'auroc': 0.75498295, 'binary_precision': 0.062234405, 'binary_recall': 0.75415283, 'binary_specificity': 0.623521, 'binary_f1_score': 0.11498037}
confusion matrix:
       0     1
0  11330  6841
1    148   454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36095527, 'precision': 0.5040948, 'recall': 0.52482647, 'specificity': 0.52482647, 'f1': 0.29471698, 'auroc': 0.4995004, 'binary_precision': 0.04161567, 'binary_recall': 0.70247936, 'binary_specificity': 0.3471736, 'binary_f1_score': 0.078576386}
confusion matrix:
      0     1
0  2082  3915
1    72   170
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 06:53:43.830648,epoch time: 0:19:30.612548,used: 0:19:30.612548,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8146954, 'precision': 0.8155589, 'recall': 0.8146999, 'specificity': 0.8146999, 'f1': 0.81457007, 'auroc': 0.8936137, 'binary_precision': 0.83210886, 'binary_recall': 0.7885585, 'binary_specificity': 0.84084123, 'binary_f1_score': 0.80974853}
confusion matrix:
       0      1
0  24508   4639
1   6165  22992
---- Validation: 
scalar performance:
{'acc': 0.73877376, 'precision': 0.53404707, 'recall': 0.71810186, 'specificity': 0.71810186, 'f1': 0.49587387, 'auroc': 0.7819741, 'binary_precision': 0.08151751, 'binary_recall': 0.6960133, 'binary_specificity': 0.7401904, 'binary_f1_score': 0.14594218}
confusion matrix:
       0     1
0  13450  4721
1    183   419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5741305, 'precision': 0.5175496, 'recall': 0.6158878, 'specificity': 0.6158878, 'f1': 0.41391796, 'auroc': 0.6397861, 'binary_precision': 0.058500916, 'binary_recall': 0.661157, 'binary_specificity': 0.5706186, 'binary_f1_score': 0.10749077}
confusion matrix:
      0     1
0  3422  2575
1    82   160
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 07:12:47.450655,epoch time: 0:19:03.620007,used: 0:38:34.232555,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8479864, 'precision': 0.848345, 'recall': 0.8479897, 'specificity': 0.8479897, 'f1': 0.84794813, 'auroc': 0.92330575, 'binary_precision': 0.85957265, 'binary_recall': 0.83195007, 'binary_specificity': 0.86402935, 'binary_f1_score': 0.8455358}
confusion matrix:
       0      1
0  25183   3963
1   4900  24258
---- Validation: 
scalar performance:
{'acc': 0.76908326, 'precision': 0.53914225, 'recall': 0.7321526, 'specificity': 0.7321526, 'f1': 0.5137276, 'auroc': 0.7994791, 'binary_precision': 0.0913072, 'binary_recall': 0.692691, 'binary_specificity': 0.77161413, 'binary_f1_score': 0.16134648}
confusion matrix:
       0     1
0  14021  4150
1    185   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6409681, 'precision': 0.52682114, 'recall': 0.6684999, 'specificity': 0.6684999, 'f1': 0.4524234, 'auroc': 0.7153129, 'binary_precision': 0.07234589, 'binary_recall': 0.6983471, 'binary_specificity': 0.6386527, 'binary_f1_score': 0.13110939}
confusion matrix:
      0     1
0  3830  2167
1    73   169
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 07:31:30.493290,epoch time: 0:18:43.042635,used: 0:57:17.275190,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.86506927, 'precision': 0.8650896, 'recall': 0.8650699, 'specificity': 0.8650699, 'f1': 0.8650676, 'auroc': 0.9380287, 'binary_precision': 0.8678554, 'binary_recall': 0.8613369, 'binary_specificity': 0.86880296, 'binary_f1_score': 0.8645839}
confusion matrix:
       0      1
0  25323   3824
1   4043  25114
---- Validation: 
scalar performance:
{'acc': 0.79523784, 'precision': 0.54394203, 'recall': 0.74004173, 'specificity': 0.74004173, 'f1': 0.5294559, 'auroc': 0.8117002, 'binary_precision': 0.1009355, 'binary_recall': 0.6810631, 'binary_specificity': 0.7990204, 'binary_f1_score': 0.17581475}
confusion matrix:
       0     1
0  14519  3652
1    192   410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6876102, 'precision': 0.5345272, 'recall': 0.70465845, 'specificity': 0.70465845, 'f1': 0.48038372, 'auroc': 0.7614193, 'binary_precision': 0.085075356, 'binary_recall': 0.7231405, 'binary_specificity': 0.6861764, 'binary_f1_score': 0.1522401}
confusion matrix:
      0     1
0  4115  1882
1    67   175
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 07:50:49.715003,epoch time: 0:19:19.221713,used: 1:16:36.496903,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.87301046, 'precision': 0.87330437, 'recall': 0.8730133, 'specificity': 0.8730133, 'f1': 0.87298596, 'auroc': 0.9446449, 'binary_precision': 0.8838309, 'binary_recall': 0.85897523, 'binary_specificity': 0.8870514, 'binary_f1_score': 0.8712258}
confusion matrix:
       0      1
0  25854   3292
1   4112  25046
---- Validation: 
scalar performance:
{'acc': 0.8192617, 'precision': 0.5486209, 'recall': 0.742012, 'specificity': 0.742012, 'f1': 0.54396147, 'auroc': 0.82057405, 'binary_precision': 0.110739194, 'binary_recall': 0.6594684, 'binary_specificity': 0.82455564, 'binary_f1_score': 0.1896346}
confusion matrix:
       0     1
0  14983  3188
1    205   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7281616, 'precision': 0.5416144, 'recall': 0.72971785, 'specificity': 0.72971785, 'f1': 0.505022, 'auroc': 0.7924135, 'binary_precision': 0.09789823, 'binary_recall': 0.73140496, 'binary_specificity': 0.7280307, 'binary_f1_score': 0.17268293}
confusion matrix:
      0     1
0  4366  1631
1    65   177
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 08:10:13.456239,epoch time: 0:19:23.741236,used: 1:36:00.238139,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8879665, 'precision': 0.88852966, 'recall': 0.88797045, 'specificity': 0.88797045, 'f1': 0.88792664, 'auroc': 0.9539001, 'binary_precision': 0.903373, 'binary_recall': 0.86892104, 'binary_specificity': 0.90701985, 'binary_f1_score': 0.88581216}
confusion matrix:
       0      1
0  26436   2710
1   3822  25336
---- Validation: 
scalar performance:
{'acc': 0.83710647, 'precision': 0.55373406, 'recall': 0.7472148, 'specificity': 0.7472148, 'f1': 0.55666465, 'auroc': 0.8287935, 'binary_precision': 0.120987654, 'binary_recall': 0.6511628, 'binary_specificity': 0.8432667, 'binary_f1_score': 0.20406039}
confusion matrix:
       0     1
0  15323  2848
1    210   392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76021796, 'precision': 0.55009484, 'recall': 0.7582893, 'specificity': 0.7582893, 'f1': 0.5278218, 'auroc': 0.8187475, 'binary_precision': 0.11296296, 'binary_recall': 0.75619835, 'binary_specificity': 0.7603802, 'binary_f1_score': 0.19656283}
confusion matrix:
      0     1
0  4560  1437
1    59   183
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-01 08:29:31.625226,epoch time: 0:19:18.168987,used: 1:55:18.407126,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89273465, 'precision': 0.8933133, 'recall': 0.8927379, 'specificity': 0.8927379, 'f1': 0.8926958, 'auroc': 0.95746, 'binary_precision': 0.90844244, 'binary_recall': 0.87354666, 'binary_specificity': 0.9119292, 'binary_f1_score': 0.8906529}
confusion matrix:
       0      1
0  26580   2567
1   3687  25470
---- Validation: 
scalar performance:
{'acc': 0.84285945, 'precision': 0.5558667, 'recall': 0.75018656, 'specificity': 0.75018656, 'f1': 0.5613577, 'auroc': 0.83414006, 'binary_precision': 0.12515964, 'binary_recall': 0.6511628, 'binary_specificity': 0.84921026, 'binary_f1_score': 0.2099625}
confusion matrix:
       0     1
0  15431  2740
1    210   392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7709569, 'precision': 0.5529727, 'recall': 0.7658581, 'specificity': 0.7658581, 'f1': 0.5354983, 'auroc': 0.8347893, 'binary_precision': 0.118327975, 'binary_recall': 0.76033056, 'binary_specificity': 0.77138567, 'binary_f1_score': 0.20478575}
confusion matrix:
      0     1
0  4626  1371
1    58   184
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-01 08:49:14.001703,epoch time: 0:19:42.376477,used: 2:15:00.783603,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89803445, 'precision': 0.8984951, 'recall': 0.8980373, 'specificity': 0.8980373, 'f1': 0.8980054, 'auroc': 0.9607121, 'binary_precision': 0.91208637, 'binary_recall': 0.8810234, 'binary_specificity': 0.9150513, 'binary_f1_score': 0.89628583}
confusion matrix:
       0      1
0  26671   2476
1   3469  25688
---- Validation: 
scalar performance:
{'acc': 0.84445745, 'precision': 0.5573911, 'recall': 0.7558303, 'specificity': 0.7558303, 'f1': 0.56394744, 'auroc': 0.8389393, 'binary_precision': 0.1278099, 'binary_recall': 0.6611296, 'binary_specificity': 0.85053104, 'binary_f1_score': 0.21420884}
confusion matrix:
       0     1
0  15455  2716
1    204   398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7762462, 'precision': 0.55570424, 'recall': 0.7765405, 'specificity': 0.7765405, 'f1': 0.5408977, 'auroc': 0.84788954, 'binary_precision': 0.12287582, 'binary_recall': 0.7768595, 'binary_specificity': 0.77622145, 'binary_f1_score': 0.21218961}
confusion matrix:
      0     1
0  4655  1342
1    54   188
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-01 09:08:38.897024,epoch time: 0:19:24.895321,used: 2:34:25.678924,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9015848, 'precision': 0.9031759, 'recall': 0.9015924, 'specificity': 0.9015924, 'f1': 0.90148884, 'auroc': 0.9631431, 'binary_precision': 0.9285636, 'binary_recall': 0.87016016, 'binary_specificity': 0.9330245, 'binary_f1_score': 0.8984138}
confusion matrix:
       0      1
0  27193   1952
1   3786  25373
---- Validation: 
scalar performance:
{'acc': 0.8654983, 'precision': 0.56408125, 'recall': 0.75304747, 'specificity': 0.75304747, 'f1': 0.5790595, 'auroc': 0.84125185, 'binary_precision': 0.14189944, 'binary_recall': 0.63289034, 'binary_specificity': 0.8732045, 'binary_f1_score': 0.23182231}
confusion matrix:
       0     1
0  15867  2304
1    221   381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80830264, 'precision': 0.56332105, 'recall': 0.7833018, 'specificity': 0.7833018, 'f1': 0.56237555, 'auroc': 0.8578923, 'binary_precision': 0.13863637, 'binary_recall': 0.75619835, 'binary_specificity': 0.8104052, 'binary_f1_score': 0.234315}
confusion matrix:
      0     1
0  4860  1137
1    59   183
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-01 09:27:24.664918,epoch time: 0:18:45.767894,used: 2:53:11.446818,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9085311, 'precision': 0.9091362, 'recall': 0.9085344, 'specificity': 0.9085344, 'f1': 0.9084978, 'auroc': 0.96675324, 'binary_precision': 0.92491263, 'binary_recall': 0.889289, 'binary_specificity': 0.92777985, 'binary_f1_score': 0.9067511}
confusion matrix:
       0      1
0  27042   2105
1   3228  25929
---- Validation: 
scalar performance:
{'acc': 0.8591062, 'precision': 0.5627467, 'recall': 0.758579, 'specificity': 0.758579, 'f1': 0.5755554, 'auroc': 0.8447858, 'binary_precision': 0.13866289, 'binary_recall': 0.6511628, 'binary_specificity': 0.8659953, 'binary_f1_score': 0.2286381}
confusion matrix:
       0     1
0  15736  2435
1    210   392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8007693, 'precision': 0.56161445, 'recall': 0.7833487, 'specificity': 0.7833487, 'f1': 0.55749106, 'auroc': 0.8651695, 'binary_precision': 0.134938, 'binary_recall': 0.7644628, 'binary_specificity': 0.8022345, 'binary_f1_score': 0.22938623}
confusion matrix:
      0     1
0  4811  1186
1    57   185
early stop counter: 1
val acc:0.859106183052063, best validation acc: 0.8654983043670654, corresponding to test acc:                         0.808302640914917 / 0.808302640914917
after epoch: 10,now: 2024-08-01 09:45:55.514294,epoch time: 0:18:30.849376,used: 3:11:42.296194,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90894276, 'precision': 0.90982926, 'recall': 0.9089452, 'specificity': 0.9089452, 'f1': 0.9088939, 'auroc': 0.967281, 'binary_precision': 0.92891574, 'binary_recall': 0.88567996, 'binary_specificity': 0.9322104, 'binary_f1_score': 0.9067828}
confusion matrix:
       0      1
0  27173   1976
1   3333  25822
---- Validation: 
scalar performance:
{'acc': 0.85468495, 'precision': 0.5616691, 'recall': 0.76111346, 'specificity': 0.76111346, 'f1': 0.57284814, 'auroc': 0.84864634, 'binary_precision': 0.13620807, 'binary_recall': 0.6611296, 'binary_specificity': 0.86109734, 'binary_f1_score': 0.22587968}
confusion matrix:
       0     1
0  15647  2524
1    204   398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.797724, 'precision': 0.56356514, 'recall': 0.7976264, 'specificity': 0.7976264, 'f1': 0.55884755, 'auroc': 0.8726822, 'binary_precision': 0.13726884, 'binary_recall': 0.79752064, 'binary_specificity': 0.7977322, 'binary_f1_score': 0.23422329}
confusion matrix:
      0     1
0  4784  1213
1    49   193
early stop counter: 2
val acc:0.8546849489212036, best validation acc: 0.8654983043670654, corresponding to test acc:                         0.808302640914917 / 0.808302640914917
after epoch: 11,now: 2024-08-01 10:04:30.705080,epoch time: 0:18:35.190786,used: 3:30:17.486980,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9135737, 'precision': 0.91418266, 'recall': 0.913579, 'specificity': 0.913579, 'f1': 0.9135426, 'auroc': 0.9696355, 'binary_precision': 0.93013304, 'binary_recall': 0.89437586, 'binary_specificity': 0.93278205, 'binary_f1_score': 0.9119041}
confusion matrix:
       0      1
0  27185   1959
1   3080  26080
---- Validation: 
scalar performance:
{'acc': 0.84978426, 'precision': 0.5616796, 'recall': 0.7698246, 'specificity': 0.7698246, 'f1': 0.5714721, 'auroc': 0.8514234, 'binary_precision': 0.1354372, 'binary_recall': 0.68438536, 'binary_specificity': 0.8552639, 'binary_f1_score': 0.22612514}
confusion matrix:
       0     1
0  15541  2630
1    190   412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79163325, 'precision': 0.5620743, 'recall': 0.79644096, 'specificity': 0.79644096, 'f1': 0.554688, 'auroc': 0.87772405, 'binary_precision': 0.13416322, 'binary_recall': 0.8016529, 'binary_specificity': 0.79122895, 'binary_f1_score': 0.22985785}
confusion matrix:
      0     1
0  4745  1252
1    48   194
early stop counter: 3
val acc:0.849784255027771, best validation acc: 0.8654983043670654, corresponding to test acc:                         0.808302640914917 / 0.808302640914917
after epoch: 12,now: 2024-08-01 10:23:27.614846,epoch time: 0:18:56.909766,used: 3:49:14.396746,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91683245, 'precision': 0.91740894, 'recall': 0.916835, 'specificity': 0.916835, 'f1': 0.9168041, 'auroc': 0.9715235, 'binary_precision': 0.93295574, 'binary_recall': 0.89823705, 'binary_specificity': 0.935433, 'binary_f1_score': 0.91526735}
confusion matrix:
       0      1
0  27266   1882
1   2967  26189
---- Validation: 
scalar performance:
{'acc': 0.8522346, 'precision': 0.563192, 'recall': 0.77349955, 'specificity': 0.77349955, 'f1': 0.57428604, 'auroc': 0.8538505, 'binary_precision': 0.13824117, 'binary_recall': 0.6893688, 'binary_specificity': 0.8576303, 'binary_f1_score': 0.23029967}
confusion matrix:
       0     1
0  15584  2587
1    187   415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7961212, 'precision': 0.564854, 'recall': 0.80670637, 'specificity': 0.80670637, 'f1': 0.5598706, 'auroc': 0.88190794, 'binary_precision': 0.13884993, 'binary_recall': 0.8181818, 'binary_specificity': 0.7952309, 'binary_f1_score': 0.23741007}
confusion matrix:
      0     1
0  4769  1228
1    44   198
early stop counter: 4
val acc:0.8522346019744873, best validation acc: 0.8654983043670654, corresponding to test acc:                         0.808302640914917 / 0.808302640914917
after epoch: 13,now: 2024-08-01 10:42:44.039560,epoch time: 0:19:16.424714,used: 4:08:30.821460,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9182903, 'precision': 0.9189255, 'recall': 0.918295, 'specificity': 0.918295, 'f1': 0.91826, 'auroc': 0.97276235, 'binary_precision': 0.9352985, 'binary_recall': 0.89879626, 'binary_specificity': 0.9377938, 'binary_f1_score': 0.91668415}
confusion matrix:
       0      1
0  27332   1813
1   2951  26208
---- Validation: 
scalar performance:
{'acc': 0.8589996, 'precision': 0.5656737, 'recall': 0.7737819, 'specificity': 0.7737819, 'f1': 0.57963943, 'auroc': 0.85474646, 'binary_precision': 0.14335543, 'binary_recall': 0.68272424, 'binary_specificity': 0.86483955, 'binary_f1_score': 0.23695591}
confusion matrix:
       0     1
0  15715  2456
1    191   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8094246, 'precision': 0.5673992, 'recall': 0.8037128, 'specificity': 0.8037128, 'f1': 0.56801337, 'auroc': 0.88554335, 'binary_precision': 0.1447862, 'binary_recall': 0.79752064, 'binary_specificity': 0.80990493, 'binary_f1_score': 0.24507937}
confusion matrix:
      0     1
0  4857  1140
1    49   193
new oracle model saved
early stop counter: 5
val acc:0.8589996099472046, best validation acc: 0.8654983043670654, corresponding to test acc:                         0.808302640914917 / 0.8094245791435242
after epoch: 14,now: 2024-08-01 11:01:51.325532,epoch time: 0:19:07.285972,used: 4:27:38.107432,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9187706, 'precision': 0.9193896, 'recall': 0.9187739, 'specificity': 0.9187739, 'f1': 0.918741, 'auroc': 0.9735801, 'binary_precision': 0.93554485, 'binary_recall': 0.8995438, 'binary_specificity': 0.9380039, 'binary_f1_score': 0.91719115}
confusion matrix:
       0      1
0  27340   1807
1   2929  26228
---- Validation: 
scalar performance:
{'acc': 0.86091727, 'precision': 0.5665987, 'recall': 0.7747725, 'specificity': 0.7747725, 'f1': 0.58145046, 'auroc': 0.8558351, 'binary_precision': 0.14517838, 'binary_recall': 0.68272424, 'binary_specificity': 0.86682075, 'binary_f1_score': 0.23944071}
confusion matrix:
       0     1
0  15751  2420
1    191   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81679755, 'precision': 0.5700331, 'recall': 0.80754805, 'specificity': 0.80754805, 'f1': 0.57402974, 'auroc': 0.8891112, 'binary_precision': 0.14996114, 'binary_recall': 0.79752064, 'binary_specificity': 0.81757545, 'binary_f1_score': 0.25245258}
confusion matrix:
      0     1
0  4903  1094
1    49   193
new oracle model saved
early stop counter: 6
val acc:0.8609172701835632, best validation acc: 0.8654983043670654, corresponding to test acc:                         0.808302640914917 / 0.8167975544929504
after epoch: 15,now: 2024-08-01 11:19:56.593316,epoch time: 0:18:05.267784,used: 4:45:43.375216,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9228869, 'precision': 0.9234216, 'recall': 0.92289, 'specificity': 0.92289, 'f1': 0.922863, 'auroc': 0.97468483, 'binary_precision': 0.9385113, 'binary_recall': 0.9051, 'binary_specificity': 0.94068, 'binary_f1_score': 0.92150295}
confusion matrix:
       0      1
0  27418   1729
1   2767  26390
---- Validation: 
scalar performance:
{'acc': 0.8628882, 'precision': 0.5674169, 'recall': 0.7749876, 'specificity': 0.7749876, 'f1': 0.58311695, 'auroc': 0.8548658, 'binary_precision': 0.14684814, 'binary_recall': 0.6810631, 'binary_specificity': 0.868912, 'binary_f1_score': 0.24160284}
confusion matrix:
       0     1
0  15789  2382
1    192   410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8252925, 'precision': 0.572929, 'recall': 0.8099842, 'specificity': 0.8099842, 'f1': 0.5807303, 'auroc': 0.8909682, 'binary_precision': 0.15584415, 'binary_recall': 0.7933884, 'binary_specificity': 0.8265799, 'binary_f1_score': 0.2605156}
confusion matrix:
      0     1
0  4957  1040
1    50   192
new oracle model saved
early stop counter: 7
val acc:0.8628882169723511, best validation acc: 0.8654983043670654, corresponding to test acc:                         0.808302640914917 / 0.8252925276756287
after epoch: 16,now: 2024-08-01 11:39:03.165701,epoch time: 0:19:06.572385,used: 5:04:49.947601,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9239503, 'precision': 0.9246612, 'recall': 0.92395246, 'specificity': 0.92395246, 'f1': 0.9239187, 'auroc': 0.97576666, 'binary_precision': 0.94206214, 'binary_recall': 0.90348136, 'binary_specificity': 0.9444235, 'binary_f1_score': 0.9223685}
confusion matrix:
       0      1
0  27529   1620
1   2814  26341
---- Validation: 
scalar performance:
{'acc': 0.86081076, 'precision': 0.56654674, 'recall': 0.77471745, 'specificity': 0.77471745, 'f1': 0.58134925, 'auroc': 0.85566306, 'binary_precision': 0.14507589, 'binary_recall': 0.68272424, 'binary_specificity': 0.8667107, 'binary_f1_score': 0.2393013}
confusion matrix:
       0     1
0  15749  2422
1    191   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.824972, 'precision': 0.5731774, 'recall': 0.8118002, 'specificity': 0.8118002, 'f1': 0.5809455, 'auroc': 0.8928307, 'binary_precision': 0.15614887, 'binary_recall': 0.79752064, 'binary_specificity': 0.8260797, 'binary_f1_score': 0.26116374}
confusion matrix:
      0     1
0  4954  1043
1    49   193
early stop counter: 8
val acc:0.8608107566833496, best validation acc: 0.8654983043670654, corresponding to test acc:                         0.808302640914917 / 0.8252925276756287
after epoch: 17,now: 2024-08-01 11:56:58.008933,epoch time: 0:17:54.843232,used: 5:22:44.790833,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.92556256, 'precision': 0.926384, 'recall': 0.9255671, 'specificity': 0.9255671, 'f1': 0.9255272, 'auroc': 0.97676575, 'binary_precision': 0.94514996, 'binary_recall': 0.9035942, 'binary_specificity': 0.94754, 'binary_f1_score': 0.9239051}
confusion matrix:
       0      1
0  27617   1529
1   2811  26347
---- Validation: 
scalar performance:
{'acc': 0.86661696, 'precision': 0.56933135, 'recall': 0.7769137, 'specificity': 0.7769137, 'f1': 0.5867607, 'auroc': 0.85737455, 'binary_precision': 0.15062454, 'binary_recall': 0.6810631, 'binary_specificity': 0.8727643, 'binary_f1_score': 0.24669074}
confusion matrix:
       0     1
0  15859  2312
1    192   410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333066, 'precision': 0.5766567, 'recall': 0.81613564, 'specificity': 0.81613564, 'f1': 0.5882933, 'auroc': 0.8948792, 'binary_precision': 0.16300675, 'binary_recall': 0.79752064, 'binary_specificity': 0.8347507, 'binary_f1_score': 0.27068722}
confusion matrix:
      0    1
0  5006  991
1    49  193
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-08-01 12:14:09.602850,epoch time: 0:17:11.593917,used: 5:39:56.384750,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.92614573, 'precision': 0.9270126, 'recall': 0.9261503, 'specificity': 0.9261503, 'f1': 0.9261087, 'auroc': 0.97762597, 'binary_precision': 0.94630414, 'binary_recall': 0.9035942, 'binary_specificity': 0.9487065, 'binary_f1_score': 0.9244561}
confusion matrix:
       0      1
0  27651   1495
1   2811  26347
---- Validation: 
scalar performance:
{'acc': 0.8658712, 'precision': 0.5692572, 'recall': 0.7781346, 'specificity': 0.7781346, 'f1': 0.5864709, 'auroc': 0.85868824, 'binary_precision': 0.15036497, 'binary_recall': 0.68438536, 'binary_specificity': 0.87188375, 'binary_f1_score': 0.24655896}
confusion matrix:
       0     1
0  15843  2328
1    190   412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83122295, 'precision': 0.57575905, 'recall': 0.8150518, 'specificity': 0.8150518, 'f1': 0.58642644, 'auroc': 0.8961342, 'binary_precision': 0.16123642, 'binary_recall': 0.79752064, 'binary_specificity': 0.83258295, 'binary_f1_score': 0.26824185}
confusion matrix:
      0     1
0  4993  1004
1    49   193
early stop counter: 1
val acc:0.8658711910247803, best validation acc: 0.86661696434021, corresponding to test acc:                         0.833306610584259 / 0.833306610584259
after epoch: 19,now: 2024-08-01 12:31:21.494821,epoch time: 0:17:11.891971,used: 5:57:08.276721,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9264716, 'precision': 0.9270177, 'recall': 0.9264753, 'specificity': 0.9264753, 'f1': 0.9264485, 'auroc': 0.97727716, 'binary_precision': 0.94233984, 'binary_recall': 0.90856713, 'binary_specificity': 0.94438344, 'binary_f1_score': 0.9251454}
confusion matrix:
       0      1
0  27525   1621
1   2666  26492
---- Validation: 
scalar performance:
{'acc': 0.8565493, 'precision': 0.5665126, 'recall': 0.78295577, 'specificity': 0.78295577, 'f1': 0.5801431, 'auroc': 0.860168, 'binary_precision': 0.14426675, 'binary_recall': 0.70431894, 'binary_specificity': 0.86159265, 'binary_f1_score': 0.23948038}
confusion matrix:
       0     1
0  15656  2515
1    178   424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8195224, 'precision': 0.5717975, 'recall': 0.81293094, 'specificity': 0.81293094, 'f1': 0.5772687, 'auroc': 0.89830184, 'binary_precision': 0.15306123, 'binary_recall': 0.8057851, 'binary_specificity': 0.8200767, 'binary_f1_score': 0.25725594}
confusion matrix:
      0     1
0  4918  1079
1    47   195
early stop counter: 2
val acc:0.8565493226051331, best validation acc: 0.86661696434021, corresponding to test acc:                         0.833306610584259 / 0.833306610584259
after epoch: 20,now: 2024-08-01 12:48:45.626198,epoch time: 0:17:24.131377,used: 6:14:32.408098,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_06_34_13_seed_2_23857238
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:14:32.408098 at 2024-08-01 12:48:45.626198
persisted model performance metric: 

scalar performance:
{'acc': 0.8333066, 'precision': 0.5766567, 'recall': 0.81613564, 'specificity': 0.81613564, 'f1': 0.5882933, 'auroc': 0.8948792, 'binary_precision': 0.16300675, 'binary_recall': 0.79752064, 'binary_specificity': 0.8347507, 'binary_f1_score': 0.27068722}
confusion matrix:
      0    1
0  5006  991
1    49  193
oracle model performance metric: 

scalar performance:
{'acc': 0.8333066, 'precision': 0.5766567, 'recall': 0.81613564, 'specificity': 0.81613564, 'f1': 0.5882933, 'auroc': 0.8948792, 'binary_precision': 0.16300675, 'binary_recall': 0.79752064, 'binary_specificity': 0.8347507, 'binary_f1_score': 0.27068722}
confusion matrix:
      0    1
0  5006  991
1    49  193
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_12-46-56/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190965 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190965 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189282 KiB | 457564 KiB |   1040 TiB |   1040 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1018 TiB |   1018 TiB |
|       from small pool |  16468 KiB |  37503 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1074 MiB | 573440 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     66 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40458 KiB |  87761 KiB | 584882 GiB | 584882 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 562792 GiB | 562792 GiB |
|       from small pool |   9152 KiB |  21236 KiB |  22089 GiB |  22089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7771    |  246075 K  |  246072 K  |
|       from large pool |      76    |     158    |  102831 K  |  102831 K  |
|       from small pool |    2878    |    7693    |  143243 K  |  143240 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7771    |  246075 K  |  246072 K  |
|       from large pool |      76    |     158    |  102831 K  |  102831 K  |
|       from small pool |    2878    |    7693    |  143243 K  |  143240 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      78    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3665    |  130231 K  |  130231 K  |
|       from large pool |      10    |      23    |   61654 K  |   61654 K  |
|       from small pool |      21    |    3655    |   68577 K  |   68577 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461507 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  38507 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1018 TiB |   1018 TiB |
|       from small pool |      0 KiB |  37503 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |   1074 MiB |    848 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  26624 KiB |  43008 KiB |     66 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87761 KiB | 584882 GiB | 584882 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 562793 GiB | 562792 GiB |
|       from small pool |      0 KiB |  21236 KiB |  22089 GiB |  22089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7771    |  246075 K  |  246075 K  |
|       from large pool |       2    |     158    |  102831 K  |  102831 K  |
|       from small pool |       0    |    7693    |  143243 K  |  143243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7771    |  246075 K  |  246075 K  |
|       from large pool |       2    |     158    |  102831 K  |  102831 K  |
|       from small pool |       0    |    7693    |  143243 K  |  143243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      78    |      55    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      13    |      21    |      33    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3665    |  130232 K  |  130232 K  |
|       from large pool |       3    |      23    |   61654 K  |   61654 K  |
|       from small pool |       0    |    3655    |   68578 K  |   68578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 12:50:10 2024]
Finished job 0.
1 of 1 steps (100%) done
