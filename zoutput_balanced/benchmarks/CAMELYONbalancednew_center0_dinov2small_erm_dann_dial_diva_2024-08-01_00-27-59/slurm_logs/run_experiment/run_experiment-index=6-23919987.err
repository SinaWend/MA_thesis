Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 17:20:07 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987

 Experiment start at: 2024-08-01 17:29:24.937424
before training, model accuracy: 0.9303292036056519
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8904463, 'precision': 0.8930403, 'recall': 0.89047754, 'specificity': 0.89047754, 'f1': 0.89027077, 'auroc': 0.9570608, 'binary_precision': 0.9251631, 'binary_recall': 0.8498014, 'binary_specificity': 0.9311536, 'binary_f1_score': 0.8858824}
confusion matrix:
       0      1
0  26685   1973
1   4311  24391
---- Validation: 
scalar performance:
{'acc': 0.94827586, 'precision': 0.53449726, 'recall': 0.52243847, 'specificity': 0.52243847, 'f1': 0.5264679, 'auroc': 0.74801016, 'binary_precision': 0.10169491, 'binary_recall': 0.065318815, 'binary_specificity': 0.9795581, 'binary_f1_score': 0.079545446}
confusion matrix:
       0    1
0  17778  371
1    601   42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94519013, 'precision': 0.5202806, 'recall': 0.5078219, 'specificity': 0.5078219, 'f1': 0.50817704, 'auroc': 0.72676504, 'binary_precision': 0.08163265, 'binary_recall': 0.03065134, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.044568244}
confusion matrix:
      0   1
0  5907  90
1   253   8
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 17:49:34.603867,epoch time: 0:20:09.666443,used: 0:20:09.666443,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9239888, 'precision': 0.92705166, 'recall': 0.92402136, 'specificity': 0.92402136, 'f1': 0.92385626, 'auroc': 0.9769604, 'binary_precision': 0.96341, 'binary_recall': 0.8815762, 'binary_specificity': 0.9664666, 'binary_f1_score': 0.92067826}
confusion matrix:
       0      1
0  27697    961
1   3399  25303
---- Validation: 
scalar performance:
{'acc': 0.95210725, 'precision': 0.6126956, 'recall': 0.591927, 'specificity': 0.591927, 'f1': 0.6010462, 'auroc': 0.8105577, 'binary_precision': 0.25335893, 'binary_recall': 0.20528771, 'binary_specificity': 0.9785663, 'binary_f1_score': 0.22680412}
confusion matrix:
       0    1
0  17760  389
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541387, 'precision': 0.67422915, 'recall': 0.5766226, 'specificity': 0.5766226, 'f1': 0.603464, 'auroc': 0.8418565, 'binary_precision': 0.38392857, 'binary_recall': 0.16475096, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.230563}
confusion matrix:
      0   1
0  5928  69
1   218  43
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 18:09:43.017845,epoch time: 0:20:08.413978,used: 0:40:18.080421,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9391039, 'precision': 0.94074976, 'recall': 0.9391296, 'specificity': 0.9391296, 'f1': 0.9390494, 'auroc': 0.983745, 'binary_precision': 0.9678928, 'binary_recall': 0.9084448, 'binary_specificity': 0.96981436, 'binary_f1_score': 0.9372271}
confusion matrix:
       0      1
0  27791    865
1   2628  26076
---- Validation: 
scalar performance:
{'acc': 0.95306516, 'precision': 0.6310805, 'recall': 0.6156746, 'specificity': 0.6156746, 'f1': 0.62281036, 'auroc': 0.8295026, 'binary_precision': 0.28849557, 'binary_recall': 0.2534992, 'binary_specificity': 0.97785, 'binary_f1_score': 0.26986754}
confusion matrix:
       0    1
0  17747  402
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7480681, 'recall': 0.65275073, 'specificity': 0.65275073, 'f1': 0.6876335, 'auroc': 0.8814771, 'binary_precision': 0.5253165, 'binary_recall': 0.31800765, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.39618137}
confusion matrix:
      0   1
0  5922  75
1   178  83
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 18:29:39.926461,epoch time: 0:19:56.908616,used: 1:00:14.989037,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94625175, 'precision': 0.94769573, 'recall': 0.94627464, 'specificity': 0.94627464, 'f1': 0.94621027, 'auroc': 0.9869647, 'binary_precision': 0.9733225, 'binary_recall': 0.9177438, 'binary_specificity': 0.9748055, 'binary_f1_score': 0.94471645}
confusion matrix:
       0      1
0  27935    722
1   2361  26342
---- Validation: 
scalar performance:
{'acc': 0.9513091, 'precision': 0.637881, 'recall': 0.6455177, 'specificity': 0.6455177, 'f1': 0.64157814, 'auroc': 0.8383297, 'binary_precision': 0.3, 'binary_recall': 0.31726283, 'binary_specificity': 0.97377264, 'binary_f1_score': 0.30839002}
confusion matrix:
       0    1
0  17673  476
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.7670303, 'recall': 0.7256291, 'specificity': 0.7256291, 'f1': 0.7443627, 'auroc': 0.89945674, 'binary_precision': 0.55707765, 'binary_recall': 0.46743295, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.5083333}
confusion matrix:
      0    1
0  5900   97
1   139  122
new oracle model saved
early stop counter: 1
val acc:0.951309084892273, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 4,now: 2024-08-01 18:48:55.852513,epoch time: 0:19:15.926052,used: 1:19:30.915089,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9517608, 'precision': 0.9525213, 'recall': 0.95177877, 'specificity': 0.95177877, 'f1': 0.9517418, 'auroc': 0.9890326, 'binary_precision': 0.97129154, 'binary_recall': 0.93112695, 'binary_specificity': 0.97243065, 'binary_f1_score': 0.9507853}
confusion matrix:
       0      1
0  27865    790
1   1977  26728
---- Validation: 
scalar performance:
{'acc': 0.9477437, 'precision': 0.6372342, 'recall': 0.6759243, 'specificity': 0.6759243, 'f1': 0.65374607, 'auroc': 0.84423983, 'binary_precision': 0.2965186, 'binary_recall': 0.38413686, 'binary_specificity': 0.96771175, 'binary_f1_score': 0.33468834}
confusion matrix:
       0    1
0  17563  586
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7438973, 'recall': 0.7696866, 'specificity': 0.7696866, 'f1': 0.75604796, 'auroc': 0.90649176, 'binary_precision': 0.50689656, 'binary_recall': 0.5632184, 'binary_specificity': 0.97615474, 'binary_f1_score': 0.5335753}
confusion matrix:
      0    1
0  5854  143
1   114  147
early stop counter: 2
val acc:0.9477437138557434, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 5,now: 2024-08-01 19:08:23.554409,epoch time: 0:19:27.701896,used: 1:38:58.616985,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95460254, 'precision': 0.955272, 'recall': 0.95461464, 'specificity': 0.95461464, 'f1': 0.9545866, 'auroc': 0.99041986, 'binary_precision': 0.9728887, 'binary_recall': 0.9353265, 'binary_specificity': 0.9739027, 'binary_f1_score': 0.9537379}
confusion matrix:
       0      1
0  27914    748
1   1856  26842
---- Validation: 
scalar performance:
{'acc': 0.94375265, 'precision': 0.6335509, 'recall': 0.6986099, 'specificity': 0.6986099, 'f1': 0.65846616, 'auroc': 0.8487575, 'binary_precision': 0.28747433, 'binary_recall': 0.43545878, 'binary_specificity': 0.961761, 'binary_f1_score': 0.34632036}
confusion matrix:
       0    1
0  17455  694
1    363  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.7245186, 'recall': 0.78942347, 'specificity': 0.78942347, 'f1': 0.75220084, 'auroc': 0.9082453, 'binary_precision': 0.46627566, 'binary_recall': 0.6091954, 'binary_specificity': 0.9696515, 'binary_f1_score': 0.52823925}
confusion matrix:
      0    1
0  5815  182
1   102  159
early stop counter: 3
val acc:0.943752646446228, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 6,now: 2024-08-01 19:27:17.778535,epoch time: 0:18:54.224126,used: 1:57:52.841111,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9598501, 'precision': 0.9604223, 'recall': 0.95986617, 'specificity': 0.95986617, 'f1': 0.9598385, 'auroc': 0.9922836, 'binary_precision': 0.97688115, 'binary_recall': 0.94206786, 'binary_specificity': 0.97766453, 'binary_f1_score': 0.9591587}
confusion matrix:
       0      1
0  28014    640
1   1663  27043
---- Validation: 
scalar performance:
{'acc': 0.9450298, 'precision': 0.63646287, 'recall': 0.6970209, 'specificity': 0.6970209, 'f1': 0.66019475, 'auroc': 0.8526577, 'binary_precision': 0.2934322, 'binary_recall': 0.43079317, 'binary_specificity': 0.96324867, 'binary_f1_score': 0.3490863}
confusion matrix:
       0    1
0  17482  667
1    366  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7472826, 'recall': 0.80108637, 'specificity': 0.80108637, 'f1': 0.7711451, 'auroc': 0.9110935, 'binary_precision': 0.5109034, 'binary_recall': 0.62835246, 'binary_specificity': 0.97382027, 'binary_f1_score': 0.5635739}
confusion matrix:
      0    1
0  5840  157
1    97  164
early stop counter: 4
val acc:0.9450297951698303, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 7,now: 2024-08-01 19:46:58.060176,epoch time: 0:19:40.281641,used: 2:17:33.122752,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9615586, 'precision': 0.9617237, 'recall': 0.96156627, 'specificity': 0.96156627, 'f1': 0.9615556, 'auroc': 0.99267673, 'binary_precision': 0.97065717, 'binary_recall': 0.9519562, 'binary_specificity': 0.9711763, 'binary_f1_score': 0.9612158}
confusion matrix:
       0      1
0  27831    826
1   1379  27324
---- Validation: 
scalar performance:
{'acc': 0.9390698, 'precision': 0.62962425, 'recall': 0.7216874, 'specificity': 0.7216874, 'f1': 0.6611142, 'auroc': 0.8545002, 'binary_precision': 0.2778761, 'binary_recall': 0.48833594, 'binary_specificity': 0.95503885, 'binary_f1_score': 0.3542019}
confusion matrix:
       0    1
0  17333  816
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.7309149, 'recall': 0.8246547, 'specificity': 0.8246547, 'f1': 0.7685735, 'auroc': 0.915321, 'binary_precision': 0.47593582, 'binary_recall': 0.68199235, 'binary_specificity': 0.967317, 'binary_f1_score': 0.56062984}
confusion matrix:
      0    1
0  5801  196
1    83  178
early stop counter: 5
val acc:0.9390698075294495, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 8,now: 2024-08-01 20:06:09.079039,epoch time: 0:19:11.018863,used: 2:36:44.141615,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9631276, 'precision': 0.9634469, 'recall': 0.9631378, 'specificity': 0.9631378, 'f1': 0.96312183, 'auroc': 0.9932357, 'binary_precision': 0.97580445, 'binary_recall': 0.94986415, 'binary_specificity': 0.97641146, 'binary_f1_score': 0.9626596}
confusion matrix:
       0      1
0  27982    676
1   1439  27263
---- Validation: 
scalar performance:
{'acc': 0.942848, 'precision': 0.63325775, 'recall': 0.70489204, 'specificity': 0.70489204, 'f1': 0.65999454, 'auroc': 0.852556, 'binary_precision': 0.2864222, 'binary_recall': 0.44945568, 'binary_specificity': 0.9603284, 'binary_f1_score': 0.34987894}
confusion matrix:
       0    1
0  17429  720
1    354  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7495084, 'recall': 0.8287381, 'specificity': 0.8287381, 'f1': 0.78285974, 'auroc': 0.91582465, 'binary_precision': 0.512894, 'binary_recall': 0.68582374, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.5868853}
confusion matrix:
      0    1
0  5827  170
1    82  179
early stop counter: 6
val acc:0.9428480267524719, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 9,now: 2024-08-01 20:25:01.284913,epoch time: 0:18:52.205874,used: 2:55:36.347489,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9651151, 'precision': 0.9653165, 'recall': 0.9651232, 'specificity': 0.9651232, 'f1': 0.9651117, 'auroc': 0.99349296, 'binary_precision': 0.9751913, 'binary_recall': 0.9545676, 'binary_specificity': 0.9756787, 'binary_f1_score': 0.96476924}
confusion matrix:
       0      1
0  27961    697
1   1304  27398
---- Validation: 
scalar performance:
{'acc': 0.94242233, 'precision': 0.6318871, 'recall': 0.70392156, 'specificity': 0.70392156, 'f1': 0.65864456, 'auroc': 0.856534, 'binary_precision': 0.28374383, 'binary_recall': 0.44790047, 'binary_specificity': 0.9599427, 'binary_f1_score': 0.3474065}
confusion matrix:
       0    1
0  17422  727
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9538191, 'precision': 0.7247058, 'recall': 0.82382095, 'specificity': 0.82382095, 'f1': 0.76379645, 'auroc': 0.9157293, 'binary_precision': 0.46354166, 'binary_recall': 0.68199235, 'binary_specificity': 0.9656495, 'binary_f1_score': 0.55193794}
confusion matrix:
      0    1
0  5791  206
1    83  178
early stop counter: 7
val acc:0.9424223303794861, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 10,now: 2024-08-01 20:43:52.384106,epoch time: 0:18:51.099193,used: 3:14:27.446682,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96708506, 'precision': 0.967481, 'recall': 0.9670954, 'specificity': 0.9670954, 'f1': 0.9670786, 'auroc': 0.9943857, 'binary_precision': 0.9812608, 'binary_recall': 0.9524042, 'binary_specificity': 0.9817865, 'binary_f1_score': 0.96661717}
confusion matrix:
       0      1
0  28138    522
1   1366  27334
---- Validation: 
scalar performance:
{'acc': 0.94242233, 'precision': 0.62944394, 'recall': 0.696421, 'specificity': 0.696421, 'f1': 0.6546688, 'auroc': 0.85024416, 'binary_precision': 0.27939698, 'binary_recall': 0.43234837, 'binary_specificity': 0.9604937, 'binary_f1_score': 0.33943832}
confusion matrix:
       0    1
0  17432  717
1    365  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.72250015, 'recall': 0.82531977, 'specificity': 0.82531977, 'f1': 0.76261437, 'auroc': 0.91299415, 'binary_precision': 0.45897436, 'binary_recall': 0.68582374, 'binary_specificity': 0.96481574, 'binary_f1_score': 0.54992324}
confusion matrix:
      0    1
0  5786  211
1    82  179
early stop counter: 8
val acc:0.9424223303794861, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 11,now: 2024-08-01 21:03:14.949461,epoch time: 0:19:22.565355,used: 3:33:50.012037,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9670328, 'precision': 0.96742296, 'recall': 0.967044, 'specificity': 0.967044, 'f1': 0.9670265, 'auroc': 0.99446225, 'binary_precision': 0.9811219, 'binary_recall': 0.95244235, 'binary_specificity': 0.9816456, 'binary_f1_score': 0.9665695}
confusion matrix:
       0      1
0  28132    526
1   1365  27337
---- Validation: 
scalar performance:
{'acc': 0.94109195, 'precision': 0.6315352, 'recall': 0.71298355, 'specificity': 0.71298355, 'f1': 0.6606978, 'auroc': 0.8528985, 'binary_precision': 0.28236398, 'binary_recall': 0.4681182, 'binary_specificity': 0.9578489, 'binary_f1_score': 0.35225278}
confusion matrix:
       0    1
0  17384  765
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95270056, 'precision': 0.7211349, 'recall': 0.8287343, 'specificity': 0.8287343, 'f1': 0.76259494, 'auroc': 0.9146297, 'binary_precision': 0.45591938, 'binary_recall': 0.6934866, 'binary_specificity': 0.963982, 'binary_f1_score': 0.55015194}
confusion matrix:
      0    1
0  5781  216
1    80  181
early stop counter: 9
val acc:0.9410919547080994, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 12,now: 2024-08-01 21:22:38.353848,epoch time: 0:19:23.404387,used: 3:53:13.416424,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96753836, 'precision': 0.9682231, 'recall': 0.9675545, 'specificity': 0.9675545, 'f1': 0.9675273, 'auroc': 0.99497557, 'binary_precision': 0.9863386, 'binary_recall': 0.9482651, 'binary_specificity': 0.98684394, 'binary_f1_score': 0.96692723}
confusion matrix:
       0      1
0  28279    377
1   1485  27219
---- Validation: 
scalar performance:
{'acc': 0.94497657, 'precision': 0.63506645, 'recall': 0.6932431, 'specificity': 0.6932431, 'f1': 0.6580114, 'auroc': 0.8516419, 'binary_precision': 0.29090908, 'binary_recall': 0.4230171, 'binary_specificity': 0.9634691, 'binary_f1_score': 0.34474018}
confusion matrix:
       0    1
0  17486  663
1    371  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.7324763, 'recall': 0.8284861, 'specificity': 0.8284861, 'f1': 0.7709154, 'auroc': 0.91325426, 'binary_precision': 0.4787234, 'binary_recall': 0.6896552, 'binary_specificity': 0.967317, 'binary_f1_score': 0.5651492}
confusion matrix:
      0    1
0  5801  196
1    81  180
early stop counter: 10
val acc:0.9449765682220459, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 13,now: 2024-08-01 21:41:33.503998,epoch time: 0:18:55.150150,used: 4:12:08.566574,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96983963, 'precision': 0.9700366, 'recall': 0.9698479, 'specificity': 0.9698479, 'f1': 0.96983683, 'auroc': 0.9954343, 'binary_precision': 0.97986126, 'binary_recall': 0.9594467, 'binary_specificity': 0.98024917, 'binary_f1_score': 0.96954656}
confusion matrix:
       0      1
0  28091    566
1   1164  27539
---- Validation: 
scalar performance:
{'acc': 0.93257767, 'precision': 0.6182546, 'recall': 0.72582686, 'specificity': 0.72582686, 'f1': 0.6514301, 'auroc': 0.8590477, 'binary_precision': 0.254717, 'binary_recall': 0.503888, 'binary_specificity': 0.9477657, 'binary_f1_score': 0.33838123}
confusion matrix:
       0    1
0  17201  948
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93720037, 'precision': 0.6780066, 'recall': 0.8298086, 'specificity': 0.8298086, 'f1': 0.7264153, 'auroc': 0.9111631, 'binary_precision': 0.3690476, 'binary_recall': 0.7126437, 'binary_specificity': 0.9469735, 'binary_f1_score': 0.4862745}
confusion matrix:
      0    1
0  5679  318
1    75  186
early stop counter: 11
val acc:0.9325776696205139, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 14,now: 2024-08-01 22:00:23.951387,epoch time: 0:18:50.447389,used: 4:30:59.013963,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9716353, 'precision': 0.9717617, 'recall': 0.97164106, 'specificity': 0.97164106, 'f1': 0.9716337, 'auroc': 0.9957377, 'binary_precision': 0.9796605, 'binary_recall': 0.9633101, 'binary_specificity': 0.97997206, 'binary_f1_score': 0.97141653}
confusion matrix:
       0      1
0  28086    574
1   1053  27647
---- Validation: 
scalar performance:
{'acc': 0.92363775, 'precision': 0.6106575, 'recall': 0.7474505, 'specificity': 0.7474505, 'f1': 0.64649343, 'auroc': 0.8662455, 'binary_precision': 0.23774834, 'binary_recall': 0.55832034, 'binary_specificity': 0.93658054, 'binary_f1_score': 0.33348817}
confusion matrix:
       0     1
0  16998  1151
1    284   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92761266, 'precision': 0.6590782, 'recall': 0.8284707, 'specificity': 0.8284707, 'f1': 0.7073987, 'auroc': 0.9138777, 'binary_precision': 0.3309859, 'binary_recall': 0.7203065, 'binary_specificity': 0.93663496, 'binary_f1_score': 0.4535585}
confusion matrix:
      0    1
0  5617  380
1    73  188
early stop counter: 12
val acc:0.9236377477645874, best validation acc: 0.9530651569366455, corresponding to test acc:                         0.9595717191696167 / 0.9622882604598999
after epoch: 15,now: 2024-08-01 22:19:14.887953,epoch time: 0:18:50.936566,used: 4:49:49.950529,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_17_29_23_seed_0_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:49:49.950529 at 2024-08-01 22:19:14.887953
persisted model performance metric: 

scalar performance:
{'acc': 0.9595717, 'precision': 0.7480681, 'recall': 0.65275073, 'specificity': 0.65275073, 'f1': 0.6876335, 'auroc': 0.8814771, 'binary_precision': 0.5253165, 'binary_recall': 0.31800765, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.39618137}
confusion matrix:
      0   1
0  5922  75
1   178  83
oracle model performance metric: 

scalar performance:
{'acc': 0.96228826, 'precision': 0.7670303, 'recall': 0.7256291, 'specificity': 0.7256291, 'f1': 0.7443627, 'auroc': 0.89945674, 'binary_precision': 0.55707765, 'binary_recall': 0.46743295, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.5083333}
confusion matrix:
      0    1
0  5900   97
1   139  122
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    968 MiB |   8604 MiB | 359936 GiB | 359935 GiB |
|       from large pool |    930 MiB |   8559 MiB | 354167 GiB | 354166 GiB |
|       from small pool |     38 MiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    968 MiB |   8604 MiB | 359936 GiB | 359935 GiB |
|       from large pool |    930 MiB |   8559 MiB | 354167 GiB | 354166 GiB |
|       from small pool |     38 MiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    967 MiB |   8603 MiB | 359915 GiB | 359914 GiB |
|       from large pool |    929 MiB |   8559 MiB | 354158 GiB | 354158 GiB |
|       from small pool |     37 MiB |     79 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9626 MiB |   9626 MiB |   9626 MiB |      0 B   |
|       from large pool |   9540 MiB |   9540 MiB |   9540 MiB |      0 B   |
|       from small pool |     86 MiB |     86 MiB |     86 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  89116 KiB |    824 MiB | 187787 GiB | 187787 GiB |
|       from large pool |  65366 KiB |    822 MiB | 182011 GiB | 182011 GiB |
|       from small pool |  23750 KiB |     24 MiB |   5776 GiB |   5776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3472    |    8159    |   71315 K  |   71311 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37869 K  |   37866 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3472    |    8159    |   71315 K  |   71311 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37869 K  |   37866 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     404    |     404    |       0    |
|       from large pool |     361    |     361    |     361    |       0    |
|       from small pool |      43    |      43    |      43    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    3621    |   38531 K  |   38530 K  |
|       from large pool |      23    |     359    |   22212 K  |   22212 K  |
|       from small pool |      55    |    3599    |   16318 K  |   16318 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8604 MiB | 359936 GiB | 359936 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 354167 GiB | 354167 GiB |
|       from small pool |      0 KiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8604 MiB | 359936 GiB | 359936 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 354167 GiB | 354167 GiB |
|       from small pool |      0 KiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB | 359915 GiB | 359915 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 354158 GiB | 354158 GiB |
|       from small pool |      0 KiB |     79 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1056 MiB |   9626 MiB |   9626 MiB |   8570 MiB |
|       from large pool |    994 MiB |   9540 MiB |   9540 MiB |   8546 MiB |
|       from small pool |     62 MiB |     86 MiB |     86 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    824 MiB | 187787 GiB | 187787 GiB |
|       from large pool |  30464 KiB |    822 MiB | 182011 GiB | 182011 GiB |
|       from small pool |      0 KiB |     38 MiB |   5776 GiB |   5776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71315 K  |   71315 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37869 K  |   37869 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71315 K  |   71315 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37869 K  |   37869 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     404    |     404    |     346    |
|       from large pool |      27    |     361    |     361    |     334    |
|       from small pool |      31    |      43    |      43    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3621    |   38532 K  |   38532 K  |
|       from large pool |       2    |     359    |   22212 K  |   22212 K  |
|       from small pool |       0    |    3599    |   16319 K  |   16319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8604 MiB | 359936 GiB | 359936 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 354167 GiB | 354167 GiB |
|       from small pool |      0 KiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8604 MiB | 359936 GiB | 359936 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 354167 GiB | 354167 GiB |
|       from small pool |      0 KiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB | 359915 GiB | 359915 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 354158 GiB | 354158 GiB |
|       from small pool |      0 KiB |     79 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1056 MiB |   9626 MiB |   9626 MiB |   8570 MiB |
|       from large pool |    994 MiB |   9540 MiB |   9540 MiB |   8546 MiB |
|       from small pool |     62 MiB |     86 MiB |     86 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    824 MiB | 187787 GiB | 187787 GiB |
|       from large pool |  30464 KiB |    822 MiB | 182011 GiB | 182011 GiB |
|       from small pool |      0 KiB |     38 MiB |   5776 GiB |   5776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71315 K  |   71315 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37869 K  |   37869 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71315 K  |   71315 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37869 K  |   37869 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     404    |     404    |     346    |
|       from large pool |      27    |     361    |     361    |     334    |
|       from small pool |      31    |      43    |      43    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3621    |   38532 K  |   38532 K  |
|       from large pool |       2    |     359    |   22212 K  |   22212 K  |
|       from small pool |       0    |    3599    |   16319 K  |   16319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987

 Experiment start at: 2024-08-01 22:27:40.513428
before training, model accuracy: 0.3665807247161865
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89110667, 'precision': 0.8950391, 'recall': 0.891143, 'specificity': 0.891143, 'f1': 0.8908414, 'auroc': 0.9582614, 'binary_precision': 0.934636, 'binary_recall': 0.84120154, 'binary_specificity': 0.9410845, 'binary_f1_score': 0.8854608}
confusion matrix:
       0      1
0  27091   1696
1   4578  24251
---- Validation: 
scalar performance:
{'acc': 0.9026147, 'precision': 0.5862956, 'recall': 0.7234691, 'specificity': 0.7234691, 'f1': 0.6144911, 'auroc': 0.8244764, 'binary_precision': 0.19131833, 'binary_recall': 0.5304606, 'binary_specificity': 0.91647756, 'binary_f1_score': 0.28121307}
confusion matrix:
       0     1
0  16558  1509
1    316   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91218174, 'precision': 0.6413328, 'recall': 0.8475096, 'specificity': 0.8475096, 'f1': 0.68908346, 'auroc': 0.9172618, 'binary_precision': 0.29317853, 'binary_recall': 0.77692306, 'binary_specificity': 0.9180962, 'binary_f1_score': 0.42571124}
confusion matrix:
      0    1
0  5459  487
1    58  202
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 22:47:26.696020,epoch time: 0:19:46.182592,used: 0:19:46.182592,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9264267, 'precision': 0.9282783, 'recall': 0.9264507, 'specificity': 0.9264507, 'f1': 0.9263498, 'auroc': 0.97671413, 'binary_precision': 0.9566218, 'binary_recall': 0.8934753, 'binary_specificity': 0.9594261, 'binary_f1_score': 0.9239709}
confusion matrix:
       0      1
0  27619   1168
1   3071  25758
---- Validation: 
scalar performance:
{'acc': 0.9003202, 'precision': 0.59299034, 'recall': 0.7566119, 'specificity': 0.7566119, 'f1': 0.6243948, 'auroc': 0.8390206, 'binary_precision': 0.20199502, 'binary_recall': 0.60178304, 'binary_specificity': 0.91144073, 'binary_f1_score': 0.30246454}
confusion matrix:
       0     1
0  16467  1600
1    268   405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90041894, 'precision': 0.6303557, 'recall': 0.8560829, 'specificity': 0.8560829, 'f1': 0.6751449, 'auroc': 0.92711675, 'binary_precision': 0.26992288, 'binary_recall': 0.8076923, 'binary_specificity': 0.9044736, 'binary_f1_score': 0.40462428}
confusion matrix:
      0    1
0  5378  568
1    50  210
early stop counter: 1
val acc:0.9003201723098755, best validation acc: 0.9026147127151489, corresponding to test acc:                         0.9121817350387573 / 0.9121817350387573
after epoch: 2,now: 2024-08-01 23:06:50.805703,epoch time: 0:19:24.109683,used: 0:39:10.292275,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9403985, 'precision': 0.94121766, 'recall': 0.94041353, 'specificity': 0.94041353, 'f1': 0.9403722, 'auroc': 0.9829796, 'binary_precision': 0.9604032, 'binary_recall': 0.9187595, 'binary_specificity': 0.96206754, 'binary_f1_score': 0.93911994}
confusion matrix:
       0      1
0  27696   1092
1   2342  26486
---- Validation: 
scalar performance:
{'acc': 0.9076841, 'precision': 0.6044128, 'recall': 0.7761669, 'specificity': 0.7761669, 'f1': 0.6404598, 'auroc': 0.8524158, 'binary_precision': 0.22344323, 'binary_recall': 0.6344725, 'binary_specificity': 0.9178613, 'binary_f1_score': 0.33049536}
confusion matrix:
       0     1
0  16583  1484
1    246   427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90638095, 'precision': 0.6375072, 'recall': 0.86103326, 'specificity': 0.86103326, 'f1': 0.68490654, 'auroc': 0.92923427, 'binary_precision': 0.28398386, 'binary_recall': 0.81153846, 'binary_specificity': 0.91052806, 'binary_f1_score': 0.4207378}
confusion matrix:
      0    1
0  5414  532
1    49  211
better model found
persisted
after epoch: 3,now: 2024-08-01 23:26:05.817234,epoch time: 0:19:15.011531,used: 0:58:25.303806,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.943783, 'precision': 0.9453895, 'recall': 0.9438039, 'specificity': 0.9438039, 'f1': 0.94373405, 'auroc': 0.98585594, 'binary_precision': 0.97231346, 'binary_recall': 0.91366035, 'binary_specificity': 0.97394747, 'binary_f1_score': 0.94207484}
confusion matrix:
       0      1
0  28038    750
1   2489  26339
---- Validation: 
scalar performance:
{'acc': 0.9135539, 'precision': 0.6098765, 'recall': 0.773489, 'specificity': 0.773489, 'f1': 0.64733547, 'auroc': 0.85437083, 'binary_precision': 0.2347339, 'binary_recall': 0.6225854, 'binary_specificity': 0.9243925, 'binary_f1_score': 0.3409276}
confusion matrix:
       0     1
0  16701  1366
1    254   419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9165324, 'precision': 0.65108055, 'recall': 0.8681699, 'specificity': 0.8681699, 'f1': 0.70247245, 'auroc': 0.9299121, 'binary_precision': 0.31085044, 'binary_recall': 0.8153846, 'binary_specificity': 0.92095524, 'binary_f1_score': 0.45010617}
confusion matrix:
      0    1
0  5476  470
1    48  212
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 23:45:22.272508,epoch time: 0:19:16.455274,used: 1:17:41.759080,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9506734, 'precision': 0.9513274, 'recall': 0.9506874, 'specificity': 0.9506874, 'f1': 0.95065665, 'auroc': 0.98827803, 'binary_precision': 0.9686903, 'binary_recall': 0.93152726, 'binary_specificity': 0.9698475, 'binary_f1_score': 0.94974536}
confusion matrix:
       0      1
0  27919    868
1   1974  26855
---- Validation: 
scalar performance:
{'acc': 0.9171825, 'precision': 0.6154383, 'recall': 0.77894723, 'specificity': 0.77894723, 'f1': 0.6545458, 'auroc': 0.860058, 'binary_precision': 0.24551246, 'binary_recall': 0.63001484, 'binary_specificity': 0.9278796, 'binary_f1_score': 0.35333335}
confusion matrix:
       0     1
0  16764  1303
1    249   424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92523366, 'precision': 0.6641396, 'recall': 0.8708718, 'specificity': 0.8708718, 'f1': 0.71802056, 'auroc': 0.92990696, 'binary_precision': 0.3370607, 'binary_recall': 0.81153846, 'binary_specificity': 0.93020517, 'binary_f1_score': 0.47629797}
confusion matrix:
      0    1
0  5531  415
1    49  211
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-02 00:04:25.844054,epoch time: 0:19:03.571546,used: 1:36:45.330626,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9552555, 'precision': 0.95582795, 'recall': 0.9552679, 'specificity': 0.9552679, 'f1': 0.9552423, 'auroc': 0.99004257, 'binary_precision': 0.9721563, 'binary_recall': 0.937422, 'binary_specificity': 0.9731138, 'binary_f1_score': 0.9544732}
confusion matrix:
       0      1
0  28014    774
1   1804  27024
---- Validation: 
scalar performance:
{'acc': 0.92411953, 'precision': 0.62335813, 'recall': 0.7739617, 'specificity': 0.7739617, 'f1': 0.66325784, 'auroc': 0.8636596, 'binary_precision': 0.2619199, 'binary_recall': 0.6121842, 'binary_specificity': 0.9357392, 'binary_f1_score': 0.36687443}
confusion matrix:
       0     1
0  16906  1161
1    261   412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9334515, 'precision': 0.6775145, 'recall': 0.8659655, 'specificity': 0.8659655, 'f1': 0.73187524, 'auroc': 0.92931056, 'binary_precision': 0.36460176, 'binary_recall': 0.7923077, 'binary_specificity': 0.9396233, 'binary_f1_score': 0.4993939}
confusion matrix:
      0    1
0  5587  359
1    54  206
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-02 00:23:53.985809,epoch time: 0:19:28.141755,used: 1:56:13.472381,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95955986, 'precision': 0.9597539, 'recall': 0.9595678, 'specificity': 0.9595678, 'f1': 0.959556, 'auroc': 0.99172056, 'binary_precision': 0.9693921, 'binary_recall': 0.9491502, 'binary_specificity': 0.9699854, 'binary_f1_score': 0.9591643}
confusion matrix:
       0      1
0  27922    864
1   1466  27364
---- Validation: 
scalar performance:
{'acc': 0.9054429, 'precision': 0.605896, 'recall': 0.7914557, 'specificity': 0.7914557, 'f1': 0.64295924, 'auroc': 0.8678842, 'binary_precision': 0.22511256, 'binary_recall': 0.6686478, 'binary_specificity': 0.91426355, 'binary_f1_score': 0.33682635}
confusion matrix:
       0     1
0  16518  1549
1    223   450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.910087, 'precision': 0.6435575, 'recall': 0.8703233, 'specificity': 0.8703233, 'f1': 0.6931891, 'auroc': 0.9288752, 'binary_precision': 0.29532966, 'binary_recall': 0.8269231, 'binary_specificity': 0.9137235, 'binary_f1_score': 0.43522266}
confusion matrix:
      0    1
0  5433  513
1    45  215
early stop counter: 1
val acc:0.9054428935050964, best validation acc: 0.9241195321083069, corresponding to test acc:                         0.9334514737129211 / 0.9334514737129211
after epoch: 7,now: 2024-08-02 00:43:16.767130,epoch time: 0:19:22.781321,used: 2:15:36.253702,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95843166, 'precision': 0.95954484, 'recall': 0.9584489, 'specificity': 0.9584489, 'f1': 0.95840764, 'auroc': 0.9922612, 'binary_precision': 0.9823364, 'binary_recall': 0.9337103, 'binary_specificity': 0.98318744, 'binary_f1_score': 0.95740634}
confusion matrix:
       0      1
0  28304    484
1   1911  26917
---- Validation: 
scalar performance:
{'acc': 0.9261473, 'precision': 0.6294334, 'recall': 0.78645766, 'specificity': 0.78645766, 'f1': 0.67143464, 'auroc': 0.8664111, 'binary_precision': 0.27313337, 'binary_recall': 0.6359584, 'binary_specificity': 0.9369569, 'binary_f1_score': 0.38214284}
confusion matrix:
       0     1
0  16928  1139
1    245   428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93457943, 'precision': 0.67980736, 'recall': 0.86655414, 'specificity': 0.86655414, 'f1': 0.7343247, 'auroc': 0.9254974, 'binary_precision': 0.3691756, 'binary_recall': 0.7923077, 'binary_specificity': 0.94080055, 'binary_f1_score': 0.5036675}
confusion matrix:
      0    1
0  5594  352
1    54  206
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-02 01:02:18.724135,epoch time: 0:19:01.957005,used: 2:34:38.210707,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9610872, 'precision': 0.96176386, 'recall': 0.9611006, 'specificity': 0.9611006, 'f1': 0.96107376, 'auroc': 0.9924232, 'binary_precision': 0.9796147, 'binary_recall': 0.9418274, 'binary_specificity': 0.98037374, 'binary_f1_score': 0.96034956}
confusion matrix:
       0      1
0  28223    565
1   1677  27151
---- Validation: 
scalar performance:
{'acc': 0.91862327, 'precision': 0.61914164, 'recall': 0.7868471, 'specificity': 0.7868471, 'f1': 0.6596306, 'auroc': 0.8706882, 'binary_precision': 0.2523256, 'binary_recall': 0.6448737, 'binary_specificity': 0.9288205, 'binary_f1_score': 0.36272463}
confusion matrix:
       0     1
0  16781  1286
1    239   434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9270061, 'precision': 0.6647216, 'recall': 0.8589239, 'specificity': 0.8589239, 'f1': 0.7173251, 'auroc': 0.9233091, 'binary_precision': 0.33943427, 'binary_recall': 0.7846154, 'binary_specificity': 0.9332324, 'binary_f1_score': 0.4738676}
confusion matrix:
      0    1
0  5549  397
1    56  204
early stop counter: 1
val acc:0.9186232686042786, best validation acc: 0.9261472821235657, corresponding to test acc:                         0.9345794320106506 / 0.9345794320106506
after epoch: 9,now: 2024-08-02 01:21:33.598782,epoch time: 0:19:14.874647,used: 2:53:53.085354,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9651312, 'precision': 0.96524507, 'recall': 0.9651373, 'specificity': 0.9651373, 'f1': 0.9651294, 'auroc': 0.9935671, 'binary_precision': 0.9727167, 'binary_recall': 0.9571627, 'binary_specificity': 0.9731119, 'binary_f1_score': 0.96487695}
confusion matrix:
       0      1
0  28012    774
1   1235  27595
---- Validation: 
scalar performance:
{'acc': 0.90192103, 'precision': 0.60276836, 'recall': 0.791775, 'specificity': 0.791775, 'f1': 0.63863075, 'auroc': 0.8718128, 'binary_precision': 0.2187349, 'binary_recall': 0.6731055, 'binary_specificity': 0.91044444, 'binary_f1_score': 0.33017492}
confusion matrix:
       0     1
0  16449  1618
1    220   453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90976477, 'precision': 0.6420309, 'recall': 0.86463815, 'specificity': 0.86463815, 'f1': 0.6909459, 'auroc': 0.92207885, 'binary_precision': 0.29281768, 'binary_recall': 0.8153846, 'binary_specificity': 0.9138917, 'binary_f1_score': 0.43089432}
confusion matrix:
      0    1
0  5434  512
1    48  212
early stop counter: 2
val acc:0.9019210338592529, best validation acc: 0.9261472821235657, corresponding to test acc:                         0.9345794320106506 / 0.9345794320106506
after epoch: 10,now: 2024-08-02 01:40:39.150291,epoch time: 0:19:05.551509,used: 3:12:58.636863,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9646105, 'precision': 0.96496487, 'recall': 0.9646207, 'specificity': 0.9646207, 'f1': 0.9646044, 'auroc': 0.9936755, 'binary_precision': 0.9779832, 'binary_recall': 0.95067465, 'binary_specificity': 0.9785667, 'binary_f1_score': 0.96413565}
confusion matrix:
       0      1
0  28170    617
1   1422  27407
---- Validation: 
scalar performance:
{'acc': 0.9041089, 'precision': 0.6061457, 'recall': 0.79791653, 'specificity': 0.79791653, 'f1': 0.6434579, 'auroc': 0.8775615, 'binary_precision': 0.22504893, 'binary_recall': 0.68350667, 'binary_specificity': 0.91232634, 'binary_f1_score': 0.33860874}
confusion matrix:
       0     1
0  16483  1584
1    213   460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.912504, 'precision': 0.64406276, 'recall': 0.8587117, 'specificity': 0.8587117, 'f1': 0.69318706, 'auroc': 0.92175865, 'binary_precision': 0.29756796, 'binary_recall': 0.8, 'binary_specificity': 0.9174235, 'binary_f1_score': 0.4337852}
confusion matrix:
      0    1
0  5455  491
1    52  208
early stop counter: 3
val acc:0.9041088819503784, best validation acc: 0.9261472821235657, corresponding to test acc:                         0.9345794320106506 / 0.9345794320106506
after epoch: 11,now: 2024-08-02 01:59:56.666956,epoch time: 0:19:17.516665,used: 3:32:16.153528,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96802974, 'precision': 0.968207, 'recall': 0.96803653, 'specificity': 0.96803653, 'f1': 0.968027, 'auroc': 0.9946534, 'binary_precision': 0.9774931, 'binary_recall': 0.95816565, 'binary_specificity': 0.9779075, 'binary_f1_score': 0.9677329}
confusion matrix:
       0      1
0  28152    636
1   1206  27622
---- Validation: 
scalar performance:
{'acc': 0.9146211, 'precision': 0.6152094, 'recall': 0.7904936, 'specificity': 0.7904936, 'f1': 0.65507907, 'auroc': 0.87378204, 'binary_precision': 0.24406405, 'binary_recall': 0.65676075, 'binary_specificity': 0.92422646, 'binary_f1_score': 0.3558776}
confusion matrix:
       0     1
0  16698  1369
1    231   442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9174992, 'precision': 0.6494968, 'recall': 0.8539626, 'specificity': 0.8539626, 'f1': 0.6994628, 'auroc': 0.9182023, 'binary_precision': 0.3090909, 'binary_recall': 0.7846154, 'binary_specificity': 0.9233098, 'binary_f1_score': 0.44347823}
confusion matrix:
      0    1
0  5490  456
1    56  204
early stop counter: 4
val acc:0.914621114730835, best validation acc: 0.9261472821235657, corresponding to test acc:                         0.9345794320106506 / 0.9345794320106506
after epoch: 12,now: 2024-08-02 02:19:18.181473,epoch time: 0:19:21.514517,used: 3:51:37.668045,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9688975, 'precision': 0.96896344, 'recall': 0.96890223, 'specificity': 0.96890223, 'f1': 0.9688967, 'auroc': 0.994866, 'binary_precision': 0.9747173, 'binary_recall': 0.96281654, 'binary_specificity': 0.97498786, 'binary_f1_score': 0.9687304}
confusion matrix:
       0      1
0  28066    720
1   1072  27758
---- Validation: 
scalar performance:
{'acc': 0.89188904, 'precision': 0.5964727, 'recall': 0.79944694, 'specificity': 0.79944694, 'f1': 0.6293406, 'auroc': 0.87941086, 'binary_precision': 0.20522876, 'binary_recall': 0.6998514, 'binary_specificity': 0.8990424, 'binary_f1_score': 0.31738546}
confusion matrix:
       0     1
0  16243  1824
1    202   471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8934902, 'precision': 0.622861, 'recall': 0.85062814, 'specificity': 0.85062814, 'f1': 0.6645353, 'auroc': 0.91935825, 'binary_precision': 0.25518927, 'binary_recall': 0.8038462, 'binary_specificity': 0.89741004, 'binary_f1_score': 0.38739577}
confusion matrix:
      0    1
0  5336  610
1    51  209
early stop counter: 5
val acc:0.8918890357017517, best validation acc: 0.9261472821235657, corresponding to test acc:                         0.9345794320106506 / 0.9345794320106506
after epoch: 13,now: 2024-08-02 02:38:13.930197,epoch time: 0:18:55.748724,used: 4:10:33.416769,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9662073, 'precision': 0.9670555, 'recall': 0.96622217, 'specificity': 0.96622217, 'f1': 0.9661927, 'auroc': 0.9948424, 'binary_precision': 0.9871335, 'binary_recall': 0.94477594, 'binary_specificity': 0.98766845, 'binary_f1_score': 0.9654904}
confusion matrix:
       0      1
0  28433    355
1   1592  27236
---- Validation: 
scalar performance:
{'acc': 0.92550695, 'precision': 0.6261067, 'recall': 0.7768271, 'specificity': 0.7768271, 'f1': 0.6666339, 'auroc': 0.87292963, 'binary_precision': 0.26722473, 'binary_recall': 0.6166419, 'binary_specificity': 0.93701226, 'binary_f1_score': 0.37286612}
confusion matrix:
       0     1
0  16929  1138
1    258   415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92990655, 'precision': 0.6685854, 'recall': 0.8530816, 'specificity': 0.8530816, 'f1': 0.7207337, 'auroc': 0.91743314, 'binary_precision': 0.3478261, 'binary_recall': 0.7692308, 'binary_specificity': 0.9369324, 'binary_f1_score': 0.47904196}
confusion matrix:
      0    1
0  5571  375
1    60  200
early stop counter: 6
val acc:0.9255069494247437, best validation acc: 0.9261472821235657, corresponding to test acc:                         0.9345794320106506 / 0.9345794320106506
after epoch: 14,now: 2024-08-02 02:57:12.268458,epoch time: 0:18:58.338261,used: 4:29:31.755030,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97016454, 'precision': 0.9703928, 'recall': 0.9701731, 'specificity': 0.9701731, 'f1': 0.9701613, 'auroc': 0.9952642, 'binary_precision': 0.9809473, 'binary_recall': 0.95900106, 'binary_specificity': 0.9813451, 'binary_f1_score': 0.96985006}
confusion matrix:
       0      1
0  28249    537
1   1182  27648
---- Validation: 
scalar performance:
{'acc': 0.8994664, 'precision': 0.60200524, 'recall': 0.7976546, 'specificity': 0.7976546, 'f1': 0.6375982, 'auroc': 0.87829125, 'binary_precision': 0.21665886, 'binary_recall': 0.6879643, 'binary_specificity': 0.9073449, 'binary_f1_score': 0.32953736}
confusion matrix:
       0     1
0  16393  1674
1    210   463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8970351, 'precision': 0.6264023, 'recall': 0.8524781, 'specificity': 0.8524781, 'f1': 0.669592, 'auroc': 0.91696167, 'binary_precision': 0.26223338, 'binary_recall': 0.8038462, 'binary_specificity': 0.90111, 'binary_f1_score': 0.39545882}
confusion matrix:
      0    1
0  5358  588
1    51  209
early stop counter: 7
val acc:0.8994663953781128, best validation acc: 0.9261472821235657, corresponding to test acc:                         0.9345794320106506 / 0.9345794320106506
after epoch: 15,now: 2024-08-02 03:16:11.084624,epoch time: 0:18:58.816166,used: 4:48:30.571196,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_22_27_39_seed_1_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:48:30.571196 at 2024-08-02 03:16:11.084624
persisted model performance metric: 

scalar performance:
{'acc': 0.93457943, 'precision': 0.67980736, 'recall': 0.86655414, 'specificity': 0.86655414, 'f1': 0.7343247, 'auroc': 0.9254974, 'binary_precision': 0.3691756, 'binary_recall': 0.7923077, 'binary_specificity': 0.94080055, 'binary_f1_score': 0.5036675}
confusion matrix:
      0    1
0  5594  352
1    54  206
oracle model performance metric: 

scalar performance:
{'acc': 0.93457943, 'precision': 0.67980736, 'recall': 0.86655414, 'specificity': 0.86655414, 'f1': 0.7343247, 'auroc': 0.9254974, 'binary_precision': 0.3691756, 'binary_recall': 0.7923077, 'binary_specificity': 0.94080055, 'binary_f1_score': 0.5036675}
confusion matrix:
      0    1
0  5594  352
1    54  206
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    970 MiB |   8605 MiB | 724940 GiB | 724939 GiB |
|       from large pool |    931 MiB |   8560 MiB | 713353 GiB | 713352 GiB |
|       from small pool |     38 MiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    970 MiB |   8605 MiB | 724940 GiB | 724939 GiB |
|       from large pool |    931 MiB |   8560 MiB | 713353 GiB | 713352 GiB |
|       from small pool |     38 MiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    967 MiB |   8603 MiB | 724829 GiB | 724828 GiB |
|       from large pool |    929 MiB |   8559 MiB | 713267 GiB | 713266 GiB |
|       from small pool |     37 MiB |     79 MiB |  11562 GiB |  11562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9598 MiB |   9626 MiB |  18168 MiB |   8570 MiB |
|       from large pool |   9518 MiB |   9540 MiB |  18064 MiB |   8546 MiB |
|       from small pool |     80 MiB |     86 MiB |    104 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  65095 KiB |    824 MiB | 384536 GiB | 384536 GiB |
|       from large pool |  43381 KiB |    822 MiB | 372930 GiB | 372930 GiB |
|       from small pool |  21714 KiB |     38 MiB |  11606 GiB |  11606 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3448    |    8191    |  143280 K  |  143277 K  |
|       from large pool |     161    |     844    |   67339 K  |   67339 K  |
|       from small pool |    3287    |    8028    |   75941 K  |   75937 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3448    |    8191    |  143280 K  |  143277 K  |
|       from large pool |     161    |     844    |   67339 K  |   67339 K  |
|       from small pool |    3287    |    8028    |   75941 K  |   75937 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     404    |     745    |     346    |
|       from large pool |     359    |     361    |     693    |     334    |
|       from small pool |      40    |      43    |      52    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3636    |   79894 K  |   79894 K  |
|       from large pool |      21    |     359    |   46181 K  |   46181 K  |
|       from small pool |      52    |    3616    |   33713 K  |   33713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8605 MiB | 724940 GiB | 724940 GiB |
|       from large pool |  16640 KiB |   8560 MiB | 713353 GiB | 713353 GiB |
|       from small pool |      0 KiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8605 MiB | 724940 GiB | 724940 GiB |
|       from large pool |  16640 KiB |   8560 MiB | 713353 GiB | 713353 GiB |
|       from small pool |      0 KiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB | 724829 GiB | 724829 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 713267 GiB | 713267 GiB |
|       from small pool |      0 KiB |     79 MiB |  11562 GiB |  11562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1034 MiB |   9626 MiB |  18168 MiB |  17134 MiB |
|       from large pool |    974 MiB |   9540 MiB |  18064 MiB |  17090 MiB |
|       from small pool |     60 MiB |     86 MiB |    104 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    824 MiB | 384536 GiB | 384536 GiB |
|       from large pool |  30464 KiB |    822 MiB | 372930 GiB | 372930 GiB |
|       from small pool |      0 KiB |     38 MiB |  11606 GiB |  11606 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143280 K  |  143280 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75941 K  |   75941 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143280 K  |  143280 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75941 K  |   75941 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     404    |     745    |     689    |
|       from large pool |      26    |     361    |     693    |     667    |
|       from small pool |      30    |      43    |      52    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3636    |   79896 K  |   79896 K  |
|       from large pool |       2    |     359    |   46181 K  |   46181 K  |
|       from small pool |       0    |    3616    |   33714 K  |   33714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8605 MiB | 724940 GiB | 724940 GiB |
|       from large pool |  16640 KiB |   8560 MiB | 713353 GiB | 713353 GiB |
|       from small pool |      0 KiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8605 MiB | 724940 GiB | 724940 GiB |
|       from large pool |  16640 KiB |   8560 MiB | 713353 GiB | 713353 GiB |
|       from small pool |      0 KiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB | 724829 GiB | 724829 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 713267 GiB | 713267 GiB |
|       from small pool |      0 KiB |     79 MiB |  11562 GiB |  11562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1034 MiB |   9626 MiB |  18168 MiB |  17134 MiB |
|       from large pool |    974 MiB |   9540 MiB |  18064 MiB |  17090 MiB |
|       from small pool |     60 MiB |     86 MiB |    104 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    824 MiB | 384536 GiB | 384536 GiB |
|       from large pool |  30464 KiB |    822 MiB | 372930 GiB | 372930 GiB |
|       from small pool |      0 KiB |     38 MiB |  11606 GiB |  11606 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143280 K  |  143280 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75941 K  |   75941 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143280 K  |  143280 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75941 K  |   75941 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     404    |     745    |     689    |
|       from large pool |      26    |     361    |     693    |     667    |
|       from small pool |      30    |      43    |      52    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3636    |   79896 K  |   79896 K  |
|       from large pool |       2    |     359    |   46181 K  |   46181 K  |
|       from small pool |       0    |    3616    |   33714 K  |   33714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987

 Experiment start at: 2024-08-02 03:24:57.807717
before training, model accuracy: 0.3599936068058014
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90343714, 'precision': 0.90593266, 'recall': 0.90344524, 'specificity': 0.90344524, 'f1': 0.9032898, 'auroc': 0.9633914, 'binary_precision': 0.9378117, 'binary_recall': 0.8642225, 'binary_specificity': 0.94266796, 'binary_f1_score': 0.89951456}
confusion matrix:
       0      1
0  27475   1671
1   3959  25199
---- Validation: 
scalar performance:
{'acc': 0.87956107, 'precision': 0.5705514, 'recall': 0.7538874, 'specificity': 0.7538874, 'f1': 0.59131277, 'auroc': 0.8455801, 'binary_precision': 0.15509355, 'binary_recall': 0.6196013, 'binary_specificity': 0.88817346, 'binary_f1_score': 0.24808778}
confusion matrix:
       0     1
0  16139  2032
1    229   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90206766, 'precision': 0.61783063, 'recall': 0.82612795, 'specificity': 0.82612795, 'f1': 0.6588268, 'auroc': 0.9111718, 'binary_precision': 0.24691358, 'binary_recall': 0.74380165, 'binary_specificity': 0.90845424, 'binary_f1_score': 0.37075177}
confusion matrix:
      0    1
0  5448  549
1    62  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 03:46:25.134060,epoch time: 0:21:27.326343,used: 0:21:27.326343,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92664313, 'precision': 0.9279629, 'recall': 0.9266479, 'specificity': 0.9266479, 'f1': 0.92658705, 'auroc': 0.9764616, 'binary_precision': 0.9517722, 'binary_recall': 0.8988579, 'binary_specificity': 0.95443785, 'binary_f1_score': 0.9245586}
confusion matrix:
       0      1
0  27819   1328
1   2949  26208
---- Validation: 
scalar performance:
{'acc': 0.89218557, 'precision': 0.5832107, 'recall': 0.77887887, 'specificity': 0.77887887, 'f1': 0.6114859, 'auroc': 0.8718114, 'binary_precision': 0.17886178, 'binary_recall': 0.6578073, 'binary_specificity': 0.89995044, 'binary_f1_score': 0.28124997}
confusion matrix:
       0     1
0  16353  1818
1    206   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91008174, 'precision': 0.6316294, 'recall': 0.8521068, 'specificity': 0.8521068, 'f1': 0.6782278, 'auroc': 0.92266107, 'binary_precision': 0.2724679, 'binary_recall': 0.7892562, 'binary_specificity': 0.91495746, 'binary_f1_score': 0.40509012}
confusion matrix:
      0    1
0  5487  510
1    51  191
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 04:05:55.758278,epoch time: 0:19:30.624218,used: 0:40:57.950561,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9399527, 'precision': 0.9405855, 'recall': 0.9399559, 'specificity': 0.9399559, 'f1': 0.9399314, 'auroc': 0.9826416, 'binary_precision': 0.9573262, 'binary_recall': 0.9209795, 'binary_specificity': 0.9589323, 'binary_f1_score': 0.93880117}
confusion matrix:
       0      1
0  27950   1197
1   2304  26853
---- Validation: 
scalar performance:
{'acc': 0.9015607, 'precision': 0.5911783, 'recall': 0.7845248, 'specificity': 0.7845248, 'f1': 0.6237923, 'auroc': 0.87642545, 'binary_precision': 0.19460784, 'binary_recall': 0.6594684, 'binary_specificity': 0.9095812, 'binary_f1_score': 0.3005299}
confusion matrix:
       0     1
0  16528  1643
1    205   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9200192, 'precision': 0.6453001, 'recall': 0.85925883, 'specificity': 0.85925883, 'f1': 0.6959226, 'auroc': 0.92593336, 'binary_precision': 0.29953197, 'binary_recall': 0.7933884, 'binary_specificity': 0.92512923, 'binary_f1_score': 0.43488106}
confusion matrix:
      0    1
0  5548  449
1    50  192
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 04:25:30.229108,epoch time: 0:19:34.470830,used: 1:00:32.421391,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9468304, 'precision': 0.94754505, 'recall': 0.9468352, 'specificity': 0.9468352, 'f1': 0.9468096, 'auroc': 0.9865732, 'binary_precision': 0.9654889, 'binary_recall': 0.92681503, 'binary_specificity': 0.9668554, 'binary_f1_score': 0.9457568}
confusion matrix:
       0      1
0  28179    966
1   2134  27025
---- Validation: 
scalar performance:
{'acc': 0.92372024, 'precision': 0.61010283, 'recall': 0.77027404, 'specificity': 0.77027404, 'f1': 0.64859, 'auroc': 0.87562627, 'binary_precision': 0.23397435, 'binary_recall': 0.6063123, 'binary_specificity': 0.9342359, 'binary_f1_score': 0.33765033}
confusion matrix:
       0     1
0  16976  1195
1    237   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9427793, 'precision': 0.6851054, 'recall': 0.8532534, 'specificity': 0.8532534, 'f1': 0.737927, 'auroc': 0.9266961, 'binary_precision': 0.38045737, 'binary_recall': 0.75619835, 'binary_specificity': 0.9503085, 'binary_f1_score': 0.5062241}
confusion matrix:
      0    1
0  5699  298
1    59  183
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 04:45:04.689193,epoch time: 0:19:34.460085,used: 1:20:06.881476,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95295346, 'precision': 0.95348316, 'recall': 0.95295703, 'specificity': 0.95295703, 'f1': 0.95294, 'auroc': 0.98873115, 'binary_precision': 0.969033, 'binary_recall': 0.9358324, 'binary_specificity': 0.9700817, 'binary_f1_score': 0.9521434}
confusion matrix:
       0      1
0  28274    872
1   1871  27287
---- Validation: 
scalar performance:
{'acc': 0.9236137, 'precision': 0.6105466, 'recall': 0.7726282, 'specificity': 0.7726282, 'f1': 0.64931726, 'auroc': 0.87663937, 'binary_precision': 0.23469388, 'binary_recall': 0.6112957, 'binary_specificity': 0.93396074, 'binary_f1_score': 0.33917052}
confusion matrix:
       0     1
0  16971  1200
1    234   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9445424, 'precision': 0.690204, 'recall': 0.85813606, 'specificity': 0.85813606, 'f1': 0.7436715, 'auroc': 0.9259423, 'binary_precision': 0.39029536, 'binary_recall': 0.7644628, 'binary_specificity': 0.9518092, 'binary_f1_score': 0.51675975}
confusion matrix:
      0    1
0  5708  289
1    57  185
new oracle model saved
early stop counter: 1
val acc:0.9236137270927429, best validation acc: 0.9237202405929565, corresponding to test acc:                         0.9427793025970459 / 0.944542407989502
after epoch: 5,now: 2024-08-02 05:04:38.268616,epoch time: 0:19:33.579423,used: 1:39:40.460899,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95281625, 'precision': 0.9537002, 'recall': 0.95282006, 'specificity': 0.95282006, 'f1': 0.9527936, 'auroc': 0.9900997, 'binary_precision': 0.9737692, 'binary_recall': 0.9307199, 'binary_specificity': 0.9749202, 'binary_f1_score': 0.951758}
confusion matrix:
       0      1
0  28416    731
1   2020  27137
---- Validation: 
scalar performance:
{'acc': 0.9366111, 'precision': 0.62292147, 'recall': 0.743205, 'specificity': 0.743205, 'f1': 0.6592639, 'auroc': 0.87235475, 'binary_precision': 0.2617504, 'binary_recall': 0.53654486, 'binary_specificity': 0.94986516, 'binary_f1_score': 0.35185185}
confusion matrix:
       0    1
0  17260  911
1    279  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.72666055, 'recall': 0.8545588, 'specificity': 0.8545588, 'f1': 0.77431995, 'auroc': 0.9230883, 'binary_precision': 0.46391752, 'binary_recall': 0.74380165, 'binary_specificity': 0.965316, 'binary_f1_score': 0.57142854}
confusion matrix:
      0    1
0  5789  208
1    62  180
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-02 05:24:15.137008,epoch time: 0:19:36.868392,used: 1:59:17.329291,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9581332, 'precision': 0.95855135, 'recall': 0.9581363, 'specificity': 0.9581363, 'f1': 0.9581239, 'auroc': 0.99101365, 'binary_precision': 0.9724492, 'binary_recall': 0.9430002, 'binary_specificity': 0.9732725, 'binary_f1_score': 0.9574983}
confusion matrix:
       0      1
0  28367    779
1   1662  27496
---- Validation: 
scalar performance:
{'acc': 0.92888725, 'precision': 0.6140251, 'recall': 0.75768524, 'specificity': 0.75768524, 'f1': 0.6519028, 'auroc': 0.8751153, 'binary_precision': 0.24280702, 'binary_recall': 0.57475084, 'binary_specificity': 0.94061965, 'binary_f1_score': 0.3413912}
confusion matrix:
       0     1
0  17092  1079
1    256   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95031255, 'precision': 0.70574766, 'recall': 0.857172, 'specificity': 0.857172, 'f1': 0.75757664, 'auroc': 0.9223207, 'binary_precision': 0.421659, 'binary_recall': 0.75619835, 'binary_specificity': 0.95814574, 'binary_f1_score': 0.54142004}
confusion matrix:
      0    1
0  5746  251
1    59  183
early stop counter: 1
val acc:0.9288872480392456, best validation acc: 0.9366111159324646, corresponding to test acc:                         0.9567238092422485 / 0.9567238092422485
after epoch: 7,now: 2024-08-02 05:43:49.160367,epoch time: 0:19:34.023359,used: 2:18:51.352650,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9620781, 'precision': 0.9622676, 'recall': 0.9620801, 'specificity': 0.9620801, 'f1': 0.9620743, 'auroc': 0.9926212, 'binary_precision': 0.9716786, 'binary_recall': 0.9519171, 'binary_specificity': 0.9722432, 'binary_f1_score': 0.9616964}
confusion matrix:
       0      1
0  28337    809
1   1402  27756
---- Validation: 
scalar performance:
{'acc': 0.92324084, 'precision': 0.60741985, 'recall': 0.7619959, 'specificity': 0.7619959, 'f1': 0.6446835, 'auroc': 0.8764402, 'binary_precision': 0.22918011, 'binary_recall': 0.589701, 'binary_specificity': 0.9342909, 'binary_f1_score': 0.33007902}
confusion matrix:
       0     1
0  16977  1194
1    247   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94422185, 'precision': 0.6890625, 'recall': 0.85598654, 'specificity': 0.85598654, 'f1': 0.7421899, 'auroc': 0.9214457, 'binary_precision': 0.38818565, 'binary_recall': 0.76033056, 'binary_specificity': 0.9516425, 'binary_f1_score': 0.5139665}
confusion matrix:
      0    1
0  5707  290
1    58  184
early stop counter: 2
val acc:0.9232408404350281, best validation acc: 0.9366111159324646, corresponding to test acc:                         0.9567238092422485 / 0.9567238092422485
after epoch: 8,now: 2024-08-02 06:03:31.772201,epoch time: 0:19:42.611834,used: 2:38:33.964484,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96204376, 'precision': 0.9623737, 'recall': 0.962046, 'specificity': 0.962046, 'f1': 0.9620371, 'auroc': 0.9927188, 'binary_precision': 0.9747674, 'binary_recall': 0.9486573, 'binary_specificity': 0.97543484, 'binary_f1_score': 0.9615351}
confusion matrix:
       0      1
0  28431    716
1   1497  27660
---- Validation: 
scalar performance:
{'acc': 0.9224418, 'precision': 0.60631454, 'recall': 0.7615832, 'specificity': 0.7615832, 'f1': 0.64331996, 'auroc': 0.8741293, 'binary_precision': 0.2269821, 'binary_recall': 0.589701, 'binary_specificity': 0.9334654, 'binary_f1_score': 0.32779318}
confusion matrix:
       0     1
0  16962  1209
1    247   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9427793, 'precision': 0.6860972, 'recall': 0.85920167, 'specificity': 0.85920167, 'f1': 0.73995125, 'auroc': 0.9192833, 'binary_precision': 0.38193017, 'binary_recall': 0.76859504, 'binary_specificity': 0.94980824, 'binary_f1_score': 0.51028806}
confusion matrix:
      0    1
0  5696  301
1    56  186
early stop counter: 3
val acc:0.9224417805671692, best validation acc: 0.9366111159324646, corresponding to test acc:                         0.9567238092422485 / 0.9567238092422485
after epoch: 9,now: 2024-08-02 06:23:02.533083,epoch time: 0:19:30.760882,used: 2:58:04.725366,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9633816, 'precision': 0.9637053, 'recall': 0.9633843, 'specificity': 0.9633843, 'f1': 0.96337533, 'auroc': 0.99318457, 'binary_precision': 0.9760085, 'binary_recall': 0.95013374, 'binary_specificity': 0.97663486, 'binary_f1_score': 0.96289736}
confusion matrix:
       0      1
0  28465    681
1   1454  27704
---- Validation: 
scalar performance:
{'acc': 0.93501306, 'precision': 0.62089944, 'recall': 0.74639475, 'specificity': 0.74639475, 'f1': 0.6577389, 'auroc': 0.8751631, 'binary_precision': 0.25745684, 'binary_recall': 0.54485047, 'binary_specificity': 0.94793904, 'binary_f1_score': 0.3496802}
confusion matrix:
       0    1
0  17225  946
1    274  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548004, 'precision': 0.7192708, 'recall': 0.8495928, 'specificity': 0.8495928, 'f1': 0.7670881, 'auroc': 0.91830915, 'binary_precision': 0.44949496, 'binary_recall': 0.7355372, 'binary_specificity': 0.9636485, 'binary_f1_score': 0.55799377}
confusion matrix:
      0    1
0  5779  218
1    64  178
early stop counter: 4
val acc:0.9350130558013916, best validation acc: 0.9366111159324646, corresponding to test acc:                         0.9567238092422485 / 0.9567238092422485
after epoch: 10,now: 2024-08-02 06:42:37.549197,epoch time: 0:19:35.016114,used: 3:17:39.741480,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9652168, 'precision': 0.96558267, 'recall': 0.9652197, 'specificity': 0.9652197, 'f1': 0.9652101, 'auroc': 0.9938917, 'binary_precision': 0.97868586, 'binary_recall': 0.95116264, 'binary_specificity': 0.9792767, 'binary_f1_score': 0.964728}
confusion matrix:
       0      1
0  28542    604
1   1424  27734
---- Validation: 
scalar performance:
{'acc': 0.9313908, 'precision': 0.6165008, 'recall': 0.7525542, 'specificity': 0.7525542, 'f1': 0.65399873, 'auroc': 0.874733, 'binary_precision': 0.24816446, 'binary_recall': 0.5614618, 'binary_specificity': 0.9436465, 'binary_f1_score': 0.34419551}
confusion matrix:
       0     1
0  17147  1024
1    264   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9482289, 'precision': 0.6993166, 'recall': 0.8541055, 'specificity': 0.8541055, 'f1': 0.7512231, 'auroc': 0.91675174, 'binary_precision': 0.40898877, 'binary_recall': 0.75206614, 'binary_specificity': 0.95614475, 'binary_f1_score': 0.52983993}
confusion matrix:
      0    1
0  5734  263
1    60  182
early stop counter: 5
val acc:0.9313908219337463, best validation acc: 0.9366111159324646, corresponding to test acc:                         0.9567238092422485 / 0.9567238092422485
after epoch: 11,now: 2024-08-02 07:02:03.880702,epoch time: 0:19:26.331505,used: 3:37:06.072985,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9672578, 'precision': 0.9675112, 'recall': 0.9672598, 'specificity': 0.9672598, 'f1': 0.96725345, 'auroc': 0.994393, 'binary_precision': 0.97843796, 'binary_recall': 0.9555853, 'binary_specificity': 0.97893435, 'binary_f1_score': 0.9668766}
confusion matrix:
       0      1
0  28533    614
1   1295  27862
---- Validation: 
scalar performance:
{'acc': 0.9276088, 'precision': 0.61567557, 'recall': 0.7714797, 'specificity': 0.7714797, 'f1': 0.6552501, 'auroc': 0.8806039, 'binary_precision': 0.24511784, 'binary_recall': 0.60465115, 'binary_specificity': 0.9383083, 'binary_f1_score': 0.34882608}
confusion matrix:
       0     1
0  17050  1121
1    238   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94213814, 'precision': 0.6845381, 'recall': 0.8588681, 'specificity': 0.8588681, 'f1': 0.73838353, 'auroc': 0.9194039, 'binary_precision': 0.37881875, 'binary_recall': 0.76859504, 'binary_specificity': 0.94914126, 'binary_f1_score': 0.50750345}
confusion matrix:
      0    1
0  5692  305
1    56  186
early stop counter: 6
val acc:0.9276087880134583, best validation acc: 0.9366111159324646, corresponding to test acc:                         0.9567238092422485 / 0.9567238092422485
after epoch: 12,now: 2024-08-02 07:21:31.953221,epoch time: 0:19:28.072519,used: 3:56:34.145504,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9680468, 'precision': 0.96830666, 'recall': 0.9680488, 'specificity': 0.9680488, 'f1': 0.96804243, 'auroc': 0.9949548, 'binary_precision': 0.97938037, 'binary_recall': 0.9562369, 'binary_specificity': 0.9798607, 'binary_f1_score': 0.96767026}
confusion matrix:
       0      1
0  28560    587
1   1276  27881
---- Validation: 
scalar performance:
{'acc': 0.9281415, 'precision': 0.61510056, 'recall': 0.76613355, 'specificity': 0.76613355, 'f1': 0.65403986, 'auroc': 0.8766434, 'binary_precision': 0.24435319, 'binary_recall': 0.59302324, 'binary_specificity': 0.93924385, 'binary_f1_score': 0.34609792}
confusion matrix:
       0     1
0  17067  1104
1    245   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9440616, 'precision': 0.688653, 'recall': 0.85590315, 'specificity': 0.85590315, 'f1': 0.7417877, 'auroc': 0.9171052, 'binary_precision': 0.3873684, 'binary_recall': 0.76033056, 'binary_specificity': 0.95147574, 'binary_f1_score': 0.51324964}
confusion matrix:
      0    1
0  5706  291
1    58  184
early stop counter: 7
val acc:0.9281414747238159, best validation acc: 0.9366111159324646, corresponding to test acc:                         0.9567238092422485 / 0.9567238092422485
after epoch: 13,now: 2024-08-02 07:41:01.634953,epoch time: 0:19:29.681732,used: 4:16:03.827236,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9677209, 'precision': 0.968119, 'recall': 0.9677229, 'specificity': 0.9677229, 'f1': 0.9677142, 'auroc': 0.994931, 'binary_precision': 0.98180467, 'binary_recall': 0.9531143, 'binary_specificity': 0.9823316, 'binary_f1_score': 0.96724683}
confusion matrix:
       0      1
0  28633    515
1   1367  27789
---- Validation: 
scalar performance:
{'acc': 0.9374634, 'precision': 0.6255244, 'recall': 0.74685746, 'specificity': 0.74685746, 'f1': 0.6624498, 'auroc': 0.87535155, 'binary_precision': 0.26672104, 'binary_recall': 0.54318935, 'binary_specificity': 0.9505256, 'binary_f1_score': 0.35776803}
confusion matrix:
       0    1
0  17272  899
1    275  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9519154, 'precision': 0.7097347, 'recall': 0.8500748, 'specificity': 0.8500748, 'f1': 0.7593461, 'auroc': 0.9146503, 'binary_precision': 0.43028846, 'binary_recall': 0.73966944, 'binary_specificity': 0.9604802, 'binary_f1_score': 0.5440729}
confusion matrix:
      0    1
0  5760  237
1    63  179
better model found
persisted
after epoch: 14,now: 2024-08-02 08:00:31.829697,epoch time: 0:19:30.194744,used: 4:35:34.021980,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96926457, 'precision': 0.9694394, 'recall': 0.9692656, 'specificity': 0.9692656, 'f1': 0.96926177, 'auroc': 0.99529064, 'binary_precision': 0.9785247, 'binary_recall': 0.95959526, 'binary_specificity': 0.97893584, 'binary_f1_score': 0.96896756}
confusion matrix:
       0      1
0  28535    614
1   1178  27977
---- Validation: 
scalar performance:
{'acc': 0.9301124, 'precision': 0.61969995, 'recall': 0.772773, 'specificity': 0.772773, 'f1': 0.6599556, 'auroc': 0.88242126, 'binary_precision': 0.25312933, 'binary_recall': 0.60465115, 'binary_specificity': 0.94089484, 'binary_f1_score': 0.35686272}
confusion matrix:
       0     1
0  17097  1074
1    238   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9381311, 'precision': 0.67316604, 'recall': 0.8448873, 'specificity': 0.8448873, 'f1': 0.7248361, 'auroc': 0.91529715, 'binary_precision': 0.35714287, 'binary_recall': 0.74380165, 'binary_specificity': 0.945973, 'binary_f1_score': 0.48257372}
confusion matrix:
      0    1
0  5673  324
1    62  180
early stop counter: 1
val acc:0.9301124215126038, best validation acc: 0.9374634027481079, corresponding to test acc:                         0.9519153833389282 / 0.9567238092422485
after epoch: 15,now: 2024-08-02 08:20:02.928001,epoch time: 0:19:31.098304,used: 4:55:05.120284,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_24_56_seed_2_23919987
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:55:05.120284 at 2024-08-02 08:20:02.928001
persisted model performance metric: 

scalar performance:
{'acc': 0.9519154, 'precision': 0.7097347, 'recall': 0.8500748, 'specificity': 0.8500748, 'f1': 0.7593461, 'auroc': 0.9146503, 'binary_precision': 0.43028846, 'binary_recall': 0.73966944, 'binary_specificity': 0.9604802, 'binary_f1_score': 0.5440729}
confusion matrix:
      0    1
0  5760  237
1    63  179
oracle model performance metric: 

scalar performance:
{'acc': 0.9567238, 'precision': 0.72666055, 'recall': 0.8545588, 'specificity': 0.8545588, 'f1': 0.77431995, 'auroc': 0.9230883, 'binary_precision': 0.46391752, 'binary_recall': 0.74380165, 'binary_specificity': 0.965316, 'binary_f1_score': 0.57142854}
confusion matrix:
      0    1
0  5789  208
1    62  180
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    970 MiB |   8605 MiB |   1078 TiB |   1078 TiB |
|       from large pool |    931 MiB |   8560 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     38 MiB |     80 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |    970 MiB |   8605 MiB |   1078 TiB |   1078 TiB |
|       from large pool |    931 MiB |   8560 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     38 MiB |     80 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |    967 MiB |   8603 MiB |   1078 TiB |   1078 TiB |
|       from large pool |    929 MiB |   8559 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     37 MiB |     79 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9598 MiB |   9626 MiB |  26732 MiB |  17134 MiB |
|       from large pool |   9518 MiB |   9540 MiB |  26608 MiB |  17090 MiB |
|       from small pool |     80 MiB |     86 MiB |    124 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  60993 KiB |    824 MiB | 593108 GiB | 593108 GiB |
|       from large pool |  43381 KiB |    822 MiB | 575518 GiB | 575518 GiB |
|       from small pool |  17612 KiB |     38 MiB |  17589 GiB |  17589 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3460    |    8277    |  217242 K  |  217239 K  |
|       from large pool |     161    |     844    |  102528 K  |  102528 K  |
|       from small pool |    3299    |    8114    |  114714 K  |  114710 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3460    |    8277    |  217242 K  |  217239 K  |
|       from large pool |     161    |     844    |  102528 K  |  102528 K  |
|       from small pool |    3299    |    8114    |  114714 K  |  114710 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     404    |    1088    |     689    |
|       from large pool |     359    |     361    |    1026    |     667    |
|       from small pool |      40    |      43    |      62    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3678    |  122850 K  |  122850 K  |
|       from large pool |      21    |     359    |   71778 K  |   71778 K  |
|       from small pool |      50    |    3658    |   51071 K  |   51071 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8605 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8560 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     80 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8605 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8560 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     80 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8559 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     79 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1030 MiB |   9626 MiB |  26732 MiB |  25702 MiB |
|       from large pool |    974 MiB |   9540 MiB |  26608 MiB |  25634 MiB |
|       from small pool |     56 MiB |     86 MiB |    124 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    824 MiB | 593108 GiB | 593108 GiB |
|       from large pool |  30464 KiB |    822 MiB | 575519 GiB | 575519 GiB |
|       from small pool |      0 KiB |     38 MiB |  17589 GiB |  17589 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8277    |  217242 K  |  217242 K  |
|       from large pool |       2    |     844    |  102528 K  |  102528 K  |
|       from small pool |       0    |    8114    |  114714 K  |  114714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8277    |  217242 K  |  217242 K  |
|       from large pool |       2    |     844    |  102528 K  |  102528 K  |
|       from small pool |       0    |    8114    |  114714 K  |  114714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |     404    |    1088    |    1034    |
|       from large pool |      26    |     361    |    1026    |    1000    |
|       from small pool |      28    |      43    |      62    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3678    |  122852 K  |  122852 K  |
|       from large pool |       2    |     359    |   71778 K  |   71778 K  |
|       from small pool |       0    |    3658    |   51073 K  |   51073 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 08:21:32 2024]
Finished job 0.
1 of 1 steps (100%) done
