Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  2 05:01:12 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998

 Experiment start at: 2024-08-02 05:09:37.229029
before training, model accuracy: 0.8723234534263611
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86888075, 'precision': 0.87404937, 'recall': 0.86892796, 'specificity': 0.86892796, 'f1': 0.8684366, 'auroc': 0.94933546, 'binary_precision': 0.91821986, 'binary_recall': 0.8101244, 'binary_specificity': 0.92773145, 'binary_f1_score': 0.8607918}
confusion matrix:
       0      1
0  26586   2071
1   5450  23253
---- Validation: 
scalar performance:
{'acc': 0.92853343, 'precision': 0.5403812, 'recall': 0.55572075, 'specificity': 0.55572075, 'f1': 0.54617727, 'auroc': 0.66926897, 'binary_precision': 0.11111111, 'binary_recall': 0.15552099, 'binary_specificity': 0.95592046, 'binary_f1_score': 0.12961763}
confusion matrix:
       0    1
0  17349  800
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477469, 'precision': 0.5980245, 'recall': 0.54763496, 'specificity': 0.54763496, 'f1': 0.56184685, 'auroc': 0.8256165, 'binary_precision': 0.23387097, 'binary_recall': 0.11111111, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.15064935}
confusion matrix:
      0   1
0  5902  95
1   232  29
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 05:28:40.358328,epoch time: 0:19:03.129299,used: 0:19:03.129299,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.911053, 'precision': 0.9149791, 'recall': 0.9110887, 'specificity': 0.9110887, 'f1': 0.9108472, 'auroc': 0.9720597, 'binary_precision': 0.9555264, 'binary_recall': 0.8623741, 'binary_specificity': 0.9598032, 'binary_f1_score': 0.90656364}
confusion matrix:
       0      1
0  27507   1152
1   3950  24751
---- Validation: 
scalar performance:
{'acc': 0.9251809, 'precision': 0.56899726, 'recall': 0.61848986, 'specificity': 0.61848986, 'f1': 0.5849784, 'auroc': 0.7509221, 'binary_precision': 0.16387665, 'binary_recall': 0.28926906, 'binary_specificity': 0.94771063, 'binary_f1_score': 0.20922385}
confusion matrix:
       0    1
0  17200  949
1    457  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95270056, 'precision': 0.69692636, 'recall': 0.66932124, 'specificity': 0.66932124, 'f1': 0.6819143, 'auroc': 0.8789376, 'binary_precision': 0.42152467, 'binary_recall': 0.36015326, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.38842973}
confusion matrix:
      0    1
0  5868  129
1   167   94
new oracle model saved
early stop counter: 1
val acc:0.9251809120178223, best validation acc: 0.9285334348678589, corresponding to test acc:                         0.9477468729019165 / 0.9527005553245544
after epoch: 2,now: 2024-08-02 05:47:18.404265,epoch time: 0:18:38.045937,used: 0:37:41.175236,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9264993, 'precision': 0.92938405, 'recall': 0.92653084, 'specificity': 0.92653084, 'f1': 0.92637926, 'auroc': 0.978606, 'binary_precision': 0.9647711, 'binary_recall': 0.8854435, 'binary_specificity': 0.9676181, 'binary_f1_score': 0.9234067}
confusion matrix:
       0      1
0  27730    928
1   3288  25414
---- Validation: 
scalar performance:
{'acc': 0.9299702, 'precision': 0.5832144, 'recall': 0.63747054, 'specificity': 0.63747054, 'f1': 0.60173917, 'auroc': 0.7838826, 'binary_precision': 0.19100092, 'binary_recall': 0.32348368, 'binary_specificity': 0.9514574, 'binary_f1_score': 0.24018477}
confusion matrix:
       0    1
0  17268  881
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7426628, 'recall': 0.7257105, 'specificity': 0.7257105, 'f1': 0.73383605, 'auroc': 0.8931682, 'binary_precision': 0.5082645, 'binary_recall': 0.47126436, 'binary_specificity': 0.9801567, 'binary_f1_score': 0.48906562}
confusion matrix:
      0    1
0  5878  119
1   138  123
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 06:06:06.300194,epoch time: 0:18:47.895929,used: 0:56:29.071165,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9342573, 'precision': 0.93666875, 'recall': 0.9342807, 'specificity': 0.9342807, 'f1': 0.9341689, 'auroc': 0.98269975, 'binary_precision': 0.96927595, 'binary_recall': 0.8970311, 'binary_specificity': 0.97153026, 'binary_f1_score': 0.9317553}
confusion matrix:
       0      1
0  27846    816
1   2955  25743
---- Validation: 
scalar performance:
{'acc': 0.9324713, 'precision': 0.5936439, 'recall': 0.65376645, 'specificity': 0.65376645, 'f1': 0.6144796, 'auroc': 0.8044783, 'binary_precision': 0.21072088, 'binary_recall': 0.35458788, 'binary_specificity': 0.95294505, 'binary_f1_score': 0.26434782}
confusion matrix:
       0    1
0  17295  854
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7592132, 'recall': 0.75636184, 'specificity': 0.75636184, 'f1': 0.7577785, 'auroc': 0.90277004, 'binary_precision': 0.5387597, 'binary_recall': 0.532567, 'binary_specificity': 0.9801567, 'binary_f1_score': 0.5356454}
confusion matrix:
      0    1
0  5878  119
1   122  139
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 06:24:39.071828,epoch time: 0:18:32.771634,used: 1:15:01.842799,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9404637, 'precision': 0.9425298, 'recall': 0.94049484, 'specificity': 0.94049484, 'f1': 0.940397, 'auroc': 0.9851538, 'binary_precision': 0.9729942, 'binary_recall': 0.9061869, 'binary_specificity': 0.9748028, 'binary_f1_score': 0.93840295}
confusion matrix:
       0      1
0  27932    722
1   2693  26013
---- Validation: 
scalar performance:
{'acc': 0.93513197, 'precision': 0.60112673, 'recall': 0.6611444, 'specificity': 0.6611444, 'f1': 0.62258136, 'auroc': 0.814947, 'binary_precision': 0.22519083, 'binary_recall': 0.36702955, 'binary_specificity': 0.95525926, 'binary_f1_score': 0.27912477}
confusion matrix:
       0    1
0  17337  812
1    407  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.76850927, 'recall': 0.7773513, 'specificity': 0.7773513, 'f1': 0.77284884, 'auroc': 0.907692, 'binary_precision': 0.5555556, 'binary_recall': 0.57471263, 'binary_specificity': 0.97999, 'binary_f1_score': 0.5649718}
confusion matrix:
      0    1
0  5877  120
1   111  150
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-02 06:43:22.651508,epoch time: 0:18:43.579680,used: 1:33:45.422479,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94775105, 'precision': 0.9488244, 'recall': 0.9477673, 'specificity': 0.9477673, 'f1': 0.9477211, 'auroc': 0.9878024, 'binary_precision': 0.97093964, 'binary_recall': 0.9232029, 'binary_specificity': 0.97233176, 'binary_f1_score': 0.9464697}
confusion matrix:
       0      1
0  27868    793
1   2204  26495
---- Validation: 
scalar performance:
{'acc': 0.93358874, 'precision': 0.61160713, 'recall': 0.69859827, 'specificity': 0.69859827, 'f1': 0.64007056, 'auroc': 0.8298941, 'binary_precision': 0.24342664, 'binary_recall': 0.44634527, 'binary_specificity': 0.95085126, 'binary_f1_score': 0.31503844}
confusion matrix:
       0    1
0  17257  892
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.75631005, 'recall': 0.8129975, 'specificity': 0.8129975, 'f1': 0.7814134, 'auroc': 0.9118072, 'binary_precision': 0.5279503, 'binary_recall': 0.651341, 'binary_specificity': 0.974654, 'binary_f1_score': 0.58319044}
confusion matrix:
      0    1
0  5845  152
1    91  170
early stop counter: 1
val acc:0.9335887432098389, best validation acc: 0.9351319670677185, corresponding to test acc:                         0.963087260723114 / 0.963087260723114
after epoch: 6,now: 2024-08-02 07:02:05.212467,epoch time: 0:18:42.560959,used: 1:52:27.983438,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.948954, 'precision': 0.9504199, 'recall': 0.9489759, 'specificity': 0.9489759, 'f1': 0.94891405, 'auroc': 0.9888933, 'binary_precision': 0.9763084, 'binary_recall': 0.92031914, 'binary_specificity': 0.97763276, 'binary_f1_score': 0.94748735}
confusion matrix:
       0      1
0  28017    641
1   2287  26415
---- Validation: 
scalar performance:
{'acc': 0.9434866, 'precision': 0.6247478, 'recall': 0.6752204, 'specificity': 0.6752204, 'f1': 0.64487517, 'auroc': 0.8298256, 'binary_precision': 0.27153763, 'binary_recall': 0.38724726, 'binary_specificity': 0.96319354, 'binary_f1_score': 0.3192308}
confusion matrix:
       0    1
0  17481  668
1    394  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.7898352, 'recall': 0.81416667, 'specificity': 0.81416667, 'f1': 0.8014459, 'auroc': 0.91305804, 'binary_precision': 0.5950704, 'binary_recall': 0.6475096, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.6201835}
confusion matrix:
      0    1
0  5882  115
1    92  169
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-02 07:20:45.322609,epoch time: 0:18:40.110142,used: 2:11:08.093580,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9527894, 'precision': 0.9533793, 'recall': 0.95280266, 'specificity': 0.95280266, 'f1': 0.95277494, 'auroc': 0.9897572, 'binary_precision': 0.9699172, 'binary_recall': 0.9346364, 'binary_specificity': 0.97096896, 'binary_f1_score': 0.95194995}
confusion matrix:
       0      1
0  27827    832
1   1876  26825
---- Validation: 
scalar performance:
{'acc': 0.9404002, 'precision': 0.62650335, 'recall': 0.70212466, 'specificity': 0.70212466, 'f1': 0.65381825, 'auroc': 0.8386003, 'binary_precision': 0.27307326, 'binary_recall': 0.44634527, 'binary_specificity': 0.95790404, 'binary_f1_score': 0.338843}
confusion matrix:
       0    1
0  17385  764
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.7721103, 'recall': 0.82740796, 'specificity': 0.82740796, 'f1': 0.79684657, 'auroc': 0.91632485, 'binary_precision': 0.5583596, 'binary_recall': 0.6781609, 'binary_specificity': 0.976655, 'binary_f1_score': 0.61245674}
confusion matrix:
      0    1
0  5857  140
1    84  177
early stop counter: 1
val acc:0.9404001832008362, best validation acc: 0.9434865713119507, corresponding to test acc:                         0.9669223427772522 / 0.9669223427772522
after epoch: 8,now: 2024-08-02 07:39:28.789239,epoch time: 0:18:43.466630,used: 2:29:51.560210,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95622385, 'precision': 0.95697343, 'recall': 0.9562416, 'specificity': 0.9562416, 'f1': 0.95620704, 'auroc': 0.9910732, 'binary_precision': 0.975701, 'binary_recall': 0.93583, 'binary_specificity': 0.9766533, 'binary_f1_score': 0.9553497}
confusion matrix:
       0      1
0  27986    669
1   1842  26863
---- Validation: 
scalar performance:
{'acc': 0.945828, 'precision': 0.6342899, 'recall': 0.68393314, 'specificity': 0.68393314, 'f1': 0.65449977, 'auroc': 0.83987236, 'binary_precision': 0.2900336, 'binary_recall': 0.40279937, 'binary_specificity': 0.96506697, 'binary_f1_score': 0.33723962}
confusion matrix:
       0    1
0  17515  634
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.78739923, 'recall': 0.8250773, 'specificity': 0.8250773, 'f1': 0.804923, 'auroc': 0.9162481, 'binary_precision': 0.5892256, 'binary_recall': 0.6704981, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.6272402}
confusion matrix:
      0    1
0  5875  122
1    86  175
better model found
persisted
after epoch: 9,now: 2024-08-02 07:58:07.587568,epoch time: 0:18:38.798329,used: 2:48:30.358539,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9551604, 'precision': 0.95637417, 'recall': 0.9551821, 'specificity': 0.9551821, 'f1': 0.955132, 'auroc': 0.9913497, 'binary_precision': 0.98012054, 'binary_recall': 0.9292433, 'binary_specificity': 0.9811209, 'binary_f1_score': 0.9540041}
confusion matrix:
       0      1
0  28115    541
1   2031  26673
---- Validation: 
scalar performance:
{'acc': 0.9484355, 'precision': 0.63878024, 'recall': 0.6740323, 'specificity': 0.6740323, 'f1': 0.6540564, 'auroc': 0.8344357, 'binary_precision': 0.2997543, 'binary_recall': 0.37947124, 'binary_specificity': 0.9685933, 'binary_f1_score': 0.33493477}
confusion matrix:
       0    1
0  17579  570
1    399  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8060567, 'recall': 0.8284104, 'specificity': 0.8284104, 'f1': 0.8167894, 'auroc': 0.9150367, 'binary_precision': 0.62633455, 'binary_recall': 0.6743295, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.6494465}
confusion matrix:
      0    1
0  5892  105
1    85  176
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-02 08:16:47.822303,epoch time: 0:18:40.234735,used: 3:07:10.593274,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9582113, 'precision': 0.9591743, 'recall': 0.9582282, 'specificity': 0.9582282, 'f1': 0.95819044, 'auroc': 0.99203527, 'binary_precision': 0.9803857, 'binary_recall': 0.9351939, 'binary_specificity': 0.98126245, 'binary_f1_score': 0.9572568}
confusion matrix:
       0      1
0  28122    537
1   1860  26841
---- Validation: 
scalar performance:
{'acc': 0.9431673, 'precision': 0.6345926, 'recall': 0.70655745, 'specificity': 0.70655745, 'f1': 0.6615031, 'auroc': 0.8426194, 'binary_precision': 0.28897715, 'binary_recall': 0.4525661, 'binary_specificity': 0.9605488, 'binary_f1_score': 0.35272726}
confusion matrix:
       0    1
0  17433  716
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7540814, 'recall': 0.8365677, 'specificity': 0.8365677, 'f1': 0.788687, 'auroc': 0.9150495, 'binary_precision': 0.52136755, 'binary_recall': 0.7011494, 'binary_specificity': 0.971986, 'binary_f1_score': 0.5980392}
confusion matrix:
      0    1
0  5829  168
1    78  183
early stop counter: 1
val acc:0.9431673288345337, best validation acc: 0.9484354853630066, corresponding to test acc:                         0.9696388840675354 / 0.9696388840675354
after epoch: 11,now: 2024-08-02 08:35:30.123472,epoch time: 0:18:42.301169,used: 3:25:52.894443,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96033823, 'precision': 0.9610741, 'recall': 0.96035224, 'specificity': 0.96035224, 'f1': 0.9603232, 'auroc': 0.9924178, 'binary_precision': 0.97966963, 'binary_recall': 0.9402439, 'binary_specificity': 0.9804606, 'binary_f1_score': 0.95955193}
confusion matrix:
       0      1
0  28100    560
1   1715  26985
---- Validation: 
scalar performance:
{'acc': 0.9411984, 'precision': 0.6320324, 'recall': 0.71378875, 'specificity': 0.71378875, 'f1': 0.6613108, 'auroc': 0.8444738, 'binary_precision': 0.28330207, 'binary_recall': 0.4696734, 'binary_specificity': 0.95790404, 'binary_f1_score': 0.35342306}
confusion matrix:
       0    1
0  17385  764
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.74115884, 'recall': 0.8441453, 'specificity': 0.8441453, 'f1': 0.7821339, 'auroc': 0.9145218, 'binary_precision': 0.49473685, 'binary_recall': 0.7203065, 'binary_specificity': 0.967984, 'binary_f1_score': 0.5865835}
confusion matrix:
      0    1
0  5805  192
1    73  188
early stop counter: 2
val acc:0.9411984086036682, best validation acc: 0.9484354853630066, corresponding to test acc:                         0.9696388840675354 / 0.9696388840675354
after epoch: 12,now: 2024-08-02 08:54:18.642625,epoch time: 0:18:48.519153,used: 3:44:41.413596,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96204674, 'precision': 0.9626954, 'recall': 0.96206254, 'specificity': 0.96206254, 'f1': 0.96203434, 'auroc': 0.9933251, 'binary_precision': 0.980231, 'binary_recall': 0.94317865, 'binary_specificity': 0.9809464, 'binary_f1_score': 0.96134794}
confusion matrix:
       0      1
0  28110    546
1   1631  27073
---- Validation: 
scalar performance:
{'acc': 0.94290125, 'precision': 0.6336386, 'recall': 0.70566964, 'specificity': 0.70566964, 'f1': 0.6605072, 'auroc': 0.8459466, 'binary_precision': 0.28712872, 'binary_recall': 0.45101088, 'binary_specificity': 0.9603284, 'binary_f1_score': 0.35087717}
confusion matrix:
       0    1
0  17429  720
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.75711226, 'recall': 0.84423053, 'specificity': 0.84423053, 'f1': 0.7934034, 'auroc': 0.9154585, 'binary_precision': 0.5267606, 'binary_recall': 0.71647507, 'binary_specificity': 0.971986, 'binary_f1_score': 0.6071429}
confusion matrix:
      0    1
0  5829  168
1    74  187
early stop counter: 3
val acc:0.9429012537002563, best validation acc: 0.9484354853630066, corresponding to test acc:                         0.9696388840675354 / 0.9696388840675354
after epoch: 13,now: 2024-08-02 09:12:50.002614,epoch time: 0:18:31.359989,used: 4:03:12.773585,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96495813, 'precision': 0.96542144, 'recall': 0.9649715, 'specificity': 0.9649715, 'f1': 0.96495014, 'auroc': 0.9937854, 'binary_precision': 0.98031527, 'binary_recall': 0.9490315, 'binary_specificity': 0.9809115, 'binary_f1_score': 0.9644197}
confusion matrix:
       0      1
0  28109    547
1   1463  27241
---- Validation: 
scalar performance:
{'acc': 0.94061303, 'precision': 0.6301161, 'recall': 0.7119856, 'specificity': 0.7119856, 'f1': 0.65926814, 'auroc': 0.8453922, 'binary_precision': 0.27958992, 'binary_recall': 0.466563, 'binary_specificity': 0.95740813, 'binary_f1_score': 0.34965038}
confusion matrix:
       0    1
0  17376  773
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.74791604, 'recall': 0.8468113, 'specificity': 0.8468113, 'f1': 0.7878486, 'auroc': 0.91546226, 'binary_precision': 0.5080645, 'binary_recall': 0.7241379, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.5971564}
confusion matrix:
      0    1
0  5814  183
1    72  189
early stop counter: 4
val acc:0.9406130313873291, best validation acc: 0.9484354853630066, corresponding to test acc:                         0.9696388840675354 / 0.9696388840675354
after epoch: 14,now: 2024-08-02 09:31:57.347247,epoch time: 0:19:07.344633,used: 4:22:20.118218,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9649756, 'precision': 0.9654803, 'recall': 0.9649913, 'specificity': 0.9649913, 'f1': 0.9649669, 'auroc': 0.99368393, 'binary_precision': 0.98104507, 'binary_recall': 0.9483401, 'binary_specificity': 0.9816424, 'binary_f1_score': 0.9644154}
confusion matrix:
       0      1
0  28127    526
1   1483  27224
---- Validation: 
scalar performance:
{'acc': 0.9393891, 'precision': 0.62946934, 'recall': 0.71885246, 'specificity': 0.71885246, 'f1': 0.6603398, 'auroc': 0.8466928, 'binary_precision': 0.2777778, 'binary_recall': 0.4821151, 'binary_specificity': 0.95558983, 'binary_f1_score': 0.352473}
confusion matrix:
       0    1
0  17343  806
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.73418796, 'recall': 0.8432281, 'specificity': 0.8432281, 'f1': 0.7767117, 'auroc': 0.9149102, 'binary_precision': 0.48081842, 'binary_recall': 0.7203065, 'binary_specificity': 0.96614975, 'binary_f1_score': 0.5766871}
confusion matrix:
      0    1
0  5794  203
1    73  188
early stop counter: 5
val acc:0.9393891096115112, best validation acc: 0.9484354853630066, corresponding to test acc:                         0.9696388840675354 / 0.9696388840675354
after epoch: 15,now: 2024-08-02 09:50:37.786511,epoch time: 0:18:40.439264,used: 4:41:00.557482,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_09_36_seed_0_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:41:00.557482 at 2024-08-02 09:50:37.786511
persisted model performance metric: 

scalar performance:
{'acc': 0.9696389, 'precision': 0.8060567, 'recall': 0.8284104, 'specificity': 0.8284104, 'f1': 0.8167894, 'auroc': 0.9150367, 'binary_precision': 0.62633455, 'binary_recall': 0.6743295, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.6494465}
confusion matrix:
      0    1
0  5892  105
1    85  176
oracle model performance metric: 

scalar performance:
{'acc': 0.9696389, 'precision': 0.8060567, 'recall': 0.8284104, 'specificity': 0.8284104, 'f1': 0.8167894, 'auroc': 0.9150367, 'binary_precision': 0.62633455, 'binary_recall': 0.6743295, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.6494465}
confusion matrix:
      0    1
0  5892  105
1    85  176
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    836 MiB |   8471 MiB | 359920 GiB | 359920 GiB |
|       from large pool |    799 MiB |   8429 MiB | 354164 GiB | 354163 GiB |
|       from small pool |     36 MiB |     76 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    836 MiB |   8471 MiB | 359920 GiB | 359920 GiB |
|       from large pool |    799 MiB |   8429 MiB | 354164 GiB | 354163 GiB |
|       from small pool |     36 MiB |     76 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    832 MiB |   8468 MiB | 359903 GiB | 359902 GiB |
|       from large pool |    796 MiB |   8426 MiB | 354159 GiB | 354159 GiB |
|       from small pool |     35 MiB |     75 MiB |   5743 GiB |   5743 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9434 MiB |   9434 MiB |   9434 MiB |      0 B   |
|       from large pool |   9350 MiB |   9350 MiB |   9350 MiB |      0 B   |
|       from small pool |     84 MiB |     84 MiB |     84 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  67011 KiB |    769 MiB | 194427 GiB | 194427 GiB |
|       from large pool |  59734 KiB |    767 MiB | 188668 GiB | 188668 GiB |
|       from small pool |   7277 KiB |     13 MiB |   5758 GiB |   5758 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3472    |    8159    |   71321 K  |   71317 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37875 K  |   37871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3472    |    8159    |   71321 K  |   71317 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37875 K  |   37871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     406    |     406    |     406    |       0    |
|       from large pool |     364    |     364    |     364    |       0    |
|       from small pool |      42    |      42    |      42    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    3617    |   38317 K  |   38317 K  |
|       from large pool |      19    |     356    |   21948 K  |   21948 K  |
|       from small pool |      50    |    3599    |   16368 K  |   16368 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8471 MiB | 359920 GiB | 359920 GiB |
|       from large pool |  16640 KiB |   8429 MiB | 354164 GiB | 354164 GiB |
|       from small pool |      0 KiB |     76 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8471 MiB | 359920 GiB | 359920 GiB |
|       from large pool |  16640 KiB |   8429 MiB | 354164 GiB | 354164 GiB |
|       from small pool |      0 KiB |     76 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8468 MiB | 359903 GiB | 359903 GiB |
|       from large pool |  16640 KiB |   8426 MiB | 354159 GiB | 354159 GiB |
|       from small pool |      0 KiB |     75 MiB |   5743 GiB |   5743 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |   9434 MiB |   9434 MiB |   8532 MiB |
|       from large pool |    858 MiB |   9350 MiB |   9350 MiB |   8492 MiB |
|       from small pool |     44 MiB |     84 MiB |     84 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    769 MiB | 194427 GiB | 194427 GiB |
|       from large pool |  30464 KiB |    767 MiB | 188668 GiB | 188668 GiB |
|       from small pool |      0 KiB |     24 MiB |   5758 GiB |   5758 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71321 K  |   71320 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37875 K  |   37875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71321 K  |   71320 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37875 K  |   37875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     406    |     406    |     357    |
|       from large pool |      27    |     364    |     364    |     337    |
|       from small pool |      22    |      42    |      42    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3617    |   38318 K  |   38318 K  |
|       from large pool |       2    |     356    |   21948 K  |   21948 K  |
|       from small pool |       0    |    3599    |   16369 K  |   16369 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8471 MiB | 359920 GiB | 359920 GiB |
|       from large pool |  16640 KiB |   8429 MiB | 354164 GiB | 354164 GiB |
|       from small pool |      0 KiB |     76 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8471 MiB | 359920 GiB | 359920 GiB |
|       from large pool |  16640 KiB |   8429 MiB | 354164 GiB | 354164 GiB |
|       from small pool |      0 KiB |     76 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8468 MiB | 359903 GiB | 359903 GiB |
|       from large pool |  16640 KiB |   8426 MiB | 354159 GiB | 354159 GiB |
|       from small pool |      0 KiB |     75 MiB |   5743 GiB |   5743 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |   9434 MiB |   9434 MiB |   8532 MiB |
|       from large pool |    858 MiB |   9350 MiB |   9350 MiB |   8492 MiB |
|       from small pool |     44 MiB |     84 MiB |     84 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    769 MiB | 194427 GiB | 194427 GiB |
|       from large pool |  30464 KiB |    767 MiB | 188668 GiB | 188668 GiB |
|       from small pool |      0 KiB |     24 MiB |   5758 GiB |   5758 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71321 K  |   71320 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37875 K  |   37875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71321 K  |   71320 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37875 K  |   37875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     406    |     406    |     357    |
|       from large pool |      27    |     364    |     364    |     337    |
|       from small pool |      22    |      42    |      42    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3617    |   38318 K  |   38318 K  |
|       from large pool |       2    |     356    |   21948 K  |   21948 K  |
|       from small pool |       0    |    3599    |   16369 K  |   16369 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998

 Experiment start at: 2024-08-02 09:59:00.896721
before training, model accuracy: 0.7446020245552063
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86817896, 'precision': 0.87260497, 'recall': 0.8682206, 'specificity': 0.8682206, 'f1': 0.8677955, 'auroc': 0.9439002, 'binary_precision': 0.9134058, 'binary_recall': 0.81370103, 'binary_specificity': 0.9227402, 'binary_f1_score': 0.86067545}
confusion matrix:
       0      1
0  26562   2224
1   5371  23459
---- Validation: 
scalar performance:
{'acc': 0.91254, 'precision': 0.494516, 'recall': 0.49186313, 'specificity': 0.49186313, 'f1': 0.49247742, 'auroc': 0.66995215, 'binary_precision': 0.025540275, 'binary_recall': 0.038632985, 'binary_specificity': 0.9450933, 'binary_f1_score': 0.030751035}
confusion matrix:
       0    1
0  17075  992
1    647   26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93457943, 'precision': 0.52470493, 'recall': 0.51714665, 'specificity': 0.51714665, 'f1': 0.51957625, 'auroc': 0.7810209, 'binary_precision': 0.08988764, 'binary_recall': 0.06153846, 'binary_specificity': 0.9727548, 'binary_f1_score': 0.07305936}
confusion matrix:
      0    1
0  5784  162
1   244   16
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 10:19:17.915779,epoch time: 0:20:17.019058,used: 0:20:17.019058,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9111879, 'precision': 0.9139619, 'recall': 0.9112192, 'specificity': 0.9112192, 'f1': 0.9110433, 'auroc': 0.970353, 'binary_precision': 0.94804066, 'binary_recall': 0.8702046, 'binary_specificity': 0.95223373, 'binary_f1_score': 0.90745664}
confusion matrix:
       0      1
0  27411   1375
1   3742  25088
---- Validation: 
scalar performance:
{'acc': 0.94338316, 'precision': 0.5097946, 'recall': 0.5064286, 'specificity': 0.5064286, 'f1': 0.5070553, 'auroc': 0.76484156, 'binary_precision': 0.055045873, 'binary_recall': 0.035661217, 'binary_specificity': 0.977196, 'binary_f1_score': 0.043282233}
confusion matrix:
       0    1
0  17655  412
1    649   24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95149857, 'precision': 0.62967783, 'recall': 0.55172193, 'specificity': 0.55172193, 'f1': 0.5706139, 'auroc': 0.8650347, 'binary_precision': 0.2970297, 'binary_recall': 0.115384616, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.16620499}
confusion matrix:
      0   1
0  5875  71
1   230  30
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 10:38:30.580500,epoch time: 0:19:12.664721,used: 0:39:29.683779,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92732924, 'precision': 0.9302614, 'recall': 0.92735934, 'specificity': 0.92735934, 'f1': 0.92720866, 'auroc': 0.9778842, 'binary_precision': 0.96596324, 'binary_recall': 0.8859829, 'binary_specificity': 0.9687359, 'binary_f1_score': 0.924246}
confusion matrix:
       0      1
0  27887    900
1   3287  25542
---- Validation: 
scalar performance:
{'acc': 0.94909286, 'precision': 0.53927845, 'recall': 0.52154934, 'specificity': 0.52154934, 'f1': 0.5264867, 'auroc': 0.80436265, 'binary_precision': 0.11294766, 'binary_recall': 0.060921248, 'binary_specificity': 0.98217744, 'binary_f1_score': 0.07915058}
confusion matrix:
       0    1
0  17745  322
1    632   41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.7738996, 'recall': 0.64520687, 'specificity': 0.64520687, 'f1': 0.6875241, 'auroc': 0.8976623, 'binary_precision': 0.5777778, 'binary_recall': 0.3, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.3949367}
confusion matrix:
      0   1
0  5889  57
1   182  78
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 10:58:56.090154,epoch time: 0:20:25.509654,used: 0:59:55.193433,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93743056, 'precision': 0.9391479, 'recall': 0.9374545, 'specificity': 0.9374545, 'f1': 0.9373717, 'auroc': 0.98251987, 'binary_precision': 0.96680117, 'binary_recall': 0.90607005, 'binary_specificity': 0.968839, 'binary_f1_score': 0.935451}
confusion matrix:
       0      1
0  27889    897
1   2708  26122
---- Validation: 
scalar performance:
{'acc': 0.9480256, 'precision': 0.5828321, 'recall': 0.5617661, 'specificity': 0.5617661, 'f1': 0.5703484, 'auroc': 0.8348236, 'binary_precision': 0.1971831, 'binary_recall': 0.14561664, 'binary_specificity': 0.9779155, 'binary_f1_score': 0.16752137}
confusion matrix:
       0    1
0  17668  399
1    575   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.80833924, 'recall': 0.75690246, 'specificity': 0.75690246, 'f1': 0.7800019, 'auroc': 0.9116012, 'binary_precision': 0.6372093, 'binary_recall': 0.52692306, 'binary_specificity': 0.9868819, 'binary_f1_score': 0.57684207}
confusion matrix:
      0    1
0  5868   78
1   123  137
new oracle model saved
early stop counter: 1
val acc:0.9480255842208862, best validation acc: 0.9490928649902344, corresponding to test acc:                         0.9614889025688171 / 0.9676119685173035
after epoch: 4,now: 2024-08-02 11:18:49.060349,epoch time: 0:19:52.970195,used: 1:19:48.163628,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94227296, 'precision': 0.94429266, 'recall': 0.9422988, 'specificity': 0.9422988, 'f1': 0.9422096, 'auroc': 0.9860054, 'binary_precision': 0.97444004, 'binary_recall': 0.9084634, 'binary_specificity': 0.97613424, 'binary_f1_score': 0.9402958}
confusion matrix:
       0      1
0  28099    687
1   2639  26191
---- Validation: 
scalar performance:
{'acc': 0.95533615, 'precision': 0.6170877, 'recall': 0.5619812, 'specificity': 0.5619812, 'f1': 0.5794298, 'auroc': 0.8487971, 'binary_precision': 0.2657143, 'binary_recall': 0.13818721, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.18181817}
confusion matrix:
       0    1
0  17810  257
1    580   93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.84129846, 'recall': 0.7510602, 'specificity': 0.7510602, 'f1': 0.7885653, 'auroc': 0.91516584, 'binary_precision': 0.7037037, 'binary_recall': 0.51153845, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.5924276}
confusion matrix:
      0    1
0  5890   56
1   127  133
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-02 11:39:01.482618,epoch time: 0:20:12.422269,used: 1:40:00.585897,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9472369, 'precision': 0.94837767, 'recall': 0.9472545, 'specificity': 0.9472545, 'f1': 0.9472047, 'auroc': 0.9865746, 'binary_precision': 0.9711686, 'binary_recall': 0.9219162, 'binary_specificity': 0.9725928, 'binary_f1_score': 0.9459017}
confusion matrix:
       0      1
0  27999    789
1   2251  26577
---- Validation: 
scalar performance:
{'acc': 0.94935966, 'precision': 0.62526906, 'recall': 0.616103, 'specificity': 0.616103, 'f1': 0.62047756, 'auroc': 0.8607445, 'binary_precision': 0.27813506, 'binary_recall': 0.25705793, 'binary_specificity': 0.9751481, 'binary_f1_score': 0.26718146}
confusion matrix:
       0    1
0  17618  449
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.8016713, 'recall': 0.7994515, 'specificity': 0.7994515, 'f1': 0.8005568, 'auroc': 0.9195801, 'binary_precision': 0.62015504, 'binary_recall': 0.61538464, 'binary_specificity': 0.9835183, 'binary_f1_score': 0.6177606}
confusion matrix:
      0    1
0  5848   98
1   100  160
early stop counter: 1
val acc:0.949359655380249, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 6,now: 2024-08-02 11:58:47.483308,epoch time: 0:19:46.000690,used: 1:59:46.586587,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9528256, 'precision': 0.9531686, 'recall': 0.95283574, 'specificity': 0.95283574, 'f1': 0.95281744, 'auroc': 0.9886216, 'binary_precision': 0.9658187, 'binary_recall': 0.93895036, 'binary_specificity': 0.9667211, 'binary_f1_score': 0.95219505}
confusion matrix:
       0      1
0  27829    958
1   1760  27069
---- Validation: 
scalar performance:
{'acc': 0.93484527, 'precision': 0.6164508, 'recall': 0.6886854, 'specificity': 0.6886854, 'f1': 0.64202285, 'auroc': 0.8583937, 'binary_precision': 0.2549195, 'binary_recall': 0.42347696, 'binary_specificity': 0.95389384, 'binary_f1_score': 0.31825796}
confusion matrix:
       0    1
0  17234  833
1    388  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.72799575, 'recall': 0.8345164, 'specificity': 0.8345164, 'f1': 0.7694657, 'auroc': 0.9209385, 'binary_precision': 0.46923077, 'binary_recall': 0.70384616, 'binary_specificity': 0.96518666, 'binary_f1_score': 0.5630769}
confusion matrix:
      0    1
0  5739  207
1    77  183
early stop counter: 2
val acc:0.9348452687263489, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 7,now: 2024-08-02 12:18:07.044691,epoch time: 0:19:19.561383,used: 2:19:06.147970,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9550125, 'precision': 0.9556434, 'recall': 0.9550268, 'specificity': 0.9550268, 'f1': 0.9549979, 'auroc': 0.9904052, 'binary_precision': 0.97279084, 'binary_recall': 0.9362816, 'binary_specificity': 0.973772, 'binary_f1_score': 0.95418715}
confusion matrix:
       0      1
0  28031    755
1   1837  26993
---- Validation: 
scalar performance:
{'acc': 0.94151545, 'precision': 0.6241051, 'recall': 0.66854095, 'specificity': 0.66854095, 'f1': 0.6422269, 'auroc': 0.85895157, 'binary_precision': 0.27184466, 'binary_recall': 0.3744428, 'binary_specificity': 0.9626391, 'binary_f1_score': 0.315}
confusion matrix:
       0    1
0  17392  675
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7460388, 'recall': 0.83319294, 'specificity': 0.83319294, 'f1': 0.78202724, 'auroc': 0.92178965, 'binary_precision': 0.50558656, 'binary_recall': 0.6961538, 'binary_specificity': 0.97023207, 'binary_f1_score': 0.5857605}
confusion matrix:
      0    1
0  5769  177
1    79  181
early stop counter: 3
val acc:0.9415154457092285, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 8,now: 2024-08-02 12:37:08.250073,epoch time: 0:19:01.205382,used: 2:38:07.353352,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95681757, 'precision': 0.9576142, 'recall': 0.9568336, 'specificity': 0.9568336, 'f1': 0.9567998, 'auroc': 0.9909179, 'binary_precision': 0.97689915, 'binary_recall': 0.9358307, 'binary_specificity': 0.97783643, 'binary_f1_score': 0.95592403}
confusion matrix:
       0      1
0  28148    638
1   1850  26980
---- Validation: 
scalar performance:
{'acc': 0.9437567, 'precision': 0.6308528, 'recall': 0.67041856, 'specificity': 0.67041856, 'f1': 0.647508, 'auroc': 0.8595867, 'binary_precision': 0.2852311, 'binary_recall': 0.37592867, 'binary_specificity': 0.9649084, 'binary_f1_score': 0.32435897}
confusion matrix:
       0    1
0  17433  634
1    420  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.7322195, 'recall': 0.8259942, 'specificity': 0.8259942, 'f1': 0.76993084, 'auroc': 0.9194404, 'binary_precision': 0.4784946, 'binary_recall': 0.6846154, 'binary_specificity': 0.967373, 'binary_f1_score': 0.56329113}
confusion matrix:
      0    1
0  5752  194
1    82  178
early stop counter: 4
val acc:0.9437566995620728, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 9,now: 2024-08-02 12:57:38.494719,epoch time: 0:20:30.244646,used: 2:58:37.597998,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9602194, 'precision': 0.9606749, 'recall': 0.96023154, 'specificity': 0.96023154, 'f1': 0.96021026, 'auroc': 0.9917482, 'binary_precision': 0.9753529, 'binary_recall': 0.94436353, 'binary_specificity': 0.9760995, 'binary_f1_score': 0.9596081}
confusion matrix:
       0      1
0  28098    688
1   1604  27226
---- Validation: 
scalar performance:
{'acc': 0.92566705, 'precision': 0.61575204, 'recall': 0.73685515, 'specificity': 0.73685515, 'f1': 0.6503692, 'auroc': 0.8632959, 'binary_precision': 0.2496523, 'binary_recall': 0.53343236, 'binary_specificity': 0.9402779, 'binary_f1_score': 0.34012318}
confusion matrix:
       0     1
0  16988  1079
1    314   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9349017, 'precision': 0.6778621, 'recall': 0.85201037, 'specificity': 0.85201037, 'f1': 0.7301042, 'auroc': 0.9208951, 'binary_precision': 0.36666667, 'binary_recall': 0.76153845, 'binary_specificity': 0.94248235, 'binary_f1_score': 0.49500003}
confusion matrix:
      0    1
0  5604  342
1    62  198
early stop counter: 5
val acc:0.9256670475006104, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 10,now: 2024-08-02 13:18:02.470256,epoch time: 0:20:23.975537,used: 3:19:01.573535,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9617294, 'precision': 0.9619988, 'recall': 0.9617379, 'specificity': 0.9617379, 'f1': 0.9617243, 'auroc': 0.99282455, 'binary_precision': 0.97333145, 'binary_recall': 0.9495282, 'binary_specificity': 0.97394747, 'binary_f1_score': 0.9612825}
confusion matrix:
       0      1
0  28038    750
1   1455  27373
---- Validation: 
scalar performance:
{'acc': 0.9208111, 'precision': 0.61393565, 'recall': 0.75507945, 'specificity': 0.75507945, 'f1': 0.65061384, 'auroc': 0.8629427, 'binary_precision': 0.24448645, 'binary_recall': 0.576523, 'binary_specificity': 0.9336359, 'binary_f1_score': 0.34336284}
confusion matrix:
       0     1
0  16868  1199
1    285   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9282952, 'precision': 0.6666671, 'recall': 0.8577576, 'specificity': 0.8577576, 'f1': 0.7192972, 'auroc': 0.9197676, 'binary_precision': 0.34348562, 'binary_recall': 0.7807692, 'binary_specificity': 0.934746, 'binary_f1_score': 0.47708577}
confusion matrix:
      0    1
0  5558  388
1    57  203
early stop counter: 6
val acc:0.920811116695404, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 11,now: 2024-08-02 13:40:40.614999,epoch time: 0:22:38.144743,used: 3:41:39.718278,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9629617, 'precision': 0.9630895, 'recall': 0.9629675, 'specificity': 0.9629675, 'f1': 0.9629594, 'auroc': 0.99333966, 'binary_precision': 0.9709598, 'binary_recall': 0.9545234, 'binary_specificity': 0.9714117, 'binary_f1_score': 0.9626714}
confusion matrix:
       0      1
0  27965    823
1   1311  27517
---- Validation: 
scalar performance:
{'acc': 0.9058698, 'precision': 0.60016996, 'recall': 0.76592743, 'specificity': 0.76592743, 'f1': 0.6344413, 'auroc': 0.86131644, 'binary_precision': 0.21573736, 'binary_recall': 0.615156, 'binary_specificity': 0.91669893, 'binary_f1_score': 0.31944445}
confusion matrix:
       0     1
0  16562  1505
1    259   414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90654206, 'precision': 0.6369354, 'recall': 0.8574394, 'specificity': 0.8574394, 'f1': 0.68401146, 'auroc': 0.91970944, 'binary_precision': 0.28319782, 'binary_recall': 0.8038462, 'binary_specificity': 0.9110326, 'binary_f1_score': 0.41883767}
confusion matrix:
      0    1
0  5417  529
1    51  209
early stop counter: 7
val acc:0.9058697819709778, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 12,now: 2024-08-02 14:04:19.435588,epoch time: 0:23:38.820589,used: 4:05:18.538867,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.964003, 'precision': 0.96441483, 'recall': 0.96401453, 'specificity': 0.96401453, 'f1': 0.9639957, 'auroc': 0.99334264, 'binary_precision': 0.97843504, 'binary_recall': 0.94897676, 'binary_specificity': 0.9790523, 'binary_f1_score': 0.9634808}
confusion matrix:
       0      1
0  28183    603
1   1471  27359
---- Validation: 
scalar performance:
{'acc': 0.92491996, 'precision': 0.6165373, 'recall': 0.74362034, 'specificity': 0.74362034, 'f1': 0.65211856, 'auroc': 0.8651503, 'binary_precision': 0.25067934, 'binary_recall': 0.5482912, 'binary_specificity': 0.93894947, 'binary_f1_score': 0.34405595}
confusion matrix:
       0     1
0  16964  1103
1    304   369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92620045, 'precision': 0.66114277, 'recall': 0.84746957, 'specificity': 0.84746957, 'f1': 0.712037, 'auroc': 0.9178499, 'binary_precision': 0.33333334, 'binary_recall': 0.76153845, 'binary_specificity': 0.93340063, 'binary_f1_score': 0.46370026}
confusion matrix:
      0    1
0  5550  396
1    62  198
early stop counter: 8
val acc:0.9249199628829956, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 13,now: 2024-08-02 14:23:53.911255,epoch time: 0:19:34.475667,used: 4:24:53.014534,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9641419, 'precision': 0.9646222, 'recall': 0.96415377, 'specificity': 0.96415377, 'f1': 0.96413326, 'auroc': 0.9938278, 'binary_precision': 0.979744, 'binary_recall': 0.9479344, 'binary_specificity': 0.9803731, 'binary_f1_score': 0.9635768}
confusion matrix:
       0      1
0  28222    565
1   1501  27328
---- Validation: 
scalar performance:
{'acc': 0.91499466, 'precision': 0.60677624, 'recall': 0.75492394, 'specificity': 0.75492394, 'f1': 0.64222336, 'auroc': 0.86429906, 'binary_precision': 0.23004694, 'binary_recall': 0.58246654, 'binary_specificity': 0.9273814, 'binary_f1_score': 0.32982752}
confusion matrix:
       0     1
0  16755  1312
1    281   392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9129874, 'precision': 0.64432776, 'recall': 0.85712504, 'specificity': 0.85712504, 'f1': 0.6934168, 'auroc': 0.9205283, 'binary_precision': 0.29827088, 'binary_recall': 0.79615384, 'binary_specificity': 0.9180962, 'binary_f1_score': 0.43396226}
confusion matrix:
      0    1
0  5459  487
1    53  207
early stop counter: 9
val acc:0.9149946570396423, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 14,now: 2024-08-02 14:46:31.596423,epoch time: 0:22:37.685168,used: 4:47:30.699702,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96653706, 'precision': 0.96685874, 'recall': 0.9665468, 'specificity': 0.9665468, 'f1': 0.96653175, 'auroc': 0.9942939, 'binary_precision': 0.97929657, 'binary_recall': 0.9532762, 'binary_specificity': 0.9798173, 'binary_f1_score': 0.9661112}
confusion matrix:
       0      1
0  28206    581
1   1347  27482
---- Validation: 
scalar performance:
{'acc': 0.9141942, 'precision': 0.6042607, 'recall': 0.7487867, 'specificity': 0.7487867, 'f1': 0.6387128, 'auroc': 0.86180675, 'binary_precision': 0.22548445, 'binary_recall': 0.57057947, 'binary_specificity': 0.92699397, 'binary_f1_score': 0.32323232}
confusion matrix:
       0     1
0  16748  1319
1    289   384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9087979, 'precision': 0.63891953, 'recall': 0.8549387, 'specificity': 0.8549387, 'f1': 0.68646944, 'auroc': 0.9196849, 'binary_precision': 0.2875, 'binary_recall': 0.79615384, 'binary_specificity': 0.9137235, 'binary_f1_score': 0.42244896}
confusion matrix:
      0    1
0  5433  513
1    53  207
early stop counter: 10
val acc:0.9141942262649536, best validation acc: 0.9553361535072327, corresponding to test acc:                         0.9705123901367188 / 0.9705123901367188
after epoch: 15,now: 2024-08-02 15:06:54.798451,epoch time: 0:20:23.202028,used: 5:07:53.901730,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_09_59_00_seed_1_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:07:53.901730 at 2024-08-02 15:06:54.798451
persisted model performance metric: 

scalar performance:
{'acc': 0.9705124, 'precision': 0.84129846, 'recall': 0.7510602, 'specificity': 0.7510602, 'f1': 0.7885653, 'auroc': 0.91516584, 'binary_precision': 0.7037037, 'binary_recall': 0.51153845, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.5924276}
confusion matrix:
      0    1
0  5890   56
1   127  133
oracle model performance metric: 

scalar performance:
{'acc': 0.9705124, 'precision': 0.84129846, 'recall': 0.7510602, 'specificity': 0.7510602, 'f1': 0.7885653, 'auroc': 0.91516584, 'binary_precision': 0.7037037, 'binary_recall': 0.51153845, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.5924276}
confusion matrix:
      0    1
0  5890   56
1   127  133
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    838 MiB |   8473 MiB | 724888 GiB | 724887 GiB |
|       from large pool |    801 MiB |   8430 MiB | 713326 GiB | 713325 GiB |
|       from small pool |     36 MiB |     76 MiB |  11561 GiB |  11561 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    838 MiB |   8473 MiB | 724888 GiB | 724887 GiB |
|       from large pool |    801 MiB |   8430 MiB | 713326 GiB | 713325 GiB |
|       from small pool |     36 MiB |     76 MiB |  11561 GiB |  11561 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    832 MiB |   8468 MiB | 724802 GiB | 724801 GiB |
|       from large pool |    796 MiB |   8426 MiB | 713265 GiB | 713264 GiB |
|       from small pool |     35 MiB |     75 MiB |  11536 GiB |  11536 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9436 MiB |   9436 MiB |  17968 MiB |   8532 MiB |
|       from large pool |   9356 MiB |   9356 MiB |  17848 MiB |   8492 MiB |
|       from small pool |     80 MiB |     84 MiB |    120 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  49134 KiB |    776 MiB | 392936 GiB | 392936 GiB |
|       from large pool |  37749 KiB |    775 MiB | 381370 GiB | 381370 GiB |
|       from small pool |  11385 KiB |     24 MiB |  11566 GiB |  11566 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3448    |    8191    |  143284 K  |  143281 K  |
|       from large pool |     161    |     844    |   67339 K  |   67339 K  |
|       from small pool |    3287    |    8028    |   75945 K  |   75941 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3448    |    8191    |  143284 K  |  143281 K  |
|       from large pool |     161    |     844    |   67339 K  |   67339 K  |
|       from small pool |    3287    |    8028    |   75945 K  |   75941 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     406    |     761    |     357    |
|       from large pool |     364    |     364    |     701    |     337    |
|       from small pool |      40    |      42    |      60    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3634    |   79315 K  |   79315 K  |
|       from large pool |      17    |     356    |   46553 K  |   46553 K  |
|       from small pool |      51    |    3618    |   32762 K  |   32762 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8473 MiB | 724888 GiB | 724888 GiB |
|       from large pool |  16640 KiB |   8430 MiB | 713326 GiB | 713326 GiB |
|       from small pool |      0 KiB |     76 MiB |  11561 GiB |  11561 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8473 MiB | 724888 GiB | 724888 GiB |
|       from large pool |  16640 KiB |   8430 MiB | 713326 GiB | 713326 GiB |
|       from small pool |      0 KiB |     76 MiB |  11561 GiB |  11561 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8468 MiB | 724802 GiB | 724802 GiB |
|       from large pool |  16640 KiB |   8426 MiB | 713265 GiB | 713265 GiB |
|       from small pool |      0 KiB |     75 MiB |  11536 GiB |  11536 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    886 MiB |   9436 MiB |  17968 MiB |  17082 MiB |
|       from large pool |    838 MiB |   9356 MiB |  17848 MiB |  17010 MiB |
|       from small pool |     48 MiB |     84 MiB |    120 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    776 MiB | 392936 GiB | 392936 GiB |
|       from large pool |  30464 KiB |    775 MiB | 381370 GiB | 381370 GiB |
|       from small pool |      0 KiB |     28 MiB |  11566 GiB |  11566 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143284 K  |  143284 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75945 K  |   75945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143284 K  |  143284 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75945 K  |   75945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     406    |     761    |     711    |
|       from large pool |      26    |     364    |     701    |     675    |
|       from small pool |      24    |      42    |      60    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3634    |   79317 K  |   79317 K  |
|       from large pool |       2    |     356    |   46553 K  |   46553 K  |
|       from small pool |       0    |    3618    |   32763 K  |   32763 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8473 MiB | 724888 GiB | 724888 GiB |
|       from large pool |  16640 KiB |   8430 MiB | 713326 GiB | 713326 GiB |
|       from small pool |      0 KiB |     76 MiB |  11561 GiB |  11561 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8473 MiB | 724888 GiB | 724888 GiB |
|       from large pool |  16640 KiB |   8430 MiB | 713326 GiB | 713326 GiB |
|       from small pool |      0 KiB |     76 MiB |  11561 GiB |  11561 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8468 MiB | 724802 GiB | 724802 GiB |
|       from large pool |  16640 KiB |   8426 MiB | 713265 GiB | 713265 GiB |
|       from small pool |      0 KiB |     75 MiB |  11536 GiB |  11536 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    886 MiB |   9436 MiB |  17968 MiB |  17082 MiB |
|       from large pool |    838 MiB |   9356 MiB |  17848 MiB |  17010 MiB |
|       from small pool |     48 MiB |     84 MiB |    120 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    776 MiB | 392936 GiB | 392936 GiB |
|       from large pool |  30464 KiB |    775 MiB | 381370 GiB | 381370 GiB |
|       from small pool |      0 KiB |     28 MiB |  11566 GiB |  11566 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143284 K  |  143284 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75945 K  |   75945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143284 K  |  143284 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75945 K  |   75945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     406    |     761    |     711    |
|       from large pool |      26    |     364    |     701    |     675    |
|       from small pool |      24    |      42    |      60    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3634    |   79317 K  |   79317 K  |
|       from large pool |       2    |     356    |   46553 K  |   46553 K  |
|       from small pool |       0    |    3618    |   32763 K  |   32763 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998

 Experiment start at: 2024-08-02 15:15:06.358239
before training, model accuracy: 0.1489020735025406
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88877267, 'precision': 0.88990426, 'recall': 0.8887791, 'specificity': 0.8887791, 'f1': 0.8886931, 'auroc': 0.95617735, 'binary_precision': 0.9109693, 'binary_recall': 0.86182654, 'binary_specificity': 0.91573167, 'binary_f1_score': 0.8857168}
confusion matrix:
       0      1
0  26689   2456
1   4029  25130
---- Validation: 
scalar performance:
{'acc': 0.7169339, 'precision': 0.5233705, 'recall': 0.65462196, 'specificity': 0.65462196, 'f1': 0.47449946, 'auroc': 0.7261881, 'binary_precision': 0.06531365, 'binary_recall': 0.5880399, 'binary_specificity': 0.7212041, 'binary_f1_score': 0.11756892}
confusion matrix:
       0     1
0  13105  5066
1    248   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7520436, 'precision': 0.54069614, 'recall': 0.71041685, 'specificity': 0.71041685, 'f1': 0.5132325, 'auroc': 0.7693509, 'binary_precision': 0.09895513, 'binary_recall': 0.6652893, 'binary_specificity': 0.7555444, 'binary_f1_score': 0.17228465}
confusion matrix:
      0     1
0  4531  1466
1    81   161
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 15:36:49.894886,epoch time: 0:21:43.536647,used: 0:21:43.536647,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9163694, 'precision': 0.9194174, 'recall': 0.9163796, 'specificity': 0.9163796, 'f1': 0.9162185, 'auroc': 0.97293794, 'binary_precision': 0.95523226, 'binary_recall': 0.8737268, 'binary_specificity': 0.9590324, 'binary_f1_score': 0.91266346}
confusion matrix:
       0      1
0  27951   1194
1   3682  25477
---- Validation: 
scalar performance:
{'acc': 0.85649604, 'precision': 0.5516357, 'recall': 0.7082448, 'specificity': 0.7082448, 'f1': 0.5592318, 'auroc': 0.8033091, 'binary_precision': 0.12018882, 'binary_recall': 0.5498339, 'binary_specificity': 0.86665565, 'binary_f1_score': 0.19725864}
confusion matrix:
       0     1
0  15748  2423
1    271   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8616766, 'precision': 0.57947016, 'recall': 0.7753763, 'specificity': 0.7753763, 'f1': 0.6000702, 'auroc': 0.8521857, 'binary_precision': 0.17350158, 'binary_recall': 0.6818182, 'binary_specificity': 0.86893445, 'binary_f1_score': 0.2766136}
confusion matrix:
      0    1
0  5211  786
1    77  165
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 15:56:59.071176,epoch time: 0:20:09.176290,used: 0:41:52.712937,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9349787, 'precision': 0.93689847, 'recall': 0.9349855, 'specificity': 0.9349855, 'f1': 0.9349079, 'auroc': 0.98152924, 'binary_precision': 0.96591115, 'binary_recall': 0.9018108, 'binary_specificity': 0.9681603, 'binary_f1_score': 0.932761}
confusion matrix:
       0      1
0  28218    928
1   2863  26295
---- Validation: 
scalar performance:
{'acc': 0.8855271, 'precision': 0.57152855, 'recall': 0.7441205, 'specificity': 0.7441205, 'f1': 0.59371376, 'auroc': 0.8404795, 'binary_precision': 0.15789473, 'binary_recall': 0.59302324, 'binary_specificity': 0.89521766, 'binary_f1_score': 0.24938875}
confusion matrix:
       0     1
0  16267  1904
1    245   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8889245, 'precision': 0.60783136, 'recall': 0.8311876, 'specificity': 0.8311876, 'f1': 0.64428777, 'auroc': 0.88696694, 'binary_precision': 0.22600242, 'binary_recall': 0.76859504, 'binary_specificity': 0.89378023, 'binary_f1_score': 0.34929577}
confusion matrix:
      0    1
0  5360  637
1    56  186
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 16:17:53.995446,epoch time: 0:20:54.924270,used: 1:02:47.637207,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94291985, 'precision': 0.94466925, 'recall': 0.9429285, 'specificity': 0.9429285, 'f1': 0.9428644, 'auroc': 0.9852241, 'binary_precision': 0.97262883, 'binary_recall': 0.9115226, 'binary_specificity': 0.97433436, 'binary_f1_score': 0.94108486}
confusion matrix:
       0      1
0  28396    748
1   2580  26580
---- Validation: 
scalar performance:
{'acc': 0.89351726, 'precision': 0.58122545, 'recall': 0.765915, 'specificity': 0.765915, 'f1': 0.60873795, 'auroc': 0.85700536, 'binary_precision': 0.17587008, 'binary_recall': 0.6295681, 'binary_specificity': 0.90226185, 'binary_f1_score': 0.27493656}
confusion matrix:
       0     1
0  16395  1776
1    223   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89501524, 'precision': 0.61627233, 'recall': 0.8482351, 'specificity': 0.8482351, 'f1': 0.65676355, 'auroc': 0.8999597, 'binary_precision': 0.24155194, 'binary_recall': 0.79752064, 'binary_specificity': 0.8989495, 'binary_f1_score': 0.37079734}
confusion matrix:
      0    1
0  5391  606
1    49  193
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 16:37:25.606771,epoch time: 0:19:31.611325,used: 1:22:19.248532,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94770515, 'precision': 0.9491629, 'recall': 0.94771004, 'specificity': 0.94771004, 'f1': 0.94766307, 'auroc': 0.9875761, 'binary_precision': 0.9747945, 'binary_recall': 0.91919607, 'binary_specificity': 0.97622395, 'binary_f1_score': 0.9461793}
confusion matrix:
       0      1
0  28454    693
1   2356  26801
---- Validation: 
scalar performance:
{'acc': 0.9137591, 'precision': 0.5971138, 'recall': 0.7635224, 'specificity': 0.7635224, 'f1': 0.6318009, 'auroc': 0.86445546, 'binary_precision': 0.20826162, 'binary_recall': 0.60299003, 'binary_specificity': 0.9240548, 'binary_f1_score': 0.3095949}
confusion matrix:
       0     1
0  16791  1380
1    239   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91713417, 'precision': 0.6383161, 'recall': 0.84387887, 'specificity': 0.84387887, 'f1': 0.6862664, 'auroc': 0.9057442, 'binary_precision': 0.2868217, 'binary_recall': 0.7644628, 'binary_specificity': 0.92329496, 'binary_f1_score': 0.4171364}
confusion matrix:
      0    1
0  5537  460
1    57  185
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-02 16:56:55.110715,epoch time: 0:19:29.503944,used: 1:41:48.752476,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9538282, 'precision': 0.95469415, 'recall': 0.9538312, 'specificity': 0.9538312, 'f1': 0.9538064, 'auroc': 0.9894526, 'binary_precision': 0.9745714, 'binary_recall': 0.9319866, 'binary_specificity': 0.9756759, 'binary_f1_score': 0.9528034}
confusion matrix:
       0      1
0  28439    709
1   1983  27173
---- Validation: 
scalar performance:
{'acc': 0.90656793, 'precision': 0.59806406, 'recall': 0.7967479, 'specificity': 0.7967479, 'f1': 0.63394445, 'auroc': 0.87144554, 'binary_precision': 0.20761421, 'binary_recall': 0.679402, 'binary_specificity': 0.9140939, 'binary_f1_score': 0.31804046}
confusion matrix:
       0     1
0  16610  1561
1    193   409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.905113, 'precision': 0.62624884, 'recall': 0.8515049, 'specificity': 0.8515049, 'f1': 0.67098665, 'auroc': 0.9086665, 'binary_precision': 0.26158038, 'binary_recall': 0.7933884, 'binary_specificity': 0.9096215, 'binary_f1_score': 0.39344263}
confusion matrix:
      0    1
0  5455  542
1    50  192
early stop counter: 1
val acc:0.9065679311752319, best validation acc: 0.9137591123580933, corresponding to test acc:                         0.917134165763855 / 0.917134165763855
after epoch: 6,now: 2024-08-02 17:16:37.347434,epoch time: 0:19:42.236719,used: 2:01:30.989195,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9568297, 'precision': 0.9577388, 'recall': 0.95683277, 'specificity': 0.95683277, 'f1': 0.95680845, 'auroc': 0.9909507, 'binary_precision': 0.97817266, 'binary_recall': 0.93452466, 'binary_specificity': 0.97914094, 'binary_f1_score': 0.9558506}
confusion matrix:
       0      1
0  28540    608
1   1909  27247
---- Validation: 
scalar performance:
{'acc': 0.9268098, 'precision': 0.6136415, 'recall': 0.7678548, 'specificity': 0.7678548, 'f1': 0.65254146, 'auroc': 0.8697212, 'binary_precision': 0.24128686, 'binary_recall': 0.59800667, 'binary_specificity': 0.93770295, 'binary_f1_score': 0.34383953}
confusion matrix:
       0     1
0  17039  1132
1    242   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9294759, 'precision': 0.6570358, 'recall': 0.84633327, 'specificity': 0.84633327, 'f1': 0.7081986, 'auroc': 0.90728855, 'binary_precision': 0.32446808, 'binary_recall': 0.75619835, 'binary_specificity': 0.93646824, 'binary_f1_score': 0.4540943}
confusion matrix:
      0    1
0  5616  381
1    59  183
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-02 17:36:04.674011,epoch time: 0:19:27.326577,used: 2:20:58.315772,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9597798, 'precision': 0.9604008, 'recall': 0.95978296, 'specificity': 0.95978296, 'f1': 0.9597664, 'auroc': 0.99185, 'binary_precision': 0.97735363, 'binary_recall': 0.9413863, 'binary_specificity': 0.9781796, 'binary_f1_score': 0.95903283}
confusion matrix:
       0      1
0  28511    636
1   1709  27448
---- Validation: 
scalar performance:
{'acc': 0.9259042, 'precision': 0.61582905, 'recall': 0.7818419, 'specificity': 0.7818419, 'f1': 0.6564122, 'auroc': 0.8730302, 'binary_precision': 0.2446602, 'binary_recall': 0.627907, 'binary_specificity': 0.93577677, 'binary_f1_score': 0.35211924}
confusion matrix:
       0     1
0  17004  1167
1    224   378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9240263, 'precision': 0.6481906, 'recall': 0.8454813, 'specificity': 0.8454813, 'f1': 0.69815946, 'auroc': 0.907575, 'binary_precision': 0.30666667, 'binary_recall': 0.76033056, 'binary_specificity': 0.930632, 'binary_f1_score': 0.4370546}
confusion matrix:
      0    1
0  5581  416
1    58  184
early stop counter: 1
val acc:0.9259042143821716, best validation acc: 0.9268097877502441, corresponding to test acc:                         0.9294759035110474 / 0.9294759035110474
after epoch: 8,now: 2024-08-02 17:55:31.424789,epoch time: 0:19:26.750778,used: 2:40:25.066550,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9625926, 'precision': 0.9629631, 'recall': 0.96259505, 'specificity': 0.96259505, 'f1': 0.9625852, 'auroc': 0.992818, 'binary_precision': 0.97610307, 'binary_recall': 0.9484172, 'binary_specificity': 0.9767729, 'binary_f1_score': 0.962061}
confusion matrix:
       0      1
0  28470    677
1   1504  27653
---- Validation: 
scalar performance:
{'acc': 0.91748786, 'precision': 0.6089168, 'recall': 0.7967675, 'specificity': 0.7967675, 'f1': 0.6488385, 'auroc': 0.8764216, 'binary_precision': 0.2295831, 'binary_recall': 0.6677741, 'binary_specificity': 0.9257608, 'binary_f1_score': 0.34169146}
confusion matrix:
       0     1
0  16822  1349
1    200   402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9059144, 'precision': 0.62715006, 'recall': 0.8519218, 'specificity': 0.8519218, 'f1': 0.6722281, 'auroc': 0.90838534, 'binary_precision': 0.26337448, 'binary_recall': 0.7933884, 'binary_specificity': 0.9104552, 'binary_f1_score': 0.3954686}
confusion matrix:
      0    1
0  5460  537
1    50  192
early stop counter: 2
val acc:0.9174878597259521, best validation acc: 0.9268097877502441, corresponding to test acc:                         0.9294759035110474 / 0.9294759035110474
after epoch: 9,now: 2024-08-02 18:14:56.333515,epoch time: 0:19:24.908726,used: 2:59:49.975276,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96312433, 'precision': 0.96345806, 'recall': 0.96312803, 'specificity': 0.96312803, 'f1': 0.96311784, 'auroc': 0.9932393, 'binary_precision': 0.9759639, 'binary_recall': 0.9496571, 'binary_specificity': 0.976599, 'binary_f1_score': 0.96263075}
confusion matrix:
       0      1
0  28462    682
1   1468  27692
---- Validation: 
scalar performance:
{'acc': 0.91711503, 'precision': 0.6066095, 'recall': 0.78854436, 'specificity': 0.78854436, 'f1': 0.6454229, 'auroc': 0.87453926, 'binary_precision': 0.2255466, 'binary_recall': 0.6511628, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.33504274}
confusion matrix:
       0     1
0  16825  1346
1    210   392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.905113, 'precision': 0.6249991, 'recall': 0.84555674, 'specificity': 0.84555674, 'f1': 0.6691241, 'auroc': 0.9056401, 'binary_precision': 0.2596154, 'binary_recall': 0.78099173, 'binary_specificity': 0.91012174, 'binary_f1_score': 0.38969076}
confusion matrix:
      0    1
0  5458  539
1    53  189
early stop counter: 3
val acc:0.9171150326728821, best validation acc: 0.9268097877502441, corresponding to test acc:                         0.9294759035110474 / 0.9294759035110474
after epoch: 10,now: 2024-08-02 18:34:36.852981,epoch time: 0:19:40.519466,used: 3:19:30.494742,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96399903, 'precision': 0.9642335, 'recall': 0.9640006, 'specificity': 0.9640006, 'f1': 0.9639946, 'auroc': 0.99366623, 'binary_precision': 0.97470087, 'binary_recall': 0.952737, 'binary_specificity': 0.9752642, 'binary_f1_score': 0.96359384}
confusion matrix:
       0      1
0  28427    721
1   1378  27778
---- Validation: 
scalar performance:
{'acc': 0.9187663, 'precision': 0.6067807, 'recall': 0.7813668, 'specificity': 0.7813668, 'f1': 0.6452582, 'auroc': 0.8747277, 'binary_precision': 0.22643746, 'binary_recall': 0.63455147, 'binary_specificity': 0.92818224, 'binary_f1_score': 0.3337702}
confusion matrix:
       0     1
0  16866  1305
1    220   382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9044719, 'precision': 0.623866, 'recall': 0.8432405, 'specificity': 0.8432405, 'f1': 0.66751605, 'auroc': 0.90557814, 'binary_precision': 0.25753424, 'binary_recall': 0.7768595, 'binary_specificity': 0.9096215, 'binary_f1_score': 0.38683125}
confusion matrix:
      0    1
0  5455  542
1    54  188
early stop counter: 4
val acc:0.9187663197517395, best validation acc: 0.9268097877502441, corresponding to test acc:                         0.9294759035110474 / 0.9294759035110474
after epoch: 11,now: 2024-08-02 18:53:57.498062,epoch time: 0:19:20.645081,used: 3:38:51.139823,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9665375, 'precision': 0.966792, 'recall': 0.9665395, 'specificity': 0.9665395, 'f1': 0.966533, 'auroc': 0.9942117, 'binary_precision': 0.9777341, 'binary_recall': 0.95483077, 'binary_specificity': 0.9782482, 'binary_f1_score': 0.9661467}
confusion matrix:
       0      1
0  28513    634
1   1317  27840
---- Validation: 
scalar performance:
{'acc': 0.9078464, 'precision': 0.5991744, 'recall': 0.7966053, 'specificity': 0.7966053, 'f1': 0.6355371, 'auroc': 0.87547845, 'binary_precision': 0.20987654, 'binary_recall': 0.6777409, 'binary_specificity': 0.9154697, 'binary_f1_score': 0.32050276}
confusion matrix:
       0     1
0  16635  1536
1    194   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88780254, 'precision': 0.60938203, 'recall': 0.84250045, 'specificity': 0.84250045, 'f1': 0.64640385, 'auroc': 0.9050627, 'binary_precision': 0.2280285, 'binary_recall': 0.7933884, 'binary_specificity': 0.89161247, 'binary_f1_score': 0.35424355}
confusion matrix:
      0    1
0  5347  650
1    50  192
early stop counter: 5
val acc:0.9078463912010193, best validation acc: 0.9268097877502441, corresponding to test acc:                         0.9294759035110474 / 0.9294759035110474
after epoch: 12,now: 2024-08-02 19:13:37.031988,epoch time: 0:19:39.533926,used: 3:58:30.673749,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96856135, 'precision': 0.96909, 'recall': 0.9685642, 'specificity': 0.9685642, 'f1': 0.9685526, 'auroc': 0.9951769, 'binary_precision': 0.98488075, 'binary_recall': 0.951744, 'binary_specificity': 0.9853844, 'binary_f1_score': 0.9680289}
confusion matrix:
       0      1
0  28721    426
1   1407  27750
---- Validation: 
scalar performance:
{'acc': 0.92350715, 'precision': 0.61118275, 'recall': 0.7757853, 'specificity': 0.7757853, 'f1': 0.6503402, 'auroc': 0.87649286, 'binary_precision': 0.23574145, 'binary_recall': 0.6179402, 'binary_specificity': 0.9336305, 'binary_f1_score': 0.3412844}
confusion matrix:
       0     1
0  16965  1206
1    230   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.905113, 'precision': 0.6249991, 'recall': 0.84555674, 'specificity': 0.84555674, 'f1': 0.6691241, 'auroc': 0.90270823, 'binary_precision': 0.2596154, 'binary_recall': 0.78099173, 'binary_specificity': 0.91012174, 'binary_f1_score': 0.38969076}
confusion matrix:
      0    1
0  5458  539
1    53  189
early stop counter: 6
val acc:0.9235071539878845, best validation acc: 0.9268097877502441, corresponding to test acc:                         0.9294759035110474 / 0.9294759035110474
after epoch: 13,now: 2024-08-02 19:32:53.317397,epoch time: 0:19:16.285409,used: 4:17:46.959158,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96876717, 'precision': 0.96887696, 'recall': 0.9687687, 'specificity': 0.9687687, 'f1': 0.9687654, 'auroc': 0.99498546, 'binary_precision': 0.97610503, 'binary_recall': 0.9610742, 'binary_specificity': 0.9764633, 'binary_f1_score': 0.9685313}
confusion matrix:
       0      1
0  28460    686
1   1135  28023
---- Validation: 
scalar performance:
{'acc': 0.90758, 'precision': 0.59872514, 'recall': 0.79566467, 'specificity': 0.79566467, 'f1': 0.6348826, 'auroc': 0.88034195, 'binary_precision': 0.20903955, 'binary_recall': 0.67607975, 'binary_specificity': 0.9152496, 'binary_f1_score': 0.3193409}
confusion matrix:
       0     1
0  16631  1540
1    195   407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87321687, 'precision': 0.5993999, 'recall': 0.84086156, 'specificity': 0.84086156, 'f1': 0.630105, 'auroc': 0.90326774, 'binary_precision': 0.20766774, 'binary_recall': 0.8057851, 'binary_specificity': 0.875938, 'binary_f1_score': 0.3302286}
confusion matrix:
      0    1
0  5253  744
1    47  195
early stop counter: 7
val acc:0.9075800180435181, best validation acc: 0.9268097877502441, corresponding to test acc:                         0.9294759035110474 / 0.9294759035110474
after epoch: 14,now: 2024-08-02 19:51:58.404400,epoch time: 0:19:05.087003,used: 4:36:52.046161,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9698134, 'precision': 0.9698354, 'recall': 0.96981394, 'specificity': 0.96981394, 'f1': 0.9698131, 'auroc': 0.9952059, 'binary_precision': 0.9730962, 'binary_recall': 0.96635455, 'binary_specificity': 0.9732734, 'binary_f1_score': 0.9697137}
confusion matrix:
       0      1
0  28368    779
1    981  28176
---- Validation: 
scalar performance:
{'acc': 0.9153039, 'precision': 0.6053591, 'recall': 0.79162407, 'specificity': 0.79162407, 'f1': 0.6439172, 'auroc': 0.8804879, 'binary_precision': 0.22278339, 'binary_recall': 0.6594684, 'binary_specificity': 0.92377967, 'binary_f1_score': 0.33305368}
confusion matrix:
       0     1
0  16786  1385
1    205   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88491744, 'precision': 0.6065665, 'recall': 0.839017, 'specificity': 0.839017, 'f1': 0.6420843, 'auroc': 0.90237, 'binary_precision': 0.22261073, 'binary_recall': 0.7892562, 'binary_specificity': 0.88877773, 'binary_f1_score': 0.34727272}
confusion matrix:
      0    1
0  5330  667
1    51  191
early stop counter: 8
val acc:0.9153038859367371, best validation acc: 0.9268097877502441, corresponding to test acc:                         0.9294759035110474 / 0.9294759035110474
after epoch: 15,now: 2024-08-02 20:11:04.149915,epoch time: 0:19:05.745515,used: 4:55:57.791676,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_15_15_05_seed_2_23919998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:55:57.791676 at 2024-08-02 20:11:04.149915
persisted model performance metric: 

scalar performance:
{'acc': 0.9294759, 'precision': 0.6570358, 'recall': 0.84633327, 'specificity': 0.84633327, 'f1': 0.7081986, 'auroc': 0.90728855, 'binary_precision': 0.32446808, 'binary_recall': 0.75619835, 'binary_specificity': 0.93646824, 'binary_f1_score': 0.4540943}
confusion matrix:
      0    1
0  5616  381
1    59  183
oracle model performance metric: 

scalar performance:
{'acc': 0.9294759, 'precision': 0.6570358, 'recall': 0.84633327, 'specificity': 0.84633327, 'f1': 0.7081986, 'auroc': 0.90728855, 'binary_precision': 0.32446808, 'binary_recall': 0.75619835, 'binary_specificity': 0.93646824, 'binary_f1_score': 0.4540943}
confusion matrix:
      0    1
0  5616  381
1    59  183
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    838 MiB |   8473 MiB |   1078 TiB |   1078 TiB |
|       from large pool |    801 MiB |   8430 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     36 MiB |     76 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |    838 MiB |   8473 MiB |   1078 TiB |   1078 TiB |
|       from large pool |    801 MiB |   8430 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     36 MiB |     76 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |    832 MiB |   8468 MiB |   1078 TiB |   1078 TiB |
|       from large pool |    796 MiB |   8426 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     35 MiB |     75 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9436 MiB |   9436 MiB |  26518 MiB |  17082 MiB |
|       from large pool |   9356 MiB |   9356 MiB |  26366 MiB |  17010 MiB |
|       from small pool |     80 MiB |     84 MiB |    152 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  45032 KiB |    776 MiB | 595957 GiB | 595957 GiB |
|       from large pool |  37749 KiB |    775 MiB | 578418 GiB | 578418 GiB |
|       from small pool |   7283 KiB |     28 MiB |  17539 GiB |  17539 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3460    |    8277    |  217247 K  |  217243 K  |
|       from large pool |     161    |     844    |  102529 K  |  102528 K  |
|       from small pool |    3299    |    8114    |  114717 K  |  114714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3460    |    8277    |  217247 K  |  217243 K  |
|       from large pool |     161    |     844    |  102529 K  |  102528 K  |
|       from small pool |    3299    |    8114    |  114717 K  |  114714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     406    |    1115    |     711    |
|       from large pool |     364    |     364    |    1039    |     675    |
|       from small pool |      40    |      42    |      76    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |    3674    |  124211 K  |  124211 K  |
|       from large pool |      17    |     356    |   71545 K  |   71545 K  |
|       from small pool |      45    |    3658    |   52665 K  |   52665 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8473 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8430 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     76 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8473 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8430 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     76 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8468 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8426 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     75 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |   9436 MiB |  26518 MiB |  25636 MiB |
|       from large pool |    838 MiB |   9356 MiB |  26366 MiB |  25528 MiB |
|       from small pool |     44 MiB |     84 MiB |    152 MiB |    108 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    776 MiB | 595957 GiB | 595957 GiB |
|       from large pool |  30464 KiB |    775 MiB | 578418 GiB | 578418 GiB |
|       from small pool |      0 KiB |     28 MiB |  17539 GiB |  17539 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8277    |  217247 K  |  217247 K  |
|       from large pool |       2    |     844    |  102529 K  |  102529 K  |
|       from small pool |       0    |    8114    |  114717 K  |  114717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8277    |  217247 K  |  217247 K  |
|       from large pool |       2    |     844    |  102529 K  |  102529 K  |
|       from small pool |       0    |    8114    |  114717 K  |  114717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      48    |     406    |    1115    |    1067    |
|       from large pool |      26    |     364    |    1039    |    1013    |
|       from small pool |      22    |      42    |      76    |      54    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3674    |  124212 K  |  124212 K  |
|       from large pool |       2    |     356    |   71545 K  |   71545 K  |
|       from small pool |       0    |    3658    |   52667 K  |   52667 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 20:12:31 2024]
Finished job 0.
1 of 1 steps (100%) done
