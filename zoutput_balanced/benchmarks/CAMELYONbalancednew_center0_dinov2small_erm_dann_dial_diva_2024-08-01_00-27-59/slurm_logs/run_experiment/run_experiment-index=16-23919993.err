Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 22:16:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/16.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=16
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_22_25_55_seed_0_23919993

 Experiment start at: 2024-08-01 22:25:56.070005
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.22451263666152954
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93950486, 'precision': 0.94243383, 'recall': 0.9395391, 'specificity': 0.9395391, 'f1': 0.9394078, 'auroc': 0.9779674, 'binary_precision': 0.97864187, 'binary_recall': 0.8987249, 'binary_specificity': 0.9803532, 'binary_f1_score': 0.9369824}
confusion matrix:
       0      1
0  28093    563
1   2907  25797
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9476905, 'precision': 0.55416745, 'recall': 0.54013675, 'specificity': 0.54013675, 'f1': 0.54571563, 'auroc': 0.759055, 'binary_precision': 0.13983051, 'binary_recall': 0.102643855, 'binary_specificity': 0.9776296, 'binary_f1_score': 0.11838565}
confusion matrix:
       0    1
0  17743  406
1    577   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9228188, 'precision': 0.54767245, 'recall': 0.55478406, 'specificity': 0.55478406, 'f1': 0.5508438, 'auroc': 0.8129087, 'binary_precision': 0.13245033, 'binary_recall': 0.1532567, 'binary_specificity': 0.95631146, 'binary_f1_score': 0.14209591}
confusion matrix:
      0    1
0  5735  262
1   221   40
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 22:58:40.698570,epoch time: 0:32:44.628565,used: 0:32:44.628565,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_22_25_55_seed_0_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9536088, 'precision': 0.95531774, 'recall': 0.95363235, 'specificity': 0.95363235, 'f1': 0.9535669, 'auroc': 0.9864522, 'binary_precision': 0.9834045, 'binary_recall': 0.9228625, 'binary_specificity': 0.98440224, 'binary_f1_score': 0.9521721}
confusion matrix:
       0      1
0  28211    447
1   2214  26488
---- Validation: 
scalar performance:
{'acc': 0.9549276, 'precision': 0.63225865, 'recall': 0.6016378, 'specificity': 0.6016378, 'f1': 0.61459523, 'auroc': 0.8196447, 'binary_precision': 0.29183674, 'binary_recall': 0.22239502, 'binary_specificity': 0.9808805, 'binary_f1_score': 0.2524272}
confusion matrix:
       0    1
0  17802  347
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9389581, 'precision': 0.64153373, 'recall': 0.6713127, 'specificity': 0.6713127, 'f1': 0.65468764, 'auroc': 0.84327734, 'binary_precision': 0.31034482, 'binary_recall': 0.37931034, 'binary_specificity': 0.963315, 'binary_f1_score': 0.34137928}
confusion matrix:
      0    1
0  5777  220
1   162   99
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 23:30:57.642968,epoch time: 0:32:16.944398,used: 1:05:01.572963,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_22_25_55_seed_0_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96009415, 'precision': 0.9616302, 'recall': 0.9601174, 'specificity': 0.9601174, 'f1': 0.96006227, 'auroc': 0.9896878, 'binary_precision': 0.98846066, 'binary_recall': 0.9311222, 'binary_specificity': 0.9891126, 'binary_f1_score': 0.9589351}
confusion matrix:
       0      1
0  28345    312
1   1977  26726
---- Validation: 
scalar performance:
{'acc': 0.9551937, 'precision': 0.65385115, 'recall': 0.6422785, 'specificity': 0.6422785, 'f1': 0.6478026, 'auroc': 0.8331584, 'binary_precision': 0.3322091, 'binary_recall': 0.30637637, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.31877023}
confusion matrix:
       0    1
0  17753  396
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93783957, 'precision': 0.65737176, 'recall': 0.73119605, 'specificity': 0.73119605, 'f1': 0.68574846, 'auroc': 0.850461, 'binary_precision': 0.33673468, 'binary_recall': 0.50574714, 'binary_specificity': 0.956645, 'binary_f1_score': 0.40428787}
confusion matrix:
      0    1
0  5737  260
1   129  132
better model found
persisted
after epoch: 3,now: 2024-08-02 00:02:58.868046,epoch time: 0:32:01.225078,used: 1:37:02.798041,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_22_25_55_seed_0_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9660216, 'precision': 0.96679616, 'recall': 0.9660381, 'specificity': 0.9660381, 'f1': 0.96600837, 'auroc': 0.9926648, 'binary_precision': 0.9860122, 'binary_recall': 0.9455109, 'binary_specificity': 0.98656523, 'binary_f1_score': 0.965337}
confusion matrix:
       0      1
0  28272    385
1   1564  27139
---- Validation: 
scalar performance:
{'acc': 0.9390166, 'precision': 0.6301694, 'recall': 0.72391, 'specificity': 0.72391, 'f1': 0.66208607, 'auroc': 0.8509464, 'binary_precision': 0.27880386, 'binary_recall': 0.49300155, 'binary_specificity': 0.9548184, 'binary_f1_score': 0.35617977}
confusion matrix:
       0    1
0  17329  820
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9081176, 'precision': 0.61862177, 'recall': 0.7724906, 'specificity': 0.7724906, 'f1': 0.6561576, 'auroc': 0.85433364, 'binary_precision': 0.2546875, 'binary_recall': 0.6245211, 'binary_specificity': 0.9204602, 'binary_f1_score': 0.3618202}
confusion matrix:
      0    1
0  5520  477
1    98  163
early stop counter: 1
val acc:0.939016580581665, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9378395676612854 / 0.9389581084251404
after epoch: 4,now: 2024-08-02 00:35:18.107398,epoch time: 0:32:19.239352,used: 2:09:22.037393,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_22_25_55_seed_0_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96959555, 'precision': 0.9703246, 'recall': 0.9696114, 'specificity': 0.9696114, 'f1': 0.96958447, 'auroc': 0.99402034, 'binary_precision': 0.9890433, 'binary_recall': 0.94976133, 'binary_specificity': 0.98946154, 'binary_f1_score': 0.9690044}
confusion matrix:
       0      1
0  28355    302
1   1442  27261
---- Validation: 
scalar performance:
{'acc': 0.9367284, 'precision': 0.62394166, 'recall': 0.71897507, 'specificity': 0.71897507, 'f1': 0.65547085, 'auroc': 0.8519609, 'binary_precision': 0.26666668, 'binary_recall': 0.4852255, 'binary_specificity': 0.9527247, 'binary_f1_score': 0.3441809}
confusion matrix:
       0    1
0  17291  858
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9095558, 'precision': 0.6236768, 'recall': 0.78606737, 'specificity': 0.78606737, 'f1': 0.6632625, 'auroc': 0.8669201, 'binary_precision': 0.2635659, 'binary_recall': 0.651341, 'binary_specificity': 0.9207937, 'binary_f1_score': 0.37527597}
confusion matrix:
      0    1
0  5522  475
1    91  170
early stop counter: 2
val acc:0.9367284178733826, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9378395676612854 / 0.9389581084251404
after epoch: 5,now: 2024-08-02 01:07:28.491277,epoch time: 0:32:10.383879,used: 2:41:32.421272,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_22_25_55_seed_0_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97187936, 'precision': 0.97208714, 'recall': 0.9718898, 'specificity': 0.9718898, 'f1': 0.97187674, 'auroc': 0.9948467, 'binary_precision': 0.9822376, 'binary_recall': 0.96119547, 'binary_specificity': 0.9825841, 'binary_f1_score': 0.9716026}
confusion matrix:
       0      1
0  28153    499
1   1114  27594
---- Validation: 
scalar performance:
{'acc': 0.91895485, 'precision': 0.6064442, 'recall': 0.7540268, 'specificity': 0.7540268, 'f1': 0.6422363, 'auroc': 0.8616543, 'binary_precision': 0.22872996, 'binary_recall': 0.5769829, 'binary_specificity': 0.93107057, 'binary_f1_score': 0.32759383}
confusion matrix:
       0     1
0  16898  1251
1    272   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88223076, 'precision': 0.6014689, 'recall': 0.7956306, 'specificity': 0.7956306, 'f1': 0.63362336, 'auroc': 0.86545825, 'binary_precision': 0.21733966, 'binary_recall': 0.7011494, 'binary_specificity': 0.89011174, 'binary_f1_score': 0.33182228}
confusion matrix:
      0    1
0  5338  659
1    78  183
early stop counter: 3
val acc:0.9189548492431641, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9378395676612854 / 0.9389581084251404
after epoch: 6,now: 2024-08-02 01:40:03.838991,epoch time: 0:32:35.347714,used: 3:14:07.768986,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_22_25_55_seed_0_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 3:14:07.768986 at 2024-08-02 01:40:03.838991
persisted model performance metric: 

scalar performance:
{'acc': 0.93783957, 'precision': 0.65737176, 'recall': 0.73119605, 'specificity': 0.73119605, 'f1': 0.68574846, 'auroc': 0.850461, 'binary_precision': 0.33673468, 'binary_recall': 0.50574714, 'binary_specificity': 0.956645, 'binary_f1_score': 0.40428787}
confusion matrix:
      0    1
0  5737  260
1   129  132
oracle model performance metric: 

scalar performance:
{'acc': 0.9389581, 'precision': 0.64153373, 'recall': 0.6713127, 'specificity': 0.6713127, 'f1': 0.65468764, 'auroc': 0.84327734, 'binary_precision': 0.31034482, 'binary_recall': 0.37931034, 'binary_specificity': 0.963315, 'binary_f1_score': 0.34137928}
confusion matrix:
      0    1
0  5777  220
1   162   99
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/16.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198163 KiB |   2142 MiB | 316930 GiB | 316930 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 313103 GiB | 313103 GiB |
|       from small pool |  17501 KiB |     37 MiB |   3827 GiB |   3827 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198163 KiB |   2142 MiB | 316930 GiB | 316930 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 313103 GiB | 313103 GiB |
|       from small pool |  17501 KiB |     37 MiB |   3827 GiB |   3827 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   2141 MiB | 316899 GiB | 316899 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 313077 GiB | 313077 GiB |
|       from small pool |  16482 KiB |     36 MiB |   3821 GiB |   3821 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2372 MiB |   2372 MiB |   2372 MiB |      0 B   |
|       from large pool |   2330 MiB |   2330 MiB |   2330 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55789 KiB | 225565 KiB | 170454 GiB | 170454 GiB |
|       from large pool |  50762 KiB | 224940 KiB | 166603 GiB | 166603 GiB |
|       from small pool |   5027 KiB |   9264 KiB |   3851 GiB |   3851 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2998    |    7665    |   47779 K  |   47776 K  |
|       from large pool |      79    |     252    |   28813 K  |   28813 K  |
|       from small pool |    2919    |    7585    |   18965 K  |   18963 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2998    |    7665    |   47779 K  |   47776 K  |
|       from large pool |      79    |     252    |   28813 K  |   28813 K  |
|       from small pool |    2919    |    7585    |   18965 K  |   18963 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     118    |     118    |     118    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3602    |   30844 K  |   30844 K  |
|       from large pool |      10    |      97    |   22387 K  |   22387 K  |
|       from small pool |      25    |    3592    |    8456 K  |    8456 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 316930 GiB | 316930 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 313103 GiB | 313103 GiB |
|       from small pool |      0 KiB |     37 MiB |   3827 GiB |   3827 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 316930 GiB | 316930 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 313103 GiB | 313103 GiB |
|       from small pool |      0 KiB |     37 MiB |   3827 GiB |   3827 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 316899 GiB | 316899 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 313077 GiB | 313077 GiB |
|       from small pool |      0 KiB |     36 MiB |   3821 GiB |   3821 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   2372 MiB |   2372 MiB |   2124 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  22528 KiB |     42 MiB |     42 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 170454 GiB | 170454 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 166603 GiB | 166603 GiB |
|       from small pool |      0 KiB |  18592 KiB |   3851 GiB |   3851 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   47779 K  |   47779 K  |
|       from large pool |       2    |     252    |   28813 K  |   28813 K  |
|       from small pool |       0    |    7585    |   18965 K  |   18965 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   47779 K  |   47779 K  |
|       from large pool |       2    |     252    |   28813 K  |   28813 K  |
|       from small pool |       0    |    7585    |   18965 K  |   18965 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     118    |     118    |      96    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      11    |      21    |      21    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   30845 K  |   30845 K  |
|       from large pool |       3    |      97    |   22387 K  |   22387 K  |
|       from small pool |       0    |    3592    |    8457 K  |    8457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 316930 GiB | 316930 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 313103 GiB | 313103 GiB |
|       from small pool |      0 KiB |     37 MiB |   3827 GiB |   3827 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 316930 GiB | 316930 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 313103 GiB | 313103 GiB |
|       from small pool |      0 KiB |     37 MiB |   3827 GiB |   3827 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 316899 GiB | 316899 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 313077 GiB | 313077 GiB |
|       from small pool |      0 KiB |     36 MiB |   3821 GiB |   3821 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   2372 MiB |   2372 MiB |   2124 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  22528 KiB |     42 MiB |     42 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 170454 GiB | 170454 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 166603 GiB | 166603 GiB |
|       from small pool |      0 KiB |  18592 KiB |   3851 GiB |   3851 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   47779 K  |   47779 K  |
|       from large pool |       2    |     252    |   28813 K  |   28813 K  |
|       from small pool |       0    |    7585    |   18965 K  |   18965 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   47779 K  |   47779 K  |
|       from large pool |       2    |     252    |   28813 K  |   28813 K  |
|       from small pool |       0    |    7585    |   18965 K  |   18965 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     118    |     118    |      96    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      11    |      21    |      21    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   30845 K  |   30845 K  |
|       from large pool |       3    |      97    |   22387 K  |   22387 K  |
|       from small pool |       0    |    3592    |    8457 K  |    8457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_01_50_54_seed_1_23919993

 Experiment start at: 2024-08-02 01:50:54.808056
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6890106797218323
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93836784, 'precision': 0.9416139, 'recall': 0.93839914, 'specificity': 0.93839914, 'f1': 0.93825734, 'auroc': 0.9811406, 'binary_precision': 0.9796584, 'binary_recall': 0.8954178, 'binary_specificity': 0.98138046, 'binary_f1_score': 0.93564576}
confusion matrix:
       0      1
0  28251    536
1   3015  25814
---- Validation: 
scalar performance:
{'acc': 0.9533084, 'precision': 0.66222763, 'recall': 0.66106695, 'specificity': 0.66106695, 'f1': 0.6616449, 'auroc': 0.84996533, 'binary_precision': 0.3488024, 'binary_recall': 0.346211, 'binary_specificity': 0.97592294, 'binary_f1_score': 0.34750184}
confusion matrix:
       0    1
0  17632  435
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.71369386, 'recall': 0.72935784, 'specificity': 0.72935784, 'f1': 0.721204, 'auroc': 0.9005282, 'binary_precision': 0.45, 'binary_recall': 0.4846154, 'binary_specificity': 0.97410023, 'binary_f1_score': 0.46666667}
confusion matrix:
      0    1
0  5792  154
1   134  126
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 02:23:43.690686,epoch time: 0:32:48.882630,used: 0:32:48.882630,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_01_50_54_seed_1_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9540926, 'precision': 0.9561473, 'recall': 0.9541172, 'specificity': 0.9541172, 'f1': 0.95404255, 'auroc': 0.98959565, 'binary_precision': 0.98694485, 'binary_recall': 0.9204273, 'binary_specificity': 0.987807, 'binary_f1_score': 0.9525262}
confusion matrix:
       0      1
0  28436    351
1   2294  26535
---- Validation: 
scalar performance:
{'acc': 0.95581645, 'precision': 0.6887904, 'recall': 0.7124364, 'specificity': 0.7124364, 'f1': 0.69981176, 'auroc': 0.87675273, 'binary_precision': 0.3981603, 'binary_recall': 0.45022288, 'binary_specificity': 0.9746499, 'binary_f1_score': 0.42259413}
confusion matrix:
       0    1
0  17609  458
1    370  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.75799567, 'recall': 0.81247056, 'specificity': 0.81247056, 'f1': 0.78224725, 'auroc': 0.9153128, 'binary_precision': 0.5314465, 'binary_recall': 0.65, 'binary_specificity': 0.97494113, 'binary_f1_score': 0.58477503}
confusion matrix:
      0    1
0  5797  149
1    91  169
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 02:56:17.953379,epoch time: 0:32:34.262693,used: 1:05:23.145323,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_01_50_54_seed_1_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9603235, 'precision': 0.96110344, 'recall': 0.9603379, 'specificity': 0.9603379, 'f1': 0.9603076, 'auroc': 0.99163544, 'binary_precision': 0.9802417, 'binary_recall': 0.939642, 'binary_specificity': 0.98103374, 'binary_f1_score': 0.9595126}
confusion matrix:
       0      1
0  28242    546
1   1740  27088
---- Validation: 
scalar performance:
{'acc': 0.9537887, 'precision': 0.6875073, 'recall': 0.7478634, 'specificity': 0.7478634, 'f1': 0.71284544, 'auroc': 0.8818691, 'binary_precision': 0.39289677, 'binary_recall': 0.52600294, 'binary_specificity': 0.9697238, 'binary_f1_score': 0.4498094}
confusion matrix:
       0    1
0  17520  547
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.74070907, 'recall': 0.82340944, 'specificity': 0.82340944, 'f1': 0.775032, 'auroc': 0.9190413, 'binary_precision': 0.49577466, 'binary_recall': 0.6769231, 'binary_specificity': 0.9698957, 'binary_f1_score': 0.5723578}
confusion matrix:
      0    1
0  5767  179
1    84  176
early stop counter: 1
val acc:0.953788697719574, best validation acc: 0.9558164477348328, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 3,now: 2024-08-02 03:28:29.804878,epoch time: 0:32:11.851499,used: 1:37:34.996822,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_01_50_54_seed_1_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9610698, 'precision': 0.9625304, 'recall': 0.9610914, 'specificity': 0.9610914, 'f1': 0.9610404, 'auroc': 0.9931232, 'binary_precision': 0.9887136, 'binary_recall': 0.93284774, 'binary_specificity': 0.9893351, 'binary_f1_score': 0.9599686}
confusion matrix:
       0      1
0  28479    307
1   1936  26894
---- Validation: 
scalar performance:
{'acc': 0.9568303, 'precision': 0.6940488, 'recall': 0.71367747, 'specificity': 0.71367747, 'f1': 0.7033213, 'auroc': 0.881569, 'binary_precision': 0.40860215, 'binary_recall': 0.45170876, 'binary_specificity': 0.9756462, 'binary_f1_score': 0.4290755}
confusion matrix:
       0    1
0  17627  440
1    369  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.7703544, 'recall': 0.8118088, 'specificity': 0.8118088, 'f1': 0.7893965, 'auroc': 0.9225607, 'binary_precision': 0.5562914, 'binary_recall': 0.64615387, 'binary_specificity': 0.97746384, 'binary_f1_score': 0.59786475}
confusion matrix:
      0    1
0  5812  134
1    92  168
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 04:00:41.321091,epoch time: 0:32:11.516213,used: 2:09:46.513035,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_01_50_54_seed_1_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.966485, 'precision': 0.9673414, 'recall': 0.9665007, 'specificity': 0.9665007, 'f1': 0.9664704, 'auroc': 0.99438345, 'binary_precision': 0.98752993, 'binary_recall': 0.94495124, 'binary_specificity': 0.98805016, 'binary_f1_score': 0.9657715}
confusion matrix:
       0      1
0  28443    344
1   1587  27242
---- Validation: 
scalar performance:
{'acc': 0.9558698, 'precision': 0.6934205, 'recall': 0.7332068, 'specificity': 0.7332068, 'f1': 0.71117973, 'auroc': 0.8827075, 'binary_precision': 0.40586796, 'binary_recall': 0.49331352, 'binary_specificity': 0.9731001, 'binary_f1_score': 0.4453387}
confusion matrix:
       0    1
0  17581  486
1    341  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.7718694, 'recall': 0.817494, 'specificity': 0.817494, 'f1': 0.7926655, 'auroc': 0.9243525, 'binary_precision': 0.5588235, 'binary_recall': 0.6576923, 'binary_specificity': 0.97729564, 'binary_f1_score': 0.60424036}
confusion matrix:
      0    1
0  5811  135
1    89  171
new oracle model saved
early stop counter: 1
val acc:0.9558697938919067, best validation acc: 0.9568303227424622, corresponding to test acc:                         0.9635836482048035 / 0.9639058709144592
after epoch: 5,now: 2024-08-02 04:32:43.478782,epoch time: 0:32:02.157691,used: 2:41:48.670726,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_01_50_54_seed_1_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9704249, 'precision': 0.9705297, 'recall': 0.97043043, 'specificity': 0.97043043, 'f1': 0.97042346, 'auroc': 0.9946292, 'binary_precision': 0.97773784, 'binary_recall': 0.9628152, 'binary_specificity': 0.97804564, 'binary_f1_score': 0.97021914}
confusion matrix:
       0      1
0  28155    632
1   1072  27757
---- Validation: 
scalar performance:
{'acc': 0.95026684, 'precision': 0.67834204, 'recall': 0.76534903, 'specificity': 0.76534903, 'f1': 0.7118896, 'auroc': 0.88612103, 'binary_precision': 0.37316355, 'binary_recall': 0.5661218, 'binary_specificity': 0.9645763, 'binary_f1_score': 0.44982287}
confusion matrix:
       0    1
0  17427  640
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.73300314, 'recall': 0.8279173, 'specificity': 0.8279173, 'f1': 0.7711071, 'auroc': 0.92551816, 'binary_precision': 0.47989276, 'binary_recall': 0.68846154, 'binary_specificity': 0.967373, 'binary_f1_score': 0.5655608}
confusion matrix:
      0    1
0  5752  194
1    81  179
early stop counter: 2
val acc:0.9502668380737305, best validation acc: 0.9568303227424622, corresponding to test acc:                         0.9635836482048035 / 0.9639058709144592
after epoch: 6,now: 2024-08-02 05:04:50.035778,epoch time: 0:32:06.556996,used: 3:13:55.227722,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_01_50_54_seed_1_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97259444, 'precision': 0.9727111, 'recall': 0.9726005, 'specificity': 0.9726005, 'f1': 0.97259295, 'auroc': 0.9956752, 'binary_precision': 0.9803293, 'binary_recall': 0.9645855, 'binary_specificity': 0.98061556, 'binary_f1_score': 0.9723936}
confusion matrix:
       0      1
0  28228    558
1   1021  27809
---- Validation: 
scalar performance:
{'acc': 0.95026684, 'precision': 0.6781903, 'recall': 0.7646338, 'specificity': 0.7646338, 'f1': 0.71156514, 'auroc': 0.8841442, 'binary_precision': 0.3729146, 'binary_recall': 0.56463593, 'binary_specificity': 0.9646317, 'binary_f1_score': 0.44917256}
confusion matrix:
       0    1
0  17428  639
1    293  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.7262876, 'recall': 0.8088547, 'specificity': 0.8088547, 'f1': 0.760141, 'auroc': 0.9247154, 'binary_precision': 0.46814406, 'binary_recall': 0.65, 'binary_specificity': 0.96770936, 'binary_f1_score': 0.54428345}
confusion matrix:
      0    1
0  5754  192
1    91  169
early stop counter: 3
val acc:0.9502668380737305, best validation acc: 0.9568303227424622, corresponding to test acc:                         0.9635836482048035 / 0.9639058709144592
after epoch: 7,now: 2024-08-02 05:36:48.919339,epoch time: 0:31:58.883561,used: 3:45:54.111283,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_01_50_54_seed_1_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 3:45:54.111283 at 2024-08-02 05:36:48.919339
persisted model performance metric: 

scalar performance:
{'acc': 0.96358365, 'precision': 0.7703544, 'recall': 0.8118088, 'specificity': 0.8118088, 'f1': 0.7893965, 'auroc': 0.9225607, 'binary_precision': 0.5562914, 'binary_recall': 0.64615387, 'binary_specificity': 0.97746384, 'binary_f1_score': 0.59786475}
confusion matrix:
      0    1
0  5812  134
1    92  168
oracle model performance metric: 

scalar performance:
{'acc': 0.9639059, 'precision': 0.7718694, 'recall': 0.817494, 'specificity': 0.817494, 'f1': 0.7926655, 'auroc': 0.9243525, 'binary_precision': 0.5588235, 'binary_recall': 0.6576923, 'binary_specificity': 0.97729564, 'binary_f1_score': 0.60424036}
confusion matrix:
      0    1
0  5811  135
1    89  171
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196700 KiB |   2142 MiB | 687608 GiB | 687608 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 679312 GiB | 679312 GiB |
|       from small pool |  17489 KiB |     37 MiB |   8296 GiB |   8296 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196700 KiB |   2142 MiB | 687608 GiB | 687608 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 679312 GiB | 679312 GiB |
|       from small pool |  17489 KiB |     37 MiB |   8296 GiB |   8296 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   2141 MiB | 687526 GiB | 687526 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 679243 GiB | 679243 GiB |
|       from small pool |  16480 KiB |     36 MiB |   8283 GiB |   8283 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2354 MiB |   2372 MiB |   4478 MiB |   2124 MiB |
|       from large pool |   2316 MiB |   2330 MiB |   4420 MiB |   2104 MiB |
|       from small pool |     38 MiB |     42 MiB |     58 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40868 KiB | 232750 KiB | 375455 GiB | 375455 GiB |
|       from large pool |  31733 KiB | 230336 KiB | 367111 GiB | 367111 GiB |
|       from small pool |   9135 KiB |  18592 KiB |   8343 GiB |   8343 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2974    |    7697    |  103593 K  |  103590 K  |
|       from large pool |      79    |     252    |   62508 K  |   62508 K  |
|       from small pool |    2895    |    7617    |   41084 K  |   41081 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2974    |    7697    |  103593 K  |  103590 K  |
|       from large pool |      79    |     252    |   62508 K  |   62508 K  |
|       from small pool |    2895    |    7617    |   41084 K  |   41081 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     118    |     211    |      96    |
|       from large pool |      96    |      97    |     182    |      86    |
|       from small pool |      19    |      21    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |    3619    |   65918 K  |   65918 K  |
|       from large pool |      11    |     100    |   47733 K  |   47733 K  |
|       from small pool |      30    |    3608    |   18184 K  |   18184 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 687608 GiB | 687608 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 679312 GiB | 679312 GiB |
|       from small pool |      0 KiB |     37 MiB |   8296 GiB |   8296 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 687608 GiB | 687608 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 679312 GiB | 679312 GiB |
|       from small pool |      0 KiB |     37 MiB |   8296 GiB |   8296 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 687526 GiB | 687526 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 679243 GiB | 679243 GiB |
|       from small pool |      0 KiB |     36 MiB |   8283 GiB |   8283 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   2372 MiB |   4478 MiB |   4246 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4420 MiB |   4214 MiB |
|       from small pool |  26624 KiB |     42 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 232750 KiB | 375455 GiB | 375455 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 367111 GiB | 367111 GiB |
|       from small pool |      0 KiB |  23492 KiB |   8343 GiB |   8343 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  103593 K  |  103593 K  |
|       from large pool |       2    |     252    |   62508 K  |   62508 K  |
|       from small pool |       0    |    7617    |   41084 K  |   41084 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  103593 K  |  103593 K  |
|       from large pool |       2    |     252    |   62508 K  |   62508 K  |
|       from small pool |       0    |    7617    |   41084 K  |   41084 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     118    |     211    |     188    |
|       from large pool |      10    |      97    |     182    |     172    |
|       from small pool |      13    |      21    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3619    |   65919 K  |   65919 K  |
|       from large pool |       3    |     100    |   47733 K  |   47733 K  |
|       from small pool |       0    |    3608    |   18185 K  |   18185 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 687608 GiB | 687608 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 679312 GiB | 679312 GiB |
|       from small pool |      0 KiB |     37 MiB |   8296 GiB |   8296 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 687608 GiB | 687608 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 679312 GiB | 679312 GiB |
|       from small pool |      0 KiB |     37 MiB |   8296 GiB |   8296 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 687526 GiB | 687526 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 679243 GiB | 679243 GiB |
|       from small pool |      0 KiB |     36 MiB |   8283 GiB |   8283 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   2372 MiB |   4478 MiB |   4246 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4420 MiB |   4214 MiB |
|       from small pool |  26624 KiB |     42 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 232750 KiB | 375455 GiB | 375455 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 367111 GiB | 367111 GiB |
|       from small pool |      0 KiB |  23492 KiB |   8343 GiB |   8343 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  103593 K  |  103593 K  |
|       from large pool |       2    |     252    |   62508 K  |   62508 K  |
|       from small pool |       0    |    7617    |   41084 K  |   41084 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  103593 K  |  103593 K  |
|       from large pool |       2    |     252    |   62508 K  |   62508 K  |
|       from small pool |       0    |    7617    |   41084 K  |   41084 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     118    |     211    |     188    |
|       from large pool |      10    |      97    |     182    |     172    |
|       from small pool |      13    |      21    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3619    |   65919 K  |   65919 K  |
|       from large pool |       3    |     100    |   47733 K  |   47733 K  |
|       from small pool |       0    |    3608    |   18185 K  |   18185 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_05_46_50_seed_2_23919993

 Experiment start at: 2024-08-02 05:46:50.390760
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.10803013294935226
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91811883, 'precision': 0.92298734, 'recall': 0.91812986, 'specificity': 0.91812986, 'f1': 0.91788393, 'auroc': 0.95749056, 'binary_precision': 0.9684186, 'binary_recall': 0.86446255, 'binary_specificity': 0.97179717, 'binary_f1_score': 0.9134925}
confusion matrix:
       0      1
0  28324    822
1   3952  25206
---- Validation: 
scalar performance:
{'acc': 0.9555745, 'precision': 0.5301978, 'recall': 0.5144955, 'specificity': 0.5144955, 'f1': 0.51797056, 'auroc': 0.5849174, 'binary_precision': 0.09154929, 'binary_recall': 0.04318937, 'binary_specificity': 0.9858016, 'binary_f1_score': 0.058690745}
confusion matrix:
       0    1
0  17913  258
1    576   26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95287704, 'precision': 0.51407456, 'recall': 0.5035955, 'specificity': 0.5035955, 'f1': 0.5011721, 'auroc': 0.552148, 'binary_precision': 0.06666667, 'binary_recall': 0.016528925, 'binary_specificity': 0.990662, 'binary_f1_score': 0.026490066}
confusion matrix:
      0   1
0  5941  56
1   238   4
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 06:19:55.727682,epoch time: 0:33:05.336922,used: 0:33:05.336922,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_05_46_50_seed_2_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93755144, 'precision': 0.94299936, 'recall': 0.937561, 'specificity': 0.937561, 'f1': 0.9373598, 'auroc': 0.9752425, 'binary_precision': 0.99216884, 'binary_recall': 0.88208663, 'binary_specificity': 0.9930353, 'binary_f1_score': 0.933895}
confusion matrix:
       0      1
0  28944    203
1   3438  25719
---- Validation: 
scalar performance:
{'acc': 0.96574867, 'precision': 0.5939206, 'recall': 0.5117206, 'specificity': 0.5117206, 'f1': 0.51498413, 'auroc': 0.6741339, 'binary_precision': 0.21917808, 'binary_recall': 0.026578072, 'binary_specificity': 0.9968631, 'binary_f1_score': 0.047407407}
confusion matrix:
       0   1
0  18114  57
1    586  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586472, 'precision': 0.5977425, 'recall': 0.51254517, 'specificity': 0.51254517, 'f1': 0.5151667, 'auroc': 0.704726, 'binary_precision': 0.23333333, 'binary_recall': 0.02892562, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.05147059}
confusion matrix:
      0   1
0  5974  23
1   235   7
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 06:52:20.354015,epoch time: 0:32:24.626333,used: 1:05:29.963255,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_05_46_50_seed_2_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9533994, 'precision': 0.9554716, 'recall': 0.9534064, 'specificity': 0.9534064, 'f1': 0.95334685, 'auroc': 0.9833425, 'binary_precision': 0.98624444, 'binary_recall': 0.9196447, 'binary_specificity': 0.9871681, 'binary_f1_score': 0.9517809}
confusion matrix:
       0      1
0  28772    374
1   2343  26815
---- Validation: 
scalar performance:
{'acc': 0.9645768, 'precision': 0.6548051, 'recall': 0.5512677, 'specificity': 0.5512677, 'f1': 0.57376266, 'auroc': 0.75196373, 'binary_precision': 0.33846155, 'binary_recall': 0.10963455, 'binary_specificity': 0.9929008, 'binary_f1_score': 0.16562109}
confusion matrix:
       0    1
0  18042  129
1    536   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.7200796, 'recall': 0.58484095, 'specificity': 0.58484095, 'f1': 0.6189603, 'auroc': 0.8125653, 'binary_precision': 0.47252747, 'binary_recall': 0.17768595, 'binary_specificity': 0.991996, 'binary_f1_score': 0.25825825}
confusion matrix:
      0   1
0  5949  48
1   199  43
new oracle model saved
early stop counter: 1
val acc:0.964576780796051, best validation acc: 0.96574866771698, corresponding to test acc:                         0.9586471915245056 / 0.9604102969169617
after epoch: 3,now: 2024-08-02 07:24:38.742205,epoch time: 0:32:18.388190,used: 1:37:48.351445,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_05_46_50_seed_2_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9595054, 'precision': 0.9611007, 'recall': 0.95951045, 'specificity': 0.95951045, 'f1': 0.9594707, 'auroc': 0.98787475, 'binary_precision': 0.98826534, 'binary_recall': 0.93006825, 'binary_specificity': 0.9889526, 'binary_f1_score': 0.9582841}
confusion matrix:
       0      1
0  28825    322
1   2039  27118
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.7139181, 'recall': 0.5909146, 'specificity': 0.5909146, 'f1': 0.62512934, 'auroc': 0.8102195, 'binary_precision': 0.45418328, 'binary_recall': 0.18936877, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.2672919}
confusion matrix:
       0    1
0  18034  137
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.75838256, 'recall': 0.66366863, 'specificity': 0.66366863, 'f1': 0.6991768, 'auroc': 0.85169375, 'binary_precision': 0.54304636, 'binary_recall': 0.338843, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.41730282}
confusion matrix:
      0   1
0  5928  69
1   160  82
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 07:56:57.599133,epoch time: 0:32:18.856928,used: 2:10:07.208373,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_05_46_50_seed_2_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9660915, 'precision': 0.9661613, 'recall': 0.9660926, 'specificity': 0.9660926, 'f1': 0.9660903, 'auroc': 0.991135, 'binary_precision': 0.9719078, 'binary_recall': 0.959941, 'binary_specificity': 0.97224414, 'binary_f1_score': 0.96588737}
confusion matrix:
       0      1
0  28338    809
1   1168  27989
---- Validation: 
scalar performance:
{'acc': 0.96574867, 'precision': 0.71957594, 'recall': 0.68517905, 'specificity': 0.68517905, 'f1': 0.7007525, 'auroc': 0.8556273, 'binary_precision': 0.45940593, 'binary_recall': 0.38538206, 'binary_specificity': 0.98497605, 'binary_f1_score': 0.4191509}
confusion matrix:
       0    1
0  17898  273
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.71063435, 'recall': 0.7528554, 'specificity': 0.7528554, 'f1': 0.72952473, 'auroc': 0.8814032, 'binary_precision': 0.44027305, 'binary_recall': 0.53305787, 'binary_specificity': 0.972653, 'binary_f1_score': 0.482243}
confusion matrix:
      0    1
0  5833  164
1   113  129
early stop counter: 1
val acc:0.96574866771698, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9632954001426697 / 0.9632954001426697
after epoch: 5,now: 2024-08-02 08:29:05.895856,epoch time: 0:32:08.296723,used: 2:42:15.505096,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_05_46_50_seed_2_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9679782, 'precision': 0.96866035, 'recall': 0.9679821, 'specificity': 0.9679821, 'f1': 0.96796674, 'auroc': 0.9923091, 'binary_precision': 0.986592, 'binary_recall': 0.9488648, 'binary_specificity': 0.9870994, 'binary_f1_score': 0.96736073}
confusion matrix:
       0      1
0  28770    376
1   1491  27667
---- Validation: 
scalar performance:
{'acc': 0.96574867, 'precision': 0.71484846, 'recall': 0.6538602, 'specificity': 0.6538602, 'f1': 0.67875665, 'auroc': 0.8628422, 'binary_precision': 0.45199063, 'binary_recall': 0.320598, 'binary_specificity': 0.98712236, 'binary_f1_score': 0.3751215}
confusion matrix:
       0    1
0  17937  234
1    409  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.76224303, 'recall': 0.7674381, 'specificity': 0.7674381, 'f1': 0.7648119, 'auroc': 0.8884971, 'binary_precision': 0.5425101, 'binary_recall': 0.553719, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.54805726}
confusion matrix:
      0    1
0  5884  113
1   108  134
new oracle model saved
early stop counter: 2
val acc:0.96574866771698, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9632954001426697 / 0.9645776748657227
after epoch: 6,now: 2024-08-02 09:01:18.653412,epoch time: 0:32:12.757556,used: 3:14:28.262652,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_05_46_50_seed_2_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9709111, 'precision': 0.9710884, 'recall': 0.97091275, 'specificity': 0.97091275, 'f1': 0.9709084, 'auroc': 0.9932883, 'binary_precision': 0.9802721, 'binary_recall': 0.9611757, 'binary_specificity': 0.9806498, 'binary_f1_score': 0.97063}
confusion matrix:
       0      1
0  28583    564
1   1132  28025
---- Validation: 
scalar performance:
{'acc': 0.96180683, 'precision': 0.69153416, 'recall': 0.6887642, 'specificity': 0.6887642, 'f1': 0.6901378, 'auroc': 0.8709998, 'binary_precision': 0.4030354, 'binary_recall': 0.39700997, 'binary_specificity': 0.9805184, 'binary_f1_score': 0.4}
confusion matrix:
       0    1
0  17817  354
1    363  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483892, 'precision': 0.6902309, 'recall': 0.7947066, 'specificity': 0.7947066, 'f1': 0.7292273, 'auroc': 0.8899043, 'binary_precision': 0.39583334, 'binary_recall': 0.6280992, 'binary_specificity': 0.96131396, 'binary_f1_score': 0.485623}
confusion matrix:
      0    1
0  5765  232
1    90  152
early stop counter: 3
val acc:0.9618068337440491, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9632954001426697 / 0.9645776748657227
after epoch: 7,now: 2024-08-02 09:33:34.598907,epoch time: 0:32:15.945495,used: 3:46:44.208147,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_05_46_50_seed_2_23919993
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 3:46:44.208147 at 2024-08-02 09:33:34.598907
persisted model performance metric: 

scalar performance:
{'acc': 0.9632954, 'precision': 0.75838256, 'recall': 0.66366863, 'specificity': 0.66366863, 'f1': 0.6991768, 'auroc': 0.85169375, 'binary_precision': 0.54304636, 'binary_recall': 0.338843, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.41730282}
confusion matrix:
      0   1
0  5928  69
1   160  82
oracle model performance metric: 

scalar performance:
{'acc': 0.9645777, 'precision': 0.76224303, 'recall': 0.7674381, 'specificity': 0.7674381, 'f1': 0.7648119, 'auroc': 0.8884971, 'binary_precision': 0.5425101, 'binary_recall': 0.553719, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.54805726}
confusion matrix:
      0    1
0  5884  113
1   108  134
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196706 KiB |   2142 MiB |   1037 TiB |   1037 TiB |
|       from large pool | 179211 KiB |   2124 MiB |   1025 TiB |   1025 TiB |
|       from small pool |  17495 KiB |     37 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196706 KiB |   2142 MiB |   1037 TiB |   1037 TiB |
|       from large pool | 179211 KiB |   2124 MiB |   1025 TiB |   1025 TiB |
|       from small pool |  17495 KiB |     37 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   2141 MiB |   1037 TiB |   1037 TiB |
|       from large pool | 178979 KiB |   2123 MiB |   1024 TiB |   1024 TiB |
|       from small pool |  16482 KiB |     36 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2354 MiB |   2372 MiB |   6600 MiB |   4246 MiB |
|       from large pool |   2316 MiB |   2330 MiB |   6530 MiB |   4214 MiB |
|       from small pool |     38 MiB |     42 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38814 KiB | 232750 KiB | 582737 GiB | 582737 GiB |
|       from large pool |  31733 KiB | 230336 KiB | 569852 GiB | 569852 GiB |
|       from small pool |   7081 KiB |  23492 KiB |  12884 GiB |  12884 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2986    |    7783    |  160004 K  |  160001 K  |
|       from large pool |      79    |     252    |   96579 K  |   96579 K  |
|       from small pool |    2907    |    7703    |   63424 K  |   63421 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2986    |    7783    |  160004 K  |  160001 K  |
|       from large pool |      79    |     252    |   96579 K  |   96579 K  |
|       from small pool |    2907    |    7703    |   63424 K  |   63421 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     118    |     303    |     188    |
|       from large pool |      96    |      97    |     268    |     172    |
|       from small pool |      19    |      21    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |    3660    |  101504 K  |  101504 K  |
|       from large pool |      11    |     100    |   73365 K  |   73365 K  |
|       from small pool |      30    |    3649    |   28139 K  |   28139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |   2124 MiB |   1025 TiB |   1025 TiB |
|       from small pool |      0 KiB |     37 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |   2124 MiB |   1025 TiB |   1025 TiB |
|       from small pool |      0 KiB |     37 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |   2123 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      0 KiB |     36 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   2372 MiB |   6600 MiB |   6370 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   6530 MiB |   6324 MiB |
|       from small pool |  24576 KiB |     42 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 232750 KiB | 582737 GiB | 582737 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 569853 GiB | 569853 GiB |
|       from small pool |      0 KiB |  23492 KiB |  12884 GiB |  12884 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  160004 K  |  160004 K  |
|       from large pool |       2    |     252    |   96579 K  |   96579 K  |
|       from small pool |       0    |    7703    |   63424 K  |   63424 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  160004 K  |  160004 K  |
|       from large pool |       2    |     252    |   96579 K  |   96579 K  |
|       from small pool |       0    |    7703    |   63424 K  |   63424 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     118    |     303    |     281    |
|       from large pool |      10    |      97    |     268    |     258    |
|       from small pool |      12    |      21    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3660    |  101505 K  |  101505 K  |
|       from large pool |       3    |     100    |   73365 K  |   73365 K  |
|       from small pool |       0    |    3649    |   28140 K  |   28140 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 09:35:03 2024]
Finished job 0.
1 of 1 steps (100%) done
