Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 21:38:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992

 Experiment start at: 2024-08-01 21:47:40.877822
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.06263982504606247
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88948745, 'precision': 0.8971745, 'recall': 0.8895336, 'specificity': 0.8895336, 'f1': 0.88895845, 'auroc': 0.9559345, 'binary_precision': 0.95259494, 'binary_recall': 0.81992406, 'binary_specificity': 0.9591431, 'binary_f1_score': 0.88129437}
confusion matrix:
       0      1
0  27490   1171
1   5168  23531
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9198595, 'precision': 0.49909875, 'recall': 0.49872625, 'specificity': 0.49872625, 'f1': 0.49825084, 'auroc': 0.50814116, 'binary_precision': 0.032502707, 'binary_recall': 0.0466563, 'binary_specificity': 0.9507962, 'binary_f1_score': 0.038314175}
confusion matrix:
       0    1
0  17256  893
1    613   30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93783957, 'precision': 0.60311896, 'recall': 0.5974357, 'specificity': 0.5974357, 'f1': 0.6001746, 'auroc': 0.8104806, 'binary_precision': 0.2398374, 'binary_recall': 0.22605364, 'binary_specificity': 0.9688178, 'binary_f1_score': 0.23274162}
confusion matrix:
      0    1
0  5810  187
1   202   59
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 22:07:59.404432,epoch time: 0:20:18.526610,used: 0:20:18.526610,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9223152, 'precision': 0.9265083, 'recall': 0.9223498, 'specificity': 0.9223498, 'f1': 0.9221281, 'auroc': 0.97428846, 'binary_precision': 0.96897244, 'binary_recall': 0.8726829, 'binary_specificity': 0.97201675, 'binary_f1_score': 0.9183105}
confusion matrix:
       0      1
0  27858    802
1   3654  25046
---- Validation: 
scalar performance:
{'acc': 0.9051724, 'precision': 0.5200508, 'recall': 0.5398761, 'specificity': 0.5398761, 'f1': 0.52315474, 'auroc': 0.6682018, 'binary_precision': 0.071482316, 'binary_recall': 0.14774494, 'binary_specificity': 0.93200725, 'binary_f1_score': 0.09634888}
confusion matrix:
       0     1
0  16915  1234
1    548    95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9346437, 'precision': 0.65602595, 'recall': 0.7551812, 'specificity': 0.7551812, 'f1': 0.6909654, 'auroc': 0.8690884, 'binary_precision': 0.3318182, 'binary_recall': 0.55938697, 'binary_specificity': 0.9509755, 'binary_f1_score': 0.4165478}
confusion matrix:
      0    1
0  5703  294
1   115  146
early stop counter: 1
val acc:0.9051724076271057, best validation acc: 0.9198595285415649, corresponding to test acc:                         0.9378395676612854 / 0.9378395676612854
after epoch: 2,now: 2024-08-01 22:27:12.773052,epoch time: 0:19:13.368620,used: 0:39:31.895230,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93607044, 'precision': 0.93820703, 'recall': 0.93609977, 'specificity': 0.93609977, 'f1': 0.9359953, 'auroc': 0.9799504, 'binary_precision': 0.9690158, 'binary_recall': 0.9010591, 'binary_specificity': 0.97114044, 'binary_f1_score': 0.93380266}
confusion matrix:
       0      1
0  27829    827
1   2840  25864
---- Validation: 
scalar performance:
{'acc': 0.92241377, 'precision': 0.54934835, 'recall': 0.58180463, 'specificity': 0.58180463, 'f1': 0.5597333, 'auroc': 0.73681366, 'binary_precision': 0.12717292, 'binary_recall': 0.21617419, 'binary_specificity': 0.94743514, 'binary_f1_score': 0.16013825}
confusion matrix:
       0    1
0  17195  954
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94231385, 'precision': 0.681826, 'recall': 0.78483593, 'specificity': 0.78483593, 'f1': 0.71969724, 'auroc': 0.88427037, 'binary_precision': 0.3809524, 'binary_recall': 0.6130268, 'binary_specificity': 0.956645, 'binary_f1_score': 0.4698972}
confusion matrix:
      0    1
0  5737  260
1   101  160
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 22:47:19.689541,epoch time: 0:20:06.916489,used: 0:59:38.811719,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94440377, 'precision': 0.94631964, 'recall': 0.94443476, 'specificity': 0.94443476, 'f1': 0.94434667, 'auroc': 0.9852978, 'binary_precision': 0.975798, 'binary_recall': 0.9115198, 'binary_specificity': 0.97734964, 'binary_f1_score': 0.9425643}
confusion matrix:
       0      1
0  28004    649
1   2540  26167
---- Validation: 
scalar performance:
{'acc': 0.9273095, 'precision': 0.562375, 'recall': 0.59859025, 'specificity': 0.59859025, 'f1': 0.5749118, 'auroc': 0.7620057, 'binary_precision': 0.1520693, 'binary_recall': 0.24572317, 'binary_specificity': 0.9514574, 'binary_f1_score': 0.1878716}
confusion matrix:
       0    1
0  17268  881
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94630873, 'precision': 0.69487584, 'recall': 0.7924173, 'specificity': 0.7924173, 'f1': 0.73205113, 'auroc': 0.892627, 'binary_precision': 0.4064838, 'binary_recall': 0.6245211, 'binary_specificity': 0.9603135, 'binary_f1_score': 0.49244714}
confusion matrix:
      0    1
0  5759  238
1    98  163
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 23:07:39.045874,epoch time: 0:20:19.356333,used: 1:19:58.168052,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95095885, 'precision': 0.9520118, 'recall': 0.9509792, 'specificity': 0.9509792, 'f1': 0.9509318, 'auroc': 0.9876858, 'binary_precision': 0.9740379, 'binary_recall': 0.9267001, 'binary_specificity': 0.97525823, 'binary_f1_score': 0.9497795}
confusion matrix:
       0      1
0  27947    709
1   2104  26600
---- Validation: 
scalar performance:
{'acc': 0.9066092, 'precision': 0.5656212, 'recall': 0.6553784, 'specificity': 0.6553784, 'f1': 0.5853381, 'auroc': 0.78583, 'binary_precision': 0.15422885, 'binary_recall': 0.38569206, 'binary_specificity': 0.92506474, 'binary_f1_score': 0.2203465}
confusion matrix:
       0     1
0  16789  1360
1    395   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92793226, 'precision': 0.65812016, 'recall': 0.82130814, 'specificity': 0.82130814, 'f1': 0.7053858, 'auroc': 0.8982429, 'binary_precision': 0.3297491, 'binary_recall': 0.70498085, 'binary_specificity': 0.9376355, 'binary_f1_score': 0.44932845}
confusion matrix:
      0    1
0  5623  374
1    77  184
early stop counter: 1
val acc:0.9066091775894165, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 5,now: 2024-08-01 23:28:21.930305,epoch time: 0:20:42.884431,used: 1:40:41.052483,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9536262, 'precision': 0.95456535, 'recall': 0.9536446, 'specificity': 0.9536446, 'f1': 0.95360357, 'auroc': 0.9894098, 'binary_precision': 0.9754281, 'binary_recall': 0.9307738, 'binary_specificity': 0.97651535, 'binary_f1_score': 0.95257795}
confusion matrix:
       0      1
0  27984    673
1   1987  26716
---- Validation: 
scalar performance:
{'acc': 0.9159217, 'precision': 0.5799007, 'recall': 0.67445064, 'specificity': 0.67445064, 'f1': 0.6040285, 'auroc': 0.8038162, 'binary_precision': 0.18150918, 'binary_recall': 0.41524106, 'binary_specificity': 0.93366027, 'binary_f1_score': 0.2526017}
confusion matrix:
       0     1
0  16945  1204
1    376   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9333653, 'precision': 0.6688582, 'recall': 0.82414293, 'specificity': 0.82414293, 'f1': 0.71662146, 'auroc': 0.90216434, 'binary_precision': 0.35114503, 'binary_recall': 0.70498085, 'binary_specificity': 0.943305, 'binary_f1_score': 0.4687898}
confusion matrix:
      0    1
0  5657  340
1    77  184
early stop counter: 2
val acc:0.915921688079834, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 6,now: 2024-08-01 23:48:54.930231,epoch time: 0:20:32.999926,used: 2:01:14.052409,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9556834, 'precision': 0.9566078, 'recall': 0.9556999, 'specificity': 0.9556999, 'f1': 0.955662, 'auroc': 0.99017, 'binary_precision': 0.9773366, 'binary_recall': 0.9330685, 'binary_specificity': 0.9783314, 'binary_f1_score': 0.9546896}
confusion matrix:
       0      1
0  28038    621
1   1921  26780
---- Validation: 
scalar performance:
{'acc': 0.90793955, 'precision': 0.5775666, 'recall': 0.6905697, 'specificity': 0.6905697, 'f1': 0.6023056, 'auroc': 0.8052272, 'binary_precision': 0.17552239, 'binary_recall': 0.45723173, 'binary_specificity': 0.92390764, 'binary_f1_score': 0.25366697}
confusion matrix:
       0     1
0  16768  1381
1    349   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9287312, 'precision': 0.6603881, 'recall': 0.82538974, 'specificity': 0.82538974, 'f1': 0.7083208, 'auroc': 0.9022436, 'binary_precision': 0.33393177, 'binary_recall': 0.7126437, 'binary_specificity': 0.93813574, 'binary_f1_score': 0.45476776}
confusion matrix:
      0    1
0  5626  371
1    75  186
early stop counter: 3
val acc:0.9079395532608032, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 7,now: 2024-08-02 00:09:25.930897,epoch time: 0:20:31.000666,used: 2:21:45.053075,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9598675, 'precision': 0.9604521, 'recall': 0.9598813, 'specificity': 0.9598813, 'f1': 0.9598556, 'auroc': 0.9919687, 'binary_precision': 0.97705096, 'binary_recall': 0.9419204, 'binary_specificity': 0.97784215, 'binary_f1_score': 0.95916414}
confusion matrix:
       0      1
0  28023    635
1   1667  27035
---- Validation: 
scalar performance:
{'acc': 0.90719455, 'precision': 0.5809507, 'recall': 0.70443505, 'specificity': 0.70443505, 'f1': 0.60730463, 'auroc': 0.8103701, 'binary_precision': 0.18123914, 'binary_recall': 0.4867807, 'binary_specificity': 0.9220894, 'binary_f1_score': 0.26413503}
confusion matrix:
       0     1
0  16735  1414
1    330   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92825186, 'precision': 0.6598743, 'recall': 0.8269719, 'specificity': 0.8269719, 'f1': 0.70801795, 'auroc': 0.90304476, 'binary_precision': 0.33274022, 'binary_recall': 0.71647507, 'binary_specificity': 0.9374687, 'binary_f1_score': 0.454435}
confusion matrix:
      0    1
0  5622  375
1    74  187
early stop counter: 4
val acc:0.9071945548057556, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 8,now: 2024-08-02 00:30:03.562152,epoch time: 0:20:37.631255,used: 2:42:22.684330,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9611925, 'precision': 0.9619144, 'recall': 0.96120775, 'specificity': 0.96120775, 'f1': 0.9611782, 'auroc': 0.9927894, 'binary_precision': 0.9803687, 'binary_recall': 0.9412933, 'binary_specificity': 0.9811222, 'binary_f1_score': 0.9604337}
confusion matrix:
       0      1
0  28117    541
1   1685  27017
---- Validation: 
scalar performance:
{'acc': 0.9051724, 'precision': 0.5791889, 'recall': 0.7041382, 'specificity': 0.7041382, 'f1': 0.60495925, 'auroc': 0.8068393, 'binary_precision': 0.17770232, 'binary_recall': 0.48833594, 'binary_specificity': 0.9199405, 'binary_f1_score': 0.26058093}
confusion matrix:
       0     1
0  16696  1453
1    329   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9258549, 'precision': 0.6551405, 'recall': 0.82388896, 'specificity': 0.82388896, 'f1': 0.70262504, 'auroc': 0.9006132, 'binary_precision': 0.32347825, 'binary_recall': 0.7126437, 'binary_specificity': 0.93513423, 'binary_f1_score': 0.44497606}
confusion matrix:
      0    1
0  5608  389
1    75  186
early stop counter: 5
val acc:0.9051724076271057, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 9,now: 2024-08-02 00:50:32.379579,epoch time: 0:20:28.817427,used: 3:02:51.501757,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9637378, 'precision': 0.9640049, 'recall': 0.963745, 'specificity': 0.963745, 'f1': 0.96373296, 'auroc': 0.993507, 'binary_precision': 0.9752866, 'binary_recall': 0.95163256, 'binary_specificity': 0.9758574, 'binary_f1_score': 0.96331435}
confusion matrix:
       0      1
0  27971    692
1   1388  27309
---- Validation: 
scalar performance:
{'acc': 0.90373564, 'precision': 0.5794991, 'recall': 0.7093948, 'specificity': 0.7093948, 'f1': 0.6055214, 'auroc': 0.8139204, 'binary_precision': 0.17790055, 'binary_recall': 0.5007776, 'binary_specificity': 0.918012, 'binary_f1_score': 0.26253566}
confusion matrix:
       0     1
0  16661  1488
1    321   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92138064, 'precision': 0.6484009, 'recall': 0.82521915, 'specificity': 0.82521915, 'f1': 0.69547033, 'auroc': 0.90223014, 'binary_precision': 0.30971992, 'binary_recall': 0.7203065, 'binary_specificity': 0.93013173, 'binary_f1_score': 0.4331797}
confusion matrix:
      0    1
0  5578  419
1    73  188
early stop counter: 6
val acc:0.9037356376647949, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 10,now: 2024-08-02 01:10:43.820193,epoch time: 0:20:11.440614,used: 3:23:02.942371,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9650802, 'precision': 0.9654403, 'recall': 0.96509, 'specificity': 0.96509, 'f1': 0.96507394, 'auroc': 0.994076, 'binary_precision': 0.9785609, 'binary_recall': 0.9510453, 'binary_specificity': 0.9791347, 'binary_f1_score': 0.9646069}
confusion matrix:
       0      1
0  28062    598
1   1405  27295
---- Validation: 
scalar performance:
{'acc': 0.9005428, 'precision': 0.5784303, 'recall': 0.7144923, 'specificity': 0.7144923, 'f1': 0.6041187, 'auroc': 0.8155081, 'binary_precision': 0.1753178, 'binary_recall': 0.5147745, 'binary_specificity': 0.91421014, 'binary_f1_score': 0.26155668}
confusion matrix:
       0     1
0  16592  1557
1    312   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.915628, 'precision': 0.64050466, 'recall': 0.8258823, 'specificity': 0.8258823, 'f1': 0.6865082, 'auroc': 0.90282416, 'binary_precision': 0.29366305, 'binary_recall': 0.72796935, 'binary_specificity': 0.9237952, 'binary_f1_score': 0.41850218}
confusion matrix:
      0    1
0  5540  457
1    71  190
early stop counter: 7
val acc:0.9005427956581116, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 11,now: 2024-08-02 01:31:13.150004,epoch time: 0:20:29.329811,used: 3:43:32.272182,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96570784, 'precision': 0.96626645, 'recall': 0.9657212, 'specificity': 0.9657212, 'f1': 0.96569824, 'auroc': 0.99407697, 'binary_precision': 0.98259866, 'binary_recall': 0.94826144, 'binary_specificity': 0.98318094, 'binary_f1_score': 0.9651248}
confusion matrix:
       0      1
0  28176    482
1   1485  27217
---- Validation: 
scalar performance:
{'acc': 0.91597486, 'precision': 0.5908352, 'recall': 0.7097308, 'specificity': 0.7097308, 'f1': 0.61995786, 'auroc': 0.8241664, 'binary_precision': 0.20076726, 'binary_recall': 0.48833594, 'binary_specificity': 0.9311257, 'binary_f1_score': 0.28454918}
confusion matrix:
       0     1
0  16899  1250
1    329   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9256951, 'precision': 0.6540681, 'recall': 0.82014096, 'specificity': 0.82014096, 'f1': 0.70098764, 'auroc': 0.9000375, 'binary_precision': 0.3216783, 'binary_recall': 0.70498085, 'binary_specificity': 0.935301, 'binary_f1_score': 0.44177672}
confusion matrix:
      0    1
0  5609  388
1    77  184
early stop counter: 8
val acc:0.9159748554229736, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 12,now: 2024-08-02 01:52:00.743917,epoch time: 0:20:47.593913,used: 4:04:19.866095,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9694212, 'precision': 0.96972394, 'recall': 0.9694306, 'specificity': 0.9694306, 'f1': 0.96941674, 'auroc': 0.9949974, 'binary_precision': 0.98183316, 'binary_recall': 0.9565869, 'binary_specificity': 0.98227435, 'binary_f1_score': 0.96904564}
confusion matrix:
       0      1
0  28151    508
1   1246  27455
---- Validation: 
scalar performance:
{'acc': 0.9101213, 'precision': 0.5858814, 'recall': 0.7127008, 'specificity': 0.7127008, 'f1': 0.61406296, 'auroc': 0.8231268, 'binary_precision': 0.19053255, 'binary_recall': 0.5007776, 'binary_specificity': 0.92462397, 'binary_f1_score': 0.27603945}
confusion matrix:
       0     1
0  16781  1368
1    321   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9181847, 'precision': 0.64221215, 'recall': 0.8180546, 'specificity': 0.8180546, 'f1': 0.6877461, 'auroc': 0.8961837, 'binary_precision': 0.2979066, 'binary_recall': 0.70881224, 'binary_specificity': 0.927297, 'binary_f1_score': 0.41950113}
confusion matrix:
      0    1
0  5561  436
1    76  185
early stop counter: 9
val acc:0.9101213216781616, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 13,now: 2024-08-02 02:12:48.091552,epoch time: 0:20:47.347635,used: 4:25:07.213730,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96769524, 'precision': 0.96809465, 'recall': 0.96770763, 'specificity': 0.96770763, 'f1': 0.96768904, 'auroc': 0.99486685, 'binary_precision': 0.9819781, 'binary_recall': 0.9529334, 'binary_specificity': 0.98248184, 'binary_f1_score': 0.9672378}
confusion matrix:
       0      1
0  28154    502
1   1351  27353
---- Validation: 
scalar performance:
{'acc': 0.9126756, 'precision': 0.5882654, 'recall': 0.71252304, 'specificity': 0.71252304, 'f1': 0.61704767, 'auroc': 0.824572, 'binary_precision': 0.1953602, 'binary_recall': 0.4976672, 'binary_specificity': 0.9273789, 'binary_f1_score': 0.2805787}
confusion matrix:
       0     1
0  16831  1318
1    323   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92090124, 'precision': 0.6468305, 'recall': 0.8213043, 'specificity': 0.8213043, 'f1': 0.69328636, 'auroc': 0.8975644, 'binary_precision': 0.3069307, 'binary_recall': 0.7126437, 'binary_specificity': 0.92996496, 'binary_f1_score': 0.42906573}
confusion matrix:
      0    1
0  5577  420
1    75  186
early stop counter: 10
val acc:0.9126756191253662, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 14,now: 2024-08-02 02:33:33.263213,epoch time: 0:20:45.171661,used: 4:45:52.385391,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9712343, 'precision': 0.9716764, 'recall': 0.97124565, 'specificity': 0.97124565, 'f1': 0.971228, 'auroc': 0.9956013, 'binary_precision': 0.98630136, 'binary_recall': 0.9557855, 'binary_specificity': 0.9867057, 'binary_f1_score': 0.9708037}
confusion matrix:
       0      1
0  28278    381
1   1269  27432
---- Validation: 
scalar performance:
{'acc': 0.9100681, 'precision': 0.5810718, 'recall': 0.696172, 'specificity': 0.696172, 'f1': 0.60706264, 'auroc': 0.81262594, 'binary_precision': 0.18214937, 'binary_recall': 0.466563, 'binary_specificity': 0.925781, 'binary_f1_score': 0.26200876}
confusion matrix:
       0     1
0  16802  1347
1    343   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9159476, 'precision': 0.63932544, 'recall': 0.81871974, 'specificity': 0.81871974, 'f1': 0.68448967, 'auroc': 0.895352, 'binary_precision': 0.2919937, 'binary_recall': 0.7126437, 'binary_specificity': 0.92479575, 'binary_f1_score': 0.4142539}
confusion matrix:
      0    1
0  5546  451
1    75  186
early stop counter: 11
val acc:0.9100680947303772, best validation acc: 0.927309513092041, corresponding to test acc:                         0.9463087320327759 / 0.9463087320327759
after epoch: 15,now: 2024-08-02 02:55:27.842634,epoch time: 0:21:54.579421,used: 5:07:46.964812,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_47_40_seed_0_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:07:46.964812 at 2024-08-02 02:55:27.842634
persisted model performance metric: 

scalar performance:
{'acc': 0.94630873, 'precision': 0.69487584, 'recall': 0.7924173, 'specificity': 0.7924173, 'f1': 0.73205113, 'auroc': 0.892627, 'binary_precision': 0.4064838, 'binary_recall': 0.6245211, 'binary_specificity': 0.9603135, 'binary_f1_score': 0.49244714}
confusion matrix:
      0    1
0  5759  238
1    98  163
oracle model performance metric: 

scalar performance:
{'acc': 0.94630873, 'precision': 0.69487584, 'recall': 0.7924173, 'specificity': 0.7924173, 'f1': 0.73205113, 'auroc': 0.892627, 'binary_precision': 0.4064838, 'binary_recall': 0.6245211, 'binary_specificity': 0.9603135, 'binary_f1_score': 0.49244714}
confusion matrix:
      0    1
0  5759  238
1    98  163
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    821 MiB |   8456 MiB | 359926 GiB | 359925 GiB |
|       from large pool |    783 MiB |   8413 MiB | 354164 GiB | 354163 GiB |
|       from small pool |     37 MiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    821 MiB |   8456 MiB | 359926 GiB | 359925 GiB |
|       from large pool |    783 MiB |   8413 MiB | 354164 GiB | 354163 GiB |
|       from small pool |     37 MiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    819 MiB |   8455 MiB | 359906 GiB | 359905 GiB |
|       from large pool |    782 MiB |   8412 MiB | 354156 GiB | 354155 GiB |
|       from small pool |     36 MiB |     77 MiB |   5749 GiB |   5749 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9400 MiB |   9400 MiB |   9400 MiB |      0 B   |
|       from large pool |   9314 MiB |   9314 MiB |   9314 MiB |      0 B   |
|       from small pool |     86 MiB |     86 MiB |     86 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  74301 KiB |    796 MiB | 193453 GiB | 193453 GiB |
|       from large pool |  59734 KiB |    795 MiB | 187685 GiB | 187685 GiB |
|       from small pool |  14567 KiB |     17 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3472    |    8159    |   71314 K  |   71310 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37868 K  |   37865 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3472    |    8159    |   71314 K  |   71310 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37868 K  |   37865 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     407    |     407    |     407    |       0    |
|       from large pool |     364    |     364    |     364    |       0    |
|       from small pool |      43    |      43    |      43    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3616    |   38646 K  |   38645 K  |
|       from large pool |      19    |     358    |   22155 K  |   22155 K  |
|       from small pool |      55    |    3598    |   16490 K  |   16490 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8456 MiB | 359926 GiB | 359926 GiB |
|       from large pool |  16640 KiB |   8413 MiB | 354164 GiB | 354164 GiB |
|       from small pool |      0 KiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8456 MiB | 359926 GiB | 359926 GiB |
|       from large pool |  16640 KiB |   8413 MiB | 354164 GiB | 354164 GiB |
|       from small pool |      0 KiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB | 359906 GiB | 359906 GiB |
|       from large pool |  16640 KiB |   8412 MiB | 354156 GiB | 354156 GiB |
|       from small pool |      0 KiB |     77 MiB |   5749 GiB |   5749 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    894 MiB |   9400 MiB |   9400 MiB |   8506 MiB |
|       from large pool |    842 MiB |   9314 MiB |   9314 MiB |   8472 MiB |
|       from small pool |     52 MiB |     86 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    796 MiB | 193454 GiB | 193453 GiB |
|       from large pool |  30464 KiB |    795 MiB | 187685 GiB | 187685 GiB |
|       from small pool |      0 KiB |     30 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71314 K  |   71314 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37868 K  |   37868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71314 K  |   71314 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37868 K  |   37868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     407    |     407    |     354    |
|       from large pool |      27    |     364    |     364    |     337    |
|       from small pool |      26    |      43    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3616    |   38647 K  |   38647 K  |
|       from large pool |       2    |     358    |   22155 K  |   22155 K  |
|       from small pool |       0    |    3598    |   16492 K  |   16492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8456 MiB | 359926 GiB | 359926 GiB |
|       from large pool |  16640 KiB |   8413 MiB | 354164 GiB | 354164 GiB |
|       from small pool |      0 KiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8456 MiB | 359926 GiB | 359926 GiB |
|       from large pool |  16640 KiB |   8413 MiB | 354164 GiB | 354164 GiB |
|       from small pool |      0 KiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB | 359906 GiB | 359906 GiB |
|       from large pool |  16640 KiB |   8412 MiB | 354156 GiB | 354156 GiB |
|       from small pool |      0 KiB |     77 MiB |   5749 GiB |   5749 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    894 MiB |   9400 MiB |   9400 MiB |   8506 MiB |
|       from large pool |    842 MiB |   9314 MiB |   9314 MiB |   8472 MiB |
|       from small pool |     52 MiB |     86 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    796 MiB | 193454 GiB | 193453 GiB |
|       from large pool |  30464 KiB |    795 MiB | 187685 GiB | 187685 GiB |
|       from small pool |      0 KiB |     30 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71314 K  |   71314 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37868 K  |   37868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71314 K  |   71314 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37868 K  |   37868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     407    |     407    |     354    |
|       from large pool |      27    |     364    |     364    |     337    |
|       from small pool |      26    |      43    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3616    |   38647 K  |   38647 K  |
|       from large pool |       2    |     358    |   22155 K  |   22155 K  |
|       from small pool |       0    |    3598    |   16492 K  |   16492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992

 Experiment start at: 2024-08-02 03:07:19.561422
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.65887850522995
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8872015, 'precision': 0.8892531, 'recall': 0.88722795, 'specificity': 0.88722795, 'f1': 0.88705754, 'auroc': 0.9536883, 'binary_precision': 0.91769546, 'binary_recall': 0.8508793, 'binary_specificity': 0.9235766, 'binary_f1_score': 0.8830253}
confusion matrix:
       0      1
0  26587   2200
1   4299  24530
---- Validation: 
scalar performance:
{'acc': 0.8194771, 'precision': 0.5388528, 'recall': 0.66604644, 'specificity': 0.66604644, 'f1': 0.5324575, 'auroc': 0.74243724, 'binary_precision': 0.099586286, 'binary_recall': 0.5007429, 'binary_specificity': 0.83134997, 'binary_f1_score': 0.1661326}
confusion matrix:
       0     1
0  15020  3047
1    336   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87222046, 'precision': 0.58535516, 'recall': 0.7530958, 'specificity': 0.7530958, 'f1': 0.6099273, 'auroc': 0.85044587, 'binary_precision': 0.18903151, 'binary_recall': 0.6230769, 'binary_specificity': 0.8831147, 'binary_f1_score': 0.2900627}
confusion matrix:
      0    1
0  5251  695
1    98  162
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 03:29:29.799420,epoch time: 0:22:10.237998,used: 0:22:10.237998,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9219488, 'precision': 0.9242523, 'recall': 0.9219744, 'specificity': 0.9219744, 'f1': 0.9218458, 'auroc': 0.9737549, 'binary_precision': 0.9556879, 'binary_recall': 0.8850423, 'binary_specificity': 0.9589065, 'binary_f1_score': 0.9190094}
confusion matrix:
       0      1
0  27605   1183
1   3314  25514
---- Validation: 
scalar performance:
{'acc': 0.88858056, 'precision': 0.5790472, 'recall': 0.7347876, 'specificity': 0.7347876, 'f1': 0.6040468, 'auroc': 0.817159, 'binary_precision': 0.17560752, 'binary_recall': 0.5690936, 'binary_specificity': 0.9004815, 'binary_f1_score': 0.26839525}
confusion matrix:
       0     1
0  16269  1798
1    290   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9044473, 'precision': 0.62561136, 'recall': 0.8158885, 'specificity': 0.8158885, 'f1': 0.6674751, 'auroc': 0.8937626, 'binary_precision': 0.26449788, 'binary_recall': 0.7192308, 'binary_specificity': 0.9125463, 'binary_f1_score': 0.3867632}
confusion matrix:
      0    1
0  5426  520
1    73  187
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 03:50:58.762556,epoch time: 0:21:28.963136,used: 0:43:39.201134,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9378645, 'precision': 0.9394686, 'recall': 0.93788767, 'specificity': 0.93788767, 'f1': 0.93780994, 'auroc': 0.98149467, 'binary_precision': 0.9662112, 'binary_recall': 0.90756154, 'binary_specificity': 0.96821374, 'binary_f1_score': 0.9359685}
confusion matrix:
       0      1
0  27871    915
1   2665  26165
---- Validation: 
scalar performance:
{'acc': 0.9163821, 'precision': 0.6076309, 'recall': 0.7520672, 'specificity': 0.7520672, 'f1': 0.64301676, 'auroc': 0.84678566, 'binary_precision': 0.23201439, 'binary_recall': 0.5750371, 'binary_specificity': 0.92909724, 'binary_f1_score': 0.33062792}
confusion matrix:
       0     1
0  16786  1281
1    286   387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92217207, 'precision': 0.652858, 'recall': 0.8380113, 'specificity': 0.8380113, 'f1': 0.70180714, 'auroc': 0.90814376, 'binary_precision': 0.31751227, 'binary_recall': 0.74615383, 'binary_specificity': 0.9298688, 'binary_f1_score': 0.44546497}
confusion matrix:
      0    1
0  5529  417
1    66  194
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 04:12:02.204459,epoch time: 0:21:03.441903,used: 1:04:42.643037,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9473063, 'precision': 0.9479983, 'recall': 0.9473214, 'specificity': 0.9473214, 'f1': 0.9472872, 'auroc': 0.9860724, 'binary_precision': 0.9657975, 'binary_recall': 0.9275408, 'binary_specificity': 0.96710205, 'binary_f1_score': 0.9462827}
confusion matrix:
       0      1
0  27839    947
1   2089  26741
---- Validation: 
scalar performance:
{'acc': 0.90901816, 'precision': 0.6045039, 'recall': 0.77113664, 'specificity': 0.77113664, 'f1': 0.64036494, 'auroc': 0.85682154, 'binary_precision': 0.22406417, 'binary_recall': 0.6225854, 'binary_specificity': 0.9196878, 'binary_f1_score': 0.32953203}
confusion matrix:
       0     1
0  16616  1451
1    254   419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91459876, 'precision': 0.6449942, 'recall': 0.85061, 'specificity': 0.85061, 'f1': 0.69378865, 'auroc': 0.91331017, 'binary_precision': 0.30029586, 'binary_recall': 0.7807692, 'binary_specificity': 0.92045075, 'binary_f1_score': 0.4337607}
confusion matrix:
      0    1
0  5473  473
1    57  203
early stop counter: 1
val acc:0.9090181589126587, best validation acc: 0.9163820743560791, corresponding to test acc:                         0.9221720695495605 / 0.9221720695495605
after epoch: 4,now: 2024-08-02 04:32:48.176001,epoch time: 0:20:45.971542,used: 1:25:28.614579,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95013535, 'precision': 0.9508071, 'recall': 0.9501488, 'specificity': 0.9501488, 'f1': 0.9501178, 'auroc': 0.9877033, 'binary_precision': 0.96838343, 'binary_recall': 0.93072706, 'binary_specificity': 0.96957064, 'binary_f1_score': 0.9491819}
confusion matrix:
       0      1
0  27912    876
1   1997  26831
---- Validation: 
scalar performance:
{'acc': 0.9286019, 'precision': 0.6307831, 'recall': 0.77628636, 'specificity': 0.77628636, 'f1': 0.6716221, 'auroc': 0.86689496, 'binary_precision': 0.27669576, 'binary_recall': 0.6121842, 'binary_specificity': 0.94038856, 'binary_f1_score': 0.38112858}
confusion matrix:
       0     1
0  16990  1077
1    261   412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93280697, 'precision': 0.6721523, 'recall': 0.8435613, 'specificity': 0.8435613, 'f1': 0.7230305, 'auroc': 0.91589886, 'binary_precision': 0.3559633, 'binary_recall': 0.74615383, 'binary_specificity': 0.9409687, 'binary_f1_score': 0.48198757}
confusion matrix:
      0    1
0  5595  351
1    66  194
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-02 04:53:46.637447,epoch time: 0:20:58.461446,used: 1:46:27.076025,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9521834, 'precision': 0.9535091, 'recall': 0.9522033, 'specificity': 0.9522033, 'f1': 0.95214987, 'auroc': 0.9894687, 'binary_precision': 0.9782114, 'binary_recall': 0.9250408, 'binary_specificity': 0.9793657, 'binary_f1_score': 0.9508834}
confusion matrix:
       0      1
0  28193    594
1   2161  26668
---- Validation: 
scalar performance:
{'acc': 0.93207043, 'precision': 0.63462234, 'recall': 0.76807153, 'specificity': 0.76807153, 'f1': 0.6743888, 'auroc': 0.8659507, 'binary_precision': 0.28510028, 'binary_recall': 0.59138185, 'binary_specificity': 0.94476116, 'binary_f1_score': 0.3847269}
confusion matrix:
       0    1
0  17069  998
1    275  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93699646, 'precision': 0.6810951, 'recall': 0.8457476, 'specificity': 0.8457476, 'f1': 0.73223156, 'auroc': 0.917732, 'binary_precision': 0.37379575, 'binary_recall': 0.74615383, 'binary_specificity': 0.9453414, 'binary_f1_score': 0.4980744}
confusion matrix:
      0    1
0  5621  325
1    66  194
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-02 05:14:08.464297,epoch time: 0:20:21.826850,used: 2:06:48.902875,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9560886, 'precision': 0.95649624, 'recall': 0.95609903, 'specificity': 0.95609903, 'f1': 0.9560795, 'auroc': 0.99041677, 'binary_precision': 0.9703126, 'binary_recall': 0.94102955, 'binary_specificity': 0.9711685, 'binary_f1_score': 0.9554468}
confusion matrix:
       0      1
0  27958    830
1   1700  27128
---- Validation: 
scalar performance:
{'acc': 0.9265742, 'precision': 0.629443, 'recall': 0.78381795, 'specificity': 0.78381795, 'f1': 0.67113304, 'auroc': 0.8712684, 'binary_precision': 0.27337202, 'binary_recall': 0.63001484, 'binary_specificity': 0.93762106, 'binary_f1_score': 0.38129497}
confusion matrix:
       0     1
0  16940  1127
1    249   424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9311956, 'precision': 0.6703502, 'recall': 0.8500763, 'specificity': 0.8500763, 'f1': 0.72216064, 'auroc': 0.9182657, 'binary_precision': 0.3516874, 'binary_recall': 0.76153845, 'binary_specificity': 0.9386142, 'binary_f1_score': 0.4811665}
confusion matrix:
      0    1
0  5581  365
1    62  198
early stop counter: 1
val acc:0.926574170589447, best validation acc: 0.9320704340934753, corresponding to test acc:                         0.9369964599609375 / 0.9369964599609375
after epoch: 7,now: 2024-08-02 05:34:23.832501,epoch time: 0:20:15.368204,used: 2:27:04.271079,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95872676, 'precision': 0.9592912, 'recall': 0.95874023, 'specificity': 0.95874023, 'f1': 0.9587149, 'auroc': 0.9914031, 'binary_precision': 0.9755843, 'binary_recall': 0.94106835, 'binary_specificity': 0.9764121, 'binary_f1_score': 0.95801556}
confusion matrix:
       0      1
0  28107    679
1   1699  27131
---- Validation: 
scalar performance:
{'acc': 0.9304162, 'precision': 0.63595474, 'recall': 0.7850953, 'specificity': 0.7850953, 'f1': 0.6782896, 'auroc': 0.8732514, 'binary_precision': 0.28639135, 'binary_recall': 0.62852895, 'binary_specificity': 0.9416616, 'binary_f1_score': 0.39348838}
confusion matrix:
       0     1
0  17013  1054
1    250   423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93055105, 'precision': 0.6687522, 'recall': 0.847901, 'specificity': 0.847901, 'f1': 0.72018945, 'auroc': 0.91845846, 'binary_precision': 0.34867257, 'binary_recall': 0.75769234, 'binary_specificity': 0.93810964, 'binary_f1_score': 0.47757575}
confusion matrix:
      0    1
0  5578  368
1    63  197
early stop counter: 2
val acc:0.9304162263870239, best validation acc: 0.9320704340934753, corresponding to test acc:                         0.9369964599609375 / 0.9369964599609375
after epoch: 8,now: 2024-08-02 05:53:49.012367,epoch time: 0:19:25.179866,used: 2:46:29.450945,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9605492, 'precision': 0.96114707, 'recall': 0.96056235, 'specificity': 0.96056235, 'f1': 0.9605371, 'auroc': 0.9920678, 'binary_precision': 0.9779354, 'binary_recall': 0.9424191, 'binary_specificity': 0.97870564, 'binary_f1_score': 0.95984876}
confusion matrix:
       0      1
0  28174    613
1   1660  27169
---- Validation: 
scalar performance:
{'acc': 0.9391142, 'precision': 0.6502618, 'recall': 0.7745856, 'specificity': 0.7745856, 'f1': 0.69062924, 'auroc': 0.8748698, 'binary_precision': 0.31603774, 'binary_recall': 0.5973254, 'binary_specificity': 0.9518459, 'binary_f1_score': 0.41336763}
confusion matrix:
       0    1
0  17197  870
1    271  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94489205, 'precision': 0.6998106, 'recall': 0.84435105, 'specificity': 0.84435105, 'f1': 0.74918175, 'auroc': 0.91923916, 'binary_precision': 0.41163793, 'binary_recall': 0.7346154, 'binary_specificity': 0.9540868, 'binary_f1_score': 0.5276243}
confusion matrix:
      0    1
0  5673  273
1    69  191
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-02 06:13:08.210988,epoch time: 0:19:19.198621,used: 3:05:48.649566,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9625104, 'precision': 0.96311426, 'recall': 0.9625237, 'specificity': 0.9625237, 'f1': 0.9624989, 'auroc': 0.99322116, 'binary_precision': 0.9800209, 'binary_recall': 0.9443269, 'binary_specificity': 0.98072046, 'binary_f1_score': 0.96184283}
confusion matrix:
       0      1
0  28232    555
1   1605  27224
---- Validation: 
scalar performance:
{'acc': 0.939968, 'precision': 0.65142137, 'recall': 0.77145207, 'specificity': 0.77145207, 'f1': 0.69106066, 'auroc': 0.8733338, 'binary_precision': 0.31861958, 'binary_recall': 0.58989596, 'binary_specificity': 0.95300823, 'binary_f1_score': 0.41375715}
confusion matrix:
       0    1
0  17218  849
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9466645, 'precision': 0.70403975, 'recall': 0.8397591, 'specificity': 0.8397591, 'f1': 0.75177306, 'auroc': 0.9182404, 'binary_precision': 0.42058167, 'binary_recall': 0.72307694, 'binary_specificity': 0.9564413, 'binary_f1_score': 0.53182465}
confusion matrix:
      0    1
0  5687  259
1    72  188
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-02 06:32:35.560497,epoch time: 0:19:27.349509,used: 3:25:15.999075,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9653395, 'precision': 0.9656157, 'recall': 0.965348, 'specificity': 0.965348, 'f1': 0.9653348, 'auroc': 0.99369097, 'binary_precision': 0.97713125, 'binary_recall': 0.9530318, 'binary_specificity': 0.9776643, 'binary_f1_score': 0.964931}
confusion matrix:
       0      1
0  28145    643
1   1354  27474
---- Validation: 
scalar performance:
{'acc': 0.92790824, 'precision': 0.63358206, 'recall': 0.79237777, 'specificity': 0.79237777, 'f1': 0.6766995, 'auroc': 0.8775499, 'binary_precision': 0.28100777, 'binary_recall': 0.64635956, 'binary_specificity': 0.938396, 'binary_f1_score': 0.39171547}
confusion matrix:
       0     1
0  16954  1113
1    238   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9282952, 'precision': 0.66488475, 'recall': 0.8485627, 'specificity': 0.8485627, 'f1': 0.7162049, 'auroc': 0.91605604, 'binary_precision': 0.34079173, 'binary_recall': 0.76153845, 'binary_specificity': 0.9355869, 'binary_f1_score': 0.47086802}
confusion matrix:
      0    1
0  5563  383
1    62  198
early stop counter: 1
val acc:0.9279082417488098, best validation acc: 0.9399679899215698, corresponding to test acc:                         0.9466645121574402 / 0.9466645121574402
after epoch: 11,now: 2024-08-02 06:51:44.439540,epoch time: 0:19:08.879043,used: 3:44:24.878118,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9662767, 'precision': 0.966586, 'recall': 0.96628577, 'specificity': 0.96628577, 'f1': 0.96627164, 'auroc': 0.9941149, 'binary_precision': 0.97877264, 'binary_recall': 0.9532746, 'binary_specificity': 0.9792969, 'binary_f1_score': 0.9658554}
confusion matrix:
       0      1
0  28192    596
1   1347  27481
---- Validation: 
scalar performance:
{'acc': 0.92998934, 'precision': 0.63689125, 'recall': 0.7920265, 'specificity': 0.7920265, 'f1': 0.6802237, 'auroc': 0.8761261, 'binary_precision': 0.28770763, 'binary_recall': 0.6433878, 'binary_specificity': 0.9406653, 'binary_f1_score': 0.39761245}
confusion matrix:
       0     1
0  16995  1072
1    240   433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93280697, 'precision': 0.67284966, 'recall': 0.84723926, 'specificity': 0.84723926, 'f1': 0.7243049, 'auroc': 0.9168626, 'binary_precision': 0.35701275, 'binary_recall': 0.75384617, 'binary_specificity': 0.94063234, 'binary_f1_score': 0.48454884}
confusion matrix:
      0    1
0  5593  353
1    64  196
early stop counter: 2
val acc:0.9299893379211426, best validation acc: 0.9399679899215698, corresponding to test acc:                         0.9466645121574402 / 0.9466645121574402
after epoch: 12,now: 2024-08-02 07:11:13.142614,epoch time: 0:19:28.703074,used: 4:03:53.581192,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96723133, 'precision': 0.9677862, 'recall': 0.96724397, 'specificity': 0.96724397, 'f1': 0.9672222, 'auroc': 0.99460113, 'binary_precision': 0.9840802, 'binary_recall': 0.94987684, 'binary_specificity': 0.9846111, 'binary_f1_score': 0.966676}
confusion matrix:
       0      1
0  28344    443
1   1445  27384
---- Validation: 
scalar performance:
{'acc': 0.94002134, 'precision': 0.6520672, 'recall': 0.7736256, 'specificity': 0.7736256, 'f1': 0.69209415, 'auroc': 0.87252605, 'binary_precision': 0.3197442, 'binary_recall': 0.5943536, 'binary_specificity': 0.95289755, 'binary_f1_score': 0.41580042}
confusion matrix:
       0    1
0  17216  851
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94086367, 'precision': 0.68769383, 'recall': 0.8330539, 'specificity': 0.8330539, 'f1': 0.73597145, 'auroc': 0.9143057, 'binary_precision': 0.38830897, 'binary_recall': 0.7153846, 'binary_specificity': 0.9507232, 'binary_f1_score': 0.5033829}
confusion matrix:
      0    1
0  5653  293
1    74  186
better model found
persisted
after epoch: 13,now: 2024-08-02 07:30:22.050731,epoch time: 0:19:08.908117,used: 4:23:02.489309,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96705776, 'precision': 0.96762824, 'recall': 0.9670706, 'specificity': 0.9670706, 'f1': 0.96704835, 'auroc': 0.99439967, 'binary_precision': 0.9841441, 'binary_recall': 0.9494606, 'binary_specificity': 0.9846806, 'binary_f1_score': 0.9664913}
confusion matrix:
       0      1
0  28346    441
1   1457  27372
---- Validation: 
scalar performance:
{'acc': 0.92475986, 'precision': 0.6277126, 'recall': 0.7878839, 'specificity': 0.7878839, 'f1': 0.66967684, 'auroc': 0.87067425, 'binary_precision': 0.26954347, 'binary_recall': 0.640416, 'binary_specificity': 0.9353517, 'binary_f1_score': 0.37940142}
confusion matrix:
       0     1
0  16899  1168
1    242   431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9165324, 'precision': 0.64618134, 'recall': 0.8442631, 'specificity': 0.8442631, 'f1': 0.6947194, 'auroc': 0.9122927, 'binary_precision': 0.30335367, 'binary_recall': 0.7653846, 'binary_specificity': 0.9231416, 'binary_f1_score': 0.43449786}
confusion matrix:
      0    1
0  5489  457
1    61  199
early stop counter: 1
val acc:0.9247598648071289, best validation acc: 0.9400213360786438, corresponding to test acc:                         0.9408636689186096 / 0.9466645121574402
after epoch: 14,now: 2024-08-02 07:49:14.602622,epoch time: 0:18:52.551891,used: 4:41:55.041200,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9677694, 'precision': 0.9682612, 'recall': 0.9677807, 'specificity': 0.9677807, 'f1': 0.9677614, 'auroc': 0.9952074, 'binary_precision': 0.9836113, 'binary_recall': 0.9514361, 'binary_specificity': 0.9841253, 'binary_f1_score': 0.9672562}
confusion matrix:
       0      1
0  28331    457
1   1400  27428
---- Validation: 
scalar performance:
{'acc': 0.9329776, 'precision': 0.64247334, 'recall': 0.79357636, 'specificity': 0.79357636, 'f1': 0.6862916, 'auroc': 0.88064635, 'binary_precision': 0.29882678, 'binary_recall': 0.6433878, 'binary_specificity': 0.94376487, 'binary_f1_score': 0.40810555}
confusion matrix:
       0     1
0  17051  1016
1    240   433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9286175, 'precision': 0.6636529, 'recall': 0.83953595, 'specificity': 0.83953595, 'f1': 0.7136878, 'auroc': 0.9148005, 'binary_precision': 0.33919156, 'binary_recall': 0.74230766, 'binary_specificity': 0.93676424, 'binary_f1_score': 0.46562123}
confusion matrix:
      0    1
0  5570  376
1    67  193
early stop counter: 2
val acc:0.9329776167869568, best validation acc: 0.9400213360786438, corresponding to test acc:                         0.9408636689186096 / 0.9466645121574402
after epoch: 15,now: 2024-08-02 08:08:02.656986,epoch time: 0:18:48.054364,used: 5:00:43.095564,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_03_07_18_seed_1_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:00:43.095564 at 2024-08-02 08:08:02.656986
persisted model performance metric: 

scalar performance:
{'acc': 0.94086367, 'precision': 0.68769383, 'recall': 0.8330539, 'specificity': 0.8330539, 'f1': 0.73597145, 'auroc': 0.9143057, 'binary_precision': 0.38830897, 'binary_recall': 0.7153846, 'binary_specificity': 0.9507232, 'binary_f1_score': 0.5033829}
confusion matrix:
      0    1
0  5653  293
1    74  186
oracle model performance metric: 

scalar performance:
{'acc': 0.9466645, 'precision': 0.70403975, 'recall': 0.8397591, 'specificity': 0.8397591, 'f1': 0.75177306, 'auroc': 0.9182404, 'binary_precision': 0.42058167, 'binary_recall': 0.72307694, 'binary_specificity': 0.9564413, 'binary_f1_score': 0.53182465}
confusion matrix:
      0    1
0  5687  259
1    72  188
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    822 MiB |   8458 MiB | 726497 GiB | 726496 GiB |
|       from large pool |    784 MiB |   8415 MiB | 714922 GiB | 714922 GiB |
|       from small pool |     37 MiB |     78 MiB |  11574 GiB |  11574 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    822 MiB |   8458 MiB | 726497 GiB | 726496 GiB |
|       from large pool |    784 MiB |   8415 MiB | 714922 GiB | 714922 GiB |
|       from small pool |     37 MiB |     78 MiB |  11574 GiB |  11574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    819 MiB |   8455 MiB | 724813 GiB | 724812 GiB |
|       from large pool |    782 MiB |   8412 MiB | 713264 GiB | 713263 GiB |
|       from small pool |     36 MiB |     77 MiB |  11549 GiB |  11549 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9372 MiB |   9400 MiB |  17878 MiB |   8506 MiB |
|       from large pool |   9292 MiB |   9314 MiB |  17764 MiB |   8472 MiB |
|       from small pool |     80 MiB |     86 MiB |    114 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  53122 KiB |    796 MiB | 393662 GiB | 393661 GiB |
|       from large pool |  38543 KiB |    795 MiB | 382070 GiB | 382070 GiB |
|       from small pool |  14579 KiB |     30 MiB |  11591 GiB |  11591 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3448    |    8191    |  143283 K  |  143279 K  |
|       from large pool |     161    |     844    |   67339 K  |   67339 K  |
|       from small pool |    3287    |    8028    |   75943 K  |   75940 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3448    |    8191    |  143283 K  |  143279 K  |
|       from large pool |     161    |     844    |   67339 K  |   67339 K  |
|       from small pool |    3287    |    8028    |   75943 K  |   75940 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     402    |     407    |     756    |     354    |
|       from large pool |     362    |     364    |     699    |     337    |
|       from small pool |      40    |      43    |      57    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3631    |   78978 K  |   78978 K  |
|       from large pool |      17    |     358    |   46356 K  |   46356 K  |
|       from small pool |      55    |    3615    |   32621 K  |   32621 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8458 MiB | 726497 GiB | 726497 GiB |
|       from large pool |  16640 KiB |   8415 MiB | 714922 GiB | 714922 GiB |
|       from small pool |      0 KiB |     78 MiB |  11574 GiB |  11574 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8458 MiB | 726497 GiB | 726497 GiB |
|       from large pool |  16640 KiB |   8415 MiB | 714922 GiB | 714922 GiB |
|       from small pool |      0 KiB |     78 MiB |  11574 GiB |  11574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB | 724813 GiB | 724813 GiB |
|       from large pool |  16640 KiB |   8412 MiB | 713264 GiB | 713264 GiB |
|       from small pool |      0 KiB |     77 MiB |  11549 GiB |  11549 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    874 MiB |   9400 MiB |  17878 MiB |  17004 MiB |
|       from large pool |    822 MiB |   9314 MiB |  17764 MiB |  16942 MiB |
|       from small pool |     52 MiB |     86 MiB |    114 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    796 MiB | 393662 GiB | 393662 GiB |
|       from large pool |  30464 KiB |    795 MiB | 382070 GiB | 382070 GiB |
|       from small pool |      0 KiB |     31 MiB |  11591 GiB |  11591 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143283 K  |  143283 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75943 K  |   75943 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143283 K  |  143283 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75943 K  |   75943 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      52    |     407    |     756    |     704    |
|       from large pool |      26    |     364    |     699    |     673    |
|       from small pool |      26    |      43    |      57    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3631    |   78979 K  |   78979 K  |
|       from large pool |       2    |     358    |   46356 K  |   46356 K  |
|       from small pool |       0    |    3615    |   32622 K  |   32622 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8458 MiB | 726497 GiB | 726497 GiB |
|       from large pool |  16640 KiB |   8415 MiB | 714922 GiB | 714922 GiB |
|       from small pool |      0 KiB |     78 MiB |  11574 GiB |  11574 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8458 MiB | 726497 GiB | 726497 GiB |
|       from large pool |  16640 KiB |   8415 MiB | 714922 GiB | 714922 GiB |
|       from small pool |      0 KiB |     78 MiB |  11574 GiB |  11574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB | 724813 GiB | 724813 GiB |
|       from large pool |  16640 KiB |   8412 MiB | 713264 GiB | 713264 GiB |
|       from small pool |      0 KiB |     77 MiB |  11549 GiB |  11549 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    874 MiB |   9400 MiB |  17878 MiB |  17004 MiB |
|       from large pool |    822 MiB |   9314 MiB |  17764 MiB |  16942 MiB |
|       from small pool |     52 MiB |     86 MiB |    114 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    796 MiB | 393662 GiB | 393662 GiB |
|       from large pool |  30464 KiB |    795 MiB | 382070 GiB | 382070 GiB |
|       from small pool |      0 KiB |     31 MiB |  11591 GiB |  11591 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143283 K  |  143283 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75943 K  |   75943 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143283 K  |  143283 K  |
|       from large pool |       2    |     844    |   67339 K  |   67339 K  |
|       from small pool |       0    |    8028    |   75943 K  |   75943 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      52    |     407    |     756    |     704    |
|       from large pool |      26    |     364    |     699    |     673    |
|       from small pool |      26    |      43    |      57    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3631    |   78979 K  |   78979 K  |
|       from large pool |       2    |     358    |   46356 K  |   46356 K  |
|       from small pool |       0    |    3615    |   32622 K  |   32622 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992

 Experiment start at: 2024-08-02 08:18:27.713737
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.9104022979736328
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88321555, 'precision': 0.88341963, 'recall': 0.8832183, 'specificity': 0.8832183, 'f1': 0.8832005, 'auroc': 0.95208275, 'binary_precision': 0.8923255, 'binary_recall': 0.8716691, 'binary_specificity': 0.8947675, 'binary_f1_score': 0.88187635}
confusion matrix:
       0      1
0  26078   3067
1   3742  25417
---- Validation: 
scalar performance:
{'acc': 0.8529271, 'precision': 0.51972777, 'recall': 0.57309514, 'specificity': 0.57309514, 'f1': 0.513314, 'auroc': 0.69378674, 'binary_precision': 0.06629168, 'binary_recall': 0.2740864, 'binary_specificity': 0.8721039, 'binary_f1_score': 0.10676156}
confusion matrix:
       0     1
0  15847  2324
1    437   165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8485334, 'precision': 0.5290284, 'recall': 0.59207565, 'specificity': 0.59207565, 'f1': 0.52776325, 'auroc': 0.73565567, 'binary_precision': 0.08888889, 'binary_recall': 0.3140496, 'binary_specificity': 0.8701017, 'binary_f1_score': 0.13855971}
confusion matrix:
      0    1
0  5218  779
1   166   76
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 08:38:02.542903,epoch time: 0:19:34.829166,used: 0:19:34.829166,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.91722697, 'precision': 0.91953444, 'recall': 0.91723335, 'specificity': 0.91723335, 'f1': 0.9171138, 'auroc': 0.9720899, 'binary_precision': 0.9506909, 'binary_recall': 0.8801317, 'binary_specificity': 0.9543349, 'binary_f1_score': 0.9140516}
confusion matrix:
       0      1
0  27816   1331
1   3495  25662
---- Validation: 
scalar performance:
{'acc': 0.9076333, 'precision': 0.5614103, 'recall': 0.65355265, 'specificity': 0.65355265, 'f1': 0.5803066, 'auroc': 0.7952743, 'binary_precision': 0.14447236, 'binary_recall': 0.3820598, 'binary_specificity': 0.92504543, 'binary_f1_score': 0.20966272}
confusion matrix:
       0     1
0  16809  1362
1    372   230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89373296, 'precision': 0.57754266, 'recall': 0.69489706, 'specificity': 0.69489706, 'f1': 0.6009894, 'auroc': 0.82375073, 'binary_precision': 0.17764166, 'binary_recall': 0.47933885, 'binary_specificity': 0.9104552, 'binary_f1_score': 0.2592179}
confusion matrix:
      0    1
0  5460  537
1   126  116
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 08:57:43.418561,epoch time: 0:19:40.875658,used: 0:39:15.704824,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9366424, 'precision': 0.93805647, 'recall': 0.93664634, 'specificity': 0.93664634, 'f1': 0.9365916, 'auroc': 0.9814603, 'binary_precision': 0.96297914, 'binary_recall': 0.90821785, 'binary_specificity': 0.9650748, 'binary_f1_score': 0.9347972}
confusion matrix:
       0      1
0  28130   1018
1   2676  26480
---- Validation: 
scalar performance:
{'acc': 0.91173494, 'precision': 0.5874029, 'recall': 0.732764, 'specificity': 0.732764, 'f1': 0.61767447, 'auroc': 0.83834493, 'binary_precision': 0.19097832, 'binary_recall': 0.5415282, 'binary_specificity': 0.9239998, 'binary_f1_score': 0.28237334}
confusion matrix:
       0     1
0  16790  1381
1    276   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8879628, 'precision': 0.5991329, 'recall': 0.79499805, 'specificity': 0.79499805, 'f1': 0.63177615, 'auroc': 0.8687029, 'binary_precision': 0.21185371, 'binary_recall': 0.6942149, 'binary_specificity': 0.8957812, 'binary_f1_score': 0.32463768}
confusion matrix:
      0    1
0  5372  625
1    74  168
better model found
persisted
after epoch: 3,now: 2024-08-02 09:17:12.324940,epoch time: 0:19:28.906379,used: 0:58:44.611203,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94341725, 'precision': 0.94521177, 'recall': 0.9434227, 'specificity': 0.9434227, 'f1': 0.9433607, 'auroc': 0.98605967, 'binary_precision': 0.97352034, 'binary_recall': 0.9116507, 'binary_specificity': 0.9751947, 'binary_f1_score': 0.9415703}
confusion matrix:
       0      1
0  28424    723
1   2576  26581
---- Validation: 
scalar performance:
{'acc': 0.91903263, 'precision': 0.59141684, 'recall': 0.7204728, 'specificity': 0.7204728, 'f1': 0.6220668, 'auroc': 0.8483486, 'binary_precision': 0.2, 'binary_recall': 0.50830567, 'binary_specificity': 0.9326399, 'binary_f1_score': 0.28705442}
confusion matrix:
       0     1
0  16947  1224
1    296   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9012662, 'precision': 0.6097656, 'recall': 0.7939872, 'specificity': 0.7939872, 'f1': 0.64702517, 'auroc': 0.88025904, 'binary_precision': 0.23361823, 'binary_recall': 0.677686, 'binary_specificity': 0.91028845, 'binary_f1_score': 0.34745762}
confusion matrix:
      0    1
0  5459  538
1    78  164
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 09:37:08.343126,epoch time: 0:19:56.018186,used: 1:18:40.629389,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9464531, 'precision': 0.9486089, 'recall': 0.94646144, 'specificity': 0.94646144, 'f1': 0.9463893, 'auroc': 0.98806417, 'binary_precision': 0.9797678, 'binary_recall': 0.9117597, 'binary_specificity': 0.98116314, 'binary_f1_score': 0.94454116}
confusion matrix:
       0      1
0  28596    549
1   2573  26586
---- Validation: 
scalar performance:
{'acc': 0.9281415, 'precision': 0.60477114, 'recall': 0.7275872, 'specificity': 0.7275872, 'f1': 0.63813424, 'auroc': 0.8558091, 'binary_precision': 0.22637363, 'binary_recall': 0.51328903, 'binary_specificity': 0.9418854, 'binary_f1_score': 0.31418404}
confusion matrix:
       0     1
0  17115  1056
1    293   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91376823, 'precision': 0.6267687, 'recall': 0.8104042, 'specificity': 0.8104042, 'f1': 0.6697367, 'auroc': 0.89032185, 'binary_precision': 0.2665615, 'binary_recall': 0.6983471, 'binary_specificity': 0.9224612, 'binary_f1_score': 0.38584474}
confusion matrix:
      0    1
0  5532  465
1    73  169
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-02 09:56:48.610181,epoch time: 0:19:40.267055,used: 1:38:20.896444,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9530392, 'precision': 0.9537328, 'recall': 0.9530426, 'specificity': 0.9530426, 'f1': 0.9530215, 'auroc': 0.9891231, 'binary_precision': 0.97151524, 'binary_recall': 0.93346363, 'binary_specificity': 0.97262156, 'binary_f1_score': 0.9521094}
confusion matrix:
       0      1
0  28349    798
1   1940  27217
---- Validation: 
scalar performance:
{'acc': 0.9087519, 'precision': 0.58959854, 'recall': 0.7521024, 'specificity': 0.7521024, 'f1': 0.6212535, 'auroc': 0.8602413, 'binary_precision': 0.19393939, 'binary_recall': 0.58471763, 'binary_specificity': 0.9194871, 'binary_f1_score': 0.29127017}
confusion matrix:
       0     1
0  16708  1463
1    250   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8887642, 'precision': 0.60726917, 'recall': 0.82912153, 'specificity': 0.82912153, 'f1': 0.6434709, 'auroc': 0.89575297, 'binary_precision': 0.22506082, 'binary_recall': 0.7644628, 'binary_specificity': 0.89378023, 'binary_f1_score': 0.34774435}
confusion matrix:
      0    1
0  5360  637
1    57  185
early stop counter: 1
val acc:0.908751904964447, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 6,now: 2024-08-02 10:16:46.206630,epoch time: 0:19:57.596449,used: 1:58:18.492893,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95710415, 'precision': 0.95790243, 'recall': 0.95710707, 'specificity': 0.95710707, 'f1': 0.95708567, 'auroc': 0.9908576, 'binary_precision': 0.9770555, 'binary_recall': 0.93620527, 'binary_specificity': 0.9780088, 'binary_f1_score': 0.9561943}
confusion matrix:
       0      1
0  28507    641
1   1860  27296
---- Validation: 
scalar performance:
{'acc': 0.9139189, 'precision': 0.59491503, 'recall': 0.75396836, 'specificity': 0.75396836, 'f1': 0.62848735, 'auroc': 0.86122155, 'binary_precision': 0.20454545, 'binary_recall': 0.58305645, 'binary_specificity': 0.9248803, 'binary_f1_score': 0.3028473}
confusion matrix:
       0     1
0  16806  1365
1    251   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89806056, 'precision': 0.6158678, 'recall': 0.8339573, 'specificity': 0.8339573, 'f1': 0.656177, 'auroc': 0.89964676, 'binary_precision': 0.2421466, 'binary_recall': 0.7644628, 'binary_specificity': 0.90345174, 'binary_f1_score': 0.36779323}
confusion matrix:
      0    1
0  5418  579
1    57  185
early stop counter: 2
val acc:0.9139189124107361, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 7,now: 2024-08-02 10:36:18.327515,epoch time: 0:19:32.120885,used: 2:17:50.613778,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9600542, 'precision': 0.96064234, 'recall': 0.96005607, 'specificity': 0.96005607, 'f1': 0.9600415, 'auroc': 0.9919307, 'binary_precision': 0.9771272, 'binary_recall': 0.94217116, 'binary_specificity': 0.9779409, 'binary_f1_score': 0.9593308}
confusion matrix:
       0      1
0  28506    643
1   1686  27469
---- Validation: 
scalar performance:
{'acc': 0.9086987, 'precision': 0.59246254, 'recall': 0.7641206, 'specificity': 0.7641206, 'f1': 0.6255009, 'auroc': 0.8680415, 'binary_precision': 0.19880824, 'binary_recall': 0.6096346, 'binary_specificity': 0.9186066, 'binary_f1_score': 0.2998366}
confusion matrix:
       0     1
0  16692  1479
1    235   367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88780254, 'precision': 0.60855126, 'recall': 0.83853495, 'specificity': 0.83853495, 'f1': 0.6452188, 'auroc': 0.89952207, 'binary_precision': 0.22673032, 'binary_recall': 0.78512394, 'binary_specificity': 0.89194596, 'binary_f1_score': 0.35185185}
confusion matrix:
      0    1
0  5349  648
1    52  190
early stop counter: 3
val acc:0.9086986780166626, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 8,now: 2024-08-02 10:56:01.270297,epoch time: 0:19:42.942782,used: 2:37:33.556560,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9618208, 'precision': 0.9625217, 'recall': 0.9618255, 'specificity': 0.9618255, 'f1': 0.9618066, 'auroc': 0.992756, 'binary_precision': 0.980586, 'binary_recall': 0.9423163, 'binary_specificity': 0.9813347, 'binary_f1_score': 0.9610703}
confusion matrix:
       0      1
0  28601    544
1   1682  27477
---- Validation: 
scalar performance:
{'acc': 0.9021467, 'precision': 0.58639014, 'recall': 0.7615391, 'specificity': 0.7615391, 'f1': 0.6167606, 'auroc': 0.86448646, 'binary_precision': 0.18670726, 'binary_recall': 0.6112957, 'binary_specificity': 0.9117825, 'binary_f1_score': 0.28604743}
confusion matrix:
       0     1
0  16568  1603
1    234   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88427633, 'precision': 0.604378, 'recall': 0.8307525, 'specificity': 0.8307525, 'f1': 0.6389037, 'auroc': 0.89934707, 'binary_precision': 0.21896955, 'binary_recall': 0.77272725, 'binary_specificity': 0.88877773, 'binary_f1_score': 0.34124085}
confusion matrix:
      0    1
0  5330  667
1    55  187
early stop counter: 4
val acc:0.9021466970443726, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 9,now: 2024-08-02 11:15:24.096039,epoch time: 0:19:22.825742,used: 2:56:56.382302,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9629185, 'precision': 0.96382284, 'recall': 0.96292305, 'specificity': 0.96292305, 'f1': 0.96290064, 'auroc': 0.9937544, 'binary_precision': 0.9843548, 'binary_recall': 0.94080526, 'binary_specificity': 0.98504084, 'binary_f1_score': 0.96208745}
confusion matrix:
       0      1
0  28710    436
1   1726  27432
---- Validation: 
scalar performance:
{'acc': 0.9143451, 'precision': 0.594995, 'recall': 0.75258243, 'specificity': 0.75258243, 'f1': 0.6285293, 'auroc': 0.8610078, 'binary_precision': 0.20481221, 'binary_recall': 0.5797342, 'binary_specificity': 0.92543066, 'binary_f1_score': 0.30268863}
confusion matrix:
       0     1
0  16816  1355
1    253   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8964578, 'precision': 0.61429405, 'recall': 0.83312356, 'specificity': 0.83312356, 'f1': 0.6539065, 'auroc': 0.8991803, 'binary_precision': 0.23901808, 'binary_recall': 0.7644628, 'binary_specificity': 0.90178424, 'binary_f1_score': 0.36417323}
confusion matrix:
      0    1
0  5408  589
1    57  185
early stop counter: 5
val acc:0.9143450856208801, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 10,now: 2024-08-02 11:35:53.404662,epoch time: 0:20:29.308623,used: 3:17:25.690925,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96362174, 'precision': 0.9640003, 'recall': 0.9636242, 'specificity': 0.9636242, 'f1': 0.9636144, 'auroc': 0.9935021, 'binary_precision': 0.9772968, 'binary_recall': 0.94930893, 'binary_specificity': 0.9779394, 'binary_f1_score': 0.9630996}
confusion matrix:
       0      1
0  28504    643
1   1478  27679
---- Validation: 
scalar performance:
{'acc': 0.89128006, 'precision': 0.5811225, 'recall': 0.7719867, 'specificity': 0.7719867, 'f1': 0.6083505, 'auroc': 0.86157453, 'binary_precision': 0.1751693, 'binary_recall': 0.64451826, 'binary_specificity': 0.8994552, 'binary_f1_score': 0.27547038}
confusion matrix:
       0     1
0  16344  1827
1    214   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85366243, 'precision': 0.58696264, 'recall': 0.8287071, 'specificity': 0.8287071, 'f1': 0.60827327, 'auroc': 0.8979469, 'binary_precision': 0.18319169, 'binary_recall': 0.8016529, 'binary_specificity': 0.85576123, 'binary_f1_score': 0.29823214}
confusion matrix:
      0    1
0  5132  865
1    48  194
early stop counter: 6
val acc:0.8912800550460815, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 11,now: 2024-08-02 11:55:20.226895,epoch time: 0:19:26.822233,used: 3:36:52.513158,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9673264, 'precision': 0.967727, 'recall': 0.9673284, 'specificity': 0.9673284, 'f1': 0.96731955, 'auroc': 0.99433887, 'binary_precision': 0.9814494, 'binary_recall': 0.9526684, 'binary_specificity': 0.9819885, 'binary_f1_score': 0.9668448}
confusion matrix:
       0      1
0  28623    525
1   1380  27776
---- Validation: 
scalar performance:
{'acc': 0.89916366, 'precision': 0.5848991, 'recall': 0.76481646, 'specificity': 0.76481646, 'f1': 0.6144965, 'auroc': 0.86147225, 'binary_precision': 0.18342325, 'binary_recall': 0.62126243, 'binary_specificity': 0.9083705, 'binary_f1_score': 0.28322604}
confusion matrix:
       0     1
0  16506  1665
1    228   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8629588, 'precision': 0.59030867, 'recall': 0.82362914, 'specificity': 0.82362914, 'f1': 0.61526775, 'auroc': 0.8964241, 'binary_precision': 0.19071645, 'binary_recall': 0.78099173, 'binary_specificity': 0.8662665, 'binary_f1_score': 0.30656934}
confusion matrix:
      0    1
0  5195  802
1    53  189
early stop counter: 7
val acc:0.8991636633872986, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 12,now: 2024-08-02 12:14:55.694854,epoch time: 0:19:35.467959,used: 3:56:27.981117,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96837264, 'precision': 0.9686969, 'recall': 0.9683758, 'specificity': 0.9683758, 'f1': 0.96836734, 'auroc': 0.9950139, 'binary_precision': 0.9810842, 'binary_recall': 0.9551768, 'binary_specificity': 0.9815749, 'binary_f1_score': 0.9679572}
confusion matrix:
       0      1
0  28608    537
1   1307  27852
---- Validation: 
scalar performance:
{'acc': 0.8573483, 'precision': 0.5648952, 'recall': 0.7729289, 'specificity': 0.7729289, 'f1': 0.57809937, 'auroc': 0.8502637, 'binary_precision': 0.14182195, 'binary_recall': 0.68272424, 'binary_specificity': 0.86313355, 'binary_f1_score': 0.23485714}
confusion matrix:
       0     1
0  15684  2487
1    191   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8190415, 'precision': 0.5723549, 'recall': 0.8166463, 'specificity': 0.8166463, 'f1': 0.577821, 'auroc': 0.89494264, 'binary_precision': 0.15378611, 'binary_recall': 0.8140496, 'binary_specificity': 0.81924295, 'binary_f1_score': 0.25869992}
confusion matrix:
      0     1
0  4913  1084
1    45   197
early stop counter: 8
val acc:0.8573483228683472, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 13,now: 2024-08-02 12:34:48.310705,epoch time: 0:19:52.615851,used: 4:16:20.596968,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9682526, 'precision': 0.9686322, 'recall': 0.968256, 'specificity': 0.968256, 'f1': 0.96824634, 'auroc': 0.99465394, 'binary_precision': 0.98203063, 'binary_recall': 0.95397645, 'binary_specificity': 0.9825356, 'binary_f1_score': 0.9678003}
confusion matrix:
       0      1
0  28636    509
1   1342  27817
---- Validation: 
scalar performance:
{'acc': 0.88174504, 'precision': 0.5765375, 'recall': 0.7766979, 'specificity': 0.7766979, 'f1': 0.6003006, 'auroc': 0.8619706, 'binary_precision': 0.16542597, 'binary_recall': 0.66445184, 'binary_specificity': 0.8889439, 'binary_f1_score': 0.26490065}
confusion matrix:
       0     1
0  16153  2018
1    202   400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84821284, 'precision': 0.58290696, 'recall': 0.8199241, 'specificity': 0.8199241, 'f1': 0.60124695, 'auroc': 0.8987042, 'binary_precision': 0.17571297, 'binary_recall': 0.7892562, 'binary_specificity': 0.85059196, 'binary_f1_score': 0.2874342}
confusion matrix:
      0    1
0  5101  896
1    51  191
early stop counter: 9
val acc:0.8817450404167175, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 14,now: 2024-08-02 12:57:37.212231,epoch time: 0:22:48.901526,used: 4:39:09.498494,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9695218, 'precision': 0.96989197, 'recall': 0.96952474, 'specificity': 0.96952474, 'f1': 0.9695159, 'auroc': 0.9953723, 'binary_precision': 0.9831316, 'binary_recall': 0.95544964, 'binary_specificity': 0.9835998, 'binary_f1_score': 0.96909297}
confusion matrix:
       0      1
0  28668    478
1   1299  27859
---- Validation: 
scalar performance:
{'acc': 0.88094604, 'precision': 0.575349, 'recall': 0.77307296, 'specificity': 0.77307296, 'f1': 0.5984491, 'auroc': 0.8538996, 'binary_precision': 0.16329896, 'binary_recall': 0.6578073, 'binary_specificity': 0.88833857, 'binary_f1_score': 0.2616452}
confusion matrix:
       0     1
0  16142  2029
1    206   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8387562, 'precision': 0.5779389, 'recall': 0.8130222, 'specificity': 0.8130222, 'f1': 0.5917371, 'auroc': 0.895487, 'binary_precision': 0.16608392, 'binary_recall': 0.78512394, 'binary_specificity': 0.84092045, 'binary_f1_score': 0.27417025}
confusion matrix:
      0    1
0  5043  954
1    52  190
early stop counter: 10
val acc:0.8809460401535034, best validation acc: 0.9281414747238159, corresponding to test acc:                         0.9137682318687439 / 0.9137682318687439
after epoch: 15,now: 2024-08-02 13:20:22.990691,epoch time: 0:22:45.778460,used: 5:01:55.276954,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_18_27_seed_2_23919992
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:01:55.276954 at 2024-08-02 13:20:22.990691
persisted model performance metric: 

scalar performance:
{'acc': 0.91376823, 'precision': 0.6267687, 'recall': 0.8104042, 'specificity': 0.8104042, 'f1': 0.6697367, 'auroc': 0.89032185, 'binary_precision': 0.2665615, 'binary_recall': 0.6983471, 'binary_specificity': 0.9224612, 'binary_f1_score': 0.38584474}
confusion matrix:
      0    1
0  5532  465
1    73  169
oracle model performance metric: 

scalar performance:
{'acc': 0.91376823, 'precision': 0.6267687, 'recall': 0.8104042, 'specificity': 0.8104042, 'f1': 0.6697367, 'auroc': 0.89032185, 'binary_precision': 0.2665615, 'binary_recall': 0.6983471, 'binary_specificity': 0.9224612, 'binary_f1_score': 0.38584474}
confusion matrix:
      0    1
0  5532  465
1    73  169
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    822 MiB |   8458 MiB |   1081 TiB |   1081 TiB |
|       from large pool |    784 MiB |   8415 MiB |   1064 TiB |   1064 TiB |
|       from small pool |     37 MiB |     78 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |    822 MiB |   8458 MiB |   1081 TiB |   1081 TiB |
|       from large pool |    784 MiB |   8415 MiB |   1064 TiB |   1064 TiB |
|       from small pool |     37 MiB |     78 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |    819 MiB |   8455 MiB |   1078 TiB |   1078 TiB |
|       from large pool |    782 MiB |   8412 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     36 MiB |     77 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9372 MiB |   9400 MiB |  26376 MiB |  17004 MiB |
|       from large pool |   9292 MiB |   9314 MiB |  26234 MiB |  16942 MiB |
|       from small pool |     80 MiB |     86 MiB |    142 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  49020 KiB |    796 MiB | 602011 GiB | 602011 GiB |
|       from large pool |  38543 KiB |    795 MiB | 584443 GiB | 584442 GiB |
|       from small pool |  10477 KiB |     31 MiB |  17568 GiB |  17568 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3460    |    8277    |  217242 K  |  217239 K  |
|       from large pool |     161    |     844    |  102528 K  |  102528 K  |
|       from small pool |    3299    |    8114    |  114714 K  |  114710 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3460    |    8277    |  217242 K  |  217239 K  |
|       from large pool |     161    |     844    |  102528 K  |  102528 K  |
|       from small pool |    3299    |    8114    |  114714 K  |  114710 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     402    |     407    |    1106    |     704    |
|       from large pool |     362    |     364    |    1035    |     673    |
|       from small pool |      40    |      43    |      71    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    3672    |  120545 K  |  120545 K  |
|       from large pool |      17    |     358    |   71541 K  |   71541 K  |
|       from small pool |      52    |    3656    |   49004 K  |   49004 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8458 MiB |   1081 TiB |   1081 TiB |
|       from large pool |  16640 KiB |   8415 MiB |   1064 TiB |   1064 TiB |
|       from small pool |      0 KiB |     78 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8458 MiB |   1081 TiB |   1081 TiB |
|       from large pool |  16640 KiB |   8415 MiB |   1064 TiB |   1064 TiB |
|       from small pool |      0 KiB |     78 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8412 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     77 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    870 MiB |   9400 MiB |  26376 MiB |  25506 MiB |
|       from large pool |    822 MiB |   9314 MiB |  26234 MiB |  25412 MiB |
|       from small pool |     48 MiB |     86 MiB |    142 MiB |     94 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    796 MiB | 602012 GiB | 602012 GiB |
|       from large pool |  30464 KiB |    795 MiB | 584443 GiB | 584443 GiB |
|       from small pool |      0 KiB |     31 MiB |  17568 GiB |  17568 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8277    |  217242 K  |  217242 K  |
|       from large pool |       2    |     844    |  102528 K  |  102528 K  |
|       from small pool |       0    |    8114    |  114714 K  |  114714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8277    |  217242 K  |  217242 K  |
|       from large pool |       2    |     844    |  102528 K  |  102528 K  |
|       from small pool |       0    |    8114    |  114714 K  |  114714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     407    |    1106    |    1056    |
|       from large pool |      26    |     364    |    1035    |    1009    |
|       from small pool |      24    |      43    |      71    |      47    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3672    |  120546 K  |  120546 K  |
|       from large pool |       2    |     358    |   71541 K  |   71541 K  |
|       from small pool |       0    |    3656    |   49005 K  |   49005 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 13:21:52 2024]
Finished job 0.
1 of 1 steps (100%) done
