Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  2 01:39:35 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995

 Experiment start at: 2024-08-02 01:46:25.594618
before training, model accuracy: 0.9576542377471924
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8851639, 'precision': 0.88796127, 'recall': 0.88520396, 'specificity': 0.88520396, 'f1': 0.884964, 'auroc': 0.9518275, 'binary_precision': 0.9211408, 'binary_recall': 0.8426865, 'binary_specificity': 0.9277214, 'binary_f1_score': 0.8801688}
confusion matrix:
       0      1
0  26582   2071
1   4516  24191
---- Validation: 
scalar performance:
{'acc': 0.9469987, 'precision': 0.5985787, 'recall': 0.59828293, 'specificity': 0.59828293, 'f1': 0.5984305, 'auroc': 0.8176023, 'binary_precision': 0.22464898, 'binary_recall': 0.22395024, 'binary_specificity': 0.9726156, 'binary_f1_score': 0.22429907}
confusion matrix:
       0    1
0  17652  497
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9538191, 'precision': 0.6498101, 'recall': 0.5508032, 'specificity': 0.5508032, 'f1': 0.571699, 'auroc': 0.85029936, 'binary_precision': 0.3372093, 'binary_recall': 0.11111111, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.16714698}
confusion matrix:
      0   1
0  5940  57
1   232  29
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 02:00:47.401452,epoch time: 0:14:21.806834,used: 0:14:21.806834,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9150279, 'precision': 0.91829723, 'recall': 0.9150603, 'specificity': 0.9150603, 'f1': 0.914866, 'auroc': 0.97094476, 'binary_precision': 0.95546126, 'binary_recall': 0.87077105, 'binary_specificity': 0.9593496, 'binary_f1_score': 0.9111525}
confusion matrix:
       0      1
0  27494   1165
1   3709  24992
---- Validation: 
scalar performance:
{'acc': 0.9411984, 'precision': 0.6076037, 'recall': 0.64628375, 'specificity': 0.64628375, 'f1': 0.6233289, 'auroc': 0.8343656, 'binary_precision': 0.23927765, 'binary_recall': 0.32970452, 'binary_specificity': 0.96286297, 'binary_f1_score': 0.27730542}
confusion matrix:
       0    1
0  17475  674
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.74308574, 'recall': 0.67265624, 'specificity': 0.67265624, 'f1': 0.7011087, 'auroc': 0.89458585, 'binary_precision': 0.5136612, 'binary_recall': 0.36015326, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.4234234}
confusion matrix:
      0   1
0  5908  89
1   167  94
new oracle model saved
early stop counter: 1
val acc:0.9411984086036682, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.959092378616333
after epoch: 2,now: 2024-08-02 02:14:41.413105,epoch time: 0:13:54.011653,used: 0:28:15.818487,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92698747, 'precision': 0.9291638, 'recall': 0.9270161, 'specificity': 0.9270161, 'f1': 0.926898, 'auroc': 0.9783758, 'binary_precision': 0.9599265, 'binary_recall': 0.89130056, 'binary_specificity': 0.9627316, 'binary_f1_score': 0.9243415}
confusion matrix:
       0      1
0  27589   1068
1   3120  25583
---- Validation: 
scalar performance:
{'acc': 0.9404534, 'precision': 0.61306816, 'recall': 0.66389936, 'specificity': 0.66389936, 'f1': 0.6327897, 'auroc': 0.84727824, 'binary_precision': 0.24894515, 'binary_recall': 0.36702955, 'binary_specificity': 0.9607692, 'binary_f1_score': 0.29666877}
confusion matrix:
       0    1
0  17437  712
1    407  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7692808, 'recall': 0.7534476, 'specificity': 0.7534476, 'f1': 0.76109236, 'auroc': 0.9125482, 'binary_precision': 0.55918366, 'binary_recall': 0.5249042, 'binary_specificity': 0.981991, 'binary_f1_score': 0.541502}
confusion matrix:
      0    1
0  5889  108
1   124  137
new oracle model saved
early stop counter: 2
val acc:0.9404534101486206, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9629274606704712
after epoch: 3,now: 2024-08-02 02:28:31.780900,epoch time: 0:13:50.367795,used: 0:42:06.186282,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9388773, 'precision': 0.93929124, 'recall': 0.93888915, 'specificity': 0.93888915, 'f1': 0.938864, 'auroc': 0.982483, 'binary_precision': 0.95296997, 'binary_recall': 0.92341995, 'binary_specificity': 0.9543583, 'binary_f1_score': 0.93796223}
confusion matrix:
       0      1
0  27350   1308
1   2198  26504
---- Validation: 
scalar performance:
{'acc': 0.92289275, 'precision': 0.6041622, 'recall': 0.7275633, 'specificity': 0.7275633, 'f1': 0.6370205, 'auroc': 0.85614, 'binary_precision': 0.22622283, 'binary_recall': 0.5178849, 'binary_specificity': 0.93724173, 'binary_f1_score': 0.31489363}
confusion matrix:
       0     1
0  17010  1139
1    310   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.7282541, 'recall': 0.8297348, 'specificity': 0.8297348, 'f1': 0.7682228, 'auroc': 0.9215968, 'binary_precision': 0.47012988, 'binary_recall': 0.6934866, 'binary_specificity': 0.965983, 'binary_f1_score': 0.5603715}
confusion matrix:
      0    1
0  5793  204
1    80  181
early stop counter: 3
val acc:0.9228927493095398, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9629274606704712
after epoch: 4,now: 2024-08-02 02:42:18.375898,epoch time: 0:13:46.594998,used: 0:55:52.781280,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94144005, 'precision': 0.94211483, 'recall': 0.9414565, 'specificity': 0.9414565, 'f1': 0.9414191, 'auroc': 0.9846618, 'binary_precision': 0.9595982, 'binary_recall': 0.9217879, 'binary_specificity': 0.9611251, 'binary_f1_score': 0.9403131}
confusion matrix:
       0      1
0  27542   1114
1   2245  26459
---- Validation: 
scalar performance:
{'acc': 0.9290656, 'precision': 0.6166513, 'recall': 0.7405098, 'specificity': 0.7405098, 'f1': 0.6521207, 'auroc': 0.8618554, 'binary_precision': 0.2503618, 'binary_recall': 0.5381026, 'binary_specificity': 0.942917, 'binary_f1_score': 0.3417284}
confusion matrix:
       0     1
0  17113  1036
1    297   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7446069, 'recall': 0.8318192, 'specificity': 0.8318192, 'f1': 0.78057843, 'auroc': 0.92308867, 'binary_precision': 0.50277776, 'binary_recall': 0.6934866, 'binary_specificity': 0.9701517, 'binary_f1_score': 0.58293074}
confusion matrix:
      0    1
0  5818  179
1    80  181
early stop counter: 4
val acc:0.9290655851364136, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9629274606704712
after epoch: 5,now: 2024-08-02 02:56:05.465546,epoch time: 0:13:47.089648,used: 1:09:39.870928,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94314855, 'precision': 0.9447098, 'recall': 0.9431714, 'specificity': 0.9431714, 'f1': 0.94310063, 'auroc': 0.98621684, 'binary_precision': 0.9712518, 'binary_recall': 0.9134207, 'binary_specificity': 0.972922, 'binary_f1_score': 0.94144905}
confusion matrix:
       0      1
0  27882    776
1   2485  26217
---- Validation: 
scalar performance:
{'acc': 0.94588125, 'precision': 0.6439292, 'recall': 0.71321285, 'specificity': 0.71321285, 'f1': 0.6706125, 'auroc': 0.8715245, 'binary_precision': 0.3072165, 'binary_recall': 0.46345258, 'binary_specificity': 0.9629732, 'binary_f1_score': 0.36949784}
confusion matrix:
       0    1
0  17477  672
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.7937504, 'recall': 0.82374525, 'specificity': 0.82374525, 'f1': 0.807923, 'auroc': 0.9225309, 'binary_precision': 0.6020761, 'binary_recall': 0.6666667, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.63272727}
confusion matrix:
      0    1
0  5882  115
1    87  174
new oracle model saved
early stop counter: 5
val acc:0.9458812475204468, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 6,now: 2024-08-02 03:09:53.579765,epoch time: 0:13:48.114219,used: 1:23:27.985147,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94877964, 'precision': 0.949661, 'recall': 0.9487975, 'specificity': 0.9487975, 'f1': 0.948756, 'auroc': 0.9884215, 'binary_precision': 0.9697699, 'binary_recall': 0.9265234, 'binary_specificity': 0.97107166, 'binary_f1_score': 0.94765353}
confusion matrix:
       0      1
0  27828    829
1   2109  26594
---- Validation: 
scalar performance:
{'acc': 0.94034696, 'precision': 0.63441056, 'recall': 0.72834903, 'specificity': 0.72834903, 'f1': 0.6667881, 'auroc': 0.871185, 'binary_precision': 0.2869875, 'binary_recall': 0.5007776, 'binary_specificity': 0.95592046, 'binary_f1_score': 0.3648725}
confusion matrix:
       0    1
0  17349  800
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7659519, 'recall': 0.830489, 'specificity': 0.830489, 'f1': 0.79422104, 'auroc': 0.92179036, 'binary_precision': 0.5457317, 'binary_recall': 0.68582374, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.60780984}
confusion matrix:
      0    1
0  5848  149
1    82  179
early stop counter: 6
val acc:0.9403469562530518, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 7,now: 2024-08-02 03:23:48.557623,epoch time: 0:13:54.977858,used: 1:37:22.963005,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9535216, 'precision': 0.9539441, 'recall': 0.95353234, 'specificity': 0.95353234, 'f1': 0.9535116, 'auroc': 0.98975766, 'binary_precision': 0.96796805, 'binary_recall': 0.9381533, 'binary_specificity': 0.96891135, 'binary_f1_score': 0.9528275}
confusion matrix:
       0      1
0  27769    891
1   1775  26925
---- Validation: 
scalar performance:
{'acc': 0.9322052, 'precision': 0.6245175, 'recall': 0.7503859, 'specificity': 0.7503859, 'f1': 0.6616822, 'auroc': 0.8707781, 'binary_precision': 0.2654275, 'binary_recall': 0.55520993, 'binary_specificity': 0.94556177, 'binary_f1_score': 0.3591549}
confusion matrix:
       0    1
0  17161  988
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7456647, 'recall': 0.8410642, 'specificity': 0.8410642, 'f1': 0.78438497, 'auroc': 0.9217974, 'binary_precision': 0.50406504, 'binary_recall': 0.7126437, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.5904762}
confusion matrix:
      0    1
0  5814  183
1    75  186
early stop counter: 7
val acc:0.9322052001953125, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 8,now: 2024-08-02 03:37:56.930566,epoch time: 0:14:08.372943,used: 1:51:31.335948,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95688635, 'precision': 0.9571613, 'recall': 0.9568954, 'specificity': 0.9568954, 'f1': 0.95688045, 'auroc': 0.99064136, 'binary_precision': 0.96855795, 'binary_recall': 0.9444967, 'binary_specificity': 0.96929413, 'binary_f1_score': 0.956376}
confusion matrix:
       0      1
0  27779    880
1   1593  27108
---- Validation: 
scalar performance:
{'acc': 0.9352916, 'precision': 0.6284926, 'recall': 0.7444832, 'specificity': 0.7444832, 'f1': 0.6646322, 'auroc': 0.8719977, 'binary_precision': 0.2738753, 'binary_recall': 0.53965783, 'binary_specificity': 0.9493085, 'binary_f1_score': 0.3633508}
confusion matrix:
       0    1
0  17229  920
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.765686, 'recall': 0.83965063, 'specificity': 0.83965063, 'f1': 0.79748654, 'auroc': 0.9224951, 'binary_precision': 0.5443787, 'binary_recall': 0.70498085, 'binary_specificity': 0.9743205, 'binary_f1_score': 0.61435723}
confusion matrix:
      0    1
0  5843  154
1    77  184
early stop counter: 8
val acc:0.935291588306427, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 9,now: 2024-08-02 03:51:47.823355,epoch time: 0:13:50.892789,used: 2:05:22.228737,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9584554, 'precision': 0.95884764, 'recall': 0.9584693, 'specificity': 0.9584693, 'f1': 0.9584474, 'auroc': 0.9918871, 'binary_precision': 0.97250146, 'binary_recall': 0.9436723, 'binary_specificity': 0.9732663, 'binary_f1_score': 0.95787007}
confusion matrix:
       0      1
0  27887    766
1   1617  27090
---- Validation: 
scalar performance:
{'acc': 0.94135803, 'precision': 0.6406716, 'recall': 0.74237347, 'specificity': 0.74237347, 'f1': 0.6754067, 'auroc': 0.8766947, 'binary_precision': 0.29850745, 'binary_recall': 0.5287714, 'binary_specificity': 0.95597553, 'binary_f1_score': 0.3815937}
confusion matrix:
       0    1
0  17350  799
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.7775914, 'recall': 0.83898556, 'specificity': 0.83898556, 'f1': 0.8048012, 'auroc': 0.9224535, 'binary_precision': 0.56832296, 'binary_recall': 0.7011494, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.6277873}
confusion matrix:
      0    1
0  5858  139
1    78  183
early stop counter: 9
val acc:0.9413580298423767, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 10,now: 2024-08-02 04:05:33.767579,epoch time: 0:13:45.944224,used: 2:19:08.172961,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9607392, 'precision': 0.9611907, 'recall': 0.9607519, 'specificity': 0.9607519, 'f1': 0.9607303, 'auroc': 0.9924778, 'binary_precision': 0.975823, 'binary_recall': 0.9449535, 'binary_specificity': 0.9765502, 'binary_f1_score': 0.96014017}
confusion matrix:
       0      1
0  27985    672
1   1580  27123
---- Validation: 
scalar performance:
{'acc': 0.9438591, 'precision': 0.6425595, 'recall': 0.72716707, 'specificity': 0.72716707, 'f1': 0.67335796, 'auroc': 0.8757349, 'binary_precision': 0.30343512, 'binary_recall': 0.49455675, 'binary_specificity': 0.9597774, 'binary_f1_score': 0.3761088}
confusion matrix:
       0    1
0  17419  730
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.7905233, 'recall': 0.84015286, 'specificity': 0.84015286, 'f1': 0.81312096, 'auroc': 0.92126334, 'binary_precision': 0.59415585, 'binary_recall': 0.7011494, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.6432338}
confusion matrix:
      0    1
0  5872  125
1    78  183
early stop counter: 10
val acc:0.9438591003417969, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 11,now: 2024-08-02 04:19:26.048175,epoch time: 0:13:52.280596,used: 2:33:00.453557,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9622036, 'precision': 0.96252275, 'recall': 0.9622143, 'specificity': 0.9622143, 'f1': 0.9621977, 'auroc': 0.9929842, 'binary_precision': 0.97487384, 'binary_recall': 0.9489252, 'binary_specificity': 0.9755034, 'binary_f1_score': 0.9617245}
confusion matrix:
       0      1
0  27955    702
1   1466  27237
---- Validation: 
scalar performance:
{'acc': 0.9411452, 'precision': 0.6382811, 'recall': 0.73551273, 'specificity': 0.73551273, 'f1': 0.6717772, 'auroc': 0.8786066, 'binary_precision': 0.29422224, 'binary_recall': 0.5147745, 'binary_specificity': 0.956251, 'binary_f1_score': 0.37443438}
confusion matrix:
       0    1
0  17355  794
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7647972, 'recall': 0.843232, 'specificity': 0.843232, 'f1': 0.79820895, 'auroc': 0.9182623, 'binary_precision': 0.54227406, 'binary_recall': 0.7126437, 'binary_specificity': 0.97382027, 'binary_f1_score': 0.615894}
confusion matrix:
      0    1
0  5840  157
1    75  186
early stop counter: 11
val acc:0.9411451816558838, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 12,now: 2024-08-02 04:33:13.203462,epoch time: 0:13:47.155287,used: 2:46:47.608844,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96560323, 'precision': 0.9657477, 'recall': 0.96561104, 'specificity': 0.96561104, 'f1': 0.96560097, 'auroc': 0.9941598, 'binary_precision': 0.9741734, 'binary_recall': 0.9566278, 'binary_specificity': 0.9745943, 'binary_f1_score': 0.9653209}
confusion matrix:
       0      1
0  27927    728
1   1245  27460
---- Validation: 
scalar performance:
{'acc': 0.9416241, 'precision': 0.6443226, 'recall': 0.753762, 'specificity': 0.753762, 'f1': 0.68112713, 'auroc': 0.881631, 'binary_precision': 0.3049828, 'binary_recall': 0.5520995, 'binary_specificity': 0.95542455, 'binary_f1_score': 0.39291644}
confusion matrix:
       0    1
0  17340  809
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7647571, 'recall': 0.8450643, 'specificity': 0.8450643, 'f1': 0.7988411, 'auroc': 0.91950893, 'binary_precision': 0.54202896, 'binary_recall': 0.71647507, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.6171617}
confusion matrix:
      0    1
0  5839  158
1    74  187
early stop counter: 12
val acc:0.941624104976654, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 13,now: 2024-08-02 04:47:03.829902,epoch time: 0:13:50.626440,used: 3:00:38.235284,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9640865, 'precision': 0.96427387, 'recall': 0.9640939, 'specificity': 0.9640939, 'f1': 0.96408325, 'auroc': 0.99388504, 'binary_precision': 0.97378623, 'binary_recall': 0.95390403, 'binary_specificity': 0.9742838, 'binary_f1_score': 0.9637426}
confusion matrix:
       0      1
0  27922    737
1   1323  27378
---- Validation: 
scalar performance:
{'acc': 0.94290125, 'precision': 0.6492567, 'recall': 0.7611737, 'specificity': 0.7611737, 'f1': 0.68711674, 'auroc': 0.8836142, 'binary_precision': 0.31433505, 'binary_recall': 0.5660964, 'binary_specificity': 0.956251, 'binary_f1_score': 0.40421987}
confusion matrix:
       0    1
0  17355  794
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7655911, 'recall': 0.84331536, 'specificity': 0.84331536, 'f1': 0.79876244, 'auroc': 0.92045057, 'binary_precision': 0.54385966, 'binary_recall': 0.7126437, 'binary_specificity': 0.973987, 'binary_f1_score': 0.61691546}
confusion matrix:
      0    1
0  5841  156
1    75  186
early stop counter: 13
val acc:0.9429012537002563, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 14,now: 2024-08-02 05:00:54.817150,epoch time: 0:13:50.987248,used: 3:14:29.222532,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9673466, 'precision': 0.9674921, 'recall': 0.9673525, 'specificity': 0.9673525, 'f1': 0.96734434, 'auroc': 0.99446285, 'binary_precision': 0.97590834, 'binary_recall': 0.9583958, 'binary_specificity': 0.9763093, 'binary_f1_score': 0.9670728}
confusion matrix:
       0      1
0  27982    679
1   1194  27505
---- Validation: 
scalar performance:
{'acc': 0.94300765, 'precision': 0.6499036, 'recall': 0.7627289, 'specificity': 0.7627289, 'f1': 0.688029, 'auroc': 0.88644385, 'binary_precision': 0.31551725, 'binary_recall': 0.56920683, 'binary_specificity': 0.956251, 'binary_f1_score': 0.40599003}
confusion matrix:
       0    1
0  17355  794
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7671376, 'recall': 0.8453144, 'specificity': 0.8453144, 'f1': 0.8005047, 'auroc': 0.9193083, 'binary_precision': 0.5467836, 'binary_recall': 0.71647507, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.62023216}
confusion matrix:
      0    1
0  5842  155
1    74  187
early stop counter: 14
val acc:0.9430076479911804, best validation acc: 0.9469987154006958, corresponding to test acc:                         0.9538190960884094 / 0.9677213430404663
after epoch: 15,now: 2024-08-02 05:14:44.243369,epoch time: 0:13:49.426219,used: 3:28:18.648751,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_01_46_24_seed_0_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:28:18.648751 at 2024-08-02 05:14:44.243369
persisted model performance metric: 

scalar performance:
{'acc': 0.9538191, 'precision': 0.6498101, 'recall': 0.5508032, 'specificity': 0.5508032, 'f1': 0.571699, 'auroc': 0.85029936, 'binary_precision': 0.3372093, 'binary_recall': 0.11111111, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.16714698}
confusion matrix:
      0   1
0  5940  57
1   232  29
oracle model performance metric: 

scalar performance:
{'acc': 0.96772134, 'precision': 0.7937504, 'recall': 0.82374525, 'specificity': 0.82374525, 'f1': 0.807923, 'auroc': 0.9225309, 'binary_precision': 0.6020761, 'binary_recall': 0.6666667, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.63272727}
confusion matrix:
      0    1
0  5882  115
1    87  174
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1134 MiB |   8770 MiB | 359990 GiB | 359989 GiB |
|       from large pool |   1095 MiB |   8725 MiB | 354221 GiB | 354220 GiB |
|       from small pool |     38 MiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1134 MiB |   8770 MiB | 359990 GiB | 359989 GiB |
|       from large pool |   1095 MiB |   8725 MiB | 354221 GiB | 354220 GiB |
|       from small pool |     38 MiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1128 MiB |   8764 MiB | 359916 GiB | 359915 GiB |
|       from large pool |   1090 MiB |   8720 MiB | 354160 GiB | 354159 GiB |
|       from small pool |     37 MiB |     79 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9896 MiB |   9896 MiB |   9896 MiB |      0 B   |
|       from large pool |   9810 MiB |   9810 MiB |   9810 MiB |      0 B   |
|       from small pool |     86 MiB |     86 MiB |     86 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  77340 KiB |    833 MiB | 197576 GiB | 197576 GiB |
|       from large pool |  59734 KiB |    831 MiB | 191796 GiB | 191796 GiB |
|       from small pool |  17606 KiB |     20 MiB |   5779 GiB |   5779 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3472    |    8159    |   71313 K  |   71309 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37868 K  |   37864 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3472    |    8159    |   71313 K  |   71309 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37868 K  |   37864 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     401    |     401    |     401    |       0    |
|       from large pool |     358    |     358    |     358    |       0    |
|       from small pool |      43    |      43    |      43    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3616    |   39637 K  |   39637 K  |
|       from large pool |      19    |     351    |   21979 K  |   21979 K  |
|       from small pool |      54    |    3598    |   17658 K  |   17658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8770 MiB | 359990 GiB | 359990 GiB |
|       from large pool |  16640 KiB |   8725 MiB | 354221 GiB | 354221 GiB |
|       from small pool |      0 KiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8770 MiB | 359990 GiB | 359990 GiB |
|       from large pool |  16640 KiB |   8725 MiB | 354221 GiB | 354221 GiB |
|       from small pool |      0 KiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8764 MiB | 359916 GiB | 359916 GiB |
|       from large pool |  16640 KiB |   8720 MiB | 354160 GiB | 354160 GiB |
|       from small pool |      0 KiB |     79 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1210 MiB |   9896 MiB |   9896 MiB |   8686 MiB |
|       from large pool |   1154 MiB |   9810 MiB |   9810 MiB |   8656 MiB |
|       from small pool |     56 MiB |     86 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    833 MiB | 197576 GiB | 197576 GiB |
|       from large pool |  30464 KiB |    831 MiB | 191796 GiB | 191796 GiB |
|       from small pool |      0 KiB |     32 MiB |   5779 GiB |   5779 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71313 K  |   71313 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37868 K  |   37868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71313 K  |   71313 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37868 K  |   37868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     401    |     401    |     346    |
|       from large pool |      27    |     358    |     358    |     331    |
|       from small pool |      28    |      43    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3616    |   39638 K  |   39638 K  |
|       from large pool |       2    |     351    |   21979 K  |   21979 K  |
|       from small pool |       0    |    3598    |   17659 K  |   17659 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8770 MiB | 359990 GiB | 359990 GiB |
|       from large pool |  16640 KiB |   8725 MiB | 354221 GiB | 354221 GiB |
|       from small pool |      0 KiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8770 MiB | 359990 GiB | 359990 GiB |
|       from large pool |  16640 KiB |   8725 MiB | 354221 GiB | 354221 GiB |
|       from small pool |      0 KiB |     80 MiB |   5768 GiB |   5768 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8764 MiB | 359916 GiB | 359916 GiB |
|       from large pool |  16640 KiB |   8720 MiB | 354160 GiB | 354160 GiB |
|       from small pool |      0 KiB |     79 MiB |   5756 GiB |   5756 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1210 MiB |   9896 MiB |   9896 MiB |   8686 MiB |
|       from large pool |   1154 MiB |   9810 MiB |   9810 MiB |   8656 MiB |
|       from small pool |     56 MiB |     86 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    833 MiB | 197576 GiB | 197576 GiB |
|       from large pool |  30464 KiB |    831 MiB | 191796 GiB | 191796 GiB |
|       from small pool |      0 KiB |     32 MiB |   5779 GiB |   5779 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71313 K  |   71313 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37868 K  |   37868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71313 K  |   71313 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37868 K  |   37868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     401    |     401    |     346    |
|       from large pool |      27    |     358    |     358    |     331    |
|       from small pool |      28    |      43    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3616    |   39638 K  |   39638 K  |
|       from large pool |       2    |     351    |   21979 K  |   21979 K  |
|       from small pool |       0    |    3598    |   17659 K  |   17659 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995

 Experiment start at: 2024-08-02 05:21:52.765659
before training, model accuracy: 0.04270061478018761
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89770204, 'precision': 0.89874095, 'recall': 0.8977198, 'specificity': 0.8977198, 'f1': 0.8976383, 'auroc': 0.96219486, 'binary_precision': 0.9192687, 'binary_recall': 0.8721382, 'binary_specificity': 0.9233014, 'binary_f1_score': 0.89508355}
confusion matrix:
       0      1
0  26580   2208
1   3686  25142
---- Validation: 
scalar performance:
{'acc': 0.77379936, 'precision': 0.53452665, 'recall': 0.67740494, 'specificity': 0.67740494, 'f1': 0.51175284, 'auroc': 0.7447368, 'binary_precision': 0.0889811, 'binary_recall': 0.57355124, 'binary_specificity': 0.78125864, 'binary_f1_score': 0.15406106}
confusion matrix:
       0     1
0  14115  3952
1    287   386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8259749, 'precision': 0.57817566, 'recall': 0.80987734, 'specificity': 0.80987734, 'f1': 0.5886192, 'auroc': 0.86933875, 'binary_precision': 0.16720779, 'binary_recall': 0.7923077, 'binary_specificity': 0.827447, 'binary_f1_score': 0.2761394}
confusion matrix:
      0     1
0  4920  1026
1    54   206
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 05:36:14.922948,epoch time: 0:14:22.157289,used: 0:14:22.157289,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93165094, 'precision': 0.9333912, 'recall': 0.931673, 'specificity': 0.931673, 'f1': 0.9315846, 'auroc': 0.9793241, 'binary_precision': 0.9610284, 'binary_recall': 0.899889, 'binary_specificity': 0.963457, 'binary_f1_score': 0.9294544}
confusion matrix:
       0      1
0  27736   1052
1   2886  25942
---- Validation: 
scalar performance:
{'acc': 0.8869797, 'precision': 0.5718532, 'recall': 0.7103535, 'specificity': 0.7103535, 'f1': 0.5936493, 'auroc': 0.8155774, 'binary_precision': 0.16317016, 'binary_recall': 0.5200594, 'binary_specificity': 0.9006476, 'binary_f1_score': 0.24840312}
confusion matrix:
       0     1
0  16272  1795
1    323   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9023526, 'precision': 0.6248834, 'recall': 0.8221513, 'specificity': 0.8221513, 'f1': 0.6667967, 'auroc': 0.889653, 'binary_precision': 0.26236263, 'binary_recall': 0.7346154, 'binary_specificity': 0.90968716, 'binary_f1_score': 0.38663965}
confusion matrix:
      0    1
0  5409  537
1    69  191
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 05:50:13.513899,epoch time: 0:13:58.590951,used: 0:28:20.748240,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94395655, 'precision': 0.94575566, 'recall': 0.94397867, 'specificity': 0.94397867, 'f1': 0.9439019, 'auroc': 0.98567593, 'binary_precision': 0.97424877, 'binary_recall': 0.91209936, 'binary_specificity': 0.975858, 'binary_f1_score': 0.94215024}
confusion matrix:
       0      1
0  28093    695
1   2534  26294
---- Validation: 
scalar performance:
{'acc': 0.91696906, 'precision': 0.6021522, 'recall': 0.72948307, 'specificity': 0.72948307, 'f1': 0.63457024, 'auroc': 0.84126663, 'binary_precision': 0.22284997, 'binary_recall': 0.5274888, 'binary_specificity': 0.9314773, 'binary_f1_score': 0.31332743}
confusion matrix:
       0     1
0  16829  1238
1    318   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91766036, 'precision': 0.6446783, 'recall': 0.8301399, 'specificity': 0.8301399, 'f1': 0.69170505, 'auroc': 0.90021217, 'binary_precision': 0.30173776, 'binary_recall': 0.7346154, 'binary_specificity': 0.9256643, 'binary_f1_score': 0.42777157}
confusion matrix:
      0    1
0  5504  442
1    69  191
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 06:04:15.827484,epoch time: 0:14:02.313585,used: 0:42:23.061825,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.949337, 'precision': 0.95089084, 'recall': 0.94935954, 'specificity': 0.94935954, 'f1': 0.94929504, 'auroc': 0.98893446, 'binary_precision': 0.9775517, 'binary_recall': 0.91987514, 'binary_specificity': 0.97884387, 'binary_f1_score': 0.9478368}
confusion matrix:
       0      1
0  28177    609
1   2310  26520
---- Validation: 
scalar performance:
{'acc': 0.9118997, 'precision': 0.6046216, 'recall': 0.7597562, 'specificity': 0.7597562, 'f1': 0.63990575, 'auroc': 0.85595405, 'binary_precision': 0.2252809, 'binary_recall': 0.5958395, 'binary_specificity': 0.923673, 'binary_f1_score': 0.3269466}
confusion matrix:
       0     1
0  16688  1379
1    272   401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90090233, 'precision': 0.62814295, 'recall': 0.84346235, 'specificity': 0.84346235, 'f1': 0.6718297, 'auroc': 0.90136355, 'binary_precision': 0.26675427, 'binary_recall': 0.7807692, 'binary_specificity': 0.9061554, 'binary_f1_score': 0.39764938}
confusion matrix:
      0    1
0  5388  558
1    57  203
early stop counter: 1
val acc:0.9118996858596802, best validation acc: 0.9169690608978271, corresponding to test acc:                         0.9176603555679321 / 0.9176603555679321
after epoch: 4,now: 2024-08-02 06:18:13.546363,epoch time: 0:13:57.718879,used: 0:56:20.780704,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95574147, 'precision': 0.9561987, 'recall': 0.9557537, 'specificity': 0.9557537, 'f1': 0.95573115, 'auroc': 0.9901237, 'binary_precision': 0.97083277, 'binary_recall': 0.93978494, 'binary_specificity': 0.97172236, 'binary_f1_score': 0.9550566}
confusion matrix:
       0      1
0  27972    814
1   1736  27094
---- Validation: 
scalar performance:
{'acc': 0.9024546, 'precision': 0.59943515, 'recall': 0.77560055, 'specificity': 0.77560055, 'f1': 0.63369983, 'auroc': 0.8639924, 'binary_precision': 0.2133995, 'binary_recall': 0.63893014, 'binary_specificity': 0.91227096, 'binary_f1_score': 0.31994048}
confusion matrix:
       0     1
0  16482  1585
1    243   430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8838221, 'precision': 0.6121299, 'recall': 0.83638775, 'specificity': 0.83638775, 'f1': 0.6487402, 'auroc': 0.90278983, 'binary_precision': 0.2347526, 'binary_recall': 0.7846154, 'binary_specificity': 0.8881601, 'binary_f1_score': 0.36138177}
confusion matrix:
      0    1
0  5281  665
1    56  204
early stop counter: 2
val acc:0.9024546146392822, best validation acc: 0.9169690608978271, corresponding to test acc:                         0.9176603555679321 / 0.9176603555679321
after epoch: 5,now: 2024-08-02 06:32:09.223054,epoch time: 0:13:55.676691,used: 1:10:16.457395,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95782423, 'precision': 0.9582945, 'recall': 0.95783544, 'specificity': 0.95783544, 'f1': 0.9578141, 'auroc': 0.9913479, 'binary_precision': 0.97315025, 'binary_recall': 0.94168866, 'binary_specificity': 0.9739822, 'binary_f1_score': 0.957161}
confusion matrix:
       0      1
0  28039    749
1   1681  27147
---- Validation: 
scalar performance:
{'acc': 0.9097652, 'precision': 0.6074509, 'recall': 0.78010726, 'specificity': 0.78010726, 'f1': 0.6446134, 'auroc': 0.87162626, 'binary_precision': 0.22925532, 'binary_recall': 0.640416, 'binary_specificity': 0.91979855, 'binary_f1_score': 0.337642}
confusion matrix:
       0     1
0  16618  1449
1    242   431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89252335, 'precision': 0.620356, 'recall': 0.8427676, 'specificity': 0.8427676, 'f1': 0.6609214, 'auroc': 0.9032731, 'binary_precision': 0.250918, 'binary_recall': 0.78846157, 'binary_specificity': 0.8970737, 'binary_f1_score': 0.3806871}
confusion matrix:
      0    1
0  5334  612
1    55  205
early stop counter: 3
val acc:0.9097651839256287, best validation acc: 0.9169690608978271, corresponding to test acc:                         0.9176603555679321 / 0.9176603555679321
after epoch: 6,now: 2024-08-02 06:46:04.655340,epoch time: 0:13:55.432286,used: 1:24:11.889681,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95817137, 'precision': 0.9594477, 'recall': 0.9581907, 'specificity': 0.9581907, 'f1': 0.9581435, 'auroc': 0.992221, 'binary_precision': 0.9838467, 'binary_recall': 0.9317007, 'binary_specificity': 0.9846806, 'binary_f1_score': 0.957064}
confusion matrix:
       0      1
0  28346    441
1   1969  26860
---- Validation: 
scalar performance:
{'acc': 0.92817503, 'precision': 0.6258322, 'recall': 0.7596139, 'specificity': 0.7596139, 'f1': 0.66411006, 'auroc': 0.86863065, 'binary_precision': 0.26809096, 'binary_recall': 0.5780089, 'binary_specificity': 0.9412188, 'binary_f1_score': 0.36629}
confusion matrix:
       0     1
0  17005  1062
1    284   389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91411537, 'precision': 0.6411956, 'recall': 0.8356458, 'specificity': 0.8356458, 'f1': 0.6880715, 'auroc': 0.9036262, 'binary_precision': 0.29411766, 'binary_recall': 0.75, 'binary_specificity': 0.92129165, 'binary_f1_score': 0.4225352}
confusion matrix:
      0    1
0  5478  468
1    65  195
better model found
persisted
after epoch: 7,now: 2024-08-02 06:59:58.882685,epoch time: 0:13:54.227345,used: 1:38:06.117026,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96327406, 'precision': 0.9637457, 'recall': 0.96328527, 'specificity': 0.96328527, 'f1': 0.9632653, 'auroc': 0.9932065, 'binary_precision': 0.9787097, 'binary_recall': 0.9472041, 'binary_specificity': 0.9793664, 'binary_f1_score': 0.9626992}
confusion matrix:
       0      1
0  28194    594
1   1522  27306
---- Validation: 
scalar performance:
{'acc': 0.910619, 'precision': 0.6113392, 'recall': 0.7927096, 'specificity': 0.7927096, 'f1': 0.65026027, 'auroc': 0.87896717, 'binary_precision': 0.23603794, 'binary_recall': 0.66567606, 'binary_specificity': 0.9197432, 'binary_f1_score': 0.34850255}
confusion matrix:
       0     1
0  16617  1450
1    225   448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88720596, 'precision': 0.6150572, 'recall': 0.83815366, 'specificity': 0.83815366, 'f1': 0.65315306, 'auroc': 0.9021902, 'binary_precision': 0.24056605, 'binary_recall': 0.7846154, 'binary_specificity': 0.8916919, 'binary_f1_score': 0.36823106}
confusion matrix:
      0    1
0  5302  644
1    56  204
early stop counter: 1
val acc:0.9106190204620361, best validation acc: 0.9281750321388245, corresponding to test acc:                         0.9141153693199158 / 0.9176603555679321
after epoch: 8,now: 2024-08-02 07:13:53.260245,epoch time: 0:13:54.377560,used: 1:52:00.494586,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9642981, 'precision': 0.9646447, 'recall': 0.9643086, 'specificity': 0.9643086, 'f1': 0.96429205, 'auroc': 0.9932761, 'binary_precision': 0.9775265, 'binary_recall': 0.95050293, 'binary_specificity': 0.97811437, 'binary_f1_score': 0.96382535}
confusion matrix:
       0      1
0  28156    630
1   1427  27403
---- Validation: 
scalar performance:
{'acc': 0.9163287, 'precision': 0.61535376, 'recall': 0.782796, 'specificity': 0.782796, 'f1': 0.6547337, 'auroc': 0.87356436, 'binary_precision': 0.24501425, 'binary_recall': 0.63893014, 'binary_specificity': 0.92666185, 'binary_f1_score': 0.354201}
confusion matrix:
       0     1
0  16742  1325
1    243   430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8939736, 'precision': 0.62056875, 'recall': 0.83800745, 'specificity': 0.83800745, 'f1': 0.6612204, 'auroc': 0.900879, 'binary_precision': 0.25187033, 'binary_recall': 0.77692306, 'binary_specificity': 0.89909184, 'binary_f1_score': 0.38041434}
confusion matrix:
      0    1
0  5346  600
1    58  202
early stop counter: 2
val acc:0.9163287281990051, best validation acc: 0.9281750321388245, corresponding to test acc:                         0.9141153693199158 / 0.9176603555679321
after epoch: 9,now: 2024-08-02 07:27:49.706787,epoch time: 0:13:56.446542,used: 2:05:56.941128,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9691405, 'precision': 0.9692358, 'recall': 0.96914554, 'specificity': 0.96914554, 'f1': 0.96913916, 'auroc': 0.9944781, 'binary_precision': 0.9760983, 'binary_recall': 0.96187735, 'binary_specificity': 0.9764138, 'binary_f1_score': 0.9689356}
confusion matrix:
       0      1
0  28109    679
1   1099  27729
---- Validation: 
scalar performance:
{'acc': 0.9094984, 'precision': 0.6102071, 'recall': 0.7928437, 'specificity': 0.7928437, 'f1': 0.64878404, 'auroc': 0.8767396, 'binary_precision': 0.23373243, 'binary_recall': 0.66716194, 'binary_specificity': 0.9185255, 'binary_f1_score': 0.3461835}
confusion matrix:
       0     1
0  16595  1472
1    224   449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8781824, 'precision': 0.607946, 'recall': 0.8352836, 'specificity': 0.8352836, 'f1': 0.64220285, 'auroc': 0.89976907, 'binary_precision': 0.22626932, 'binary_recall': 0.78846157, 'binary_specificity': 0.8821056, 'binary_f1_score': 0.3516295}
confusion matrix:
      0    1
0  5245  701
1    55  205
early stop counter: 3
val acc:0.909498393535614, best validation acc: 0.9281750321388245, corresponding to test acc:                         0.9141153693199158 / 0.9176603555679321
after epoch: 10,now: 2024-08-02 07:41:44.634271,epoch time: 0:13:54.927484,used: 2:19:51.868612,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9680818, 'precision': 0.9684661, 'recall': 0.9680923, 'specificity': 0.9680923, 'f1': 0.96807575, 'auroc': 0.99497485, 'binary_precision': 0.9820676, 'binary_recall': 0.9536231, 'binary_specificity': 0.9825616, 'binary_f1_score': 0.9676364}
confusion matrix:
       0      1
0  28285    502
1   1337  27492
---- Validation: 
scalar performance:
{'acc': 0.9133938, 'precision': 0.6119546, 'recall': 0.7827045, 'specificity': 0.7827045, 'f1': 0.65051293, 'auroc': 0.87295043, 'binary_precision': 0.23814774, 'binary_recall': 0.6419019, 'binary_specificity': 0.923507, 'binary_f1_score': 0.3474065}
confusion matrix:
       0     1
0  16685  1382
1    241   432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87383175, 'precision': 0.60266376, 'recall': 0.8238182, 'specificity': 0.8238182, 'f1': 0.6341966, 'auroc': 0.8950673, 'binary_precision': 0.21668473, 'binary_recall': 0.7692308, 'binary_specificity': 0.87840563, 'binary_f1_score': 0.3381234}
confusion matrix:
      0    1
0  5223  723
1    60  200
early stop counter: 4
val acc:0.9133937954902649, best validation acc: 0.9281750321388245, corresponding to test acc:                         0.9141153693199158 / 0.9176603555679321
after epoch: 11,now: 2024-08-02 07:55:39.348769,epoch time: 0:13:54.714498,used: 2:33:46.583110,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9689322, 'precision': 0.9690739, 'recall': 0.96893835, 'specificity': 0.96893835, 'f1': 0.9689302, 'auroc': 0.99507725, 'binary_precision': 0.9773995, 'binary_recall': 0.9601082, 'binary_specificity': 0.97776854, 'binary_f1_score': 0.96867675}
confusion matrix:
       0      1
0  28148    640
1   1150  27678
---- Validation: 
scalar performance:
{'acc': 0.9104589, 'precision': 0.6146171, 'recall': 0.8076472, 'specificity': 0.8076472, 'f1': 0.6552164, 'auroc': 0.8859718, 'binary_precision': 0.2413793, 'binary_recall': 0.6968796, 'binary_specificity': 0.9184148, 'binary_f1_score': 0.35856268}
confusion matrix:
       0     1
0  16593  1474
1    204   469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8714148, 'precision': 0.6024992, 'recall': 0.8299128, 'specificity': 0.8299128, 'f1': 0.6335483, 'auroc': 0.8993118, 'binary_precision': 0.21564482, 'binary_recall': 0.7846154, 'binary_specificity': 0.8752102, 'binary_f1_score': 0.33830845}
confusion matrix:
      0    1
0  5204  742
1    56  204
early stop counter: 5
val acc:0.9104589223861694, best validation acc: 0.9281750321388245, corresponding to test acc:                         0.9141153693199158 / 0.9176603555679321
after epoch: 12,now: 2024-08-02 08:09:35.844575,epoch time: 0:13:56.495806,used: 2:47:43.078916,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.970286, 'precision': 0.9704266, 'recall': 0.97029245, 'specificity': 0.97029245, 'f1': 0.9702841, 'auroc': 0.9954759, 'binary_precision': 0.9787437, 'binary_recall': 0.9614971, 'binary_specificity': 0.97908777, 'binary_f1_score': 0.9700437}
confusion matrix:
       0      1
0  28185    602
1   1110  27719
---- Validation: 
scalar performance:
{'acc': 0.92726785, 'precision': 0.6318133, 'recall': 0.7891846, 'specificity': 0.7891846, 'f1': 0.67437726, 'auroc': 0.8848121, 'binary_precision': 0.27770618, 'binary_recall': 0.640416, 'binary_specificity': 0.9379532, 'binary_f1_score': 0.38741574}
confusion matrix:
       0     1
0  16946  1121
1    242   431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8963906, 'precision': 0.6221819, 'recall': 0.83559084, 'specificity': 0.83559084, 'f1': 0.6634759, 'auroc': 0.9008771, 'binary_precision': 0.25542784, 'binary_recall': 0.7692308, 'binary_specificity': 0.9019509, 'binary_f1_score': 0.3835091}
confusion matrix:
      0    1
0  5363  583
1    60  200
early stop counter: 6
val acc:0.927267849445343, best validation acc: 0.9281750321388245, corresponding to test acc:                         0.9141153693199158 / 0.9176603555679321
after epoch: 13,now: 2024-08-02 08:23:36.711584,epoch time: 0:14:00.867009,used: 3:01:43.945925,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97054636, 'precision': 0.971167, 'recall': 0.97055906, 'specificity': 0.97055906, 'f1': 0.97053725, 'auroc': 0.9956689, 'binary_precision': 0.988442, 'binary_recall': 0.9522686, 'binary_specificity': 0.9888495, 'binary_f1_score': 0.9700182}
confusion matrix:
       0      1
0  28467    321
1   1376  27452
---- Validation: 
scalar performance:
{'acc': 0.92566705, 'precision': 0.6256513, 'recall': 0.77404904, 'specificity': 0.77404904, 'f1': 0.66580254, 'auroc': 0.87981963, 'binary_precision': 0.26653695, 'binary_recall': 0.61069834, 'binary_specificity': 0.9373997, 'binary_f1_score': 0.37110606}
confusion matrix:
       0     1
0  16936  1131
1    262   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89139545, 'precision': 0.61607045, 'recall': 0.8274671, 'specificity': 0.8274671, 'f1': 0.65474963, 'auroc': 0.89724314, 'binary_precision': 0.24381188, 'binary_recall': 0.75769234, 'binary_specificity': 0.89724183, 'binary_f1_score': 0.36891386}
confusion matrix:
      0    1
0  5335  611
1    63  197
early stop counter: 7
val acc:0.9256670475006104, best validation acc: 0.9281750321388245, corresponding to test acc:                         0.9141153693199158 / 0.9176603555679321
after epoch: 14,now: 2024-08-02 08:37:38.014435,epoch time: 0:14:01.302851,used: 3:15:45.248776,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97301096, 'precision': 0.97321147, 'recall': 0.9730186, 'specificity': 0.9730186, 'f1': 0.9730084, 'auroc': 0.99589205, 'binary_precision': 0.9831361, 'binary_recall': 0.9625724, 'binary_specificity': 0.9834648, 'binary_f1_score': 0.9727456}
confusion matrix:
       0      1
0  28311    476
1   1079  27750
---- Validation: 
scalar performance:
{'acc': 0.9099253, 'precision': 0.6105312, 'recall': 0.7923498, 'specificity': 0.7923498, 'f1': 0.6491885, 'auroc': 0.87933254, 'binary_precision': 0.23443224, 'binary_recall': 0.66567606, 'binary_specificity': 0.91902363, 'binary_f1_score': 0.34674925}
confusion matrix:
       0     1
0  16604  1463
1    225   448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8681921, 'precision': 0.5998536, 'recall': 0.82639205, 'specificity': 0.82639205, 'f1': 0.6292926, 'auroc': 0.8937979, 'binary_precision': 0.21058092, 'binary_recall': 0.7807692, 'binary_specificity': 0.8720148, 'binary_f1_score': 0.33169934}
confusion matrix:
      0    1
0  5185  761
1    57  203
early stop counter: 8
val acc:0.9099252820014954, best validation acc: 0.9281750321388245, corresponding to test acc:                         0.9141153693199158 / 0.9176603555679321
after epoch: 15,now: 2024-08-02 08:51:48.190788,epoch time: 0:14:10.176353,used: 3:29:55.425129,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_05_21_51_seed_1_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:29:55.425129 at 2024-08-02 08:51:48.190788
persisted model performance metric: 

scalar performance:
{'acc': 0.91411537, 'precision': 0.6411956, 'recall': 0.8356458, 'specificity': 0.8356458, 'f1': 0.6880715, 'auroc': 0.9036262, 'binary_precision': 0.29411766, 'binary_recall': 0.75, 'binary_specificity': 0.92129165, 'binary_f1_score': 0.4225352}
confusion matrix:
      0    1
0  5478  468
1    65  195
oracle model performance metric: 

scalar performance:
{'acc': 0.91766036, 'precision': 0.6446783, 'recall': 0.8301399, 'specificity': 0.8301399, 'f1': 0.69170505, 'auroc': 0.90021217, 'binary_precision': 0.30173776, 'binary_recall': 0.7346154, 'binary_specificity': 0.9256643, 'binary_f1_score': 0.42777157}
confusion matrix:
      0    1
0  5504  442
1    69  191
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1135 MiB |   8771 MiB | 724975 GiB | 724974 GiB |
|       from large pool |   1097 MiB |   8726 MiB | 713388 GiB | 713387 GiB |
|       from small pool |     38 MiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1135 MiB |   8771 MiB | 724975 GiB | 724974 GiB |
|       from large pool |   1097 MiB |   8726 MiB | 713388 GiB | 713387 GiB |
|       from small pool |     38 MiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1128 MiB |   8764 MiB | 724831 GiB | 724830 GiB |
|       from large pool |   1090 MiB |   8720 MiB | 713268 GiB | 713267 GiB |
|       from small pool |     37 MiB |     79 MiB |  11562 GiB |  11562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9872 MiB |   9896 MiB |  18558 MiB |   8686 MiB |
|       from large pool |   9792 MiB |   9810 MiB |  18448 MiB |   8656 MiB |
|       from small pool |     80 MiB |     86 MiB |    110 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61511 KiB |    833 MiB | 394821 GiB | 394821 GiB |
|       from large pool |  37749 KiB |    831 MiB | 383216 GiB | 383216 GiB |
|       from small pool |  23762 KiB |     32 MiB |  11604 GiB |  11604 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3448    |    8191    |  143275 K  |  143272 K  |
|       from large pool |     161    |     844    |   67338 K  |   67338 K  |
|       from small pool |    3287    |    8028    |   75936 K  |   75933 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3448    |    8191    |  143275 K  |  143272 K  |
|       from large pool |     161    |     844    |   67338 K  |   67338 K  |
|       from small pool |    3287    |    8028    |   75936 K  |   75933 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     398    |     401    |     744    |     346    |
|       from large pool |     358    |     358    |     689    |     331    |
|       from small pool |      40    |      43    |      55    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3631    |   80501 K  |   80501 K  |
|       from large pool |      17    |     351    |   45921 K  |   45921 K  |
|       from small pool |      56    |    3615    |   34579 K  |   34579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8771 MiB | 724975 GiB | 724975 GiB |
|       from large pool |  16640 KiB |   8726 MiB | 713388 GiB | 713388 GiB |
|       from small pool |      0 KiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8771 MiB | 724975 GiB | 724975 GiB |
|       from large pool |  16640 KiB |   8726 MiB | 713388 GiB | 713388 GiB |
|       from small pool |      0 KiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8764 MiB | 724831 GiB | 724831 GiB |
|       from large pool |  16640 KiB |   8720 MiB | 713268 GiB | 713268 GiB |
|       from small pool |      0 KiB |     79 MiB |  11562 GiB |  11562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1196 MiB |   9896 MiB |  18558 MiB |  17362 MiB |
|       from large pool |   1134 MiB |   9810 MiB |  18448 MiB |  17314 MiB |
|       from small pool |     62 MiB |     86 MiB |    110 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    833 MiB | 394821 GiB | 394821 GiB |
|       from large pool |  30464 KiB |    831 MiB | 383216 GiB | 383216 GiB |
|       from small pool |      0 KiB |     41 MiB |  11604 GiB |  11604 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143275 K  |  143275 K  |
|       from large pool |       2    |     844    |   67338 K  |   67338 K  |
|       from small pool |       0    |    8028    |   75936 K  |   75936 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143275 K  |  143275 K  |
|       from large pool |       2    |     844    |   67338 K  |   67338 K  |
|       from small pool |       0    |    8028    |   75936 K  |   75936 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     401    |     744    |     687    |
|       from large pool |      26    |     358    |     689    |     663    |
|       from small pool |      31    |      43    |      55    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3631    |   80502 K  |   80502 K  |
|       from large pool |       2    |     351    |   45921 K  |   45921 K  |
|       from small pool |       0    |    3615    |   34581 K  |   34581 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8771 MiB | 724975 GiB | 724975 GiB |
|       from large pool |  16640 KiB |   8726 MiB | 713388 GiB | 713388 GiB |
|       from small pool |      0 KiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8771 MiB | 724975 GiB | 724975 GiB |
|       from large pool |  16640 KiB |   8726 MiB | 713388 GiB | 713388 GiB |
|       from small pool |      0 KiB |     80 MiB |  11587 GiB |  11587 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8764 MiB | 724831 GiB | 724831 GiB |
|       from large pool |  16640 KiB |   8720 MiB | 713268 GiB | 713268 GiB |
|       from small pool |      0 KiB |     79 MiB |  11562 GiB |  11562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1196 MiB |   9896 MiB |  18558 MiB |  17362 MiB |
|       from large pool |   1134 MiB |   9810 MiB |  18448 MiB |  17314 MiB |
|       from small pool |     62 MiB |     86 MiB |    110 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    833 MiB | 394821 GiB | 394821 GiB |
|       from large pool |  30464 KiB |    831 MiB | 383216 GiB | 383216 GiB |
|       from small pool |      0 KiB |     41 MiB |  11604 GiB |  11604 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143275 K  |  143275 K  |
|       from large pool |       2    |     844    |   67338 K  |   67338 K  |
|       from small pool |       0    |    8028    |   75936 K  |   75936 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143275 K  |  143275 K  |
|       from large pool |       2    |     844    |   67338 K  |   67338 K  |
|       from small pool |       0    |    8028    |   75936 K  |   75936 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     401    |     744    |     687    |
|       from large pool |      26    |     358    |     689    |     663    |
|       from small pool |      31    |      43    |      55    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3631    |   80502 K  |   80502 K  |
|       from large pool |       2    |     351    |   45921 K  |   45921 K  |
|       from small pool |       0    |    3615    |   34581 K  |   34581 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995

 Experiment start at: 2024-08-02 08:59:00.879158
before training, model accuracy: 0.03926911577582359
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8731648, 'precision': 0.8733697, 'recall': 0.8731624, 'specificity': 0.8731624, 'f1': 0.87314683, 'auroc': 0.9495375, 'binary_precision': 0.86467373, 'binary_recall': 0.8848686, 'binary_specificity': 0.8614561, 'binary_f1_score': 0.8746546}
confusion matrix:
       0      1
0  25108   4038
1   3357  25801
---- Validation: 
scalar performance:
{'acc': 0.6319182, 'precision': 0.5250548, 'recall': 0.6910107, 'specificity': 0.6910107, 'f1': 0.44185072, 'auroc': 0.7562474, 'binary_precision': 0.06291574, 'binary_recall': 0.75415283, 'binary_specificity': 0.6278686, 'binary_f1_score': 0.11614223}
confusion matrix:
       0     1
0  11409  6762
1    148   454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57188654, 'precision': 0.5256491, 'recall': 0.6702373, 'specificity': 0.6702373, 'f1': 0.42009258, 'auroc': 0.7717812, 'binary_precision': 0.06702317, 'binary_recall': 0.7768595, 'binary_specificity': 0.56361514, 'binary_f1_score': 0.12340006}
confusion matrix:
      0     1
0  3380  2617
1    54   188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 09:13:48.684479,epoch time: 0:14:47.805321,used: 0:14:47.805321,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9217892, 'precision': 0.92383945, 'recall': 0.92179644, 'specificity': 0.92179644, 'f1': 0.9216954, 'auroc': 0.97468436, 'binary_precision': 0.9533692, 'binary_recall': 0.886995, 'binary_specificity': 0.9565978, 'binary_f1_score': 0.9189852}
confusion matrix:
       0      1
0  27881   1265
1   3295  25863
---- Validation: 
scalar performance:
{'acc': 0.9137591, 'precision': 0.57343674, 'recall': 0.6767932, 'specificity': 0.6767932, 'f1': 0.5969182, 'auroc': 0.78044, 'binary_precision': 0.16699411, 'binary_recall': 0.42358804, 'binary_specificity': 0.92999834, 'binary_f1_score': 0.23954909}
confusion matrix:
       0     1
0  16899  1272
1    347   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9060747, 'precision': 0.6057003, 'recall': 0.75881636, 'specificity': 0.75881636, 'f1': 0.6402708, 'auroc': 0.8344331, 'binary_precision': 0.22870663, 'binary_recall': 0.59917355, 'binary_specificity': 0.91845924, 'binary_f1_score': 0.33105025}
confusion matrix:
      0    1
0  5508  489
1    97  145
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 09:28:25.843296,epoch time: 0:14:37.158817,used: 0:29:24.964138,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9367282, 'precision': 0.93900037, 'recall': 0.9367331, 'specificity': 0.9367331, 'f1': 0.9366467, 'auroc': 0.9824325, 'binary_precision': 0.9706176, 'binary_recall': 0.90074086, 'binary_specificity': 0.9727254, 'binary_f1_score': 0.93437463}
confusion matrix:
       0      1
0  28353    795
1   2894  26262
---- Validation: 
scalar performance:
{'acc': 0.92308104, 'precision': 0.5898606, 'recall': 0.6992756, 'specificity': 0.6992756, 'f1': 0.6183281, 'auroc': 0.80880606, 'binary_precision': 0.19842407, 'binary_recall': 0.4601329, 'binary_specificity': 0.9384184, 'binary_f1_score': 0.2772773}
confusion matrix:
       0     1
0  17052  1119
1    325   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91376823, 'precision': 0.6249301, 'recall': 0.8024732, 'specificity': 0.8024732, 'f1': 0.6669225, 'auroc': 0.86352956, 'binary_precision': 0.26357827, 'binary_recall': 0.6818182, 'binary_specificity': 0.92312825, 'binary_f1_score': 0.38018435}
confusion matrix:
      0    1
0  5536  461
1    77  165
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 09:42:48.316668,epoch time: 0:14:22.473372,used: 0:43:47.437510,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9461958, 'precision': 0.9474231, 'recall': 0.9462003, 'specificity': 0.9462003, 'f1': 0.94615924, 'auroc': 0.9867928, 'binary_precision': 0.9708991, 'binary_recall': 0.91998494, 'binary_specificity': 0.9724157, 'binary_f1_score': 0.94475657}
confusion matrix:
       0      1
0  28343    804
1   2333  26824
---- Validation: 
scalar performance:
{'acc': 0.9342673, 'precision': 0.60779095, 'recall': 0.7058571, 'specificity': 0.7058571, 'f1': 0.6380514, 'auroc': 0.8307209, 'binary_precision': 0.23400673, 'binary_recall': 0.46179402, 'binary_specificity': 0.9499202, 'binary_f1_score': 0.3106145}
confusion matrix:
       0    1
0  17261  910
1    324  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9307581, 'precision': 0.652357, 'recall': 0.8132937, 'specificity': 0.8132937, 'f1': 0.698838, 'auroc': 0.8807131, 'binary_precision': 0.31800765, 'binary_recall': 0.6859504, 'binary_specificity': 0.940637, 'binary_f1_score': 0.434555}
confusion matrix:
      0    1
0  5641  356
1    76  166
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 09:57:13.626478,epoch time: 0:14:25.309810,used: 0:58:12.747320,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95307356, 'precision': 0.9543231, 'recall': 0.9530798, 'specificity': 0.9530798, 'f1': 0.9530417, 'auroc': 0.9897586, 'binary_precision': 0.97820973, 'binary_recall': 0.92681503, 'binary_specificity': 0.97934467, 'binary_f1_score': 0.9518191}
confusion matrix:
       0      1
0  28543    602
1   2134  27025
---- Validation: 
scalar performance:
{'acc': 0.9326693, 'precision': 0.6085718, 'recall': 0.7170774, 'specificity': 0.7170774, 'f1': 0.64067334, 'auroc': 0.83360684, 'binary_precision': 0.23477565, 'binary_recall': 0.48671097, 'binary_specificity': 0.9474437, 'binary_f1_score': 0.31675676}
confusion matrix:
       0    1
0  17216  955
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.924988, 'precision': 0.64250386, 'recall': 0.81227493, 'specificity': 0.81227493, 'f1': 0.6881883, 'auroc': 0.8807765, 'binary_precision': 0.2982143, 'binary_recall': 0.69008267, 'binary_specificity': 0.93446726, 'binary_f1_score': 0.41645885}
confusion matrix:
      0    1
0  5604  393
1    75  167
early stop counter: 1
val acc:0.9326692819595337, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 5,now: 2024-08-02 10:11:43.194691,epoch time: 0:14:29.568213,used: 1:12:42.315533,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95789313, 'precision': 0.9588834, 'recall': 0.9578979, 'specificity': 0.9578979, 'f1': 0.9578707, 'auroc': 0.9912808, 'binary_precision': 0.9802525, 'binary_recall': 0.934632, 'binary_specificity': 0.9811638, 'binary_f1_score': 0.9568988}
confusion matrix:
       0      1
0  28597    549
1   1906  27252
---- Validation: 
scalar performance:
{'acc': 0.9276088, 'precision': 0.61179554, 'recall': 0.75622183, 'specificity': 0.75622183, 'f1': 0.6492324, 'auroc': 0.85439473, 'binary_precision': 0.23842433, 'binary_recall': 0.5730897, 'binary_specificity': 0.93935394, 'binary_f1_score': 0.33674967}
confusion matrix:
       0     1
0  17069  1102
1    257   345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92082065, 'precision': 0.63675904, 'recall': 0.81407267, 'specificity': 0.81407267, 'f1': 0.681916, 'auroc': 0.88853604, 'binary_precision': 0.28644067, 'binary_recall': 0.6983471, 'binary_specificity': 0.92979825, 'binary_f1_score': 0.40624997}
confusion matrix:
      0    1
0  5576  421
1    73  169
early stop counter: 2
val acc:0.9276087880134583, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 6,now: 2024-08-02 10:26:06.949917,epoch time: 0:14:23.755226,used: 1:27:06.070759,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9620266, 'precision': 0.96265244, 'recall': 0.9620291, 'specificity': 0.9620291, 'f1': 0.96201396, 'auroc': 0.99259424, 'binary_precision': 0.9797023, 'binary_recall': 0.94361365, 'binary_specificity': 0.9804446, 'binary_f1_score': 0.9613194}
confusion matrix:
       0      1
0  28578    570
1   1644  27512
---- Validation: 
scalar performance:
{'acc': 0.90907156, 'precision': 0.5964316, 'recall': 0.77957106, 'specificity': 0.77957106, 'f1': 0.6313688, 'auroc': 0.8630763, 'binary_precision': 0.2056473, 'binary_recall': 0.641196, 'binary_specificity': 0.91794616, 'binary_f1_score': 0.31141588}
confusion matrix:
       0     1
0  16680  1491
1    216   386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89389324, 'precision': 0.6101397, 'recall': 0.82385856, 'specificity': 0.82385856, 'f1': 0.64785963, 'auroc': 0.89118254, 'binary_precision': 0.2314578, 'binary_recall': 0.74793386, 'binary_specificity': 0.89978325, 'binary_f1_score': 0.3535156}
confusion matrix:
      0    1
0  5396  601
1    61  181
early stop counter: 3
val acc:0.9090715646743774, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 7,now: 2024-08-02 10:40:55.420542,epoch time: 0:14:48.470625,used: 1:41:54.541384,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96333015, 'precision': 0.96372324, 'recall': 0.9633336, 'specificity': 0.9633336, 'f1': 0.9633225, 'auroc': 0.9935299, 'binary_precision': 0.9772848, 'binary_recall': 0.9487294, 'binary_specificity': 0.9779379, 'binary_f1_score': 0.9627954}
confusion matrix:
       0      1
0  28502    643
1   1495  27664
---- Validation: 
scalar performance:
{'acc': 0.9086454, 'precision': 0.59801286, 'recall': 0.7881845, 'specificity': 0.7881845, 'f1': 0.6337563, 'auroc': 0.8683733, 'binary_precision': 0.20818038, 'binary_recall': 0.6594684, 'binary_specificity': 0.9169006, 'binary_f1_score': 0.31646076}
confusion matrix:
       0     1
0  16661  1510
1    205   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89213014, 'precision': 0.6093847, 'recall': 0.8269069, 'specificity': 0.8269069, 'f1': 0.646714, 'auroc': 0.8917785, 'binary_precision': 0.22961104, 'binary_recall': 0.75619835, 'binary_specificity': 0.8976155, 'binary_f1_score': 0.35226178}
confusion matrix:
      0    1
0  5383  614
1    59  183
early stop counter: 4
val acc:0.9086453914642334, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 8,now: 2024-08-02 10:55:30.705153,epoch time: 0:14:35.284611,used: 1:56:29.825995,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9664517, 'precision': 0.96691793, 'recall': 0.966455, 'specificity': 0.966455, 'f1': 0.96644354, 'auroc': 0.99415964, 'binary_precision': 0.98172414, 'binary_recall': 0.9506139, 'binary_specificity': 0.98229605, 'binary_f1_score': 0.96591866}
confusion matrix:
       0      1
0  28630    516
1   1440  27718
---- Validation: 
scalar performance:
{'acc': 0.9265967, 'precision': 0.616872, 'recall': 0.7821996, 'specificity': 0.7821996, 'f1': 0.65767545, 'auroc': 0.8682163, 'binary_precision': 0.24673629, 'binary_recall': 0.627907, 'binary_specificity': 0.9364922, 'binary_f1_score': 0.3542643}
confusion matrix:
       0     1
0  17017  1154
1    224   378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91665334, 'precision': 0.6324775, 'recall': 0.8198359, 'specificity': 0.8198359, 'f1': 0.6773784, 'auroc': 0.89248276, 'binary_precision': 0.27724358, 'binary_recall': 0.71487606, 'binary_specificity': 0.92479575, 'binary_f1_score': 0.3995381}
confusion matrix:
      0    1
0  5546  451
1    69  173
early stop counter: 5
val acc:0.9265967011451721, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 9,now: 2024-08-02 11:10:20.523902,epoch time: 0:14:49.818749,used: 2:11:19.644744,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9642906, 'precision': 0.96533895, 'recall': 0.9642947, 'specificity': 0.9642947, 'f1': 0.9642707, 'auroc': 0.9942235, 'binary_precision': 0.98746896, 'binary_recall': 0.94052887, 'binary_specificity': 0.98806053, 'binary_f1_score': 0.9634275}
confusion matrix:
       0      1
0  28799    348
1   1734  27423
---- Validation: 
scalar performance:
{'acc': 0.9264902, 'precision': 0.61495095, 'recall': 0.7749171, 'specificity': 0.7749171, 'f1': 0.65474486, 'auroc': 0.8658974, 'binary_precision': 0.24340369, 'binary_recall': 0.6129568, 'binary_specificity': 0.9368774, 'binary_f1_score': 0.34844193}
confusion matrix:
       0     1
0  17024  1147
1    233   369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91553134, 'precision': 0.63048613, 'recall': 0.8172695, 'specificity': 0.8172695, 'f1': 0.6747724, 'auroc': 0.88830364, 'binary_precision': 0.27344993, 'binary_recall': 0.7107438, 'binary_specificity': 0.9237952, 'binary_f1_score': 0.39494836}
confusion matrix:
      0    1
0  5540  457
1    70  172
early stop counter: 6
val acc:0.9264901876449585, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 10,now: 2024-08-02 11:24:53.723252,epoch time: 0:14:33.199350,used: 2:25:52.844094,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.968527, 'precision': 0.9687826, 'recall': 0.968529, 'specificity': 0.968529, 'f1': 0.96852285, 'auroc': 0.9950387, 'binary_precision': 0.979771, 'binary_recall': 0.95681995, 'binary_specificity': 0.9802381, 'binary_f1_score': 0.96815956}
confusion matrix:
       0      1
0  28571    576
1   1259  27898
---- Validation: 
scalar performance:
{'acc': 0.9169552, 'precision': 0.60953414, 'recall': 0.80211365, 'specificity': 0.80211365, 'f1': 0.6499012, 'auroc': 0.8730984, 'binary_precision': 0.23042254, 'binary_recall': 0.679402, 'binary_specificity': 0.92482525, 'binary_f1_score': 0.34413126}
confusion matrix:
       0     1
0  16805  1366
1    193   409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8953358, 'precision': 0.6114964, 'recall': 0.8246089, 'specificity': 0.8246089, 'f1': 0.64984214, 'auroc': 0.8914292, 'binary_precision': 0.23415264, 'binary_recall': 0.74793386, 'binary_specificity': 0.901284, 'binary_f1_score': 0.35665023}
confusion matrix:
      0    1
0  5405  592
1    61  181
early stop counter: 7
val acc:0.9169551730155945, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 11,now: 2024-08-02 11:39:24.661677,epoch time: 0:14:30.938425,used: 2:40:23.782519,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9707567, 'precision': 0.97102535, 'recall': 0.97075915, 'specificity': 0.97075915, 'f1': 0.9707526, 'auroc': 0.99547184, 'binary_precision': 0.98232543, 'binary_recall': 0.9587763, 'binary_specificity': 0.9827421, 'binary_f1_score': 0.97040796}
confusion matrix:
       0      1
0  28643    503
1   1202  27956
---- Validation: 
scalar performance:
{'acc': 0.9002823, 'precision': 0.59389275, 'recall': 0.8015315, 'specificity': 0.8015315, 'f1': 0.62774384, 'auroc': 0.8738519, 'binary_precision': 0.1987666, 'binary_recall': 0.6960133, 'binary_specificity': 0.9070497, 'binary_f1_score': 0.3092251}
confusion matrix:
       0     1
0  16482  1689
1    183   419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8802693, 'precision': 0.6008214, 'recall': 0.82668537, 'specificity': 0.82668537, 'f1': 0.6333384, 'auroc': 0.8923911, 'binary_precision': 0.21208666, 'binary_recall': 0.76859504, 'binary_specificity': 0.8847757, 'binary_f1_score': 0.33243966}
confusion matrix:
      0    1
0  5306  691
1    56  186
early stop counter: 8
val acc:0.9002823233604431, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 12,now: 2024-08-02 11:53:50.695054,epoch time: 0:14:26.033377,used: 2:54:49.815896,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97156286, 'precision': 0.97188663, 'recall': 0.9715651, 'specificity': 0.9715651, 'f1': 0.9715581, 'auroc': 0.99577534, 'binary_precision': 0.9842908, 'binary_recall': 0.95843196, 'binary_specificity': 0.98469824, 'binary_f1_score': 0.97118926}
confusion matrix:
       0      1
0  28701    446
1   1212  27945
---- Validation: 
scalar performance:
{'acc': 0.9075268, 'precision': 0.59777516, 'recall': 0.7916219, 'specificity': 0.7916219, 'f1': 0.63347197, 'auroc': 0.8701496, 'binary_precision': 0.20743035, 'binary_recall': 0.6677741, 'binary_specificity': 0.9154697, 'binary_f1_score': 0.3165354}
confusion matrix:
       0     1
0  16635  1536
1    200   402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8861997, 'precision': 0.60296655, 'recall': 0.81787384, 'specificity': 0.81787384, 'f1': 0.63710576, 'auroc': 0.8880136, 'binary_precision': 0.2173913, 'binary_recall': 0.74380165, 'binary_specificity': 0.89194596, 'binary_f1_score': 0.33644858}
confusion matrix:
      0    1
0  5349  648
1    62  180
early stop counter: 9
val acc:0.9075267910957336, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 13,now: 2024-08-02 12:08:11.024081,epoch time: 0:14:20.329027,used: 3:09:10.144923,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9738268, 'precision': 0.9738549, 'recall': 0.97382796, 'specificity': 0.97382796, 'f1': 0.9738265, 'auroc': 0.99605894, 'binary_precision': 0.9775681, 'binary_recall': 0.96992457, 'binary_specificity': 0.9777313, 'binary_f1_score': 0.9737314}
confusion matrix:
       0      1
0  28495    649
1    877  28283
---- Validation: 
scalar performance:
{'acc': 0.8705055, 'precision': 0.57724994, 'recall': 0.80863523, 'specificity': 0.80863523, 'f1': 0.59891695, 'auroc': 0.8793014, 'binary_precision': 0.16415718, 'binary_recall': 0.7425249, 'binary_specificity': 0.8747455, 'binary_f1_score': 0.26887217}
confusion matrix:
       0     1
0  15895  2276
1    155   447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8339478, 'precision': 0.5776991, 'recall': 0.8204347, 'specificity': 0.8204347, 'f1': 0.5898768, 'auroc': 0.8933557, 'binary_precision': 0.16469595, 'binary_recall': 0.8057851, 'binary_specificity': 0.8350842, 'binary_f1_score': 0.2734923}
confusion matrix:
      0    1
0  5008  989
1    47  195
early stop counter: 10
val acc:0.8705055117607117, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 14,now: 2024-08-02 12:22:38.611999,epoch time: 0:14:27.587918,used: 3:23:37.732841,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9734495, 'precision': 0.973585, 'recall': 0.97345126, 'specificity': 0.97345126, 'f1': 0.9734477, 'auroc': 0.9961997, 'binary_precision': 0.98164815, 'binary_recall': 0.9649496, 'binary_specificity': 0.9819529, 'binary_f1_score': 0.97322726}
confusion matrix:
       0      1
0  28620    526
1   1022  28136
---- Validation: 
scalar performance:
{'acc': 0.90624833, 'precision': 0.5952345, 'recall': 0.7853402, 'specificity': 0.7853402, 'f1': 0.6297562, 'auroc': 0.8677131, 'binary_precision': 0.20277208, 'binary_recall': 0.65614617, 'binary_specificity': 0.91453415, 'binary_f1_score': 0.3098039}
confusion matrix:
       0     1
0  16618  1553
1    207   395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88636, 'precision': 0.6030991, 'recall': 0.81795716, 'specificity': 0.81795716, 'f1': 0.6373097, 'auroc': 0.8893317, 'binary_precision': 0.21765417, 'binary_recall': 0.74380165, 'binary_specificity': 0.89211273, 'binary_f1_score': 0.33676332}
confusion matrix:
      0    1
0  5350  647
1    62  180
early stop counter: 11
val acc:0.9062483310699463, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.9307581186294556 / 0.9307581186294556
after epoch: 15,now: 2024-08-02 12:37:02.471911,epoch time: 0:14:23.859912,used: 3:38:01.592753,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_08_59_00_seed_2_23919995
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:38:01.592753 at 2024-08-02 12:37:02.471911
persisted model performance metric: 

scalar performance:
{'acc': 0.9307581, 'precision': 0.652357, 'recall': 0.8132937, 'specificity': 0.8132937, 'f1': 0.698838, 'auroc': 0.8807131, 'binary_precision': 0.31800765, 'binary_recall': 0.6859504, 'binary_specificity': 0.940637, 'binary_f1_score': 0.434555}
confusion matrix:
      0    1
0  5641  356
1    76  166
oracle model performance metric: 

scalar performance:
{'acc': 0.9307581, 'precision': 0.652357, 'recall': 0.8132937, 'specificity': 0.8132937, 'f1': 0.698838, 'auroc': 0.8807131, 'binary_precision': 0.31800765, 'binary_recall': 0.6859504, 'binary_specificity': 0.940637, 'binary_f1_score': 0.434555}
confusion matrix:
      0    1
0  5641  356
1    76  166
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1135 MiB |   8771 MiB |   1078 TiB |   1078 TiB |
|       from large pool |   1097 MiB |   8726 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     38 MiB |     80 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1135 MiB |   8771 MiB |   1078 TiB |   1078 TiB |
|       from large pool |   1097 MiB |   8726 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     38 MiB |     80 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1128 MiB |   8764 MiB |   1078 TiB |   1078 TiB |
|       from large pool |   1090 MiB |   8720 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     37 MiB |     79 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9872 MiB |   9896 MiB |  27234 MiB |  17362 MiB |
|       from large pool |   9792 MiB |   9810 MiB |  27106 MiB |  17314 MiB |
|       from small pool |     80 MiB |     86 MiB |    128 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  53313 KiB |    833 MiB | 603981 GiB | 603981 GiB |
|       from large pool |  37749 KiB |    831 MiB | 586396 GiB | 586396 GiB |
|       from small pool |  15564 KiB |     41 MiB |  17585 GiB |  17585 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3460    |    8277    |  217234 K  |  217231 K  |
|       from large pool |     161    |     844    |  102527 K  |  102527 K  |
|       from small pool |    3299    |    8114    |  114706 K  |  114703 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3460    |    8277    |  217234 K  |  217231 K  |
|       from large pool |     161    |     844    |  102527 K  |  102527 K  |
|       from small pool |    3299    |    8114    |  114706 K  |  114703 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     398    |     401    |    1085    |     687    |
|       from large pool |     358    |     358    |    1021    |     663    |
|       from small pool |      40    |      43    |      64    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    3673    |  122500 K  |  122500 K  |
|       from large pool |      17    |     351    |   71492 K  |   71492 K  |
|       from small pool |      48    |    3657    |   51008 K  |   51008 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8771 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8726 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     80 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8771 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8726 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     80 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8764 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8720 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     79 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1188 MiB |   9896 MiB |  27234 MiB |  26046 MiB |
|       from large pool |   1134 MiB |   9810 MiB |  27106 MiB |  25972 MiB |
|       from small pool |     54 MiB |     86 MiB |    128 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    833 MiB | 603982 GiB | 603982 GiB |
|       from large pool |  30464 KiB |    831 MiB | 586396 GiB | 586396 GiB |
|       from small pool |      0 KiB |     41 MiB |  17585 GiB |  17585 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8277    |  217234 K  |  217234 K  |
|       from large pool |       2    |     844    |  102527 K  |  102527 K  |
|       from small pool |       0    |    8114    |  114706 K  |  114706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8277    |  217234 K  |  217234 K  |
|       from large pool |       2    |     844    |  102527 K  |  102527 K  |
|       from small pool |       0    |    8114    |  114706 K  |  114706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     401    |    1085    |    1032    |
|       from large pool |      26    |     358    |    1021    |     995    |
|       from small pool |      27    |      43    |      64    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3673    |  122502 K  |  122502 K  |
|       from large pool |       2    |     351    |   71492 K  |   71492 K  |
|       from small pool |       0    |    3657    |   51009 K  |   51009 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 12:38:06 2024]
Finished job 0.
1 of 1 steps (100%) done
