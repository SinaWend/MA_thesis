Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 21:00:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990

 Experiment start at: 2024-08-01 21:10:08.282967
before training, model accuracy: 0.2599872350692749
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8775105, 'precision': 0.87998354, 'recall': 0.8775443, 'specificity': 0.8775443, 'f1': 0.87731767, 'auroc': 0.946238, 'binary_precision': 0.9108483, 'binary_recall': 0.83716553, 'binary_specificity': 0.917923, 'binary_f1_score': 0.872454}
confusion matrix:
       0      1
0  26304   2352
1   4674  24030
---- Validation: 
scalar performance:
{'acc': 0.92092377, 'precision': 0.598559, 'recall': 0.7167933, 'specificity': 0.7167933, 'f1': 0.6295631, 'auroc': 0.8057775, 'binary_precision': 0.21577883, 'binary_recall': 0.4976672, 'binary_specificity': 0.93591934, 'binary_f1_score': 0.3010348}
confusion matrix:
       0     1
0  16986  1163
1    323   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93767977, 'precision': 0.6686686, 'recall': 0.77875334, 'specificity': 0.77875334, 'f1': 0.70728457, 'auroc': 0.8745823, 'binary_precision': 0.35505617, 'binary_recall': 0.60536397, 'binary_specificity': 0.9521427, 'binary_f1_score': 0.44759205}
confusion matrix:
      0    1
0  5710  287
1   103  158
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 21:30:05.755880,epoch time: 0:19:57.472913,used: 0:19:57.472913,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9193166, 'precision': 0.9205922, 'recall': 0.9193368, 'specificity': 0.9193368, 'f1': 0.91925794, 'auroc': 0.9717705, 'binary_precision': 0.9439383, 'binary_recall': 0.8917111, 'binary_specificity': 0.94696254, 'binary_f1_score': 0.9170817}
confusion matrix:
       0      1
0  27139   1520
1   3108  25593
---- Validation: 
scalar performance:
{'acc': 0.93630266, 'precision': 0.6267955, 'recall': 0.73150563, 'specificity': 0.73150563, 'f1': 0.6606074, 'auroc': 0.83289605, 'binary_precision': 0.27145216, 'binary_recall': 0.5116641, 'binary_specificity': 0.9513472, 'binary_f1_score': 0.35471702}
confusion matrix:
       0    1
0  17266  883
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93767977, 'precision': 0.66988194, 'recall': 0.7842504, 'specificity': 0.7842504, 'f1': 0.7096038, 'auroc': 0.89333105, 'binary_precision': 0.35698447, 'binary_recall': 0.61685824, 'binary_specificity': 0.9516425, 'binary_f1_score': 0.45224717}
confusion matrix:
      0    1
0  5707  290
1   100  161
better model found
persisted
after epoch: 2,now: 2024-08-01 21:49:09.635704,epoch time: 0:19:03.879824,used: 0:39:01.352737,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9353382, 'precision': 0.9360614, 'recall': 0.93535316, 'specificity': 0.93535316, 'f1': 0.9353128, 'auroc': 0.9797535, 'binary_precision': 0.95400375, 'binary_recall': 0.914881, 'binary_specificity': 0.9558254, 'binary_f1_score': 0.9340328}
confusion matrix:
       0      1
0  27393   1266
1   2443  26258
---- Validation: 
scalar performance:
{'acc': 0.9331098, 'precision': 0.6262244, 'recall': 0.7508542, 'specificity': 0.7508542, 'f1': 0.66347826, 'auroc': 0.8489872, 'binary_precision': 0.2688253, 'binary_recall': 0.55520993, 'binary_specificity': 0.94649845, 'binary_f1_score': 0.36225265}
confusion matrix:
       0    1
0  17178  971
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9332055, 'precision': 0.66962224, 'recall': 0.8295565, 'specificity': 0.8295565, 'f1': 0.7182844, 'auroc': 0.9060571, 'binary_precision': 0.35216573, 'binary_recall': 0.71647507, 'binary_specificity': 0.942638, 'binary_f1_score': 0.4722222}
confusion matrix:
      0    1
0  5653  344
1    74  187
early stop counter: 1
val acc:0.9331098198890686, best validation acc: 0.936302661895752, corresponding to test acc:                         0.9376797676086426 / 0.9376797676086426
after epoch: 3,now: 2024-08-01 22:08:13.630221,epoch time: 0:19:03.994517,used: 0:58:05.347254,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94191074, 'precision': 0.9433992, 'recall': 0.94193006, 'specificity': 0.94193006, 'f1': 0.94186366, 'auroc': 0.9848138, 'binary_precision': 0.96925527, 'binary_recall': 0.91285414, 'binary_specificity': 0.9710059, 'binary_f1_score': 0.9402096}
confusion matrix:
       0      1
0  27830    831
1   2501  26198
---- Validation: 
scalar performance:
{'acc': 0.9393359, 'precision': 0.6358344, 'recall': 0.7413266, 'specificity': 0.7413266, 'f1': 0.6708754, 'auroc': 0.85657454, 'binary_precision': 0.28887, 'binary_recall': 0.5287714, 'binary_specificity': 0.95388174, 'binary_f1_score': 0.37362638}
confusion matrix:
       0    1
0  17312  837
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471077, 'precision': 0.70343053, 'recall': 0.83131313, 'specificity': 0.83131313, 'f1': 0.7492279, 'auroc': 0.9124913, 'binary_precision': 0.42009133, 'binary_recall': 0.70498085, 'binary_specificity': 0.9576455, 'binary_f1_score': 0.52646637}
confusion matrix:
      0    1
0  5743  254
1    77  184
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 22:27:13.035594,epoch time: 0:18:59.405373,used: 1:17:04.752627,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94773364, 'precision': 0.9486538, 'recall': 0.9477534, 'specificity': 0.9477534, 'f1': 0.94770837, 'auroc': 0.987095, 'binary_precision': 0.96919143, 'binary_recall': 0.9249608, 'binary_specificity': 0.9705461, 'binary_f1_score': 0.9465597}
confusion matrix:
       0      1
0  27811    844
1   2154  26551
---- Validation: 
scalar performance:
{'acc': 0.9386441, 'precision': 0.6354845, 'recall': 0.74546874, 'specificity': 0.74546874, 'f1': 0.67140305, 'auroc': 0.8613994, 'binary_precision': 0.28785357, 'binary_recall': 0.5381026, 'binary_specificity': 0.95283484, 'binary_f1_score': 0.3750677}
confusion matrix:
       0    1
0  17293  856
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477469, 'precision': 0.705371, 'recall': 0.8316467, 'specificity': 0.8316467, 'f1': 0.7509169, 'auroc': 0.91488975, 'binary_precision': 0.42396313, 'binary_recall': 0.70498085, 'binary_specificity': 0.9583125, 'binary_f1_score': 0.52949643}
confusion matrix:
      0    1
0  5747  250
1    77  184
new oracle model saved
early stop counter: 1
val acc:0.9386441111564636, best validation acc: 0.9393358826637268, corresponding to test acc:                         0.9471076726913452 / 0.9477468729019165
after epoch: 5,now: 2024-08-01 22:46:19.507792,epoch time: 0:19:06.472198,used: 1:36:11.224825,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9516911, 'precision': 0.951992, 'recall': 0.95170015, 'specificity': 0.95170015, 'f1': 0.95168364, 'auroc': 0.98839915, 'binary_precision': 0.9638296, 'binary_recall': 0.93867594, 'binary_specificity': 0.96472436, 'binary_f1_score': 0.95108646}
confusion matrix:
       0      1
0  27649   1011
1   1760  26940
---- Validation: 
scalar performance:
{'acc': 0.9295977, 'precision': 0.6249398, 'recall': 0.76853734, 'specificity': 0.76853734, 'f1': 0.6647049, 'auroc': 0.86606956, 'binary_precision': 0.26486862, 'binary_recall': 0.5956454, 'binary_specificity': 0.94142926, 'binary_f1_score': 0.36668265}
confusion matrix:
       0     1
0  17086  1063
1    260   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9392777, 'precision': 0.6845392, 'recall': 0.84005415, 'specificity': 0.84005415, 'f1': 0.73449147, 'auroc': 0.91963285, 'binary_precision': 0.38123754, 'binary_recall': 0.7318008, 'binary_specificity': 0.9483075, 'binary_f1_score': 0.5013124}
confusion matrix:
      0    1
0  5687  310
1    70  191
early stop counter: 2
val acc:0.9295976758003235, best validation acc: 0.9393358826637268, corresponding to test acc:                         0.9471076726913452 / 0.9477468729019165
after epoch: 6,now: 2024-08-01 23:05:27.609922,epoch time: 0:19:08.102130,used: 1:55:19.326955,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9554568, 'precision': 0.9560157, 'recall': 0.9554715, 'specificity': 0.9554715, 'f1': 0.9554441, 'auroc': 0.990811, 'binary_precision': 0.9721911, 'binary_recall': 0.9378135, 'binary_specificity': 0.9731295, 'binary_f1_score': 0.9546929}
confusion matrix:
       0      1
0  27886    770
1   1785  26919
---- Validation: 
scalar performance:
{'acc': 0.94183695, 'precision': 0.6416609, 'recall': 0.74187136, 'specificity': 0.74187136, 'f1': 0.6761575, 'auroc': 0.8635336, 'binary_precision': 0.30053192, 'binary_recall': 0.5272162, 'binary_specificity': 0.9565265, 'binary_f1_score': 0.38283458}
confusion matrix:
       0    1
0  17360  789
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.73479104, 'recall': 0.83423316, 'specificity': 0.83423316, 'f1': 0.77440166, 'auroc': 0.9202347, 'binary_precision': 0.4828496, 'binary_recall': 0.7011494, 'binary_specificity': 0.967317, 'binary_f1_score': 0.571875}
confusion matrix:
      0    1
0  5801  196
1    78  183
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-01 23:24:51.221765,epoch time: 0:19:23.611843,used: 2:14:42.938798,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9589086, 'precision': 0.9591329, 'recall': 0.9589164, 'specificity': 0.9589164, 'f1': 0.95890415, 'auroc': 0.99183553, 'binary_precision': 0.96945506, 'binary_recall': 0.9477352, 'binary_specificity': 0.9700977, 'binary_f1_score': 0.9584721}
confusion matrix:
       0      1
0  27803    857
1   1500  27200
---- Validation: 
scalar performance:
{'acc': 0.923957, 'precision': 0.617741, 'recall': 0.77311766, 'specificity': 0.77311766, 'f1': 0.6572253, 'auroc': 0.87054634, 'binary_precision': 0.25, 'binary_recall': 0.61119753, 'binary_specificity': 0.93503773, 'binary_f1_score': 0.35485327}
confusion matrix:
       0     1
0  16970  1179
1    250   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9364014, 'precision': 0.6779091, 'recall': 0.8385534, 'specificity': 0.8385534, 'f1': 0.7279154, 'auroc': 0.9204973, 'binary_precision': 0.3680154, 'binary_recall': 0.7318008, 'binary_specificity': 0.945306, 'binary_f1_score': 0.4897436}
confusion matrix:
      0    1
0  5669  328
1    70  191
early stop counter: 1
val acc:0.9239569902420044, best validation acc: 0.941836953163147, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 8,now: 2024-08-01 23:43:45.996591,epoch time: 0:18:54.774826,used: 2:33:37.713624,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9602685, 'precision': 0.96067774, 'recall': 0.96028006, 'specificity': 0.96028006, 'f1': 0.9602604, 'auroc': 0.9922279, 'binary_precision': 0.97460216, 'binary_recall': 0.9452303, 'binary_specificity': 0.97532976, 'binary_f1_score': 0.9596916}
confusion matrix:
       0      1
0  27951    707
1   1572  27130
---- Validation: 
scalar performance:
{'acc': 0.929172, 'precision': 0.62247336, 'recall': 0.76156646, 'specificity': 0.76156646, 'f1': 0.66115034, 'auroc': 0.86965585, 'binary_precision': 0.26044568, 'binary_recall': 0.5816485, 'binary_specificity': 0.9414844, 'binary_f1_score': 0.35978836}
confusion matrix:
       0     1
0  17087  1062
1    269   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403963, 'precision': 0.6869327, 'recall': 0.83880544, 'specificity': 0.83880544, 'f1': 0.73646927, 'auroc': 0.92176807, 'binary_precision': 0.38617885, 'binary_recall': 0.72796935, 'binary_specificity': 0.94964147, 'binary_f1_score': 0.5046481}
confusion matrix:
      0    1
0  5695  302
1    71  190
early stop counter: 2
val acc:0.9291719794273376, best validation acc: 0.941836953163147, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 9,now: 2024-08-02 00:02:35.934114,epoch time: 0:18:49.937523,used: 2:52:27.651147,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9616457, 'precision': 0.9622721, 'recall': 0.9616574, 'specificity': 0.9616574, 'f1': 0.96163344, 'auroc': 0.99316144, 'binary_precision': 0.97944564, 'binary_recall': 0.9431319, 'binary_specificity': 0.9801828, 'binary_f1_score': 0.96094584}
confusion matrix:
       0      1
0  28094    568
1   1632  27066
---- Validation: 
scalar performance:
{'acc': 0.9398148, 'precision': 0.6387838, 'recall': 0.748325, 'specificity': 0.748325, 'f1': 0.6749987, 'auroc': 0.87310493, 'binary_precision': 0.29426643, 'binary_recall': 0.5427683, 'binary_specificity': 0.95388174, 'binary_f1_score': 0.38162935}
confusion matrix:
       0    1
0  17312  837
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9493448, 'precision': 0.7110932, 'recall': 0.8379774, 'specificity': 0.8379774, 'f1': 0.7572185, 'auroc': 0.92017275, 'binary_precision': 0.4348837, 'binary_recall': 0.71647507, 'binary_specificity': 0.95947975, 'binary_f1_score': 0.5412445}
confusion matrix:
      0    1
0  5754  243
1    74  187
early stop counter: 3
val acc:0.9398148059844971, best validation acc: 0.941836953163147, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 10,now: 2024-08-02 00:21:30.030577,epoch time: 0:18:54.096463,used: 3:11:21.747610,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9643828, 'precision': 0.9644431, 'recall': 0.9643873, 'specificity': 0.9643873, 'f1': 0.96438193, 'auroc': 0.99337757, 'binary_precision': 0.9699277, 'binary_recall': 0.9585395, 'binary_specificity': 0.97023517, 'binary_f1_score': 0.96419996}
confusion matrix:
       0      1
0  27805    853
1   1190  27512
---- Validation: 
scalar performance:
{'acc': 0.91107917, 'precision': 0.6092924, 'recall': 0.8017032, 'specificity': 0.8017032, 'f1': 0.6486324, 'auroc': 0.87810826, 'binary_precision': 0.23060797, 'binary_recall': 0.6842924, 'binary_specificity': 0.919114, 'binary_f1_score': 0.34496278}
confusion matrix:
       0     1
0  16681  1468
1    203   440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9151486, 'precision': 0.6445687, 'recall': 0.8476201, 'specificity': 0.8476201, 'f1': 0.6931173, 'auroc': 0.91926426, 'binary_precision': 0.29970327, 'binary_recall': 0.77394634, 'binary_specificity': 0.921294, 'binary_f1_score': 0.43208554}
confusion matrix:
      0    1
0  5525  472
1    59  202
early stop counter: 4
val acc:0.9110791683197021, best validation acc: 0.941836953163147, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 11,now: 2024-08-02 00:40:34.233035,epoch time: 0:19:04.202458,used: 3:30:25.950068,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9662483, 'precision': 0.96641403, 'recall': 0.96625626, 'specificity': 0.96625626, 'f1': 0.96624565, 'auroc': 0.99382603, 'binary_precision': 0.97541916, 'binary_recall': 0.9566611, 'binary_specificity': 0.9758515, 'binary_f1_score': 0.96594906}
confusion matrix:
       0      1
0  27964    692
1   1244  27460
---- Validation: 
scalar performance:
{'acc': 0.9253406, 'precision': 0.6205995, 'recall': 0.77683413, 'specificity': 0.77683413, 'f1': 0.6608773, 'auroc': 0.8775275, 'binary_precision': 0.25546977, 'binary_recall': 0.61741835, 'binary_specificity': 0.9362499, 'binary_f1_score': 0.36140195}
confusion matrix:
       0     1
0  16992  1157
1    246   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92809206, 'precision': 0.66475695, 'recall': 0.8525412, 'specificity': 0.8525412, 'f1': 0.71662533, 'auroc': 0.91929746, 'binary_precision': 0.3401015, 'binary_recall': 0.77011496, 'binary_specificity': 0.93496746, 'binary_f1_score': 0.47183096}
confusion matrix:
      0    1
0  5607  390
1    60  201
early stop counter: 5
val acc:0.9253405928611755, best validation acc: 0.941836953163147, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 12,now: 2024-08-02 00:59:17.551256,epoch time: 0:18:43.318221,used: 3:49:09.268289,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96711993, 'precision': 0.9671385, 'recall': 0.9671226, 'specificity': 0.9671226, 'f1': 0.96711975, 'auroc': 0.99468553, 'binary_precision': 0.97029215, 'binary_recall': 0.9638017, 'binary_specificity': 0.97044355, 'binary_f1_score': 0.96703607}
confusion matrix:
       0      1
0  27810    847
1   1039  27664
---- Validation: 
scalar performance:
{'acc': 0.9241167, 'precision': 0.6227186, 'recall': 0.7927017, 'specificity': 0.7927017, 'f1': 0.6648838, 'auroc': 0.8808329, 'binary_precision': 0.25848243, 'binary_recall': 0.65163296, 'binary_specificity': 0.9337705, 'binary_f1_score': 0.37014136}
confusion matrix:
       0     1
0  16947  1202
1    224   419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9228188, 'precision': 0.65573287, 'recall': 0.84978986, 'specificity': 0.84978986, 'f1': 0.7063552, 'auroc': 0.92005837, 'binary_precision': 0.3221154, 'binary_recall': 0.77011496, 'binary_specificity': 0.92946476, 'binary_f1_score': 0.45423728}
confusion matrix:
      0    1
0  5574  423
1    60  201
early stop counter: 6
val acc:0.9241166710853577, best validation acc: 0.941836953163147, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 13,now: 2024-08-02 01:18:15.212145,epoch time: 0:18:57.660889,used: 4:08:06.929178,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.967364, 'precision': 0.96783674, 'recall': 0.96737635, 'specificity': 0.96737635, 'f1': 0.9673564, 'auroc': 0.9946972, 'binary_precision': 0.9829014, 'binary_recall': 0.95132744, 'binary_specificity': 0.9834252, 'binary_f1_score': 0.9668567}
confusion matrix:
       0      1
0  28183    475
1   1397  27305
---- Validation: 
scalar performance:
{'acc': 0.93619627, 'precision': 0.6313834, 'recall': 0.7487018, 'specificity': 0.7487018, 'f1': 0.6681694, 'auroc': 0.8774706, 'binary_precision': 0.2793651, 'binary_recall': 0.5474339, 'binary_specificity': 0.9499697, 'binary_f1_score': 0.3699422}
confusion matrix:
       0    1
0  17241  908
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935922, 'precision': 0.67786574, 'recall': 0.84380025, 'specificity': 0.84380025, 'f1': 0.7287836, 'auroc': 0.91718817, 'binary_precision': 0.36742425, 'binary_recall': 0.743295, 'binary_specificity': 0.9443055, 'binary_f1_score': 0.49176174}
confusion matrix:
      0    1
0  5663  334
1    67  194
early stop counter: 7
val acc:0.9361962676048279, best validation acc: 0.941836953163147, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 14,now: 2024-08-02 01:37:13.848605,epoch time: 0:18:58.636460,used: 4:27:05.565638,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9692294, 'precision': 0.9693693, 'recall': 0.9692359, 'specificity': 0.9692359, 'f1': 0.96922743, 'auroc': 0.99525785, 'binary_precision': 0.9776564, 'binary_recall': 0.96045434, 'binary_specificity': 0.9780174, 'binary_f1_score': 0.968979}
confusion matrix:
       0      1
0  28029    630
1   1135  27566
---- Validation: 
scalar performance:
{'acc': 0.92603236, 'precision': 0.62369835, 'recall': 0.7854429, 'specificity': 0.7854429, 'f1': 0.66530514, 'auroc': 0.88152313, 'binary_precision': 0.26103646, 'binary_recall': 0.63452566, 'binary_specificity': 0.9363601, 'binary_f1_score': 0.36990026}
confusion matrix:
       0     1
0  16994  1155
1    235   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9261745, 'precision': 0.6617237, 'recall': 0.85337305, 'specificity': 0.85337305, 'f1': 0.713428, 'auroc': 0.91992486, 'binary_precision': 0.3338843, 'binary_recall': 0.77394634, 'binary_specificity': 0.93279976, 'binary_f1_score': 0.46651274}
confusion matrix:
      0    1
0  5594  403
1    59  202
early stop counter: 8
val acc:0.9260323643684387, best validation acc: 0.941836953163147, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 15,now: 2024-08-02 01:56:28.386014,epoch time: 0:19:14.537409,used: 4:46:20.103047,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_01_21_10_07_seed_0_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:46:20.103047 at 2024-08-02 01:56:28.386014
persisted model performance metric: 

scalar performance:
{'acc': 0.95621604, 'precision': 0.73479104, 'recall': 0.83423316, 'specificity': 0.83423316, 'f1': 0.77440166, 'auroc': 0.9202347, 'binary_precision': 0.4828496, 'binary_recall': 0.7011494, 'binary_specificity': 0.967317, 'binary_f1_score': 0.571875}
confusion matrix:
      0    1
0  5801  196
1    78  183
oracle model performance metric: 

scalar performance:
{'acc': 0.95621604, 'precision': 0.73479104, 'recall': 0.83423316, 'specificity': 0.83423316, 'f1': 0.77440166, 'auroc': 0.9202347, 'binary_precision': 0.4828496, 'binary_recall': 0.7011494, 'binary_specificity': 0.967317, 'binary_f1_score': 0.571875}
confusion matrix:
      0    1
0  5801  196
1    78  183
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1143 MiB |   8779 MiB | 359930 GiB | 359929 GiB |
|       from large pool |   1106 MiB |   8735 MiB | 354167 GiB | 354166 GiB |
|       from small pool |     37 MiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1143 MiB |   8779 MiB | 359930 GiB | 359929 GiB |
|       from large pool |   1106 MiB |   8735 MiB | 354167 GiB | 354166 GiB |
|       from small pool |     37 MiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1141 MiB |   8778 MiB | 359911 GiB | 359910 GiB |
|       from large pool |   1105 MiB |   8734 MiB | 354161 GiB | 354160 GiB |
|       from small pool |     36 MiB |     77 MiB |   5750 GiB |   5749 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9928 MiB |   9928 MiB |   9928 MiB |      0 B   |
|       from large pool |   9844 MiB |   9844 MiB |   9844 MiB |      0 B   |
|       from small pool |     84 MiB |     84 MiB |     84 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  73789 KiB |    822 MiB | 195927 GiB | 195927 GiB |
|       from large pool |  65366 KiB |    821 MiB | 190157 GiB | 190157 GiB |
|       from small pool |   8423 KiB |     12 MiB |   5769 GiB |   5769 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3472    |    8159    |   71315 K  |   71312 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37870 K  |   37867 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3472    |    8159    |   71315 K  |   71312 K  |
|       from large pool |     161    |     844    |   33445 K  |   33445 K  |
|       from small pool |    3311    |    7996    |   37870 K  |   37867 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     401    |     401    |     401    |       0    |
|       from large pool |     359    |     359    |     359    |       0    |
|       from small pool |      42    |      42    |      42    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3621    |   38275 K  |   38275 K  |
|       from large pool |      23    |     355    |   21675 K  |   21675 K  |
|       from small pool |      49    |    3599    |   16599 K  |   16599 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8779 MiB | 359930 GiB | 359930 GiB |
|       from large pool |  16640 KiB |   8735 MiB | 354167 GiB | 354167 GiB |
|       from small pool |      0 KiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8779 MiB | 359930 GiB | 359930 GiB |
|       from large pool |  16640 KiB |   8735 MiB | 354167 GiB | 354167 GiB |
|       from small pool |      0 KiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB | 359911 GiB | 359911 GiB |
|       from large pool |  16640 KiB |   8734 MiB | 354161 GiB | 354161 GiB |
|       from small pool |      0 KiB |     77 MiB |   5750 GiB |   5750 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |   9928 MiB |   9928 MiB |   8712 MiB |
|       from large pool |   1170 MiB |   9844 MiB |   9844 MiB |   8674 MiB |
|       from small pool |     46 MiB |     84 MiB |     84 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    822 MiB | 195928 GiB | 195928 GiB |
|       from large pool |  30464 KiB |    821 MiB | 190158 GiB | 190158 GiB |
|       from small pool |      0 KiB |     24 MiB |   5770 GiB |   5770 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71315 K  |   71315 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37870 K  |   37870 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71315 K  |   71315 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37870 K  |   37870 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     401    |     401    |     351    |
|       from large pool |      27    |     359    |     359    |     332    |
|       from small pool |      23    |      42    |      42    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3621    |   38276 K  |   38276 K  |
|       from large pool |       2    |     355    |   21675 K  |   21675 K  |
|       from small pool |       0    |    3599    |   16600 K  |   16600 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8779 MiB | 359930 GiB | 359930 GiB |
|       from large pool |  16640 KiB |   8735 MiB | 354167 GiB | 354167 GiB |
|       from small pool |      0 KiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8779 MiB | 359930 GiB | 359930 GiB |
|       from large pool |  16640 KiB |   8735 MiB | 354167 GiB | 354167 GiB |
|       from small pool |      0 KiB |     78 MiB |   5762 GiB |   5762 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB | 359911 GiB | 359911 GiB |
|       from large pool |  16640 KiB |   8734 MiB | 354161 GiB | 354161 GiB |
|       from small pool |      0 KiB |     77 MiB |   5750 GiB |   5750 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |   9928 MiB |   9928 MiB |   8712 MiB |
|       from large pool |   1170 MiB |   9844 MiB |   9844 MiB |   8674 MiB |
|       from small pool |     46 MiB |     84 MiB |     84 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    822 MiB | 195928 GiB | 195928 GiB |
|       from large pool |  30464 KiB |    821 MiB | 190158 GiB | 190158 GiB |
|       from small pool |      0 KiB |     24 MiB |   5770 GiB |   5770 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8159    |   71315 K  |   71315 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37870 K  |   37870 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8159    |   71315 K  |   71315 K  |
|       from large pool |       2    |     844    |   33445 K  |   33445 K  |
|       from small pool |       0    |    7996    |   37870 K  |   37870 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     401    |     401    |     351    |
|       from large pool |      27    |     359    |     359    |     332    |
|       from small pool |      23    |      42    |      42    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3621    |   38276 K  |   38276 K  |
|       from large pool |       2    |     355    |   21675 K  |   21675 K  |
|       from small pool |       0    |    3599    |   16600 K  |   16600 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990

 Experiment start at: 2024-08-02 02:04:44.419556
before training, model accuracy: 0.8867225646972656
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88904124, 'precision': 0.8919879, 'recall': 0.88907135, 'specificity': 0.88907135, 'f1': 0.8888378, 'auroc': 0.9542812, 'binary_precision': 0.92614824, 'binary_recall': 0.8456709, 'binary_specificity': 0.9324719, 'binary_f1_score': 0.8840819}
confusion matrix:
       0      1
0  26844   1944
1   4449  24379
---- Validation: 
scalar performance:
{'acc': 0.93511206, 'precision': 0.5216674, 'recall': 0.520736, 'specificity': 0.520736, 'f1': 0.52118164, 'auroc': 0.70879173, 'binary_precision': 0.077760495, 'binary_recall': 0.0742942, 'binary_specificity': 0.96717775, 'binary_f1_score': 0.07598784}
confusion matrix:
       0    1
0  17474  593
1    623   50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95198196, 'precision': 0.64995897, 'recall': 0.5685251, 'specificity': 0.5685251, 'f1': 0.5913439, 'auroc': 0.83047813, 'binary_precision': 0.33620688, 'binary_recall': 0.15, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.20744681}
confusion matrix:
      0   1
0  5869  77
1   221  39
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 02:24:18.478741,epoch time: 0:19:34.059185,used: 0:19:34.059185,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.91997015, 'precision': 0.9226136, 'recall': 0.919999, 'specificity': 0.919999, 'f1': 0.91984844, 'auroc': 0.9747671, 'binary_precision': 0.9562203, 'binary_recall': 0.8803635, 'binary_specificity': 0.95963454, 'binary_f1_score': 0.91672534}
confusion matrix:
       0      1
0  27625   1162
1   3449  25380
---- Validation: 
scalar performance:
{'acc': 0.9355923, 'precision': 0.5824219, 'recall': 0.60538656, 'specificity': 0.60538656, 'f1': 0.59208554, 'auroc': 0.7837573, 'binary_precision': 0.19310345, 'binary_recall': 0.24962853, 'binary_specificity': 0.9611446, 'binary_f1_score': 0.21775761}
confusion matrix:
       0    1
0  17365  702
1    505  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95198196, 'precision': 0.691255, 'recall': 0.65863544, 'specificity': 0.65863544, 'f1': 0.6731729, 'auroc': 0.8674112, 'binary_precision': 0.41121495, 'binary_recall': 0.33846155, 'binary_specificity': 0.9788093, 'binary_f1_score': 0.37130806}
confusion matrix:
      0    1
0  5820  126
1   172   88
better model found
persisted
after epoch: 2,now: 2024-08-02 02:43:20.222675,epoch time: 0:19:01.743934,used: 0:38:35.803119,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93850666, 'precision': 0.9402637, 'recall': 0.9385298, 'specificity': 0.9385298, 'f1': 0.9384475, 'auroc': 0.98355293, 'binary_precision': 0.9682593, 'binary_recall': 0.90682995, 'binary_specificity': 0.9702296, 'binary_f1_score': 0.9365384}
confusion matrix:
       0      1
0  27930    857
1   2686  26143
---- Validation: 
scalar performance:
{'acc': 0.92924225, 'precision': 0.60857564, 'recall': 0.695078, 'specificity': 0.695078, 'f1': 0.63640124, 'auroc': 0.83287776, 'binary_precision': 0.23859087, 'binary_recall': 0.44279346, 'binary_specificity': 0.9473626, 'binary_f1_score': 0.31009364}
confusion matrix:
       0    1
0  17116  951
1    375  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511763, 'precision': 0.70504916, 'recall': 0.7446474, 'specificity': 0.7446474, 'f1': 0.7228054, 'auroc': 0.8932003, 'binary_precision': 0.4313099, 'binary_recall': 0.5192308, 'binary_specificity': 0.9700639, 'binary_f1_score': 0.47120422}
confusion matrix:
      0    1
0  5768  178
1   125  135
early stop counter: 1
val acc:0.9292422533035278, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 3,now: 2024-08-02 03:02:19.361286,epoch time: 0:18:59.138611,used: 0:57:34.941730,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9468724, 'precision': 0.94817674, 'recall': 0.9468912, 'specificity': 0.9468912, 'f1': 0.9468353, 'auroc': 0.98762417, 'binary_precision': 0.9725289, 'binary_recall': 0.9198002, 'binary_specificity': 0.9739822, 'binary_f1_score': 0.9454299}
confusion matrix:
       0      1
0  28039    749
1   2312  26516
---- Validation: 
scalar performance:
{'acc': 0.90720385, 'precision': 0.5938729, 'recall': 0.7365781, 'specificity': 0.7365781, 'f1': 0.6249738, 'auroc': 0.8489614, 'binary_precision': 0.20552486, 'binary_recall': 0.55274886, 'binary_specificity': 0.92040735, 'binary_f1_score': 0.29963753}
confusion matrix:
       0     1
0  16629  1438
1    301   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9363519, 'precision': 0.6699331, 'recall': 0.7957586, 'specificity': 0.7957586, 'f1': 0.71217597, 'auroc': 0.9020085, 'binary_precision': 0.35607675, 'binary_recall': 0.6423077, 'binary_specificity': 0.9492096, 'binary_f1_score': 0.45816183}
confusion matrix:
      0    1
0  5644  302
1    93  167
early stop counter: 2
val acc:0.9072038531303406, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 4,now: 2024-08-02 03:21:15.058935,epoch time: 0:18:55.697649,used: 1:16:30.639379,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.955134, 'precision': 0.9554013, 'recall': 0.9551425, 'specificity': 0.9551425, 'f1': 0.95512795, 'auroc': 0.9899415, 'binary_precision': 0.9666086, 'binary_recall': 0.94290274, 'binary_specificity': 0.96738225, 'binary_f1_score': 0.95460856}
confusion matrix:
       0      1
0  27849    939
1   1646  27182
---- Validation: 
scalar performance:
{'acc': 0.87854856, 'precision': 0.58015084, 'recall': 0.7646328, 'specificity': 0.7646328, 'f1': 0.60444045, 'auroc': 0.85314965, 'binary_precision': 0.17511147, 'binary_recall': 0.6419019, 'binary_specificity': 0.8873637, 'binary_f1_score': 0.27515924}
confusion matrix:
       0     1
0  16032  2035
1    241   432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9137931, 'precision': 0.6383238, 'recall': 0.8244437, 'specificity': 0.8244437, 'f1': 0.683747, 'auroc': 0.906233, 'binary_precision': 0.2894334, 'binary_recall': 0.72692305, 'binary_specificity': 0.92196435, 'binary_f1_score': 0.4140197}
confusion matrix:
      0    1
0  5482  464
1    71  189
early stop counter: 3
val acc:0.8785485625267029, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 5,now: 2024-08-02 03:40:09.490285,epoch time: 0:18:54.431350,used: 1:35:25.070729,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9585532, 'precision': 0.95921105, 'recall': 0.958567, 'specificity': 0.958567, 'f1': 0.95853925, 'auroc': 0.99107194, 'binary_precision': 0.9767752, 'binary_recall': 0.93950534, 'binary_specificity': 0.97762877, 'binary_f1_score': 0.9577779}
confusion matrix:
       0      1
0  28143    644
1   1744  27085
---- Validation: 
scalar performance:
{'acc': 0.87475985, 'precision': 0.5771885, 'recall': 0.7605221, 'specificity': 0.7605221, 'f1': 0.5996156, 'auroc': 0.8540276, 'binary_precision': 0.16943128, 'binary_recall': 0.63744426, 'binary_specificity': 0.88359994, 'binary_f1_score': 0.26770672}
confusion matrix:
       0     1
0  15964  2103
1    244   429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90412503, 'precision': 0.6273223, 'recall': 0.8249153, 'specificity': 0.8249153, 'f1': 0.6700973, 'auroc': 0.90476465, 'binary_precision': 0.26703754, 'binary_recall': 0.73846155, 'binary_specificity': 0.91136897, 'binary_f1_score': 0.39223695}
confusion matrix:
      0    1
0  5419  527
1    68  192
early stop counter: 4
val acc:0.8747598528862, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 6,now: 2024-08-02 03:58:55.683280,epoch time: 0:18:46.192995,used: 1:54:11.263724,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9595425, 'precision': 0.9604585, 'recall': 0.9595596, 'specificity': 0.9595596, 'f1': 0.95952344, 'auroc': 0.99188805, 'binary_precision': 0.9811876, 'binary_recall': 0.9371141, 'binary_specificity': 0.9820051, 'binary_f1_score': 0.95864457}
confusion matrix:
       0      1
0  28268    518
1   1813  27017
---- Validation: 
scalar performance:
{'acc': 0.8898079, 'precision': 0.58574486, 'recall': 0.7590279, 'specificity': 0.7590279, 'f1': 0.6137411, 'auroc': 0.8586496, 'binary_precision': 0.18705036, 'binary_recall': 0.61812776, 'binary_specificity': 0.89992803, 'binary_f1_score': 0.28719363}
confusion matrix:
       0     1
0  16259  1808
1    257   416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9099259, 'precision': 0.6323334, 'recall': 0.8187476, 'specificity': 0.8187476, 'f1': 0.6760799, 'auroc': 0.90527177, 'binary_precision': 0.2778603, 'binary_recall': 0.7192308, 'binary_specificity': 0.9182644, 'binary_f1_score': 0.40085745}
confusion matrix:
      0    1
0  5460  486
1    73  187
early stop counter: 5
val acc:0.8898078799247742, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 7,now: 2024-08-02 04:17:36.340215,epoch time: 0:18:40.656935,used: 2:12:51.920659,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96471465, 'precision': 0.9647753, 'recall': 0.96471894, 'specificity': 0.96471894, 'f1': 0.9647137, 'auroc': 0.99347985, 'binary_precision': 0.9702703, 'binary_recall': 0.9588609, 'binary_specificity': 0.970577, 'binary_f1_score': 0.9645318}
confusion matrix:
       0      1
0  27940    847
1   1186  27643
---- Validation: 
scalar performance:
{'acc': 0.8480256, 'precision': 0.56965995, 'recall': 0.7795594, 'specificity': 0.7795594, 'f1': 0.58278805, 'auroc': 0.86201966, 'binary_precision': 0.152, 'binary_recall': 0.70579493, 'binary_specificity': 0.85332376, 'binary_f1_score': 0.25013164}
confusion matrix:
       0     1
0  15417  2650
1    198   475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87044793, 'precision': 0.6010247, 'recall': 0.8257303, 'specificity': 0.8257303, 'f1': 0.6313385, 'auroc': 0.9083159, 'binary_precision': 0.21308017, 'binary_recall': 0.77692306, 'binary_specificity': 0.8745375, 'binary_f1_score': 0.33443707}
confusion matrix:
      0    1
0  5200  746
1    58  202
early stop counter: 6
val acc:0.8480256199836731, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 8,now: 2024-08-02 04:36:08.964087,epoch time: 0:18:32.623872,used: 2:31:24.544531,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9660511, 'precision': 0.9664483, 'recall': 0.96606135, 'specificity': 0.96606135, 'f1': 0.96604437, 'auroc': 0.99416625, 'binary_precision': 0.98023444, 'binary_recall': 0.95133203, 'binary_specificity': 0.9807906, 'binary_f1_score': 0.965567}
confusion matrix:
       0      1
0  28235    553
1   1403  27425
---- Validation: 
scalar performance:
{'acc': 0.8738527, 'precision': 0.57930887, 'recall': 0.7722112, 'specificity': 0.7722112, 'f1': 0.6024407, 'auroc': 0.86210704, 'binary_precision': 0.17266744, 'binary_recall': 0.6627043, 'binary_specificity': 0.88171804, 'binary_f1_score': 0.27395576}
confusion matrix:
       0     1
0  15930  2137
1    227   446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8875282, 'precision': 0.6121199, 'recall': 0.82360995, 'specificity': 0.82360995, 'f1': 0.6489916, 'auroc': 0.9047815, 'binary_precision': 0.23614457, 'binary_recall': 0.75384617, 'binary_specificity': 0.89337367, 'binary_f1_score': 0.35963303}
confusion matrix:
      0    1
0  5312  634
1    64  196
early stop counter: 7
val acc:0.8738527297973633, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 9,now: 2024-08-02 04:54:38.238776,epoch time: 0:18:29.274689,used: 2:49:53.819220,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96933144, 'precision': 0.96939194, 'recall': 0.9693357, 'specificity': 0.9693357, 'f1': 0.9693306, 'auroc': 0.9946914, 'binary_precision': 0.97490525, 'binary_recall': 0.96350896, 'binary_specificity': 0.9751624, 'binary_f1_score': 0.96917355}
confusion matrix:
       0      1
0  28072    715
1   1052  27777
---- Validation: 
scalar performance:
{'acc': 0.84236926, 'precision': 0.567825, 'recall': 0.78020215, 'specificity': 0.78020215, 'f1': 0.57863384, 'auroc': 0.86370707, 'binary_precision': 0.14810243, 'binary_recall': 0.71322435, 'binary_specificity': 0.84717995, 'binary_f1_score': 0.24527337}
confusion matrix:
       0     1
0  15306  2761
1    193   480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85497904, 'precision': 0.59189975, 'recall': 0.8213356, 'specificity': 0.8213356, 'f1': 0.6154374, 'auroc': 0.90528154, 'binary_precision': 0.19465649, 'binary_recall': 0.7846154, 'binary_specificity': 0.85805583, 'binary_f1_score': 0.3119266}
confusion matrix:
      0    1
0  5102  844
1    56  204
early stop counter: 8
val acc:0.8423692584037781, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 10,now: 2024-08-02 05:13:06.566920,epoch time: 0:18:28.328144,used: 3:08:22.147364,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9687413, 'precision': 0.96914893, 'recall': 0.96875215, 'specificity': 0.96875215, 'f1': 0.96873504, 'auroc': 0.99518156, 'binary_precision': 0.98316056, 'binary_recall': 0.9538659, 'binary_specificity': 0.98363847, 'binary_f1_score': 0.9682917}
confusion matrix:
       0      1
0  28316    471
1   1330  27499
---- Validation: 
scalar performance:
{'acc': 0.8914621, 'precision': 0.58725214, 'recall': 0.7606011, 'specificity': 0.7606011, 'f1': 0.6160146, 'auroc': 0.8613628, 'binary_precision': 0.18997721, 'binary_recall': 0.61961365, 'binary_specificity': 0.90158856, 'binary_f1_score': 0.29079497}
confusion matrix:
       0     1
0  16289  1778
1    256   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8965517, 'precision': 0.6190764, 'recall': 0.820963, 'specificity': 0.820963, 'f1': 0.658942, 'auroc': 0.904971, 'binary_precision': 0.25065273, 'binary_recall': 0.73846155, 'binary_specificity': 0.9034645, 'binary_f1_score': 0.374269}
confusion matrix:
      0    1
0  5372  574
1    68  192
early stop counter: 9
val acc:0.8914620876312256, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 11,now: 2024-08-02 05:31:35.988509,epoch time: 0:18:29.421589,used: 3:26:51.568953,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9707894, 'precision': 0.9708379, 'recall': 0.97079337, 'specificity': 0.97079337, 'f1': 0.9707888, 'auroc': 0.9954597, 'binary_precision': 0.9758124, 'binary_recall': 0.96555674, 'binary_specificity': 0.97603, 'binary_f1_score': 0.97065747}
confusion matrix:
       0      1
0  28096    690
1    993  27837
---- Validation: 
scalar performance:
{'acc': 0.8771078, 'precision': 0.5809483, 'recall': 0.77175355, 'specificity': 0.77175355, 'f1': 0.60533476, 'auroc': 0.86531603, 'binary_precision': 0.17607313, 'binary_recall': 0.65824664, 'binary_specificity': 0.8852604, 'binary_f1_score': 0.27783003}
confusion matrix:
       0     1
0  15994  2073
1    230   443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8778601, 'precision': 0.60490245, 'recall': 0.8222425, 'specificity': 0.8222425, 'f1': 0.63791215, 'auroc': 0.90444577, 'binary_precision': 0.22147651, 'binary_recall': 0.76153845, 'binary_specificity': 0.8829465, 'binary_f1_score': 0.34315425}
confusion matrix:
      0    1
0  5250  696
1    62  198
early stop counter: 10
val acc:0.8771077990531921, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 12,now: 2024-08-02 05:50:07.492502,epoch time: 0:18:31.503993,used: 3:45:23.072946,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9710497, 'precision': 0.9712006, 'recall': 0.9710567, 'specificity': 0.9710567, 'f1': 0.9710477, 'auroc': 0.99560106, 'binary_precision': 0.97982615, 'binary_recall': 0.96194935, 'binary_specificity': 0.980164, 'binary_f1_score': 0.97080547}
confusion matrix:
       0      1
0  28215    571
1   1097  27733
---- Validation: 
scalar performance:
{'acc': 0.88484526, 'precision': 0.5865567, 'recall': 0.7764816, 'specificity': 0.7764816, 'f1': 0.61442965, 'auroc': 0.8702881, 'binary_precision': 0.18710493, 'binary_recall': 0.6597325, 'binary_specificity': 0.89323074, 'binary_f1_score': 0.29152986}
confusion matrix:
       0     1
0  16138  1929
1    229   444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8852723, 'precision': 0.6097368, 'recall': 0.8205937, 'specificity': 0.8205937, 'f1': 0.64547443, 'auroc': 0.9041023, 'binary_precision': 0.23159145, 'binary_recall': 0.75, 'binary_specificity': 0.89118737, 'binary_f1_score': 0.35390198}
confusion matrix:
      0    1
0  5299  647
1    65  195
early stop counter: 11
val acc:0.8848452568054199, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 13,now: 2024-08-02 06:08:36.220182,epoch time: 0:18:28.727680,used: 4:03:51.800626,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9706158, 'precision': 0.971169, 'recall': 0.9706284, 'specificity': 0.9706284, 'f1': 0.97060776, 'auroc': 0.9957782, 'binary_precision': 0.98749644, 'binary_recall': 0.9533456, 'binary_specificity': 0.9879112, 'binary_f1_score': 0.97012055}
confusion matrix:
       0      1
0  28439    348
1   1345  27484
---- Validation: 
scalar performance:
{'acc': 0.89727855, 'precision': 0.5912236, 'recall': 0.75932604, 'specificity': 0.75932604, 'f1': 0.6219064, 'auroc': 0.8639449, 'binary_precision': 0.19816779, 'binary_recall': 0.61069834, 'binary_specificity': 0.90795374, 'binary_f1_score': 0.29923552}
confusion matrix:
       0     1
0  16404  1663
1    262   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89574605, 'precision': 0.6182579, 'recall': 0.8205426, 'specificity': 0.8205426, 'f1': 0.65780234, 'auroc': 0.90065587, 'binary_precision': 0.24902724, 'binary_recall': 0.73846155, 'binary_specificity': 0.9026236, 'binary_f1_score': 0.3724539}
confusion matrix:
      0    1
0  5367  579
1    68  192
early stop counter: 12
val acc:0.8972785472869873, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 14,now: 2024-08-02 06:27:05.868032,epoch time: 0:18:29.647850,used: 4:22:21.448476,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97174394, 'precision': 0.97196364, 'recall': 0.9717523, 'specificity': 0.9717523, 'f1': 0.9717411, 'auroc': 0.9961623, 'binary_precision': 0.98233914, 'binary_recall': 0.9608047, 'binary_specificity': 0.98269993, 'binary_f1_score': 0.97145265}
confusion matrix:
       0      1
0  28288    498
1   1130  27700
---- Validation: 
scalar performance:
{'acc': 0.88890076, 'precision': 0.5873788, 'recall': 0.76857114, 'specificity': 0.76857114, 'f1': 0.61601835, 'auroc': 0.86642385, 'binary_precision': 0.18951079, 'binary_recall': 0.63893014, 'binary_specificity': 0.8982122, 'binary_f1_score': 0.29231817}
confusion matrix:
       0     1
0  16228  1839
1    243   430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8864003, 'precision': 0.6103048, 'recall': 0.8193433, 'specificity': 0.8193433, 'f1': 0.6463508, 'auroc': 0.90288365, 'binary_precision': 0.23289315, 'binary_recall': 0.74615383, 'binary_specificity': 0.89253277, 'binary_f1_score': 0.35498628}
confusion matrix:
      0    1
0  5307  639
1    66  194
early stop counter: 13
val acc:0.8889007568359375, best validation acc: 0.9355922937393188, corresponding to test acc:                         0.9519819617271423 / 0.9519819617271423
after epoch: 15,now: 2024-08-02 06:45:39.597753,epoch time: 0:18:33.729721,used: 4:40:55.178197,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_02_04_43_seed_1_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:40:55.178197 at 2024-08-02 06:45:39.597753
persisted model performance metric: 

scalar performance:
{'acc': 0.95198196, 'precision': 0.691255, 'recall': 0.65863544, 'specificity': 0.65863544, 'f1': 0.6731729, 'auroc': 0.8674112, 'binary_precision': 0.41121495, 'binary_recall': 0.33846155, 'binary_specificity': 0.9788093, 'binary_f1_score': 0.37130806}
confusion matrix:
      0    1
0  5820  126
1   172   88
oracle model performance metric: 

scalar performance:
{'acc': 0.95198196, 'precision': 0.64995897, 'recall': 0.5685251, 'specificity': 0.5685251, 'f1': 0.5913439, 'auroc': 0.83047813, 'binary_precision': 0.33620688, 'binary_recall': 0.15, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.20744681}
confusion matrix:
      0   1
0  5869  77
1   221  39
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1144 MiB |   8781 MiB | 726512 GiB | 726511 GiB |
|       from large pool |   1106 MiB |   8737 MiB | 714938 GiB | 714937 GiB |
|       from small pool |     37 MiB |     78 MiB |  11573 GiB |  11573 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1144 MiB |   8781 MiB | 726512 GiB | 726511 GiB |
|       from large pool |   1106 MiB |   8737 MiB | 714938 GiB | 714937 GiB |
|       from small pool |     37 MiB |     78 MiB |  11573 GiB |  11573 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1141 MiB |   8778 MiB | 724817 GiB | 724816 GiB |
|       from large pool |   1105 MiB |   8734 MiB | 713268 GiB | 713267 GiB |
|       from small pool |     36 MiB |     77 MiB |  11549 GiB |  11549 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9904 MiB |   9928 MiB |  18616 MiB |   8712 MiB |
|       from large pool |   9824 MiB |   9844 MiB |  18498 MiB |   8674 MiB |
|       from small pool |     80 MiB |     84 MiB |    118 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  54658 KiB |    822 MiB | 398195 GiB | 398195 GiB |
|       from large pool |  44175 KiB |    821 MiB | 386602 GiB | 386602 GiB |
|       from small pool |  10483 KiB |     24 MiB |  11592 GiB |  11592 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3448    |    8191    |  143274 K  |  143271 K  |
|       from large pool |     161    |     844    |   67338 K  |   67338 K  |
|       from small pool |    3287    |    8028    |   75935 K  |   75932 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3448    |    8191    |  143274 K  |  143271 K  |
|       from large pool |     161    |     844    |   67338 K  |   67338 K  |
|       from small pool |    3287    |    8028    |   75935 K  |   75932 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     398    |     401    |     749    |     351    |
|       from large pool |     358    |     359    |     690    |     332    |
|       from small pool |      40    |      42    |      59    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3637    |   78416 K  |   78416 K  |
|       from large pool |      21    |     355    |   45721 K  |   45721 K  |
|       from small pool |      51    |    3617    |   32695 K  |   32695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8781 MiB | 726512 GiB | 726512 GiB |
|       from large pool |  16640 KiB |   8737 MiB | 714938 GiB | 714938 GiB |
|       from small pool |      0 KiB |     78 MiB |  11573 GiB |  11573 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8781 MiB | 726512 GiB | 726512 GiB |
|       from large pool |  16640 KiB |   8737 MiB | 714938 GiB | 714938 GiB |
|       from small pool |      0 KiB |     78 MiB |  11573 GiB |  11573 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB | 724817 GiB | 724817 GiB |
|       from large pool |  16640 KiB |   8734 MiB | 713268 GiB | 713268 GiB |
|       from small pool |      0 KiB |     77 MiB |  11549 GiB |  11549 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |   9928 MiB |  18616 MiB |  17418 MiB |
|       from large pool |   1150 MiB |   9844 MiB |  18498 MiB |  17348 MiB |
|       from small pool |     48 MiB |     84 MiB |    118 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    822 MiB | 398195 GiB | 398195 GiB |
|       from large pool |  30464 KiB |    821 MiB | 386602 GiB | 386602 GiB |
|       from small pool |      0 KiB |     27 MiB |  11592 GiB |  11592 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143274 K  |  143274 K  |
|       from large pool |       2    |     844    |   67338 K  |   67338 K  |
|       from small pool |       0    |    8028    |   75935 K  |   75935 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143274 K  |  143274 K  |
|       from large pool |       2    |     844    |   67338 K  |   67338 K  |
|       from small pool |       0    |    8028    |   75935 K  |   75935 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     401    |     749    |     699    |
|       from large pool |      26    |     359    |     690    |     664    |
|       from small pool |      24    |      42    |      59    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3637    |   78418 K  |   78418 K  |
|       from large pool |       2    |     355    |   45721 K  |   45721 K  |
|       from small pool |       0    |    3617    |   32696 K  |   32696 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8781 MiB | 726512 GiB | 726512 GiB |
|       from large pool |  16640 KiB |   8737 MiB | 714938 GiB | 714938 GiB |
|       from small pool |      0 KiB |     78 MiB |  11573 GiB |  11573 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8781 MiB | 726512 GiB | 726512 GiB |
|       from large pool |  16640 KiB |   8737 MiB | 714938 GiB | 714938 GiB |
|       from small pool |      0 KiB |     78 MiB |  11573 GiB |  11573 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB | 724817 GiB | 724817 GiB |
|       from large pool |  16640 KiB |   8734 MiB | 713268 GiB | 713268 GiB |
|       from small pool |      0 KiB |     77 MiB |  11549 GiB |  11549 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |   9928 MiB |  18616 MiB |  17418 MiB |
|       from large pool |   1150 MiB |   9844 MiB |  18498 MiB |  17348 MiB |
|       from small pool |     48 MiB |     84 MiB |    118 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    822 MiB | 398195 GiB | 398195 GiB |
|       from large pool |  30464 KiB |    821 MiB | 386602 GiB | 386602 GiB |
|       from small pool |      0 KiB |     27 MiB |  11592 GiB |  11592 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8191    |  143274 K  |  143274 K  |
|       from large pool |       2    |     844    |   67338 K  |   67338 K  |
|       from small pool |       0    |    8028    |   75935 K  |   75935 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8191    |  143274 K  |  143274 K  |
|       from large pool |       2    |     844    |   67338 K  |   67338 K  |
|       from small pool |       0    |    8028    |   75935 K  |   75935 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     401    |     749    |     699    |
|       from large pool |      26    |     359    |     690    |     664    |
|       from small pool |      24    |      42    |      59    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3637    |   78418 K  |   78418 K  |
|       from large pool |       2    |     355    |   45721 K  |   45721 K  |
|       from small pool |       0    |    3617    |   32696 K  |   32696 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990

 Experiment start at: 2024-08-02 06:53:51.165795
before training, model accuracy: 0.12165411561727524
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8946213, 'precision': 0.89814305, 'recall': 0.894631, 'specificity': 0.894631, 'f1': 0.8943894, 'auroc': 0.95901215, 'binary_precision': 0.9356402, 'binary_recall': 0.847589, 'binary_specificity': 0.941673, 'binary_f1_score': 0.8894407}
confusion matrix:
       0      1
0  27446   1700
1   4444  24714
---- Validation: 
scalar performance:
{'acc': 0.9389549, 'precision': 0.51729053, 'recall': 0.5179561, 'specificity': 0.5179561, 'f1': 0.5176103, 'auroc': 0.6889749, 'binary_precision': 0.06549521, 'binary_recall': 0.06810631, 'binary_specificity': 0.96780586, 'binary_f1_score': 0.06677525}
confusion matrix:
       0    1
0  17586  585
1    561   41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93765026, 'precision': 0.58258796, 'recall': 0.5829154, 'specificity': 0.5829154, 'f1': 0.5827513, 'auroc': 0.78030336, 'binary_precision': 0.19753087, 'binary_recall': 0.1983471, 'binary_specificity': 0.96748376, 'binary_f1_score': 0.19793814}
confusion matrix:
      0    1
0  5802  195
1   194   48
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 07:13:27.210076,epoch time: 0:19:36.044281,used: 0:19:36.044281,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9224753, 'precision': 0.926021, 'recall': 0.9224847, 'specificity': 0.9224847, 'f1': 0.9223148, 'auroc': 0.9768239, 'binary_precision': 0.9649381, 'binary_recall': 0.8768434, 'binary_specificity': 0.968126, 'binary_f1_score': 0.9187839}
confusion matrix:
       0      1
0  28217    929
1   3591  25567
---- Validation: 
scalar performance:
{'acc': 0.9472647, 'precision': 0.5676389, 'recall': 0.5648102, 'specificity': 0.5648102, 'f1': 0.5661854, 'auroc': 0.76009166, 'binary_precision': 0.16319445, 'binary_recall': 0.15614618, 'binary_specificity': 0.9734742, 'binary_f1_score': 0.15959252}
confusion matrix:
       0    1
0  17689  482
1    508   94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535182, 'precision': 0.6852616, 'recall': 0.67642736, 'specificity': 0.67642736, 'f1': 0.6807193, 'auroc': 0.8601987, 'binary_precision': 0.39565217, 'binary_recall': 0.37603307, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.38559324}
confusion matrix:
      0    1
0  5858  139
1   151   91
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 07:32:26.713946,epoch time: 0:18:59.503870,used: 0:38:35.548151,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93782586, 'precision': 0.9394226, 'recall': 0.93783, 'specificity': 0.93783, 'f1': 0.9377698, 'auroc': 0.98333323, 'binary_precision': 0.9659452, 'binary_recall': 0.90766907, 'binary_specificity': 0.96799093, 'binary_f1_score': 0.9359008}
confusion matrix:
       0      1
0  28215    933
1   2692  26464
---- Validation: 
scalar performance:
{'acc': 0.9456667, 'precision': 0.5919395, 'recall': 0.60895544, 'specificity': 0.60895544, 'f1': 0.5995581, 'auroc': 0.7946267, 'binary_precision': 0.20891365, 'binary_recall': 0.24916944, 'binary_specificity': 0.9687414, 'binary_f1_score': 0.22727273}
confusion matrix:
       0    1
0  17603  568
1    452  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957365, 'precision': 0.71853423, 'recall': 0.7478243, 'specificity': 0.7478243, 'f1': 0.73212284, 'auroc': 0.8818239, 'binary_precision': 0.45652175, 'binary_recall': 0.5206612, 'binary_specificity': 0.9749875, 'binary_f1_score': 0.4864865}
confusion matrix:
      0    1
0  5847  150
1   116  126
new oracle model saved
early stop counter: 1
val acc:0.9456666707992554, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9573649764060974
after epoch: 3,now: 2024-08-02 07:51:25.485130,epoch time: 0:18:58.771184,used: 0:57:34.319335,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9446007, 'precision': 0.94598025, 'recall': 0.9446064, 'specificity': 0.9446064, 'f1': 0.9445583, 'auroc': 0.98670983, 'binary_precision': 0.97083604, 'binary_recall': 0.91676384, 'binary_specificity': 0.97244906, 'binary_f1_score': 0.94302547}
confusion matrix:
       0      1
0  28343    803
1   2427  26731
---- Validation: 
scalar performance:
{'acc': 0.9449209, 'precision': 0.5973228, 'recall': 0.62302506, 'specificity': 0.62302506, 'f1': 0.6083365, 'auroc': 0.8059844, 'binary_precision': 0.21875, 'binary_recall': 0.27906978, 'binary_specificity': 0.96698034, 'binary_f1_score': 0.24525549}
confusion matrix:
       0    1
0  17571  600
1    434  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7417661, 'recall': 0.78551465, 'specificity': 0.78551465, 'f1': 0.76157093, 'auroc': 0.89145744, 'binary_precision': 0.5, 'binary_recall': 0.59504133, 'binary_specificity': 0.975988, 'binary_f1_score': 0.54339623}
confusion matrix:
      0    1
0  5853  144
1    98  144
new oracle model saved
early stop counter: 2
val acc:0.9449208974838257, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 4,now: 2024-08-02 08:10:22.787182,epoch time: 0:18:57.302052,used: 1:16:31.621387,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9494889, 'precision': 0.9501561, 'recall': 0.9494929, 'specificity': 0.9494929, 'f1': 0.94947046, 'auroc': 0.98776424, 'binary_precision': 0.96753824, 'binary_recall': 0.93020785, 'binary_specificity': 0.9687779, 'binary_f1_score': 0.9485059}
confusion matrix:
       0      1
0  28236    910
1   2035  27123
---- Validation: 
scalar performance:
{'acc': 0.9207905, 'precision': 0.5796129, 'recall': 0.674804, 'specificity': 0.674804, 'f1': 0.60415643, 'auroc': 0.81114066, 'binary_precision': 0.17958002, 'binary_recall': 0.41196012, 'binary_specificity': 0.9376479, 'binary_f1_score': 0.25012606}
confusion matrix:
       0     1
0  17038  1133
1    354   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9422985, 'precision': 0.6775035, 'recall': 0.81731397, 'specificity': 0.81731397, 'f1': 0.7238607, 'auroc': 0.89670455, 'binary_precision': 0.36830357, 'binary_recall': 0.6818182, 'binary_specificity': 0.95280975, 'binary_f1_score': 0.47826084}
confusion matrix:
      0    1
0  5714  283
1    77  165
early stop counter: 3
val acc:0.9207904934883118, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 5,now: 2024-08-02 08:29:22.149284,epoch time: 0:18:59.362102,used: 1:35:30.983489,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95480585, 'precision': 0.9549664, 'recall': 0.9548068, 'specificity': 0.9548068, 'f1': 0.9548019, 'auroc': 0.9901564, 'binary_precision': 0.9635391, 'binary_recall': 0.9453953, 'binary_specificity': 0.9642183, 'binary_f1_score': 0.954381}
confusion matrix:
       0      1
0  28106   1043
1   1592  27563
---- Validation: 
scalar performance:
{'acc': 0.925265, 'precision': 0.59114844, 'recall': 0.6947825, 'specificity': 0.6947825, 'f1': 0.61925703, 'auroc': 0.827777, 'binary_precision': 0.20134228, 'binary_recall': 0.44850498, 'binary_specificity': 0.94105995, 'binary_f1_score': 0.27792075}
confusion matrix:
       0     1
0  17100  1071
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94502324, 'precision': 0.68514097, 'recall': 0.82071406, 'specificity': 0.82071406, 'f1': 0.7313957, 'auroc': 0.8985126, 'binary_precision': 0.38337183, 'binary_recall': 0.6859504, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.49185184}
confusion matrix:
      0    1
0  5730  267
1    76  166
early stop counter: 4
val acc:0.9252650141716003, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 6,now: 2024-08-02 08:48:32.978754,epoch time: 0:19:10.829470,used: 1:54:41.812959,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95689833, 'precision': 0.9576119, 'recall': 0.9569011, 'specificity': 0.9569011, 'f1': 0.9568817, 'auroc': 0.99120337, 'binary_precision': 0.9757169, 'binary_recall': 0.9371313, 'binary_specificity': 0.9766708, 'binary_f1_score': 0.9560349}
confusion matrix:
       0      1
0  28468    680
1   1833  27323
---- Validation: 
scalar performance:
{'acc': 0.9367176, 'precision': 0.5952202, 'recall': 0.65733385, 'specificity': 0.65733385, 'f1': 0.61679935, 'auroc': 0.8210956, 'binary_precision': 0.21218075, 'binary_recall': 0.358804, 'binary_specificity': 0.9558637, 'binary_f1_score': 0.26666668}
confusion matrix:
       0    1
0  17369  802
1    386  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.71793807, 'recall': 0.81035495, 'specificity': 0.81035495, 'f1': 0.7547885, 'auroc': 0.8983879, 'binary_precision': 0.45014244, 'binary_recall': 0.6528926, 'binary_specificity': 0.96781725, 'binary_f1_score': 0.5328837}
confusion matrix:
      0    1
0  5804  193
1    84  158
early stop counter: 5
val acc:0.9367176294326782, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 7,now: 2024-08-02 09:07:29.076295,epoch time: 0:18:56.097541,used: 2:13:37.910500,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9599513, 'precision': 0.9603337, 'recall': 0.95995426, 'specificity': 0.95995426, 'f1': 0.9599431, 'auroc': 0.99173915, 'binary_precision': 0.97365355, 'binary_recall': 0.94550383, 'binary_specificity': 0.9744047, 'binary_f1_score': 0.9593722}
confusion matrix:
       0      1
0  28400    746
1   1589  27569
---- Validation: 
scalar performance:
{'acc': 0.91770095, 'precision': 0.58143073, 'recall': 0.6908752, 'specificity': 0.6908752, 'f1': 0.6077119, 'auroc': 0.81948817, 'binary_precision': 0.18206339, 'binary_recall': 0.44850498, 'binary_specificity': 0.9332453, 'binary_f1_score': 0.2589928}
confusion matrix:
       0     1
0  16958  1213
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94550407, 'precision': 0.68717456, 'recall': 0.8249297, 'specificity': 0.8249297, 'f1': 0.7341163, 'auroc': 0.8999879, 'binary_precision': 0.38709676, 'binary_recall': 0.6942149, 'binary_specificity': 0.9556445, 'binary_f1_score': 0.4970414}
confusion matrix:
      0    1
0  5731  266
1    74  168
early stop counter: 6
val acc:0.9177009463310242, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 8,now: 2024-08-02 09:26:38.881195,epoch time: 0:19:09.804900,used: 2:32:47.715400,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9622153, 'precision': 0.96270484, 'recall': 0.96221864, 'specificity': 0.96221864, 'f1': 0.9622055, 'auroc': 0.9926671, 'binary_precision': 0.9778069, 'binary_recall': 0.94591534, 'binary_specificity': 0.97852194, 'binary_f1_score': 0.9615968}
confusion matrix:
       0      1
0  28520    626
1   1577  27581
---- Validation: 
scalar performance:
{'acc': 0.9370372, 'precision': 0.5961624, 'recall': 0.658302, 'specificity': 0.658302, 'f1': 0.6178335, 'auroc': 0.82383657, 'binary_precision': 0.21400395, 'binary_recall': 0.3604651, 'binary_specificity': 0.9561389, 'binary_f1_score': 0.26856434}
confusion matrix:
       0    1
0  17374  797
1    385  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.718384, 'recall': 0.8143204, 'specificity': 0.8143204, 'f1': 0.75634944, 'auroc': 0.8980861, 'binary_precision': 0.45070422, 'binary_recall': 0.661157, 'binary_specificity': 0.96748376, 'binary_f1_score': 0.53601336}
confusion matrix:
      0    1
0  5802  195
1    82  160
early stop counter: 7
val acc:0.9370372295379639, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 9,now: 2024-08-02 09:45:45.355495,epoch time: 0:19:06.474300,used: 2:51:54.189700,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9626784, 'precision': 0.9634187, 'recall': 0.9626825, 'specificity': 0.9626825, 'f1': 0.96266365, 'auroc': 0.9937252, 'binary_precision': 0.98199356, 'binary_recall': 0.94265723, 'binary_specificity': 0.98270774, 'binary_f1_score': 0.9619234}
confusion matrix:
       0      1
0  28642    504
1   1672  27486
---- Validation: 
scalar performance:
{'acc': 0.9389549, 'precision': 0.60287833, 'recall': 0.66652006, 'specificity': 0.66652006, 'f1': 0.6254871, 'auroc': 0.828697, 'binary_precision': 0.22690763, 'binary_recall': 0.3754153, 'binary_specificity': 0.9576248, 'binary_f1_score': 0.28285357}
confusion matrix:
       0    1
0  17401  770
1    376  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.7293674, 'recall': 0.8196199, 'specificity': 0.8196199, 'f1': 0.76595026, 'auroc': 0.89965576, 'binary_precision': 0.4723032, 'binary_recall': 0.6694215, 'binary_specificity': 0.96981823, 'binary_f1_score': 0.5538462}
confusion matrix:
      0    1
0  5816  181
1    80  162
early stop counter: 8
val acc:0.9389548897743225, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 10,now: 2024-08-02 10:05:01.424227,epoch time: 0:19:16.068732,used: 3:11:10.258432,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9650796, 'precision': 0.9651518, 'recall': 0.96508086, 'specificity': 0.96508086, 'f1': 0.96507823, 'auroc': 0.99371636, 'binary_precision': 0.9709989, 'binary_recall': 0.9588106, 'binary_specificity': 0.97135115, 'binary_f1_score': 0.9648662}
confusion matrix:
       0      1
0  28311    835
1   1201  27957
---- Validation: 
scalar performance:
{'acc': 0.92254835, 'precision': 0.58866197, 'recall': 0.6973944, 'specificity': 0.6973944, 'f1': 0.61677086, 'auroc': 0.82853067, 'binary_precision': 0.19614837, 'binary_recall': 0.45681062, 'binary_specificity': 0.9379781, 'binary_f1_score': 0.2744511}
confusion matrix:
       0     1
0  17044  1127
1    327   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94197786, 'precision': 0.67818403, 'recall': 0.8250781, 'specificity': 0.8250781, 'f1': 0.7260609, 'auroc': 0.8990239, 'binary_precision': 0.36899564, 'binary_recall': 0.6983471, 'binary_specificity': 0.9518092, 'binary_f1_score': 0.48285714}
confusion matrix:
      0    1
0  5708  289
1    73  169
early stop counter: 9
val acc:0.9225483536720276, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 11,now: 2024-08-02 10:25:06.876896,epoch time: 0:20:05.452669,used: 3:31:15.711101,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9676866, 'precision': 0.9677831, 'recall': 0.9676883, 'specificity': 0.9676883, 'f1': 0.967685, 'auroc': 0.99460757, 'binary_precision': 0.9745624, 'binary_recall': 0.96045816, 'binary_specificity': 0.9749185, 'binary_f1_score': 0.96745884}
confusion matrix:
       0      1
0  28414    731
1   1153  28006
---- Validation: 
scalar performance:
{'acc': 0.9066212, 'precision': 0.5793569, 'recall': 0.71887976, 'specificity': 0.71887976, 'f1': 0.6063354, 'auroc': 0.8284124, 'binary_precision': 0.17577465, 'binary_recall': 0.5182724, 'binary_specificity': 0.9194871, 'binary_f1_score': 0.26251578}
confusion matrix:
       0     1
0  16708  1463
1    290   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9277128, 'precision': 0.6497862, 'recall': 0.82558876, 'specificity': 0.82558876, 'f1': 0.69775915, 'auroc': 0.8975817, 'binary_precision': 0.3117117, 'binary_recall': 0.71487606, 'binary_specificity': 0.93630147, 'binary_f1_score': 0.434128}
confusion matrix:
      0    1
0  5615  382
1    69  173
early stop counter: 10
val acc:0.9066212177276611, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 12,now: 2024-08-02 10:53:37.341236,epoch time: 0:28:30.464340,used: 3:59:46.175441,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9674465, 'precision': 0.96782637, 'recall': 0.9674499, 'specificity': 0.9674499, 'f1': 0.96744, 'auroc': 0.9947228, 'binary_precision': 0.981218, 'binary_recall': 0.9531534, 'binary_specificity': 0.98174644, 'binary_f1_score': 0.9669821}
confusion matrix:
       0      1
0  28613    532
1   1366  27793
---- Validation: 
scalar performance:
{'acc': 0.92915356, 'precision': 0.59973437, 'recall': 0.7056247, 'specificity': 0.7056247, 'f1': 0.6298686, 'auroc': 0.8387705, 'binary_precision': 0.21782945, 'binary_recall': 0.4667774, 'binary_specificity': 0.94447196, 'binary_f1_score': 0.29704016}
confusion matrix:
       0     1
0  17162  1009
1    321   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94374096, 'precision': 0.6812892, 'recall': 0.81806433, 'specificity': 0.81806433, 'f1': 0.72741413, 'auroc': 0.8957294, 'binary_precision': 0.37585422, 'binary_recall': 0.6818182, 'binary_specificity': 0.9543105, 'binary_f1_score': 0.4845815}
confusion matrix:
      0    1
0  5723  274
1    77  165
early stop counter: 11
val acc:0.929153561592102, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 13,now: 2024-08-02 11:20:48.795171,epoch time: 0:27:11.453935,used: 4:26:57.629376,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96929884, 'precision': 0.9694582, 'recall': 0.96930075, 'specificity': 0.96930075, 'f1': 0.96929634, 'auroc': 0.9951061, 'binary_precision': 0.9781606, 'binary_recall': 0.9600453, 'binary_specificity': 0.9785562, 'binary_f1_score': 0.9690183}
confusion matrix:
       0      1
0  28521    625
1   1165  27993
---- Validation: 
scalar performance:
{'acc': 0.9262771, 'precision': 0.5960593, 'recall': 0.706548, 'specificity': 0.706548, 'f1': 0.62605035, 'auroc': 0.83699, 'binary_precision': 0.21037038, 'binary_recall': 0.4717608, 'binary_specificity': 0.9413351, 'binary_f1_score': 0.29098362}
confusion matrix:
       0     1
0  17105  1066
1    318   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9427793, 'precision': 0.67912155, 'recall': 0.8195468, 'specificity': 0.8195468, 'f1': 0.72578764, 'auroc': 0.89411855, 'binary_precision': 0.37136465, 'binary_recall': 0.6859504, 'binary_specificity': 0.95314324, 'binary_f1_score': 0.48185775}
confusion matrix:
      0    1
0  5716  281
1    76  166
early stop counter: 12
val acc:0.9262771010398865, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 14,now: 2024-08-02 11:45:37.536399,epoch time: 0:24:48.741228,used: 4:51:46.370604,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96971047, 'precision': 0.9700532, 'recall': 0.9697133, 'specificity': 0.9697133, 'f1': 0.9697051, 'auroc': 0.9955193, 'binary_precision': 0.9827975, 'binary_recall': 0.95616984, 'binary_specificity': 0.9832567, 'binary_f1_score': 0.96930087}
confusion matrix:
       0      1
0  28658    488
1   1278  27880
---- Validation: 
scalar performance:
{'acc': 0.9265434, 'precision': 0.59669507, 'recall': 0.70748854, 'specificity': 0.70748854, 'f1': 0.62685925, 'auroc': 0.84180665, 'binary_precision': 0.21158129, 'binary_recall': 0.47342193, 'binary_specificity': 0.9415552, 'binary_f1_score': 0.29245767}
confusion matrix:
       0     1
0  17109  1062
1    317   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94245875, 'precision': 0.6775386, 'recall': 0.8154146, 'specificity': 0.8154146, 'f1': 0.7234956, 'auroc': 0.89363825, 'binary_precision': 0.36853933, 'binary_recall': 0.677686, 'binary_specificity': 0.95314324, 'binary_f1_score': 0.47743815}
confusion matrix:
      0    1
0  5716  281
1    78  164
early stop counter: 13
val acc:0.9265434145927429, best validation acc: 0.9472646713256836, corresponding to test acc:                         0.9535182118415833 / 0.9612117409706116
after epoch: 15,now: 2024-08-02 12:04:46.027157,epoch time: 0:19:08.490758,used: 5:10:54.861362,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_08md_02_06_53_49_seed_2_23919990
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:10:54.861362 at 2024-08-02 12:04:46.027157
persisted model performance metric: 

scalar performance:
{'acc': 0.9535182, 'precision': 0.6852616, 'recall': 0.67642736, 'specificity': 0.67642736, 'f1': 0.6807193, 'auroc': 0.8601987, 'binary_precision': 0.39565217, 'binary_recall': 0.37603307, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.38559324}
confusion matrix:
      0    1
0  5858  139
1   151   91
oracle model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.7417661, 'recall': 0.78551465, 'specificity': 0.78551465, 'f1': 0.76157093, 'auroc': 0.89145744, 'binary_precision': 0.5, 'binary_recall': 0.59504133, 'binary_specificity': 0.975988, 'binary_f1_score': 0.54339623}
confusion matrix:
      0    1
0  5853  144
1    98  144
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1144 MiB |   8781 MiB |   1081 TiB |   1081 TiB |
|       from large pool |   1106 MiB |   8737 MiB |   1064 TiB |   1064 TiB |
|       from small pool |     37 MiB |     78 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1144 MiB |   8781 MiB |   1081 TiB |   1081 TiB |
|       from large pool |   1106 MiB |   8737 MiB |   1064 TiB |   1064 TiB |
|       from small pool |     37 MiB |     78 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1141 MiB |   8778 MiB |   1078 TiB |   1078 TiB |
|       from large pool |   1105 MiB |   8734 MiB |   1061 TiB |   1061 TiB |
|       from small pool |     36 MiB |     77 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9904 MiB |   9928 MiB |  27322 MiB |  17418 MiB |
|       from large pool |   9824 MiB |   9844 MiB |  27172 MiB |  17348 MiB |
|       from small pool |     80 MiB |     84 MiB |    150 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58748 KiB |    822 MiB | 608774 GiB | 608774 GiB |
|       from large pool |  44175 KiB |    821 MiB | 591201 GiB | 591201 GiB |
|       from small pool |  14573 KiB |     27 MiB |  17572 GiB |  17572 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3460    |    8277    |  217231 K  |  217228 K  |
|       from large pool |     161    |     844    |  102527 K  |  102527 K  |
|       from small pool |    3299    |    8114    |  114704 K  |  114700 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3460    |    8277    |  217231 K  |  217228 K  |
|       from large pool |     161    |     844    |  102527 K  |  102527 K  |
|       from small pool |    3299    |    8114    |  114704 K  |  114700 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     398    |     401    |    1097    |     699    |
|       from large pool |     358    |     359    |    1022    |     664    |
|       from small pool |      40    |      42    |      75    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3678    |  120151 K  |  120151 K  |
|       from large pool |      21    |     355    |   70740 K  |   70740 K  |
|       from small pool |      55    |    3658    |   49411 K  |   49410 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8781 MiB |   1081 TiB |   1081 TiB |
|       from large pool |  16640 KiB |   8737 MiB |   1064 TiB |   1064 TiB |
|       from small pool |      0 KiB |     78 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8781 MiB |   1081 TiB |   1081 TiB |
|       from large pool |  16640 KiB |   8737 MiB |   1064 TiB |   1064 TiB |
|       from small pool |      0 KiB |     78 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8778 MiB |   1078 TiB |   1078 TiB |
|       from large pool |  16640 KiB |   8734 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     77 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1202 MiB |   9928 MiB |  27322 MiB |  26120 MiB |
|       from large pool |   1150 MiB |   9844 MiB |  27172 MiB |  26022 MiB |
|       from small pool |     52 MiB |     84 MiB |    150 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    822 MiB | 608774 GiB | 608774 GiB |
|       from large pool |  30464 KiB |    821 MiB | 591202 GiB | 591202 GiB |
|       from small pool |      0 KiB |     31 MiB |  17572 GiB |  17572 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8277    |  217231 K  |  217231 K  |
|       from large pool |       2    |     844    |  102527 K  |  102527 K  |
|       from small pool |       0    |    8114    |  114704 K  |  114704 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8277    |  217231 K  |  217231 K  |
|       from large pool |       2    |     844    |  102527 K  |  102527 K  |
|       from small pool |       0    |    8114    |  114704 K  |  114704 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      52    |     401    |    1097    |    1045    |
|       from large pool |      26    |     359    |    1022    |     996    |
|       from small pool |      26    |      42    |      75    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3678    |  120152 K  |  120152 K  |
|       from large pool |       2    |     355    |   70740 K  |   70740 K  |
|       from small pool |       0    |    3658    |   49412 K  |   49412 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 12:06:14 2024]
Finished job 0.
1 of 1 steps (100%) done
