Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 09:52:12 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/20.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=20
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_09_59_12_seed_0_23919984

 Experiment start at: 2024-08-01 09:59:12.560715
before training, model accuracy: 0.22451263666152954
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9397838, 'precision': 0.94264424, 'recall': 0.93981755, 'specificity': 0.93981755, 'f1': 0.9396896, 'auroc': 0.97801006, 'binary_precision': 0.9784372, 'binary_recall': 0.89949137, 'binary_specificity': 0.9801438, 'binary_f1_score': 0.9373049}
confusion matrix:
       0      1
0  28087    569
1   2885  25819
---- Validation: 
scalar performance:
{'acc': 0.94785017, 'precision': 0.5569631, 'recall': 0.54246956, 'specificity': 0.54246956, 'f1': 0.5482801, 'auroc': 0.7597097, 'binary_precision': 0.14526317, 'binary_recall': 0.10730949, 'binary_specificity': 0.9776296, 'binary_f1_score': 0.12343471}
confusion matrix:
       0    1
0  17743  406
1    574   69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.923458, 'precision': 0.55115163, 'recall': 0.5587823, 'specificity': 0.5587823, 'f1': 0.5545635, 'auroc': 0.81341565, 'binary_precision': 0.13907285, 'binary_recall': 0.16091955, 'binary_specificity': 0.956645, 'binary_f1_score': 0.14920072}
confusion matrix:
      0    1
0  5737  260
1   219   42
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 10:33:01.787349,epoch time: 0:33:49.226634,used: 0:33:49.226634,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_09_59_12_seed_0_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9536088, 'precision': 0.9552944, 'recall': 0.95363224, 'specificity': 0.95363224, 'f1': 0.9535675, 'auroc': 0.9864567, 'binary_precision': 0.9831892, 'binary_recall': 0.92307156, 'binary_specificity': 0.9841929, 'binary_f1_score': 0.9521825}
confusion matrix:
       0      1
0  28205    453
1   2208  26494
---- Validation: 
scalar performance:
{'acc': 0.9549276, 'precision': 0.634034, 'recall': 0.604638, 'specificity': 0.604638, 'f1': 0.6172134, 'auroc': 0.8198528, 'binary_precision': 0.2951807, 'binary_recall': 0.22861587, 'binary_specificity': 0.9806601, 'binary_f1_score': 0.2576687}
confusion matrix:
       0    1
0  17798  351
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9391179, 'precision': 0.64465785, 'recall': 0.67872536, 'specificity': 0.67872536, 'f1': 0.659499, 'auroc': 0.843024, 'binary_precision': 0.31595093, 'binary_recall': 0.394636, 'binary_specificity': 0.96281475, 'binary_f1_score': 0.35093698}
confusion matrix:
      0    1
0  5774  223
1   158  103
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 11:07:09.667669,epoch time: 0:34:07.880320,used: 1:07:57.106954,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_09_59_12_seed_0_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9602685, 'precision': 0.9617792, 'recall': 0.9602915, 'specificity': 0.9602915, 'f1': 0.9602374, 'auroc': 0.9896896, 'binary_precision': 0.9883927, 'binary_recall': 0.93154025, 'binary_specificity': 0.9890428, 'binary_f1_score': 0.95912474}
confusion matrix:
       0      1
0  28343    314
1   1965  26738
---- Validation: 
scalar performance:
{'acc': 0.9539698, 'precision': 0.6473141, 'recall': 0.6408948, 'specificity': 0.6408948, 'f1': 0.6440211, 'auroc': 0.833112, 'binary_precision': 0.31921825, 'binary_recall': 0.30482116, 'binary_specificity': 0.9769684, 'binary_f1_score': 0.31185362}
confusion matrix:
       0    1
0  17731  418
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935922, 'precision': 0.65285665, 'recall': 0.7320279, 'specificity': 0.7320279, 'f1': 0.682479, 'auroc': 0.85006166, 'binary_precision': 0.3275862, 'binary_recall': 0.5095785, 'binary_specificity': 0.95447725, 'binary_f1_score': 0.39880058}
confusion matrix:
      0    1
0  5724  273
1   128  133
early stop counter: 1
val acc:0.9539697766304016, best validation acc: 0.9549276232719421, corresponding to test acc:                         0.9391179084777832 / 0.9391179084777832
after epoch: 3,now: 2024-08-01 11:42:34.080621,epoch time: 0:35:24.412952,used: 1:43:21.519906,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_09_59_12_seed_0_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96619594, 'precision': 0.96695757, 'recall': 0.9662123, 'specificity': 0.9662123, 'f1': 0.966183, 'auroc': 0.99266255, 'binary_precision': 0.9860173, 'binary_recall': 0.9458593, 'binary_specificity': 0.98656523, 'binary_f1_score': 0.9655209}
confusion matrix:
       0      1
0  28272    385
1   1554  27149
---- Validation: 
scalar performance:
{'acc': 0.93944234, 'precision': 0.63182265, 'recall': 0.7263806, 'specificity': 0.7263806, 'f1': 0.6640863, 'auroc': 0.8522688, 'binary_precision': 0.2819383, 'binary_recall': 0.4976672, 'binary_specificity': 0.9550939, 'binary_f1_score': 0.359955}
confusion matrix:
       0    1
0  17334  815
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9089166, 'precision': 0.61963224, 'recall': 0.7729075, 'specificity': 0.7729075, 'f1': 0.657393, 'auroc': 0.85469747, 'binary_precision': 0.25669292, 'binary_recall': 0.6245211, 'binary_specificity': 0.921294, 'binary_f1_score': 0.36383927}
confusion matrix:
      0    1
0  5525  472
1    98  163
early stop counter: 2
val acc:0.9394423365592957, best validation acc: 0.9549276232719421, corresponding to test acc:                         0.9391179084777832 / 0.9391179084777832
after epoch: 4,now: 2024-08-01 12:16:41.996925,epoch time: 0:34:07.916304,used: 2:17:29.436210,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_09_59_12_seed_0_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96959555, 'precision': 0.97027874, 'recall': 0.9696109, 'specificity': 0.9696109, 'f1': 0.9695852, 'auroc': 0.9940105, 'binary_precision': 0.9884054, 'binary_recall': 0.95038843, 'binary_specificity': 0.9888334, 'binary_f1_score': 0.9690242}
confusion matrix:
       0      1
0  28337    320
1   1424  27279
---- Validation: 
scalar performance:
{'acc': 0.93736696, 'precision': 0.62487555, 'recall': 0.71780556, 'specificity': 0.71780556, 'f1': 0.6560652, 'auroc': 0.8526027, 'binary_precision': 0.26863086, 'binary_recall': 0.4821151, 'binary_specificity': 0.95349604, 'binary_f1_score': 0.34501952}
confusion matrix:
       0    1
0  17305  844
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91099393, 'precision': 0.626454, 'recall': 0.7904824, 'specificity': 0.7904824, 'f1': 0.6669214, 'auroc': 0.86825466, 'binary_precision': 0.26875, 'binary_recall': 0.65900385, 'binary_specificity': 0.921961, 'binary_f1_score': 0.381798}
confusion matrix:
      0    1
0  5529  468
1    89  172
early stop counter: 3
val acc:0.9373669624328613, best validation acc: 0.9549276232719421, corresponding to test acc:                         0.9391179084777832 / 0.9391179084777832
after epoch: 5,now: 2024-08-01 12:49:54.564161,epoch time: 0:33:12.567236,used: 2:50:42.003446,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_09_59_12_seed_0_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:50:42.003446 at 2024-08-01 12:49:54.564161
persisted model performance metric: 

scalar performance:
{'acc': 0.9391179, 'precision': 0.64465785, 'recall': 0.67872536, 'specificity': 0.67872536, 'f1': 0.659499, 'auroc': 0.843024, 'binary_precision': 0.31595093, 'binary_recall': 0.394636, 'binary_specificity': 0.96281475, 'binary_f1_score': 0.35093698}
confusion matrix:
      0    1
0  5774  223
1   158  103
oracle model performance metric: 

scalar performance:
{'acc': 0.9391179, 'precision': 0.64465785, 'recall': 0.67872536, 'specificity': 0.67872536, 'f1': 0.659499, 'auroc': 0.843024, 'binary_precision': 0.31595093, 'binary_recall': 0.394636, 'binary_specificity': 0.96281475, 'binary_f1_score': 0.35093698}
confusion matrix:
      0    1
0  5774  223
1   158  103
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/20.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198163 KiB |   2142 MiB | 264581 GiB | 264581 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 261381 GiB | 261381 GiB |
|       from small pool |  17501 KiB |     37 MiB |   3199 GiB |   3199 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198163 KiB |   2142 MiB | 264581 GiB | 264581 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 261381 GiB | 261381 GiB |
|       from small pool |  17501 KiB |     37 MiB |   3199 GiB |   3199 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   2141 MiB | 264555 GiB | 264554 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 261360 GiB | 261360 GiB |
|       from small pool |  16482 KiB |     36 MiB |   3194 GiB |   3194 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2372 MiB |   2372 MiB |   2372 MiB |      0 B   |
|       from large pool |   2330 MiB |   2330 MiB |   2330 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  57837 KiB | 225565 KiB | 142326 GiB | 142326 GiB |
|       from large pool |  50762 KiB | 224940 KiB | 139103 GiB | 139103 GiB |
|       from small pool |   7075 KiB |   9877 KiB |   3223 GiB |   3223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2998    |    7665    |   39922 K  |   39919 K  |
|       from large pool |      79    |     252    |   24056 K  |   24056 K  |
|       from small pool |    2919    |    7585    |   15865 K  |   15862 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2998    |    7665    |   39922 K  |   39919 K  |
|       from large pool |      79    |     252    |   24056 K  |   24056 K  |
|       from small pool |    2919    |    7585    |   15865 K  |   15862 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     118    |     118    |     118    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    3602    |   25852 K  |   25852 K  |
|       from large pool |      10    |      97    |   18685 K  |   18685 K  |
|       from small pool |      29    |    3592    |    7166 K  |    7166 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 264581 GiB | 264581 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 261381 GiB | 261381 GiB |
|       from small pool |      0 KiB |     37 MiB |   3199 GiB |   3199 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 264581 GiB | 264581 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 261381 GiB | 261381 GiB |
|       from small pool |      0 KiB |     37 MiB |   3199 GiB |   3199 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 264555 GiB | 264555 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 261360 GiB | 261360 GiB |
|       from small pool |      0 KiB |     36 MiB |   3194 GiB |   3194 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   2372 MiB |   2372 MiB |   2122 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 142326 GiB | 142326 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 139103 GiB | 139103 GiB |
|       from small pool |      0 KiB |  20640 KiB |   3223 GiB |   3223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   39922 K  |   39922 K  |
|       from large pool |       2    |     252    |   24056 K  |   24056 K  |
|       from small pool |       0    |    7585    |   15865 K  |   15865 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   39922 K  |   39922 K  |
|       from large pool |       2    |     252    |   24056 K  |   24056 K  |
|       from small pool |       0    |    7585    |   15865 K  |   15865 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     118    |     118    |      95    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   25853 K  |   25853 K  |
|       from large pool |       3    |      97    |   18685 K  |   18685 K  |
|       from small pool |       0    |    3592    |    7167 K  |    7167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 264581 GiB | 264581 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 261381 GiB | 261381 GiB |
|       from small pool |      0 KiB |     37 MiB |   3199 GiB |   3199 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 264581 GiB | 264581 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 261381 GiB | 261381 GiB |
|       from small pool |      0 KiB |     37 MiB |   3199 GiB |   3199 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 264555 GiB | 264555 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 261360 GiB | 261360 GiB |
|       from small pool |      0 KiB |     36 MiB |   3194 GiB |   3194 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   2372 MiB |   2372 MiB |   2122 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 142326 GiB | 142326 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 139103 GiB | 139103 GiB |
|       from small pool |      0 KiB |  20640 KiB |   3223 GiB |   3223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   39922 K  |   39922 K  |
|       from large pool |       2    |     252    |   24056 K  |   24056 K  |
|       from small pool |       0    |    7585    |   15865 K  |   15865 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   39922 K  |   39922 K  |
|       from large pool |       2    |     252    |   24056 K  |   24056 K  |
|       from small pool |       0    |    7585    |   15865 K  |   15865 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     118    |     118    |      95    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   25853 K  |   25853 K  |
|       from large pool |       3    |      97    |   18685 K  |   18685 K  |
|       from small pool |       0    |    3592    |    7167 K  |    7167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_12_58_06_seed_1_23919984

 Experiment start at: 2024-08-01 12:58:06.544369
before training, model accuracy: 0.6890106797218323
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93836784, 'precision': 0.9416139, 'recall': 0.93839914, 'specificity': 0.93839914, 'f1': 0.93825734, 'auroc': 0.981141, 'binary_precision': 0.9796584, 'binary_recall': 0.8954178, 'binary_specificity': 0.98138046, 'binary_f1_score': 0.93564576}
confusion matrix:
       0      1
0  28251    536
1   3015  25814
---- Validation: 
scalar performance:
{'acc': 0.9533084, 'precision': 0.66222763, 'recall': 0.66106695, 'specificity': 0.66106695, 'f1': 0.6616449, 'auroc': 0.84996676, 'binary_precision': 0.3488024, 'binary_recall': 0.346211, 'binary_specificity': 0.97592294, 'binary_f1_score': 0.34750184}
confusion matrix:
       0    1
0  17632  435
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.71369386, 'recall': 0.72935784, 'specificity': 0.72935784, 'f1': 0.721204, 'auroc': 0.9005307, 'binary_precision': 0.45, 'binary_recall': 0.4846154, 'binary_specificity': 0.97410023, 'binary_f1_score': 0.46666667}
confusion matrix:
      0    1
0  5792  154
1   134  126
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 13:32:12.020515,epoch time: 0:34:05.476146,used: 0:34:05.476146,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_12_58_06_seed_1_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95410997, 'precision': 0.9561669, 'recall': 0.9541345, 'specificity': 0.9541345, 'f1': 0.95405996, 'auroc': 0.9895958, 'binary_precision': 0.9869816, 'binary_recall': 0.9204273, 'binary_specificity': 0.9878417, 'binary_f1_score': 0.9525433}
confusion matrix:
       0      1
0  28437    350
1   2294  26535
---- Validation: 
scalar performance:
{'acc': 0.95581645, 'precision': 0.6887904, 'recall': 0.7124364, 'specificity': 0.7124364, 'f1': 0.69981176, 'auroc': 0.87676, 'binary_precision': 0.3981603, 'binary_recall': 0.45022288, 'binary_specificity': 0.9746499, 'binary_f1_score': 0.42259413}
confusion matrix:
       0    1
0  17609  458
1    370  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.75799567, 'recall': 0.81247056, 'specificity': 0.81247056, 'f1': 0.78224725, 'auroc': 0.91532063, 'binary_precision': 0.5314465, 'binary_recall': 0.65, 'binary_specificity': 0.97494113, 'binary_f1_score': 0.58477503}
confusion matrix:
      0    1
0  5797  149
1    91  169
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 14:06:08.931731,epoch time: 0:33:56.911216,used: 1:08:02.387362,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_12_58_06_seed_1_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9604103, 'precision': 0.9612076, 'recall': 0.9604248, 'specificity': 0.9604248, 'f1': 0.960394, 'auroc': 0.991662, 'binary_precision': 0.9805583, 'binary_recall': 0.93950325, 'binary_specificity': 0.98134637, 'binary_f1_score': 0.9595918}
confusion matrix:
       0      1
0  28251    537
1   1744  27084
---- Validation: 
scalar performance:
{'acc': 0.95384204, 'precision': 0.6880161, 'recall': 0.7493216, 'specificity': 0.7493216, 'f1': 0.7136987, 'auroc': 0.88209915, 'binary_precision': 0.3938053, 'binary_recall': 0.5289747, 'binary_specificity': 0.96966845, 'binary_f1_score': 0.45149013}
confusion matrix:
       0    1
0  17519  548
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.74141055, 'recall': 0.8234935, 'specificity': 0.8234935, 'f1': 0.7755413, 'auroc': 0.9193514, 'binary_precision': 0.49717513, 'binary_recall': 0.6769231, 'binary_specificity': 0.9700639, 'binary_f1_score': 0.5732899}
confusion matrix:
      0    1
0  5768  178
1    84  176
early stop counter: 1
val acc:0.953842043876648, best validation acc: 0.9558164477348328, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 3,now: 2024-08-01 14:39:20.964591,epoch time: 0:33:12.032860,used: 1:41:14.420222,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_12_58_06_seed_1_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96117395, 'precision': 0.9625989, 'recall': 0.9611953, 'specificity': 0.9611953, 'f1': 0.9611453, 'auroc': 0.9931845, 'binary_precision': 0.9884648, 'binary_recall': 0.93329865, 'binary_specificity': 0.98909193, 'binary_f1_score': 0.9600899}
confusion matrix:
       0      1
0  28472    314
1   1923  26907
---- Validation: 
scalar performance:
{'acc': 0.95704377, 'precision': 0.695739, 'recall': 0.71664923, 'specificity': 0.71664923, 'f1': 0.7055865, 'auroc': 0.8821552, 'binary_precision': 0.4117647, 'binary_recall': 0.4576523, 'binary_specificity': 0.9756462, 'binary_f1_score': 0.43349752}
confusion matrix:
       0    1
0  17627  440
1    365  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.7703544, 'recall': 0.8118088, 'specificity': 0.8118088, 'f1': 0.7893965, 'auroc': 0.92260146, 'binary_precision': 0.5562914, 'binary_recall': 0.64615387, 'binary_specificity': 0.97746384, 'binary_f1_score': 0.59786475}
confusion matrix:
      0    1
0  5812  134
1    92  168
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 15:13:26.746614,epoch time: 0:34:05.782023,used: 2:15:20.202245,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_12_58_06_seed_1_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9667974, 'precision': 0.9675157, 'recall': 0.9668118, 'specificity': 0.9668118, 'f1': 0.9667854, 'auroc': 0.9943851, 'binary_precision': 0.98602384, 'binary_recall': 0.9470672, 'binary_specificity': 0.9865564, 'binary_f1_score': 0.966153}
confusion matrix:
       0      1
0  28400    387
1   1526  27303
---- Validation: 
scalar performance:
{'acc': 0.9551227, 'precision': 0.6914522, 'recall': 0.739972, 'specificity': 0.739972, 'f1': 0.7125671, 'auroc': 0.8829733, 'binary_precision': 0.40140846, 'binary_recall': 0.50817233, 'binary_specificity': 0.9717717, 'binary_f1_score': 0.44852456}
confusion matrix:
       0    1
0  17557  510
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.76131016, 'recall': 0.8164849, 'specificity': 0.8164849, 'f1': 0.7858765, 'auroc': 0.9238664, 'binary_precision': 0.5377358, 'binary_recall': 0.6576923, 'binary_specificity': 0.9752775, 'binary_f1_score': 0.5916955}
confusion matrix:
      0    1
0  5799  147
1    89  171
early stop counter: 1
val acc:0.955122709274292, best validation acc: 0.9570437669754028, corresponding to test acc:                         0.9635836482048035 / 0.9635836482048035
after epoch: 5,now: 2024-08-01 15:47:16.086043,epoch time: 0:33:49.339429,used: 2:49:09.541674,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_12_58_06_seed_1_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9704769, 'precision': 0.9705913, 'recall': 0.9704827, 'specificity': 0.9704827, 'f1': 0.97047544, 'auroc': 0.9946028, 'binary_precision': 0.9781107, 'binary_recall': 0.9625377, 'binary_specificity': 0.97842777, 'binary_f1_score': 0.97026175}
confusion matrix:
       0      1
0  28166    621
1   1080  27749
---- Validation: 
scalar performance:
{'acc': 0.9495731, 'precision': 0.67568016, 'recall': 0.76355875, 'specificity': 0.76355875, 'f1': 0.70934165, 'auroc': 0.88533354, 'binary_precision': 0.36796117, 'binary_recall': 0.56315005, 'binary_specificity': 0.96396744, 'binary_f1_score': 0.44509688}
confusion matrix:
       0    1
0  17416  651
1    294  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95343214, 'precision': 0.72376084, 'recall': 0.8212231, 'specificity': 0.8212231, 'f1': 0.762295, 'auroc': 0.9251779, 'binary_precision': 0.46194226, 'binary_recall': 0.6769231, 'binary_specificity': 0.96552306, 'binary_f1_score': 0.54914194}
confusion matrix:
      0    1
0  5741  205
1    84  176
early stop counter: 2
val acc:0.9495730996131897, best validation acc: 0.9570437669754028, corresponding to test acc:                         0.9635836482048035 / 0.9635836482048035
after epoch: 6,now: 2024-08-01 16:20:12.557550,epoch time: 0:32:56.471507,used: 3:22:06.013181,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_12_58_06_seed_1_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9722473, 'precision': 0.9723618, 'recall': 0.9722533, 'specificity': 0.9722533, 'f1': 0.9722458, 'auroc': 0.9956388, 'binary_precision': 0.97990906, 'binary_recall': 0.964308, 'binary_specificity': 0.9801987, 'binary_f1_score': 0.97204596}
confusion matrix:
       0      1
0  28216    570
1   1029  27801
---- Validation: 
scalar performance:
{'acc': 0.95037353, 'precision': 0.6781012, 'recall': 0.7625433, 'specificity': 0.7625433, 'f1': 0.7108815, 'auroc': 0.88428843, 'binary_precision': 0.37289813, 'binary_recall': 0.5601783, 'binary_specificity': 0.9649084, 'binary_f1_score': 0.4477435}
confusion matrix:
       0    1
0  17433  634
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.7320291, 'recall': 0.8150444, 'specificity': 0.8150444, 'f1': 0.76620805, 'auroc': 0.9249977, 'binary_precision': 0.47910863, 'binary_recall': 0.6615385, 'binary_specificity': 0.96855026, 'binary_f1_score': 0.55573505}
confusion matrix:
      0    1
0  5759  187
1    88  172
early stop counter: 3
val acc:0.9503735303878784, best validation acc: 0.9570437669754028, corresponding to test acc:                         0.9635836482048035 / 0.9635836482048035
after epoch: 7,now: 2024-08-01 16:53:29.947283,epoch time: 0:33:17.389733,used: 3:55:23.402914,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_12_58_06_seed_1_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 3:55:23.402914 at 2024-08-01 16:53:29.947283
persisted model performance metric: 

scalar performance:
{'acc': 0.96358365, 'precision': 0.7703544, 'recall': 0.8118088, 'specificity': 0.8118088, 'f1': 0.7893965, 'auroc': 0.92260146, 'binary_precision': 0.5562914, 'binary_recall': 0.64615387, 'binary_specificity': 0.97746384, 'binary_f1_score': 0.59786475}
confusion matrix:
      0    1
0  5812  134
1    92  168
oracle model performance metric: 

scalar performance:
{'acc': 0.96358365, 'precision': 0.7703544, 'recall': 0.8118088, 'specificity': 0.8118088, 'f1': 0.7893965, 'auroc': 0.92260146, 'binary_precision': 0.5562914, 'binary_recall': 0.64615387, 'binary_specificity': 0.97746384, 'binary_f1_score': 0.59786475}
confusion matrix:
      0    1
0  5812  134
1    92  168
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196700 KiB |   2142 MiB | 635258 GiB | 635258 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 627590 GiB | 627590 GiB |
|       from small pool |  17489 KiB |     37 MiB |   7668 GiB |   7668 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196700 KiB |   2142 MiB | 635258 GiB | 635258 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 627590 GiB | 627590 GiB |
|       from small pool |  17489 KiB |     37 MiB |   7668 GiB |   7668 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   2141 MiB | 635182 GiB | 635181 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 627525 GiB | 627525 GiB |
|       from small pool |  16480 KiB |     36 MiB |   7656 GiB |   7656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2356 MiB |   2372 MiB |   4478 MiB |   2122 MiB |
|       from large pool |   2318 MiB |   2330 MiB |   4422 MiB |   2104 MiB |
|       from small pool |     38 MiB |     42 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40868 KiB | 234798 KiB | 343368 GiB | 343368 GiB |
|       from large pool |  31733 KiB | 232384 KiB | 335652 GiB | 335652 GiB |
|       from small pool |   9135 KiB |  20640 KiB |   7715 GiB |   7715 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2974    |    7697    |   95735 K  |   95732 K  |
|       from large pool |      79    |     252    |   57751 K  |   57751 K  |
|       from small pool |    2895    |    7617    |   37983 K  |   37981 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2974    |    7697    |   95735 K  |   95732 K  |
|       from large pool |      79    |     252    |   57751 K  |   57751 K  |
|       from small pool |    2895    |    7617    |   37983 K  |   37981 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     118    |     211    |      95    |
|       from large pool |      97    |      97    |     183    |      86    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |    3619    |   61077 K  |   61077 K  |
|       from large pool |      11    |     101    |   44183 K  |   44183 K  |
|       from small pool |      30    |    3608    |   16894 K  |   16894 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 635258 GiB | 635258 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 627590 GiB | 627590 GiB |
|       from small pool |      0 KiB |     37 MiB |   7668 GiB |   7668 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 635258 GiB | 635258 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 627590 GiB | 627590 GiB |
|       from small pool |      0 KiB |     37 MiB |   7668 GiB |   7668 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 635182 GiB | 635182 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 627525 GiB | 627525 GiB |
|       from small pool |      0 KiB |     36 MiB |   7656 GiB |   7656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   2372 MiB |   4478 MiB |   4246 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4422 MiB |   4216 MiB |
|       from small pool |  26624 KiB |     42 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 234798 KiB | 343368 GiB | 343368 GiB |
|       from large pool |  30464 KiB | 232384 KiB | 335653 GiB | 335653 GiB |
|       from small pool |      0 KiB |  23492 KiB |   7715 GiB |   7715 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |   95735 K  |   95735 K  |
|       from large pool |       2    |     252    |   57751 K  |   57751 K  |
|       from small pool |       0    |    7617    |   37983 K  |   37983 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |   95735 K  |   95735 K  |
|       from large pool |       2    |     252    |   57751 K  |   57751 K  |
|       from small pool |       0    |    7617    |   37983 K  |   37983 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     118    |     211    |     188    |
|       from large pool |      10    |      97    |     183    |     173    |
|       from small pool |      13    |      21    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3619    |   61078 K  |   61078 K  |
|       from large pool |       3    |     101    |   44183 K  |   44183 K  |
|       from small pool |       0    |    3608    |   16895 K  |   16895 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 635258 GiB | 635258 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 627590 GiB | 627590 GiB |
|       from small pool |      0 KiB |     37 MiB |   7668 GiB |   7668 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 635258 GiB | 635258 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 627590 GiB | 627590 GiB |
|       from small pool |      0 KiB |     37 MiB |   7668 GiB |   7668 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 635182 GiB | 635182 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 627525 GiB | 627525 GiB |
|       from small pool |      0 KiB |     36 MiB |   7656 GiB |   7656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   2372 MiB |   4478 MiB |   4246 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4422 MiB |   4216 MiB |
|       from small pool |  26624 KiB |     42 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 234798 KiB | 343368 GiB | 343368 GiB |
|       from large pool |  30464 KiB | 232384 KiB | 335653 GiB | 335653 GiB |
|       from small pool |      0 KiB |  23492 KiB |   7715 GiB |   7715 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |   95735 K  |   95735 K  |
|       from large pool |       2    |     252    |   57751 K  |   57751 K  |
|       from small pool |       0    |    7617    |   37983 K  |   37983 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |   95735 K  |   95735 K  |
|       from large pool |       2    |     252    |   57751 K  |   57751 K  |
|       from small pool |       0    |    7617    |   37983 K  |   37983 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     118    |     211    |     188    |
|       from large pool |      10    |      97    |     183    |     173    |
|       from small pool |      13    |      21    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3619    |   61078 K  |   61078 K  |
|       from large pool |       3    |     101    |   44183 K  |   44183 K  |
|       from small pool |       0    |    3608    |   16895 K  |   16895 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_17_01_54_seed_2_23919984

 Experiment start at: 2024-08-01 17:01:54.953334
before training, model accuracy: 0.10803013294935226
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91811883, 'precision': 0.92298734, 'recall': 0.91812986, 'specificity': 0.91812986, 'f1': 0.91788393, 'auroc': 0.9574908, 'binary_precision': 0.9684186, 'binary_recall': 0.86446255, 'binary_specificity': 0.97179717, 'binary_f1_score': 0.9134925}
confusion matrix:
       0      1
0  28324    822
1   3952  25206
---- Validation: 
scalar performance:
{'acc': 0.9555745, 'precision': 0.5301978, 'recall': 0.5144955, 'specificity': 0.5144955, 'f1': 0.51797056, 'auroc': 0.58492017, 'binary_precision': 0.09154929, 'binary_recall': 0.04318937, 'binary_specificity': 0.9858016, 'binary_f1_score': 0.058690745}
confusion matrix:
       0    1
0  17913  258
1    576   26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95287704, 'precision': 0.51407456, 'recall': 0.5035955, 'specificity': 0.5035955, 'f1': 0.5011721, 'auroc': 0.5521487, 'binary_precision': 0.06666667, 'binary_recall': 0.016528925, 'binary_specificity': 0.990662, 'binary_f1_score': 0.026490066}
confusion matrix:
      0   1
0  5941  56
1   238   4
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 17:36:09.876267,epoch time: 0:34:14.922933,used: 0:34:14.922933,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_17_01_54_seed_2_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93755144, 'precision': 0.94299936, 'recall': 0.937561, 'specificity': 0.937561, 'f1': 0.9373598, 'auroc': 0.97524226, 'binary_precision': 0.99216884, 'binary_recall': 0.88208663, 'binary_specificity': 0.9930353, 'binary_f1_score': 0.933895}
confusion matrix:
       0      1
0  28944    203
1   3438  25719
---- Validation: 
scalar performance:
{'acc': 0.96574867, 'precision': 0.5939206, 'recall': 0.5117206, 'specificity': 0.5117206, 'f1': 0.51498413, 'auroc': 0.6741359, 'binary_precision': 0.21917808, 'binary_recall': 0.026578072, 'binary_specificity': 0.9968631, 'binary_f1_score': 0.047407407}
confusion matrix:
       0   1
0  18114  57
1    586  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586472, 'precision': 0.5977425, 'recall': 0.51254517, 'specificity': 0.51254517, 'f1': 0.5151667, 'auroc': 0.70472944, 'binary_precision': 0.23333333, 'binary_recall': 0.02892562, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.05147059}
confusion matrix:
      0   1
0  5974  23
1   235   7
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 18:09:56.363258,epoch time: 0:33:46.486991,used: 1:08:01.409924,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_17_01_54_seed_2_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9533994, 'precision': 0.9554716, 'recall': 0.9534064, 'specificity': 0.9534064, 'f1': 0.95334685, 'auroc': 0.98334265, 'binary_precision': 0.98624444, 'binary_recall': 0.9196447, 'binary_specificity': 0.9871681, 'binary_f1_score': 0.9517809}
confusion matrix:
       0      1
0  28772    374
1   2343  26815
---- Validation: 
scalar performance:
{'acc': 0.9645768, 'precision': 0.6548051, 'recall': 0.5512677, 'specificity': 0.5512677, 'f1': 0.57376266, 'auroc': 0.7519636, 'binary_precision': 0.33846155, 'binary_recall': 0.10963455, 'binary_specificity': 0.9929008, 'binary_f1_score': 0.16562109}
confusion matrix:
       0    1
0  18042  129
1    536   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.7200796, 'recall': 0.58484095, 'specificity': 0.58484095, 'f1': 0.6189603, 'auroc': 0.8125737, 'binary_precision': 0.47252747, 'binary_recall': 0.17768595, 'binary_specificity': 0.991996, 'binary_f1_score': 0.25825825}
confusion matrix:
      0   1
0  5949  48
1   199  43
new oracle model saved
early stop counter: 1
val acc:0.964576780796051, best validation acc: 0.96574866771698, corresponding to test acc:                         0.9586471915245056 / 0.9604102969169617
after epoch: 3,now: 2024-08-01 18:43:41.758379,epoch time: 0:33:45.395121,used: 1:41:46.805045,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_17_01_54_seed_2_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9594882, 'precision': 0.9610853, 'recall': 0.9594933, 'specificity': 0.9594933, 'f1': 0.9594534, 'auroc': 0.9878744, 'binary_precision': 0.98826486, 'binary_recall': 0.930034, 'binary_specificity': 0.9889526, 'binary_f1_score': 0.9582656}
confusion matrix:
       0      1
0  28825    322
1   2040  27117
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.7139181, 'recall': 0.5909146, 'specificity': 0.5909146, 'f1': 0.62512934, 'auroc': 0.81020457, 'binary_precision': 0.45418328, 'binary_recall': 0.18936877, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.2672919}
confusion matrix:
       0    1
0  18034  137
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.75838256, 'recall': 0.66366863, 'specificity': 0.66366863, 'f1': 0.6991768, 'auroc': 0.8516924, 'binary_precision': 0.54304636, 'binary_recall': 0.338843, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.41730282}
confusion matrix:
      0   1
0  5928  69
1   160  82
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 19:17:09.051069,epoch time: 0:33:27.292690,used: 2:15:14.097735,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_17_01_54_seed_2_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96607435, 'precision': 0.96614456, 'recall': 0.9660754, 'specificity': 0.9660754, 'f1': 0.96607316, 'auroc': 0.9911348, 'binary_precision': 0.9719068, 'binary_recall': 0.9599067, 'binary_specificity': 0.97224414, 'binary_f1_score': 0.9658695}
confusion matrix:
       0      1
0  28338    809
1   1169  27988
---- Validation: 
scalar performance:
{'acc': 0.96574867, 'precision': 0.719469, 'recall': 0.684376, 'specificity': 0.684376, 'f1': 0.7002273, 'auroc': 0.85562724, 'binary_precision': 0.45924452, 'binary_recall': 0.38372093, 'binary_specificity': 0.98503107, 'binary_f1_score': 0.41809955}
confusion matrix:
       0    1
0  17899  272
1    371  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.71063435, 'recall': 0.7528554, 'specificity': 0.7528554, 'f1': 0.72952473, 'auroc': 0.8814004, 'binary_precision': 0.44027305, 'binary_recall': 0.53305787, 'binary_specificity': 0.972653, 'binary_f1_score': 0.482243}
confusion matrix:
      0    1
0  5833  164
1   113  129
early stop counter: 1
val acc:0.96574866771698, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9632954001426697 / 0.9632954001426697
after epoch: 5,now: 2024-08-01 19:50:55.419958,epoch time: 0:33:46.368889,used: 2:49:00.466624,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_17_01_54_seed_2_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9678067, 'precision': 0.9685034, 'recall': 0.96781063, 'specificity': 0.96781063, 'f1': 0.9677949, 'auroc': 0.99230313, 'binary_precision': 0.986622, 'binary_recall': 0.9484876, 'binary_specificity': 0.98713374, 'binary_f1_score': 0.967179}
confusion matrix:
       0      1
0  28771    375
1   1502  27656
---- Validation: 
scalar performance:
{'acc': 0.96564215, 'precision': 0.71379364, 'recall': 0.65380514, 'specificity': 0.65380514, 'f1': 0.6783649, 'auroc': 0.8629409, 'binary_precision': 0.44988346, 'binary_recall': 0.320598, 'binary_specificity': 0.98701227, 'binary_f1_score': 0.3743938}
confusion matrix:
       0    1
0  17935  236
1    409  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.76114774, 'recall': 0.7673547, 'specificity': 0.7673547, 'f1': 0.7642101, 'auroc': 0.8886599, 'binary_precision': 0.5403226, 'binary_recall': 0.553719, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.5469388}
confusion matrix:
      0    1
0  5883  114
1   108  134
new oracle model saved
early stop counter: 2
val acc:0.9656421542167664, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9632954001426697 / 0.9644173979759216
after epoch: 6,now: 2024-08-01 20:24:26.919138,epoch time: 0:33:31.499180,used: 3:22:31.965804,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_17_01_54_seed_2_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97056806, 'precision': 0.97070086, 'recall': 0.9705695, 'specificity': 0.9705695, 'f1': 0.9705661, 'auroc': 0.9932032, 'binary_precision': 0.9786499, 'binary_recall': 0.96213603, 'binary_specificity': 0.979003, 'binary_f1_score': 0.9703228}
confusion matrix:
       0      1
0  28535    612
1   1104  28053
---- Validation: 
scalar performance:
{'acc': 0.9619134, 'precision': 0.69240487, 'recall': 0.6896223, 'specificity': 0.6896223, 'f1': 0.69100213, 'auroc': 0.86921966, 'binary_precision': 0.40472177, 'binary_recall': 0.3986711, 'binary_specificity': 0.9805734, 'binary_f1_score': 0.40167361}
confusion matrix:
       0    1
0  17818  353
1    362  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94919056, 'precision': 0.6928485, 'recall': 0.79512346, 'specificity': 0.79512346, 'f1': 0.7313989, 'auroc': 0.8890623, 'binary_precision': 0.4010554, 'binary_recall': 0.6280992, 'binary_specificity': 0.9621477, 'binary_f1_score': 0.48953304}
confusion matrix:
      0    1
0  5770  227
1    90  152
early stop counter: 3
val acc:0.9619134068489075, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9632954001426697 / 0.9644173979759216
after epoch: 7,now: 2024-08-01 20:58:36.030752,epoch time: 0:34:09.111614,used: 3:56:41.077418,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_01_17_01_54_seed_2_23919984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 3:56:41.077418 at 2024-08-01 20:58:36.030752
persisted model performance metric: 

scalar performance:
{'acc': 0.9632954, 'precision': 0.75838256, 'recall': 0.66366863, 'specificity': 0.66366863, 'f1': 0.6991768, 'auroc': 0.8516924, 'binary_precision': 0.54304636, 'binary_recall': 0.338843, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.41730282}
confusion matrix:
      0   1
0  5928  69
1   160  82
oracle model performance metric: 

scalar performance:
{'acc': 0.9644174, 'precision': 0.76114774, 'recall': 0.7673547, 'specificity': 0.7673547, 'f1': 0.7642101, 'auroc': 0.8886599, 'binary_precision': 0.5403226, 'binary_recall': 0.553719, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.5469388}
confusion matrix:
      0    1
0  5883  114
1   108  134
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196706 KiB |   2142 MiB |    986 TiB |    986 TiB |
|       from large pool | 179211 KiB |   2124 MiB |    974 TiB |    974 TiB |
|       from small pool |  17495 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196706 KiB |   2142 MiB |    986 TiB |    986 TiB |
|       from large pool | 179211 KiB |   2124 MiB |    974 TiB |    974 TiB |
|       from small pool |  17495 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   2141 MiB |    986 TiB |    986 TiB |
|       from large pool | 178979 KiB |   2123 MiB |    974 TiB |    974 TiB |
|       from small pool |  16482 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2356 MiB |   2372 MiB |   6602 MiB |   4246 MiB |
|       from large pool |   2318 MiB |   2330 MiB |   6534 MiB |   4216 MiB |
|       from small pool |     38 MiB |     42 MiB |     68 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38814 KiB | 234798 KiB | 546644 GiB | 546644 GiB |
|       from large pool |  31733 KiB | 232384 KiB | 534388 GiB | 534388 GiB |
|       from small pool |   7081 KiB |  23492 KiB |  12256 GiB |  12256 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2986    |    7783    |  152146 K  |  152143 K  |
|       from large pool |      79    |     252    |   91823 K  |   91823 K  |
|       from small pool |    2907    |    7703    |   60323 K  |   60320 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2986    |    7783    |  152146 K  |  152143 K  |
|       from large pool |      79    |     252    |   91823 K  |   91823 K  |
|       from small pool |    2907    |    7703    |   60323 K  |   60320 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     118    |     304    |     188    |
|       from large pool |      97    |      97    |     270    |     173    |
|       from small pool |      19    |      21    |      34    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |    3660    |   96817 K  |   96817 K  |
|       from large pool |      11    |     101    |   69968 K  |   69967 K  |
|       from small pool |      30    |    3649    |   26849 K  |   26849 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |   2124 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |   2124 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |   2123 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   2372 MiB |   6602 MiB |   6372 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   6534 MiB |   6328 MiB |
|       from small pool |  24576 KiB |     42 MiB |     68 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 234798 KiB | 546644 GiB | 546644 GiB |
|       from large pool |  30464 KiB | 232384 KiB | 534388 GiB | 534388 GiB |
|       from small pool |      0 KiB |  23492 KiB |  12256 GiB |  12256 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  152146 K  |  152146 K  |
|       from large pool |       2    |     252    |   91823 K  |   91823 K  |
|       from small pool |       0    |    7703    |   60323 K  |   60323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  152146 K  |  152146 K  |
|       from large pool |       2    |     252    |   91823 K  |   91823 K  |
|       from small pool |       0    |    7703    |   60323 K  |   60323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     118    |     304    |     282    |
|       from large pool |      10    |      97    |     270    |     260    |
|       from small pool |      12    |      21    |      34    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3660    |   96818 K  |   96818 K  |
|       from large pool |       3    |     101    |   69968 K  |   69968 K  |
|       from small pool |       0    |    3649    |   26850 K  |   26850 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 20:59:59 2024]
Finished job 0.
1 of 1 steps (100%) done
