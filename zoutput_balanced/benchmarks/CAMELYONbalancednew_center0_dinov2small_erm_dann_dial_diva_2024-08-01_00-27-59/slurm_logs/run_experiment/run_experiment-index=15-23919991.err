Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 21:27:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/15.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=15
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991

 Experiment start at: 2024-08-01 21:37:37.695550
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94830894, 'precision': 0.94898105, 'recall': 0.9483232, 'specificity': 0.9483232, 'f1': 0.9482907, 'auroc': 0.9856192, 'binary_precision': 0.96653616, 'binary_recall': 0.9288527, 'binary_specificity': 0.9677937, 'binary_f1_score': 0.9473198}
confusion matrix:
       0      1
0  27736    923
1   2042  26659
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8944232, 'precision': 0.59059066, 'recall': 0.78257936, 'specificity': 0.78257936, 'f1': 0.62166315, 'auroc': 0.8835961, 'binary_precision': 0.19425444, 'binary_recall': 0.66251945, 'binary_specificity': 0.90263927, 'binary_f1_score': 0.30042315}
confusion matrix:
       0     1
0  16382  1767
1    217   426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88526684, 'precision': 0.61537504, 'recall': 0.84852004, 'specificity': 0.84852004, 'f1': 0.65353, 'auroc': 0.9130702, 'binary_precision': 0.2400455, 'binary_recall': 0.8084291, 'binary_specificity': 0.88861096, 'binary_f1_score': 0.37017542}
confusion matrix:
      0    1
0  5329  668
1    50  211
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 22:22:37.909248,epoch time: 0:45:00.213698,used: 0:45:00.213698,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96206415, 'precision': 0.9627527, 'recall': 0.9620784, 'specificity': 0.9620784, 'f1': 0.96205086, 'auroc': 0.9923192, 'binary_precision': 0.9807867, 'binary_recall': 0.9426501, 'binary_specificity': 0.9815067, 'binary_f1_score': 0.9613403}
confusion matrix:
       0      1
0  28129    530
1   1646  27055
---- Validation: 
scalar performance:
{'acc': 0.91549593, 'precision': 0.60693324, 'recall': 0.77173746, 'specificity': 0.77173746, 'f1': 0.6441111, 'auroc': 0.88416517, 'binary_precision': 0.22829212, 'binary_recall': 0.61741835, 'binary_specificity': 0.9260565, 'binary_f1_score': 0.33333334}
confusion matrix:
       0     1
0  16807  1342
1    246   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89165866, 'precision': 0.6207441, 'recall': 0.8500227, 'specificity': 0.8500227, 'f1': 0.66156685, 'auroc': 0.9224746, 'binary_precision': 0.25089607, 'binary_recall': 0.8045977, 'binary_specificity': 0.89544773, 'binary_f1_score': 0.3825137}
confusion matrix:
      0    1
0  5370  627
1    51  210
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 23:07:46.820562,epoch time: 0:45:08.911314,used: 1:30:09.125012,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9709728, 'precision': 0.9712043, 'recall': 0.9709822, 'specificity': 0.9709822, 'f1': 0.9709697, 'auroc': 0.99491155, 'binary_precision': 0.9818584, 'binary_recall': 0.95972687, 'binary_specificity': 0.9822376, 'binary_f1_score': 0.97066647}
confusion matrix:
       0      1
0  28147    509
1   1156  27548
---- Validation: 
scalar performance:
{'acc': 0.8878778, 'precision': 0.592162, 'recall': 0.810693, 'specificity': 0.810693, 'f1': 0.6232956, 'auroc': 0.8872236, 'binary_precision': 0.195, 'binary_recall': 0.7278383, 'binary_specificity': 0.89354783, 'binary_f1_score': 0.3075912}
confusion matrix:
       0     1
0  16217  1932
1    175   468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85634387, 'precision': 0.5977133, 'recall': 0.84808785, 'specificity': 0.84808785, 'f1': 0.62359023, 'auroc': 0.92650795, 'binary_precision': 0.2035316, 'binary_recall': 0.83908045, 'binary_specificity': 0.85709524, 'binary_f1_score': 0.32759908}
confusion matrix:
      0    1
0  5140  857
1    42  219
early stop counter: 1
val acc:0.8878778219223022, best validation acc: 0.9154959321022034, corresponding to test acc:                         0.8916586637496948 / 0.8916586637496948
after epoch: 3,now: 2024-08-01 23:52:57.797640,epoch time: 0:45:10.977078,used: 2:15:20.102090,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9748082, 'precision': 0.97534466, 'recall': 0.97482, 'specificity': 0.97482, 'f1': 0.97480154, 'auroc': 0.99620104, 'binary_precision': 0.99148846, 'binary_recall': 0.95787454, 'binary_specificity': 0.9917655, 'binary_f1_score': 0.9743917}
confusion matrix:
       0      1
0  28424    236
1   1209  27491
---- Validation: 
scalar performance:
{'acc': 0.9202852, 'precision': 0.6128292, 'recall': 0.7727168, 'specificity': 0.7727168, 'f1': 0.65141934, 'auroc': 0.8815216, 'binary_precision': 0.24012157, 'binary_recall': 0.61430794, 'binary_specificity': 0.9311257, 'binary_f1_score': 0.34527972}
confusion matrix:
       0     1
0  16899  1250
1    248   395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9089166, 'precision': 0.6355473, 'recall': 0.84070385, 'specificity': 0.84070385, 'f1': 0.6815017, 'auroc': 0.91972744, 'binary_precision': 0.28208745, 'binary_recall': 0.7662835, 'binary_specificity': 0.91512424, 'binary_f1_score': 0.41237113}
confusion matrix:
      0    1
0  5488  509
1    61  200
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 00:38:47.533458,epoch time: 0:45:49.735818,used: 3:01:09.837908,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97759765, 'precision': 0.9777504, 'recall': 0.97760427, 'specificity': 0.97760427, 'f1': 0.97759604, 'auroc': 0.9965559, 'binary_precision': 0.9864788, 'binary_recall': 0.9685028, 'binary_specificity': 0.9867057, 'binary_f1_score': 0.9774082}
confusion matrix:
       0      1
0  28278    381
1    904  27797
---- Validation: 
scalar performance:
{'acc': 0.9186356, 'precision': 0.60984814, 'recall': 0.7688625, 'specificity': 0.7688625, 'f1': 0.64751697, 'auroc': 0.8822031, 'binary_precision': 0.23441248, 'binary_recall': 0.60808706, 'binary_specificity': 0.92963797, 'binary_f1_score': 0.33838165}
confusion matrix:
       0     1
0  16872  1277
1    252   391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9185043, 'precision': 0.6467092, 'recall': 0.83654475, 'specificity': 0.83654475, 'f1': 0.6947142, 'auroc': 0.91608644, 'binary_precision': 0.3051643, 'binary_recall': 0.74712646, 'binary_specificity': 0.925963, 'binary_f1_score': 0.43333334}
confusion matrix:
      0    1
0  5553  444
1    66  195
new oracle model saved
early stop counter: 1
val acc:0.9186356067657471, best validation acc: 0.9202852249145508, corresponding to test acc:                         0.9089165925979614 / 0.9185042977333069
after epoch: 5,now: 2024-08-02 01:25:04.715886,epoch time: 0:46:17.182428,used: 3:47:27.020336,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97829497, 'precision': 0.97868526, 'recall': 0.9783056, 'specificity': 0.9783056, 'f1': 0.9782909, 'auroc': 0.997332, 'binary_precision': 0.9925373, 'binary_recall': 0.96386886, 'binary_specificity': 0.99274224, 'binary_f1_score': 0.9779931}
confusion matrix:
       0      1
0  28451    208
1   1037  27664
---- Validation: 
scalar performance:
{'acc': 0.9441252, 'precision': 0.62655544, 'recall': 0.675551, 'specificity': 0.675551, 'f1': 0.6462839, 'auroc': 0.86469406, 'binary_precision': 0.2751381, 'binary_recall': 0.38724726, 'binary_specificity': 0.96385473, 'binary_f1_score': 0.32170543}
confusion matrix:
       0    1
0  17493  656
1    394  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9448706, 'precision': 0.69073284, 'recall': 0.79349923, 'specificity': 0.79349923, 'f1': 0.7291194, 'auroc': 0.9054377, 'binary_precision': 0.39805827, 'binary_recall': 0.62835246, 'binary_specificity': 0.958646, 'binary_f1_score': 0.48736998}
confusion matrix:
      0    1
0  5749  248
1    97  164
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-02 02:12:17.242008,epoch time: 0:47:12.526122,used: 4:34:39.546458,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98162484, 'precision': 0.981668, 'recall': 0.98162913, 'specificity': 0.98162913, 'f1': 0.9816245, 'auroc': 0.9976517, 'binary_precision': 0.98645365, 'binary_recall': 0.9766939, 'binary_specificity': 0.9865643, 'binary_f1_score': 0.9815495}
confusion matrix:
       0      1
0  28270    385
1    669  28036
---- Validation: 
scalar performance:
{'acc': 0.9096956, 'precision': 0.601065, 'recall': 0.7724848, 'specificity': 0.7724848, 'f1': 0.6365502, 'auroc': 0.880911, 'binary_precision': 0.21636169, 'binary_recall': 0.62519443, 'binary_specificity': 0.9197752, 'binary_f1_score': 0.32147142}
confusion matrix:
       0     1
0  16693  1456
1    241   402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9010866, 'precision': 0.6227112, 'recall': 0.8201275, 'specificity': 0.8201275, 'f1': 0.66393125, 'auroc': 0.9071516, 'binary_precision': 0.2581081, 'binary_recall': 0.7318008, 'binary_specificity': 0.90845424, 'binary_f1_score': 0.38161838}
confusion matrix:
      0    1
0  5448  549
1    70  191
early stop counter: 1
val acc:0.9096956253051758, best validation acc: 0.9441251754760742, corresponding to test acc:                         0.9448705911636353 / 0.9448705911636353
after epoch: 7,now: 2024-08-02 02:59:16.647729,epoch time: 0:46:59.405721,used: 5:21:38.952179,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9818863, 'precision': 0.98216724, 'recall': 0.9818957, 'specificity': 0.9818957, 'f1': 0.98188394, 'auroc': 0.99776995, 'binary_precision': 0.9939998, 'binary_recall': 0.96965367, 'binary_specificity': 0.99413776, 'binary_f1_score': 0.9816758}
confusion matrix:
       0      1
0  28490    168
1    871  27831
---- Validation: 
scalar performance:
{'acc': 0.9405066, 'precision': 0.6307795, 'recall': 0.71493065, 'specificity': 0.71493065, 'f1': 0.6605405, 'auroc': 0.8787782, 'binary_precision': 0.28070176, 'binary_recall': 0.47278383, 'binary_specificity': 0.9570775, 'binary_f1_score': 0.35225958}
confusion matrix:
       0    1
0  17370  779
1    339  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94151485, 'precision': 0.6838762, 'recall': 0.80640703, 'specificity': 0.80640703, 'f1': 0.72675294, 'auroc': 0.90312654, 'binary_precision': 0.3830735, 'binary_recall': 0.65900385, 'binary_specificity': 0.9538102, 'binary_f1_score': 0.48450708}
confusion matrix:
      0    1
0  5720  277
1    89  172
early stop counter: 2
val acc:0.9405065774917603, best validation acc: 0.9441251754760742, corresponding to test acc:                         0.9448705911636353 / 0.9448705911636353
after epoch: 8,now: 2024-08-02 03:46:28.007667,epoch time: 0:47:11.359938,used: 6:08:50.312117,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9837692, 'precision': 0.983776, 'recall': 0.9837707, 'specificity': 0.9837707, 'f1': 0.9837692, 'auroc': 0.9978847, 'binary_precision': 0.98579574, 'binary_recall': 0.9817086, 'binary_specificity': 0.9858329, 'binary_f1_score': 0.98374796}
confusion matrix:
       0      1
0  28252    406
1    525  28177
---- Validation: 
scalar performance:
{'acc': 0.8979885, 'precision': 0.6002852, 'recall': 0.8144274, 'specificity': 0.8144274, 'f1': 0.6359715, 'auroc': 0.897641, 'binary_precision': 0.21124206, 'binary_recall': 0.7247278, 'binary_specificity': 0.90412694, 'binary_f1_score': 0.3271323}
confusion matrix:
       0     1
0  16409  1740
1    177   466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90332377, 'precision': 0.62847704, 'recall': 0.8359534, 'specificity': 0.8359534, 'f1': 0.6721301, 'auroc': 0.9163835, 'binary_precision': 0.26819408, 'binary_recall': 0.7624521, 'binary_specificity': 0.9094547, 'binary_f1_score': 0.39680958}
confusion matrix:
      0    1
0  5454  543
1    62  199
early stop counter: 3
val acc:0.897988498210907, best validation acc: 0.9441251754760742, corresponding to test acc:                         0.9448705911636353 / 0.9448705911636353
after epoch: 9,now: 2024-08-02 04:31:26.212025,epoch time: 0:44:58.204358,used: 6:53:48.516475,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_21_37_37_seed_0_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 6:53:48.516475 at 2024-08-02 04:31:26.212025
persisted model performance metric: 

scalar performance:
{'acc': 0.9448706, 'precision': 0.69073284, 'recall': 0.79349923, 'specificity': 0.79349923, 'f1': 0.7291194, 'auroc': 0.9054377, 'binary_precision': 0.39805827, 'binary_recall': 0.62835246, 'binary_specificity': 0.958646, 'binary_f1_score': 0.48736998}
confusion matrix:
      0    1
0  5749  248
1    97  164
oracle model performance metric: 

scalar performance:
{'acc': 0.9448706, 'precision': 0.69073284, 'recall': 0.79349923, 'specificity': 0.79349923, 'f1': 0.7291194, 'auroc': 0.9054377, 'binary_precision': 0.39805827, 'binary_recall': 0.62835246, 'binary_specificity': 0.958646, 'binary_f1_score': 0.48736998}
confusion matrix:
      0    1
0  5749  248
1    97  164
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/15.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   4047 MiB |    924 TiB |    924 TiB |
|       from large pool | 180662 KiB |   4027 MiB |    914 TiB |    914 TiB |
|       from small pool |  17491 KiB |     37 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   4047 MiB |    924 TiB |    924 TiB |
|       from large pool | 180662 KiB |   4027 MiB |    914 TiB |    914 TiB |
|       from small pool |  17491 KiB |     37 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   4045 MiB |    924 TiB |    924 TiB |
|       from large pool | 178979 KiB |   4026 MiB |    914 TiB |    914 TiB |
|       from small pool |  16482 KiB |     36 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4966 MiB |   4966 MiB |   4966 MiB |      0 B   |
|       from large pool |   4924 MiB |   4924 MiB |   4924 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  57847 KiB | 392988 KiB | 474957 GiB | 474957 GiB |
|       from large pool |  50762 KiB | 392048 KiB | 464526 GiB | 464526 GiB |
|       from small pool |   7085 KiB |   9888 KiB |  10431 GiB |  10431 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7645    |  120993 K  |  120990 K  |
|       from large pool |      79    |     423    |   82737 K  |   82737 K  |
|       from small pool |    2899    |    7565    |   38256 K  |   38253 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7645    |  120993 K  |  120990 K  |
|       from large pool |      79    |     423    |   82737 K  |   82737 K  |
|       from small pool |    2899    |    7565    |   38256 K  |   38253 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     204    |     204    |     204    |       0    |
|       from large pool |     183    |     183    |     183    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3605    |   84587 K  |   84587 K  |
|       from large pool |      10    |     183    |   64661 K  |   64661 K  |
|       from small pool |      23    |    3595    |   19926 K  |   19926 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |    924 TiB |    924 TiB |
|       from large pool |  16640 KiB |   4027 MiB |    914 TiB |    914 TiB |
|       from small pool |      0 KiB |     37 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |    924 TiB |    924 TiB |
|       from large pool |  16640 KiB |   4027 MiB |    914 TiB |    914 TiB |
|       from small pool |      0 KiB |     37 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |    924 TiB |    924 TiB |
|       from large pool |  16640 KiB |   4026 MiB |    914 TiB |    914 TiB |
|       from small pool |      0 KiB |     36 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   4966 MiB |   4966 MiB |   4716 MiB |
|       from large pool | 231424 KiB |   4924 MiB |   4924 MiB |   4698 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB | 474957 GiB | 474957 GiB |
|       from large pool |  30464 KiB | 392048 KiB | 464526 GiB | 464526 GiB |
|       from small pool |      0 KiB |  18291 KiB |  10431 GiB |  10431 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7645    |  120993 K  |  120993 K  |
|       from large pool |       2    |     423    |   82737 K  |   82737 K  |
|       from small pool |       0    |    7565    |   38256 K  |   38256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7645    |  120993 K  |  120993 K  |
|       from large pool |       2    |     423    |   82737 K  |   82737 K  |
|       from small pool |       0    |    7565    |   38256 K  |   38256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     204    |     204    |     181    |
|       from large pool |      11    |     183    |     183    |     172    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3605    |   84588 K  |   84588 K  |
|       from large pool |       3    |     183    |   64661 K  |   64661 K  |
|       from small pool |       0    |    3595    |   19927 K  |   19927 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |    924 TiB |    924 TiB |
|       from large pool |  16640 KiB |   4027 MiB |    914 TiB |    914 TiB |
|       from small pool |      0 KiB |     37 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |    924 TiB |    924 TiB |
|       from large pool |  16640 KiB |   4027 MiB |    914 TiB |    914 TiB |
|       from small pool |      0 KiB |     37 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |    924 TiB |    924 TiB |
|       from large pool |  16640 KiB |   4026 MiB |    914 TiB |    914 TiB |
|       from small pool |      0 KiB |     36 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   4966 MiB |   4966 MiB |   4716 MiB |
|       from large pool | 231424 KiB |   4924 MiB |   4924 MiB |   4698 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB | 474957 GiB | 474957 GiB |
|       from large pool |  30464 KiB | 392048 KiB | 464526 GiB | 464526 GiB |
|       from small pool |      0 KiB |  18291 KiB |  10431 GiB |  10431 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7645    |  120993 K  |  120993 K  |
|       from large pool |       2    |     423    |   82737 K  |   82737 K  |
|       from small pool |       0    |    7565    |   38256 K  |   38256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7645    |  120993 K  |  120993 K  |
|       from large pool |       2    |     423    |   82737 K  |   82737 K  |
|       from small pool |       0    |    7565    |   38256 K  |   38256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     204    |     204    |     181    |
|       from large pool |      11    |     183    |     183    |     172    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3605    |   84588 K  |   84588 K  |
|       from large pool |       3    |     183    |   64661 K  |   64661 K  |
|       from small pool |       0    |    3595    |   19927 K  |   19927 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_04_42_32_seed_1_23919991

 Experiment start at: 2024-08-02 04:42:32.263787
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94944113, 'precision': 0.95033735, 'recall': 0.94945824, 'specificity': 0.94945824, 'f1': 0.9494173, 'auroc': 0.98717403, 'binary_precision': 0.9706192, 'binary_recall': 0.9270205, 'binary_specificity': 0.97189605, 'binary_f1_score': 0.948319}
confusion matrix:
       0      1
0  27977    809
1   2104  26726
---- Validation: 
scalar performance:
{'acc': 0.9294557, 'precision': 0.6238677, 'recall': 0.7445421, 'specificity': 0.7445421, 'f1': 0.65984225, 'auroc': 0.8724278, 'binary_precision': 0.26536515, 'binary_recall': 0.54531944, 'binary_specificity': 0.94376487, 'binary_f1_score': 0.35700393}
confusion matrix:
       0     1
0  17051  1016
1    306   367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94102484, 'precision': 0.6841543, 'recall': 0.81107014, 'specificity': 0.81107014, 'f1': 0.72805375, 'auroc': 0.9153759, 'binary_precision': 0.38325992, 'binary_recall': 0.66923076, 'binary_specificity': 0.9529095, 'binary_f1_score': 0.48739496}
confusion matrix:
      0    1
0  5666  280
1    86  174
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 05:26:03.708532,epoch time: 0:43:31.444745,used: 0:43:31.444745,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_04_42_32_seed_1_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.964003, 'precision': 0.9642439, 'recall': 0.96401143, 'specificity': 0.96401143, 'f1': 0.9639988, 'auroc': 0.9929055, 'binary_precision': 0.97500265, 'binary_recall': 0.9524784, 'binary_specificity': 0.9755445, 'binary_f1_score': 0.9636089}
confusion matrix:
       0      1
0  28083    704
1   1370  27459
---- Validation: 
scalar performance:
{'acc': 0.9192636, 'precision': 0.6293632, 'recall': 0.8279494, 'specificity': 0.8279494, 'f1': 0.67517006, 'auroc': 0.89177525, 'binary_precision': 0.26948407, 'binary_recall': 0.7295691, 'binary_specificity': 0.9263298, 'binary_f1_score': 0.39358717}
confusion matrix:
       0     1
0  16736  1331
1    182   491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8949404, 'precision': 0.62506306, 'recall': 0.85506284, 'specificity': 0.85506284, 'f1': 0.667709, 'auroc': 0.9252781, 'binary_precision': 0.25921375, 'binary_recall': 0.81153846, 'binary_specificity': 0.8985873, 'binary_f1_score': 0.39292365}
confusion matrix:
      0    1
0  5343  603
1    49  211
early stop counter: 1
val acc:0.9192636013031006, best validation acc: 0.9294556975364685, corresponding to test acc:                         0.9410248398780823 / 0.9410248398780823
after epoch: 2,now: 2024-08-02 06:08:16.345835,epoch time: 0:42:12.637303,used: 1:25:44.082048,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_04_42_32_seed_1_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96886283, 'precision': 0.9689344, 'recall': 0.9688674, 'specificity': 0.9688674, 'f1': 0.9688618, 'auroc': 0.994992, 'binary_precision': 0.9749148, 'binary_recall': 0.9625377, 'binary_specificity': 0.97519714, 'binary_f1_score': 0.96868664}
confusion matrix:
       0      1
0  28073    714
1   1080  27749
---- Validation: 
scalar performance:
{'acc': 0.90565634, 'precision': 0.6153609, 'recall': 0.8330519, 'specificity': 0.8330519, 'f1': 0.6569928, 'auroc': 0.8980197, 'binary_precision': 0.24064425, 'binary_recall': 0.7548291, 'binary_specificity': 0.9112747, 'binary_f1_score': 0.36494252}
confusion matrix:
       0     1
0  16464  1603
1    165   508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701257, 'precision': 0.60847855, 'recall': 0.8623418, 'specificity': 0.8623418, 'f1': 0.64149535, 'auroc': 0.9314749, 'binary_precision': 0.22424242, 'binary_recall': 0.85384613, 'binary_specificity': 0.8708375, 'binary_f1_score': 0.3552}
confusion matrix:
      0    1
0  5178  768
1    38  222
early stop counter: 2
val acc:0.9056563377380371, best validation acc: 0.9294556975364685, corresponding to test acc:                         0.9410248398780823 / 0.9410248398780823
after epoch: 3,now: 2024-08-02 06:50:32.473052,epoch time: 0:42:16.127217,used: 2:08:00.209265,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_04_42_32_seed_1_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9737747, 'precision': 0.9738379, 'recall': 0.97377896, 'specificity': 0.97377896, 'f1': 0.97377396, 'auroc': 0.9961357, 'binary_precision': 0.9794987, 'binary_recall': 0.9678449, 'binary_specificity': 0.9797131, 'binary_f1_score': 0.9736369}
confusion matrix:
       0      1
0  28203    584
1    927  27902
---- Validation: 
scalar performance:
{'acc': 0.91392744, 'precision': 0.6241782, 'recall': 0.83376515, 'specificity': 0.83376515, 'f1': 0.66892326, 'auroc': 0.8987938, 'binary_precision': 0.25847894, 'binary_recall': 0.7473997, 'binary_specificity': 0.9201306, 'binary_f1_score': 0.38411605}
confusion matrix:
       0     1
0  16624  1443
1    170   503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8893007, 'precision': 0.62007755, 'recall': 0.8539587, 'specificity': 0.8539587, 'f1': 0.6604235, 'auroc': 0.9281372, 'binary_precision': 0.24911869, 'binary_recall': 0.8153846, 'binary_specificity': 0.89253277, 'binary_f1_score': 0.38163817}
confusion matrix:
      0    1
0  5307  639
1    48  212
early stop counter: 3
val acc:0.913927435874939, best validation acc: 0.9294556975364685, corresponding to test acc:                         0.9410248398780823 / 0.9410248398780823
after epoch: 4,now: 2024-08-02 07:32:47.294656,epoch time: 0:42:14.821604,used: 2:50:15.030869,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_04_42_32_seed_1_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 2:50:15.030869 at 2024-08-02 07:32:47.294656
persisted model performance metric: 

scalar performance:
{'acc': 0.94102484, 'precision': 0.6841543, 'recall': 0.81107014, 'specificity': 0.81107014, 'f1': 0.72805375, 'auroc': 0.9153759, 'binary_precision': 0.38325992, 'binary_recall': 0.66923076, 'binary_specificity': 0.9529095, 'binary_f1_score': 0.48739496}
confusion matrix:
      0    1
0  5666  280
1    86  174
oracle model performance metric: 

scalar performance:
{'acc': 0.94102484, 'precision': 0.6841543, 'recall': 0.81107014, 'specificity': 0.81107014, 'f1': 0.72805375, 'auroc': 0.9153759, 'binary_precision': 0.38325992, 'binary_recall': 0.66923076, 'binary_specificity': 0.9529095, 'binary_f1_score': 0.48739496}
confusion matrix:
      0    1
0  5666  280
1    86  174
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   4047 MiB |   1338 TiB |   1338 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1324 TiB |   1324 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   4047 MiB |   1338 TiB |   1338 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1324 TiB |   1324 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   4045 MiB |   1338 TiB |   1338 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1324 TiB |   1324 TiB |
|       from small pool |  16480 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4946 MiB |   4966 MiB |   9662 MiB |   4716 MiB |
|       from large pool |   4908 MiB |   4924 MiB |   9606 MiB |   4698 MiB |
|       from small pool |     38 MiB |     42 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 396512 KiB | 695807 GiB | 695807 GiB |
|       from large pool |  31733 KiB | 395396 KiB | 680670 GiB | 680670 GiB |
|       from small pool |   7097 KiB |  18291 KiB |  15137 GiB |  15137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7677    |  175316 K  |  175313 K  |
|       from large pool |      79    |     423    |  119810 K  |  119809 K  |
|       from small pool |    2875    |    7597    |   55506 K  |   55503 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7677    |  175316 K  |  175313 K  |
|       from large pool |      79    |     423    |  119810 K  |  119809 K  |
|       from small pool |    2875    |    7597    |   55506 K  |   55503 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     204    |     381    |     181    |
|       from large pool |     181    |     183    |     353    |     172    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3621    |  120814 K  |  120814 K  |
|       from large pool |      11    |     185    |   92474 K  |   92474 K  |
|       from small pool |      22    |    3610    |   28339 K  |   28339 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1338 TiB |   1338 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1324 TiB |   1324 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1338 TiB |   1338 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1324 TiB |   1324 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1338 TiB |   1338 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1324 TiB |   1324 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   4966 MiB |   9662 MiB |   9432 MiB |
|       from large pool | 210944 KiB |   4924 MiB |   9606 MiB |   9400 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 396512 KiB | 695807 GiB | 695807 GiB |
|       from large pool |  30464 KiB | 395396 KiB | 680670 GiB | 680670 GiB |
|       from small pool |      0 KiB |  21453 KiB |  15137 GiB |  15137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7677    |  175316 K  |  175316 K  |
|       from large pool |       2    |     423    |  119810 K  |  119810 K  |
|       from small pool |       0    |    7597    |   55506 K  |   55506 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7677    |  175316 K  |  175316 K  |
|       from large pool |       2    |     423    |  119810 K  |  119810 K  |
|       from small pool |       0    |    7597    |   55506 K  |   55506 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     204    |     381    |     359    |
|       from large pool |      10    |     183    |     353    |     343    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3621    |  120815 K  |  120815 K  |
|       from large pool |       3    |     185    |   92474 K  |   92474 K  |
|       from small pool |       0    |    3610    |   28341 K  |   28341 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1338 TiB |   1338 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1324 TiB |   1324 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1338 TiB |   1338 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1324 TiB |   1324 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1338 TiB |   1338 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1324 TiB |   1324 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   4966 MiB |   9662 MiB |   9432 MiB |
|       from large pool | 210944 KiB |   4924 MiB |   9606 MiB |   9400 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 396512 KiB | 695807 GiB | 695807 GiB |
|       from large pool |  30464 KiB | 395396 KiB | 680670 GiB | 680670 GiB |
|       from small pool |      0 KiB |  21453 KiB |  15137 GiB |  15137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7677    |  175316 K  |  175316 K  |
|       from large pool |       2    |     423    |  119810 K  |  119810 K  |
|       from small pool |       0    |    7597    |   55506 K  |   55506 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7677    |  175316 K  |  175316 K  |
|       from large pool |       2    |     423    |  119810 K  |  119810 K  |
|       from small pool |       0    |    7597    |   55506 K  |   55506 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     204    |     381    |     359    |
|       from large pool |      10    |     183    |     353    |     343    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3621    |  120815 K  |  120815 K  |
|       from large pool |       3    |     185    |   92474 K  |   92474 K  |
|       from small pool |       0    |    3610    |   28341 K  |   28341 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_07_42_41_seed_2_23919991

 Experiment start at: 2024-08-02 07:42:41.814413
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9486313, 'precision': 0.9502314, 'recall': 0.9486385, 'specificity': 0.9486385, 'f1': 0.9485862, 'auroc': 0.9867344, 'binary_precision': 0.9771318, 'binary_recall': 0.9187901, 'binary_specificity': 0.9784869, 'binary_f1_score': 0.94706327}
confusion matrix:
       0      1
0  28518    627
1   2368  26791
---- Validation: 
scalar performance:
{'acc': 0.9394876, 'precision': 0.6098532, 'recall': 0.6828562, 'specificity': 0.6828562, 'f1': 0.6352918, 'auroc': 0.8418712, 'binary_precision': 0.23976608, 'binary_recall': 0.40863788, 'binary_specificity': 0.95707446, 'binary_f1_score': 0.3022113}
confusion matrix:
       0    1
0  17391  780
1    356  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9336432, 'precision': 0.648531, 'recall': 0.7731569, 'specificity': 0.7731569, 'f1': 0.68838483, 'auroc': 0.8720621, 'binary_precision': 0.31385282, 'binary_recall': 0.59917355, 'binary_specificity': 0.9471402, 'binary_f1_score': 0.41193184}
confusion matrix:
      0    1
0  5680  317
1    97  145
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 08:25:40.856584,epoch time: 0:42:59.042171,used: 0:42:59.042171,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_07_42_41_seed_2_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9623525, 'precision': 0.9633107, 'recall': 0.962358, 'specificity': 0.962358, 'f1': 0.9623333, 'auroc': 0.99290633, 'binary_precision': 0.9844412, 'binary_recall': 0.9395727, 'binary_specificity': 0.98514324, 'binary_f1_score': 0.96148384}
confusion matrix:
       0      1
0  28712    433
1   1762  27397
---- Validation: 
scalar performance:
{'acc': 0.94081926, 'precision': 0.6301415, 'recall': 0.7389544, 'specificity': 0.7389544, 'f1': 0.6654159, 'auroc': 0.8679647, 'binary_precision': 0.2765584, 'binary_recall': 0.5232558, 'binary_specificity': 0.954653, 'binary_f1_score': 0.36186102}
confusion matrix:
       0    1
0  17347  824
1    287  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918737, 'precision': 0.6371896, 'recall': 0.82885075, 'specificity': 0.82885075, 'f1': 0.6837535, 'auroc': 0.9037212, 'binary_precision': 0.28594506, 'binary_recall': 0.73140496, 'binary_specificity': 0.9262965, 'binary_f1_score': 0.41114983}
confusion matrix:
      0    1
0  5555  442
1    65  177
better model found
persisted
after epoch: 2,now: 2024-08-02 09:08:10.372068,epoch time: 0:42:29.515484,used: 1:25:28.557655,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_07_42_41_seed_2_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9696247, 'precision': 0.97009766, 'recall': 0.9696275, 'specificity': 0.9696275, 'f1': 0.96961725, 'auroc': 0.9948286, 'binary_precision': 0.9850514, 'binary_recall': 0.95373327, 'binary_specificity': 0.9855217, 'binary_f1_score': 0.96913946}
confusion matrix:
       0      1
0  28725    422
1   1349  27808
---- Validation: 
scalar performance:
{'acc': 0.9276621, 'precision': 0.61694896, 'recall': 0.7763255, 'specificity': 0.7763255, 'f1': 0.6572036, 'auroc': 0.87377584, 'binary_precision': 0.24732621, 'binary_recall': 0.61461794, 'binary_specificity': 0.9380331, 'binary_f1_score': 0.3527169}
confusion matrix:
       0     1
0  17045  1126
1    232   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90751725, 'precision': 0.62816036, 'recall': 0.84879005, 'specificity': 0.84879005, 'f1': 0.6734958, 'auroc': 0.9128083, 'binary_precision': 0.26573426, 'binary_recall': 0.78512394, 'binary_specificity': 0.9124562, 'binary_f1_score': 0.39707416}
confusion matrix:
      0    1
0  5472  525
1    52  190
early stop counter: 1
val acc:0.9276620745658875, best validation acc: 0.940819263458252, corresponding to test acc:                         0.91873699426651 / 0.9336432218551636
after epoch: 3,now: 2024-08-02 09:51:15.770823,epoch time: 0:43:05.398755,used: 2:08:33.956410,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_07_42_41_seed_2_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97149426, 'precision': 0.9721198, 'recall': 0.971498, 'specificity': 0.971498, 'f1': 0.97148496, 'auroc': 0.9958698, 'binary_precision': 0.9893572, 'binary_recall': 0.9532547, 'binary_specificity': 0.9897413, 'binary_f1_score': 0.97097045}
confusion matrix:
       0      1
0  28847    299
1   1363  27795
---- Validation: 
scalar performance:
{'acc': 0.9335748, 'precision': 0.62431204, 'recall': 0.7689402, 'specificity': 0.7689402, 'f1': 0.66452855, 'auroc': 0.88004285, 'binary_precision': 0.26269317, 'binary_recall': 0.59302324, 'binary_specificity': 0.9448572, 'binary_f1_score': 0.36409995}
confusion matrix:
       0     1
0  17169  1002
1    245   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91665334, 'precision': 0.63595885, 'recall': 0.83569777, 'specificity': 0.83569777, 'f1': 0.6827939, 'auroc': 0.9127574, 'binary_precision': 0.2828125, 'binary_recall': 0.74793386, 'binary_specificity': 0.92346174, 'binary_f1_score': 0.41043085}
confusion matrix:
      0    1
0  5538  459
1    61  181
early stop counter: 2
val acc:0.9335747957229614, best validation acc: 0.940819263458252, corresponding to test acc:                         0.91873699426651 / 0.9336432218551636
after epoch: 4,now: 2024-08-02 10:34:24.172078,epoch time: 0:43:08.401255,used: 2:51:42.357665,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_07_42_41_seed_2_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97559345, 'precision': 0.97587144, 'recall': 0.97559553, 'specificity': 0.97559553, 'f1': 0.97559, 'auroc': 0.99680907, 'binary_precision': 0.9874165, 'binary_recall': 0.9634736, 'binary_specificity': 0.98771745, 'binary_f1_score': 0.97529817}
confusion matrix:
       0      1
0  28789    358
1   1065  28092
---- Validation: 
scalar performance:
{'acc': 0.9270229, 'precision': 0.6224158, 'recall': 0.80329895, 'specificity': 0.80329895, 'f1': 0.6661235, 'auroc': 0.89295757, 'binary_precision': 0.25634518, 'binary_recall': 0.6710963, 'binary_specificity': 0.93550164, 'binary_f1_score': 0.37098256}
confusion matrix:
       0     1
0  16999  1172
1    198   404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90767753, 'precision': 0.626243, 'recall': 0.8389598, 'specificity': 0.8389598, 'f1': 0.6705863, 'auroc': 0.9144683, 'binary_precision': 0.2627841, 'binary_recall': 0.7644628, 'binary_specificity': 0.91345674, 'binary_f1_score': 0.39112052}
confusion matrix:
      0    1
0  5478  519
1    57  185
early stop counter: 3
val acc:0.9270228743553162, best validation acc: 0.940819263458252, corresponding to test acc:                         0.91873699426651 / 0.9336432218551636
after epoch: 5,now: 2024-08-02 11:17:23.812380,epoch time: 0:42:59.640302,used: 3:34:41.997967,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_07_42_41_seed_2_23919991
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 3:34:41.997967 at 2024-08-02 11:17:23.812380
persisted model performance metric: 

scalar performance:
{'acc': 0.918737, 'precision': 0.6371896, 'recall': 0.82885075, 'specificity': 0.82885075, 'f1': 0.6837535, 'auroc': 0.9037212, 'binary_precision': 0.28594506, 'binary_recall': 0.73140496, 'binary_specificity': 0.9262965, 'binary_f1_score': 0.41114983}
confusion matrix:
      0    1
0  5555  442
1    65  177
oracle model performance metric: 

scalar performance:
{'acc': 0.9336432, 'precision': 0.648531, 'recall': 0.7731569, 'specificity': 0.7731569, 'f1': 0.68838483, 'auroc': 0.8720621, 'binary_precision': 0.31385282, 'binary_recall': 0.59917355, 'binary_specificity': 0.9471402, 'binary_f1_score': 0.41193184}
confusion matrix:
      0    1
0  5680  317
1    97  145
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   4047 MiB |   1861 TiB |   1861 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1841 TiB |   1841 TiB |
|       from small pool |  17485 KiB |     37 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   4047 MiB |   1861 TiB |   1861 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1841 TiB |   1841 TiB |
|       from small pool |  17485 KiB |     37 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   4045 MiB |   1861 TiB |   1861 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1841 TiB |   1841 TiB |
|       from small pool |  16481 KiB |     36 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4944 MiB |   4966 MiB |  14376 MiB |   9432 MiB |
|       from large pool |   4906 MiB |   4924 MiB |  14306 MiB |   9400 MiB |
|       from small pool |     38 MiB |     42 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40872 KiB | 396512 KiB |    953 TiB |    953 TiB |
|       from large pool |  31733 KiB | 395396 KiB |    932 TiB |    932 TiB |
|       from small pool |   9139 KiB |  21453 KiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7763    |  243821 K  |  243818 K  |
|       from large pool |      79    |     423    |  166617 K  |  166617 K  |
|       from small pool |    2887    |    7683    |   77204 K  |   77201 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7763    |  243821 K  |  243818 K  |
|       from large pool |      79    |     423    |  166617 K  |  166617 K  |
|       from small pool |    2887    |    7683    |   77204 K  |   77201 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     199    |     204    |     558    |     359    |
|       from large pool |     180    |     183    |     523    |     343    |
|       from small pool |      19    |      21    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3663    |  165713 K  |  165713 K  |
|       from large pool |      11    |     185    |  127141 K  |  127141 K  |
|       from small pool |      23    |    3652    |   38571 K  |   38571 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1861 TiB |   1861 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1841 TiB |   1841 TiB |
|       from small pool |      0 KiB |     37 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1861 TiB |   1861 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1841 TiB |   1841 TiB |
|       from small pool |      0 KiB |     37 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1861 TiB |   1861 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1841 TiB |   1841 TiB |
|       from small pool |      0 KiB |     36 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   4966 MiB |  14376 MiB |  14144 MiB |
|       from large pool | 210944 KiB |   4924 MiB |  14306 MiB |  14100 MiB |
|       from small pool |  26624 KiB |     42 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 396512 KiB |    953 TiB |    953 TiB |
|       from large pool |  30464 KiB | 395396 KiB |    932 TiB |    932 TiB |
|       from small pool |      0 KiB |  23495 KiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7763    |  243821 K  |  243821 K  |
|       from large pool |       2    |     423    |  166617 K  |  166617 K  |
|       from small pool |       0    |    7683    |   77204 K  |   77204 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7763    |  243821 K  |  243821 K  |
|       from large pool |       2    |     423    |  166617 K  |  166617 K  |
|       from small pool |       0    |    7683    |   77204 K  |   77204 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     204    |     558    |     535    |
|       from large pool |      10    |     183    |     523    |     513    |
|       from small pool |      13    |      21    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3663    |  165714 K  |  165714 K  |
|       from large pool |       3    |     185    |  127141 K  |  127141 K  |
|       from small pool |       0    |    3652    |   38572 K  |   38572 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 11:18:49 2024]
Finished job 0.
1 of 1 steps (100%) done
