Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 05:44:59 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980

 Experiment start at: 2024-08-01 05:54:30.563438
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94808227, 'precision': 0.9491816, 'recall': 0.948104, 'specificity': 0.948104, 'f1': 0.9480522, 'auroc': 0.9855094, 'binary_precision': 0.97162235, 'binary_recall': 0.92321897, 'binary_specificity': 0.972989, 'binary_f1_score': 0.94680244}
confusion matrix:
       0      1
0  27881    774
1   2204  26501
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8996381, 'precision': 0.594659, 'recall': 0.7830291, 'specificity': 0.7830291, 'f1': 0.62777436, 'auroc': 0.8807057, 'binary_precision': 0.20248923, 'binary_recall': 0.6578538, 'binary_specificity': 0.9082043, 'binary_f1_score': 0.30966327}
confusion matrix:
       0     1
0  16483  1666
1    220   423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8879834, 'precision': 0.61736906, 'recall': 0.8481051, 'specificity': 0.8481051, 'f1': 0.65657365, 'auroc': 0.912853, 'binary_precision': 0.24418604, 'binary_recall': 0.8045977, 'binary_specificity': 0.89161247, 'binary_f1_score': 0.37466547}
confusion matrix:
      0    1
0  5347  650
1    51  210
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 06:41:52.892374,epoch time: 0:47:22.328936,used: 0:47:22.328936,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9602336, 'precision': 0.96114767, 'recall': 0.9602508, 'specificity': 0.9602508, 'f1': 0.9602149, 'auroc': 0.9915329, 'binary_precision': 0.98187125, 'binary_recall': 0.93784404, 'binary_specificity': 0.98265755, 'binary_f1_score': 0.9593528}
confusion matrix:
       0      1
0  28161    497
1   1784  26918
---- Validation: 
scalar performance:
{'acc': 0.9107067, 'precision': 0.6018266, 'recall': 0.7715081, 'specificity': 0.7715081, 'f1': 0.63752145, 'auroc': 0.8803867, 'binary_precision': 0.21798365, 'binary_recall': 0.62208396, 'binary_specificity': 0.9209323, 'binary_f1_score': 0.322841}
confusion matrix:
       0     1
0  16714  1435
1    243   400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8906999, 'precision': 0.62023354, 'recall': 0.85135484, 'specificity': 0.85135484, 'f1': 0.6608039, 'auroc': 0.91951084, 'binary_precision': 0.24970414, 'binary_recall': 0.8084291, 'binary_specificity': 0.8942805, 'binary_f1_score': 0.38155517}
confusion matrix:
      0    1
0  5363  634
1    50  211
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 07:28:41.675222,epoch time: 0:46:48.782848,used: 1:34:11.111784,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97053695, 'precision': 0.97071743, 'recall': 0.9705446, 'specificity': 0.9705446, 'f1': 0.97053444, 'auroc': 0.9946145, 'binary_precision': 0.980128, 'binary_recall': 0.9605951, 'binary_specificity': 0.9804941, 'binary_f1_score': 0.9702632}
confusion matrix:
       0      1
0  28099    559
1   1131  27571
---- Validation: 
scalar performance:
{'acc': 0.9047467, 'precision': 0.5999196, 'recall': 0.787174, 'specificity': 0.787174, 'f1': 0.63537246, 'auroc': 0.8848244, 'binary_precision': 0.21281923, 'binary_recall': 0.66096425, 'binary_specificity': 0.91338366, 'binary_f1_score': 0.32196972}
confusion matrix:
       0     1
0  16577  1572
1    218   425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88670504, 'precision': 0.61623675, 'recall': 0.8474381, 'specificity': 0.8474381, 'f1': 0.6548734, 'auroc': 0.9185059, 'binary_precision': 0.24193548, 'binary_recall': 0.8045977, 'binary_specificity': 0.89027846, 'binary_f1_score': 0.37201065}
confusion matrix:
      0    1
0  5339  658
1    51  210
early stop counter: 1
val acc:0.9047467112541199, best validation acc: 0.9107066988945007, corresponding to test acc:                         0.8906999230384827 / 0.8906999230384827
after epoch: 3,now: 2024-08-01 08:15:00.917219,epoch time: 0:46:19.241997,used: 2:20:30.353781,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9752092, 'precision': 0.97546864, 'recall': 0.9752179, 'specificity': 0.9752179, 'f1': 0.97520614, 'auroc': 0.9958391, 'binary_precision': 0.9867599, 'binary_recall': 0.96338105, 'binary_specificity': 0.9870547, 'binary_f1_score': 0.97493035}
confusion matrix:
       0      1
0  28288    371
1   1051  27650
---- Validation: 
scalar performance:
{'acc': 0.91746485, 'precision': 0.60737157, 'recall': 0.76450616, 'specificity': 0.76450616, 'f1': 0.6441713, 'auroc': 0.8838773, 'binary_precision': 0.2297619, 'binary_recall': 0.60031104, 'binary_specificity': 0.9287013, 'binary_f1_score': 0.3323289}
confusion matrix:
       0     1
0  16855  1294
1    257   386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91626716, 'precision': 0.6453783, 'recall': 0.84453917, 'specificity': 0.84453917, 'f1': 0.69384843, 'auroc': 0.9136343, 'binary_precision': 0.30165914, 'binary_recall': 0.7662835, 'binary_specificity': 0.92279476, 'binary_f1_score': 0.43290046}
confusion matrix:
      0    1
0  5534  463
1    61  200
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-01 09:01:09.702406,epoch time: 0:46:08.785187,used: 3:06:39.138968,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97625524, 'precision': 0.97648436, 'recall': 0.9762642, 'specificity': 0.9762642, 'f1': 0.9762527, 'auroc': 0.99660385, 'binary_precision': 0.98713607, 'binary_recall': 0.9651256, 'binary_specificity': 0.98740274, 'binary_f1_score': 0.9760068}
confusion matrix:
       0      1
0  28296    361
1   1001  27702
---- Validation: 
scalar performance:
{'acc': 0.92241377, 'precision': 0.6149011, 'recall': 0.7700685, 'specificity': 0.7700685, 'f1': 0.653638, 'auroc': 0.88714707, 'binary_precision': 0.24451411, 'binary_recall': 0.60653186, 'binary_specificity': 0.93360513, 'binary_f1_score': 0.34852546}
confusion matrix:
       0     1
0  16944  1205
1    253   390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92729306, 'precision': 0.6615056, 'recall': 0.8429626, 'specificity': 0.8429626, 'f1': 0.7119088, 'auroc': 0.90925145, 'binary_precision': 0.334471, 'binary_recall': 0.75095785, 'binary_specificity': 0.93496746, 'binary_f1_score': 0.46280992}
confusion matrix:
      0    1
0  5607  390
1    65  196
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 09:46:51.226527,epoch time: 0:45:41.524121,used: 3:52:20.663089,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98036957, 'precision': 0.98044026, 'recall': 0.98037416, 'specificity': 0.98037416, 'f1': 0.980369, 'auroc': 0.99733675, 'binary_precision': 0.9864517, 'binary_recall': 0.97414726, 'binary_specificity': 0.98660105, 'binary_f1_score': 0.98026085}
confusion matrix:
       0      1
0  28275    384
1    742  27959
---- Validation: 
scalar performance:
{'acc': 0.925447, 'precision': 0.6140156, 'recall': 0.7506373, 'specificity': 0.7506373, 'f1': 0.65059775, 'auroc': 0.8851615, 'binary_precision': 0.24426451, 'binary_recall': 0.562986, 'binary_specificity': 0.9382886, 'binary_f1_score': 0.34070593}
confusion matrix:
       0     1
0  17029  1120
1    281   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9364014, 'precision': 0.67653644, 'recall': 0.831224, 'specificity': 0.831224, 'f1': 0.72528315, 'auroc': 0.90571594, 'binary_precision': 0.36594912, 'binary_recall': 0.71647507, 'binary_specificity': 0.945973, 'binary_f1_score': 0.48445594}
confusion matrix:
      0    1
0  5673  324
1    74  187
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-01 10:32:31.221907,epoch time: 0:45:39.995380,used: 4:38:00.658469,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9795153, 'precision': 0.9798844, 'recall': 0.9795251, 'specificity': 0.9795251, 'f1': 0.9795117, 'auroc': 0.9975083, 'binary_precision': 0.99336797, 'binary_recall': 0.96550524, 'binary_specificity': 0.993545, 'binary_f1_score': 0.9792384}
confusion matrix:
       0      1
0  28475    185
1    990  27710
---- Validation: 
scalar performance:
{'acc': 0.9371009, 'precision': 0.6251997, 'recall': 0.7206681, 'specificity': 0.7206681, 'f1': 0.65696025, 'auroc': 0.8836914, 'binary_precision': 0.26906598, 'binary_recall': 0.48833594, 'binary_specificity': 0.9530002, 'binary_f1_score': 0.3469613}
confusion matrix:
       0    1
0  17296  853
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.7121951, 'recall': 0.8184054, 'specificity': 0.8184054, 'f1': 0.7527853, 'auroc': 0.9026414, 'binary_precision': 0.43890274, 'binary_recall': 0.6743295, 'binary_specificity': 0.96248126, 'binary_f1_score': 0.53172207}
confusion matrix:
      0    1
0  5772  225
1    85  176
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-01 11:17:47.909992,epoch time: 0:45:16.688085,used: 5:23:17.346554,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9815725, 'precision': 0.9816918, 'recall': 0.9815781, 'specificity': 0.9815781, 'f1': 0.98157156, 'auroc': 0.9975786, 'binary_precision': 0.98944724, 'binary_recall': 0.973554, 'binary_specificity': 0.9896022, 'binary_f1_score': 0.98143625}
confusion matrix:
       0      1
0  28362    298
1    759  27941
---- Validation: 
scalar performance:
{'acc': 0.9244359, 'precision': 0.61226004, 'recall': 0.7493638, 'specificity': 0.7493638, 'f1': 0.64850134, 'auroc': 0.8826839, 'binary_precision': 0.24082722, 'binary_recall': 0.5614308, 'binary_specificity': 0.9372968, 'binary_f1_score': 0.33706817}
confusion matrix:
       0     1
0  17011  1138
1    282   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935123, 'precision': 0.6729949, 'recall': 0.8268924, 'specificity': 0.8268924, 'f1': 0.7211107, 'auroc': 0.9049499, 'binary_precision': 0.3592233, 'binary_recall': 0.70881224, 'binary_specificity': 0.9449725, 'binary_f1_score': 0.47680408}
confusion matrix:
      0    1
0  5667  330
1    76  185
early stop counter: 1
val acc:0.9244359135627747, best validation acc: 0.937100887298584, corresponding to test acc:                         0.9504634141921997 / 0.9504634141921997
after epoch: 8,now: 2024-08-01 12:02:38.671576,epoch time: 0:44:50.761584,used: 6:08:08.108138,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9834902, 'precision': 0.9836065, 'recall': 0.98349714, 'specificity': 0.98349714, 'f1': 0.9834894, 'auroc': 0.9979713, 'binary_precision': 0.9913268, 'binary_recall': 0.97554433, 'binary_specificity': 0.99145, 'binary_f1_score': 0.9833723}
confusion matrix:
       0      1
0  28410    245
1    702  28003
---- Validation: 
scalar performance:
{'acc': 0.9311409, 'precision': 0.6211339, 'recall': 0.74458444, 'specificity': 0.74458444, 'f1': 0.6573473, 'auroc': 0.88768613, 'binary_precision': 0.25906736, 'binary_recall': 0.5443235, 'binary_specificity': 0.94484544, 'binary_f1_score': 0.35105318}
confusion matrix:
       0     1
0  17148  1001
1    293   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498242, 'precision': 0.71146286, 'recall': 0.8290659, 'specificity': 0.8290659, 'f1': 0.7551742, 'auroc': 0.90945876, 'binary_precision': 0.43645084, 'binary_recall': 0.697318, 'binary_specificity': 0.96081376, 'binary_f1_score': 0.5368732}
confusion matrix:
      0    1
0  5762  235
1    79  182
early stop counter: 2
val acc:0.9311408996582031, best validation acc: 0.937100887298584, corresponding to test acc:                         0.9504634141921997 / 0.9504634141921997
after epoch: 9,now: 2024-08-01 12:46:47.091082,epoch time: 0:44:08.419506,used: 6:52:16.527644,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98425734, 'precision': 0.9843154, 'recall': 0.98426163, 'specificity': 0.98426163, 'f1': 0.984257, 'auroc': 0.99818254, 'binary_precision': 0.9898157, 'binary_recall': 0.9786078, 'binary_specificity': 0.98991555, 'binary_f1_score': 0.98417985}
confusion matrix:
       0      1
0  28369    289
1    614  28088
---- Validation: 
scalar performance:
{'acc': 0.93545127, 'precision': 0.63204443, 'recall': 0.7565667, 'specificity': 0.7565667, 'f1': 0.67019486, 'auroc': 0.89610565, 'binary_precision': 0.2800926, 'binary_recall': 0.5645412, 'binary_specificity': 0.9485922, 'binary_f1_score': 0.3744198}
confusion matrix:
       0    1
0  17216  933
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9442314, 'precision': 0.6945241, 'recall': 0.8261478, 'specificity': 0.8261478, 'f1': 0.7404751, 'auroc': 0.9075539, 'binary_precision': 0.40265486, 'binary_recall': 0.697318, 'binary_specificity': 0.9549775, 'binary_f1_score': 0.51051897}
confusion matrix:
      0    1
0  5727  270
1    79  182
early stop counter: 3
val acc:0.9354512691497803, best validation acc: 0.937100887298584, corresponding to test acc:                         0.9504634141921997 / 0.9504634141921997
after epoch: 10,now: 2024-08-01 13:32:25.966061,epoch time: 0:45:38.874979,used: 7:37:55.402623,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_54_30_seed_0_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 7:37:55.402623 at 2024-08-01 13:32:25.966061
persisted model performance metric: 

scalar performance:
{'acc': 0.9504634, 'precision': 0.7121951, 'recall': 0.8184054, 'specificity': 0.8184054, 'f1': 0.7527853, 'auroc': 0.9026414, 'binary_precision': 0.43890274, 'binary_recall': 0.6743295, 'binary_specificity': 0.96248126, 'binary_f1_score': 0.53172207}
confusion matrix:
      0    1
0  5772  225
1    85  176
oracle model performance metric: 

scalar performance:
{'acc': 0.9504634, 'precision': 0.7121951, 'recall': 0.8184054, 'specificity': 0.8184054, 'f1': 0.7527853, 'auroc': 0.9026414, 'binary_precision': 0.43890274, 'binary_recall': 0.6743295, 'binary_specificity': 0.96248126, 'binary_f1_score': 0.53172207}
confusion matrix:
      0    1
0  5772  225
1    85  176
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   4047 MiB |   1027 TiB |   1027 TiB |
|       from large pool | 180662 KiB |   4027 MiB |   1015 TiB |   1015 TiB |
|       from small pool |  17491 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   4047 MiB |   1027 TiB |   1027 TiB |
|       from large pool | 180662 KiB |   4027 MiB |   1015 TiB |   1015 TiB |
|       from small pool |  17491 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   4045 MiB |   1027 TiB |   1027 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1015 TiB |   1015 TiB |
|       from small pool |  16482 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4966 MiB |   4966 MiB |   4966 MiB |      0 B   |
|       from large pool |   4924 MiB |   4924 MiB |   4924 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  57847 KiB | 392988 KiB | 527541 GiB | 527541 GiB |
|       from large pool |  50762 KiB | 392048 KiB | 515962 GiB | 515962 GiB |
|       from small pool |   7085 KiB |   9888 KiB |  11579 GiB |  11579 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7645    |  134367 K  |  134364 K  |
|       from large pool |      79    |     423    |   91899 K  |   91899 K  |
|       from small pool |    2899    |    7565    |   42467 K  |   42464 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7645    |  134367 K  |  134364 K  |
|       from large pool |      79    |     423    |   91899 K  |   91899 K  |
|       from small pool |    2899    |    7565    |   42467 K  |   42464 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     204    |     204    |     204    |       0    |
|       from large pool |     183    |     183    |     183    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      29    |    3605    |   93401 K  |   93401 K  |
|       from large pool |      10    |     183    |   71826 K  |   71826 K  |
|       from small pool |      19    |    3595    |   21575 K  |   21575 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1027 TiB |   1027 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1027 TiB |   1027 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1027 TiB |   1027 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   4966 MiB |   4966 MiB |   4716 MiB |
|       from large pool | 231424 KiB |   4924 MiB |   4924 MiB |   4698 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB | 527542 GiB | 527541 GiB |
|       from large pool |  30464 KiB | 392048 KiB | 515962 GiB | 515962 GiB |
|       from small pool |      0 KiB |  18291 KiB |  11579 GiB |  11579 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7645    |  134367 K  |  134367 K  |
|       from large pool |       2    |     423    |   91899 K  |   91899 K  |
|       from small pool |       0    |    7565    |   42467 K  |   42467 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7645    |  134367 K  |  134367 K  |
|       from large pool |       2    |     423    |   91899 K  |   91899 K  |
|       from small pool |       0    |    7565    |   42467 K  |   42467 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     204    |     204    |     181    |
|       from large pool |      11    |     183    |     183    |     172    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3605    |   93402 K  |   93402 K  |
|       from large pool |       3    |     183    |   71826 K  |   71826 K  |
|       from small pool |       0    |    3595    |   21576 K  |   21576 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1027 TiB |   1027 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1027 TiB |   1027 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1027 TiB |   1027 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   4966 MiB |   4966 MiB |   4716 MiB |
|       from large pool | 231424 KiB |   4924 MiB |   4924 MiB |   4698 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB | 527542 GiB | 527541 GiB |
|       from large pool |  30464 KiB | 392048 KiB | 515962 GiB | 515962 GiB |
|       from small pool |      0 KiB |  18291 KiB |  11579 GiB |  11579 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7645    |  134367 K  |  134367 K  |
|       from large pool |       2    |     423    |   91899 K  |   91899 K  |
|       from small pool |       0    |    7565    |   42467 K  |   42467 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7645    |  134367 K  |  134367 K  |
|       from large pool |       2    |     423    |   91899 K  |   91899 K  |
|       from small pool |       0    |    7565    |   42467 K  |   42467 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     204    |     204    |     181    |
|       from large pool |      11    |     183    |     183    |     172    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3605    |   93402 K  |   93402 K  |
|       from large pool |       3    |     183    |   71826 K  |   71826 K  |
|       from small pool |       0    |    3595    |   21576 K  |   21576 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_43_08_seed_1_23919980

 Experiment start at: 2024-08-01 13:43:09.056280
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94775754, 'precision': 0.9488927, 'recall': 0.94777596, 'specificity': 0.94777596, 'f1': 0.947726, 'auroc': 0.9868046, 'binary_precision': 0.9716488, 'binary_recall': 0.9225086, 'binary_specificity': 0.9730434, 'binary_f1_score': 0.9464413}
confusion matrix:
       0      1
0  28011    776
1   2234  26595
---- Validation: 
scalar performance:
{'acc': 0.9304162, 'precision': 0.6364713, 'recall': 0.7872411, 'specificity': 0.7872411, 'f1': 0.67913043, 'auroc': 0.8830799, 'binary_precision': 0.28725556, 'binary_recall': 0.6329866, 'binary_specificity': 0.94149554, 'binary_f1_score': 0.39517623}
confusion matrix:
       0     1
0  17010  1057
1    247   426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9273284, 'precision': 0.6616656, 'recall': 0.8407022, 'specificity': 0.8407022, 'f1': 0.71174264, 'auroc': 0.91916287, 'binary_precision': 0.33506045, 'binary_recall': 0.74615383, 'binary_specificity': 0.9352506, 'binary_f1_score': 0.4624553}
confusion matrix:
      0    1
0  5561  385
1    66  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 14:28:08.131151,epoch time: 0:44:59.074871,used: 0:44:59.074871,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_43_08_seed_1_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9611219, 'precision': 0.96190524, 'recall': 0.96113706, 'specificity': 0.96113706, 'f1': 0.9611063, 'auroc': 0.99295425, 'binary_precision': 0.98110956, 'binary_recall': 0.9404072, 'binary_specificity': 0.98186684, 'binary_f1_score': 0.9603273}
confusion matrix:
       0      1
0  28265    522
1   1718  27111
---- Validation: 
scalar performance:
{'acc': 0.92427963, 'precision': 0.63470054, 'recall': 0.82125235, 'specificity': 0.82125235, 'f1': 0.6810524, 'auroc': 0.8955076, 'binary_precision': 0.28084606, 'binary_recall': 0.7102526, 'binary_specificity': 0.93225217, 'binary_f1_score': 0.40252632}
confusion matrix:
       0     1
0  16843  1224
1    195   478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89945215, 'precision': 0.63085276, 'recall': 0.86293435, 'specificity': 0.86293435, 'f1': 0.67595726, 'auroc': 0.928839, 'binary_precision': 0.270202, 'binary_recall': 0.8230769, 'binary_specificity': 0.9027918, 'binary_f1_score': 0.4068441}
confusion matrix:
      0    1
0  5368  578
1    46  214
early stop counter: 1
val acc:0.9242796301841736, best validation acc: 0.9304162263870239, corresponding to test acc:                         0.9273284077644348 / 0.9273284077644348
after epoch: 2,now: 2024-08-01 15:13:29.426284,epoch time: 0:45:21.295133,used: 1:30:20.370004,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_43_08_seed_1_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96920997, 'precision': 0.96934825, 'recall': 0.969216, 'specificity': 0.969216, 'f1': 0.96920794, 'auroc': 0.9948417, 'binary_precision': 0.97758085, 'binary_recall': 0.9604898, 'binary_specificity': 0.97794217, 'binary_f1_score': 0.96896}
confusion matrix:
       0      1
0  28153    635
1   1139  27689
---- Validation: 
scalar performance:
{'acc': 0.90384203, 'precision': 0.6155532, 'recall': 0.8421247, 'specificity': 0.8421247, 'f1': 0.6574004, 'auroc': 0.899389, 'binary_precision': 0.24022089, 'binary_recall': 0.7756315, 'binary_specificity': 0.9086179, 'binary_f1_score': 0.36683065}
confusion matrix:
       0     1
0  16416  1651
1    151   522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8569127, 'precision': 0.60058045, 'recall': 0.8591244, 'specificity': 0.8591244, 'f1': 0.627578, 'auroc': 0.9327777, 'binary_precision': 0.20817845, 'binary_recall': 0.86153847, 'binary_specificity': 0.8567104, 'binary_f1_score': 0.33532935}
confusion matrix:
      0    1
0  5094  852
1    36  224
early stop counter: 2
val acc:0.903842031955719, best validation acc: 0.9304162263870239, corresponding to test acc:                         0.9273284077644348 / 0.9273284077644348
after epoch: 3,now: 2024-08-01 15:58:40.334222,epoch time: 0:45:10.907938,used: 2:15:31.277942,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_43_08_seed_1_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9715704, 'precision': 0.9718368, 'recall': 0.9715787, 'specificity': 0.9715787, 'f1': 0.97156674, 'auroc': 0.9960964, 'binary_precision': 0.98322314, 'binary_recall': 0.95955324, 'binary_specificity': 0.98360425, 'binary_f1_score': 0.971244}
confusion matrix:
       0      1
0  28316    472
1   1166  27662
---- Validation: 
scalar performance:
{'acc': 0.9035219, 'precision': 0.61371845, 'recall': 0.83480597, 'specificity': 0.83480597, 'f1': 0.65470004, 'auroc': 0.8970663, 'binary_precision': 0.23714682, 'binary_recall': 0.76077265, 'binary_specificity': 0.90883934, 'binary_f1_score': 0.36158192}
confusion matrix:
       0     1
0  16420  1647
1    161   512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8598131, 'precision': 0.6030982, 'recall': 0.864316, 'specificity': 0.864316, 'f1': 0.6317286, 'auroc': 0.9289613, 'binary_precision': 0.21280603, 'binary_recall': 0.86923075, 'binary_specificity': 0.8594013, 'binary_f1_score': 0.34190622}
confusion matrix:
      0    1
0  5110  836
1    34  226
early stop counter: 3
val acc:0.9035218954086304, best validation acc: 0.9304162263870239, corresponding to test acc:                         0.9273284077644348 / 0.9273284077644348
after epoch: 4,now: 2024-08-01 16:43:44.670457,epoch time: 0:45:04.336235,used: 3:00:35.614177,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_13_43_08_seed_1_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 3:00:35.614177 at 2024-08-01 16:43:44.670457
persisted model performance metric: 

scalar performance:
{'acc': 0.9273284, 'precision': 0.6616656, 'recall': 0.8407022, 'specificity': 0.8407022, 'f1': 0.71174264, 'auroc': 0.91916287, 'binary_precision': 0.33506045, 'binary_recall': 0.74615383, 'binary_specificity': 0.9352506, 'binary_f1_score': 0.4624553}
confusion matrix:
      0    1
0  5561  385
1    66  194
oracle model performance metric: 

scalar performance:
{'acc': 0.9273284, 'precision': 0.6616656, 'recall': 0.8407022, 'specificity': 0.8407022, 'f1': 0.71174264, 'auroc': 0.91916287, 'binary_precision': 0.33506045, 'binary_recall': 0.74615383, 'binary_specificity': 0.9352506, 'binary_f1_score': 0.4624553}
confusion matrix:
      0    1
0  5561  385
1    66  194
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   4047 MiB |   1441 TiB |   1441 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1425 TiB |   1425 TiB |
|       from small pool |  17479 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   4047 MiB |   1441 TiB |   1441 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1425 TiB |   1425 TiB |
|       from small pool |  17479 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   4045 MiB |   1441 TiB |   1441 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1425 TiB |   1425 TiB |
|       from small pool |  16480 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4946 MiB |   4966 MiB |   9662 MiB |   4716 MiB |
|       from large pool |   4908 MiB |   4924 MiB |   9606 MiB |   4698 MiB |
|       from small pool |     38 MiB |     42 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 396512 KiB | 748391 GiB | 748391 GiB |
|       from large pool |  31733 KiB | 395396 KiB | 732106 GiB | 732106 GiB |
|       from small pool |   7097 KiB |  18291 KiB |  16285 GiB |  16285 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7677    |  188690 K  |  188687 K  |
|       from large pool |      79    |     423    |  128972 K  |  128972 K  |
|       from small pool |    2875    |    7597    |   59717 K  |   59714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7677    |  188690 K  |  188687 K  |
|       from large pool |      79    |     423    |  128972 K  |  128972 K  |
|       from small pool |    2875    |    7597    |   59717 K  |   59714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     204    |     381    |     181    |
|       from large pool |     181    |     183    |     353    |     172    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3621    |  129628 K  |  129628 K  |
|       from large pool |      11    |     185    |   99639 K  |   99639 K  |
|       from small pool |      22    |    3610    |   29988 K  |   29988 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1441 TiB |   1441 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1425 TiB |   1425 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1441 TiB |   1441 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1425 TiB |   1425 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1441 TiB |   1441 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1425 TiB |   1425 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   4966 MiB |   9662 MiB |   9432 MiB |
|       from large pool | 210944 KiB |   4924 MiB |   9606 MiB |   9400 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 396512 KiB | 748392 GiB | 748392 GiB |
|       from large pool |  30464 KiB | 395396 KiB | 732106 GiB | 732106 GiB |
|       from small pool |      0 KiB |  21453 KiB |  16285 GiB |  16285 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7677    |  188690 K  |  188690 K  |
|       from large pool |       2    |     423    |  128972 K  |  128972 K  |
|       from small pool |       0    |    7597    |   59717 K  |   59717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7677    |  188690 K  |  188690 K  |
|       from large pool |       2    |     423    |  128972 K  |  128972 K  |
|       from small pool |       0    |    7597    |   59717 K  |   59717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     204    |     381    |     359    |
|       from large pool |      10    |     183    |     353    |     343    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3621    |  129629 K  |  129629 K  |
|       from large pool |       3    |     185    |   99639 K  |   99639 K  |
|       from small pool |       0    |    3610    |   29989 K  |   29989 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1441 TiB |   1441 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1425 TiB |   1425 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1441 TiB |   1441 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1425 TiB |   1425 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1441 TiB |   1441 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1425 TiB |   1425 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   4966 MiB |   9662 MiB |   9432 MiB |
|       from large pool | 210944 KiB |   4924 MiB |   9606 MiB |   9400 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 396512 KiB | 748392 GiB | 748392 GiB |
|       from large pool |  30464 KiB | 395396 KiB | 732106 GiB | 732106 GiB |
|       from small pool |      0 KiB |  21453 KiB |  16285 GiB |  16285 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7677    |  188690 K  |  188690 K  |
|       from large pool |       2    |     423    |  128972 K  |  128972 K  |
|       from small pool |       0    |    7597    |   59717 K  |   59717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7677    |  188690 K  |  188690 K  |
|       from large pool |       2    |     423    |  128972 K  |  128972 K  |
|       from small pool |       0    |    7597    |   59717 K  |   59717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     204    |     381    |     359    |
|       from large pool |      10    |     183    |     353    |     343    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3621    |  129629 K  |  129629 K  |
|       from large pool |       3    |     185    |   99639 K  |   99639 K  |
|       from small pool |       0    |    3610    |   29989 K  |   29989 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_16_54_23_seed_2_23919980

 Experiment start at: 2024-08-01 16:54:23.644811
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9535538, 'precision': 0.9544344, 'recall': 0.9535583, 'specificity': 0.9535583, 'f1': 0.9535316, 'auroc': 0.9883552, 'binary_precision': 0.9744905, 'binary_recall': 0.9315111, 'binary_specificity': 0.97560555, 'binary_f1_score': 0.95251626}
confusion matrix:
       0      1
0  28435    711
1   1997  27161
---- Validation: 
scalar performance:
{'acc': 0.9372503, 'precision': 0.61535364, 'recall': 0.7130194, 'specificity': 0.7130194, 'f1': 0.64659005, 'auroc': 0.84524286, 'binary_precision': 0.2486911, 'binary_recall': 0.47342193, 'binary_specificity': 0.9526168, 'binary_f1_score': 0.32608697}
confusion matrix:
       0    1
0  17310  861
1    317  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91601217, 'precision': 0.62561697, 'recall': 0.79372674, 'specificity': 0.79372674, 'f1': 0.6670533, 'auroc': 0.88157165, 'binary_precision': 0.26578072, 'binary_recall': 0.661157, 'binary_specificity': 0.9262965, 'binary_f1_score': 0.3791469}
confusion matrix:
      0    1
0  5555  442
1    82  160
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 17:39:38.461596,epoch time: 0:45:14.816785,used: 0:45:14.816785,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_16_54_23_seed_2_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96550834, 'precision': 0.96580344, 'recall': 0.96551144, 'specificity': 0.96551144, 'f1': 0.9655031, 'auroc': 0.99385405, 'binary_precision': 0.97758776, 'binary_recall': 0.9528791, 'binary_specificity': 0.97814375, 'binary_f1_score': 0.96507525}
confusion matrix:
       0      1
0  28508    637
1   1374  27785
---- Validation: 
scalar performance:
{'acc': 0.9253715, 'precision': 0.6140658, 'recall': 0.7775515, 'specificity': 0.7775515, 'f1': 0.6539421, 'auroc': 0.8721372, 'binary_precision': 0.24142395, 'binary_recall': 0.6196013, 'binary_specificity': 0.93550164, 'binary_f1_score': 0.34746155}
confusion matrix:
       0     1
0  16999  1172
1    229   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8802693, 'precision': 0.6053527, 'recall': 0.84849554, 'specificity': 0.84849554, 'f1': 0.63971037, 'auroc': 0.90898347, 'binary_precision': 0.21913236, 'binary_recall': 0.8140496, 'binary_specificity': 0.8829415, 'binary_f1_score': 0.34531116}
confusion matrix:
      0    1
0  5295  702
1    45  197
early stop counter: 1
val acc:0.925371527671814, best validation acc: 0.9372503161430359, corresponding to test acc:                         0.916012167930603 / 0.916012167930603
after epoch: 2,now: 2024-08-01 18:25:00.560938,epoch time: 0:45:22.099342,used: 1:30:36.916127,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_16_54_23_seed_2_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97121984, 'precision': 0.9714397, 'recall': 0.9712217, 'specificity': 0.9712217, 'f1': 0.97121656, 'auroc': 0.99531794, 'binary_precision': 0.9816652, 'binary_recall': 0.9603869, 'binary_specificity': 0.9820565, 'binary_f1_score': 0.9709094}
confusion matrix:
       0      1
0  28624    523
1   1155  28002
---- Validation: 
scalar performance:
{'acc': 0.94279015, 'precision': 0.6435405, 'recall': 0.77370054, 'specificity': 0.77370054, 'f1': 0.6846468, 'auroc': 0.88193786, 'binary_precision': 0.3010118, 'binary_recall': 0.59302324, 'binary_specificity': 0.95437783, 'binary_f1_score': 0.39932886}
confusion matrix:
       0    1
0  17342  829
1    245  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.911364, 'precision': 0.6311244, 'recall': 0.8428601, 'specificity': 0.8428601, 'f1': 0.67714787, 'auroc': 0.9126712, 'binary_precision': 0.27232796, 'binary_recall': 0.76859504, 'binary_specificity': 0.9171252, 'binary_f1_score': 0.40216216}
confusion matrix:
      0    1
0  5500  497
1    56  186
better model found
persisted
after epoch: 3,now: 2024-08-01 19:10:26.937251,epoch time: 0:45:26.376313,used: 2:16:03.292440,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_16_54_23_seed_2_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9751818, 'precision': 0.9755311, 'recall': 0.97518456, 'specificity': 0.97518456, 'f1': 0.97517735, 'auroc': 0.9965942, 'binary_precision': 0.9884717, 'binary_recall': 0.96158856, 'binary_specificity': 0.9887806, 'binary_f1_score': 0.9748448}
confusion matrix:
       0      1
0  28819    327
1   1120  28038
---- Validation: 
scalar performance:
{'acc': 0.9316039, 'precision': 0.61771476, 'recall': 0.7558764, 'specificity': 0.7558764, 'f1': 0.6557357, 'auroc': 0.8718461, 'binary_precision': 0.25036603, 'binary_recall': 0.5681063, 'binary_specificity': 0.9436465, 'binary_f1_score': 0.34756097}
confusion matrix:
       0     1
0  17147  1024
1    260   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89918256, 'precision': 0.61483735, 'recall': 0.82462716, 'specificity': 0.82462716, 'f1': 0.65462804, 'auroc': 0.9072112, 'binary_precision': 0.24096386, 'binary_recall': 0.74380165, 'binary_specificity': 0.9054527, 'binary_f1_score': 0.36400405}
confusion matrix:
      0    1
0  5430  567
1    62  180
early stop counter: 1
val acc:0.9316039085388184, best validation acc: 0.942790150642395, corresponding to test acc:                         0.9113640189170837 / 0.916012167930603
after epoch: 4,now: 2024-08-01 19:55:29.598558,epoch time: 0:45:02.661307,used: 3:01:05.953747,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_16_54_23_seed_2_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9769141, 'precision': 0.97722465, 'recall': 0.9769163, 'specificity': 0.9769163, 'f1': 0.9769104, 'auroc': 0.99683326, 'binary_precision': 0.98944074, 'binary_recall': 0.9641253, 'binary_specificity': 0.98970735, 'binary_f1_score': 0.97661895}
confusion matrix:
       0      1
0  28847    300
1   1046  28111
---- Validation: 
scalar performance:
{'acc': 0.9286209, 'precision': 0.618067, 'recall': 0.77521473, 'specificity': 0.77521473, 'f1': 0.6583747, 'auroc': 0.88932943, 'binary_precision': 0.24966079, 'binary_recall': 0.6112957, 'binary_specificity': 0.93913376, 'binary_f1_score': 0.35452792}
confusion matrix:
       0     1
0  17065  1106
1    234   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90206766, 'precision': 0.6165147, 'recall': 0.8201797, 'specificity': 0.8201797, 'f1': 0.6568845, 'auroc': 0.9124466, 'binary_precision': 0.24481328, 'binary_recall': 0.73140496, 'binary_specificity': 0.9089545, 'binary_f1_score': 0.36683938}
confusion matrix:
      0    1
0  5451  546
1    65  177
early stop counter: 2
val acc:0.9286208748817444, best validation acc: 0.942790150642395, corresponding to test acc:                         0.9113640189170837 / 0.916012167930603
after epoch: 5,now: 2024-08-01 20:40:25.190327,epoch time: 0:44:55.591769,used: 3:46:01.545516,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_16_54_23_seed_2_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9777031, 'precision': 0.9777401, 'recall': 0.97770417, 'specificity': 0.97770417, 'f1': 0.9777026, 'auroc': 0.99686813, 'binary_precision': 0.9820063, 'binary_recall': 0.9732501, 'binary_specificity': 0.9821582, 'binary_f1_score': 0.97760856}
confusion matrix:
       0      1
0  28625    520
1    780  28379
---- Validation: 
scalar performance:
{'acc': 0.9217493, 'precision': 0.6099204, 'recall': 0.77969563, 'specificity': 0.77969563, 'f1': 0.6490927, 'auroc': 0.88932276, 'binary_precision': 0.23290204, 'binary_recall': 0.627907, 'binary_specificity': 0.9314842, 'binary_f1_score': 0.3397753}
confusion matrix:
       0     1
0  16926  1245
1    224   378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8890848, 'precision': 0.6062637, 'recall': 0.82334006, 'specificity': 0.82334006, 'f1': 0.6420561, 'auroc': 0.9059764, 'binary_precision': 0.22358723, 'binary_recall': 0.75206614, 'binary_specificity': 0.894614, 'binary_f1_score': 0.34469697}
confusion matrix:
      0    1
0  5365  632
1    60  182
early stop counter: 3
val acc:0.9217492938041687, best validation acc: 0.942790150642395, corresponding to test acc:                         0.9113640189170837 / 0.916012167930603
after epoch: 6,now: 2024-08-01 21:25:54.501700,epoch time: 0:45:29.311373,used: 4:31:30.856889,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_16_54_23_seed_2_23919980
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 4:31:30.856889 at 2024-08-01 21:25:54.501700
persisted model performance metric: 

scalar performance:
{'acc': 0.911364, 'precision': 0.6311244, 'recall': 0.8428601, 'specificity': 0.8428601, 'f1': 0.67714787, 'auroc': 0.9126712, 'binary_precision': 0.27232796, 'binary_recall': 0.76859504, 'binary_specificity': 0.9171252, 'binary_f1_score': 0.40216216}
confusion matrix:
      0    1
0  5500  497
1    56  186
oracle model performance metric: 

scalar performance:
{'acc': 0.91601217, 'precision': 0.62561697, 'recall': 0.79372674, 'specificity': 0.79372674, 'f1': 0.6670533, 'auroc': 0.88157165, 'binary_precision': 0.26578072, 'binary_recall': 0.661157, 'binary_specificity': 0.9262965, 'binary_f1_score': 0.3791469}
confusion matrix:
      0    1
0  5555  442
1    82  160
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_2024-08-01_00-27-59/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   4047 MiB |   2068 TiB |   2068 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   2045 TiB |   2045 TiB |
|       from small pool |  17485 KiB |     37 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   4047 MiB |   2068 TiB |   2068 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   2045 TiB |   2045 TiB |
|       from small pool |  17485 KiB |     37 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   4045 MiB |   2068 TiB |   2068 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   2045 TiB |   2045 TiB |
|       from small pool |  16481 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4944 MiB |   4966 MiB |  14376 MiB |   9432 MiB |
|       from large pool |   4906 MiB |   4924 MiB |  14306 MiB |   9400 MiB |
|       from small pool |     38 MiB |     42 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38824 KiB | 396512 KiB |   1059 TiB |   1059 TiB |
|       from large pool |  31733 KiB | 395396 KiB |   1036 TiB |   1036 TiB |
|       from small pool |   7091 KiB |  21453 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7763    |  270770 K  |  270767 K  |
|       from large pool |      79    |     423    |  185086 K  |  185086 K  |
|       from small pool |    2887    |    7683    |   85683 K  |   85680 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7763    |  270770 K  |  270767 K  |
|       from large pool |      79    |     423    |  185086 K  |  185086 K  |
|       from small pool |    2887    |    7683    |   85683 K  |   85680 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     199    |     204    |     558    |     359    |
|       from large pool |     180    |     183    |     523    |     343    |
|       from small pool |      19    |      21    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3663    |  183928 K  |  183928 K  |
|       from large pool |      11    |     185    |  141203 K  |  141203 K  |
|       from small pool |      21    |    3652    |   42724 K  |   42724 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   2068 TiB |   2068 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   2045 TiB |   2045 TiB |
|       from small pool |      0 KiB |     37 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   2068 TiB |   2068 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   2045 TiB |   2045 TiB |
|       from small pool |      0 KiB |     37 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   2068 TiB |   2068 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   2045 TiB |   2045 TiB |
|       from small pool |      0 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   4966 MiB |  14376 MiB |  14146 MiB |
|       from large pool | 210944 KiB |   4924 MiB |  14306 MiB |  14100 MiB |
|       from small pool |  24576 KiB |     42 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 396512 KiB |   1059 TiB |   1059 TiB |
|       from large pool |  30464 KiB | 395396 KiB |   1036 TiB |   1036 TiB |
|       from small pool |      0 KiB |  21453 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7763    |  270770 K  |  270770 K  |
|       from large pool |       2    |     423    |  185086 K  |  185086 K  |
|       from small pool |       0    |    7683    |   85683 K  |   85683 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7763    |  270770 K  |  270770 K  |
|       from large pool |       2    |     423    |  185086 K  |  185086 K  |
|       from small pool |       0    |    7683    |   85683 K  |   85683 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     204    |     558    |     536    |
|       from large pool |      10    |     183    |     523    |     513    |
|       from small pool |      12    |      21    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3663    |  183929 K  |  183929 K  |
|       from large pool |       3    |     185    |  141203 K  |  141203 K  |
|       from small pool |       0    |    3652    |   42726 K  |   42726 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 21:27:23 2024]
Finished job 0.
1 of 1 steps (100%) done
