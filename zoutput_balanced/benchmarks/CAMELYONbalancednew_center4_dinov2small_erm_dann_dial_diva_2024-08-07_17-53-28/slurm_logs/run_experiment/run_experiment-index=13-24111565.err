Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Aug  7 20:57:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/13.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=13
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_21_03_04_seed_0_24111565

 Experiment start at: 2024-08-07 21:03:04.763674
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9511608, 'precision': 0.9531745, 'recall': 0.9511832, 'specificity': 0.9511832, 'f1': 0.9511081, 'auroc': 0.9862592, 'binary_precision': 0.9835511, 'binary_recall': 0.9177353, 'binary_specificity': 0.9846312, 'binary_f1_score': 0.949504}
confusion matrix:
       0      1
0  24922    389
1   2085  23260
---- Validation: 
scalar performance:
{'acc': 0.9210311, 'precision': 0.58980024, 'recall': 0.8044448, 'specificity': 0.8044448, 'f1': 0.62648267, 'auroc': 0.8917797, 'binary_precision': 0.18803987, 'binary_recall': 0.68192774, 'binary_specificity': 0.9269619, 'binary_f1_score': 0.29479167}
confusion matrix:
       0     1
0  15509  1222
1    132   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84615386, 'precision': 0.62907815, 'recall': 0.7729367, 'specificity': 0.7729367, 'f1': 0.658425, 'auroc': 0.8621155, 'binary_precision': 0.28741866, 'binary_recall': 0.6865285, 'binary_specificity': 0.8593449, 'binary_f1_score': 0.40519878}
confusion matrix:
      0     1
0  8028  1314
1   242   530
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 21:49:28.134505,epoch time: 0:46:23.370831,used: 0:46:23.370831,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_21_03_04_seed_0_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9652361, 'precision': 0.9658657, 'recall': 0.9652486, 'specificity': 0.9652486, 'f1': 0.96522504, 'auroc': 0.99217814, 'binary_precision': 0.9831599, 'binary_recall': 0.9467351, 'binary_specificity': 0.983762, 'binary_f1_score': 0.9646038}
confusion matrix:
       0      1
0  24900    411
1   1350  23995
---- Validation: 
scalar performance:
{'acc': 0.91059136, 'precision': 0.5868558, 'recall': 0.8366934, 'specificity': 0.8366934, 'f1': 0.62177414, 'auroc': 0.91432285, 'binary_precision': 0.18020596, 'binary_recall': 0.7590361, 'binary_specificity': 0.9143506, 'binary_f1_score': 0.29126215}
confusion matrix:
       0     1
0  15298  1433
1    100   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86296225, 'precision': 0.65211624, 'recall': 0.81233686, 'specificity': 0.81233686, 'f1': 0.68882513, 'auroc': 0.8894893, 'binary_precision': 0.32713965, 'binary_recall': 0.75259066, 'binary_specificity': 0.87208307, 'binary_f1_score': 0.456044}
confusion matrix:
      0     1
0  8147  1195
1   191   581
new oracle model saved
early stop counter: 1
val acc:0.9105913639068604, best validation acc: 0.92103111743927, corresponding to test acc:                         0.8461538553237915 / 0.8629622459411621
after epoch: 2,now: 2024-08-07 22:34:38.067256,epoch time: 0:45:09.932751,used: 1:31:33.303582,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_21_03_04_seed_0_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97048724, 'precision': 0.9710907, 'recall': 0.9705, 'specificity': 0.9705, 'f1': 0.97047836, 'auroc': 0.9941885, 'binary_precision': 0.98812985, 'binary_recall': 0.95245796, 'binary_specificity': 0.9885421, 'binary_f1_score': 0.9699661}
confusion matrix:
       0      1
0  25020    290
1   1205  24141
---- Validation: 
scalar performance:
{'acc': 0.9206229, 'precision': 0.5937966, 'recall': 0.8265594, 'specificity': 0.8265594, 'f1': 0.63263905, 'auroc': 0.9164405, 'binary_precision': 0.1948387, 'binary_recall': 0.72771084, 'binary_specificity': 0.92540795, 'binary_f1_score': 0.30737913}
confusion matrix:
       0     1
0  15483  1248
1    113   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8958869, 'precision': 0.6746005, 'recall': 0.76064444, 'specificity': 0.76064444, 'f1': 0.7053711, 'auroc': 0.88602376, 'binary_precision': 0.38378826, 'binary_recall': 0.60103625, 'binary_specificity': 0.9202526, 'binary_f1_score': 0.46845028}
confusion matrix:
      0    1
0  8597  745
1   308  464
new oracle model saved
early stop counter: 2
val acc:0.9206228852272034, best validation acc: 0.92103111743927, corresponding to test acc:                         0.8461538553237915 / 0.8958868980407715
after epoch: 3,now: 2024-08-07 23:20:02.552677,epoch time: 0:45:24.485421,used: 2:16:57.789003,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_21_03_04_seed_0_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97374445, 'precision': 0.9741334, 'recall': 0.97375244, 'specificity': 0.97375244, 'f1': 0.9737394, 'auroc': 0.9956472, 'binary_precision': 0.9878505, 'binary_recall': 0.95931655, 'binary_specificity': 0.9881883, 'binary_f1_score': 0.9733745}
confusion matrix:
       0      1
0  25015    299
1   1031  24311
---- Validation: 
scalar performance:
{'acc': 0.92138106, 'precision': 0.5962146, 'recall': 0.8351724, 'specificity': 0.8351724, 'f1': 0.63632184, 'auroc': 0.9216912, 'binary_precision': 0.1992263, 'binary_recall': 0.7445783, 'binary_specificity': 0.9257665, 'binary_f1_score': 0.31434384}
confusion matrix:
       0     1
0  15489  1242
1    106   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90013844, 'precision': 0.68943506, 'recall': 0.79740644, 'specificity': 0.79740644, 'f1': 0.72635126, 'auroc': 0.8955947, 'binary_precision': 0.4071763, 'binary_recall': 0.6761658, 'binary_specificity': 0.918647, 'binary_f1_score': 0.5082765}
confusion matrix:
      0    1
0  8582  760
1   250  522
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-08 00:05:18.843405,epoch time: 0:45:16.290728,used: 3:02:14.079731,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_21_03_04_seed_0_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.976903, 'precision': 0.97735727, 'recall': 0.97691166, 'specificity': 0.97691166, 'f1': 0.97689784, 'auroc': 0.99649495, 'binary_precision': 0.99222124, 'binary_recall': 0.9613685, 'binary_specificity': 0.99245477, 'binary_f1_score': 0.9765513}
confusion matrix:
       0      1
0  25123    191
1    979  24363
---- Validation: 
scalar performance:
{'acc': 0.9567246, 'precision': 0.65199435, 'recall': 0.81098485, 'specificity': 0.81098485, 'f1': 0.7007154, 'auroc': 0.92243075, 'binary_precision': 0.3127148, 'binary_recall': 0.6578313, 'binary_specificity': 0.96413845, 'binary_f1_score': 0.42391303}
confusion matrix:
       0    1
0  16131  600
1    142  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9161558, 'precision': 0.7075768, 'recall': 0.7300261, 'specificity': 0.7300261, 'f1': 0.7180258, 'auroc': 0.89451385, 'binary_precision': 0.4560185, 'binary_recall': 0.5103627, 'binary_specificity': 0.94968957, 'binary_f1_score': 0.48166257}
confusion matrix:
      0    1
0  8872  470
1   378  394
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-08 00:49:55.450575,epoch time: 0:44:36.607170,used: 3:46:50.686901,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_21_03_04_seed_0_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.980338, 'precision': 0.9805478, 'recall': 0.9803438, 'specificity': 0.9803438, 'f1': 0.98033595, 'auroc': 0.99702734, 'binary_precision': 0.990728, 'binary_recall': 0.9697735, 'binary_specificity': 0.9909141, 'binary_f1_score': 0.9801388}
confusion matrix:
       0      1
0  25084    230
1    766  24576
---- Validation: 
scalar performance:
{'acc': 0.94336873, 'precision': 0.62568265, 'recall': 0.8335147, 'specificity': 0.8335147, 'f1': 0.67533654, 'auroc': 0.9239524, 'binary_precision': 0.25868055, 'binary_recall': 0.7180723, 'binary_specificity': 0.948957, 'binary_f1_score': 0.3803446}
confusion matrix:
       0    1
0  15877  854
1    117  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91239864, 'precision': 0.7058808, 'recall': 0.7707709, 'specificity': 0.7707709, 'f1': 0.7322626, 'auroc': 0.89742815, 'binary_precision': 0.4455067, 'binary_recall': 0.60362697, 'binary_specificity': 0.9379148, 'binary_f1_score': 0.51265126}
confusion matrix:
      0    1
0  8762  580
1   306  466
early stop counter: 1
val acc:0.9433687329292297, best validation acc: 0.9567245841026306, corresponding to test acc:                         0.9161558151245117 / 0.9161558151245117
after epoch: 6,now: 2024-08-08 01:34:13.351613,epoch time: 0:44:17.901038,used: 4:31:08.587939,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_21_03_04_seed_0_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.981858, 'precision': 0.9819145, 'recall': 0.981862, 'specificity': 0.981862, 'f1': 0.98185766, 'auroc': 0.99741614, 'binary_precision': 0.98731196, 'binary_recall': 0.9762882, 'binary_specificity': 0.9874358, 'binary_f1_score': 0.98176914}
confusion matrix:
       0      1
0  24992    318
1    601  24745
---- Validation: 
scalar performance:
{'acc': 0.9410358, 'precision': 0.6232361, 'recall': 0.84171873, 'specificity': 0.84171873, 'f1': 0.6730664, 'auroc': 0.9237498, 'binary_precision': 0.25331125, 'binary_recall': 0.7373494, 'binary_specificity': 0.9460881, 'binary_f1_score': 0.37707946}
confusion matrix:
       0    1
0  15829  902
1    109  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9101246, 'precision': 0.7034513, 'recall': 0.78261113, 'specificity': 0.78261113, 'f1': 0.7341081, 'auroc': 0.9016316, 'binary_precision': 0.43845463, 'binary_recall': 0.63212436, 'binary_specificity': 0.93309784, 'binary_f1_score': 0.51777184}
confusion matrix:
      0    1
0  8717  625
1   284  488
early stop counter: 2
val acc:0.941035807132721, best validation acc: 0.9567245841026306, corresponding to test acc:                         0.9161558151245117 / 0.9161558151245117
after epoch: 7,now: 2024-08-08 02:18:51.554576,epoch time: 0:44:38.202963,used: 5:15:46.790902,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_21_03_04_seed_0_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9820554, 'precision': 0.982214, 'recall': 0.98206127, 'specificity': 0.98206127, 'f1': 0.9820541, 'auroc': 0.9976653, 'binary_precision': 0.9911163, 'binary_recall': 0.97285354, 'binary_specificity': 0.991269, 'binary_f1_score': 0.9819}
confusion matrix:
       0      1
0  25091    221
1    688  24656
---- Validation: 
scalar performance:
{'acc': 0.9555581, 'precision': 0.6516291, 'recall': 0.8256613, 'specificity': 0.8256613, 'f1': 0.70283264, 'auroc': 0.92234993, 'binary_precision': 0.31120783, 'binary_recall': 0.68915665, 'binary_specificity': 0.962166, 'binary_f1_score': 0.4287856}
confusion matrix:
       0    1
0  16098  633
1    129  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91536486, 'precision': 0.7133359, 'recall': 0.77772385, 'specificity': 0.77772385, 'f1': 0.7397791, 'auroc': 0.9038349, 'binary_precision': 0.45938104, 'binary_recall': 0.615285, 'binary_specificity': 0.9401627, 'binary_f1_score': 0.5260244}
confusion matrix:
      0    1
0  8783  559
1   297  475
early stop counter: 3
val acc:0.9555581212043762, best validation acc: 0.9567245841026306, corresponding to test acc:                         0.9161558151245117 / 0.9161558151245117
after epoch: 8,now: 2024-08-08 03:03:27.098641,epoch time: 0:44:35.544065,used: 6:00:22.334967,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_21_03_04_seed_0_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 6:00:22.334967 at 2024-08-08 03:03:27.098641
persisted model performance metric: 

scalar performance:
{'acc': 0.9161558, 'precision': 0.7075768, 'recall': 0.7300261, 'specificity': 0.7300261, 'f1': 0.7180258, 'auroc': 0.89451385, 'binary_precision': 0.4560185, 'binary_recall': 0.5103627, 'binary_specificity': 0.94968957, 'binary_f1_score': 0.48166257}
confusion matrix:
      0    1
0  8872  470
1   378  394
oracle model performance metric: 

scalar performance:
{'acc': 0.9161558, 'precision': 0.7075768, 'recall': 0.7300261, 'specificity': 0.7300261, 'f1': 0.7180258, 'auroc': 0.89451385, 'binary_precision': 0.4560185, 'binary_recall': 0.5103627, 'binary_specificity': 0.94968957, 'binary_f1_score': 0.48166257}
confusion matrix:
      0    1
0  8872  470
1   378  394
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/13.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   4047 MiB | 750065 GiB | 750064 GiB |
|       from large pool | 180662 KiB |   4027 MiB | 741250 GiB | 741249 GiB |
|       from small pool |  18214 KiB |     38 MiB |   8814 GiB |   8814 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   4047 MiB | 750065 GiB | 750064 GiB |
|       from large pool | 180662 KiB |   4027 MiB | 741250 GiB | 741249 GiB |
|       from small pool |  18214 KiB |     38 MiB |   8814 GiB |   8814 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   4045 MiB | 750020 GiB | 750020 GiB |
|       from large pool | 178979 KiB |   4026 MiB | 741215 GiB | 741214 GiB |
|       from small pool |  16663 KiB |     36 MiB |   8805 GiB |   8805 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4432 MiB |   4432 MiB |   4432 MiB |      0 B   |
|       from large pool |   4390 MiB |   4390 MiB |   4390 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  63268 KiB | 398856 KiB | 390827 GiB | 390827 GiB |
|       from large pool |  50762 KiB | 397938 KiB | 381959 GiB | 381959 GiB |
|       from small pool |  12506 KiB |  13009 KiB |   8867 GiB |   8867 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6807    |  100417 K  |  100412 K  |
|       from large pool |      79    |     423    |   68040 K  |   68040 K  |
|       from small pool |    4345    |    6727    |   32376 K  |   32372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6807    |  100417 K  |  100412 K  |
|       from large pool |      79    |     423    |   68040 K  |   68040 K  |
|       from small pool |    4345    |    6727    |   32376 K  |   32372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     203    |     203    |     203    |       0    |
|       from large pool |     182    |     182    |     182    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3187    |   68234 K  |   68234 K  |
|       from large pool |      10    |     184    |   54763 K  |   54762 K  |
|       from small pool |      23    |    3177    |   13471 K  |   13471 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB | 750065 GiB | 750065 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 741250 GiB | 741250 GiB |
|       from small pool |      0 KiB |     38 MiB |   8814 GiB |   8814 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB | 750065 GiB | 750065 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 741250 GiB | 741250 GiB |
|       from small pool |      0 KiB |     38 MiB |   8814 GiB |   8814 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 750020 GiB | 750020 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 741215 GiB | 741214 GiB |
|       from small pool |      0 KiB |     36 MiB |   8805 GiB |   8805 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   4432 MiB |   4432 MiB |   4176 MiB |
|       from large pool | 231424 KiB |   4390 MiB |   4390 MiB |   4164 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB | 390827 GiB | 390827 GiB |
|       from large pool |  30464 KiB | 397938 KiB | 381960 GiB | 381960 GiB |
|       from small pool |      0 KiB |  24597 KiB |   8867 GiB |   8867 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |  100417 K  |  100417 K  |
|       from large pool |       2    |     423    |   68040 K  |   68040 K  |
|       from small pool |       0    |    6727    |   32376 K  |   32376 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |  100417 K  |  100417 K  |
|       from large pool |       2    |     423    |   68040 K  |   68040 K  |
|       from small pool |       0    |    6727    |   32376 K  |   32376 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |     203    |     203    |     177    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3187    |   68236 K  |   68236 K  |
|       from large pool |       3    |     184    |   54763 K  |   54763 K  |
|       from small pool |       0    |    3177    |   13473 K  |   13473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB | 750065 GiB | 750065 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 741250 GiB | 741250 GiB |
|       from small pool |      0 KiB |     38 MiB |   8814 GiB |   8814 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB | 750065 GiB | 750065 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 741250 GiB | 741250 GiB |
|       from small pool |      0 KiB |     38 MiB |   8814 GiB |   8814 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 750020 GiB | 750020 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 741215 GiB | 741214 GiB |
|       from small pool |      0 KiB |     36 MiB |   8805 GiB |   8805 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   4432 MiB |   4432 MiB |   4176 MiB |
|       from large pool | 231424 KiB |   4390 MiB |   4390 MiB |   4164 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB | 390827 GiB | 390827 GiB |
|       from large pool |  30464 KiB | 397938 KiB | 381960 GiB | 381960 GiB |
|       from small pool |      0 KiB |  24597 KiB |   8867 GiB |   8867 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |  100417 K  |  100417 K  |
|       from large pool |       2    |     423    |   68040 K  |   68040 K  |
|       from small pool |       0    |    6727    |   32376 K  |   32376 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |  100417 K  |  100417 K  |
|       from large pool |       2    |     423    |   68040 K  |   68040 K  |
|       from small pool |       0    |    6727    |   32376 K  |   32376 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |     203    |     203    |     177    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3187    |   68236 K  |   68236 K  |
|       from large pool |       3    |     184    |   54763 K  |   54763 K  |
|       from small pool |       0    |    3177    |   13473 K  |   13473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_03_26_32_seed_1_24111565

 Experiment start at: 2024-08-08 03:26:32.705500
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9426346, 'precision': 0.9454361, 'recall': 0.94266427, 'specificity': 0.94266427, 'f1': 0.94254684, 'auroc': 0.9858655, 'binary_precision': 0.9809491, 'binary_recall': 0.9028897, 'binary_specificity': 0.98243886, 'binary_f1_score': 0.94030213}
confusion matrix:
       0      1
0  24951    446
1   2470  22965
---- Validation: 
scalar performance:
{'acc': 0.94451904, 'precision': 0.5931881, 'recall': 0.68335795, 'specificity': 0.68335795, 'f1': 0.62075824, 'auroc': 0.86421376, 'binary_precision': 0.20206659, 'binary_recall': 0.40835267, 'binary_specificity': 0.9583633, 'binary_f1_score': 0.2703533}
confusion matrix:
       0    1
0  15997  695
1    255  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8802894, 'precision': 0.60370535, 'recall': 0.62757456, 'specificity': 0.62757456, 'f1': 0.6136755, 'auroc': 0.8368335, 'binary_precision': 0.2628812, 'binary_recall': 0.33025098, 'binary_specificity': 0.9248982, 'binary_f1_score': 0.29274008}
confusion matrix:
      0    1
0  8633  701
1   507  250
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 04:12:18.205505,epoch time: 0:45:45.500005,used: 0:45:45.500005,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_03_26_32_seed_1_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96264166, 'precision': 0.96273744, 'recall': 0.96264744, 'specificity': 0.96264744, 'f1': 0.96264005, 'auroc': 0.99170196, 'binary_precision': 0.9695942, 'binary_recall': 0.95529956, 'binary_specificity': 0.96999526, 'binary_f1_score': 0.9623938}
confusion matrix:
       0      1
0  24634    762
1   1137  24299
---- Validation: 
scalar performance:
{'acc': 0.9401974, 'precision': 0.6148995, 'recall': 0.7907648, 'specificity': 0.7907648, 'f1': 0.65821636, 'auroc': 0.8902846, 'binary_precision': 0.23968393, 'binary_recall': 0.6334107, 'binary_specificity': 0.94811887, 'binary_f1_score': 0.3477707}
confusion matrix:
       0    1
0  15826  866
1    158  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8732534, 'precision': 0.6522343, 'recall': 0.7864297, 'specificity': 0.7864297, 'f1': 0.68796587, 'auroc': 0.8754808, 'binary_precision': 0.33247754, 'binary_recall': 0.68428004, 'binary_specificity': 0.88857937, 'binary_f1_score': 0.44751617}
confusion matrix:
      0     1
0  8294  1040
1   239   518
early stop counter: 1
val acc:0.9401974081993103, best validation acc: 0.94451904296875, corresponding to test acc:                         0.8802893757820129 / 0.8802893757820129
after epoch: 2,now: 2024-08-08 04:59:01.212580,epoch time: 0:46:43.007075,used: 1:32:28.507080,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_03_26_32_seed_1_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96832705, 'precision': 0.9689106, 'recall': 0.968341, 'specificity': 0.968341, 'f1': 0.96831787, 'auroc': 0.9942565, 'binary_precision': 0.98565024, 'binary_recall': 0.9505425, 'binary_specificity': 0.98613954, 'binary_f1_score': 0.9677781}
confusion matrix:
       0      1
0  25044    352
1   1258  24178
---- Validation: 
scalar performance:
{'acc': 0.94393504, 'precision': 0.62359554, 'recall': 0.7994627, 'specificity': 0.7994627, 'f1': 0.6691282, 'auroc': 0.90343124, 'binary_precision': 0.25666973, 'binary_recall': 0.6473318, 'binary_specificity': 0.9515936, 'binary_f1_score': 0.36758894}
confusion matrix:
       0    1
0  15884  808
1    152  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8795957, 'precision': 0.6589862, 'recall': 0.78803724, 'specificity': 0.78803724, 'f1': 0.6955301, 'auroc': 0.87698245, 'binary_precision': 0.34610215, 'binary_recall': 0.68031704, 'binary_specificity': 0.89575744, 'binary_f1_score': 0.45879734}
confusion matrix:
      0    1
0  8361  973
1   242  515
early stop counter: 2
val acc:0.9439350366592407, best validation acc: 0.94451904296875, corresponding to test acc:                         0.8802893757820129 / 0.8802893757820129
after epoch: 3,now: 2024-08-08 05:44:30.785993,epoch time: 0:45:29.573413,used: 2:17:58.080493,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_03_26_32_seed_1_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97293043, 'precision': 0.97339535, 'recall': 0.9729429, 'specificity': 0.9729429, 'f1': 0.97292435, 'auroc': 0.9955685, 'binary_precision': 0.9884288, 'binary_recall': 0.957108, 'binary_specificity': 0.98877776, 'binary_f1_score': 0.9725163}
confusion matrix:
       0      1
0  25111    285
1   1091  24345
---- Validation: 
scalar performance:
{'acc': 0.9478479, 'precision': 0.6299971, 'recall': 0.7924285, 'specificity': 0.7924285, 'f1': 0.67524195, 'auroc': 0.90730524, 'binary_precision': 0.26992032, 'binary_recall': 0.6287703, 'binary_specificity': 0.95608675, 'binary_f1_score': 0.37770036}
confusion matrix:
       0    1
0  15959  733
1    160  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.886929, 'precision': 0.6641643, 'recall': 0.7762209, 'specificity': 0.7762209, 'f1': 0.6991854, 'auroc': 0.87522, 'binary_precision': 0.35903084, 'binary_recall': 0.64597094, 'binary_specificity': 0.90647095, 'binary_f1_score': 0.46153846}
confusion matrix:
      0    1
0  8461  873
1   268  489
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-08 06:29:17.763439,epoch time: 0:44:46.977446,used: 3:02:45.057939,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_03_26_32_seed_1_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9759207, 'precision': 0.97630656, 'recall': 0.97593087, 'specificity': 0.97593087, 'f1': 0.9759162, 'auroc': 0.99625564, 'binary_precision': 0.9900413, 'binary_recall': 0.96154755, 'binary_specificity': 0.9903142, 'binary_f1_score': 0.9755865}
confusion matrix:
       0      1
0  25152    246
1    978  24456
---- Validation: 
scalar performance:
{'acc': 0.94113183, 'precision': 0.61789894, 'recall': 0.7968947, 'specificity': 0.7968947, 'f1': 0.662328, 'auroc': 0.90802586, 'binary_precision': 0.24536629, 'binary_recall': 0.6450116, 'binary_specificity': 0.94877785, 'binary_f1_score': 0.35549873}
confusion matrix:
       0    1
0  15837  855
1    153  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8777128, 'precision': 0.6566132, 'recall': 0.7864125, 'specificity': 0.7864125, 'f1': 0.6928017, 'auroc': 0.8739121, 'binary_precision': 0.34152824, 'binary_recall': 0.678996, 'binary_specificity': 0.893829, 'binary_f1_score': 0.45446506}
confusion matrix:
      0    1
0  8343  991
1   243  514
early stop counter: 1
val acc:0.9411318302154541, best validation acc: 0.9478479027748108, corresponding to test acc:                         0.8869289755821228 / 0.8869289755821228
after epoch: 5,now: 2024-08-08 07:14:02.974043,epoch time: 0:44:45.210604,used: 3:47:30.268543,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_03_26_32_seed_1_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97643214, 'precision': 0.976688, 'recall': 0.9764409, 'specificity': 0.9764409, 'f1': 0.97642934, 'auroc': 0.996732, 'binary_precision': 0.98792124, 'binary_recall': 0.9646943, 'binary_specificity': 0.98818755, 'binary_f1_score': 0.9761697}
confusion matrix:
       0      1
0  25097    300
1    898  24537
---- Validation: 
scalar performance:
{'acc': 0.93605095, 'precision': 0.61162734, 'recall': 0.8055901, 'specificity': 0.8055901, 'f1': 0.6555445, 'auroc': 0.9103675, 'binary_precision': 0.23225807, 'binary_recall': 0.6682135, 'binary_specificity': 0.9429667, 'binary_f1_score': 0.3447038}
confusion matrix:
       0    1
0  15740  952
1    143  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8672084, 'precision': 0.6501283, 'recall': 0.7989424, 'specificity': 0.7989424, 'f1': 0.68631476, 'auroc': 0.8729274, 'binary_precision': 0.32555357, 'binary_recall': 0.71862614, 'binary_specificity': 0.87925863, 'binary_f1_score': 0.44810545}
confusion matrix:
      0     1
0  8207  1127
1   213   544
early stop counter: 2
val acc:0.9360509514808655, best validation acc: 0.9478479027748108, corresponding to test acc:                         0.8869289755821228 / 0.8869289755821228
after epoch: 6,now: 2024-08-08 07:58:46.120845,epoch time: 0:44:43.146802,used: 4:32:13.415345,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_03_26_32_seed_1_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97839946, 'precision': 0.9787129, 'recall': 0.97840965, 'specificity': 0.97840965, 'f1': 0.9783962, 'auroc': 0.997118, 'binary_precision': 0.9911608, 'binary_recall': 0.96544266, 'binary_specificity': 0.9913766, 'binary_f1_score': 0.9781327}
confusion matrix:
       0      1
0  25177    219
1    879  24557
---- Validation: 
scalar performance:
{'acc': 0.93943816, 'precision': 0.61328375, 'recall': 0.78924525, 'specificity': 0.78924525, 'f1': 0.6561698, 'auroc': 0.90914524, 'binary_precision': 0.23652174, 'binary_recall': 0.63109046, 'binary_specificity': 0.9474, 'binary_f1_score': 0.34408602}
confusion matrix:
       0    1
0  15814  878
1    159  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88177586, 'precision': 0.66130626, 'recall': 0.78800184, 'specificity': 0.78800184, 'f1': 0.6979781, 'auroc': 0.87336534, 'binary_precision': 0.3508892, 'binary_recall': 0.677675, 'binary_specificity': 0.89832866, 'binary_f1_score': 0.46237043}
confusion matrix:
      0    1
0  8385  949
1   244  513
early stop counter: 3
val acc:0.9394381642341614, best validation acc: 0.9478479027748108, corresponding to test acc:                         0.8869289755821228 / 0.8869289755821228
after epoch: 7,now: 2024-08-08 08:43:29.150729,epoch time: 0:44:43.029884,used: 5:16:56.445229,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_03_26_32_seed_1_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 5:16:56.445229 at 2024-08-08 08:43:29.150729
persisted model performance metric: 

scalar performance:
{'acc': 0.886929, 'precision': 0.6641643, 'recall': 0.7762209, 'specificity': 0.7762209, 'f1': 0.6991854, 'auroc': 0.87522, 'binary_precision': 0.35903084, 'binary_recall': 0.64597094, 'binary_specificity': 0.90647095, 'binary_f1_score': 0.46153846}
confusion matrix:
      0    1
0  8461  873
1   268  489
oracle model performance metric: 

scalar performance:
{'acc': 0.886929, 'precision': 0.6641643, 'recall': 0.7762209, 'specificity': 0.7762209, 'f1': 0.6991854, 'auroc': 0.87522, 'binary_precision': 0.35903084, 'binary_recall': 0.64597094, 'binary_specificity': 0.90647095, 'binary_f1_score': 0.46153846}
confusion matrix:
      0    1
0  8461  873
1   268  489
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   4047 MiB |   1378 TiB |   1378 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1362 TiB |   1362 TiB |
|       from small pool |  18208 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   4047 MiB |   1378 TiB |   1378 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1362 TiB |   1362 TiB |
|       from small pool |  18208 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   4045 MiB |   1378 TiB |   1378 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1362 TiB |   1362 TiB |
|       from small pool |  16662 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4420 MiB |   4432 MiB |   8596 MiB |   4176 MiB |
|       from large pool |   4382 MiB |   4390 MiB |   8546 MiB |   4164 MiB |
|       from small pool |     38 MiB |     42 MiB |     50 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB | 398856 KiB | 748231 GiB | 748231 GiB |
|       from large pool |  31733 KiB | 397938 KiB | 731279 GiB | 731279 GiB |
|       from small pool |  10464 KiB |  24597 KiB |  16952 GiB |  16952 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6829    |  189074 K  |  189070 K  |
|       from large pool |      79    |     423    |  128103 K  |  128103 K  |
|       from small pool |    4333    |    6749    |   60971 K  |   60967 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6829    |  189074 K  |  189070 K  |
|       from large pool |      79    |     423    |  128103 K  |  128103 K  |
|       from small pool |    4333    |    6749    |   60971 K  |   60967 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     203    |     377    |     177    |
|       from large pool |     181    |     182    |     352    |     171    |
|       from small pool |      19    |      21    |      25    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3197    |  130116 K  |  130116 K  |
|       from large pool |      11    |     186    |  100337 K  |  100337 K  |
|       from small pool |      21    |    3186    |   29779 K  |   29778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1378 TiB |   1378 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1362 TiB |   1362 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1378 TiB |   1378 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1362 TiB |   1362 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1378 TiB |   1378 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1362 TiB |   1362 TiB |
|       from small pool |      0 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4432 MiB |   8596 MiB |   8362 MiB |
|       from large pool | 210944 KiB |   4390 MiB |   8546 MiB |   8340 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB | 748231 GiB | 748231 GiB |
|       from large pool |  30464 KiB | 397938 KiB | 731279 GiB | 731279 GiB |
|       from small pool |      0 KiB |  24603 KiB |  16952 GiB |  16952 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  189074 K  |  189074 K  |
|       from large pool |       2    |     423    |  128103 K  |  128103 K  |
|       from small pool |       0    |    6749    |   60971 K  |   60971 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  189074 K  |  189074 K  |
|       from large pool |       2    |     423    |  128103 K  |  128103 K  |
|       from small pool |       0    |    6749    |   60971 K  |   60971 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     203    |     377    |     353    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3197    |  130118 K  |  130118 K  |
|       from large pool |       3    |     186    |  100337 K  |  100337 K  |
|       from small pool |       0    |    3186    |   29780 K  |   29780 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1378 TiB |   1378 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1362 TiB |   1362 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1378 TiB |   1378 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1362 TiB |   1362 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1378 TiB |   1378 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1362 TiB |   1362 TiB |
|       from small pool |      0 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4432 MiB |   8596 MiB |   8362 MiB |
|       from large pool | 210944 KiB |   4390 MiB |   8546 MiB |   8340 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB | 748231 GiB | 748231 GiB |
|       from large pool |  30464 KiB | 397938 KiB | 731279 GiB | 731279 GiB |
|       from small pool |      0 KiB |  24603 KiB |  16952 GiB |  16952 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  189074 K  |  189074 K  |
|       from large pool |       2    |     423    |  128103 K  |  128103 K  |
|       from small pool |       0    |    6749    |   60971 K  |   60971 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  189074 K  |  189074 K  |
|       from large pool |       2    |     423    |  128103 K  |  128103 K  |
|       from small pool |       0    |    6749    |   60971 K  |   60971 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     203    |     377    |     353    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3197    |  130118 K  |  130118 K  |
|       from large pool |       3    |     186    |  100337 K  |  100337 K  |
|       from small pool |       0    |    3186    |   29780 K  |   29780 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_07_26_seed_2_24111565

 Experiment start at: 2024-08-08 09:07:27.281805
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94970596, 'precision': 0.95043486, 'recall': 0.9497099, 'specificity': 0.9497099, 'f1': 0.94968593, 'auroc': 0.9850035, 'binary_precision': 0.96860266, 'binary_recall': 0.9295633, 'binary_specificity': 0.96985644, 'binary_f1_score': 0.9486815}
confusion matrix:
       0      1
0  25064    779
1   1821  24032
---- Validation: 
scalar performance:
{'acc': 0.9292805, 'precision': 0.5861399, 'recall': 0.7456681, 'specificity': 0.7456681, 'f1': 0.61948746, 'auroc': 0.84863114, 'binary_precision': 0.18406375, 'binary_recall': 0.55263156, 'binary_specificity': 0.93870467, 'binary_f1_score': 0.27615064}
confusion matrix:
       0     1
0  15682  1024
1    187   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88010305, 'precision': 0.64933175, 'recall': 0.72842956, 'specificity': 0.72842956, 'f1': 0.6762675, 'auroc': 0.8536484, 'binary_precision': 0.33954933, 'binary_recall': 0.54830617, 'binary_specificity': 0.908553, 'binary_f1_score': 0.4193858}
confusion matrix:
      0    1
0  8445  850
1   360  437
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 09:55:39.377466,epoch time: 0:48:12.095661,used: 0:48:12.095661,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_07_26_seed_2_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9616605, 'precision': 0.96257174, 'recall': 0.96166563, 'specificity': 0.96166563, 'f1': 0.96164185, 'auroc': 0.9910964, 'binary_precision': 0.9831606, 'binary_recall': 0.9394291, 'binary_specificity': 0.98390216, 'binary_f1_score': 0.9607974}
confusion matrix:
       0      1
0  25426    416
1   1566  24288
---- Validation: 
scalar performance:
{'acc': 0.9465662, 'precision': 0.6155501, 'recall': 0.75802594, 'specificity': 0.75802594, 'f1': 0.6552768, 'auroc': 0.87259126, 'binary_precision': 0.24248704, 'binary_recall': 0.5598086, 'binary_specificity': 0.9562433, 'binary_f1_score': 0.33839476}
confusion matrix:
       0    1
0  15975  731
1    184  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9055688, 'precision': 0.69398814, 'recall': 0.7502841, 'specificity': 0.7502841, 'f1': 0.7171296, 'auroc': 0.8891417, 'binary_precision': 0.426276, 'binary_recall': 0.565872, 'binary_specificity': 0.9346961, 'binary_f1_score': 0.48625335}
confusion matrix:
      0    1
0  8688  607
1   346  451
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 10:44:15.224944,epoch time: 0:48:35.847478,used: 1:36:47.943139,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_07_26_seed_2_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9676958, 'precision': 0.9684347, 'recall': 0.9676981, 'specificity': 0.9676981, 'f1': 0.96768314, 'auroc': 0.9941193, 'binary_precision': 0.9870685, 'binary_recall': 0.9478163, 'binary_specificity': 0.9875798, 'binary_f1_score': 0.9670443}
confusion matrix:
       0      1
0  25524    321
1   1349  24502
---- Validation: 
scalar performance:
{'acc': 0.95409954, 'precision': 0.63069165, 'recall': 0.7478919, 'specificity': 0.7478919, 'f1': 0.6685852, 'auroc': 0.87566155, 'binary_precision': 0.27339903, 'binary_recall': 0.53110045, 'binary_specificity': 0.96468335, 'binary_f1_score': 0.3609756}
confusion matrix:
       0    1
0  16116  590
1    196  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9086405, 'precision': 0.7007072, 'recall': 0.7530987, 'specificity': 0.7530987, 'f1': 0.72269744, 'auroc': 0.8991585, 'binary_precision': 0.43937925, 'binary_recall': 0.5683814, 'binary_specificity': 0.937816, 'binary_f1_score': 0.49562365}
confusion matrix:
      0    1
0  8717  578
1   344  453
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-08 11:38:28.285823,epoch time: 0:54:13.060879,used: 2:31:01.004018,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_07_26_seed_2_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97214484, 'precision': 0.97253644, 'recall': 0.9721471, 'specificity': 0.9721471, 'f1': 0.9721392, 'auroc': 0.99550396, 'binary_precision': 0.9861786, 'binary_recall': 0.9577209, 'binary_specificity': 0.9865733, 'binary_f1_score': 0.97174144}
confusion matrix:
       0      1
0  25497    347
1   1093  24759
---- Validation: 
scalar performance:
{'acc': 0.9425952, 'precision': 0.613801, 'recall': 0.78164804, 'specificity': 0.78164804, 'f1': 0.6562312, 'auroc': 0.88634014, 'binary_precision': 0.2376973, 'binary_recall': 0.61244017, 'binary_specificity': 0.950856, 'binary_f1_score': 0.3424749}
confusion matrix:
       0    1
0  15885  821
1    162  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9097305, 'precision': 0.70894504, 'recall': 0.7869569, 'specificity': 0.7869569, 'f1': 0.73939836, 'auroc': 0.9033663, 'binary_precision': 0.44982395, 'binary_recall': 0.64115435, 'binary_specificity': 0.9327595, 'binary_f1_score': 0.52871186}
confusion matrix:
      0    1
0  8670  625
1   286  511
new oracle model saved
early stop counter: 1
val acc:0.9425951838493347, best validation acc: 0.9540995359420776, corresponding to test acc:                         0.9086405038833618 / 0.9097304940223694
after epoch: 4,now: 2024-08-08 12:25:47.580138,epoch time: 0:47:19.294315,used: 3:18:20.298333,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_07_26_seed_2_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9751238, 'precision': 0.9753256, 'recall': 0.975125, 'specificity': 0.975125, 'f1': 0.97512114, 'auroc': 0.99608195, 'binary_precision': 0.9851483, 'binary_recall': 0.9647983, 'binary_specificity': 0.98545176, 'binary_f1_score': 0.97486705}
confusion matrix:
       0      1
0  25469    376
1    910  24941
---- Validation: 
scalar performance:
{'acc': 0.9439967, 'precision': 0.6159666, 'recall': 0.78003395, 'specificity': 0.78003395, 'f1': 0.6585151, 'auroc': 0.8876319, 'binary_precision': 0.24213536, 'binary_recall': 0.6076555, 'binary_specificity': 0.9524123, 'binary_f1_score': 0.34628493}
confusion matrix:
       0    1
0  15911  795
1    164  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9110186, 'precision': 0.711756, 'recall': 0.78880334, 'specificity': 0.78880334, 'f1': 0.7420428, 'auroc': 0.90241957, 'binary_precision': 0.45519078, 'binary_recall': 0.64366376, 'binary_specificity': 0.933943, 'binary_f1_score': 0.53326404}
confusion matrix:
      0    1
0  8681  614
1   284  513
new oracle model saved
early stop counter: 2
val acc:0.9439967274665833, best validation acc: 0.9540995359420776, corresponding to test acc:                         0.9086405038833618 / 0.9110186100006104
after epoch: 5,now: 2024-08-08 13:13:16.521298,epoch time: 0:47:28.941160,used: 4:05:49.239493,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_07_26_seed_2_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97850895, 'precision': 0.9787179, 'recall': 0.9785098, 'specificity': 0.9785098, 'f1': 0.9785067, 'auroc': 0.99678427, 'binary_precision': 0.9887392, 'binary_recall': 0.9680464, 'binary_specificity': 0.98897314, 'binary_f1_score': 0.9782834}
confusion matrix:
       0      1
0  25561    285
1    826  25024
---- Validation: 
scalar performance:
{'acc': 0.92665267, 'precision': 0.5945197, 'recall': 0.79563594, 'specificity': 0.79563594, 'f1': 0.6329126, 'auroc': 0.89392716, 'binary_precision': 0.19812681, 'binary_recall': 0.65789473, 'binary_specificity': 0.9333772, 'binary_f1_score': 0.30454043}
confusion matrix:
       0     1
0  15593  1113
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9084423, 'precision': 0.7094255, 'recall': 0.80403805, 'specificity': 0.80403805, 'f1': 0.7445022, 'auroc': 0.90334857, 'binary_precision': 0.447564, 'binary_recall': 0.6800502, 'binary_specificity': 0.92802584, 'binary_f1_score': 0.53984064}
confusion matrix:
      0    1
0  8626  669
1   255  542
early stop counter: 3
val acc:0.9266526699066162, best validation acc: 0.9540995359420776, corresponding to test acc:                         0.9086405038833618 / 0.9110186100006104
after epoch: 6,now: 2024-08-08 14:01:58.899125,epoch time: 0:48:42.377827,used: 4:54:31.617320,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_07_26_seed_2_24111565
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 4:54:31.617320 at 2024-08-08 14:01:58.899125
persisted model performance metric: 

scalar performance:
{'acc': 0.9086405, 'precision': 0.7007072, 'recall': 0.7530987, 'specificity': 0.7530987, 'f1': 0.72269744, 'auroc': 0.8991585, 'binary_precision': 0.43937925, 'binary_recall': 0.5683814, 'binary_specificity': 0.937816, 'binary_f1_score': 0.49562365}
confusion matrix:
      0    1
0  8717  578
1   344  453
oracle model performance metric: 

scalar performance:
{'acc': 0.9110186, 'precision': 0.711756, 'recall': 0.78880334, 'specificity': 0.78880334, 'f1': 0.7420428, 'auroc': 0.90241957, 'binary_precision': 0.45519078, 'binary_recall': 0.64366376, 'binary_specificity': 0.933943, 'binary_f1_score': 0.53326404}
confusion matrix:
      0    1
0  8681  614
1   284  513
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   4047 MiB |   1945 TiB |   1945 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1922 TiB |   1922 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   4047 MiB |   1945 TiB |   1945 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1922 TiB |   1922 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   4045 MiB |   1945 TiB |   1945 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1922 TiB |   1922 TiB |
|       from small pool |  16662 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4420 MiB |   4432 MiB |  12782 MiB |   8362 MiB |
|       from large pool |   4382 MiB |   4390 MiB |  12722 MiB |   8340 MiB |
|       from small pool |     38 MiB |     42 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB | 398856 KiB |   1037 TiB |   1037 TiB |
|       from large pool |  31733 KiB | 397938 KiB |   1013 TiB |   1013 TiB |
|       from small pool |  10464 KiB |  24603 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6937    |  266840 K  |  266836 K  |
|       from large pool |      79    |     423    |  180793 K  |  180793 K  |
|       from small pool |    4333    |    6857    |   86047 K  |   86043 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6937    |  266840 K  |  266836 K  |
|       from large pool |      79    |     423    |  180793 K  |  180793 K  |
|       from small pool |    4333    |    6857    |   86047 K  |   86043 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     203    |     553    |     353    |
|       from large pool |     181    |     182    |     523    |     342    |
|       from small pool |      19    |      21    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3251    |  184359 K  |  184359 K  |
|       from large pool |      11    |     186    |  140283 K  |  140283 K  |
|       from small pool |      21    |    3240    |   44076 K  |   44076 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1945 TiB |   1945 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1922 TiB |   1922 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1945 TiB |   1945 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1922 TiB |   1922 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1945 TiB |   1945 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1922 TiB |   1922 TiB |
|       from small pool |      0 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4432 MiB |  12782 MiB |  12548 MiB |
|       from large pool | 210944 KiB |   4390 MiB |  12722 MiB |  12516 MiB |
|       from small pool |  28672 KiB |     42 MiB |     60 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB |   1037 TiB |   1037 TiB |
|       from large pool |  30464 KiB | 397938 KiB |   1013 TiB |   1013 TiB |
|       from small pool |      0 KiB |  25471 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6937    |  266840 K  |  266840 K  |
|       from large pool |       2    |     423    |  180793 K  |  180793 K  |
|       from small pool |       0    |    6857    |   86047 K  |   86047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6937    |  266840 K  |  266840 K  |
|       from large pool |       2    |     423    |  180793 K  |  180793 K  |
|       from small pool |       0    |    6857    |   86047 K  |   86047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     203    |     553    |     529    |
|       from large pool |      10    |     182    |     523    |     513    |
|       from small pool |      14    |      21    |      30    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3251    |  184361 K  |  184361 K  |
|       from large pool |       3    |     186    |  140283 K  |  140283 K  |
|       from small pool |       0    |    3240    |   44078 K  |   44078 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  8 14:25:46 2024]
Finished job 0.
1 of 1 steps (100%) done
