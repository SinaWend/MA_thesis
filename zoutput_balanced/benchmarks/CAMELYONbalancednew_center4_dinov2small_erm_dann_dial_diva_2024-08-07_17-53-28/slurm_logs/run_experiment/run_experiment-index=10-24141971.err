Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 23:59:04 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971

 Experiment start at: 2024-08-11 00:06:59.809315
before training, model accuracy: 0.8344868421554565
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8791456, 'precision': 0.8857783, 'recall': 0.87918186, 'specificity': 0.87918186, 'f1': 0.8786311, 'auroc': 0.9574677, 'binary_precision': 0.9365007, 'binary_recall': 0.8135901, 'binary_specificity': 0.9447736, 'binary_f1_score': 0.8707293}
confusion matrix:
       0      1
0  23916   1398
1   4724  20618
---- Validation: 
scalar performance:
{'acc': 0.92907965, 'precision': 0.49737433, 'recall': 0.49486133, 'specificity': 0.49486133, 'f1': 0.49442083, 'auroc': 0.6013752, 'binary_precision': 0.019207682, 'binary_recall': 0.038554218, 'binary_specificity': 0.9511685, 'binary_f1_score': 0.025641026}
confusion matrix:
       0    1
0  15914  817
1    399   16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9118054, 'precision': 0.65553427, 'recall': 0.5981472, 'specificity': 0.5981472, 'f1': 0.6179856, 'auroc': 0.81268084, 'binary_precision': 0.37288135, 'binary_recall': 0.22797927, 'binary_specificity': 0.9683151, 'binary_f1_score': 0.2829582}
confusion matrix:
      0    1
0  9046  296
1   596  176
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 00:21:26.911910,epoch time: 0:14:27.102595,used: 0:14:27.102595,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9228127, 'precision': 0.92622715, 'recall': 0.9228428, 'specificity': 0.9228428, 'f1': 0.9226614, 'auroc': 0.97625935, 'binary_precision': 0.96454424, 'binary_recall': 0.87800354, 'binary_specificity': 0.96768206, 'binary_f1_score': 0.91924155}
confusion matrix:
       0      1
0  24493    818
1   3092  22253
---- Validation: 
scalar performance:
{'acc': 0.90948325, 'precision': 0.5146303, 'recall': 0.5423919, 'specificity': 0.5423919, 'f1': 0.5148481, 'auroc': 0.6832073, 'binary_precision': 0.051302288, 'binary_recall': 0.15662651, 'binary_specificity': 0.9281573, 'binary_f1_score': 0.07728895}
confusion matrix:
       0     1
0  15529  1202
1    350    65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8987542, 'precision': 0.66876113, 'recall': 0.72120047, 'specificity': 0.72120047, 'f1': 0.68994594, 'auroc': 0.85917795, 'binary_precision': 0.3790787, 'binary_recall': 0.511658, 'binary_specificity': 0.93074286, 'binary_f1_score': 0.43550164}
confusion matrix:
      0    1
0  8695  647
1   377  395
early stop counter: 1
val acc:0.9094832539558411, best validation acc: 0.9290796518325806, corresponding to test acc:                         0.9118053913116455 / 0.9118053913116455
after epoch: 2,now: 2024-08-11 00:34:47.065760,epoch time: 0:13:20.153850,used: 0:27:47.256445,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93436116, 'precision': 0.9363179, 'recall': 0.93438244, 'specificity': 0.93438244, 'f1': 0.9342897, 'auroc': 0.98058546, 'binary_precision': 0.9656952, 'binary_recall': 0.90080494, 'binary_specificity': 0.9679599, 'binary_f1_score': 0.9321221}
confusion matrix:
       0      1
0  24501    811
1   2514  22830
---- Validation: 
scalar performance:
{'acc': 0.9164237, 'precision': 0.5326468, 'recall': 0.59177065, 'specificity': 0.59177065, 'f1': 0.5414318, 'auroc': 0.73174083, 'binary_precision': 0.08482871, 'binary_recall': 0.25060242, 'binary_specificity': 0.9329389, 'binary_f1_score': 0.12675199}
confusion matrix:
       0     1
0  15609  1122
1    311   104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8997429, 'precision': 0.68107235, 'recall': 0.7627318, 'specificity': 0.7627318, 'f1': 0.7112028, 'auroc': 0.8773842, 'binary_precision': 0.3965812, 'binary_recall': 0.60103625, 'binary_specificity': 0.92442733, 'binary_f1_score': 0.47785786}
confusion matrix:
      0    1
0  8636  706
1   308  464
early stop counter: 2
val acc:0.9164236783981323, best validation acc: 0.9290796518325806, corresponding to test acc:                         0.9118053913116455 / 0.9118053913116455
after epoch: 3,now: 2024-08-11 00:48:07.687827,epoch time: 0:13:20.622067,used: 0:41:07.878512,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94063884, 'precision': 0.94441116, 'recall': 0.9406698, 'specificity': 0.9406698, 'f1': 0.94051546, 'auroc': 0.98568785, 'binary_precision': 0.98552424, 'binary_recall': 0.89449596, 'binary_specificity': 0.98684365, 'binary_f1_score': 0.93780637}
confusion matrix:
       0      1
0  24978    333
1   2674  22671
---- Validation: 
scalar performance:
{'acc': 0.9322291, 'precision': 0.5520747, 'recall': 0.61984324, 'specificity': 0.61984324, 'f1': 0.5685163, 'auroc': 0.7667059, 'binary_precision': 0.122345805, 'binary_recall': 0.29156625, 'binary_specificity': 0.94812024, 'binary_f1_score': 0.17236467}
confusion matrix:
       0    1
0  15863  868
1    294  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.907455, 'precision': 0.6976327, 'recall': 0.77819526, 'specificity': 0.77819526, 'f1': 0.7284057, 'auroc': 0.888928, 'binary_precision': 0.42743364, 'binary_recall': 0.62564766, 'binary_specificity': 0.93074286, 'binary_f1_score': 0.50788647}
confusion matrix:
      0    1
0  8695  647
1   289  483
better model found
persisted
after epoch: 4,now: 2024-08-11 01:01:26.212230,epoch time: 0:13:18.524403,used: 0:54:26.402915,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94849575, 'precision': 0.95104486, 'recall': 0.9485121, 'specificity': 0.9485121, 'f1': 0.9484242, 'auroc': 0.98795193, 'binary_precision': 0.9850619, 'binary_recall': 0.9108489, 'binary_specificity': 0.9861753, 'binary_f1_score': 0.9465029}
confusion matrix:
       0      1
0  24967    350
1   2259  23080
---- Validation: 
scalar performance:
{'acc': 0.9476263, 'precision': 0.5744963, 'recall': 0.6277328, 'specificity': 0.6277328, 'f1': 0.5925967, 'auroc': 0.7894193, 'binary_precision': 0.16689655, 'binary_recall': 0.29156625, 'binary_specificity': 0.9638994, 'binary_f1_score': 0.2122807}
confusion matrix:
       0    1
0  16127  604
1    294  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90864146, 'precision': 0.6990392, 'recall': 0.7740843, 'specificity': 0.7740843, 'f1': 0.7282969, 'auroc': 0.89205956, 'binary_precision': 0.43103448, 'binary_recall': 0.615285, 'binary_specificity': 0.93288374, 'binary_f1_score': 0.506937}
confusion matrix:
      0    1
0  8715  627
1   297  475
better model found
persisted
after epoch: 5,now: 2024-08-11 01:14:45.109395,epoch time: 0:13:18.897165,used: 1:07:45.300080,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9518517, 'precision': 0.9542427, 'recall': 0.95186895, 'specificity': 0.95186895, 'f1': 0.95178956, 'auroc': 0.98923117, 'binary_precision': 0.9873175, 'binary_recall': 0.9155091, 'binary_specificity': 0.9882288, 'binary_f1_score': 0.9500584}
confusion matrix:
       0      1
0  25018    298
1   2141  23199
---- Validation: 
scalar performance:
{'acc': 0.94727635, 'precision': 0.5785559, 'recall': 0.63930285, 'specificity': 0.63930285, 'f1': 0.59870505, 'auroc': 0.8054893, 'binary_precision': 0.17443408, 'binary_recall': 0.31566265, 'binary_specificity': 0.962943, 'binary_f1_score': 0.22469981}
confusion matrix:
       0    1
0  16111  620
1    284  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9078505, 'precision': 0.69999194, 'recall': 0.7867274, 'specificity': 0.7867274, 'f1': 0.732586, 'auroc': 0.89577484, 'binary_precision': 0.43067592, 'binary_recall': 0.6437824, 'binary_specificity': 0.9296724, 'binary_f1_score': 0.51609546}
confusion matrix:
      0    1
0  8685  657
1   275  497
early stop counter: 1
val acc:0.9472763538360596, best validation acc: 0.9476262927055359, corresponding to test acc:                         0.9086414575576782 / 0.9118053913116455
after epoch: 6,now: 2024-08-11 01:28:04.496322,epoch time: 0:13:19.386927,used: 1:21:04.687007,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9596889, 'precision': 0.9606143, 'recall': 0.9597058, 'specificity': 0.9597058, 'f1': 0.9596697, 'auroc': 0.991109, 'binary_precision': 0.9814486, 'binary_recall': 0.9371523, 'binary_specificity': 0.9822593, 'binary_f1_score': 0.9587891}
confusion matrix:
       0      1
0  24860    449
1   1593  23754
---- Validation: 
scalar performance:
{'acc': 0.9329873, 'precision': 0.5759526, 'recall': 0.6930777, 'specificity': 0.6930777, 'f1': 0.6032645, 'auroc': 0.8177659, 'binary_precision': 0.16636364, 'binary_recall': 0.44096386, 'binary_specificity': 0.94519156, 'binary_f1_score': 0.24158415}
confusion matrix:
       0    1
0  15814  917
1    232  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89519477, 'precision': 0.6870691, 'recall': 0.81909037, 'specificity': 0.81909037, 'f1': 0.72817206, 'auroc': 0.898744, 'binary_precision': 0.39816123, 'binary_recall': 0.72927463, 'binary_specificity': 0.90890604, 'binary_f1_score': 0.515096}
confusion matrix:
      0    1
0  8491  851
1   209  563
early stop counter: 2
val acc:0.9329872727394104, best validation acc: 0.9476262927055359, corresponding to test acc:                         0.9086414575576782 / 0.9118053913116455
after epoch: 7,now: 2024-08-11 01:41:23.107454,epoch time: 0:13:18.611132,used: 1:34:23.298139,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9579122, 'precision': 0.95916647, 'recall': 0.9579308, 'specificity': 0.9579308, 'f1': 0.95788455, 'auroc': 0.9909755, 'binary_precision': 0.98334306, 'binary_recall': 0.9316657, 'binary_specificity': 0.98419595, 'binary_f1_score': 0.9568071}
confusion matrix:
       0      1
0  24910    400
1   1732  23614
---- Validation: 
scalar performance:
{'acc': 0.9417357, 'precision': 0.585549, 'recall': 0.68581104, 'specificity': 0.68581104, 'f1': 0.6134638, 'auroc': 0.8223176, 'binary_precision': 0.1860215, 'binary_recall': 0.41686746, 'binary_specificity': 0.95475465, 'binary_f1_score': 0.2572491}
confusion matrix:
       0    1
0  15974  757
1    242  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8997429, 'precision': 0.6917775, 'recall': 0.8114518, 'specificity': 0.8114518, 'f1': 0.7312822, 'auroc': 0.89804846, 'binary_precision': 0.40929535, 'binary_recall': 0.7072539, 'binary_specificity': 0.9156498, 'binary_f1_score': 0.51851845}
confusion matrix:
      0    1
0  8554  788
1   226  546
early stop counter: 3
val acc:0.9417356848716736, best validation acc: 0.9476262927055359, corresponding to test acc:                         0.9086414575576782 / 0.9118053913116455
after epoch: 8,now: 2024-08-11 01:54:41.401423,epoch time: 0:13:18.293969,used: 1:47:41.592108,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96067595, 'precision': 0.96207595, 'recall': 0.9606945, 'specificity': 0.9606945, 'f1': 0.9606472, 'auroc': 0.9920398, 'binary_precision': 0.98767906, 'binary_recall': 0.933044, 'binary_specificity': 0.98834497, 'binary_f1_score': 0.95958453}
confusion matrix:
       0      1
0  25016    295
1   1697  23648
---- Validation: 
scalar performance:
{'acc': 0.94226056, 'precision': 0.5952489, 'recall': 0.7154534, 'specificity': 0.7154534, 'f1': 0.6278143, 'auroc': 0.84102964, 'binary_precision': 0.2039135, 'binary_recall': 0.47710842, 'binary_specificity': 0.95379835, 'binary_f1_score': 0.2857143}
confusion matrix:
       0    1
0  15958  773
1    217  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89648014, 'precision': 0.6890589, 'recall': 0.8203802, 'specificity': 0.8203802, 'f1': 0.73031235, 'auroc': 0.90046453, 'binary_precision': 0.40199572, 'binary_recall': 0.73056996, 'binary_specificity': 0.9101905, 'binary_f1_score': 0.51862067}
confusion matrix:
      0    1
0  8503  839
1   208  564
early stop counter: 4
val acc:0.9422605633735657, best validation acc: 0.9476262927055359, corresponding to test acc:                         0.9086414575576782 / 0.9118053913116455
after epoch: 9,now: 2024-08-11 02:08:00.642584,epoch time: 0:13:19.241161,used: 2:01:00.833269,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96365684, 'precision': 0.96446586, 'recall': 0.9636709, 'specificity': 0.9636709, 'f1': 0.96364176, 'auroc': 0.9928131, 'binary_precision': 0.98401976, 'binary_recall': 0.9426711, 'binary_specificity': 0.9846707, 'binary_f1_score': 0.9629018}
confusion matrix:
       0      1
0  24923    388
1   1453  23892
---- Validation: 
scalar performance:
{'acc': 0.9342121, 'precision': 0.59019876, 'recall': 0.7407026, 'specificity': 0.7407026, 'f1': 0.624439, 'auroc': 0.85112786, 'binary_precision': 0.19240725, 'binary_recall': 0.5373494, 'binary_specificity': 0.9440559, 'binary_f1_score': 0.28335452}
confusion matrix:
       0    1
0  15795  936
1    192  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88550526, 'precision': 0.6790707, 'recall': 0.8358286, 'specificity': 0.8358286, 'f1': 0.7220522, 'auroc': 0.90293694, 'binary_precision': 0.3783102, 'binary_recall': 0.77720207, 'binary_specificity': 0.89445513, 'binary_f1_score': 0.5089058}
confusion matrix:
      0    1
0  8356  986
1   172  600
early stop counter: 5
val acc:0.9342120885848999, best validation acc: 0.9476262927055359, corresponding to test acc:                         0.9086414575576782 / 0.9118053913116455
after epoch: 10,now: 2024-08-11 02:21:19.122976,epoch time: 0:13:18.480392,used: 2:14:19.313661,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96391344, 'precision': 0.96469617, 'recall': 0.9639249, 'specificity': 0.9639249, 'f1': 0.9638989, 'auroc': 0.9931926, 'binary_precision': 0.9839068, 'binary_recall': 0.9432957, 'binary_specificity': 0.984554, 'binary_f1_score': 0.9631734}
confusion matrix:
       0      1
0  24923    391
1   1437  23905
---- Validation: 
scalar performance:
{'acc': 0.9371282, 'precision': 0.593953, 'recall': 0.73984706, 'specificity': 0.73984706, 'f1': 0.6289478, 'auroc': 0.8519412, 'binary_precision': 0.2, 'binary_recall': 0.5325301, 'binary_specificity': 0.94716394, 'binary_f1_score': 0.29078948}
confusion matrix:
       0    1
0  15847  884
1    194  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89035, 'precision': 0.6841352, 'recall': 0.83369803, 'specificity': 0.83369803, 'f1': 0.7272599, 'auroc': 0.9037281, 'binary_precision': 0.38921762, 'binary_recall': 0.7668394, 'binary_specificity': 0.9005566, 'binary_f1_score': 0.51635414}
confusion matrix:
      0    1
0  8413  929
1   180  592
early stop counter: 6
val acc:0.9371281862258911, best validation acc: 0.9476262927055359, corresponding to test acc:                         0.9086414575576782 / 0.9118053913116455
after epoch: 11,now: 2024-08-11 02:34:39.006975,epoch time: 0:13:19.883999,used: 2:27:39.197660,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9641306, 'precision': 0.96502703, 'recall': 0.96414363, 'specificity': 0.96414363, 'f1': 0.964114, 'auroc': 0.99376976, 'binary_precision': 0.9855928, 'binary_recall': 0.9420747, 'binary_specificity': 0.9862126, 'binary_f1_score': 0.9633425}
confusion matrix:
       0      1
0  24964    349
1   1468  23875
---- Validation: 
scalar performance:
{'acc': 0.94663477, 'precision': 0.6041548, 'recall': 0.7188697, 'specificity': 0.7188697, 'f1': 0.6376889, 'auroc': 0.85828674, 'binary_precision': 0.22160356, 'binary_recall': 0.4795181, 'binary_specificity': 0.95822126, 'binary_f1_score': 0.30312264}
confusion matrix:
       0    1
0  16032  699
1    216  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8960846, 'precision': 0.68848205, 'recall': 0.8201662, 'specificity': 0.8201662, 'f1': 0.72971916, 'auroc': 0.89884055, 'binary_precision': 0.4008529, 'binary_recall': 0.73056996, 'binary_specificity': 0.9097624, 'binary_f1_score': 0.51766866}
confusion matrix:
      0    1
0  8499  843
1   208  564
early stop counter: 7
val acc:0.9466347694396973, best validation acc: 0.9476262927055359, corresponding to test acc:                         0.9086414575576782 / 0.9118053913116455
after epoch: 12,now: 2024-08-11 02:47:58.593652,epoch time: 0:13:19.586677,used: 2:40:58.784337,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9690856, 'precision': 0.96951836, 'recall': 0.96909463, 'specificity': 0.96909463, 'f1': 0.9690789, 'auroc': 0.9944122, 'binary_precision': 0.9839215, 'binary_recall': 0.95379394, 'binary_specificity': 0.9843954, 'binary_f1_score': 0.96862346}
confusion matrix:
       0      1
0  24918    395
1   1171  24172
---- Validation: 
scalar performance:
{'acc': 0.9387029, 'precision': 0.6009177, 'recall': 0.7582779, 'specificity': 0.7582779, 'f1': 0.63892084, 'auroc': 0.866171, 'binary_precision': 0.2129964, 'binary_recall': 0.5686747, 'binary_specificity': 0.94788116, 'binary_f1_score': 0.30991465}
confusion matrix:
       0    1
0  15859  872
1    179  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8839233, 'precision': 0.67539704, 'recall': 0.82724833, 'specificity': 0.82724833, 'f1': 0.71717, 'auroc': 0.8987705, 'binary_precision': 0.37246192, 'binary_recall': 0.7603627, 'binary_specificity': 0.89413404, 'binary_f1_score': 0.49999994}
confusion matrix:
      0    1
0  8353  989
1   185  587
early stop counter: 8
val acc:0.9387028813362122, best validation acc: 0.9476262927055359, corresponding to test acc:                         0.9086414575576782 / 0.9118053913116455
after epoch: 13,now: 2024-08-11 03:01:17.822405,epoch time: 0:13:19.228753,used: 2:54:18.013090,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9668746, 'precision': 0.96795774, 'recall': 0.96688986, 'specificity': 0.96688986, 'f1': 0.9668562, 'auroc': 0.99468637, 'binary_precision': 0.99062943, 'binary_recall': 0.9427083, 'binary_specificity': 0.9910714, 'binary_f1_score': 0.966075}
confusion matrix:
       0      1
0  25086    226
1   1452  23892
---- Validation: 
scalar performance:
{'acc': 0.9536335, 'precision': 0.6188482, 'recall': 0.71423125, 'specificity': 0.71423125, 'f1': 0.6508455, 'auroc': 0.8630508, 'binary_precision': 0.2513089, 'binary_recall': 0.4626506, 'binary_specificity': 0.96581197, 'binary_f1_score': 0.32569975}
confusion matrix:
       0    1
0  16159  572
1    223  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9005339, 'precision': 0.6932646, 'recall': 0.8130683, 'specificity': 0.8130683, 'f1': 0.7329539, 'auroc': 0.89825976, 'binary_precision': 0.41203007, 'binary_recall': 0.7098446, 'binary_specificity': 0.916292, 'binary_f1_score': 0.52140814}
confusion matrix:
      0    1
0  8560  782
1   224  548
better model found
persisted
after epoch: 14,now: 2024-08-11 03:14:37.469056,epoch time: 0:13:19.646651,used: 3:07:37.659741,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96880925, 'precision': 0.9694204, 'recall': 0.96881855, 'specificity': 0.96881855, 'f1': 0.9687995, 'auroc': 0.9947617, 'binary_precision': 0.98648703, 'binary_recall': 0.9506728, 'binary_specificity': 0.9869642, 'binary_f1_score': 0.9682489}
confusion matrix:
       0      1
0  24985    330
1   1250  24091
---- Validation: 
scalar performance:
{'acc': 0.952642, 'precision': 0.61394477, 'recall': 0.7066736, 'specificity': 0.7066736, 'f1': 0.6448317, 'auroc': 0.8632487, 'binary_precision': 0.24187256, 'binary_recall': 0.44819278, 'binary_specificity': 0.9651545, 'binary_f1_score': 0.3141892}
confusion matrix:
       0    1
0  16148  583
1    229  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8985565, 'precision': 0.68830514, 'recall': 0.8030857, 'specificity': 0.8030857, 'f1': 0.72649384, 'auroc': 0.8929701, 'binary_precision': 0.40378788, 'binary_recall': 0.6904145, 'binary_specificity': 0.9157568, 'binary_f1_score': 0.5095602}
confusion matrix:
      0    1
0  8555  787
1   239  533
early stop counter: 1
val acc:0.952642023563385, best validation acc: 0.9536334872245789, corresponding to test acc:                         0.90053391456604 / 0.9118053913116455
after epoch: 15,now: 2024-08-11 03:27:57.379318,epoch time: 0:13:19.910262,used: 3:20:57.570003,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_06_58_seed_0_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:20:57.570003 at 2024-08-11 03:27:57.379318
persisted model performance metric: 

scalar performance:
{'acc': 0.9005339, 'precision': 0.6932646, 'recall': 0.8130683, 'specificity': 0.8130683, 'f1': 0.7329539, 'auroc': 0.89825976, 'binary_precision': 0.41203007, 'binary_recall': 0.7098446, 'binary_specificity': 0.916292, 'binary_f1_score': 0.52140814}
confusion matrix:
      0    1
0  8560  782
1   224  548
oracle model performance metric: 

scalar performance:
{'acc': 0.9118054, 'precision': 0.65553427, 'recall': 0.5981472, 'specificity': 0.5981472, 'f1': 0.6179856, 'auroc': 0.81268084, 'binary_precision': 0.37288135, 'binary_recall': 0.22797927, 'binary_specificity': 0.9683151, 'binary_f1_score': 0.2829582}
confusion matrix:
      0    1
0  9046  296
1   596  176
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    837 MiB |   8473 MiB | 351616 GiB | 351615 GiB |
|       from large pool |    799 MiB |   8430 MiB | 346043 GiB | 346043 GiB |
|       from small pool |     37 MiB |     77 MiB |   5572 GiB |   5572 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    837 MiB |   8473 MiB | 351616 GiB | 351615 GiB |
|       from large pool |    799 MiB |   8430 MiB | 346043 GiB | 346043 GiB |
|       from small pool |     37 MiB |     77 MiB |   5572 GiB |   5572 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    832 MiB |   8469 MiB | 351478 GiB | 351478 GiB |
|       from large pool |    796 MiB |   8426 MiB | 345917 GiB | 345917 GiB |
|       from small pool |     36 MiB |     76 MiB |   5560 GiB |   5560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9154 MiB |   9154 MiB |   9154 MiB |      0 B   |
|       from large pool |   9068 MiB |   9068 MiB |   9068 MiB |      0 B   |
|       from small pool |     86 MiB |     86 MiB |     86 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  70384 KiB |   1123 MiB | 212136 GiB | 212136 GiB |
|       from large pool |  59734 KiB |   1121 MiB | 206561 GiB | 206561 GiB |
|       from small pool |  10650 KiB |     13 MiB |   5575 GiB |   5575 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4918    |    7321    |   68987 K  |   68982 K  |
|       from large pool |     161    |     844    |   32632 K  |   32632 K  |
|       from small pool |    4757    |    7158    |   36355 K  |   36350 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4918    |    7321    |   68987 K  |   68982 K  |
|       from large pool |     161    |     844    |   32632 K  |   32632 K  |
|       from small pool |    4757    |    7158    |   36355 K  |   36350 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     340    |     340    |     340    |       0    |
|       from large pool |     297    |     297    |     297    |       0    |
|       from small pool |      43    |      43    |      43    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3203    |   37217 K  |   37217 K  |
|       from large pool |      19    |     300    |   21505 K  |   21505 K  |
|       from small pool |      49    |    3185    |   15712 K  |   15712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8473 MiB | 351616 GiB | 351616 GiB |
|       from large pool |  16640 KiB |   8430 MiB | 346043 GiB | 346043 GiB |
|       from small pool |      0 KiB |     77 MiB |   5572 GiB |   5572 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8473 MiB | 351616 GiB | 351616 GiB |
|       from large pool |  16640 KiB |   8430 MiB | 346043 GiB | 346043 GiB |
|       from small pool |      0 KiB |     77 MiB |   5572 GiB |   5572 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8469 MiB | 351478 GiB | 351478 GiB |
|       from large pool |  16640 KiB |   8426 MiB | 345917 GiB | 345917 GiB |
|       from small pool |      0 KiB |     76 MiB |   5560 GiB |   5560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |   9154 MiB |   9154 MiB |   8248 MiB |
|       from large pool |    858 MiB |   9068 MiB |   9068 MiB |   8210 MiB |
|       from small pool |     48 MiB |     86 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1123 MiB | 212137 GiB | 212137 GiB |
|       from large pool |  30464 KiB |   1121 MiB | 206561 GiB | 206561 GiB |
|       from small pool |      0 KiB |     28 MiB |   5575 GiB |   5575 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68987 K  |   68987 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36355 K  |   36355 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68987 K  |   68987 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36355 K  |   36355 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     340    |     340    |     289    |
|       from large pool |      27    |     297    |     297    |     270    |
|       from small pool |      24    |      43    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3203    |   37219 K  |   37219 K  |
|       from large pool |       2    |     300    |   21505 K  |   21505 K  |
|       from small pool |       0    |    3185    |   15714 K  |   15714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8473 MiB | 351616 GiB | 351616 GiB |
|       from large pool |  16640 KiB |   8430 MiB | 346043 GiB | 346043 GiB |
|       from small pool |      0 KiB |     77 MiB |   5572 GiB |   5572 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8473 MiB | 351616 GiB | 351616 GiB |
|       from large pool |  16640 KiB |   8430 MiB | 346043 GiB | 346043 GiB |
|       from small pool |      0 KiB |     77 MiB |   5572 GiB |   5572 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8469 MiB | 351478 GiB | 351478 GiB |
|       from large pool |  16640 KiB |   8426 MiB | 345917 GiB | 345917 GiB |
|       from small pool |      0 KiB |     76 MiB |   5560 GiB |   5560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |   9154 MiB |   9154 MiB |   8248 MiB |
|       from large pool |    858 MiB |   9068 MiB |   9068 MiB |   8210 MiB |
|       from small pool |     48 MiB |     86 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1123 MiB | 212137 GiB | 212137 GiB |
|       from large pool |  30464 KiB |   1121 MiB | 206561 GiB | 206561 GiB |
|       from small pool |      0 KiB |     28 MiB |   5575 GiB |   5575 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68987 K  |   68987 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36355 K  |   36355 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68987 K  |   68987 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36355 K  |   36355 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     340    |     340    |     289    |
|       from large pool |      27    |     297    |     297    |     270    |
|       from small pool |      24    |      43    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3203    |   37219 K  |   37219 K  |
|       from large pool |       2    |     300    |   21505 K  |   21505 K  |
|       from small pool |       0    |    3185    |   15714 K  |   15714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971

 Experiment start at: 2024-08-11 03:35:24.364567
before training, model accuracy: 0.6325438618659973
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8736229, 'precision': 0.8739132, 'recall': 0.87363553, 'specificity': 0.87363553, 'f1': 0.87360096, 'auroc': 0.9492874, 'binary_precision': 0.88456094, 'binary_recall': 0.8596643, 'binary_specificity': 0.8876068, 'binary_f1_score': 0.87193495}
confusion matrix:
       0      1
0  22539   2854
1   3570  21869
---- Validation: 
scalar performance:
{'acc': 0.8987327, 'precision': 0.50606143, 'recall': 0.5186064, 'specificity': 0.5186064, 'f1': 0.5010268, 'auroc': 0.7021261, 'binary_precision': 0.03629893, 'binary_recall': 0.118329465, 'binary_specificity': 0.9188833, 'binary_f1_score': 0.055555556}
confusion matrix:
       0     1
0  15338  1354
1    380    51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85452384, 'precision': 0.4804531, 'recall': 0.48012146, 'specificity': 0.48012146, 'f1': 0.4802854, 'auroc': 0.62109995, 'binary_precision': 0.038910504, 'binary_recall': 0.03963012, 'binary_specificity': 0.9206128, 'binary_f1_score': 0.039267015}
confusion matrix:
      0    1
0  8593  741
1   727   30
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 03:49:36.179746,epoch time: 0:14:11.815179,used: 0:14:11.815179,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.91416824, 'precision': 0.91950893, 'recall': 0.91420823, 'specificity': 0.91420823, 'f1': 0.91389966, 'auroc': 0.9713409, 'binary_precision': 0.9670198, 'binary_recall': 0.8577101, 'binary_specificity': 0.97070634, 'binary_f1_score': 0.9090909}
confusion matrix:
       0      1
0  24654    744
1   3619  21815
---- Validation: 
scalar performance:
{'acc': 0.95316243, 'precision': 0.51203436, 'recall': 0.5114897, 'specificity': 0.5114897, 'f1': 0.51174843, 'auroc': 0.77196026, 'binary_precision': 0.048661802, 'binary_recall': 0.046403714, 'binary_specificity': 0.9765756, 'binary_f1_score': 0.047505934}
confusion matrix:
       0    1
0  16301  391
1    411   20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9119017, 'precision': 0.50096786, 'recall': 0.5002123, 'specificity': 0.5002123, 'f1': 0.49007535, 'auroc': 0.7036819, 'binary_precision': 0.07692308, 'binary_recall': 0.015852047, 'binary_specificity': 0.9845725, 'binary_f1_score': 0.026286965}
confusion matrix:
      0    1
0  9190  144
1   745   12
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 04:03:03.640689,epoch time: 0:13:27.460943,used: 0:27:39.276122,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9349819, 'precision': 0.9370066, 'recall': 0.93501014, 'specificity': 0.93501014, 'f1': 0.93490934, 'auroc': 0.9801183, 'binary_precision': 0.96695924, 'binary_recall': 0.9008531, 'binary_specificity': 0.9691672, 'binary_f1_score': 0.9327363}
confusion matrix:
       0      1
0  24612    783
1   2522  22915
---- Validation: 
scalar performance:
{'acc': 0.9539216, 'precision': 0.56939423, 'recall': 0.58420795, 'specificity': 0.58420795, 'f1': 0.5759235, 'auroc': 0.81413233, 'binary_precision': 0.15969582, 'binary_recall': 0.1948956, 'binary_specificity': 0.9735203, 'binary_f1_score': 0.17554858}
confusion matrix:
       0    1
0  16250  442
1    347   84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9111089, 'precision': 0.53643864, 'recall': 0.5101016, 'specificity': 0.5101016, 'f1': 0.5070399, 'auroc': 0.75722384, 'binary_precision': 0.14646465, 'binary_recall': 0.038309116, 'binary_specificity': 0.98189414, 'binary_f1_score': 0.060732987}
confusion matrix:
      0    1
0  9165  169
1   728   29
better model found
persisted
after epoch: 3,now: 2024-08-11 04:16:29.524475,epoch time: 0:13:25.883786,used: 0:41:05.159908,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9425165, 'precision': 0.9439093, 'recall': 0.94253755, 'specificity': 0.94253755, 'f1': 0.9424732, 'auroc': 0.9826673, 'binary_precision': 0.9689622, 'binary_recall': 0.9144093, 'binary_specificity': 0.9706658, 'binary_f1_score': 0.9408956}
confusion matrix:
       0      1
0  24652    745
1   2177  23258
---- Validation: 
scalar performance:
{'acc': 0.9539216, 'precision': 0.59455216, 'recall': 0.63280386, 'specificity': 0.63280386, 'f1': 0.60988265, 'auroc': 0.84379935, 'binary_precision': 0.20751634, 'binary_recall': 0.29466358, 'binary_specificity': 0.97094417, 'binary_f1_score': 0.24352829}
confusion matrix:
       0    1
0  16207  485
1    304  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9120008, 'precision': 0.57237315, 'recall': 0.5233294, 'specificity': 0.5233294, 'f1': 0.52747506, 'auroc': 0.7910626, 'binary_precision': 0.21645021, 'binary_recall': 0.0660502, 'binary_specificity': 0.9806085, 'binary_f1_score': 0.10121458}
confusion matrix:
      0    1
0  9153  181
1   707   50
new oracle model saved
early stop counter: 1
val acc:0.9539216160774231, best validation acc: 0.9539216160774231, corresponding to test acc:                         0.9111089110374451 / 0.9120007753372192
after epoch: 4,now: 2024-08-11 04:29:57.650734,epoch time: 0:13:28.126259,used: 0:54:33.286167,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94875276, 'precision': 0.9506558, 'recall': 0.9487797, 'specificity': 0.9487797, 'f1': 0.94870067, 'auroc': 0.98587227, 'binary_precision': 0.9801481, 'binary_recall': 0.9161458, 'binary_specificity': 0.98141366, 'binary_f1_score': 0.94706684}
confusion matrix:
       0      1
0  24923    472
1   2133  23304
---- Validation: 
scalar performance:
{'acc': 0.95468086, 'precision': 0.61079866, 'recall': 0.66709745, 'specificity': 0.66709745, 'f1': 0.6323344, 'auroc': 0.8633355, 'binary_precision': 0.23823975, 'binary_recall': 0.36426914, 'binary_specificity': 0.9699257, 'binary_f1_score': 0.2880734}
confusion matrix:
       0    1
0  16190  502
1    274  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9178476, 'precision': 0.6167949, 'recall': 0.53013146, 'specificity': 0.53013146, 'f1': 0.53796864, 'auroc': 0.81072706, 'binary_precision': 0.3043478, 'binary_recall': 0.07397622, 'binary_specificity': 0.9862867, 'binary_f1_score': 0.11902231}
confusion matrix:
      0    1
0  9206  128
1   701   56
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 04:43:25.485942,epoch time: 0:13:27.835208,used: 1:08:01.121375,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95384794, 'precision': 0.95442915, 'recall': 0.9538622, 'specificity': 0.9538622, 'f1': 0.9538342, 'auroc': 0.9883497, 'binary_precision': 0.97087854, 'binary_recall': 0.935839, 'binary_specificity': 0.9718853, 'binary_f1_score': 0.95303684}
confusion matrix:
       0      1
0  24682    714
1   1632  23804
---- Validation: 
scalar performance:
{'acc': 0.94451904, 'precision': 0.5996384, 'recall': 0.7037005, 'specificity': 0.7037005, 'f1': 0.6305584, 'auroc': 0.87386477, 'binary_precision': 0.21389195, 'binary_recall': 0.450116, 'binary_specificity': 0.9572849, 'binary_f1_score': 0.28998506}
confusion matrix:
       0    1
0  15979  713
1    237  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9166584, 'precision': 0.6358662, 'recall': 0.5495175, 'specificity': 0.5495175, 'f1': 0.5653972, 'auroc': 0.83013475, 'binary_precision': 0.33969465, 'binary_recall': 0.11756935, 'binary_specificity': 0.98146564, 'binary_f1_score': 0.17468105}
confusion matrix:
      0    1
0  9161  173
1   668   89
early stop counter: 1
val acc:0.94451904296875, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.9178475737571716
after epoch: 6,now: 2024-08-11 04:56:53.216913,epoch time: 0:13:27.730971,used: 1:21:28.852346,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9574284, 'precision': 0.9583415, 'recall': 0.95744693, 'specificity': 0.95744693, 'f1': 0.95740837, 'auroc': 0.98928595, 'binary_precision': 0.9790063, 'binary_recall': 0.93497664, 'binary_specificity': 0.9799173, 'binary_f1_score': 0.95648503}
confusion matrix:
       0      1
0  24885    510
1   1654  23783
---- Validation: 
scalar performance:
{'acc': 0.93692696, 'precision': 0.59320635, 'recall': 0.72466946, 'specificity': 0.72466946, 'f1': 0.62636054, 'auroc': 0.8764398, 'binary_precision': 0.19981499, 'binary_recall': 0.5011601, 'binary_specificity': 0.94817877, 'binary_f1_score': 0.2857143}
confusion matrix:
       0    1
0  15827  865
1    215  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9159647, 'precision': 0.650436, 'recall': 0.5703852, 'specificity': 0.5703852, 'f1': 0.5909234, 'auroc': 0.84479964, 'binary_precision': 0.36578172, 'binary_recall': 0.16380449, 'binary_specificity': 0.9769659, 'binary_f1_score': 0.22627737}
confusion matrix:
      0    1
0  9119  215
1   633  124
early stop counter: 2
val acc:0.9369269609451294, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.9178475737571716
after epoch: 7,now: 2024-08-11 05:10:20.531791,epoch time: 0:13:27.314878,used: 1:34:56.167224,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96071374, 'precision': 0.96116126, 'recall': 0.96072614, 'specificity': 0.96072614, 'f1': 0.9607049, 'auroc': 0.9908384, 'binary_precision': 0.9757256, 'binary_recall': 0.9449992, 'binary_specificity': 0.976453, 'binary_f1_score': 0.96011657}
confusion matrix:
       0      1
0  24798    598
1   1399  24037
---- Validation: 
scalar performance:
{'acc': 0.92197627, 'precision': 0.58137214, 'recall': 0.74751484, 'specificity': 0.74751484, 'f1': 0.61276793, 'auroc': 0.87813383, 'binary_precision': 0.17469446, 'binary_recall': 0.5638051, 'binary_specificity': 0.9312245, 'binary_f1_score': 0.26673985}
confusion matrix:
       0     1
0  15544  1148
1    188   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9154692, 'precision': 0.6633447, 'recall': 0.5956086, 'specificity': 0.5956086, 'f1': 0.61763346, 'auroc': 0.84338266, 'binary_precision': 0.38785046, 'binary_recall': 0.21928665, 'binary_specificity': 0.97193056, 'binary_f1_score': 0.28016877}
confusion matrix:
      0    1
0  9072  262
1   591  166
early stop counter: 3
val acc:0.9219762682914734, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.9178475737571716
after epoch: 8,now: 2024-08-11 05:23:46.076347,epoch time: 0:13:25.544556,used: 1:48:21.711780,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96299577, 'precision': 0.96359086, 'recall': 0.9630085, 'specificity': 0.9630085, 'f1': 0.96298456, 'auroc': 0.99176526, 'binary_precision': 0.98037934, 'binary_recall': 0.9449556, 'binary_specificity': 0.9810615, 'binary_f1_score': 0.9623416}
confusion matrix:
       0      1
0  24917    481
1   1400  24034
---- Validation: 
scalar performance:
{'acc': 0.92366993, 'precision': 0.58324295, 'recall': 0.7483835, 'specificity': 0.7483835, 'f1': 0.61539024, 'auroc': 0.8803514, 'binary_precision': 0.17841409, 'binary_recall': 0.5638051, 'binary_specificity': 0.9329619, 'binary_f1_score': 0.2710541}
confusion matrix:
       0     1
0  15573  1119
1    188   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9181449, 'precision': 0.67969704, 'recall': 0.60494506, 'specificity': 0.60494506, 'f1': 0.6294433, 'auroc': 0.8517257, 'binary_precision': 0.41920376, 'binary_recall': 0.2364597, 'binary_specificity': 0.97343045, 'binary_f1_score': 0.30236486}
confusion matrix:
      0    1
0  9086  248
1   578  179
new oracle model saved
early stop counter: 4
val acc:0.9236699342727661, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.9181448817253113
after epoch: 9,now: 2024-08-11 05:37:12.845563,epoch time: 0:13:26.769216,used: 2:01:48.480996,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96362525, 'precision': 0.96449244, 'recall': 0.9636415, 'specificity': 0.9636415, 'f1': 0.96360916, 'auroc': 0.9922677, 'binary_precision': 0.9847501, 'binary_recall': 0.9418911, 'binary_specificity': 0.985392, 'binary_f1_score': 0.96284384}
confusion matrix:
       0      1
0  25026    371
1   1478  23957
---- Validation: 
scalar performance:
{'acc': 0.93190444, 'precision': 0.59106964, 'recall': 0.7424358, 'specificity': 0.7424358, 'f1': 0.62533003, 'auroc': 0.87995374, 'binary_precision': 0.19451371, 'binary_recall': 0.54292345, 'binary_specificity': 0.94194824, 'binary_f1_score': 0.28641373}
confusion matrix:
       0    1
0  15723  969
1    197  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.921316, 'precision': 0.69284594, 'recall': 0.59330666, 'specificity': 0.59330666, 'f1': 0.6208831, 'auroc': 0.85851085, 'binary_precision': 0.44729346, 'binary_recall': 0.20739762, 'binary_specificity': 0.97921574, 'binary_f1_score': 0.2833935}
confusion matrix:
      0    1
0  9140  194
1   600  157
new oracle model saved
early stop counter: 5
val acc:0.9319044351577759, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.9213160276412964
after epoch: 10,now: 2024-08-11 05:50:39.909491,epoch time: 0:13:27.063928,used: 2:15:15.544924,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9667139, 'precision': 0.9674677, 'recall': 0.96672976, 'specificity': 0.96672976, 'f1': 0.96670127, 'auroc': 0.9933479, 'binary_precision': 0.98643774, 'binary_recall': 0.94649315, 'binary_specificity': 0.98696643, 'binary_f1_score': 0.9660527}
confusion matrix:
       0      1
0  25065    331
1   1361  24075
---- Validation: 
scalar performance:
{'acc': 0.9324301, 'precision': 0.59237504, 'recall': 0.7449657, 'specificity': 0.7449657, 'f1': 0.627138, 'auroc': 0.88250005, 'binary_precision': 0.19699499, 'binary_recall': 0.5475638, 'binary_specificity': 0.9423676, 'binary_f1_score': 0.28974828}
confusion matrix:
       0    1
0  15730  962
1    195  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92161334, 'precision': 0.69459724, 'recall': 0.59286046, 'specificity': 0.59286046, 'f1': 0.62070286, 'auroc': 0.86050797, 'binary_precision': 0.45086706, 'binary_recall': 0.20607662, 'binary_specificity': 0.9796443, 'binary_f1_score': 0.2828649}
confusion matrix:
      0    1
0  9144  190
1   601  156
new oracle model saved
early stop counter: 6
val acc:0.93243008852005, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.921613335609436
after epoch: 11,now: 2024-08-11 06:04:07.527056,epoch time: 0:13:27.617565,used: 2:28:43.162489,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96818936, 'precision': 0.9685707, 'recall': 0.9682013, 'specificity': 0.9682013, 'f1': 0.9681834, 'auroc': 0.99370015, 'binary_precision': 0.9821472, 'binary_recall': 0.95376813, 'binary_specificity': 0.98263437, 'binary_f1_score': 0.96774966}
confusion matrix:
       0      1
0  24954    441
1   1176  24261
---- Validation: 
scalar performance:
{'acc': 0.9223267, 'precision': 0.5848896, 'recall': 0.7612562, 'specificity': 0.7612562, 'f1': 0.6180661, 'auroc': 0.8871237, 'binary_precision': 0.18097942, 'binary_recall': 0.5916473, 'binary_specificity': 0.9308651, 'binary_f1_score': 0.2771739}
confusion matrix:
       0     1
0  15538  1154
1    176   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92012686, 'precision': 0.69771945, 'recall': 0.63393545, 'specificity': 0.63393545, 'f1': 0.6578466, 'auroc': 0.86437523, 'binary_precision': 0.4509018, 'binary_recall': 0.2972259, 'binary_specificity': 0.97064495, 'binary_f1_score': 0.35828024}
confusion matrix:
      0    1
0  9060  274
1   532  225
early stop counter: 7
val acc:0.9223266839981079, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.921613335609436
after epoch: 12,now: 2024-08-11 06:17:34.347889,epoch time: 0:13:26.820833,used: 2:42:09.983322,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9686615, 'precision': 0.96904474, 'recall': 0.9686717, 'specificity': 0.9686717, 'f1': 0.96865547, 'auroc': 0.9940498, 'binary_precision': 0.98263085, 'binary_recall': 0.9542345, 'binary_specificity': 0.9831089, 'binary_f1_score': 0.96822447}
confusion matrix:
       0      1
0  24969    429
1   1164  24270
---- Validation: 
scalar performance:
{'acc': 0.90825206, 'precision': 0.57561076, 'recall': 0.7732495, 'specificity': 0.7732495, 'f1': 0.6041584, 'auroc': 0.8847681, 'binary_precision': 0.16152018, 'binary_recall': 0.63109046, 'binary_specificity': 0.91540855, 'binary_f1_score': 0.25721037}
confusion matrix:
       0     1
0  15280  1412
1    159   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91883856, 'precision': 0.6941787, 'recall': 0.6417361, 'specificity': 0.6417361, 'f1': 0.6625875, 'auroc': 0.8623833, 'binary_precision': 0.4425926, 'binary_recall': 0.31571993, 'binary_specificity': 0.9677523, 'binary_f1_score': 0.36854276}
confusion matrix:
      0    1
0  9033  301
1   518  239
early stop counter: 8
val acc:0.9082520604133606, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.921613335609436
after epoch: 13,now: 2024-08-11 06:31:03.933858,epoch time: 0:13:29.585969,used: 2:55:39.569291,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97112054, 'precision': 0.9713597, 'recall': 0.97112954, 'specificity': 0.97112954, 'f1': 0.97111726, 'auroc': 0.9948131, 'binary_precision': 0.9821759, 'binary_recall': 0.9597028, 'binary_specificity': 0.9825563, 'binary_f1_score': 0.9708093}
confusion matrix:
       0      1
0  24953    443
1   1025  24411
---- Validation: 
scalar performance:
{'acc': 0.90994567, 'precision': 0.5768009, 'recall': 0.7729881, 'specificity': 0.7729881, 'f1': 0.606066, 'auroc': 0.88633496, 'binary_precision': 0.16394435, 'binary_recall': 0.6287703, 'binary_specificity': 0.91720587, 'binary_f1_score': 0.26007676}
confusion matrix:
       0     1
0  15310  1382
1    160   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9186404, 'precision': 0.6907598, 'recall': 0.631918, 'specificity': 0.631918, 'f1': 0.65430397, 'auroc': 0.85964656, 'binary_precision': 0.4372549, 'binary_recall': 0.2945839, 'binary_specificity': 0.96925217, 'binary_f1_score': 0.3520126}
confusion matrix:
      0    1
0  9047  287
1   534  223
early stop counter: 9
val acc:0.9099456667900085, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.921613335609436
after epoch: 14,now: 2024-08-11 06:44:32.284448,epoch time: 0:13:28.350590,used: 3:09:07.919881,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97060907, 'precision': 0.97106194, 'recall': 0.97062206, 'specificity': 0.97062206, 'f1': 0.9706026, 'auroc': 0.994939, 'binary_precision': 0.985876, 'binary_recall': 0.95494753, 'binary_specificity': 0.98629653, 'binary_f1_score': 0.9701654}
confusion matrix:
       0      1
0  25047    348
1   1146  24291
---- Validation: 
scalar performance:
{'acc': 0.9101209, 'precision': 0.5757691, 'recall': 0.7674272, 'specificity': 0.7674272, 'f1': 0.6045243, 'auroc': 0.88546264, 'binary_precision': 0.16219512, 'binary_recall': 0.6171694, 'binary_specificity': 0.9176851, 'binary_f1_score': 0.25688073}
confusion matrix:
       0     1
0  15318  1374
1    165   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91933405, 'precision': 0.6952193, 'recall': 0.63775545, 'specificity': 0.63775545, 'f1': 0.66000384, 'auroc': 0.8598527, 'binary_precision': 0.4452975, 'binary_recall': 0.30647293, 'binary_specificity': 0.96903795, 'binary_f1_score': 0.3630673}
confusion matrix:
      0    1
0  9045  289
1   525  232
early stop counter: 10
val acc:0.9101209044456482, best validation acc: 0.954680860042572, corresponding to test acc:                         0.9178475737571716 / 0.921613335609436
after epoch: 15,now: 2024-08-11 06:57:58.877767,epoch time: 0:13:26.593319,used: 3:22:34.513200,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_03_35_23_seed_1_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:22:34.513200 at 2024-08-11 06:57:58.877767
persisted model performance metric: 

scalar performance:
{'acc': 0.9178476, 'precision': 0.6167949, 'recall': 0.53013146, 'specificity': 0.53013146, 'f1': 0.53796864, 'auroc': 0.81072706, 'binary_precision': 0.3043478, 'binary_recall': 0.07397622, 'binary_specificity': 0.9862867, 'binary_f1_score': 0.11902231}
confusion matrix:
      0    1
0  9206  128
1   701   56
oracle model performance metric: 

scalar performance:
{'acc': 0.92161334, 'precision': 0.69459724, 'recall': 0.59286046, 'specificity': 0.59286046, 'f1': 0.62070286, 'auroc': 0.86050797, 'binary_precision': 0.45086706, 'binary_recall': 0.20607662, 'binary_specificity': 0.9796443, 'binary_f1_score': 0.2828649}
confusion matrix:
      0    1
0  9144  190
1   601  156
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    838 MiB |   8474 MiB | 708162 GiB | 708161 GiB |
|       from large pool |    801 MiB |   8432 MiB | 696967 GiB | 696966 GiB |
|       from small pool |     37 MiB |     77 MiB |  11194 GiB |  11194 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    838 MiB |   8474 MiB | 708162 GiB | 708161 GiB |
|       from large pool |    801 MiB |   8432 MiB | 696967 GiB | 696966 GiB |
|       from small pool |     37 MiB |     77 MiB |  11194 GiB |  11194 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    832 MiB |   8469 MiB | 707920 GiB | 707920 GiB |
|       from large pool |    796 MiB |   8426 MiB | 696750 GiB | 696749 GiB |
|       from small pool |     36 MiB |     76 MiB |  11170 GiB |  11170 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9128 MiB |   9154 MiB |  17376 MiB |   8248 MiB |
|       from large pool |   9048 MiB |   9068 MiB |  17258 MiB |   8210 MiB |
|       from small pool |     80 MiB |     86 MiB |    118 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 253209 KiB |   1132 MiB | 428590 GiB | 428590 GiB |
|       from large pool | 238456 KiB |   1130 MiB | 417391 GiB | 417390 GiB |
|       from small pool |  14752 KiB |     28 MiB |  11199 GiB |  11199 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7343    |  138621 K  |  138616 K  |
|       from large pool |     161    |     844    |   65711 K  |   65711 K  |
|       from small pool |    4745    |    7180    |   72909 K  |   72904 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7343    |  138621 K  |  138616 K  |
|       from large pool |     161    |     844    |   65711 K  |   65711 K  |
|       from small pool |    4745    |    7180    |   72909 K  |   72904 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     336    |     340    |     625    |     289    |
|       from large pool |     296    |     297    |     566    |     270    |
|       from small pool |      40    |      43    |      59    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3211    |   73836 K  |   73836 K  |
|       from large pool |      18    |     300    |   42331 K  |   42331 K  |
|       from small pool |      50    |    3194    |   31504 K  |   31504 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8474 MiB | 708162 GiB | 708161 GiB |
|       from large pool |  16640 KiB |   8432 MiB | 696967 GiB | 696967 GiB |
|       from small pool |      0 KiB |     77 MiB |  11194 GiB |  11194 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8474 MiB | 708162 GiB | 708161 GiB |
|       from large pool |  16640 KiB |   8432 MiB | 696967 GiB | 696967 GiB |
|       from small pool |      0 KiB |     77 MiB |  11194 GiB |  11194 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8469 MiB | 707920 GiB | 707920 GiB |
|       from large pool |  16640 KiB |   8426 MiB | 696750 GiB | 696750 GiB |
|       from small pool |      0 KiB |     76 MiB |  11170 GiB |  11170 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1086 MiB |   9154 MiB |  17376 MiB |  16290 MiB |
|       from large pool |   1034 MiB |   9068 MiB |  17258 MiB |  16224 MiB |
|       from small pool |     52 MiB |     86 MiB |    118 MiB |     66 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1132 MiB | 428590 GiB | 428590 GiB |
|       from large pool |  30464 KiB |   1130 MiB | 417391 GiB | 417391 GiB |
|       from small pool |      0 KiB |     29 MiB |  11199 GiB |  11199 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138621 K  |  138621 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72909 K  |   72909 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138621 K  |  138621 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72909 K  |   72909 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     340    |     625    |     572    |
|       from large pool |      27    |     297    |     566    |     539    |
|       from small pool |      26    |      43    |      59    |      33    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3211    |   73838 K  |   73838 K  |
|       from large pool |       2    |     300    |   42331 K  |   42331 K  |
|       from small pool |       0    |    3194    |   31506 K  |   31506 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8474 MiB | 708162 GiB | 708161 GiB |
|       from large pool |  16640 KiB |   8432 MiB | 696967 GiB | 696967 GiB |
|       from small pool |      0 KiB |     77 MiB |  11194 GiB |  11194 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8474 MiB | 708162 GiB | 708161 GiB |
|       from large pool |  16640 KiB |   8432 MiB | 696967 GiB | 696967 GiB |
|       from small pool |      0 KiB |     77 MiB |  11194 GiB |  11194 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8469 MiB | 707920 GiB | 707920 GiB |
|       from large pool |  16640 KiB |   8426 MiB | 696750 GiB | 696750 GiB |
|       from small pool |      0 KiB |     76 MiB |  11170 GiB |  11170 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1086 MiB |   9154 MiB |  17376 MiB |  16290 MiB |
|       from large pool |   1034 MiB |   9068 MiB |  17258 MiB |  16224 MiB |
|       from small pool |     52 MiB |     86 MiB |    118 MiB |     66 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1132 MiB | 428590 GiB | 428590 GiB |
|       from large pool |  30464 KiB |   1130 MiB | 417391 GiB | 417391 GiB |
|       from small pool |      0 KiB |     29 MiB |  11199 GiB |  11199 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138621 K  |  138621 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72909 K  |   72909 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138621 K  |  138621 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72909 K  |   72909 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     340    |     625    |     572    |
|       from large pool |      27    |     297    |     566    |     539    |
|       from small pool |      26    |      43    |      59    |      33    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3211    |   73838 K  |   73838 K  |
|       from large pool |       2    |     300    |   42331 K  |   42331 K  |
|       from small pool |       0    |    3194    |   31506 K  |   31506 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971

 Experiment start at: 2024-08-11 07:05:30.254511
before training, model accuracy: 0.20035672187805176
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8930672, 'precision': 0.8935456, 'recall': 0.89306855, 'specificity': 0.89306855, 'f1': 0.8930349, 'auroc': 0.9604627, 'binary_precision': 0.9072872, 'binary_recall': 0.87562865, 'binary_specificity': 0.9105084, 'binary_f1_score': 0.8911768}
confusion matrix:
       0      1
0  23533   2313
1   3215  22635
---- Validation: 
scalar performance:
{'acc': 0.71028966, 'precision': 0.5173151, 'recall': 0.65092665, 'specificity': 0.65092665, 'f1': 0.45896935, 'auroc': 0.7202722, 'binary_precision': 0.048857994, 'binary_recall': 0.5885168, 'binary_specificity': 0.7133365, 'binary_f1_score': 0.09022557}
confusion matrix:
       0     1
0  11917  4789
1    172   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6902497, 'precision': 0.56451744, 'recall': 0.69992626, 'specificity': 0.69992626, 'f1': 0.5349449, 'auroc': 0.7565659, 'binary_precision': 0.16373087, 'binary_recall': 0.7114178, 'binary_specificity': 0.68843466, 'binary_f1_score': 0.2661972}
confusion matrix:
      0     1
0  6399  2896
1   230   567
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 07:20:06.177962,epoch time: 0:14:35.923451,used: 0:14:35.923451,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9260291, 'precision': 0.9281855, 'recall': 0.92603457, 'specificity': 0.92603457, 'f1': 0.9259365, 'auroc': 0.97573566, 'binary_precision': 0.95861095, 'binary_recall': 0.8905307, 'binary_specificity': 0.96153843, 'binary_f1_score': 0.9233176}
confusion matrix:
       0      1
0  24850    994
1   2830  23022
---- Validation: 
scalar performance:
{'acc': 0.8474656, 'precision': 0.5349293, 'recall': 0.69090843, 'specificity': 0.69090843, 'f1': 0.5302195, 'auroc': 0.7914137, 'binary_precision': 0.08352316, 'binary_recall': 0.5263158, 'binary_specificity': 0.855501, 'binary_f1_score': 0.14416777}
confusion matrix:
       0     1
0  14292  2414
1    198   220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8304598, 'precision': 0.6169235, 'recall': 0.7519529, 'specificity': 0.7519529, 'f1': 0.6410467, 'auroc': 0.8344046, 'binary_precision': 0.2673116, 'binary_recall': 0.6587202, 'binary_specificity': 0.8451856, 'binary_f1_score': 0.38029698}
confusion matrix:
      0     1
0  7856  1439
1   272   525
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 07:33:58.392026,epoch time: 0:13:52.214064,used: 0:28:28.137515,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93893147, 'precision': 0.9412607, 'recall': 0.9389413, 'specificity': 0.9389413, 'f1': 0.9388517, 'auroc': 0.98193884, 'binary_precision': 0.97338784, 'binary_recall': 0.90257204, 'binary_specificity': 0.97531056, 'binary_f1_score': 0.9366433}
confusion matrix:
       0      1
0  25203    638
1   2519  23336
---- Validation: 
scalar performance:
{'acc': 0.8960523, 'precision': 0.5538554, 'recall': 0.7123109, 'specificity': 0.7123109, 'f1': 0.57022965, 'auroc': 0.82365716, 'binary_precision': 0.120824054, 'binary_recall': 0.51913875, 'binary_specificity': 0.90548307, 'binary_f1_score': 0.1960253}
confusion matrix:
       0     1
0  15127  1579
1    201   217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8704915, 'precision': 0.656861, 'recall': 0.79031825, 'specificity': 0.79031825, 'f1': 0.692622, 'auroc': 0.8666283, 'binary_precision': 0.34239802, 'binary_recall': 0.6951066, 'binary_specificity': 0.8855299, 'binary_f1_score': 0.45879915}
confusion matrix:
      0     1
0  8231  1064
1   243   554
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 07:47:49.685697,epoch time: 0:13:51.293671,used: 0:42:19.431186,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9477716, 'precision': 0.94976157, 'recall': 0.9477793, 'specificity': 0.9477793, 'f1': 0.9477144, 'auroc': 0.9862048, 'binary_precision': 0.97973645, 'binary_recall': 0.91448134, 'binary_specificity': 0.9810773, 'binary_f1_score': 0.9459849}
confusion matrix:
       0      1
0  25353    489
1   2211  23643
---- Validation: 
scalar performance:
{'acc': 0.91649145, 'precision': 0.56889707, 'recall': 0.7239524, 'specificity': 0.7239524, 'f1': 0.59474725, 'auroc': 0.8407526, 'binary_precision': 0.15055248, 'binary_recall': 0.5215311, 'binary_specificity': 0.9263738, 'binary_f1_score': 0.23365486}
confusion matrix:
       0     1
0  15476  1230
1    200   218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.884562, 'precision': 0.6695863, 'recall': 0.78189707, 'specificity': 0.78189707, 'f1': 0.704837, 'auroc': 0.8751476, 'binary_precision': 0.37042254, 'binary_recall': 0.65997493, 'binary_specificity': 0.90381926, 'binary_f1_score': 0.47451517}
confusion matrix:
      0    1
0  8401  894
1   271  526
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 08:01:39.380676,epoch time: 0:13:49.694979,used: 0:56:09.126165,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9531492, 'precision': 0.9547027, 'recall': 0.95315707, 'specificity': 0.95315707, 'f1': 0.95310974, 'auroc': 0.9879708, 'binary_precision': 0.98134834, 'binary_recall': 0.9238832, 'binary_specificity': 0.982431, 'binary_f1_score': 0.9517492}
confusion matrix:
       0      1
0  25387    454
1   1968  23887
---- Validation: 
scalar performance:
{'acc': 0.91526514, 'precision': 0.5756483, 'recall': 0.75831115, 'specificity': 0.75831115, 'f1': 0.60491484, 'auroc': 0.85270786, 'binary_precision': 0.16219752, 'binary_recall': 0.5933014, 'binary_specificity': 0.92332095, 'binary_f1_score': 0.25475088}
confusion matrix:
       0     1
0  15425  1281
1    170   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.885652, 'precision': 0.6730445, 'recall': 0.79051864, 'specificity': 0.79051864, 'f1': 0.70957404, 'auroc': 0.8797146, 'binary_precision': 0.37578288, 'binary_recall': 0.6775408, 'binary_specificity': 0.9034965, 'binary_f1_score': 0.48343778}
confusion matrix:
      0    1
0  8398  897
1   257  540
new oracle model saved
early stop counter: 1
val acc:0.9152651429176331, best validation acc: 0.9164914488792419, corresponding to test acc:                         0.8845620155334473 / 0.8856520056724548
after epoch: 5,now: 2024-08-11 08:15:31.210471,epoch time: 0:13:51.829795,used: 1:10:00.955960,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.958372, 'precision': 0.95947915, 'recall': 0.9583787, 'specificity': 0.9583787, 'f1': 0.95834744, 'auroc': 0.99018544, 'binary_precision': 0.98210144, 'binary_recall': 0.93378454, 'binary_specificity': 0.9829728, 'binary_f1_score': 0.9573338}
confusion matrix:
       0      1
0  25401    440
1   1712  24143
---- Validation: 
scalar performance:
{'acc': 0.90732306, 'precision': 0.5709001, 'recall': 0.7635707, 'specificity': 0.7635707, 'f1': 0.59728086, 'auroc': 0.8573539, 'binary_precision': 0.1522903, 'binary_recall': 0.61244017, 'binary_specificity': 0.9147013, 'binary_f1_score': 0.24392569}
confusion matrix:
       0     1
0  15281  1425
1    162   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8825803, 'precision': 0.6701728, 'recall': 0.79343957, 'specificity': 0.79343957, 'f1': 0.70715046, 'auroc': 0.881642, 'binary_precision': 0.36927223, 'binary_recall': 0.68757844, 'binary_specificity': 0.8993007, 'binary_f1_score': 0.480491}
confusion matrix:
      0    1
0  8359  936
1   249  548
early stop counter: 2
val acc:0.9073230624198914, best validation acc: 0.9164914488792419, corresponding to test acc:                         0.8845620155334473 / 0.8856520056724548
after epoch: 6,now: 2024-08-11 08:29:20.952624,epoch time: 0:13:49.742153,used: 1:23:50.698113,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9614477, 'precision': 0.96250224, 'recall': 0.96145326, 'specificity': 0.96145326, 'f1': 0.961426, 'auroc': 0.99199504, 'binary_precision': 0.9846448, 'binary_recall': 0.93753386, 'binary_specificity': 0.98537266, 'binary_f1_score': 0.960512}
confusion matrix:
       0      1
0  25464    378
1   1615  24239
---- Validation: 
scalar performance:
{'acc': 0.9209297, 'precision': 0.58169293, 'recall': 0.7635468, 'specificity': 0.7635468, 'f1': 0.61394465, 'auroc': 0.85750353, 'binary_precision': 0.1740947, 'binary_recall': 0.5980861, 'binary_specificity': 0.92900753, 'binary_f1_score': 0.26968718}
confusion matrix:
       0     1
0  15520  1186
1    168   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89179546, 'precision': 0.6822798, 'recall': 0.7967216, 'specificity': 0.7967216, 'f1': 0.71944094, 'auroc': 0.8833945, 'binary_precision': 0.39350182, 'binary_recall': 0.6838143, 'binary_specificity': 0.9096288, 'binary_f1_score': 0.49954173}
confusion matrix:
      0    1
0  8455  840
1   252  545
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-11 08:43:13.919954,epoch time: 0:13:52.967330,used: 1:37:43.665443,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96262765, 'precision': 0.96327764, 'recall': 0.96263057, 'specificity': 0.96263057, 'f1': 0.9626147, 'auroc': 0.9920913, 'binary_precision': 0.9806688, 'binary_recall': 0.9438728, 'binary_specificity': 0.98138833, 'binary_f1_score': 0.961919}
confusion matrix:
       0      1
0  25363    481
1   1451  24401
---- Validation: 
scalar performance:
{'acc': 0.91368836, 'precision': 0.5779252, 'recall': 0.77499676, 'specificity': 0.77499676, 'f1': 0.6083185, 'auroc': 0.86216897, 'binary_precision': 0.16582598, 'binary_recall': 0.62918663, 'binary_specificity': 0.9208069, 'binary_f1_score': 0.26247504}
confusion matrix:
       0     1
0  15383  1323
1    155   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88812923, 'precision': 0.67655134, 'recall': 0.79243696, 'specificity': 0.79243696, 'f1': 0.71327746, 'auroc': 0.87993586, 'binary_precision': 0.38260254, 'binary_recall': 0.67879546, 'binary_specificity': 0.9060785, 'binary_f1_score': 0.48937133}
confusion matrix:
      0    1
0  8422  873
1   256  541
early stop counter: 1
val acc:0.9136883616447449, best validation acc: 0.9209296703338623, corresponding to test acc:                         0.8917954564094543 / 0.8917954564094543
after epoch: 8,now: 2024-08-11 08:57:16.468499,epoch time: 0:14:02.548545,used: 1:51:46.213988,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9654132, 'precision': 0.96623576, 'recall': 0.96541727, 'specificity': 0.96541727, 'f1': 0.9653982, 'auroc': 0.99283403, 'binary_precision': 0.98586714, 'binary_recall': 0.94437784, 'binary_specificity': 0.9864567, 'binary_f1_score': 0.9646767}
confusion matrix:
       0      1
0  25493    350
1   1438  24415
---- Validation: 
scalar performance:
{'acc': 0.9240832, 'precision': 0.5871876, 'recall': 0.774493, 'specificity': 0.774493, 'f1': 0.6220286, 'auroc': 0.86716545, 'binary_precision': 0.18454936, 'binary_recall': 0.6172249, 'binary_specificity': 0.931761, 'binary_f1_score': 0.28414097}
confusion matrix:
       0     1
0  15566  1140
1    160   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8947681, 'precision': 0.6845139, 'recall': 0.7885848, 'specificity': 0.7885848, 'f1': 0.71989954, 'auroc': 0.8806931, 'binary_precision': 0.39969718, 'binary_recall': 0.6624843, 'binary_specificity': 0.9146853, 'binary_f1_score': 0.49858353}
confusion matrix:
      0    1
0  8502  793
1   269  528
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-11 09:11:11.750033,epoch time: 0:13:55.281534,used: 2:05:41.495522,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96728957, 'precision': 0.96806157, 'recall': 0.96729505, 'specificity': 0.96729505, 'f1': 0.96727633, 'auroc': 0.9935031, 'binary_precision': 0.98713815, 'binary_recall': 0.9469348, 'binary_specificity': 0.9876553, 'binary_f1_score': 0.96661866}
confusion matrix:
       0      1
0  25522    319
1   1372  24483
---- Validation: 
scalar performance:
{'acc': 0.9207545, 'precision': 0.5853108, 'recall': 0.78095067, 'specificity': 0.78095067, 'f1': 0.6194679, 'auroc': 0.86951196, 'binary_precision': 0.18039483, 'binary_recall': 0.6339713, 'binary_specificity': 0.92793006, 'binary_f1_score': 0.2808691}
confusion matrix:
       0     1
0  15502  1204
1    153   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951645, 'precision': 0.68602407, 'recall': 0.7928149, 'specificity': 0.7928149, 'f1': 0.72211206, 'auroc': 0.8818507, 'binary_precision': 0.40195343, 'binary_recall': 0.6712673, 'binary_specificity': 0.91436255, 'binary_f1_score': 0.50281954}
confusion matrix:
      0    1
0  8499  796
1   262  535
new oracle model saved
early stop counter: 1
val acc:0.9207544922828674, best validation acc: 0.9240831732749939, corresponding to test acc:                         0.8947681188583374 / 0.8951644897460938
after epoch: 10,now: 2024-08-11 09:25:04.183850,epoch time: 0:13:52.433817,used: 2:19:33.929339,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96817935, 'precision': 0.9688715, 'recall': 0.9681823, 'specificity': 0.9681823, 'f1': 0.9681677, 'auroc': 0.99425113, 'binary_precision': 0.9869252, 'binary_recall': 0.9489401, 'binary_specificity': 0.98742455, 'binary_f1_score': 0.96755993}
confusion matrix:
       0      1
0  25519    325
1   1320  24532
---- Validation: 
scalar performance:
{'acc': 0.933602, 'precision': 0.59861547, 'recall': 0.7758727, 'specificity': 0.7758727, 'f1': 0.6373889, 'auroc': 0.8720983, 'binary_precision': 0.20748577, 'binary_recall': 0.6100478, 'binary_specificity': 0.9416976, 'binary_f1_score': 0.3096539}
confusion matrix:
       0    1
0  15732  974
1    163  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9019025, 'precision': 0.6927481, 'recall': 0.7758246, 'specificity': 0.7758246, 'f1': 0.7238022, 'auroc': 0.8819957, 'binary_precision': 0.41897565, 'binary_recall': 0.62609786, 'binary_specificity': 0.92555135, 'binary_f1_score': 0.502012}
confusion matrix:
      0    1
0  8603  692
1   298  499
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-11 09:38:57.681852,epoch time: 0:13:53.498002,used: 2:33:27.427341,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9686049, 'precision': 0.9690865, 'recall': 0.9686086, 'specificity': 0.9686086, 'f1': 0.96859705, 'auroc': 0.9940573, 'binary_precision': 0.98417455, 'binary_recall': 0.9525412, 'binary_specificity': 0.9846761, 'binary_f1_score': 0.96809953}
confusion matrix:
       0      1
0  25446    396
1   1227  24627
---- Validation: 
scalar performance:
{'acc': 0.92665267, 'precision': 0.59251016, 'recall': 0.786306, 'specificity': 0.786306, 'f1': 0.62981397, 'auroc': 0.8755716, 'binary_precision': 0.19460641, 'binary_recall': 0.638756, 'binary_specificity': 0.93385607, 'binary_f1_score': 0.29832402}
confusion matrix:
       0     1
0  15601  1105
1    151   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8995244, 'precision': 0.69079936, 'recall': 0.78485763, 'specificity': 0.78485763, 'f1': 0.724486, 'auroc': 0.88407606, 'binary_precision': 0.41326937, 'binary_recall': 0.64868253, 'binary_specificity': 0.9210328, 'binary_f1_score': 0.5048828}
confusion matrix:
      0    1
0  8561  734
1   280  517
early stop counter: 1
val acc:0.9266526699066162, best validation acc: 0.933601975440979, corresponding to test acc:                         0.9019024968147278 / 0.9019024968147278
after epoch: 12,now: 2024-08-11 09:52:51.328540,epoch time: 0:13:53.646688,used: 2:47:21.074029,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9728025, 'precision': 0.97305626, 'recall': 0.9728039, 'specificity': 0.9728039, 'f1': 0.97279894, 'auroc': 0.9953848, 'binary_precision': 0.98404026, 'binary_recall': 0.9612007, 'binary_specificity': 0.98440707, 'binary_f1_score': 0.97248644}
confusion matrix:
       0      1
0  25442    403
1   1003  24848
---- Validation: 
scalar performance:
{'acc': 0.9226232, 'precision': 0.588328, 'recall': 0.7865734, 'specificity': 0.7865734, 'f1': 0.62393373, 'auroc': 0.876095, 'binary_precision': 0.18615916, 'binary_recall': 0.6435407, 'binary_specificity': 0.92960614, 'binary_f1_score': 0.28878152}
confusion matrix:
       0     1
0  15530  1176
1    149   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8993262, 'precision': 0.6891037, 'recall': 0.77844095, 'specificity': 0.77844095, 'f1': 0.7215271, 'auroc': 0.88037515, 'binary_precision': 0.41104794, 'binary_recall': 0.6348808, 'binary_specificity': 0.92200106, 'binary_f1_score': 0.49901378}
confusion matrix:
      0    1
0  8570  725
1   291  506
early stop counter: 2
val acc:0.9226232171058655, best validation acc: 0.933601975440979, corresponding to test acc:                         0.9019024968147278 / 0.9019024968147278
after epoch: 13,now: 2024-08-11 10:06:44.513214,epoch time: 0:13:53.184674,used: 3:01:14.258703,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97317004, 'precision': 0.9735646, 'recall': 0.97317123, 'specificity': 0.97317123, 'f1': 0.9731645, 'auroc': 0.9955857, 'binary_precision': 0.98725253, 'binary_recall': 0.9587234, 'binary_specificity': 0.987619, 'binary_f1_score': 0.97277886}
confusion matrix:
       0      1
0  25526    320
1   1067  24783
---- Validation: 
scalar performance:
{'acc': 0.93348515, 'precision': 0.5968201, 'recall': 0.7688154, 'specificity': 0.7688154, 'f1': 0.6346441, 'auroc': 0.8735548, 'binary_precision': 0.20426579, 'binary_recall': 0.59569377, 'binary_specificity': 0.941937, 'binary_f1_score': 0.30421504}
confusion matrix:
       0    1
0  15736  970
1    169  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9049742, 'precision': 0.69862914, 'recall': 0.7786393, 'specificity': 0.7786393, 'f1': 0.729169, 'auroc': 0.88260734, 'binary_precision': 0.43041238, 'binary_recall': 0.6286073, 'binary_specificity': 0.9286713, 'binary_f1_score': 0.5109638}
confusion matrix:
      0    1
0  8632  663
1   296  501
new oracle model saved
early stop counter: 3
val acc:0.9334851503372192, best validation acc: 0.933601975440979, corresponding to test acc:                         0.9019024968147278 / 0.9049742221832275
after epoch: 14,now: 2024-08-11 10:20:37.314382,epoch time: 0:13:52.801168,used: 3:15:07.059871,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9732668, 'precision': 0.97380066, 'recall': 0.97327006, 'specificity': 0.97327006, 'f1': 0.9732594, 'auroc': 0.99579096, 'binary_precision': 0.989753, 'binary_recall': 0.95644605, 'binary_specificity': 0.990094, 'binary_f1_score': 0.97281456}
confusion matrix:
       0      1
0  25587    256
1   1126  24727
---- Validation: 
scalar performance:
{'acc': 0.93120766, 'precision': 0.5930973, 'recall': 0.76531565, 'specificity': 0.76531565, 'f1': 0.6296465, 'auroc': 0.8718442, 'binary_precision': 0.1969697, 'binary_recall': 0.59090906, 'binary_specificity': 0.93972224, 'binary_f1_score': 0.29545456}
confusion matrix:
       0     1
0  15699  1007
1    171   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90487516, 'precision': 0.69799167, 'recall': 0.77629125, 'specificity': 0.77629125, 'f1': 0.72801983, 'auroc': 0.8798433, 'binary_precision': 0.4295592, 'binary_recall': 0.62358844, 'binary_specificity': 0.92899406, 'binary_f1_score': 0.5087001}
confusion matrix:
      0    1
0  8635  660
1   300  497
early stop counter: 4
val acc:0.9312076568603516, best validation acc: 0.933601975440979, corresponding to test acc:                         0.9019024968147278 / 0.9049742221832275
after epoch: 15,now: 2024-08-11 10:34:29.821805,epoch time: 0:13:52.507423,used: 3:28:59.567294,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_07_05_29_seed_2_24141971
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:28:59.567294 at 2024-08-11 10:34:29.821805
persisted model performance metric: 

scalar performance:
{'acc': 0.9019025, 'precision': 0.6927481, 'recall': 0.7758246, 'specificity': 0.7758246, 'f1': 0.7238022, 'auroc': 0.8819957, 'binary_precision': 0.41897565, 'binary_recall': 0.62609786, 'binary_specificity': 0.92555135, 'binary_f1_score': 0.502012}
confusion matrix:
      0    1
0  8603  692
1   298  499
oracle model performance metric: 

scalar performance:
{'acc': 0.9049742, 'precision': 0.69862914, 'recall': 0.7786393, 'specificity': 0.7786393, 'f1': 0.729169, 'auroc': 0.88260734, 'binary_precision': 0.43041238, 'binary_recall': 0.6286073, 'binary_specificity': 0.9286713, 'binary_f1_score': 0.5109638}
confusion matrix:
      0    1
0  8632  663
1   296  501
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    838 MiB |   8475 MiB |   1054 TiB |   1054 TiB |
|       from large pool |    801 MiB |   8432 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     37 MiB |     77 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |    838 MiB |   8475 MiB |   1054 TiB |   1054 TiB |
|       from large pool |    801 MiB |   8432 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     37 MiB |     77 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |    832 MiB |   8469 MiB |   1053 TiB |   1053 TiB |
|       from large pool |    796 MiB |   8426 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     36 MiB |     76 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9116 MiB |   9154 MiB |  25406 MiB |  16290 MiB |
|       from large pool |   9036 MiB |   9068 MiB |  25260 MiB |  16224 MiB |
|       from small pool |     80 MiB |     86 MiB |    146 MiB |     66 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 253209 KiB |   1184 MiB | 676064 GiB | 676064 GiB |
|       from large pool | 238456 KiB |   1181 MiB | 659077 GiB | 659076 GiB |
|       from small pool |  14752 KiB |     29 MiB |  16987 GiB |  16987 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7451    |  210320 K  |  210315 K  |
|       from large pool |     161    |     844    |  100109 K  |  100109 K  |
|       from small pool |    4745    |    7288    |  110210 K  |  110205 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7451    |  210320 K  |  210315 K  |
|       from large pool |     161    |     844    |  100109 K  |  100109 K  |
|       from small pool |    4745    |    7288    |  110210 K  |  110205 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     329    |     340    |     901    |     572    |
|       from large pool |     289    |     297    |     828    |     539    |
|       from small pool |      40    |      43    |      73    |      33    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3264    |  110842 K  |  110842 K  |
|       from large pool |      18    |     300    |   63495 K  |   63495 K  |
|       from small pool |      50    |    3247    |   47347 K  |   47346 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8475 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8432 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     77 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8475 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8432 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     77 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8469 MiB |   1053 TiB |   1053 TiB |
|       from large pool |  16640 KiB |   8426 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     76 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1086 MiB |   9154 MiB |  25406 MiB |  24320 MiB |
|       from large pool |   1034 MiB |   9068 MiB |  25260 MiB |  24226 MiB |
|       from small pool |     52 MiB |     86 MiB |    146 MiB |     94 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1184 MiB | 676064 GiB | 676064 GiB |
|       from large pool |  30464 KiB |   1181 MiB | 659077 GiB | 659077 GiB |
|       from small pool |      0 KiB |     31 MiB |  16987 GiB |  16987 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7451    |  210320 K  |  210320 K  |
|       from large pool |       2    |     844    |  100109 K  |  100109 K  |
|       from small pool |       0    |    7288    |  110210 K  |  110210 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7451    |  210320 K  |  210320 K  |
|       from large pool |       2    |     844    |  100109 K  |  100109 K  |
|       from small pool |       0    |    7288    |  110210 K  |  110210 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     340    |     901    |     848    |
|       from large pool |      27    |     297    |     828    |     801    |
|       from small pool |      26    |      43    |      73    |      47    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3264    |  110844 K  |  110844 K  |
|       from large pool |       2    |     300    |   63495 K  |   63495 K  |
|       from small pool |       0    |    3247    |   47349 K  |   47349 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 10:36:07 2024]
Finished job 0.
1 of 1 steps (100%) done
