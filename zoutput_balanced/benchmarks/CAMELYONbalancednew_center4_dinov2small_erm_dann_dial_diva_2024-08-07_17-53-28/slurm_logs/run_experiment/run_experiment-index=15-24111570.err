Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  8 03:55:48 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/15.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=15
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570

 Experiment start at: 2024-08-08 04:02:44.334222
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95183194, 'precision': 0.9535318, 'recall': 0.9518465, 'specificity': 0.9518465, 'f1': 0.9517879, 'auroc': 0.9860202, 'binary_precision': 0.9814161, 'binary_recall': 0.92115235, 'binary_specificity': 0.98254067, 'binary_f1_score': 0.95032984}
confusion matrix:
       0      1
0  24874    442
1   1998  23342
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9058089, 'precision': 0.5776144, 'recall': 0.8060444, 'specificity': 0.8060444, 'f1': 0.60729367, 'auroc': 0.88931024, 'binary_precision': 0.16329966, 'binary_recall': 0.70120484, 'binary_specificity': 0.91088396, 'binary_f1_score': 0.26490667}
confusion matrix:
       0     1
0  15240  1491
1    124   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8095709, 'precision': 0.61369, 'recall': 0.7852176, 'specificity': 0.7852176, 'f1': 0.6325484, 'auroc': 0.8596386, 'binary_precision': 0.2515073, 'binary_recall': 0.7564767, 'binary_specificity': 0.81395847, 'binary_f1_score': 0.37750483}
confusion matrix:
      0     1
0  7604  1738
1   188   584
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 04:41:32.043614,epoch time: 0:38:47.709392,used: 0:38:47.709392,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9630646, 'precision': 0.9639356, 'recall': 0.9630749, 'specificity': 0.9630749, 'f1': 0.96304786, 'auroc': 0.99128604, 'binary_precision': 0.9841564, 'binary_recall': 0.9413181, 'binary_specificity': 0.98483175, 'binary_f1_score': 0.9622607}
confusion matrix:
       0      1
0  24932    384
1   1487  23853
---- Validation: 
scalar performance:
{'acc': 0.9087834, 'precision': 0.58290464, 'recall': 0.82284266, 'specificity': 0.82284266, 'f1': 0.615617, 'auroc': 0.9055096, 'binary_precision': 0.1730222, 'binary_recall': 0.7325301, 'binary_specificity': 0.9131552, 'binary_f1_score': 0.27992633}
confusion matrix:
       0     1
0  15278  1453
1    111   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82499504, 'precision': 0.6211444, 'recall': 0.78703135, 'specificity': 0.78703135, 'f1': 0.64538145, 'auroc': 0.8668591, 'binary_precision': 0.26725745, 'binary_recall': 0.742228, 'binary_specificity': 0.83183473, 'binary_f1_score': 0.3930041}
confusion matrix:
      0     1
0  7771  1571
1   199   573
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 05:19:56.274718,epoch time: 0:38:24.231104,used: 1:17:11.940496,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97068465, 'precision': 0.9711093, 'recall': 0.970693, 'specificity': 0.970693, 'f1': 0.9706784, 'auroc': 0.9937791, 'binary_precision': 0.9853917, 'binary_recall': 0.95556784, 'binary_specificity': 0.98581815, 'binary_f1_score': 0.97025067}
confusion matrix:
       0      1
0  24955    359
1   1126  24216
---- Validation: 
scalar performance:
{'acc': 0.9078502, 'precision': 0.5836317, 'recall': 0.83058906, 'specificity': 0.83058906, 'f1': 0.61661696, 'auroc': 0.908605, 'binary_precision': 0.1740347, 'binary_recall': 0.7493976, 'binary_specificity': 0.91178054, 'binary_f1_score': 0.28247046}
confusion matrix:
       0     1
0  15255  1476
1    104   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8362666, 'precision': 0.6266503, 'recall': 0.7854089, 'specificity': 0.7854089, 'f1': 0.65428466, 'auroc': 0.8679105, 'binary_precision': 0.27944112, 'binary_recall': 0.7253886, 'binary_specificity': 0.84542924, 'binary_f1_score': 0.40345824}
confusion matrix:
      0     1
0  7898  1444
1   212   560
new oracle model saved
early stop counter: 1
val acc:0.9078502058982849, best validation acc: 0.9087833762168884, corresponding to test acc:                         0.8249950408935547 / 0.8362665772438049
after epoch: 3,now: 2024-08-08 05:57:54.654805,epoch time: 0:37:58.380087,used: 1:55:10.320583,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.973705, 'precision': 0.9740547, 'recall': 0.97371423, 'specificity': 0.97371423, 'f1': 0.9737005, 'auroc': 0.99569017, 'binary_precision': 0.9870989, 'binary_recall': 0.9599921, 'binary_specificity': 0.9874363, 'binary_f1_score': 0.97335684}
confusion matrix:
       0      1
0  24993    318
1   1014  24331
---- Validation: 
scalar performance:
{'acc': 0.91146624, 'precision': 0.5854613, 'recall': 0.8253923, 'specificity': 0.8253923, 'f1': 0.6197293, 'auroc': 0.9112148, 'binary_precision': 0.1780502, 'binary_recall': 0.73493975, 'binary_specificity': 0.91584486, 'binary_f1_score': 0.2866541}
confusion matrix:
       0     1
0  15323  1408
1    110   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8525806, 'precision': 0.6404251, 'recall': 0.7978049, 'specificity': 0.7978049, 'f1': 0.67343754, 'auroc': 0.8765918, 'binary_precision': 0.30578065, 'binary_recall': 0.7331606, 'binary_specificity': 0.86244917, 'binary_f1_score': 0.4315669}
confusion matrix:
      0     1
0  8057  1285
1   206   566
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-08 06:35:41.124331,epoch time: 0:37:46.469526,used: 2:32:56.790109,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9758568, 'precision': 0.97620595, 'recall': 0.9758649, 'specificity': 0.9758649, 'f1': 0.9758526, 'auroc': 0.9961086, 'binary_precision': 0.98924947, 'binary_recall': 0.9621986, 'binary_specificity': 0.9895311, 'binary_f1_score': 0.9755365}
confusion matrix:
       0      1
0  25048    265
1    958  24385
---- Validation: 
scalar performance:
{'acc': 0.9201563, 'precision': 0.5948793, 'recall': 0.83454484, 'specificity': 0.83454484, 'f1': 0.63432217, 'auroc': 0.91647685, 'binary_precision': 0.19656488, 'binary_recall': 0.7445783, 'binary_specificity': 0.9245114, 'binary_f1_score': 0.31102166}
confusion matrix:
       0     1
0  15468  1263
1    106   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8633577, 'precision': 0.6476107, 'recall': 0.7941324, 'specificity': 0.7941324, 'f1': 0.6826571, 'auroc': 0.8814167, 'binary_precision': 0.32163742, 'binary_recall': 0.71243525, 'binary_specificity': 0.8758296, 'binary_f1_score': 0.443191}
confusion matrix:
      0     1
0  8182  1160
1   222   550
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-08 07:13:19.524098,epoch time: 0:37:38.399767,used: 3:10:35.189876,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9764292, 'precision': 0.976799, 'recall': 0.97643924, 'specificity': 0.97643924, 'f1': 0.97642505, 'auroc': 0.9963405, 'binary_precision': 0.99025655, 'binary_recall': 0.9623609, 'binary_specificity': 0.99051756, 'binary_f1_score': 0.9761095}
confusion matrix:
       0      1
0  25070    240
1    954  24392
---- Validation: 
scalar performance:
{'acc': 0.93281233, 'precision': 0.60687804, 'recall': 0.8222309, 'specificity': 0.8222309, 'f1': 0.65089095, 'auroc': 0.914493, 'binary_precision': 0.22146636, 'binary_recall': 0.7060241, 'binary_specificity': 0.93843764, 'binary_f1_score': 0.33716917}
confusion matrix:
       0     1
0  15701  1030
1    122   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88085824, 'precision': 0.6602168, 'recall': 0.77924573, 'specificity': 0.77924573, 'f1': 0.69550693, 'auroc': 0.88192546, 'binary_precision': 0.35079256, 'binary_recall': 0.65932643, 'binary_specificity': 0.89916503, 'binary_f1_score': 0.45793974}
confusion matrix:
      0    1
0  8400  942
1   263  509
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-08 07:51:04.518457,epoch time: 0:37:44.994359,used: 3:48:20.184235,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9797062, 'precision': 0.97986716, 'recall': 0.9797125, 'specificity': 0.9797125, 'f1': 0.97970474, 'auroc': 0.9967332, 'binary_precision': 0.98882324, 'binary_recall': 0.9704084, 'binary_specificity': 0.98901665, 'binary_f1_score': 0.97952926}
confusion matrix:
       0      1
0  25033    278
1    750  24595
---- Validation: 
scalar performance:
{'acc': 0.9088417, 'precision': 0.5840398, 'recall': 0.8287472, 'specificity': 0.8287472, 'f1': 0.6173407, 'auroc': 0.91244805, 'binary_precision': 0.17497168, 'binary_recall': 0.7445783, 'binary_specificity': 0.9129161, 'binary_f1_score': 0.28335625}
confusion matrix:
       0     1
0  15274  1457
1    106   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8455606, 'precision': 0.6393722, 'recall': 0.8112351, 'specificity': 0.8112351, 'f1': 0.67151654, 'auroc': 0.8852207, 'binary_precision': 0.30050504, 'binary_recall': 0.77072537, 'binary_specificity': 0.85174483, 'binary_f1_score': 0.43241277}
confusion matrix:
      0     1
0  7957  1385
1   177   595
early stop counter: 1
val acc:0.9088417291641235, best validation acc: 0.9328123331069946, corresponding to test acc:                         0.8808582425117493 / 0.8808582425117493
after epoch: 7,now: 2024-08-08 08:28:40.336522,epoch time: 0:37:35.818065,used: 4:25:56.002300,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97883767, 'precision': 0.9791598, 'recall': 0.97884333, 'specificity': 0.97884333, 'f1': 0.9788343, 'auroc': 0.9970568, 'binary_precision': 0.99169266, 'binary_recall': 0.96578395, 'binary_specificity': 0.99190265, 'binary_f1_score': 0.9785669}
confusion matrix:
       0      1
0  25112    205
1    867  24472
---- Validation: 
scalar performance:
{'acc': 0.9282631, 'precision': 0.6023519, 'recall': 0.8281244, 'specificity': 0.8281244, 'f1': 0.6449892, 'auroc': 0.91306734, 'binary_precision': 0.21201414, 'binary_recall': 0.72289157, 'binary_specificity': 0.93335724, 'binary_f1_score': 0.32786885}
confusion matrix:
       0     1
0  15616  1115
1    115   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8694878, 'precision': 0.6566994, 'recall': 0.80873954, 'specificity': 0.80873954, 'f1': 0.69434774, 'auroc': 0.89218765, 'binary_precision': 0.33748516, 'binary_recall': 0.73704666, 'binary_specificity': 0.8804324, 'binary_f1_score': 0.46297804}
confusion matrix:
      0     1
0  8225  1117
1   203   569
early stop counter: 2
val acc:0.9282631278038025, best validation acc: 0.9328123331069946, corresponding to test acc:                         0.8808582425117493 / 0.8808582425117493
after epoch: 8,now: 2024-08-08 09:06:11.090170,epoch time: 0:37:30.753648,used: 5:03:26.755948,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9812066, 'precision': 0.9812646, 'recall': 0.9812101, 'specificity': 0.9812101, 'f1': 0.98120606, 'auroc': 0.9972118, 'binary_precision': 0.98671085, 'binary_recall': 0.9755761, 'binary_specificity': 0.9868442, 'binary_f1_score': 0.9811119}
confusion matrix:
       0      1
0  24979    333
1    619  24725
---- Validation: 
scalar performance:
{'acc': 0.93106264, 'precision': 0.6058485, 'recall': 0.8283839, 'specificity': 0.8283839, 'f1': 0.6497996, 'auroc': 0.9143729, 'binary_precision': 0.21904762, 'binary_recall': 0.72048193, 'binary_specificity': 0.9362859, 'binary_f1_score': 0.33595505}
confusion matrix:
       0     1
0  15665  1066
1    116   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86691713, 'precision': 0.65864885, 'recall': 0.8251724, 'specificity': 0.8251724, 'f1': 0.697399, 'auroc': 0.8980748, 'binary_precision': 0.33803612, 'binary_recall': 0.77590674, 'binary_specificity': 0.87443805, 'binary_f1_score': 0.47091198}
confusion matrix:
      0     1
0  8169  1173
1   173   599
early stop counter: 3
val acc:0.931062638759613, best validation acc: 0.9328123331069946, corresponding to test acc:                         0.8808582425117493 / 0.8808582425117493
after epoch: 9,now: 2024-08-08 09:43:47.813278,epoch time: 0:37:36.723108,used: 5:41:03.479056,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_04_02_44_seed_0_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 5:41:03.479056 at 2024-08-08 09:43:47.813278
persisted model performance metric: 

scalar performance:
{'acc': 0.88085824, 'precision': 0.6602168, 'recall': 0.77924573, 'specificity': 0.77924573, 'f1': 0.69550693, 'auroc': 0.88192546, 'binary_precision': 0.35079256, 'binary_recall': 0.65932643, 'binary_specificity': 0.89916503, 'binary_f1_score': 0.45793974}
confusion matrix:
      0    1
0  8400  942
1   263  509
oracle model performance metric: 

scalar performance:
{'acc': 0.88085824, 'precision': 0.6602168, 'recall': 0.77924573, 'specificity': 0.77924573, 'f1': 0.69550693, 'auroc': 0.88192546, 'binary_precision': 0.35079256, 'binary_recall': 0.65932643, 'binary_specificity': 0.89916503, 'binary_f1_score': 0.45793974}
confusion matrix:
      0    1
0  8400  942
1   263  509
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/15.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   4047 MiB |    836 TiB |    836 TiB |
|       from large pool | 180662 KiB |   4028 MiB |    827 TiB |    827 TiB |
|       from small pool |  18214 KiB |     38 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   4047 MiB |    836 TiB |    836 TiB |
|       from large pool | 180662 KiB |   4028 MiB |    827 TiB |    827 TiB |
|       from small pool |  18214 KiB |     38 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   4045 MiB |    836 TiB |    836 TiB |
|       from large pool | 178979 KiB |   4026 MiB |    827 TiB |    827 TiB |
|       from small pool |  16663 KiB |     36 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4936 MiB |   4936 MiB |   4936 MiB |      0 B   |
|       from large pool |   4894 MiB |   4894 MiB |   4894 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  65316 KiB |    864 MiB | 519597 GiB | 519597 GiB |
|       from large pool |  50762 KiB |    862 MiB | 509941 GiB | 509941 GiB |
|       from small pool |  14554 KiB |     14 MiB |   9656 GiB |   9656 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6807    |  110789 K  |  110785 K  |
|       from large pool |      79    |     423    |   75077 K  |   75077 K  |
|       from small pool |    4345    |    6727    |   35712 K  |   35707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6807    |  110789 K  |  110785 K  |
|       from large pool |      79    |     423    |   75077 K  |   75077 K  |
|       from small pool |    4345    |    6727    |   35712 K  |   35707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     181    |     181    |     181    |       0    |
|       from large pool |     160    |     160    |     160    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3187    |   71044 K  |   71044 K  |
|       from large pool |      10    |     163    |   56162 K  |   56162 K  |
|       from small pool |      26    |    3177    |   14882 K  |   14882 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |    836 TiB |    836 TiB |
|       from large pool |  16640 KiB |   4028 MiB |    827 TiB |    827 TiB |
|       from small pool |      0 KiB |     38 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |    836 TiB |    836 TiB |
|       from large pool |  16640 KiB |   4028 MiB |    827 TiB |    827 TiB |
|       from small pool |      0 KiB |     38 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |    836 TiB |    836 TiB |
|       from large pool |  16640 KiB |   4026 MiB |    827 TiB |    827 TiB |
|       from small pool |      0 KiB |     36 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 264192 KiB |   4936 MiB |   4936 MiB |   4678 MiB |
|       from large pool | 231424 KiB |   4894 MiB |   4894 MiB |   4668 MiB |
|       from small pool |  32768 KiB |     42 MiB |     42 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB | 519598 GiB | 519598 GiB |
|       from large pool |  30464 KiB |    862 MiB | 509941 GiB | 509941 GiB |
|       from small pool |      0 KiB |     26 MiB |   9656 GiB |   9656 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |  110789 K  |  110789 K  |
|       from large pool |       2    |     423    |   75077 K  |   75077 K  |
|       from small pool |       0    |    6727    |   35712 K  |   35712 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |  110789 K  |  110789 K  |
|       from large pool |       2    |     423    |   75077 K  |   75077 K  |
|       from small pool |       0    |    6727    |   35712 K  |   35712 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |     181    |     181    |     154    |
|       from large pool |      11    |     160    |     160    |     149    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3187    |   71046 K  |   71046 K  |
|       from large pool |       3    |     163    |   56162 K  |   56162 K  |
|       from small pool |       0    |    3177    |   14884 K  |   14884 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |    836 TiB |    836 TiB |
|       from large pool |  16640 KiB |   4028 MiB |    827 TiB |    827 TiB |
|       from small pool |      0 KiB |     38 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |    836 TiB |    836 TiB |
|       from large pool |  16640 KiB |   4028 MiB |    827 TiB |    827 TiB |
|       from small pool |      0 KiB |     38 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |    836 TiB |    836 TiB |
|       from large pool |  16640 KiB |   4026 MiB |    827 TiB |    827 TiB |
|       from small pool |      0 KiB |     36 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 264192 KiB |   4936 MiB |   4936 MiB |   4678 MiB |
|       from large pool | 231424 KiB |   4894 MiB |   4894 MiB |   4668 MiB |
|       from small pool |  32768 KiB |     42 MiB |     42 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB | 519598 GiB | 519598 GiB |
|       from large pool |  30464 KiB |    862 MiB | 509941 GiB | 509941 GiB |
|       from small pool |      0 KiB |     26 MiB |   9656 GiB |   9656 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |  110789 K  |  110789 K  |
|       from large pool |       2    |     423    |   75077 K  |   75077 K  |
|       from small pool |       0    |    6727    |   35712 K  |   35712 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |  110789 K  |  110789 K  |
|       from large pool |       2    |     423    |   75077 K  |   75077 K  |
|       from small pool |       0    |    6727    |   35712 K  |   35712 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |     181    |     181    |     154    |
|       from large pool |      11    |     160    |     160    |     149    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3187    |   71046 K  |   71046 K  |
|       from large pool |       3    |     163    |   56162 K  |   56162 K  |
|       from small pool |       0    |    3177    |   14884 K  |   14884 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_10_05_17_seed_1_24111570

 Experiment start at: 2024-08-08 10:05:17.147269
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94430673, 'precision': 0.9463502, 'recall': 0.9443348, 'specificity': 0.9443348, 'f1': 0.94424534, 'auroc': 0.9847665, 'binary_precision': 0.9767589, 'binary_recall': 0.9103668, 'binary_specificity': 0.97830284, 'binary_f1_score': 0.9423949}
confusion matrix:
       0      1
0  24844    551
1   2280  23157
---- Validation: 
scalar performance:
{'acc': 0.9406062, 'precision': 0.5884454, 'recall': 0.689262, 'specificity': 0.689262, 'f1': 0.61684775, 'auroc': 0.8613386, 'binary_precision': 0.19222689, 'binary_recall': 0.42459396, 'binary_specificity': 0.95393, 'binary_f1_score': 0.2646421}
confusion matrix:
       0    1
0  15923  769
1    248  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88474876, 'precision': 0.607969, 'recall': 0.6251297, 'specificity': 0.6251297, 'f1': 0.61556077, 'auroc': 0.8297576, 'binary_precision': 0.2719101, 'binary_recall': 0.31968296, 'binary_specificity': 0.9305764, 'binary_f1_score': 0.29386765}
confusion matrix:
      0    1
0  8686  648
1   515  242
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 10:44:55.707171,epoch time: 0:39:38.559902,used: 0:39:38.559902,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_10_05_17_seed_1_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96006453, 'precision': 0.9611826, 'recall': 0.96008694, 'specificity': 0.96008694, 'f1': 0.96004164, 'auroc': 0.9917698, 'binary_precision': 0.98411715, 'binary_recall': 0.9352962, 'binary_specificity': 0.9848777, 'binary_f1_score': 0.9590858}
confusion matrix:
       0      1
0  25009    384
1   1646  23793
---- Validation: 
scalar performance:
{'acc': 0.9463295, 'precision': 0.62062854, 'recall': 0.7667867, 'specificity': 0.7667867, 'f1': 0.6617266, 'auroc': 0.89202046, 'binary_precision': 0.2525355, 'binary_recall': 0.57772624, 'binary_specificity': 0.9558471, 'binary_f1_score': 0.35144672}
confusion matrix:
       0    1
0  15955  737
1    182  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8854425, 'precision': 0.641623, 'recall': 0.70562, 'specificity': 0.70562, 'f1': 0.6648058, 'auroc': 0.8578435, 'binary_precision': 0.326068, 'binary_recall': 0.49405548, 'binary_specificity': 0.9171845, 'binary_f1_score': 0.39285716}
confusion matrix:
      0    1
0  8561  773
1   383  374
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 11:25:43.578065,epoch time: 0:40:47.870894,used: 1:20:26.430796,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_10_05_17_seed_1_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9684057, 'precision': 0.96874595, 'recall': 0.9684186, 'specificity': 0.9684186, 'f1': 0.9684006, 'auroc': 0.99414533, 'binary_precision': 0.9816117, 'binary_recall': 0.95475626, 'binary_specificity': 0.982081, 'binary_f1_score': 0.9679978}
confusion matrix:
       0      1
0  24937    455
1   1151  24289
---- Validation: 
scalar performance:
{'acc': 0.9404894, 'precision': 0.61972517, 'recall': 0.8101269, 'specificity': 0.8101269, 'f1': 0.66575706, 'auroc': 0.9060036, 'binary_precision': 0.24828768, 'binary_recall': 0.6728538, 'binary_specificity': 0.9474, 'binary_f1_score': 0.36272672}
confusion matrix:
       0    1
0  15814  878
1    141  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8686949, 'precision': 0.64639056, 'recall': 0.780324, 'specificity': 0.780324, 'f1': 0.68081486, 'auroc': 0.8642007, 'binary_precision': 0.32160804, 'binary_recall': 0.67635405, 'binary_specificity': 0.884294, 'binary_f1_score': 0.43593016}
confusion matrix:
      0     1
0  8254  1080
1   245   512
early stop counter: 1
val acc:0.9404894113540649, best validation acc: 0.9463294744491577, corresponding to test acc:                         0.8854424953460693 / 0.8854424953460693
after epoch: 3,now: 2024-08-08 12:03:46.245654,epoch time: 0:38:02.667589,used: 1:58:29.098385,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_10_05_17_seed_1_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97206485, 'precision': 0.9724101, 'recall': 0.97207725, 'specificity': 0.97207725, 'f1': 0.9720602, 'auroc': 0.99559927, 'binary_precision': 0.98540884, 'binary_recall': 0.958371, 'binary_specificity': 0.98578346, 'binary_f1_score': 0.97170186}
confusion matrix:
       0      1
0  25032    361
1   1059  24380
---- Validation: 
scalar performance:
{'acc': 0.93862057, 'precision': 0.61786985, 'recall': 0.8159492, 'specificity': 0.8159492, 'f1': 0.6640401, 'auroc': 0.91130114, 'binary_precision': 0.24422443, 'binary_recall': 0.68677497, 'binary_specificity': 0.94512343, 'binary_f1_score': 0.36031651}
confusion matrix:
       0    1
0  15776  916
1    135  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8780101, 'precision': 0.6556712, 'recall': 0.7817178, 'specificity': 0.7817178, 'f1': 0.69128, 'auroc': 0.8709171, 'binary_precision': 0.34051144, 'binary_recall': 0.668428, 'binary_specificity': 0.8950075, 'binary_f1_score': 0.45118144}
confusion matrix:
      0    1
0  8354  980
1   251  506
early stop counter: 2
val acc:0.9386205673217773, best validation acc: 0.9463294744491577, corresponding to test acc:                         0.8854424953460693 / 0.8854424953460693
after epoch: 4,now: 2024-08-08 12:41:51.181161,epoch time: 0:38:04.935507,used: 2:36:34.033892,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_10_05_17_seed_1_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9753305, 'precision': 0.97561944, 'recall': 0.97534037, 'specificity': 0.97534037, 'f1': 0.97532713, 'auroc': 0.9960136, 'binary_precision': 0.9875403, 'binary_recall': 0.96284795, 'binary_specificity': 0.9878327, 'binary_f1_score': 0.9750378}
confusion matrix:
       0      1
0  25087    309
1    945  24491
---- Validation: 
scalar performance:
{'acc': 0.9459207, 'precision': 0.6256921, 'recall': 0.79144, 'specificity': 0.79144, 'f1': 0.6704796, 'auroc': 0.9118922, 'binary_precision': 0.26133075, 'binary_recall': 0.6287703, 'binary_specificity': 0.9541097, 'binary_f1_score': 0.3692098}
confusion matrix:
       0    1
0  15926  766
1    160  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8882172, 'precision': 0.660456, 'recall': 0.75628155, 'specificity': 0.75628155, 'f1': 0.6921735, 'auroc': 0.8693596, 'binary_precision': 0.35519126, 'binary_recall': 0.6010568, 'binary_specificity': 0.9115063, 'binary_f1_score': 0.44651622}
confusion matrix:
      0    1
0  8508  826
1   302  455
new oracle model saved
early stop counter: 3
val acc:0.9459207057952881, best validation acc: 0.9463294744491577, corresponding to test acc:                         0.8854424953460693 / 0.8882172107696533
after epoch: 5,now: 2024-08-08 13:19:28.260917,epoch time: 0:37:37.079756,used: 3:14:11.113648,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_10_05_17_seed_1_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 3:14:11.113648 at 2024-08-08 13:19:28.260917
persisted model performance metric: 

scalar performance:
{'acc': 0.8854425, 'precision': 0.641623, 'recall': 0.70562, 'specificity': 0.70562, 'f1': 0.6648058, 'auroc': 0.8578435, 'binary_precision': 0.326068, 'binary_recall': 0.49405548, 'binary_specificity': 0.9171845, 'binary_f1_score': 0.39285716}
confusion matrix:
      0    1
0  8561  773
1   383  374
oracle model performance metric: 

scalar performance:
{'acc': 0.8882172, 'precision': 0.660456, 'recall': 0.75628155, 'specificity': 0.75628155, 'f1': 0.6921735, 'auroc': 0.8693596, 'binary_precision': 0.35519126, 'binary_recall': 0.6010568, 'binary_specificity': 0.9115063, 'binary_f1_score': 0.44651622}
confusion matrix:
      0    1
0  8508  826
1   302  455
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   4047 MiB |   1310 TiB |   1310 TiB |
|       from large pool | 179211 KiB |   4028 MiB |   1295 TiB |   1295 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   4047 MiB |   1310 TiB |   1310 TiB |
|       from large pool | 179211 KiB |   4028 MiB |   1295 TiB |   1295 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   4045 MiB |   1310 TiB |   1310 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1295 TiB |   1295 TiB |
|       from small pool |  16662 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4930 MiB |   4936 MiB |   9608 MiB |   4678 MiB |
|       from large pool |   4892 MiB |   4894 MiB |   9560 MiB |   4668 MiB |
|       from small pool |     38 MiB |     42 MiB |     48 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB |    864 MiB |    800 TiB |    800 TiB |
|       from large pool |  31733 KiB |    862 MiB |    785 TiB |    785 TiB |
|       from small pool |  10464 KiB |     26 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6829    |  173705 K  |  173701 K  |
|       from large pool |      79    |     423    |  117622 K  |  117622 K  |
|       from small pool |    4333    |    6749    |   56083 K  |   56079 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6829    |  173705 K  |  173701 K  |
|       from large pool |      79    |     423    |  117622 K  |  117622 K  |
|       from small pool |    4333    |    6749    |   56083 K  |   56079 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     178    |     181    |     332    |     154    |
|       from large pool |     159    |     160    |     308    |     149    |
|       from small pool |      19    |      21    |      24    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3197    |  113096 K  |  113096 K  |
|       from large pool |      11    |     165    |   86657 K  |   86657 K  |
|       from small pool |      21    |    3186    |   26439 K  |   26439 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1310 TiB |   1310 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1295 TiB |   1295 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1310 TiB |   1310 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1295 TiB |   1295 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1310 TiB |   1310 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1295 TiB |   1295 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4936 MiB |   9608 MiB |   9374 MiB |
|       from large pool | 210944 KiB |   4894 MiB |   9560 MiB |   9354 MiB |
|       from small pool |  28672 KiB |     42 MiB |     48 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB |    800 TiB |    800 TiB |
|       from large pool |  30464 KiB |    862 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     26 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  173705 K  |  173705 K  |
|       from large pool |       2    |     423    |  117622 K  |  117622 K  |
|       from small pool |       0    |    6749    |   56083 K  |   56083 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  173705 K  |  173705 K  |
|       from large pool |       2    |     423    |  117622 K  |  117622 K  |
|       from small pool |       0    |    6749    |   56083 K  |   56083 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     181    |     332    |     308    |
|       from large pool |      10    |     160    |     308    |     298    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3197    |  113098 K  |  113098 K  |
|       from large pool |       3    |     165    |   86657 K  |   86657 K  |
|       from small pool |       0    |    3186    |   26441 K  |   26441 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1310 TiB |   1310 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1295 TiB |   1295 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1310 TiB |   1310 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1295 TiB |   1295 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1310 TiB |   1310 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1295 TiB |   1295 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4936 MiB |   9608 MiB |   9374 MiB |
|       from large pool | 210944 KiB |   4894 MiB |   9560 MiB |   9354 MiB |
|       from small pool |  28672 KiB |     42 MiB |     48 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB |    800 TiB |    800 TiB |
|       from large pool |  30464 KiB |    862 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     26 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  173705 K  |  173705 K  |
|       from large pool |       2    |     423    |  117622 K  |  117622 K  |
|       from small pool |       0    |    6749    |   56083 K  |   56083 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  173705 K  |  173705 K  |
|       from large pool |       2    |     423    |  117622 K  |  117622 K  |
|       from small pool |       0    |    6749    |   56083 K  |   56083 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     181    |     332    |     308    |
|       from large pool |      10    |     160    |     308    |     298    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3197    |  113098 K  |  113098 K  |
|       from large pool |       3    |     165    |   86657 K  |   86657 K  |
|       from small pool |       0    |    3186    |   26441 K  |   26441 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_13_43_07_seed_2_24111570

 Experiment start at: 2024-08-08 13:43:07.909267
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9485647, 'precision': 0.95039034, 'recall': 0.94856834, 'specificity': 0.94856834, 'f1': 0.9485128, 'auroc': 0.98586595, 'binary_precision': 0.9790944, 'binary_recall': 0.916715, 'binary_specificity': 0.9804217, 'binary_f1_score': 0.94687843}
confusion matrix:
       0      1
0  25339    506
1   2153  23698
---- Validation: 
scalar performance:
{'acc': 0.9428872, 'precision': 0.60005504, 'recall': 0.72581804, 'specificity': 0.72581804, 'f1': 0.6343269, 'auroc': 0.84331876, 'binary_precision': 0.21311475, 'binary_recall': 0.49760765, 'binary_specificity': 0.9540285, 'binary_f1_score': 0.29842183}
confusion matrix:
       0    1
0  15938  768
1    210  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88832736, 'precision': 0.66056144, 'recall': 0.7306001, 'specificity': 0.7306001, 'f1': 0.6862836, 'auroc': 0.86385226, 'binary_precision': 0.36204013, 'binary_recall': 0.54328734, 'binary_specificity': 0.91791284, 'binary_f1_score': 0.43452084}
confusion matrix:
      0    1
0  8532  763
1   364  433
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 14:23:35.072432,epoch time: 0:40:27.163165,used: 0:40:27.163165,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_13_43_07_seed_2_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9625116, 'precision': 0.96343213, 'recall': 0.96251166, 'specificity': 0.96251166, 'f1': 0.962493, 'auroc': 0.9917824, 'binary_precision': 0.9840865, 'binary_recall': 0.9402275, 'binary_specificity': 0.98479575, 'binary_f1_score': 0.96165717}
confusion matrix:
       0      1
0  25455    393
1   1545  24303
---- Validation: 
scalar performance:
{'acc': 0.9421864, 'precision': 0.6085309, 'recall': 0.7627787, 'specificity': 0.7627787, 'f1': 0.6481637, 'auroc': 0.86916625, 'binary_precision': 0.22813688, 'binary_recall': 0.57416266, 'binary_specificity': 0.95139474, 'binary_f1_score': 0.32653058}
confusion matrix:
       0    1
0  15894  812
1    178  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90071344, 'precision': 0.6897675, 'recall': 0.7711642, 'specificity': 0.7711642, 'f1': 0.72020364, 'auroc': 0.8929417, 'binary_precision': 0.41379312, 'binary_recall': 0.61731493, 'binary_specificity': 0.9250134, 'binary_f1_score': 0.49546832}
confusion matrix:
      0    1
0  8598  697
1   305  492
new oracle model saved
early stop counter: 1
val acc:0.9421864151954651, best validation acc: 0.9428871870040894, corresponding to test acc:                         0.8883273601531982 / 0.9007134437561035
after epoch: 2,now: 2024-08-08 15:02:30.640686,epoch time: 0:38:55.568254,used: 1:19:22.731419,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_13_43_07_seed_2_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.968721, 'precision': 0.9691957, 'recall': 0.9687247, 'specificity': 0.9687247, 'f1': 0.9687133, 'auroc': 0.9941492, 'binary_precision': 0.98417836, 'binary_recall': 0.9527733, 'binary_specificity': 0.9846761, 'binary_f1_score': 0.96822125}
confusion matrix:
       0      1
0  25446    396
1   1221  24633
---- Validation: 
scalar performance:
{'acc': 0.93640506, 'precision': 0.6028474, 'recall': 0.7773093, 'specificity': 0.7773093, 'f1': 0.6427973, 'auroc': 0.8793443, 'binary_precision': 0.21591872, 'binary_recall': 0.6100478, 'binary_specificity': 0.94457084, 'binary_f1_score': 0.31894934}
confusion matrix:
       0    1
0  15780  926
1    163  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90249705, 'precision': 0.6976429, 'recall': 0.7950748, 'specificity': 0.7950748, 'f1': 0.7326372, 'auroc': 0.9042987, 'binary_precision': 0.4252598, 'binary_recall': 0.6675031, 'binary_specificity': 0.9226466, 'binary_f1_score': 0.5195312}
confusion matrix:
      0    1
0  8576  719
1   265  532
new oracle model saved
early stop counter: 2
val acc:0.9364050626754761, best validation acc: 0.9428871870040894, corresponding to test acc:                         0.8883273601531982 / 0.9024970531463623
after epoch: 3,now: 2024-08-08 15:41:43.872858,epoch time: 0:39:13.232172,used: 1:58:35.963591,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_13_43_07_seed_2_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9719514, 'precision': 0.97250044, 'recall': 0.9719527, 'specificity': 0.9719527, 'f1': 0.9719433, 'auroc': 0.99535644, 'binary_precision': 0.98862547, 'binary_recall': 0.9548936, 'binary_specificity': 0.9890118, 'binary_f1_score': 0.9714668}
confusion matrix:
       0      1
0  25562    284
1   1166  24684
---- Validation: 
scalar performance:
{'acc': 0.9467414, 'precision': 0.6188466, 'recall': 0.76977813, 'specificity': 0.76977813, 'f1': 0.6604036, 'auroc': 0.8787066, 'binary_precision': 0.24847251, 'binary_recall': 0.58373207, 'binary_specificity': 0.95582426, 'binary_f1_score': 0.34857145}
confusion matrix:
       0    1
0  15968  738
1    174  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90745145, 'precision': 0.7030834, 'recall': 0.77826345, 'specificity': 0.77826345, 'f1': 0.7324477, 'auroc': 0.9036815, 'binary_precision': 0.43954104, 'binary_recall': 0.6248432, 'binary_specificity': 0.9316837, 'binary_f1_score': 0.5160622}
confusion matrix:
      0    1
0  8660  635
1   299  498
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-08 16:22:51.578029,epoch time: 0:41:07.705171,used: 2:39:43.668762,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_13_43_07_seed_2_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9753559, 'precision': 0.9757582, 'recall': 0.9753587, 'specificity': 0.9753587, 'f1': 0.97535086, 'auroc': 0.9962033, 'binary_precision': 0.989641, 'binary_recall': 0.96077824, 'binary_specificity': 0.9899393, 'binary_f1_score': 0.97499615}
confusion matrix:
       0      1
0  25583    260
1   1014  24839
---- Validation: 
scalar performance:
{'acc': 0.94323754, 'precision': 0.6139264, 'recall': 0.77731234, 'specificity': 0.77731234, 'f1': 0.6559019, 'auroc': 0.88448656, 'binary_precision': 0.23818526, 'binary_recall': 0.6028708, 'binary_specificity': 0.95175385, 'binary_f1_score': 0.3414634}
confusion matrix:
       0    1
0  15900  806
1    166  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9108204, 'precision': 0.7119031, 'recall': 0.79213715, 'specificity': 0.79213715, 'f1': 0.7431389, 'auroc': 0.90576327, 'binary_precision': 0.45486414, 'binary_recall': 0.65119195, 'binary_specificity': 0.9330823, 'binary_f1_score': 0.5356037}
confusion matrix:
      0    1
0  8673  622
1   278  519
new oracle model saved
early stop counter: 1
val acc:0.9432375431060791, best validation acc: 0.9467414021492004, corresponding to test acc:                         0.9074514508247375 / 0.9108204245567322
after epoch: 5,now: 2024-08-08 17:02:09.396854,epoch time: 0:39:17.818825,used: 3:19:01.487587,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_13_43_07_seed_2_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9767874, 'precision': 0.9771675, 'recall': 0.9767879, 'specificity': 0.9767879, 'f1': 0.9767828, 'auroc': 0.996837, 'binary_precision': 0.9906445, 'binary_recall': 0.9626678, 'binary_specificity': 0.990908, 'binary_f1_score': 0.9764558}
confusion matrix:
       0      1
0  25612    235
1    965  24884
---- Validation: 
scalar performance:
{'acc': 0.9348283, 'precision': 0.60282385, 'recall': 0.78699744, 'specificity': 0.78699744, 'f1': 0.64346945, 'auroc': 0.8875313, 'binary_precision': 0.21533442, 'binary_recall': 0.6315789, 'binary_specificity': 0.9424159, 'binary_f1_score': 0.3211679}
confusion matrix:
       0    1
0  15744  962
1    154  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90982956, 'precision': 0.71132255, 'recall': 0.8002026, 'specificity': 0.8002026, 'f1': 0.74497783, 'auroc': 0.90485644, 'binary_precision': 0.4521592, 'binary_recall': 0.67001253, 'binary_specificity': 0.9303927, 'binary_f1_score': 0.5399393}
confusion matrix:
      0    1
0  8648  647
1   263  534
early stop counter: 2
val acc:0.9348282814025879, best validation acc: 0.9467414021492004, corresponding to test acc:                         0.9074514508247375 / 0.9108204245567322
after epoch: 6,now: 2024-08-08 17:42:51.449780,epoch time: 0:40:42.052926,used: 3:59:43.540513,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_13_43_07_seed_2_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97930205, 'precision': 0.9794724, 'recall': 0.97930574, 'specificity': 0.97930574, 'f1': 0.9793004, 'auroc': 0.9972439, 'binary_precision': 0.9886068, 'binary_recall': 0.9697966, 'binary_specificity': 0.98881495, 'binary_f1_score': 0.9791114}
confusion matrix:
       0      1
0  25549    289
1    781  25077
---- Validation: 
scalar performance:
{'acc': 0.93763137, 'precision': 0.60749006, 'recall': 0.78960025, 'specificity': 0.78960025, 'f1': 0.649477, 'auroc': 0.8899542, 'binary_precision': 0.22457626, 'binary_recall': 0.6339713, 'binary_specificity': 0.94522923, 'binary_f1_score': 0.33166456}
confusion matrix:
       0    1
0  15791  915
1    153  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91240585, 'precision': 0.7183099, 'recall': 0.81421953, 'specificity': 0.81421953, 'f1': 0.75425535, 'auroc': 0.90541816, 'binary_precision': 0.46371976, 'binary_recall': 0.69761604, 'binary_specificity': 0.930823, 'binary_f1_score': 0.5571142}
confusion matrix:
      0    1
0  8652  643
1   241  556
new oracle model saved
early stop counter: 3
val acc:0.937631368637085, best validation acc: 0.9467414021492004, corresponding to test acc:                         0.9074514508247375 / 0.9124058485031128
after epoch: 7,now: 2024-08-08 18:23:43.936234,epoch time: 0:40:52.486454,used: 4:40:36.026967,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_13_43_07_seed_2_24111570
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 4:40:36.026967 at 2024-08-08 18:23:43.936234
persisted model performance metric: 

scalar performance:
{'acc': 0.90745145, 'precision': 0.7030834, 'recall': 0.77826345, 'specificity': 0.77826345, 'f1': 0.7324477, 'auroc': 0.9036815, 'binary_precision': 0.43954104, 'binary_recall': 0.6248432, 'binary_specificity': 0.9316837, 'binary_f1_score': 0.5160622}
confusion matrix:
      0    1
0  8660  635
1   299  498
oracle model performance metric: 

scalar performance:
{'acc': 0.91240585, 'precision': 0.7183099, 'recall': 0.81421953, 'specificity': 0.81421953, 'f1': 0.75425535, 'auroc': 0.90541816, 'binary_precision': 0.46371976, 'binary_recall': 0.69761604, 'binary_specificity': 0.930823, 'binary_f1_score': 0.5571142}
confusion matrix:
      0    1
0  8652  643
1   241  556
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   4047 MiB |   1977 TiB |   1977 TiB |
|       from large pool | 179211 KiB |   4028 MiB |   1955 TiB |   1955 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   4047 MiB |   1977 TiB |   1977 TiB |
|       from large pool | 179211 KiB |   4028 MiB |   1955 TiB |   1955 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   4045 MiB |   1977 TiB |   1977 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1955 TiB |   1955 TiB |
|       from small pool |  16662 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4930 MiB |   4936 MiB |  14304 MiB |   9374 MiB |
|       from large pool |   4892 MiB |   4894 MiB |  14246 MiB |   9354 MiB |
|       from small pool |     38 MiB |     42 MiB |     58 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB |    864 MiB |   1213 TiB |   1213 TiB |
|       from large pool |  31733 KiB |    862 MiB |   1190 TiB |   1190 TiB |
|       from small pool |  10464 KiB |     26 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6937    |  262044 K  |  262040 K  |
|       from large pool |      79    |     423    |  177493 K  |  177493 K  |
|       from small pool |    4333    |    6857    |   84551 K  |   84546 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6937    |  262044 K  |  262040 K  |
|       from large pool |      79    |     423    |  177493 K  |  177493 K  |
|       from small pool |    4333    |    6857    |   84551 K  |   84546 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     178    |     181    |     486    |     308    |
|       from large pool |     159    |     160    |     457    |     298    |
|       from small pool |      19    |      21    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3251    |  172190 K  |  172190 K  |
|       from large pool |      11    |     165    |  129610 K  |  129610 K  |
|       from small pool |      21    |    3240    |   42579 K  |   42579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1977 TiB |   1977 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1955 TiB |   1955 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1977 TiB |   1977 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1955 TiB |   1955 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1977 TiB |   1977 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1955 TiB |   1955 TiB |
|       from small pool |      0 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4936 MiB |  14304 MiB |  14070 MiB |
|       from large pool | 210944 KiB |   4894 MiB |  14246 MiB |  14040 MiB |
|       from small pool |  28672 KiB |     42 MiB |     58 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB |   1213 TiB |   1213 TiB |
|       from large pool |  30464 KiB |    862 MiB |   1190 TiB |   1190 TiB |
|       from small pool |      0 KiB |     26 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6937    |  262044 K  |  262044 K  |
|       from large pool |       2    |     423    |  177493 K  |  177493 K  |
|       from small pool |       0    |    6857    |   84551 K  |   84551 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6937    |  262044 K  |  262044 K  |
|       from large pool |       2    |     423    |  177493 K  |  177493 K  |
|       from small pool |       0    |    6857    |   84551 K  |   84551 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     181    |     486    |     462    |
|       from large pool |      10    |     160    |     457    |     447    |
|       from small pool |      14    |      21    |      29    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3251    |  172192 K  |  172192 K  |
|       from large pool |       3    |     165    |  129610 K  |  129610 K  |
|       from small pool |       0    |    3240    |   42581 K  |   42581 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  8 18:38:13 2024]
Finished job 0.
1 of 1 steps (100%) done
