Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 12:05:35 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966

 Experiment start at: 2024-08-10 12:12:40.367553
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.9236701726913452
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8907533, 'precision': 0.8949358, 'recall': 0.8907838, 'specificity': 0.8907838, 'f1': 0.8904687, 'auroc': 0.95908314, 'binary_precision': 0.9357265, 'binary_recall': 0.839285, 'binary_specificity': 0.9422826, 'binary_f1_score': 0.8848858}
confusion matrix:
       0      1
0  23852   1461
1   4073  21270
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9482095, 'precision': 0.5679864, 'recall': 0.61040765, 'specificity': 0.61040765, 'f1': 0.58298695, 'auroc': 0.8080284, 'binary_precision': 0.15474452, 'binary_recall': 0.2554217, 'binary_specificity': 0.9653936, 'binary_f1_score': 0.19272727}
confusion matrix:
       0    1
0  16152  579
1    309  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88797706, 'precision': 0.65805835, 'recall': 0.74032074, 'specificity': 0.74032074, 'f1': 0.6866474, 'auroc': 0.8486841, 'binary_precision': 0.35384616, 'binary_recall': 0.56606215, 'binary_specificity': 0.91457933, 'binary_f1_score': 0.43547586}
confusion matrix:
      0    1
0  8544  798
1   335  437
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 12:30:54.120180,epoch time: 0:18:13.752627,used: 0:18:13.752627,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9266622, 'precision': 0.92876637, 'recall': 0.9266844, 'specificity': 0.9266844, 'f1': 0.9265747, 'auroc': 0.9766264, 'binary_precision': 0.95896107, 'binary_recall': 0.891572, 'binary_specificity': 0.96179676, 'binary_f1_score': 0.92403954}
confusion matrix:
       0      1
0  24345    967
1   2748  22596
---- Validation: 
scalar performance:
{'acc': 0.94401026, 'precision': 0.58425957, 'recall': 0.67052746, 'specificity': 0.67052746, 'f1': 0.6098739, 'auroc': 0.8285619, 'binary_precision': 0.18424103, 'binary_recall': 0.38313252, 'binary_specificity': 0.9579224, 'binary_f1_score': 0.24882631}
confusion matrix:
       0    1
0  16027  704
1    256  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.888768, 'precision': 0.6702945, 'recall': 0.7823392, 'specificity': 0.7823392, 'f1': 0.7059304, 'auroc': 0.870108, 'binary_precision': 0.37088516, 'binary_recall': 0.6567358, 'binary_specificity': 0.90794265, 'binary_f1_score': 0.47405332}
confusion matrix:
      0    1
0  8482  860
1   265  507
new oracle model saved
early stop counter: 1
val acc:0.9440102577209473, best validation acc: 0.9482095241546631, corresponding to test acc:                         0.8879770636558533 / 0.8887680172920227
after epoch: 2,now: 2024-08-10 12:48:09.286057,epoch time: 0:17:15.165877,used: 0:35:28.918504,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9379738, 'precision': 0.9408629, 'recall': 0.9379946, 'specificity': 0.9379946, 'f1': 0.937874, 'auroc': 0.98326373, 'binary_precision': 0.9766803, 'binary_recall': 0.89743894, 'binary_specificity': 0.97855026, 'binary_f1_score': 0.93538433}
confusion matrix:
       0      1
0  24772    543
1   2599  22742
---- Validation: 
scalar performance:
{'acc': 0.952642, 'precision': 0.6094314, 'recall': 0.69257444, 'specificity': 0.69257444, 'f1': 0.637746, 'auroc': 0.8466255, 'binary_precision': 0.23355705, 'binary_recall': 0.4192771, 'binary_specificity': 0.96587175, 'binary_f1_score': 0.29999998}
confusion matrix:
       0    1
0  16160  571
1    241  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90290684, 'precision': 0.68723935, 'recall': 0.7668211, 'specificity': 0.7668211, 'f1': 0.71718824, 'auroc': 0.8808603, 'binary_precision': 0.40837696, 'binary_recall': 0.6062176, 'binary_specificity': 0.92742455, 'binary_f1_score': 0.48800835}
confusion matrix:
      0    1
0  8664  678
1   304  468
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 13:05:29.812022,epoch time: 0:17:20.525965,used: 0:52:49.444469,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9434223, 'precision': 0.9462887, 'recall': 0.9434445, 'specificity': 0.9434445, 'f1': 0.94333327, 'auroc': 0.9864299, 'binary_precision': 0.9821934, 'binary_recall': 0.90328306, 'binary_specificity': 0.9836059, 'binary_f1_score': 0.941087}
confusion matrix:
       0      1
0  24899    415
1   2451  22891
---- Validation: 
scalar performance:
{'acc': 0.9541584, 'precision': 0.6159609, 'recall': 0.70040107, 'specificity': 0.70040107, 'f1': 0.6452114, 'auroc': 0.8517885, 'binary_precision': 0.24623802, 'binary_recall': 0.43373495, 'binary_specificity': 0.9670671, 'binary_f1_score': 0.31413612}
confusion matrix:
       0    1
0  16180  551
1    235  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8995452, 'precision': 0.68628794, 'recall': 0.78698474, 'specificity': 0.78698474, 'f1': 0.7213506, 'auroc': 0.8818655, 'binary_precision': 0.40271133, 'binary_recall': 0.65414506, 'binary_specificity': 0.9198244, 'binary_f1_score': 0.49851927}
confusion matrix:
      0    1
0  8593  749
1   267  505
better model found
persisted
after epoch: 4,now: 2024-08-10 13:22:52.777015,epoch time: 0:17:22.964993,used: 1:10:12.409462,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94952226, 'precision': 0.9511008, 'recall': 0.94953984, 'specificity': 0.94953984, 'f1': 0.94947946, 'auroc': 0.9875876, 'binary_precision': 0.9779344, 'binary_recall': 0.9198595, 'binary_specificity': 0.97922015, 'binary_f1_score': 0.94800836}
confusion matrix:
       0      1
0  24787    526
1   2031  23312
---- Validation: 
scalar performance:
{'acc': 0.9492593, 'precision': 0.60828733, 'recall': 0.7143398, 'specificity': 0.7143398, 'f1': 0.64104474, 'auroc': 0.8525256, 'binary_precision': 0.2301305, 'binary_recall': 0.46746987, 'binary_specificity': 0.9612097, 'binary_f1_score': 0.30842608}
confusion matrix:
       0    1
0  16082  649
1    221  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88936126, 'precision': 0.67487174, 'recall': 0.7981081, 'specificity': 0.7981081, 'f1': 0.7129267, 'auroc': 0.881644, 'binary_precision': 0.3772116, 'binary_recall': 0.6904145, 'binary_specificity': 0.9058018, 'binary_f1_score': 0.48787186}
confusion matrix:
      0    1
0  8462  880
1   239  533
early stop counter: 1
val acc:0.9492592811584473, best validation acc: 0.9541584253311157, corresponding to test acc:                         0.8995451927185059 / 0.9029068350791931
after epoch: 5,now: 2024-08-10 13:40:09.114788,epoch time: 0:17:16.337773,used: 1:27:28.747235,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95530635, 'precision': 0.9558921, 'recall': 0.95531917, 'specificity': 0.95531917, 'f1': 0.9552929, 'auroc': 0.98972714, 'binary_precision': 0.972411, 'binary_recall': 0.9372682, 'binary_specificity': 0.9733702, 'binary_f1_score': 0.9545162}
confusion matrix:
       0      1
0  24636    674
1   1590  23756
---- Validation: 
scalar performance:
{'acc': 0.9390528, 'precision': 0.5997435, 'recall': 0.7514076, 'specificity': 0.7514076, 'f1': 0.63688767, 'auroc': 0.865032, 'binary_precision': 0.21100917, 'binary_recall': 0.55421686, 'binary_specificity': 0.9485984, 'binary_f1_score': 0.30564785}
confusion matrix:
       0    1
0  15871  860
1    185  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.873245, 'precision': 0.66228366, 'recall': 0.817309, 'specificity': 0.817309, 'f1': 0.7014707, 'auroc': 0.8883239, 'binary_precision': 0.3473054, 'binary_recall': 0.7512953, 'binary_specificity': 0.88332266, 'binary_f1_score': 0.4750205}
confusion matrix:
      0     1
0  8252  1090
1   192   580
early stop counter: 2
val acc:0.9390528202056885, best validation acc: 0.9541584253311157, corresponding to test acc:                         0.8995451927185059 / 0.9029068350791931
after epoch: 6,now: 2024-08-10 13:57:06.868250,epoch time: 0:16:57.753462,used: 1:44:26.500697,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9569449, 'precision': 0.9583751, 'recall': 0.95696485, 'specificity': 0.95696485, 'f1': 0.95691264, 'auroc': 0.99119925, 'binary_precision': 0.9841575, 'binary_recall': 0.928904, 'binary_specificity': 0.9850257, 'binary_f1_score': 0.9557328}
confusion matrix:
       0      1
0  24931    379
1   1802  23544
---- Validation: 
scalar performance:
{'acc': 0.95281696, 'precision': 0.61902744, 'recall': 0.72203743, 'specificity': 0.72203743, 'f1': 0.6526455, 'auroc': 0.8696133, 'binary_precision': 0.25126263, 'binary_recall': 0.4795181, 'binary_specificity': 0.9645568, 'binary_f1_score': 0.32974318}
confusion matrix:
       0    1
0  16138  593
1    216  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89539254, 'precision': 0.6828134, 'recall': 0.79840225, 'specificity': 0.79840225, 'f1': 0.7205596, 'auroc': 0.88784844, 'binary_precision': 0.39344263, 'binary_recall': 0.68393785, 'binary_specificity': 0.91286665, 'binary_f1_score': 0.49952698}
confusion matrix:
      0    1
0  8528  814
1   244  528
early stop counter: 3
val acc:0.9528169631958008, best validation acc: 0.9541584253311157, corresponding to test acc:                         0.8995451927185059 / 0.9029068350791931
after epoch: 7,now: 2024-08-10 14:14:00.348375,epoch time: 0:16:53.480125,used: 2:01:19.980822,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96120894, 'precision': 0.96215117, 'recall': 0.96122324, 'specificity': 0.96122324, 'f1': 0.96119, 'auroc': 0.99248636, 'binary_precision': 0.98317695, 'binary_recall': 0.93852586, 'binary_specificity': 0.9839207, 'binary_f1_score': 0.96033263}
confusion matrix:
       0      1
0  24905    407
1   1558  23786
---- Validation: 
scalar performance:
{'acc': 0.9450601, 'precision': 0.6134535, 'recall': 0.7650602, 'specificity': 0.7650602, 'f1': 0.6539815, 'auroc': 0.8780379, 'binary_precision': 0.23781094, 'binary_recall': 0.5759036, 'binary_specificity': 0.9542167, 'binary_f1_score': 0.3366197}
confusion matrix:
       0    1
0  15965  766
1    176  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8850109, 'precision': 0.6745242, 'recall': 0.81833076, 'specificity': 0.81833076, 'f1': 0.71527797, 'auroc': 0.8894254, 'binary_precision': 0.3724723, 'binary_recall': 0.7396373, 'binary_specificity': 0.8970242, 'binary_f1_score': 0.49544466}
confusion matrix:
      0    1
0  8380  962
1   201  571
early stop counter: 4
val acc:0.9450600743293762, best validation acc: 0.9541584253311157, corresponding to test acc:                         0.8995451927185059 / 0.9029068350791931
after epoch: 8,now: 2024-08-10 14:31:03.272662,epoch time: 0:17:02.924287,used: 2:18:22.905109,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96353835, 'precision': 0.9642278, 'recall': 0.96354985, 'specificity': 0.96354985, 'f1': 0.9635255, 'auroc': 0.9930327, 'binary_precision': 0.982266, 'binary_recall': 0.94416606, 'binary_specificity': 0.9829337, 'binary_f1_score': 0.96283925}
confusion matrix:
       0      1
0  24881    432
1   1415  23928
---- Validation: 
scalar performance:
{'acc': 0.95147556, 'precision': 0.62514144, 'recall': 0.7565981, 'specificity': 0.7565981, 'f1': 0.6649141, 'auroc': 0.878471, 'binary_precision': 0.26171428, 'binary_recall': 0.5518072, 'binary_specificity': 0.96138906, 'binary_f1_score': 0.35503873}
confusion matrix:
       0    1
0  16085  646
1    186  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8918331, 'precision': 0.68365526, 'recall': 0.823212, 'specificity': 0.823212, 'f1': 0.72539437, 'auroc': 0.89508367, 'binary_precision': 0.39032698, 'binary_recall': 0.742228, 'binary_specificity': 0.9041961, 'binary_f1_score': 0.5116071}
confusion matrix:
      0    1
0  8447  895
1   199  573
early stop counter: 5
val acc:0.9514755606651306, best validation acc: 0.9541584253311157, corresponding to test acc:                         0.8995451927185059 / 0.9029068350791931
after epoch: 9,now: 2024-08-10 14:48:04.306134,epoch time: 0:17:01.033472,used: 2:35:23.938581,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96393317, 'precision': 0.9648124, 'recall': 0.96394706, 'specificity': 0.96394706, 'f1': 0.9639169, 'auroc': 0.99337375, 'binary_precision': 0.9851867, 'binary_recall': 0.94207704, 'binary_specificity': 0.985817, 'binary_f1_score': 0.9631497}
confusion matrix:
       0      1
0  24953    359
1   1468  23876
---- Validation: 
scalar performance:
{'acc': 0.94972587, 'precision': 0.6189534, 'recall': 0.748652, 'specificity': 0.748652, 'f1': 0.65742236, 'auroc': 0.8707117, 'binary_precision': 0.24972005, 'binary_recall': 0.5373494, 'binary_specificity': 0.95995456, 'binary_f1_score': 0.34097862}
confusion matrix:
       0    1
0  16061  670
1    192  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8907455, 'precision': 0.6800638, 'recall': 0.81311697, 'specificity': 0.81311697, 'f1': 0.7203349, 'auroc': 0.890605, 'binary_precision': 0.38493434, 'binary_recall': 0.7215026, 'binary_specificity': 0.90473133, 'binary_f1_score': 0.5020279}
confusion matrix:
      0    1
0  8452  890
1   215  557
early stop counter: 6
val acc:0.949725866317749, best validation acc: 0.9541584253311157, corresponding to test acc:                         0.8995451927185059 / 0.9029068350791931
after epoch: 10,now: 2024-08-10 15:05:33.946316,epoch time: 0:17:29.640182,used: 2:52:53.578763,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9680985, 'precision': 0.9685955, 'recall': 0.9681057, 'specificity': 0.9681057, 'f1': 0.9680904, 'auroc': 0.99473023, 'binary_precision': 0.9839651, 'binary_recall': 0.9517345, 'binary_specificity': 0.9844768, 'binary_f1_score': 0.96758145}
confusion matrix:
       0      1
0  24924    393
1   1223  24116
---- Validation: 
scalar performance:
{'acc': 0.9504841, 'precision': 0.62443674, 'recall': 0.7631397, 'specificity': 0.7631397, 'f1': 0.6652912, 'auroc': 0.8770635, 'binary_precision': 0.25995576, 'binary_recall': 0.56626505, 'binary_specificity': 0.96001434, 'binary_f1_score': 0.35633057}
confusion matrix:
       0    1
0  16062  669
1    180  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89084435, 'precision': 0.6825836, 'recall': 0.8238651, 'specificity': 0.8238651, 'f1': 0.724391, 'auroc': 0.89479625, 'binary_precision': 0.3879892, 'binary_recall': 0.7448186, 'binary_specificity': 0.9029116, 'binary_f1_score': 0.5102041}
confusion matrix:
      0    1
0  8435  907
1   197  575
early stop counter: 7
val acc:0.9504840970039368, best validation acc: 0.9541584253311157, corresponding to test acc:                         0.8995451927185059 / 0.9029068350791931
after epoch: 11,now: 2024-08-10 15:23:04.378629,epoch time: 0:17:30.432313,used: 3:10:24.011076,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9676445, 'precision': 0.96845335, 'recall': 0.967656, 'specificity': 0.967656, 'f1': 0.9676311, 'auroc': 0.9947957, 'binary_precision': 0.9880575, 'binary_recall': 0.9467682, 'binary_specificity': 0.98854387, 'binary_f1_score': 0.96697235}
confusion matrix:
       0      1
0  25024    290
1   1349  23993
---- Validation: 
scalar performance:
{'acc': 0.95736617, 'precision': 0.63175666, 'recall': 0.7208437, 'specificity': 0.7208437, 'f1': 0.6635132, 'auroc': 0.87686706, 'binary_precision': 0.27683616, 'binary_recall': 0.47228914, 'binary_specificity': 0.96939814, 'binary_f1_score': 0.34906498}
confusion matrix:
       0    1
0  16219  512
1    219  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90340126, 'precision': 0.6969782, 'recall': 0.80986726, 'specificity': 0.80986726, 'f1': 0.73563474, 'auroc': 0.89710224, 'binary_precision': 0.42023346, 'binary_recall': 0.69948184, 'binary_specificity': 0.9202526, 'binary_f1_score': 0.52503645}
confusion matrix:
      0    1
0  8597  745
1   232  540
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-10 15:40:24.312957,epoch time: 0:17:19.934328,used: 3:27:43.945404,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97084254, 'precision': 0.97128874, 'recall': 0.9708499, 'specificity': 0.9708499, 'f1': 0.970836, 'auroc': 0.99526775, 'binary_precision': 0.98590916, 'binary_recall': 0.955367, 'binary_specificity': 0.9863328, 'binary_f1_score': 0.97039783}
confusion matrix:
       0      1
0  24970    346
1   1131  24209
---- Validation: 
scalar performance:
{'acc': 0.9540418, 'precision': 0.6338627, 'recall': 0.7649627, 'specificity': 0.7649627, 'f1': 0.67487735, 'auroc': 0.8830075, 'binary_precision': 0.2787663, 'binary_recall': 0.56626505, 'binary_specificity': 0.9636603, 'binary_f1_score': 0.3736089}
confusion matrix:
       0    1
0  16123  608
1    180  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89677674, 'precision': 0.6914566, 'recall': 0.83004713, 'specificity': 0.83004713, 'f1': 0.73419654, 'auroc': 0.89713186, 'binary_precision': 0.40502793, 'binary_recall': 0.7512953, 'binary_specificity': 0.908799, 'binary_f1_score': 0.5263158}
confusion matrix:
      0    1
0  8490  852
1   192  580
early stop counter: 1
val acc:0.9540417790412903, best validation acc: 0.9573661684989929, corresponding to test acc:                         0.903401255607605 / 0.903401255607605
after epoch: 13,now: 2024-08-10 15:57:46.094419,epoch time: 0:17:21.781462,used: 3:45:05.726866,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9706451, 'precision': 0.97112036, 'recall': 0.970654, 'specificity': 0.970654, 'f1': 0.97063816, 'auroc': 0.99537814, 'binary_precision': 0.9862215, 'binary_recall': 0.95466024, 'binary_specificity': 0.9866477, 'binary_f1_score': 0.97018427}
confusion matrix:
       0      1
0  24976    338
1   1149  24193
---- Validation: 
scalar performance:
{'acc': 0.9606322, 'precision': 0.6456468, 'recall': 0.7295668, 'specificity': 0.7295668, 'f1': 0.6770487, 'auroc': 0.8791076, 'binary_precision': 0.30421686, 'binary_recall': 0.486747, 'binary_specificity': 0.9723866, 'binary_f1_score': 0.37442073}
confusion matrix:
       0    1
0  16269  462
1    213  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9056753, 'precision': 0.7005091, 'recall': 0.8093158, 'specificity': 0.8093158, 'f1': 0.7385841, 'auroc': 0.8974967, 'binary_precision': 0.42754778, 'binary_recall': 0.69559586, 'binary_specificity': 0.92303574, 'binary_f1_score': 0.5295858}
confusion matrix:
      0    1
0  8623  719
1   235  537
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-10 16:15:11.520513,epoch time: 0:17:25.426094,used: 4:02:31.152960,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97301406, 'precision': 0.97320354, 'recall': 0.97301924, 'specificity': 0.97301924, 'f1': 0.97301155, 'auroc': 0.9956912, 'binary_precision': 0.9828017, 'binary_recall': 0.96290594, 'binary_specificity': 0.98313254, 'binary_f1_score': 0.9727521}
confusion matrix:
       0      1
0  24888    427
1    940  24401
---- Validation: 
scalar performance:
{'acc': 0.95194215, 'precision': 0.6332609, 'recall': 0.7850356, 'specificity': 0.7850356, 'f1': 0.6777263, 'auroc': 0.884971, 'binary_precision': 0.27650273, 'binary_recall': 0.6096386, 'binary_specificity': 0.9604327, 'binary_f1_score': 0.38045114}
confusion matrix:
       0    1
0  16069  662
1    162  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89025116, 'precision': 0.68528503, 'recall': 0.8395859, 'specificity': 0.8395859, 'f1': 0.7291742, 'auroc': 0.8999417, 'binary_precision': 0.39040208, 'binary_recall': 0.7797927, 'binary_specificity': 0.89937913, 'binary_f1_score': 0.5203111}
confusion matrix:
      0    1
0  8402  940
1   170  602
early stop counter: 1
val acc:0.9519421458244324, best validation acc: 0.9606322050094604, corresponding to test acc:                         0.9056752920150757 / 0.9056752920150757
after epoch: 15,now: 2024-08-10 16:32:35.993631,epoch time: 0:17:24.473118,used: 4:19:55.626078,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_12_12_39_seed_0_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:19:55.626078 at 2024-08-10 16:32:35.993631
persisted model performance metric: 

scalar performance:
{'acc': 0.9056753, 'precision': 0.7005091, 'recall': 0.8093158, 'specificity': 0.8093158, 'f1': 0.7385841, 'auroc': 0.8974967, 'binary_precision': 0.42754778, 'binary_recall': 0.69559586, 'binary_specificity': 0.92303574, 'binary_f1_score': 0.5295858}
confusion matrix:
      0    1
0  8623  719
1   235  537
oracle model performance metric: 

scalar performance:
{'acc': 0.9056753, 'precision': 0.7005091, 'recall': 0.8093158, 'specificity': 0.8093158, 'f1': 0.7385841, 'auroc': 0.8974967, 'binary_precision': 0.42754778, 'binary_recall': 0.69559586, 'binary_specificity': 0.92303574, 'binary_f1_score': 0.5295858}
confusion matrix:
      0    1
0  8623  719
1   235  537
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1135 MiB |   8771 MiB | 351610 GiB | 351609 GiB |
|       from large pool |   1095 MiB |   8726 MiB | 346025 GiB | 346024 GiB |
|       from small pool |     39 MiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1135 MiB |   8771 MiB | 351610 GiB | 351609 GiB |
|       from large pool |   1095 MiB |   8726 MiB | 346025 GiB | 346024 GiB |
|       from small pool |     39 MiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1128 MiB |   8765 MiB | 351497 GiB | 351496 GiB |
|       from large pool |   1090 MiB |   8720 MiB | 345923 GiB | 345922 GiB |
|       from small pool |     37 MiB |     79 MiB |   5573 GiB |   5573 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9436 MiB |   9436 MiB |   9436 MiB |      0 B   |
|       from large pool |   9350 MiB |   9350 MiB |   9350 MiB |      0 B   |
|       from small pool |     86 MiB |     86 MiB |     86 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  84809 KiB |   1133 MiB | 213505 GiB | 213505 GiB |
|       from large pool |  59734 KiB |   1131 MiB | 207917 GiB | 207917 GiB |
|       from small pool |  25075 KiB |     24 MiB |   5588 GiB |   5588 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4918    |    7321    |   68991 K  |   68987 K  |
|       from large pool |     161    |     844    |   32632 K  |   32632 K  |
|       from small pool |    4757    |    7158    |   36359 K  |   36354 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4918    |    7321    |   68991 K  |   68987 K  |
|       from large pool |     161    |     844    |   32632 K  |   32632 K  |
|       from small pool |    4757    |    7158    |   36359 K  |   36354 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     334    |     334    |     334    |       0    |
|       from large pool |     291    |     291    |     291    |       0    |
|       from small pool |      43    |      43    |      43    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3198    |   37433 K  |   37432 K  |
|       from large pool |      19    |     292    |   21321 K  |   21321 K  |
|       from small pool |      56    |    3180    |   16111 K  |   16111 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8771 MiB | 351610 GiB | 351610 GiB |
|       from large pool |  16640 KiB |   8726 MiB | 346025 GiB | 346025 GiB |
|       from small pool |      0 KiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8771 MiB | 351610 GiB | 351610 GiB |
|       from large pool |  16640 KiB |   8726 MiB | 346025 GiB | 346025 GiB |
|       from small pool |      0 KiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8765 MiB | 351497 GiB | 351497 GiB |
|       from large pool |  16640 KiB |   8720 MiB | 345923 GiB | 345923 GiB |
|       from small pool |      0 KiB |     79 MiB |   5573 GiB |   5573 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1218 MiB |   9436 MiB |   9436 MiB |   8218 MiB |
|       from large pool |   1154 MiB |   9350 MiB |   9350 MiB |   8196 MiB |
|       from small pool |     64 MiB |     86 MiB |     86 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1133 MiB | 213505 GiB | 213505 GiB |
|       from large pool |  30464 KiB |   1131 MiB | 207917 GiB | 207917 GiB |
|       from small pool |      0 KiB |     36 MiB |   5588 GiB |   5588 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68991 K  |   68991 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36359 K  |   36359 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68991 K  |   68991 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36359 K  |   36359 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     334    |     334    |     275    |
|       from large pool |      27    |     291    |     291    |     264    |
|       from small pool |      32    |      43    |      43    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3198    |   37435 K  |   37435 K  |
|       from large pool |       2    |     292    |   21321 K  |   21321 K  |
|       from small pool |       0    |    3180    |   16113 K  |   16113 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8771 MiB | 351610 GiB | 351610 GiB |
|       from large pool |  16640 KiB |   8726 MiB | 346025 GiB | 346025 GiB |
|       from small pool |      0 KiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8771 MiB | 351610 GiB | 351610 GiB |
|       from large pool |  16640 KiB |   8726 MiB | 346025 GiB | 346025 GiB |
|       from small pool |      0 KiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8765 MiB | 351497 GiB | 351497 GiB |
|       from large pool |  16640 KiB |   8720 MiB | 345923 GiB | 345923 GiB |
|       from small pool |      0 KiB |     79 MiB |   5573 GiB |   5573 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1218 MiB |   9436 MiB |   9436 MiB |   8218 MiB |
|       from large pool |   1154 MiB |   9350 MiB |   9350 MiB |   8196 MiB |
|       from small pool |     64 MiB |     86 MiB |     86 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1133 MiB | 213505 GiB | 213505 GiB |
|       from large pool |  30464 KiB |   1131 MiB | 207917 GiB | 207917 GiB |
|       from small pool |      0 KiB |     36 MiB |   5588 GiB |   5588 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68991 K  |   68991 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36359 K  |   36359 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68991 K  |   68991 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36359 K  |   36359 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     334    |     334    |     275    |
|       from large pool |      27    |     291    |     291    |     264    |
|       from small pool |      32    |      43    |      43    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3198    |   37435 K  |   37435 K  |
|       from large pool |       2    |     292    |   21321 K  |   21321 K  |
|       from small pool |       0    |    3180    |   16113 K  |   16113 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966

 Experiment start at: 2024-08-10 16:42:32.807299
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.07590922713279724
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9017548, 'precision': 0.902559, 'recall': 0.90177333, 'specificity': 0.90177333, 'f1': 0.9017086, 'auroc': 0.96409273, 'binary_precision': 0.9207591, 'binary_recall': 0.879349, 'binary_specificity': 0.9241977, 'binary_f1_score': 0.89957774}
confusion matrix:
       0      1
0  23470   1925
1   3069  22368
---- Validation: 
scalar performance:
{'acc': 0.7326403, 'precision': 0.5184279, 'recall': 0.64814216, 'specificity': 0.64814216, 'f1': 0.46920043, 'auroc': 0.7061249, 'binary_precision': 0.05206308, 'binary_recall': 0.55916476, 'binary_specificity': 0.73711956, 'binary_f1_score': 0.09525691}
confusion matrix:
       0     1
0  12304  4388
1    190   241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68377763, 'precision': 0.5695665, 'recall': 0.7307424, 'specificity': 0.7307424, 'f1': 0.53483915, 'auroc': 0.7792716, 'binary_precision': 0.16418323, 'binary_recall': 0.78599733, 'binary_specificity': 0.67548746, 'binary_f1_score': 0.2716275}
confusion matrix:
      0     1
0  6305  3029
1   162   595
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 17:00:23.901800,epoch time: 0:17:51.094501,used: 0:17:51.094501,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93812954, 'precision': 0.94049454, 'recall': 0.93815845, 'specificity': 0.93815845, 'f1': 0.9380492, 'auroc': 0.98226774, 'binary_precision': 0.9729684, 'binary_recall': 0.9013996, 'binary_specificity': 0.9749173, 'binary_f1_score': 0.9358177}
confusion matrix:
       0      1
0  24759    637
1   2508  22928
---- Validation: 
scalar performance:
{'acc': 0.8872861, 'precision': 0.5391933, 'recall': 0.6540026, 'specificity': 0.6540026, 'f1': 0.54693514, 'auroc': 0.77256763, 'binary_precision': 0.095083736, 'binary_recall': 0.40835267, 'binary_specificity': 0.89965254, 'binary_f1_score': 0.15425067}
confusion matrix:
       0     1
0  15017  1675
1    255   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84005547, 'precision': 0.6192008, 'recall': 0.7581667, 'specificity': 0.7581667, 'f1': 0.6455728, 'auroc': 0.83778214, 'binary_precision': 0.26949972, 'binary_recall': 0.661823, 'binary_specificity': 0.85451037, 'binary_f1_score': 0.3830275}
confusion matrix:
      0     1
0  7976  1358
1   256   501
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 17:17:20.916469,epoch time: 0:16:57.014669,used: 0:34:48.109170,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95026755, 'precision': 0.95173496, 'recall': 0.9502912, 'specificity': 0.9502912, 'f1': 0.9502289, 'auroc': 0.98706365, 'binary_precision': 0.9776888, 'binary_recall': 0.9216496, 'binary_specificity': 0.97893286, 'binary_f1_score': 0.94884247}
confusion matrix:
       0      1
0  24860    535
1   1993  23444
---- Validation: 
scalar performance:
{'acc': 0.88308126, 'precision': 0.5492935, 'recall': 0.7094829, 'specificity': 0.7094829, 'f1': 0.56093884, 'auroc': 0.8092598, 'binary_precision': 0.11209877, 'binary_recall': 0.52668214, 'binary_specificity': 0.89228374, 'binary_f1_score': 0.18485343}
confusion matrix:
       0     1
0  14894  1798
1    204   227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85353285, 'precision': 0.64015186, 'recall': 0.80126107, 'specificity': 0.80126107, 'f1': 0.6735236, 'auroc': 0.8718109, 'binary_precision': 0.3041825, 'binary_recall': 0.73976225, 'binary_specificity': 0.8627598, 'binary_f1_score': 0.43110088}
confusion matrix:
      0     1
0  8053  1281
1   197   560
new oracle model saved
early stop counter: 1
val acc:0.8830812573432922, best validation acc: 0.8872861266136169, corresponding to test acc:                         0.8400554656982422 / 0.8535328507423401
after epoch: 3,now: 2024-08-10 17:34:15.200248,epoch time: 0:16:54.283779,used: 0:51:42.392949,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9561497, 'precision': 0.95772576, 'recall': 0.956174, 'specificity': 0.956174, 'f1': 0.95611346, 'auroc': 0.99057925, 'binary_precision': 0.98479277, 'binary_recall': 0.9266816, 'binary_specificity': 0.98566645, 'binary_f1_score': 0.95485383}
confusion matrix:
       0      1
0  25031    364
1   1865  23572
---- Validation: 
scalar performance:
{'acc': 0.91999066, 'precision': 0.56910694, 'recall': 0.7046813, 'specificity': 0.7046813, 'f1': 0.5945002, 'auroc': 0.82519287, 'binary_precision': 0.15247965, 'binary_recall': 0.47795823, 'binary_specificity': 0.9314043, 'binary_f1_score': 0.23120092}
confusion matrix:
       0     1
0  15547  1145
1    225   206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88702804, 'precision': 0.6681426, 'recall': 0.7914479, 'specificity': 0.7914479, 'f1': 0.7054428, 'auroc': 0.8767853, 'binary_precision': 0.36428064, 'binary_recall': 0.678996, 'binary_specificity': 0.9038997, 'binary_f1_score': 0.47416973}
confusion matrix:
      0    1
0  8437  897
1   243  514
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-10 17:51:22.773546,epoch time: 0:17:07.573298,used: 1:08:49.966247,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9635269, 'precision': 0.96404016, 'recall': 0.9635421, 'specificity': 0.9635421, 'f1': 0.96351767, 'auroc': 0.992237, 'binary_precision': 0.9797014, 'binary_recall': 0.9467353, 'binary_specificity': 0.98034894, 'binary_f1_score': 0.9629363}
confusion matrix:
       0      1
0  24894    499
1   1355  24084
---- Validation: 
scalar performance:
{'acc': 0.9032296, 'precision': 0.56366, 'recall': 0.7322488, 'specificity': 0.7322488, 'f1': 0.5857804, 'auroc': 0.82953817, 'binary_precision': 0.13983549, 'binary_recall': 0.5522042, 'binary_specificity': 0.9122933, 'binary_f1_score': 0.22315988}
confusion matrix:
       0     1
0  15228  1464
1    193   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87384796, 'precision': 0.6564007, 'recall': 0.80010366, 'specificity': 0.80010366, 'f1': 0.693794, 'auroc': 0.881088, 'binary_precision': 0.33834586, 'binary_recall': 0.71334213, 'binary_specificity': 0.8868652, 'binary_f1_score': 0.45898855}
confusion matrix:
      0     1
0  8278  1056
1   217   540
early stop counter: 1
val acc:0.9032295942306519, best validation acc: 0.9199906587600708, corresponding to test acc:                         0.8870280385017395 / 0.8870280385017395
after epoch: 5,now: 2024-08-10 18:08:32.681659,epoch time: 0:17:09.908113,used: 1:25:59.874360,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9659073, 'precision': 0.9664635, 'recall': 0.96592104, 'specificity': 0.96592104, 'f1': 0.9658978, 'auroc': 0.9933486, 'binary_precision': 0.98276913, 'binary_recall': 0.9484982, 'binary_specificity': 0.98334384, 'binary_f1_score': 0.9653296}
confusion matrix:
       0      1
0  24973    423
1   1310  24126
---- Validation: 
scalar performance:
{'acc': 0.8940606, 'precision': 0.5629184, 'recall': 0.7535391, 'specificity': 0.7535391, 'f1': 0.5833058, 'auroc': 0.8364865, 'binary_precision': 0.13700788, 'binary_recall': 0.60556847, 'binary_specificity': 0.9015097, 'binary_f1_score': 0.22345892}
confusion matrix:
       0     1
0  15048  1644
1    170   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86483, 'precision': 0.6482729, 'recall': 0.7994776, 'specificity': 0.7994776, 'f1': 0.68405974, 'auroc': 0.8781266, 'binary_precision': 0.32157555, 'binary_recall': 0.7225892, 'binary_specificity': 0.87636596, 'binary_f1_score': 0.4450773}
confusion matrix:
      0     1
0  8180  1154
1   210   547
early stop counter: 2
val acc:0.8940606117248535, best validation acc: 0.9199906587600708, corresponding to test acc:                         0.8870280385017395 / 0.8870280385017395
after epoch: 6,now: 2024-08-10 18:25:42.015290,epoch time: 0:17:09.333631,used: 1:43:09.207991,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9664975, 'precision': 0.9673463, 'recall': 0.96651524, 'specificity': 0.96651524, 'f1': 0.9664832, 'auroc': 0.9938664, 'binary_precision': 0.9874712, 'binary_recall': 0.9450407, 'binary_specificity': 0.9879898, 'binary_f1_score': 0.96579015}
confusion matrix:
       0      1
0  25090    305
1   1398  24039
---- Validation: 
scalar performance:
{'acc': 0.9219179, 'precision': 0.5799766, 'recall': 0.74183416, 'specificity': 0.74183416, 'f1': 0.6106624, 'auroc': 0.8415266, 'binary_precision': 0.17221418, 'binary_recall': 0.5522042, 'binary_specificity': 0.9314642, 'binary_f1_score': 0.26254824}
confusion matrix:
       0     1
0  15548  1144
1    193   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8892082, 'precision': 0.6677499, 'recall': 0.7792738, 'specificity': 0.7792738, 'f1': 0.70314467, 'auroc': 0.87183934, 'binary_precision': 0.36579925, 'binary_recall': 0.64993393, 'binary_specificity': 0.9086137, 'binary_f1_score': 0.46812555}
confusion matrix:
      0    1
0  8481  853
1   265  492
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-10 18:43:11.788072,epoch time: 0:17:29.772782,used: 2:00:38.980773,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9681106, 'precision': 0.9687282, 'recall': 0.9681236, 'specificity': 0.9681236, 'f1': 0.9681008, 'auroc': 0.99414635, 'binary_precision': 0.9859201, 'binary_recall': 0.94983095, 'binary_specificity': 0.9864163, 'binary_f1_score': 0.96753913}
confusion matrix:
       0      1
0  25053    345
1   1276  24158
---- Validation: 
scalar performance:
{'acc': 0.9057992, 'precision': 0.5710718, 'recall': 0.7595599, 'specificity': 0.7595599, 'f1': 0.59713227, 'auroc': 0.8478664, 'binary_precision': 0.15316902, 'binary_recall': 0.60556847, 'binary_specificity': 0.9135514, 'binary_f1_score': 0.24449648}
confusion matrix:
       0     1
0  15249  1443
1    170   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87741554, 'precision': 0.6577028, 'recall': 0.7917142, 'specificity': 0.7917142, 'f1': 0.69452953, 'auroc': 0.87229836, 'binary_precision': 0.34272608, 'binary_recall': 0.69088507, 'binary_specificity': 0.8925434, 'binary_f1_score': 0.45816907}
confusion matrix:
      0     1
0  8331  1003
1   234   523
early stop counter: 1
val acc:0.9057992100715637, best validation acc: 0.9219179153442383, corresponding to test acc:                         0.889208197593689 / 0.889208197593689
after epoch: 8,now: 2024-08-10 19:00:51.973664,epoch time: 0:17:40.185592,used: 2:18:19.166365,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9716714, 'precision': 0.97201025, 'recall': 0.97168154, 'specificity': 0.97168154, 'f1': 0.9716667, 'auroc': 0.9952302, 'binary_precision': 0.9848454, 'binary_recall': 0.9581286, 'binary_specificity': 0.9852345, 'binary_f1_score': 0.9713033}
confusion matrix:
       0      1
0  25022    375
1   1065  24370
---- Validation: 
scalar performance:
{'acc': 0.90358, 'precision': 0.56938756, 'recall': 0.75842166, 'specificity': 0.75842166, 'f1': 0.5943722, 'auroc': 0.85094607, 'binary_precision': 0.14982778, 'binary_recall': 0.60556847, 'binary_specificity': 0.91127485, 'binary_f1_score': 0.24022089}
confusion matrix:
       0     1
0  15211  1481
1    170   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87622637, 'precision': 0.6569817, 'recall': 0.7934991, 'specificity': 0.7934991, 'f1': 0.6939027, 'auroc': 0.87369144, 'binary_precision': 0.34087968, 'binary_recall': 0.6961691, 'binary_specificity': 0.8908292, 'binary_f1_score': 0.45766386}
confusion matrix:
      0     1
0  8315  1019
1   230   527
early stop counter: 2
val acc:0.9035800099372864, best validation acc: 0.9219179153442383, corresponding to test acc:                         0.889208197593689 / 0.889208197593689
after epoch: 9,now: 2024-08-10 19:18:12.909919,epoch time: 0:17:20.936255,used: 2:35:40.102620,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9718091, 'precision': 0.9719914, 'recall': 0.971817, 'specificity': 0.971817, 'f1': 0.9718067, 'auroc': 0.99537563, 'binary_precision': 0.9814659, 'binary_recall': 0.9618258, 'binary_specificity': 0.9818082, 'binary_f1_score': 0.9715466}
confusion matrix:
       0      1
0  24934    462
1    971  24465
---- Validation: 
scalar performance:
{'acc': 0.8872277, 'precision': 0.56399107, 'recall': 0.7771577, 'specificity': 0.7771577, 'f1': 0.58354014, 'auroc': 0.8618846, 'binary_precision': 0.13768116, 'binary_recall': 0.6612529, 'binary_specificity': 0.89306253, 'binary_f1_score': 0.22790882}
confusion matrix:
       0     1
0  14907  1785
1    146   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8485779, 'precision': 0.642856, 'recall': 0.8240739, 'specificity': 0.8240739, 'f1': 0.67656916, 'auroc': 0.8839288, 'binary_precision': 0.30481014, 'binary_recall': 0.7952444, 'binary_specificity': 0.85290337, 'binary_f1_score': 0.44070283}
confusion matrix:
      0     1
0  7961  1373
1   155   602
early stop counter: 3
val acc:0.8872277140617371, best validation acc: 0.9219179153442383, corresponding to test acc:                         0.889208197593689 / 0.889208197593689
after epoch: 10,now: 2024-08-10 19:35:07.686207,epoch time: 0:16:54.776288,used: 2:52:34.878908,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97450423, 'precision': 0.97472537, 'recall': 0.9745146, 'specificity': 0.9745146, 'f1': 0.97450167, 'auroc': 0.9959481, 'binary_precision': 0.985209, 'binary_recall': 0.963522, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.97424483}
confusion matrix:
       0      1
0  25024    368
1    928  24512
---- Validation: 
scalar performance:
{'acc': 0.88465804, 'precision': 0.5623385, 'recall': 0.7747096, 'specificity': 0.7747096, 'f1': 0.58053064, 'auroc': 0.8603951, 'binary_precision': 0.1344697, 'binary_recall': 0.6589327, 'binary_specificity': 0.8904865, 'binary_f1_score': 0.22335826}
confusion matrix:
       0     1
0  14864  1828
1    147   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85937965, 'precision': 0.6483054, 'recall': 0.81595325, 'specificity': 0.81595325, 'f1': 0.6843788, 'auroc': 0.8761574, 'binary_precision': 0.31813186, 'binary_recall': 0.7648613, 'binary_specificity': 0.8670452, 'binary_f1_score': 0.44935971}
confusion matrix:
      0     1
0  8093  1241
1   178   579
early stop counter: 4
val acc:0.8846580386161804, best validation acc: 0.9219179153442383, corresponding to test acc:                         0.889208197593689 / 0.889208197593689
after epoch: 11,now: 2024-08-10 19:52:31.768596,epoch time: 0:17:24.082389,used: 3:09:58.961297,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9746223, 'precision': 0.97475505, 'recall': 0.97463, 'specificity': 0.97463, 'f1': 0.9746208, 'auroc': 0.99615884, 'binary_precision': 0.9829221, 'binary_recall': 0.9660757, 'binary_specificity': 0.98318434, 'binary_f1_score': 0.97442615}
confusion matrix:
       0      1
0  24966    427
1    863  24576
---- Validation: 
scalar performance:
{'acc': 0.87221867, 'precision': 0.5572773, 'recall': 0.7751101, 'specificity': 0.7751101, 'f1': 0.57001436, 'auroc': 0.85872185, 'binary_precision': 0.124090716, 'binary_recall': 0.6728538, 'binary_specificity': 0.8773664, 'binary_f1_score': 0.20953758}
confusion matrix:
       0     1
0  14645  2047
1    141   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84639776, 'precision': 0.6406739, 'recall': 0.8210746, 'specificity': 0.8210746, 'f1': 0.67352337, 'auroc': 0.87573826, 'binary_precision': 0.30085385, 'binary_recall': 0.7912814, 'binary_specificity': 0.8508678, 'binary_f1_score': 0.43595347}
confusion matrix:
      0     1
0  7942  1392
1   158   599
early stop counter: 5
val acc:0.872218668460846, best validation acc: 0.9219179153442383, corresponding to test acc:                         0.889208197593689 / 0.889208197593689
after epoch: 12,now: 2024-08-10 20:09:42.131891,epoch time: 0:17:10.363295,used: 3:27:09.324592,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9744059, 'precision': 0.9747106, 'recall': 0.9744155, 'specificity': 0.9744155, 'f1': 0.9744021, 'auroc': 0.9959725, 'binary_precision': 0.986926, 'binary_recall': 0.9615884, 'binary_specificity': 0.9872426, 'binary_f1_score': 0.9740924}
confusion matrix:
       0      1
0  25073    324
1    977  24458
---- Validation: 
scalar performance:
{'acc': 0.8854757, 'precision': 0.56279165, 'recall': 0.77512896, 'specificity': 0.77512896, 'f1': 0.5813833, 'auroc': 0.86179614, 'binary_precision': 0.13536702, 'binary_recall': 0.6589327, 'binary_specificity': 0.8913252, 'binary_f1_score': 0.2245947}
confusion matrix:
       0     1
0  14878  1814
1    147   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85323554, 'precision': 0.6467825, 'recall': 0.8271985, 'specificity': 0.8271985, 'f1': 0.6820874, 'auroc': 0.8821577, 'binary_precision': 0.31243524, 'binary_recall': 0.7965654, 'binary_specificity': 0.8578316, 'binary_f1_score': 0.44882768}
confusion matrix:
      0     1
0  8007  1327
1   154   603
early stop counter: 6
val acc:0.8854756951332092, best validation acc: 0.9219179153442383, corresponding to test acc:                         0.889208197593689 / 0.889208197593689
after epoch: 13,now: 2024-08-10 20:27:08.273481,epoch time: 0:17:26.141590,used: 3:44:35.466182,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97570425, 'precision': 0.976035, 'recall': 0.97571427, 'specificity': 0.97571427, 'f1': 0.9757004, 'auroc': 0.9965527, 'binary_precision': 0.9887704, 'binary_recall': 0.9623747, 'binary_specificity': 0.98905385, 'binary_f1_score': 0.975394}
confusion matrix:
       0      1
0  25119    278
1    957  24478
---- Validation: 
scalar performance:
{'acc': 0.88424927, 'precision': 0.56170267, 'recall': 0.7722396, 'specificity': 0.7722396, 'f1': 0.57950014, 'auroc': 0.8597144, 'binary_precision': 0.13333334, 'binary_recall': 0.65429235, 'binary_specificity': 0.8901869, 'binary_f1_score': 0.22152397}
confusion matrix:
       0     1
0  14859  1833
1    149   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86264986, 'precision': 0.650188, 'recall': 0.81347245, 'specificity': 0.81347245, 'f1': 0.68682796, 'auroc': 0.87619126, 'binary_precision': 0.32261702, 'binary_recall': 0.7556143, 'binary_specificity': 0.8713306, 'binary_f1_score': 0.4521739}
confusion matrix:
      0     1
0  8133  1201
1   185   572
early stop counter: 7
val acc:0.8842492699623108, best validation acc: 0.9219179153442383, corresponding to test acc:                         0.889208197593689 / 0.889208197593689
after epoch: 14,now: 2024-08-10 20:44:09.100519,epoch time: 0:17:00.827038,used: 4:01:36.293220,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97653055, 'precision': 0.9768304, 'recall': 0.97654057, 'specificity': 0.97654057, 'f1': 0.9765272, 'auroc': 0.9967594, 'binary_precision': 0.988987, 'binary_recall': 0.96383077, 'binary_specificity': 0.9892503, 'binary_f1_score': 0.9762469}
confusion matrix:
       0      1
0  25123    273
1    920  24516
---- Validation: 
scalar performance:
{'acc': 0.8736203, 'precision': 0.55753815, 'recall': 0.77356875, 'specificity': 0.77356875, 'f1': 0.5707668, 'auroc': 0.85631454, 'binary_precision': 0.12472932, 'binary_recall': 0.6682135, 'binary_specificity': 0.878924, 'binary_f1_score': 0.21021898}
confusion matrix:
       0     1
0  14671  2021
1    143   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86502826, 'precision': 0.6516502, 'recall': 0.81172335, 'specificity': 0.81172335, 'f1': 0.6886585, 'auroc': 0.87767875, 'binary_precision': 0.32604945, 'binary_recall': 0.74900925, 'binary_specificity': 0.8744375, 'binary_f1_score': 0.45432693}
confusion matrix:
      0     1
0  8162  1172
1   190   567
early stop counter: 8
val acc:0.8736202716827393, best validation acc: 0.9219179153442383, corresponding to test acc:                         0.889208197593689 / 0.889208197593689
after epoch: 15,now: 2024-08-10 21:01:27.810672,epoch time: 0:17:18.710153,used: 4:18:55.003373,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_42_31_seed_1_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:18:55.003373 at 2024-08-10 21:01:27.810672
persisted model performance metric: 

scalar performance:
{'acc': 0.8892082, 'precision': 0.6677499, 'recall': 0.7792738, 'specificity': 0.7792738, 'f1': 0.70314467, 'auroc': 0.87183934, 'binary_precision': 0.36579925, 'binary_recall': 0.64993393, 'binary_specificity': 0.9086137, 'binary_f1_score': 0.46812555}
confusion matrix:
      0    1
0  8481  853
1   265  492
oracle model performance metric: 

scalar performance:
{'acc': 0.8892082, 'precision': 0.6677499, 'recall': 0.7792738, 'specificity': 0.7792738, 'f1': 0.70314467, 'auroc': 0.87183934, 'binary_precision': 0.36579925, 'binary_recall': 0.64993393, 'binary_specificity': 0.9086137, 'binary_f1_score': 0.46812555}
confusion matrix:
      0    1
0  8481  853
1   265  492
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1136 MiB |   8772 MiB | 708214 GiB | 708212 GiB |
|       from large pool |   1097 MiB |   8728 MiB | 696994 GiB | 696992 GiB |
|       from small pool |     39 MiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1136 MiB |   8772 MiB | 708214 GiB | 708212 GiB |
|       from large pool |   1097 MiB |   8728 MiB | 696994 GiB | 696992 GiB |
|       from small pool |     39 MiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1128 MiB |   8765 MiB | 707954 GiB | 707953 GiB |
|       from large pool |   1090 MiB |   8720 MiB | 696758 GiB | 696757 GiB |
|       from small pool |     37 MiB |     79 MiB |  11196 GiB |  11196 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9412 MiB |   9436 MiB |  17630 MiB |   8218 MiB |
|       from large pool |   9330 MiB |   9350 MiB |  17526 MiB |   8196 MiB |
|       from small pool |     82 MiB |     86 MiB |    104 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 259441 KiB |   1166 MiB | 435533 GiB | 435533 GiB |
|       from large pool | 238456 KiB |   1163 MiB | 424307 GiB | 424307 GiB |
|       from small pool |  20985 KiB |     36 MiB |  11226 GiB |  11226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7343    |  138623 K  |  138618 K  |
|       from large pool |     161    |     844    |   65711 K  |   65711 K  |
|       from small pool |    4745    |    7180    |   72911 K  |   72907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7343    |  138623 K  |  138618 K  |
|       from large pool |     161    |     844    |   65711 K  |   65711 K  |
|       from small pool |    4745    |    7180    |   72911 K  |   72907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     331    |     334    |     606    |     275    |
|       from large pool |     290    |     291    |     554    |     264    |
|       from small pool |      41    |      43    |      52    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3208    |   73987 K  |   73987 K  |
|       from large pool |      18    |     292    |   42143 K  |   42143 K  |
|       from small pool |      56    |    3191    |   31844 K  |   31844 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8772 MiB | 708214 GiB | 708214 GiB |
|       from large pool |  16640 KiB |   8728 MiB | 696994 GiB | 696994 GiB |
|       from small pool |      0 KiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8772 MiB | 708214 GiB | 708214 GiB |
|       from large pool |  16640 KiB |   8728 MiB | 696994 GiB | 696994 GiB |
|       from small pool |      0 KiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8765 MiB | 707954 GiB | 707954 GiB |
|       from large pool |  16640 KiB |   8720 MiB | 696758 GiB | 696758 GiB |
|       from small pool |      0 KiB |     79 MiB |  11196 GiB |  11196 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1390 MiB |   9436 MiB |  17630 MiB |  16240 MiB |
|       from large pool |   1330 MiB |   9350 MiB |  17526 MiB |  16196 MiB |
|       from small pool |     60 MiB |     86 MiB |    104 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1166 MiB | 435533 GiB | 435533 GiB |
|       from large pool |  30464 KiB |   1163 MiB | 424307 GiB | 424307 GiB |
|       from small pool |      0 KiB |     38 MiB |  11226 GiB |  11226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138623 K  |  138623 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72911 K  |   72911 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138623 K  |  138623 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72911 K  |   72911 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     334    |     606    |     549    |
|       from large pool |      27    |     291    |     554    |     527    |
|       from small pool |      30    |      43    |      52    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3208    |   73989 K  |   73989 K  |
|       from large pool |       2    |     292    |   42143 K  |   42143 K  |
|       from small pool |       0    |    3191    |   31846 K  |   31846 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8772 MiB | 708214 GiB | 708214 GiB |
|       from large pool |  16640 KiB |   8728 MiB | 696994 GiB | 696994 GiB |
|       from small pool |      0 KiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8772 MiB | 708214 GiB | 708214 GiB |
|       from large pool |  16640 KiB |   8728 MiB | 696994 GiB | 696994 GiB |
|       from small pool |      0 KiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8765 MiB | 707954 GiB | 707954 GiB |
|       from large pool |  16640 KiB |   8720 MiB | 696758 GiB | 696758 GiB |
|       from small pool |      0 KiB |     79 MiB |  11196 GiB |  11196 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1390 MiB |   9436 MiB |  17630 MiB |  16240 MiB |
|       from large pool |   1330 MiB |   9350 MiB |  17526 MiB |  16196 MiB |
|       from small pool |     60 MiB |     86 MiB |    104 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1166 MiB | 435533 GiB | 435533 GiB |
|       from large pool |  30464 KiB |   1163 MiB | 424307 GiB | 424307 GiB |
|       from small pool |      0 KiB |     38 MiB |  11226 GiB |  11226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138623 K  |  138623 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72911 K  |   72911 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138623 K  |  138623 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72911 K  |   72911 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     334    |     606    |     549    |
|       from large pool |      27    |     291    |     554    |     527    |
|       from small pool |      30    |      43    |      52    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3208    |   73989 K  |   73989 K  |
|       from large pool |       2    |     292    |   42143 K  |   42143 K  |
|       from small pool |       0    |    3191    |   31846 K  |   31846 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966

 Experiment start at: 2024-08-10 21:11:47.181180
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.07966706156730652
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88573587, 'precision': 0.88573587, 'recall': 0.8857358, 'specificity': 0.8857358, 'f1': 0.88573587, 'auroc': 0.9566382, 'binary_precision': 0.8856922, 'binary_recall': 0.8858635, 'binary_specificity': 0.88560814, 'binary_f1_score': 0.88577783}
confusion matrix:
       0      1
0  22885   2956
1   2951  22904
---- Validation: 
scalar performance:
{'acc': 0.6969166, 'precision': 0.516242, 'recall': 0.64523906, 'specificity': 0.64523906, 'f1': 0.45260668, 'auroc': 0.6929554, 'binary_precision': 0.046904672, 'binary_recall': 0.59090906, 'binary_specificity': 0.69956905, 'binary_f1_score': 0.08691063}
confusion matrix:
       0     1
0  11687  5019
1    171   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64456993, 'precision': 0.5539342, 'recall': 0.6762751, 'specificity': 0.6762751, 'f1': 0.5044067, 'auroc': 0.73330873, 'binary_precision': 0.14485744, 'binary_recall': 0.7139272, 'binary_specificity': 0.63862294, 'binary_f1_score': 0.24084656}
confusion matrix:
      0     1
0  5936  3359
1   228   569
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 21:31:51.121934,epoch time: 0:20:03.940754,used: 0:20:03.940754,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9331089, 'precision': 0.93467176, 'recall': 0.93311477, 'specificity': 0.93311477, 'f1': 0.93304944, 'auroc': 0.97858393, 'binary_precision': 0.9607835, 'binary_recall': 0.90310603, 'binary_specificity': 0.9631235, 'binary_f1_score': 0.9310524}
confusion matrix:
       0      1
0  24890    953
1   2505  23348
---- Validation: 
scalar performance:
{'acc': 0.91654986, 'precision': 0.5506663, 'recall': 0.6516753, 'specificity': 0.6516753, 'f1': 0.5676238, 'auroc': 0.746336, 'binary_precision': 0.117913835, 'binary_recall': 0.37320575, 'binary_specificity': 0.93014485, 'binary_f1_score': 0.17920735}
confusion matrix:
       0     1
0  15539  1167
1    262   156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8782204, 'precision': 0.6045583, 'recall': 0.62072533, 'specificity': 0.62072533, 'f1': 0.6117021, 'auroc': 0.79425615, 'binary_precision': 0.26873663, 'binary_recall': 0.314931, 'binary_specificity': 0.92651963, 'binary_f1_score': 0.2900058}
confusion matrix:
      0    1
0  8612  683
1   546  251
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 21:51:43.465176,epoch time: 0:19:52.343242,used: 0:39:56.283996,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.946669, 'precision': 0.94912446, 'recall': 0.9466747, 'specificity': 0.9466747, 'f1': 0.9465965, 'auroc': 0.9855223, 'binary_precision': 0.98237187, 'binary_recall': 0.90967816, 'binary_specificity': 0.98367125, 'binary_f1_score': 0.94462854}
confusion matrix:
       0      1
0  25422    422
1   2335  23517
---- Validation: 
scalar performance:
{'acc': 0.9445223, 'precision': 0.57637745, 'recall': 0.64385283, 'specificity': 0.64385283, 'f1': 0.5975446, 'auroc': 0.7779276, 'binary_precision': 0.16997519, 'binary_recall': 0.3277512, 'binary_specificity': 0.9599545, 'binary_f1_score': 0.22385621}
confusion matrix:
       0    1
0  16037  669
1    281  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9036861, 'precision': 0.62294316, 'recall': 0.5748997, 'specificity': 0.5748997, 'f1': 0.59042394, 'auroc': 0.8072812, 'binary_precision': 0.31343284, 'binary_recall': 0.18444166, 'binary_specificity': 0.9653577, 'binary_f1_score': 0.23222749}
confusion matrix:
      0    1
0  8973  322
1   650  147
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 22:09:11.938053,epoch time: 0:17:28.472877,used: 0:57:24.756873,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9546193, 'precision': 0.9552806, 'recall': 0.95462084, 'specificity': 0.95462084, 'f1': 0.95460296, 'auroc': 0.9879899, 'binary_precision': 0.97265124, 'binary_recall': 0.9355513, 'binary_specificity': 0.97369033, 'binary_f1_score': 0.9537406}
confusion matrix:
       0      1
0  25166    680
1   1666  24184
---- Validation: 
scalar performance:
{'acc': 0.9261271, 'precision': 0.5670888, 'recall': 0.68457353, 'specificity': 0.68457353, 'f1': 0.5913811, 'auroc': 0.8080721, 'binary_precision': 0.14913008, 'binary_recall': 0.430622, 'binary_specificity': 0.9385251, 'binary_f1_score': 0.22153845}
confusion matrix:
       0     1
0  15679  1027
1    238   180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8975426, 'precision': 0.6384842, 'recall': 0.6266263, 'specificity': 0.6266263, 'f1': 0.63216805, 'auroc': 0.8299534, 'binary_precision': 0.3360996, 'binary_recall': 0.30489334, 'binary_specificity': 0.9483593, 'binary_f1_score': 0.31973687}
confusion matrix:
      0    1
0  8815  480
1   554  243
early stop counter: 1
val acc:0.9261270761489868, best validation acc: 0.9445223212242126, corresponding to test acc:                         0.9036861062049866 / 0.9036861062049866
after epoch: 4,now: 2024-08-10 22:26:57.143700,epoch time: 0:17:45.205647,used: 1:15:09.962520,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9573081, 'precision': 0.9584379, 'recall': 0.9573119, 'specificity': 0.9573119, 'f1': 0.95728207, 'auroc': 0.9904487, 'binary_precision': 0.98123497, 'binary_recall': 0.9324617, 'binary_specificity': 0.9821622, 'binary_f1_score': 0.9562268}
confusion matrix:
       0      1
0  25383    461
1   1746  24106
---- Validation: 
scalar performance:
{'acc': 0.932142, 'precision': 0.5767429, 'recall': 0.6969862, 'specificity': 0.6969862, 'f1': 0.6044745, 'auroc': 0.8208988, 'binary_precision': 0.16785714, 'binary_recall': 0.44976076, 'binary_specificity': 0.94421166, 'binary_f1_score': 0.24447334}
confusion matrix:
       0    1
0  15774  932
1    230  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90655965, 'precision': 0.6634222, 'recall': 0.63266855, 'specificity': 0.63266855, 'f1': 0.6458247, 'auroc': 0.8384807, 'binary_precision': 0.38522014, 'binary_recall': 0.30740276, 'binary_specificity': 0.9579344, 'binary_f1_score': 0.34194}
confusion matrix:
      0    1
0  8904  391
1   552  245
new oracle model saved
early stop counter: 2
val acc:0.9321420192718506, best validation acc: 0.9445223212242126, corresponding to test acc:                         0.9036861062049866 / 0.9065596461296082
after epoch: 5,now: 2024-08-10 22:44:42.682657,epoch time: 0:17:45.538957,used: 1:32:55.501477,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9613123, 'precision': 0.96243435, 'recall': 0.961318, 'specificity': 0.961318, 'f1': 0.96128917, 'auroc': 0.99201095, 'binary_precision': 0.9852714, 'binary_recall': 0.93664426, 'binary_specificity': 0.9859918, 'binary_f1_score': 0.9603427}
confusion matrix:
       0      1
0  25480    362
1   1638  24216
---- Validation: 
scalar performance:
{'acc': 0.93634665, 'precision': 0.5842075, 'recall': 0.7049724, 'specificity': 0.7049724, 'f1': 0.61412877, 'auroc': 0.83066, 'binary_precision': 0.18241966, 'binary_recall': 0.4617225, 'binary_specificity': 0.9482222, 'binary_f1_score': 0.2615176}
confusion matrix:
       0    1
0  15841  865
1    225  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9110186, 'precision': 0.6797251, 'recall': 0.6396777, 'specificity': 0.6396777, 'f1': 0.656291, 'auroc': 0.84281844, 'binary_precision': 0.41680396, 'binary_recall': 0.3174404, 'binary_specificity': 0.961915, 'binary_f1_score': 0.36039883}
confusion matrix:
      0    1
0  8941  354
1   544  253
new oracle model saved
early stop counter: 3
val acc:0.9363466501235962, best validation acc: 0.9445223212242126, corresponding to test acc:                         0.9036861062049866 / 0.9110186100006104
after epoch: 6,now: 2024-08-10 23:02:28.150906,epoch time: 0:17:45.468249,used: 1:50:40.969726,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96473616, 'precision': 0.96549135, 'recall': 0.9647393, 'specificity': 0.9647393, 'f1': 0.96472204, 'auroc': 0.9927273, 'binary_precision': 0.9842799, 'binary_recall': 0.9445691, 'binary_specificity': 0.9849095, 'binary_f1_score': 0.96401566}
confusion matrix:
       0      1
0  25454    390
1   1433  24419
---- Validation: 
scalar performance:
{'acc': 0.932726, 'precision': 0.5823096, 'recall': 0.71477914, 'specificity': 0.71477914, 'f1': 0.6126752, 'auroc': 0.8373349, 'binary_precision': 0.17807017, 'binary_recall': 0.48564592, 'binary_specificity': 0.9439124, 'binary_f1_score': 0.2605905}
confusion matrix:
       0    1
0  15769  937
1    215  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9108204, 'precision': 0.6850395, 'recall': 0.6596447, 'specificity': 0.6596447, 'f1': 0.6710681, 'auroc': 0.85061824, 'binary_precision': 0.42415318, 'binary_recall': 0.3613551, 'binary_specificity': 0.9579344, 'binary_f1_score': 0.39024392}
confusion matrix:
      0    1
0  8904  391
1   509  288
early stop counter: 4
val acc:0.9327260255813599, best validation acc: 0.9445223212242126, corresponding to test acc:                         0.9036861062049866 / 0.9110186100006104
after epoch: 7,now: 2024-08-10 23:20:28.039992,epoch time: 0:17:59.889086,used: 2:08:40.858812,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96460074, 'precision': 0.9657006, 'recall': 0.9646045, 'specificity': 0.9646045, 'f1': 0.96458006, 'auroc': 0.993511, 'binary_precision': 0.98837113, 'binary_recall': 0.94027543, 'binary_specificity': 0.9889336, 'binary_f1_score': 0.9637236}
confusion matrix:
       0      1
0  25558    286
1   1544  24308
---- Validation: 
scalar performance:
{'acc': 0.9442303, 'precision': 0.5969133, 'recall': 0.7066803, 'specificity': 0.7066803, 'f1': 0.62834835, 'auroc': 0.8457471, 'binary_precision': 0.2078346, 'binary_recall': 0.4569378, 'binary_specificity': 0.95642287, 'binary_f1_score': 0.2857143}
confusion matrix:
       0    1
0  15978  728
1    227  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9155767, 'precision': 0.69800377, 'recall': 0.6467407, 'specificity': 0.6467407, 'f1': 0.6673088, 'auroc': 0.8566706, 'binary_precision': 0.45233968, 'binary_recall': 0.32747805, 'binary_specificity': 0.96600324, 'binary_f1_score': 0.37991267}
confusion matrix:
      0    1
0  8979  316
1   536  261
new oracle model saved
early stop counter: 5
val acc:0.944230318069458, best validation acc: 0.9445223212242126, corresponding to test acc:                         0.9036861062049866 / 0.915576696395874
after epoch: 8,now: 2024-08-10 23:38:35.838664,epoch time: 0:18:07.798672,used: 2:26:48.657484,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96800524, 'precision': 0.96885765, 'recall': 0.9680086, 'specificity': 0.9680086, 'f1': 0.9679909, 'auroc': 0.9946735, 'binary_precision': 0.98888797, 'binary_recall': 0.9466579, 'binary_specificity': 0.98935926, 'binary_f1_score': 0.9673122}
confusion matrix:
       0      1
0  25569    275
1   1379  24473
---- Validation: 
scalar performance:
{'acc': 0.9523476, 'precision': 0.61221075, 'recall': 0.7003443, 'specificity': 0.7003443, 'f1': 0.6418991, 'auroc': 0.84564656, 'binary_precision': 0.23884514, 'binary_recall': 0.43540668, 'binary_specificity': 0.96528196, 'binary_f1_score': 0.3084746}
confusion matrix:
       0    1
0  16126  580
1    236  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91854936, 'precision': 0.7037169, 'recall': 0.60992587, 'specificity': 0.60992587, 'f1': 0.6386694, 'auroc': 0.851145, 'binary_precision': 0.46973366, 'binary_recall': 0.2434128, 'binary_specificity': 0.97643894, 'binary_f1_score': 0.32066116}
confusion matrix:
      0    1
0  9076  219
1   603  194
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-10 23:56:54.193020,epoch time: 0:18:18.354356,used: 2:45:07.011840,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.970017, 'precision': 0.9703529, 'recall': 0.97002065, 'specificity': 0.97002065, 'f1': 0.97001183, 'auroc': 0.99450123, 'binary_precision': 0.98298955, 'binary_recall': 0.9566041, 'binary_specificity': 0.9834372, 'binary_f1_score': 0.96961737}
confusion matrix:
       0      1
0  25413    428
1   1122  24733
---- Validation: 
scalar performance:
{'acc': 0.928463, 'precision': 0.58789444, 'recall': 0.7569115, 'specificity': 0.7569115, 'f1': 0.62236094, 'auroc': 0.86071646, 'binary_precision': 0.18696664, 'binary_recall': 0.576555, 'binary_specificity': 0.937268, 'binary_f1_score': 0.28236672}
confusion matrix:
       0     1
0  15658  1048
1    177   241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9117122, 'precision': 0.70002615, 'recall': 0.71347, 'specificity': 0.71347, 'f1': 0.7064493, 'auroc': 0.8663398, 'binary_precision': 0.44509345, 'binary_recall': 0.47804266, 'binary_specificity': 0.94889724, 'binary_f1_score': 0.46098006}
confusion matrix:
      0    1
0  8820  475
1   416  381
early stop counter: 1
val acc:0.9284629821777344, best validation acc: 0.9523475766181946, corresponding to test acc:                         0.9185493588447571 / 0.9185493588447571
after epoch: 10,now: 2024-08-11 00:14:41.891034,epoch time: 0:17:47.698014,used: 3:02:54.709854,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9716806, 'precision': 0.97208935, 'recall': 0.9716823, 'specificity': 0.9716823, 'f1': 0.97167456, 'auroc': 0.9951234, 'binary_precision': 0.9860098, 'binary_recall': 0.9569456, 'binary_specificity': 0.986419, 'binary_f1_score': 0.9712603}
confusion matrix:
       0      1
0  25494    351
1   1113  24738
---- Validation: 
scalar performance:
{'acc': 0.9212217, 'precision': 0.5825145, 'recall': 0.766029, 'specificity': 0.766029, 'f1': 0.61517453, 'auroc': 0.8656572, 'binary_precision': 0.17560975, 'binary_recall': 0.6028708, 'binary_specificity': 0.9291871, 'binary_f1_score': 0.27199134}
confusion matrix:
       0     1
0  15523  1183
1    166   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9105232, 'precision': 0.69914156, 'recall': 0.7237221, 'specificity': 0.7237221, 'f1': 0.7104491, 'auroc': 0.8630088, 'binary_precision': 0.4415011, 'binary_recall': 0.5018821, 'binary_specificity': 0.9455621, 'binary_f1_score': 0.46975923}
confusion matrix:
      0    1
0  8789  506
1   397  400
early stop counter: 2
val acc:0.9212216734886169, best validation acc: 0.9523475766181946, corresponding to test acc:                         0.9185493588447571 / 0.9185493588447571
after epoch: 11,now: 2024-08-11 00:32:22.120653,epoch time: 0:17:40.229619,used: 3:20:34.939473,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97489166, 'precision': 0.97522753, 'recall': 0.97489476, 'specificity': 0.97489476, 'f1': 0.9748873, 'auroc': 0.9961474, 'binary_precision': 0.9879193, 'binary_recall': 0.96155334, 'binary_specificity': 0.9882362, 'binary_f1_score': 0.97455794}
confusion matrix:
       0      1
0  25538    304
1    994  24860
---- Validation: 
scalar performance:
{'acc': 0.9302733, 'precision': 0.5893775, 'recall': 0.75434065, 'specificity': 0.75434065, 'f1': 0.62418973, 'auroc': 0.86512756, 'binary_precision': 0.19009584, 'binary_recall': 0.569378, 'binary_specificity': 0.9393032, 'binary_f1_score': 0.28502995}
confusion matrix:
       0     1
0  15692  1014
1    180   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9130004, 'precision': 0.7017575, 'recall': 0.7049923, 'specificity': 0.7049923, 'f1': 0.7033574, 'auroc': 0.8641221, 'binary_precision': 0.45006165, 'binary_recall': 0.45796737, 'binary_specificity': 0.9520172, 'binary_f1_score': 0.4539801}
confusion matrix:
      0    1
0  8849  446
1   432  365
early stop counter: 3
val acc:0.9302732944488525, best validation acc: 0.9523475766181946, corresponding to test acc:                         0.9185493588447571 / 0.9185493588447571
after epoch: 12,now: 2024-08-11 00:50:10.854433,epoch time: 0:17:48.733780,used: 3:38:23.673253,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97452414, 'precision': 0.9749419, 'recall': 0.974527, 'specificity': 0.974527, 'f1': 0.97451866, 'auroc': 0.9954292, 'binary_precision': 0.9890767, 'binary_recall': 0.95965654, 'binary_specificity': 0.9893975, 'binary_f1_score': 0.9741445}
confusion matrix:
       0      1
0  25569    274
1   1043  24810
---- Validation: 
scalar performance:
{'acc': 0.93354356, 'precision': 0.5912724, 'recall': 0.7455205, 'specificity': 0.7455205, 'f1': 0.6260575, 'auroc': 0.85988283, 'binary_precision': 0.19439729, 'binary_recall': 0.5478469, 'binary_specificity': 0.9431941, 'binary_f1_score': 0.28696743}
confusion matrix:
       0    1
0  15757  949
1    189  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9148831, 'precision': 0.7056018, 'recall': 0.69683737, 'specificity': 0.69683737, 'f1': 0.70109105, 'auroc': 0.8636606, 'binary_precision': 0.45921052, 'binary_recall': 0.4378921, 'binary_specificity': 0.95578265, 'binary_f1_score': 0.448298}
confusion matrix:
      0    1
0  8884  411
1   448  349
early stop counter: 4
val acc:0.9335435628890991, best validation acc: 0.9523475766181946, corresponding to test acc:                         0.9185493588447571 / 0.9185493588447571
after epoch: 13,now: 2024-08-11 01:07:57.116241,epoch time: 0:17:46.261808,used: 3:56:09.935061,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9751818, 'precision': 0.9754868, 'recall': 0.9751843, 'specificity': 0.9751843, 'f1': 0.975178, 'auroc': 0.9963354, 'binary_precision': 0.9875774, 'binary_recall': 0.9624802, 'binary_specificity': 0.9878884, 'binary_f1_score': 0.97486734}
confusion matrix:
       0      1
0  25530    313
1    970  24883
---- Validation: 
scalar performance:
{'acc': 0.93663865, 'precision': 0.6004598, 'recall': 0.7657666, 'specificity': 0.7657666, 'f1': 0.63895166, 'auroc': 0.8688693, 'binary_precision': 0.21175453, 'binary_recall': 0.5861244, 'binary_specificity': 0.9454088, 'binary_f1_score': 0.3111111}
confusion matrix:
       0    1
0  15794  912
1    173  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123068, 'precision': 0.7051129, 'recall': 0.7327202, 'specificity': 0.7327202, 'f1': 0.7177248, 'auroc': 0.87318885, 'binary_precision': 0.45196506, 'binary_recall': 0.5194479, 'binary_specificity': 0.94599247, 'binary_f1_score': 0.4833625}
confusion matrix:
      0    1
0  8793  502
1   383  414
early stop counter: 5
val acc:0.9366386532783508, best validation acc: 0.9523475766181946, corresponding to test acc:                         0.9185493588447571 / 0.9185493588447571
after epoch: 14,now: 2024-08-11 01:25:44.111732,epoch time: 0:17:46.995491,used: 4:13:56.930552,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9760523, 'precision': 0.97630733, 'recall': 0.9760541, 'specificity': 0.9760541, 'f1': 0.9760492, 'auroc': 0.9965233, 'binary_precision': 0.98736733, 'binary_recall': 0.9644515, 'binary_specificity': 0.9876567, 'binary_f1_score': 0.9757749}
confusion matrix:
       0      1
0  25525    319
1    919  24933
---- Validation: 
scalar performance:
{'acc': 0.92577666, 'precision': 0.58732474, 'recall': 0.76719725, 'specificity': 0.76719725, 'f1': 0.6219991, 'auroc': 0.86471295, 'binary_precision': 0.18523985, 'binary_recall': 0.6004785, 'binary_specificity': 0.933916, 'binary_f1_score': 0.28313592}
confusion matrix:
       0     1
0  15602  1104
1    167   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9144867, 'precision': 0.7058333, 'recall': 0.7046521, 'specificity': 0.7046521, 'f1': 0.7052404, 'auroc': 0.86306775, 'binary_precision': 0.45833334, 'binary_recall': 0.45545796, 'binary_specificity': 0.95384616, 'binary_f1_score': 0.45689115}
confusion matrix:
      0    1
0  8866  429
1   434  363
early stop counter: 6
val acc:0.9257766604423523, best validation acc: 0.9523475766181946, corresponding to test acc:                         0.9185493588447571 / 0.9185493588447571
after epoch: 15,now: 2024-08-11 01:43:51.185842,epoch time: 0:18:07.074110,used: 4:32:04.004662,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_21_11_46_seed_2_24141966
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:32:04.004662 at 2024-08-11 01:43:51.185842
persisted model performance metric: 

scalar performance:
{'acc': 0.91854936, 'precision': 0.7037169, 'recall': 0.60992587, 'specificity': 0.60992587, 'f1': 0.6386694, 'auroc': 0.851145, 'binary_precision': 0.46973366, 'binary_recall': 0.2434128, 'binary_specificity': 0.97643894, 'binary_f1_score': 0.32066116}
confusion matrix:
      0    1
0  9076  219
1   603  194
oracle model performance metric: 

scalar performance:
{'acc': 0.91854936, 'precision': 0.7037169, 'recall': 0.60992587, 'specificity': 0.60992587, 'f1': 0.6386694, 'auroc': 0.851145, 'binary_precision': 0.46973366, 'binary_recall': 0.2434128, 'binary_specificity': 0.97643894, 'binary_f1_score': 0.32066116}
confusion matrix:
      0    1
0  9076  219
1   603  194
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1136 MiB |   8773 MiB |   1054 TiB |   1054 TiB |
|       from large pool |   1097 MiB |   8728 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     39 MiB |     80 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1136 MiB |   8773 MiB |   1054 TiB |   1054 TiB |
|       from large pool |   1097 MiB |   8728 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     39 MiB |     80 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1128 MiB |   8765 MiB |   1053 TiB |   1053 TiB |
|       from large pool |   1090 MiB |   8720 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     37 MiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9398 MiB |   9436 MiB |  25638 MiB |  16240 MiB |
|       from large pool |   9318 MiB |   9350 MiB |  25514 MiB |  16196 MiB |
|       from small pool |     80 MiB |     86 MiB |    124 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 261489 KiB |   1166 MiB | 668163 GiB | 668163 GiB |
|       from large pool | 238456 KiB |   1163 MiB | 651133 GiB | 651132 GiB |
|       from small pool |  23033 KiB |     38 MiB |  17030 GiB |  17030 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7451    |  210317 K  |  210312 K  |
|       from large pool |     161    |     844    |  100109 K  |  100109 K  |
|       from small pool |    4745    |    7288    |  110208 K  |  110203 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7451    |  210317 K  |  210312 K  |
|       from large pool |     161    |     844    |  100109 K  |  100109 K  |
|       from small pool |    4745    |    7288    |  110208 K  |  110203 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     323    |     334    |     872    |     549    |
|       from large pool |     283    |     291    |     810    |     527    |
|       from small pool |      40    |      43    |      62    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3263    |  111518 K  |  111518 K  |
|       from large pool |      18    |     292    |   63562 K  |   63562 K  |
|       from small pool |      56    |    3246    |   47955 K  |   47955 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8773 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8728 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     80 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8773 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8728 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     80 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8765 MiB |   1053 TiB |   1053 TiB |
|       from large pool |  16640 KiB |   8720 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1392 MiB |   9436 MiB |  25638 MiB |  24246 MiB |
|       from large pool |   1330 MiB |   9350 MiB |  25514 MiB |  24184 MiB |
|       from small pool |     62 MiB |     86 MiB |    124 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1166 MiB | 668163 GiB | 668163 GiB |
|       from large pool |  30464 KiB |   1163 MiB | 651133 GiB | 651133 GiB |
|       from small pool |      0 KiB |     38 MiB |  17030 GiB |  17030 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7451    |  210317 K  |  210317 K  |
|       from large pool |       2    |     844    |  100109 K  |  100109 K  |
|       from small pool |       0    |    7288    |  110208 K  |  110208 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7451    |  210317 K  |  210317 K  |
|       from large pool |       2    |     844    |  100109 K  |  100109 K  |
|       from small pool |       0    |    7288    |  110208 K  |  110208 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     334    |     872    |     814    |
|       from large pool |      27    |     291    |     810    |     783    |
|       from small pool |      31    |      43    |      62    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3263    |  111520 K  |  111520 K  |
|       from large pool |       2    |     292    |   63562 K  |   63562 K  |
|       from small pool |       0    |    3246    |   47957 K  |   47957 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 01:46:06 2024]
Finished job 0.
1 of 1 steps (100%) done
