Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 20:31:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969

 Experiment start at: 2024-08-10 20:41:39.037146
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8852086067199707
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8880883, 'precision': 0.8888884, 'recall': 0.88810354, 'specificity': 0.88810354, 'f1': 0.88803345, 'auroc': 0.9574894, 'binary_precision': 0.906697, 'binary_recall': 0.8653778, 'binary_specificity': 0.9108293, 'binary_f1_score': 0.8855557}
confusion matrix:
       0      1
0  23054   2257
1   3412  21933
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94552666, 'precision': 0.5068384, 'recall': 0.5091635, 'specificity': 0.5091635, 'f1': 0.5074991, 'auroc': 0.7037273, 'binary_precision': 0.037433155, 'binary_recall': 0.05060241, 'binary_specificity': 0.96772456, 'binary_f1_score': 0.043032788}
confusion matrix:
       0    1
0  16191  540
1    394   21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8899545, 'precision': 0.57231444, 'recall': 0.5566116, 'specificity': 0.5566116, 'f1': 0.56280553, 'auroc': 0.78514946, 'binary_precision': 0.21247892, 'binary_recall': 0.16321243, 'binary_specificity': 0.9500107, 'binary_f1_score': 0.18461537}
confusion matrix:
      0    1
0  8875  467
1   646  126
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 21:00:09.867857,epoch time: 0:18:30.830711,used: 0:18:30.830711,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9300971, 'precision': 0.9325743, 'recall': 0.9301196, 'specificity': 0.9301196, 'f1': 0.92999935, 'auroc': 0.97839177, 'binary_precision': 0.9654569, 'binary_recall': 0.89219904, 'binary_specificity': 0.9680401, 'binary_f1_score': 0.9273835}
confusion matrix:
       0      1
0  24504    809
1   2732  22611
---- Validation: 
scalar performance:
{'acc': 0.96255684, 'precision': 0.5708938, 'recall': 0.5578376, 'specificity': 0.5578376, 'f1': 0.56356764, 'auroc': 0.7758341, 'binary_precision': 0.16320474, 'binary_recall': 0.13253012, 'binary_specificity': 0.98314506, 'binary_f1_score': 0.14627658}
confusion matrix:
       0    1
0  16449  282
1    360   55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9166502, 'precision': 0.6747536, 'recall': 0.5948283, 'specificity': 0.5948283, 'f1': 0.6191541, 'auroc': 0.8521183, 'binary_precision': 0.41191068, 'binary_recall': 0.2150259, 'binary_specificity': 0.9746307, 'binary_f1_score': 0.2825532}
confusion matrix:
      0    1
0  9105  237
1   606  166
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 21:18:08.063709,epoch time: 0:17:58.195852,used: 0:36:29.026563,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94286954, 'precision': 0.9453784, 'recall': 0.9428933, 'specificity': 0.9428933, 'f1': 0.9427911, 'auroc': 0.9847381, 'binary_precision': 0.978964, 'binary_recall': 0.9052636, 'binary_specificity': 0.98052305, 'binary_f1_score': 0.94067246}
confusion matrix:
       0      1
0  24819    493
1   2401  22943
---- Validation: 
scalar performance:
{'acc': 0.9615654, 'precision': 0.609986, 'recall': 0.6231259, 'specificity': 0.6231259, 'f1': 0.6161312, 'auroc': 0.80740094, 'binary_precision': 0.23819743, 'binary_recall': 0.26746988, 'binary_specificity': 0.9787819, 'binary_f1_score': 0.25198638}
confusion matrix:
       0    1
0  16376  355
1    304  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91813326, 'precision': 0.70348, 'recall': 0.67405844, 'specificity': 0.67405844, 'f1': 0.68725306, 'auroc': 0.8770225, 'binary_precision': 0.4570552, 'binary_recall': 0.38601035, 'binary_specificity': 0.9621066, 'binary_f1_score': 0.41853932}
confusion matrix:
      0    1
0  8988  354
1   474  298
new oracle model saved
early stop counter: 1
val acc:0.961565375328064, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.9181332588195801
after epoch: 3,now: 2024-08-10 21:37:15.330276,epoch time: 0:19:07.266567,used: 0:55:36.293130,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9532138, 'precision': 0.95455956, 'recall': 0.9532279, 'specificity': 0.9532279, 'f1': 0.9531802, 'auroc': 0.9881312, 'binary_precision': 0.97942144, 'binary_recall': 0.9259303, 'binary_specificity': 0.9805254, 'binary_f1_score': 0.95192504}
confusion matrix:
       0      1
0  24822    493
1   1877  23464
---- Validation: 
scalar performance:
{'acc': 0.96203196, 'precision': 0.62299657, 'recall': 0.64686364, 'specificity': 0.64686364, 'f1': 0.63373137, 'auroc': 0.8211578, 'binary_precision': 0.2630522, 'binary_recall': 0.31566265, 'binary_specificity': 0.97806466, 'binary_f1_score': 0.28696603}
confusion matrix:
       0    1
0  16364  367
1    284  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9188254, 'precision': 0.7062964, 'recall': 0.6762156, 'specificity': 0.6762156, 'f1': 0.68969566, 'auroc': 0.88446224, 'binary_precision': 0.4623656, 'binary_recall': 0.38989636, 'binary_specificity': 0.9625348, 'binary_f1_score': 0.4230499}
confusion matrix:
      0    1
0  8992  350
1   471  301
new oracle model saved
early stop counter: 2
val acc:0.9620319604873657, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.9188253879547119
after epoch: 4,now: 2024-08-10 21:56:53.082002,epoch time: 0:19:37.751726,used: 1:15:14.044856,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9548918, 'precision': 0.95605975, 'recall': 0.9549079, 'specificity': 0.9549079, 'f1': 0.95486397, 'auroc': 0.9898333, 'binary_precision': 0.97929746, 'binary_recall': 0.9294902, 'binary_specificity': 0.9803255, 'binary_f1_score': 0.95374393}
confusion matrix:
       0      1
0  24814    498
1   1787  23557
---- Validation: 
scalar performance:
{'acc': 0.96121544, 'precision': 0.6233245, 'recall': 0.65584475, 'specificity': 0.65584475, 'f1': 0.6374316, 'auroc': 0.83026457, 'binary_precision': 0.26325756, 'binary_recall': 0.33493975, 'binary_specificity': 0.9767497, 'binary_f1_score': 0.2948038}
confusion matrix:
       0    1
0  16342  389
1    276  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92040735, 'precision': 0.7138033, 'recall': 0.6883607, 'specificity': 0.6883607, 'f1': 0.7000243, 'auroc': 0.8915578, 'binary_precision': 0.4754829, 'binary_recall': 0.41450778, 'binary_specificity': 0.96221364, 'binary_f1_score': 0.4429066}
confusion matrix:
      0    1
0  8989  353
1   452  320
new oracle model saved
early stop counter: 3
val acc:0.9612154364585876, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.9204073548316956
after epoch: 5,now: 2024-08-10 22:14:13.022185,epoch time: 0:17:19.940183,used: 1:32:33.985039,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9602219, 'precision': 0.96125317, 'recall': 0.9602369, 'specificity': 0.9602369, 'f1': 0.96020055, 'auroc': 0.9915024, 'binary_precision': 0.9832222, 'binary_recall': 0.93647414, 'binary_specificity': 0.98399967, 'binary_f1_score': 0.959279}
confusion matrix:
       0      1
0  24907    405
1   1610  23734
---- Validation: 
scalar performance:
{'acc': 0.95964074, 'precision': 0.625458, 'recall': 0.6773616, 'specificity': 0.6773616, 'f1': 0.6463506, 'auroc': 0.83559, 'binary_precision': 0.26644182, 'binary_recall': 0.38072288, 'binary_specificity': 0.97400033, 'binary_f1_score': 0.31349206}
confusion matrix:
       0    1
0  16296  435
1    257  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9216927, 'precision': 0.72180045, 'recall': 0.71757555, 'specificity': 0.71757555, 'f1': 0.71966124, 'auroc': 0.897758, 'binary_precision': 0.48677248, 'binary_recall': 0.47668394, 'binary_specificity': 0.9584671, 'binary_f1_score': 0.4816754}
confusion matrix:
      0    1
0  8954  388
1   404  368
new oracle model saved
early stop counter: 4
val acc:0.9596407413482666, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.9216927289962769
after epoch: 6,now: 2024-08-10 22:31:59.127131,epoch time: 0:17:46.104946,used: 1:50:20.089985,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96381474, 'precision': 0.9645287, 'recall': 0.96382487, 'specificity': 0.96382487, 'f1': 0.96380144, 'auroc': 0.99310434, 'binary_precision': 0.9828691, 'binary_recall': 0.9441222, 'binary_specificity': 0.98352754, 'binary_f1_score': 0.96310616}
confusion matrix:
       0      1
0  24898    417
1   1416  23925
---- Validation: 
scalar performance:
{'acc': 0.9593491, 'precision': 0.6226261, 'recall': 0.6725125, 'specificity': 0.6725125, 'f1': 0.64276433, 'auroc': 0.83960897, 'binary_precision': 0.26101694, 'binary_recall': 0.37108433, 'binary_specificity': 0.9739406, 'binary_f1_score': 0.30646765}
confusion matrix:
       0    1
0  16295  436
1    261  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9220882, 'precision': 0.7203382, 'recall': 0.6922413, 'specificity': 0.6922413, 'f1': 0.70503974, 'auroc': 0.8940162, 'binary_precision': 0.487988, 'binary_recall': 0.42098445, 'binary_specificity': 0.9634982, 'binary_f1_score': 0.45201668}
confusion matrix:
      0    1
0  9001  341
1   447  325
new oracle model saved
early stop counter: 5
val acc:0.9593490958213806, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.9220882058143616
after epoch: 7,now: 2024-08-10 22:49:34.619161,epoch time: 0:17:35.492030,used: 2:07:55.582015,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9658481, 'precision': 0.96655506, 'recall': 0.9658581, 'specificity': 0.9658581, 'f1': 0.96583563, 'auroc': 0.9940303, 'binary_precision': 0.9848454, 'binary_recall': 0.9462926, 'binary_specificity': 0.9854237, 'binary_f1_score': 0.9651841}
confusion matrix:
       0      1
0  24946    369
1   1361  23980
---- Validation: 
scalar performance:
{'acc': 0.956433, 'precision': 0.61454827, 'recall': 0.6768929, 'specificity': 0.6768929, 'f1': 0.63805497, 'auroc': 0.8402095, 'binary_precision': 0.24461539, 'binary_recall': 0.38313252, 'binary_specificity': 0.9706533, 'binary_f1_score': 0.29859155}
confusion matrix:
       0    1
0  16240  491
1    256  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92268145, 'precision': 0.7236325, 'recall': 0.7032571, 'specificity': 0.7032571, 'f1': 0.712809, 'auroc': 0.8937377, 'binary_precision': 0.4928161, 'binary_recall': 0.44430053, 'binary_specificity': 0.96221364, 'binary_f1_score': 0.46730247}
confusion matrix:
      0    1
0  8989  353
1   429  343
new oracle model saved
early stop counter: 6
val acc:0.9564329981803894, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.922681450843811
after epoch: 8,now: 2024-08-10 23:07:13.667116,epoch time: 0:17:39.047955,used: 2:25:34.629970,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9682565, 'precision': 0.96882606, 'recall': 0.9682641, 'specificity': 0.9682641, 'f1': 0.9682472, 'auroc': 0.9941733, 'binary_precision': 0.9852767, 'binary_recall': 0.95074785, 'binary_specificity': 0.9857803, 'binary_f1_score': 0.96770436}
confusion matrix:
       0      1
0  24957    360
1   1248  24091
---- Validation: 
scalar performance:
{'acc': 0.9548583, 'precision': 0.61454993, 'recall': 0.69018525, 'specificity': 0.69018525, 'f1': 0.6415608, 'auroc': 0.84526896, 'binary_precision': 0.24393724, 'binary_recall': 0.4120482, 'binary_specificity': 0.9683223, 'binary_f1_score': 0.30645162}
confusion matrix:
       0    1
0  16201  530
1    244  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9195175, 'precision': 0.71528333, 'recall': 0.7193688, 'specificity': 0.7193688, 'f1': 0.71730053, 'auroc': 0.8987485, 'binary_precision': 0.47335026, 'binary_recall': 0.48316061, 'binary_specificity': 0.95557696, 'binary_f1_score': 0.4782051}
confusion matrix:
      0    1
0  8927  415
1   399  373
early stop counter: 7
val acc:0.9548583030700684, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.922681450843811
after epoch: 9,now: 2024-08-10 23:24:49.835256,epoch time: 0:17:36.168140,used: 2:43:10.798110,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9707833, 'precision': 0.9711936, 'recall': 0.9707916, 'specificity': 0.9707916, 'f1': 0.9707773, 'auroc': 0.9945483, 'binary_precision': 0.9852367, 'binary_recall': 0.95592296, 'binary_specificity': 0.98566014, 'binary_f1_score': 0.97035843}
confusion matrix:
       0      1
0  24951    363
1   1117  24225
---- Validation: 
scalar performance:
{'acc': 0.9450601, 'precision': 0.6005709, 'recall': 0.71688783, 'specificity': 0.71688783, 'f1': 0.6336894, 'auroc': 0.84241605, 'binary_precision': 0.21451788, 'binary_recall': 0.47710842, 'binary_specificity': 0.95666724, 'binary_f1_score': 0.29596412}
confusion matrix:
       0    1
0  16006  725
1    217  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91566145, 'precision': 0.710222, 'recall': 0.7535244, 'specificity': 0.7535244, 'f1': 0.7291336, 'auroc': 0.8965651, 'binary_precision': 0.4573235, 'binary_recall': 0.56217617, 'binary_specificity': 0.9448726, 'binary_f1_score': 0.50435793}
confusion matrix:
      0    1
0  8827  515
1   338  434
early stop counter: 8
val acc:0.9450600743293762, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.922681450843811
after epoch: 10,now: 2024-08-10 23:42:28.703860,epoch time: 0:17:38.868604,used: 3:00:49.666714,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9722244, 'precision': 0.9725317, 'recall': 0.97223204, 'specificity': 0.97223204, 'f1': 0.97222024, 'auroc': 0.99544215, 'binary_precision': 0.98473066, 'binary_recall': 0.9593576, 'binary_specificity': 0.98510647, 'binary_f1_score': 0.9718786}
confusion matrix:
       0      1
0  24936    377
1   1030  24313
---- Validation: 
scalar performance:
{'acc': 0.94867605, 'precision': 0.6116843, 'recall': 0.7304901, 'specificity': 0.7304901, 'f1': 0.6471589, 'auroc': 0.85492975, 'binary_precision': 0.23609534, 'binary_recall': 0.50120485, 'binary_specificity': 0.95977527, 'binary_f1_score': 0.32098767}
confusion matrix:
       0    1
0  16058  673
1    207  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91536486, 'precision': 0.71168065, 'recall': 0.76702917, 'specificity': 0.76702917, 'f1': 0.7350043, 'auroc': 0.9035661, 'binary_precision': 0.45791584, 'binary_recall': 0.5919689, 'binary_specificity': 0.9420895, 'binary_f1_score': 0.5163842}
confusion matrix:
      0    1
0  8801  541
1   315  457
early stop counter: 9
val acc:0.9486760497093201, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.922681450843811
after epoch: 11,now: 2024-08-11 00:00:11.791906,epoch time: 0:17:43.088046,used: 3:18:32.754760,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97234285, 'precision': 0.97266865, 'recall': 0.9723518, 'specificity': 0.9723518, 'f1': 0.97233844, 'auroc': 0.99535394, 'binary_precision': 0.9852464, 'binary_recall': 0.95908463, 'binary_specificity': 0.9856189, 'binary_f1_score': 0.9719896}
confusion matrix:
       0      1
0  24947    364
1   1037  24308
---- Validation: 
scalar performance:
{'acc': 0.95124227, 'precision': 0.6084308, 'recall': 0.7000817, 'specificity': 0.7000817, 'f1': 0.63845444, 'auroc': 0.8527391, 'binary_precision': 0.23116219, 'binary_recall': 0.4361446, 'binary_specificity': 0.9640189, 'binary_f1_score': 0.30217028}
confusion matrix:
       0    1
0  16129  602
1    234  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91783667, 'precision': 0.71237165, 'recall': 0.73212427, 'specificity': 0.73212427, 'f1': 0.7216599, 'auroc': 0.90016955, 'binary_precision': 0.4653349, 'binary_recall': 0.51295334, 'binary_specificity': 0.9512952, 'binary_f1_score': 0.4879852}
confusion matrix:
      0    1
0  8887  455
1   376  396
early stop counter: 10
val acc:0.9512422680854797, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.922681450843811
after epoch: 12,now: 2024-08-11 00:17:25.063361,epoch time: 0:17:13.271455,used: 3:35:46.026215,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9749289, 'precision': 0.97521126, 'recall': 0.9749377, 'specificity': 0.9749377, 'f1': 0.9749255, 'auroc': 0.9959991, 'binary_precision': 0.9869741, 'binary_recall': 0.96259767, 'binary_specificity': 0.98727775, 'binary_f1_score': 0.97463346}
confusion matrix:
       0      1
0  24988    322
1    948  24398
---- Validation: 
scalar performance:
{'acc': 0.9405109, 'precision': 0.5970303, 'recall': 0.73218083, 'specificity': 0.73218083, 'f1': 0.63177586, 'auroc': 0.85768884, 'binary_precision': 0.20659554, 'binary_recall': 0.51325303, 'binary_specificity': 0.9511087, 'binary_f1_score': 0.2946058}
confusion matrix:
       0    1
0  15913  818
1    202  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9149693, 'precision': 0.71075904, 'recall': 0.76681507, 'specificity': 0.76681507, 'f1': 0.7343087, 'auroc': 0.89764404, 'binary_precision': 0.45608783, 'binary_recall': 0.5919689, 'binary_specificity': 0.9416613, 'binary_f1_score': 0.51521987}
confusion matrix:
      0    1
0  8797  545
1   315  457
early stop counter: 11
val acc:0.9405109286308289, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.922681450843811
after epoch: 13,now: 2024-08-11 00:34:27.449533,epoch time: 0:17:02.386172,used: 3:52:48.412387,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9739814, 'precision': 0.97416866, 'recall': 0.9739869, 'specificity': 0.9739869, 'f1': 0.973979, 'auroc': 0.9959209, 'binary_precision': 0.9837307, 'binary_recall': 0.9639334, 'binary_specificity': 0.98404044, 'binary_f1_score': 0.97373146}
confusion matrix:
       0      1
0  24910    404
1    914  24428
---- Validation: 
scalar performance:
{'acc': 0.9317625, 'precision': 0.58593774, 'recall': 0.7359227, 'specificity': 0.7359227, 'f1': 0.61874616, 'auroc': 0.8572835, 'binary_precision': 0.18410042, 'binary_recall': 0.5301205, 'binary_specificity': 0.94172496, 'binary_f1_score': 0.27329195}
confusion matrix:
       0    1
0  15756  975
1    195  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91318965, 'precision': 0.7069044, 'recall': 0.76704, 'specificity': 0.76704, 'f1': 0.7317506, 'auroc': 0.89545953, 'binary_precision': 0.4482422, 'binary_recall': 0.5945596, 'binary_specificity': 0.9395204, 'binary_f1_score': 0.5111358}
confusion matrix:
      0    1
0  8777  565
1   313  459
early stop counter: 12
val acc:0.9317625164985657, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.922681450843811
after epoch: 14,now: 2024-08-11 00:51:41.059570,epoch time: 0:17:13.610037,used: 4:10:02.022424,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9760344, 'precision': 0.9761678, 'recall': 0.9760401, 'specificity': 0.9760401, 'f1': 0.976033, 'auroc': 0.9965894, 'binary_precision': 0.9843054, 'binary_recall': 0.9675281, 'binary_specificity': 0.98455215, 'binary_f1_score': 0.9758446}
confusion matrix:
       0      1
0  24920    391
1    823  24522
---- Validation: 
scalar performance:
{'acc': 0.9405109, 'precision': 0.5982809, 'recall': 0.7368806, 'specificity': 0.7368806, 'f1': 0.63371265, 'auroc': 0.8626906, 'binary_precision': 0.20885468, 'binary_recall': 0.5228916, 'binary_specificity': 0.9508696, 'binary_f1_score': 0.29848695}
confusion matrix:
       0    1
0  15909  822
1    198  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91338736, 'precision': 0.7088429, 'recall': 0.77605927, 'specificity': 0.77605927, 'f1': 0.73606926, 'auroc': 0.90259707, 'binary_precision': 0.45057034, 'binary_recall': 0.61398965, 'binary_specificity': 0.9381289, 'binary_f1_score': 0.5197369}
confusion matrix:
      0    1
0  8764  578
1   298  474
early stop counter: 13
val acc:0.9405109286308289, best validation acc: 0.9625568389892578, corresponding to test acc:                         0.9166501760482788 / 0.922681450843811
after epoch: 15,now: 2024-08-11 01:08:51.384145,epoch time: 0:17:10.324575,used: 4:27:12.346999,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_41_38_seed_0_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:27:12.346999 at 2024-08-11 01:08:51.384145
persisted model performance metric: 

scalar performance:
{'acc': 0.9166502, 'precision': 0.6747536, 'recall': 0.5948283, 'specificity': 0.5948283, 'f1': 0.6191541, 'auroc': 0.8521183, 'binary_precision': 0.41191068, 'binary_recall': 0.2150259, 'binary_specificity': 0.9746307, 'binary_f1_score': 0.2825532}
confusion matrix:
      0    1
0  9105  237
1   606  166
oracle model performance metric: 

scalar performance:
{'acc': 0.92268145, 'precision': 0.7236325, 'recall': 0.7032571, 'specificity': 0.7032571, 'f1': 0.712809, 'auroc': 0.8937377, 'binary_precision': 0.4928161, 'binary_recall': 0.44430053, 'binary_specificity': 0.96221364, 'binary_f1_score': 0.46730247}
confusion matrix:
      0    1
0  8989  353
1   429  343
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    969 MiB |   8606 MiB | 351635 GiB | 351634 GiB |
|       from large pool |    930 MiB |   8561 MiB | 346049 GiB | 346048 GiB |
|       from small pool |     39 MiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    969 MiB |   8606 MiB | 351635 GiB | 351634 GiB |
|       from large pool |    930 MiB |   8561 MiB | 346049 GiB | 346048 GiB |
|       from small pool |     39 MiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    967 MiB |   8603 MiB | 351494 GiB | 351494 GiB |
|       from large pool |    929 MiB |   8559 MiB | 345921 GiB | 345920 GiB |
|       from small pool |     37 MiB |     79 MiB |   5573 GiB |   5573 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9286 MiB |   9286 MiB |   9286 MiB |      0 B   |
|       from large pool |   9200 MiB |   9200 MiB |   9200 MiB |      0 B   |
|       from small pool |     86 MiB |     86 MiB |     86 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  88393 KiB |   1149 MiB | 218735 GiB | 218735 GiB |
|       from large pool |  65366 KiB |   1147 MiB | 213147 GiB | 213147 GiB |
|       from small pool |  23027 KiB |     23 MiB |   5588 GiB |   5588 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4918    |    7321    |   68991 K  |   68987 K  |
|       from large pool |     161    |     844    |   32632 K  |   32632 K  |
|       from small pool |    4757    |    7158    |   36359 K  |   36354 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4918    |    7321    |   68991 K  |   68987 K  |
|       from large pool |     161    |     844    |   32632 K  |   32632 K  |
|       from small pool |    4757    |    7158    |   36359 K  |   36354 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     337    |     337    |     337    |       0    |
|       from large pool |     294    |     294    |     294    |       0    |
|       from small pool |      43    |      43    |      43    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      79    |    3203    |   36717 K  |   36717 K  |
|       from large pool |      23    |     299    |   21405 K  |   21405 K  |
|       from small pool |      56    |    3181    |   15311 K  |   15311 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8606 MiB | 351635 GiB | 351635 GiB |
|       from large pool |  16640 KiB |   8561 MiB | 346049 GiB | 346049 GiB |
|       from small pool |      0 KiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8606 MiB | 351635 GiB | 351635 GiB |
|       from large pool |  16640 KiB |   8561 MiB | 346049 GiB | 346049 GiB |
|       from small pool |      0 KiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB | 351494 GiB | 351494 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 345921 GiB | 345921 GiB |
|       from small pool |      0 KiB |     79 MiB |   5573 GiB |   5573 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1056 MiB |   9286 MiB |   9286 MiB |   8230 MiB |
|       from large pool |    994 MiB |   9200 MiB |   9200 MiB |   8206 MiB |
|       from small pool |     62 MiB |     86 MiB |     86 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1149 MiB | 218735 GiB | 218735 GiB |
|       from large pool |  30464 KiB |   1147 MiB | 213147 GiB | 213147 GiB |
|       from small pool |      0 KiB |     36 MiB |   5588 GiB |   5588 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68991 K  |   68991 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36359 K  |   36359 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68991 K  |   68991 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36359 K  |   36359 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     337    |     337    |     279    |
|       from large pool |      27    |     294    |     294    |     267    |
|       from small pool |      31    |      43    |      43    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3203    |   36719 K  |   36719 K  |
|       from large pool |       2    |     299    |   21405 K  |   21405 K  |
|       from small pool |       0    |    3181    |   15313 K  |   15313 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8606 MiB | 351635 GiB | 351635 GiB |
|       from large pool |  16640 KiB |   8561 MiB | 346049 GiB | 346049 GiB |
|       from small pool |      0 KiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8606 MiB | 351635 GiB | 351635 GiB |
|       from large pool |  16640 KiB |   8561 MiB | 346049 GiB | 346049 GiB |
|       from small pool |      0 KiB |     80 MiB |   5585 GiB |   5585 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB | 351494 GiB | 351494 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 345921 GiB | 345921 GiB |
|       from small pool |      0 KiB |     79 MiB |   5573 GiB |   5573 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1056 MiB |   9286 MiB |   9286 MiB |   8230 MiB |
|       from large pool |    994 MiB |   9200 MiB |   9200 MiB |   8206 MiB |
|       from small pool |     62 MiB |     86 MiB |     86 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1149 MiB | 218735 GiB | 218735 GiB |
|       from large pool |  30464 KiB |   1147 MiB | 213147 GiB | 213147 GiB |
|       from small pool |      0 KiB |     36 MiB |   5588 GiB |   5588 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68991 K  |   68991 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36359 K  |   36359 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68991 K  |   68991 K  |
|       from large pool |       2    |     844    |   32632 K  |   32632 K  |
|       from small pool |       0    |    7158    |   36359 K  |   36359 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     337    |     337    |     279    |
|       from large pool |      27    |     294    |     294    |     267    |
|       from small pool |      31    |      43    |      43    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3203    |   36719 K  |   36719 K  |
|       from large pool |       2    |     299    |   21405 K  |   21405 K  |
|       from small pool |       0    |    3181    |   15313 K  |   15313 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969

 Experiment start at: 2024-08-11 01:19:48.112515
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3990684747695923
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89892197, 'precision': 0.9012821, 'recall': 0.89894915, 'specificity': 0.89894915, 'f1': 0.8987775, 'auroc': 0.9629781, 'binary_precision': 0.9322344, 'binary_recall': 0.860541, 'binary_specificity': 0.93735725, 'binary_f1_score': 0.89495414}
confusion matrix:
       0      1
0  23807   1591
1   3547  21887
---- Validation: 
scalar performance:
{'acc': 0.8631081, 'precision': 0.55069655, 'recall': 0.7546153, 'specificity': 0.7546153, 'f1': 0.5579195, 'auroc': 0.83831745, 'binary_precision': 0.11196755, 'binary_recall': 0.6403712, 'binary_specificity': 0.86885935, 'binary_f1_score': 0.19060774}
confusion matrix:
       0     1
0  14503  2189
1    155   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85174906, 'precision': 0.62420356, 'recall': 0.74992126, 'specificity': 0.74992126, 'f1': 0.6525103, 'auroc': 0.8468542, 'binary_precision': 0.28174838, 'binary_recall': 0.6301189, 'binary_specificity': 0.8697236, 'binary_f1_score': 0.3893878}
confusion matrix:
      0     1
0  8118  1216
1   280   477
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 01:39:36.846722,epoch time: 0:19:48.734207,used: 0:19:48.734207,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9331917, 'precision': 0.93513817, 'recall': 0.9332168, 'specificity': 0.9332168, 'f1': 0.93311954, 'auroc': 0.9788331, 'binary_precision': 0.9644287, 'binary_recall': 0.89966583, 'binary_specificity': 0.9667677, 'binary_f1_score': 0.93092227}
confusion matrix:
       0      1
0  24553    844
1   2552  22883
---- Validation: 
scalar performance:
{'acc': 0.9077849, 'precision': 0.57382447, 'recall': 0.76622903, 'specificity': 0.76622903, 'f1': 0.6014384, 'auroc': 0.8455206, 'binary_precision': 0.15833333, 'binary_recall': 0.6171694, 'binary_specificity': 0.91528875, 'binary_f1_score': 0.25201327}
confusion matrix:
       0     1
0  15278  1414
1    165   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88504606, 'precision': 0.6602137, 'recall': 0.76974076, 'specificity': 0.76974076, 'f1': 0.6943035, 'auroc': 0.87753546, 'binary_precision': 0.35216436, 'binary_recall': 0.6340819, 'binary_specificity': 0.9053996, 'binary_f1_score': 0.4528302}
confusion matrix:
      0    1
0  8451  883
1   277  480
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 01:57:54.437350,epoch time: 0:18:17.590628,used: 0:38:06.324835,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9449363, 'precision': 0.94708323, 'recall': 0.9449664, 'specificity': 0.9449664, 'f1': 0.9448726, 'auroc': 0.98420846, 'binary_precision': 0.978282, 'binary_recall': 0.9101738, 'binary_specificity': 0.979759, 'binary_f1_score': 0.9429997}
confusion matrix:
       0      1
0  24880    514
1   2285  23153
---- Validation: 
scalar performance:
{'acc': 0.9285172, 'precision': 0.59015006, 'recall': 0.7553903, 'specificity': 0.7553903, 'f1': 0.62495726, 'auroc': 0.85140216, 'binary_precision': 0.1919192, 'binary_recall': 0.57308584, 'binary_specificity': 0.9376947, 'binary_f1_score': 0.28754365}
confusion matrix:
       0     1
0  15652  1040
1    184   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8994153, 'precision': 0.68073297, 'recall': 0.77447337, 'specificity': 0.77447337, 'f1': 0.7138717, 'auroc': 0.88932526, 'binary_precision': 0.39321193, 'binary_recall': 0.6274769, 'binary_specificity': 0.92146987, 'binary_f1_score': 0.48346058}
confusion matrix:
      0    1
0  8601  733
1   282  475
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 02:15:29.640101,epoch time: 0:17:35.202751,used: 0:55:41.527586,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9502282, 'precision': 0.9519219, 'recall': 0.95024997, 'specificity': 0.95024997, 'f1': 0.95018315, 'auroc': 0.98711693, 'binary_precision': 0.9797654, 'binary_recall': 0.91951716, 'binary_specificity': 0.9809828, 'binary_f1_score': 0.9486857}
confusion matrix:
       0      1
0  24915    483
1   2047  23387
---- Validation: 
scalar performance:
{'acc': 0.93575895, 'precision': 0.59731746, 'recall': 0.7466731, 'specificity': 0.7466731, 'f1': 0.63329434, 'auroc': 0.8535354, 'binary_precision': 0.2068361, 'binary_recall': 0.5475638, 'binary_specificity': 0.9457824, 'binary_f1_score': 0.30025446}
confusion matrix:
       0    1
0  15787  905
1    195  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90298283, 'precision': 0.68439394, 'recall': 0.765477, 'specificity': 0.765477, 'f1': 0.714651, 'auroc': 0.8926548, 'binary_precision': 0.40228873, 'binary_recall': 0.6036988, 'binary_specificity': 0.9272552, 'binary_f1_score': 0.48283148}
confusion matrix:
      0    1
0  8655  679
1   300  457
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 02:32:57.500263,epoch time: 0:17:27.860162,used: 1:13:09.387748,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9570153, 'precision': 0.9579948, 'recall': 0.95703447, 'specificity': 0.95703447, 'f1': 0.9569936, 'auroc': 0.98978764, 'binary_precision': 0.9793832, 'binary_recall': 0.9337579, 'binary_specificity': 0.9803111, 'binary_f1_score': 0.95602655}
confusion matrix:
       0      1
0  24895    500
1   1685  23752
---- Validation: 
scalar performance:
{'acc': 0.9340653, 'precision': 0.59672076, 'recall': 0.7537154, 'specificity': 0.7537154, 'f1': 0.6331649, 'auroc': 0.8596842, 'binary_precision': 0.20523648, 'binary_recall': 0.5638051, 'binary_specificity': 0.9436257, 'binary_f1_score': 0.30092877}
confusion matrix:
       0    1
0  15751  941
1    188  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90000993, 'precision': 0.68311083, 'recall': 0.7808641, 'specificity': 0.7808641, 'f1': 0.71735805, 'auroc': 0.8961282, 'binary_precision': 0.39689034, 'binary_recall': 0.6406869, 'binary_specificity': 0.92104137, 'binary_f1_score': 0.49014652}
confusion matrix:
      0    1
0  8597  737
1   272  485
early stop counter: 1
val acc:0.9340652823448181, best validation acc: 0.9357589483261108, corresponding to test acc:                         0.9029828310012817 / 0.9029828310012817
after epoch: 5,now: 2024-08-11 02:51:11.877264,epoch time: 0:18:14.377001,used: 1:31:23.764749,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95945466, 'precision': 0.9605907, 'recall': 0.9594734, 'specificity': 0.9594734, 'f1': 0.9594308, 'auroc': 0.9914328, 'binary_precision': 0.98365337, 'binary_recall': 0.9344997, 'binary_specificity': 0.984447, 'binary_f1_score': 0.95844674}
confusion matrix:
       0      1
0  25002    395
1   1666  23769
---- Validation: 
scalar performance:
{'acc': 0.94510305, 'precision': 0.61275834, 'recall': 0.74581516, 'specificity': 0.74581516, 'f1': 0.6504546, 'auroc': 0.8627906, 'binary_precision': 0.23789908, 'binary_recall': 0.5359629, 'binary_specificity': 0.9556674, 'binary_f1_score': 0.32952926}
confusion matrix:
       0    1
0  15952  740
1    200  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9042711, 'precision': 0.68965113, 'recall': 0.77952594, 'specificity': 0.77952594, 'f1': 0.72250634, 'auroc': 0.89709526, 'binary_precision': 0.41045415, 'binary_recall': 0.6327609, 'binary_specificity': 0.926291, 'binary_f1_score': 0.49792102}
confusion matrix:
      0    1
0  8646  688
1   278  479
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-11 03:09:29.355870,epoch time: 0:18:17.478606,used: 1:49:41.243355,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96307445, 'precision': 0.9640574, 'recall': 0.9630927, 'specificity': 0.9630927, 'f1': 0.96305597, 'auroc': 0.9922566, 'binary_precision': 0.9856124, 'binary_recall': 0.93992764, 'binary_specificity': 0.9862577, 'binary_f1_score': 0.9622281}
confusion matrix:
       0      1
0  25047    349
1   1528  23908
---- Validation: 
scalar performance:
{'acc': 0.93745255, 'precision': 0.6028727, 'recall': 0.7588432, 'specificity': 0.7588432, 'f1': 0.641005, 'auroc': 0.8622587, 'binary_precision': 0.21731448, 'binary_recall': 0.5707657, 'binary_specificity': 0.9469207, 'binary_f1_score': 0.31477928}
confusion matrix:
       0    1
0  15806  886
1    185  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9011, 'precision': 0.6883632, 'recall': 0.7972337, 'specificity': 0.7972337, 'f1': 0.72549534, 'auroc': 0.8988252, 'binary_precision': 0.40459225, 'binary_recall': 0.67503303, 'binary_specificity': 0.9194343, 'binary_f1_score': 0.5059406}
confusion matrix:
      0    1
0  8582  752
1   246  511
early stop counter: 1
val acc:0.9374525547027588, best validation acc: 0.9451030492782593, corresponding to test acc:                         0.904271125793457 / 0.904271125793457
after epoch: 7,now: 2024-08-11 03:27:40.636761,epoch time: 0:18:11.280891,used: 2:07:52.524246,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9644712, 'precision': 0.96526027, 'recall': 0.96448755, 'specificity': 0.96448755, 'f1': 0.964457, 'auroc': 0.993327, 'binary_precision': 0.98461854, 'binary_recall': 0.94374114, 'binary_specificity': 0.9852339, 'binary_f1_score': 0.96374655}
confusion matrix:
       0      1
0  25021    375
1   1431  24005
---- Validation: 
scalar performance:
{'acc': 0.93605095, 'precision': 0.60032874, 'recall': 0.7569941, 'specificity': 0.7569941, 'f1': 0.63781106, 'auroc': 0.86169124, 'binary_precision': 0.21230502, 'binary_recall': 0.5684455, 'binary_specificity': 0.94554275, 'binary_f1_score': 0.30914825}
confusion matrix:
       0    1
0  15783  909
1    186  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90129817, 'precision': 0.6884295, 'recall': 0.79612696, 'specificity': 0.79612696, 'f1': 0.72532004, 'auroc': 0.89786464, 'binary_precision': 0.40493238, 'binary_recall': 0.672391, 'binary_specificity': 0.91986287, 'binary_f1_score': 0.50546175}
confusion matrix:
      0    1
0  8586  748
1   248  509
early stop counter: 2
val acc:0.9360509514808655, best validation acc: 0.9451030492782593, corresponding to test acc:                         0.904271125793457 / 0.904271125793457
after epoch: 8,now: 2024-08-11 03:45:12.182728,epoch time: 0:17:31.545967,used: 2:25:24.070213,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9665368, 'precision': 0.967221, 'recall': 0.96655047, 'specificity': 0.96655047, 'f1': 0.96652526, 'auroc': 0.9939053, 'binary_precision': 0.9852779, 'binary_recall': 0.9472753, 'binary_specificity': 0.98582566, 'binary_f1_score': 0.9659029}
confusion matrix:
       0      1
0  25038    360
1   1341  24093
---- Validation: 
scalar performance:
{'acc': 0.9444607, 'precision': 0.614943, 'recall': 0.75904727, 'specificity': 0.75904727, 'f1': 0.6546093, 'auroc': 0.8647274, 'binary_precision': 0.2415507, 'binary_recall': 0.5638051, 'binary_specificity': 0.9542895, 'binary_f1_score': 0.33820462}
confusion matrix:
       0    1
0  15929  763
1    188  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90357745, 'precision': 0.69334936, 'recall': 0.8028214, 'specificity': 0.8028214, 'f1': 0.7310692, 'auroc': 0.9001051, 'binary_precision': 0.413738, 'binary_recall': 0.68428004, 'binary_specificity': 0.92136276, 'binary_f1_score': 0.5156795}
confusion matrix:
      0    1
0  8600  734
1   239  518
early stop counter: 3
val acc:0.9444606900215149, best validation acc: 0.9451030492782593, corresponding to test acc:                         0.904271125793457 / 0.904271125793457
after epoch: 9,now: 2024-08-11 04:02:50.366376,epoch time: 0:17:38.183648,used: 2:43:02.253861,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9672254, 'precision': 0.9680834, 'recall': 0.9672432, 'specificity': 0.9672432, 'f1': 0.96721125, 'auroc': 0.9942543, 'binary_precision': 0.9883315, 'binary_recall': 0.9456697, 'binary_specificity': 0.9888167, 'binary_f1_score': 0.9665301}
confusion matrix:
       0      1
0  25111    284
1   1382  24055
---- Validation: 
scalar performance:
{'acc': 0.9408982, 'precision': 0.6065763, 'recall': 0.7515694, 'specificity': 0.7515694, 'f1': 0.6444996, 'auroc': 0.8622116, 'binary_precision': 0.22516556, 'binary_recall': 0.5522042, 'binary_specificity': 0.9509346, 'binary_f1_score': 0.3198925}
confusion matrix:
       0    1
0  15873  819
1    193  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90486574, 'precision': 0.6933561, 'recall': 0.79259294, 'specificity': 0.79259294, 'f1': 0.72876024, 'auroc': 0.8972602, 'binary_precision': 0.4156276, 'binary_recall': 0.66050196, 'binary_specificity': 0.9246839, 'binary_f1_score': 0.5102041}
confusion matrix:
      0    1
0  8631  703
1   257  500
new oracle model saved
early stop counter: 4
val acc:0.9408981800079346, best validation acc: 0.9451030492782593, corresponding to test acc:                         0.904271125793457 / 0.9048657417297363
after epoch: 10,now: 2024-08-11 04:20:20.854511,epoch time: 0:17:30.488135,used: 3:00:32.741996,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9704517, 'precision': 0.97071713, 'recall': 0.9704621, 'specificity': 0.9704621, 'f1': 0.970448, 'auroc': 0.99469876, 'binary_precision': 0.9821141, 'binary_recall': 0.95840865, 'binary_specificity': 0.9825156, 'binary_f1_score': 0.9701166}
confusion matrix:
       0      1
0  24950    444
1   1058  24380
---- Validation: 
scalar performance:
{'acc': 0.92559713, 'precision': 0.5935005, 'recall': 0.7844063, 'specificity': 0.7844063, 'f1': 0.63073826, 'auroc': 0.87072015, 'binary_precision': 0.1969806, 'binary_recall': 0.63573086, 'binary_specificity': 0.9330817, 'binary_f1_score': 0.3007684}
confusion matrix:
       0     1
0  15575  1117
1    157   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8911902, 'precision': 0.6819771, 'recall': 0.8295069, 'specificity': 0.8295069, 'f1': 0.7247422, 'auroc': 0.90210134, 'binary_precision': 0.38533962, 'binary_recall': 0.7569353, 'binary_specificity': 0.90207845, 'binary_f1_score': 0.5106952}
confusion matrix:
      0    1
0  8420  914
1   184  573
early stop counter: 5
val acc:0.9255971312522888, best validation acc: 0.9451030492782593, corresponding to test acc:                         0.904271125793457 / 0.9048657417297363
after epoch: 11,now: 2024-08-11 04:38:07.146799,epoch time: 0:17:46.292288,used: 3:18:19.034284,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9714943, 'precision': 0.9719701, 'recall': 0.97150505, 'specificity': 0.97150505, 'f1': 0.97148764, 'auroc': 0.995433, 'binary_precision': 0.98712325, 'binary_recall': 0.9554909, 'binary_specificity': 0.9875192, 'binary_f1_score': 0.9710496}
confusion matrix:
       0      1
0  25082    317
1   1132  24301
---- Validation: 
scalar performance:
{'acc': 0.93721896, 'precision': 0.6073932, 'recall': 0.77906585, 'specificity': 0.77906585, 'f1': 0.6482252, 'auroc': 0.8729433, 'binary_precision': 0.22525597, 'binary_recall': 0.612529, 'binary_specificity': 0.94560266, 'binary_f1_score': 0.32938242}
confusion matrix:
       0    1
0  15784  908
1    167  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89109105, 'precision': 0.68342793, 'recall': 0.8367365, 'specificity': 0.8367365, 'f1': 0.7271468, 'auroc': 0.9039769, 'binary_precision': 0.38690478, 'binary_recall': 0.77278733, 'binary_specificity': 0.90068567, 'binary_f1_score': 0.5156457}
confusion matrix:
      0    1
0  8407  927
1   172  585
early stop counter: 6
val acc:0.937218964099884, best validation acc: 0.9451030492782593, corresponding to test acc:                         0.904271125793457 / 0.9048657417297363
after epoch: 12,now: 2024-08-11 04:56:06.557522,epoch time: 0:17:59.410723,used: 3:36:18.445007,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97293043, 'precision': 0.9733925, 'recall': 0.9729435, 'specificity': 0.9729435, 'f1': 0.97292435, 'auroc': 0.99606454, 'binary_precision': 0.98838955, 'binary_recall': 0.957149, 'binary_specificity': 0.98873794, 'binary_f1_score': 0.9725185}
confusion matrix:
       0      1
0  25109    286
1   1090  24347
---- Validation: 
scalar performance:
{'acc': 0.92734915, 'precision': 0.59467363, 'recall': 0.78078437, 'specificity': 0.78078437, 'f1': 0.63218445, 'auroc': 0.86849165, 'binary_precision': 0.19955654, 'binary_recall': 0.6264501, 'binary_specificity': 0.9351186, 'binary_f1_score': 0.3026906}
confusion matrix:
       0     1
0  15609  1083
1    161   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89138836, 'precision': 0.68329316, 'recall': 0.83446944, 'specificity': 0.83446944, 'f1': 0.7267338, 'auroc': 0.90109277, 'binary_precision': 0.38707528, 'binary_recall': 0.7675033, 'binary_specificity': 0.9014356, 'binary_f1_score': 0.5146147}
confusion matrix:
      0    1
0  8414  920
1   176  581
early stop counter: 7
val acc:0.9273491501808167, best validation acc: 0.9451030492782593, corresponding to test acc:                         0.904271125793457 / 0.9048657417297363
after epoch: 13,now: 2024-08-11 05:14:23.818661,epoch time: 0:18:17.261139,used: 3:54:35.706146,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97413045, 'precision': 0.97429675, 'recall': 0.9741376, 'specificity': 0.9741376, 'f1': 0.9741285, 'auroc': 0.9956056, 'binary_precision': 0.9833667, 'binary_recall': 0.9646157, 'binary_specificity': 0.9836595, 'binary_f1_score': 0.973901}
confusion matrix:
       0      1
0  24982    415
1    900  24535
---- Validation: 
scalar performance:
{'acc': 0.9234947, 'precision': 0.5910043, 'recall': 0.78332794, 'specificity': 0.78332794, 'f1': 0.62724686, 'auroc': 0.87909734, 'binary_precision': 0.1920112, 'binary_recall': 0.63573086, 'binary_specificity': 0.930925, 'binary_f1_score': 0.29494077}
confusion matrix:
       0     1
0  15539  1153
1    157   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8802894, 'precision': 0.67268634, 'recall': 0.8412155, 'specificity': 0.8412155, 'f1': 0.7155956, 'auroc': 0.902485, 'binary_precision': 0.36374623, 'binary_recall': 0.7952444, 'binary_specificity': 0.88718665, 'binary_f1_score': 0.49917084}
confusion matrix:
      0     1
0  8281  1053
1   155   602
early stop counter: 8
val acc:0.9234946966171265, best validation acc: 0.9451030492782593, corresponding to test acc:                         0.904271125793457 / 0.9048657417297363
after epoch: 14,now: 2024-08-11 05:32:06.347148,epoch time: 0:17:42.528487,used: 4:12:18.234633,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9745239, 'precision': 0.9747902, 'recall': 0.97453284, 'specificity': 0.97453284, 'f1': 0.9745207, 'auroc': 0.99591374, 'binary_precision': 0.986223, 'binary_recall': 0.9625319, 'binary_specificity': 0.9865338, 'binary_f1_score': 0.97423345}
confusion matrix:
       0      1
0  25055    342
1    953  24482
---- Validation: 
scalar performance:
{'acc': 0.9217427, 'precision': 0.58852607, 'recall': 0.780169, 'specificity': 0.780169, 'f1': 0.6236704, 'auroc': 0.87134105, 'binary_precision': 0.18719889, 'binary_recall': 0.63109046, 'binary_specificity': 0.92924756, 'binary_f1_score': 0.28874734}
confusion matrix:
       0     1
0  15511  1181
1    159   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.883956, 'precision': 0.675242, 'recall': 0.8359143, 'specificity': 0.8359143, 'f1': 0.718121, 'auroc': 0.898112, 'binary_precision': 0.37013802, 'binary_recall': 0.77939236, 'binary_specificity': 0.89243627, 'binary_f1_score': 0.5019141}
confusion matrix:
      0     1
0  8330  1004
1   167   590
early stop counter: 9
val acc:0.9217426776885986, best validation acc: 0.9451030492782593, corresponding to test acc:                         0.904271125793457 / 0.9048657417297363
after epoch: 15,now: 2024-08-11 05:49:45.632080,epoch time: 0:17:39.284932,used: 4:29:57.519565,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_01_19_47_seed_1_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:29:57.519565 at 2024-08-11 05:49:45.632080
persisted model performance metric: 

scalar performance:
{'acc': 0.9042711, 'precision': 0.68965113, 'recall': 0.77952594, 'specificity': 0.77952594, 'f1': 0.72250634, 'auroc': 0.89709526, 'binary_precision': 0.41045415, 'binary_recall': 0.6327609, 'binary_specificity': 0.926291, 'binary_f1_score': 0.49792102}
confusion matrix:
      0    1
0  8646  688
1   278  479
oracle model performance metric: 

scalar performance:
{'acc': 0.90486574, 'precision': 0.6933561, 'recall': 0.79259294, 'specificity': 0.79259294, 'f1': 0.72876024, 'auroc': 0.8972602, 'binary_precision': 0.4156276, 'binary_recall': 0.66050196, 'binary_specificity': 0.9246839, 'binary_f1_score': 0.5102041}
confusion matrix:
      0    1
0  8631  703
1   257  500
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    971 MiB |   8607 MiB | 708194 GiB | 708193 GiB |
|       from large pool |    931 MiB |   8562 MiB | 696974 GiB | 696973 GiB |
|       from small pool |     39 MiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    971 MiB |   8607 MiB | 708194 GiB | 708193 GiB |
|       from large pool |    931 MiB |   8562 MiB | 696974 GiB | 696973 GiB |
|       from small pool |     39 MiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    967 MiB |   8603 MiB | 707951 GiB | 707950 GiB |
|       from large pool |    929 MiB |   8559 MiB | 696754 GiB | 696753 GiB |
|       from small pool |     37 MiB |     79 MiB |  11196 GiB |  11196 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9262 MiB |   9286 MiB |  17492 MiB |   8230 MiB |
|       from large pool |   9180 MiB |   9200 MiB |  17386 MiB |   8206 MiB |
|       from small pool |     82 MiB |     86 MiB |    106 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 265073 KiB |   1149 MiB | 437390 GiB | 437389 GiB |
|       from large pool | 244088 KiB |   1147 MiB | 426163 GiB | 426163 GiB |
|       from small pool |  20985 KiB |     36 MiB |  11226 GiB |  11226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7343    |  138625 K  |  138620 K  |
|       from large pool |     161    |     844    |   65711 K  |   65711 K  |
|       from small pool |    4745    |    7180    |   72913 K  |   72908 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7343    |  138625 K  |  138620 K  |
|       from large pool |     161    |     844    |   65711 K  |   65711 K  |
|       from small pool |    4745    |    7180    |   72913 K  |   72908 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     334    |     337    |     613    |     279    |
|       from large pool |     293    |     294    |     560    |     267    |
|       from small pool |      41    |      43    |      53    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    3212    |   73221 K  |   73221 K  |
|       from large pool |      22    |     299    |   42176 K  |   42176 K  |
|       from small pool |      56    |    3191    |   31044 K  |   31044 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8607 MiB | 708194 GiB | 708194 GiB |
|       from large pool |  16640 KiB |   8562 MiB | 696974 GiB | 696974 GiB |
|       from small pool |      0 KiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8607 MiB | 708194 GiB | 708194 GiB |
|       from large pool |  16640 KiB |   8562 MiB | 696974 GiB | 696974 GiB |
|       from small pool |      0 KiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB | 707951 GiB | 707951 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 696754 GiB | 696754 GiB |
|       from small pool |      0 KiB |     79 MiB |  11196 GiB |  11196 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1230 MiB |   9286 MiB |  17492 MiB |  16262 MiB |
|       from large pool |   1170 MiB |   9200 MiB |  17386 MiB |  16216 MiB |
|       from small pool |     60 MiB |     86 MiB |    106 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1149 MiB | 437390 GiB | 437390 GiB |
|       from large pool |  30464 KiB |   1147 MiB | 426164 GiB | 426164 GiB |
|       from small pool |      0 KiB |     38 MiB |  11226 GiB |  11226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138625 K  |  138625 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72913 K  |   72913 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138625 K  |  138625 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72913 K  |   72913 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     337    |     613    |     556    |
|       from large pool |      27    |     294    |     560    |     533    |
|       from small pool |      30    |      43    |      53    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3212    |   73223 K  |   73223 K  |
|       from large pool |       2    |     299    |   42176 K  |   42176 K  |
|       from small pool |       0    |    3191    |   31047 K  |   31047 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8607 MiB | 708194 GiB | 708194 GiB |
|       from large pool |  16640 KiB |   8562 MiB | 696974 GiB | 696974 GiB |
|       from small pool |      0 KiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8607 MiB | 708194 GiB | 708194 GiB |
|       from large pool |  16640 KiB |   8562 MiB | 696974 GiB | 696974 GiB |
|       from small pool |      0 KiB |     80 MiB |  11220 GiB |  11220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB | 707951 GiB | 707951 GiB |
|       from large pool |  16640 KiB |   8559 MiB | 696754 GiB | 696754 GiB |
|       from small pool |      0 KiB |     79 MiB |  11196 GiB |  11196 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1230 MiB |   9286 MiB |  17492 MiB |  16262 MiB |
|       from large pool |   1170 MiB |   9200 MiB |  17386 MiB |  16216 MiB |
|       from small pool |     60 MiB |     86 MiB |    106 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1149 MiB | 437390 GiB | 437390 GiB |
|       from large pool |  30464 KiB |   1147 MiB | 426164 GiB | 426164 GiB |
|       from small pool |      0 KiB |     38 MiB |  11226 GiB |  11226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138625 K  |  138625 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72913 K  |   72913 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138625 K  |  138625 K  |
|       from large pool |       2    |     844    |   65711 K  |   65711 K  |
|       from small pool |       0    |    7180    |   72913 K  |   72913 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     337    |     613    |     556    |
|       from large pool |      27    |     294    |     560    |     533    |
|       from small pool |      30    |      43    |      53    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3212    |   73223 K  |   73223 K  |
|       from large pool |       2    |     299    |   42176 K  |   42176 K  |
|       from small pool |       0    |    3191    |   31047 K  |   31047 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969

 Experiment start at: 2024-08-11 06:00:20.228661
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.44262781739234924
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9087163, 'precision': 0.91145766, 'recall': 0.9087211, 'specificity': 0.9087211, 'f1': 0.90856475, 'auroc': 0.967122, 'binary_precision': 0.94507164, 'binary_recall': 0.8678968, 'binary_specificity': 0.9495454, 'binary_f1_score': 0.9048416}
confusion matrix:
       0      1
0  24541   1304
1   3415  22436
---- Validation: 
scalar performance:
{'acc': 0.8641673, 'precision': 0.54971915, 'recall': 0.75544786, 'specificity': 0.75544786, 'f1': 0.5565861, 'auroc': 0.8416693, 'binary_precision': 0.109656304, 'binary_recall': 0.6411483, 'binary_specificity': 0.8697474, 'binary_f1_score': 0.18728162}
confusion matrix:
       0     1
0  14530  2176
1    150   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8360087, 'precision': 0.60142124, 'recall': 0.695315, 'specificity': 0.695315, 'f1': 0.6218166, 'auroc': 0.7942046, 'binary_precision': 0.24764706, 'binary_recall': 0.52823085, 'binary_specificity': 0.86239916, 'binary_f1_score': 0.33720466}
confusion matrix:
      0     1
0  8016  1279
1   376   421
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 06:20:08.137200,epoch time: 0:19:47.908539,used: 0:19:47.908539,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93744195, 'precision': 0.9388939, 'recall': 0.9374453, 'specificity': 0.9374453, 'f1': 0.93739057, 'auroc': 0.98156095, 'binary_precision': 0.964167, 'binary_recall': 0.90866894, 'binary_specificity': 0.9662217, 'binary_f1_score': 0.9355957}
confusion matrix:
       0      1
0  24972    873
1   2361  23490
---- Validation: 
scalar performance:
{'acc': 0.8915557, 'precision': 0.566109, 'recall': 0.78697836, 'specificity': 0.78697836, 'f1': 0.5876222, 'auroc': 0.87119997, 'binary_precision': 0.14114714, 'binary_recall': 0.6770335, 'binary_specificity': 0.89692324, 'binary_f1_score': 0.23359473}
confusion matrix:
       0     1
0  14984  1722
1    135   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85126835, 'precision': 0.637373, 'recall': 0.77701473, 'specificity': 0.77701473, 'f1': 0.6685567, 'auroc': 0.84733915, 'binary_precision': 0.30466148, 'binary_recall': 0.6888331, 'binary_specificity': 0.86519635, 'binary_f1_score': 0.42247015}
confusion matrix:
      0     1
0  8042  1253
1   248   549
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 06:38:44.805182,epoch time: 0:18:36.667982,used: 0:38:24.576521,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94432837, 'precision': 0.94652605, 'recall': 0.94433653, 'specificity': 0.94433653, 'f1': 0.94426054, 'auroc': 0.98527265, 'binary_precision': 0.97791, 'binary_recall': 0.909221, 'binary_specificity': 0.9794521, 'binary_f1_score': 0.9423154}
confusion matrix:
       0      1
0  25311    531
1   2347  23507
---- Validation: 
scalar performance:
{'acc': 0.90960056, 'precision': 0.576284, 'recall': 0.7822317, 'specificity': 0.7822317, 'f1': 0.6055964, 'auroc': 0.87263066, 'binary_precision': 0.16208135, 'binary_recall': 0.6483254, 'binary_specificity': 0.91613793, 'binary_f1_score': 0.25933015}
confusion matrix:
       0     1
0  15305  1401
1    147   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8635553, 'precision': 0.6428126, 'recall': 0.7624632, 'specificity': 0.7624632, 'f1': 0.67452776, 'auroc': 0.8467401, 'binary_precision': 0.319202, 'binary_recall': 0.642409, 'binary_specificity': 0.88251746, 'binary_f1_score': 0.42648897}
confusion matrix:
      0     1
0  8203  1092
1   285   512
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 06:57:00.945271,epoch time: 0:18:16.140089,used: 0:56:40.716610,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95049906, 'precision': 0.95237803, 'recall': 0.9505078, 'specificity': 0.9505078, 'f1': 0.9504483, 'auroc': 0.98778653, 'binary_precision': 0.98160094, 'binary_recall': 0.9182363, 'binary_specificity': 0.9827793, 'binary_f1_score': 0.9488619}
confusion matrix:
       0      1
0  25396    445
1   2114  23741
---- Validation: 
scalar performance:
{'acc': 0.94352955, 'precision': 0.61252415, 'recall': 0.7692983, 'specificity': 0.7692983, 'f1': 0.6534088, 'auroc': 0.87520313, 'binary_precision': 0.23580366, 'binary_recall': 0.5861244, 'binary_specificity': 0.95247215, 'binary_f1_score': 0.3363075}
confusion matrix:
       0    1
0  15912  794
1    173  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8962545, 'precision': 0.68077683, 'recall': 0.7630079, 'specificity': 0.7630079, 'f1': 0.7108753, 'auroc': 0.86374474, 'binary_precision': 0.3970346, 'binary_recall': 0.60476786, 'binary_specificity': 0.92124796, 'binary_f1_score': 0.47936347}
confusion matrix:
      0    1
0  8563  732
1   315  482
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 07:15:02.396515,epoch time: 0:18:01.451244,used: 1:14:42.167854,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9563409, 'precision': 0.9576974, 'recall': 0.95634514, 'specificity': 0.95634514, 'f1': 0.95630884, 'auroc': 0.99018276, 'binary_precision': 0.9826535, 'binary_recall': 0.9290964, 'binary_specificity': 0.9835939, 'binary_f1_score': 0.9551248}
confusion matrix:
       0      1
0  25420    424
1   1833  24019
---- Validation: 
scalar performance:
{'acc': 0.9295141, 'precision': 0.5950977, 'recall': 0.78310764, 'specificity': 0.78310764, 'f1': 0.6331993, 'auroc': 0.8787381, 'binary_precision': 0.2, 'binary_recall': 0.62918663, 'binary_specificity': 0.9370286, 'binary_f1_score': 0.3035199}
confusion matrix:
       0     1
0  15654  1052
1    155   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.880004, 'precision': 0.6638419, 'recall': 0.77999616, 'specificity': 0.77999616, 'f1': 0.69888014, 'auroc': 0.86587083, 'binary_precision': 0.35899183, 'binary_recall': 0.6612296, 'binary_specificity': 0.89876276, 'binary_f1_score': 0.46534216}
confusion matrix:
      0    1
0  8354  941
1   270  527
early stop counter: 1
val acc:0.9295141100883484, best validation acc: 0.9435295462608337, corresponding to test acc:                         0.8962544798851013 / 0.8962544798851013
after epoch: 5,now: 2024-08-11 07:33:25.488601,epoch time: 0:18:23.092086,used: 1:33:05.259940,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96042246, 'precision': 0.96128356, 'recall': 0.96042836, 'specificity': 0.96042836, 'f1': 0.9604044, 'auroc': 0.9916123, 'binary_precision': 0.9812816, 'binary_recall': 0.93877393, 'binary_specificity': 0.9820827, 'binary_f1_score': 0.95955724}
confusion matrix:
       0      1
0  25378    463
1   1583  24272
---- Validation: 
scalar performance:
{'acc': 0.93196684, 'precision': 0.59841, 'recall': 0.78436464, 'specificity': 0.78436464, 'f1': 0.63763756, 'auroc': 0.8828645, 'binary_precision': 0.20659858, 'binary_recall': 0.62918663, 'binary_specificity': 0.93954265, 'binary_f1_score': 0.31105852}
confusion matrix:
       0     1
0  15696  1010
1    155   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88248116, 'precision': 0.67047465, 'recall': 0.7951064, 'specificity': 0.7951064, 'f1': 0.70768577, 'auroc': 0.8719523, 'binary_precision': 0.36955065, 'binary_recall': 0.69134253, 'binary_specificity': 0.89887035, 'binary_f1_score': 0.48164335}
confusion matrix:
      0    1
0  8355  940
1   246  551
early stop counter: 2
val acc:0.9319668412208557, best validation acc: 0.9435295462608337, corresponding to test acc:                         0.8962544798851013 / 0.8962544798851013
after epoch: 6,now: 2024-08-11 07:52:08.605029,epoch time: 0:18:43.116428,used: 1:51:48.376368,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96481353, 'precision': 0.9652117, 'recall': 0.9648169, 'specificity': 0.9648169, 'f1': 0.9648062, 'auroc': 0.9928496, 'binary_precision': 0.9788802, 'binary_recall': 0.9501431, 'binary_specificity': 0.97949076, 'binary_f1_score': 0.96429765}
confusion matrix:
       0      1
0  25312    530
1   1289  24565
---- Validation: 
scalar performance:
{'acc': 0.9257183, 'precision': 0.5923898, 'recall': 0.7904922, 'specificity': 0.7904922, 'f1': 0.6297845, 'auroc': 0.88165116, 'binary_precision': 0.19412607, 'binary_recall': 0.6483254, 'binary_specificity': 0.9326589, 'binary_f1_score': 0.2987872}
confusion matrix:
       0     1
0  15581  1125
1    147   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86989695, 'precision': 0.6578939, 'recall': 0.79630464, 'specificity': 0.79630464, 'f1': 0.69426835, 'auroc': 0.8690367, 'binary_precision': 0.34325638, 'binary_recall': 0.7089084, 'binary_specificity': 0.8837009, 'binary_f1_score': 0.46254605}
confusion matrix:
      0     1
0  8214  1081
1   232   565
early stop counter: 3
val acc:0.9257183074951172, best validation acc: 0.9435295462608337, corresponding to test acc:                         0.8962544798851013 / 0.8962544798851013
after epoch: 7,now: 2024-08-11 08:10:48.190811,epoch time: 0:18:39.585782,used: 2:10:27.962150,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9648909, 'precision': 0.964962, 'recall': 0.9648916, 'specificity': 0.9648916, 'f1': 0.9648896, 'auroc': 0.993165, 'binary_precision': 0.9707403, 'binary_recall': 0.9586863, 'binary_specificity': 0.97109693, 'binary_f1_score': 0.96467566}
confusion matrix:
       0      1
0  25098    747
1   1068  24783
---- Validation: 
scalar performance:
{'acc': 0.9158491, 'precision': 0.5839998, 'recall': 0.79593027, 'specificity': 0.79593027, 'f1': 0.61758685, 'auroc': 0.8845173, 'binary_precision': 0.17687935, 'binary_recall': 0.6698565, 'binary_specificity': 0.92200404, 'binary_f1_score': 0.27986008}
confusion matrix:
       0     1
0  15403  1303
1    138   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85533094, 'precision': 0.6462709, 'recall': 0.7981477, 'specificity': 0.7981477, 'f1': 0.68022704, 'auroc': 0.86929566, 'binary_precision': 0.318555, 'binary_recall': 0.7302384, 'binary_specificity': 0.86605704, 'binary_f1_score': 0.44359758}
confusion matrix:
      0     1
0  8050  1245
1   215   582
early stop counter: 4
val acc:0.9158490896224976, best validation acc: 0.9435295462608337, corresponding to test acc:                         0.8962544798851013 / 0.8962544798851013
after epoch: 8,now: 2024-08-11 08:28:57.396562,epoch time: 0:18:09.205751,used: 2:28:37.167901,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96937865, 'precision': 0.96958685, 'recall': 0.96938115, 'specificity': 0.96938115, 'f1': 0.9693754, 'auroc': 0.9938723, 'binary_precision': 0.97953135, 'binary_recall': 0.9588072, 'binary_specificity': 0.97995514, 'binary_f1_score': 0.96905845}
confusion matrix:
       0      1
0  25324    518
1   1065  24789
---- Validation: 
scalar performance:
{'acc': 0.9166667, 'precision': 0.5852649, 'recall': 0.79868174, 'specificity': 0.79868174, 'f1': 0.61951816, 'auroc': 0.885196, 'binary_precision': 0.17927527, 'binary_recall': 0.67464113, 'binary_specificity': 0.9227224, 'binary_f1_score': 0.28327474}
confusion matrix:
       0     1
0  15415  1291
1    136   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85543007, 'precision': 0.6463597, 'recall': 0.7982015, 'specificity': 0.7982015, 'f1': 0.68034244, 'auroc': 0.8700456, 'binary_precision': 0.31872946, 'binary_recall': 0.7302384, 'binary_specificity': 0.8661646, 'binary_f1_score': 0.44376665}
confusion matrix:
      0     1
0  8051  1244
1   215   582
early stop counter: 5
val acc:0.9166666865348816, best validation acc: 0.9435295462608337, corresponding to test acc:                         0.8962544798851013 / 0.8962544798851013
after epoch: 9,now: 2024-08-11 08:47:07.468892,epoch time: 0:18:10.072330,used: 2:46:47.240231,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9696495, 'precision': 0.9702165, 'recall': 0.9696515, 'specificity': 0.9696515, 'f1': 0.9696404, 'auroc': 0.99468946, 'binary_precision': 0.98657423, 'binary_recall': 0.9522649, 'binary_specificity': 0.98703814, 'binary_f1_score': 0.969116}
confusion matrix:
       0      1
0  25510    335
1   1234  24617
---- Validation: 
scalar performance:
{'acc': 0.9471502, 'precision': 0.61622655, 'recall': 0.75599277, 'specificity': 0.75599277, 'f1': 0.6557042, 'auroc': 0.88216424, 'binary_precision': 0.24395373, 'binary_recall': 0.5550239, 'binary_specificity': 0.9569616, 'binary_f1_score': 0.33893356}
confusion matrix:
       0    1
0  15987  719
1    186  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8931827, 'precision': 0.67954326, 'recall': 0.7768265, 'specificity': 0.7768265, 'f1': 0.71304476, 'auroc': 0.87092364, 'binary_precision': 0.3918399, 'binary_recall': 0.63864493, 'binary_specificity': 0.91500807, 'binary_f1_score': 0.48568705}
confusion matrix:
      0    1
0  8505  790
1   288  509
better model found
persisted
after epoch: 10,now: 2024-08-11 09:05:52.597238,epoch time: 0:18:45.128346,used: 3:05:32.368577,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9707908, 'precision': 0.9711468, 'recall': 0.9707924, 'specificity': 0.9707924, 'f1': 0.9707854, 'auroc': 0.99499, 'binary_precision': 0.98412824, 'binary_recall': 0.95702296, 'binary_specificity': 0.9845618, 'binary_f1_score': 0.9703864}
confusion matrix:
       0      1
0  25446    399
1   1111  24740
---- Validation: 
scalar performance:
{'acc': 0.9439967, 'precision': 0.6148539, 'recall': 0.7753689, 'specificity': 0.7753689, 'f1': 0.6567264, 'auroc': 0.88351095, 'binary_precision': 0.2401537, 'binary_recall': 0.5980861, 'binary_specificity': 0.95265174, 'binary_f1_score': 0.34270048}
confusion matrix:
       0    1
0  15915  791
1    168  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8848593, 'precision': 0.67241496, 'recall': 0.79180896, 'specificity': 0.79180896, 'f1': 0.709155, 'auroc': 0.8745467, 'binary_precision': 0.37422466, 'binary_recall': 0.6813049, 'binary_specificity': 0.90231305, 'binary_f1_score': 0.48309603}
confusion matrix:
      0    1
0  8387  908
1   254  543
early stop counter: 1
val acc:0.9439967274665833, best validation acc: 0.9471501708030701, corresponding to test acc:                         0.8931826949119568 / 0.8962544798851013
after epoch: 11,now: 2024-08-11 09:24:31.511552,epoch time: 0:18:38.914314,used: 3:24:11.282891,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97266716, 'precision': 0.97295, 'recall': 0.97266996, 'specificity': 0.97266996, 'f1': 0.97266316, 'auroc': 0.9950254, 'binary_precision': 0.9845751, 'binary_recall': 0.96039295, 'binary_specificity': 0.98494697, 'binary_f1_score': 0.9723337}
confusion matrix:
       0      1
0  25453    389
1   1024  24830
---- Validation: 
scalar performance:
{'acc': 0.9348867, 'precision': 0.6013199, 'recall': 0.7800299, 'specificity': 0.7800299, 'f1': 0.64109284, 'auroc': 0.8823507, 'binary_precision': 0.21269579, 'binary_recall': 0.6172249, 'binary_specificity': 0.9428349, 'binary_f1_score': 0.31637034}
confusion matrix:
       0    1
0  15751  955
1    160  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8761395, 'precision': 0.66156465, 'recall': 0.7870753, 'specificity': 0.7870753, 'f1': 0.6974307, 'auroc': 0.86780524, 'binary_precision': 0.3528265, 'binary_recall': 0.6813049, 'binary_specificity': 0.89284563, 'binary_f1_score': 0.46489725}
confusion matrix:
      0    1
0  8299  996
1   254  543
early stop counter: 2
val acc:0.9348866939544678, best validation acc: 0.9471501708030701, corresponding to test acc:                         0.8931826949119568 / 0.8962544798851013
after epoch: 12,now: 2024-08-11 09:43:02.255461,epoch time: 0:18:30.743909,used: 3:42:42.026800,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97293794, 'precision': 0.9731854, 'recall': 0.9729397, 'specificity': 0.9729397, 'f1': 0.9729345, 'auroc': 0.99565494, 'binary_precision': 0.98404527, 'binary_recall': 0.961473, 'binary_specificity': 0.9844064, 'binary_f1_score': 0.9726282}
confusion matrix:
       0      1
0  25441    403
1    996  24856
---- Validation: 
scalar performance:
{'acc': 0.9310909, 'precision': 0.5995197, 'recall': 0.7944119, 'specificity': 0.7944119, 'f1': 0.63963217, 'auroc': 0.888144, 'binary_precision': 0.20826952, 'binary_recall': 0.6507177, 'binary_specificity': 0.93810606, 'binary_f1_score': 0.31554523}
confusion matrix:
       0     1
0  15672  1034
1    146   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8743559, 'precision': 0.6644016, 'recall': 0.8050345, 'specificity': 0.8050345, 'f1': 0.70232636, 'auroc': 0.8768237, 'binary_precision': 0.35489833, 'binary_recall': 0.7227102, 'binary_specificity': 0.8873588, 'binary_f1_score': 0.47603306}
confusion matrix:
      0     1
0  8248  1047
1   221   576
early stop counter: 3
val acc:0.9310908913612366, best validation acc: 0.9471501708030701, corresponding to test acc:                         0.8931826949119568 / 0.8962544798851013
after epoch: 13,now: 2024-08-11 10:00:55.809265,epoch time: 0:17:53.553804,used: 4:00:35.580604,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.973673, 'precision': 0.9739822, 'recall': 0.97367597, 'specificity': 0.97367597, 'f1': 0.9736688, 'auroc': 0.9958786, 'binary_precision': 0.98614585, 'binary_recall': 0.9608571, 'binary_specificity': 0.98649484, 'binary_f1_score': 0.97333723}
confusion matrix:
       0      1
0  25493    349
1   1012  24842
---- Validation: 
scalar performance:
{'acc': 0.9330764, 'precision': 0.60179985, 'recall': 0.793097, 'specificity': 0.793097, 'f1': 0.6425451, 'auroc': 0.88921595, 'binary_precision': 0.21293375, 'binary_recall': 0.64593303, 'binary_specificity': 0.940261, 'binary_f1_score': 0.32028466}
confusion matrix:
       0    1
0  15708  998
1    148  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8771304, 'precision': 0.66855496, 'recall': 0.8105556, 'specificity': 0.8105556, 'f1': 0.7074363, 'auroc': 0.87897193, 'binary_precision': 0.36233684, 'binary_recall': 0.7314931, 'binary_specificity': 0.8896181, 'binary_f1_score': 0.48462173}
confusion matrix:
      0     1
0  8269  1026
1   214   583
early stop counter: 4
val acc:0.9330763816833496, best validation acc: 0.9471501708030701, corresponding to test acc:                         0.8931826949119568 / 0.8962544798851013
after epoch: 14,now: 2024-08-11 10:19:33.143661,epoch time: 0:18:37.334396,used: 4:19:12.915000,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97529787, 'precision': 0.97542715, 'recall': 0.97529984, 'specificity': 0.97529984, 'f1': 0.9752963, 'auroc': 0.9963803, 'binary_precision': 0.9833235, 'binary_recall': 0.96700704, 'binary_specificity': 0.9835926, 'binary_f1_score': 0.97509706}
confusion matrix:
       0      1
0  25418    424
1    853  25001
---- Validation: 
scalar performance:
{'acc': 0.9356459, 'precision': 0.60485923, 'recall': 0.79091513, 'specificity': 0.79091513, 'f1': 0.6463073, 'auroc': 0.8913242, 'binary_precision': 0.21921182, 'binary_recall': 0.638756, 'binary_specificity': 0.94307435, 'binary_f1_score': 0.32640585}
confusion matrix:
       0    1
0  15755  951
1    151  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8791122, 'precision': 0.6723896, 'recall': 0.8179406, 'specificity': 0.8179406, 'f1': 0.7123618, 'auroc': 0.8827702, 'binary_precision': 0.36871508, 'binary_recall': 0.74529487, 'binary_specificity': 0.8905863, 'binary_f1_score': 0.49335548}
confusion matrix:
      0     1
0  8278  1017
1   203   594
early stop counter: 5
val acc:0.9356458783149719, best validation acc: 0.9471501708030701, corresponding to test acc:                         0.8931826949119568 / 0.8962544798851013
after epoch: 15,now: 2024-08-11 10:38:35.364775,epoch time: 0:19:02.221114,used: 4:38:15.136114,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_06_00_19_seed_2_24141969
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:38:15.136114 at 2024-08-11 10:38:35.364775
persisted model performance metric: 

scalar performance:
{'acc': 0.8931827, 'precision': 0.67954326, 'recall': 0.7768265, 'specificity': 0.7768265, 'f1': 0.71304476, 'auroc': 0.87092364, 'binary_precision': 0.3918399, 'binary_recall': 0.63864493, 'binary_specificity': 0.91500807, 'binary_f1_score': 0.48568705}
confusion matrix:
      0    1
0  8505  790
1   288  509
oracle model performance metric: 

scalar performance:
{'acc': 0.8962545, 'precision': 0.68077683, 'recall': 0.7630079, 'specificity': 0.7630079, 'f1': 0.7108753, 'auroc': 0.86374474, 'binary_precision': 0.3970346, 'binary_recall': 0.60476786, 'binary_specificity': 0.92124796, 'binary_f1_score': 0.47936347}
confusion matrix:
      0    1
0  8563  732
1   315  482
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    971 MiB |   8607 MiB |   1054 TiB |   1054 TiB |
|       from large pool |    931 MiB |   8562 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     39 MiB |     80 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |    971 MiB |   8607 MiB |   1054 TiB |   1054 TiB |
|       from large pool |    931 MiB |   8562 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     39 MiB |     80 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |    967 MiB |   8603 MiB |   1053 TiB |   1053 TiB |
|       from large pool |    929 MiB |   8559 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     37 MiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9242 MiB |   9286 MiB |  25504 MiB |  16262 MiB |
|       from large pool |   9160 MiB |   9200 MiB |  25376 MiB |  16216 MiB |
|       from small pool |     82 MiB |     86 MiB |    128 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 269169 KiB |   1149 MiB | 668924 GiB | 668924 GiB |
|       from large pool | 244088 KiB |   1147 MiB | 651893 GiB | 651893 GiB |
|       from small pool |  25081 KiB |     38 MiB |  17030 GiB |  17030 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7451    |  210317 K  |  210312 K  |
|       from large pool |     161    |     844    |  100109 K  |  100109 K  |
|       from small pool |    4745    |    7288    |  110208 K  |  110203 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7451    |  210317 K  |  210312 K  |
|       from large pool |     161    |     844    |  100109 K  |  100109 K  |
|       from small pool |    4745    |    7288    |  110208 K  |  110203 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     325    |     337    |     881    |     556    |
|       from large pool |     284    |     294    |     817    |     533    |
|       from small pool |      41    |      43    |      64    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      79    |    3267    |  111393 K  |  111393 K  |
|       from large pool |      22    |     299    |   63981 K  |   63981 K  |
|       from small pool |      57    |    3246    |   47412 K  |   47412 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8607 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8562 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     80 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8607 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8562 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     80 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8603 MiB |   1053 TiB |   1053 TiB |
|       from large pool |  16640 KiB |   8559 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1234 MiB |   9286 MiB |  25504 MiB |  24270 MiB |
|       from large pool |   1170 MiB |   9200 MiB |  25376 MiB |  24206 MiB |
|       from small pool |     64 MiB |     86 MiB |    128 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1149 MiB | 668924 GiB | 668924 GiB |
|       from large pool |  30464 KiB |   1147 MiB | 651894 GiB | 651893 GiB |
|       from small pool |      0 KiB |     42 MiB |  17030 GiB |  17030 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7451    |  210317 K  |  210317 K  |
|       from large pool |       2    |     844    |  100109 K  |  100109 K  |
|       from small pool |       0    |    7288    |  110208 K  |  110208 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7451    |  210317 K  |  210317 K  |
|       from large pool |       2    |     844    |  100109 K  |  100109 K  |
|       from small pool |       0    |    7288    |  110208 K  |  110208 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     337    |     881    |     822    |
|       from large pool |      27    |     294    |     817    |     790    |
|       from small pool |      32    |      43    |      64    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3267    |  111395 K  |  111395 K  |
|       from large pool |       2    |     299    |   63981 K  |   63981 K  |
|       from small pool |       0    |    3246    |   47414 K  |   47414 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 10:40:49 2024]
Finished job 0.
1 of 1 steps (100%) done
