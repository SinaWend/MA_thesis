Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 23:59:04 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970

 Experiment start at: 2024-08-11 00:07:27.312629
before training, model accuracy: 0.09007316827774048
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8963203, 'precision': 0.9006292, 'recall': 0.89634895, 'specificity': 0.89634895, 'f1': 0.89604557, 'auroc': 0.9601115, 'binary_precision': 0.9423162, 'binary_recall': 0.844448, 'binary_specificity': 0.94825, 'binary_f1_score': 0.8907018}
confusion matrix:
       0      1
0  24004   1310
1   3942  21400
---- Validation: 
scalar performance:
{'acc': 0.85448503, 'precision': 0.51179904, 'recall': 0.5576833, 'specificity': 0.5576833, 'f1': 0.4983052, 'auroc': 0.616815, 'binary_precision': 0.044658493, 'binary_recall': 0.24578314, 'binary_specificity': 0.8695834, 'binary_f1_score': 0.07558355}
confusion matrix:
       0     1
0  14549  2182
1    313   102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8645442, 'precision': 0.5013677, 'recall': 0.50126624, 'specificity': 0.50126624, 'f1': 0.5012456, 'auroc': 0.5588147, 'binary_precision': 0.07887324, 'binary_recall': 0.07253886, 'binary_specificity': 0.92999357, 'binary_f1_score': 0.07557355}
confusion matrix:
      0    1
0  8688  654
1   716   56
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 00:27:13.711912,epoch time: 0:19:46.399283,used: 0:19:46.399283,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9249842, 'precision': 0.9284431, 'recall': 0.92501086, 'specificity': 0.92501086, 'f1': 0.9248357, 'auroc': 0.9752464, 'binary_precision': 0.96708727, 'binary_recall': 0.8800063, 'binary_specificity': 0.9700154, 'binary_f1_score': 0.9214941}
confusion matrix:
       0      1
0  24554    759
1   3041  22302
---- Validation: 
scalar performance:
{'acc': 0.89717716, 'precision': 0.53356487, 'recall': 0.62185645, 'specificity': 0.62185645, 'f1': 0.5403494, 'auroc': 0.7178115, 'binary_precision': 0.08497537, 'binary_recall': 0.3325301, 'binary_specificity': 0.9111828, 'binary_f1_score': 0.13536048}
confusion matrix:
       0     1
0  15245  1486
1    277   138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88471425, 'precision': 0.52890426, 'recall': 0.5205027, 'specificity': 0.5205027, 'f1': 0.52278805, 'auroc': 0.71039134, 'binary_precision': 0.13108614, 'binary_recall': 0.09067357, 'binary_specificity': 0.9503318, 'binary_f1_score': 0.10719755}
confusion matrix:
      0    1
0  8878  464
1   702   70
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 00:46:11.357104,epoch time: 0:18:57.645192,used: 0:38:44.044475,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93728286, 'precision': 0.94044757, 'recall': 0.93730634, 'specificity': 0.93730634, 'f1': 0.9371723, 'auroc': 0.98181653, 'binary_precision': 0.9779206, 'binary_recall': 0.89483863, 'binary_specificity': 0.97977406, 'binary_f1_score': 0.9345367}
confusion matrix:
       0      1
0  24802    512
1   2665  22677
---- Validation: 
scalar performance:
{'acc': 0.8975271, 'precision': 0.5457958, 'recall': 0.6737329, 'specificity': 0.6737329, 'f1': 0.55850136, 'auroc': 0.77078974, 'binary_precision': 0.1066823, 'binary_recall': 0.43855423, 'binary_specificity': 0.9089116, 'binary_f1_score': 0.17161717}
confusion matrix:
       0     1
0  15207  1524
1    233   182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88728493, 'precision': 0.5816128, 'recall': 0.57239676, 'specificity': 0.57239676, 'f1': 0.5765419, 'auroc': 0.7913556, 'binary_precision': 0.22861357, 'binary_recall': 0.2007772, 'binary_specificity': 0.9440163, 'binary_f1_score': 0.2137931}
confusion matrix:
      0    1
0  8819  523
1   617  155
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 01:05:04.466941,epoch time: 0:18:53.109837,used: 0:57:37.154312,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95027244, 'precision': 0.9511709, 'recall': 0.9502857, 'specificity': 0.9502857, 'f1': 0.9502487, 'auroc': 0.98636186, 'binary_precision': 0.97145337, 'binary_recall': 0.9278696, 'binary_specificity': 0.9727018, 'binary_f1_score': 0.94916147}
confusion matrix:
       0      1
0  24622    691
1   1828  23515
---- Validation: 
scalar performance:
{'acc': 0.8657996, 'precision': 0.54091954, 'recall': 0.7032981, 'specificity': 0.7032981, 'f1': 0.54410166, 'auroc': 0.8048084, 'binary_precision': 0.094931275, 'binary_recall': 0.5325301, 'binary_specificity': 0.8740661, 'binary_f1_score': 0.16113745}
confusion matrix:
       0     1
0  14624  2107
1    194   221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8684991, 'precision': 0.6199444, 'recall': 0.6905633, 'specificity': 0.6905633, 'f1': 0.642427, 'auroc': 0.83697927, 'binary_precision': 0.28538463, 'binary_recall': 0.48056996, 'binary_specificity': 0.9005566, 'binary_f1_score': 0.3581081}
confusion matrix:
      0    1
0  8413  929
1   401  371
early stop counter: 1
val acc:0.865799605846405, best validation acc: 0.8975270986557007, corresponding to test acc:                         0.8872849345207214 / 0.8872849345207214
after epoch: 4,now: 2024-08-11 01:23:54.222605,epoch time: 0:18:49.755664,used: 1:16:26.909976,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95394427, 'precision': 0.95561934, 'recall': 0.95396346, 'specificity': 0.95396346, 'f1': 0.95390326, 'auroc': 0.9888345, 'binary_precision': 0.98340404, 'binary_recall': 0.9235322, 'binary_specificity': 0.9843947, 'binary_f1_score': 0.95252824}
confusion matrix:
       0      1
0  24917    395
1   1938  23406
---- Validation: 
scalar performance:
{'acc': 0.90662545, 'precision': 0.5585224, 'recall': 0.7101182, 'specificity': 0.7101182, 'f1': 0.5787126, 'auroc': 0.81728673, 'binary_precision': 0.13029926, 'binary_recall': 0.5036145, 'binary_specificity': 0.91662186, 'binary_f1_score': 0.20703319}
confusion matrix:
       0     1
0  15336  1395
1    206   209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8954914, 'precision': 0.6488082, 'recall': 0.6760615, 'specificity': 0.6760615, 'f1': 0.66077447, 'auroc': 0.85094965, 'binary_precision': 0.34660926, 'binary_recall': 0.41709843, 'binary_specificity': 0.9350246, 'binary_f1_score': 0.37860084}
confusion matrix:
      0    1
0  8735  607
1   450  322
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 01:42:46.253592,epoch time: 0:18:52.030987,used: 1:35:18.940963,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9599455, 'precision': 0.9607204, 'recall': 0.95996016, 'specificity': 0.95996016, 'f1': 0.9599295, 'auroc': 0.9907613, 'binary_precision': 0.9797934, 'binary_recall': 0.9393198, 'binary_specificity': 0.98060054, 'binary_f1_score': 0.9591298}
confusion matrix:
       0      1
0  24819    491
1   1538  23808
---- Validation: 
scalar performance:
{'acc': 0.8796804, 'precision': 0.5516329, 'recall': 0.7386091, 'specificity': 0.7386091, 'f1': 0.5634661, 'auroc': 0.82758284, 'binary_precision': 0.11459308, 'binary_recall': 0.5903614, 'binary_specificity': 0.88685673, 'binary_f1_score': 0.19193105}
confusion matrix:
       0     1
0  14838  1893
1    170   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8770022, 'precision': 0.64942133, 'recall': 0.755175, 'specificity': 0.755175, 'f1': 0.6812432, 'auroc': 0.8661219, 'binary_precision': 0.33333334, 'binary_recall': 0.61139894, 'binary_specificity': 0.898951, 'binary_f1_score': 0.43144423}
confusion matrix:
      0    1
0  8398  944
1   300  472
early stop counter: 1
val acc:0.8796803951263428, best validation acc: 0.9066254496574402, corresponding to test acc:                         0.8954914212226868 / 0.8954914212226868
after epoch: 6,now: 2024-08-11 02:01:34.314596,epoch time: 0:18:48.061004,used: 1:54:07.001967,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.962729, 'precision': 0.9633977, 'recall': 0.96274185, 'specificity': 0.96274185, 'f1': 0.9627163, 'auroc': 0.99195933, 'binary_precision': 0.9811692, 'binary_recall': 0.94361806, 'binary_specificity': 0.9818656, 'binary_f1_score': 0.9620274}
confusion matrix:
       0      1
0  24852    459
1   1429  23916
---- Validation: 
scalar performance:
{'acc': 0.8933279, 'precision': 0.5573917, 'recall': 0.73855245, 'specificity': 0.73855245, 'f1': 0.5750062, 'auroc': 0.8389876, 'binary_precision': 0.12632136, 'binary_recall': 0.5759036, 'binary_specificity': 0.90120137, 'binary_f1_score': 0.2071955}
confusion matrix:
       0     1
0  15078  1653
1    176   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88659286, 'precision': 0.6599171, 'recall': 0.75323683, 'specificity': 0.75323683, 'f1': 0.69096607, 'auroc': 0.87043417, 'binary_precision': 0.35521236, 'binary_recall': 0.59585494, 'binary_specificity': 0.9106187, 'binary_f1_score': 0.4450895}
confusion matrix:
      0    1
0  8507  835
1   312  460
early stop counter: 2
val acc:0.8933278918266296, best validation acc: 0.9066254496574402, corresponding to test acc:                         0.8954914212226868 / 0.8954914212226868
after epoch: 7,now: 2024-08-11 02:20:27.694352,epoch time: 0:18:53.379756,used: 2:13:00.381723,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9652953, 'precision': 0.96562696, 'recall': 0.9653022, 'specificity': 0.9653022, 'f1': 0.9652895, 'auroc': 0.9930654, 'binary_precision': 0.97818244, 'binary_recall': 0.9518567, 'binary_specificity': 0.9787478, 'binary_f1_score': 0.96483994}
confusion matrix:
       0      1
0  24777    538
1   1220  24121
---- Validation: 
scalar performance:
{'acc': 0.8845795, 'precision': 0.5550919, 'recall': 0.7469941, 'specificity': 0.7469941, 'f1': 0.56974345, 'auroc': 0.8410301, 'binary_precision': 0.12112403, 'binary_recall': 0.60240966, 'binary_specificity': 0.8915785, 'binary_f1_score': 0.20169424}
confusion matrix:
       0     1
0  14917  1814
1    165   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8851097, 'precision': 0.66254926, 'recall': 0.7696643, 'specificity': 0.7696643, 'f1': 0.69638395, 'auroc': 0.87088466, 'binary_precision': 0.35745615, 'binary_recall': 0.6334197, 'binary_specificity': 0.9059088, 'binary_f1_score': 0.45700935}
confusion matrix:
      0    1
0  8463  879
1   283  489
early stop counter: 3
val acc:0.8845794796943665, best validation acc: 0.9066254496574402, corresponding to test acc:                         0.8954914212226868 / 0.8954914212226868
after epoch: 8,now: 2024-08-11 02:39:15.043929,epoch time: 0:18:47.349577,used: 2:31:47.731300,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96563095, 'precision': 0.9664886, 'recall': 0.9656437, 'specificity': 0.9656437, 'f1': 0.9656158, 'auroc': 0.9936604, 'binary_precision': 0.9866392, 'binary_recall': 0.94408715, 'binary_specificity': 0.98720026, 'binary_f1_score': 0.9648943}
confusion matrix:
       0      1
0  24989    324
1   1417  23926
---- Validation: 
scalar performance:
{'acc': 0.9103581, 'precision': 0.5682727, 'recall': 0.743754, 'specificity': 0.743754, 'f1': 0.59366626, 'auroc': 0.8404111, 'binary_precision': 0.14805521, 'binary_recall': 0.5686747, 'binary_specificity': 0.9188333, 'binary_f1_score': 0.23494276}
confusion matrix:
       0     1
0  15373  1358
1    179   236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9005339, 'precision': 0.68119365, 'recall': 0.7578126, 'specificity': 0.7578126, 'f1': 0.7100056, 'auroc': 0.8719431, 'binary_precision': 0.39772728, 'binary_recall': 0.58937824, 'binary_specificity': 0.92624706, 'binary_f1_score': 0.47494784}
confusion matrix:
      0    1
0  8653  689
1   317  455
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-11 02:58:04.979752,epoch time: 0:18:49.935823,used: 2:50:37.667123,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9679011, 'precision': 0.9685066, 'recall': 0.96791255, 'specificity': 0.96791255, 'f1': 0.96789134, 'auroc': 0.9941741, 'binary_precision': 0.98550725, 'binary_recall': 0.9498106, 'binary_specificity': 0.98601454, 'binary_f1_score': 0.9673297}
confusion matrix:
       0      1
0  24958    354
1   1272  24072
---- Validation: 
scalar performance:
{'acc': 0.8952525, 'precision': 0.56036603, 'recall': 0.7489382, 'specificity': 0.7489382, 'f1': 0.57979953, 'auroc': 0.8447068, 'binary_precision': 0.13173333, 'binary_recall': 0.59518075, 'binary_specificity': 0.9026956, 'binary_f1_score': 0.21572053}
confusion matrix:
       0     1
0  15103  1628
1    168   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8935139, 'precision': 0.6744001, 'recall': 0.7736194, 'specificity': 0.7736194, 'f1': 0.7080723, 'auroc': 0.8742988, 'binary_precision': 0.3809524, 'binary_recall': 0.63212436, 'binary_specificity': 0.9151145, 'binary_f1_score': 0.47540185}
confusion matrix:
      0    1
0  8549  793
1   284  488
early stop counter: 1
val acc:0.895252525806427, best validation acc: 0.9103580713272095, corresponding to test acc:                         0.90053391456604 / 0.90053391456604
after epoch: 10,now: 2024-08-11 03:16:54.609587,epoch time: 0:18:49.629835,used: 3:09:27.296958,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9718493, 'precision': 0.9719995, 'recall': 0.971854, 'specificity': 0.971854, 'f1': 0.9718473, 'auroc': 0.99531925, 'binary_precision': 0.980549, 'binary_recall': 0.962827, 'binary_specificity': 0.9808809, 'binary_f1_score': 0.9716072}
confusion matrix:
       0      1
0  24831    484
1    942  24399
---- Validation: 
scalar performance:
{'acc': 0.8706404, 'precision': 0.5525233, 'recall': 0.76217544, 'specificity': 0.76217544, 'f1': 0.5624391, 'auroc': 0.8512672, 'binary_precision': 0.11490816, 'binary_recall': 0.64819276, 'binary_specificity': 0.87615806, 'binary_f1_score': 0.19521044}
confusion matrix:
       0     1
0  14659  2072
1    146   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88253903, 'precision': 0.6670211, 'recall': 0.79857415, 'specificity': 0.79857415, 'f1': 0.70502174, 'auroc': 0.8753997, 'binary_precision': 0.36096257, 'binary_recall': 0.69948184, 'binary_specificity': 0.89766645, 'binary_f1_score': 0.4761905}
confusion matrix:
      0    1
0  8386  956
1   232  540
early stop counter: 2
val acc:0.8706403970718384, best validation acc: 0.9103580713272095, corresponding to test acc:                         0.90053391456604 / 0.90053391456604
after epoch: 11,now: 2024-08-11 03:35:40.421655,epoch time: 0:18:45.812068,used: 3:28:13.109026,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9730338, 'precision': 0.97328794, 'recall': 0.9730407, 'specificity': 0.9730407, 'f1': 0.97303045, 'auroc': 0.99564135, 'binary_precision': 0.98440343, 'binary_recall': 0.96133053, 'binary_specificity': 0.9847509, 'binary_f1_score': 0.97273016}
confusion matrix:
       0      1
0  24927    386
1    980  24363
---- Validation: 
scalar performance:
{'acc': 0.8994518, 'precision': 0.5634877, 'recall': 0.7534397, 'specificity': 0.7534397, 'f1': 0.5851825, 'auroc': 0.8539822, 'binary_precision': 0.13779746, 'binary_recall': 0.6, 'binary_specificity': 0.9068794, 'binary_f1_score': 0.22412242}
confusion matrix:
       0     1
0  15173  1558
1    166   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8947993, 'precision': 0.6787826, 'recall': 0.7844157, 'specificity': 0.7844157, 'f1': 0.714186, 'auroc': 0.88046056, 'binary_precision': 0.38786483, 'binary_recall': 0.65414506, 'binary_specificity': 0.9146864, 'binary_f1_score': 0.48698172}
confusion matrix:
      0    1
0  8545  797
1   267  505
early stop counter: 3
val acc:0.8994517922401428, best validation acc: 0.9103580713272095, corresponding to test acc:                         0.90053391456604 / 0.90053391456604
after epoch: 12,now: 2024-08-11 03:54:19.555392,epoch time: 0:18:39.133737,used: 3:46:52.242763,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97301406, 'precision': 0.9731907, 'recall': 0.97302026, 'specificity': 0.97302026, 'f1': 0.9730118, 'auroc': 0.99555016, 'binary_precision': 0.98249286, 'binary_recall': 0.963226, 'binary_specificity': 0.9828145, 'binary_f1_score': 0.972764}
confusion matrix:
       0      1
0  24877    435
1    932  24412
---- Validation: 
scalar performance:
{'acc': 0.8688324, 'precision': 0.5521539, 'recall': 0.7635988, 'specificity': 0.7635988, 'f1': 0.56140053, 'auroc': 0.8499005, 'binary_precision': 0.114057235, 'binary_recall': 0.65301204, 'binary_specificity': 0.8741856, 'binary_f1_score': 0.19419563}
confusion matrix:
       0     1
0  14626  2105
1    144   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88352776, 'precision': 0.67057174, 'recall': 0.80861574, 'specificity': 0.80861574, 'f1': 0.70995945, 'auroc': 0.8788496, 'binary_precision': 0.3662714, 'binary_recall': 0.7202073, 'binary_specificity': 0.8970242, 'binary_f1_score': 0.4855895}
confusion matrix:
      0    1
0  8380  962
1   216  556
early stop counter: 4
val acc:0.8688324093818665, best validation acc: 0.9103580713272095, corresponding to test acc:                         0.90053391456604 / 0.90053391456604
after epoch: 13,now: 2024-08-11 04:13:03.851576,epoch time: 0:18:44.296184,used: 4:05:36.538947,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97344834, 'precision': 0.9739941, 'recall': 0.9734591, 'specificity': 0.9734591, 'f1': 0.9734412, 'auroc': 0.9960253, 'binary_precision': 0.99023575, 'binary_recall': 0.95636046, 'binary_specificity': 0.99055785, 'binary_f1_score': 0.9730034}
confusion matrix:
       0      1
0  25073    239
1   1106  24238
---- Validation: 
scalar performance:
{'acc': 0.91893154, 'precision': 0.5742518, 'recall': 0.74109745, 'specificity': 0.74109745, 'f1': 0.60290146, 'auroc': 0.847766, 'binary_precision': 0.16027875, 'binary_recall': 0.55421686, 'binary_specificity': 0.927978, 'binary_f1_score': 0.24864867}
confusion matrix:
       0     1
0  15526  1205
1    185   230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9045877, 'precision': 0.6919844, 'recall': 0.7754549, 'specificity': 0.7754549, 'f1': 0.7232461, 'auroc': 0.8804023, 'binary_precision': 0.4164502, 'binary_recall': 0.623057, 'binary_specificity': 0.9278527, 'binary_f1_score': 0.49922162}
confusion matrix:
      0    1
0  8668  674
1   291  481
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-11 04:31:48.054437,epoch time: 0:18:44.202861,used: 4:24:20.741808,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9758765, 'precision': 0.9760509, 'recall': 0.97588223, 'specificity': 0.97588223, 'f1': 0.9758745, 'auroc': 0.99643064, 'binary_precision': 0.98531246, 'binary_recall': 0.96618396, 'binary_specificity': 0.9855805, 'binary_f1_score': 0.9756545}
confusion matrix:
       0      1
0  24948    365
1    857  24486
---- Validation: 
scalar performance:
{'acc': 0.88732064, 'precision': 0.55804276, 'recall': 0.7566232, 'specificity': 0.7566232, 'f1': 0.57473606, 'auroc': 0.85421157, 'binary_precision': 0.12653865, 'binary_recall': 0.6192771, 'binary_specificity': 0.8939693, 'binary_f1_score': 0.21013899}
confusion matrix:
       0     1
0  14957  1774
1    158   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89559025, 'precision': 0.683243, 'recall': 0.7991034, 'specificity': 0.7991034, 'f1': 0.7210878, 'auroc': 0.8796761, 'binary_precision': 0.39418778, 'binary_recall': 0.6852332, 'binary_specificity': 0.91297364, 'binary_f1_score': 0.5004731}
confusion matrix:
      0    1
0  8529  813
1   243  529
early stop counter: 1
val acc:0.8873206377029419, best validation acc: 0.9189315438270569, corresponding to test acc:                         0.9045876860618591 / 0.9045876860618591
after epoch: 15,now: 2024-08-11 04:50:27.916776,epoch time: 0:18:39.862339,used: 4:43:00.604147,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_07_26_seed_0_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:43:00.604147 at 2024-08-11 04:50:27.916776
persisted model performance metric: 

scalar performance:
{'acc': 0.9045877, 'precision': 0.6919844, 'recall': 0.7754549, 'specificity': 0.7754549, 'f1': 0.7232461, 'auroc': 0.8804023, 'binary_precision': 0.4164502, 'binary_recall': 0.623057, 'binary_specificity': 0.9278527, 'binary_f1_score': 0.49922162}
confusion matrix:
      0    1
0  8668  674
1   291  481
oracle model performance metric: 

scalar performance:
{'acc': 0.9045877, 'precision': 0.6919844, 'recall': 0.7754549, 'specificity': 0.7754549, 'f1': 0.7232461, 'auroc': 0.8804023, 'binary_precision': 0.4164502, 'binary_recall': 0.623057, 'binary_specificity': 0.9278527, 'binary_f1_score': 0.49922162}
confusion matrix:
      0    1
0  8668  674
1   291  481
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    822 MiB |   8458 MiB | 351620 GiB | 351620 GiB |
|       from large pool |    783 MiB |   8414 MiB | 346041 GiB | 346040 GiB |
|       from small pool |     38 MiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    822 MiB |   8458 MiB | 351620 GiB | 351620 GiB |
|       from large pool |    783 MiB |   8414 MiB | 346041 GiB | 346040 GiB |
|       from small pool |     38 MiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    819 MiB |   8455 MiB | 351487 GiB | 351486 GiB |
|       from large pool |    782 MiB |   8412 MiB | 345920 GiB | 345919 GiB |
|       from small pool |     36 MiB |     77 MiB |   5567 GiB |   5567 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9142 MiB |   9142 MiB |   9142 MiB |      0 B   |
|       from large pool |   9058 MiB |   9058 MiB |   9058 MiB |      0 B   |
|       from small pool |     84 MiB |     84 MiB |     84 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  77674 KiB |   1142 MiB | 212705 GiB | 212705 GiB |
|       from large pool |  59734 KiB |   1139 MiB | 207116 GiB | 207116 GiB |
|       from small pool |  17940 KiB |     21 MiB |   5588 GiB |   5588 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4918    |    7321    |   68993 K  |   68988 K  |
|       from large pool |     161    |     844    |   32633 K  |   32632 K  |
|       from small pool |    4757    |    7158    |   36360 K  |   36355 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4918    |    7321    |   68993 K  |   68988 K  |
|       from large pool |     161    |     844    |   32633 K  |   32632 K  |
|       from small pool |    4757    |    7158    |   36360 K  |   36355 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     340    |     340    |     340    |       0    |
|       from large pool |     298    |     298    |     298    |       0    |
|       from small pool |      42    |      42    |      42    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3198    |   38089 K  |   38089 K  |
|       from large pool |      19    |     301    |   21371 K  |   21371 K  |
|       from small pool |      55    |    3180    |   16718 K  |   16718 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8458 MiB | 351620 GiB | 351620 GiB |
|       from large pool |  16640 KiB |   8414 MiB | 346041 GiB | 346041 GiB |
|       from small pool |      0 KiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8458 MiB | 351620 GiB | 351620 GiB |
|       from large pool |  16640 KiB |   8414 MiB | 346041 GiB | 346041 GiB |
|       from small pool |      0 KiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB | 351487 GiB | 351487 GiB |
|       from large pool |  16640 KiB |   8412 MiB | 345920 GiB | 345920 GiB |
|       from small pool |      0 KiB |     77 MiB |   5567 GiB |   5567 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    898 MiB |   9142 MiB |   9142 MiB |   8244 MiB |
|       from large pool |    842 MiB |   9058 MiB |   9058 MiB |   8216 MiB |
|       from small pool |     56 MiB |     84 MiB |     84 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1142 MiB | 212705 GiB | 212705 GiB |
|       from large pool |  30464 KiB |   1139 MiB | 207116 GiB | 207116 GiB |
|       from small pool |      0 KiB |     30 MiB |   5588 GiB |   5588 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68993 K  |   68993 K  |
|       from large pool |       2    |     844    |   32633 K  |   32633 K  |
|       from small pool |       0    |    7158    |   36360 K  |   36360 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68993 K  |   68993 K  |
|       from large pool |       2    |     844    |   32633 K  |   32633 K  |
|       from small pool |       0    |    7158    |   36360 K  |   36360 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     340    |     340    |     285    |
|       from large pool |      27    |     298    |     298    |     271    |
|       from small pool |      28    |      42    |      42    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3198    |   38091 K  |   38091 K  |
|       from large pool |       2    |     301    |   21371 K  |   21371 K  |
|       from small pool |       0    |    3180    |   16720 K  |   16720 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8458 MiB | 351620 GiB | 351620 GiB |
|       from large pool |  16640 KiB |   8414 MiB | 346041 GiB | 346041 GiB |
|       from small pool |      0 KiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8458 MiB | 351620 GiB | 351620 GiB |
|       from large pool |  16640 KiB |   8414 MiB | 346041 GiB | 346041 GiB |
|       from small pool |      0 KiB |     79 MiB |   5579 GiB |   5579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB | 351487 GiB | 351487 GiB |
|       from large pool |  16640 KiB |   8412 MiB | 345920 GiB | 345920 GiB |
|       from small pool |      0 KiB |     77 MiB |   5567 GiB |   5567 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    898 MiB |   9142 MiB |   9142 MiB |   8244 MiB |
|       from large pool |    842 MiB |   9058 MiB |   9058 MiB |   8216 MiB |
|       from small pool |     56 MiB |     84 MiB |     84 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1142 MiB | 212705 GiB | 212705 GiB |
|       from large pool |  30464 KiB |   1139 MiB | 207116 GiB | 207116 GiB |
|       from small pool |      0 KiB |     30 MiB |   5588 GiB |   5588 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7321    |   68993 K  |   68993 K  |
|       from large pool |       2    |     844    |   32633 K  |   32633 K  |
|       from small pool |       0    |    7158    |   36360 K  |   36360 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7321    |   68993 K  |   68993 K  |
|       from large pool |       2    |     844    |   32633 K  |   32633 K  |
|       from small pool |       0    |    7158    |   36360 K  |   36360 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     340    |     340    |     285    |
|       from large pool |      27    |     298    |     298    |     271    |
|       from small pool |      28    |      42    |      42    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3198    |   38091 K  |   38091 K  |
|       from large pool |       2    |     301    |   21371 K  |   21371 K  |
|       from small pool |       0    |    3180    |   16720 K  |   16720 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970

 Experiment start at: 2024-08-11 04:59:06.752923
before training, model accuracy: 0.5887424349784851
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88522977, 'precision': 0.88629484, 'recall': 0.8852515, 'specificity': 0.8852515, 'f1': 0.8851546, 'auroc': 0.95375866, 'binary_precision': 0.90678567, 'binary_recall': 0.8589456, 'binary_specificity': 0.9115574, 'binary_f1_score': 0.8822175}
confusion matrix:
       0      1
0  23149   2246
1   3588  21849
---- Validation: 
scalar performance:
{'acc': 0.76248324, 'precision': 0.5236846, 'recall': 0.67701054, 'specificity': 0.67701054, 'f1': 0.4867944, 'auroc': 0.7366272, 'binary_precision': 0.061081603, 'binary_recall': 0.587007, 'binary_specificity': 0.76701415, 'binary_f1_score': 0.11064947}
confusion matrix:
       0     1
0  12803  3889
1    178   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76543456, 'precision': 0.57220024, 'recall': 0.69598067, 'specificity': 0.69598067, 'f1': 0.5709455, 'auroc': 0.78274155, 'binary_precision': 0.18307087, 'binary_recall': 0.6142669, 'binary_specificity': 0.77769446, 'binary_f1_score': 0.2820746}
confusion matrix:
      0     1
0  7259  2075
1   292   465
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 05:18:53.404767,epoch time: 0:19:46.651844,used: 0:19:46.651844,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9236898, 'precision': 0.92701936, 'recall': 0.9237263, 'specificity': 0.9237263, 'f1': 0.9235451, 'auroc': 0.9737061, 'binary_precision': 0.96493274, 'binary_recall': 0.8794669, 'binary_specificity': 0.9679858, 'binary_f1_score': 0.9202196}
confusion matrix:
       0      1
0  24582    813
1   3066  22371
---- Validation: 
scalar performance:
{'acc': 0.9060912, 'precision': 0.5546353, 'recall': 0.6851206, 'specificity': 0.6851206, 'f1': 0.5726658, 'auroc': 0.78230035, 'binary_precision': 0.12444161, 'binary_recall': 0.4524362, 'binary_specificity': 0.91780496, 'binary_f1_score': 0.19519518}
confusion matrix:
       0     1
0  15320  1372
1    236   195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666138, 'precision': 0.62098086, 'recall': 0.7039392, 'specificity': 0.7039392, 'f1': 0.6455817, 'auroc': 0.8459703, 'binary_precision': 0.2842491, 'binary_recall': 0.5125495, 'binary_specificity': 0.8953289, 'binary_f1_score': 0.36569276}
confusion matrix:
      0    1
0  8357  977
1   369  388
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 05:37:39.977070,epoch time: 0:18:46.572303,used: 0:38:33.224147,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94369686, 'precision': 0.9447541, 'recall': 0.94371617, 'specificity': 0.94371617, 'f1': 0.9436651, 'auroc': 0.98215926, 'binary_precision': 0.96663636, 'binary_recall': 0.919209, 'binary_specificity': 0.96822333, 'binary_f1_score': 0.9423263}
confusion matrix:
       0      1
0  24589    807
1   2055  23381
---- Validation: 
scalar performance:
{'acc': 0.9043392, 'precision': 0.56470144, 'recall': 0.733948, 'specificity': 0.733948, 'f1': 0.5874588, 'auroc': 0.8127357, 'binary_precision': 0.14183976, 'binary_recall': 0.55452436, 'binary_specificity': 0.9133717, 'binary_f1_score': 0.22589792}
confusion matrix:
       0     1
0  15246  1446
1    192   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8805867, 'precision': 0.6555, 'recall': 0.77097183, 'specificity': 0.77097183, 'f1': 0.68978006, 'auroc': 0.8792128, 'binary_precision': 0.34225354, 'binary_recall': 0.64200795, 'binary_specificity': 0.8999357, 'binary_f1_score': 0.44648597}
confusion matrix:
      0    1
0  8400  934
1   271  486
new oracle model saved
early stop counter: 1
val acc:0.9043391942977905, best validation acc: 0.9060912132263184, corresponding to test acc:                         0.8666138052940369 / 0.8805866837501526
after epoch: 3,now: 2024-08-11 05:56:27.507166,epoch time: 0:18:47.530096,used: 0:57:20.754243,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94881177, 'precision': 0.9504326, 'recall': 0.9488367, 'specificity': 0.9488367, 'f1': 0.9487676, 'auroc': 0.9858166, 'binary_precision': 0.9776597, 'binary_recall': 0.9187011, 'binary_specificity': 0.97897226, 'binary_f1_score': 0.94726384}
confusion matrix:
       0      1
0  24861    534
1   2068  23369
---- Validation: 
scalar performance:
{'acc': 0.9347661, 'precision': 0.5907945, 'recall': 0.72695154, 'specificity': 0.72695154, 'f1': 0.6237518, 'auroc': 0.8223671, 'binary_precision': 0.19483986, 'binary_recall': 0.50812066, 'binary_specificity': 0.9457824, 'binary_f1_score': 0.28167206}
confusion matrix:
       0    1
0  15787  905
1    212  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8996135, 'precision': 0.6752029, 'recall': 0.75030315, 'specificity': 0.75030315, 'f1': 0.7033353, 'auroc': 0.88742924, 'binary_precision': 0.38632327, 'binary_recall': 0.5746367, 'binary_specificity': 0.9259696, 'binary_f1_score': 0.46202868}
confusion matrix:
      0    1
0  8643  691
1   322  435
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 06:15:19.815423,epoch time: 0:18:52.308257,used: 1:16:13.062500,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95378894, 'precision': 0.9550928, 'recall': 0.953809, 'specificity': 0.953809, 'f1': 0.9537573, 'auroc': 0.9876058, 'binary_precision': 0.97963935, 'binary_recall': 0.9269117, 'binary_specificity': 0.9807064, 'binary_f1_score': 0.9525464}
confusion matrix:
       0      1
0  24907    490
1   1859  23576
---- Validation: 
scalar performance:
{'acc': 0.9403142, 'precision': 0.6004442, 'recall': 0.73205745, 'specificity': 0.73205745, 'f1': 0.63536847, 'auroc': 0.83207357, 'binary_precision': 0.21393998, 'binary_recall': 0.512761, 'binary_specificity': 0.95135397, 'binary_f1_score': 0.30191258}
confusion matrix:
       0    1
0  15880  812
1    210  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9046675, 'precision': 0.68571794, 'recall': 0.7584975, 'specificity': 0.7584975, 'f1': 0.7137617, 'auroc': 0.8928025, 'binary_precision': 0.40622142, 'binary_recall': 0.58652574, 'binary_specificity': 0.9304693, 'binary_f1_score': 0.48}
confusion matrix:
      0    1
0  8685  649
1   313  444
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 06:34:04.336907,epoch time: 0:18:44.521484,used: 1:34:57.583984,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95733005, 'precision': 0.95843077, 'recall': 0.9573504, 'specificity': 0.9573504, 'f1': 0.95730567, 'auroc': 0.9899627, 'binary_precision': 0.98110163, 'binary_recall': 0.93269646, 'binary_specificity': 0.98200434, 'binary_f1_score': 0.95628685}
confusion matrix:
       0      1
0  24938    457
1   1712  23725
---- Validation: 
scalar performance:
{'acc': 0.93879575, 'precision': 0.6011056, 'recall': 0.74371016, 'specificity': 0.74371016, 'f1': 0.6374313, 'auroc': 0.8373477, 'binary_precision': 0.21461609, 'binary_recall': 0.53828305, 'binary_specificity': 0.94913733, 'binary_f1_score': 0.3068783}
confusion matrix:
       0    1
0  15843  849
1    199  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9003072, 'precision': 0.68428475, 'recall': 0.7840595, 'specificity': 0.7840595, 'f1': 0.7190836, 'auroc': 0.89812076, 'binary_precision': 0.39869812, 'binary_recall': 0.64729196, 'binary_specificity': 0.9208271, 'binary_f1_score': 0.49345413}
confusion matrix:
      0    1
0  8595  739
1   267  490
early stop counter: 1
val acc:0.9387957453727722, best validation acc: 0.9403141736984253, corresponding to test acc:                         0.9046674966812134 / 0.9046674966812134
after epoch: 6,now: 2024-08-11 06:52:46.220235,epoch time: 0:18:41.883328,used: 1:53:39.467312,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96024156, 'precision': 0.961035, 'recall': 0.9602605, 'specificity': 0.9602605, 'f1': 0.9602256, 'auroc': 0.9910238, 'binary_precision': 0.98038894, 'binary_recall': 0.9393451, 'binary_specificity': 0.9811759, 'binary_f1_score': 0.9594283}
confusion matrix:
       0      1
0  24915    478
1   1543  23896
---- Validation: 
scalar performance:
{'acc': 0.939847, 'precision': 0.6035185, 'recall': 0.7465097, 'specificity': 0.7465097, 'f1': 0.6404821, 'auroc': 0.8449749, 'binary_precision': 0.21930647, 'binary_recall': 0.54292345, 'binary_specificity': 0.95009583, 'binary_f1_score': 0.31241655}
confusion matrix:
       0    1
0  15859  833
1    197  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9046675, 'precision': 0.6910025, 'recall': 0.78277487, 'specificity': 0.78277487, 'f1': 0.7244239, 'auroc': 0.8990619, 'binary_precision': 0.4126172, 'binary_recall': 0.6393659, 'binary_specificity': 0.9261838, 'binary_f1_score': 0.50155437}
confusion matrix:
      0    1
0  8645  689
1   273  484
early stop counter: 2
val acc:0.9398469924926758, best validation acc: 0.9403141736984253, corresponding to test acc:                         0.9046674966812134 / 0.9046674966812134
after epoch: 7,now: 2024-08-11 07:11:37.866157,epoch time: 0:18:51.645922,used: 2:12:31.113234,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9652581, 'precision': 0.9657701, 'recall': 0.9652713, 'specificity': 0.9652713, 'f1': 0.96524924, 'auroc': 0.99298453, 'binary_precision': 0.9814107, 'binary_recall': 0.9485375, 'binary_specificity': 0.98200506, 'binary_f1_score': 0.96469414}
confusion matrix:
       0      1
0  24939    457
1   1309  24127
---- Validation: 
scalar performance:
{'acc': 0.9458623, 'precision': 0.6158656, 'recall': 0.75185525, 'specificity': 0.75185525, 'f1': 0.65458107, 'auroc': 0.851938, 'binary_precision': 0.24380165, 'binary_recall': 0.5475638, 'binary_specificity': 0.95614666, 'binary_f1_score': 0.33738384}
confusion matrix:
       0    1
0  15960  732
1    195  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9090279, 'precision': 0.6971237, 'recall': 0.774814, 'specificity': 0.774814, 'f1': 0.72711885, 'auroc': 0.90104544, 'binary_precision': 0.42648402, 'binary_recall': 0.61690885, 'binary_specificity': 0.9327191, 'binary_f1_score': 0.5043196}
confusion matrix:
      0    1
0  8706  628
1   290  467
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-11 07:30:34.353716,epoch time: 0:18:56.487559,used: 2:31:27.600793,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96567124, 'precision': 0.9666219, 'recall': 0.96569, 'specificity': 0.96569, 'f1': 0.96565473, 'auroc': 0.99346775, 'binary_precision': 0.98789126, 'binary_recall': 0.9429571, 'binary_specificity': 0.98842293, 'binary_f1_score': 0.9649013}
confusion matrix:
       0      1
0  25101    294
1   1451  23986
---- Validation: 
scalar performance:
{'acc': 0.95117676, 'precision': 0.6236964, 'recall': 0.73649883, 'specificity': 0.73649883, 'f1': 0.6597356, 'auroc': 0.8487825, 'binary_precision': 0.26035503, 'binary_recall': 0.5104408, 'binary_specificity': 0.9625569, 'binary_f1_score': 0.34482756}
confusion matrix:
       0    1
0  16067  625
1    211  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91428006, 'precision': 0.70557857, 'recall': 0.7630867, 'specificity': 0.7630867, 'f1': 0.72953236, 'auroc': 0.8974671, 'binary_precision': 0.44567403, 'binary_recall': 0.5852048, 'binary_specificity': 0.9409685, 'binary_f1_score': 0.5059966}
confusion matrix:
      0    1
0  8783  551
1   314  443
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-11 07:49:27.505919,epoch time: 0:18:53.152203,used: 2:50:20.752996,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9672844, 'precision': 0.9680354, 'recall': 0.96729946, 'specificity': 0.96729946, 'f1': 0.96727204, 'auroc': 0.99374974, 'binary_precision': 0.9869715, 'binary_recall': 0.94712013, 'binary_specificity': 0.98747885, 'binary_f1_score': 0.9666353}
confusion matrix:
       0      1
0  25079    318
1   1345  24090
---- Validation: 
scalar performance:
{'acc': 0.9527536, 'precision': 0.6325398, 'recall': 0.7542597, 'specificity': 0.7542597, 'f1': 0.6714674, 'auroc': 0.8621429, 'binary_precision': 0.27712265, 'binary_recall': 0.5452436, 'binary_specificity': 0.96327585, 'binary_f1_score': 0.36747462}
confusion matrix:
       0    1
0  16079  613
1    196  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9120008, 'precision': 0.7040547, 'recall': 0.78127646, 'specificity': 0.78127646, 'f1': 0.73422897, 'auroc': 0.90529734, 'binary_precision': 0.43940794, 'binary_recall': 0.6274769, 'binary_specificity': 0.93507606, 'binary_f1_score': 0.5168662}
confusion matrix:
      0    1
0  8728  606
1   282  475
better model found
persisted
after epoch: 10,now: 2024-08-11 08:08:35.993758,epoch time: 0:19:08.487839,used: 3:09:29.240835,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9699205, 'precision': 0.9702493, 'recall': 0.9699305, 'specificity': 0.9699305, 'f1': 0.9699156, 'auroc': 0.9946301, 'binary_precision': 0.9828715, 'binary_recall': 0.9565559, 'binary_specificity': 0.9833051, 'binary_f1_score': 0.9695351}
confusion matrix:
       0      1
0  24973    424
1   1105  24330
---- Validation: 
scalar performance:
{'acc': 0.93716055, 'precision': 0.6029514, 'recall': 0.76095366, 'specificity': 0.76095366, 'f1': 0.6412951, 'auroc': 0.85692424, 'binary_precision': 0.2173532, 'binary_recall': 0.575406, 'binary_specificity': 0.9465013, 'binary_f1_score': 0.31552166}
confusion matrix:
       0    1
0  15799  893
1    183  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91120803, 'precision': 0.70264775, 'recall': 0.7820618, 'specificity': 0.7820618, 'f1': 0.7333997, 'auroc': 0.8997929, 'binary_precision': 0.43641353, 'binary_recall': 0.6301189, 'binary_specificity': 0.9340047, 'binary_f1_score': 0.51567566}
confusion matrix:
      0    1
0  8718  616
1   280  477
early stop counter: 1
val acc:0.9371605515480042, best validation acc: 0.9527536034584045, corresponding to test acc:                         0.9120007753372192 / 0.9142800569534302
after epoch: 11,now: 2024-08-11 08:27:35.538186,epoch time: 0:18:59.544428,used: 3:28:28.785263,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97190744, 'precision': 0.9722264, 'recall': 0.9719178, 'specificity': 0.9719178, 'f1': 0.97190315, 'auroc': 0.99477446, 'binary_precision': 0.98469675, 'binary_recall': 0.95875925, 'binary_specificity': 0.98507637, 'binary_f1_score': 0.97155493}
confusion matrix:
       0      1
0  25017    379
1   1049  24387
---- Validation: 
scalar performance:
{'acc': 0.91964024, 'precision': 0.587708, 'recall': 0.7858715, 'specificity': 0.7858715, 'f1': 0.6226013, 'auroc': 0.865229, 'binary_precision': 0.18520986, 'binary_recall': 0.6450116, 'binary_specificity': 0.92673135, 'binary_f1_score': 0.28778467}
confusion matrix:
       0     1
0  15469  1223
1    153   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90258646, 'precision': 0.69305265, 'recall': 0.808962, 'specificity': 0.808962, 'f1': 0.73209333, 'auroc': 0.90292454, 'binary_precision': 0.41199377, 'binary_recall': 0.6988111, 'binary_specificity': 0.9191129, 'binary_f1_score': 0.5183733}
confusion matrix:
      0    1
0  8579  755
1   228  529
early stop counter: 2
val acc:0.9196402430534363, best validation acc: 0.9527536034584045, corresponding to test acc:                         0.9120007753372192 / 0.9142800569534302
after epoch: 12,now: 2024-08-11 08:46:41.184735,epoch time: 0:19:05.646549,used: 3:47:34.431812,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97176975, 'precision': 0.97202194, 'recall': 0.971779, 'specificity': 0.971779, 'f1': 0.9717663, 'auroc': 0.9951794, 'binary_precision': 0.98313135, 'binary_recall': 0.9600566, 'binary_specificity': 0.9835013, 'binary_f1_score': 0.97145694}
confusion matrix:
       0      1
0  24977    419
1   1016  24420
---- Validation: 
scalar performance:
{'acc': 0.92740756, 'precision': 0.59372985, 'recall': 0.77629375, 'specificity': 0.77629375, 'f1': 0.630719, 'auroc': 0.86648005, 'binary_precision': 0.19791667, 'binary_recall': 0.6171694, 'binary_specificity': 0.9354182, 'binary_f1_score': 0.29971832}
confusion matrix:
       0     1
0  15614  1078
1    165   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9042711, 'precision': 0.6957226, 'recall': 0.80926573, 'specificity': 0.80926573, 'f1': 0.7345307, 'auroc': 0.90172005, 'binary_precision': 0.4173913, 'binary_recall': 0.6974901, 'binary_specificity': 0.92104137, 'binary_f1_score': 0.52225524}
confusion matrix:
      0    1
0  8597  737
1   229  528
early stop counter: 3
val acc:0.9274075627326965, best validation acc: 0.9527536034584045, corresponding to test acc:                         0.9120007753372192 / 0.9142800569534302
after epoch: 13,now: 2024-08-11 09:05:46.035759,epoch time: 0:19:04.851024,used: 4:06:39.282836,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97369766, 'precision': 0.97403, 'recall': 0.97370875, 'specificity': 0.97370875, 'f1': 0.9736935, 'auroc': 0.9953419, 'binary_precision': 0.98679, 'binary_recall': 0.96029407, 'binary_specificity': 0.9871234, 'binary_f1_score': 0.9733618}
confusion matrix:
       0      1
0  25068    327
1   1010  24427
---- Validation: 
scalar performance:
{'acc': 0.92740756, 'precision': 0.5944943, 'recall': 0.7796842, 'specificity': 0.7796842, 'f1': 0.631895, 'auroc': 0.8659706, 'binary_precision': 0.19925927, 'binary_recall': 0.62412995, 'binary_specificity': 0.9352384, 'binary_f1_score': 0.3020775}
confusion matrix:
       0     1
0  15611  1081
1    162   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9056585, 'precision': 0.6954841, 'recall': 0.7966631, 'specificity': 0.7966631, 'f1': 0.73150945, 'auroc': 0.90026355, 'binary_precision': 0.41922122, 'binary_recall': 0.668428, 'binary_specificity': 0.9248982, 'binary_f1_score': 0.51527494}
confusion matrix:
      0    1
0  8633  701
1   251  506
early stop counter: 4
val acc:0.9274075627326965, best validation acc: 0.9527536034584045, corresponding to test acc:                         0.9120007753372192 / 0.9142800569534302
after epoch: 14,now: 2024-08-11 09:24:44.967938,epoch time: 0:18:58.932179,used: 4:25:38.215015,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9727534, 'precision': 0.973279, 'recall': 0.9727673, 'specificity': 0.9727673, 'f1': 0.9727464, 'auroc': 0.9957758, 'binary_precision': 0.98925954, 'binary_recall': 0.95593035, 'binary_specificity': 0.98960423, 'binary_f1_score': 0.97230935}
confusion matrix:
       0      1
0  25131    264
1   1121  24316
---- Validation: 
scalar performance:
{'acc': 0.93202126, 'precision': 0.5986274, 'recall': 0.7730095, 'specificity': 0.7730095, 'f1': 0.6369296, 'auroc': 0.86554635, 'binary_precision': 0.20796813, 'binary_recall': 0.60556847, 'binary_specificity': 0.9404505, 'binary_f1_score': 0.30960855}
confusion matrix:
       0    1
0  15698  994
1    170  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9058567, 'precision': 0.697021, 'recall': 0.80283964, 'specificity': 0.80283964, 'f1': 0.73424417, 'auroc': 0.90097773, 'binary_precision': 0.42122447, 'binary_recall': 0.68163806, 'binary_specificity': 0.92404115, 'binary_f1_score': 0.52068615}
confusion matrix:
      0    1
0  8625  709
1   241  516
early stop counter: 5
val acc:0.9320212602615356, best validation acc: 0.9527536034584045, corresponding to test acc:                         0.9120007753372192 / 0.9142800569534302
after epoch: 15,now: 2024-08-11 09:43:47.422044,epoch time: 0:19:02.454106,used: 4:44:40.669121,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_04_59_05_seed_1_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:44:40.669121 at 2024-08-11 09:43:47.422044
persisted model performance metric: 

scalar performance:
{'acc': 0.9120008, 'precision': 0.7040547, 'recall': 0.78127646, 'specificity': 0.78127646, 'f1': 0.73422897, 'auroc': 0.90529734, 'binary_precision': 0.43940794, 'binary_recall': 0.6274769, 'binary_specificity': 0.93507606, 'binary_f1_score': 0.5168662}
confusion matrix:
      0    1
0  8728  606
1   282  475
oracle model performance metric: 

scalar performance:
{'acc': 0.91428006, 'precision': 0.70557857, 'recall': 0.7630867, 'specificity': 0.7630867, 'f1': 0.72953236, 'auroc': 0.8974671, 'binary_precision': 0.44567403, 'binary_recall': 0.5852048, 'binary_specificity': 0.9409685, 'binary_f1_score': 0.5059966}
confusion matrix:
      0    1
0  8783  551
1   314  443
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    823 MiB |   8459 MiB | 708179 GiB | 708178 GiB |
|       from large pool |    785 MiB |   8416 MiB | 696972 GiB | 696971 GiB |
|       from small pool |     38 MiB |     79 MiB |  11207 GiB |  11207 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    823 MiB |   8459 MiB | 708179 GiB | 708178 GiB |
|       from large pool |    785 MiB |   8416 MiB | 696972 GiB | 696971 GiB |
|       from small pool |     38 MiB |     79 MiB |  11207 GiB |  11207 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    819 MiB |   8455 MiB | 707936 GiB | 707936 GiB |
|       from large pool |    782 MiB |   8412 MiB | 696753 GiB | 696752 GiB |
|       from small pool |     36 MiB |     77 MiB |  11183 GiB |  11183 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9116 MiB |   9142 MiB |  17360 MiB |   8244 MiB |
|       from large pool |   9036 MiB |   9058 MiB |  17252 MiB |   8216 MiB |
|       from small pool |     80 MiB |     84 MiB |    108 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 252307 KiB |   1142 MiB | 430003 GiB | 430003 GiB |
|       from large pool | 238456 KiB |   1139 MiB | 418777 GiB | 418777 GiB |
|       from small pool |  13850 KiB |     30 MiB |  11225 GiB |  11225 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7343    |  138629 K  |  138624 K  |
|       from large pool |     161    |     844    |   65712 K  |   65712 K  |
|       from small pool |    4745    |    7180    |   72917 K  |   72912 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7343    |  138629 K  |  138624 K  |
|       from large pool |     161    |     844    |   65712 K  |   65712 K  |
|       from small pool |    4745    |    7180    |   72917 K  |   72912 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     336    |     340    |     621    |     285    |
|       from large pool |     296    |     298    |     567    |     271    |
|       from small pool |      40    |      42    |      54    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3209    |   75190 K  |   75190 K  |
|       from large pool |      18    |     301    |   42205 K  |   42205 K  |
|       from small pool |      50    |    3192    |   32984 K  |   32984 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8459 MiB | 708179 GiB | 708179 GiB |
|       from large pool |  16640 KiB |   8416 MiB | 696972 GiB | 696972 GiB |
|       from small pool |      0 KiB |     79 MiB |  11207 GiB |  11207 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8459 MiB | 708179 GiB | 708179 GiB |
|       from large pool |  16640 KiB |   8416 MiB | 696972 GiB | 696972 GiB |
|       from small pool |      0 KiB |     79 MiB |  11207 GiB |  11207 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB | 707936 GiB | 707936 GiB |
|       from large pool |  16640 KiB |   8412 MiB | 696753 GiB | 696753 GiB |
|       from small pool |      0 KiB |     77 MiB |  11183 GiB |  11183 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1070 MiB |   9142 MiB |  17360 MiB |  16290 MiB |
|       from large pool |   1018 MiB |   9058 MiB |  17252 MiB |  16234 MiB |
|       from small pool |     52 MiB |     84 MiB |    108 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1142 MiB | 430003 GiB | 430003 GiB |
|       from large pool |  30464 KiB |   1139 MiB | 418777 GiB | 418777 GiB |
|       from small pool |      0 KiB |     31 MiB |  11225 GiB |  11225 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138629 K  |  138629 K  |
|       from large pool |       2    |     844    |   65712 K  |   65712 K  |
|       from small pool |       0    |    7180    |   72917 K  |   72917 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138629 K  |  138629 K  |
|       from large pool |       2    |     844    |   65712 K  |   65712 K  |
|       from small pool |       0    |    7180    |   72917 K  |   72917 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     340    |     621    |     568    |
|       from large pool |      27    |     298    |     567    |     540    |
|       from small pool |      26    |      42    |      54    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3209    |   75192 K  |   75192 K  |
|       from large pool |       2    |     301    |   42205 K  |   42205 K  |
|       from small pool |       0    |    3192    |   32986 K  |   32986 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8459 MiB | 708179 GiB | 708179 GiB |
|       from large pool |  16640 KiB |   8416 MiB | 696972 GiB | 696972 GiB |
|       from small pool |      0 KiB |     79 MiB |  11207 GiB |  11207 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8459 MiB | 708179 GiB | 708179 GiB |
|       from large pool |  16640 KiB |   8416 MiB | 696972 GiB | 696972 GiB |
|       from small pool |      0 KiB |     79 MiB |  11207 GiB |  11207 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB | 707936 GiB | 707936 GiB |
|       from large pool |  16640 KiB |   8412 MiB | 696753 GiB | 696753 GiB |
|       from small pool |      0 KiB |     77 MiB |  11183 GiB |  11183 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1070 MiB |   9142 MiB |  17360 MiB |  16290 MiB |
|       from large pool |   1018 MiB |   9058 MiB |  17252 MiB |  16234 MiB |
|       from small pool |     52 MiB |     84 MiB |    108 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1142 MiB | 430003 GiB | 430003 GiB |
|       from large pool |  30464 KiB |   1139 MiB | 418777 GiB | 418777 GiB |
|       from small pool |      0 KiB |     31 MiB |  11225 GiB |  11225 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7343    |  138629 K  |  138629 K  |
|       from large pool |       2    |     844    |   65712 K  |   65712 K  |
|       from small pool |       0    |    7180    |   72917 K  |   72917 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7343    |  138629 K  |  138629 K  |
|       from large pool |       2    |     844    |   65712 K  |   65712 K  |
|       from small pool |       0    |    7180    |   72917 K  |   72917 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     340    |     621    |     568    |
|       from large pool |      27    |     298    |     567    |     540    |
|       from small pool |      26    |      42    |      54    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3209    |   75192 K  |   75192 K  |
|       from large pool |       2    |     301    |   42205 K  |   42205 K  |
|       from small pool |       0    |    3192    |   32986 K  |   32986 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970

 Experiment start at: 2024-08-11 09:52:54.687073
before training, model accuracy: 0.8981371521949768
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88741875, 'precision': 0.8895271, 'recall': 0.8874202, 'specificity': 0.8874202, 'f1': 0.88726646, 'auroc': 0.9539956, 'binary_precision': 0.91819435, 'binary_recall': 0.85063255, 'binary_specificity': 0.92420787, 'binary_f1_score': 0.8831231}
confusion matrix:
       0      1
0  23888   1959
1   3861  21988
---- Validation: 
scalar performance:
{'acc': 0.88851905, 'precision': 0.5148194, 'recall': 0.55450594, 'specificity': 0.55450594, 'f1': 0.5112136, 'auroc': 0.68200713, 'binary_precision': 0.051173992, 'binary_recall': 0.20334928, 'binary_specificity': 0.90566266, 'binary_f1_score': 0.08177008}
confusion matrix:
       0     1
0  15130  1576
1    333    85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85840267, 'precision': 0.5178498, 'recall': 0.5181972, 'specificity': 0.5181972, 'f1': 0.5180168, 'auroc': 0.7421849, 'binary_precision': 0.111793615, 'binary_recall': 0.114178166, 'binary_specificity': 0.92221624, 'binary_f1_score': 0.1129733}
confusion matrix:
      0    1
0  8572  723
1   706   91
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 10:13:24.898096,epoch time: 0:20:30.211023,used: 0:20:30.211023,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92353374, 'precision': 0.9261346, 'recall': 0.92353976, 'specificity': 0.92353976, 'f1': 0.92341757, 'auroc': 0.97319174, 'binary_precision': 0.95946455, 'binary_recall': 0.8844577, 'binary_specificity': 0.96262187, 'binary_f1_score': 0.92043555}
confusion matrix:
       0      1
0  24878    966
1   2987  22865
---- Validation: 
scalar performance:
{'acc': 0.92857975, 'precision': 0.55012476, 'recall': 0.62168723, 'specificity': 0.62168723, 'f1': 0.5662033, 'auroc': 0.7712908, 'binary_precision': 0.11848341, 'binary_recall': 0.29904306, 'binary_specificity': 0.9443314, 'binary_f1_score': 0.16972165}
confusion matrix:
       0    1
0  15776  930
1    293  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90418154, 'precision': 0.64378166, 'recall': 0.60499376, 'specificity': 0.60499376, 'f1': 0.62009543, 'auroc': 0.8385867, 'binary_precision': 0.3503521, 'binary_recall': 0.24968633, 'binary_specificity': 0.9603012, 'binary_f1_score': 0.2915751}
confusion matrix:
      0    1
0  8926  369
1   598  199
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 10:32:54.583625,epoch time: 0:19:29.685529,used: 0:39:59.896552,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9379449, 'precision': 0.9403856, 'recall': 0.9379507, 'specificity': 0.9379507, 'f1': 0.9378594, 'auroc': 0.98042864, 'binary_precision': 0.9732091, 'binary_recall': 0.900704, 'binary_specificity': 0.9751973, 'binary_f1_score': 0.9355539}
confusion matrix:
       0      1
0  25203    641
1   2567  23285
---- Validation: 
scalar performance:
{'acc': 0.93891615, 'precision': 0.5748843, 'recall': 0.6631383, 'specificity': 0.6631383, 'f1': 0.5989733, 'auroc': 0.8199675, 'binary_precision': 0.16595745, 'binary_recall': 0.37320575, 'binary_specificity': 0.95307076, 'binary_f1_score': 0.22974962}
confusion matrix:
       0    1
0  15922  784
1    262  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.914784, 'precision': 0.6986772, 'recall': 0.66294354, 'specificity': 0.66294354, 'f1': 0.6784482, 'auroc': 0.8788632, 'binary_precision': 0.45101088, 'binary_recall': 0.36386448, 'binary_specificity': 0.9620226, 'binary_f1_score': 0.4027778}
confusion matrix:
      0    1
0  8942  353
1   507  290
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 10:52:29.848280,epoch time: 0:19:35.264655,used: 0:59:35.161207,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9484486, 'precision': 0.94979316, 'recall': 0.94845283, 'specificity': 0.94845283, 'f1': 0.9484104, 'auroc': 0.986161, 'binary_precision': 0.974424, 'binary_recall': 0.9210893, 'binary_specificity': 0.9758164, 'binary_f1_score': 0.9470063}
confusion matrix:
       0      1
0  25219    625
1   2040  23812
---- Validation: 
scalar performance:
{'acc': 0.9445223, 'precision': 0.5960792, 'recall': 0.702165, 'specificity': 0.702165, 'f1': 0.6268115, 'auroc': 0.8411157, 'binary_precision': 0.20640177, 'binary_recall': 0.4473684, 'binary_specificity': 0.9569616, 'binary_f1_score': 0.28247732}
confusion matrix:
       0    1
0  15987  719
1    231  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91696393, 'precision': 0.71243715, 'recall': 0.6996877, 'specificity': 0.6996877, 'f1': 0.70579886, 'auroc': 0.8920311, 'binary_precision': 0.47248322, 'binary_recall': 0.4416562, 'binary_specificity': 0.9577192, 'binary_f1_score': 0.45654994}
confusion matrix:
      0    1
0  8902  393
1   445  352
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 11:12:06.974515,epoch time: 0:19:37.126235,used: 1:19:12.287442,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95268494, 'precision': 0.9542919, 'recall': 0.9526918, 'specificity': 0.9526918, 'f1': 0.9526436, 'auroc': 0.98840785, 'binary_precision': 0.9813688, 'binary_recall': 0.92291325, 'binary_specificity': 0.9824704, 'binary_f1_score': 0.9512438}
confusion matrix:
       0      1
0  25389    453
1   1993  23861
---- Validation: 
scalar performance:
{'acc': 0.9492525, 'precision': 0.6101251, 'recall': 0.71741796, 'specificity': 0.71741796, 'f1': 0.6433483, 'auroc': 0.8527769, 'binary_precision': 0.23376623, 'binary_recall': 0.47368422, 'binary_specificity': 0.96115166, 'binary_f1_score': 0.31304348}
confusion matrix:
       0    1
0  16057  649
1    220  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.919243, 'precision': 0.7206084, 'recall': 0.706087, 'specificity': 0.706087, 'f1': 0.7130198, 'auroc': 0.8956153, 'binary_precision': 0.48783785, 'binary_recall': 0.45294857, 'binary_specificity': 0.9592254, 'binary_f1_score': 0.4697463}
confusion matrix:
      0    1
0  8916  379
1   436  361
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 11:31:33.128451,epoch time: 0:19:26.153936,used: 1:38:38.441378,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9582753, 'precision': 0.9588286, 'recall': 0.95827734, 'specificity': 0.95827734, 'f1': 0.9582628, 'auroc': 0.9901861, 'binary_precision': 0.9747916, 'binary_recall': 0.94089204, 'binary_specificity': 0.9756626, 'binary_f1_score': 0.9575418}
confusion matrix:
       0      1
0  25216    629
1   1528  24323
---- Validation: 
scalar performance:
{'acc': 0.9399089, 'precision': 0.59880924, 'recall': 0.73945284, 'specificity': 0.73945284, 'f1': 0.6345409, 'auroc': 0.85705936, 'binary_precision': 0.20987654, 'binary_recall': 0.52870816, 'binary_specificity': 0.9501975, 'binary_f1_score': 0.30047587}
confusion matrix:
       0    1
0  15874  832
1    197  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91696393, 'precision': 0.71865857, 'recall': 0.7444254, 'specificity': 0.7444254, 'f1': 0.7305733, 'auroc': 0.89875543, 'binary_precision': 0.4772475, 'binary_recall': 0.5395232, 'binary_specificity': 0.9493276, 'binary_f1_score': 0.5064782}
confusion matrix:
      0    1
0  8824  471
1   367  430
early stop counter: 1
val acc:0.9399089217185974, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 6,now: 2024-08-11 11:51:02.501881,epoch time: 0:19:29.373430,used: 1:58:07.814808,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9596487, 'precision': 0.96042234, 'recall': 0.9596495, 'specificity': 0.9596495, 'f1': 0.9596318, 'auroc': 0.9909035, 'binary_precision': 0.9793053, 'binary_recall': 0.9391466, 'binary_specificity': 0.9801524, 'binary_f1_score': 0.9588056}
confusion matrix:
       0      1
0  25334    513
1   1573  24276
---- Validation: 
scalar performance:
{'acc': 0.9421864, 'precision': 0.60347486, 'recall': 0.7429526, 'specificity': 0.7429526, 'f1': 0.6402065, 'auroc': 0.8644171, 'binary_precision': 0.21905698, 'binary_recall': 0.5334928, 'binary_specificity': 0.9524123, 'binary_f1_score': 0.31058496}
confusion matrix:
       0    1
0  15911  795
1    195  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9168649, 'precision': 0.71716547, 'recall': 0.7351947, 'specificity': 0.7351947, 'f1': 0.7256955, 'auroc': 0.8958417, 'binary_precision': 0.47586206, 'binary_recall': 0.5194479, 'binary_specificity': 0.9509414, 'binary_f1_score': 0.49670067}
confusion matrix:
      0    1
0  8839  456
1   383  414
early stop counter: 2
val acc:0.9421864151954651, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 7,now: 2024-08-11 12:10:31.828928,epoch time: 0:19:29.327047,used: 2:17:37.141855,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9637496, 'precision': 0.96443665, 'recall': 0.9637526, 'specificity': 0.9637526, 'f1': 0.96373636, 'auroc': 0.9924716, 'binary_precision': 0.98233825, 'binary_recall': 0.94449174, 'binary_specificity': 0.98301345, 'binary_f1_score': 0.9630433}
confusion matrix:
       0      1
0  25405    439
1   1435  24417
---- Validation: 
scalar performance:
{'acc': 0.9328428, 'precision': 0.5936961, 'recall': 0.7591562, 'specificity': 0.7591562, 'f1': 0.6300422, 'auroc': 0.8673843, 'binary_precision': 0.1985173, 'binary_recall': 0.576555, 'binary_specificity': 0.94175744, 'binary_f1_score': 0.29534313}
confusion matrix:
       0    1
0  15733  973
1    177  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9145858, 'precision': 0.71337634, 'recall': 0.74944353, 'specificity': 0.74944353, 'f1': 0.72949386, 'auroc': 0.8936417, 'binary_precision': 0.4656811, 'binary_recall': 0.553325, 'binary_specificity': 0.9455621, 'binary_f1_score': 0.50573397}
confusion matrix:
      0    1
0  8789  506
1   356  441
early stop counter: 3
val acc:0.9328427910804749, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 8,now: 2024-08-11 12:30:06.924633,epoch time: 0:19:35.095705,used: 2:37:12.237560,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9672315, 'precision': 0.96753097, 'recall': 0.9672334, 'specificity': 0.9672334, 'f1': 0.9672264, 'auroc': 0.99359035, 'binary_precision': 0.97940147, 'binary_recall': 0.95454895, 'binary_specificity': 0.97991794, 'binary_f1_score': 0.96681553}
confusion matrix:
       0      1
0  25325    519
1   1175  24677
---- Validation: 
scalar performance:
{'acc': 0.92425835, 'precision': 0.5876436, 'recall': 0.77574897, 'specificity': 0.77574897, 'f1': 0.6227046, 'auroc': 0.8732798, 'binary_precision': 0.18539728, 'binary_recall': 0.6196172, 'binary_specificity': 0.9318808, 'binary_f1_score': 0.28539944}
confusion matrix:
       0     1
0  15568  1138
1    159   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91200954, 'precision': 0.7111, 'recall': 0.7721345, 'specificity': 0.7721345, 'f1': 0.7362952, 'auroc': 0.89443046, 'binary_precision': 0.45695364, 'binary_recall': 0.6060226, 'binary_specificity': 0.93824637, 'binary_f1_score': 0.5210356}
confusion matrix:
      0    1
0  8721  574
1   314  483
early stop counter: 4
val acc:0.9242583513259888, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 9,now: 2024-08-11 12:49:34.060362,epoch time: 0:19:27.135729,used: 2:56:39.373289,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9666512, 'precision': 0.9673685, 'recall': 0.96665347, 'specificity': 0.96665347, 'f1': 0.9666385, 'auroc': 0.9937775, 'binary_precision': 0.9857068, 'binary_recall': 0.94704264, 'binary_specificity': 0.9862643, 'binary_f1_score': 0.965988}
confusion matrix:
       0      1
0  25490    355
1   1369  24482
---- Validation: 
scalar performance:
{'acc': 0.9364634, 'precision': 0.5979206, 'recall': 0.75634694, 'specificity': 0.75634694, 'f1': 0.63508534, 'auroc': 0.86697614, 'binary_precision': 0.20716783, 'binary_recall': 0.56698567, 'binary_specificity': 0.94570816, 'binary_f1_score': 0.3034571}
confusion matrix:
       0    1
0  15799  907
1    181  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91607213, 'precision': 0.714567, 'recall': 0.7318965, 'specificity': 0.7318965, 'f1': 0.72277725, 'auroc': 0.89018685, 'binary_precision': 0.47119817, 'binary_recall': 0.5131744, 'binary_specificity': 0.9506186, 'binary_f1_score': 0.49129128}
confusion matrix:
      0    1
0  8836  459
1   388  409
early stop counter: 5
val acc:0.9364634156227112, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 10,now: 2024-08-11 13:08:54.336725,epoch time: 0:19:20.276363,used: 3:15:59.649652,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9698816, 'precision': 0.9702457, 'recall': 0.96988595, 'specificity': 0.96988595, 'f1': 0.969876, 'auroc': 0.9948614, 'binary_precision': 0.9834083, 'binary_recall': 0.95590967, 'binary_specificity': 0.9838622, 'binary_f1_score': 0.969464}
confusion matrix:
       0      1
0  25423    417
1   1140  24716
---- Validation: 
scalar performance:
{'acc': 0.9204625, 'precision': 0.5829959, 'recall': 0.7714711, 'specificity': 0.7714711, 'f1': 0.6159569, 'auroc': 0.8710942, 'binary_precision': 0.17626886, 'binary_recall': 0.6148325, 'binary_specificity': 0.92810965, 'binary_f1_score': 0.2739872}
confusion matrix:
       0     1
0  15505  1201
1    161   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91220766, 'precision': 0.70996267, 'recall': 0.7624915, 'specificity': 0.7624915, 'f1': 0.732205, 'auroc': 0.88646704, 'binary_precision': 0.45641527, 'binary_recall': 0.5846926, 'binary_specificity': 0.94029045, 'binary_f1_score': 0.51265126}
confusion matrix:
      0    1
0  8740  555
1   331  466
early stop counter: 6
val acc:0.9204624891281128, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 11,now: 2024-08-11 13:28:22.644941,epoch time: 0:19:28.308216,used: 3:35:27.957868,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9703072, 'precision': 0.9707657, 'recall': 0.9703102, 'specificity': 0.9703102, 'f1': 0.9703001, 'auroc': 0.9951855, 'binary_precision': 0.9855055, 'binary_recall': 0.9546668, 'binary_specificity': 0.9859536, 'binary_f1_score': 0.96984106}
confusion matrix:
       0      1
0  25480    363
1   1172  24681
---- Validation: 
scalar performance:
{'acc': 0.9226816, 'precision': 0.5843385, 'recall': 0.76794344, 'specificity': 0.76794344, 'f1': 0.61783063, 'auroc': 0.8702109, 'binary_precision': 0.17917848, 'binary_recall': 0.6052632, 'binary_specificity': 0.9306237, 'binary_f1_score': 0.27650273}
confusion matrix:
       0     1
0  15547  1159
1    165   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9131986, 'precision': 0.71032625, 'recall': 0.75098467, 'specificity': 0.75098467, 'f1': 0.7282008, 'auroc': 0.88292503, 'binary_precision': 0.45923632, 'binary_recall': 0.55834377, 'binary_specificity': 0.9436256, 'binary_f1_score': 0.50396377}
confusion matrix:
      0    1
0  8771  524
1   352  445
early stop counter: 7
val acc:0.9226816296577454, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 12,now: 2024-08-11 13:47:42.769877,epoch time: 0:19:20.124936,used: 3:54:48.082804,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9710423, 'precision': 0.9713774, 'recall': 0.9710464, 'specificity': 0.9710464, 'f1': 0.97103727, 'auroc': 0.9952184, 'binary_precision': 0.98402417, 'binary_recall': 0.95765007, 'binary_specificity': 0.9844427, 'binary_f1_score': 0.970658}
confusion matrix:
       0      1
0  25438    402
1   1095  24761
---- Validation: 
scalar performance:
{'acc': 0.9107685, 'precision': 0.57608986, 'recall': 0.776999, 'specificity': 0.776999, 'f1': 0.60539067, 'auroc': 0.8707793, 'binary_precision': 0.16199756, 'binary_recall': 0.6363636, 'binary_specificity': 0.91763437, 'binary_f1_score': 0.2582524}
confusion matrix:
       0     1
0  15330  1376
1    152   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.910325, 'precision': 0.70675814, 'recall': 0.7672051, 'specificity': 0.7672051, 'f1': 0.7316371, 'auroc': 0.8839519, 'binary_precision': 0.4490566, 'binary_recall': 0.5972397, 'binary_specificity': 0.9371705, 'binary_f1_score': 0.51265484}
confusion matrix:
      0    1
0  8711  584
1   321  476
early stop counter: 8
val acc:0.9107685089111328, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 13,now: 2024-08-11 14:07:01.517516,epoch time: 0:19:18.747639,used: 4:14:06.830443,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97231895, 'precision': 0.97240436, 'recall': 0.9723197, 'specificity': 0.9723197, 'f1': 0.9723177, 'auroc': 0.99576735, 'binary_precision': 0.978786, 'binary_recall': 0.96557194, 'binary_specificity': 0.9790675, 'binary_f1_score': 0.97213405}
confusion matrix:
       0      1
0  25304    541
1    890  24961
---- Validation: 
scalar performance:
{'acc': 0.87123334, 'precision': 0.55769104, 'recall': 0.78939164, 'specificity': 0.78939164, 'f1': 0.5702131, 'auroc': 0.8683392, 'binary_precision': 0.123789474, 'binary_recall': 0.7033493, 'binary_specificity': 0.875434, 'binary_f1_score': 0.21052632}
confusion matrix:
       0     1
0  14625  2081
1    124   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89575905, 'precision': 0.68732226, 'recall': 0.79485834, 'specificity': 0.79485834, 'f1': 0.72368795, 'auroc': 0.8840558, 'binary_precision': 0.40420735, 'binary_recall': 0.67503136, 'binary_specificity': 0.9146853, 'binary_f1_score': 0.5056391}
confusion matrix:
      0    1
0  8502  793
1   259  538
early stop counter: 9
val acc:0.871233344078064, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 14,now: 2024-08-11 14:26:34.249026,epoch time: 0:19:32.731510,used: 4:33:39.561953,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97210616, 'precision': 0.972766, 'recall': 0.9721098, 'specificity': 0.9721098, 'f1': 0.97209656, 'auroc': 0.9960414, 'binary_precision': 0.9904762, 'binary_recall': 0.9533903, 'binary_specificity': 0.9908292, 'binary_f1_score': 0.97157943}
confusion matrix:
       0      1
0  25606    237
1   1205  24648
---- Validation: 
scalar performance:
{'acc': 0.9274702, 'precision': 0.5863988, 'recall': 0.7552365, 'specificity': 0.7552365, 'f1': 0.6202804, 'auroc': 0.86718297, 'binary_precision': 0.18404908, 'binary_recall': 0.57416266, 'binary_specificity': 0.9363103, 'binary_f1_score': 0.27874565}
confusion matrix:
       0     1
0  15642  1064
1    178   240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9129013, 'precision': 0.7111873, 'recall': 0.76057386, 'specificity': 0.76057386, 'f1': 0.7323291, 'auroc': 0.88226485, 'binary_precision': 0.45924452, 'binary_recall': 0.57967377, 'binary_specificity': 0.9414739, 'binary_f1_score': 0.5124792}
confusion matrix:
      0    1
0  8751  544
1   335  462
early stop counter: 10
val acc:0.9274702072143555, best validation acc: 0.9492524862289429, corresponding to test acc:                         0.9192429780960083 / 0.9192429780960083
after epoch: 15,now: 2024-08-11 14:46:08.540981,epoch time: 0:19:34.291955,used: 4:53:13.853908,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_09_52_53_seed_2_24141970
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:53:13.853908 at 2024-08-11 14:46:08.540981
persisted model performance metric: 

scalar performance:
{'acc': 0.919243, 'precision': 0.7206084, 'recall': 0.706087, 'specificity': 0.706087, 'f1': 0.7130198, 'auroc': 0.8956153, 'binary_precision': 0.48783785, 'binary_recall': 0.45294857, 'binary_specificity': 0.9592254, 'binary_f1_score': 0.4697463}
confusion matrix:
      0    1
0  8916  379
1   436  361
oracle model performance metric: 

scalar performance:
{'acc': 0.919243, 'precision': 0.7206084, 'recall': 0.706087, 'specificity': 0.706087, 'f1': 0.7130198, 'auroc': 0.8956153, 'binary_precision': 0.48783785, 'binary_recall': 0.45294857, 'binary_specificity': 0.9592254, 'binary_f1_score': 0.4697463}
confusion matrix:
      0    1
0  8916  379
1   436  361
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    823 MiB |   8459 MiB |   1054 TiB |   1054 TiB |
|       from large pool |    785 MiB |   8416 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     38 MiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |    823 MiB |   8459 MiB |   1054 TiB |   1054 TiB |
|       from large pool |    785 MiB |   8416 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     38 MiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |    819 MiB |   8455 MiB |   1053 TiB |   1053 TiB |
|       from large pool |    782 MiB |   8412 MiB |   1037 TiB |   1037 TiB |
|       from small pool |     36 MiB |     77 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9096 MiB |   9142 MiB |  25386 MiB |  16290 MiB |
|       from large pool |   9016 MiB |   9058 MiB |  25250 MiB |  16234 MiB |
|       from small pool |     80 MiB |     84 MiB |    136 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 254355 KiB |   1180 MiB | 668573 GiB | 668573 GiB |
|       from large pool | 238456 KiB |   1178 MiB | 651541 GiB | 651541 GiB |
|       from small pool |  15898 KiB |     31 MiB |  17031 GiB |  17031 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4906    |    7451    |  210322 K  |  210317 K  |
|       from large pool |     161    |     844    |  100110 K  |  100110 K  |
|       from small pool |    4745    |    7288    |  110212 K  |  110207 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4906    |    7451    |  210322 K  |  210317 K  |
|       from large pool |     161    |     844    |  100110 K  |  100110 K  |
|       from small pool |    4745    |    7288    |  110212 K  |  110207 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     327    |     340    |     895    |     568    |
|       from large pool |     287    |     298    |     827    |     540    |
|       from small pool |      40    |      42    |      68    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3263    |  113700 K  |  113700 K  |
|       from large pool |      18    |     301    |   63985 K  |   63985 K  |
|       from small pool |      52    |    3246    |   49714 K  |   49714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8459 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8416 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8459 MiB |   1054 TiB |   1054 TiB |
|       from large pool |  16640 KiB |   8416 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     79 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8455 MiB |   1053 TiB |   1053 TiB |
|       from large pool |  16640 KiB |   8412 MiB |   1037 TiB |   1037 TiB |
|       from small pool |      0 KiB |     77 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1072 MiB |   9142 MiB |  25386 MiB |  24314 MiB |
|       from large pool |   1018 MiB |   9058 MiB |  25250 MiB |  24232 MiB |
|       from small pool |     54 MiB |     84 MiB |    136 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |   1180 MiB | 668573 GiB | 668573 GiB |
|       from large pool |  30464 KiB |   1178 MiB | 651541 GiB | 651541 GiB |
|       from small pool |      0 KiB |     31 MiB |  17031 GiB |  17031 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7451    |  210322 K  |  210322 K  |
|       from large pool |       2    |     844    |  100110 K  |  100110 K  |
|       from small pool |       0    |    7288    |  110212 K  |  110212 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7451    |  210322 K  |  210322 K  |
|       from large pool |       2    |     844    |  100110 K  |  100110 K  |
|       from small pool |       0    |    7288    |  110212 K  |  110212 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |     340    |     895    |     841    |
|       from large pool |      27    |     298    |     827    |     800    |
|       from small pool |      27    |      42    |      68    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3263    |  113702 K  |  113702 K  |
|       from large pool |       2    |     301    |   63986 K  |   63986 K  |
|       from small pool |       0    |    3246    |   49716 K  |   49716 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 14:48:25 2024]
Finished job 0.
1 of 1 steps (100%) done
