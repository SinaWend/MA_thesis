Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 00:21:12 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_27_57_seed_0_24141974

 Experiment start at: 2024-08-11 00:27:58.083726
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.11637334525585175
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95605654, 'precision': 0.957511, 'recall': 0.9560711, 'specificity': 0.9560711, 'f1': 0.9560226, 'auroc': 0.98977923, 'binary_precision': 0.9834358, 'binary_recall': 0.92778504, 'binary_specificity': 0.9843571, 'binary_f1_score': 0.95480025}
confusion matrix:
       0      1
0  24919    396
1   1830  23511
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96354836, 'precision': 0.6440704, 'recall': 0.6840636, 'specificity': 0.6840636, 'f1': 0.6613337, 'auroc': 0.8495338, 'binary_precision': 0.30337077, 'binary_recall': 0.39036146, 'binary_specificity': 0.9777658, 'binary_f1_score': 0.341412}
confusion matrix:
       0    1
0  16359  372
1    253  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91467273, 'precision': 0.7010858, 'recall': 0.71555793, 'specificity': 0.71555793, 'f1': 0.70798236, 'auroc': 0.8942114, 'binary_precision': 0.44537815, 'binary_recall': 0.48056996, 'binary_specificity': 0.9505459, 'binary_f1_score': 0.46230528}
confusion matrix:
      0    1
0  8880  462
1   401  371
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 01:03:06.226946,epoch time: 0:35:08.143220,used: 0:35:08.143220,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_27_57_seed_0_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9694212, 'precision': 0.9698162, 'recall': 0.96942925, 'specificity': 0.96942925, 'f1': 0.9694151, 'auroc': 0.9945466, 'binary_precision': 0.9835779, 'binary_recall': 0.95481807, 'binary_specificity': 0.98404044, 'binary_f1_score': 0.9689846}
confusion matrix:
       0      1
0  24910    404
1   1145  24197
---- Validation: 
scalar performance:
{'acc': 0.94622654, 'precision': 0.6062962, 'recall': 0.72923493, 'specificity': 0.72923493, 'f1': 0.6414667, 'auroc': 0.8653375, 'binary_precision': 0.22535211, 'binary_recall': 0.50120485, 'binary_specificity': 0.95726496, 'binary_f1_score': 0.3109118}
confusion matrix:
       0    1
0  16016  715
1    207  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91091555, 'precision': 0.70215726, 'recall': 0.76699734, 'specificity': 0.76699734, 'f1': 0.72840285, 'auroc': 0.896593, 'binary_precision': 0.43862987, 'binary_recall': 0.59715027, 'binary_specificity': 0.93684435, 'binary_f1_score': 0.5057597}
confusion matrix:
      0    1
0  8752  590
1   311  461
early stop counter: 1
val acc:0.9462265372276306, best validation acc: 0.9635483622550964, corresponding to test acc:                         0.9146727323532104 / 0.9146727323532104
after epoch: 2,now: 2024-08-11 01:36:42.648417,epoch time: 0:33:36.421471,used: 1:08:44.564691,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_27_57_seed_0_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97204673, 'precision': 0.97264946, 'recall': 0.9720581, 'specificity': 0.9720581, 'f1': 0.9720383, 'auroc': 0.9957373, 'binary_precision': 0.98968565, 'binary_recall': 0.954072, 'binary_specificity': 0.99004424, 'binary_f1_score': 0.9715526}
confusion matrix:
       0      1
0  25060    252
1   1164  24180
---- Validation: 
scalar performance:
{'acc': 0.9313542, 'precision': 0.58915293, 'recall': 0.75098765, 'specificity': 0.75098765, 'f1': 0.6237887, 'auroc': 0.8724494, 'binary_precision': 0.18973942, 'binary_recall': 0.5614458, 'binary_specificity': 0.9405296, 'binary_f1_score': 0.2836275}
confusion matrix:
       0    1
0  15736  995
1    182  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90468657, 'precision': 0.694368, 'recall': 0.786203, 'specificity': 0.786203, 'f1': 0.7279445, 'auroc': 0.89527977, 'binary_precision': 0.41932774, 'binary_recall': 0.64637303, 'binary_specificity': 0.92603296, 'binary_f1_score': 0.5086646}
confusion matrix:
      0    1
0  8651  691
1   273  499
early stop counter: 2
val acc:0.9313542246818542, best validation acc: 0.9635483622550964, corresponding to test acc:                         0.9146727323532104 / 0.9146727323532104
after epoch: 3,now: 2024-08-11 02:10:32.894654,epoch time: 0:33:50.246237,used: 1:42:34.810928,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_27_57_seed_0_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.979114, 'precision': 0.9793333, 'recall': 0.97911954, 'specificity': 0.97911954, 'f1': 0.9791118, 'auroc': 0.99755573, 'binary_precision': 0.98971486, 'binary_recall': 0.9683122, 'binary_specificity': 0.98992693, 'binary_f1_score': 0.97889656}
confusion matrix:
       0      1
0  25060    255
1    803  24538
---- Validation: 
scalar performance:
{'acc': 0.94109416, 'precision': 0.59804595, 'recall': 0.7324797, 'specificity': 0.7324797, 'f1': 0.6329586, 'auroc': 0.8749118, 'binary_precision': 0.208619, 'binary_recall': 0.51325303, 'binary_specificity': 0.9517064, 'binary_f1_score': 0.29665738}
confusion matrix:
       0    1
0  15923  808
1    202  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9138817, 'precision': 0.7099278, 'recall': 0.7763269, 'specificity': 0.7763269, 'f1': 0.73692584, 'auroc': 0.89761364, 'binary_precision': 0.45272207, 'binary_recall': 0.61398965, 'binary_specificity': 0.9386641, 'binary_f1_score': 0.52116555}
confusion matrix:
      0    1
0  8769  573
1   298  474
early stop counter: 3
val acc:0.941094160079956, best validation acc: 0.9635483622550964, corresponding to test acc:                         0.9146727323532104 / 0.9146727323532104
after epoch: 4,now: 2024-08-11 02:44:07.209305,epoch time: 0:33:34.314651,used: 2:16:09.125579,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_00_27_57_seed_0_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 2:16:09.125579 at 2024-08-11 02:44:07.209305
persisted model performance metric: 

scalar performance:
{'acc': 0.91467273, 'precision': 0.7010858, 'recall': 0.71555793, 'specificity': 0.71555793, 'f1': 0.70798236, 'auroc': 0.8942114, 'binary_precision': 0.44537815, 'binary_recall': 0.48056996, 'binary_specificity': 0.9505459, 'binary_f1_score': 0.46230528}
confusion matrix:
      0    1
0  8880  462
1   401  371
oracle model performance metric: 

scalar performance:
{'acc': 0.91467273, 'precision': 0.7010858, 'recall': 0.71555793, 'specificity': 0.71555793, 'f1': 0.70798236, 'auroc': 0.8942114, 'binary_precision': 0.44537815, 'binary_recall': 0.48056996, 'binary_specificity': 0.9505459, 'binary_f1_score': 0.46230528}
confusion matrix:
      0    1
0  8880  462
1   401  371
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1920 MiB |   6572 MiB | 341138 GiB | 341137 GiB |
|       from large pool |   1876 MiB |   6528 MiB | 337805 GiB | 337804 GiB |
|       from small pool |     44 MiB |     85 MiB |   3333 GiB |   3333 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1920 MiB |   6572 MiB | 341138 GiB | 341137 GiB |
|       from large pool |   1876 MiB |   6528 MiB | 337805 GiB | 337804 GiB |
|       from small pool |     44 MiB |     85 MiB |   3333 GiB |   3333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1917 MiB |   6568 MiB | 340871 GiB | 340869 GiB |
|       from large pool |   1874 MiB |   6525 MiB | 337543 GiB | 337541 GiB |
|       from small pool |     42 MiB |     83 MiB |   3328 GiB |   3328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7008 MiB |   7008 MiB |   7008 MiB |      0 B   |
|       from large pool |   6918 MiB |   6918 MiB |   6918 MiB |      0 B   |
|       from small pool |     90 MiB |     90 MiB |     90 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 779393 KiB |    904 MiB | 218600 GiB | 218599 GiB |
|       from large pool | 769540 KiB |    902 MiB | 215195 GiB | 215194 GiB |
|       from small pool |   9853 KiB |     17 MiB |   3405 GiB |   3405 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5080    |    7463    |   44241 K  |   44236 K  |
|       from large pool |     176    |     456    |   25118 K  |   25118 K  |
|       from small pool |    4904    |    7286    |   19123 K  |   19118 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5080    |    7463    |   44241 K  |   44236 K  |
|       from large pool |     176    |     456    |   25118 K  |   25118 K  |
|       from small pool |    4904    |    7286    |   19123 K  |   19118 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     173    |     173    |     173    |       0    |
|       from large pool |     128    |     128    |     128    |       0    |
|       from small pool |      45    |      45    |      45    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3207    |   27155 K  |   27155 K  |
|       from large pool |      32    |     117    |   16794 K  |   16794 K  |
|       from small pool |      39    |    3175    |   10360 K  |   10360 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6572 MiB | 341138 GiB | 341138 GiB |
|       from large pool |  16640 KiB |   6528 MiB | 337805 GiB | 337805 GiB |
|       from small pool |      0 KiB |     85 MiB |   3333 GiB |   3333 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6572 MiB | 341138 GiB | 341138 GiB |
|       from large pool |  16640 KiB |   6528 MiB | 337805 GiB | 337805 GiB |
|       from small pool |      0 KiB |     85 MiB |   3333 GiB |   3333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB | 340871 GiB | 340871 GiB |
|       from large pool |  16640 KiB |   6525 MiB | 337543 GiB | 337543 GiB |
|       from small pool |      0 KiB |     83 MiB |   3328 GiB |   3328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2682 MiB |   7008 MiB |   7008 MiB |   4326 MiB |
|       from large pool |   2628 MiB |   6918 MiB |   6918 MiB |   4290 MiB |
|       from small pool |     54 MiB |     90 MiB |     90 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    904 MiB | 218601 GiB | 218600 GiB |
|       from large pool | 204544 KiB |    902 MiB | 215195 GiB | 215195 GiB |
|       from small pool |      0 KiB |     28 MiB |   3405 GiB |   3405 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7463    |   44241 K  |   44241 K  |
|       from large pool |       2    |     456    |   25118 K  |   25118 K  |
|       from small pool |       0    |    7286    |   19123 K  |   19123 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7463    |   44241 K  |   44241 K  |
|       from large pool |       2    |     456    |   25118 K  |   25118 K  |
|       from small pool |       0    |    7286    |   19123 K  |   19123 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     173    |     173    |     108    |
|       from large pool |      38    |     128    |     128    |      90    |
|       from small pool |      27    |      45    |      45    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3207    |   27157 K  |   27157 K  |
|       from large pool |       4    |     117    |   16794 K  |   16794 K  |
|       from small pool |       0    |    3175    |   10362 K  |   10362 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6572 MiB | 341138 GiB | 341138 GiB |
|       from large pool |  16640 KiB |   6528 MiB | 337805 GiB | 337805 GiB |
|       from small pool |      0 KiB |     85 MiB |   3333 GiB |   3333 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6572 MiB | 341138 GiB | 341138 GiB |
|       from large pool |  16640 KiB |   6528 MiB | 337805 GiB | 337805 GiB |
|       from small pool |      0 KiB |     85 MiB |   3333 GiB |   3333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB | 340871 GiB | 340871 GiB |
|       from large pool |  16640 KiB |   6525 MiB | 337543 GiB | 337543 GiB |
|       from small pool |      0 KiB |     83 MiB |   3328 GiB |   3328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2682 MiB |   7008 MiB |   7008 MiB |   4326 MiB |
|       from large pool |   2628 MiB |   6918 MiB |   6918 MiB |   4290 MiB |
|       from small pool |     54 MiB |     90 MiB |     90 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    904 MiB | 218601 GiB | 218600 GiB |
|       from large pool | 204544 KiB |    902 MiB | 215195 GiB | 215195 GiB |
|       from small pool |      0 KiB |     28 MiB |   3405 GiB |   3405 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7463    |   44241 K  |   44241 K  |
|       from large pool |       2    |     456    |   25118 K  |   25118 K  |
|       from small pool |       0    |    7286    |   19123 K  |   19123 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7463    |   44241 K  |   44241 K  |
|       from large pool |       2    |     456    |   25118 K  |   25118 K  |
|       from small pool |       0    |    7286    |   19123 K  |   19123 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     173    |     173    |     108    |
|       from large pool |      38    |     128    |     128    |      90    |
|       from small pool |      27    |      45    |      45    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3207    |   27157 K  |   27157 K  |
|       from large pool |       4    |     117    |   16794 K  |   16794 K  |
|       from small pool |       0    |    3175    |   10362 K  |   10362 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_02_53_32_seed_1_24141974

 Experiment start at: 2024-08-11 02:53:32.771170
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.0762065201997757
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9641958, 'precision': 0.96470296, 'recall': 0.9642076, 'specificity': 0.9642076, 'f1': 0.9641866, 'auroc': 0.9921221, 'binary_precision': 0.98023266, 'binary_recall': 0.94755054, 'binary_specificity': 0.98086464, 'binary_f1_score': 0.9636145}
confusion matrix:
       0      1
0  24912    486
1   1334  24100
---- Validation: 
scalar performance:
{'acc': 0.930386, 'precision': 0.5878651, 'recall': 0.7371365, 'specificity': 0.7371365, 'f1': 0.6209396, 'auroc': 0.8454436, 'binary_precision': 0.18837018, 'binary_recall': 0.5336427, 'binary_specificity': 0.94063026, 'binary_f1_score': 0.27845037}
confusion matrix:
       0    1
0  15701  991
1    201  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9021901, 'precision': 0.6772789, 'recall': 0.741378, 'specificity': 0.741378, 'f1': 0.7024118, 'auroc': 0.89099056, 'binary_precision': 0.39212006, 'binary_recall': 0.55217963, 'binary_specificity': 0.9305764, 'binary_f1_score': 0.45858473}
confusion matrix:
      0    1
0  8686  648
1   339  418
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 03:28:13.863690,epoch time: 0:34:41.092520,used: 0:34:41.092520,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_02_53_32_seed_1_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9730288, 'precision': 0.97336316, 'recall': 0.9730394, 'specificity': 0.9730394, 'f1': 0.9730244, 'auroc': 0.99537385, 'binary_precision': 0.986142, 'binary_recall': 0.95958483, 'binary_specificity': 0.98649395, 'binary_f1_score': 0.9726821}
confusion matrix:
       0      1
0  25053    343
1   1028  24408
---- Validation: 
scalar performance:
{'acc': 0.93856215, 'precision': 0.5946249, 'recall': 0.72098756, 'specificity': 0.72098756, 'f1': 0.62758017, 'auroc': 0.8520356, 'binary_precision': 0.20287082, 'binary_recall': 0.49187934, 'binary_specificity': 0.95009583, 'binary_f1_score': 0.28726286}
confusion matrix:
       0    1
0  15859  833
1    219  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9103161, 'precision': 0.6954168, 'recall': 0.7536607, 'specificity': 0.7536607, 'f1': 0.7193439, 'auroc': 0.88859576, 'binary_precision': 0.42673266, 'binary_recall': 0.5693527, 'binary_specificity': 0.93796873, 'binary_f1_score': 0.4878325}
confusion matrix:
      0    1
0  8755  579
1   326  431
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 04:01:59.989182,epoch time: 0:33:46.125492,used: 1:08:27.218012,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_02_53_32_seed_1_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9773568, 'precision': 0.97766095, 'recall': 0.9773668, 'specificity': 0.9773668, 'f1': 0.9773535, 'auroc': 0.9966378, 'binary_precision': 0.9899132, 'binary_recall': 0.96457773, 'binary_specificity': 0.99015594, 'binary_f1_score': 0.9770813}
confusion matrix:
       0      1
0  25146    250
1    901  24535
---- Validation: 
scalar performance:
{'acc': 0.9338901, 'precision': 0.5933357, 'recall': 0.741194, 'specificity': 0.741194, 'f1': 0.62802804, 'auroc': 0.8577698, 'binary_precision': 0.19914164, 'binary_recall': 0.53828305, 'binary_specificity': 0.94410497, 'binary_f1_score': 0.2907268}
confusion matrix:
       0    1
0  15759  933
1    199  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90437025, 'precision': 0.692114, 'recall': 0.79050434, 'specificity': 0.79050434, 'f1': 0.7272234, 'auroc': 0.8903372, 'binary_precision': 0.41347754, 'binary_recall': 0.65653896, 'binary_specificity': 0.9244697, 'binary_f1_score': 0.5074017}
confusion matrix:
      0    1
0  8629  705
1   260  497
early stop counter: 1
val acc:0.9338901042938232, best validation acc: 0.9385621547698975, corresponding to test acc:                         0.9103161096572876 / 0.9103161096572876
after epoch: 3,now: 2024-08-11 04:35:48.392766,epoch time: 0:33:48.403584,used: 1:42:15.621596,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_02_53_32_seed_1_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9800126, 'precision': 0.98017734, 'recall': 0.9800197, 'specificity': 0.9800197, 'f1': 0.9800111, 'auroc': 0.9973321, 'binary_precision': 0.9892607, 'binary_recall': 0.9705917, 'binary_specificity': 0.9894476, 'binary_f1_score': 0.9798373}
confusion matrix:
       0      1
0  25129    268
1    748  24687
---- Validation: 
scalar performance:
{'acc': 0.9045144, 'precision': 0.5719439, 'recall': 0.7679421, 'specificity': 0.7679421, 'f1': 0.59830326, 'auroc': 0.8643653, 'binary_precision': 0.15442021, 'binary_recall': 0.62412995, 'binary_specificity': 0.91175413, 'binary_f1_score': 0.247584}
confusion matrix:
       0     1
0  15219  1473
1    162   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8927757, 'precision': 0.68224597, 'recall': 0.82186687, 'specificity': 0.82186687, 'f1': 0.7240053, 'auroc': 0.8876859, 'binary_precision': 0.3873874, 'binary_recall': 0.7384412, 'binary_specificity': 0.90529245, 'binary_f1_score': 0.50818187}
confusion matrix:
      0    1
0  8450  884
1   198  559
early stop counter: 2
val acc:0.9045143723487854, best validation acc: 0.9385621547698975, corresponding to test acc:                         0.9103161096572876 / 0.9103161096572876
after epoch: 4,now: 2024-08-11 05:09:31.275325,epoch time: 0:33:42.882559,used: 2:15:58.504155,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_02_53_32_seed_1_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9815667, 'precision': 0.981582, 'recall': 0.98156905, 'specificity': 0.98156905, 'f1': 0.9815666, 'auroc': 0.99757016, 'binary_precision': 0.9844955, 'binary_recall': 0.9785737, 'binary_specificity': 0.9845645, 'binary_f1_score': 0.98152566}
confusion matrix:
       0      1
0  25004    392
1    545  24891
---- Validation: 
scalar performance:
{'acc': 0.88880455, 'precision': 0.5696288, 'recall': 0.8039597, 'specificity': 0.8039597, 'f1': 0.5922153, 'auroc': 0.8839812, 'binary_precision': 0.14743897, 'binary_recall': 0.7146172, 'binary_specificity': 0.8933022, 'binary_f1_score': 0.24444446}
confusion matrix:
       0     1
0  14911  1781
1    123   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8831632, 'precision': 0.6726299, 'recall': 0.82820255, 'specificity': 0.82820255, 'f1': 0.71450675, 'auroc': 0.8896792, 'binary_precision': 0.36628643, 'binary_recall': 0.76354027, 'binary_specificity': 0.8928648, 'binary_f1_score': 0.49507496}
confusion matrix:
      0     1
0  8334  1000
1   179   578
early stop counter: 3
val acc:0.88880455493927, best validation acc: 0.9385621547698975, corresponding to test acc:                         0.9103161096572876 / 0.9103161096572876
after epoch: 5,now: 2024-08-11 05:43:17.787337,epoch time: 0:33:46.512012,used: 2:49:45.016167,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_02_53_32_seed_1_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:49:45.016167 at 2024-08-11 05:43:17.787337
persisted model performance metric: 

scalar performance:
{'acc': 0.9103161, 'precision': 0.6954168, 'recall': 0.7536607, 'specificity': 0.7536607, 'f1': 0.7193439, 'auroc': 0.88859576, 'binary_precision': 0.42673266, 'binary_recall': 0.5693527, 'binary_specificity': 0.93796873, 'binary_f1_score': 0.4878325}
confusion matrix:
      0    1
0  8755  579
1   326  431
oracle model performance metric: 

scalar performance:
{'acc': 0.9103161, 'precision': 0.6954168, 'recall': 0.7536607, 'specificity': 0.7536607, 'f1': 0.7193439, 'auroc': 0.88859576, 'binary_precision': 0.42673266, 'binary_recall': 0.5693527, 'binary_specificity': 0.93796873, 'binary_f1_score': 0.4878325}
confusion matrix:
      0    1
0  8755  579
1   326  431
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1921 MiB |   6573 MiB | 767765 GiB | 767763 GiB |
|       from large pool |   1877 MiB |   6530 MiB | 760280 GiB | 760278 GiB |
|       from small pool |     44 MiB |     85 MiB |   7484 GiB |   7484 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1921 MiB |   6573 MiB | 767765 GiB | 767763 GiB |
|       from large pool |   1877 MiB |   6530 MiB | 760280 GiB | 760278 GiB |
|       from small pool |     44 MiB |     85 MiB |   7484 GiB |   7484 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1917 MiB |   6568 MiB | 767157 GiB | 767155 GiB |
|       from large pool |   1874 MiB |   6525 MiB | 759682 GiB | 759680 GiB |
|       from small pool |     42 MiB |     83 MiB |   7474 GiB |   7474 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6818 MiB |   7008 MiB |  11144 MiB |   4326 MiB |
|       from large pool |   6734 MiB |   6918 MiB |  11024 MiB |   4290 MiB |
|       from small pool |     84 MiB |     90 MiB |    120 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 395593 KiB |    949 MiB | 569135 GiB | 569135 GiB |
|       from large pool | 383686 KiB |    948 MiB | 561501 GiB | 561501 GiB |
|       from small pool |  11907 KiB |     28 MiB |   7633 GiB |   7633 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5068    |    7485    |   99437 K  |   99432 K  |
|       from large pool |     176    |     456    |   56502 K  |   56502 K  |
|       from small pool |    4892    |    7308    |   42934 K  |   42929 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5068    |    7485    |   99437 K  |   99432 K  |
|       from large pool |     176    |     456    |   56502 K  |   56502 K  |
|       from small pool |    4892    |    7308    |   42934 K  |   42929 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     173    |     237    |     108    |
|       from large pool |      87    |     128    |     177    |      90    |
|       from small pool |      42    |      45    |      60    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3218    |   57220 K  |   57220 K  |
|       from large pool |      31    |     117    |   33913 K  |   33913 K  |
|       from small pool |      41    |    3187    |   23307 K  |   23307 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6573 MiB | 767765 GiB | 767765 GiB |
|       from large pool |  16640 KiB |   6530 MiB | 760280 GiB | 760280 GiB |
|       from small pool |      0 KiB |     85 MiB |   7484 GiB |   7484 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6573 MiB | 767765 GiB | 767765 GiB |
|       from large pool |  16640 KiB |   6530 MiB | 760280 GiB | 760280 GiB |
|       from small pool |      0 KiB |     85 MiB |   7484 GiB |   7484 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB | 767157 GiB | 767157 GiB |
|       from large pool |  16640 KiB |   6525 MiB | 759682 GiB | 759682 GiB |
|       from small pool |      0 KiB |     83 MiB |   7474 GiB |   7474 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2308 MiB |   7008 MiB |  11144 MiB |   8836 MiB |
|       from large pool |   2252 MiB |   6918 MiB |  11024 MiB |   8772 MiB |
|       from small pool |     56 MiB |     90 MiB |    120 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    949 MiB | 569135 GiB | 569135 GiB |
|       from large pool | 204544 KiB |    948 MiB | 561502 GiB | 561502 GiB |
|       from small pool |      0 KiB |     31 MiB |   7633 GiB |   7633 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7485    |   99437 K  |   99437 K  |
|       from large pool |       2    |     456    |   56502 K  |   56502 K  |
|       from small pool |       0    |    7308    |   42934 K  |   42934 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7485    |   99437 K  |   99437 K  |
|       from large pool |       2    |     456    |   56502 K  |   56502 K  |
|       from small pool |       0    |    7308    |   42934 K  |   42934 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     173    |     237    |     173    |
|       from large pool |      36    |     128    |     177    |     141    |
|       from small pool |      28    |      45    |      60    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3218    |   57222 K  |   57222 K  |
|       from large pool |       4    |     117    |   33913 K  |   33913 K  |
|       from small pool |       0    |    3187    |   23309 K  |   23309 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6573 MiB | 767765 GiB | 767765 GiB |
|       from large pool |  16640 KiB |   6530 MiB | 760280 GiB | 760280 GiB |
|       from small pool |      0 KiB |     85 MiB |   7484 GiB |   7484 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6573 MiB | 767765 GiB | 767765 GiB |
|       from large pool |  16640 KiB |   6530 MiB | 760280 GiB | 760280 GiB |
|       from small pool |      0 KiB |     85 MiB |   7484 GiB |   7484 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB | 767157 GiB | 767157 GiB |
|       from large pool |  16640 KiB |   6525 MiB | 759682 GiB | 759682 GiB |
|       from small pool |      0 KiB |     83 MiB |   7474 GiB |   7474 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2308 MiB |   7008 MiB |  11144 MiB |   8836 MiB |
|       from large pool |   2252 MiB |   6918 MiB |  11024 MiB |   8772 MiB |
|       from small pool |     56 MiB |     90 MiB |    120 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    949 MiB | 569135 GiB | 569135 GiB |
|       from large pool | 204544 KiB |    948 MiB | 561502 GiB | 561502 GiB |
|       from small pool |      0 KiB |     31 MiB |   7633 GiB |   7633 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7485    |   99437 K  |   99437 K  |
|       from large pool |       2    |     456    |   56502 K  |   56502 K  |
|       from small pool |       0    |    7308    |   42934 K  |   42934 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7485    |   99437 K  |   99437 K  |
|       from large pool |       2    |     456    |   56502 K  |   56502 K  |
|       from small pool |       0    |    7308    |   42934 K  |   42934 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     173    |     237    |     173    |
|       from large pool |      36    |     128    |     177    |     141    |
|       from small pool |      28    |      45    |      60    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3218    |   57222 K  |   57222 K  |
|       from large pool |       4    |     117    |   33913 K  |   33913 K  |
|       from small pool |       0    |    3187    |   23309 K  |   23309 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974

 Experiment start at: 2024-08-11 05:52:29.486033
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.07946888357400894
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.961912, 'precision': 0.9624766, 'recall': 0.96191466, 'specificity': 0.96191466, 'f1': 0.9619005, 'auroc': 0.9912871, 'binary_precision': 0.97867477, 'binary_recall': 0.9444144, 'binary_specificity': 0.97941494, 'binary_f1_score': 0.9612394}
confusion matrix:
       0      1
0  25312    532
1   1437  24415
---- Validation: 
scalar performance:
{'acc': 0.8683135, 'precision': 0.5579097, 'recall': 0.7972251, 'specificity': 0.7972251, 'f1': 0.56971115, 'auroc': 0.86933595, 'binary_precision': 0.12371979, 'binary_recall': 0.72248805, 'binary_specificity': 0.8719622, 'binary_f1_score': 0.21126267}
confusion matrix:
       0     1
0  14567  2139
1    116   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8036068, 'precision': 0.61872166, 'recall': 0.8004668, 'specificity': 0.8004668, 'f1': 0.6367362, 'auroc': 0.86262, 'binary_precision': 0.25865582, 'binary_recall': 0.7967378, 'binary_specificity': 0.8041958, 'binary_f1_score': 0.39052895}
confusion matrix:
      0     1
0  7475  1820
1   162   635
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 06:27:43.081534,epoch time: 0:35:13.595501,used: 0:35:13.595501,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.972377, 'precision': 0.9725026, 'recall': 0.9723773, 'specificity': 0.9723773, 'f1': 0.97237515, 'auroc': 0.9951763, 'binary_precision': 0.9802179, 'binary_recall': 0.9642153, 'binary_specificity': 0.9805393, 'binary_f1_score': 0.97215074}
confusion matrix:
       0      1
0  25344    503
1    925  24924
---- Validation: 
scalar performance:
{'acc': 0.8897454, 'precision': 0.567107, 'recall': 0.79771304, 'specificity': 0.79771304, 'f1': 0.5887219, 'auroc': 0.8738501, 'binary_precision': 0.14250973, 'binary_recall': 0.70095694, 'binary_specificity': 0.8944691, 'binary_f1_score': 0.23686339}
confusion matrix:
       0     1
0  14943  1763
1    125   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8491875, 'precision': 0.639503, 'recall': 0.78965056, 'specificity': 0.78965056, 'f1': 0.67132163, 'auroc': 0.86000156, 'binary_precision': 0.30625334, 'binary_recall': 0.71894604, 'binary_specificity': 0.860355, 'binary_f1_score': 0.42953524}
confusion matrix:
      0     1
0  7997  1298
1   224   573
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 07:02:13.523695,epoch time: 0:34:30.442161,used: 1:09:44.037662,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9761684, 'precision': 0.97654295, 'recall': 0.9761722, 'specificity': 0.9761722, 'f1': 0.97616386, 'auroc': 0.9965557, 'binary_precision': 0.9899709, 'binary_recall': 0.96209633, 'binary_specificity': 0.9902481, 'binary_f1_score': 0.9758346}
confusion matrix:
       0      1
0  25589    252
1    980  24875
---- Validation: 
scalar performance:
{'acc': 0.9390329, 'precision': 0.60631496, 'recall': 0.77515745, 'specificity': 0.77515745, 'f1': 0.6468274, 'auroc': 0.8826864, 'binary_precision': 0.22300886, 'binary_recall': 0.6028708, 'binary_specificity': 0.947444, 'binary_f1_score': 0.3255814}
confusion matrix:
       0    1
0  15828  878
1    166  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8931827, 'precision': 0.6771899, 'recall': 0.767076, 'specificity': 0.767076, 'f1': 0.70886046, 'auroc': 0.86855423, 'binary_precision': 0.3889328, 'binary_recall': 0.61731493, 'binary_specificity': 0.91683704, 'binary_f1_score': 0.47720656}
confusion matrix:
      0    1
0  8522  773
1   305  492
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 07:37:03.072050,epoch time: 0:34:49.548355,used: 1:44:33.586017,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9796116, 'precision': 0.9797078, 'recall': 0.9796127, 'specificity': 0.9796127, 'f1': 0.97961056, 'auroc': 0.99685884, 'binary_precision': 0.98654056, 'binary_recall': 0.9724973, 'binary_specificity': 0.9867281, 'binary_f1_score': 0.9794686}
confusion matrix:
       0      1
0  25501    343
1    711  25141
---- Validation: 
scalar performance:
{'acc': 0.92349917, 'precision': 0.589558, 'recall': 0.7881886, 'specificity': 0.7881886, 'f1': 0.62572867, 'auroc': 0.882078, 'binary_precision': 0.18854749, 'binary_recall': 0.64593303, 'binary_specificity': 0.9304442, 'binary_f1_score': 0.2918919}
confusion matrix:
       0     1
0  15544  1162
1    148   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8745541, 'precision': 0.6640413, 'recall': 0.80284786, 'specificity': 0.80284786, 'f1': 0.7017306, 'auroc': 0.87704027, 'binary_precision': 0.35461873, 'binary_recall': 0.71769136, 'binary_specificity': 0.8880043, 'binary_f1_score': 0.4746888}
confusion matrix:
      0     1
0  8254  1041
1   225   572
early stop counter: 1
val acc:0.9234991669654846, best validation acc: 0.9390329122543335, corresponding to test acc:                         0.8931826949119568 / 0.8931826949119568
after epoch: 4,now: 2024-08-11 08:11:52.238941,epoch time: 0:34:49.166891,used: 2:19:22.752908,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97986305, 'precision': 0.98010945, 'recall': 0.97986436, 'specificity': 0.97986436, 'f1': 0.97986054, 'auroc': 0.99743986, 'binary_precision': 0.9910149, 'binary_recall': 0.9685119, 'binary_specificity': 0.9912169, 'binary_f1_score': 0.9796342}
confusion matrix:
       0      1
0  25618    227
1    814  25037
---- Validation: 
scalar performance:
{'acc': 0.9410769, 'precision': 0.60989034, 'recall': 0.77620494, 'specificity': 0.77620494, 'f1': 0.6511449, 'auroc': 0.8883891, 'binary_precision': 0.23013699, 'binary_recall': 0.6028708, 'binary_specificity': 0.94953907, 'binary_f1_score': 0.33311304}
confusion matrix:
       0    1
0  15863  843
1    166  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88555294, 'precision': 0.6733339, 'recall': 0.79218554, 'specificity': 0.79218554, 'f1': 0.7101173, 'auroc': 0.8815642, 'binary_precision': 0.3760388, 'binary_recall': 0.6813049, 'binary_specificity': 0.90306616, 'binary_f1_score': 0.48460507}
confusion matrix:
      0    1
0  8394  901
1   254  543
better model found
persisted
after epoch: 5,now: 2024-08-11 08:46:39.407662,epoch time: 0:34:47.168721,used: 2:54:09.921629,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9811978, 'precision': 0.9814794, 'recall': 0.9812006, 'specificity': 0.9812006, 'f1': 0.9811951, 'auroc': 0.99784684, 'binary_precision': 0.99318165, 'binary_recall': 0.969057, 'binary_specificity': 0.9933442, 'binary_f1_score': 0.98097104}
confusion matrix:
       0      1
0  25670    172
1    800  25054
---- Validation: 
scalar performance:
{'acc': 0.94329596, 'precision': 0.61348164, 'recall': 0.77500975, 'specificity': 0.77500975, 'f1': 0.65514016, 'auroc': 0.8863833, 'binary_precision': 0.23741691, 'binary_recall': 0.5980861, 'binary_specificity': 0.95193344, 'binary_f1_score': 0.33990481}
confusion matrix:
       0    1
0  15903  803
1    168  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88773286, 'precision': 0.67586696, 'recall': 0.79164827, 'specificity': 0.79164827, 'f1': 0.7124896, 'auroc': 0.8767235, 'binary_precision': 0.38135594, 'binary_recall': 0.6775408, 'binary_specificity': 0.90575576, 'binary_f1_score': 0.48802528}
confusion matrix:
      0    1
0  8419  876
1   257  540
better model found
persisted
after epoch: 6,now: 2024-08-11 09:21:32.748944,epoch time: 0:34:53.341282,used: 3:29:03.262911,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98417675, 'precision': 0.984236, 'recall': 0.9841776, 'specificity': 0.9841776, 'f1': 0.9841763, 'auroc': 0.9979229, 'binary_precision': 0.98963386, 'binary_recall': 0.978609, 'binary_specificity': 0.98974615, 'binary_f1_score': 0.98409057}
confusion matrix:
       0      1
0  25579    265
1    553  25299
---- Validation: 
scalar performance:
{'acc': 0.9351787, 'precision': 0.60772514, 'recall': 0.80700314, 'specificity': 0.80700314, 'f1': 0.6510251, 'auroc': 0.89228696, 'binary_precision': 0.22408293, 'binary_recall': 0.6722488, 'binary_specificity': 0.94175744, 'binary_f1_score': 0.3361244}
confusion matrix:
       0    1
0  15733  973
1    137  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87861675, 'precision': 0.6731846, 'recall': 0.82340723, 'specificity': 0.82340723, 'f1': 0.7137481, 'auroc': 0.88827384, 'binary_precision': 0.36919317, 'binary_recall': 0.7578419, 'binary_specificity': 0.8889726, 'binary_f1_score': 0.4965064}
confusion matrix:
      0     1
0  8263  1032
1   193   604
early stop counter: 1
val acc:0.9351786971092224, best validation acc: 0.943295955657959, corresponding to test acc:                         0.8877328634262085 / 0.8931826949119568
after epoch: 7,now: 2024-08-11 09:56:22.855166,epoch time: 0:34:50.106222,used: 4:03:53.369133,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98338366, 'precision': 0.98348814, 'recall': 0.9833842, 'specificity': 0.9833842, 'f1': 0.9833827, 'auroc': 0.99806726, 'binary_precision': 0.990616, 'binary_recall': 0.97601545, 'binary_specificity': 0.99075294, 'binary_f1_score': 0.9832616}
confusion matrix:
       0      1
0  25607    239
1    620  25230
---- Validation: 
scalar performance:
{'acc': 0.9439967, 'precision': 0.6192166, 'recall': 0.7940288, 'specificity': 0.7940288, 'f1': 0.66376567, 'auroc': 0.89017874, 'binary_precision': 0.24790308, 'binary_recall': 0.6363636, 'binary_specificity': 0.951694, 'binary_f1_score': 0.3568075}
confusion matrix:
       0    1
0  15899  807
1    152  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8812921, 'precision': 0.6779112, 'recall': 0.83174235, 'specificity': 0.83174235, 'f1': 0.719759, 'auroc': 0.8942827, 'binary_precision': 0.37721983, 'binary_recall': 0.7728984, 'binary_specificity': 0.8905863, 'binary_f1_score': 0.50699586}
confusion matrix:
      0     1
0  8278  1017
1   181   616
better model found
persisted
after epoch: 8,now: 2024-08-11 10:31:18.672112,epoch time: 0:34:55.816946,used: 4:38:49.186079,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98419607, 'precision': 0.98419607, 'recall': 0.98419607, 'specificity': 0.98419607, 'f1': 0.98419607, 'auroc': 0.99826455, 'binary_precision': 0.98414415, 'binary_recall': 0.98425835, 'binary_specificity': 0.9841337, 'binary_f1_score': 0.98420125}
confusion matrix:
       0      1
0  25431    410
1    407  25448
---- Validation: 
scalar performance:
{'acc': 0.8955851, 'precision': 0.5769651, 'recall': 0.83569324, 'specificity': 0.83569324, 'f1': 0.6046025, 'auroc': 0.8955858, 'binary_precision': 0.16021825, 'binary_recall': 0.77272725, 'binary_specificity': 0.89865917, 'binary_f1_score': 0.26540673}
confusion matrix:
       0     1
0  15013  1693
1     95   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8127229, 'precision': 0.62955457, 'recall': 0.8260639, 'specificity': 0.8260639, 'f1': 0.6518657, 'auroc': 0.89068246, 'binary_precision': 0.27556467, 'binary_recall': 0.84190714, 'binary_specificity': 0.81022054, 'binary_f1_score': 0.41522273}
confusion matrix:
      0     1
0  7531  1764
1   126   671
early stop counter: 1
val acc:0.8955851197242737, best validation acc: 0.9439967274665833, corresponding to test acc:                         0.8812921047210693 / 0.8931826949119568
after epoch: 9,now: 2024-08-11 11:06:26.856554,epoch time: 0:35:08.184442,used: 5:13:57.370521,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9855695, 'precision': 0.98561513, 'recall': 0.9855701, 'specificity': 0.9855701, 'f1': 0.9855692, 'auroc': 0.9984985, 'binary_precision': 0.9903512, 'binary_recall': 0.9806971, 'binary_specificity': 0.99044305, 'binary_f1_score': 0.9855005}
confusion matrix:
       0      1
0  25598    247
1    499  25352
---- Validation: 
scalar performance:
{'acc': 0.9328428, 'precision': 0.6054906, 'recall': 0.81163716, 'specificity': 0.81163716, 'f1': 0.64840776, 'auroc': 0.8960562, 'binary_precision': 0.21932516, 'binary_recall': 0.68421054, 'binary_specificity': 0.9390638, 'binary_f1_score': 0.3321719}
confusion matrix:
       0     1
0  15688  1018
1    132   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86880696, 'precision': 0.6638106, 'recall': 0.82324386, 'specificity': 0.82324386, 'f1': 0.70285106, 'auroc': 0.89100873, 'binary_precision': 0.34968626, 'binary_recall': 0.7691343, 'binary_specificity': 0.8773534, 'binary_f1_score': 0.48078436}
confusion matrix:
      0     1
0  8155  1140
1   184   613
early stop counter: 2
val acc:0.9328427910804749, best validation acc: 0.9439967274665833, corresponding to test acc:                         0.8812921047210693 / 0.8931826949119568
after epoch: 10,now: 2024-08-11 11:41:20.157203,epoch time: 0:34:53.300649,used: 5:48:50.671170,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9849698, 'precision': 0.98497427, 'recall': 0.98497, 'specificity': 0.98497, 'f1': 0.98496974, 'auroc': 0.9983784, 'binary_precision': 0.98645765, 'binary_recall': 0.98344296, 'binary_specificity': 0.9864969, 'binary_f1_score': 0.984948}
confusion matrix:
       0      1
0  25497    349
1    428  25422
---- Validation: 
scalar performance:
{'acc': 0.9357043, 'precision': 0.60598934, 'recall': 0.7956101, 'specificity': 0.7956101, 'f1': 0.6480583, 'auroc': 0.89496243, 'binary_precision': 0.22122449, 'binary_recall': 0.6483254, 'binary_specificity': 0.94289476, 'binary_f1_score': 0.32988435}
confusion matrix:
       0    1
0  15752  954
1    147  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86989695, 'precision': 0.66690475, 'recall': 0.83186543, 'specificity': 0.83186543, 'f1': 0.7069888, 'auroc': 0.8935025, 'binary_precision': 0.3542373, 'binary_recall': 0.7867001, 'binary_specificity': 0.8770307, 'binary_f1_score': 0.48850796}
confusion matrix:
      0     1
0  8152  1143
1   170   627
early stop counter: 3
val acc:0.9357042908668518, best validation acc: 0.9439967274665833, corresponding to test acc:                         0.8812921047210693 / 0.8931826949119568
after epoch: 11,now: 2024-08-11 12:16:17.759045,epoch time: 0:34:57.601842,used: 6:23:48.273012,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_11_05_52_28_seed_2_24141974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 6:23:48.273012 at 2024-08-11 12:16:17.759045
persisted model performance metric: 

scalar performance:
{'acc': 0.8812921, 'precision': 0.6779112, 'recall': 0.83174235, 'specificity': 0.83174235, 'f1': 0.719759, 'auroc': 0.8942827, 'binary_precision': 0.37721983, 'binary_recall': 0.7728984, 'binary_specificity': 0.8905863, 'binary_f1_score': 0.50699586}
confusion matrix:
      0     1
0  8278  1017
1   181   616
oracle model performance metric: 

scalar performance:
{'acc': 0.8931827, 'precision': 0.6771899, 'recall': 0.767076, 'specificity': 0.767076, 'f1': 0.70886046, 'auroc': 0.86855423, 'binary_precision': 0.3889328, 'binary_recall': 0.61731493, 'binary_specificity': 0.91683704, 'binary_f1_score': 0.47720656}
confusion matrix:
      0    1
0  8522  773
1   305  492
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1921 MiB |   6573 MiB |   1675 TiB |   1675 TiB |
|       from large pool |   1877 MiB |   6530 MiB |   1659 TiB |   1659 TiB |
|       from small pool |     44 MiB |     85 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1921 MiB |   6573 MiB |   1675 TiB |   1675 TiB |
|       from large pool |   1877 MiB |   6530 MiB |   1659 TiB |   1659 TiB |
|       from small pool |     44 MiB |     85 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1917 MiB |   6568 MiB |   1674 TiB |   1674 TiB |
|       from large pool |   1874 MiB |   6525 MiB |   1658 TiB |   1658 TiB |
|       from small pool |     42 MiB |     83 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6958 MiB |   7008 MiB |  15794 MiB |   8836 MiB |
|       from large pool |   6874 MiB |   6918 MiB |  15646 MiB |   8772 MiB |
|       from small pool |     84 MiB |     90 MiB |    148 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 749938 KiB |   1001 MiB |   1257 TiB |   1257 TiB |
|       from large pool | 740078 KiB |    998 MiB |   1241 TiB |   1241 TiB |
|       from small pool |   9859 KiB |     31 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    5068    |    7593    |  221423 K  |  221418 K  |
|       from large pool |     176    |     456    |  126099 K  |  126099 K  |
|       from small pool |    4892    |    7416    |   95323 K  |   95318 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5068    |    7593    |  221423 K  |  221418 K  |
|       from large pool |     176    |     456    |  126099 K  |  126099 K  |
|       from small pool |    4892    |    7416    |   95323 K  |   95318 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     173    |     313    |     173    |
|       from large pool |      98    |     128    |     239    |     141    |
|       from small pool |      42    |      45    |      74    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3274    |  126267 K  |  126267 K  |
|       from large pool |      32    |     117    |   72839 K  |   72839 K  |
|       from small pool |      40    |    3241    |   53428 K  |   53428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6573 MiB |   1675 TiB |   1675 TiB |
|       from large pool |  16640 KiB |   6530 MiB |   1659 TiB |   1659 TiB |
|       from small pool |      0 KiB |     85 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6573 MiB |   1675 TiB |   1675 TiB |
|       from large pool |  16640 KiB |   6530 MiB |   1659 TiB |   1659 TiB |
|       from small pool |      0 KiB |     85 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6568 MiB |   1674 TiB |   1674 TiB |
|       from large pool |  16640 KiB |   6525 MiB |   1658 TiB |   1658 TiB |
|       from small pool |      0 KiB |     83 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2654 MiB |   7008 MiB |  15794 MiB |  13140 MiB |
|       from large pool |   2600 MiB |   6918 MiB |  15646 MiB |  13046 MiB |
|       from small pool |     54 MiB |     90 MiB |    148 MiB |     94 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |   1001 MiB |   1257 TiB |   1257 TiB |
|       from large pool | 204544 KiB |    998 MiB |   1241 TiB |   1241 TiB |
|       from small pool |      0 KiB |     31 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  221423 K  |  221423 K  |
|       from large pool |       2    |     456    |  126099 K  |  126099 K  |
|       from small pool |       0    |    7416    |   95323 K  |   95323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  221423 K  |  221423 K  |
|       from large pool |       2    |     456    |  126099 K  |  126099 K  |
|       from small pool |       0    |    7416    |   95323 K  |   95323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     173    |     313    |     248    |
|       from large pool |      38    |     128    |     239    |     201    |
|       from small pool |      27    |      45    |      74    |      47    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3274    |  126269 K  |  126269 K  |
|       from large pool |       4    |     117    |   72839 K  |   72839 K  |
|       from small pool |       0    |    3241    |   53430 K  |   53430 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 12:18:24 2024]
Finished job 0.
1 of 1 steps (100%) done
