Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Aug  7 19:34:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/20.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=20
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_19_42_51_seed_0_24111563

 Experiment start at: 2024-08-07 19:42:51.785161
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.28613802790641785
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9328411, 'precision': 0.93676275, 'recall': 0.93286735, 'specificity': 0.93286735, 'f1': 0.93269277, 'auroc': 0.9762721, 'binary_precision': 0.9782874, 'binary_recall': 0.8854076, 'binary_specificity': 0.98032707, 'binary_f1_score': 0.9295331}
confusion matrix:
       0      1
0  24816    498
1   2904  22438
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9335122, 'precision': 0.5179922, 'recall': 0.5347305, 'specificity': 0.5347305, 'f1': 0.5215915, 'auroc': 0.63774514, 'binary_precision': 0.058465287, 'binary_recall': 0.11566265, 'binary_specificity': 0.95379835, 'binary_f1_score': 0.0776699}
confusion matrix:
       0    1
0  15958  773
1    367   48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8682025, 'precision': 0.55221397, 'recall': 0.55731386, 'specificity': 0.55731386, 'f1': 0.55451894, 'auroc': 0.77703744, 'binary_precision': 0.17192982, 'binary_recall': 0.1904145, 'binary_specificity': 0.92421323, 'binary_f1_score': 0.18070067}
confusion matrix:
      0    1
0  8634  708
1   625  147
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 20:13:23.610948,epoch time: 0:30:31.825787,used: 0:30:31.825787,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_19_42_51_seed_0_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9546944, 'precision': 0.9559605, 'recall': 0.95470905, 'specificity': 0.95470905, 'f1': 0.954664, 'auroc': 0.9861463, 'binary_precision': 0.98012584, 'binary_recall': 0.9282614, 'binary_specificity': 0.98115665, 'binary_f1_score': 0.9534889}
confusion matrix:
       0      1
0  24837    477
1   1818  23524
---- Validation: 
scalar performance:
{'acc': 0.9461682, 'precision': 0.5577719, 'recall': 0.59526247, 'specificity': 0.59526247, 'f1': 0.5706999, 'auroc': 0.7351762, 'binary_precision': 0.13505746, 'binary_recall': 0.22650602, 'binary_specificity': 0.9640189, 'binary_f1_score': 0.16921692}
confusion matrix:
       0    1
0  16129  602
1    321   94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89430493, 'precision': 0.6223377, 'recall': 0.6195695, 'specificity': 0.6195695, 'f1': 0.6209299, 'auroc': 0.8323108, 'binary_precision': 0.30278885, 'binary_recall': 0.29533678, 'binary_specificity': 0.9438022, 'binary_f1_score': 0.2990164}
confusion matrix:
      0    1
0  8817  525
1   544  228
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 20:43:15.289892,epoch time: 0:29:51.678944,used: 1:00:23.504731,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_19_42_51_seed_0_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9609918, 'precision': 0.9620587, 'recall': 0.9610061, 'specificity': 0.9610061, 'f1': 0.9609701, 'auroc': 0.9897431, 'binary_precision': 0.98441064, 'binary_recall': 0.9368662, 'binary_specificity': 0.985146, 'binary_f1_score': 0.96005017}
confusion matrix:
       0      1
0  24937    376
1   1600  23743
---- Validation: 
scalar performance:
{'acc': 0.945235, 'precision': 0.57510614, 'recall': 0.63943183, 'specificity': 0.63943183, 'f1': 0.59553665, 'auroc': 0.77470195, 'binary_precision': 0.16751269, 'binary_recall': 0.3180723, 'binary_specificity': 0.96079135, 'binary_f1_score': 0.21945137}
confusion matrix:
       0    1
0  16075  656
1    283  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8971722, 'precision': 0.65809906, 'recall': 0.6947958, 'specificity': 0.6947958, 'f1': 0.67370236, 'auroc': 0.86307406, 'binary_precision': 0.3621399, 'binary_recall': 0.45595855, 'binary_specificity': 0.933633, 'binary_f1_score': 0.40366971}
confusion matrix:
      0    1
0  8722  620
1   420  352
new oracle model saved
early stop counter: 1
val acc:0.945235013961792, best validation acc: 0.9461681842803955, corresponding to test acc:                         0.8943049311637878 / 0.897172212600708
after epoch: 3,now: 2024-08-07 21:12:42.841796,epoch time: 0:29:27.551904,used: 1:29:51.056635,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_19_42_51_seed_0_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96851313, 'precision': 0.9689589, 'recall': 0.9685211, 'specificity': 0.9685211, 'f1': 0.9685061, 'auroc': 0.9930607, 'binary_precision': 0.9835465, 'binary_recall': 0.9530011, 'binary_specificity': 0.9840411, 'binary_f1_score': 0.96803296}
confusion matrix:
       0      1
0  24911    404
1   1191  24150
---- Validation: 
scalar performance:
{'acc': 0.94313544, 'precision': 0.57988656, 'recall': 0.6618546, 'specificity': 0.6618546, 'f1': 0.60407597, 'auroc': 0.7952454, 'binary_precision': 0.17592593, 'binary_recall': 0.36626506, 'binary_specificity': 0.95744425, 'binary_f1_score': 0.2376857}
confusion matrix:
       0    1
0  16019  712
1    263  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8995452, 'precision': 0.66703975, 'recall': 0.71033984, 'specificity': 0.71033984, 'f1': 0.6851507, 'auroc': 0.8739437, 'binary_precision': 0.37751004, 'binary_recall': 0.48704663, 'binary_specificity': 0.933633, 'binary_f1_score': 0.42533937}
confusion matrix:
      0    1
0  8722  620
1   396  376
new oracle model saved
early stop counter: 2
val acc:0.9431354403495789, best validation acc: 0.9461681842803955, corresponding to test acc:                         0.8943049311637878 / 0.8995451927185059
after epoch: 4,now: 2024-08-07 21:42:59.556331,epoch time: 0:30:16.714535,used: 2:00:07.771170,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_19_42_51_seed_0_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9696778, 'precision': 0.9702969, 'recall': 0.96968865, 'specificity': 0.96968865, 'f1': 0.9696684, 'auroc': 0.9935379, 'binary_precision': 0.9875087, 'binary_recall': 0.95142645, 'binary_specificity': 0.98795086, 'binary_f1_score': 0.9691319}
confusion matrix:
       0      1
0  25008    305
1   1231  24112
---- Validation: 
scalar performance:
{'acc': 0.939986, 'precision': 0.57702196, 'recall': 0.6672905, 'specificity': 0.6672905, 'f1': 0.6018562, 'auroc': 0.801865, 'binary_precision': 0.16989248, 'binary_recall': 0.38072288, 'binary_specificity': 0.95385814, 'binary_f1_score': 0.23494424}
confusion matrix:
       0    1
0  15959  772
1    257  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90468657, 'precision': 0.68107456, 'recall': 0.72678834, 'specificity': 0.72678834, 'f1': 0.70034516, 'auroc': 0.87957907, 'binary_precision': 0.4030303, 'binary_recall': 0.5168394, 'binary_specificity': 0.9367373, 'binary_f1_score': 0.45289445}
confusion matrix:
      0    1
0  8751  591
1   373  399
new oracle model saved
early stop counter: 3
val acc:0.939985990524292, best validation acc: 0.9461681842803955, corresponding to test acc:                         0.8943049311637878 / 0.9046865701675415
after epoch: 5,now: 2024-08-07 22:13:25.396385,epoch time: 0:30:25.840054,used: 2:30:33.611224,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_19_42_51_seed_0_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:30:33.611224 at 2024-08-07 22:13:25.396385
persisted model performance metric: 

scalar performance:
{'acc': 0.89430493, 'precision': 0.6223377, 'recall': 0.6195695, 'specificity': 0.6195695, 'f1': 0.6209299, 'auroc': 0.8323108, 'binary_precision': 0.30278885, 'binary_recall': 0.29533678, 'binary_specificity': 0.9438022, 'binary_f1_score': 0.2990164}
confusion matrix:
      0    1
0  8817  525
1   544  228
oracle model performance metric: 

scalar performance:
{'acc': 0.90468657, 'precision': 0.68107456, 'recall': 0.72678834, 'specificity': 0.72678834, 'f1': 0.70034516, 'auroc': 0.87957907, 'binary_precision': 0.4030303, 'binary_recall': 0.5168394, 'binary_specificity': 0.9367373, 'binary_f1_score': 0.45289445}
confusion matrix:
      0    1
0  8751  591
1   373  399
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/20.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198886 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |  18224 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198886 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |  18224 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   2141 MiB | 263056 GiB | 263055 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 259628 GiB | 259628 GiB |
|       from small pool |  16663 KiB |     36 MiB |   3427 GiB |   3427 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2372 MiB |   2372 MiB |   2372 MiB |      0 B   |
|       from large pool |   2330 MiB |   2330 MiB |   2330 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  63258 KiB | 225565 KiB | 143429 GiB | 143429 GiB |
|       from large pool |  50762 KiB | 224940 KiB | 139975 GiB | 139975 GiB |
|       from small pool |  12496 KiB |  12998 KiB |   3453 GiB |   3453 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4444    |    6827    |   40030 K  |   40025 K  |
|       from large pool |      79    |     252    |   24084 K  |   24084 K  |
|       from small pool |    4365    |    6747    |   15945 K  |   15940 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4444    |    6827    |   40030 K  |   40025 K  |
|       from large pool |      79    |     252    |   24084 K  |   24084 K  |
|       from small pool |    4365    |    6747    |   15945 K  |   15940 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     118    |     118    |     118    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    3182    |   25681 K  |   25681 K  |
|       from large pool |      10    |      97    |   18855 K  |   18855 K  |
|       from small pool |      30    |    3172    |    6825 K  |    6825 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |      0 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |      0 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 263056 GiB | 263055 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 259628 GiB | 259628 GiB |
|       from small pool |      0 KiB |     36 MiB |   3427 GiB |   3427 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   2372 MiB |   2372 MiB |   2116 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 143429 GiB | 143429 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 139975 GiB | 139975 GiB |
|       from small pool |      0 KiB |  26061 KiB |   3453 GiB |   3453 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   40030 K  |   40030 K  |
|       from large pool |       2    |     252    |   24084 K  |   24084 K  |
|       from small pool |       0    |    6747    |   15945 K  |   15945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   40030 K  |   40030 K  |
|       from large pool |       2    |     252    |   24084 K  |   24084 K  |
|       from small pool |       0    |    6747    |   15945 K  |   15945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |     118    |     118    |      92    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   25683 K  |   25683 K  |
|       from large pool |       3    |      97    |   18855 K  |   18855 K  |
|       from small pool |       0    |    3172    |    6827 K  |    6827 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |      0 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |      0 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 263056 GiB | 263055 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 259628 GiB | 259628 GiB |
|       from small pool |      0 KiB |     36 MiB |   3427 GiB |   3427 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   2372 MiB |   2372 MiB |   2116 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 143429 GiB | 143429 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 139975 GiB | 139975 GiB |
|       from small pool |      0 KiB |  26061 KiB |   3453 GiB |   3453 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   40030 K  |   40030 K  |
|       from large pool |       2    |     252    |   24084 K  |   24084 K  |
|       from small pool |       0    |    6747    |   15945 K  |   15945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   40030 K  |   40030 K  |
|       from large pool |       2    |     252    |   24084 K  |   24084 K  |
|       from small pool |       0    |    6747    |   15945 K  |   15945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |     118    |     118    |      92    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   25683 K  |   25683 K  |
|       from large pool |       3    |      97    |   18855 K  |   18855 K  |
|       from small pool |       0    |    3172    |    6827 K  |    6827 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_22_39_52_seed_1_24111563

 Experiment start at: 2024-08-07 22:39:52.985522
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6057873368263245
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9351983, 'precision': 0.93661904, 'recall': 0.9352197, 'specificity': 0.9352197, 'f1': 0.93514764, 'auroc': 0.97782266, 'binary_precision': 0.9617133, 'binary_recall': 0.9065854, 'binary_specificity': 0.963854, 'binary_f1_score': 0.93333596}
confusion matrix:
       0      1
0  24479    918
1   2376  23059
---- Validation: 
scalar performance:
{'acc': 0.9465631, 'precision': 0.5767666, 'recall': 0.62902963, 'specificity': 0.62902963, 'f1': 0.5948085, 'auroc': 0.80295223, 'binary_precision': 0.17208672, 'binary_recall': 0.29466358, 'binary_specificity': 0.96339566, 'binary_f1_score': 0.21727972}
confusion matrix:
       0    1
0  16081  611
1    304  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.895055, 'precision': 0.6512513, 'recall': 0.6932149, 'specificity': 0.6932149, 'f1': 0.66852987, 'auroc': 0.8493699, 'binary_precision': 0.34778225, 'binary_recall': 0.45574635, 'binary_specificity': 0.9306835, 'binary_f1_score': 0.39451113}
confusion matrix:
      0    1
0  8687  647
1   412  345
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 23:11:06.362025,epoch time: 0:31:13.376503,used: 0:31:13.376503,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_22_39_52_seed_1_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95262825, 'precision': 0.954654, 'recall': 0.952656, 'specificity': 0.952656, 'f1': 0.9525775, 'auroc': 0.98756206, 'binary_precision': 0.9852092, 'binary_recall': 0.91913354, 'binary_specificity': 0.9861784, 'binary_f1_score': 0.95102507}
confusion matrix:
       0      1
0  25044    351
1   2057  23380
---- Validation: 
scalar performance:
{'acc': 0.96122175, 'precision': 0.632244, 'recall': 0.6625414, 'specificity': 0.6625414, 'f1': 0.6456263, 'auroc': 0.8471538, 'binary_precision': 0.2814259, 'binary_recall': 0.34802786, 'binary_specificity': 0.9770549, 'binary_f1_score': 0.3112033}
confusion matrix:
       0    1
0  16309  383
1    281  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91348726, 'precision': 0.69197166, 'recall': 0.7037854, 'specificity': 0.7037854, 'f1': 0.69763994, 'auroc': 0.8708564, 'binary_precision': 0.42821783, 'binary_recall': 0.45706737, 'binary_specificity': 0.9505035, 'binary_f1_score': 0.44217253}
confusion matrix:
      0    1
0  8872  462
1   411  346
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 23:41:54.730636,epoch time: 0:30:48.368611,used: 1:02:01.745114,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_22_39_52_seed_1_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9620121, 'precision': 0.962816, 'recall': 0.96202946, 'specificity': 0.96202946, 'f1': 0.9619966, 'auroc': 0.99112284, 'binary_precision': 0.98231286, 'binary_recall': 0.9410308, 'binary_specificity': 0.9830282, 'binary_f1_score': 0.96122885}
confusion matrix:
       0      1
0  24964    431
1   1500  23937
---- Validation: 
scalar performance:
{'acc': 0.964609, 'precision': 0.65346724, 'recall': 0.67558014, 'specificity': 0.67558014, 'f1': 0.6636926, 'auroc': 0.85994947, 'binary_precision': 0.32323232, 'binary_recall': 0.3712297, 'binary_specificity': 0.9799305, 'binary_f1_score': 0.34557235}
confusion matrix:
       0    1
0  16357  335
1    271  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9163611, 'precision': 0.7037084, 'recall': 0.72476083, 'specificity': 0.72476083, 'f1': 0.71353984, 'auroc': 0.87158, 'binary_precision': 0.4483986, 'binary_recall': 0.4993395, 'binary_specificity': 0.95018214, 'binary_f1_score': 0.4725}
confusion matrix:
      0    1
0  8869  465
1   379  378
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-08 00:12:18.659351,epoch time: 0:30:23.928715,used: 1:32:25.673829,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_22_39_52_seed_1_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9652778, 'precision': 0.9664045, 'recall': 0.9652982, 'specificity': 0.9652982, 'f1': 0.9652578, 'auroc': 0.99271375, 'binary_precision': 0.9895359, 'binary_recall': 0.940559, 'binary_specificity': 0.9900374, 'binary_f1_score': 0.96442604}
confusion matrix:
       0      1
0  25142    253
1   1512  23925
---- Validation: 
scalar performance:
{'acc': 0.96583545, 'precision': 0.6621021, 'recall': 0.68072975, 'specificity': 0.68072975, 'f1': 0.6708525, 'auroc': 0.8595376, 'binary_precision': 0.34024897, 'binary_recall': 0.38051045, 'binary_specificity': 0.980949, 'binary_f1_score': 0.35925522}
confusion matrix:
       0    1
0  16374  318
1    267  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91348726, 'precision': 0.70464957, 'recall': 0.7675136, 'specificity': 0.7675136, 'f1': 0.73037076, 'auroc': 0.8782196, 'binary_precision': 0.44302553, 'binary_recall': 0.5957728, 'binary_specificity': 0.93925434, 'binary_f1_score': 0.50816905}
confusion matrix:
      0    1
0  8767  567
1   306  451
better model found
persisted
after epoch: 4,now: 2024-08-08 00:42:10.490731,epoch time: 0:29:51.831380,used: 2:02:17.505209,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_22_39_52_seed_1_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9727534, 'precision': 0.9731838, 'recall': 0.9727666, 'specificity': 0.9727666, 'f1': 0.9727477, 'auroc': 0.99468654, 'binary_precision': 0.98767287, 'binary_recall': 0.9575045, 'binary_specificity': 0.98802865, 'binary_f1_score': 0.97235477}
confusion matrix:
       0      1
0  25090    304
1   1081  24357
---- Validation: 
scalar performance:
{'acc': 0.9639082, 'precision': 0.64763534, 'recall': 0.66956997, 'specificity': 0.66956997, 'f1': 0.65775156, 'auroc': 0.8574905, 'binary_precision': 0.31187123, 'binary_recall': 0.35962877, 'binary_specificity': 0.97951114, 'binary_f1_score': 0.33405173}
confusion matrix:
       0    1
0  16350  342
1    276  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9110098, 'precision': 0.6978808, 'recall': 0.75889117, 'specificity': 0.75889117, 'f1': 0.7227905, 'auroc': 0.8700099, 'binary_precision': 0.43081453, 'binary_recall': 0.57992077, 'binary_specificity': 0.93786156, 'binary_f1_score': 0.4943694}
confusion matrix:
      0    1
0  8754  580
1   318  439
early stop counter: 1
val acc:0.9639081954956055, best validation acc: 0.965835452079773, corresponding to test acc:                         0.9134872555732727 / 0.9163610935211182
after epoch: 5,now: 2024-08-08 01:11:49.968394,epoch time: 0:29:39.477663,used: 2:31:56.982872,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_22_39_52_seed_1_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9738551, 'precision': 0.97396404, 'recall': 0.9738611, 'specificity': 0.9738611, 'f1': 0.9738537, 'auroc': 0.9953499, 'binary_precision': 0.9813506, 'binary_recall': 0.966111, 'binary_specificity': 0.98161125, 'binary_f1_score': 0.97367114}
confusion matrix:
       0      1
0  24929    467
1    862  24574
---- Validation: 
scalar performance:
{'acc': 0.96256495, 'precision': 0.647789, 'recall': 0.6892235, 'specificity': 0.6892235, 'f1': 0.66564214, 'auroc': 0.86905897, 'binary_precision': 0.3111511, 'binary_recall': 0.4013921, 'binary_specificity': 0.9770549, 'binary_f1_score': 0.35055724}
confusion matrix:
       0    1
0  16309  383
1    258  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9088296, 'precision': 0.6945386, 'recall': 0.763782, 'specificity': 0.763782, 'f1': 0.7219257, 'auroc': 0.8671888, 'binary_precision': 0.42318568, 'binary_recall': 0.59313077, 'binary_specificity': 0.9344333, 'binary_f1_score': 0.49394944}
confusion matrix:
      0    1
0  8722  612
1   308  449
early stop counter: 2
val acc:0.9625649452209473, best validation acc: 0.965835452079773, corresponding to test acc:                         0.9134872555732727 / 0.9163610935211182
after epoch: 6,now: 2024-08-08 01:40:59.824543,epoch time: 0:29:09.856149,used: 3:01:06.839021,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_22_39_52_seed_1_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9757633, 'precision': 0.97589165, 'recall': 0.9757706, 'specificity': 0.9757706, 'f1': 0.97576195, 'auroc': 0.99587554, 'binary_precision': 0.9839264, 'binary_recall': 0.96737164, 'binary_specificity': 0.9841695, 'binary_f1_score': 0.97557884}
confusion matrix:
       0      1
0  24992    402
1    830  24608
---- Validation: 
scalar performance:
{'acc': 0.9556153, 'precision': 0.6331147, 'recall': 0.72634387, 'specificity': 0.72634387, 'f1': 0.6659279, 'auroc': 0.8788661, 'binary_precision': 0.2797858, 'binary_recall': 0.4849188, 'binary_specificity': 0.96776897, 'binary_f1_score': 0.35483873}
confusion matrix:
       0    1
0  16154  538
1    222  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8966406, 'precision': 0.6805039, 'recall': 0.7911815, 'specificity': 0.7911815, 'f1': 0.7172154, 'auroc': 0.87555444, 'binary_precision': 0.3896605, 'binary_recall': 0.667107, 'binary_specificity': 0.915256, 'binary_f1_score': 0.491963}
confusion matrix:
      0    1
0  8543  791
1   252  505
early stop counter: 3
val acc:0.9556152820587158, best validation acc: 0.965835452079773, corresponding to test acc:                         0.9134872555732727 / 0.9163610935211182
after epoch: 7,now: 2024-08-08 02:09:42.836977,epoch time: 0:28:43.012434,used: 3:29:49.851455,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_22_39_52_seed_1_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 3:29:49.851455 at 2024-08-08 02:09:42.836977
persisted model performance metric: 

scalar performance:
{'acc': 0.91348726, 'precision': 0.70464957, 'recall': 0.7675136, 'specificity': 0.7675136, 'f1': 0.73037076, 'auroc': 0.8782196, 'binary_precision': 0.44302553, 'binary_recall': 0.5957728, 'binary_specificity': 0.93925434, 'binary_f1_score': 0.50816905}
confusion matrix:
      0    1
0  8767  567
1   306  451
oracle model performance metric: 

scalar performance:
{'acc': 0.9163611, 'precision': 0.7037084, 'recall': 0.72476083, 'specificity': 0.72476083, 'f1': 0.71353984, 'auroc': 0.87158, 'binary_precision': 0.4483986, 'binary_recall': 0.4993395, 'binary_specificity': 0.95018214, 'binary_f1_score': 0.4725}
confusion matrix:
      0    1
0  8869  465
1   379  378
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197429 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |  18218 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197429 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |  18218 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   2141 MiB | 621138 GiB | 621138 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 613133 GiB | 613133 GiB |
|       from small pool |  16662 KiB |     36 MiB |   8004 GiB |   8004 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2354 MiB |   2372 MiB |   4470 MiB |   2116 MiB |
|       from large pool |   2316 MiB |   2330 MiB |   4420 MiB |   2104 MiB |
|       from small pool |     38 MiB |     42 MiB |     50 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42187 KiB | 231558 KiB | 344074 GiB | 344074 GiB |
|       from large pool |  31733 KiB | 230336 KiB | 335832 GiB | 335832 GiB |
|       from small pool |  10454 KiB |  26061 KiB |   8242 GiB |   8242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4432    |    6849    |   94480 K  |   94476 K  |
|       from large pool |      79    |     252    |   56814 K  |   56814 K  |
|       from small pool |    4353    |    6769    |   37666 K  |   37661 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4432    |    6849    |   94480 K  |   94476 K  |
|       from large pool |      79    |     252    |   56814 K  |   56814 K  |
|       from small pool |    4353    |    6769    |   37666 K  |   37661 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     118    |     207    |      92    |
|       from large pool |      96    |      97    |     182    |      86    |
|       from small pool |      19    |      21    |      25    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    3194    |   62734 K  |   62734 K  |
|       from large pool |      11    |     100    |   43190 K  |   43190 K  |
|       from small pool |      29    |    3183    |   19544 K  |   19544 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |      0 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |      0 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 621138 GiB | 621138 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 613133 GiB | 613133 GiB |
|       from small pool |      0 KiB |     36 MiB |   8004 GiB |   8004 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   2372 MiB |   4470 MiB |   4236 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4420 MiB |   4214 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 231558 KiB | 344074 GiB | 344074 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 335832 GiB | 335832 GiB |
|       from small pool |      0 KiB |  26061 KiB |   8242 GiB |   8242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |   94480 K  |   94480 K  |
|       from large pool |       2    |     252    |   56814 K  |   56814 K  |
|       from small pool |       0    |    6769    |   37666 K  |   37666 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |   94480 K  |   94480 K  |
|       from large pool |       2    |     252    |   56814 K  |   56814 K  |
|       from small pool |       0    |    6769    |   37666 K  |   37666 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     118    |     207    |     183    |
|       from large pool |      10    |      97    |     182    |     172    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3194    |   62736 K  |   62736 K  |
|       from large pool |       3    |     100    |   43190 K  |   43190 K  |
|       from small pool |       0    |    3183    |   19546 K  |   19546 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |      0 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |      0 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 621138 GiB | 621138 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 613133 GiB | 613133 GiB |
|       from small pool |      0 KiB |     36 MiB |   8004 GiB |   8004 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   2372 MiB |   4470 MiB |   4236 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4420 MiB |   4214 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 231558 KiB | 344074 GiB | 344074 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 335832 GiB | 335832 GiB |
|       from small pool |      0 KiB |  26061 KiB |   8242 GiB |   8242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |   94480 K  |   94480 K  |
|       from large pool |       2    |     252    |   56814 K  |   56814 K  |
|       from small pool |       0    |    6769    |   37666 K  |   37666 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |   94480 K  |   94480 K  |
|       from large pool |       2    |     252    |   56814 K  |   56814 K  |
|       from small pool |       0    |    6769    |   37666 K  |   37666 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     118    |     207    |     183    |
|       from large pool |      10    |      97    |     182    |     172    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3194    |   62736 K  |   62736 K  |
|       from large pool |       3    |     100    |   43190 K  |   43190 K  |
|       from small pool |       0    |    3183    |   19546 K  |   19546 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_02_35_35_seed_2_24111563

 Experiment start at: 2024-08-08 02:35:35.545351
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.11296075582504272
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90467346, 'precision': 0.9165739, 'recall': 0.9046833, 'specificity': 0.9046833, 'f1': 0.9039893, 'auroc': 0.95372874, 'binary_precision': 0.9870118, 'binary_recall': 0.8201617, 'binary_specificity': 0.9892049, 'binary_f1_score': 0.8958844}
confusion matrix:
       0      1
0  25566    279
1   4649  21202
---- Validation: 
scalar performance:
{'acc': 0.9719692, 'precision': 0.51643354, 'recall': 0.50280935, 'specificity': 0.50280935, 'f1': 0.5010877, 'auroc': 0.53167486, 'binary_precision': 0.057142857, 'binary_recall': 0.009569378, 'binary_specificity': 0.99604934, 'binary_f1_score': 0.016393442}
confusion matrix:
       0   1
0  16640  66
1    414   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9198375, 'precision': 0.6108428, 'recall': 0.50451654, 'specificity': 0.50451654, 'f1': 0.48998588, 'auroc': 0.59616077, 'binary_precision': 0.3, 'binary_recall': 0.011292347, 'binary_specificity': 0.99774075, 'binary_f1_score': 0.021765418}
confusion matrix:
      0   1
0  9274  21
1   788   9
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 03:06:24.429170,epoch time: 0:30:48.883819,used: 0:30:48.883819,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_02_35_35_seed_2_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93661016, 'precision': 0.94026923, 'recall': 0.9366208, 'specificity': 0.9366208, 'f1': 0.9364792, 'auroc': 0.97232366, 'binary_precision': 0.9804639, 'binary_recall': 0.8910033, 'binary_specificity': 0.98223823, 'binary_f1_score': 0.9335954}
confusion matrix:
       0      1
0  25383    459
1   2818  23036
---- Validation: 
scalar performance:
{'acc': 0.9699252, 'precision': 0.5880012, 'recall': 0.5344166, 'specificity': 0.5344166, 'f1': 0.5476197, 'auroc': 0.6887766, 'binary_precision': 0.19875777, 'binary_recall': 0.07655502, 'binary_specificity': 0.9922782, 'binary_f1_score': 0.110535406}
confusion matrix:
       0    1
0  16577  129
1    386   32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92092746, 'precision': 0.7024744, 'recall': 0.50797606, 'specificity': 0.50797606, 'f1': 0.49633753, 'auroc': 0.68539184, 'binary_precision': 0.4827586, 'binary_recall': 0.017565873, 'binary_specificity': 0.9983862, 'binary_f1_score': 0.03389831}
confusion matrix:
      0   1
0  9280  15
1   783  14
new oracle model saved
early stop counter: 1
val acc:0.9699252247810364, best validation acc: 0.9719691872596741, corresponding to test acc:                         0.919837474822998 / 0.9209274649620056
after epoch: 2,now: 2024-08-08 03:35:28.542661,epoch time: 0:29:04.113491,used: 0:59:52.997310,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_02_35_35_seed_2_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94933844, 'precision': 0.9521724, 'recall': 0.9493476, 'specificity': 0.9493476, 'f1': 0.94925964, 'auroc': 0.9809233, 'binary_precision': 0.98802775, 'binary_recall': 0.9097238, 'binary_specificity': 0.9889714, 'binary_f1_score': 0.9472603}
confusion matrix:
       0      1
0  25557    285
1   2334  23520
---- Validation: 
scalar performance:
{'acc': 0.9734875, 'precision': 0.6846856, 'recall': 0.5735621, 'specificity': 0.5735621, 'f1': 0.60322297, 'auroc': 0.76292646, 'binary_precision': 0.3902439, 'binary_recall': 0.15311004, 'binary_specificity': 0.99401414, 'binary_f1_score': 0.21993127}
confusion matrix:
       0    1
0  16606  100
1    354   64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221165, 'precision': 0.76378536, 'recall': 0.51894563, 'specificity': 0.51894563, 'f1': 0.51732016, 'auroc': 0.7380955, 'binary_precision': 0.6037736, 'binary_recall': 0.040150564, 'binary_specificity': 0.99774075, 'binary_f1_score': 0.075294115}
confusion matrix:
      0   1
0  9274  21
1   765  32
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-08 04:05:19.844009,epoch time: 0:29:51.301348,used: 1:29:44.298658,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_02_35_35_seed_2_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9580625, 'precision': 0.9599614, 'recall': 0.95807123, 'specificity': 0.95807123, 'f1': 0.95801973, 'auroc': 0.986151, 'binary_precision': 0.9895829, 'binary_recall': 0.92589444, 'binary_specificity': 0.9902481, 'binary_f1_score': 0.9566799}
confusion matrix:
       0      1
0  25589    252
1   1916  23939
---- Validation: 
scalar performance:
{'acc': 0.97266996, 'precision': 0.6922417, 'recall': 0.6197928, 'specificity': 0.6197928, 'f1': 0.6468761, 'auroc': 0.8088635, 'binary_precision': 0.4031008, 'binary_recall': 0.24880382, 'binary_specificity': 0.9907818, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  16552  154
1    314  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233056, 'precision': 0.76043534, 'recall': 0.5431071, 'specificity': 0.5431071, 'f1': 0.5592585, 'auroc': 0.7631385, 'binary_precision': 0.5934959, 'binary_recall': 0.091593474, 'binary_specificity': 0.99462074, 'binary_f1_score': 0.15869565}
confusion matrix:
      0   1
0  9245  50
1   724  73
new oracle model saved
early stop counter: 1
val acc:0.9726699590682983, best validation acc: 0.9734874963760376, corresponding to test acc:                         0.9221165180206299 / 0.9233055710792542
after epoch: 4,now: 2024-08-08 04:35:07.738175,epoch time: 0:29:47.894166,used: 1:59:32.192824,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_02_35_35_seed_2_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96403974, 'precision': 0.9648887, 'recall': 0.9640406, 'specificity': 0.9640406, 'f1': 0.96402335, 'auroc': 0.989815, 'binary_precision': 0.984764, 'binary_recall': 0.942667, 'binary_specificity': 0.98541415, 'binary_f1_score': 0.96325576}
confusion matrix:
       0      1
0  25470    377
1   1482  24367
---- Validation: 
scalar performance:
{'acc': 0.966071, 'precision': 0.6543519, 'recall': 0.6712242, 'specificity': 0.6712242, 'f1': 0.6623012, 'auroc': 0.826328, 'binary_precision': 0.32473117, 'binary_recall': 0.36124402, 'binary_specificity': 0.98120433, 'binary_f1_score': 0.34201583}
confusion matrix:
       0    1
0  16392  314
1    267  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221165, 'precision': 0.7269182, 'recall': 0.5785959, 'specificity': 0.5785959, 'f1': 0.60799646, 'auroc': 0.788564, 'binary_precision': 0.5210728, 'binary_recall': 0.1706399, 'binary_specificity': 0.9865519, 'binary_f1_score': 0.25708884}
confusion matrix:
      0    1
0  9170  125
1   661  136
early stop counter: 2
val acc:0.9660710096359253, best validation acc: 0.9734874963760376, corresponding to test acc:                         0.9221165180206299 / 0.9233055710792542
after epoch: 5,now: 2024-08-08 05:04:20.348305,epoch time: 0:29:12.610130,used: 2:28:44.802954,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_02_35_35_seed_2_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96759903, 'precision': 0.9686432, 'recall': 0.9676008, 'specificity': 0.9676008, 'f1': 0.96758103, 'auroc': 0.9914596, 'binary_precision': 0.9907832, 'binary_recall': 0.9439845, 'binary_specificity': 0.9912172, 'binary_f1_score': 0.96681786}
confusion matrix:
       0      1
0  25619    227
1   1448  24402
---- Validation: 
scalar performance:
{'acc': 0.96776456, 'precision': 0.65496594, 'recall': 0.64410233, 'specificity': 0.64410233, 'f1': 0.6493151, 'auroc': 0.8381089, 'binary_precision': 0.3273196, 'binary_recall': 0.30382776, 'binary_specificity': 0.98437685, 'binary_f1_score': 0.31513646}
confusion matrix:
       0    1
0  16445  261
1    291  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92191833, 'precision': 0.7277552, 'recall': 0.55095744, 'specificity': 0.55095744, 'f1': 0.57078683, 'auroc': 0.7976459, 'binary_precision': 0.5269461, 'binary_recall': 0.11041405, 'binary_specificity': 0.9915008, 'binary_f1_score': 0.18257262}
confusion matrix:
      0   1
0  9216  79
1   709  88
early stop counter: 3
val acc:0.9677645564079285, best validation acc: 0.9734874963760376, corresponding to test acc:                         0.9221165180206299 / 0.9233055710792542
after epoch: 6,now: 2024-08-08 05:34:14.872801,epoch time: 0:29:54.524496,used: 2:58:39.327450,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_02_35_35_seed_2_24111563
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 2:58:39.327450 at 2024-08-08 05:34:14.872801
persisted model performance metric: 

scalar performance:
{'acc': 0.9221165, 'precision': 0.76378536, 'recall': 0.51894563, 'specificity': 0.51894563, 'f1': 0.51732016, 'auroc': 0.7380955, 'binary_precision': 0.6037736, 'binary_recall': 0.040150564, 'binary_specificity': 0.99774075, 'binary_f1_score': 0.075294115}
confusion matrix:
      0   1
0  9274  21
1   765  32
oracle model performance metric: 

scalar performance:
{'acc': 0.9233056, 'precision': 0.76043534, 'recall': 0.5431071, 'specificity': 0.5431071, 'f1': 0.5592585, 'auroc': 0.7631385, 'binary_precision': 0.5934959, 'binary_recall': 0.091593474, 'binary_specificity': 0.99462074, 'binary_f1_score': 0.15869565}
confusion matrix:
      0   1
0  9245  50
1   724  73
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197429 KiB |   2142 MiB |    914 TiB |    914 TiB |
|       from large pool | 179211 KiB |   2124 MiB |    903 TiB |    903 TiB |
|       from small pool |  18218 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197429 KiB |   2142 MiB |    914 TiB |    914 TiB |
|       from large pool | 179211 KiB |   2124 MiB |    903 TiB |    903 TiB |
|       from small pool |  18218 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   2141 MiB |    914 TiB |    914 TiB |
|       from large pool | 178979 KiB |   2123 MiB |    902 TiB |    902 TiB |
|       from small pool |  16662 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2362 MiB |   2372 MiB |   6598 MiB |   4236 MiB |
|       from large pool |   2324 MiB |   2330 MiB |   6538 MiB |   4214 MiB |
|       from small pool |     38 MiB |     42 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42187 KiB | 233721 KiB | 512624 GiB | 512624 GiB |
|       from large pool |  31733 KiB | 231736 KiB | 500137 GiB | 500137 GiB |
|       from small pool |  10454 KiB |  26061 KiB |  12487 GiB |  12487 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4432    |    6957    |  142426 K  |  142422 K  |
|       from large pool |      79    |     252    |   85677 K  |   85677 K  |
|       from small pool |    4353    |    6877    |   56748 K  |   56744 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4432    |    6957    |  142426 K  |  142422 K  |
|       from large pool |      79    |     252    |   85677 K  |   85677 K  |
|       from small pool |    4353    |    6877    |   56748 K  |   56744 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     118    |     299    |     183    |
|       from large pool |      97    |      97    |     269    |     172    |
|       from small pool |      19    |      21    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    3247    |   95674 K  |   95674 K  |
|       from large pool |      11    |     101    |   65242 K  |   65242 K  |
|       from small pool |      29    |    3236    |   30431 K  |   30431 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB |    914 TiB |    914 TiB |
|       from large pool |  16640 KiB |   2124 MiB |    903 TiB |    903 TiB |
|       from small pool |      0 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB |    914 TiB |    914 TiB |
|       from large pool |  16640 KiB |   2124 MiB |    903 TiB |    903 TiB |
|       from small pool |      0 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB |    914 TiB |    914 TiB |
|       from large pool |  16640 KiB |   2123 MiB |    902 TiB |    902 TiB |
|       from small pool |      0 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   2372 MiB |   6598 MiB |   6364 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   6538 MiB |   6332 MiB |
|       from small pool |  28672 KiB |     42 MiB |     60 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 233721 KiB | 512624 GiB | 512624 GiB |
|       from large pool |  30464 KiB | 231736 KiB | 500137 GiB | 500137 GiB |
|       from small pool |      0 KiB |  26061 KiB |  12487 GiB |  12487 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  142426 K  |  142426 K  |
|       from large pool |       2    |     252    |   85677 K  |   85677 K  |
|       from small pool |       0    |    6877    |   56748 K  |   56748 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  142426 K  |  142426 K  |
|       from large pool |       2    |     252    |   85677 K  |   85677 K  |
|       from small pool |       0    |    6877    |   56748 K  |   56748 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     118    |     299    |     275    |
|       from large pool |      10    |      97    |     269    |     259    |
|       from small pool |      14    |      21    |      30    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3247    |   95676 K  |   95676 K  |
|       from large pool |       3    |     101    |   65242 K  |   65242 K  |
|       from small pool |       0    |    3236    |   30433 K  |   30433 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  8 05:52:19 2024]
Finished job 0.
1 of 1 steps (100%) done
