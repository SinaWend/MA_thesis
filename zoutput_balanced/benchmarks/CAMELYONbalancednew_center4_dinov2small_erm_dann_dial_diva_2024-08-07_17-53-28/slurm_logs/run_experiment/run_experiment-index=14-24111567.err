Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  8 01:30:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/14.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=14
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_01_40_10_seed_0_24111567

 Experiment start at: 2024-08-08 01:40:10.428735
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9504501, 'precision': 0.95263547, 'recall': 0.95047486, 'specificity': 0.95047486, 'f1': 0.9503921, 'auroc': 0.98614633, 'binary_precision': 0.98426497, 'binary_recall': 0.915608, 'binary_specificity': 0.9853418, 'binary_f1_score': 0.9486959}
confusion matrix:
       0      1
0  24939    371
1   2139  23207
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9275633, 'precision': 0.59134614, 'recall': 0.77959347, 'specificity': 0.77959347, 'f1': 0.6280702, 'auroc': 0.8848311, 'binary_precision': 0.19256505, 'binary_recall': 0.6240964, 'binary_specificity': 0.93509054, 'binary_f1_score': 0.29431817}
confusion matrix:
       0     1
0  15645  1086
1    156   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8454617, 'precision': 0.62485164, 'recall': 0.760085, 'specificity': 0.760085, 'f1': 0.65292525, 'auroc': 0.85956264, 'binary_precision': 0.28137094, 'binary_recall': 0.65932643, 'binary_specificity': 0.8608435, 'binary_f1_score': 0.3944208}
confusion matrix:
      0     1
0  8042  1300
1   263   509
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 02:22:29.204214,epoch time: 0:42:18.775479,used: 0:42:18.775479,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_01_40_10_seed_0_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9618012, 'precision': 0.96324515, 'recall': 0.96181774, 'specificity': 0.96181774, 'f1': 0.9617723, 'auroc': 0.9916811, 'binary_precision': 0.98925674, 'binary_recall': 0.9337884, 'binary_specificity': 0.9898471, 'binary_f1_score': 0.9607226}
confusion matrix:
       0      1
0  25056    257
1   1678  23665
---- Validation: 
scalar performance:
{'acc': 0.9284964, 'precision': 0.60003346, 'recall': 0.81531966, 'specificity': 0.81531966, 'f1': 0.641331, 'auroc': 0.9023248, 'binary_precision': 0.20806335, 'binary_recall': 0.69638556, 'binary_specificity': 0.93425375, 'binary_f1_score': 0.32039908}
confusion matrix:
       0     1
0  15631  1100
1    126   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85129523, 'precision': 0.63418967, 'recall': 0.7786906, 'specificity': 0.7786906, 'f1': 0.66525114, 'auroc': 0.87247455, 'binary_precision': 0.29689234, 'binary_recall': 0.6930052, 'binary_specificity': 0.86437595, 'binary_f1_score': 0.41569543}
confusion matrix:
      0     1
0  8075  1267
1   237   535
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 03:00:17.719577,epoch time: 0:37:48.515363,used: 1:20:07.290842,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_01_40_10_seed_0_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663811, 'precision': 0.9674728, 'recall': 0.96639544, 'specificity': 0.96639544, 'f1': 0.9663621, 'auroc': 0.9935458, 'binary_precision': 0.9902123, 'binary_recall': 0.9421142, 'binary_specificity': 0.9906767, 'binary_f1_score': 0.96556455}
confusion matrix:
       0      1
0  25077    236
1   1467  23876
---- Validation: 
scalar performance:
{'acc': 0.93193746, 'precision': 0.603437, 'recall': 0.8112082, 'specificity': 0.8112082, 'f1': 0.6457663, 'auroc': 0.9040987, 'binary_precision': 0.21515152, 'binary_recall': 0.6843374, 'binary_specificity': 0.938079, 'binary_f1_score': 0.32737753}
confusion matrix:
       0     1
0  15695  1036
1    131   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619735, 'precision': 0.6365261, 'recall': 0.7589226, 'specificity': 0.7589226, 'f1': 0.6676147, 'auroc': 0.86646414, 'binary_precision': 0.30597016, 'binary_recall': 0.6373057, 'binary_specificity': 0.8805395, 'binary_f1_score': 0.41344538}
confusion matrix:
      0     1
0  8226  1116
1   280   492
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-08 03:38:24.035869,epoch time: 0:38:06.316292,used: 1:58:13.607134,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_01_40_10_seed_0_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97123736, 'precision': 0.97201335, 'recall': 0.9712511, 'specificity': 0.9712511, 'f1': 0.9712261, 'auroc': 0.99483705, 'binary_precision': 0.99132043, 'binary_recall': 0.95083845, 'binary_specificity': 0.9916637, 'binary_f1_score': 0.9706575}
confusion matrix:
       0      1
0  25100    211
1   1246  24099
---- Validation: 
scalar performance:
{'acc': 0.9415024, 'precision': 0.61899143, 'recall': 0.8172842, 'specificity': 0.8172842, 'f1': 0.665855, 'auroc': 0.90821373, 'binary_precision': 0.24611399, 'binary_recall': 0.686747, 'binary_specificity': 0.94782144, 'binary_f1_score': 0.36236492}
confusion matrix:
       0    1
0  15858  873
1    130  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8800672, 'precision': 0.65553963, 'recall': 0.7651522, 'specificity': 0.7651522, 'f1': 0.68881154, 'auroc': 0.87567925, 'binary_precision': 0.34394905, 'binary_recall': 0.6295337, 'binary_specificity': 0.9007707, 'binary_f1_score': 0.44485128}
confusion matrix:
      0    1
0  8415  927
1   286  486
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-08 04:16:15.314701,epoch time: 0:37:51.278832,used: 2:36:04.885966,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_01_40_10_seed_0_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9718296, 'precision': 0.9725945, 'recall': 0.9718432, 'specificity': 0.9718432, 'f1': 0.9718188, 'auroc': 0.995684, 'binary_precision': 0.99177563, 'binary_recall': 0.9515881, 'binary_specificity': 0.9920983, 'binary_f1_score': 0.9712664}
confusion matrix:
       0      1
0  25111    200
1   1227  24118
---- Validation: 
scalar performance:
{'acc': 0.9467514, 'precision': 0.6247682, 'recall': 0.798825, 'specificity': 0.798825, 'f1': 0.67062116, 'auroc': 0.90740085, 'binary_precision': 0.25872093, 'binary_recall': 0.6433735, 'binary_specificity': 0.9542765, 'binary_f1_score': 0.36903942}
confusion matrix:
       0    1
0  15966  765
1    148  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8898556, 'precision': 0.6671457, 'recall': 0.7645094, 'specificity': 0.7645094, 'f1': 0.6997285, 'auroc': 0.88019246, 'binary_precision': 0.36785161, 'binary_recall': 0.6165803, 'binary_specificity': 0.91243845, 'binary_f1_score': 0.46079382}
confusion matrix:
      0    1
0  8524  818
1   296  476
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-08 04:54:18.413914,epoch time: 0:38:03.099213,used: 3:14:07.985179,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_01_40_10_seed_0_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9741788, 'precision': 0.974805, 'recall': 0.97418815, 'specificity': 0.97418815, 'f1': 0.97417057, 'auroc': 0.9958943, 'binary_precision': 0.99217695, 'binary_recall': 0.95592123, 'binary_specificity': 0.99245507, 'binary_f1_score': 0.97371167}
confusion matrix:
       0      1
0  25124    191
1   1117  24224
---- Validation: 
scalar performance:
{'acc': 0.9450601, 'precision': 0.6248448, 'recall': 0.8144074, 'specificity': 0.8144074, 'f1': 0.6724701, 'auroc': 0.91143066, 'binary_precision': 0.25803488, 'binary_recall': 0.6771084, 'binary_specificity': 0.9517064, 'binary_f1_score': 0.3736702}
confusion matrix:
       0    1
0  15923  808
1    134  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837254, 'precision': 0.66809547, 'recall': 0.77558947, 'specificity': 0.77558947, 'f1': 0.7026762, 'auroc': 0.8838433, 'binary_precision': 0.36767977, 'binary_recall': 0.64248705, 'binary_specificity': 0.90869194, 'binary_f1_score': 0.4677039}
confusion matrix:
      0    1
0  8489  853
1   276  496
early stop counter: 1
val acc:0.9450600743293762, best validation acc: 0.9467514157295227, corresponding to test acc:                         0.8898556232452393 / 0.8898556232452393
after epoch: 6,now: 2024-08-08 05:32:27.023313,epoch time: 0:38:08.609399,used: 3:52:16.594578,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_01_40_10_seed_0_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97767293, 'precision': 0.9778998, 'recall': 0.9776795, 'specificity': 0.9776795, 'f1': 0.97767055, 'auroc': 0.9969765, 'binary_precision': 0.9884603, 'binary_recall': 0.96665746, 'binary_specificity': 0.98870146, 'binary_f1_score': 0.9774373}
confusion matrix:
       0      1
0  25027    286
1    845  24498
---- Validation: 
scalar performance:
{'acc': 0.9389945, 'precision': 0.6135705, 'recall': 0.81129944, 'specificity': 0.81129944, 'f1': 0.6587496, 'auroc': 0.9088509, 'binary_precision': 0.23554066, 'binary_recall': 0.6771084, 'binary_specificity': 0.9454904, 'binary_f1_score': 0.3495025}
confusion matrix:
       0    1
0  15819  912
1    134  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8663239, 'precision': 0.65672064, 'recall': 0.8195039, 'specificity': 0.8195039, 'f1': 0.69481665, 'auroc': 0.89190304, 'binary_precision': 0.33522728, 'binary_recall': 0.7642487, 'binary_specificity': 0.87475914, 'binary_f1_score': 0.4660348}
confusion matrix:
      0     1
0  8172  1170
1   182   590
early stop counter: 2
val acc:0.9389945268630981, best validation acc: 0.9467514157295227, corresponding to test acc:                         0.8898556232452393 / 0.8898556232452393
after epoch: 7,now: 2024-08-08 06:10:23.672628,epoch time: 0:37:56.649315,used: 4:30:13.243893,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_01_40_10_seed_0_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9784231, 'precision': 0.97884667, 'recall': 0.97843254, 'specificity': 0.97843254, 'f1': 0.9784186, 'auroc': 0.9967345, 'binary_precision': 0.9932474, 'binary_recall': 0.9634233, 'binary_specificity': 0.9934418, 'binary_f1_score': 0.97810805}
confusion matrix:
       0      1
0  25146    166
1    927  24417
---- Validation: 
scalar performance:
{'acc': 0.93281233, 'precision': 0.60566187, 'recall': 0.8163562, 'specificity': 0.8163562, 'f1': 0.6489784, 'auroc': 0.90839005, 'binary_precision': 0.21934502, 'binary_recall': 0.6939759, 'binary_specificity': 0.9387365, 'binary_f1_score': 0.33333334}
confusion matrix:
       0     1
0  15706  1025
1    127   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8634566, 'precision': 0.6525849, 'recall': 0.8126044, 'specificity': 0.8126044, 'f1': 0.68942595, 'auroc': 0.8923038, 'binary_precision': 0.32806325, 'binary_recall': 0.75259066, 'binary_specificity': 0.87261826, 'binary_f1_score': 0.45694062}
confusion matrix:
      0     1
0  8152  1190
1   191   581
early stop counter: 3
val acc:0.9328123331069946, best validation acc: 0.9467514157295227, corresponding to test acc:                         0.8898556232452393 / 0.8898556232452393
after epoch: 8,now: 2024-08-08 06:47:53.939637,epoch time: 0:37:30.267009,used: 5:07:43.510902,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_01_40_10_seed_0_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 5:07:43.510902 at 2024-08-08 06:47:53.939637
persisted model performance metric: 

scalar performance:
{'acc': 0.8898556, 'precision': 0.6671457, 'recall': 0.7645094, 'specificity': 0.7645094, 'f1': 0.6997285, 'auroc': 0.88019246, 'binary_precision': 0.36785161, 'binary_recall': 0.6165803, 'binary_specificity': 0.91243845, 'binary_f1_score': 0.46079382}
confusion matrix:
      0    1
0  8524  818
1   296  476
oracle model performance metric: 

scalar performance:
{'acc': 0.8898556, 'precision': 0.6671457, 'recall': 0.7645094, 'specificity': 0.7645094, 'f1': 0.6997285, 'auroc': 0.88019246, 'binary_precision': 0.36785161, 'binary_recall': 0.6165803, 'binary_specificity': 0.91243845, 'binary_f1_score': 0.46079382}
confusion matrix:
      0    1
0  8524  818
1   296  476
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/14.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   4047 MiB | 763649 GiB | 763649 GiB |
|       from large pool | 180662 KiB |   4028 MiB | 755075 GiB | 755075 GiB |
|       from small pool |  18214 KiB |     38 MiB |   8574 GiB |   8574 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   4047 MiB | 763649 GiB | 763649 GiB |
|       from large pool | 180662 KiB |   4028 MiB | 755075 GiB | 755075 GiB |
|       from small pool |  18214 KiB |     38 MiB |   8574 GiB |   8574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   4045 MiB | 763565 GiB | 763565 GiB |
|       from large pool | 178979 KiB |   4026 MiB | 755000 GiB | 755000 GiB |
|       from small pool |  16663 KiB |     36 MiB |   8564 GiB |   8564 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4936 MiB |   4936 MiB |   4936 MiB |      0 B   |
|       from large pool |   4894 MiB |   4894 MiB |   4894 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  65316 KiB |    864 MiB | 462959 GiB | 462959 GiB |
|       from large pool |  50762 KiB |    862 MiB | 454332 GiB | 454332 GiB |
|       from small pool |  14554 KiB |     14 MiB |   8626 GiB |   8626 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6807    |   98776 K  |   98771 K  |
|       from large pool |      79    |     423    |   66910 K  |   66910 K  |
|       from small pool |    4345    |    6727    |   31865 K  |   31861 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6807    |   98776 K  |   98771 K  |
|       from large pool |      79    |     423    |   66910 K  |   66910 K  |
|       from small pool |    4345    |    6727    |   31865 K  |   31861 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     181    |     181    |     181    |       0    |
|       from large pool |     160    |     160    |     160    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3187    |   63400 K  |   63400 K  |
|       from large pool |      10    |     163    |   50060 K  |   50060 K  |
|       from small pool |      26    |    3177    |   13340 K  |   13340 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB | 763649 GiB | 763649 GiB |
|       from large pool |  16640 KiB |   4028 MiB | 755075 GiB | 755075 GiB |
|       from small pool |      0 KiB |     38 MiB |   8574 GiB |   8574 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB | 763649 GiB | 763649 GiB |
|       from large pool |  16640 KiB |   4028 MiB | 755075 GiB | 755075 GiB |
|       from small pool |      0 KiB |     38 MiB |   8574 GiB |   8574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 763565 GiB | 763565 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 755000 GiB | 755000 GiB |
|       from small pool |      0 KiB |     36 MiB |   8564 GiB |   8564 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 264192 KiB |   4936 MiB |   4936 MiB |   4678 MiB |
|       from large pool | 231424 KiB |   4894 MiB |   4894 MiB |   4668 MiB |
|       from small pool |  32768 KiB |     42 MiB |     42 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB | 462959 GiB | 462959 GiB |
|       from large pool |  30464 KiB |    862 MiB | 454332 GiB | 454332 GiB |
|       from small pool |      0 KiB |     26 MiB |   8626 GiB |   8626 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |   98776 K  |   98776 K  |
|       from large pool |       2    |     423    |   66910 K  |   66910 K  |
|       from small pool |       0    |    6727    |   31865 K  |   31865 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |   98776 K  |   98776 K  |
|       from large pool |       2    |     423    |   66910 K  |   66910 K  |
|       from small pool |       0    |    6727    |   31865 K  |   31865 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |     181    |     181    |     154    |
|       from large pool |      11    |     160    |     160    |     149    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3187    |   63402 K  |   63402 K  |
|       from large pool |       3    |     163    |   50060 K  |   50060 K  |
|       from small pool |       0    |    3177    |   13342 K  |   13342 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB | 763649 GiB | 763649 GiB |
|       from large pool |  16640 KiB |   4028 MiB | 755075 GiB | 755075 GiB |
|       from small pool |      0 KiB |     38 MiB |   8574 GiB |   8574 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB | 763649 GiB | 763649 GiB |
|       from large pool |  16640 KiB |   4028 MiB | 755075 GiB | 755075 GiB |
|       from small pool |      0 KiB |     38 MiB |   8574 GiB |   8574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 763565 GiB | 763565 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 755000 GiB | 755000 GiB |
|       from small pool |      0 KiB |     36 MiB |   8564 GiB |   8564 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 264192 KiB |   4936 MiB |   4936 MiB |   4678 MiB |
|       from large pool | 231424 KiB |   4894 MiB |   4894 MiB |   4668 MiB |
|       from small pool |  32768 KiB |     42 MiB |     42 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB | 462959 GiB | 462959 GiB |
|       from large pool |  30464 KiB |    862 MiB | 454332 GiB | 454332 GiB |
|       from small pool |      0 KiB |     26 MiB |   8626 GiB |   8626 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |   98776 K  |   98776 K  |
|       from large pool |       2    |     423    |   66910 K  |   66910 K  |
|       from small pool |       0    |    6727    |   31865 K  |   31865 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |   98776 K  |   98776 K  |
|       from large pool |       2    |     423    |   66910 K  |   66910 K  |
|       from small pool |       0    |    6727    |   31865 K  |   31865 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |     181    |     181    |     154    |
|       from large pool |      11    |     160    |     160    |     149    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3187    |   63402 K  |   63402 K  |
|       from large pool |       3    |     163    |   50060 K  |   50060 K  |
|       from small pool |       0    |    3177    |   13342 K  |   13342 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567

 Experiment start at: 2024-08-08 07:09:28.716900
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9448576, 'precision': 0.94711554, 'recall': 0.9448856, 'specificity': 0.9448856, 'f1': 0.94479024, 'auroc': 0.98452467, 'binary_precision': 0.9790864, 'binary_recall': 0.90922314, 'binary_specificity': 0.98054814, 'binary_f1_score': 0.9428624}
confusion matrix:
       0      1
0  24902    494
1   2309  23127
---- Validation: 
scalar performance:
{'acc': 0.94352627, 'precision': 0.5966254, 'recall': 0.69980085, 'specificity': 0.69980085, 'f1': 0.626889, 'auroc': 0.8639777, 'binary_precision': 0.208061, 'binary_recall': 0.44315544, 'binary_specificity': 0.95644623, 'binary_f1_score': 0.28317273}
confusion matrix:
       0    1
0  15965  727
1    240  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89039737, 'precision': 0.6275189, 'recall': 0.65003264, 'specificity': 0.65003264, 'f1': 0.63740873, 'auroc': 0.8522222, 'binary_precision': 0.3071823, 'binary_recall': 0.3672391, 'binary_specificity': 0.9328262, 'binary_f1_score': 0.33453667}
confusion matrix:
      0    1
0  8707  627
1   479  278
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 07:49:09.410804,epoch time: 0:39:40.693904,used: 0:39:40.693904,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95988744, 'precision': 0.9609001, 'recall': 0.95990694, 'specificity': 0.95990694, 'f1': 0.9598666, 'auroc': 0.9914662, 'binary_precision': 0.9827117, 'binary_recall': 0.9363133, 'binary_specificity': 0.98350066, 'binary_f1_score': 0.95895153}
confusion matrix:
       0      1
0  24976    419
1   1620  23817
---- Validation: 
scalar performance:
{'acc': 0.9452783, 'precision': 0.6213941, 'recall': 0.778679, 'specificity': 0.778679, 'f1': 0.6641605, 'auroc': 0.88904464, 'binary_precision': 0.2534113, 'binary_recall': 0.60324824, 'binary_specificity': 0.9541097, 'binary_f1_score': 0.3568977}
confusion matrix:
       0    1
0  15926  766
1    171  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88048756, 'precision': 0.660838, 'recall': 0.79155403, 'specificity': 0.79155403, 'f1': 0.69790316, 'auroc': 0.87897176, 'binary_precision': 0.34922767, 'binary_recall': 0.6869221, 'binary_specificity': 0.896186, 'binary_f1_score': 0.46304542}
confusion matrix:
      0    1
0  8365  969
1   237  520
better model found
persisted
after epoch: 2,now: 2024-08-08 08:26:41.255472,epoch time: 0:37:31.844668,used: 1:17:12.538572,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9665368, 'precision': 0.9673104, 'recall': 0.96655214, 'specificity': 0.96655214, 'f1': 0.96652377, 'auroc': 0.99403894, 'binary_precision': 0.98651195, 'binary_recall': 0.9460586, 'binary_specificity': 0.9870457, 'binary_f1_score': 0.9658619}
confusion matrix:
       0      1
0  25068    329
1   1372  24063
---- Validation: 
scalar performance:
{'acc': 0.94486946, 'precision': 0.6272767, 'recall': 0.8078529, 'specificity': 0.8078529, 'f1': 0.6742333, 'auroc': 0.90491164, 'binary_precision': 0.26359448, 'binary_recall': 0.6635731, 'binary_specificity': 0.95213276, 'binary_f1_score': 0.37730873}
confusion matrix:
       0    1
0  15893  799
1    145  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8797939, 'precision': 0.65698385, 'recall': 0.7796473, 'specificity': 0.7796473, 'f1': 0.69242877, 'auroc': 0.87606716, 'binary_precision': 0.3436214, 'binary_recall': 0.661823, 'binary_specificity': 0.8974716, 'binary_f1_score': 0.4523702}
confusion matrix:
      0    1
0  8377  957
1   256  501
early stop counter: 1
val acc:0.9448694586753845, best validation acc: 0.9452782869338989, corresponding to test acc:                         0.8804875612258911 / 0.8903973698616028
after epoch: 3,now: 2024-08-08 09:04:13.779748,epoch time: 0:37:32.524276,used: 1:54:45.062848,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96905494, 'precision': 0.97005194, 'recall': 0.9690713, 'specificity': 0.9690713, 'f1': 0.9690393, 'auroc': 0.9952997, 'binary_precision': 0.991878, 'binary_recall': 0.9458992, 'binary_specificity': 0.99224347, 'binary_f1_score': 0.9683431}
confusion matrix:
       0      1
0  25201    197
1   1376  24058
---- Validation: 
scalar performance:
{'acc': 0.94884074, 'precision': 0.62915385, 'recall': 0.7793761, 'specificity': 0.7793761, 'f1': 0.6724638, 'auroc': 0.907328, 'binary_precision': 0.2689512, 'binary_recall': 0.60092807, 'binary_specificity': 0.9578241, 'binary_f1_score': 0.37159258}
confusion matrix:
       0    1
0  15988  704
1    172  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88474876, 'precision': 0.65851235, 'recall': 0.7647246, 'specificity': 0.7647246, 'f1': 0.6918436, 'auroc': 0.8692554, 'binary_precision': 0.34962964, 'binary_recall': 0.6235139, 'binary_specificity': 0.9059353, 'binary_f1_score': 0.44803038}
confusion matrix:
      0    1
0  8456  878
1   285  472
better model found
persisted
after epoch: 4,now: 2024-08-08 09:41:53.592815,epoch time: 0:37:39.813067,used: 2:32:24.875915,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97377634, 'precision': 0.9742071, 'recall': 0.97379017, 'specificity': 0.97379017, 'f1': 0.97377086, 'auroc': 0.9957905, 'binary_precision': 0.98872757, 'binary_recall': 0.9585282, 'binary_specificity': 0.9890521, 'binary_f1_score': 0.9733937}
confusion matrix:
       0      1
0  25115    278
1   1055  24384
---- Validation: 
scalar performance:
{'acc': 0.9406062, 'precision': 0.61769193, 'recall': 0.80001557, 'specificity': 0.80001557, 'f1': 0.6623946, 'auroc': 0.9120805, 'binary_precision': 0.24477352, 'binary_recall': 0.6519722, 'binary_specificity': 0.94805896, 'binary_f1_score': 0.35592148}
confusion matrix:
       0    1
0  15825  867
1    150  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86958677, 'precision': 0.64495754, 'recall': 0.77230906, 'specificity': 0.77230906, 'f1': 0.6785764, 'auroc': 0.85788083, 'binary_precision': 0.32025725, 'binary_recall': 0.65786, 'binary_specificity': 0.8867581, 'binary_f1_score': 0.43079585}
confusion matrix:
      0     1
0  8277  1057
1   259   498
early stop counter: 1
val acc:0.9406061768531799, best validation acc: 0.9488407373428345, corresponding to test acc:                         0.8847487568855286 / 0.8903973698616028
after epoch: 5,now: 2024-08-08 10:19:47.799061,epoch time: 0:37:54.206246,used: 3:10:19.082161,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97574365, 'precision': 0.9759693, 'recall': 0.97575235, 'specificity': 0.97575235, 'f1': 0.9757411, 'auroc': 0.9962899, 'binary_precision': 0.98653156, 'binary_recall': 0.9646957, 'binary_specificity': 0.98680896, 'binary_f1_score': 0.97549146}
confusion matrix:
       0      1
0  25061    335
1    898  24538
---- Validation: 
scalar performance:
{'acc': 0.9307364, 'precision': 0.6051155, 'recall': 0.80964506, 'specificity': 0.80964506, 'f1': 0.6474653, 'auroc': 0.91107017, 'binary_precision': 0.21891288, 'binary_recall': 0.68213457, 'binary_specificity': 0.93715554, 'binary_f1_score': 0.33145437}
confusion matrix:
       0     1
0  15643  1049
1    137   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8531365, 'precision': 0.6322083, 'recall': 0.7737347, 'specificity': 0.7737347, 'f1': 0.66308045, 'auroc': 0.8577316, 'binary_precision': 0.2934473, 'binary_recall': 0.68031704, 'binary_specificity': 0.86715233, 'binary_f1_score': 0.41003186}
confusion matrix:
      0     1
0  8094  1240
1   242   515
early stop counter: 2
val acc:0.9307364225387573, best validation acc: 0.9488407373428345, corresponding to test acc:                         0.8847487568855286 / 0.8903973698616028
after epoch: 6,now: 2024-08-08 10:58:08.981499,epoch time: 0:38:21.182438,used: 3:48:40.264599,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97743547, 'precision': 0.9778135, 'recall': 0.9774473, 'specificity': 0.9774473, 'f1': 0.9774314, 'auroc': 0.99687326, 'binary_precision': 0.99146163, 'binary_recall': 0.9632032, 'binary_specificity': 0.9916913, 'binary_f1_score': 0.97712815}
confusion matrix:
       0      1
0  25184    211
1    936  24501
---- Validation: 
scalar performance:
{'acc': 0.94889915, 'precision': 0.6308973, 'recall': 0.7861869, 'specificity': 0.7861869, 'f1': 0.67529035, 'auroc': 0.91078854, 'binary_precision': 0.27207392, 'binary_recall': 0.6148492, 'binary_specificity': 0.95752454, 'binary_f1_score': 0.3772242}
confusion matrix:
       0    1
0  15983  709
1    166  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87989295, 'precision': 0.64468324, 'recall': 0.7360016, 'specificity': 0.7360016, 'f1': 0.6737879, 'auroc': 0.84490407, 'binary_precision': 0.32673267, 'binary_recall': 0.5667107, 'binary_specificity': 0.90529245, 'binary_f1_score': 0.41449276}
confusion matrix:
      0    1
0  8450  884
1   328  429
better model found
persisted
after epoch: 7,now: 2024-08-08 11:38:36.123755,epoch time: 0:40:27.142256,used: 4:29:07.406855,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9774158, 'precision': 0.97795343, 'recall': 0.97742915, 'specificity': 0.97742915, 'f1': 0.9774099, 'auroc': 0.99703646, 'binary_precision': 0.99418086, 'binary_recall': 0.9604891, 'binary_specificity': 0.9943692, 'binary_f1_score': 0.9770446}
confusion matrix:
       0      1
0  25253    143
1   1005  24431
---- Validation: 
scalar performance:
{'acc': 0.951644, 'precision': 0.6343274, 'recall': 0.77290297, 'specificity': 0.77290297, 'f1': 0.676611, 'auroc': 0.90993977, 'binary_precision': 0.27968922, 'binary_recall': 0.58468676, 'binary_specificity': 0.9611191, 'binary_f1_score': 0.3783784}
confusion matrix:
       0    1
0  16043  649
1    179  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88276684, 'precision': 0.6449109, 'recall': 0.7260233, 'specificity': 0.7260233, 'f1': 0.67215544, 'auroc': 0.8375832, 'binary_precision': 0.32905295, 'binary_recall': 0.5416116, 'binary_specificity': 0.91043496, 'binary_f1_score': 0.4093859}
confusion matrix:
      0    1
0  8498  836
1   347  410
better model found
persisted
after epoch: 8,now: 2024-08-08 12:16:17.564002,epoch time: 0:37:41.440247,used: 5:06:48.847102,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97889125, 'precision': 0.97926724, 'recall': 0.97890186, 'specificity': 0.97890186, 'f1': 0.97888744, 'auroc': 0.9973661, 'binary_precision': 0.99287856, 'binary_recall': 0.96473366, 'binary_specificity': 0.99307007, 'binary_f1_score': 0.9786038}
confusion matrix:
       0      1
0  25221    176
1    897  24538
---- Validation: 
scalar performance:
{'acc': 0.9449279, 'precision': 0.6240995, 'recall': 0.7931911, 'specificity': 0.7931911, 'f1': 0.6689506, 'auroc': 0.90778863, 'binary_precision': 0.25803402, 'binary_recall': 0.6334107, 'binary_specificity': 0.95297146, 'binary_f1_score': 0.36668906}
confusion matrix:
       0    1
0  15907  785
1    158  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87127143, 'precision': 0.63510704, 'recall': 0.73376894, 'specificity': 0.73376894, 'f1': 0.6639507, 'auroc': 0.8362967, 'binary_precision': 0.3075284, 'binary_recall': 0.5719947, 'binary_specificity': 0.89554316, 'binary_f1_score': 0.4}
confusion matrix:
      0    1
0  8359  975
1   324  433
early stop counter: 1
val acc:0.9449278712272644, best validation acc: 0.9516440033912659, corresponding to test acc:                         0.882766842842102 / 0.8903973698616028
after epoch: 9,now: 2024-08-08 12:53:41.889683,epoch time: 0:37:24.325681,used: 5:44:13.172783,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9815077, 'precision': 0.98173517, 'recall': 0.98151636, 'specificity': 0.98151636, 'f1': 0.98150575, 'auroc': 0.99758947, 'binary_precision': 0.9924017, 'binary_recall': 0.9704749, 'binary_specificity': 0.9925579, 'binary_f1_score': 0.9813159}
confusion matrix:
       0      1
0  25207    189
1    751  24685
---- Validation: 
scalar performance:
{'acc': 0.94831514, 'precision': 0.63056326, 'recall': 0.7904079, 'specificity': 0.7904079, 'f1': 0.6755558, 'auroc': 0.9098588, 'binary_precision': 0.27116936, 'binary_recall': 0.62412995, 'binary_specificity': 0.95668584, 'binary_f1_score': 0.3780745}
confusion matrix:
       0    1
0  15969  723
1    162  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8737489, 'precision': 0.64829636, 'recall': 0.7703103, 'specificity': 0.7703103, 'f1': 0.68210685, 'auroc': 0.86032, 'binary_precision': 0.3275517, 'binary_recall': 0.6486129, 'binary_specificity': 0.8920077, 'binary_f1_score': 0.4352837}
confusion matrix:
      0     1
0  8326  1008
1   266   491
early stop counter: 2
val acc:0.9483151435852051, best validation acc: 0.9516440033912659, corresponding to test acc:                         0.882766842842102 / 0.8903973698616028
after epoch: 10,now: 2024-08-08 13:32:59.372451,epoch time: 0:39:17.482768,used: 6:23:30.655551,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9823733, 'precision': 0.98249996, 'recall': 0.98238015, 'specificity': 0.98238015, 'f1': 0.98237234, 'auroc': 0.99775684, 'binary_precision': 0.99052566, 'binary_recall': 0.97409284, 'binary_specificity': 0.99066746, 'binary_f1_score': 0.98224056}
confusion matrix:
       0      1
0  25158    237
1    659  24778
---- Validation: 
scalar performance:
{'acc': 0.9396134, 'precision': 0.6166563, 'recall': 0.80289674, 'specificity': 0.80289674, 'f1': 0.6614409, 'auroc': 0.9076649, 'binary_precision': 0.24252775, 'binary_recall': 0.6589327, 'binary_specificity': 0.9468608, 'binary_f1_score': 0.35455683}
confusion matrix:
       0    1
0  15805  887
1    147  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8447131, 'precision': 0.6261612, 'recall': 0.7722161, 'specificity': 0.7722161, 'f1': 0.65488255, 'auroc': 0.8500083, 'binary_precision': 0.28108108, 'binary_recall': 0.6869221, 'binary_specificity': 0.85751015, 'binary_f1_score': 0.39892596}
confusion matrix:
      0     1
0  8004  1330
1   237   520
early stop counter: 3
val acc:0.939613401889801, best validation acc: 0.9516440033912659, corresponding to test acc:                         0.882766842842102 / 0.8903973698616028
after epoch: 11,now: 2024-08-08 14:13:23.421222,epoch time: 0:40:24.048771,used: 7:03:54.704322,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_07_09_28_seed_1_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 7:03:54.704322 at 2024-08-08 14:13:23.421222
persisted model performance metric: 

scalar performance:
{'acc': 0.88276684, 'precision': 0.6449109, 'recall': 0.7260233, 'specificity': 0.7260233, 'f1': 0.67215544, 'auroc': 0.8375832, 'binary_precision': 0.32905295, 'binary_recall': 0.5416116, 'binary_specificity': 0.91043496, 'binary_f1_score': 0.4093859}
confusion matrix:
      0    1
0  8498  836
1   347  410
oracle model performance metric: 

scalar performance:
{'acc': 0.89039737, 'precision': 0.6275189, 'recall': 0.65003264, 'specificity': 0.65003264, 'f1': 0.63740873, 'auroc': 0.8522222, 'binary_precision': 0.3071823, 'binary_recall': 0.3672391, 'binary_specificity': 0.9328262, 'binary_f1_score': 0.33453667}
confusion matrix:
      0    1
0  8707  627
1   479  278
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   4047 MiB |   1768 TiB |   1768 TiB |
|       from large pool | 179211 KiB |   4028 MiB |   1748 TiB |   1748 TiB |
|       from small pool |  18208 KiB |     38 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   4047 MiB |   1768 TiB |   1768 TiB |
|       from large pool | 179211 KiB |   4028 MiB |   1748 TiB |   1748 TiB |
|       from small pool |  18208 KiB |     38 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   4045 MiB |   1768 TiB |   1768 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1748 TiB |   1748 TiB |
|       from small pool |  16662 KiB |     36 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4930 MiB |   4936 MiB |   9608 MiB |   4678 MiB |
|       from large pool |   4892 MiB |   4894 MiB |   9560 MiB |   4668 MiB |
|       from small pool |     38 MiB |     42 MiB |     48 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB |    864 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  31733 KiB |    862 MiB |   1064 TiB |   1064 TiB |
|       from small pool |  10464 KiB |     26 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6829    |  233986 K  |  233981 K  |
|       from large pool |      79    |     423    |  158613 K  |  158613 K  |
|       from small pool |    4333    |    6749    |   75372 K  |   75368 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6829    |  233986 K  |  233981 K  |
|       from large pool |      79    |     423    |  158613 K  |  158613 K  |
|       from small pool |    4333    |    6749    |   75372 K  |   75368 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     178    |     181    |     332    |     154    |
|       from large pool |     159    |     160    |     308    |     149    |
|       from small pool |      19    |      21    |      24    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3197    |  153831 K  |  153831 K  |
|       from large pool |      11    |     165    |  115895 K  |  115895 K  |
|       from small pool |      21    |    3186    |   37936 K  |   37936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1768 TiB |   1768 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1748 TiB |   1748 TiB |
|       from small pool |      0 KiB |     38 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1768 TiB |   1768 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1748 TiB |   1748 TiB |
|       from small pool |      0 KiB |     38 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1768 TiB |   1768 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1748 TiB |   1748 TiB |
|       from small pool |      0 KiB |     36 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4936 MiB |   9608 MiB |   9374 MiB |
|       from large pool | 210944 KiB |   4894 MiB |   9560 MiB |   9354 MiB |
|       from small pool |  28672 KiB |     42 MiB |     48 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  30464 KiB |    862 MiB |   1064 TiB |   1064 TiB |
|       from small pool |      0 KiB |     26 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  233986 K  |  233986 K  |
|       from large pool |       2    |     423    |  158613 K  |  158613 K  |
|       from small pool |       0    |    6749    |   75372 K  |   75372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  233986 K  |  233986 K  |
|       from large pool |       2    |     423    |  158613 K  |  158613 K  |
|       from small pool |       0    |    6749    |   75372 K  |   75372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     181    |     332    |     308    |
|       from large pool |      10    |     160    |     308    |     298    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3197    |  153833 K  |  153833 K  |
|       from large pool |       3    |     165    |  115895 K  |  115895 K  |
|       from small pool |       0    |    3186    |   37938 K  |   37938 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1768 TiB |   1768 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1748 TiB |   1748 TiB |
|       from small pool |      0 KiB |     38 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1768 TiB |   1768 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   1748 TiB |   1748 TiB |
|       from small pool |      0 KiB |     38 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1768 TiB |   1768 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1748 TiB |   1748 TiB |
|       from small pool |      0 KiB |     36 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4936 MiB |   9608 MiB |   9374 MiB |
|       from large pool | 210944 KiB |   4894 MiB |   9560 MiB |   9354 MiB |
|       from small pool |  28672 KiB |     42 MiB |     48 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  30464 KiB |    862 MiB |   1064 TiB |   1064 TiB |
|       from small pool |      0 KiB |     26 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  233986 K  |  233986 K  |
|       from large pool |       2    |     423    |  158613 K  |  158613 K  |
|       from small pool |       0    |    6749    |   75372 K  |   75372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  233986 K  |  233986 K  |
|       from large pool |       2    |     423    |  158613 K  |  158613 K  |
|       from small pool |       0    |    6749    |   75372 K  |   75372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     181    |     332    |     308    |
|       from large pool |      10    |     160    |     308    |     298    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3197    |  153833 K  |  153833 K  |
|       from large pool |       3    |     165    |  115895 K  |  115895 K  |
|       from small pool |       0    |    3186    |   37938 K  |   37938 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567

 Experiment start at: 2024-08-08 14:37:09.314060
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9440576, 'precision': 0.9472953, 'recall': 0.94406086, 'specificity': 0.94406086, 'f1': 0.94395643, 'auroc': 0.98564315, 'binary_precision': 0.98537, 'binary_recall': 0.9015087, 'binary_specificity': 0.98661304, 'binary_f1_score': 0.9415757}
confusion matrix:
       0      1
0  25500    346
1   2546  23304
---- Validation: 
scalar performance:
{'acc': 0.93681383, 'precision': 0.59285027, 'recall': 0.73436785, 'specificity': 0.73436785, 'f1': 0.6270808, 'auroc': 0.8409748, 'binary_precision': 0.19818182, 'binary_recall': 0.5215311, 'binary_specificity': 0.9472046, 'binary_f1_score': 0.28722003}
confusion matrix:
       0    1
0  15824  882
1    200  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88941735, 'precision': 0.66406214, 'recall': 0.73750097, 'specificity': 0.73750097, 'f1': 0.69086385, 'auroc': 0.8667185, 'binary_precision': 0.36785418, 'binary_recall': 0.5570891, 'binary_specificity': 0.91791284, 'binary_f1_score': 0.44311377}
confusion matrix:
      0    1
0  8532  763
1   353  444
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 15:17:42.157863,epoch time: 0:40:32.843803,used: 0:40:32.843803,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9633434, 'precision': 0.96377134, 'recall': 0.96334577, 'specificity': 0.96334577, 'f1': 0.96333504, 'auroc': 0.99146724, 'binary_precision': 0.97789747, 'binary_recall': 0.9481278, 'binary_specificity': 0.97856367, 'binary_f1_score': 0.96278256}
confusion matrix:
       0      1
0  25290    554
1   1341  24511
---- Validation: 
scalar performance:
{'acc': 0.9253095, 'precision': 0.59115094, 'recall': 0.78678393, 'specificity': 0.78678393, 'f1': 0.62794083, 'auroc': 0.8692234, 'binary_precision': 0.19183965, 'binary_recall': 0.6411483, 'binary_specificity': 0.9324195, 'binary_f1_score': 0.29531682}
confusion matrix:
       0     1
0  15577  1129
1    150   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8965517, 'precision': 0.68868196, 'recall': 0.79586226, 'specificity': 0.79586226, 'f1': 0.7251052, 'auroc': 0.89536035, 'binary_precision': 0.40679246, 'binary_recall': 0.6762861, 'binary_specificity': 0.9154384, 'binary_f1_score': 0.50801134}
confusion matrix:
      0    1
0  8509  786
1   258  539
new oracle model saved
early stop counter: 1
val acc:0.9253094792366028, best validation acc: 0.9368138313293457, corresponding to test acc:                         0.8894173502922058 / 0.8965517282485962
after epoch: 2,now: 2024-08-08 15:56:36.893696,epoch time: 0:38:54.735833,used: 1:19:27.579636,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9655099, 'precision': 0.9666305, 'recall': 0.96551466, 'specificity': 0.96551466, 'f1': 0.96548945, 'auroc': 0.99398595, 'binary_precision': 0.98954606, 'binary_recall': 0.940974, 'binary_specificity': 0.9900553, 'binary_f1_score': 0.96464896}
confusion matrix:
       0      1
0  25586    257
1   1526  24327
---- Validation: 
scalar performance:
{'acc': 0.94633263, 'precision': 0.61853576, 'recall': 0.77190113, 'specificity': 0.77190113, 'f1': 0.6603511, 'auroc': 0.8793682, 'binary_precision': 0.24773414, 'binary_recall': 0.5885168, 'binary_specificity': 0.95528555, 'binary_f1_score': 0.3486889}
confusion matrix:
       0    1
0  15959  747
1    172  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9084423, 'precision': 0.7063771, 'recall': 0.7862576, 'specificity': 0.7862576, 'f1': 0.7372582, 'auroc': 0.90245974, 'binary_precision': 0.44473454, 'binary_recall': 0.64115435, 'binary_specificity': 0.93136096, 'binary_f1_score': 0.52517986}
confusion matrix:
      0    1
0  8657  638
1   286  511
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-08 16:35:00.982034,epoch time: 0:38:24.088338,used: 1:57:51.667974,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97171926, 'precision': 0.97205675, 'recall': 0.97172034, 'specificity': 0.97172034, 'f1': 0.97171426, 'auroc': 0.9952595, 'binary_precision': 0.98469675, 'binary_recall': 0.95833653, 'binary_specificity': 0.9851041, 'binary_f1_score': 0.97133785}
confusion matrix:
       0      1
0  25461    385
1   1077  24773
---- Validation: 
scalar performance:
{'acc': 0.933602, 'precision': 0.6020467, 'recall': 0.79103386, 'specificity': 0.79103386, 'f1': 0.64273924, 'auroc': 0.88563967, 'binary_precision': 0.21354581, 'binary_recall': 0.6411483, 'binary_specificity': 0.94091946, 'binary_f1_score': 0.32038254}
confusion matrix:
       0    1
0  15719  987
1    150  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.905866, 'precision': 0.706818, 'recall': 0.81468415, 'specificity': 0.81468415, 'f1': 0.7449631, 'auroc': 0.90646446, 'binary_precision': 0.44018763, 'binary_recall': 0.706399, 'binary_specificity': 0.92296934, 'binary_f1_score': 0.5423892}
confusion matrix:
      0    1
0  8579  716
1   234  563
early stop counter: 1
val acc:0.933601975440979, best validation acc: 0.9463326334953308, corresponding to test acc:                         0.9084423184394836 / 0.9084423184394836
after epoch: 4,now: 2024-08-08 17:14:58.957050,epoch time: 0:39:57.975016,used: 2:37:49.642990,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.972377, 'precision': 0.97306913, 'recall': 0.9723822, 'specificity': 0.9723822, 'f1': 0.97236705, 'auroc': 0.99617946, 'binary_precision': 0.991232, 'binary_recall': 0.9532005, 'binary_specificity': 0.9915638, 'binary_f1_score': 0.9718443}
confusion matrix:
       0      1
0  25623    218
1   1210  24645
---- Validation: 
scalar performance:
{'acc': 0.94358796, 'precision': 0.6168026, 'recall': 0.78682184, 'specificity': 0.78682184, 'f1': 0.66022366, 'auroc': 0.8869597, 'binary_precision': 0.2434457, 'binary_recall': 0.6220096, 'binary_specificity': 0.95163417, 'binary_f1_score': 0.3499327}
confusion matrix:
       0    1
0  15898  808
1    158  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.910325, 'precision': 0.7140176, 'recall': 0.8113692, 'specificity': 0.8113692, 'f1': 0.750088, 'auroc': 0.9085008, 'binary_precision': 0.45551893, 'binary_recall': 0.69385195, 'binary_specificity': 0.9288865, 'binary_f1_score': 0.5499751}
confusion matrix:
      0    1
0  8634  661
1   244  553
new oracle model saved
early stop counter: 2
val acc:0.9435879588127136, best validation acc: 0.9463326334953308, corresponding to test acc:                         0.9084423184394836 / 0.9103249907493591
after epoch: 5,now: 2024-08-08 17:54:58.249524,epoch time: 0:39:59.292474,used: 3:17:48.935464,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9762071, 'precision': 0.9766689, 'recall': 0.97620887, 'specificity': 0.97620887, 'f1': 0.97620136, 'auroc': 0.9967387, 'binary_precision': 0.99153525, 'binary_recall': 0.96062046, 'binary_specificity': 0.99179727, 'binary_f1_score': 0.97583306}
confusion matrix:
       0      1
0  25633    212
1   1018  24833
---- Validation: 
scalar performance:
{'acc': 0.9548003, 'precision': 0.64031625, 'recall': 0.7785734, 'specificity': 0.7785734, 'f1': 0.68354046, 'auroc': 0.8888097, 'binary_precision': 0.29107982, 'binary_recall': 0.5933014, 'binary_specificity': 0.9638453, 'binary_f1_score': 0.39055118}
confusion matrix:
       0    1
0  16102  604
1    170  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9168649, 'precision': 0.7259002, 'recall': 0.80402184, 'specificity': 0.80402184, 'f1': 0.75706863, 'auroc': 0.90823334, 'binary_precision': 0.48108107, 'binary_recall': 0.67001253, 'binary_specificity': 0.9380312, 'binary_f1_score': 0.56004196}
confusion matrix:
      0    1
0  8719  576
1   263  534
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-08 18:33:51.967736,epoch time: 0:38:53.718212,used: 3:56:42.653676,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9771162, 'precision': 0.9776208, 'recall': 0.97712004, 'specificity': 0.97712004, 'f1': 0.9771103, 'auroc': 0.9971094, 'binary_precision': 0.993203, 'binary_recall': 0.96081847, 'binary_specificity': 0.99342155, 'binary_f1_score': 0.9767424}
confusion matrix:
       0      1
0  25672    170
1   1013  24841
---- Validation: 
scalar performance:
{'acc': 0.9487853, 'precision': 0.6251477, 'recall': 0.77782315, 'specificity': 0.77782315, 'f1': 0.6682141, 'auroc': 0.88595235, 'binary_precision': 0.26068822, 'binary_recall': 0.5980861, 'binary_specificity': 0.9575602, 'binary_f1_score': 0.36310822}
confusion matrix:
       0    1
0  15997  709
1    168  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9155767, 'precision': 0.72398204, 'recall': 0.81020534, 'specificity': 0.81020534, 'f1': 0.757509, 'auroc': 0.90638304, 'binary_precision': 0.47602442, 'binary_recall': 0.685069, 'binary_specificity': 0.9353416, 'binary_f1_score': 0.5617284}
confusion matrix:
      0    1
0  8694  601
1   251  546
early stop counter: 1
val acc:0.9487853050231934, best validation acc: 0.9548003077507019, corresponding to test acc:                         0.9168648719787598 / 0.9168648719787598
after epoch: 7,now: 2024-08-08 19:12:02.131698,epoch time: 0:38:10.163962,used: 4:34:52.817638,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97804475, 'precision': 0.9784987, 'recall': 0.9780483, 'specificity': 0.9780483, 'f1': 0.9780397, 'auroc': 0.99742126, 'binary_precision': 0.9932948, 'binary_recall': 0.96259767, 'binary_specificity': 0.993499, 'binary_f1_score': 0.97770536}
confusion matrix:
       0      1
0  25674    168
1    967  24887
---- Validation: 
scalar performance:
{'acc': 0.9480262, 'precision': 0.62478817, 'recall': 0.78326523, 'specificity': 0.78326523, 'f1': 0.66859555, 'auroc': 0.8871311, 'binary_precision': 0.25967413, 'binary_recall': 0.6100478, 'binary_specificity': 0.9564827, 'binary_f1_score': 0.3642857}
confusion matrix:
       0    1
0  15979  727
1    163  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9173603, 'precision': 0.7269967, 'recall': 0.80429083, 'specificity': 0.80429083, 'f1': 0.75794774, 'auroc': 0.9041395, 'binary_precision': 0.48325792, 'binary_recall': 0.67001253, 'binary_specificity': 0.9385691, 'binary_f1_score': 0.56151414}
confusion matrix:
      0    1
0  8724  571
1   263  534
new oracle model saved
early stop counter: 2
val acc:0.948026180267334, best validation acc: 0.9548003077507019, corresponding to test acc:                         0.9168648719787598 / 0.9173603057861328
after epoch: 8,now: 2024-08-08 19:51:24.516411,epoch time: 0:39:22.384713,used: 5:14:15.202351,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.980366, 'precision': 0.9805528, 'recall': 0.9803671, 'specificity': 0.9803671, 'f1': 0.9803641, 'auroc': 0.9974443, 'binary_precision': 0.99005526, 'binary_recall': 0.9704847, 'binary_specificity': 0.9902496, 'binary_f1_score': 0.9801723}
confusion matrix:
       0      1
0  25593    252
1    763  25088
---- Validation: 
scalar performance:
{'acc': 0.9488437, 'precision': 0.62721777, 'recall': 0.78601676, 'specificity': 0.78601676, 'f1': 0.67156196, 'auroc': 0.89084756, 'binary_precision': 0.26440328, 'binary_recall': 0.6148325, 'binary_specificity': 0.957201, 'binary_f1_score': 0.36978418}
confusion matrix:
       0    1
0  15991  715
1    161  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91438764, 'precision': 0.7226586, 'recall': 0.81816316, 'specificity': 0.81816316, 'f1': 0.7587384, 'auroc': 0.9072858, 'binary_precision': 0.47182506, 'binary_recall': 0.7038896, 'binary_specificity': 0.93243676, 'binary_f1_score': 0.56495464}
confusion matrix:
      0    1
0  8667  628
1   236  561
early stop counter: 3
val acc:0.9488437175750732, best validation acc: 0.9548003077507019, corresponding to test acc:                         0.9168648719787598 / 0.9173603057861328
after epoch: 9,now: 2024-08-08 20:30:47.879014,epoch time: 0:39:23.362603,used: 5:53:38.564954,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_14_37_09_seed_2_24111567
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 5:53:38.564954 at 2024-08-08 20:30:47.879014
persisted model performance metric: 

scalar performance:
{'acc': 0.9168649, 'precision': 0.7259002, 'recall': 0.80402184, 'specificity': 0.80402184, 'f1': 0.75706863, 'auroc': 0.90823334, 'binary_precision': 0.48108107, 'binary_recall': 0.67001253, 'binary_specificity': 0.9380312, 'binary_f1_score': 0.56004196}
confusion matrix:
      0    1
0  8719  576
1   263  534
oracle model performance metric: 

scalar performance:
{'acc': 0.9173603, 'precision': 0.7269967, 'recall': 0.80429083, 'specificity': 0.80429083, 'f1': 0.75794774, 'auroc': 0.9041395, 'binary_precision': 0.48325792, 'binary_recall': 0.67001253, 'binary_specificity': 0.9385691, 'binary_f1_score': 0.56151414}
confusion matrix:
      0    1
0  8724  571
1   263  534
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   4047 MiB |   2621 TiB |   2621 TiB |
|       from large pool | 179211 KiB |   4028 MiB |   2592 TiB |   2592 TiB |
|       from small pool |  18208 KiB |     38 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   4047 MiB |   2621 TiB |   2621 TiB |
|       from large pool | 179211 KiB |   4028 MiB |   2592 TiB |   2592 TiB |
|       from small pool |  18208 KiB |     38 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   4045 MiB |   2621 TiB |   2621 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   2592 TiB |   2592 TiB |
|       from small pool |  16662 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4930 MiB |   4936 MiB |  14304 MiB |   9374 MiB |
|       from large pool |   4892 MiB |   4894 MiB |  14246 MiB |   9354 MiB |
|       from small pool |     38 MiB |     42 MiB |     58 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB |    864 MiB |   1612 TiB |   1612 TiB |
|       from large pool |  31733 KiB |    862 MiB |   1582 TiB |   1582 TiB |
|       from small pool |  10464 KiB |     26 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6937    |  346796 K  |  346791 K  |
|       from large pool |      79    |     423    |  235135 K  |  235135 K  |
|       from small pool |    4333    |    6857    |  111660 K  |  111656 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6937    |  346796 K  |  346791 K  |
|       from large pool |      79    |     423    |  235135 K  |  235135 K  |
|       from small pool |    4333    |    6857    |  111660 K  |  111656 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     178    |     181    |     486    |     308    |
|       from large pool |     159    |     160    |     457    |     298    |
|       from small pool |      19    |      21    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3251    |  229303 K  |  229303 K  |
|       from large pool |      11    |     165    |  170820 K  |  170820 K  |
|       from small pool |      21    |    3240    |   58483 K  |   58483 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   2621 TiB |   2621 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   2592 TiB |   2592 TiB |
|       from small pool |      0 KiB |     38 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   2621 TiB |   2621 TiB |
|       from large pool |  16640 KiB |   4028 MiB |   2592 TiB |   2592 TiB |
|       from small pool |      0 KiB |     38 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   2621 TiB |   2621 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   2592 TiB |   2592 TiB |
|       from small pool |      0 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4936 MiB |  14304 MiB |  14070 MiB |
|       from large pool | 210944 KiB |   4894 MiB |  14246 MiB |  14040 MiB |
|       from small pool |  28672 KiB |     42 MiB |     58 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    864 MiB |   1612 TiB |   1612 TiB |
|       from large pool |  30464 KiB |    862 MiB |   1582 TiB |   1582 TiB |
|       from small pool |      0 KiB |     26 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6937    |  346796 K  |  346796 K  |
|       from large pool |       2    |     423    |  235135 K  |  235135 K  |
|       from small pool |       0    |    6857    |  111660 K  |  111660 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6937    |  346796 K  |  346796 K  |
|       from large pool |       2    |     423    |  235135 K  |  235135 K  |
|       from small pool |       0    |    6857    |  111660 K  |  111660 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     181    |     486    |     462    |
|       from large pool |      10    |     160    |     457    |     447    |
|       from small pool |      14    |      21    |      29    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3251    |  229305 K  |  229305 K  |
|       from large pool |       3    |     165    |  170820 K  |  170820 K  |
|       from small pool |       0    |    3240    |   58485 K  |   58485 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  8 20:44:59 2024]
Finished job 0.
1 of 1 steps (100%) done
