Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Aug  7 18:03:40 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559

 Experiment start at: 2024-08-07 18:09:26.491506
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95254266, 'precision': 0.95429885, 'recall': 0.95256233, 'specificity': 0.95256233, 'f1': 0.9524982, 'auroc': 0.9864316, 'binary_precision': 0.98270345, 'binary_recall': 0.92136204, 'binary_specificity': 0.9837626, 'binary_f1_score': 0.9510447}
confusion matrix:
       0      1
0  24901    411
1   1993  23351
---- Validation: 
scalar performance:
{'acc': 0.90195966, 'precision': 0.5761939, 'recall': 0.81229657, 'specificity': 0.81229657, 'f1': 0.6046207, 'auroc': 0.89131755, 'binary_precision': 0.16004297, 'binary_recall': 0.7180723, 'binary_specificity': 0.90652084, 'binary_f1_score': 0.26174793}
confusion matrix:
       0     1
0  15167  1564
1    117   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7894008, 'precision': 0.6093752, 'recall': 0.79628253, 'specificity': 0.79628253, 'f1': 0.62098145, 'auroc': 0.8622135, 'binary_precision': 0.23884615, 'binary_recall': 0.80440414, 'binary_specificity': 0.788161, 'binary_f1_score': 0.3683274}
confusion matrix:
      0     1
0  7363  1979
1   151   621
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 18:54:36.471967,epoch time: 0:45:09.980461,used: 0:45:09.980461,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96592706, 'precision': 0.966455, 'recall': 0.96593845, 'specificity': 0.96593845, 'f1': 0.965918, 'auroc': 0.99157345, 'binary_precision': 0.9823157, 'binary_recall': 0.948984, 'binary_specificity': 0.9828928, 'binary_f1_score': 0.96536225}
confusion matrix:
       0      1
0  24878    433
1   1293  24052
---- Validation: 
scalar performance:
{'acc': 0.9025429, 'precision': 0.58127344, 'recall': 0.838444, 'specificity': 0.838444, 'f1': 0.6123433, 'auroc': 0.91086555, 'binary_precision': 0.16877638, 'binary_recall': 0.7710843, 'binary_specificity': 0.9058036, 'binary_f1_score': 0.27693638}
confusion matrix:
       0     1
0  15155  1576
1     95   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81283367, 'precision': 0.62100947, 'recall': 0.8065907, 'specificity': 0.8065907, 'f1': 0.6419661, 'auroc': 0.8778056, 'binary_precision': 0.26199576, 'binary_recall': 0.7992228, 'binary_specificity': 0.81395847, 'binary_f1_score': 0.39462745}
confusion matrix:
      0     1
0  7604  1738
1   155   617
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 19:38:50.484228,epoch time: 0:44:14.012261,used: 1:29:23.992722,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96851313, 'precision': 0.9691635, 'recall': 0.9685257, 'specificity': 0.9685257, 'f1': 0.96850276, 'auroc': 0.99357355, 'binary_precision': 0.9868, 'binary_recall': 0.94977313, 'binary_specificity': 0.9872783, 'binary_f1_score': 0.9679326}
confusion matrix:
       0      1
0  24989    322
1   1273  24072
---- Validation: 
scalar performance:
{'acc': 0.9240056, 'precision': 0.5978278, 'recall': 0.82946765, 'specificity': 0.82946765, 'f1': 0.6386032, 'auroc': 0.9161898, 'binary_precision': 0.20281124, 'binary_recall': 0.7301205, 'binary_specificity': 0.92881477, 'binary_f1_score': 0.31744367}
confusion matrix:
       0     1
0  15540  1191
1    112   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688946, 'precision': 0.6489779, 'recall': 0.7816818, 'specificity': 0.7816818, 'f1': 0.68358994, 'auroc': 0.8791307, 'binary_precision': 0.32709113, 'binary_recall': 0.6787565, 'binary_specificity': 0.88460714, 'binary_f1_score': 0.44144902}
confusion matrix:
      0     1
0  8264  1078
1   248   524
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 20:22:57.094503,epoch time: 0:44:06.610275,used: 2:13:30.602997,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9718296, 'precision': 0.97259593, 'recall': 0.9718416, 'specificity': 0.9718416, 'f1': 0.9718187, 'auroc': 0.99537766, 'binary_precision': 0.991775, 'binary_recall': 0.9515843, 'binary_specificity': 0.9920989, 'binary_f1_score': 0.971264}
confusion matrix:
       0      1
0  25113    200
1   1227  24116
---- Validation: 
scalar performance:
{'acc': 0.9389945, 'precision': 0.614074, 'recall': 0.8136493, 'specificity': 0.8136493, 'f1': 0.65955466, 'auroc': 0.9154655, 'binary_precision': 0.2364244, 'binary_recall': 0.68192774, 'binary_specificity': 0.94537085, 'binary_f1_score': 0.35111666}
confusion matrix:
       0    1
0  15817  914
1    132  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88827366, 'precision': 0.6661178, 'recall': 0.7684062, 'specificity': 0.7684062, 'f1': 0.6995321, 'auroc': 0.88009137, 'binary_precision': 0.36500755, 'binary_recall': 0.626943, 'binary_specificity': 0.90986943, 'binary_f1_score': 0.4613918}
confusion matrix:
      0    1
0  8500  842
1   288  484
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 21:06:58.411805,epoch time: 0:44:01.317302,used: 2:57:31.920299,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97609365, 'precision': 0.9764204, 'recall': 0.9760999, 'specificity': 0.9760999, 'f1': 0.9760898, 'auroc': 0.99618, 'binary_precision': 0.98901546, 'binary_recall': 0.9629045, 'binary_specificity': 0.9892953, 'binary_f1_score': 0.9757853}
confusion matrix:
       0      1
0  25045    271
1    940  24400
---- Validation: 
scalar performance:
{'acc': 0.9307127, 'precision': 0.60560435, 'recall': 0.82937956, 'specificity': 0.82937956, 'f1': 0.64951056, 'auroc': 0.9197689, 'binary_precision': 0.21849963, 'binary_recall': 0.72289157, 'binary_specificity': 0.93586755, 'binary_f1_score': 0.33557042}
confusion matrix:
       0     1
0  15658  1073
1    115   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8641487, 'precision': 0.6477366, 'recall': 0.792184, 'specificity': 0.792184, 'f1': 0.6827331, 'auroc': 0.8853078, 'binary_precision': 0.32231405, 'binary_recall': 0.7072539, 'binary_specificity': 0.8771141, 'binary_f1_score': 0.44282237}
confusion matrix:
      0     1
0  8194  1148
1   226   546
early stop counter: 1
val acc:0.9307126998901367, best validation acc: 0.9389945268630981, corresponding to test acc:                         0.8882736563682556 / 0.8882736563682556
after epoch: 5,now: 2024-08-07 21:51:19.043554,epoch time: 0:44:20.631749,used: 3:41:52.552048,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97514606, 'precision': 0.9757466, 'recall': 0.97515666, 'specificity': 0.97515666, 'f1': 0.97513866, 'auroc': 0.99641395, 'binary_precision': 0.9927975, 'binary_recall': 0.95726633, 'binary_specificity': 0.99304706, 'binary_f1_score': 0.9747082}
confusion matrix:
       0      1
0  25137    176
1   1083  24260
---- Validation: 
scalar performance:
{'acc': 0.9478596, 'precision': 0.6290245, 'recall': 0.8076173, 'specificity': 0.8076173, 'f1': 0.67640656, 'auroc': 0.9163028, 'binary_precision': 0.2667965, 'binary_recall': 0.66024095, 'binary_specificity': 0.9549937, 'binary_f1_score': 0.38002774}
confusion matrix:
       0    1
0  15978  753
1    141  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9007317, 'precision': 0.6762787, 'recall': 0.7365304, 'specificity': 0.7365304, 'f1': 0.7001668, 'auroc': 0.8822031, 'binary_precision': 0.39158878, 'binary_recall': 0.5427461, 'binary_specificity': 0.9303147, 'binary_f1_score': 0.4549403}
confusion matrix:
      0    1
0  8691  651
1   353  419
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 22:35:33.563419,epoch time: 0:44:14.519865,used: 4:26:07.071913,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97883767, 'precision': 0.9791006, 'recall': 0.9788461, 'specificity': 0.9788461, 'f1': 0.978835, 'auroc': 0.99678254, 'binary_precision': 0.9905028, 'binary_recall': 0.96697706, 'binary_specificity': 0.99071515, 'binary_f1_score': 0.97859854}
confusion matrix:
       0      1
0  25075    235
1    837  24509
---- Validation: 
scalar performance:
{'acc': 0.93281233, 'precision': 0.60566187, 'recall': 0.8163562, 'specificity': 0.8163562, 'f1': 0.6489784, 'auroc': 0.91242456, 'binary_precision': 0.21934502, 'binary_recall': 0.6939759, 'binary_specificity': 0.9387365, 'binary_f1_score': 0.33333334}
confusion matrix:
       0     1
0  15706  1025
1    127   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8768044, 'precision': 0.6583365, 'recall': 0.78834015, 'specificity': 0.78834015, 'f1': 0.6946118, 'auroc': 0.89050287, 'binary_precision': 0.34509805, 'binary_recall': 0.68393785, 'binary_specificity': 0.89274246, 'binary_f1_score': 0.45873153}
confusion matrix:
      0     1
0  8340  1002
1   244   528
early stop counter: 1
val acc:0.9328123331069946, best validation acc: 0.9478595852851868, corresponding to test acc:                         0.9007316827774048 / 0.9007316827774048
after epoch: 7,now: 2024-08-07 23:20:08.973101,epoch time: 0:44:35.409682,used: 5:10:42.481595,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97897583, 'precision': 0.9793657, 'recall': 0.9789861, 'specificity': 0.9789861, 'f1': 0.97897184, 'auroc': 0.9971794, 'binary_precision': 0.9932155, 'binary_recall': 0.96457034, 'binary_specificity': 0.9934018, 'binary_f1_score': 0.97868335}
confusion matrix:
       0      1
0  25143    167
1    898  24448
---- Validation: 
scalar performance:
{'acc': 0.9518255, 'precision': 0.63295877, 'recall': 0.7849759, 'specificity': 0.7849759, 'f1': 0.6774096, 'auroc': 0.9139197, 'binary_precision': 0.27589968, 'binary_recall': 0.6096386, 'binary_specificity': 0.9603132, 'binary_f1_score': 0.37987992}
confusion matrix:
       0    1
0  16067  664
1    162  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9005339, 'precision': 0.68259144, 'recall': 0.7637541, 'specificity': 0.7637541, 'f1': 0.7126876, 'auroc': 0.8921355, 'binary_precision': 0.39948454, 'binary_recall': 0.6023316, 'binary_specificity': 0.9251766, 'binary_f1_score': 0.4803719}
confusion matrix:
      0    1
0  8643  699
1   307  465
better model found
persisted
after epoch: 8,now: 2024-08-08 00:04:22.632425,epoch time: 0:44:13.659324,used: 5:54:56.140919,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98124605, 'precision': 0.98134667, 'recall': 0.9812507, 'specificity': 0.9812507, 'f1': 0.98124516, 'auroc': 0.99743915, 'binary_precision': 0.98846614, 'binary_recall': 0.9738794, 'binary_specificity': 0.988622, 'binary_f1_score': 0.9811185}
confusion matrix:
       0      1
0  25024    288
1    662  24682
---- Validation: 
scalar performance:
{'acc': 0.93106264, 'precision': 0.6058485, 'recall': 0.8283839, 'specificity': 0.8283839, 'f1': 0.6497996, 'auroc': 0.91771835, 'binary_precision': 0.21904762, 'binary_recall': 0.72048193, 'binary_specificity': 0.9362859, 'binary_f1_score': 0.33595505}
confusion matrix:
       0     1
0  15665  1066
1    116   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86622506, 'precision': 0.6573765, 'recall': 0.82242113, 'specificity': 0.82242113, 'f1': 0.6957229, 'auroc': 0.9011903, 'binary_precision': 0.33596838, 'binary_recall': 0.77072537, 'binary_specificity': 0.8741169, 'binary_f1_score': 0.46795124}
confusion matrix:
      0     1
0  8166  1176
1   177   595
early stop counter: 1
val acc:0.931062638759613, best validation acc: 0.9518254995346069, corresponding to test acc:                         0.90053391456604 / 0.9007316827774048
after epoch: 9,now: 2024-08-08 00:48:26.070468,epoch time: 0:44:03.438043,used: 6:38:59.578962,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9839308, 'precision': 0.98402226, 'recall': 0.98393416, 'specificity': 0.98393416, 'f1': 0.9839301, 'auroc': 0.9979096, 'binary_precision': 0.99079484, 'binary_recall': 0.97695345, 'binary_specificity': 0.9909148, 'binary_f1_score': 0.98382545}
confusion matrix:
       0      1
0  25086    230
1    584  24756
---- Validation: 
scalar performance:
{'acc': 0.9324624, 'precision': 0.60417783, 'recall': 0.8114772, 'specificity': 0.8114772, 'f1': 0.646763, 'auroc': 0.9143383, 'binary_precision': 0.21662852, 'binary_recall': 0.6843374, 'binary_specificity': 0.93861693, 'binary_f1_score': 0.32908458}
confusion matrix:
       0     1
0  15704  1027
1    131   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8683014, 'precision': 0.6568645, 'recall': 0.8134446, 'specificity': 0.8134446, 'f1': 0.69477284, 'auroc': 0.8977686, 'binary_precision': 0.33682984, 'binary_recall': 0.7487047, 'binary_specificity': 0.87818456, 'binary_f1_score': 0.46463022}
confusion matrix:
      0     1
0  8204  1138
1   194   578
early stop counter: 2
val acc:0.9324623942375183, best validation acc: 0.9518254995346069, corresponding to test acc:                         0.90053391456604 / 0.9007316827774048
after epoch: 10,now: 2024-08-08 01:32:29.466653,epoch time: 0:44:03.396185,used: 7:23:02.975147,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9823121, 'precision': 0.9825904, 'recall': 0.9823197, 'specificity': 0.9823197, 'f1': 0.9823097, 'auroc': 0.99803406, 'binary_precision': 0.9943384, 'binary_recall': 0.97017044, 'binary_specificity': 0.99446905, 'binary_f1_score': 0.98210573}
confusion matrix:
       0      1
0  25172    140
1    756  24588
---- Validation: 
scalar performance:
{'acc': 0.9538085, 'precision': 0.6357889, 'recall': 0.77541757, 'specificity': 0.77541757, 'f1': 0.6786294, 'auroc': 0.9115982, 'binary_precision': 0.28208092, 'binary_recall': 0.5879518, 'binary_specificity': 0.9628833, 'binary_f1_score': 0.38125002}
confusion matrix:
       0    1
0  16110  621
1    171  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89390945, 'precision': 0.67771715, 'recall': 0.78512233, 'specificity': 0.78512233, 'f1': 0.7133586, 'auroc': 0.8994257, 'binary_precision': 0.38555133, 'binary_recall': 0.6567358, 'binary_specificity': 0.9135089, 'binary_f1_score': 0.4858649}
confusion matrix:
      0    1
0  8534  808
1   265  507
better model found
persisted
after epoch: 11,now: 2024-08-08 02:16:37.860022,epoch time: 0:44:08.393369,used: 8:07:11.368516,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9834373, 'precision': 0.9835987, 'recall': 0.9834435, 'specificity': 0.9834435, 'f1': 0.98343605, 'auroc': 0.99797654, 'binary_precision': 0.9926027, 'binary_recall': 0.9741566, 'binary_specificity': 0.99273044, 'binary_f1_score': 0.9832931}
confusion matrix:
       0      1
0  25127    184
1    655  24690
---- Validation: 
scalar performance:
{'acc': 0.94377697, 'precision': 0.6145938, 'recall': 0.77967685, 'specificity': 0.77967685, 'f1': 0.6569778, 'auroc': 0.9114692, 'binary_precision': 0.23931624, 'binary_recall': 0.60722893, 'binary_specificity': 0.9521248, 'binary_f1_score': 0.34332427}
confusion matrix:
       0    1
0  15930  801
1    163  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87868303, 'precision': 0.66462475, 'recall': 0.80539906, 'specificity': 0.80539906, 'f1': 0.70319295, 'auroc': 0.89794147, 'binary_precision': 0.3546326, 'binary_recall': 0.71891195, 'binary_specificity': 0.8918861, 'binary_f1_score': 0.47496793}
confusion matrix:
      0     1
0  8332  1010
1   217   555
early stop counter: 1
val acc:0.9437769651412964, best validation acc: 0.9538084864616394, corresponding to test acc:                         0.8939094543457031 / 0.9007316827774048
after epoch: 12,now: 2024-08-08 03:00:41.987559,epoch time: 0:44:04.127537,used: 8:51:15.496053,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98274636, 'precision': 0.98301804, 'recall': 0.9827535, 'specificity': 0.9827535, 'f1': 0.9827441, 'auroc': 0.99792457, 'binary_precision': 0.994623, 'binary_recall': 0.9707612, 'binary_specificity': 0.9947458, 'binary_f1_score': 0.9825472}
confusion matrix:
       0      1
0  25180    133
1    741  24602
---- Validation: 
scalar performance:
{'acc': 0.9469264, 'precision': 0.6185331, 'recall': 0.7707162, 'specificity': 0.7707162, 'f1': 0.6602373, 'auroc': 0.9102342, 'binary_precision': 0.24770643, 'binary_recall': 0.58554214, 'binary_specificity': 0.95589024, 'binary_f1_score': 0.34813756}
confusion matrix:
       0    1
0  15993  738
1    172  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8837255, 'precision': 0.66791123, 'recall': 0.79683983, 'specificity': 0.79683983, 'f1': 0.70573115, 'auroc': 0.898607, 'binary_precision': 0.36314362, 'binary_recall': 0.69430053, 'binary_specificity': 0.89937913, 'binary_f1_score': 0.47686833}
confusion matrix:
      0    1
0  8402  940
1   236  536
early stop counter: 2
val acc:0.9469264149665833, best validation acc: 0.9538084864616394, corresponding to test acc:                         0.8939094543457031 / 0.9007316827774048
after epoch: 13,now: 2024-08-08 03:44:45.368289,epoch time: 0:44:03.380730,used: 9:35:18.876783,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9842862, 'precision': 0.9844223, 'recall': 0.9842912, 'specificity': 0.9842912, 'f1': 0.9842852, 'auroc': 0.9983622, 'binary_precision': 0.992694, 'binary_recall': 0.9757724, 'binary_specificity': 0.99281, 'binary_f1_score': 0.9841605}
confusion matrix:
       0      1
0  25131    182
1    614  24729
---- Validation: 
scalar performance:
{'acc': 0.9570745, 'precision': 0.64130116, 'recall': 0.75946707, 'specificity': 0.75946707, 'f1': 0.68067384, 'auroc': 0.913262, 'binary_precision': 0.29396662, 'binary_recall': 0.5518072, 'binary_specificity': 0.9671269, 'binary_f1_score': 0.38358462}
confusion matrix:
       0    1
0  16181  550
1    186  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89994067, 'precision': 0.6832129, 'recall': 0.77056277, 'specificity': 0.77056277, 'f1': 0.7149168, 'auroc': 0.8968301, 'binary_precision': 0.39949748, 'binary_recall': 0.61787564, 'binary_specificity': 0.92324984, 'binary_f1_score': 0.48524925}
confusion matrix:
      0    1
0  8625  717
1   295  477
better model found
persisted
after epoch: 14,now: 2024-08-08 04:28:56.382606,epoch time: 0:44:11.014317,used: 10:19:29.891100,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98485863, 'precision': 0.98497343, 'recall': 0.9848633, 'specificity': 0.9848633, 'f1': 0.9848579, 'auroc': 0.99834645, 'binary_precision': 0.992584, 'binary_recall': 0.9770351, 'binary_specificity': 0.9926915, 'binary_f1_score': 0.9847482}
confusion matrix:
       0      1
0  25128    185
1    582  24761
---- Validation: 
scalar performance:
{'acc': 0.95450836, 'precision': 0.6284642, 'recall': 0.7393532, 'specificity': 0.7393532, 'f1': 0.66482943, 'auroc': 0.9067813, 'binary_precision': 0.2692794, 'binary_recall': 0.51325303, 'binary_specificity': 0.9654533, 'binary_f1_score': 0.3532338}
confusion matrix:
       0    1
0  16153  578
1    202  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88955903, 'precision': 0.6711054, 'recall': 0.781579, 'specificity': 0.781579, 'f1': 0.70656896, 'auroc': 0.89616907, 'binary_precision': 0.37269372, 'binary_recall': 0.65414506, 'binary_specificity': 0.90901303, 'binary_f1_score': 0.4748472}
confusion matrix:
      0    1
0  8492  850
1   267  505
early stop counter: 1
val acc:0.954508364200592, best validation acc: 0.9570745229721069, corresponding to test acc:                         0.8999406695365906 / 0.9007316827774048
after epoch: 15,now: 2024-08-08 05:13:07.222141,epoch time: 0:44:10.839535,used: 11:03:40.730635,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 11:03:40.730635 at 2024-08-08 05:13:07.222141
persisted model performance metric: 

scalar performance:
{'acc': 0.89994067, 'precision': 0.6832129, 'recall': 0.77056277, 'specificity': 0.77056277, 'f1': 0.7149168, 'auroc': 0.8968301, 'binary_precision': 0.39949748, 'binary_recall': 0.61787564, 'binary_specificity': 0.92324984, 'binary_f1_score': 0.48524925}
confusion matrix:
      0    1
0  8625  717
1   295  477
oracle model performance metric: 

scalar performance:
{'acc': 0.9007317, 'precision': 0.6762787, 'recall': 0.7365304, 'specificity': 0.7365304, 'f1': 0.7001668, 'auroc': 0.8822031, 'binary_precision': 0.39158878, 'binary_recall': 0.5427461, 'binary_specificity': 0.9303147, 'binary_f1_score': 0.4549403}
confusion matrix:
      0    1
0  8691  651
1   353  419
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   4047 MiB |   1349 TiB |   1349 TiB |
|       from large pool | 180662 KiB |   4027 MiB |   1333 TiB |   1333 TiB |
|       from small pool |  18214 KiB |     38 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   4047 MiB |   1349 TiB |   1349 TiB |
|       from large pool | 180662 KiB |   4027 MiB |   1333 TiB |   1333 TiB |
|       from small pool |  18214 KiB |     38 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   4045 MiB |   1349 TiB |   1349 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1333 TiB |   1333 TiB |
|       from small pool |  16663 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4432 MiB |   4432 MiB |   4432 MiB |      0 B   |
|       from large pool |   4390 MiB |   4390 MiB |   4390 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61220 KiB | 398856 KiB | 718022 GiB | 718021 GiB |
|       from large pool |  50762 KiB | 397938 KiB | 701921 GiB | 701921 GiB |
|       from small pool |  10458 KiB |  13261 KiB |  16100 GiB |  16100 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6807    |  184508 K  |  184504 K  |
|       from large pool |      79    |     423    |  125206 K  |  125206 K  |
|       from small pool |    4345    |    6727    |   59302 K  |   59297 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6807    |  184508 K  |  184504 K  |
|       from large pool |      79    |     423    |  125206 K  |  125206 K  |
|       from small pool |    4345    |    6727    |   59302 K  |   59297 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     203    |     203    |     203    |       0    |
|       from large pool |     182    |     182    |     182    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3187    |  125069 K  |  125069 K  |
|       from large pool |      10    |     184    |  100759 K  |  100759 K  |
|       from small pool |      22    |    3177    |   24309 K  |   24309 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1349 TiB |   1349 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1333 TiB |   1333 TiB |
|       from small pool |      0 KiB |     38 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1349 TiB |   1349 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1333 TiB |   1333 TiB |
|       from small pool |      0 KiB |     38 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1349 TiB |   1349 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1333 TiB |   1333 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 260096 KiB |   4432 MiB |   4432 MiB |   4178 MiB |
|       from large pool | 231424 KiB |   4390 MiB |   4390 MiB |   4164 MiB |
|       from small pool |  28672 KiB |     42 MiB |     42 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB | 718022 GiB | 718022 GiB |
|       from large pool |  30464 KiB | 397938 KiB | 701922 GiB | 701922 GiB |
|       from small pool |      0 KiB |  24597 KiB |  16100 GiB |  16100 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |  184508 K  |  184508 K  |
|       from large pool |       2    |     423    |  125206 K  |  125206 K  |
|       from small pool |       0    |    6727    |   59302 K  |   59302 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |  184508 K  |  184508 K  |
|       from large pool |       2    |     423    |  125206 K  |  125206 K  |
|       from small pool |       0    |    6727    |   59302 K  |   59302 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     203    |     203    |     178    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |      14    |      21    |      21    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3187    |  125071 K  |  125071 K  |
|       from large pool |       3    |     184    |  100759 K  |  100759 K  |
|       from small pool |       0    |    3177    |   24311 K  |   24311 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1349 TiB |   1349 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1333 TiB |   1333 TiB |
|       from small pool |      0 KiB |     38 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1349 TiB |   1349 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1333 TiB |   1333 TiB |
|       from small pool |      0 KiB |     38 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1349 TiB |   1349 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1333 TiB |   1333 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 260096 KiB |   4432 MiB |   4432 MiB |   4178 MiB |
|       from large pool | 231424 KiB |   4390 MiB |   4390 MiB |   4164 MiB |
|       from small pool |  28672 KiB |     42 MiB |     42 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB | 718022 GiB | 718022 GiB |
|       from large pool |  30464 KiB | 397938 KiB | 701922 GiB | 701922 GiB |
|       from small pool |      0 KiB |  24597 KiB |  16100 GiB |  16100 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |  184508 K  |  184508 K  |
|       from large pool |       2    |     423    |  125206 K  |  125206 K  |
|       from small pool |       0    |    6727    |   59302 K  |   59302 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |  184508 K  |  184508 K  |
|       from large pool |       2    |     423    |  125206 K  |  125206 K  |
|       from small pool |       0    |    6727    |   59302 K  |   59302 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     203    |     203    |     178    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |      14    |      21    |      21    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3187    |  125071 K  |  125071 K  |
|       from large pool |       3    |     184    |  100759 K  |  100759 K  |
|       from small pool |       0    |    3177    |   24311 K  |   24311 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_05_36_02_seed_1_24111559

 Experiment start at: 2024-08-08 05:36:02.357110
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9434608, 'precision': 0.9459245, 'recall': 0.94349015, 'specificity': 0.94349015, 'f1': 0.9433851, 'auroc': 0.9850205, 'binary_precision': 0.97926754, 'binary_recall': 0.90619594, 'binary_specificity': 0.98078436, 'binary_f1_score': 0.94131577}
confusion matrix:
       0      1
0  24908    488
1   2386  23050
---- Validation: 
scalar performance:
{'acc': 0.9473807, 'precision': 0.59923434, 'recall': 0.6848258, 'specificity': 0.6848258, 'f1': 0.62680846, 'auroc': 0.8625422, 'binary_precision': 0.21411192, 'binary_recall': 0.40835267, 'binary_specificity': 0.9612988, 'binary_f1_score': 0.28092578}
confusion matrix:
       0    1
0  16046  646
1    255  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8853434, 'precision': 0.60225904, 'recall': 0.61270547, 'specificity': 0.61270547, 'f1': 0.60708076, 'auroc': 0.82804406, 'binary_precision': 0.2624703, 'binary_recall': 0.29194188, 'binary_specificity': 0.93346906, 'binary_f1_score': 0.27642277}
confusion matrix:
      0    1
0  8713  621
1   536  221
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 06:21:29.772785,epoch time: 0:45:27.415675,used: 0:45:27.415675,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_05_36_02_seed_1_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9612252, 'precision': 0.9621637, 'recall': 0.961244, 'specificity': 0.961244, 'f1': 0.9612066, 'auroc': 0.992067, 'binary_precision': 0.98319745, 'binary_recall': 0.93855405, 'binary_specificity': 0.98393387, 'binary_f1_score': 0.96035725}
confusion matrix:
       0      1
0  24987    408
1   1563  23874
---- Validation: 
scalar performance:
{'acc': 0.95176077, 'precision': 0.63353246, 'recall': 0.7684423, 'specificity': 0.7684423, 'f1': 0.6750505, 'auroc': 0.892601, 'binary_precision': 0.27833894, 'binary_recall': 0.575406, 'binary_specificity': 0.96147853, 'binary_f1_score': 0.3751891}
confusion matrix:
       0    1
0  16049  643
1    183  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8901992, 'precision': 0.6452419, 'recall': 0.6972664, 'specificity': 0.6972664, 'f1': 0.6654334, 'auroc': 0.86499107, 'binary_precision': 0.3349012, 'binary_recall': 0.4702774, 'binary_specificity': 0.92425543, 'binary_f1_score': 0.39120877}
confusion matrix:
      0    1
0  8627  707
1   401  356
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 07:05:58.997843,epoch time: 0:44:29.225058,used: 1:29:56.640733,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_05_36_02_seed_1_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9697238, 'precision': 0.9702485, 'recall': 0.969735, 'specificity': 0.969735, 'f1': 0.96971583, 'auroc': 0.99380994, 'binary_precision': 0.9861247, 'binary_recall': 0.9528958, 'binary_specificity': 0.9865743, 'binary_f1_score': 0.9692255}
confusion matrix:
       0      1
0  25058    341
1   1198  24235
---- Validation: 
scalar performance:
{'acc': 0.94393504, 'precision': 0.62460685, 'recall': 0.8039832, 'specificity': 0.8039832, 'f1': 0.67078227, 'auroc': 0.9039911, 'binary_precision': 0.2584475, 'binary_recall': 0.6566125, 'binary_specificity': 0.95135397, 'binary_f1_score': 0.37090433}
confusion matrix:
       0    1
0  15880  812
1    148  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8725597, 'precision': 0.6468034, 'recall': 0.7690606, 'specificity': 0.7690606, 'f1': 0.68035036, 'auroc': 0.8676569, 'binary_precision': 0.32471836, 'binary_recall': 0.64729196, 'binary_specificity': 0.8908292, 'binary_f1_score': 0.43248016}
confusion matrix:
      0     1
0  8315  1019
1   267   490
early stop counter: 1
val acc:0.9439350366592407, best validation acc: 0.9517607688903809, corresponding to test acc:                         0.8901991844177246 / 0.8901991844177246
after epoch: 3,now: 2024-08-08 07:50:27.459066,epoch time: 0:44:28.461223,used: 2:14:25.101956,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_05_36_02_seed_1_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97214353, 'precision': 0.97261536, 'recall': 0.972158, 'specificity': 0.972158, 'f1': 0.97213715, 'auroc': 0.995439, 'binary_precision': 0.98777664, 'binary_recall': 0.95616966, 'binary_specificity': 0.98814636, 'binary_f1_score': 0.97171617}
confusion matrix:
       0      1
0  25092    301
1   1115  24324
---- Validation: 
scalar performance:
{'acc': 0.94574547, 'precision': 0.6296231, 'recall': 0.8105625, 'specificity': 0.8105625, 'f1': 0.67717505, 'auroc': 0.9084417, 'binary_precision': 0.26815644, 'binary_recall': 0.6682135, 'binary_specificity': 0.95291156, 'binary_f1_score': 0.3827243}
confusion matrix:
       0    1
0  15906  786
1    143  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.890001, 'precision': 0.6607015, 'recall': 0.74874866, 'specificity': 0.74874866, 'f1': 0.6908742, 'auroc': 0.86652684, 'binary_precision': 0.35708502, 'binary_recall': 0.58256274, 'binary_specificity': 0.91493464, 'binary_f1_score': 0.44277108}
confusion matrix:
      0    1
0  8540  794
1   316  441
early stop counter: 2
val acc:0.9457454681396484, best validation acc: 0.9517607688903809, corresponding to test acc:                         0.8901991844177246 / 0.8901991844177246
after epoch: 4,now: 2024-08-08 08:34:59.670445,epoch time: 0:44:32.211379,used: 2:58:57.313335,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_05_36_02_seed_1_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97690433, 'precision': 0.9770128, 'recall': 0.97690976, 'specificity': 0.97690976, 'f1': 0.9769032, 'auroc': 0.99639606, 'binary_precision': 0.9843862, 'binary_recall': 0.96921444, 'binary_specificity': 0.9846051, 'binary_f1_score': 0.9767414}
confusion matrix:
       0      1
0  25007    391
1    783  24651
---- Validation: 
scalar performance:
{'acc': 0.9367517, 'precision': 0.61520207, 'recall': 0.8172509, 'specificity': 0.8172509, 'f1': 0.66085935, 'auroc': 0.9099513, 'binary_precision': 0.23878205, 'binary_recall': 0.6914153, 'binary_specificity': 0.9430865, 'binary_f1_score': 0.3549732}
confusion matrix:
       0    1
0  15742  950
1    133  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.866812, 'precision': 0.64496654, 'recall': 0.78112704, 'specificity': 0.78112704, 'f1': 0.6791976, 'auroc': 0.87120104, 'binary_precision': 0.31849104, 'binary_recall': 0.68031704, 'binary_specificity': 0.881937, 'binary_f1_score': 0.4338669}
confusion matrix:
      0     1
0  8232  1102
1   242   515
early stop counter: 3
val acc:0.9367517232894897, best validation acc: 0.9517607688903809, corresponding to test acc:                         0.8901991844177246 / 0.8901991844177246
after epoch: 5,now: 2024-08-08 09:19:24.040715,epoch time: 0:44:24.370270,used: 3:43:21.683605,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_05_36_02_seed_1_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 3:43:21.683605 at 2024-08-08 09:19:24.040715
persisted model performance metric: 

scalar performance:
{'acc': 0.8901992, 'precision': 0.6452419, 'recall': 0.6972664, 'specificity': 0.6972664, 'f1': 0.6654334, 'auroc': 0.86499107, 'binary_precision': 0.3349012, 'binary_recall': 0.4702774, 'binary_specificity': 0.92425543, 'binary_f1_score': 0.39120877}
confusion matrix:
      0    1
0  8627  707
1   401  356
oracle model performance metric: 

scalar performance:
{'acc': 0.8901992, 'precision': 0.6452419, 'recall': 0.6972664, 'specificity': 0.6972664, 'f1': 0.6654334, 'auroc': 0.86499107, 'binary_precision': 0.3349012, 'binary_recall': 0.4702774, 'binary_specificity': 0.92425543, 'binary_f1_score': 0.39120877}
confusion matrix:
      0    1
0  8627  707
1   401  356
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   4047 MiB |   1818 TiB |   1818 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1797 TiB |   1797 TiB |
|       from small pool |  18208 KiB |     38 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   4047 MiB |   1818 TiB |   1818 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   1797 TiB |   1797 TiB |
|       from small pool |  18208 KiB |     38 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   4045 MiB |   1818 TiB |   1818 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   1797 TiB |   1797 TiB |
|       from small pool |  16662 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4420 MiB |   4432 MiB |   8598 MiB |   4178 MiB |
|       from large pool |   4382 MiB |   4390 MiB |   8546 MiB |   4164 MiB |
|       from small pool |     38 MiB |     42 MiB |     52 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB | 398856 KiB |    955 TiB |    955 TiB |
|       from large pool |  31733 KiB | 397938 KiB |    933 TiB |    933 TiB |
|       from small pool |  10464 KiB |  24597 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6829    |  249068 K  |  249064 K  |
|       from large pool |      79    |     423    |  168883 K  |  168883 K  |
|       from small pool |    4333    |    6749    |   80185 K  |   80181 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6829    |  249068 K  |  249064 K  |
|       from large pool |      79    |     423    |  168883 K  |  168883 K  |
|       from small pool |    4333    |    6749    |   80185 K  |   80181 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     203    |     378    |     178    |
|       from large pool |     181    |     182    |     352    |     171    |
|       from small pool |      19    |      21    |      26    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3197    |  170064 K  |  170064 K  |
|       from large pool |      11    |     186    |  133823 K  |  133823 K  |
|       from small pool |      21    |    3186    |   36241 K  |   36241 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1818 TiB |   1818 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1797 TiB |   1797 TiB |
|       from small pool |      0 KiB |     38 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1818 TiB |   1818 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1797 TiB |   1797 TiB |
|       from small pool |      0 KiB |     38 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1818 TiB |   1818 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1797 TiB |   1797 TiB |
|       from small pool |      0 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4432 MiB |   8598 MiB |   8364 MiB |
|       from large pool | 210944 KiB |   4390 MiB |   8546 MiB |   8340 MiB |
|       from small pool |  28672 KiB |     42 MiB |     52 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB |    955 TiB |    955 TiB |
|       from large pool |  30464 KiB | 397938 KiB |    933 TiB |    933 TiB |
|       from small pool |      0 KiB |  25471 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  249068 K  |  249068 K  |
|       from large pool |       2    |     423    |  168883 K  |  168883 K  |
|       from small pool |       0    |    6749    |   80185 K  |   80185 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  249068 K  |  249068 K  |
|       from large pool |       2    |     423    |  168883 K  |  168883 K  |
|       from small pool |       0    |    6749    |   80185 K  |   80185 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     203    |     378    |     354    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |      14    |      21    |      26    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3197    |  170066 K  |  170066 K  |
|       from large pool |       3    |     186    |  133823 K  |  133823 K  |
|       from small pool |       0    |    3186    |   36243 K  |   36243 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   1818 TiB |   1818 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1797 TiB |   1797 TiB |
|       from small pool |      0 KiB |     38 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   1818 TiB |   1818 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   1797 TiB |   1797 TiB |
|       from small pool |      0 KiB |     38 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   1818 TiB |   1818 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   1797 TiB |   1797 TiB |
|       from small pool |      0 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4432 MiB |   8598 MiB |   8364 MiB |
|       from large pool | 210944 KiB |   4390 MiB |   8546 MiB |   8340 MiB |
|       from small pool |  28672 KiB |     42 MiB |     52 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB |    955 TiB |    955 TiB |
|       from large pool |  30464 KiB | 397938 KiB |    933 TiB |    933 TiB |
|       from small pool |      0 KiB |  25471 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  249068 K  |  249068 K  |
|       from large pool |       2    |     423    |  168883 K  |  168883 K  |
|       from small pool |       0    |    6749    |   80185 K  |   80185 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  249068 K  |  249068 K  |
|       from large pool |       2    |     423    |  168883 K  |  168883 K  |
|       from small pool |       0    |    6749    |   80185 K  |   80185 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     203    |     378    |     354    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |      14    |      21    |      26    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3197    |  170066 K  |  170066 K  |
|       from large pool |       3    |     186    |  133823 K  |  133823 K  |
|       from small pool |       0    |    3186    |   36243 K  |   36243 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_42_45_seed_2_24111559

 Experiment start at: 2024-08-08 09:42:45.772731
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9489902, 'precision': 0.9500373, 'recall': 0.94899493, 'specificity': 0.94899493, 'f1': 0.9489609, 'auroc': 0.9848971, 'binary_precision': 0.9717932, 'binary_recall': 0.9248443, 'binary_specificity': 0.97314554, 'binary_f1_score': 0.9477377}
confusion matrix:
       0      1
0  25149    694
1   1943  23910
---- Validation: 
scalar performance:
{'acc': 0.9274118, 'precision': 0.58795345, 'recall': 0.76220405, 'specificity': 0.76220405, 'f1': 0.6226713, 'auroc': 0.8490303, 'binary_precision': 0.18678816, 'binary_recall': 0.5885168, 'binary_specificity': 0.9358913, 'binary_f1_score': 0.28357348}
confusion matrix:
       0     1
0  15635  1071
1    172   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87861675, 'precision': 0.65584385, 'recall': 0.7563007, 'specificity': 0.7563007, 'f1': 0.68740815, 'auroc': 0.8689606, 'binary_precision': 0.3473609, 'binary_recall': 0.6110414, 'binary_specificity': 0.90155995, 'binary_f1_score': 0.4429286}
confusion matrix:
      0    1
0  8380  915
1   310  487
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 10:30:36.765807,epoch time: 0:47:50.993076,used: 0:47:50.993076,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_42_45_seed_2_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9615444, 'precision': 0.962453, 'recall': 0.9615487, 'specificity': 0.9615487, 'f1': 0.9615258, 'auroc': 0.9919605, 'binary_precision': 0.9829994, 'binary_recall': 0.9393494, 'binary_specificity': 0.983748, 'binary_f1_score': 0.9606789}
confusion matrix:
       0      1
0  25423    420
1   1568  24285
---- Validation: 
scalar performance:
{'acc': 0.9350035, 'precision': 0.59654737, 'recall': 0.75909734, 'specificity': 0.75909734, 'f1': 0.63361734, 'auroc': 0.85920006, 'binary_precision': 0.20425531, 'binary_recall': 0.57416266, 'binary_specificity': 0.9440321, 'binary_f1_score': 0.30131826}
confusion matrix:
       0    1
0  15771  935
1    178  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90200156, 'precision': 0.68768203, 'recall': 0.75178885, 'specificity': 0.75178885, 'f1': 0.7130972, 'auroc': 0.88808596, 'binary_precision': 0.41320074, 'binary_recall': 0.57340026, 'binary_specificity': 0.9301775, 'binary_f1_score': 0.48029426}
confusion matrix:
      0    1
0  8646  649
1   340  457
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 11:18:36.563517,epoch time: 0:47:59.797710,used: 1:35:50.790786,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_42_45_seed_2_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9696301, 'precision': 0.97012913, 'recall': 0.9696326, 'specificity': 0.9696326, 'f1': 0.9696222, 'auroc': 0.9943924, 'binary_precision': 0.98548466, 'binary_recall': 0.95331115, 'binary_specificity': 0.98595417, 'binary_f1_score': 0.96913093}
confusion matrix:
       0      1
0  25481    363
1   1207  24645
---- Validation: 
scalar performance:
{'acc': 0.94352955, 'precision': 0.61166567, 'recall': 0.7657995, 'specificity': 0.7657995, 'f1': 0.65203935, 'auroc': 0.8748587, 'binary_precision': 0.23426911, 'binary_recall': 0.57894737, 'binary_specificity': 0.95265174, 'binary_f1_score': 0.3335631}
confusion matrix:
       0    1
0  15915  791
1    176  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9088387, 'precision': 0.70285827, 'recall': 0.7623832, 'specificity': 0.7623832, 'f1': 0.727321, 'auroc': 0.89735276, 'binary_precision': 0.44203582, 'binary_recall': 0.5884567, 'binary_specificity': 0.9363098, 'binary_f1_score': 0.5048439}
confusion matrix:
      0    1
0  8703  592
1   328  469
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-08 12:05:18.505542,epoch time: 0:46:41.942025,used: 2:22:32.732811,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_42_45_seed_2_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9739438, 'precision': 0.9744481, 'recall': 0.973947, 'specificity': 0.973947, 'f1': 0.97393703, 'auroc': 0.9956392, 'binary_precision': 0.98996323, 'binary_recall': 0.9576065, 'binary_specificity': 0.9902875, 'binary_f1_score': 0.9735161}
confusion matrix:
       0      1
0  25592    251
1   1096  24757
---- Validation: 
scalar performance:
{'acc': 0.93944174, 'precision': 0.60505867, 'recall': 0.7672032, 'specificity': 0.7672032, 'f1': 0.6445992, 'auroc': 0.87750566, 'binary_precision': 0.22091974, 'binary_recall': 0.5861244, 'binary_specificity': 0.94828206, 'binary_f1_score': 0.32089064}
confusion matrix:
       0    1
0  15842  864
1    173  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90745145, 'precision': 0.7029779, 'recall': 0.7776899, 'specificity': 0.7776899, 'f1': 0.7321995, 'auroc': 0.8990047, 'binary_precision': 0.43943414, 'binary_recall': 0.62358844, 'binary_specificity': 0.9317913, 'binary_f1_score': 0.5155602}
confusion matrix:
      0    1
0  8661  634
1   300  497
early stop counter: 1
val acc:0.9394417405128479, best validation acc: 0.9435295462608337, corresponding to test acc:                         0.90883868932724 / 0.90883868932724
after epoch: 4,now: 2024-08-08 12:51:55.324061,epoch time: 0:46:36.818519,used: 3:09:09.551330,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_42_45_seed_2_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9761684, 'precision': 0.97649676, 'recall': 0.9761699, 'specificity': 0.9761699, 'f1': 0.9761643, 'auroc': 0.9965557, 'binary_precision': 0.989035, 'binary_recall': 0.96301883, 'binary_specificity': 0.98932093, 'binary_f1_score': 0.97585356}
confusion matrix:
       0      1
0  25569    276
1    956  24895
---- Validation: 
scalar performance:
{'acc': 0.9392665, 'precision': 0.6058808, 'recall': 0.7717784, 'specificity': 0.7717784, 'f1': 0.64600134, 'auroc': 0.88257337, 'binary_precision': 0.22232144, 'binary_recall': 0.59569377, 'binary_specificity': 0.94786304, 'binary_f1_score': 0.32379717}
confusion matrix:
       0    1
0  15835  871
1    169  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90814507, 'precision': 0.7074948, 'recall': 0.79584676, 'specificity': 0.79584676, 'f1': 0.74079764, 'auroc': 0.90566844, 'binary_precision': 0.44519392, 'binary_recall': 0.6624843, 'binary_specificity': 0.92920923, 'binary_f1_score': 0.5325265}
confusion matrix:
      0    1
0  8637  658
1   269  528
early stop counter: 2
val acc:0.9392665028572083, best validation acc: 0.9435295462608337, corresponding to test acc:                         0.90883868932724 / 0.90883868932724
after epoch: 5,now: 2024-08-08 13:40:28.340369,epoch time: 0:48:33.016308,used: 3:57:42.567638,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_42_45_seed_2_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9787798, 'precision': 0.97904754, 'recall': 0.9787816, 'specificity': 0.9787816, 'f1': 0.9787768, 'auroc': 0.99699485, 'binary_precision': 0.99041164, 'binary_recall': 0.9669271, 'binary_specificity': 0.9906361, 'binary_f1_score': 0.97852844}
confusion matrix:
       0      1
0  25602    242
1    855  24997
---- Validation: 
scalar performance:
{'acc': 0.93844897, 'precision': 0.60642815, 'recall': 0.7795231, 'specificity': 0.7795231, 'f1': 0.64734876, 'auroc': 0.8864353, 'binary_precision': 0.22299652, 'binary_recall': 0.61244017, 'binary_specificity': 0.946606, 'binary_f1_score': 0.3269476}
confusion matrix:
       0    1
0  15814  892
1    162  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90804595, 'precision': 0.71164834, 'recall': 0.8216032, 'specificity': 0.8216032, 'f1': 0.75065655, 'auroc': 0.9106974, 'binary_precision': 0.4487079, 'binary_recall': 0.71894604, 'binary_specificity': 0.9242604, 'binary_f1_score': 0.5525555}
confusion matrix:
      0    1
0  8591  704
1   224  573
early stop counter: 3
val acc:0.938448965549469, best validation acc: 0.9435295462608337, corresponding to test acc:                         0.90883868932724 / 0.90883868932724
after epoch: 6,now: 2024-08-08 14:32:45.916020,epoch time: 0:52:17.575651,used: 4:50:00.143289,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_09_42_45_seed_2_24111559
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 4:50:00.143289 at 2024-08-08 14:32:45.916020
persisted model performance metric: 

scalar performance:
{'acc': 0.9088387, 'precision': 0.70285827, 'recall': 0.7623832, 'specificity': 0.7623832, 'f1': 0.727321, 'auroc': 0.89735276, 'binary_precision': 0.44203582, 'binary_recall': 0.5884567, 'binary_specificity': 0.9363098, 'binary_f1_score': 0.5048439}
confusion matrix:
      0    1
0  8703  592
1   328  469
oracle model performance metric: 

scalar performance:
{'acc': 0.9088387, 'precision': 0.70285827, 'recall': 0.7623832, 'specificity': 0.7623832, 'f1': 0.727321, 'auroc': 0.89735276, 'binary_precision': 0.44203582, 'binary_recall': 0.5884567, 'binary_specificity': 0.9363098, 'binary_f1_score': 0.5048439}
confusion matrix:
      0    1
0  8703  592
1   328  469
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   4047 MiB |   2385 TiB |   2385 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   2357 TiB |   2357 TiB |
|       from small pool |  18208 KiB |     38 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   4047 MiB |   2385 TiB |   2385 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   2357 TiB |   2357 TiB |
|       from small pool |  18208 KiB |     38 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   4045 MiB |   2385 TiB |   2385 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   2357 TiB |   2357 TiB |
|       from small pool |  16662 KiB |     36 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4420 MiB |   4432 MiB |  12784 MiB |   8364 MiB |
|       from large pool |   4382 MiB |   4390 MiB |  12722 MiB |   8340 MiB |
|       from small pool |     38 MiB |     42 MiB |     62 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB | 398856 KiB |   1261 TiB |   1261 TiB |
|       from large pool |  31733 KiB | 397938 KiB |   1233 TiB |   1233 TiB |
|       from small pool |  10464 KiB |  25471 KiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6937    |  326833 K  |  326829 K  |
|       from large pool |      79    |     423    |  221572 K  |  221572 K  |
|       from small pool |    4333    |    6857    |  105260 K  |  105256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6937    |  326833 K  |  326829 K  |
|       from large pool |      79    |     423    |  221572 K  |  221572 K  |
|       from small pool |    4333    |    6857    |  105260 K  |  105256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     203    |     554    |     354    |
|       from large pool |     181    |     182    |     523    |     342    |
|       from small pool |      19    |      21    |      31    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3251    |  224307 K  |  224307 K  |
|       from large pool |      11    |     186    |  173769 K  |  173769 K  |
|       from small pool |      21    |    3240    |   50538 K  |   50538 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   2385 TiB |   2385 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   2357 TiB |   2357 TiB |
|       from small pool |      0 KiB |     38 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   2385 TiB |   2385 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   2357 TiB |   2357 TiB |
|       from small pool |      0 KiB |     38 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   2385 TiB |   2385 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   2357 TiB |   2357 TiB |
|       from small pool |      0 KiB |     36 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   4432 MiB |  12784 MiB |  12550 MiB |
|       from large pool | 210944 KiB |   4390 MiB |  12722 MiB |  12516 MiB |
|       from small pool |  28672 KiB |     42 MiB |     62 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398856 KiB |   1261 TiB |   1261 TiB |
|       from large pool |  30464 KiB | 397938 KiB |   1233 TiB |   1233 TiB |
|       from small pool |      0 KiB |  25471 KiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6937    |  326833 K  |  326833 K  |
|       from large pool |       2    |     423    |  221572 K  |  221572 K  |
|       from small pool |       0    |    6857    |  105260 K  |  105260 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6937    |  326833 K  |  326833 K  |
|       from large pool |       2    |     423    |  221572 K  |  221572 K  |
|       from small pool |       0    |    6857    |  105260 K  |  105260 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     203    |     554    |     530    |
|       from large pool |      10    |     182    |     523    |     513    |
|       from small pool |      14    |      21    |      31    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3251    |  224309 K  |  224309 K  |
|       from large pool |       3    |     186    |  173769 K  |  173769 K  |
|       from small pool |       0    |    3240    |   50540 K  |   50540 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  8 14:52:49 2024]
Finished job 0.
1 of 1 steps (100%) done
