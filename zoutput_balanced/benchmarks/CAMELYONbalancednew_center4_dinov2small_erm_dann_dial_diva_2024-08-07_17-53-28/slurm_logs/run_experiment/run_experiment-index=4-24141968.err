Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 13:05:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_13_17_26_seed_0_24141968

 Experiment start at: 2024-08-10 13:17:26.979200
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.4511568248271942
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96063644, 'precision': 0.96148634, 'recall': 0.9606458, 'specificity': 0.9606458, 'f1': 0.9606189, 'auroc': 0.99145925, 'binary_precision': 0.9813998, 'binary_recall': 0.93910575, 'binary_specificity': 0.9821859, 'binary_f1_score': 0.9597871}
confusion matrix:
       0      1
0  24866    451
1   1543  23796
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.89478594, 'precision': 0.565657, 'recall': 0.7780725, 'specificity': 0.7780725, 'f1': 0.5876064, 'auroc': 0.8535399, 'binary_precision': 0.14071392, 'binary_recall': 0.6554217, 'binary_specificity': 0.9007232, 'binary_f1_score': 0.23168655}
confusion matrix:
       0     1
0  15070  1661
1    143   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.833597, 'precision': 0.6377219, 'recall': 0.8314956, 'specificity': 0.8314956, 'f1': 0.6672571, 'auroc': 0.8985721, 'binary_precision': 0.29210407, 'binary_recall': 0.82901555, 'binary_specificity': 0.8339756, 'binary_f1_score': 0.43199462}
confusion matrix:
      0     1
0  7791  1551
1   132   640
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 13:55:05.071293,epoch time: 0:37:38.092093,used: 0:37:38.092093,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_13_17_26_seed_0_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9703293, 'precision': 0.97097874, 'recall': 0.9703426, 'specificity': 0.9703426, 'f1': 0.9703196, 'auroc': 0.9954212, 'binary_precision': 0.98864615, 'binary_recall': 0.95162946, 'binary_specificity': 0.9890557, 'binary_f1_score': 0.9697847}
confusion matrix:
       0      1
0  25033    277
1   1226  24120
---- Validation: 
scalar performance:
{'acc': 0.9243555, 'precision': 0.5838971, 'recall': 0.7615007, 'specificity': 0.7615007, 'f1': 0.6171505, 'auroc': 0.87266034, 'binary_precision': 0.17857143, 'binary_recall': 0.5903614, 'binary_specificity': 0.93264, 'binary_f1_score': 0.2742026}
confusion matrix:
       0     1
0  15604  1127
1    170   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89025116, 'precision': 0.67553324, 'recall': 0.79621327, 'specificity': 0.79621327, 'f1': 0.7132728, 'auroc': 0.88463473, 'binary_precision': 0.37893984, 'binary_recall': 0.6852332, 'binary_specificity': 0.9071933, 'binary_f1_score': 0.4880074}
confusion matrix:
      0    1
0  8475  867
1   243  529
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 14:30:56.267023,epoch time: 0:35:51.195730,used: 1:13:29.287823,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_13_17_26_seed_0_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9758765, 'precision': 0.97604525, 'recall': 0.9758822, 'specificity': 0.9758822, 'f1': 0.97587454, 'auroc': 0.9966513, 'binary_precision': 0.9851563, 'binary_recall': 0.9663418, 'binary_specificity': 0.9854225, 'binary_f1_score': 0.97565836}
confusion matrix:
       0      1
0  24944    369
1    853  24490
---- Validation: 
scalar performance:
{'acc': 0.9047008, 'precision': 0.5776246, 'recall': 0.8101764, 'specificity': 0.8101764, 'f1': 0.6071668, 'auroc': 0.8913863, 'binary_precision': 0.16307352, 'binary_recall': 0.7108434, 'binary_specificity': 0.9095093, 'binary_f1_score': 0.2652878}
confusion matrix:
       0     1
0  15217  1514
1    120   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8692901, 'precision': 0.66085184, 'recall': 0.82586277, 'specificity': 0.82586277, 'f1': 0.7001665, 'auroc': 0.8949393, 'binary_precision': 0.34249714, 'binary_recall': 0.7746114, 'binary_specificity': 0.8771141, 'binary_f1_score': 0.47498012}
confusion matrix:
      0     1
0  8194  1148
1   174   598
early stop counter: 1
val acc:0.9047008156776428, best validation acc: 0.9243555068969727, corresponding to test acc:                         0.8902511596679688 / 0.8902511596679688
after epoch: 3,now: 2024-08-10 15:07:12.260823,epoch time: 0:36:15.993800,used: 1:49:45.281623,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_13_17_26_seed_0_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97927195, 'precision': 0.97945195, 'recall': 0.97927773, 'specificity': 0.97927773, 'f1': 0.97927016, 'auroc': 0.99718547, 'binary_precision': 0.9888911, 'binary_recall': 0.969459, 'binary_specificity': 0.9890965, 'binary_f1_score': 0.9790786}
confusion matrix:
       0      1
0  25037    276
1    774  24569
---- Validation: 
scalar performance:
{'acc': 0.90901667, 'precision': 0.57865137, 'recall': 0.7994635, 'specificity': 0.7994635, 'f1': 0.60920787, 'auroc': 0.89258623, 'binary_precision': 0.165791, 'binary_recall': 0.6843374, 'binary_specificity': 0.9145897, 'binary_f1_score': 0.2669173}
confusion matrix:
       0     1
0  15302  1429
1    131   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87888074, 'precision': 0.66734457, 'recall': 0.81560653, 'specificity': 0.81560653, 'f1': 0.7071557, 'auroc': 0.8892136, 'binary_precision': 0.35817158, 'binary_recall': 0.74093264, 'binary_specificity': 0.8902804, 'binary_f1_score': 0.4829042}
confusion matrix:
      0     1
0  8317  1025
1   200   572
early stop counter: 2
val acc:0.9090166687965393, best validation acc: 0.9243555068969727, corresponding to test acc:                         0.8902511596679688 / 0.8902511596679688
after epoch: 4,now: 2024-08-10 15:43:24.924113,epoch time: 0:36:12.663290,used: 2:25:57.944913,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_13_17_26_seed_0_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9800813, 'precision': 0.98013985, 'recall': 0.98008466, 'specificity': 0.98008466, 'f1': 0.98008084, 'auroc': 0.9975354, 'binary_precision': 0.98559225, 'binary_recall': 0.9744308, 'binary_specificity': 0.9857386, 'binary_f1_score': 0.97997975}
confusion matrix:
       0      1
0  24952    361
1    648  24695
---- Validation: 
scalar performance:
{'acc': 0.87985533, 'precision': 0.56295633, 'recall': 0.80332017, 'specificity': 0.80332017, 'f1': 0.58022, 'auroc': 0.8900403, 'binary_precision': 0.13363029, 'binary_recall': 0.72289157, 'binary_specificity': 0.8837487, 'binary_f1_score': 0.22556391}
confusion matrix:
       0     1
0  14786  1945
1    115   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8531738, 'precision': 0.6483464, 'recall': 0.8260509, 'specificity': 0.8260509, 'f1': 0.6837284, 'auroc': 0.89358985, 'binary_precision': 0.31614235, 'binary_recall': 0.79404145, 'binary_specificity': 0.85806036, 'binary_f1_score': 0.45223162}
confusion matrix:
      0     1
0  8016  1326
1   159   613
early stop counter: 3
val acc:0.8798553347587585, best validation acc: 0.9243555068969727, corresponding to test acc:                         0.8902511596679688 / 0.8902511596679688
after epoch: 5,now: 2024-08-10 16:19:36.202581,epoch time: 0:36:11.278468,used: 3:02:09.223381,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_13_17_26_seed_0_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 3:02:09.223381 at 2024-08-10 16:19:36.202581
persisted model performance metric: 

scalar performance:
{'acc': 0.89025116, 'precision': 0.67553324, 'recall': 0.79621327, 'specificity': 0.79621327, 'f1': 0.7132728, 'auroc': 0.88463473, 'binary_precision': 0.37893984, 'binary_recall': 0.6852332, 'binary_specificity': 0.9071933, 'binary_f1_score': 0.4880074}
confusion matrix:
      0    1
0  8475  867
1   243  529
oracle model performance metric: 

scalar performance:
{'acc': 0.89025116, 'precision': 0.67553324, 'recall': 0.79621327, 'specificity': 0.79621327, 'f1': 0.7132728, 'auroc': 0.88463473, 'binary_precision': 0.37893984, 'binary_recall': 0.6852332, 'binary_specificity': 0.9071933, 'binary_f1_score': 0.4880074}
confusion matrix:
      0    1
0  8475  867
1   243  529
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 762007 KiB |   5629 MiB | 417896 GiB | 417895 GiB |
|       from large pool | 718015 KiB |   5587 MiB | 413807 GiB | 413806 GiB |
|       from small pool |  43992 KiB |     83 MiB |   4089 GiB |   4088 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 762007 KiB |   5629 MiB | 417896 GiB | 417895 GiB |
|       from large pool | 718015 KiB |   5587 MiB | 413807 GiB | 413806 GiB |
|       from small pool |  43992 KiB |     83 MiB |   4089 GiB |   4088 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 760017 KiB |   5628 MiB | 417626 GiB | 417625 GiB |
|       from large pool | 717638 KiB |   5586 MiB | 413543 GiB | 413542 GiB |
|       from small pool |  42379 KiB |     81 MiB |   4083 GiB |   4083 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5966 MiB |   5966 MiB |   5966 MiB |      0 B   |
|       from large pool |   5878 MiB |   5878 MiB |   5878 MiB |      0 B   |
|       from small pool |     88 MiB |     88 MiB |     88 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 388968 KiB | 758536 KiB | 260366 GiB | 260366 GiB |
|       from large pool | 375617 KiB | 756018 KiB | 256241 GiB | 256241 GiB |
|       from small pool |  13351 KiB |  16288 KiB |   4125 GiB |   4125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5060    |    7443    |   53900 K  |   53895 K  |
|       from large pool |     166    |     448    |   31224 K  |   31223 K  |
|       from small pool |    4894    |    7276    |   22676 K  |   22671 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5060    |    7443    |   53900 K  |   53895 K  |
|       from large pool |     166    |     448    |   31224 K  |   31223 K  |
|       from small pool |    4894    |    7276    |   22676 K  |   22671 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     174    |     174    |     174    |       0    |
|       from large pool |     130    |     130    |     130    |       0    |
|       from small pool |      44    |      44    |      44    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3207    |   29968 K  |   29968 K  |
|       from large pool |      30    |     131    |   19660 K  |   19659 K  |
|       from small pool |      40    |    3177    |   10308 K  |   10308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5629 MiB | 417896 GiB | 417896 GiB |
|       from large pool |  16640 KiB |   5587 MiB | 413807 GiB | 413807 GiB |
|       from small pool |      0 KiB |     83 MiB |   4089 GiB |   4089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5629 MiB | 417896 GiB | 417896 GiB |
|       from large pool |  16640 KiB |   5587 MiB | 413807 GiB | 413807 GiB |
|       from small pool |      0 KiB |     83 MiB |   4089 GiB |   4089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5628 MiB | 417626 GiB | 417626 GiB |
|       from large pool |  16640 KiB |   5586 MiB | 413543 GiB | 413543 GiB |
|       from small pool |      0 KiB |     81 MiB |   4083 GiB |   4083 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1124 MiB |   5966 MiB |   5966 MiB |   4842 MiB |
|       from large pool |   1068 MiB |   5878 MiB |   5878 MiB |   4810 MiB |
|       from small pool |     56 MiB |     88 MiB |     88 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB | 758536 KiB | 260367 GiB | 260367 GiB |
|       from large pool | 204544 KiB | 756018 KiB | 256241 GiB | 256241 GiB |
|       from small pool |      0 KiB |  34837 KiB |   4125 GiB |   4125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7443    |   53900 K  |   53900 K  |
|       from large pool |       2    |     448    |   31224 K  |   31224 K  |
|       from small pool |       0    |    7276    |   22676 K  |   22676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7443    |   53900 K  |   53900 K  |
|       from large pool |       2    |     448    |   31224 K  |   31224 K  |
|       from small pool |       0    |    7276    |   22676 K  |   22676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     174    |     174    |     118    |
|       from large pool |      28    |     130    |     130    |     102    |
|       from small pool |      28    |      44    |      44    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3207    |   29970 K  |   29970 K  |
|       from large pool |       3    |     131    |   19660 K  |   19660 K  |
|       from small pool |       0    |    3177    |   10310 K  |   10310 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5629 MiB | 417896 GiB | 417896 GiB |
|       from large pool |  16640 KiB |   5587 MiB | 413807 GiB | 413807 GiB |
|       from small pool |      0 KiB |     83 MiB |   4089 GiB |   4089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5629 MiB | 417896 GiB | 417896 GiB |
|       from large pool |  16640 KiB |   5587 MiB | 413807 GiB | 413807 GiB |
|       from small pool |      0 KiB |     83 MiB |   4089 GiB |   4089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5628 MiB | 417626 GiB | 417626 GiB |
|       from large pool |  16640 KiB |   5586 MiB | 413543 GiB | 413543 GiB |
|       from small pool |      0 KiB |     81 MiB |   4083 GiB |   4083 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1124 MiB |   5966 MiB |   5966 MiB |   4842 MiB |
|       from large pool |   1068 MiB |   5878 MiB |   5878 MiB |   4810 MiB |
|       from small pool |     56 MiB |     88 MiB |     88 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB | 758536 KiB | 260367 GiB | 260367 GiB |
|       from large pool | 204544 KiB | 756018 KiB | 256241 GiB | 256241 GiB |
|       from small pool |      0 KiB |  34837 KiB |   4125 GiB |   4125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7443    |   53900 K  |   53900 K  |
|       from large pool |       2    |     448    |   31224 K  |   31224 K  |
|       from small pool |       0    |    7276    |   22676 K  |   22676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7443    |   53900 K  |   53900 K  |
|       from large pool |       2    |     448    |   31224 K  |   31224 K  |
|       from small pool |       0    |    7276    |   22676 K  |   22676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     174    |     174    |     118    |
|       from large pool |      28    |     130    |     130    |     102    |
|       from small pool |      28    |      44    |      44    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3207    |   29970 K  |   29970 K  |
|       from large pool |       3    |     131    |   19660 K  |   19660 K  |
|       from small pool |       0    |    3177    |   10310 K  |   10310 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_29_32_seed_1_24141968

 Experiment start at: 2024-08-10 16:29:33.002934
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.15776434540748596
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9574874, 'precision': 0.95861065, 'recall': 0.957507, 'specificity': 0.957507, 'f1': 0.95746267, 'auroc': 0.98921806, 'binary_precision': 0.9815052, 'binary_recall': 0.9326152, 'binary_specificity': 0.9823988, 'binary_f1_score': 0.95643586}
confusion matrix:
       0      1
0  24949    447
1   1714  23722
---- Validation: 
scalar performance:
{'acc': 0.8614145, 'precision': 0.5485108, 'recall': 0.7447055, 'specificity': 0.7447055, 'f1': 0.55426526, 'auroc': 0.82448184, 'binary_precision': 0.108151734, 'binary_recall': 0.6218097, 'binary_specificity': 0.8676013, 'binary_f1_score': 0.18425575}
confusion matrix:
       0     1
0  14482  2210
1    163   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81944305, 'precision': 0.60885596, 'recall': 0.7591633, 'specificity': 0.7591633, 'f1': 0.6293092, 'auroc': 0.83459145, 'binary_precision': 0.247271, 'binary_recall': 0.6882431, 'binary_specificity': 0.83008355, 'binary_f1_score': 0.3638268}
confusion matrix:
      0     1
0  7748  1586
1   236   521
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 17:06:50.480433,epoch time: 0:37:17.477499,used: 0:37:17.477499,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_29_32_seed_1_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97074676, 'precision': 0.9711144, 'recall': 0.97075737, 'specificity': 0.97075737, 'f1': 0.97074157, 'auroc': 0.9941838, 'binary_precision': 0.9844635, 'binary_recall': 0.9566346, 'binary_specificity': 0.9848801, 'binary_f1_score': 0.9703496}
confusion matrix:
       0      1
0  25013    384
1   1103  24332
---- Validation: 
scalar performance:
{'acc': 0.86445135, 'precision': 0.5514238, 'recall': 0.7564344, 'specificity': 0.7564344, 'f1': 0.559355, 'auroc': 0.84425247, 'binary_precision': 0.11333879, 'binary_recall': 0.64269143, 'binary_specificity': 0.8701773, 'binary_f1_score': 0.19269566}
confusion matrix:
       0     1
0  14525  2167
1    154   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87077594, 'precision': 0.64224386, 'recall': 0.7589923, 'specificity': 0.7589923, 'f1': 0.6743688, 'auroc': 0.8398564, 'binary_precision': 0.31730127, 'binary_recall': 0.6274769, 'binary_specificity': 0.8905078, 'binary_f1_score': 0.42147294}
confusion matrix:
      0     1
0  8312  1022
1   282   475
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 17:42:51.789467,epoch time: 0:36:01.309034,used: 1:13:18.786533,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_29_32_seed_1_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9738551, 'precision': 0.974199, 'recall': 0.9738669, 'specificity': 0.9738669, 'f1': 0.9738507, 'auroc': 0.99586844, 'binary_precision': 0.9871883, 'binary_recall': 0.960217, 'binary_specificity': 0.98751676, 'binary_f1_score': 0.9735158}
confusion matrix:
       0      1
0  25077    317
1   1012  24426
---- Validation: 
scalar performance:
{'acc': 0.9159026, 'precision': 0.57576877, 'recall': 0.7466599, 'specificity': 0.7466599, 'f1': 0.604663, 'auroc': 0.84625036, 'binary_precision': 0.1634423, 'binary_recall': 0.5684455, 'binary_specificity': 0.9248742, 'binary_f1_score': 0.253886}
confusion matrix:
       0     1
0  15438  1254
1    186   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.894064, 'precision': 0.67252463, 'recall': 0.7727946, 'specificity': 0.7727946, 'f1': 0.706354, 'auroc': 0.8596269, 'binary_precision': 0.37677726, 'binary_recall': 0.6301189, 'binary_specificity': 0.9154703, 'binary_f1_score': 0.4715769}
confusion matrix:
      0    1
0  8545  789
1   280  477
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 18:18:59.151885,epoch time: 0:36:07.362418,used: 1:49:26.148951,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_29_32_seed_1_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97688466, 'precision': 0.97730625, 'recall': 0.97689646, 'specificity': 0.97689646, 'f1': 0.97687995, 'auroc': 0.996901, 'binary_precision': 0.99169064, 'binary_recall': 0.96186507, 'binary_specificity': 0.99192786, 'binary_f1_score': 0.97655016}
confusion matrix:
       0      1
0  25191    205
1    970  24466
---- Validation: 
scalar performance:
{'acc': 0.91198975, 'precision': 0.57249725, 'recall': 0.74578303, 'specificity': 0.74578303, 'f1': 0.59969497, 'auroc': 0.8557425, 'binary_precision': 0.15688775, 'binary_recall': 0.5707657, 'binary_specificity': 0.9208004, 'binary_f1_score': 0.24612306}
confusion matrix:
       0     1
0  15370  1322
1    185   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90228915, 'precision': 0.68244654, 'recall': 0.7620674, 'specificity': 0.7620674, 'f1': 0.7122017, 'auroc': 0.86376643, 'binary_precision': 0.39894086, 'binary_recall': 0.5970938, 'binary_specificity': 0.92704093, 'binary_f1_score': 0.4783069}
confusion matrix:
      0    1
0  8653  681
1   305  452
new oracle model saved
early stop counter: 1
val acc:0.9119897484779358, best validation acc: 0.9159026145935059, corresponding to test acc:                         0.8940640091896057 / 0.9022891521453857
after epoch: 4,now: 2024-08-10 18:55:12.438182,epoch time: 0:36:13.286297,used: 2:25:39.435248,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_29_32_seed_1_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9796388, 'precision': 0.9797531, 'recall': 0.9796444, 'specificity': 0.9796444, 'f1': 0.9796378, 'auroc': 0.99723864, 'binary_precision': 0.9873367, 'binary_recall': 0.97177005, 'binary_specificity': 0.9875187, 'binary_f1_score': 0.9794916}
confusion matrix:
       0      1
0  25081    317
1    718  24716
---- Validation: 
scalar performance:
{'acc': 0.8815628, 'precision': 0.5620896, 'recall': 0.7810329, 'specificity': 0.7810329, 'f1': 0.57944214, 'auroc': 0.8713116, 'binary_precision': 0.1335475, 'binary_recall': 0.675174, 'binary_specificity': 0.8868919, 'binary_f1_score': 0.2229885}
confusion matrix:
       0     1
0  14804  1888
1    140   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88762265, 'precision': 0.6678752, 'recall': 0.78752077, 'specificity': 0.78752077, 'f1': 0.7045929, 'auroc': 0.8730452, 'binary_precision': 0.36448598, 'binary_recall': 0.669749, 'binary_specificity': 0.90529245, 'binary_f1_score': 0.47206706}
confusion matrix:
      0    1
0  8450  884
1   250  507
early stop counter: 2
val acc:0.8815628290176392, best validation acc: 0.9159026145935059, corresponding to test acc:                         0.8940640091896057 / 0.9022891521453857
after epoch: 5,now: 2024-08-10 19:31:08.821826,epoch time: 0:35:56.383644,used: 3:01:35.818892,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_29_32_seed_1_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98154706, 'precision': 0.9816635, 'recall': 0.98155266, 'specificity': 0.98155266, 'f1': 0.98154604, 'auroc': 0.9976932, 'binary_precision': 0.9893328, 'binary_recall': 0.973618, 'binary_specificity': 0.98948735, 'binary_f1_score': 0.9814125}
confusion matrix:
       0      1
0  25131    267
1    671  24763
---- Validation: 
scalar performance:
{'acc': 0.8806284, 'precision': 0.5609957, 'recall': 0.77716327, 'specificity': 0.77716327, 'f1': 0.57760847, 'auroc': 0.86480355, 'binary_precision': 0.13156693, 'binary_recall': 0.6682135, 'binary_specificity': 0.8861131, 'binary_f1_score': 0.21984732}
confusion matrix:
       0     1
0  14791  1901
1    143   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8894064, 'precision': 0.66999495, 'recall': 0.7872711, 'specificity': 0.7872711, 'f1': 0.7066314, 'auroc': 0.87720644, 'binary_precision': 0.3688824, 'binary_recall': 0.667107, 'binary_specificity': 0.9074352, 'binary_f1_score': 0.47507054}
confusion matrix:
      0    1
0  8470  864
1   252  505
early stop counter: 3
val acc:0.8806284070014954, best validation acc: 0.9159026145935059, corresponding to test acc:                         0.8940640091896057 / 0.9022891521453857
after epoch: 6,now: 2024-08-10 20:07:13.434058,epoch time: 0:36:04.612232,used: 3:37:40.431124,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_16_29_32_seed_1_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 3:37:40.431124 at 2024-08-10 20:07:13.434058
persisted model performance metric: 

scalar performance:
{'acc': 0.894064, 'precision': 0.67252463, 'recall': 0.7727946, 'specificity': 0.7727946, 'f1': 0.706354, 'auroc': 0.8596269, 'binary_precision': 0.37677726, 'binary_recall': 0.6301189, 'binary_specificity': 0.9154703, 'binary_f1_score': 0.4715769}
confusion matrix:
      0    1
0  8545  789
1   280  477
oracle model performance metric: 

scalar performance:
{'acc': 0.90228915, 'precision': 0.68244654, 'recall': 0.7620674, 'specificity': 0.7620674, 'f1': 0.7122017, 'auroc': 0.86376643, 'binary_precision': 0.39894086, 'binary_recall': 0.5970938, 'binary_specificity': 0.92704093, 'binary_f1_score': 0.4783069}
confusion matrix:
      0    1
0  8653  681
1   305  452
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 762584 KiB |   5632 MiB |    898 TiB |    898 TiB |
|       from large pool | 718598 KiB |   5589 MiB |    890 TiB |    890 TiB |
|       from small pool |  43986 KiB |     83 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 762584 KiB |   5632 MiB |    898 TiB |    898 TiB |
|       from large pool | 718598 KiB |   5589 MiB |    890 TiB |    890 TiB |
|       from small pool |  43986 KiB |     83 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 760016 KiB |   5628 MiB |    897 TiB |    897 TiB |
|       from large pool | 717638 KiB |   5586 MiB |    889 TiB |    889 TiB |
|       from small pool |  42378 KiB |     81 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5928 MiB |   5966 MiB |  10770 MiB |   4842 MiB |
|       from large pool |   5844 MiB |   5878 MiB |  10654 MiB |   4810 MiB |
|       from small pool |     84 MiB |     88 MiB |    116 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 511271 KiB |    875 MiB | 623819 GiB | 623819 GiB |
|       from large pool | 495866 KiB |    874 MiB | 614748 GiB | 614747 GiB |
|       from small pool |  15405 KiB |     34 MiB |   9071 GiB |   9071 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5048    |    7465    |  118553 K  |  118548 K  |
|       from large pool |     166    |     448    |   68720 K  |   68720 K  |
|       from small pool |    4882    |    7298    |   49832 K  |   49828 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5048    |    7465    |  118553 K  |  118548 K  |
|       from large pool |     166    |     448    |   68720 K  |   68720 K  |
|       from small pool |    4882    |    7298    |   49832 K  |   49828 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     153    |     174    |     271    |     118    |
|       from large pool |     111    |     130    |     213    |     102    |
|       from small pool |      42    |      44    |      58    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3220    |   65032 K  |   65032 K  |
|       from large pool |      33    |     131    |   42397 K  |   42397 K  |
|       from small pool |      40    |    3187    |   22634 K  |   22634 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5632 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |   5589 MiB |    890 TiB |    890 TiB |
|       from small pool |      0 KiB |     83 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5632 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |   5589 MiB |    890 TiB |    890 TiB |
|       from small pool |      0 KiB |     83 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5628 MiB |    897 TiB |    897 TiB |
|       from large pool |  16640 KiB |   5586 MiB |    889 TiB |    889 TiB |
|       from small pool |      0 KiB |     81 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1244 MiB |   5966 MiB |  10770 MiB |   9526 MiB |
|       from large pool |   1186 MiB |   5878 MiB |  10654 MiB |   9468 MiB |
|       from small pool |     58 MiB |     88 MiB |    116 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    875 MiB | 623820 GiB | 623820 GiB |
|       from large pool | 204544 KiB |    874 MiB | 614748 GiB | 614748 GiB |
|       from small pool |      0 KiB |     38 MiB |   9071 GiB |   9071 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7465    |  118553 K  |  118553 K  |
|       from large pool |       2    |     448    |   68720 K  |   68720 K  |
|       from small pool |       0    |    7298    |   49832 K  |   49832 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7465    |  118553 K  |  118553 K  |
|       from large pool |       2    |     448    |   68720 K  |   68720 K  |
|       from small pool |       0    |    7298    |   49832 K  |   49832 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     174    |     271    |     212    |
|       from large pool |      30    |     130    |     213    |     183    |
|       from small pool |      29    |      44    |      58    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3220    |   65034 K  |   65034 K  |
|       from large pool |       3    |     131    |   42397 K  |   42397 K  |
|       from small pool |       0    |    3187    |   22636 K  |   22636 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5632 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |   5589 MiB |    890 TiB |    890 TiB |
|       from small pool |      0 KiB |     83 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5632 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |   5589 MiB |    890 TiB |    890 TiB |
|       from small pool |      0 KiB |     83 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5628 MiB |    897 TiB |    897 TiB |
|       from large pool |  16640 KiB |   5586 MiB |    889 TiB |    889 TiB |
|       from small pool |      0 KiB |     81 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1244 MiB |   5966 MiB |  10770 MiB |   9526 MiB |
|       from large pool |   1186 MiB |   5878 MiB |  10654 MiB |   9468 MiB |
|       from small pool |     58 MiB |     88 MiB |    116 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    875 MiB | 623820 GiB | 623820 GiB |
|       from large pool | 204544 KiB |    874 MiB | 614748 GiB | 614748 GiB |
|       from small pool |      0 KiB |     38 MiB |   9071 GiB |   9071 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7465    |  118553 K  |  118553 K  |
|       from large pool |       2    |     448    |   68720 K  |   68720 K  |
|       from small pool |       0    |    7298    |   49832 K  |   49832 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7465    |  118553 K  |  118553 K  |
|       from large pool |       2    |     448    |   68720 K  |   68720 K  |
|       from small pool |       0    |    7298    |   49832 K  |   49832 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     174    |     271    |     212    |
|       from large pool |      30    |     130    |     213    |     183    |
|       from small pool |      29    |      44    |      58    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3220    |   65034 K  |   65034 K  |
|       from large pool |       3    |     131    |   42397 K  |   42397 K  |
|       from small pool |       0    |    3187    |   22636 K  |   22636 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_17_17_seed_2_24141968

 Experiment start at: 2024-08-10 20:17:18.284525
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.08254062384366989
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9577724, 'precision': 0.95821226, 'recall': 0.9577778, 'specificity': 0.9577778, 'f1': 0.9577626, 'auroc': 0.98997545, 'binary_precision': 0.9724972, 'binary_recall': 0.9422207, 'binary_specificity': 0.9733349, 'binary_f1_score': 0.9571196}
confusion matrix:
       0      1
0  25150    689
1   1494  24363
---- Validation: 
scalar performance:
{'acc': 0.9449895, 'precision': 0.5962895, 'recall': 0.70007193, 'specificity': 0.70007193, 'f1': 0.62670565, 'auroc': 0.84490985, 'binary_precision': 0.20693512, 'binary_recall': 0.44258374, 'binary_specificity': 0.9575602, 'binary_f1_score': 0.2820122}
confusion matrix:
       0    1
0  15997  709
1    233  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8802021, 'precision': 0.66920966, 'recall': 0.8001784, 'specificity': 0.8001784, 'f1': 0.7070279, 'auroc': 0.8759953, 'binary_precision': 0.3658854, 'binary_recall': 0.7051443, 'binary_specificity': 0.8952125, 'binary_f1_score': 0.48178312}
confusion matrix:
      0    1
0  8321  974
1   235  562
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 20:55:09.238684,epoch time: 0:37:50.954159,used: 0:37:50.954159,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_17_17_seed_2_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9710229, 'precision': 0.9712237, 'recall': 0.9710249, 'specificity': 0.9710249, 'f1': 0.9710199, 'auroc': 0.9949931, 'binary_precision': 0.9810009, 'binary_recall': 0.9606622, 'binary_specificity': 0.9813876, 'binary_f1_score': 0.97072506}
confusion matrix:
       0      1
0  25362    481
1   1017  24836
---- Validation: 
scalar performance:
{'acc': 0.93897456, 'precision': 0.59125215, 'recall': 0.71681535, 'specificity': 0.71681535, 'f1': 0.6234761, 'auroc': 0.849903, 'binary_precision': 0.19592628, 'binary_recall': 0.4832536, 'binary_specificity': 0.9503771, 'binary_f1_score': 0.27881297}
confusion matrix:
       0    1
0  15877  829
1    216  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89348, 'precision': 0.6837205, 'recall': 0.79304755, 'specificity': 0.79304755, 'f1': 0.7200805, 'auroc': 0.877704, 'binary_precision': 0.39718935, 'binary_recall': 0.6737767, 'binary_specificity': 0.91231847, 'binary_f1_score': 0.49976736}
confusion matrix:
      0    1
0  8480  815
1   260  537
new oracle model saved
early stop counter: 1
val acc:0.9389745593070984, best validation acc: 0.9449895024299622, corresponding to test acc:                         0.8802021145820618 / 0.8934800028800964
after epoch: 2,now: 2024-08-10 21:32:20.646120,epoch time: 0:37:11.407436,used: 1:15:02.361595,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_17_17_seed_2_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9757428, 'precision': 0.9760599, 'recall': 0.9757458, 'specificity': 0.9757458, 'f1': 0.9757389, 'auroc': 0.99635446, 'binary_precision': 0.98840535, 'binary_recall': 0.9627911, 'binary_specificity': 0.98870057, 'binary_f1_score': 0.9754301}
confusion matrix:
       0      1
0  25550    292
1    962  24892
---- Validation: 
scalar performance:
{'acc': 0.95129645, 'precision': 0.61055386, 'recall': 0.7033043, 'specificity': 0.7033043, 'f1': 0.64103496, 'auroc': 0.8613128, 'binary_precision': 0.23536895, 'binary_recall': 0.44258374, 'binary_specificity': 0.9640249, 'binary_f1_score': 0.30730897}
confusion matrix:
       0    1
0  16105  601
1    233  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9079469, 'precision': 0.7029137, 'recall': 0.77222323, 'specificity': 0.77222323, 'f1': 0.73050284, 'auroc': 0.87677634, 'binary_precision': 0.4403255, 'binary_recall': 0.6110414, 'binary_specificity': 0.93340504, 'binary_f1_score': 0.5118235}
confusion matrix:
      0    1
0  8676  619
1   310  487
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 22:09:46.033372,epoch time: 0:37:25.387252,used: 1:52:27.748847,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_17_17_seed_2_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9771549, 'precision': 0.9775338, 'recall': 0.9771582, 'specificity': 0.9771582, 'f1': 0.97715044, 'auroc': 0.99687904, 'binary_precision': 0.99104404, 'binary_recall': 0.9630231, 'binary_specificity': 0.99129325, 'binary_f1_score': 0.9768326}
confusion matrix:
       0      1
0  25617    225
1    956  24898
---- Validation: 
scalar performance:
{'acc': 0.9531652, 'precision': 0.61294603, 'recall': 0.6960983, 'specificity': 0.6960983, 'f1': 0.6415948, 'auroc': 0.8681097, 'binary_precision': 0.24054053, 'binary_recall': 0.4258373, 'binary_specificity': 0.9663594, 'binary_f1_score': 0.3074266}
confusion matrix:
       0    1
0  16144  562
1    240  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90982956, 'precision': 0.7079819, 'recall': 0.780128, 'specificity': 0.780128, 'f1': 0.7366344, 'auroc': 0.8794271, 'binary_precision': 0.4491449, 'binary_recall': 0.62609786, 'binary_specificity': 0.93415815, 'binary_f1_score': 0.5230608}
confusion matrix:
      0    1
0  8683  612
1   298  499
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-10 22:46:38.192886,epoch time: 0:36:52.159514,used: 2:29:19.908361,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_17_17_seed_2_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97903126, 'precision': 0.9792769, 'recall': 0.97903395, 'specificity': 0.97903395, 'f1': 0.9790287, 'auroc': 0.9971889, 'binary_precision': 0.9901844, 'binary_recall': 0.9676646, 'binary_specificity': 0.99040323, 'binary_f1_score': 0.978795}
confusion matrix:
       0      1
0  25594    248
1    836  25018
---- Validation: 
scalar performance:
{'acc': 0.9425368, 'precision': 0.60564613, 'recall': 0.74896336, 'specificity': 0.74896336, 'f1': 0.643337, 'auroc': 0.88066375, 'binary_precision': 0.22309197, 'binary_recall': 0.54545456, 'binary_specificity': 0.95247215, 'binary_f1_score': 0.31666666}
confusion matrix:
       0    1
0  15912  794
1    190  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8995244, 'precision': 0.6957742, 'recall': 0.8089472, 'specificity': 0.8089472, 'f1': 0.7341095, 'auroc': 0.8826051, 'binary_precision': 0.4187266, 'binary_recall': 0.7013802, 'binary_specificity': 0.9165143, 'binary_f1_score': 0.5243902}
confusion matrix:
      0    1
0  8519  776
1   238  559
early stop counter: 1
val acc:0.9425367712974548, best validation acc: 0.9531651735305786, corresponding to test acc:                         0.9098295569419861 / 0.9098295569419861
after epoch: 5,now: 2024-08-10 23:23:28.552010,epoch time: 0:36:50.359124,used: 3:06:10.267485,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_17_17_seed_2_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9805788, 'precision': 0.98064244, 'recall': 0.98057985, 'specificity': 0.98057985, 'f1': 0.9805782, 'auroc': 0.99756384, 'binary_precision': 0.9862247, 'binary_recall': 0.9747805, 'binary_specificity': 0.98637927, 'binary_f1_score': 0.9804692}
confusion matrix:
       0      1
0  25491    352
1    652  25201
---- Validation: 
scalar performance:
{'acc': 0.9235576, 'precision': 0.5813402, 'recall': 0.7508987, 'specificity': 0.7508987, 'f1': 0.61317194, 'auroc': 0.87425363, 'binary_precision': 0.17410387, 'binary_recall': 0.569378, 'binary_specificity': 0.9324195, 'binary_f1_score': 0.26666665}
confusion matrix:
       0     1
0  15577  1129
1    180   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951645, 'precision': 0.6884088, 'recall': 0.80371255, 'specificity': 0.80371255, 'f1': 0.72641146, 'auroc': 0.878822, 'binary_precision': 0.40467495, 'binary_recall': 0.6951066, 'binary_specificity': 0.91231847, 'binary_f1_score': 0.511542}
confusion matrix:
      0    1
0  8480  815
1   243  554
early stop counter: 2
val acc:0.9235575795173645, best validation acc: 0.9531651735305786, corresponding to test acc:                         0.9098295569419861 / 0.9098295569419861
after epoch: 6,now: 2024-08-11 00:00:04.713691,epoch time: 0:36:36.161681,used: 3:42:46.429166,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_17_17_seed_2_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98172003, 'precision': 0.9818894, 'recall': 0.9817219, 'specificity': 0.9817219, 'f1': 0.98171854, 'auroc': 0.9978075, 'binary_precision': 0.99097216, 'binary_recall': 0.97230494, 'binary_specificity': 0.9911388, 'binary_f1_score': 0.9815498}
confusion matrix:
       0      1
0  25614    229
1    716  25137
---- Validation: 
scalar performance:
{'acc': 0.92431676, 'precision': 0.5861603, 'recall': 0.7687815, 'specificity': 0.7687815, 'f1': 0.6204279, 'auroc': 0.8791939, 'binary_precision': 0.18280347, 'binary_recall': 0.6052632, 'binary_specificity': 0.9322998, 'binary_f1_score': 0.28079912}
confusion matrix:
       0     1
0  15575  1131
1    165   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89209276, 'precision': 0.68490326, 'recall': 0.8066335, 'specificity': 0.8066335, 'f1': 0.7236551, 'auroc': 0.8797208, 'binary_precision': 0.39689267, 'binary_recall': 0.7051443, 'binary_specificity': 0.90812266, 'binary_f1_score': 0.50790787}
confusion matrix:
      0    1
0  8441  854
1   235  562
early stop counter: 3
val acc:0.9243167638778687, best validation acc: 0.9531651735305786, corresponding to test acc:                         0.9098295569419861 / 0.9098295569419861
after epoch: 7,now: 2024-08-11 00:37:07.619483,epoch time: 0:37:02.905792,used: 4:19:49.334958,model: dset_te_center4_diva_b8efecac6_not_commited_2024md_08md_10_20_17_17_seed_2_24141968
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 4:19:49.334958 at 2024-08-11 00:37:07.619483
persisted model performance metric: 

scalar performance:
{'acc': 0.90982956, 'precision': 0.7079819, 'recall': 0.780128, 'specificity': 0.780128, 'f1': 0.7366344, 'auroc': 0.8794271, 'binary_precision': 0.4491449, 'binary_recall': 0.62609786, 'binary_specificity': 0.93415815, 'binary_f1_score': 0.5230608}
confusion matrix:
      0    1
0  8683  612
1   298  499
oracle model performance metric: 

scalar performance:
{'acc': 0.90982956, 'precision': 0.7079819, 'recall': 0.780128, 'specificity': 0.780128, 'f1': 0.7366344, 'auroc': 0.8794271, 'binary_precision': 0.4491449, 'binary_recall': 0.62609786, 'binary_specificity': 0.93415815, 'binary_f1_score': 0.5230608}
confusion matrix:
      0    1
0  8683  612
1   298  499
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-10_12-05-04/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 762584 KiB |   5632 MiB |   1479 TiB |   1479 TiB |
|       from large pool | 718598 KiB |   5590 MiB |   1465 TiB |   1465 TiB |
|       from small pool |  43986 KiB |     83 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 762584 KiB |   5632 MiB |   1479 TiB |   1479 TiB |
|       from large pool | 718598 KiB |   5590 MiB |   1465 TiB |   1465 TiB |
|       from small pool |  43986 KiB |     83 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 760016 KiB |   5628 MiB |   1478 TiB |   1478 TiB |
|       from large pool | 717638 KiB |   5586 MiB |   1463 TiB |   1463 TiB |
|       from small pool |  42378 KiB |     81 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5936 MiB |   5966 MiB |  15462 MiB |   9526 MiB |
|       from large pool |   5852 MiB |   5878 MiB |  15320 MiB |   9468 MiB |
|       from small pool |     84 MiB |     88 MiB |    142 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 408871 KiB |    883 MiB |   1026 TiB |   1026 TiB |
|       from large pool | 397562 KiB |    882 MiB |   1011 TiB |   1011 TiB |
|       from small pool |  11309 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    5048    |    7573    |  194935 K  |  194930 K  |
|       from large pool |     166    |     448    |  113079 K  |  113079 K  |
|       from small pool |    4882    |    7406    |   81855 K  |   81850 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5048    |    7573    |  194935 K  |  194930 K  |
|       from large pool |     166    |     448    |  113079 K  |  113079 K  |
|       from small pool |    4882    |    7406    |   81855 K  |   81850 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     151    |     174    |     363    |     212    |
|       from large pool |     109    |     130    |     292    |     183    |
|       from small pool |      42    |      44    |      71    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3272    |  108071 K  |  108071 K  |
|       from large pool |      32    |     131    |   69706 K  |   69706 K  |
|       from small pool |      40    |    3240    |   38364 K  |   38364 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5632 MiB |   1479 TiB |   1479 TiB |
|       from large pool |  16640 KiB |   5590 MiB |   1465 TiB |   1465 TiB |
|       from small pool |      0 KiB |     83 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5632 MiB |   1479 TiB |   1479 TiB |
|       from large pool |  16640 KiB |   5590 MiB |   1465 TiB |   1465 TiB |
|       from small pool |      0 KiB |     83 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5628 MiB |   1478 TiB |   1478 TiB |
|       from large pool |  16640 KiB |   5586 MiB |   1463 TiB |   1463 TiB |
|       from small pool |      0 KiB |     81 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1144 MiB |   5966 MiB |  15462 MiB |  14318 MiB |
|       from large pool |   1090 MiB |   5878 MiB |  15320 MiB |  14230 MiB |
|       from small pool |     54 MiB |     88 MiB |    142 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204544 KiB |    883 MiB |   1026 TiB |   1026 TiB |
|       from large pool | 204544 KiB |    882 MiB |   1011 TiB |   1011 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7573    |  194935 K  |  194935 K  |
|       from large pool |       2    |     448    |  113079 K  |  113079 K  |
|       from small pool |       0    |    7406    |   81855 K  |   81855 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7573    |  194935 K  |  194935 K  |
|       from large pool |       2    |     448    |  113079 K  |  113079 K  |
|       from small pool |       0    |    7406    |   81855 K  |   81855 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     174    |     363    |     307    |
|       from large pool |      29    |     130    |     292    |     263    |
|       from small pool |      27    |      44    |      71    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3272    |  108073 K  |  108073 K  |
|       from large pool |       3    |     131    |   69706 K  |   69706 K  |
|       from small pool |       0    |    3240    |   38366 K  |   38366 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 00:39:24 2024]
Finished job 0.
1 of 1 steps (100%) done
