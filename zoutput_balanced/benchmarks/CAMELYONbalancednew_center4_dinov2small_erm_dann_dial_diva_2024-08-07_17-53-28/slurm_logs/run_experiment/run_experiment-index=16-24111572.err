Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  8 05:45:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/16.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=16
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_05_55_00_seed_0_24111572

 Experiment start at: 2024-08-08 05:55:01.125586
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.28613802790641785
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93315697, 'precision': 0.9375434, 'recall': 0.9331847, 'specificity': 0.9331847, 'f1': 0.93299186, 'auroc': 0.9755626, 'binary_precision': 0.9814912, 'binary_recall': 0.88304, 'binary_specificity': 0.98332936, 'binary_f1_score': 0.92966634}
confusion matrix:
       0      1
0  24892    422
1   2964  22378
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9476263, 'precision': 0.52019495, 'recall': 0.5266884, 'specificity': 0.5266884, 'f1': 0.52268326, 'auroc': 0.64560026, 'binary_precision': 0.06329114, 'binary_recall': 0.084337346, 'binary_specificity': 0.9690395, 'binary_f1_score': 0.072314054}
confusion matrix:
       0    1
0  16213  518
1    380   35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8937117, 'precision': 0.55422294, 'recall': 0.53428537, 'specificity': 0.53428537, 'f1': 0.53995824, 'auroc': 0.7877514, 'binary_precision': 0.17970401, 'binary_recall': 0.11010363, 'binary_specificity': 0.9584671, 'binary_f1_score': 0.13654618}
confusion matrix:
      0    1
0  8954  388
1   687   85
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 06:25:25.332497,epoch time: 0:30:24.206911,used: 0:30:24.206911,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_05_55_00_seed_0_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9518517, 'precision': 0.9540833, 'recall': 0.95186836, 'specificity': 0.95186836, 'f1': 0.9517938, 'auroc': 0.9852398, 'binary_precision': 0.98603505, 'binary_recall': 0.91673243, 'binary_specificity': 0.9870043, 'binary_f1_score': 0.9501217}
confusion matrix:
       0      1
0  24987    329
1   2110  23230
---- Validation: 
scalar performance:
{'acc': 0.96296513, 'precision': 0.5912178, 'recall': 0.5815455, 'specificity': 0.5815455, 'f1': 0.58606577, 'auroc': 0.7396843, 'binary_precision': 0.2027027, 'binary_recall': 0.18072289, 'binary_specificity': 0.98236805, 'binary_f1_score': 0.1910828}
confusion matrix:
       0    1
0  16436  295
1    340   75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9122998, 'precision': 0.6533279, 'recall': 0.5906909, 'specificity': 0.5906909, 'f1': 0.6110539, 'auroc': 0.8396915, 'binary_precision': 0.3696145, 'binary_recall': 0.2111399, 'binary_specificity': 0.9702419, 'binary_f1_score': 0.26875517}
confusion matrix:
      0    1
0  9064  278
1   609  163
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 06:54:52.030006,epoch time: 0:29:26.697509,used: 0:59:50.904420,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_05_55_00_seed_0_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9609523, 'precision': 0.9620662, 'recall': 0.96096593, 'specificity': 0.96096593, 'f1': 0.9609296, 'auroc': 0.9892106, 'binary_precision': 0.98489124, 'binary_recall': 0.93631124, 'binary_specificity': 0.9856206, 'binary_f1_score': 0.95998704}
confusion matrix:
       0      1
0  24950    364
1   1614  23728
---- Validation: 
scalar performance:
{'acc': 0.947218, 'precision': 0.58206886, 'recall': 0.64867246, 'specificity': 0.64867246, 'f1': 0.6038309, 'auroc': 0.7761996, 'binary_precision': 0.18098958, 'binary_recall': 0.33493975, 'binary_specificity': 0.96240515, 'binary_f1_score': 0.23499575}
confusion matrix:
       0    1
0  16102  629
1    276  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90261024, 'precision': 0.6615874, 'recall': 0.6739736, 'specificity': 0.6739736, 'f1': 0.66745776, 'auroc': 0.85616636, 'binary_precision': 0.37275985, 'binary_recall': 0.4041451, 'binary_specificity': 0.9438022, 'binary_f1_score': 0.38781855}
confusion matrix:
      0    1
0  8817  525
1   460  312
early stop counter: 1
val acc:0.9472180008888245, best validation acc: 0.9629651308059692, corresponding to test acc:                         0.9122998118400574 / 0.9122998118400574
after epoch: 3,now: 2024-08-08 07:24:29.299011,epoch time: 0:29:37.269005,used: 1:29:28.173425,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_05_55_00_seed_0_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9677432, 'precision': 0.96808064, 'recall': 0.96775234, 'specificity': 0.96775234, 'f1': 0.9677378, 'auroc': 0.9924792, 'binary_precision': 0.9808168, 'binary_recall': 0.95419216, 'binary_specificity': 0.98131245, 'binary_f1_score': 0.9673213}
confusion matrix:
       0      1
0  24838    473
1   1161  24184
---- Validation: 
scalar performance:
{'acc': 0.93677825, 'precision': 0.5718764, 'recall': 0.66447186, 'specificity': 0.66447186, 'f1': 0.59582615, 'auroc': 0.78743947, 'binary_precision': 0.15971516, 'binary_recall': 0.37831324, 'binary_specificity': 0.95063055, 'binary_f1_score': 0.22460657}
confusion matrix:
       0    1
0  15905  826
1    258  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9033024, 'precision': 0.6709369, 'recall': 0.69930243, 'specificity': 0.69930243, 'f1': 0.68359184, 'auroc': 0.863243, 'binary_precision': 0.38730854, 'binary_recall': 0.45854923, 'binary_specificity': 0.94005567, 'binary_f1_score': 0.41992882}
confusion matrix:
      0    1
0  8782  560
1   418  354
early stop counter: 2
val acc:0.9367782473564148, best validation acc: 0.9629651308059692, corresponding to test acc:                         0.9122998118400574 / 0.9122998118400574
after epoch: 4,now: 2024-08-08 07:53:24.495912,epoch time: 0:28:55.196901,used: 1:58:23.370326,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_05_55_00_seed_0_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9700726, 'precision': 0.97057915, 'recall': 0.9700824, 'specificity': 0.9700824, 'f1': 0.970065, 'auroc': 0.9934027, 'binary_precision': 0.98616606, 'binary_recall': 0.9535572, 'binary_specificity': 0.9866077, 'binary_f1_score': 0.9695875}
confusion matrix:
       0      1
0  24974    339
1   1177  24166
---- Validation: 
scalar performance:
{'acc': 0.93654495, 'precision': 0.5737783, 'recall': 0.671402, 'specificity': 0.671402, 'f1': 0.5987298, 'auroc': 0.79902303, 'binary_precision': 0.16316317, 'binary_recall': 0.3927711, 'binary_specificity': 0.9500329, 'binary_f1_score': 0.23055163}
confusion matrix:
       0    1
0  15895  836
1    252  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90498316, 'precision': 0.6795939, 'recall': 0.71863085, 'specificity': 0.71863085, 'f1': 0.6964376, 'auroc': 0.8700962, 'binary_precision': 0.40145984, 'binary_recall': 0.49870467, 'binary_specificity': 0.938557, 'binary_f1_score': 0.44482958}
confusion matrix:
      0    1
0  8768  574
1   387  385
early stop counter: 3
val acc:0.9365449547767639, best validation acc: 0.9629651308059692, corresponding to test acc:                         0.9122998118400574 / 0.9122998118400574
after epoch: 5,now: 2024-08-08 08:22:46.389503,epoch time: 0:29:21.893591,used: 2:27:45.263917,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_05_55_00_seed_0_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:27:45.263917 at 2024-08-08 08:22:46.389503
persisted model performance metric: 

scalar performance:
{'acc': 0.9122998, 'precision': 0.6533279, 'recall': 0.5906909, 'specificity': 0.5906909, 'f1': 0.6110539, 'auroc': 0.8396915, 'binary_precision': 0.3696145, 'binary_recall': 0.2111399, 'binary_specificity': 0.9702419, 'binary_f1_score': 0.26875517}
confusion matrix:
      0    1
0  9064  278
1   609  163
oracle model performance metric: 

scalar performance:
{'acc': 0.9122998, 'precision': 0.6533279, 'recall': 0.5906909, 'specificity': 0.5906909, 'f1': 0.6110539, 'auroc': 0.8396915, 'binary_precision': 0.3696145, 'binary_recall': 0.2111399, 'binary_specificity': 0.9702419, 'binary_f1_score': 0.26875517}
confusion matrix:
      0    1
0  9064  278
1   609  163
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/16.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198886 KiB |   2142 MiB | 251370 GiB | 251370 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 248178 GiB | 248178 GiB |
|       from small pool |  18224 KiB |     38 MiB |   3191 GiB |   3191 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198886 KiB |   2142 MiB | 251370 GiB | 251370 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 248178 GiB | 248178 GiB |
|       from small pool |  18224 KiB |     38 MiB |   3191 GiB |   3191 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   2141 MiB | 251346 GiB | 251346 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 248159 GiB | 248159 GiB |
|       from small pool |  16663 KiB |     36 MiB |   3186 GiB |   3186 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2372 MiB |   2372 MiB |   2372 MiB |      0 B   |
|       from large pool |   2330 MiB |   2330 MiB |   2330 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  63258 KiB | 225565 KiB | 136364 GiB | 136364 GiB |
|       from large pool |  50762 KiB | 224940 KiB | 133152 GiB | 133152 GiB |
|       from small pool |  12496 KiB |  12998 KiB |   3212 GiB |   3212 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4444    |    6827    |   38387 K  |   38382 K  |
|       from large pool |      79    |     252    |   22954 K  |   22954 K  |
|       from small pool |    4365    |    6747    |   15432 K  |   15428 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4444    |    6827    |   38387 K  |   38382 K  |
|       from large pool |      79    |     252    |   22954 K  |   22954 K  |
|       from small pool |    4365    |    6747    |   15432 K  |   15428 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     118    |     118    |     118    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    3182    |   24594 K  |   24594 K  |
|       from large pool |      10    |      97    |   17900 K  |   17900 K  |
|       from small pool |      30    |    3172    |    6693 K  |    6693 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 251370 GiB | 251370 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 248178 GiB | 248178 GiB |
|       from small pool |      0 KiB |     38 MiB |   3191 GiB |   3191 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 251370 GiB | 251370 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 248178 GiB | 248178 GiB |
|       from small pool |      0 KiB |     38 MiB |   3191 GiB |   3191 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 251346 GiB | 251346 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 248159 GiB | 248159 GiB |
|       from small pool |      0 KiB |     36 MiB |   3186 GiB |   3186 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   2372 MiB |   2372 MiB |   2116 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 136364 GiB | 136364 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 133152 GiB | 133152 GiB |
|       from small pool |      0 KiB |  26061 KiB |   3212 GiB |   3212 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   38387 K  |   38387 K  |
|       from large pool |       2    |     252    |   22954 K  |   22954 K  |
|       from small pool |       0    |    6747    |   15432 K  |   15432 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   38387 K  |   38387 K  |
|       from large pool |       2    |     252    |   22954 K  |   22954 K  |
|       from small pool |       0    |    6747    |   15432 K  |   15432 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |     118    |     118    |      92    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   24596 K  |   24596 K  |
|       from large pool |       3    |      97    |   17900 K  |   17900 K  |
|       from small pool |       0    |    3172    |    6695 K  |    6695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 251370 GiB | 251370 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 248178 GiB | 248178 GiB |
|       from small pool |      0 KiB |     38 MiB |   3191 GiB |   3191 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 251370 GiB | 251370 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 248178 GiB | 248178 GiB |
|       from small pool |      0 KiB |     38 MiB |   3191 GiB |   3191 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 251346 GiB | 251346 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 248159 GiB | 248159 GiB |
|       from small pool |      0 KiB |     36 MiB |   3186 GiB |   3186 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   2372 MiB |   2372 MiB |   2116 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 136364 GiB | 136364 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 133152 GiB | 133152 GiB |
|       from small pool |      0 KiB |  26061 KiB |   3212 GiB |   3212 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   38387 K  |   38387 K  |
|       from large pool |       2    |     252    |   22954 K  |   22954 K  |
|       from small pool |       0    |    6747    |   15432 K  |   15432 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   38387 K  |   38387 K  |
|       from large pool |       2    |     252    |   22954 K  |   22954 K  |
|       from small pool |       0    |    6747    |   15432 K  |   15432 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |     118    |     118    |      92    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   24596 K  |   24596 K  |
|       from large pool |       3    |      97    |   17900 K  |   17900 K  |
|       from small pool |       0    |    3172    |    6695 K  |    6695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_08_47_22_seed_1_24111572

 Experiment start at: 2024-08-08 08:47:22.909451
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6057873368263245
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9338409, 'precision': 0.93779296, 'recall': 0.9338765, 'specificity': 0.9338765, 'f1': 0.93369496, 'auroc': 0.97962046, 'binary_precision': 0.9795759, 'binary_recall': 0.8862591, 'binary_specificity': 0.9814939, 'binary_f1_score': 0.9305839}
confusion matrix:
       0      1
0  24927    470
1   2893  22542
---- Validation: 
scalar performance:
{'acc': 0.9404894, 'precision': 0.5558048, 'recall': 0.6010513, 'specificity': 0.6010513, 'f1': 0.57000387, 'auroc': 0.8323889, 'binary_precision': 0.13157895, 'binary_recall': 0.24361949, 'binary_specificity': 0.9584831, 'binary_f1_score': 0.17087063}
confusion matrix:
       0    1
0  15999  693
1    326  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8899019, 'precision': 0.5991296, 'recall': 0.5963546, 'specificity': 0.5963546, 'f1': 0.5977111, 'auroc': 0.78806436, 'binary_precision': 0.25885558, 'binary_recall': 0.25099075, 'binary_specificity': 0.94171846, 'binary_f1_score': 0.25486252}
confusion matrix:
      0    1
0  8790  544
1   567  190
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 09:18:11.689221,epoch time: 0:30:48.779770,used: 0:30:48.779770,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_08_47_22_seed_1_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9541627, 'precision': 0.95526123, 'recall': 0.9541831, 'specificity': 0.9541831, 'f1': 0.9541365, 'auroc': 0.9879041, 'binary_precision': 0.977832, 'binary_recall': 0.9294728, 'binary_specificity': 0.97889346, 'binary_f1_score': 0.95303935}
confusion matrix:
       0      1
0  24859    536
1   1794  23643
---- Validation: 
scalar performance:
{'acc': 0.951352, 'precision': 0.60499436, 'recall': 0.67556125, 'specificity': 0.67556125, 'f1': 0.62989897, 'auroc': 0.8674667, 'binary_precision': 0.22615804, 'binary_recall': 0.38515082, 'binary_specificity': 0.9659717, 'binary_f1_score': 0.28497854}
confusion matrix:
       0    1
0  16124  568
1    265  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90308195, 'precision': 0.65455, 'recall': 0.6605309, 'specificity': 0.6605309, 'f1': 0.65746033, 'auroc': 0.85113454, 'binary_precision': 0.3599493, 'binary_recall': 0.37516513, 'binary_specificity': 0.94589674, 'binary_f1_score': 0.3673997}
confusion matrix:
      0    1
0  8829  505
1   473  284
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 09:47:37.199170,epoch time: 0:29:25.509949,used: 1:00:14.289719,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_08_47_22_seed_1_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.962622, 'precision': 0.9629098, 'recall': 0.9626329, 'specificity': 0.9626329, 'f1': 0.9626168, 'auroc': 0.9913497, 'binary_precision': 0.9746713, 'binary_recall': 0.94999605, 'binary_specificity': 0.97526973, 'binary_f1_score': 0.9621755}
confusion matrix:
       0      1
0  24766    628
1   1272  24166
---- Validation: 
scalar performance:
{'acc': 0.94954157, 'precision': 0.6139766, 'recall': 0.71644783, 'specificity': 0.71644783, 'f1': 0.64674205, 'auroc': 0.87566584, 'binary_precision': 0.24195471, 'binary_recall': 0.4709977, 'binary_specificity': 0.9618979, 'binary_f1_score': 0.31968504}
confusion matrix:
       0    1
0  16056  636
1    228  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89743334, 'precision': 0.6677427, 'recall': 0.7351652, 'specificity': 0.7351652, 'f1': 0.6933813, 'auroc': 0.86686414, 'binary_precision': 0.3738657, 'binary_recall': 0.54425365, 'binary_specificity': 0.9260767, 'binary_f1_score': 0.44324908}
confusion matrix:
      0    1
0  8644  690
1   345  412
early stop counter: 1
val acc:0.9495415687561035, best validation acc: 0.9513520002365112, corresponding to test acc:                         0.9030819535255432 / 0.9030819535255432
after epoch: 3,now: 2024-08-08 10:19:45.023664,epoch time: 0:32:07.824494,used: 1:32:22.114213,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_08_47_22_seed_1_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9655335, 'precision': 0.96648717, 'recall': 0.96555054, 'specificity': 0.96555054, 'f1': 0.9655168, 'auroc': 0.9928433, 'binary_precision': 0.9877662, 'binary_recall': 0.94279534, 'binary_specificity': 0.9883057, 'binary_f1_score': 0.96475697}
confusion matrix:
       0      1
0  25100    297
1   1455  23980
---- Validation: 
scalar performance:
{'acc': 0.95637447, 'precision': 0.6326251, 'recall': 0.71656203, 'specificity': 0.71656203, 'f1': 0.66308355, 'auroc': 0.88580275, 'binary_precision': 0.2793296, 'binary_recall': 0.46403712, 'binary_specificity': 0.969087, 'binary_f1_score': 0.3487358}
confusion matrix:
       0    1
0  16176  516
1    231  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8989198, 'precision': 0.6804799, 'recall': 0.77663326, 'specificity': 0.77663326, 'f1': 0.7141479, 'auroc': 0.87774456, 'binary_precision': 0.39230138, 'binary_recall': 0.6327609, 'binary_specificity': 0.9205057, 'binary_f1_score': 0.48432755}
confusion matrix:
      0    1
0  8592  742
1   278  479
better model found
persisted
after epoch: 4,now: 2024-08-08 10:50:37.817467,epoch time: 0:30:52.793803,used: 2:03:14.908016,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_08_47_22_seed_1_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9690156, 'precision': 0.96946573, 'recall': 0.969026, 'specificity': 0.969026, 'f1': 0.9690087, 'auroc': 0.9943812, 'binary_precision': 0.9841708, 'binary_recall': 0.953407, 'binary_specificity': 0.98464507, 'binary_f1_score': 0.9685447}
confusion matrix:
       0      1
0  25009    390
1   1185  24248
---- Validation: 
scalar performance:
{'acc': 0.9644338, 'precision': 0.669726, 'recall': 0.73538756, 'specificity': 0.73538756, 'f1': 0.69662845, 'auroc': 0.8860052, 'binary_precision': 0.352649, 'binary_recall': 0.49419954, 'binary_specificity': 0.9765756, 'binary_f1_score': 0.4115942}
confusion matrix:
       0    1
0  16301  391
1    218  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90912694, 'precision': 0.69489765, 'recall': 0.76272887, 'specificity': 0.76272887, 'f1': 0.72186714, 'auroc': 0.8800515, 'binary_precision': 0.42409867, 'binary_recall': 0.5904888, 'binary_specificity': 0.93496895, 'binary_f1_score': 0.49364996}
confusion matrix:
      0    1
0  8727  607
1   310  447
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-08 11:25:02.683814,epoch time: 0:34:24.866347,used: 2:37:39.774363,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_08_47_22_seed_1_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9714943, 'precision': 0.97192764, 'recall': 0.9715082, 'specificity': 0.9715082, 'f1': 0.9714884, 'auroc': 0.9950743, 'binary_precision': 0.9864547, 'binary_recall': 0.95616966, 'binary_specificity': 0.98684675, 'binary_f1_score': 0.9710762}
confusion matrix:
       0      1
0  25059    334
1   1115  24324
---- Validation: 
scalar performance:
{'acc': 0.9573089, 'precision': 0.6463211, 'recall': 0.75546604, 'specificity': 0.75546604, 'f1': 0.68410265, 'auroc': 0.8885527, 'binary_precision': 0.3046875, 'binary_recall': 0.54292345, 'binary_specificity': 0.96800864, 'binary_f1_score': 0.39032528}
confusion matrix:
       0    1
0  16158  534
1    197  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90417206, 'precision': 0.68642855, 'recall': 0.7655129, 'specificity': 0.7655129, 'f1': 0.7162658, 'auroc': 0.876024, 'binary_precision': 0.4064171, 'binary_recall': 0.60237783, 'binary_specificity': 0.92864794, 'binary_f1_score': 0.48536456}
confusion matrix:
      0    1
0  8668  666
1   301  456
early stop counter: 1
val acc:0.9573088884353638, best validation acc: 0.9644337892532349, corresponding to test acc:                         0.9091269373893738 / 0.9091269373893738
after epoch: 6,now: 2024-08-08 11:56:25.728642,epoch time: 0:31:23.044828,used: 3:09:02.819191,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_08_47_22_seed_1_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9738157, 'precision': 0.9738898, 'recall': 0.9738205, 'specificity': 0.9738205, 'f1': 0.97381485, 'auroc': 0.99562895, 'binary_precision': 0.9800064, 'binary_recall': 0.9674071, 'binary_specificity': 0.9802339, 'binary_f1_score': 0.973666}
confusion matrix:
       0      1
0  24895    502
1    829  24606
---- Validation: 
scalar performance:
{'acc': 0.95573205, 'precision': 0.6422813, 'recall': 0.7591778, 'specificity': 0.7591778, 'f1': 0.681388, 'auroc': 0.89119864, 'binary_precision': 0.29638854, 'binary_recall': 0.5522042, 'binary_specificity': 0.9661515, 'binary_f1_score': 0.38573742}
confusion matrix:
       0    1
0  16127  565
1    193  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9065504, 'precision': 0.6930723, 'recall': 0.7771164, 'specificity': 0.7771164, 'f1': 0.72462213, 'auroc': 0.88360274, 'binary_precision': 0.41784453, 'binary_recall': 0.6248349, 'binary_specificity': 0.9293979, 'binary_f1_score': 0.50079405}
confusion matrix:
      0    1
0  8675  659
1   284  473
early stop counter: 2
val acc:0.9557320475578308, best validation acc: 0.9644337892532349, corresponding to test acc:                         0.9091269373893738 / 0.9091269373893738
after epoch: 7,now: 2024-08-08 12:24:47.239557,epoch time: 0:28:21.510915,used: 3:37:24.330106,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_08_47_22_seed_1_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9745436, 'precision': 0.97492194, 'recall': 0.9745537, 'specificity': 0.9745537, 'f1': 0.9745389, 'auroc': 0.996142, 'binary_precision': 0.9885057, 'binary_recall': 0.96028936, 'binary_specificity': 0.988818, 'binary_f1_score': 0.9741933}
confusion matrix:
       0      1
0  25114    284
1   1010  24424
---- Validation: 
scalar performance:
{'acc': 0.95427203, 'precision': 0.63865227, 'recall': 0.76181936, 'specificity': 0.76181936, 'f1': 0.67864335, 'auroc': 0.8953409, 'binary_precision': 0.28896883, 'binary_recall': 0.55916476, 'binary_specificity': 0.964474, 'binary_f1_score': 0.3810277}
confusion matrix:
       0    1
0  16099  593
1    190  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9070459, 'precision': 0.68979895, 'recall': 0.7573554, 'specificity': 0.7573554, 'f1': 0.7164851, 'auroc': 0.88054436, 'binary_precision': 0.4147031, 'binary_recall': 0.5812417, 'binary_specificity': 0.93346906, 'binary_f1_score': 0.48404837}
confusion matrix:
      0    1
0  8713  621
1   317  440
early stop counter: 3
val acc:0.9542720317840576, best validation acc: 0.9644337892532349, corresponding to test acc:                         0.9091269373893738 / 0.9091269373893738
after epoch: 8,now: 2024-08-08 12:53:50.110214,epoch time: 0:29:02.870657,used: 4:06:27.200763,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_08_47_22_seed_1_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 4:06:27.200763 at 2024-08-08 12:53:50.110214
persisted model performance metric: 

scalar performance:
{'acc': 0.90912694, 'precision': 0.69489765, 'recall': 0.76272887, 'specificity': 0.76272887, 'f1': 0.72186714, 'auroc': 0.8800515, 'binary_precision': 0.42409867, 'binary_recall': 0.5904888, 'binary_specificity': 0.93496895, 'binary_f1_score': 0.49364996}
confusion matrix:
      0    1
0  8727  607
1   310  447
oracle model performance metric: 

scalar performance:
{'acc': 0.90912694, 'precision': 0.69489765, 'recall': 0.76272887, 'specificity': 0.76272887, 'f1': 0.72186714, 'auroc': 0.8800515, 'binary_precision': 0.42409867, 'binary_recall': 0.5904888, 'binary_specificity': 0.93496895, 'binary_f1_score': 0.49364996}
confusion matrix:
      0    1
0  8727  607
1   310  447
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197429 KiB |   2142 MiB | 644921 GiB | 644921 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 636815 GiB | 636814 GiB |
|       from small pool |  18218 KiB |     38 MiB |   8106 GiB |   8106 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197429 KiB |   2142 MiB | 644921 GiB | 644921 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 636815 GiB | 636814 GiB |
|       from small pool |  18218 KiB |     38 MiB |   8106 GiB |   8106 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   2141 MiB | 644843 GiB | 644843 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 636749 GiB | 636749 GiB |
|       from small pool |  16662 KiB |     36 MiB |   8094 GiB |   8094 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2354 MiB |   2372 MiB |   4470 MiB |   2116 MiB |
|       from large pool |   2316 MiB |   2330 MiB |   4420 MiB |   2104 MiB |
|       from small pool |     38 MiB |     42 MiB |     50 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42187 KiB | 231558 KiB | 355757 GiB | 355757 GiB |
|       from large pool |  31733 KiB | 230336 KiB | 347402 GiB | 347402 GiB |
|       from small pool |  10454 KiB |  26061 KiB |   8354 GiB |   8354 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4432    |    6849    |   98355 K  |   98351 K  |
|       from large pool |      79    |     252    |   58841 K  |   58841 K  |
|       from small pool |    4353    |    6769    |   39514 K  |   39509 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4432    |    6849    |   98355 K  |   98351 K  |
|       from large pool |      79    |     252    |   58841 K  |   58841 K  |
|       from small pool |    4353    |    6769    |   39514 K  |   39509 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     118    |     207    |      92    |
|       from large pool |      96    |      97    |     182    |      86    |
|       from small pool |      19    |      21    |      25    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |    3193    |   65353 K  |   65353 K  |
|       from large pool |      11    |     100    |   44715 K  |   44715 K  |
|       from small pool |      30    |    3182    |   20638 K  |   20638 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 644921 GiB | 644921 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 636815 GiB | 636815 GiB |
|       from small pool |      0 KiB |     38 MiB |   8106 GiB |   8106 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 644921 GiB | 644921 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 636815 GiB | 636815 GiB |
|       from small pool |      0 KiB |     38 MiB |   8106 GiB |   8106 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 644843 GiB | 644843 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 636749 GiB | 636749 GiB |
|       from small pool |      0 KiB |     36 MiB |   8094 GiB |   8094 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   2372 MiB |   4470 MiB |   4236 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4420 MiB |   4214 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 231558 KiB | 355757 GiB | 355757 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 347403 GiB | 347403 GiB |
|       from small pool |      0 KiB |  26061 KiB |   8354 GiB |   8354 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |   98355 K  |   98355 K  |
|       from large pool |       2    |     252    |   58841 K  |   58841 K  |
|       from small pool |       0    |    6769    |   39514 K  |   39514 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |   98355 K  |   98355 K  |
|       from large pool |       2    |     252    |   58841 K  |   58841 K  |
|       from small pool |       0    |    6769    |   39514 K  |   39514 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     118    |     207    |     183    |
|       from large pool |      10    |      97    |     182    |     172    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3193    |   65355 K  |   65355 K  |
|       from large pool |       3    |     100    |   44715 K  |   44715 K  |
|       from small pool |       0    |    3182    |   20640 K  |   20640 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 644921 GiB | 644921 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 636815 GiB | 636815 GiB |
|       from small pool |      0 KiB |     38 MiB |   8106 GiB |   8106 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 644921 GiB | 644921 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 636815 GiB | 636815 GiB |
|       from small pool |      0 KiB |     38 MiB |   8106 GiB |   8106 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 644843 GiB | 644843 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 636749 GiB | 636749 GiB |
|       from small pool |      0 KiB |     36 MiB |   8094 GiB |   8094 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   2372 MiB |   4470 MiB |   4236 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4420 MiB |   4214 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 231558 KiB | 355757 GiB | 355757 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 347403 GiB | 347403 GiB |
|       from small pool |      0 KiB |  26061 KiB |   8354 GiB |   8354 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |   98355 K  |   98355 K  |
|       from large pool |       2    |     252    |   58841 K  |   58841 K  |
|       from small pool |       0    |    6769    |   39514 K  |   39514 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |   98355 K  |   98355 K  |
|       from large pool |       2    |     252    |   58841 K  |   58841 K  |
|       from small pool |       0    |    6769    |   39514 K  |   39514 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     118    |     207    |     183    |
|       from large pool |      10    |      97    |     182    |     172    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3193    |   65355 K  |   65355 K  |
|       from large pool |       3    |     100    |   44715 K  |   44715 K  |
|       from small pool |       0    |    3182    |   20640 K  |   20640 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_13_19_51_seed_2_24111572

 Experiment start at: 2024-08-08 13:19:51.706144
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.11296075582504272
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9011722, 'precision': 0.9147657, 'recall': 0.9011862, 'specificity': 0.9011862, 'f1': 0.9003581, 'auroc': 0.9484278, 'binary_precision': 0.9898918, 'binary_recall': 0.810653, 'binary_specificity': 0.99171954, 'binary_f1_score': 0.8913511}
confusion matrix:
       0      1
0  25630    214
1   4895  20957
---- Validation: 
scalar performance:
{'acc': 0.97156036, 'precision': 0.49481568, 'recall': 0.49910113, 'specificity': 0.49910113, 'f1': 0.4948321, 'auroc': 0.48103258, 'binary_precision': 0.014084507, 'binary_recall': 0.0023923444, 'binary_specificity': 0.9958099, 'binary_f1_score': 0.0040899795}
confusion matrix:
       0   1
0  16636  70
1    417   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9198375, 'precision': 0.603658, 'recall': 0.50394297, 'specificity': 0.50394297, 'f1': 0.4888023, 'auroc': 0.5749416, 'binary_precision': 0.2857143, 'binary_recall': 0.010037641, 'binary_specificity': 0.99784833, 'binary_f1_score': 0.01939394}
confusion matrix:
      0   1
0  9275  20
1   789   8
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 13:52:00.522098,epoch time: 0:32:08.815954,used: 0:32:08.815954,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_13_19_51_seed_2_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9329348, 'precision': 0.9385346, 'recall': 0.9329458, 'specificity': 0.9329458, 'f1': 0.93272126, 'auroc': 0.9713472, 'binary_precision': 0.9881378, 'binary_recall': 0.8764167, 'binary_specificity': 0.9894749, 'binary_f1_score': 0.92893016}
confusion matrix:
       0      1
0  25571    272
1   3195  22658
---- Validation: 
scalar performance:
{'acc': 0.97418827, 'precision': 0.613112, 'recall': 0.51327664, 'specificity': 0.51327664, 'f1': 0.51920915, 'auroc': 0.64057446, 'binary_precision': 0.25, 'binary_recall': 0.028708134, 'binary_specificity': 0.9978451, 'binary_f1_score': 0.051502146}
confusion matrix:
       0   1
0  16670  36
1    406  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92221564, 'precision': 0.774318, 'recall': 0.5178523, 'specificity': 0.5178523, 'f1': 0.5152072, 'auroc': 0.68503803, 'binary_precision': 0.625, 'binary_recall': 0.037641153, 'binary_specificity': 0.9980635, 'binary_f1_score': 0.07100591}
confusion matrix:
      0   1
0  9277  18
1   767  30
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 14:23:35.459544,epoch time: 0:31:34.937446,used: 1:03:43.753400,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_13_19_51_seed_2_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9495899, 'precision': 0.95166916, 'recall': 0.9495965, 'specificity': 0.9495965, 'f1': 0.9495324, 'auroc': 0.98017025, 'binary_precision': 0.9823629, 'binary_recall': 0.91563845, 'binary_specificity': 0.98355454, 'binary_f1_score': 0.9478278}
confusion matrix:
       0      1
0  25418    425
1   2181  23672
---- Validation: 
scalar performance:
{'acc': 0.9736627, 'precision': 0.6708201, 'recall': 0.550327, 'specificity': 0.550327, 'f1': 0.57494307, 'auroc': 0.728351, 'binary_precision': 0.36363637, 'binary_recall': 0.10526316, 'binary_specificity': 0.9953909, 'binary_f1_score': 0.1632653}
confusion matrix:
       0   1
0  16629  77
1    374  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92221564, 'precision': 0.7460408, 'recall': 0.5298971, 'specificity': 0.5298971, 'f1': 0.53715724, 'auroc': 0.7277669, 'binary_precision': 0.56666666, 'binary_recall': 0.06398996, 'binary_specificity': 0.9958042, 'binary_f1_score': 0.11499436}
confusion matrix:
      0   1
0  9256  39
1   746  51
early stop counter: 1
val acc:0.9736626744270325, best validation acc: 0.9741882681846619, corresponding to test acc:                         0.9222156405448914 / 0.9222156405448914
after epoch: 3,now: 2024-08-08 14:55:43.652879,epoch time: 0:32:08.193335,used: 1:35:51.946735,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_13_19_51_seed_2_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.9593461, 'recall': 0.9583379, 'specificity': 0.9583379, 'f1': 0.9583106, 'auroc': 0.98450536, 'binary_precision': 0.9809636, 'binary_recall': 0.9348238, 'binary_specificity': 0.98185194, 'binary_f1_score': 0.95733804}
confusion matrix:
       0      1
0  25374    469
1   1685  24168
---- Validation: 
scalar performance:
{'acc': 0.9750642, 'precision': 0.7292923, 'recall': 0.6116899, 'specificity': 0.6116899, 'f1': 0.6487402, 'auroc': 0.79627943, 'binary_precision': 0.47761193, 'binary_recall': 0.22966507, 'binary_specificity': 0.9937148, 'binary_f1_score': 0.3101777}
confusion matrix:
       0    1
0  16601  105
1    322   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92261195, 'precision': 0.7347219, 'recall': 0.56452584, 'specificity': 0.56452584, 'f1': 0.5903093, 'auroc': 0.78584343, 'binary_precision': 0.5388349, 'binary_recall': 0.13927227, 'binary_specificity': 0.9897795, 'binary_f1_score': 0.22133599}
confusion matrix:
      0    1
0  9200   95
1   686  111
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-08 15:25:08.319124,epoch time: 0:29:24.666245,used: 2:05:16.612980,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_13_19_51_seed_2_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96046114, 'precision': 0.9622326, 'recall': 0.96046597, 'specificity': 0.96046597, 'f1': 0.96042347, 'auroc': 0.9882562, 'binary_precision': 0.99088657, 'binary_recall': 0.92948323, 'binary_specificity': 0.9914487, 'binary_f1_score': 0.9592032}
confusion matrix:
       0      1
0  25623    221
1   1823  24029
---- Validation: 
scalar performance:
{'acc': 0.97518104, 'precision': 0.7321471, 'recall': 0.6164148, 'specificity': 0.6164148, 'f1': 0.65367997, 'auroc': 0.81138754, 'binary_precision': 0.4830918, 'binary_recall': 0.23923445, 'binary_specificity': 0.9935951, 'binary_f1_score': 0.32}
confusion matrix:
       0    1
0  16599  107
1    318  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92132384, 'precision': 0.7185794, 'recall': 0.55637026, 'specificity': 0.55637026, 'f1': 0.5783063, 'auroc': 0.78575253, 'binary_precision': 0.507772, 'binary_recall': 0.122961104, 'binary_specificity': 0.9897795, 'binary_f1_score': 0.1979798}
confusion matrix:
      0   1
0  9200  95
1   699  98
better model found
persisted
after epoch: 5,now: 2024-08-08 15:54:22.540118,epoch time: 0:29:14.220994,used: 2:34:30.833974,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_13_19_51_seed_2_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96574205, 'precision': 0.96668375, 'recall': 0.96574557, 'specificity': 0.96574557, 'f1': 0.96572495, 'auroc': 0.9904034, 'binary_precision': 0.9876868, 'binary_recall': 0.94325393, 'binary_specificity': 0.98823714, 'binary_f1_score': 0.96495914}
confusion matrix:
       0      1
0  25540    304
1   1467  24385
---- Validation: 
scalar performance:
{'acc': 0.9740131, 'precision': 0.720585, 'recall': 0.6682971, 'specificity': 0.6682971, 'f1': 0.69063973, 'auroc': 0.84530854, 'binary_precision': 0.45741326, 'binary_recall': 0.34688994, 'binary_specificity': 0.9897043, 'binary_f1_score': 0.39455786}
confusion matrix:
       0    1
0  16534  172
1    273  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9208284, 'precision': 0.71433955, 'recall': 0.5761759, 'specificity': 0.5761759, 'f1': 0.6039872, 'auroc': 0.808128, 'binary_precision': 0.49626866, 'binary_recall': 0.16687578, 'binary_specificity': 0.9854761, 'binary_f1_score': 0.24976525}
confusion matrix:
      0    1
0  9160  135
1   664  133
early stop counter: 1
val acc:0.974013090133667, best validation acc: 0.9751810431480408, corresponding to test acc:                         0.921323835849762 / 0.9226119518280029
after epoch: 6,now: 2024-08-08 16:23:04.640398,epoch time: 0:28:42.100280,used: 3:03:12.934254,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_13_19_51_seed_2_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96932065, 'precision': 0.9697764, 'recall': 0.96932185, 'specificity': 0.96932185, 'f1': 0.96931326, 'auroc': 0.9917884, 'binary_precision': 0.9844274, 'binary_recall': 0.9537331, 'binary_specificity': 0.9849106, 'binary_f1_score': 0.9688372}
confusion matrix:
       0      1
0  25456    390
1   1196  24654
---- Validation: 
scalar performance:
{'acc': 0.9693997, 'precision': 0.6848794, 'recall': 0.7020862, 'specificity': 0.7020862, 'f1': 0.6930623, 'auroc': 0.85372686, 'binary_precision': 0.3842795, 'binary_recall': 0.42105263, 'binary_specificity': 0.98311985, 'binary_f1_score': 0.4018265}
confusion matrix:
       0    1
0  16424  282
1    242  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92112565, 'precision': 0.71835285, 'recall': 0.5941177, 'specificity': 0.5941177, 'f1': 0.62502605, 'auroc': 0.82246053, 'binary_precision': 0.50152904, 'binary_recall': 0.20577164, 'binary_specificity': 0.9824637, 'binary_f1_score': 0.29181495}
confusion matrix:
      0    1
0  9132  163
1   633  164
early stop counter: 2
val acc:0.9693996906280518, best validation acc: 0.9751810431480408, corresponding to test acc:                         0.921323835849762 / 0.9226119518280029
after epoch: 7,now: 2024-08-08 16:55:42.594271,epoch time: 0:32:37.953873,used: 3:35:50.888127,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_13_19_51_seed_2_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96653515, 'precision': 0.9679406, 'recall': 0.9665383, 'specificity': 0.9665383, 'f1': 0.9665102, 'auroc': 0.99291193, 'binary_precision': 0.9936152, 'binary_recall': 0.9391126, 'binary_specificity': 0.993964, 'binary_f1_score': 0.9655954}
confusion matrix:
       0      1
0  25689    156
1   1574  24277
---- Validation: 
scalar performance:
{'acc': 0.97518104, 'precision': 0.73585784, 'recall': 0.6665633, 'specificity': 0.6665633, 'f1': 0.69478893, 'auroc': 0.8514639, 'binary_precision': 0.4880546, 'binary_recall': 0.34210527, 'binary_specificity': 0.9910212, 'binary_f1_score': 0.40225035}
confusion matrix:
       0    1
0  16556  150
1    275  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.7159045, 'recall': 0.5722686, 'specificity': 0.5722686, 'f1': 0.5992887, 'auroc': 0.81585634, 'binary_precision': 0.5, 'binary_recall': 0.15809284, 'binary_specificity': 0.98644435, 'binary_f1_score': 0.24022877}
confusion matrix:
      0    1
0  9169  126
1   671  126
early stop counter: 3
val acc:0.9751810431480408, best validation acc: 0.9751810431480408, corresponding to test acc:                         0.921323835849762 / 0.9226119518280029
after epoch: 8,now: 2024-08-08 17:26:42.730229,epoch time: 0:31:00.135958,used: 4:06:51.024085,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_13_19_51_seed_2_24111572
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 4:06:51.024085 at 2024-08-08 17:26:42.730229
persisted model performance metric: 

scalar performance:
{'acc': 0.92132384, 'precision': 0.7185794, 'recall': 0.55637026, 'specificity': 0.55637026, 'f1': 0.5783063, 'auroc': 0.78575253, 'binary_precision': 0.507772, 'binary_recall': 0.122961104, 'binary_specificity': 0.9897795, 'binary_f1_score': 0.1979798}
confusion matrix:
      0   1
0  9200  95
1   699  98
oracle model performance metric: 

scalar performance:
{'acc': 0.92261195, 'precision': 0.7347219, 'recall': 0.56452584, 'specificity': 0.56452584, 'f1': 0.5903093, 'auroc': 0.78584343, 'binary_precision': 0.5388349, 'binary_recall': 0.13927227, 'binary_specificity': 0.9897795, 'binary_f1_score': 0.22133599}
confusion matrix:
      0    1
0  9200   95
1   686  111
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197429 KiB |   2142 MiB |   1019 TiB |   1019 TiB |
|       from large pool | 179211 KiB |   2124 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  18218 KiB |     38 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197429 KiB |   2142 MiB |   1019 TiB |   1019 TiB |
|       from large pool | 179211 KiB |   2124 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  18218 KiB |     38 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   2141 MiB |   1019 TiB |   1019 TiB |
|       from large pool | 178979 KiB |   2123 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  16662 KiB |     36 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2362 MiB |   2372 MiB |   6598 MiB |   4236 MiB |
|       from large pool |   2324 MiB |   2330 MiB |   6538 MiB |   4214 MiB |
|       from small pool |     38 MiB |     42 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42187 KiB | 233721 KiB | 567064 GiB | 567064 GiB |
|       from large pool |  31733 KiB | 231736 KiB | 553496 GiB | 553496 GiB |
|       from small pool |  10454 KiB |  26061 KiB |  13568 GiB |  13568 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4432    |    6957    |  159168 K  |  159164 K  |
|       from large pool |      79    |     252    |   95269 K  |   95269 K  |
|       from small pool |    4353    |    6877    |   63899 K  |   63895 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4432    |    6957    |  159168 K  |  159164 K  |
|       from large pool |      79    |     252    |   95269 K  |   95269 K  |
|       from small pool |    4353    |    6877    |   63899 K  |   63895 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     118    |     299    |     183    |
|       from large pool |      97    |      97    |     269    |     172    |
|       from small pool |      19    |      21    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    3247    |  107498 K  |  107498 K  |
|       from large pool |      11    |     101    |   72768 K  |   72768 K  |
|       from small pool |      29    |    3236    |   34729 K  |   34729 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB |   1019 TiB |   1019 TiB |
|       from large pool |  16640 KiB |   2124 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |     38 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB |   1019 TiB |   1019 TiB |
|       from large pool |  16640 KiB |   2124 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |     38 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB |   1019 TiB |   1019 TiB |
|       from large pool |  16640 KiB |   2123 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |     36 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   2372 MiB |   6598 MiB |   6364 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   6538 MiB |   6332 MiB |
|       from small pool |  28672 KiB |     42 MiB |     60 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 233721 KiB | 567064 GiB | 567064 GiB |
|       from large pool |  30464 KiB | 231736 KiB | 553496 GiB | 553496 GiB |
|       from small pool |      0 KiB |  26061 KiB |  13568 GiB |  13568 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  159168 K  |  159168 K  |
|       from large pool |       2    |     252    |   95269 K  |   95269 K  |
|       from small pool |       0    |    6877    |   63899 K  |   63899 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  159168 K  |  159168 K  |
|       from large pool |       2    |     252    |   95269 K  |   95269 K  |
|       from small pool |       0    |    6877    |   63899 K  |   63899 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     118    |     299    |     275    |
|       from large pool |      10    |      97    |     269    |     259    |
|       from small pool |      14    |      21    |      30    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3247    |  107500 K  |  107500 K  |
|       from large pool |       3    |     101    |   72768 K  |   72768 K  |
|       from small pool |       0    |    3236    |   34731 K  |   34731 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  8 17:43:20 2024]
Finished job 0.
1 of 1 steps (100%) done
