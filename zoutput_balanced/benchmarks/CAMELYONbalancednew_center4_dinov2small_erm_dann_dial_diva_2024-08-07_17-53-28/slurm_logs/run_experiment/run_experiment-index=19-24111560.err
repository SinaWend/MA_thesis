Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Aug  7 18:03:40 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/19.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=19
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111560

 Experiment start at: 2024-08-07 18:09:26.527658
before training, model accuracy: 0.28613802790641785
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93785536, 'precision': 0.94150853, 'recall': 0.9378805, 'specificity': 0.9378805, 'f1': 0.937729, 'auroc': 0.97786653, 'binary_precision': 0.98180795, 'binary_recall': 0.8923132, 'binary_specificity': 0.9834479, 'binary_f1_score': 0.9349237}
confusion matrix:
       0      1
0  24895    419
1   2729  22613
---- Validation: 
scalar performance:
{'acc': 0.9550916, 'precision': 0.53475684, 'recall': 0.53638834, 'specificity': 0.53638834, 'f1': 0.53554636, 'auroc': 0.69077057, 'binary_precision': 0.09195402, 'binary_recall': 0.09638554, 'binary_specificity': 0.97639114, 'binary_f1_score': 0.09411765}
confusion matrix:
       0    1
0  16336  395
1    375   40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90508205, 'precision': 0.5778552, 'recall': 0.53628135, 'specificity': 0.53628135, 'f1': 0.54477733, 'auroc': 0.82336104, 'binary_precision': 0.22674419, 'binary_recall': 0.10103627, 'binary_specificity': 0.97152644, 'binary_f1_score': 0.13978495}
confusion matrix:
      0    1
0  9076  266
1   694   78
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 18:41:12.379853,epoch time: 0:31:45.852195,used: 0:31:45.852195,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9523847, 'precision': 0.9546091, 'recall': 0.95240414, 'specificity': 0.95240414, 'f1': 0.95232785, 'auroc': 0.9853145, 'binary_precision': 0.9865473, 'binary_recall': 0.9173309, 'binary_specificity': 0.9874773, 'binary_f1_score': 0.9506809}
confusion matrix:
       0      1
0  24997    317
1   2095  23247
---- Validation: 
scalar performance:
{'acc': 0.9667561, 'precision': 0.62019324, 'recall': 0.5940624, 'specificity': 0.5940624, 'f1': 0.60532737, 'auroc': 0.77245164, 'binary_precision': 0.26006192, 'binary_recall': 0.20240964, 'binary_specificity': 0.98571515, 'binary_f1_score': 0.2276423}
confusion matrix:
       0    1
0  16492  239
1    331   84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91684794, 'precision': 0.68336374, 'recall': 0.6145422, 'specificity': 0.6145422, 'f1': 0.63846904, 'auroc': 0.86776257, 'binary_precision': 0.4261242, 'binary_recall': 0.25777203, 'binary_specificity': 0.97131234, 'binary_f1_score': 0.3212268}
confusion matrix:
      0    1
0  9074  268
1   573  199
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 19:11:53.876916,epoch time: 0:30:41.497063,used: 1:02:27.349258,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96073514, 'precision': 0.96170783, 'recall': 0.9607479, 'specificity': 0.9607479, 'f1': 0.9607152, 'auroc': 0.9893064, 'binary_precision': 0.9830389, 'binary_recall': 0.93769234, 'binary_specificity': 0.98380345, 'binary_f1_score': 0.9598303}
confusion matrix:
       0      1
0  24904    410
1   1579  23763
---- Validation: 
scalar performance:
{'acc': 0.965473, 'precision': 0.6311798, 'recall': 0.627478, 'specificity': 0.627478, 'f1': 0.62929916, 'auroc': 0.79101896, 'binary_precision': 0.28039703, 'binary_recall': 0.27228916, 'binary_specificity': 0.9826669, 'binary_f1_score': 0.27628362}
confusion matrix:
       0    1
0  16441  290
1    302  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91754, 'precision': 0.6933074, 'recall': 0.6380886, 'specificity': 0.6380886, 'f1': 0.6596369, 'auroc': 0.8721608, 'binary_precision': 0.44237918, 'binary_recall': 0.30829015, 'binary_specificity': 0.967887, 'binary_f1_score': 0.36335877}
confusion matrix:
      0    1
0  9042  300
1   534  238
new oracle model saved
early stop counter: 1
val acc:0.9654729962348938, best validation acc: 0.9667561054229736, corresponding to test acc:                         0.9168479442596436 / 0.9175400137901306
after epoch: 3,now: 2024-08-07 19:42:17.422536,epoch time: 0:30:23.545620,used: 1:32:50.894878,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9652363, 'recall': 0.9645371, 'specificity': 0.9645371, 'f1': 0.9645126, 'auroc': 0.99060607, 'binary_precision': 0.9835702, 'binary_recall': 0.9448763, 'binary_specificity': 0.98419785, 'binary_f1_score': 0.9638351}
confusion matrix:
       0      1
0  24913    400
1   1397  23946
---- Validation: 
scalar performance:
{'acc': 0.94511837, 'precision': 0.602368, 'recall': 0.7227924, 'specificity': 0.7227924, 'f1': 0.6364239, 'auroc': 0.8268262, 'binary_precision': 0.21781115, 'binary_recall': 0.48915663, 'binary_specificity': 0.9564282, 'binary_f1_score': 0.30141056}
confusion matrix:
       0    1
0  16002  729
1    212  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90607077, 'precision': 0.68611234, 'recall': 0.73644984, 'specificity': 0.73644984, 'f1': 0.70710063, 'auroc': 0.88348675, 'binary_precision': 0.41153082, 'binary_recall': 0.5362694, 'binary_specificity': 0.93663025, 'binary_f1_score': 0.46569178}
confusion matrix:
      0    1
0  8750  592
1   358  414
early stop counter: 2
val acc:0.9451183676719666, best validation acc: 0.9667561054229736, corresponding to test acc:                         0.9168479442596436 / 0.9175400137901306
after epoch: 4,now: 2024-08-07 20:13:10.494095,epoch time: 0:30:53.071559,used: 2:03:43.966437,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9708031, 'precision': 0.9712796, 'recall': 0.97081316, 'specificity': 0.97081316, 'f1': 0.9707961, 'auroc': 0.9933253, 'binary_precision': 0.98642534, 'binary_recall': 0.9547822, 'binary_specificity': 0.9868442, 'binary_f1_score': 0.97034585}
confusion matrix:
       0      1
0  24979    333
1   1146  24198
---- Validation: 
scalar performance:
{'acc': 0.93829465, 'precision': 0.59334356, 'recall': 0.73104525, 'specificity': 0.73104525, 'f1': 0.6274069, 'auroc': 0.83547914, 'binary_precision': 0.19925164, 'binary_recall': 0.51325303, 'binary_specificity': 0.94883746, 'binary_f1_score': 0.287062}
confusion matrix:
       0    1
0  15875  856
1    202  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90626854, 'precision': 0.6915484, 'recall': 0.7591345, 'specificity': 0.7591345, 'f1': 0.71826595, 'auroc': 0.8869004, 'binary_precision': 0.4185185, 'binary_recall': 0.58549225, 'binary_specificity': 0.9327767, 'binary_f1_score': 0.48812094}
confusion matrix:
      0    1
0  8714  628
1   320  452
early stop counter: 3
val acc:0.9382946491241455, best validation acc: 0.9667561054229736, corresponding to test acc:                         0.9168479442596436 / 0.9175400137901306
after epoch: 5,now: 2024-08-07 20:44:04.422163,epoch time: 0:30:53.928068,used: 2:34:37.894505,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_18_09_26_seed_0_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:34:37.894505 at 2024-08-07 20:44:04.422163
persisted model performance metric: 

scalar performance:
{'acc': 0.91684794, 'precision': 0.68336374, 'recall': 0.6145422, 'specificity': 0.6145422, 'f1': 0.63846904, 'auroc': 0.86776257, 'binary_precision': 0.4261242, 'binary_recall': 0.25777203, 'binary_specificity': 0.97131234, 'binary_f1_score': 0.3212268}
confusion matrix:
      0    1
0  9074  268
1   573  199
oracle model performance metric: 

scalar performance:
{'acc': 0.91754, 'precision': 0.6933074, 'recall': 0.6380886, 'specificity': 0.6380886, 'f1': 0.6596369, 'auroc': 0.8721608, 'binary_precision': 0.44237918, 'binary_recall': 0.30829015, 'binary_specificity': 0.967887, 'binary_f1_score': 0.36335877}
confusion matrix:
      0    1
0  9042  300
1   534  238
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/19.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198886 KiB |   2142 MiB | 263080 GiB | 263079 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |  18224 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198886 KiB |   2142 MiB | 263080 GiB | 263079 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |  18224 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   2141 MiB | 263055 GiB | 263055 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 259628 GiB | 259628 GiB |
|       from small pool |  16663 KiB |     36 MiB |   3427 GiB |   3427 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2372 MiB |   2372 MiB |   2372 MiB |      0 B   |
|       from large pool |   2330 MiB |   2330 MiB |   2330 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  63258 KiB | 225565 KiB | 143429 GiB | 143429 GiB |
|       from large pool |  50762 KiB | 224940 KiB | 139975 GiB | 139975 GiB |
|       from small pool |  12496 KiB |  12998 KiB |   3453 GiB |   3453 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4444    |    6827    |   40029 K  |   40024 K  |
|       from large pool |      79    |     252    |   24084 K  |   24084 K  |
|       from small pool |    4365    |    6747    |   15944 K  |   15940 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4444    |    6827    |   40029 K  |   40024 K  |
|       from large pool |      79    |     252    |   24084 K  |   24084 K  |
|       from small pool |    4365    |    6747    |   15944 K  |   15940 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     118    |     118    |     118    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    3182    |   25680 K  |   25680 K  |
|       from large pool |      10    |      97    |   18855 K  |   18855 K  |
|       from small pool |      30    |    3172    |    6825 K  |    6825 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |      0 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |      0 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 263055 GiB | 263055 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 259628 GiB | 259628 GiB |
|       from small pool |      0 KiB |     36 MiB |   3427 GiB |   3427 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   2372 MiB |   2372 MiB |   2116 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 143429 GiB | 143429 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 139975 GiB | 139975 GiB |
|       from small pool |      0 KiB |  26061 KiB |   3453 GiB |   3453 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   40029 K  |   40029 K  |
|       from large pool |       2    |     252    |   24084 K  |   24084 K  |
|       from small pool |       0    |    6747    |   15944 K  |   15944 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   40029 K  |   40029 K  |
|       from large pool |       2    |     252    |   24084 K  |   24084 K  |
|       from small pool |       0    |    6747    |   15944 K  |   15944 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |     118    |     118    |      92    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   25682 K  |   25682 K  |
|       from large pool |       3    |      97    |   18855 K  |   18855 K  |
|       from small pool |       0    |    3172    |    6827 K  |    6827 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |      0 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 263080 GiB | 263080 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 259647 GiB | 259647 GiB |
|       from small pool |      0 KiB |     38 MiB |   3432 GiB |   3432 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 263055 GiB | 263055 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 259628 GiB | 259628 GiB |
|       from small pool |      0 KiB |     36 MiB |   3427 GiB |   3427 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   2372 MiB |   2372 MiB |   2116 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 143429 GiB | 143429 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 139975 GiB | 139975 GiB |
|       from small pool |      0 KiB |  26061 KiB |   3453 GiB |   3453 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   40029 K  |   40029 K  |
|       from large pool |       2    |     252    |   24084 K  |   24084 K  |
|       from small pool |       0    |    6747    |   15944 K  |   15944 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   40029 K  |   40029 K  |
|       from large pool |       2    |     252    |   24084 K  |   24084 K  |
|       from small pool |       0    |    6747    |   15944 K  |   15944 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |     118    |     118    |      92    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   25682 K  |   25682 K  |
|       from large pool |       3    |      97    |   18855 K  |   18855 K  |
|       from small pool |       0    |    3172    |    6827 K  |    6827 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_21_09_16_seed_1_24111560

 Experiment start at: 2024-08-07 21:09:16.894625
before training, model accuracy: 0.6057873368263245
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93336874, 'precision': 0.93713903, 'recall': 0.9334054, 'specificity': 0.9334054, 'f1': 0.9332286, 'auroc': 0.9766922, 'binary_precision': 0.9779338, 'binary_recall': 0.8868533, 'binary_specificity': 0.97995746, 'binary_f1_score': 0.9301693}
confusion matrix:
       0      1
0  24887    509
1   2878  22558
---- Validation: 
scalar performance:
{'acc': 0.95462245, 'precision': 0.5611672, 'recall': 0.56874543, 'specificity': 0.56874543, 'f1': 0.5646794, 'auroc': 0.79054666, 'binary_precision': 0.14403293, 'binary_recall': 0.16241299, 'binary_specificity': 0.97507787, 'binary_f1_score': 0.15267175}
confusion matrix:
       0    1
0  16276  416
1    361   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90228915, 'precision': 0.6427905, 'recall': 0.635825, 'specificity': 0.635825, 'f1': 0.6391836, 'auroc': 0.8325002, 'binary_precision': 0.34030685, 'binary_recall': 0.32232496, 'binary_specificity': 0.949325, 'binary_f1_score': 0.3310719}
confusion matrix:
      0    1
0  8861  473
1   513  244
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 21:43:19.795116,epoch time: 0:34:02.900491,used: 0:34:02.900491,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_21_09_16_seed_1_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.952825, 'precision': 0.95396817, 'recall': 0.95284384, 'specificity': 0.95284384, 'f1': 0.95279664, 'auroc': 0.98700166, 'binary_precision': 0.97693676, 'binary_recall': 0.9276194, 'binary_specificity': 0.9780683, 'binary_f1_score': 0.9516396}
confusion matrix:
       0      1
0  24840    557
1   1841  23594
---- Validation: 
scalar performance:
{'acc': 0.96554345, 'precision': 0.6313095, 'recall': 0.61164147, 'specificity': 0.61164147, 'f1': 0.6205778, 'auroc': 0.84154934, 'binary_precision': 0.28219178, 'binary_recall': 0.23897912, 'binary_specificity': 0.98430383, 'binary_f1_score': 0.25879395}
confusion matrix:
       0    1
0  16430  262
1    328  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9080369, 'precision': 0.67753357, 'recall': 0.69841146, 'specificity': 0.69841146, 'f1': 0.6871723, 'auroc': 0.87151897, 'binary_precision': 0.4, 'binary_recall': 0.45178336, 'binary_specificity': 0.94503963, 'binary_f1_score': 0.4243176}
confusion matrix:
      0    1
0  8821  513
1   415  342
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 22:13:27.885859,epoch time: 0:30:08.090743,used: 1:04:10.991234,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_21_09_16_seed_1_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96053666, 'precision': 0.96187115, 'recall': 0.9605547, 'specificity': 0.9605547, 'f1': 0.9605092, 'auroc': 0.9910122, 'binary_precision': 0.98686564, 'binary_recall': 0.9335509, 'binary_specificity': 0.98755854, 'binary_f1_score': 0.9594682}
confusion matrix:
       0      1
0  25083    316
1   1690  23743
---- Validation: 
scalar performance:
{'acc': 0.9699819, 'precision': 0.67475647, 'recall': 0.62860984, 'specificity': 0.62860984, 'f1': 0.64782435, 'auroc': 0.8607752, 'binary_precision': 0.36825398, 'binary_recall': 0.26914153, 'binary_specificity': 0.9880781, 'binary_f1_score': 0.31099194}
confusion matrix:
       0    1
0  16493  199
1    315  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123972, 'precision': 0.68978333, 'recall': 0.7062309, 'specificity': 0.7062309, 'f1': 0.6975429, 'auroc': 0.87789935, 'binary_precision': 0.42340168, 'binary_recall': 0.4636724, 'binary_specificity': 0.94878936, 'binary_f1_score': 0.44262293}
confusion matrix:
      0    1
0  8856  478
1   406  351
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 22:42:52.589266,epoch time: 0:29:24.703407,used: 1:33:35.694641,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_21_09_16_seed_1_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9655729, 'precision': 0.9665184, 'recall': 0.9655916, 'specificity': 0.9655916, 'f1': 0.9655564, 'auroc': 0.9929563, 'binary_precision': 0.98772806, 'binary_recall': 0.9429178, 'binary_specificity': 0.9882654, 'binary_f1_score': 0.9648029}
confusion matrix:
       0      1
0  25097    298
1   1452  23985
---- Validation: 
scalar performance:
{'acc': 0.9704491, 'precision': 0.683581, 'recall': 0.64015085, 'specificity': 0.64015085, 'f1': 0.658672, 'auroc': 0.8705497, 'binary_precision': 0.3853211, 'binary_recall': 0.29234338, 'binary_specificity': 0.9879583, 'binary_f1_score': 0.33245382}
confusion matrix:
       0    1
0  16491  201
1    305  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9128927, 'precision': 0.6946932, 'recall': 0.72288597, 'specificity': 0.72288597, 'f1': 0.7074961, 'auroc': 0.8790345, 'binary_precision': 0.43052393, 'binary_recall': 0.4993395, 'binary_specificity': 0.9464324, 'binary_f1_score': 0.46238533}
confusion matrix:
      0    1
0  8834  500
1   379  378
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 23:12:17.138987,epoch time: 0:29:24.549721,used: 2:03:00.244362,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_21_09_16_seed_1_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9686615, 'precision': 0.9693781, 'recall': 0.96867776, 'specificity': 0.96867776, 'f1': 0.9686502, 'auroc': 0.99373364, 'binary_precision': 0.98792666, 'binary_recall': 0.948972, 'binary_specificity': 0.98838353, 'binary_f1_score': 0.9680576}
confusion matrix:
       0      1
0  25100    295
1   1298  24139
---- Validation: 
scalar performance:
{'acc': 0.9689891, 'precision': 0.6777074, 'recall': 0.66200477, 'specificity': 0.66200477, 'f1': 0.6694562, 'auroc': 0.8750309, 'binary_precision': 0.37244898, 'binary_recall': 0.3387471, 'binary_specificity': 0.9852624, 'binary_f1_score': 0.35479954}
confusion matrix:
       0    1
0  16446  246
1    285  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9100188, 'precision': 0.69539917, 'recall': 0.7565347, 'specificity': 0.7565347, 'f1': 0.72027254, 'auroc': 0.88254786, 'binary_precision': 0.42619747, 'binary_recall': 0.5759577, 'binary_specificity': 0.9371116, 'binary_f1_score': 0.48988762}
confusion matrix:
      0    1
0  8747  587
1   321  436
early stop counter: 1
val acc:0.9689890742301941, best validation acc: 0.9704490900039673, corresponding to test acc:                         0.9128926992416382 / 0.9128926992416382
after epoch: 5,now: 2024-08-07 23:41:32.630922,epoch time: 0:29:15.491935,used: 2:32:15.736297,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_21_09_16_seed_1_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.975783, 'precision': 0.9761909, 'recall': 0.975794, 'specificity': 0.975794, 'f1': 0.97577816, 'auroc': 0.99574924, 'binary_precision': 0.9903168, 'binary_recall': 0.9609986, 'binary_specificity': 0.99058944, 'binary_f1_score': 0.97543746}
confusion matrix:
       0      1
0  25158    239
1    992  24443
---- Validation: 
scalar performance:
{'acc': 0.96700346, 'precision': 0.6480021, 'recall': 0.6248219, 'specificity': 0.6248219, 'f1': 0.63531315, 'auroc': 0.8553329, 'binary_precision': 0.31491712, 'binary_recall': 0.26450115, 'binary_specificity': 0.9851426, 'binary_f1_score': 0.28751573}
confusion matrix:
       0    1
0  16444  248
1    317  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9034783, 'precision': 0.6809076, 'recall': 0.7469299, 'specificity': 0.7469299, 'f1': 0.706766, 'auroc': 0.8676605, 'binary_precision': 0.39850327, 'binary_recall': 0.5627477, 'binary_specificity': 0.93111205, 'binary_f1_score': 0.46659365}
confusion matrix:
      0    1
0  8691  643
1   331  426
early stop counter: 2
val acc:0.9670034646987915, best validation acc: 0.9704490900039673, corresponding to test acc:                         0.9128926992416382 / 0.9128926992416382
after epoch: 6,now: 2024-08-08 00:10:44.973282,epoch time: 0:29:12.342360,used: 3:01:28.078657,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_21_09_16_seed_1_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97594035, 'precision': 0.9761104, 'recall': 0.97594714, 'specificity': 0.97594714, 'f1': 0.97593844, 'auroc': 0.9959996, 'binary_precision': 0.9852876, 'binary_recall': 0.96634424, 'binary_specificity': 0.98555005, 'binary_f1_score': 0.975724}
confusion matrix:
       0      1
0  25031    367
1    856  24578
---- Validation: 
scalar performance:
{'acc': 0.96583545, 'precision': 0.6313735, 'recall': 0.6084008, 'specificity': 0.6084008, 'f1': 0.618647, 'auroc': 0.8578341, 'binary_precision': 0.28248587, 'binary_recall': 0.23201856, 'binary_specificity': 0.9847831, 'binary_f1_score': 0.25477707}
confusion matrix:
       0    1
0  16438  254
1    331  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9023883, 'precision': 0.68318623, 'recall': 0.76454866, 'specificity': 0.76454866, 'f1': 0.71344495, 'auroc': 0.8718074, 'binary_precision': 0.4, 'binary_recall': 0.60237783, 'binary_specificity': 0.92671955, 'binary_f1_score': 0.48075908}
confusion matrix:
      0    1
0  8650  684
1   301  456
early stop counter: 3
val acc:0.965835452079773, best validation acc: 0.9704490900039673, corresponding to test acc:                         0.9128926992416382 / 0.9128926992416382
after epoch: 7,now: 2024-08-08 00:40:06.455689,epoch time: 0:29:21.482407,used: 3:30:49.561064,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_07_21_09_16_seed_1_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 3:30:49.561064 at 2024-08-08 00:40:06.455689
persisted model performance metric: 

scalar performance:
{'acc': 0.9128927, 'precision': 0.6946932, 'recall': 0.72288597, 'specificity': 0.72288597, 'f1': 0.7074961, 'auroc': 0.8790345, 'binary_precision': 0.43052393, 'binary_recall': 0.4993395, 'binary_specificity': 0.9464324, 'binary_f1_score': 0.46238533}
confusion matrix:
      0    1
0  8834  500
1   379  378
oracle model performance metric: 

scalar performance:
{'acc': 0.9128927, 'precision': 0.6946932, 'recall': 0.72288597, 'specificity': 0.72288597, 'f1': 0.7074961, 'auroc': 0.8790345, 'binary_precision': 0.43052393, 'binary_recall': 0.4993395, 'binary_specificity': 0.9464324, 'binary_f1_score': 0.46238533}
confusion matrix:
      0    1
0  8834  500
1   379  378
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197429 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |  18218 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197429 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |  18218 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   2141 MiB | 621138 GiB | 621138 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 613133 GiB | 613133 GiB |
|       from small pool |  16662 KiB |     36 MiB |   8004 GiB |   8004 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2362 MiB |   2372 MiB |   4478 MiB |   2116 MiB |
|       from large pool |   2324 MiB |   2330 MiB |   4428 MiB |   2104 MiB |
|       from small pool |     38 MiB |     42 MiB |     50 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42187 KiB | 233721 KiB | 334291 GiB | 334291 GiB |
|       from large pool |  31733 KiB | 231736 KiB | 326049 GiB | 326049 GiB |
|       from small pool |  10454 KiB |  26061 KiB |   8242 GiB |   8242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4432    |    6849    |   94480 K  |   94476 K  |
|       from large pool |      79    |     252    |   56814 K  |   56814 K  |
|       from small pool |    4353    |    6769    |   37665 K  |   37661 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4432    |    6849    |   94480 K  |   94476 K  |
|       from large pool |      79    |     252    |   56814 K  |   56814 K  |
|       from small pool |    4353    |    6769    |   37665 K  |   37661 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     118    |     208    |      92    |
|       from large pool |      97    |      97    |     183    |      86    |
|       from small pool |      19    |      21    |      25    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    3195    |   63402 K  |   63402 K  |
|       from large pool |      11    |     101    |   43902 K  |   43902 K  |
|       from small pool |      28    |    3184    |   19500 K  |   19500 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |      0 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |      0 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 621138 GiB | 621138 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 613133 GiB | 613133 GiB |
|       from small pool |      0 KiB |     36 MiB |   8004 GiB |   8004 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   2372 MiB |   4478 MiB |   4244 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4428 MiB |   4222 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 233721 KiB | 334291 GiB | 334291 GiB |
|       from large pool |  30464 KiB | 231736 KiB | 326049 GiB | 326049 GiB |
|       from small pool |      0 KiB |  26061 KiB |   8242 GiB |   8242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |   94480 K  |   94480 K  |
|       from large pool |       2    |     252    |   56814 K  |   56814 K  |
|       from small pool |       0    |    6769    |   37665 K  |   37665 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |   94480 K  |   94480 K  |
|       from large pool |       2    |     252    |   56814 K  |   56814 K  |
|       from small pool |       0    |    6769    |   37665 K  |   37665 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     118    |     208    |     184    |
|       from large pool |      10    |      97    |     183    |     173    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3195    |   63404 K  |   63404 K  |
|       from large pool |       3    |     101    |   43902 K  |   43902 K  |
|       from small pool |       0    |    3184    |   19502 K  |   19502 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |      0 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 621210 GiB | 621210 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 613194 GiB | 613194 GiB |
|       from small pool |      0 KiB |     38 MiB |   8016 GiB |   8016 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 621138 GiB | 621138 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 613133 GiB | 613133 GiB |
|       from small pool |      0 KiB |     36 MiB |   8004 GiB |   8004 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   2372 MiB |   4478 MiB |   4244 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4428 MiB |   4222 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 233721 KiB | 334291 GiB | 334291 GiB |
|       from large pool |  30464 KiB | 231736 KiB | 326049 GiB | 326049 GiB |
|       from small pool |      0 KiB |  26061 KiB |   8242 GiB |   8242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |   94480 K  |   94480 K  |
|       from large pool |       2    |     252    |   56814 K  |   56814 K  |
|       from small pool |       0    |    6769    |   37665 K  |   37665 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |   94480 K  |   94480 K  |
|       from large pool |       2    |     252    |   56814 K  |   56814 K  |
|       from small pool |       0    |    6769    |   37665 K  |   37665 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     118    |     208    |     184    |
|       from large pool |      10    |      97    |     183    |     173    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3195    |   63404 K  |   63404 K  |
|       from large pool |       3    |     101    |   43902 K  |   43902 K  |
|       from small pool |       0    |    3184    |   19502 K  |   19502 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560

 Experiment start at: 2024-08-08 01:03:22.737702
before training, model accuracy: 0.11296075582504272
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9088711, 'precision': 0.91471606, 'recall': 0.9088849, 'specificity': 0.9088849, 'f1': 0.90855086, 'auroc': 0.9546256, 'binary_precision': 0.9640083, 'binary_recall': 0.8495011, 'binary_specificity': 0.9682687, 'binary_f1_score': 0.9031396}
confusion matrix:
       0      1
0  25022    820
1   3891  21963
---- Validation: 
scalar performance:
{'acc': 0.9696333, 'precision': 0.50601536, 'recall': 0.5016122, 'specificity': 0.5016122, 'f1': 0.49986517, 'auroc': 0.5559944, 'binary_precision': 0.036363635, 'binary_recall': 0.009569378, 'binary_specificity': 0.99365497, 'binary_f1_score': 0.015151515}
confusion matrix:
       0    1
0  16600  106
1    414    4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9206302, 'precision': 0.6862515, 'recall': 0.51010895, 'specificity': 0.51010895, 'f1': 0.5008045, 'auroc': 0.6219486, 'binary_precision': 0.45, 'binary_recall': 0.022584694, 'binary_specificity': 0.99763316, 'binary_f1_score': 0.043010753}
confusion matrix:
      0   1
0  9273  22
1   779  18
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 01:33:54.248541,epoch time: 0:30:31.510839,used: 0:30:31.510839,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9396859, 'precision': 0.94403934, 'recall': 0.9396974, 'specificity': 0.9396974, 'f1': 0.9395387, 'auroc': 0.9753573, 'binary_precision': 0.9880646, 'binary_recall': 0.8901524, 'binary_specificity': 0.9892423, 'binary_f1_score': 0.9365564}
confusion matrix:
       0      1
0  25564    278
1   2840  23014
---- Validation: 
scalar performance:
{'acc': 0.97523946, 'precision': 0.7007639, 'recall': 0.5196465, 'specificity': 0.5196465, 'f1': 0.53084385, 'auroc': 0.6896424, 'binary_precision': 0.425, 'binary_recall': 0.040669855, 'binary_specificity': 0.99862325, 'binary_f1_score': 0.074235804}
confusion matrix:
       0   1
0  16683  23
1    401  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92290926, 'precision': 0.79273313, 'recall': 0.5233909, 'specificity': 0.5233909, 'f1': 0.5254345, 'auroc': 0.71668696, 'binary_precision': 0.66101694, 'binary_recall': 0.048933502, 'binary_specificity': 0.99784833, 'binary_f1_score': 0.091121495}
confusion matrix:
      0   1
0  9275  20
1   758  39
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 02:03:44.193708,epoch time: 0:29:49.945167,used: 1:00:21.456006,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9522207, 'precision': 0.954093, 'recall': 0.9522269, 'specificity': 0.9522269, 'f1': 0.9521718, 'auroc': 0.98240423, 'binary_precision': 0.98329955, 'binary_recall': 0.9200866, 'binary_specificity': 0.98436713, 'binary_f1_score': 0.9506435}
confusion matrix:
       0      1
0  25439    404
1   2066  23787
---- Validation: 
scalar performance:
{'acc': 0.9758818, 'precision': 0.752875, 'recall': 0.55612934, 'specificity': 0.55612934, 'f1': 0.58818203, 'auroc': 0.7543898, 'binary_precision': 0.52747256, 'binary_recall': 0.114832535, 'binary_specificity': 0.9974261, 'binary_f1_score': 0.18860511}
confusion matrix:
       0   1
0  16663  43
1    370  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92281014, 'precision': 0.7515906, 'recall': 0.53997034, 'specificity': 0.53997034, 'f1': 0.55410314, 'auroc': 0.7610711, 'binary_precision': 0.5762712, 'binary_recall': 0.08531995, 'binary_specificity': 0.99462074, 'binary_f1_score': 0.14863388}
confusion matrix:
      0   1
0  9245  50
1   729  68
better model found
persisted
after epoch: 3,now: 2024-08-08 02:33:24.706748,epoch time: 0:29:40.513040,used: 1:30:01.969046,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9605192, 'precision': 0.96174467, 'recall': 0.9605222, 'specificity': 0.9605222, 'f1': 0.96049315, 'auroc': 0.9870712, 'binary_precision': 0.9855616, 'binary_recall': 0.9347414, 'binary_specificity': 0.986303, 'binary_f1_score': 0.95947903}
confusion matrix:
       0      1
0  25491    354
1   1687  24164
---- Validation: 
scalar performance:
{'acc': 0.9758818, 'precision': 0.74709547, 'recall': 0.61444145, 'specificity': 0.61444145, 'f1': 0.65478086, 'auroc': 0.812613, 'binary_precision': 0.513089, 'binary_recall': 0.23444976, 'binary_specificity': 0.99443316, 'binary_f1_score': 0.3218391}
confusion matrix:
       0   1
0  16613  93
1    320  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92439556, 'precision': 0.7504984, 'recall': 0.58384806, 'specificity': 0.58384806, 'f1': 0.61638296, 'auroc': 0.80032706, 'binary_precision': 0.5674603, 'binary_recall': 0.17942284, 'binary_specificity': 0.98827326, 'binary_f1_score': 0.2726406}
confusion matrix:
      0    1
0  9186  109
1   654  143
new oracle model saved
early stop counter: 1
val acc:0.975881814956665, best validation acc: 0.975881814956665, corresponding to test acc:                         0.9228101372718811 / 0.9243955612182617
after epoch: 4,now: 2024-08-08 03:02:55.138468,epoch time: 0:29:30.431720,used: 1:59:32.400766,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9648522, 'precision': 0.9659246, 'recall': 0.9648541, 'specificity': 0.9648541, 'f1': 0.9648321, 'auroc': 0.9898553, 'binary_precision': 0.988297, 'binary_recall': 0.9408511, 'binary_specificity': 0.9888571, 'binary_f1_score': 0.9639906}
confusion matrix:
       0      1
0  25558    288
1   1529  24321
---- Validation: 
scalar performance:
{'acc': 0.9761154, 'precision': 0.750865, 'recall': 0.6413848, 'specificity': 0.6413848, 'f1': 0.6797811, 'auroc': 0.84127283, 'binary_precision': 0.5193133, 'binary_recall': 0.28947368, 'binary_specificity': 0.99329585, 'binary_f1_score': 0.37173578}
confusion matrix:
       0    1
0  16594  112
1    297  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231074, 'precision': 0.7400458, 'recall': 0.56880975, 'specificity': 0.56880975, 'f1': 0.59636295, 'auroc': 0.81593287, 'binary_precision': 0.5488372, 'binary_recall': 0.14805521, 'binary_specificity': 0.9895643, 'binary_f1_score': 0.2332016}
confusion matrix:
      0    1
0  9198   97
1   679  118
better model found
persisted
after epoch: 5,now: 2024-08-08 03:32:40.923968,epoch time: 0:29:45.785500,used: 2:29:18.186266,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96560663, 'precision': 0.96694857, 'recall': 0.9656118, 'specificity': 0.9656118, 'f1': 0.96558213, 'auroc': 0.99092686, 'binary_precision': 0.9920294, 'binary_recall': 0.9387692, 'binary_specificity': 0.9924544, 'binary_f1_score': 0.96466476}
confusion matrix:
       0      1
0  25648    195
1   1583  24270
---- Validation: 
scalar performance:
{'acc': 0.9776337, 'precision': 0.7816871, 'recall': 0.64799416, 'specificity': 0.64799416, 'f1': 0.69272804, 'auroc': 0.8475317, 'binary_precision': 0.58064514, 'binary_recall': 0.3014354, 'binary_specificity': 0.99455285, 'binary_f1_score': 0.3968504}
confusion matrix:
       0    1
0  16615   91
1    292  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92281014, 'precision': 0.7335874, 'recall': 0.5824138, 'specificity': 0.5824138, 'f1': 0.6132139, 'auroc': 0.82843816, 'binary_precision': 0.5338346, 'binary_recall': 0.17816813, 'binary_specificity': 0.98665947, 'binary_f1_score': 0.2671684}
confusion matrix:
      0    1
0  9171  124
1   655  142
better model found
persisted
after epoch: 6,now: 2024-08-08 04:02:18.399838,epoch time: 0:29:37.475870,used: 2:58:55.662136,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96932065, 'precision': 0.97008926, 'recall': 0.9693253, 'specificity': 0.9693253, 'f1': 0.96930826, 'auroc': 0.9920714, 'binary_precision': 0.9891558, 'binary_recall': 0.9490601, 'binary_specificity': 0.9895906, 'binary_f1_score': 0.9686932}
confusion matrix:
       0      1
0  25573    269
1   1317  24537
---- Validation: 
scalar performance:
{'acc': 0.97704977, 'precision': 0.7674932, 'recall': 0.6558585, 'specificity': 0.6558585, 'f1': 0.69597083, 'auroc': 0.8710242, 'binary_precision': 0.55186725, 'binary_recall': 0.3181818, 'binary_specificity': 0.9935353, 'binary_f1_score': 0.40364188}
confusion matrix:
       0    1
0  16598  108
1    285  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231074, 'precision': 0.74211454, 'recall': 0.5630741, 'specificity': 0.5630741, 'f1': 0.5886542, 'auroc': 0.8418203, 'binary_precision': 0.5538462, 'binary_recall': 0.13550815, 'binary_specificity': 0.9906401, 'binary_f1_score': 0.21774195}
confusion matrix:
      0    1
0  9208   87
1   689  108
early stop counter: 1
val acc:0.9770497679710388, best validation acc: 0.9776337146759033, corresponding to test acc:                         0.9228101372718811 / 0.9243955612182617
after epoch: 7,now: 2024-08-08 04:32:13.862369,epoch time: 0:29:55.462531,used: 3:28:51.124667,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97197074, 'precision': 0.9726614, 'recall': 0.9719722, 'specificity': 0.9719722, 'f1': 0.97196054, 'auroc': 0.9934578, 'binary_precision': 0.9907486, 'binary_recall': 0.9528433, 'binary_specificity': 0.99110115, 'binary_f1_score': 0.9714263}
confusion matrix:
       0      1
0  25616    230
1   1219  24631
---- Validation: 
scalar performance:
{'acc': 0.9736043, 'precision': 0.7182964, 'recall': 0.68558127, 'specificity': 0.68558127, 'f1': 0.70050275, 'auroc': 0.87609106, 'binary_precision': 0.4519774, 'binary_recall': 0.38277513, 'binary_specificity': 0.9883874, 'binary_f1_score': 0.41450778}
confusion matrix:
       0    1
0  16512  194
1    258  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92370194, 'precision': 0.7377738, 'recall': 0.61214954, 'specificity': 0.61214954, 'f1': 0.6467217, 'auroc': 0.85866845, 'binary_precision': 0.53760445, 'binary_recall': 0.2421581, 'binary_specificity': 0.98214096, 'binary_f1_score': 0.33391005}
confusion matrix:
      0    1
0  9129  166
1   604  193
early stop counter: 2
val acc:0.9736043214797974, best validation acc: 0.9776337146759033, corresponding to test acc:                         0.9228101372718811 / 0.9243955612182617
after epoch: 8,now: 2024-08-08 05:02:02.462308,epoch time: 0:29:48.599939,used: 3:58:39.724606,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9740019, 'precision': 0.9743741, 'recall': 0.97400403, 'specificity': 0.97400403, 'f1': 0.97399676, 'auroc': 0.9944811, 'binary_precision': 0.98770195, 'binary_recall': 0.9599644, 'binary_specificity': 0.98804367, 'binary_f1_score': 0.9736356}
confusion matrix:
       0      1
0  25535    309
1   1035  24817
---- Validation: 
scalar performance:
{'acc': 0.9678813, 'precision': 0.6819221, 'recall': 0.7316304, 'specificity': 0.7316304, 'f1': 0.7034803, 'auroc': 0.88063025, 'binary_precision': 0.37686568, 'binary_recall': 0.4832536, 'binary_specificity': 0.9800072, 'binary_f1_score': 0.4234801}
confusion matrix:
       0    1
0  16372  334
1    216  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9244946, 'precision': 0.74422455, 'recall': 0.61085916, 'specificity': 0.61085916, 'f1': 0.64636636, 'auroc': 0.85518384, 'binary_precision': 0.5507246, 'binary_recall': 0.23839398, 'binary_specificity': 0.98332435, 'binary_f1_score': 0.33274958}
confusion matrix:
      0    1
0  9140  155
1   607  190
new oracle model saved
early stop counter: 3
val acc:0.9678813219070435, best validation acc: 0.9776337146759033, corresponding to test acc:                         0.9228101372718811 / 0.9244946241378784
after epoch: 9,now: 2024-08-08 05:31:32.763082,epoch time: 0:29:30.300774,used: 4:28:10.025380,model: dset_te_center4_dann_b8efecac6_not_commited_2024md_08md_08_01_03_22_seed_2_24111560
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 4:28:10.025380 at 2024-08-08 05:31:32.763082
persisted model performance metric: 

scalar performance:
{'acc': 0.92281014, 'precision': 0.7335874, 'recall': 0.5824138, 'specificity': 0.5824138, 'f1': 0.6132139, 'auroc': 0.82843816, 'binary_precision': 0.5338346, 'binary_recall': 0.17816813, 'binary_specificity': 0.98665947, 'binary_f1_score': 0.2671684}
confusion matrix:
      0    1
0  9171  124
1   655  142
oracle model performance metric: 

scalar performance:
{'acc': 0.9244946, 'precision': 0.74422455, 'recall': 0.61085916, 'specificity': 0.61085916, 'f1': 0.64636636, 'auroc': 0.85518384, 'binary_precision': 0.5507246, 'binary_recall': 0.23839398, 'binary_specificity': 0.98332435, 'binary_f1_score': 0.33274958}
confusion matrix:
      0    1
0  9140  155
1   607  190
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_2024-08-07_17-53-28/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197429 KiB |   2142 MiB |   1055 TiB |   1055 TiB |
|       from large pool | 179211 KiB |   2124 MiB |   1041 TiB |   1041 TiB |
|       from small pool |  18218 KiB |     38 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197429 KiB |   2142 MiB |   1055 TiB |   1055 TiB |
|       from large pool | 179211 KiB |   2124 MiB |   1041 TiB |   1041 TiB |
|       from small pool |  18218 KiB |     38 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   2141 MiB |   1055 TiB |   1055 TiB |
|       from large pool | 178979 KiB |   2123 MiB |   1041 TiB |   1041 TiB |
|       from small pool |  16662 KiB |     36 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2362 MiB |   2372 MiB |   6606 MiB |   4244 MiB |
|       from large pool |   2324 MiB |   2330 MiB |   6546 MiB |   4222 MiB |
|       from small pool |     38 MiB |     42 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42187 KiB | 233721 KiB | 578177 GiB | 578177 GiB |
|       from large pool |  31733 KiB | 231736 KiB | 563862 GiB | 563862 GiB |
|       from small pool |  10454 KiB |  26061 KiB |  14314 GiB |  14314 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4432    |    6957    |  164221 K  |  164217 K  |
|       from large pool |      79    |     252    |   98741 K  |   98741 K  |
|       from small pool |    4353    |    6877    |   65479 K  |   65475 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4432    |    6957    |  164221 K  |  164217 K  |
|       from large pool |      79    |     252    |   98741 K  |   98741 K  |
|       from small pool |    4353    |    6877    |   65479 K  |   65475 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     118    |     300    |     184    |
|       from large pool |      97    |      97    |     270    |     173    |
|       from small pool |      19    |      21    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    3247    |  111706 K  |  111706 K  |
|       from large pool |      11    |     101    |   76079 K  |   76079 K  |
|       from small pool |      29    |    3236    |   35626 K  |   35626 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB |   1055 TiB |   1055 TiB |
|       from large pool |  16640 KiB |   2124 MiB |   1041 TiB |   1041 TiB |
|       from small pool |      0 KiB |     38 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB |   1055 TiB |   1055 TiB |
|       from large pool |  16640 KiB |   2124 MiB |   1041 TiB |   1041 TiB |
|       from small pool |      0 KiB |     38 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB |   1055 TiB |   1055 TiB |
|       from large pool |  16640 KiB |   2123 MiB |   1041 TiB |   1041 TiB |
|       from small pool |      0 KiB |     36 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   2372 MiB |   6606 MiB |   6372 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   6546 MiB |   6340 MiB |
|       from small pool |  28672 KiB |     42 MiB |     60 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 233721 KiB | 578178 GiB | 578177 GiB |
|       from large pool |  30464 KiB | 231736 KiB | 563863 GiB | 563862 GiB |
|       from small pool |      0 KiB |  26061 KiB |  14315 GiB |  14315 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  164221 K  |  164221 K  |
|       from large pool |       2    |     252    |   98741 K  |   98741 K  |
|       from small pool |       0    |    6877    |   65479 K  |   65479 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  164221 K  |  164221 K  |
|       from large pool |       2    |     252    |   98741 K  |   98741 K  |
|       from small pool |       0    |    6877    |   65479 K  |   65479 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     118    |     300    |     276    |
|       from large pool |      10    |      97    |     270    |     260    |
|       from small pool |      14    |      21    |      30    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3247    |  111708 K  |  111708 K  |
|       from large pool |       3    |     101    |   76079 K  |   76079 K  |
|       from small pool |       0    |    3236    |   35628 K  |   35628 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  8 05:48:51 2024]
Finished job 0.
1 of 1 steps (100%) done
