Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 19:23:20 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716

 Experiment start at: 2024-08-09 19:36:38.343747
before training, model accuracy: 0.6347637176513672
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9699542, 'precision': 0.97027296, 'recall': 0.96996146, 'specificity': 0.96996146, 'f1': 0.9699494, 'auroc': 0.9944229, 'binary_precision': 0.9826552, 'binary_recall': 0.95683056, 'binary_specificity': 0.98309237, 'binary_f1_score': 0.96957093}
confusion matrix:
       0      1
0  24886    428
1   1094  24248
---- Validation: 
scalar performance:
{'acc': 0.967281, 'precision': 0.66651803, 'recall': 0.6918509, 'specificity': 0.6918509, 'f1': 0.6781932, 'auroc': 0.85576886, 'binary_precision': 0.34791666, 'binary_recall': 0.40240964, 'binary_specificity': 0.9812922, 'binary_f1_score': 0.37318438}
confusion matrix:
       0    1
0  16418  313
1    248  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9224837, 'precision': 0.71216017, 'recall': 0.6104632, 'specificity': 0.6104632, 'f1': 0.6409295, 'auroc': 0.87387115, 'binary_precision': 0.48445597, 'binary_recall': 0.24222799, 'binary_specificity': 0.9786984, 'binary_f1_score': 0.32297066}
confusion matrix:
      0    1
0  9143  199
1   585  187
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 20:00:50.466414,epoch time: 0:24:12.122667,used: 0:24:12.122667,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9685723, 'precision': 0.9690919, 'recall': 0.96856254, 'specificity': 0.96856254, 'f1': 0.9685631, 'auroc': 0.9971225, 'binary_precision': 0.95362693, 'binary_recall': 0.98508465, 'binary_specificity': 0.95204043, 'binary_f1_score': 0.96910053}
confusion matrix:
       0      1
0  24099   1214
1    378  24965
---- Validation: 
scalar performance:
{'acc': 0.95456666, 'precision': 0.6473541, 'recall': 0.8181037, 'specificity': 0.8181037, 'f1': 0.69729143, 'auroc': 0.90573967, 'binary_precision': 0.3030303, 'binary_recall': 0.67469877, 'binary_specificity': 0.9615086, 'binary_f1_score': 0.41822258}
confusion matrix:
       0    1
0  16087  644
1    135  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9186276, 'precision': 0.69668436, 'recall': 0.63333, 'specificity': 0.63333, 'f1': 0.6570481, 'auroc': 0.8865034, 'binary_precision': 0.44990176, 'binary_recall': 0.2966321, 'binary_specificity': 0.9700278, 'binary_f1_score': 0.35753316}
confusion matrix:
      0    1
0  9062  280
1   543  229
early stop counter: 1
val acc:0.9545666575431824, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 2,now: 2024-08-09 20:23:04.605986,epoch time: 0:22:14.139572,used: 0:46:26.262239,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95645136, 'precision': 0.9589612, 'recall': 0.9564353, 'specificity': 0.9564353, 'f1': 0.9563907, 'auroc': 0.9978394, 'binary_precision': 0.92512953, 'binary_recall': 0.9933304, 'binary_specificity': 0.9195402, 'binary_f1_score': 0.95801777}
confusion matrix:
       0      1
0  23280   2037
1    169  25170
---- Validation: 
scalar performance:
{'acc': 0.9196314, 'precision': 0.5974122, 'recall': 0.850725, 'specificity': 0.850725, 'f1': 0.6382326, 'auroc': 0.91437757, 'binary_precision': 0.2007458, 'binary_recall': 0.7783133, 'binary_specificity': 0.9231367, 'binary_f1_score': 0.31916997}
confusion matrix:
       0     1
0  15445  1286
1     92   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9213961, 'precision': 0.70381266, 'recall': 0.6021505, 'specificity': 0.6021505, 'f1': 0.6314031, 'auroc': 0.8856987, 'binary_precision': 0.4690027, 'binary_recall': 0.2253886, 'binary_specificity': 0.9789124, 'binary_f1_score': 0.30446193}
confusion matrix:
      0    1
0  9145  197
1   598  174
early stop counter: 2
val acc:0.9196314215660095, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 3,now: 2024-08-09 20:45:00.359983,epoch time: 0:21:55.753997,used: 1:08:22.016236,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96646005, 'precision': 0.96778107, 'recall': 0.9664444, 'specificity': 0.9664444, 'f1': 0.9664355, 'auroc': 0.9984381, 'binary_precision': 0.94307023, 'binary_recall': 0.99289745, 'binary_specificity': 0.9399913, 'binary_f1_score': 0.9673426}
confusion matrix:
       0      1
0  23794   1519
1    180  25163
---- Validation: 
scalar performance:
{'acc': 0.8992185, 'precision': 0.5761093, 'recall': 0.8214664, 'specificity': 0.8214664, 'f1': 0.6040423, 'auroc': 0.89338624, 'binary_precision': 0.15931499, 'binary_recall': 0.739759, 'binary_specificity': 0.90317374, 'binary_f1_score': 0.26216906}
confusion matrix:
       0     1
0  15111  1620
1    108   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91566145, 'precision': 0.6927308, 'recall': 0.6632141, 'specificity': 0.6632141, 'f1': 0.6763391, 'auroc': 0.8987508, 'binary_precision': 0.4372093, 'binary_recall': 0.36528498, 'binary_specificity': 0.9611432, 'binary_f1_score': 0.39802402}
confusion matrix:
      0    1
0  8979  363
1   490  282
early stop counter: 3
val acc:0.8992184996604919, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 4,now: 2024-08-09 21:06:40.250417,epoch time: 0:21:39.890434,used: 1:30:01.906670,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9497394, 'precision': 0.9534616, 'recall': 0.94971263, 'specificity': 0.94971263, 'f1': 0.9496339, 'auroc': 0.997587, 'binary_precision': 0.9125258, 'binary_recall': 0.9949098, 'binary_specificity': 0.90451545, 'binary_f1_score': 0.9519386}
confusion matrix:
       0      1
0  22896   2417
1    129  25214
---- Validation: 
scalar performance:
{'acc': 0.874373, 'precision': 0.56534183, 'recall': 0.83223426, 'specificity': 0.83223426, 'f1': 0.5822451, 'auroc': 0.89628845, 'binary_precision': 0.13664857, 'binary_recall': 0.7879518, 'binary_specificity': 0.87651664, 'binary_f1_score': 0.23290601}
confusion matrix:
       0     1
0  14665  2066
1     88   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918331, 'precision': 0.6715888, 'recall': 0.5695957, 'specificity': 0.5695957, 'f1': 0.5924611, 'auroc': 0.8877987, 'binary_precision': 0.40939596, 'binary_recall': 0.15803109, 'binary_specificity': 0.98116034, 'binary_f1_score': 0.22803739}
confusion matrix:
      0    1
0  9166  176
1   650  122
early stop counter: 4
val acc:0.8743730187416077, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 5,now: 2024-08-09 21:28:25.929027,epoch time: 0:21:45.678610,used: 1:51:47.585280,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9598665, 'precision': 0.9622058, 'recall': 0.95984554, 'specificity': 0.95984554, 'f1': 0.9598143, 'auroc': 0.9983814, 'binary_precision': 0.9294716, 'binary_recall': 0.9953044, 'binary_specificity': 0.9243867, 'binary_f1_score': 0.9612621}
confusion matrix:
       0      1
0  23399   1914
1    119  25224
---- Validation: 
scalar performance:
{'acc': 0.8841129, 'precision': 0.5640184, 'recall': 0.79845214, 'specificity': 0.79845214, 'f1': 0.5828508, 'auroc': 0.8826832, 'binary_precision': 0.13611111, 'binary_recall': 0.70843375, 'binary_specificity': 0.88847053, 'binary_f1_score': 0.2283495}
confusion matrix:
       0     1
0  14865  1866
1    121   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92011076, 'precision': 0.6730087, 'recall': 0.5503581, 'specificity': 0.5503581, 'f1': 0.56843734, 'auroc': 0.8755865, 'binary_precision': 0.41509435, 'binary_recall': 0.11398964, 'binary_specificity': 0.9867266, 'binary_f1_score': 0.1788618}
confusion matrix:
      0    1
0  9218  124
1   684   88
early stop counter: 5
val acc:0.8841128945350647, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 6,now: 2024-08-09 21:49:57.775876,epoch time: 0:21:31.846849,used: 2:13:19.432129,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97662663, 'precision': 0.9772334, 'recall': 0.97661614, 'specificity': 0.97661614, 'f1': 0.97661877, 'auroc': 0.99900854, 'binary_precision': 0.96036434, 'binary_recall': 0.99431795, 'binary_specificity': 0.9589144, 'binary_f1_score': 0.9770462}
confusion matrix:
       0      1
0  24273   1040
1    144  25199
---- Validation: 
scalar performance:
{'acc': 0.9188149, 'precision': 0.59119576, 'recall': 0.82210815, 'specificity': 0.82210815, 'f1': 0.6287046, 'auroc': 0.90317065, 'binary_precision': 0.18984127, 'binary_recall': 0.72048193, 'binary_specificity': 0.92373437, 'binary_f1_score': 0.3005025}
confusion matrix:
       0     1
0  15455  1276
1    116   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221871, 'precision': 0.65326595, 'recall': 0.5134567, 'specificity': 0.5134567, 'f1': 0.50845164, 'auroc': 0.88181067, 'binary_precision': 0.3809524, 'binary_recall': 0.031088082, 'binary_specificity': 0.9958253, 'binary_f1_score': 0.057485025}
confusion matrix:
      0   1
0  9303  39
1   748  24
early stop counter: 6
val acc:0.9188148975372314, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 7,now: 2024-08-09 22:11:48.057525,epoch time: 0:21:50.281649,used: 2:35:09.713778,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94942355, 'precision': 0.9534683, 'recall': 0.94939005, 'specificity': 0.94939005, 'f1': 0.9493079, 'auroc': 0.99812305, 'binary_precision': 0.91081864, 'binary_recall': 0.9964886, 'binary_specificity': 0.9022916, 'binary_f1_score': 0.95172966}
confusion matrix:
       0      1
0  22837   2473
1     89  25257
---- Validation: 
scalar performance:
{'acc': 0.84742796, 'precision': 0.54796505, 'recall': 0.77612984, 'specificity': 0.77612984, 'f1': 0.5489284, 'auroc': 0.8550626, 'binary_precision': 0.10456342, 'binary_recall': 0.70120484, 'binary_specificity': 0.8510549, 'binary_f1_score': 0.18198875}
confusion matrix:
       0     1
0  14239  2492
1    124   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92050624, 'precision': 0.64197874, 'recall': 0.5220532, 'specificity': 0.5220532, 'f1': 0.52446723, 'auroc': 0.8577539, 'binary_precision': 0.35714287, 'binary_recall': 0.051813472, 'binary_specificity': 0.9922929, 'binary_f1_score': 0.09049773}
confusion matrix:
      0   1
0  9270  72
1   732  40
early stop counter: 7
val acc:0.8474279642105103, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 8,now: 2024-08-09 22:32:37.339077,epoch time: 0:20:49.281552,used: 2:55:58.995330,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.938645, 'precision': 0.9448215, 'recall': 0.93861014, 'specificity': 0.93861014, 'f1': 0.93842787, 'auroc': 0.99718165, 'binary_precision': 0.8925532, 'binary_recall': 0.9974352, 'binary_specificity': 0.87978506, 'binary_f1_score': 0.9420841}
confusion matrix:
       0      1
0  22270   3043
1     65  25278
---- Validation: 
scalar performance:
{'acc': 0.854835, 'precision': 0.54609853, 'recall': 0.75172675, 'specificity': 0.75172675, 'f1': 0.54852307, 'auroc': 0.8462801, 'binary_precision': 0.1023773, 'binary_recall': 0.6433735, 'binary_specificity': 0.86008006, 'binary_f1_score': 0.17664573}
confusion matrix:
       0     1
0  14390  2341
1    148   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9206051, 'precision': 0.6216813, 'recall': 0.5143828, 'specificity': 0.5143828, 'f1': 0.51077837, 'auroc': 0.7782086, 'binary_precision': 0.31764707, 'binary_recall': 0.034974094, 'binary_specificity': 0.99379146, 'binary_f1_score': 0.0630105}
confusion matrix:
      0   1
0  9284  58
1   745  27
early stop counter: 8
val acc:0.8548349738121033, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 9,now: 2024-08-09 22:53:15.193257,epoch time: 0:20:37.854180,used: 3:16:36.849510,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94083625, 'precision': 0.9467006, 'recall': 0.9408001, 'specificity': 0.9408001, 'f1': 0.94063807, 'auroc': 0.9983045, 'binary_precision': 0.8956762, 'binary_recall': 0.9979877, 'binary_specificity': 0.8836125, 'binary_f1_score': 0.9440681}
confusion matrix:
       0      1
0  22366   2946
1     51  25293
---- Validation: 
scalar performance:
{'acc': 0.8275983, 'precision': 0.5462526, 'recall': 0.79534245, 'specificity': 0.79534245, 'f1': 0.5399343, 'auroc': 0.86787707, 'binary_precision': 0.099590294, 'binary_recall': 0.76144576, 'binary_specificity': 0.82923913, 'binary_f1_score': 0.1761427}
confusion matrix:
       0     1
0  13874  2857
1     99   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9158592, 'precision': 0.6007207, 'recall': 0.5242908, 'specificity': 0.5242908, 'f1': 0.52861804, 'auroc': 0.8445993, 'binary_precision': 0.2742857, 'binary_recall': 0.062176164, 'binary_specificity': 0.9864055, 'binary_f1_score': 0.10137275}
confusion matrix:
      0    1
0  9215  127
1   724   48
early stop counter: 9
val acc:0.8275982737541199, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 10,now: 2024-08-09 23:14:07.225404,epoch time: 0:20:52.032147,used: 3:37:28.881657,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9449818, 'precision': 0.94997776, 'recall': 0.9449549, 'specificity': 0.9449549, 'f1': 0.94482636, 'auroc': 0.9985794, 'binary_precision': 0.9026925, 'binary_recall': 0.99755335, 'binary_specificity': 0.89235634, 'binary_f1_score': 0.94775516}
confusion matrix:
       0      1
0  22590   2725
1     62  25279
---- Validation: 
scalar performance:
{'acc': 0.85069406, 'precision': 0.54690117, 'recall': 0.7637042, 'specificity': 0.7637042, 'f1': 0.54842055, 'auroc': 0.8557459, 'binary_precision': 0.103218645, 'binary_recall': 0.67228913, 'binary_specificity': 0.8551192, 'binary_f1_score': 0.17896086}
confusion matrix:
       0     1
0  14307  2424
1    136   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90587306, 'precision': 0.56975615, 'recall': 0.52957976, 'specificity': 0.52957976, 'f1': 0.5360214, 'auroc': 0.79660696, 'binary_precision': 0.21153846, 'binary_recall': 0.08549223, 'binary_specificity': 0.9736673, 'binary_f1_score': 0.121771224}
confusion matrix:
      0    1
0  9096  246
1   706   66
early stop counter: 10
val acc:0.8506940603256226, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 11,now: 2024-08-09 23:34:23.305697,epoch time: 0:20:16.080293,used: 3:57:44.961950,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9398294, 'precision': 0.9458592, 'recall': 0.9397905, 'specificity': 0.9397905, 'f1': 0.9396216, 'auroc': 0.9983723, 'binary_precision': 0.8941767, 'binary_recall': 0.99783, 'binary_specificity': 0.881751, 'binary_f1_score': 0.9431641}
confusion matrix:
       0      1
0  22318   2993
1     55  25290
---- Validation: 
scalar performance:
{'acc': 0.8396127, 'precision': 0.54152477, 'recall': 0.7451018, 'specificity': 0.7451018, 'f1': 0.53721184, 'auroc': 0.838871, 'binary_precision': 0.09334727, 'binary_recall': 0.6457831, 'binary_specificity': 0.84442055, 'binary_f1_score': 0.16311625}
confusion matrix:
       0     1
0  14128  2603
1    147   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9141784, 'precision': 0.57680804, 'recall': 0.51862776, 'specificity': 0.51862776, 'f1': 0.5196837, 'auroc': 0.7862427, 'binary_precision': 0.22727273, 'binary_recall': 0.051813472, 'binary_specificity': 0.9854421, 'binary_f1_score': 0.08438819}
confusion matrix:
      0    1
0  9206  136
1   732   40
early stop counter: 11
val acc:0.8396127223968506, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 12,now: 2024-08-09 23:55:00.488001,epoch time: 0:20:37.182304,used: 4:18:22.144254,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9525821, 'precision': 0.9564624, 'recall': 0.9525531, 'specificity': 0.9525531, 'f1': 0.95247895, 'auroc': 0.998999, 'binary_precision': 0.91453457, 'binary_recall': 0.9985401, 'binary_specificity': 0.9065661, 'binary_f1_score': 0.9546929}
confusion matrix:
       0      1
0  22947   2365
1     37  25307
---- Validation: 
scalar performance:
{'acc': 0.83914614, 'precision': 0.5529261, 'recall': 0.8247583, 'specificity': 0.8247583, 'f1': 0.55327636, 'auroc': 0.89047533, 'binary_precision': 0.11144279, 'binary_recall': 0.80963856, 'binary_specificity': 0.8398781, 'binary_f1_score': 0.19591837}
confusion matrix:
       0     1
0  14052  2679
1     79   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92119837, 'precision': 0.6164295, 'recall': 0.5105449, 'specificity': 0.5105449, 'f1': 0.5033441, 'auroc': 0.81541574, 'binary_precision': 0.30769232, 'binary_recall': 0.025906736, 'binary_specificity': 0.99518305, 'binary_f1_score': 0.047789723}
confusion matrix:
      0   1
0  9297  45
1   752  20
early stop counter: 12
val acc:0.8391461372375488, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 13,now: 2024-08-10 00:15:10.398626,epoch time: 0:20:09.910625,used: 4:38:32.054879,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92222047, 'precision': 0.93243694, 'recall': 0.9221841, 'specificity': 0.9221841, 'f1': 0.92175376, 'auroc': 0.99641097, 'binary_precision': 0.8660873, 'binary_recall': 0.99897397, 'binary_specificity': 0.8453942, 'binary_f1_score': 0.9277965}
confusion matrix:
       0      1
0  21402   3914
1     26  25314
---- Validation: 
scalar performance:
{'acc': 0.7751079, 'precision': 0.53500557, 'recall': 0.76844627, 'specificity': 0.76844627, 'f1': 0.5057207, 'auroc': 0.83501005, 'binary_precision': 0.07758409, 'binary_recall': 0.76144576, 'binary_specificity': 0.7754468, 'binary_f1_score': 0.14081995}
confusion matrix:
       0     1
0  12974  3757
1     99   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91081667, 'precision': 0.5338732, 'recall': 0.50848997, 'specificity': 0.50848997, 'f1': 0.5038543, 'auroc': 0.72607416, 'binary_precision': 0.14285715, 'binary_recall': 0.033678755, 'binary_specificity': 0.9833012, 'binary_f1_score': 0.054507338}
confusion matrix:
      0    1
0  9186  156
1   746   26
early stop counter: 13
val acc:0.7751079201698303, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 14,now: 2024-08-10 00:35:28.722287,epoch time: 0:20:18.323661,used: 4:58:50.378540,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93631554, 'precision': 0.9431039, 'recall': 0.9362765, 'specificity': 0.9362765, 'f1': 0.93606675, 'auroc': 0.9970554, 'binary_precision': 0.8884167, 'binary_recall': 0.9980666, 'binary_specificity': 0.8744864, 'binary_f1_score': 0.940055}
confusion matrix:
       0      1
0  22135   3177
1     49  25295
---- Validation: 
scalar performance:
{'acc': 0.8154672, 'precision': 0.53597623, 'recall': 0.7362544, 'specificity': 0.7362544, 'f1': 0.52140164, 'auroc': 0.8281772, 'binary_precision': 0.08234579, 'binary_recall': 0.65301204, 'binary_specificity': 0.81949675, 'binary_f1_score': 0.14624932}
confusion matrix:
       0     1
0  13711  3020
1    144   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197152, 'precision': 0.52679294, 'recall': 0.50201815, 'specificity': 0.50201815, 'f1': 0.48754892, 'auroc': 0.7474605, 'binary_precision': 0.12962963, 'binary_recall': 0.0090673575, 'binary_specificity': 0.99496895, 'binary_f1_score': 0.016949153}
confusion matrix:
      0   1
0  9295  47
1   765   7
early stop counter: 14
val acc:0.8154671788215637, best validation acc: 0.9672809839248657, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 15,now: 2024-08-10 00:56:04.877327,epoch time: 0:20:36.155040,used: 5:19:26.533580,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_36_37_seed_0_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:19:26.533580 at 2024-08-10 00:56:04.877327
persisted model performance metric: 

scalar performance:
{'acc': 0.9224837, 'precision': 0.71216017, 'recall': 0.6104632, 'specificity': 0.6104632, 'f1': 0.6409295, 'auroc': 0.87387115, 'binary_precision': 0.48445597, 'binary_recall': 0.24222799, 'binary_specificity': 0.9786984, 'binary_f1_score': 0.32297066}
confusion matrix:
      0    1
0  9143  199
1   585  187
oracle model performance metric: 

scalar performance:
{'acc': 0.9224837, 'precision': 0.71216017, 'recall': 0.6104632, 'specificity': 0.6104632, 'f1': 0.6409295, 'auroc': 0.87387115, 'binary_precision': 0.48445597, 'binary_recall': 0.24222799, 'binary_specificity': 0.9786984, 'binary_f1_score': 0.32297066}
confusion matrix:
      0    1
0  9143  199
1   585  187
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493870 KiB |  10995 MiB | 335649 GiB | 335648 GiB |
|       from large pool | 403328 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |  90542 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493870 KiB |  10995 MiB | 335649 GiB | 335648 GiB |
|       from large pool | 403328 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |  90542 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476753 KiB |  10880 MiB | 332150 GiB | 332149 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 331243 GiB | 331242 GiB |
|       from small pool |  88913 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11490 MiB |  11490 MiB |  11490 MiB |      0 B   |
|       from large pool |  11362 MiB |  11362 MiB |  11362 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 751313 KiB |   1257 MiB | 127121 GiB | 127120 GiB |
|       from large pool | 741504 KiB |   1255 MiB | 126061 GiB | 126060 GiB |
|       from small pool |   9809 KiB |     10 MiB |   1060 GiB |   1060 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5175    |    7578    |   56672 K  |   56666 K  |
|       from large pool |      87    |     908    |   21002 K  |   21002 K  |
|       from small pool |    5088    |    7489    |   35669 K  |   35664 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5175    |    7578    |   56672 K  |   56666 K  |
|       from large pool |      87    |     908    |   21002 K  |   21002 K  |
|       from small pool |    5088    |    7489    |   35669 K  |   35664 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     408    |     408    |       0    |
|       from large pool |     344    |     344    |     344    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3196    |   30672 K  |   30672 K  |
|       from large pool |      19    |     189    |   13629 K  |   13629 K  |
|       from small pool |      56    |    3175    |   17043 K  |   17043 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |      0 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11490 MiB |  11490 MiB |  10274 MiB |
|       from large pool |   1118 MiB |  11362 MiB |  11362 MiB |  10244 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1257 MiB | 127121 GiB | 127121 GiB |
|       from large pool |  50944 KiB |   1255 MiB | 126061 GiB | 126061 GiB |
|       from small pool |      0 KiB |     30 MiB |   1060 GiB |   1060 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56672 K  |   56672 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35669 K  |   35669 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56672 K  |   56672 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35669 K  |   35669 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     408    |     408    |     329    |
|       from large pool |      30    |     344    |     344    |     314    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3196    |   30674 K  |   30674 K  |
|       from large pool |       4    |     189    |   13629 K  |   13629 K  |
|       from small pool |       0    |    3175    |   17045 K  |   17045 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |      0 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11490 MiB |  11490 MiB |  10274 MiB |
|       from large pool |   1118 MiB |  11362 MiB |  11362 MiB |  10244 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1257 MiB | 127121 GiB | 127121 GiB |
|       from large pool |  50944 KiB |   1255 MiB | 126061 GiB | 126061 GiB |
|       from small pool |      0 KiB |     30 MiB |   1060 GiB |   1060 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56672 K  |   56672 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35669 K  |   35669 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56672 K  |   56672 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35669 K  |   35669 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     408    |     408    |     329    |
|       from large pool |      30    |     344    |     344    |     314    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3196    |   30674 K  |   30674 K  |
|       from large pool |       4    |     189    |   13629 K  |   13629 K  |
|       from small pool |       0    |    3175    |   17045 K  |   17045 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716

 Experiment start at: 2024-08-10 01:24:46.666694
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.961658, 'precision': 0.9616711, 'recall': 0.9616598, 'specificity': 0.9616598, 'f1': 0.9616579, 'auroc': 0.9927732, 'binary_precision': 0.96429276, 'binary_recall': 0.9588707, 'binary_specificity': 0.9644488, 'binary_f1_score': 0.96157414}
confusion matrix:
       0      1
0  24497    903
1   1046  24386
---- Validation: 
scalar performance:
{'acc': 0.941015, 'precision': 0.60532576, 'recall': 0.7459786, 'specificity': 0.7459786, 'f1': 0.64244866, 'auroc': 0.8262831, 'binary_precision': 0.2229665, 'binary_recall': 0.5406032, 'binary_specificity': 0.95135397, 'binary_f1_score': 0.31571814}
confusion matrix:
       0    1
0  15880  812
1    198  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221088, 'precision': 0.7131212, 'recall': 0.67202973, 'specificity': 0.67202973, 'f1': 0.68972623, 'auroc': 0.894784, 'binary_precision': 0.47587353, 'binary_recall': 0.37780714, 'binary_specificity': 0.9662524, 'binary_f1_score': 0.42120764}
confusion matrix:
      0    1
0  9019  315
1   471  286
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 01:49:02.877299,epoch time: 0:24:16.210605,used: 0:24:16.210605,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94761175, 'precision': 0.95025635, 'recall': 0.94758165, 'specificity': 0.94758165, 'f1': 0.9475323, 'auroc': 0.995623, 'binary_precision': 0.91594523, 'binary_recall': 0.9857682, 'binary_specificity': 0.90939516, 'binary_f1_score': 0.94957495}
confusion matrix:
       0      1
0  23095   2301
1    362  25074
---- Validation: 
scalar performance:
{'acc': 0.8760731, 'precision': 0.56582934, 'recall': 0.8166419, 'specificity': 0.8166419, 'f1': 0.5835335, 'auroc': 0.87613916, 'binary_precision': 0.13882956, 'binary_recall': 0.7540603, 'binary_specificity': 0.8792236, 'binary_f1_score': 0.23448774}
confusion matrix:
       0     1
0  14676  2016
1    106   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92032504, 'precision': 0.6872864, 'recall': 0.59459186, 'specificity': 0.59459186, 'f1': 0.6212552, 'auroc': 0.8994428, 'binary_precision': 0.4359673, 'binary_recall': 0.21136063, 'binary_specificity': 0.977823, 'binary_f1_score': 0.2846975}
confusion matrix:
      0    1
0  9127  207
1   597  160
early stop counter: 1
val acc:0.8760731220245361, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9221088290214539
after epoch: 2,now: 2024-08-10 02:09:53.332126,epoch time: 0:20:50.454827,used: 0:45:06.665432,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9507987, 'precision': 0.9535761, 'recall': 0.950765, 'specificity': 0.950765, 'f1': 0.95072067, 'auroc': 0.9964346, 'binary_precision': 0.91829884, 'binary_recall': 0.9897398, 'binary_specificity': 0.9117902, 'binary_f1_score': 0.95268184}
confusion matrix:
       0      1
0  23154   2240
1    261  25177
---- Validation: 
scalar performance:
{'acc': 0.8812124, 'precision': 0.56913376, 'recall': 0.8226684, 'specificity': 0.8226684, 'f1': 0.58970463, 'auroc': 0.87006164, 'binary_precision': 0.14519699, 'binary_recall': 0.7610209, 'binary_specificity': 0.88431585, 'binary_f1_score': 0.24386618}
confusion matrix:
       0     1
0  14761  1931
1    103   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92339706, 'precision': 0.6017432, 'recall': 0.50521225, 'specificity': 0.50521225, 'f1': 0.49267638, 'auroc': 0.84924066, 'binary_precision': 0.2777778, 'binary_recall': 0.01321004, 'binary_specificity': 0.9972145, 'binary_f1_score': 0.025220683}
confusion matrix:
      0   1
0  9308  26
1   747  10
new oracle model saved
early stop counter: 2
val acc:0.8812124133110046, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9233970642089844
after epoch: 3,now: 2024-08-10 02:32:01.559760,epoch time: 0:22:08.227634,used: 1:07:14.893066,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94948065, 'precision': 0.9528272, 'recall': 0.9494469, 'specificity': 0.9494469, 'f1': 0.94938445, 'auroc': 0.9967556, 'binary_precision': 0.91409534, 'binary_recall': 0.9922944, 'binary_specificity': 0.90659946, 'binary_f1_score': 0.951591}
confusion matrix:
       0      1
0  23024   2372
1    196  25240
---- Validation: 
scalar performance:
{'acc': 0.8815628, 'precision': 0.5700882, 'recall': 0.8273686, 'specificity': 0.8273686, 'f1': 0.59119296, 'auroc': 0.87479466, 'binary_precision': 0.14683768, 'binary_recall': 0.77030164, 'binary_specificity': 0.88443565, 'binary_f1_score': 0.24665676}
confusion matrix:
       0     1
0  14763  1929
1     99   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92468536, 'precision': 0.673344, 'recall': 0.50469476, 'specificity': 0.50469476, 'f1': 0.4907277, 'auroc': 0.8639452, 'binary_precision': 0.42105263, 'binary_recall': 0.010568032, 'binary_specificity': 0.9988215, 'binary_f1_score': 0.020618558}
confusion matrix:
      0   1
0  9323  11
1   749   8
new oracle model saved
early stop counter: 3
val acc:0.8815628290176392, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9246853590011597
after epoch: 4,now: 2024-08-10 02:54:12.235462,epoch time: 0:22:10.675702,used: 1:29:25.568768,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9692713, 'precision': 0.96997833, 'recall': 0.96925545, 'specificity': 0.96925545, 'f1': 0.969259, 'auroc': 0.9978759, 'binary_precision': 0.9519555, 'binary_recall': 0.98848134, 'binary_specificity': 0.95002955, 'binary_f1_score': 0.9698747}
confusion matrix:
       0      1
0  24126   1269
1    293  25144
---- Validation: 
scalar performance:
{'acc': 0.91169775, 'precision': 0.5867616, 'recall': 0.81570184, 'specificity': 0.81570184, 'f1': 0.62119865, 'auroc': 0.87918603, 'binary_precision': 0.18149675, 'binary_recall': 0.7146172, 'binary_specificity': 0.9167865, 'binary_f1_score': 0.28947368}
confusion matrix:
       0     1
0  15303  1389
1    123   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92488354, 'precision': 0.4624876, 'recall': 0.49994645, 'specificity': 0.49994645, 'f1': 0.48048806, 'auroc': 0.82617205, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9333  1
1   757  0
new oracle model saved
early stop counter: 4
val acc:0.9116977453231812, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9248835444450378
after epoch: 5,now: 2024-08-10 03:15:50.051465,epoch time: 0:21:37.816003,used: 1:51:03.384771,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9663598, 'precision': 0.9675655, 'recall': 0.96633697, 'specificity': 0.96633697, 'f1': 0.96633685, 'auroc': 0.9979348, 'binary_precision': 0.94404733, 'binary_recall': 0.9915484, 'binary_specificity': 0.9411255, 'binary_f1_score': 0.96721506}
confusion matrix:
       0      1
0  23898   1495
1    215  25224
---- Validation: 
scalar performance:
{'acc': 0.8966303, 'precision': 0.5734659, 'recall': 0.80119276, 'specificity': 0.80119276, 'f1': 0.59944415, 'auroc': 0.8761842, 'binary_precision': 0.15542975, 'binary_recall': 0.70069605, 'binary_specificity': 0.9016894, 'binary_f1_score': 0.2544229}
confusion matrix:
       0     1
0  15051  1641
1    129   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92468536, 'precision': 0.6549987, 'recall': 0.50287396, 'specificity': 0.50287396, 'f1': 0.48691797, 'auroc': 0.8763014, 'binary_precision': 0.3846154, 'binary_recall': 0.00660502, 'binary_specificity': 0.99914294, 'binary_f1_score': 0.012987013}
confusion matrix:
      0  1
0  9326  8
1   752  5
early stop counter: 5
val acc:0.8966302871704102, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9248835444450378
after epoch: 6,now: 2024-08-10 03:36:41.471554,epoch time: 0:20:51.420089,used: 2:11:54.804860,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9453494, 'precision': 0.9497725, 'recall': 0.9453124, 'specificity': 0.9453124, 'f1': 0.9452115, 'auroc': 0.9966923, 'binary_precision': 0.9053566, 'binary_recall': 0.994771, 'binary_specificity': 0.8958538, 'binary_f1_score': 0.94795996}
confusion matrix:
       0      1
0  22752   2645
1    133  25302
---- Validation: 
scalar performance:
{'acc': 0.8558664, 'precision': 0.5530809, 'recall': 0.78254485, 'specificity': 0.78254485, 'f1': 0.5592403, 'auroc': 0.85270983, 'binary_precision': 0.11493384, 'binary_recall': 0.70533645, 'binary_specificity': 0.8597532, 'binary_f1_score': 0.1976593}
confusion matrix:
       0     1
0  14351  2341
1    127   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.7631433, 'recall': 0.5093719, 'specificity': 0.5093719, 'f1': 0.49980012, 'auroc': 0.829265, 'binary_precision': 0.6, 'binary_recall': 0.01981506, 'binary_specificity': 0.99892867, 'binary_f1_score': 0.03836317}
confusion matrix:
      0   1
0  9324  10
1   742  15
new oracle model saved
early stop counter: 6
val acc:0.8558663725852966, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9254781603813171
after epoch: 7,now: 2024-08-10 03:57:13.526675,epoch time: 0:20:32.055121,used: 2:32:26.859981,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9263456, 'precision': 0.9352681, 'recall': 0.9262866, 'specificity': 0.9262866, 'f1': 0.9259592, 'auroc': 0.99698186, 'binary_precision': 0.8731551, 'binary_recall': 0.99775916, 'binary_specificity': 0.85481393, 'binary_f1_score': 0.93130785}
confusion matrix:
       0      1
0  21708   3687
1     57  25380
---- Validation: 
scalar performance:
{'acc': 0.7884132, 'precision': 0.5414745, 'recall': 0.79654336, 'specificity': 0.79654336, 'f1': 0.5198533, 'auroc': 0.8513528, 'binary_precision': 0.0892949, 'binary_recall': 0.80510443, 'binary_specificity': 0.7879823, 'binary_f1_score': 0.16075979}
confusion matrix:
       0     1
0  13153  3539
1     84   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92637, 'precision': 0.88826084, 'recall': 0.51106787, 'specificity': 0.51106787, 'f1': 0.5027345, 'auroc': 0.73404765, 'binary_precision': 0.85, 'binary_recall': 0.022457067, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.043758042}
confusion matrix:
      0   1
0  9331   3
1   740  17
new oracle model saved
early stop counter: 7
val acc:0.7884132266044617, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9263700246810913
after epoch: 8,now: 2024-08-10 04:17:00.537522,epoch time: 0:19:47.010847,used: 2:52:13.870828,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92370945, 'precision': 0.9330896, 'recall': 0.92365164, 'specificity': 0.92365164, 'f1': 0.92328703, 'auroc': 0.99611783, 'binary_precision': 0.8695488, 'binary_recall': 0.99713004, 'binary_specificity': 0.85017323, 'binary_f1_score': 0.9289795}
confusion matrix:
       0      1
0  21591   3805
1     73  25363
---- Validation: 
scalar performance:
{'acc': 0.8250307, 'precision': 0.5404012, 'recall': 0.74638635, 'specificity': 0.74638635, 'f1': 0.5313271, 'auroc': 0.81235445, 'binary_precision': 0.09116991, 'binary_recall': 0.6635731, 'binary_specificity': 0.8291996, 'binary_f1_score': 0.1603139}
confusion matrix:
       0     1
0  13841  2851
1    145   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9247845, 'precision': 0.70747495, 'recall': 0.5223494, 'specificity': 0.5223494, 'f1': 0.52480435, 'auroc': 0.7460232, 'binary_precision': 0.4868421, 'binary_recall': 0.048877146, 'binary_specificity': 0.9958217, 'binary_f1_score': 0.08883554}
confusion matrix:
      0   1
0  9295  39
1   720  37
early stop counter: 8
val acc:0.8250306844711304, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9263700246810913
after epoch: 9,now: 2024-08-10 04:37:00.999113,epoch time: 0:20:00.461591,used: 3:12:14.332419,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91288954, 'precision': 0.9251508, 'recall': 0.9128228, 'specificity': 0.9128228, 'f1': 0.9122475, 'auroc': 0.99534345, 'binary_precision': 0.85314685, 'binary_recall': 0.99764115, 'binary_specificity': 0.8280044, 'binary_f1_score': 0.91975355}
confusion matrix:
       0      1
0  21028   4368
1     60  25376
---- Validation: 
scalar performance:
{'acc': 0.71091515, 'precision': 0.5316182, 'recall': 0.77374583, 'specificity': 0.77374583, 'f1': 0.47717655, 'auroc': 0.8272425, 'binary_precision': 0.06904444, 'binary_recall': 0.83990717, 'binary_specificity': 0.7075845, 'binary_f1_score': 0.12759957}
confusion matrix:
       0     1
0  11811  4881
1     69   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9255772, 'precision': 0.7668031, 'recall': 0.5106393, 'specificity': 0.5106393, 'f1': 0.5022974, 'auroc': 0.7927904, 'binary_precision': 0.60714287, 'binary_recall': 0.022457067, 'binary_specificity': 0.9988215, 'binary_f1_score': 0.043312103}
confusion matrix:
      0   1
0  9323  11
1   740  17
early stop counter: 9
val acc:0.7109151482582092, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9263700246810913
after epoch: 10,now: 2024-08-10 04:57:13.891626,epoch time: 0:20:12.892513,used: 3:32:27.224932,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.910037, 'precision': 0.9232556, 'recall': 0.9099641, 'specificity': 0.9099641, 'f1': 0.90931845, 'auroc': 0.9953128, 'binary_precision': 0.8486631, 'binary_recall': 0.99823093, 'binary_specificity': 0.8216972, 'binary_f1_score': 0.91739076}
confusion matrix:
       0      1
0  20867   4528
1     45  25392
---- Validation: 
scalar performance:
{'acc': 0.7799451, 'precision': 0.5399737, 'recall': 0.7933301, 'specificity': 0.7933301, 'f1': 0.51469725, 'auroc': 0.837644, 'binary_precision': 0.086288124, 'binary_recall': 0.8074246, 'binary_specificity': 0.77923554, 'binary_f1_score': 0.15591398}
confusion matrix:
       0     1
0  13007  3685
1     83   348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9227034, 'precision': 0.64767253, 'recall': 0.51818985, 'specificity': 0.51818985, 'f1': 0.5177471, 'auroc': 0.8205764, 'binary_precision': 0.3678161, 'binary_recall': 0.04227213, 'binary_specificity': 0.99410754, 'binary_f1_score': 0.07582939}
confusion matrix:
      0   1
0  9279  55
1   725  32
early stop counter: 10
val acc:0.7799450755119324, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9263700246810913
after epoch: 11,now: 2024-08-10 05:17:12.428524,epoch time: 0:19:58.536898,used: 3:52:25.761830,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9174929, 'precision': 0.9285401, 'recall': 0.9174267, 'specificity': 0.9174267, 'f1': 0.9169489, 'auroc': 0.99502933, 'binary_precision': 0.859941, 'binary_recall': 0.9976019, 'binary_specificity': 0.8372514, 'binary_f1_score': 0.9236705}
confusion matrix:
       0      1
0  21262   4133
1     61  25376
---- Validation: 
scalar performance:
{'acc': 0.83040357, 'precision': 0.5323044, 'recall': 0.68698454, 'specificity': 0.68698454, 'f1': 0.52160674, 'auroc': 0.80423164, 'binary_precision': 0.07870528, 'binary_recall': 0.5359629, 'binary_specificity': 0.83800626, 'binary_f1_score': 0.13725491}
confusion matrix:
       0     1
0  13988  2704
1    200   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91299176, 'precision': 0.5584935, 'recall': 0.5159749, 'specificity': 0.5159749, 'f1': 0.5160366, 'auroc': 0.75473356, 'binary_precision': 0.1897436, 'binary_recall': 0.048877146, 'binary_specificity': 0.98307264, 'binary_f1_score': 0.07773109}
confusion matrix:
      0    1
0  9176  158
1   720   37
early stop counter: 11
val acc:0.8304035663604736, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9263700246810913
after epoch: 12,now: 2024-08-10 05:37:31.271290,epoch time: 0:20:18.842766,used: 4:12:44.604596,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9023647, 'precision': 0.9180388, 'recall': 0.9023037, 'specificity': 0.9023037, 'f1': 0.9014311, 'auroc': 0.9952089, 'binary_precision': 0.83724916, 'binary_recall': 0.9990563, 'binary_specificity': 0.8055512, 'binary_f1_score': 0.9110239}
confusion matrix:
       0      1
0  20461   4939
1     24  25408
---- Validation: 
scalar performance:
{'acc': 0.7388892, 'precision': 0.53494364, 'recall': 0.7858337, 'specificity': 0.7858337, 'f1': 0.4924105, 'auroc': 0.8229491, 'binary_precision': 0.075630255, 'binary_recall': 0.8352668, 'binary_specificity': 0.73640066, 'binary_f1_score': 0.13870162}
confusion matrix:
       0     1
0  12292  4400
1     71   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9023883, 'precision': 0.54640794, 'recall': 0.5217749, 'specificity': 0.5217749, 'f1': 0.52524275, 'auroc': 0.69907475, 'binary_precision': 0.16470589, 'binary_recall': 0.07397622, 'binary_specificity': 0.9695736, 'binary_f1_score': 0.102096625}
confusion matrix:
      0    1
0  9050  284
1   701   56
early stop counter: 12
val acc:0.738889217376709, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9263700246810913
after epoch: 13,now: 2024-08-10 05:57:17.028134,epoch time: 0:19:45.756844,used: 4:32:30.361440,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9091124, 'precision': 0.9226491, 'recall': 0.90903854, 'specificity': 0.90903854, 'f1': 0.9083678, 'auroc': 0.99599254, 'binary_precision': 0.8472162, 'binary_recall': 0.9984275, 'binary_specificity': 0.8196495, 'binary_f1_score': 0.9166276}
confusion matrix:
       0      1
0  20815   4580
1     40  25397
---- Validation: 
scalar performance:
{'acc': 0.7989254, 'precision': 0.53622466, 'recall': 0.7454282, 'specificity': 0.7454282, 'f1': 0.51658314, 'auroc': 0.8030687, 'binary_precision': 0.08236273, 'binary_recall': 0.68909514, 'binary_specificity': 0.8017613, 'binary_f1_score': 0.14713897}
confusion matrix:
       0     1
0  13383  3309
1    134   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9128927, 'precision': 0.58524776, 'recall': 0.52806, 'specificity': 0.52806, 'f1': 0.53449804, 'auroc': 0.740582, 'binary_precision': 0.24152543, 'binary_recall': 0.07529723, 'binary_specificity': 0.9808228, 'binary_f1_score': 0.11480363}
confusion matrix:
      0    1
0  9155  179
1   700   57
early stop counter: 13
val acc:0.7989253997802734, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9263700246810913
after epoch: 14,now: 2024-08-10 06:17:01.590477,epoch time: 0:19:44.562343,used: 4:52:14.923783,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8880823, 'precision': 0.90820295, 'recall': 0.887995, 'specificity': 0.887995, 'f1': 0.88666975, 'auroc': 0.99671555, 'binary_precision': 0.8177722, 'binary_recall': 0.9989385, 'binary_specificity': 0.7770515, 'binary_f1_score': 0.8993222}
confusion matrix:
       0      1
0  19734   5662
1     27  25409
---- Validation: 
scalar performance:
{'acc': 0.6728377, 'precision': 0.5279863, 'recall': 0.7576059, 'specificity': 0.7576059, 'f1': 0.4572998, 'auroc': 0.802408, 'binary_precision': 0.061853923, 'binary_recall': 0.84686774, 'binary_specificity': 0.66834414, 'binary_f1_score': 0.11528743}
confusion matrix:
       0     1
0  11156  5536
1     66   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9057576, 'precision': 0.54658884, 'recall': 0.5187407, 'specificity': 0.5187407, 'f1': 0.5209955, 'auroc': 0.7428422, 'binary_precision': 0.16551724, 'binary_recall': 0.06340819, 'binary_specificity': 0.9740733, 'binary_f1_score': 0.09169054}
confusion matrix:
      0    1
0  9092  242
1   709   48
early stop counter: 14
val acc:0.6728376746177673, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.9221088290214539 / 0.9263700246810913
after epoch: 15,now: 2024-08-10 06:36:39.266535,epoch time: 0:19:37.676058,used: 5:11:52.599841,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_01_24_46_seed_1_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:11:52.599841 at 2024-08-10 06:36:39.266535
persisted model performance metric: 

scalar performance:
{'acc': 0.9221088, 'precision': 0.7131212, 'recall': 0.67202973, 'specificity': 0.67202973, 'f1': 0.68972623, 'auroc': 0.894784, 'binary_precision': 0.47587353, 'binary_recall': 0.37780714, 'binary_specificity': 0.9662524, 'binary_f1_score': 0.42120764}
confusion matrix:
      0    1
0  9019  315
1   471  286
oracle model performance metric: 

scalar performance:
{'acc': 0.92637, 'precision': 0.88826084, 'recall': 0.51106787, 'specificity': 0.51106787, 'f1': 0.5027345, 'auroc': 0.73404765, 'binary_precision': 0.85, 'binary_recall': 0.022457067, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.043758042}
confusion matrix:
      0   1
0  9331   3
1   740  17
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493800 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool | 403264 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |  90536 KiB |    125 MiB |   1855 GiB |   1854 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493800 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool | 403264 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |  90536 KiB |    125 MiB |   1855 GiB |   1854 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10880 MiB | 669615 GiB | 669615 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 667781 GiB | 667781 GiB |
|       from small pool |  88912 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11506 MiB |  11506 MiB |  21780 MiB |  10274 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  21624 MiB |  10244 MiB |
|       from small pool |    126 MiB |    128 MiB |    156 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    807 MiB |   1335 MiB | 284463 GiB | 284462 GiB |
|       from large pool |    798 MiB |   1332 MiB | 282186 GiB | 282185 GiB |
|       from small pool |      9 MiB |     30 MiB |   2277 GiB |   2277 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7600    |  114013 K  |  114007 K  |
|       from large pool |      87    |     908    |   42321 K  |   42321 K  |
|       from small pool |    5076    |    7511    |   71691 K  |   71686 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7600    |  114013 K  |  114007 K  |
|       from large pool |      87    |     908    |   42321 K  |   42321 K  |
|       from small pool |    5076    |    7511    |   71691 K  |   71686 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     408    |     737    |     329    |
|       from large pool |     345    |     345    |     659    |     314    |
|       from small pool |      63    |      64    |      78    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3213    |   61237 K  |   61237 K  |
|       from large pool |      24    |     197    |   26772 K  |   26772 K  |
|       from small pool |      50    |    3187    |   34465 K  |   34464 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 669615 GiB | 669615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 667781 GiB | 667781 GiB |
|       from small pool |      0 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1290 MiB |  11506 MiB |  21780 MiB |  20490 MiB |
|       from large pool |   1192 MiB |  11380 MiB |  21624 MiB |  20432 MiB |
|       from small pool |     98 MiB |    128 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1335 MiB | 284463 GiB | 284463 GiB |
|       from large pool |  50944 KiB |   1332 MiB | 282186 GiB | 282186 GiB |
|       from small pool |      0 KiB |     30 MiB |   2277 GiB |   2277 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  114013 K  |  114013 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71691 K  |   71691 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  114013 K  |  114013 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71691 K  |   71691 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     408    |     737    |     653    |
|       from large pool |      35    |     345    |     659    |     624    |
|       from small pool |      49    |      64    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3213    |   61239 K  |   61239 K  |
|       from large pool |       4    |     197    |   26772 K  |   26772 K  |
|       from small pool |       0    |    3187    |   34467 K  |   34467 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 669615 GiB | 669615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 667781 GiB | 667781 GiB |
|       from small pool |      0 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1290 MiB |  11506 MiB |  21780 MiB |  20490 MiB |
|       from large pool |   1192 MiB |  11380 MiB |  21624 MiB |  20432 MiB |
|       from small pool |     98 MiB |    128 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1335 MiB | 284463 GiB | 284463 GiB |
|       from large pool |  50944 KiB |   1332 MiB | 282186 GiB | 282186 GiB |
|       from small pool |      0 KiB |     30 MiB |   2277 GiB |   2277 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  114013 K  |  114013 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71691 K  |   71691 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  114013 K  |  114013 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71691 K  |   71691 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     408    |     737    |     653    |
|       from large pool |      35    |     345    |     659    |     624    |
|       from small pool |      49    |      64    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3213    |   61239 K  |   61239 K  |
|       from large pool |       4    |     197    |   26772 K  |   26772 K  |
|       from small pool |       0    |    3187    |   34467 K  |   34467 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716

 Experiment start at: 2024-08-10 07:01:47.757572
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.972996, 'precision': 0.9733937, 'recall': 0.97299933, 'specificity': 0.97299933, 'f1': 0.9729904, 'auroc': 0.9954618, 'binary_precision': 0.98717237, 'binary_recall': 0.958459, 'binary_specificity': 0.98753965, 'binary_f1_score': 0.9726038}
confusion matrix:
       0      1
0  25520    322
1   1074  24780
---- Validation: 
scalar performance:
{'acc': 0.9637351, 'precision': 0.67150325, 'recall': 0.77965385, 'specificity': 0.77965385, 'f1': 0.7111519, 'auroc': 0.87339824, 'binary_precision': 0.35353535, 'binary_recall': 0.5861244, 'binary_specificity': 0.9731833, 'binary_f1_score': 0.44104412}
confusion matrix:
       0    1
0  16258  448
1    173  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9199366, 'precision': 0.72057414, 'recall': 0.6835211, 'specificity': 0.6835211, 'f1': 0.69981426, 'auroc': 0.8715553, 'binary_precision': 0.49157733, 'binary_recall': 0.40276036, 'binary_specificity': 0.96428186, 'binary_f1_score': 0.44275862}
confusion matrix:
      0    1
0  8963  332
1   476  321
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 07:22:49.263467,epoch time: 0:21:01.505895,used: 0:21:01.505895,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98243576, 'precision': 0.98251784, 'recall': 0.9824373, 'specificity': 0.9824373, 'f1': 0.98243505, 'auroc': 0.99768674, 'binary_precision': 0.98886883, 'binary_recall': 0.97586447, 'binary_specificity': 0.98901016, 'binary_f1_score': 0.9823236}
confusion matrix:
       0      1
0  25558    284
1    624  25230
---- Validation: 
scalar performance:
{'acc': 0.9613992, 'precision': 0.668113, 'recall': 0.808779, 'specificity': 0.808779, 'f1': 0.7152687, 'auroc': 0.89398843, 'binary_precision': 0.34522292, 'binary_recall': 0.6483254, 'binary_specificity': 0.9692326, 'binary_f1_score': 0.45054033}
confusion matrix:
       0    1
0  16192  514
1    147  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91845024, 'precision': 0.7012435, 'recall': 0.6012687, 'specificity': 0.6012687, 'f1': 0.629912, 'auroc': 0.8913015, 'binary_precision': 0.46614584, 'binary_recall': 0.22459222, 'binary_specificity': 0.97794515, 'binary_f1_score': 0.30313295}
confusion matrix:
      0    1
0  9090  205
1   618  179
early stop counter: 1
val acc:0.9613991975784302, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9199365973472595
after epoch: 2,now: 2024-08-10 07:42:58.596688,epoch time: 0:20:09.333221,used: 0:41:10.839116,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9636529, 'precision': 0.96507835, 'recall': 0.9636529, 'specificity': 0.9636529, 'f1': 0.9636251, 'auroc': 0.9978256, 'binary_precision': 0.93933064, 'binary_recall': 0.99133396, 'binary_specificity': 0.93597186, 'binary_f1_score': 0.964632}
confusion matrix:
       0      1
0  24193   1655
1    224  25624
---- Validation: 
scalar performance:
{'acc': 0.9004905, 'precision': 0.58005524, 'recall': 0.8358748, 'specificity': 0.8358748, 'f1': 0.61012185, 'auroc': 0.9064713, 'binary_precision': 0.16649377, 'binary_recall': 0.7679426, 'binary_specificity': 0.90380704, 'binary_f1_score': 0.27365726}
confusion matrix:
       0     1
0  15099  1607
1     97   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9182521, 'precision': 0.674741, 'recall': 0.5420844, 'specificity': 0.5420844, 'f1': 0.5563126, 'auroc': 0.8546814, 'binary_precision': 0.42222223, 'binary_recall': 0.09535759, 'binary_specificity': 0.9888112, 'binary_f1_score': 0.1555783}
confusion matrix:
      0    1
0  9191  104
1   721   76
early stop counter: 2
val acc:0.9004905223846436, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9199365973472595
after epoch: 3,now: 2024-08-10 08:03:03.286204,epoch time: 0:20:04.689516,used: 1:01:15.528632,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9429743, 'precision': 0.94801676, 'recall': 0.9429641, 'specificity': 0.9429641, 'f1': 0.94281244, 'auroc': 0.9979013, 'binary_precision': 0.9005351, 'binary_recall': 0.9959773, 'binary_specificity': 0.8899509, 'binary_f1_score': 0.9458546}
confusion matrix:
       0      1
0  22999   2844
1    104  25749
---- Validation: 
scalar performance:
{'acc': 0.7975356, 'precision': 0.5448631, 'recall': 0.8227616, 'specificity': 0.8227616, 'f1': 0.5273423, 'auroc': 0.90341306, 'binary_precision': 0.09444001, 'binary_recall': 0.8492823, 'binary_specificity': 0.79624087, 'binary_f1_score': 0.16997844}
confusion matrix:
       0     1
0  13302  3404
1     63   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91874754, 'precision': 0.65738887, 'recall': 0.5222787, 'specificity': 0.5222787, 'f1': 0.5241912, 'auroc': 0.8178116, 'binary_precision': 0.3904762, 'binary_recall': 0.05144291, 'binary_specificity': 0.9931146, 'binary_f1_score': 0.090909086}
confusion matrix:
      0   1
0  9231  64
1   756  41
early stop counter: 3
val acc:0.7975355982780457, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9199365973472595
after epoch: 4,now: 2024-08-10 08:23:04.987606,epoch time: 0:20:01.701402,used: 1:21:17.230034,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95566386, 'precision': 0.9584707, 'recall': 0.95566237, 'specificity': 0.95566237, 'f1': 0.9555958, 'auroc': 0.9982772, 'binary_precision': 0.9226077, 'binary_recall': 0.9947774, 'binary_specificity': 0.91654736, 'binary_f1_score': 0.95733434}
confusion matrix:
       0      1
0  23690   2157
1    135  25714
---- Validation: 
scalar performance:
{'acc': 0.86673677, 'precision': 0.5596314, 'recall': 0.81157815, 'specificity': 0.81157815, 'f1': 0.57176125, 'auroc': 0.8857056, 'binary_precision': 0.12630312, 'binary_recall': 0.7535885, 'binary_specificity': 0.8695678, 'binary_f1_score': 0.21634614}
confusion matrix:
       0     1
0  14527  2179
1    103   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92221564, 'precision': 0.7460408, 'recall': 0.5298971, 'specificity': 0.5298971, 'f1': 0.53715724, 'auroc': 0.84684026, 'binary_precision': 0.56666666, 'binary_recall': 0.06398996, 'binary_specificity': 0.9958042, 'binary_f1_score': 0.11499436}
confusion matrix:
      0   1
0  9256  39
1   746  51
new oracle model saved
early stop counter: 4
val acc:0.8667367696762085, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9222156405448914
after epoch: 5,now: 2024-08-10 08:43:14.013732,epoch time: 0:20:09.026126,used: 1:41:26.256160,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9455664, 'precision': 0.95029545, 'recall': 0.9455624, 'specificity': 0.9455624, 'f1': 0.94542277, 'auroc': 0.99837255, 'binary_precision': 0.9041687, 'binary_recall': 0.99678916, 'binary_specificity': 0.8943357, 'binary_f1_score': 0.9482226}
confusion matrix:
       0      1
0  23115   2731
1     83  25767
---- Validation: 
scalar performance:
{'acc': 0.8271432, 'precision': 0.5513731, 'recall': 0.83093834, 'specificity': 0.83093834, 'f1': 0.5470255, 'auroc': 0.8934903, 'binary_precision': 0.107716046, 'binary_recall': 0.8349282, 'binary_specificity': 0.8269484, 'binary_f1_score': 0.19081466}
confusion matrix:
       0     1
0  13815  2891
1     69   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9227111, 'precision': 0.7509336, 'recall': 0.53819585, 'specificity': 0.53819585, 'f1': 0.5511941, 'auroc': 0.80585194, 'binary_precision': 0.57522124, 'binary_recall': 0.081555836, 'binary_specificity': 0.9948359, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  9247  48
1   732  65
new oracle model saved
early stop counter: 5
val acc:0.8271431922912598, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 6,now: 2024-08-10 09:03:08.601249,epoch time: 0:19:54.587517,used: 2:01:20.843677,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9578884, 'precision': 0.96033335, 'recall': 0.95788, 'specificity': 0.95788, 'f1': 0.95783186, 'auroc': 0.9982188, 'binary_precision': 0.92684335, 'binary_recall': 0.99427557, 'binary_specificity': 0.9214844, 'binary_f1_score': 0.959376}
confusion matrix:
       0      1
0  23813   2029
1    148  25706
---- Validation: 
scalar performance:
{'acc': 0.8791754, 'precision': 0.56069595, 'recall': 0.788797, 'specificity': 0.788797, 'f1': 0.57673687, 'auroc': 0.8819398, 'binary_precision': 0.12998655, 'binary_recall': 0.6937799, 'binary_specificity': 0.8838142, 'binary_f1_score': 0.21895054}
confusion matrix:
       0     1
0  14765  1941
1    128   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92132384, 'precision': 0.860692, 'recall': 0.5024556, 'specificity': 0.5024556, 'f1': 0.48450464, 'auroc': 0.8486075, 'binary_precision': 0.8, 'binary_recall': 0.0050188205, 'binary_specificity': 0.9998924, 'binary_f1_score': 0.009975062}
confusion matrix:
      0  1
0  9294  1
1   793  4
early stop counter: 6
val acc:0.8791754245758057, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 7,now: 2024-08-10 09:23:11.229831,epoch time: 0:20:02.628582,used: 2:21:23.472259,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94823587, 'precision': 0.95238316, 'recall': 0.9482322, 'specificity': 0.9482322, 'f1': 0.94811666, 'auroc': 0.998271, 'binary_precision': 0.9090877, 'binary_recall': 0.99609286, 'binary_specificity': 0.90037143, 'binary_f1_score': 0.9506036}
confusion matrix:
       0      1
0  23271   2575
1    101  25749
---- Validation: 
scalar performance:
{'acc': 0.8680799, 'precision': 0.54446137, 'recall': 0.71780086, 'specificity': 0.71780086, 'f1': 0.54997534, 'auroc': 0.8501377, 'binary_precision': 0.101342574, 'binary_recall': 0.5598086, 'binary_specificity': 0.8757931, 'binary_f1_score': 0.17161717}
confusion matrix:
       0     1
0  14631  2075
1    184   234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92112565, 'precision': 0.73850375, 'recall': 0.5029216, 'specificity': 0.5029216, 'f1': 0.4856647, 'auroc': 0.7777462, 'binary_precision': 0.5555556, 'binary_recall': 0.0062735258, 'binary_specificity': 0.99956965, 'binary_f1_score': 0.012406948}
confusion matrix:
      0  1
0  9291  4
1   792  5
early stop counter: 7
val acc:0.8680799007415771, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 8,now: 2024-08-10 09:43:30.946499,epoch time: 0:20:19.716668,used: 2:41:43.188927,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9322965, 'precision': 0.9398651, 'recall': 0.93228126, 'specificity': 0.93228126, 'f1': 0.9320023, 'auroc': 0.9982134, 'binary_precision': 0.8822242, 'binary_recall': 0.99783397, 'binary_specificity': 0.8667286, 'binary_f1_score': 0.9364745}
confusion matrix:
       0      1
0  22398   3444
1     56  25798
---- Validation: 
scalar performance:
{'acc': 0.70760334, 'precision': 0.5316967, 'recall': 0.784834, 'specificity': 0.784834, 'f1': 0.4753755, 'auroc': 0.8510035, 'binary_precision': 0.06813476, 'binary_recall': 0.8660287, 'binary_specificity': 0.7036394, 'binary_f1_score': 0.12633048}
confusion matrix:
       0     1
0  11755  4951
1     56   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9173603, 'precision': 0.63943326, 'recall': 0.52381986, 'specificity': 0.52381986, 'f1': 0.5270502, 'auroc': 0.78554666, 'binary_precision': 0.35433072, 'binary_recall': 0.056461733, 'binary_specificity': 0.99117804, 'binary_f1_score': 0.0974026}
confusion matrix:
      0   1
0  9213  82
1   752  45
early stop counter: 8
val acc:0.7076033353805542, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 9,now: 2024-08-10 10:03:10.893798,epoch time: 0:19:39.947299,used: 3:01:23.136226,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95247215, 'precision': 0.9560417, 'recall': 0.9524653, 'specificity': 0.9524653, 'f1': 0.95237845, 'auroc': 0.99869835, 'binary_precision': 0.91573375, 'binary_recall': 0.99667335, 'binary_specificity': 0.90825725, 'binary_f1_score': 0.9544907}
confusion matrix:
       0      1
0  23473   2371
1     86  25766
---- Validation: 
scalar performance:
{'acc': 0.83502686, 'precision': 0.54603976, 'recall': 0.7801654, 'specificity': 0.7801654, 'f1': 0.5422402, 'auroc': 0.8578427, 'binary_precision': 0.100298904, 'binary_recall': 0.72248805, 'binary_specificity': 0.8378427, 'binary_f1_score': 0.17614464}
confusion matrix:
       0     1
0  13997  2709
1    116   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9214229, 'precision': 0.8357794, 'recall': 0.5036565, 'specificity': 0.5036565, 'f1': 0.4869931, 'auroc': 0.8264268, 'binary_precision': 0.75, 'binary_recall': 0.007528231, 'binary_specificity': 0.9997848, 'binary_f1_score': 0.014906833}
confusion matrix:
      0  1
0  9293  2
1   791  6
early stop counter: 9
val acc:0.8350268602371216, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 10,now: 2024-08-10 10:22:27.940187,epoch time: 0:19:17.046389,used: 3:20:40.182615,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9129333, 'precision': 0.92541254, 'recall': 0.9129168, 'specificity': 0.9129168, 'f1': 0.9122878, 'auroc': 0.997965, 'binary_precision': 0.85259926, 'binary_recall': 0.99853015, 'binary_specificity': 0.82730335, 'binary_f1_score': 0.9198126}
confusion matrix:
       0      1
0  21380   4463
1     38  25815
---- Validation: 
scalar performance:
{'acc': 0.77511096, 'precision': 0.53482145, 'recall': 0.764619, 'specificity': 0.764619, 'f1': 0.5056111, 'auroc': 0.8191514, 'binary_precision': 0.07752892, 'binary_recall': 0.7535885, 'binary_specificity': 0.7756495, 'binary_f1_score': 0.14059362}
confusion matrix:
       0     1
0  12958  3748
1    103   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9166667, 'precision': 0.64910096, 'recall': 0.534341, 'specificity': 0.534341, 'f1': 0.5441635, 'auroc': 0.69930017, 'binary_precision': 0.37209302, 'binary_recall': 0.08030113, 'binary_specificity': 0.98838085, 'binary_f1_score': 0.13209493}
confusion matrix:
      0    1
0  9187  108
1   733   64
early stop counter: 10
val acc:0.7751109600067139, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 11,now: 2024-08-10 10:41:52.622527,epoch time: 0:19:24.682340,used: 3:40:04.864955,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.93995667, 'precision': 0.94610655, 'recall': 0.93995214, 'specificity': 0.93995214, 'f1': 0.93974864, 'auroc': 0.99853826, 'binary_precision': 0.8937474, 'binary_recall': 0.998646, 'binary_specificity': 0.88125825, 'binary_f1_score': 0.9432894}
confusion matrix:
       0      1
0  22777   3069
1     35  25815
---- Validation: 
scalar performance:
{'acc': 0.82060266, 'precision': 0.5448721, 'recall': 0.79259896, 'specificity': 0.79259896, 'f1': 0.53568584, 'auroc': 0.85237503, 'binary_precision': 0.09690158, 'binary_recall': 0.7631579, 'binary_specificity': 0.82203996, 'binary_f1_score': 0.17196766}
confusion matrix:
       0     1
0  13733  2973
1     99   319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9207293, 'precision': 0.70065135, 'recall': 0.5181925, 'specificity': 0.5181925, 'f1': 0.5163331, 'auroc': 0.6375108, 'binary_precision': 0.47761193, 'binary_recall': 0.040150564, 'binary_specificity': 0.99623454, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  9260  35
1   765  32
early stop counter: 11
val acc:0.8206026554107666, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 12,now: 2024-08-10 11:01:05.173148,epoch time: 0:19:12.550621,used: 3:59:17.415576,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9394731, 'precision': 0.9456157, 'recall': 0.939464, 'specificity': 0.939464, 'f1': 0.9392629, 'auroc': 0.9983332, 'binary_precision': 0.89333564, 'binary_recall': 0.99814326, 'binary_specificity': 0.8807847, 'binary_f1_score': 0.94283575}
confusion matrix:
       0      1
0  22763   3081
1     48  25804
---- Validation: 
scalar performance:
{'acc': 0.8658024, 'precision': 0.55075246, 'recall': 0.75861835, 'specificity': 0.75861835, 'f1': 0.55855674, 'auroc': 0.85904557, 'binary_precision': 0.11157025, 'binary_recall': 0.64593303, 'binary_specificity': 0.87130374, 'binary_f1_score': 0.19027485}
confusion matrix:
       0     1
0  14556  2150
1    148   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9207293, 'precision': 0.6832257, 'recall': 0.5067213, 'specificity': 0.5067213, 'f1': 0.49390194, 'auroc': 0.7398285, 'binary_precision': 0.44444445, 'binary_recall': 0.015056462, 'binary_specificity': 0.9983862, 'binary_f1_score': 0.029126214}
confusion matrix:
      0   1
0  9280  15
1   785  12
early stop counter: 12
val acc:0.8658024072647095, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 13,now: 2024-08-10 11:20:47.512190,epoch time: 0:19:42.339042,used: 4:18:59.754618,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90647244, 'precision': 0.92075205, 'recall': 0.9064653, 'specificity': 0.9064653, 'f1': 0.905671, 'auroc': 0.99680716, 'binary_precision': 0.843259, 'binary_recall': 0.99856865, 'binary_specificity': 0.814362, 'binary_f1_score': 0.91436565}
confusion matrix:
       0      1
0  21048   4798
1     37  25813
---- Validation: 
scalar performance:
{'acc': 0.73750293, 'precision': 0.5278616, 'recall': 0.7325158, 'specificity': 0.7325158, 'f1': 0.48245835, 'auroc': 0.7986165, 'binary_precision': 0.06488794, 'binary_recall': 0.72727275, 'binary_specificity': 0.7377589, 'binary_f1_score': 0.1191456}
confusion matrix:
       0     1
0  12325  4381
1    114   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8825803, 'precision': 0.54402786, 'recall': 0.53246963, 'specificity': 0.53246963, 'f1': 0.5363395, 'auroc': 0.5695894, 'binary_precision': 0.1620209, 'binary_recall': 0.11668758, 'binary_specificity': 0.9482517, 'binary_f1_score': 0.1356674}
confusion matrix:
      0    1
0  8814  481
1   704   93
early stop counter: 13
val acc:0.737502932548523, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 14,now: 2024-08-10 11:39:38.056362,epoch time: 0:18:50.544172,used: 4:37:50.298790,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9295303, 'precision': 0.9378445, 'recall': 0.929525, 'specificity': 0.929525, 'f1': 0.9291936, 'auroc': 0.99836195, 'binary_precision': 0.8775288, 'binary_recall': 0.9984139, 'binary_specificity': 0.86063606, 'binary_f1_score': 0.9340764}
confusion matrix:
       0      1
0  22244   3602
1     41  25809
---- Validation: 
scalar performance:
{'acc': 0.77306706, 'precision': 0.5332068, 'recall': 0.75307524, 'specificity': 0.75307524, 'f1': 0.5027193, 'auroc': 0.83247757, 'binary_precision': 0.075, 'binary_recall': 0.7320574, 'binary_specificity': 0.77409315, 'binary_f1_score': 0.13606048}
confusion matrix:
       0     1
0  12932  3774
1    112   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91874754, 'precision': 0.57712096, 'recall': 0.50449836, 'specificity': 0.50449836, 'f1': 0.49070957, 'auroc': 0.6683943, 'binary_precision': 0.23255815, 'binary_recall': 0.0125470515, 'binary_specificity': 0.9964497, 'binary_f1_score': 0.023809524}
confusion matrix:
      0   1
0  9262  33
1   787  10
early stop counter: 14
val acc:0.773067057132721, best validation acc: 0.9637351036071777, corresponding to test acc:                         0.9199365973472595 / 0.9227110743522644
after epoch: 15,now: 2024-08-10 11:56:25.502082,epoch time: 0:16:47.445720,used: 4:54:37.744510,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_07_01_47_seed_2_24132716
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:54:37.744510 at 2024-08-10 11:56:25.502082
persisted model performance metric: 

scalar performance:
{'acc': 0.9199366, 'precision': 0.72057414, 'recall': 0.6835211, 'specificity': 0.6835211, 'f1': 0.69981426, 'auroc': 0.8715553, 'binary_precision': 0.49157733, 'binary_recall': 0.40276036, 'binary_specificity': 0.96428186, 'binary_f1_score': 0.44275862}
confusion matrix:
      0    1
0  8963  332
1   476  321
oracle model performance metric: 

scalar performance:
{'acc': 0.9227111, 'precision': 0.7509336, 'recall': 0.53819585, 'specificity': 0.53819585, 'f1': 0.5511941, 'auroc': 0.80585194, 'binary_precision': 0.57522124, 'binary_recall': 0.081555836, 'binary_specificity': 0.9948359, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  9247  48
1   732  65
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494824 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 404288 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494824 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 404288 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10880 MiB |    998 TiB |    998 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    995 TiB |    995 TiB |
|       from small pool |  88912 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11476 MiB |  11506 MiB |  31966 MiB |  20490 MiB |
|       from large pool |  11350 MiB |  11380 MiB |  31782 MiB |  20432 MiB |
|       from small pool |    126 MiB |    128 MiB |    184 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 733975 KiB |   1557 MiB | 470346 GiB | 470345 GiB |
|       from large pool | 724160 KiB |   1555 MiB | 466897 GiB | 466897 GiB |
|       from small pool |   9815 KiB |     30 MiB |   3448 GiB |   3448 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7708    |  173388 K  |  173383 K  |
|       from large pool |      87    |     908    |   64564 K  |   64564 K  |
|       from small pool |    5076    |    7619    |  108824 K  |  108819 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7708    |  173388 K  |  173383 K  |
|       from large pool |      87    |     908    |   64564 K  |   64564 K  |
|       from small pool |    5076    |    7619    |  108824 K  |  108819 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     405    |     408    |    1058    |     653    |
|       from large pool |     342    |     345    |     966    |     624    |
|       from small pool |      63    |      64    |      92    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3263    |   94330 K  |   94330 K  |
|       from large pool |      22    |     198    |   42071 K  |   42071 K  |
|       from small pool |      53    |    3240    |   52259 K  |   52259 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    998 TiB |    998 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    995 TiB |    995 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1200 MiB |  11506 MiB |  31966 MiB |  30766 MiB |
|       from large pool |   1102 MiB |  11380 MiB |  31782 MiB |  30680 MiB |
|       from small pool |     98 MiB |    128 MiB |    184 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1557 MiB | 470346 GiB | 470346 GiB |
|       from large pool |  50944 KiB |   1555 MiB | 466898 GiB | 466898 GiB |
|       from small pool |      0 KiB |     30 MiB |   3448 GiB |   3448 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7708    |  173388 K  |  173388 K  |
|       from large pool |       2    |     908    |   64564 K  |   64564 K  |
|       from small pool |       0    |    7619    |  108824 K  |  108824 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7708    |  173388 K  |  173388 K  |
|       from large pool |       2    |     908    |   64564 K  |   64564 K  |
|       from small pool |       0    |    7619    |  108824 K  |  108824 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     408    |    1058    |     976    |
|       from large pool |      33    |     345    |     966    |     933    |
|       from small pool |      49    |      64    |      92    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3263    |   94332 K  |   94332 K  |
|       from large pool |       4    |     198    |   42071 K  |   42071 K  |
|       from small pool |       0    |    3240    |   52261 K  |   52261 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug 10 12:09:32 2024]
Finished job 0.
1 of 1 steps (100%) done
