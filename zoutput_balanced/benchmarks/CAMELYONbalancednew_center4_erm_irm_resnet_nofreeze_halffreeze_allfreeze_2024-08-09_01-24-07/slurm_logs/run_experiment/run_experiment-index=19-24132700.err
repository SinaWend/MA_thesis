Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 06:12:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/19.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=19
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700

 Experiment start at: 2024-08-09 06:19:04.828820
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.738491, 'precision': 0.7641203, 'recall': 0.7383925, 'specificity': 0.7383925, 'f1': 0.7319366, 'auroc': 0.8403326, 'binary_precision': 0.68200284, 'binary_recall': 0.8942945, 'binary_specificity': 0.5824905, 'binary_f1_score': 0.77385324}
confusion matrix:
       0      1
0  14744  10568
1   2679  22665
---- Validation: 
scalar performance:
{'acc': 0.50764024, 'precision': 0.50830626, 'recall': 0.5879227, 'specificity': 0.5879227, 'f1': 0.36410928, 'auroc': 0.63400877, 'binary_precision': 0.032498542, 'binary_recall': 0.67228913, 'binary_specificity': 0.50355625, 'binary_f1_score': 0.061999995}
confusion matrix:
      0     1
0  8425  8306
1   136   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.22849515, 'precision': 0.46216866, 'recall': 0.4112557, 'specificity': 0.4112557, 'f1': 0.21464767, 'auroc': 0.34102434, 'binary_precision': 0.060507562, 'binary_recall': 0.626943, 'binary_specificity': 0.1955684, 'binary_f1_score': 0.1103637}
confusion matrix:
      0     1
0  1827  7515
1   288   484
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 06:34:03.958663,epoch time: 0:14:59.129843,used: 0:14:59.129843,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.82629895, 'precision': 0.83095974, 'recall': 0.8262732, 'specificity': 0.8262732, 'f1': 0.82567734, 'auroc': 0.9055941, 'binary_precision': 0.7917931, 'binary_recall': 0.88563085, 'binary_specificity': 0.7669155, 'binary_f1_score': 0.8360873}
confusion matrix:
       0      1
0  19416   5901
1   2898  22441
---- Validation: 
scalar performance:
{'acc': 0.70284617, 'precision': 0.50933516, 'recall': 0.5822025, 'specificity': 0.5822025, 'f1': 0.4461366, 'auroc': 0.61069316, 'binary_precision': 0.037366547, 'binary_recall': 0.4554217, 'binary_specificity': 0.7089833, 'binary_f1_score': 0.06906632}
confusion matrix:
       0     1
0  11862  4869
1    226   189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4694483, 'precision': 0.5175093, 'recall': 0.56129503, 'specificity': 0.56129503, 'f1': 0.38675466, 'auroc': 0.54542255, 'binary_precision': 0.09186212, 'binary_recall': 0.6696891, 'binary_specificity': 0.4529009, 'binary_f1_score': 0.16156249}
confusion matrix:
      0     1
0  4231  5111
1   255   517
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 06:48:13.733150,epoch time: 0:14:09.774487,used: 0:29:08.904330,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84025586, 'precision': 0.8407968, 'recall': 0.8402464, 'specificity': 0.8402464, 'f1': 0.8401898, 'auroc': 0.92034614, 'binary_precision': 0.8273362, 'binary_recall': 0.8601815, 'binary_specificity': 0.82031125, 'binary_f1_score': 0.8434393}
confusion matrix:
       0      1
0  20767   4549
1   3543  21797
---- Validation: 
scalar performance:
{'acc': 0.78607255, 'precision': 0.50888306, 'recall': 0.5614014, 'specificity': 0.5614014, 'f1': 0.473861, 'auroc': 0.604897, 'binary_precision': 0.038319614, 'binary_recall': 0.3253012, 'binary_specificity': 0.7975016, 'binary_f1_score': 0.06856272}
confusion matrix:
       0     1
0  13343  3388
1    280   135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65246195, 'precision': 0.5464616, 'recall': 0.6538281, 'specificity': 0.6538281, 'f1': 0.49983826, 'auroc': 0.66607624, 'binary_precision': 0.13475366, 'binary_recall': 0.6554404, 'binary_specificity': 0.6522158, 'binary_f1_score': 0.2235476}
confusion matrix:
      0     1
0  6093  3249
1   266   506
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 07:02:32.722040,epoch time: 0:14:18.988890,used: 0:43:27.893220,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85972047, 'precision': 0.8675792, 'recall': 0.8596714, 'specificity': 0.8596714, 'f1': 0.8589549, 'auroc': 0.94520986, 'binary_precision': 0.81399995, 'binary_recall': 0.9327678, 'binary_specificity': 0.786575, 'binary_f1_score': 0.8693462}
confusion matrix:
       0      1
0  19909   5402
1   1704  23641
---- Validation: 
scalar performance:
{'acc': 0.7615187, 'precision': 0.51139504, 'recall': 0.5864179, 'specificity': 0.5864179, 'f1': 0.4693083, 'auroc': 0.631705, 'binary_precision': 0.041666668, 'binary_recall': 0.40240964, 'binary_specificity': 0.77042615, 'binary_f1_score': 0.07551436}
confusion matrix:
       0     1
0  12890  3841
1    248   167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6240854, 'precision': 0.5490329, 'recall': 0.66817474, 'specificity': 0.66817474, 'f1': 0.48901135, 'auroc': 0.6826591, 'binary_precision': 0.13423467, 'binary_recall': 0.7202073, 'binary_specificity': 0.61614215, 'binary_f1_score': 0.22629222}
confusion matrix:
      0     1
0  5756  3586
1   216   556
early stop counter: 1
val acc:0.7615187168121338, best validation acc: 0.7860725522041321, corresponding to test acc:                         0.6524619460105896 / 0.6524619460105896
after epoch: 4,now: 2024-08-09 07:16:38.701405,epoch time: 0:14:05.979365,used: 0:57:33.872585,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86970943, 'precision': 0.87321174, 'recall': 0.86967695, 'specificity': 0.86967695, 'f1': 0.86939585, 'auroc': 0.94753045, 'binary_precision': 0.8372252, 'binary_recall': 0.91809034, 'binary_specificity': 0.8212635, 'binary_f1_score': 0.8757951}
confusion matrix:
       0      1
0  20787   4524
1   2076  23269
---- Validation: 
scalar performance:
{'acc': 0.7625102, 'precision': 0.51210064, 'recall': 0.5916257, 'specificity': 0.5916257, 'f1': 0.47059658, 'auroc': 0.6524471, 'binary_precision': 0.04276069, 'binary_recall': 0.4120482, 'binary_specificity': 0.77120316, 'binary_f1_score': 0.07748074}
confusion matrix:
       0     1
0  12903  3828
1    244   171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6852877, 'precision': 0.5643682, 'recall': 0.70784026, 'specificity': 0.70784026, 'f1': 0.53131604, 'auroc': 0.7263285, 'binary_precision': 0.15994358, 'binary_recall': 0.73445594, 'binary_specificity': 0.6812246, 'binary_f1_score': 0.2626824}
confusion matrix:
      0     1
0  6364  2978
1   205   567
new oracle model saved
early stop counter: 2
val acc:0.7625101804733276, best validation acc: 0.7860725522041321, corresponding to test acc:                         0.6524619460105896 / 0.6852877140045166
after epoch: 5,now: 2024-08-09 07:30:33.546026,epoch time: 0:13:54.844621,used: 1:11:28.717206,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.86653113, 'precision': 0.8739139, 'recall': 0.8664979, 'specificity': 0.8664979, 'f1': 0.86586154, 'auroc': 0.95163894, 'binary_precision': 0.8214916, 'binary_recall': 0.93674034, 'binary_specificity': 0.79625535, 'binary_f1_score': 0.87533885}
confusion matrix:
       0      1
0  20158   5158
1   1603  23737
---- Validation: 
scalar performance:
{'acc': 0.72553366, 'precision': 0.5082893, 'recall': 0.569154, 'specificity': 0.569154, 'f1': 0.45287564, 'auroc': 0.61414236, 'binary_precision': 0.036308624, 'binary_recall': 0.40481928, 'binary_specificity': 0.73348874, 'binary_f1_score': 0.06664022}
confusion matrix:
       0     1
0  12272  4459
1    247   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5983785, 'precision': 0.5465649, 'recall': 0.66257715, 'specificity': 0.66257715, 'f1': 0.47440755, 'auroc': 0.69025093, 'binary_precision': 0.12866817, 'binary_recall': 0.738342, 'binary_specificity': 0.58681226, 'binary_f1_score': 0.21914649}
confusion matrix:
      0     1
0  5482  3860
1   202   570
early stop counter: 3
val acc:0.725533664226532, best validation acc: 0.7860725522041321, corresponding to test acc:                         0.6524619460105896 / 0.6852877140045166
after epoch: 6,now: 2024-08-09 07:44:27.423257,epoch time: 0:13:53.877231,used: 1:25:22.594437,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8842585, 'precision': 0.89031386, 'recall': 0.88421917, 'specificity': 0.88421917, 'f1': 0.88380027, 'auroc': 0.96408516, 'binary_precision': 0.8418559, 'binary_recall': 0.94645673, 'binary_specificity': 0.82198167, 'binary_f1_score': 0.8910971}
confusion matrix:
       0      1
0  20806   4506
1   1357  23987
---- Validation: 
scalar performance:
{'acc': 0.7390645, 'precision': 0.5121246, 'recall': 0.59841096, 'specificity': 0.59841096, 'f1': 0.46259788, 'auroc': 0.6355597, 'binary_precision': 0.042183623, 'binary_recall': 0.4506024, 'binary_specificity': 0.7462196, 'binary_f1_score': 0.07714521}
confusion matrix:
       0     1
0  12485  4246
1    228   187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68835276, 'precision': 0.5587347, 'recall': 0.68692183, 'specificity': 0.68692183, 'f1': 0.5272639, 'auroc': 0.7043402, 'binary_precision': 0.15386853, 'binary_recall': 0.6852332, 'binary_specificity': 0.68861055, 'binary_f1_score': 0.2513064}
confusion matrix:
      0     1
0  6433  2909
1   243   529
new oracle model saved
early stop counter: 4
val acc:0.7390645146369934, best validation acc: 0.7860725522041321, corresponding to test acc:                         0.6524619460105896 / 0.6883527636528015
after epoch: 7,now: 2024-08-09 07:58:22.591432,epoch time: 0:13:55.168175,used: 1:39:17.762612,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8854035, 'precision': 0.8883532, 'recall': 0.8853726, 'specificity': 0.8853726, 'f1': 0.88517964, 'auroc': 0.96122164, 'binary_precision': 0.8546847, 'binary_recall': 0.928904, 'binary_specificity': 0.84184116, 'binary_f1_score': 0.89025015}
confusion matrix:
       0      1
0  21307   4003
1   1802  23544
---- Validation: 
scalar performance:
{'acc': 0.7710253, 'precision': 0.5086426, 'recall': 0.5630907, 'specificity': 0.5630907, 'f1': 0.46869135, 'auroc': 0.6200153, 'binary_precision': 0.03766131, 'binary_recall': 0.34457833, 'binary_specificity': 0.78160304, 'binary_f1_score': 0.06790123}
confusion matrix:
       0     1
0  13077  3654
1    272   143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73264784, 'precision': 0.56650645, 'recall': 0.6942635, 'specificity': 0.6942635, 'f1': 0.55335593, 'auroc': 0.725528, 'binary_precision': 0.17075665, 'binary_recall': 0.64896375, 'binary_specificity': 0.7395633, 'binary_f1_score': 0.2703724}
confusion matrix:
      0     1
0  6909  2433
1   271   501
new oracle model saved
early stop counter: 5
val acc:0.7710253000259399, best validation acc: 0.7860725522041321, corresponding to test acc:                         0.6524619460105896 / 0.7326478362083435
after epoch: 8,now: 2024-08-09 08:12:18.168559,epoch time: 0:13:55.577127,used: 1:53:13.339739,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8911679, 'precision': 0.8912127, 'recall': 0.8911654, 'specificity': 0.8911654, 'f1': 0.8911643, 'auroc': 0.9610096, 'binary_precision': 0.8871402, 'binary_recall': 0.8964878, 'binary_specificity': 0.8858429, 'binary_f1_score': 0.8917895}
confusion matrix:
       0      1
0  22426   2890
1   2623  22717
---- Validation: 
scalar performance:
{'acc': 0.8218243, 'precision': 0.50659627, 'recall': 0.538598, 'specificity': 0.538598, 'f1': 0.4815065, 'auroc': 0.6010719, 'binary_precision': 0.03521127, 'binary_recall': 0.24096386, 'binary_specificity': 0.8362321, 'binary_f1_score': 0.06144393}
confusion matrix:
       0     1
0  13991  2740
1    315   100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7901918, 'precision': 0.586299, 'recall': 0.716501, 'specificity': 0.716501, 'f1': 0.5951545, 'auroc': 0.7456107, 'binary_precision': 0.20930232, 'binary_recall': 0.6295337, 'binary_specificity': 0.8034682, 'binary_f1_score': 0.3141564}
confusion matrix:
      0     1
0  7506  1836
1   286   486
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-09 08:26:29.010652,epoch time: 0:14:10.842093,used: 2:07:24.181832,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8949384, 'precision': 0.8960296, 'recall': 0.89492285, 'specificity': 0.89492285, 'f1': 0.8948633, 'auroc': 0.9646249, 'binary_precision': 0.87538904, 'binary_recall': 0.9211222, 'binary_specificity': 0.8687236, 'binary_f1_score': 0.89767355}
confusion matrix:
       0      1
0  21990   3323
1   1999  23344
---- Validation: 
scalar performance:
{'acc': 0.8045025, 'precision': 0.51294315, 'recall': 0.58376926, 'specificity': 0.58376926, 'f1': 0.48538038, 'auroc': 0.6568014, 'binary_precision': 0.045215238, 'binary_recall': 0.35180724, 'binary_specificity': 0.8157313, 'binary_f1_score': 0.08013172}
confusion matrix:
       0     1
0  13648  3083
1    269   146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7941467, 'precision': 0.58729994, 'recall': 0.71567106, 'specificity': 0.71567106, 'f1': 0.59743613, 'auroc': 0.74596685, 'binary_precision': 0.21170774, 'binary_recall': 0.623057, 'binary_specificity': 0.8082852, 'binary_f1_score': 0.31603155}
confusion matrix:
      0     1
0  7551  1791
1   291   481
new oracle model saved
early stop counter: 1
val acc:0.8045024871826172, best validation acc: 0.821824312210083, corresponding to test acc:                         0.7901918292045593 / 0.794146716594696
after epoch: 10,now: 2024-08-09 08:40:38.084176,epoch time: 0:14:09.073524,used: 2:21:33.255356,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.89509636, 'precision': 0.8988296, 'recall': 0.8950734, 'specificity': 0.8950734, 'f1': 0.8948463, 'auroc': 0.96980387, 'binary_precision': 0.86036134, 'binary_recall': 0.9434096, 'binary_specificity': 0.84673727, 'binary_f1_score': 0.89997363}
confusion matrix:
       0      1
0  21436   3880
1   1434  23906
---- Validation: 
scalar performance:
{'acc': 0.7580194, 'precision': 0.5102952, 'recall': 0.57875013, 'specificity': 0.57875013, 'f1': 0.46664754, 'auroc': 0.62815636, 'binary_precision': 0.039921142, 'binary_recall': 0.39036146, 'binary_specificity': 0.76713884, 'binary_f1_score': 0.072434604}
confusion matrix:
       0     1
0  12835  3896
1    253   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7798102, 'precision': 0.5846194, 'recall': 0.72098166, 'specificity': 0.72098166, 'f1': 0.5900638, 'auroc': 0.7448039, 'binary_precision': 0.20438845, 'binary_recall': 0.6515544, 'binary_specificity': 0.7904089, 'binary_f1_score': 0.3111661}
confusion matrix:
      0     1
0  7384  1958
1   269   503
early stop counter: 2
val acc:0.7580193877220154, best validation acc: 0.821824312210083, corresponding to test acc:                         0.7901918292045593 / 0.794146716594696
after epoch: 11,now: 2024-08-09 08:54:34.585227,epoch time: 0:13:56.501051,used: 2:35:29.756407,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9105535, 'precision': 0.91204786, 'recall': 0.91053456, 'specificity': 0.91053456, 'f1': 0.91046965, 'auroc': 0.97472626, 'binary_precision': 0.88739157, 'binary_recall': 0.9405776, 'binary_specificity': 0.8804915, 'binary_f1_score': 0.91321087}
confusion matrix:
       0      1
0  22287   3025
1   1506  23838
---- Validation: 
scalar performance:
{'acc': 0.8161087, 'precision': 0.5185497, 'recall': 0.6155649, 'specificity': 0.6155649, 'f1': 0.49697128, 'auroc': 0.6723138, 'binary_precision': 0.05465192, 'binary_recall': 0.40481928, 'binary_specificity': 0.82631046, 'binary_f1_score': 0.096302666}
confusion matrix:
       0     1
0  13825  2906
1    247   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8437809, 'precision': 0.61296624, 'recall': 0.7253088, 'specificity': 0.7253088, 'f1': 0.63744247, 'auroc': 0.76542866, 'binary_precision': 0.26401868, 'binary_recall': 0.58549225, 'binary_specificity': 0.86512524, 'binary_f1_score': 0.36392915}
confusion matrix:
      0     1
0  8082  1260
1   320   452
new oracle model saved
early stop counter: 3
val acc:0.8161087036132812, best validation acc: 0.821824312210083, corresponding to test acc:                         0.7901918292045593 / 0.8437808752059937
after epoch: 12,now: 2024-08-09 09:08:29.732005,epoch time: 0:13:55.146778,used: 2:49:24.903185,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.89965653, 'precision': 0.9022485, 'recall': 0.89963907, 'specificity': 0.89963907, 'f1': 0.89949167, 'auroc': 0.97108144, 'binary_precision': 0.87006724, 'binary_recall': 0.93973714, 'binary_specificity': 0.859541, 'binary_f1_score': 0.9035612}
confusion matrix:
       0      1
0  21761   3556
1   1527  23812
---- Validation: 
scalar performance:
{'acc': 0.79307127, 'precision': 0.5166678, 'recall': 0.6143348, 'specificity': 0.6143348, 'f1': 0.48698688, 'auroc': 0.6833646, 'binary_precision': 0.050759967, 'binary_recall': 0.426506, 'binary_specificity': 0.80216366, 'binary_f1_score': 0.09072271}
confusion matrix:
       0     1
0  13421  3310
1    238   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85366815, 'precision': 0.6178965, 'recall': 0.7199663, 'specificity': 0.7199663, 'f1': 0.64345115, 'auroc': 0.76931787, 'binary_precision': 0.2753807, 'binary_recall': 0.56217617, 'binary_specificity': 0.87775636, 'binary_f1_score': 0.36967632}
confusion matrix:
      0     1
0  8200  1142
1   338   434
new oracle model saved
early stop counter: 4
val acc:0.7930712699890137, best validation acc: 0.821824312210083, corresponding to test acc:                         0.7901918292045593 / 0.8536681532859802
after epoch: 13,now: 2024-08-09 09:22:48.021124,epoch time: 0:14:18.289119,used: 3:03:43.192304,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9198713, 'precision': 0.92036843, 'recall': 0.9198612, 'specificity': 0.9198612, 'f1': 0.91984624, 'auroc': 0.9786222, 'binary_precision': 0.9060592, 'binary_recall': 0.9369846, 'binary_specificity': 0.90273774, 'binary_f1_score': 0.92126244}
confusion matrix:
       0      1
0  22851   2462
1   1597  23746
---- Validation: 
scalar performance:
{'acc': 0.84527004, 'precision': 0.52068704, 'recall': 0.6105333, 'specificity': 0.6105333, 'f1': 0.5087697, 'auroc': 0.68473, 'binary_precision': 0.05944882, 'binary_recall': 0.36385542, 'binary_specificity': 0.8572112, 'binary_f1_score': 0.102199666}
confusion matrix:
       0     1
0  14342  2389
1    264   151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8674115, 'precision': 0.6381843, 'recall': 0.74879503, 'specificity': 0.74879503, 'f1': 0.66868997, 'auroc': 0.79424715, 'binary_precision': 0.31146455, 'binary_recall': 0.6088083, 'binary_specificity': 0.88878185, 'binary_f1_score': 0.41209996}
confusion matrix:
      0     1
0  8303  1039
1   302   470
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-09 09:36:47.472862,epoch time: 0:13:59.451738,used: 3:17:42.644042,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.91584414, 'precision': 0.9163922, 'recall': 0.9158334, 'specificity': 0.9158334, 'f1': 0.9158149, 'auroc': 0.97581065, 'binary_precision': 0.90143204, 'binary_recall': 0.9339068, 'binary_specificity': 0.89776003, 'binary_f1_score': 0.9173821}
confusion matrix:
       0      1
0  22725   2588
1   1675  23668
---- Validation: 
scalar performance:
{'acc': 0.839846, 'precision': 0.51775736, 'recall': 0.59717965, 'specificity': 0.59717965, 'f1': 0.50294554, 'auroc': 0.6900288, 'binary_precision': 0.054302104, 'binary_recall': 0.3421687, 'binary_specificity': 0.85219055, 'binary_f1_score': 0.09372938}
confusion matrix:
       0     1
0  14258  2473
1    273   142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8550524, 'precision': 0.6216837, 'recall': 0.72843945, 'specificity': 0.72843945, 'f1': 0.64838374, 'auroc': 0.7806201, 'binary_precision': 0.28148615, 'binary_recall': 0.57901555, 'binary_specificity': 0.8778634, 'binary_f1_score': 0.37881356}
confusion matrix:
      0     1
0  8201  1141
1   325   447
early stop counter: 1
val acc:0.8398460149765015, best validation acc: 0.845270037651062, corresponding to test acc:                         0.8674114942550659 / 0.8674114942550659
after epoch: 15,now: 2024-08-09 09:51:00.287489,epoch time: 0:14:12.814627,used: 3:31:55.458669,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_04_seed_0_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:31:55.458669 at 2024-08-09 09:51:00.287489
persisted model performance metric: 

scalar performance:
{'acc': 0.8674115, 'precision': 0.6381843, 'recall': 0.74879503, 'specificity': 0.74879503, 'f1': 0.66868997, 'auroc': 0.79424715, 'binary_precision': 0.31146455, 'binary_recall': 0.6088083, 'binary_specificity': 0.88878185, 'binary_f1_score': 0.41209996}
confusion matrix:
      0     1
0  8303  1039
1   302   470
oracle model performance metric: 

scalar performance:
{'acc': 0.8674115, 'precision': 0.6381843, 'recall': 0.74879503, 'specificity': 0.74879503, 'f1': 0.66868997, 'auroc': 0.79424715, 'binary_precision': 0.31146455, 'binary_recall': 0.6088083, 'binary_specificity': 0.88878185, 'binary_f1_score': 0.41209996}
confusion matrix:
      0     1
0  8303  1039
1   302   470
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/19.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205702 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205029 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205702 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205029 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201269 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 202776 GiB | 202776 GiB |
|       from small pool |  36149 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 739328 KiB | 739328 KiB | 739328 KiB |      0 B   |
|       from large pool | 661504 KiB | 661504 KiB | 661504 KiB |      0 B   |
|       from small pool |  77824 KiB |  77824 KiB |  77824 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44153 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  36864 KiB | 148352 KiB | 139038 GiB | 139038 GiB |
|       from small pool |   7289 KiB |   9156 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4698    |    7101    |   43618 K  |   43613 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29718 K  |   29714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4698    |    7101    |   43618 K  |   43613 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29718 K  |   29714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      55    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      38    |      38    |      38    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    3182    |   22781 K  |   22781 K  |
|       from large pool |       7    |      11    |    8644 K  |    8644 K  |
|       from small pool |      44    |    3176    |   14137 K  |   14137 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202776 GiB | 202776 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139038 GiB | 139038 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43618 K  |   43618 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29718 K  |   29718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43618 K  |   43618 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29718 K  |   29718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202776 GiB | 202776 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139038 GiB | 139038 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43618 K  |   43618 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29718 K  |   29718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43618 K  |   43618 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29718 K  |   29718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700

 Experiment start at: 2024-08-09 10:11:38.584401
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6805556, 'precision': 0.734598, 'recall': 0.6803665, 'specificity': 0.6803665, 'f1': 0.6608937, 'auroc': 0.8274976, 'binary_precision': 0.62219685, 'binary_recall': 0.9206243, 'binary_specificity': 0.4401087, 'binary_f1_score': 0.7425482}
confusion matrix:
       0      1
0  11177  14219
1   2019  23417
---- Validation: 
scalar performance:
{'acc': 0.35525316, 'precision': 0.4924665, 'recall': 0.42971334, 'specificity': 0.42971334, 'f1': 0.27663445, 'auroc': 0.40317607, 'binary_precision': 0.019824388, 'binary_recall': 0.50812066, 'binary_specificity': 0.35130602, 'binary_f1_score': 0.038159963}
confusion matrix:
      0      1
0  5864  10828
1   212    219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.22307006, 'precision': 0.49449015, 'recall': 0.4883829, 'specificity': 0.4883829, 'f1': 0.21474525, 'auroc': 0.46919912, 'binary_precision': 0.07305606, 'binary_recall': 0.8005284, 'binary_specificity': 0.1762374, 'binary_f1_score': 0.13389306}
confusion matrix:
      0     1
0  1645  7689
1   151   606
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 10:29:37.463989,epoch time: 0:17:58.879588,used: 0:17:58.879588,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.78987646, 'precision': 0.8069318, 'recall': 0.78976965, 'specificity': 0.78976965, 'f1': 0.7868743, 'auroc': 0.8957808, 'binary_precision': 0.7348056, 'binary_recall': 0.90774006, 'binary_specificity': 0.6717993, 'binary_f1_score': 0.81216913}
confusion matrix:
       0      1
0  17059   8334
1   2347  23092
---- Validation: 
scalar performance:
{'acc': 0.65157974, 'precision': 0.50652564, 'recall': 0.56022966, 'specificity': 0.56022966, 'f1': 0.42442268, 'auroc': 0.5452176, 'binary_precision': 0.0336984, 'binary_recall': 0.46403712, 'binary_specificity': 0.65642226, 'binary_f1_score': 0.0628338}
confusion matrix:
       0     1
0  10957  5735
1    231   200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55049056, 'precision': 0.55500305, 'recall': 0.6981447, 'specificity': 0.6981447, 'f1': 0.4543914, 'auroc': 0.75755787, 'binary_precision': 0.12943715, 'binary_recall': 0.8718626, 'binary_specificity': 0.5244268, 'binary_f1_score': 0.22540985}
confusion matrix:
      0     1
0  4895  4439
1    97   660
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 10:46:10.095959,epoch time: 0:16:32.631970,used: 0:34:31.511558,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.82290685, 'precision': 0.8336516, 'recall': 0.8228362, 'specificity': 0.8228362, 'f1': 0.8214472, 'auroc': 0.91985357, 'binary_precision': 0.77397305, 'binary_recall': 0.9126042, 'binary_specificity': 0.7330682, 'binary_f1_score': 0.8375911}
confusion matrix:
       0      1
0  18617   6779
1   2223  23213
---- Validation: 
scalar performance:
{'acc': 0.7091047, 'precision': 0.50604236, 'recall': 0.55017996, 'specificity': 0.55017996, 'f1': 0.44499537, 'auroc': 0.55875254, 'binary_precision': 0.033811476, 'binary_recall': 0.38283062, 'binary_specificity': 0.71752936, 'binary_f1_score': 0.062135193}
confusion matrix:
       0     1
0  11977  4715
1    266   165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56000394, 'precision': 0.5544121, 'recall': 0.69600403, 'specificity': 0.69600403, 'f1': 0.45929497, 'auroc': 0.7576479, 'binary_precision': 0.13014662, 'binary_recall': 0.85601056, 'binary_specificity': 0.53599745, 'binary_f1_score': 0.22594143}
confusion matrix:
      0     1
0  5003  4331
1   109   648
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 11:01:54.940153,epoch time: 0:15:44.844194,used: 0:50:16.355752,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.83856624, 'precision': 0.8520404, 'recall': 0.83848155, 'specificity': 0.83848155, 'f1': 0.83698267, 'auroc': 0.93870103, 'binary_precision': 0.7833838, 'binary_recall': 0.9363158, 'binary_specificity': 0.7406474, 'binary_f1_score': 0.85304964}
confusion matrix:
       0      1
0  18808   6586
1   1620  23818
---- Validation: 
scalar performance:
{'acc': 0.68194824, 'precision': 0.5058063, 'recall': 0.55094296, 'specificity': 0.55094296, 'f1': 0.43494713, 'auroc': 0.5554657, 'binary_precision': 0.033140942, 'binary_recall': 0.41299304, 'binary_specificity': 0.6888929, 'binary_f1_score': 0.061358154}
confusion matrix:
       0     1
0  11499  5193
1    253   178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6113368, 'precision': 0.5531965, 'recall': 0.68794286, 'specificity': 0.68794286, 'f1': 0.4854677, 'auroc': 0.737334, 'binary_precision': 0.13562053, 'binary_recall': 0.77807134, 'binary_specificity': 0.59781444, 'binary_f1_score': 0.2309804}
confusion matrix:
      0     1
0  5580  3754
1   168   589
new oracle model saved
early stop counter: 1
val acc:0.6819482445716858, best validation acc: 0.7091047167778015, corresponding to test acc:                         0.560003936290741 / 0.6113368272781372
after epoch: 4,now: 2024-08-09 11:16:22.962669,epoch time: 0:14:28.022516,used: 1:04:44.378268,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8599701, 'precision': 0.8655145, 'recall': 0.8599217, 'specificity': 0.8599217, 'f1': 0.8594254, 'auroc': 0.94721425, 'binary_precision': 0.82069325, 'binary_recall': 0.92148924, 'binary_specificity': 0.7983541, 'binary_f1_score': 0.8681754}
confusion matrix:
       0      1
0  20275   5121
1   1997  23439
---- Validation: 
scalar performance:
{'acc': 0.73614436, 'precision': 0.50821036, 'recall': 0.5640489, 'specificity': 0.5640489, 'f1': 0.45719272, 'auroc': 0.5762223, 'binary_precision': 0.037355673, 'binary_recall': 0.38283062, 'binary_specificity': 0.7452672, 'binary_f1_score': 0.06806931}
confusion matrix:
       0     1
0  12440  4252
1    266   165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72698444, 'precision': 0.5729366, 'recall': 0.72314423, 'specificity': 0.72314423, 'f1': 0.5572486, 'auroc': 0.7717841, 'binary_precision': 0.17627998, 'binary_recall': 0.71862614, 'binary_specificity': 0.7276623, 'binary_f1_score': 0.28311217}
confusion matrix:
      0     1
0  6792  2542
1   213   544
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 11:30:53.792159,epoch time: 0:14:30.829490,used: 1:19:15.207758,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8667178, 'precision': 0.8684869, 'recall': 0.86669195, 'specificity': 0.86669195, 'f1': 0.86655176, 'auroc': 0.9480995, 'binary_precision': 0.84314084, 'binary_recall': 0.90131706, 'binary_specificity': 0.8320668, 'binary_f1_score': 0.87125885}
confusion matrix:
       0      1
0  21132   4265
1   2510  22925
---- Validation: 
scalar performance:
{'acc': 0.81305844, 'precision': 0.50928843, 'recall': 0.55490303, 'specificity': 0.55490303, 'f1': 0.48345107, 'auroc': 0.5556844, 'binary_precision': 0.04047777, 'binary_recall': 0.28306264, 'binary_specificity': 0.82674336, 'binary_f1_score': 0.07082728}
confusion matrix:
       0     1
0  13800  2892
1    309   122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8292538, 'precision': 0.59655035, 'recall': 0.70498693, 'specificity': 0.70498693, 'f1': 0.6157428, 'auroc': 0.78957725, 'binary_precision': 0.2334437, 'binary_recall': 0.55878466, 'binary_specificity': 0.8511892, 'binary_f1_score': 0.32931104}
confusion matrix:
      0     1
0  7945  1389
1   334   423
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 11:45:22.723895,epoch time: 0:14:28.931736,used: 1:33:44.139494,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.87206876, 'precision': 0.8767934, 'recall': 0.8720225, 'specificity': 0.8720225, 'f1': 0.8716564, 'auroc': 0.95621943, 'binary_precision': 0.8348069, 'binary_recall': 0.92797893, 'binary_specificity': 0.81606615, 'binary_f1_score': 0.87893057}
confusion matrix:
       0      1
0  20724   4671
1   1832  23605
---- Validation: 
scalar performance:
{'acc': 0.7740466, 'precision': 0.50909036, 'recall': 0.5631469, 'specificity': 0.5631469, 'f1': 0.47100565, 'auroc': 0.5958911, 'binary_precision': 0.039389066, 'binary_recall': 0.34106728, 'binary_specificity': 0.78522646, 'binary_f1_score': 0.070622146}
confusion matrix:
       0     1
0  13107  3585
1    284   147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8048756, 'precision': 0.5865195, 'recall': 0.7057688, 'specificity': 0.7057688, 'f1': 0.59905106, 'auroc': 0.76514477, 'binary_precision': 0.21197718, 'binary_recall': 0.5891678, 'binary_specificity': 0.8223698, 'binary_f1_score': 0.3117791}
confusion matrix:
      0     1
0  7676  1658
1   311   446
early stop counter: 1
val acc:0.7740465998649597, best validation acc: 0.8130584359169006, corresponding to test acc:                         0.8292537927627563 / 0.8292537927627563
after epoch: 7,now: 2024-08-09 11:59:41.096941,epoch time: 0:14:18.373046,used: 1:48:02.512540,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8800362, 'precision': 0.88399494, 'recall': 0.8799983, 'specificity': 0.8799983, 'f1': 0.87971866, 'auroc': 0.96213686, 'binary_precision': 0.8451926, 'binary_recall': 0.9307254, 'binary_specificity': 0.8292712, 'binary_f1_score': 0.8858993}
confusion matrix:
       0      1
0  21061   4336
1   1762  23673
---- Validation: 
scalar performance:
{'acc': 0.78940606, 'precision': 0.5107878, 'recall': 0.5710249, 'specificity': 0.5710249, 'f1': 0.47827756, 'auroc': 0.6240795, 'binary_precision': 0.042375326, 'binary_recall': 0.34106728, 'binary_specificity': 0.80098253, 'binary_f1_score': 0.07538462}
confusion matrix:
       0     1
0  13370  3322
1    284   147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.774948, 'precision': 0.5835688, 'recall': 0.72600746, 'specificity': 0.72600746, 'f1': 0.586934, 'auroc': 0.7783022, 'binary_precision': 0.20031671, 'binary_recall': 0.668428, 'binary_specificity': 0.78358686, 'binary_f1_score': 0.30825466}
confusion matrix:
      0     1
0  7314  2020
1   251   506
early stop counter: 2
val acc:0.7894060611724854, best validation acc: 0.8130584359169006, corresponding to test acc:                         0.8292537927627563 / 0.8292537927627563
after epoch: 8,now: 2024-08-09 12:14:19.776527,epoch time: 0:14:38.679586,used: 2:02:41.192126,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8869413, 'precision': 0.88881516, 'recall': 0.8869127, 'specificity': 0.8869127, 'f1': 0.88679945, 'auroc': 0.9617691, 'binary_precision': 0.86202836, 'binary_recall': 0.92157096, 'binary_specificity': 0.8522544, 'binary_f1_score': 0.8908058}
confusion matrix:
       0      1
0  21643   3752
1   1995  23442
---- Validation: 
scalar performance:
{'acc': 0.8118904, 'precision': 0.5104332, 'recall': 0.56221485, 'specificity': 0.56221485, 'f1': 0.4847346, 'auroc': 0.60888815, 'binary_precision': 0.042322833, 'binary_recall': 0.29930395, 'binary_specificity': 0.8251258, 'binary_f1_score': 0.07415924}
confusion matrix:
       0     1
0  13773  2919
1    302   129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83093846, 'precision': 0.60461414, 'recall': 0.7271403, 'specificity': 0.7271403, 'f1': 0.6260995, 'auroc': 0.7838923, 'binary_precision': 0.24557641, 'binary_recall': 0.6050198, 'binary_specificity': 0.84926075, 'binary_f1_score': 0.34935167}
confusion matrix:
      0     1
0  7927  1407
1   299   458
new oracle model saved
early stop counter: 3
val acc:0.8118904232978821, best validation acc: 0.8130584359169006, corresponding to test acc:                         0.8292537927627563 / 0.830938458442688
after epoch: 9,now: 2024-08-09 12:28:37.226709,epoch time: 0:14:17.450182,used: 2:16:58.642308,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8908365, 'precision': 0.89287823, 'recall': 0.89080817, 'specificity': 0.89080817, 'f1': 0.8906894, 'auroc': 0.9661934, 'binary_precision': 0.8647518, 'binary_recall': 0.9267967, 'binary_specificity': 0.85481966, 'binary_f1_score': 0.8946999}
confusion matrix:
       0      1
0  21709   3687
1   1862  23574
---- Validation: 
scalar performance:
{'acc': 0.81253284, 'precision': 0.51651037, 'recall': 0.599839, 'specificity': 0.599839, 'f1': 0.49358073, 'auroc': 0.65976816, 'binary_precision': 0.05220754, 'binary_recall': 0.37587008, 'binary_specificity': 0.82380784, 'binary_f1_score': 0.09168081}
confusion matrix:
       0     1
0  13751  2941
1    269   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8365871, 'precision': 0.6162808, 'recall': 0.75507796, 'specificity': 0.75507796, 'f1': 0.64149505, 'auroc': 0.796716, 'binary_precision': 0.26402116, 'binary_recall': 0.659181, 'binary_specificity': 0.8509749, 'binary_f1_score': 0.37703058}
confusion matrix:
      0     1
0  7943  1391
1   258   499
new oracle model saved
early stop counter: 4
val acc:0.8125328421592712, best validation acc: 0.8130584359169006, corresponding to test acc:                         0.8292537927627563 / 0.8365870714187622
after epoch: 10,now: 2024-08-09 12:42:58.442206,epoch time: 0:14:21.215497,used: 2:31:19.857805,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8963645, 'precision': 0.89990395, 'recall': 0.8963294, 'specificity': 0.8963294, 'f1': 0.89612865, 'auroc': 0.97153676, 'binary_precision': 0.8624681, 'binary_recall': 0.94330645, 'binary_specificity': 0.8493523, 'binary_f1_score': 0.90107787}
confusion matrix:
       0      1
0  21571   3826
1   1442  23993
---- Validation: 
scalar performance:
{'acc': 0.7920341, 'precision': 0.5169097, 'recall': 0.6119277, 'specificity': 0.6119277, 'f1': 0.48764777, 'auroc': 0.66287994, 'binary_precision': 0.052089296, 'binary_recall': 0.42227378, 'binary_specificity': 0.8015816, 'binary_f1_score': 0.09273885}
confusion matrix:
       0     1
0  13380  3312
1    249   182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83827174, 'precision': 0.6189578, 'recall': 0.7608441, 'specificity': 0.7608441, 'f1': 0.6450771, 'auroc': 0.8091955, 'binary_precision': 0.268396, 'binary_recall': 0.669749, 'binary_specificity': 0.85193914, 'binary_f1_score': 0.38321996}
confusion matrix:
      0     1
0  7952  1382
1   250   507
new oracle model saved
early stop counter: 5
val acc:0.7920340895652771, best validation acc: 0.8130584359169006, corresponding to test acc:                         0.8292537927627563 / 0.8382717370986938
after epoch: 11,now: 2024-08-09 12:57:23.865010,epoch time: 0:14:25.422804,used: 2:45:45.280609,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.90069246, 'precision': 0.9026284, 'recall': 0.90066934, 'specificity': 0.90066934, 'f1': 0.90056914, 'auroc': 0.9707163, 'binary_precision': 0.87487584, 'binary_recall': 0.9352809, 'binary_specificity': 0.8660577, 'binary_f1_score': 0.9040705}
confusion matrix:
       0      1
0  21997   3402
1   1646  23787
---- Validation: 
scalar performance:
{'acc': 0.81977457, 'precision': 0.5178645, 'recall': 0.60468346, 'specificity': 0.60468346, 'f1': 0.4977304, 'auroc': 0.6665285, 'binary_precision': 0.054679636, 'binary_recall': 0.37819025, 'binary_specificity': 0.83117664, 'binary_f1_score': 0.09554513}
confusion matrix:
       0     1
0  13874  2818
1    268   163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85918146, 'precision': 0.626807, 'recall': 0.7405863, 'specificity': 0.7405863, 'f1': 0.65539354, 'auroc': 0.787662, 'binary_precision': 0.28907242, 'binary_recall': 0.6010568, 'binary_specificity': 0.8801157, 'binary_f1_score': 0.39039043}
confusion matrix:
      0     1
0  8215  1119
1   302   455
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-09 13:11:40.545501,epoch time: 0:14:16.680491,used: 3:00:01.961100,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9074402, 'precision': 0.90963197, 'recall': 0.90741, 'specificity': 0.90741, 'f1': 0.9073117, 'auroc': 0.9752999, 'binary_precision': 0.87987393, 'binary_recall': 0.94390064, 'binary_specificity': 0.87091947, 'binary_f1_score': 0.91076344}
confusion matrix:
       0      1
0  22117   3278
1   1427  24010
---- Validation: 
scalar performance:
{'acc': 0.8093208, 'precision': 0.5186466, 'recall': 0.61514354, 'specificity': 0.61514354, 'f1': 0.4956059, 'auroc': 0.6626524, 'binary_precision': 0.055520702, 'binary_recall': 0.41067284, 'binary_specificity': 0.8196142, 'binary_f1_score': 0.09781707}
confusion matrix:
       0     1
0  13681  3011
1    254   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445149, 'precision': 0.62316716, 'recall': 0.762398, 'specificity': 0.762398, 'f1': 0.65101504, 'auroc': 0.7985753, 'binary_precision': 0.2769231, 'binary_recall': 0.66578597, 'binary_specificity': 0.8590101, 'binary_f1_score': 0.39115247}
confusion matrix:
      0     1
0  8018  1316
1   253   504
early stop counter: 1
val acc:0.8093208074569702, best validation acc: 0.8197745680809021, corresponding to test acc:                         0.8591814637184143 / 0.8591814637184143
after epoch: 13,now: 2024-08-09 13:25:45.013977,epoch time: 0:14:04.468476,used: 3:14:06.429576,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9077943, 'precision': 0.91043437, 'recall': 0.9077644, 'specificity': 0.9077644, 'f1': 0.9076413, 'auroc': 0.9766779, 'binary_precision': 0.87770337, 'binary_recall': 0.9477885, 'binary_specificity': 0.8677403, 'binary_f1_score': 0.9114005}
confusion matrix:
       0      1
0  22038   3359
1   1328  24107
---- Validation: 
scalar performance:
{'acc': 0.80605036, 'precision': 0.51847434, 'recall': 0.61572635, 'specificity': 0.61572635, 'f1': 0.49433124, 'auroc': 0.68079436, 'binary_precision': 0.05511084, 'binary_recall': 0.4153132, 'binary_specificity': 0.81613946, 'binary_f1_score': 0.09730905}
confusion matrix:
       0     1
0  13623  3069
1    252   179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8691904, 'precision': 0.63581717, 'recall': 0.742355, 'specificity': 0.742355, 'f1': 0.6656945, 'auroc': 0.80701554, 'binary_precision': 0.30732375, 'binary_recall': 0.59313077, 'binary_specificity': 0.89157915, 'binary_f1_score': 0.40486926}
confusion matrix:
      0     1
0  8322  1012
1   308   449
new oracle model saved
early stop counter: 2
val acc:0.8060503602027893, best validation acc: 0.8197745680809021, corresponding to test acc:                         0.8591814637184143 / 0.8691903948783875
after epoch: 14,now: 2024-08-09 13:40:03.839728,epoch time: 0:14:18.825751,used: 3:28:25.255327,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9146797, 'precision': 0.9151542, 'recall': 0.9146658, 'specificity': 0.9146658, 'f1': 0.9146534, 'auroc': 0.97614884, 'binary_precision': 0.9013238, 'binary_recall': 0.9314778, 'binary_specificity': 0.8978539, 'binary_f1_score': 0.9161527}
confusion matrix:
       0      1
0  22801   2594
1   1743  23694
---- Validation: 
scalar performance:
{'acc': 0.8566256, 'precision': 0.5240917, 'recall': 0.6156738, 'specificity': 0.6156738, 'f1': 0.51738447, 'auroc': 0.6912673, 'binary_precision': 0.06678082, 'binary_recall': 0.36194897, 'binary_specificity': 0.86939853, 'binary_f1_score': 0.1127575}
confusion matrix:
       0     1
0  14512  2180
1    275   156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.900109, 'precision': 0.66231537, 'recall': 0.7008024, 'specificity': 0.7008024, 'f1': 0.6786606, 'auroc': 0.8157427, 'binary_precision': 0.36886102, 'binary_recall': 0.4663144, 'binary_specificity': 0.93529034, 'binary_f1_score': 0.411902}
confusion matrix:
      0    1
0  8730  604
1   404  353
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-09 13:54:18.187865,epoch time: 0:14:14.348137,used: 3:42:39.603464,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_11_38_seed_1_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:42:39.603464 at 2024-08-09 13:54:18.187865
persisted model performance metric: 

scalar performance:
{'acc': 0.900109, 'precision': 0.66231537, 'recall': 0.7008024, 'specificity': 0.7008024, 'f1': 0.6786606, 'auroc': 0.8157427, 'binary_precision': 0.36886102, 'binary_recall': 0.4663144, 'binary_specificity': 0.93529034, 'binary_f1_score': 0.411902}
confusion matrix:
      0    1
0  8730  604
1   404  353
oracle model performance metric: 

scalar performance:
{'acc': 0.900109, 'precision': 0.66231537, 'recall': 0.7008024, 'specificity': 0.7008024, 'f1': 0.6786606, 'auroc': 0.8157427, 'binary_precision': 0.36886102, 'binary_recall': 0.4663144, 'binary_specificity': 0.93529034, 'binary_f1_score': 0.411902}
confusion matrix:
      0    1
0  8730  604
1   404  353
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 574656 KiB | 407881 GiB | 407881 GiB |
|       from large pool | 165120 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1090 MiB | 489472 KiB |
|       from large pool | 550912 KiB | 661504 KiB |    984 MiB | 456704 KiB |
|       from small pool |  75776 KiB |  77824 KiB |    106 MiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 257068 GiB | 257068 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |   9343 KiB |  14884 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7123    |   87545 K  |   87541 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59625 K  |   59620 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7123    |   87545 K  |   87541 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59625 K  |   59620 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      77    |      23    |
|       from large pool |      17    |      17    |      24    |       7    |
|       from small pool |      37    |      38    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      50    |    3190    |   46443 K  |   46443 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |      47    |    3187    |   28390 K  |   28390 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407881 GiB | 407881 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257068 GiB | 257068 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |      0 KiB |  16938 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46445 K  |   46445 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |       0    |    3187    |   28392 K  |   28392 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407881 GiB | 407881 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257068 GiB | 257068 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |      0 KiB |  16938 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46445 K  |   46445 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |       0    |    3187    |   28392 K  |   28392 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700

 Experiment start at: 2024-08-09 14:14:12.427644
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.74671155, 'precision': 0.7710159, 'recall': 0.74667096, 'specificity': 0.74667096, 'f1': 0.74088204, 'auroc': 0.8566984, 'binary_precision': 0.6899241, 'binary_recall': 0.896461, 'binary_specificity': 0.5968809, 'binary_f1_score': 0.7797477}
confusion matrix:
       0      1
0  15424  10417
1   2677  23178
---- Validation: 
scalar performance:
{'acc': 0.5961224, 'precision': 0.512413, 'recall': 0.6262357, 'specificity': 0.6262357, 'f1': 0.40771705, 'auroc': 0.67681515, 'binary_precision': 0.03901816, 'binary_recall': 0.65789473, 'binary_specificity': 0.5945768, 'binary_f1_score': 0.073667295}
confusion matrix:
      0     1
0  9933  6773
1   143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.33055887, 'precision': 0.49962685, 'recall': 0.49892437, 'specificity': 0.49892437, 'f1': 0.29645318, 'auroc': 0.5160574, 'binary_precision': 0.07875018, 'binary_recall': 0.6988708, 'binary_specificity': 0.29897794, 'binary_f1_score': 0.14155018}
confusion matrix:
      0     1
0  2779  6516
1   240   557
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 14:30:55.870404,epoch time: 0:16:43.442760,used: 0:16:43.442760,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8176648, 'precision': 0.82673633, 'recall': 0.81765187, 'specificity': 0.81765187, 'f1': 0.81638616, 'auroc': 0.9115119, 'binary_precision': 0.7723324, 'binary_recall': 0.90097475, 'binary_specificity': 0.73432904, 'binary_f1_score': 0.8317086}
confusion matrix:
       0      1
0  18978   6866
1   2560  23292
---- Validation: 
scalar performance:
{'acc': 0.6949895, 'precision': 0.5128943, 'recall': 0.61509526, 'specificity': 0.61509526, 'f1': 0.44780228, 'auroc': 0.64706147, 'binary_precision': 0.042293772, 'binary_recall': 0.53110045, 'binary_specificity': 0.6990901, 'binary_f1_score': 0.07834833}
confusion matrix:
       0     1
0  11679  5027
1    196   222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5196195, 'precision': 0.5272212, 'recall': 0.5935303, 'specificity': 0.5935303, 'f1': 0.4214013, 'auroc': 0.63414717, 'binary_precision': 0.10570372, 'binary_recall': 0.6813049, 'binary_specificity': 0.5057558, 'binary_f1_score': 0.18301314}
confusion matrix:
      0     1
0  4701  4594
1   254   543
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 14:45:38.413360,epoch time: 0:14:42.542956,used: 0:31:25.985716,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.83381695, 'precision': 0.8497556, 'recall': 0.83380455, 'specificity': 0.83380455, 'f1': 0.8318982, 'auroc': 0.933029, 'binary_precision': 0.77512115, 'binary_recall': 0.9405439, 'binary_specificity': 0.7270652, 'binary_f1_score': 0.8498575}
confusion matrix:
       0      1
0  18791   7054
1   1537  24314
---- Validation: 
scalar performance:
{'acc': 0.6461691, 'precision': 0.5117544, 'recall': 0.6133992, 'specificity': 0.6133992, 'f1': 0.4276376, 'auroc': 0.6537827, 'binary_precision': 0.039510205, 'binary_recall': 0.57894737, 'binary_specificity': 0.64785105, 'binary_f1_score': 0.07397219}
confusion matrix:
       0     1
0  10823  5883
1    176   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4635355, 'precision': 0.53590554, 'recall': 0.6198663, 'specificity': 0.6198663, 'f1': 0.39512286, 'auroc': 0.7014501, 'binary_precision': 0.10879512, 'binary_recall': 0.8055207, 'binary_specificity': 0.43421194, 'binary_f1_score': 0.19169903}
confusion matrix:
      0     1
0  4036  5259
1   155   642
early stop counter: 1
val acc:0.646169126033783, best validation acc: 0.6949895024299622, corresponding to test acc:                         0.5196195244789124 / 0.5196195244789124
after epoch: 3,now: 2024-08-09 15:00:20.240173,epoch time: 0:14:41.826813,used: 0:46:07.812529,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.84714484, 'precision': 0.8584196, 'recall': 0.8471174, 'specificity': 0.8471174, 'f1': 0.845926, 'auroc': 0.9391585, 'binary_precision': 0.7949274, 'binary_recall': 0.9357983, 'binary_specificity': 0.75843656, 'binary_f1_score': 0.8596298}
confusion matrix:
       0      1
0  19598   6242
1   1660  24196
---- Validation: 
scalar performance:
{'acc': 0.7144359, 'precision': 0.5160019, 'recall': 0.63789046, 'specificity': 0.63789046, 'f1': 0.45887715, 'auroc': 0.67401993, 'binary_precision': 0.047185097, 'binary_recall': 0.55741626, 'binary_specificity': 0.71836466, 'binary_f1_score': 0.08700523}
confusion matrix:
       0     1
0  12001  4705
1    185   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63188666, 'precision': 0.54976743, 'recall': 0.6642276, 'specificity': 0.6642276, 'f1': 0.49480444, 'auroc': 0.6960987, 'binary_precision': 0.13868251, 'binary_recall': 0.7026349, 'binary_specificity': 0.62582034, 'binary_f1_score': 0.23164424}
confusion matrix:
      0     1
0  5817  3478
1   237   560
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 15:15:04.994702,epoch time: 0:14:44.754529,used: 1:00:52.567058,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86792016, 'precision': 0.87022537, 'recall': 0.86791253, 'specificity': 0.86791253, 'f1': 0.86771256, 'auroc': 0.9469825, 'binary_precision': 0.84105986, 'binary_recall': 0.90736085, 'binary_specificity': 0.8284642, 'binary_f1_score': 0.8729533}
confusion matrix:
       0      1
0  21410   4433
1   2395  23458
---- Validation: 
scalar performance:
{'acc': 0.7691544, 'precision': 0.512268, 'recall': 0.5901285, 'specificity': 0.5901285, 'f1': 0.47319645, 'auroc': 0.6359515, 'binary_precision': 0.04339964, 'binary_recall': 0.40191388, 'binary_specificity': 0.7783431, 'binary_f1_score': 0.07833994}
confusion matrix:
       0     1
0  13003  3703
1    250   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6619104, 'precision': 0.5556592, 'recall': 0.67823243, 'specificity': 0.67823243, 'f1': 0.5139601, 'auroc': 0.71710384, 'binary_precision': 0.14918165, 'binary_recall': 0.69761604, 'binary_specificity': 0.6588488, 'binary_f1_score': 0.24580018}
confusion matrix:
      0     1
0  6124  3171
1   241   556
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 15:29:47.435735,epoch time: 0:14:42.441033,used: 1:15:35.008091,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8766055, 'precision': 0.87971056, 'recall': 0.87659335, 'specificity': 0.87659335, 'f1': 0.8763503, 'auroc': 0.9554454, 'binary_precision': 0.84544164, 'binary_recall': 0.92179465, 'binary_specificity': 0.831392, 'binary_f1_score': 0.88196874}
confusion matrix:
       0      1
0  21484   4357
1   2022  23833
---- Validation: 
scalar performance:
{'acc': 0.79309744, 'precision': 0.5179184, 'recall': 0.62222564, 'specificity': 0.62222564, 'f1': 0.48888043, 'auroc': 0.6820036, 'binary_precision': 0.05293276, 'binary_recall': 0.44258374, 'binary_specificity': 0.8018676, 'binary_f1_score': 0.09455661}
confusion matrix:
       0     1
0  13396  3310
1    233   185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7508918, 'precision': 0.5691825, 'recall': 0.6858152, 'specificity': 0.6858152, 'f1': 0.5639384, 'auroc': 0.72096527, 'binary_precision': 0.1804987, 'binary_recall': 0.608532, 'binary_specificity': 0.7630984, 'binary_f1_score': 0.27841562}
confusion matrix:
      0     1
0  7093  2202
1   312   485
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 15:47:17.702642,epoch time: 0:17:30.266907,used: 1:33:05.274998,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8506461, 'precision': 0.8708534, 'recall': 0.8506371, 'specificity': 0.8506371, 'f1': 0.84858114, 'auroc': 0.9587705, 'binary_precision': 0.7843051, 'binary_recall': 0.9673501, 'binary_specificity': 0.73392403, 'binary_f1_score': 0.8662636}
confusion matrix:
       0      1
0  18969   6877
1    844  25006
---- Validation: 
scalar performance:
{'acc': 0.7073114, 'precision': 0.5188426, 'recall': 0.6657276, 'specificity': 0.6657276, 'f1': 0.45973086, 'auroc': 0.7158977, 'binary_precision': 0.05084083, 'binary_recall': 0.6220096, 'binary_specificity': 0.7094457, 'binary_f1_score': 0.09399855}
confusion matrix:
       0     1
0  11852  4854
1    158   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.728696, 'precision': 0.5684375, 'recall': 0.69613457, 'specificity': 0.69613457, 'f1': 0.5549189, 'auroc': 0.7279178, 'binary_precision': 0.17530946, 'binary_recall': 0.6574655, 'binary_specificity': 0.7348037, 'binary_f1_score': 0.2768093}
confusion matrix:
      0     1
0  6830  2465
1   273   524
early stop counter: 1
val acc:0.7073113918304443, best validation acc: 0.7930974364280701, corresponding to test acc:                         0.7508918046951294 / 0.7508918046951294
after epoch: 7,now: 2024-08-09 16:05:40.922765,epoch time: 0:18:23.220123,used: 1:51:28.495121,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8809773, 'precision': 0.8837813, 'recall': 0.8809657, 'specificity': 0.8809657, 'f1': 0.88075715, 'auroc': 0.9590749, 'binary_precision': 0.8510441, 'binary_recall': 0.9236898, 'binary_specificity': 0.8382416, 'binary_f1_score': 0.8858801}
confusion matrix:
       0      1
0  21661   4180
1   1973  23882
---- Validation: 
scalar performance:
{'acc': 0.7808339, 'precision': 0.5159694, 'recall': 0.613608, 'specificity': 0.613608, 'f1': 0.48214605, 'auroc': 0.6674045, 'binary_precision': 0.049446095, 'binary_recall': 0.43779904, 'binary_specificity': 0.78941697, 'binary_f1_score': 0.08885652}
confusion matrix:
       0     1
0  13188  3518
1    235   183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77358305, 'precision': 0.5741485, 'recall': 0.68551534, 'specificity': 0.68551534, 'f1': 0.576879, 'auroc': 0.72461957, 'binary_precision': 0.19179785, 'binary_recall': 0.5809285, 'binary_specificity': 0.7901022, 'binary_f1_score': 0.2883837}
confusion matrix:
      0     1
0  7344  1951
1   334   463
new oracle model saved
early stop counter: 2
val acc:0.780833899974823, best validation acc: 0.7930974364280701, corresponding to test acc:                         0.7508918046951294 / 0.7735830545425415
after epoch: 8,now: 2024-08-09 16:23:59.791136,epoch time: 0:18:18.868371,used: 2:09:47.363492,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89834803, 'precision': 0.90082455, 'recall': 0.898345, 'specificity': 0.898345, 'f1': 0.89819026, 'auroc': 0.9701115, 'binary_precision': 0.86933756, 'binary_recall': 0.93764025, 'binary_specificity': 0.85904974, 'binary_f1_score': 0.902198}
confusion matrix:
       0      1
0  22203   3643
1   1612  24238
---- Validation: 
scalar performance:
{'acc': 0.7886008, 'precision': 0.5151939, 'recall': 0.60475993, 'specificity': 0.60475993, 'f1': 0.48362297, 'auroc': 0.6561794, 'binary_precision': 0.04850536, 'binary_recall': 0.41148326, 'binary_specificity': 0.79803663, 'binary_f1_score': 0.086781025}
confusion matrix:
       0     1
0  13332  3374
1    246   172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79300433, 'precision': 0.5900366, 'recall': 0.7172804, 'specificity': 0.7172804, 'f1': 0.600765, 'auroc': 0.75443316, 'binary_precision': 0.2181501, 'binary_recall': 0.6273526, 'binary_specificity': 0.8072082, 'binary_f1_score': 0.3237294}
confusion matrix:
      0     1
0  7503  1792
1   297   500
new oracle model saved
early stop counter: 3
val acc:0.7886008024215698, best validation acc: 0.7930974364280701, corresponding to test acc:                         0.7508918046951294 / 0.7930043339729309
after epoch: 9,now: 2024-08-09 16:42:14.247224,epoch time: 0:18:14.456088,used: 2:28:01.819580,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9011722, 'precision': 0.9016502, 'recall': 0.9011676, 'specificity': 0.9011676, 'f1': 0.9011421, 'auroc': 0.9672427, 'binary_precision': 0.8878627, 'binary_recall': 0.91839105, 'binary_specificity': 0.8839441, 'binary_f1_score': 0.9028689}
confusion matrix:
       0      1
0  22842   2999
1   2110  23745
---- Validation: 
scalar performance:
{'acc': 0.8434361, 'precision': 0.5177855, 'recall': 0.59437764, 'specificity': 0.59437764, 'f1': 0.5041328, 'auroc': 0.6815133, 'binary_precision': 0.054702874, 'binary_recall': 0.3325359, 'binary_specificity': 0.85621935, 'binary_f1_score': 0.09395066}
confusion matrix:
       0     1
0  14304  2402
1    279   139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84324217, 'precision': 0.6036844, 'recall': 0.68949133, 'specificity': 0.68949133, 'f1': 0.6245845, 'auroc': 0.73809457, 'binary_precision': 0.25360954, 'binary_recall': 0.5069009, 'binary_specificity': 0.87208176, 'binary_f1_score': 0.33807534}
confusion matrix:
      0     1
0  8106  1189
1   393   404
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-09 17:01:16.058755,epoch time: 0:19:01.811531,used: 2:47:03.631111,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9099157, 'precision': 0.91004133, 'recall': 0.9099143, 'specificity': 0.9099143, 'f1': 0.90990853, 'auroc': 0.97182155, 'binary_precision': 0.9029008, 'binary_recall': 0.91865236, 'binary_specificity': 0.9011763, 'binary_f1_score': 0.9107085}
confusion matrix:
       0      1
0  23290   2554
1   2103  23749
---- Validation: 
scalar performance:
{'acc': 0.8528965, 'precision': 0.519316, 'recall': 0.59689367, 'specificity': 0.59689367, 'f1': 0.5090099, 'auroc': 0.67903244, 'binary_precision': 0.05768421, 'binary_recall': 0.3277512, 'binary_specificity': 0.8660362, 'binary_f1_score': 0.0981024}
confusion matrix:
       0     1
0  14468  2238
1    281   137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85800636, 'precision': 0.61551374, 'recall': 0.69291794, 'specificity': 0.69291794, 'f1': 0.63808113, 'auroc': 0.73718655, 'binary_precision': 0.27731094, 'binary_recall': 0.49686325, 'binary_specificity': 0.8889726, 'binary_f1_score': 0.35595506}
confusion matrix:
      0     1
0  8263  1032
1   401   396
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-09 17:22:38.459756,epoch time: 0:21:22.401001,used: 3:08:26.032112,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9113084, 'precision': 0.9124478, 'recall': 0.91130435, 'specificity': 0.91130435, 'f1': 0.91124654, 'auroc': 0.97543335, 'binary_precision': 0.89080817, 'binary_recall': 0.9375677, 'binary_specificity': 0.885041, 'binary_f1_score': 0.9135901}
confusion matrix:
       0      1
0  22873   2971
1   1614  24238
---- Validation: 
scalar performance:
{'acc': 0.82118666, 'precision': 0.5242224, 'recall': 0.64828414, 'specificity': 0.64828414, 'f1': 0.5067748, 'auroc': 0.71422315, 'binary_precision': 0.06427159, 'binary_recall': 0.46650717, 'binary_specificity': 0.8300611, 'binary_f1_score': 0.11297798}
confusion matrix:
       0     1
0  13867  2839
1    223   195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8548355, 'precision': 0.6176971, 'recall': 0.7061091, 'specificity': 0.7061091, 'f1': 0.6417841, 'auroc': 0.76047647, 'binary_precision': 0.27910054, 'binary_recall': 0.5294856, 'binary_specificity': 0.8827326, 'binary_f1_score': 0.36552623}
confusion matrix:
      0     1
0  8205  1090
1   375   422
early stop counter: 1
val acc:0.8211866617202759, best validation acc: 0.852896511554718, corresponding to test acc:                         0.8580063581466675 / 0.8580063581466675
after epoch: 12,now: 2024-08-09 17:44:40.720078,epoch time: 0:22:02.260322,used: 3:30:28.292434,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9043833, 'precision': 0.90761006, 'recall': 0.90437984, 'specificity': 0.90437984, 'f1': 0.90419316, 'auroc': 0.9750221, 'binary_precision': 0.8713631, 'binary_recall': 0.9488588, 'binary_specificity': 0.85990095, 'binary_f1_score': 0.9084612}
confusion matrix:
       0      1
0  22225   3621
1   1322  24528
---- Validation: 
scalar performance:
{'acc': 0.80571127, 'precision': 0.52516323, 'recall': 0.66601014, 'specificity': 0.66601014, 'f1': 0.5031332, 'auroc': 0.7290808, 'binary_precision': 0.06491175, 'binary_recall': 0.51913875, 'binary_specificity': 0.8128816, 'binary_f1_score': 0.11539482}
confusion matrix:
       0     1
0  13580  3126
1    201   217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8593936, 'precision': 0.6235669, 'recall': 0.71259844, 'specificity': 0.71259844, 'f1': 0.6487844, 'auroc': 0.7783419, 'binary_precision': 0.28986487, 'binary_recall': 0.5382685, 'binary_specificity': 0.88692844, 'binary_f1_score': 0.3768116}
confusion matrix:
      0     1
0  8244  1051
1   368   429
new oracle model saved
early stop counter: 2
val acc:0.8057112693786621, best validation acc: 0.852896511554718, corresponding to test acc:                         0.8580063581466675 / 0.8593935966491699
after epoch: 13,now: 2024-08-09 18:03:50.636693,epoch time: 0:19:09.916615,used: 3:49:38.209049,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9136684, 'precision': 0.91476154, 'recall': 0.9136634, 'specificity': 0.9136634, 'f1': 0.91361076, 'auroc': 0.9771143, 'binary_precision': 0.89351684, 'binary_recall': 0.9393107, 'binary_specificity': 0.8880161, 'binary_f1_score': 0.9158417}
confusion matrix:
       0      1
0  22949   2894
1   1569  24284
---- Validation: 
scalar performance:
{'acc': 0.79934597, 'precision': 0.5174832, 'recall': 0.61609817, 'specificity': 0.61609817, 'f1': 0.4902963, 'auroc': 0.6861088, 'binary_precision': 0.052491102, 'binary_recall': 0.423445, 'binary_specificity': 0.80875134, 'binary_f1_score': 0.09340369}
confusion matrix:
       0     1
0  13511  3195
1    241   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702933, 'precision': 0.64008284, 'recall': 0.7328546, 'specificity': 0.7328546, 'f1': 0.6683533, 'auroc': 0.76819885, 'binary_precision': 0.3197183, 'binary_recall': 0.5696361, 'binary_specificity': 0.89607316, 'binary_f1_score': 0.40956247}
confusion matrix:
      0    1
0  8329  966
1   343  454
new oracle model saved
early stop counter: 3
val acc:0.7993459701538086, best validation acc: 0.852896511554718, corresponding to test acc:                         0.8580063581466675 / 0.8702933192253113
after epoch: 14,now: 2024-08-09 18:24:13.893537,epoch time: 0:20:23.256844,used: 4:10:01.465893,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9143261, 'precision': 0.9152827, 'recall': 0.9143224, 'specificity': 0.9143224, 'f1': 0.9142761, 'auroc': 0.97653246, 'binary_precision': 0.8953896, 'binary_recall': 0.93830264, 'binary_specificity': 0.89034206, 'binary_f1_score': 0.9163439}
confusion matrix:
       0      1
0  23010   2834
1   1595  24257
---- Validation: 
scalar performance:
{'acc': 0.84010744, 'precision': 0.52259064, 'recall': 0.6241602, 'specificity': 0.6241602, 'f1': 0.51016253, 'auroc': 0.68441427, 'binary_precision': 0.06259427, 'binary_recall': 0.39712918, 'binary_specificity': 0.85119116, 'binary_f1_score': 0.10814334}
confusion matrix:
       0     1
0  14220  2486
1    252   166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85275465, 'precision': 0.6264063, 'recall': 0.7370989, 'specificity': 0.7370989, 'f1': 0.6538632, 'auroc': 0.776103, 'binary_precision': 0.2905775, 'binary_recall': 0.5997491, 'binary_specificity': 0.87444866, 'binary_f1_score': 0.39148238}
confusion matrix:
      0     1
0  8128  1167
1   319   478
early stop counter: 4
val acc:0.8401074409484863, best validation acc: 0.852896511554718, corresponding to test acc:                         0.8580063581466675 / 0.8702933192253113
after epoch: 15,now: 2024-08-09 18:44:05.736753,epoch time: 0:19:51.843216,used: 4:29:53.309109,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_14_12_seed_2_24132700
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:29:53.309109 at 2024-08-09 18:44:05.736753
persisted model performance metric: 

scalar performance:
{'acc': 0.85800636, 'precision': 0.61551374, 'recall': 0.69291794, 'specificity': 0.69291794, 'f1': 0.63808113, 'auroc': 0.73718655, 'binary_precision': 0.27731094, 'binary_recall': 0.49686325, 'binary_specificity': 0.8889726, 'binary_f1_score': 0.35595506}
confusion matrix:
      0     1
0  8263  1032
1   401   396
oracle model performance metric: 

scalar performance:
{'acc': 0.8702933, 'precision': 0.64008284, 'recall': 0.7328546, 'specificity': 0.7328546, 'f1': 0.6683533, 'auroc': 0.76819885, 'binary_precision': 0.3197183, 'binary_recall': 0.5696361, 'binary_specificity': 0.89607316, 'binary_f1_score': 0.40956247}
confusion matrix:
      0    1
0  8329  966
1   343  454
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624066 GiB | 624065 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624066 GiB | 624065 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 579948 KiB | 618484 GiB | 618484 GiB |
|       from large pool | 165120 KiB | 508176 KiB | 617636 GiB | 617635 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1476 MiB |    864 MiB |
|       from large pool | 550912 KiB | 661504 KiB |   1342 MiB |    804 MiB |
|       from small pool |  75776 KiB |  77824 KiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 378041 GiB | 378041 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 377090 GiB | 377090 GiB |
|       from small pool |   9343 KiB |  16938 KiB |    950 GiB |    950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7231    |  132535 K  |  132530 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90198 K  |   90194 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7231    |  132535 K  |  132530 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90198 K  |   90194 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      99    |      45    |
|       from large pool |      17    |      17    |      32    |      15    |
|       from small pool |      37    |      38    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3243    |   70671 K  |   70671 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |      49    |    3240    |   42937 K  |   42937 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 579948 KiB | 618484 GiB | 618484 GiB |
|       from large pool |  16640 KiB | 508176 KiB | 617636 GiB | 617636 GiB |
|       from small pool |      0 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1476 MiB |   1250 MiB |
|       from large pool | 184320 KiB | 661504 KiB |   1342 MiB |   1162 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    134 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 378041 GiB | 378041 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 377090 GiB | 377090 GiB |
|       from small pool |      0 KiB |  16938 KiB |    950 GiB |    950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7231    |  132535 K  |  132535 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90198 K  |   90198 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7231    |  132535 K  |  132535 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90198 K  |   90198 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      99    |      67    |
|       from large pool |       9    |      17    |      32    |      23    |
|       from small pool |      23    |      38    |      67    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3243    |   70673 K  |   70673 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |       0    |    3240    |   42939 K  |   42939 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 19:01:36 2024]
Finished job 0.
1 of 1 steps (100%) done
