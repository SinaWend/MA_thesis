Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 09:22:20 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/15.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=15
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710

 Experiment start at: 2024-08-09 09:29:22.593549
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.75286245, 'precision': 0.7761991, 'recall': 0.7527878, 'specificity': 0.7527878, 'f1': 0.7474928, 'auroc': 0.8502126, 'binary_precision': 0.6960431, 'binary_recall': 0.89822817, 'binary_specificity': 0.6073474, 'binary_f1_score': 0.78431517}
confusion matrix:
       0      1
0  15375   9940
1   2579  22762
---- Validation: 
scalar performance:
{'acc': 0.49930012, 'precision': 0.507794, 'recall': 0.58247423, 'specificity': 0.58247423, 'f1': 0.35974327, 'auroc': 0.6232298, 'binary_precision': 0.031858813, 'binary_recall': 0.6698795, 'binary_specificity': 0.49506903, 'binary_f1_score': 0.060824856}
confusion matrix:
      0     1
0  8283  8448
1   137   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.2111924, 'precision': 0.48448554, 'recall': 0.469028, 'specificity': 0.469028, 'f1': 0.20428984, 'auroc': 0.40280688, 'binary_precision': 0.07107143, 'binary_recall': 0.7733161, 'binary_specificity': 0.16473988, 'binary_f1_score': 0.13017881}
confusion matrix:
      0     1
0  1539  7803
1   175   597
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 09:44:24.913428,epoch time: 0:15:02.319879,used: 0:15:02.319879,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8247789, 'precision': 0.83690083, 'recall': 0.8247152, 'specificity': 0.8247152, 'f1': 0.8231686, 'auroc': 0.9156108, 'binary_precision': 0.773163, 'binary_recall': 0.91958964, 'binary_specificity': 0.72984076, 'binary_f1_score': 0.84004325}
confusion matrix:
       0      1
0  18473   6838
1   2038  23307
---- Validation: 
scalar performance:
{'acc': 0.66907734, 'precision': 0.51066095, 'recall': 0.60014737, 'specificity': 0.60014737, 'f1': 0.4351569, 'auroc': 0.63426214, 'binary_precision': 0.038441285, 'binary_recall': 0.52771086, 'binary_specificity': 0.6725838, 'binary_f1_score': 0.07166231}
confusion matrix:
       0     1
0  11253  5478
1    196   219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.401226, 'precision': 0.5192165, 'recall': 0.5629845, 'specificity': 0.5629845, 'f1': 0.34782955, 'auroc': 0.55888784, 'binary_precision': 0.09026054, 'binary_recall': 0.753886, 'binary_specificity': 0.37208307, 'binary_f1_score': 0.16121884}
confusion matrix:
      0     1
0  3476  5866
1   190   582
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 09:58:30.188397,epoch time: 0:14:05.274969,used: 0:29:07.594848,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8518833, 'precision': 0.86327606, 'recall': 0.85183436, 'specificity': 0.85183436, 'f1': 0.8507004, 'auroc': 0.93722034, 'binary_precision': 0.79908127, 'binary_recall': 0.9403757, 'binary_specificity': 0.763293, 'binary_f1_score': 0.8639899}
confusion matrix:
       0      1
0  19322   5992
1   1511  23831
---- Validation: 
scalar performance:
{'acc': 0.70978653, 'precision': 0.513443, 'recall': 0.61748207, 'specificity': 0.61748207, 'f1': 0.45380318, 'auroc': 0.66329676, 'binary_precision': 0.043260563, 'binary_recall': 0.52048194, 'binary_specificity': 0.7144821, 'binary_f1_score': 0.07988165}
confusion matrix:
       0     1
0  11954  4777
1    199   216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50415266, 'precision': 0.528373, 'recall': 0.60028213, 'specificity': 0.60028213, 'f1': 0.41237858, 'auroc': 0.60136545, 'binary_precision': 0.103087, 'binary_recall': 0.7137306, 'binary_specificity': 0.48683366, 'binary_f1_score': 0.18015368}
confusion matrix:
      0     1
0  4548  4794
1   221   551
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 10:12:56.084949,epoch time: 0:14:25.896552,used: 0:43:33.491400,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8493565, 'precision': 0.8597027, 'recall': 0.8493062, 'specificity': 0.8493062, 'f1': 0.8482523, 'auroc': 0.93692327, 'binary_precision': 0.79884595, 'binary_recall': 0.9341041, 'binary_specificity': 0.76450837, 'binary_f1_score': 0.8611966}
confusion matrix:
       0      1
0  19352   5961
1   1670  23673
---- Validation: 
scalar performance:
{'acc': 0.6865158, 'precision': 0.510298, 'recall': 0.5938087, 'specificity': 0.5938087, 'f1': 0.44131532, 'auroc': 0.6268057, 'binary_precision': 0.038346983, 'binary_recall': 0.49638554, 'binary_specificity': 0.69123185, 'binary_f1_score': 0.07119405}
confusion matrix:
       0     1
0  11565  5166
1    209   206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5276844, 'precision': 0.5402867, 'recall': 0.6427276, 'specificity': 0.6427276, 'f1': 0.43289268, 'auroc': 0.66701245, 'binary_precision': 0.11542155, 'binary_recall': 0.7784974, 'binary_specificity': 0.5069578, 'binary_f1_score': 0.20103696}
confusion matrix:
      0     1
0  4736  4606
1   171   601
new oracle model saved
early stop counter: 1
val acc:0.6865158081054688, best validation acc: 0.7097865343093872, corresponding to test acc:                         0.5041526556015015 / 0.5276843905448914
after epoch: 4,now: 2024-08-09 10:27:25.246719,epoch time: 0:14:29.161770,used: 0:58:02.653170,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.866235, 'precision': 0.87018764, 'recall': 0.86620235, 'specificity': 0.86620235, 'f1': 0.8658695, 'auroc': 0.9445075, 'binary_precision': 0.8320933, 'binary_recall': 0.9178504, 'binary_specificity': 0.81455433, 'binary_f1_score': 0.8728705}
confusion matrix:
       0      1
0  20618   4694
1   2082  23262
---- Validation: 
scalar performance:
{'acc': 0.7703254, 'precision': 0.50920266, 'recall': 0.5674318, 'specificity': 0.5674318, 'f1': 0.469233, 'auroc': 0.6285739, 'binary_precision': 0.03851192, 'binary_recall': 0.35421687, 'binary_specificity': 0.7806467, 'binary_f1_score': 0.0694707}
confusion matrix:
       0     1
0  13061  3670
1    268   147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62606287, 'precision': 0.5435865, 'recall': 0.64845, 'specificity': 0.64845, 'f1': 0.4852413, 'auroc': 0.66929686, 'binary_precision': 0.12857848, 'binary_recall': 0.6748705, 'binary_specificity': 0.62202954, 'binary_f1_score': 0.21600333}
confusion matrix:
      0     1
0  5811  3531
1   251   521
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 10:41:54.285815,epoch time: 0:14:29.039096,used: 1:12:31.692266,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8747039, 'precision': 0.8782754, 'recall': 0.8746809, 'specificity': 0.8746809, 'f1': 0.87440264, 'auroc': 0.953792, 'binary_precision': 0.8416376, 'binary_recall': 0.9232439, 'binary_specificity': 0.8261179, 'binary_f1_score': 0.8805541}
confusion matrix:
       0      1
0  20914   4402
1   1945  23395
---- Validation: 
scalar performance:
{'acc': 0.7844395, 'precision': 0.5116655, 'recall': 0.58171344, 'specificity': 0.58171344, 'f1': 0.47722065, 'auroc': 0.64638543, 'binary_precision': 0.04265403, 'binary_recall': 0.3686747, 'binary_specificity': 0.79475224, 'binary_f1_score': 0.07646177}
confusion matrix:
       0     1
0  13297  3434
1    262   153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7334388, 'precision': 0.56158626, 'recall': 0.6774614, 'specificity': 0.6774614, 'f1': 0.5484068, 'auroc': 0.7052691, 'binary_precision': 0.16457462, 'binary_recall': 0.61139894, 'binary_specificity': 0.7435239, 'binary_f1_score': 0.25934064}
confusion matrix:
      0     1
0  6946  2396
1   300   472
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 10:56:08.206254,epoch time: 0:14:13.920439,used: 1:26:45.612705,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88094205, 'precision': 0.8858826, 'recall': 0.88091075, 'specificity': 0.88091075, 'f1': 0.88055354, 'auroc': 0.96060944, 'binary_precision': 0.8423572, 'binary_recall': 0.9374556, 'binary_specificity': 0.824366, 'binary_f1_score': 0.88736576}
confusion matrix:
       0      1
0  20868   4446
1   1585  23757
---- Validation: 
scalar performance:
{'acc': 0.78560597, 'precision': 0.5132659, 'recall': 0.5928856, 'specificity': 0.5928856, 'f1': 0.47982392, 'auroc': 0.6484672, 'binary_precision': 0.045188285, 'binary_recall': 0.39036146, 'binary_specificity': 0.79540974, 'binary_f1_score': 0.08100001}
confusion matrix:
       0     1
0  13308  3423
1    253   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7020961, 'precision': 0.55908114, 'recall': 0.68307257, 'specificity': 0.68307257, 'f1': 0.53343415, 'auroc': 0.7072678, 'binary_precision': 0.15639375, 'binary_recall': 0.66062176, 'binary_specificity': 0.70552343, 'binary_f1_score': 0.25291348}
confusion matrix:
      0     1
0  6591  2751
1   262   510
better model found
persisted
after epoch: 7,now: 2024-08-09 11:10:51.210564,epoch time: 0:14:43.004310,used: 1:41:28.617015,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8837058, 'precision': 0.8888769, 'recall': 0.8836694, 'specificity': 0.8836694, 'f1': 0.8833109, 'auroc': 0.96334004, 'binary_precision': 0.84419125, 'binary_recall': 0.9412879, 'binary_specificity': 0.8260509, 'binary_f1_score': 0.8900995}
confusion matrix:
       0      1
0  20909   4403
1   1488  23856
---- Validation: 
scalar performance:
{'acc': 0.76076055, 'precision': 0.5117699, 'recall': 0.5895542, 'specificity': 0.5895542, 'f1': 0.4695608, 'auroc': 0.6354791, 'binary_precision': 0.04221505, 'binary_recall': 0.40963855, 'binary_specificity': 0.76946986, 'binary_f1_score': 0.076542094}
confusion matrix:
       0     1
0  12874  3857
1    245   170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72671545, 'precision': 0.56674033, 'recall': 0.6981819, 'specificity': 0.6981819, 'f1': 0.5512827, 'auroc': 0.7176169, 'binary_precision': 0.16998012, 'binary_recall': 0.66450775, 'binary_specificity': 0.7318561, 'binary_f1_score': 0.2707124}
confusion matrix:
      0     1
0  6837  2505
1   259   513
early stop counter: 1
val acc:0.7607605457305908, best validation acc: 0.7856059670448303, corresponding to test acc:                         0.7020961046218872 / 0.7334387898445129
after epoch: 8,now: 2024-08-09 11:26:34.428000,epoch time: 0:15:43.217436,used: 1:57:11.834451,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89095074, 'precision': 0.89614826, 'recall': 0.8909191, 'specificity': 0.8909191, 'f1': 0.89058626, 'auroc': 0.96908474, 'binary_precision': 0.8509101, 'binary_recall': 0.9481493, 'binary_specificity': 0.83368886, 'binary_f1_score': 0.8969019}
confusion matrix:
       0      1
0  21104   4210
1   1314  24028
---- Validation: 
scalar performance:
{'acc': 0.7788989, 'precision': 0.5153278, 'recall': 0.61059767, 'specificity': 0.61059767, 'f1': 0.4804753, 'auroc': 0.67430794, 'binary_precision': 0.048179872, 'binary_recall': 0.43373495, 'binary_specificity': 0.7874604, 'binary_f1_score': 0.0867261}
confusion matrix:
       0     1
0  13175  3556
1    235   180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7702195, 'precision': 0.5870797, 'recall': 0.7377735, 'specificity': 0.7377735, 'f1': 0.58956885, 'auroc': 0.7621713, 'binary_precision': 0.20516717, 'binary_recall': 0.69948184, 'binary_specificity': 0.7760651, 'binary_f1_score': 0.3172738}
confusion matrix:
      0     1
0  7250  2092
1   232   540
new oracle model saved
early stop counter: 2
val acc:0.7788988947868347, best validation acc: 0.7856059670448303, corresponding to test acc:                         0.7020961046218872 / 0.7702195048332214
after epoch: 9,now: 2024-08-09 11:40:54.237564,epoch time: 0:14:19.809564,used: 2:11:31.644015,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.889865, 'precision': 0.8929471, 'recall': 0.88983524, 'specificity': 0.88983524, 'f1': 0.8896432, 'auroc': 0.9654808, 'binary_precision': 0.8583134, 'binary_recall': 0.9340698, 'binary_specificity': 0.8456007, 'binary_f1_score': 0.8945906}
confusion matrix:
       0      1
0  21403   3908
1   1671  23674
---- Validation: 
scalar performance:
{'acc': 0.7732999, 'precision': 0.5141973, 'recall': 0.60420394, 'specificity': 0.60420394, 'f1': 0.47706205, 'auroc': 0.65432554, 'binary_precision': 0.046262413, 'binary_recall': 0.426506, 'binary_specificity': 0.78190184, 'binary_f1_score': 0.08347087}
confusion matrix:
       0     1
0  13082  3649
1    238   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7655725, 'precision': 0.5841329, 'recall': 0.731693, 'specificity': 0.731693, 'f1': 0.584666, 'auroc': 0.7548896, 'binary_precision': 0.20022497, 'binary_recall': 0.6917098, 'binary_specificity': 0.7716763, 'binary_f1_score': 0.3105554}
confusion matrix:
      0     1
0  7209  2133
1   238   534
early stop counter: 3
val acc:0.7732998728752136, best validation acc: 0.7856059670448303, corresponding to test acc:                         0.7020961046218872 / 0.7702195048332214
after epoch: 10,now: 2024-08-09 11:55:10.165776,epoch time: 0:14:15.928212,used: 2:25:47.572227,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90555906, 'precision': 0.90744543, 'recall': 0.9055403, 'specificity': 0.9055403, 'f1': 0.9054467, 'auroc': 0.9740144, 'binary_precision': 0.87985957, 'binary_recall': 0.93950754, 'binary_specificity': 0.87157303, 'binary_f1_score': 0.9087058}
confusion matrix:
       0      1
0  22063   3251
1   1533  23809
---- Validation: 
scalar performance:
{'acc': 0.8104514, 'precision': 0.51887715, 'recall': 0.62089056, 'specificity': 0.62089056, 'f1': 0.4956657, 'auroc': 0.6911268, 'binary_precision': 0.054945055, 'binary_recall': 0.42168674, 'binary_specificity': 0.8200944, 'binary_f1_score': 0.097222224}
confusion matrix:
       0     1
0  13721  3010
1    240   175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84645045, 'precision': 0.60698926, 'recall': 0.70239383, 'specificity': 0.70239383, 'f1': 0.62955856, 'auroc': 0.7559445, 'binary_precision': 0.25639427, 'binary_recall': 0.53238344, 'binary_specificity': 0.8724042, 'binary_f1_score': 0.34610528}
confusion matrix:
      0     1
0  8150  1192
1   361   411
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-09 12:09:21.358558,epoch time: 0:14:11.192782,used: 2:39:58.765009,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.90611184, 'precision': 0.90752244, 'recall': 0.90609324, 'specificity': 0.90609324, 'f1': 0.9060276, 'auroc': 0.9726442, 'binary_precision': 0.8837036, 'binary_recall': 0.9354482, 'binary_specificity': 0.8767383, 'binary_f1_score': 0.90883994}
confusion matrix:
       0      1
0  22192   3120
1   1636  23708
---- Validation: 
scalar performance:
{'acc': 0.8167503, 'precision': 0.5164865, 'recall': 0.60179436, 'specificity': 0.60179436, 'f1': 0.4942214, 'auroc': 0.6710942, 'binary_precision': 0.051332675, 'binary_recall': 0.3759036, 'binary_specificity': 0.8276851, 'binary_f1_score': 0.09033005}
confusion matrix:
       0     1
0  13848  2883
1    259   156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83547556, 'precision': 0.6064059, 'recall': 0.7202188, 'specificity': 0.7202188, 'f1': 0.62865317, 'auroc': 0.7695315, 'binary_precision': 0.25139353, 'binary_recall': 0.58419687, 'binary_specificity': 0.85624063, 'binary_f1_score': 0.35151988}
confusion matrix:
      0     1
0  7999  1343
1   321   451
better model found
persisted
after epoch: 12,now: 2024-08-09 12:23:37.268113,epoch time: 0:14:15.909555,used: 2:54:14.674564,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91154057, 'precision': 0.9117023, 'recall': 0.9115336, 'specificity': 0.9115336, 'f1': 0.91153085, 'auroc': 0.9736703, 'binary_precision': 0.9037189, 'binary_recall': 0.92136824, 'binary_specificity': 0.90169895, 'binary_f1_score': 0.91245824}
confusion matrix:
       0      1
0  22822   2488
1   1993  23353
---- Validation: 
scalar performance:
{'acc': 0.8413624, 'precision': 0.51577616, 'recall': 0.58503234, 'specificity': 0.58503234, 'f1': 0.50049365, 'auroc': 0.6489241, 'binary_precision': 0.051032335, 'binary_recall': 0.31566265, 'binary_specificity': 0.854402, 'binary_f1_score': 0.0878605}
confusion matrix:
       0     1
0  14295  2436
1    284   131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422978, 'precision': 0.6096442, 'recall': 0.71797025, 'specificity': 0.71797025, 'f1': 0.6331109, 'auroc': 0.76282716, 'binary_precision': 0.25865102, 'binary_recall': 0.5712435, 'binary_specificity': 0.86469704, 'binary_f1_score': 0.35607588}
confusion matrix:
      0     1
0  8078  1264
1   331   441
better model found
persisted
after epoch: 13,now: 2024-08-09 12:38:17.012520,epoch time: 0:14:39.744407,used: 3:08:54.418971,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9174629, 'precision': 0.9174833, 'recall': 0.91746074, 'specificity': 0.91746074, 'f1': 0.91746163, 'auroc': 0.97618544, 'binary_precision': 0.91471684, 'binary_recall': 0.9208886, 'binary_specificity': 0.9140329, 'binary_f1_score': 0.9177924}
confusion matrix:
       0      1
0  23136   2176
1   2005  23339
---- Validation: 
scalar performance:
{'acc': 0.8498192, 'precision': 0.5178326, 'recall': 0.59171546, 'specificity': 0.59171546, 'f1': 0.5058778, 'auroc': 0.6882825, 'binary_precision': 0.054822754, 'binary_recall': 0.32048193, 'binary_specificity': 0.862949, 'binary_f1_score': 0.09362901}
confusion matrix:
       0     1
0  14438  2293
1    282   133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87047654, 'precision': 0.6300873, 'recall': 0.7142113, 'specificity': 0.7142113, 'f1': 0.6560114, 'auroc': 0.7859068, 'binary_precision': 0.30162242, 'binary_recall': 0.5297927, 'binary_specificity': 0.89862984, 'binary_f1_score': 0.3843985}
confusion matrix:
      0    1
0  8395  947
1   363  409
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-09 12:52:56.917385,epoch time: 0:14:39.904865,used: 3:23:34.323836,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.915627, 'precision': 0.91715956, 'recall': 0.91561145, 'specificity': 0.91561145, 'f1': 0.91554725, 'auroc': 0.9781841, 'binary_precision': 0.8920025, 'binary_recall': 0.9458585, 'binary_specificity': 0.8853644, 'binary_f1_score': 0.91814137}
confusion matrix:
       0      1
0  22413   2902
1   1372  23969
---- Validation: 
scalar performance:
{'acc': 0.8117345, 'precision': 0.5171453, 'recall': 0.6086238, 'specificity': 0.6086238, 'f1': 0.49360755, 'auroc': 0.67460394, 'binary_precision': 0.05221267, 'binary_recall': 0.39518073, 'binary_specificity': 0.82206684, 'binary_f1_score': 0.09223846}
confusion matrix:
       0     1
0  13754  2977
1    251   164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85950166, 'precision': 0.6307269, 'recall': 0.7462958, 'specificity': 0.7462958, 'f1': 0.6600516, 'auroc': 0.7874346, 'binary_precision': 0.29655173, 'binary_recall': 0.6126943, 'binary_specificity': 0.87989724, 'binary_f1_score': 0.39966202}
confusion matrix:
      0     1
0  8220  1122
1   299   473
early stop counter: 1
val acc:0.8117344975471497, best validation acc: 0.8498191833496094, corresponding to test acc:                         0.8704765439033508 / 0.8704765439033508
after epoch: 15,now: 2024-08-09 13:07:39.176650,epoch time: 0:14:42.259265,used: 3:38:16.583101,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_29_22_seed_0_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:38:16.583101 at 2024-08-09 13:07:39.176650
persisted model performance metric: 

scalar performance:
{'acc': 0.87047654, 'precision': 0.6300873, 'recall': 0.7142113, 'specificity': 0.7142113, 'f1': 0.6560114, 'auroc': 0.7859068, 'binary_precision': 0.30162242, 'binary_recall': 0.5297927, 'binary_specificity': 0.89862984, 'binary_f1_score': 0.3843985}
confusion matrix:
      0    1
0  8395  947
1   363  409
oracle model performance metric: 

scalar performance:
{'acc': 0.87047654, 'precision': 0.6300873, 'recall': 0.7142113, 'specificity': 0.7142113, 'f1': 0.6560114, 'auroc': 0.7859068, 'binary_precision': 0.30162242, 'binary_recall': 0.5297927, 'binary_specificity': 0.89862984, 'binary_f1_score': 0.3843985}
confusion matrix:
      0    1
0  8395  947
1   363  409
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/15.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205702 KiB | 575148 KiB | 205319 GiB | 205318 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205702 KiB | 575148 KiB | 205319 GiB | 205318 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201269 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 202776 GiB | 202776 GiB |
|       from small pool |  36149 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 739328 KiB | 739328 KiB | 739328 KiB |      0 B   |
|       from large pool | 661504 KiB | 661504 KiB | 661504 KiB |      0 B   |
|       from small pool |  77824 KiB |  77824 KiB |  77824 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44153 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  36864 KiB | 148352 KiB | 139038 GiB | 139038 GiB |
|       from small pool |   7289 KiB |   9156 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4698    |    7101    |   43620 K  |   43615 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29720 K  |   29716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4698    |    7101    |   43620 K  |   43615 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29720 K  |   29716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      55    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      38    |      38    |      38    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    3182    |   22781 K  |   22781 K  |
|       from large pool |       7    |      11    |    8644 K  |    8644 K  |
|       from small pool |      44    |    3176    |   14137 K  |   14137 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202776 GiB | 202776 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139039 GiB | 139038 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29720 K  |   29720 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29720 K  |   29720 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202776 GiB | 202776 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139039 GiB | 139038 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29720 K  |   29720 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29720 K  |   29720 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710

 Experiment start at: 2024-08-09 13:27:27.650101
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.69198537, 'precision': 0.72339714, 'recall': 0.6918302, 'specificity': 0.6918302, 'f1': 0.6806545, 'auroc': 0.8153181, 'binary_precision': 0.63983417, 'binary_recall': 0.8796242, 'binary_specificity': 0.50403625, 'binary_f1_score': 0.7408082}
confusion matrix:
       0      1
0  12800  12595
1   3062  22375
---- Validation: 
scalar performance:
{'acc': 0.3638381, 'precision': 0.48828125, 'recall': 0.3889111, 'specificity': 0.3889111, 'f1': 0.27905387, 'auroc': 0.3501234, 'binary_precision': 0.016543439, 'binary_recall': 0.4153132, 'binary_specificity': 0.36250898, 'binary_f1_score': 0.031819396}
confusion matrix:
      0      1
0  6051  10641
1   252    179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.2658805, 'precision': 0.509415, 'recall': 0.5230559, 'specificity': 0.5230559, 'f1': 0.2507714, 'auroc': 0.5178439, 'binary_precision': 0.07910391, 'binary_recall': 0.8256275, 'binary_specificity': 0.22048426, 'binary_f1_score': 0.14437515}
confusion matrix:
      0     1
0  2058  7276
1   132   625
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 13:42:27.726960,epoch time: 0:15:00.076859,used: 0:15:00.076859,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.79719466, 'precision': 0.8102039, 'recall': 0.797114, 'specificity': 0.797114, 'f1': 0.7950156, 'auroc': 0.90152526, 'binary_precision': 0.7468747, 'binary_recall': 0.89959115, 'binary_specificity': 0.69463694, 'binary_f1_score': 0.8161504}
confusion matrix:
       0      1
0  17641   7755
1   2554  22882
---- Validation: 
scalar performance:
{'acc': 0.6328914, 'precision': 0.49720013, 'recall': 0.47379482, 'specificity': 0.47379482, 'f1': 0.40667057, 'auroc': 0.4343919, 'binary_precision': 0.021572152, 'binary_recall': 0.3062645, 'binary_specificity': 0.6413252, 'binary_f1_score': 0.040305343}
confusion matrix:
       0     1
0  10705  5987
1    299   132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5582202, 'precision': 0.5474274, 'recall': 0.6707624, 'specificity': 0.6707624, 'f1': 0.45351607, 'auroc': 0.711064, 'binary_precision': 0.12365264, 'binary_recall': 0.8031704, 'binary_specificity': 0.5383544, 'binary_f1_score': 0.2143109}
confusion matrix:
      0     1
0  5025  4309
1   149   608
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 13:56:37.599722,epoch time: 0:14:09.872762,used: 0:29:09.949621,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.83512354, 'precision': 0.8370081, 'recall': 0.8350911, 'specificity': 0.8350911, 'f1': 0.8348833, 'auroc': 0.91861737, 'binary_precision': 0.8120221, 'binary_recall': 0.87251353, 'binary_specificity': 0.79766876, 'binary_f1_score': 0.8411817}
confusion matrix:
       0      1
0  20256   5138
1   3243  22195
---- Validation: 
scalar performance:
{'acc': 0.7679145, 'precision': 0.5021198, 'recall': 0.51479614, 'specificity': 0.51479614, 'f1': 0.4594437, 'auroc': 0.5134423, 'binary_precision': 0.02848017, 'binary_recall': 0.24825986, 'binary_specificity': 0.7813324, 'binary_f1_score': 0.05109838}
confusion matrix:
       0     1
0  13042  3650
1    324   107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6951739, 'precision': 0.5647508, 'recall': 0.70898366, 'specificity': 0.70898366, 'f1': 0.53545153, 'auroc': 0.75542796, 'binary_precision': 0.16066726, 'binary_recall': 0.7252312, 'binary_specificity': 0.6927362, 'binary_f1_score': 0.26305702}
confusion matrix:
      0     1
0  6466  2868
1   208   549
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 14:11:02.215015,epoch time: 0:14:24.615293,used: 0:43:34.564914,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8450976, 'precision': 0.8522366, 'recall': 0.845036, 'specificity': 0.845036, 'f1': 0.84429216, 'auroc': 0.9359896, 'binary_precision': 0.80230635, 'binary_recall': 0.9162277, 'binary_specificity': 0.77384424, 'binary_f1_score': 0.85549116}
confusion matrix:
       0      1
0  19651   5743
1   2131  23307
---- Validation: 
scalar performance:
{'acc': 0.72808504, 'precision': 0.505422, 'recall': 0.54296315, 'specificity': 0.54296315, 'f1': 0.45078528, 'auroc': 0.54763114, 'binary_precision': 0.03314917, 'binary_recall': 0.34802786, 'binary_specificity': 0.7378984, 'binary_f1_score': 0.060532685}
confusion matrix:
       0     1
0  12317  4375
1    281   150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61292243, 'precision': 0.5501677, 'recall': 0.67666125, 'specificity': 0.67666125, 'f1': 0.4837942, 'auroc': 0.72644246, 'binary_precision': 0.13272685, 'binary_recall': 0.7516512, 'binary_specificity': 0.60167134, 'binary_f1_score': 0.22561458}
confusion matrix:
      0     1
0  5616  3718
1   188   569
early stop counter: 1
val acc:0.7280850410461426, best validation acc: 0.7679144740104675, corresponding to test acc:                         0.6951739192008972 / 0.6951739192008972
after epoch: 4,now: 2024-08-09 14:25:11.256200,epoch time: 0:14:09.041185,used: 0:57:43.606099,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8539306, 'precision': 0.8645166, 'recall': 0.8538636, 'specificity': 0.8538636, 'f1': 0.8528455, 'auroc': 0.9492649, 'binary_precision': 0.802594, 'binary_recall': 0.9390628, 'binary_specificity': 0.76866436, 'binary_f1_score': 0.8654818}
confusion matrix:
       0      1
0  19521   5875
1   1550  23886
---- Validation: 
scalar performance:
{'acc': 0.73614436, 'precision': 0.50991374, 'recall': 0.57761055, 'specificity': 0.57761055, 'f1': 0.45942527, 'auroc': 0.5880132, 'binary_precision': 0.03985589, 'binary_recall': 0.41067284, 'binary_specificity': 0.74454826, 'binary_f1_score': 0.072660096}
confusion matrix:
       0     1
0  12428  4264
1    254   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62233675, 'precision': 0.5512672, 'recall': 0.6793225, 'specificity': 0.6793225, 'f1': 0.48932475, 'auroc': 0.7322515, 'binary_precision': 0.13503824, 'binary_recall': 0.7463672, 'binary_specificity': 0.6122777, 'binary_f1_score': 0.22869864}
confusion matrix:
      0     1
0  5715  3619
1   192   565
early stop counter: 2
val acc:0.7361443638801575, best validation acc: 0.7679144740104675, corresponding to test acc:                         0.6951739192008972 / 0.6951739192008972
after epoch: 5,now: 2024-08-09 14:39:36.963558,epoch time: 0:14:25.707358,used: 1:12:09.313457,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8635702, 'precision': 0.86730826, 'recall': 0.8635266, 'specificity': 0.8635266, 'f1': 0.863212, 'auroc': 0.9496261, 'binary_precision': 0.8304697, 'binary_recall': 0.91394764, 'binary_specificity': 0.81310546, 'binary_f1_score': 0.87021124}
confusion matrix:
       0      1
0  20648   4746
1   2189  23249
---- Validation: 
scalar performance:
{'acc': 0.8047071, 'precision': 0.51341754, 'recall': 0.5833935, 'specificity': 0.5833935, 'f1': 0.4867747, 'auroc': 0.6305927, 'binary_precision': 0.04696734, 'binary_recall': 0.35034803, 'binary_specificity': 0.81643903, 'binary_f1_score': 0.082830496}
confusion matrix:
       0     1
0  13628  3064
1    280   151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.757804, 'precision': 0.5810141, 'recall': 0.7313067, 'specificity': 0.7313067, 'f1': 0.5779855, 'auroc': 0.7823981, 'binary_precision': 0.19293775, 'binary_recall': 0.7001321, 'binary_specificity': 0.7624813, 'binary_f1_score': 0.3025114}
confusion matrix:
      0     1
0  7117  2217
1   227   530
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 14:54:08.144119,epoch time: 0:14:31.180561,used: 1:26:40.494018,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8790329, 'precision': 0.88066685, 'recall': 0.8790097, 'specificity': 0.8790097, 'f1': 0.8788982, 'auroc': 0.9584464, 'binary_precision': 0.85590374, 'binary_recall': 0.9117323, 'binary_specificity': 0.84628713, 'binary_f1_score': 0.88293636}
confusion matrix:
       0      1
0  21494   3904
1   2245  23189
---- Validation: 
scalar performance:
{'acc': 0.81919056, 'precision': 0.51666504, 'recall': 0.5976031, 'specificity': 0.5976031, 'f1': 0.49583995, 'auroc': 0.65231276, 'binary_precision': 0.052702248, 'binary_recall': 0.36426914, 'binary_specificity': 0.83093697, 'binary_f1_score': 0.09208211}
confusion matrix:
       0     1
0  13870  2822
1    274   157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80923593, 'precision': 0.5974375, 'recall': 0.7354378, 'specificity': 0.7354378, 'f1': 0.6131863, 'auroc': 0.79871404, 'binary_precision': 0.2283721, 'binary_recall': 0.6486129, 'binary_specificity': 0.8222627, 'binary_f1_score': 0.3378053}
confusion matrix:
      0     1
0  7675  1659
1   266   491
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-09 15:08:38.550961,epoch time: 0:14:30.406842,used: 1:41:10.900860,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8835183, 'precision': 0.8842231, 'recall': 0.88349974, 'specificity': 0.88349974, 'f1': 0.8834612, 'auroc': 0.9591404, 'binary_precision': 0.86798143, 'binary_recall': 0.90486676, 'binary_specificity': 0.8621328, 'binary_f1_score': 0.8860404}
confusion matrix:
       0      1
0  21893   3501
1   2420  23018
---- Validation: 
scalar performance:
{'acc': 0.81486887, 'precision': 0.5098978, 'recall': 0.5580919, 'specificity': 0.5580919, 'f1': 0.4848642, 'auroc': 0.60891324, 'binary_precision': 0.041513223, 'binary_recall': 0.287703, 'binary_specificity': 0.8284807, 'binary_f1_score': 0.07255705}
confusion matrix:
       0     1
0  13829  2863
1    307   124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7918938, 'precision': 0.59102654, 'recall': 0.73456055, 'specificity': 0.73456055, 'f1': 0.6008752, 'auroc': 0.78637284, 'binary_precision': 0.21461964, 'binary_recall': 0.667107, 'binary_specificity': 0.8020141, 'binary_f1_score': 0.32475886}
confusion matrix:
      0     1
0  7486  1848
1   252   505
early stop counter: 1
val acc:0.8148688673973083, best validation acc: 0.8191905617713928, corresponding to test acc:                         0.8092359304428101 / 0.8092359304428101
after epoch: 8,now: 2024-08-09 15:23:19.282864,epoch time: 0:14:40.731903,used: 1:55:51.632763,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8794067, 'precision': 0.8871703, 'recall': 0.879351, 'specificity': 0.879351, 'f1': 0.8787879, 'auroc': 0.96579075, 'binary_precision': 0.832541, 'binary_recall': 0.9501101, 'binary_specificity': 0.8085919, 'binary_f1_score': 0.8874486}
confusion matrix:
       0      1
0  20535   4861
1   1269  24167
---- Validation: 
scalar performance:
{'acc': 0.75956315, 'precision': 0.51620317, 'recall': 0.620136, 'specificity': 0.620136, 'f1': 0.4758221, 'auroc': 0.64783347, 'binary_precision': 0.049829017, 'binary_recall': 0.47331786, 'binary_specificity': 0.76695424, 'binary_f1_score': 0.09016575}
confusion matrix:
       0     1
0  12802  3890
1    227   204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7964523, 'precision': 0.59198457, 'recall': 0.73277617, 'specificity': 0.73277617, 'f1': 0.6033324, 'auroc': 0.78588736, 'binary_precision': 0.21718273, 'binary_recall': 0.65786, 'binary_specificity': 0.8076923, 'binary_f1_score': 0.32655737}
confusion matrix:
      0     1
0  7539  1795
1   259   498
early stop counter: 2
val acc:0.759563148021698, best validation acc: 0.8191905617713928, corresponding to test acc:                         0.8092359304428101 / 0.8092359304428101
after epoch: 9,now: 2024-08-09 15:39:44.224282,epoch time: 0:16:24.941418,used: 2:12:16.574181,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.89235127, 'precision': 0.8968624, 'recall': 0.8923073, 'specificity': 0.8923073, 'f1': 0.8920367, 'auroc': 0.9703239, 'binary_precision': 0.8547568, 'binary_recall': 0.94555175, 'binary_specificity': 0.8390628, 'binary_f1_score': 0.89786476}
confusion matrix:
       0      1
0  21308   4087
1   1385  24052
---- Validation: 
scalar performance:
{'acc': 0.77509785, 'precision': 0.51672703, 'recall': 0.6179327, 'specificity': 0.6179327, 'f1': 0.48180708, 'auroc': 0.6706734, 'binary_precision': 0.051181104, 'binary_recall': 0.4524362, 'binary_specificity': 0.7834292, 'binary_f1_score': 0.091959454}
confusion matrix:
       0     1
0  13077  3615
1    236   195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8084432, 'precision': 0.5962554, 'recall': 0.7325815, 'specificity': 0.7325815, 'f1': 0.61157876, 'auroc': 0.779297, 'binary_precision': 0.22651163, 'binary_recall': 0.6433289, 'binary_specificity': 0.82183415, 'binary_f1_score': 0.33505332}
confusion matrix:
      0     1
0  7671  1663
1   270   487
early stop counter: 3
val acc:0.7750978469848633, best validation acc: 0.8191905617713928, corresponding to test acc:                         0.8092359304428101 / 0.8092359304428101
after epoch: 10,now: 2024-08-09 15:57:38.501494,epoch time: 0:17:54.277212,used: 2:30:10.851393,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8987252, 'precision': 0.89894855, 'recall': 0.898716, 'specificity': 0.898716, 'f1': 0.8987094, 'auroc': 0.96690667, 'binary_precision': 0.88970417, 'binary_recall': 0.9104812, 'binary_specificity': 0.8869507, 'binary_f1_score': 0.8999728}
confusion matrix:
       0      1
0  22525   2871
1   2277  23159
---- Validation: 
scalar performance:
{'acc': 0.8334988, 'precision': 0.5148387, 'recall': 0.58007884, 'specificity': 0.58007884, 'f1': 0.49745616, 'auroc': 0.6392114, 'binary_precision': 0.050185874, 'binary_recall': 0.31322506, 'binary_specificity': 0.84693265, 'binary_f1_score': 0.08651073}
confusion matrix:
       0     1
0  14137  2555
1    296   135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85838866, 'precision': 0.6303224, 'recall': 0.7541172, 'specificity': 0.7541172, 'f1': 0.66027206, 'auroc': 0.8011927, 'binary_precision': 0.2936118, 'binary_recall': 0.63143986, 'binary_specificity': 0.8767945, 'binary_f1_score': 0.40083855}
confusion matrix:
      0     1
0  8184  1150
1   279   478
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-09 16:16:24.176001,epoch time: 0:18:45.674507,used: 2:48:56.525900,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91090256, 'precision': 0.91125685, 'recall': 0.91089225, 'specificity': 0.91089225, 'f1': 0.9108819, 'auroc': 0.9730245, 'binary_precision': 0.8993619, 'binary_recall': 0.9254934, 'binary_specificity': 0.896291, 'binary_f1_score': 0.91224056}
confusion matrix:
       0      1
0  22764   2634
1   1895  23539
---- Validation: 
scalar performance:
{'acc': 0.8473398, 'precision': 0.5174287, 'recall': 0.58717805, 'specificity': 0.58717805, 'f1': 0.50513536, 'auroc': 0.6586603, 'binary_precision': 0.055034652, 'binary_recall': 0.31322506, 'binary_specificity': 0.8611311, 'binary_f1_score': 0.09361997}
confusion matrix:
       0     1
0  14374  2318
1    296   135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87543356, 'precision': 0.6364967, 'recall': 0.72509396, 'specificity': 0.72509396, 'f1': 0.66411674, 'auroc': 0.79290926, 'binary_precision': 0.31203008, 'binary_recall': 0.54821664, 'binary_specificity': 0.9019713, 'binary_f1_score': 0.39770007}
confusion matrix:
      0    1
0  8419  915
1   342  415
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-09 16:34:25.133477,epoch time: 0:18:00.957476,used: 3:06:57.483376,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8916234, 'precision': 0.89952564, 'recall': 0.8915681, 'specificity': 0.8915681, 'f1': 0.891075, 'auroc': 0.97605383, 'binary_precision': 0.84353346, 'binary_recall': 0.9618258, 'binary_specificity': 0.82131046, 'binary_f1_score': 0.8988042}
confusion matrix:
       0      1
0  20858   4538
1    971  24465
---- Validation: 
scalar performance:
{'acc': 0.7565263, 'precision': 0.51933116, 'recall': 0.64570177, 'specificity': 0.64570177, 'f1': 0.47892496, 'auroc': 0.7133699, 'binary_precision': 0.054363377, 'binary_recall': 0.5290023, 'binary_specificity': 0.76240116, 'binary_f1_score': 0.0985946}
confusion matrix:
       0     1
0  12726  3966
1    203   228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81310076, 'precision': 0.60881263, 'recall': 0.76848066, 'specificity': 0.76848066, 'f1': 0.6277042, 'auroc': 0.8067162, 'binary_precision': 0.24491641, 'binary_recall': 0.71598417, 'binary_specificity': 0.8209771, 'binary_f1_score': 0.36498317}
confusion matrix:
      0     1
0  7663  1671
1   215   542
early stop counter: 1
val acc:0.7565262913703918, best validation acc: 0.8473398089408875, corresponding to test acc:                         0.8754335641860962 / 0.8754335641860962
after epoch: 13,now: 2024-08-09 16:53:12.266419,epoch time: 0:18:47.132942,used: 3:25:44.616318,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9090533, 'precision': 0.90983665, 'recall': 0.9090353, 'specificity': 0.9090353, 'f1': 0.9090072, 'auroc': 0.9742142, 'binary_precision': 0.89212507, 'binary_recall': 0.93080944, 'binary_specificity': 0.8872613, 'binary_f1_score': 0.9110568}
confusion matrix:
       0      1
0  22532   2863
1   1760  23677
---- Validation: 
scalar performance:
{'acc': 0.8568008, 'precision': 0.5208282, 'recall': 0.5988115, 'specificity': 0.5988115, 'f1': 0.51266694, 'auroc': 0.66830635, 'binary_precision': 0.06122449, 'binary_recall': 0.32714617, 'binary_specificity': 0.8704769, 'binary_f1_score': 0.10314558}
confusion matrix:
       0     1
0  14530  2162
1    290   141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87434345, 'precision': 0.6397557, 'recall': 0.73907113, 'specificity': 0.73907113, 'f1': 0.66941476, 'auroc': 0.7952254, 'binary_precision': 0.3160547, 'binary_recall': 0.57992077, 'binary_specificity': 0.89822155, 'binary_f1_score': 0.40913326}
confusion matrix:
      0    1
0  8384  950
1   318  439
better model found
persisted
after epoch: 14,now: 2024-08-09 17:12:39.587561,epoch time: 0:19:27.321142,used: 3:45:11.937460,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9202274, 'precision': 0.9203408, 'recall': 0.92022073, 'specificity': 0.92022073, 'f1': 0.9202211, 'auroc': 0.9770317, 'binary_precision': 0.91364235, 'binary_recall': 0.92833275, 'binary_specificity': 0.91210866, 'binary_f1_score': 0.92092896}
confusion matrix:
       0      1
0  23163   2232
1   1823  23614
---- Validation: 
scalar performance:
{'acc': 0.85329676, 'precision': 0.51579595, 'recall': 0.5755416, 'specificity': 0.5755416, 'f1': 0.50438136, 'auroc': 0.63453496, 'binary_precision': 0.052473117, 'binary_recall': 0.28306264, 'binary_specificity': 0.8680206, 'binary_f1_score': 0.0885341}
confusion matrix:
       0     1
0  14489  2203
1    309   122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9023883, 'precision': 0.6581863, 'recall': 0.6747224, 'specificity': 0.6747224, 'f1': 0.6658742, 'auroc': 0.7736089, 'binary_precision': 0.3649289, 'binary_recall': 0.40686923, 'binary_specificity': 0.9425755, 'binary_f1_score': 0.38475955}
confusion matrix:
      0    1
0  8798  536
1   449  308
new oracle model saved
early stop counter: 1
val acc:0.8532967567443848, best validation acc: 0.8568007946014404, corresponding to test acc:                         0.8743434548377991 / 0.9023882746696472
after epoch: 15,now: 2024-08-09 17:36:15.567750,epoch time: 0:23:35.980189,used: 4:08:47.917649,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_27_27_seed_1_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:08:47.917649 at 2024-08-09 17:36:15.567750
persisted model performance metric: 

scalar performance:
{'acc': 0.87434345, 'precision': 0.6397557, 'recall': 0.73907113, 'specificity': 0.73907113, 'f1': 0.66941476, 'auroc': 0.7952254, 'binary_precision': 0.3160547, 'binary_recall': 0.57992077, 'binary_specificity': 0.89822155, 'binary_f1_score': 0.40913326}
confusion matrix:
      0    1
0  8384  950
1   318  439
oracle model performance metric: 

scalar performance:
{'acc': 0.9023883, 'precision': 0.6581863, 'recall': 0.6747224, 'specificity': 0.6747224, 'f1': 0.6658742, 'auroc': 0.7736089, 'binary_precision': 0.3649289, 'binary_recall': 0.40686923, 'binary_specificity': 0.9425755, 'binary_f1_score': 0.38475955}
confusion matrix:
      0    1
0  8798  536
1   449  308
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 574656 KiB | 407881 GiB | 407881 GiB |
|       from large pool | 165120 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1090 MiB | 489472 KiB |
|       from large pool | 550912 KiB | 661504 KiB |    984 MiB | 456704 KiB |
|       from small pool |  75776 KiB |  77824 KiB |    106 MiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 257063 GiB | 257063 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |   9343 KiB |  14884 KiB |    625 GiB |    625 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7123    |   87545 K  |   87541 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59625 K  |   59620 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7123    |   87545 K  |   87541 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59625 K  |   59620 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      77    |      23    |
|       from large pool |      17    |      17    |      24    |       7    |
|       from small pool |      37    |      38    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      47    |    3190    |   46435 K  |   46435 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |      44    |    3187    |   28382 K  |   28382 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407881 GiB | 407881 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257064 GiB | 257063 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |      0 KiB |  16938 KiB |    625 GiB |    625 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46437 K  |   46437 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |       0    |    3187    |   28384 K  |   28384 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407881 GiB | 407881 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257064 GiB | 257063 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |      0 KiB |  16938 KiB |    625 GiB |    625 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46437 K  |   46437 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |       0    |    3187    |   28384 K  |   28384 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710

 Experiment start at: 2024-08-09 18:03:49.692756
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7362465, 'precision': 0.7750783, 'recall': 0.7361956, 'specificity': 0.7361956, 'f1': 0.7265702, 'auroc': 0.8642374, 'binary_precision': 0.6717933, 'binary_recall': 0.92411524, 'binary_specificity': 0.548276, 'binary_f1_score': 0.7780075}
confusion matrix:
       0      1
0  14168  11673
1   1962  23893
---- Validation: 
scalar performance:
{'acc': 0.48253912, 'precision': 0.51521647, 'recall': 0.6589901, 'specificity': 0.6589901, 'f1': 0.3573871, 'auroc': 0.7432703, 'binary_precision': 0.03858345, 'binary_recall': 0.8444976, 'binary_specificity': 0.47348258, 'binary_f1_score': 0.07379533}
confusion matrix:
      0     1
0  7910  8796
1    65   353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.31252477, 'precision': 0.52367157, 'recall': 0.5619763, 'specificity': 0.5619763, 'f1': 0.29029757, 'auroc': 0.61479735, 'binary_precision': 0.091090694, 'binary_recall': 0.8582183, 'binary_specificity': 0.26573426, 'binary_f1_score': 0.16470022}
confusion matrix:
      0     1
0  2470  6825
1   113   684
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 18:26:00.980750,epoch time: 0:22:11.287994,used: 0:22:11.287994,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.80580705, 'precision': 0.8275764, 'recall': 0.80575716, 'specificity': 0.80575716, 'f1': 0.8025085, 'auroc': 0.9177567, 'binary_precision': 0.74322706, 'binary_recall': 0.9346817, 'binary_specificity': 0.67683256, 'binary_f1_score': 0.8280316}
confusion matrix:
       0      1
0  17488   8350
1   1689  24169
---- Validation: 
scalar performance:
{'acc': 0.6124153, 'precision': 0.51432616, 'recall': 0.643916, 'specificity': 0.643916, 'f1': 0.4165863, 'auroc': 0.7012038, 'binary_precision': 0.041709654, 'binary_recall': 0.6770335, 'binary_specificity': 0.61079854, 'binary_f1_score': 0.07857837}
confusion matrix:
       0     1
0  10204  6502
1    135   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50881886, 'precision': 0.53109974, 'recall': 0.60659444, 'specificity': 0.60659444, 'f1': 0.41819477, 'auroc': 0.64575106, 'binary_precision': 0.10843374, 'binary_recall': 0.7227102, 'binary_specificity': 0.49047875, 'binary_f1_score': 0.18857424}
confusion matrix:
      0     1
0  4559  4736
1   221   576
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 18:45:57.354820,epoch time: 0:19:56.374070,used: 0:42:07.662064,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8505687, 'precision': 0.8514408, 'recall': 0.8505668, 'specificity': 0.8505668, 'f1': 0.85047543, 'auroc': 0.9327047, 'binary_precision': 0.8339536, 'binary_recall': 0.8754739, 'binary_specificity': 0.8256597, 'binary_f1_score': 0.8542095}
confusion matrix:
       0      1
0  21340   4506
1   3219  22631
---- Validation: 
scalar performance:
{'acc': 0.79619247, 'precision': 0.5119872, 'recall': 0.5794947, 'specificity': 0.5794947, 'f1': 0.48156705, 'auroc': 0.60859925, 'binary_precision': 0.043672014, 'binary_recall': 0.35167465, 'binary_specificity': 0.80731475, 'binary_f1_score': 0.077695556}
confusion matrix:
       0     1
0  13487  3219
1    271   147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6085018, 'precision': 0.54795045, 'recall': 0.66128314, 'specificity': 0.66128314, 'f1': 0.4820164, 'auroc': 0.720283, 'binary_precision': 0.13393687, 'binary_recall': 0.72396487, 'binary_specificity': 0.5986014, 'binary_f1_score': 0.2260529}
confusion matrix:
      0     1
0  5564  3731
1   220   577
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 19:09:07.545455,epoch time: 0:23:10.190635,used: 1:05:17.852699,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85672003, 'precision': 0.8612268, 'recall': 0.85670495, 'specificity': 0.85670495, 'f1': 0.85626805, 'auroc': 0.94095284, 'binary_precision': 0.8209464, 'binary_recall': 0.91255075, 'binary_specificity': 0.8008591, 'binary_f1_score': 0.8643282}
confusion matrix:
       0      1
0  20695   5146
1   2261  23594
---- Validation: 
scalar performance:
{'acc': 0.7762789, 'precision': 0.51649463, 'recall': 0.6194372, 'specificity': 0.6194372, 'f1': 0.48134857, 'auroc': 0.6708311, 'binary_precision': 0.050092276, 'binary_recall': 0.45454547, 'binary_specificity': 0.784329, 'binary_f1_score': 0.09023985}
confusion matrix:
       0     1
0  13103  3603
1    228   190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65913594, 'precision': 0.55351746, 'recall': 0.6715642, 'specificity': 0.6715642, 'f1': 0.51073986, 'auroc': 0.72337353, 'binary_precision': 0.14637409, 'binary_recall': 0.6863237, 'binary_specificity': 0.65680474, 'binary_f1_score': 0.24128804}
confusion matrix:
      0     1
0  6105  3190
1   250   547
new oracle model saved
early stop counter: 1
val acc:0.7762789130210876, best validation acc: 0.796192467212677, corresponding to test acc:                         0.6085017919540405 / 0.6591359376907349
after epoch: 4,now: 2024-08-09 19:37:49.441015,epoch time: 0:28:41.895560,used: 1:33:59.748259,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8785206, 'precision': 0.88034064, 'recall': 0.8785125, 'specificity': 0.8785125, 'f1': 0.8783735, 'auroc': 0.954756, 'binary_precision': 0.8540883, 'binary_recall': 0.91308886, 'binary_specificity': 0.8439362, 'binary_f1_score': 0.8826037}
confusion matrix:
       0      1
0  21809   4033
1   2247  23607
---- Validation: 
scalar performance:
{'acc': 0.7610371, 'precision': 0.51126486, 'recall': 0.58480203, 'specificity': 0.58480203, 'f1': 0.46912453, 'auroc': 0.6373421, 'binary_precision': 0.041666668, 'binary_recall': 0.39952153, 'binary_specificity': 0.7700826, 'binary_f1_score': 0.075463176}
confusion matrix:
       0     1
0  12865  3841
1    251   167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63941735, 'precision': 0.55398744, 'recall': 0.6774928, 'specificity': 0.6774928, 'f1': 0.5020223, 'auroc': 0.7283789, 'binary_precision': 0.14421633, 'binary_recall': 0.7227102, 'binary_specificity': 0.6322754, 'binary_f1_score': 0.24045084}
confusion matrix:
      0     1
0  5877  3418
1   221   576
early stop counter: 2
val acc:0.7610371112823486, best validation acc: 0.796192467212677, corresponding to test acc:                         0.6085017919540405 / 0.6591359376907349
after epoch: 5,now: 2024-08-09 19:58:42.247610,epoch time: 0:20:52.806595,used: 1:54:52.554854,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.879894, 'precision': 0.8823797, 'recall': 0.87988937, 'specificity': 0.87988937, 'f1': 0.87969756, 'auroc': 0.95928204, 'binary_precision': 0.8515787, 'binary_recall': 0.92019653, 'binary_specificity': 0.83958215, 'binary_f1_score': 0.88455886}
confusion matrix:
       0      1
0  21699   4146
1   2063  23788
---- Validation: 
scalar performance:
{'acc': 0.78982717, 'precision': 0.51469755, 'recall': 0.6007235, 'specificity': 0.6007235, 'f1': 0.4833298, 'auroc': 0.65586984, 'binary_precision': 0.047767986, 'binary_recall': 0.40191388, 'binary_specificity': 0.7995331, 'binary_f1_score': 0.08538755}
confusion matrix:
       0     1
0  13357  3349
1    250   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7415775, 'precision': 0.56854075, 'recall': 0.68936217, 'specificity': 0.68936217, 'f1': 0.559913, 'auroc': 0.71885765, 'binary_precision': 0.17787264, 'binary_recall': 0.6273526, 'binary_specificity': 0.7513717, 'binary_f1_score': 0.27716187}
confusion matrix:
      0     1
0  6984  2311
1   297   500
new oracle model saved
early stop counter: 3
val acc:0.7898271679878235, best validation acc: 0.796192467212677, corresponding to test acc:                         0.6085017919540405 / 0.7415775060653687
after epoch: 6,now: 2024-08-09 20:18:52.247948,epoch time: 0:20:10.000338,used: 2:15:02.555192,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8785593, 'precision': 0.8828891, 'recall': 0.8785552, 'specificity': 0.8785552, 'f1': 0.8782141, 'auroc': 0.9592165, 'binary_precision': 0.84219176, 'binary_recall': 0.93172145, 'binary_specificity': 0.82538885, 'binary_f1_score': 0.8846973}
confusion matrix:
       0      1
0  21333   4513
1   1765  24085
---- Validation: 
scalar performance:
{'acc': 0.744569, 'precision': 0.51527077, 'recall': 0.6218455, 'specificity': 0.6218455, 'f1': 0.468811, 'auroc': 0.6823572, 'binary_precision': 0.047161173, 'binary_recall': 0.49282297, 'binary_specificity': 0.75086796, 'binary_f1_score': 0.08608442}
confusion matrix:
       0     1
0  12544  4162
1    212   206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71948075, 'precision': 0.5676044, 'recall': 0.6980146, 'specificity': 0.6980146, 'f1': 0.55038846, 'auroc': 0.7535564, 'binary_precision': 0.17256922, 'binary_recall': 0.67252195, 'binary_specificity': 0.7235073, 'binary_f1_score': 0.2746605}
confusion matrix:
      0     1
0  6725  2570
1   261   536
early stop counter: 4
val acc:0.7445690035820007, best validation acc: 0.796192467212677, corresponding to test acc:                         0.6085017919540405 / 0.7415775060653687
after epoch: 7,now: 2024-08-09 20:38:48.500149,epoch time: 0:19:56.252201,used: 2:34:58.807393,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89099735, 'precision': 0.8912752, 'recall': 0.8909948, 'specificity': 0.8909948, 'f1': 0.8909776, 'auroc': 0.95992005, 'binary_precision': 0.88089675, 'binary_recall': 0.9043051, 'binary_specificity': 0.8776845, 'binary_f1_score': 0.89244753}
confusion matrix:
       0      1
0  22682   3161
1   2474  23379
---- Validation: 
scalar performance:
{'acc': 0.8151717, 'precision': 0.5091713, 'recall': 0.5554007, 'specificity': 0.5554007, 'f1': 0.48339412, 'auroc': 0.59358644, 'binary_precision': 0.039557494, 'binary_recall': 0.28229666, 'binary_specificity': 0.82850474, 'binary_f1_score': 0.06939136}
confusion matrix:
       0     1
0  13841  2865
1    300   118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.761197, 'precision': 0.5784985, 'recall': 0.7086164, 'specificity': 0.7086164, 'f1': 0.57774323, 'auroc': 0.72935486, 'binary_precision': 0.19485433, 'binary_recall': 0.6461731, 'binary_specificity': 0.7710597, 'binary_f1_score': 0.2994186}
confusion matrix:
      0     1
0  7167  2128
1   282   515
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-09 20:58:36.451901,epoch time: 0:19:47.951752,used: 2:54:46.759145,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89513695, 'precision': 0.8967379, 'recall': 0.8951271, 'specificity': 0.8951271, 'f1': 0.89502937, 'auroc': 0.9673148, 'binary_precision': 0.871613, 'binary_recall': 0.92686415, 'binary_specificity': 0.8633901, 'binary_f1_score': 0.89838994}
confusion matrix:
       0      1
0  22310   3530
1   1891  23965
---- Validation: 
scalar performance:
{'acc': 0.79210466, 'precision': 0.51581573, 'recall': 0.6077219, 'specificity': 0.6077219, 'f1': 0.48562628, 'auroc': 0.658359, 'binary_precision': 0.049598623, 'binary_recall': 0.4138756, 'binary_specificity': 0.80156827, 'binary_f1_score': 0.08858167}
confusion matrix:
       0     1
0  13391  3315
1    245   173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7620888, 'precision': 0.5829015, 'recall': 0.7222924, 'specificity': 0.7222924, 'f1': 0.582875, 'auroc': 0.75580055, 'binary_precision': 0.20074627, 'binary_recall': 0.67503136, 'binary_specificity': 0.76955354, 'binary_f1_score': 0.3094622}
confusion matrix:
      0     1
0  7153  2142
1   259   538
new oracle model saved
early stop counter: 1
val acc:0.7921046614646912, best validation acc: 0.8151717185974121, corresponding to test acc:                         0.7611969709396362 / 0.7620887756347656
after epoch: 9,now: 2024-08-09 21:18:44.159531,epoch time: 0:20:07.707630,used: 3:14:54.466775,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90210074, 'precision': 0.9024415, 'recall': 0.902099, 'specificity': 0.902099, 'f1': 0.9020797, 'auroc': 0.96806216, 'binary_precision': 0.89076006, 'binary_recall': 0.91663766, 'binary_specificity': 0.8875604, 'binary_f1_score': 0.9035136}
confusion matrix:
       0      1
0  22939   2906
1   2155  23696
---- Validation: 
scalar performance:
{'acc': 0.8209531, 'precision': 0.51411563, 'recall': 0.58402103, 'specificity': 0.58402103, 'f1': 0.49223253, 'auroc': 0.6547619, 'binary_precision': 0.04781421, 'binary_recall': 0.33492824, 'binary_specificity': 0.83311385, 'binary_f1_score': 0.083682}
confusion matrix:
       0     1
0  13918  2788
1    278   140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.828478, 'precision': 0.59075004, 'recall': 0.67688775, 'specificity': 0.67688775, 'f1': 0.60794973, 'auroc': 0.73743737, 'binary_precision': 0.22943221, 'binary_recall': 0.49686325, 'binary_specificity': 0.8569123, 'binary_f1_score': 0.313912}
confusion matrix:
      0     1
0  7965  1330
1   401   396
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-09 21:38:45.430165,epoch time: 0:20:01.270634,used: 3:34:55.737409,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90333873, 'precision': 0.9043745, 'recall': 0.9033358, 'specificity': 0.9033358, 'f1': 0.9032763, 'auroc': 0.9713054, 'binary_precision': 0.88393843, 'binary_recall': 0.92862946, 'binary_specificity': 0.87804216, 'binary_f1_score': 0.9057329}
confusion matrix:
       0      1
0  22693   3152
1   1845  24006
---- Validation: 
scalar performance:
{'acc': 0.8122518, 'precision': 0.51840705, 'recall': 0.6157151, 'specificity': 0.6157151, 'f1': 0.49569732, 'auroc': 0.67255473, 'binary_precision': 0.05447595, 'binary_recall': 0.4090909, 'binary_specificity': 0.8223393, 'binary_f1_score': 0.09614844}
confusion matrix:
       0     1
0  13738  2968
1    247   171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8225327, 'precision': 0.6031615, 'recall': 0.72126573, 'specificity': 0.72126573, 'f1': 0.62288296, 'auroc': 0.75479573, 'binary_precision': 0.24538934, 'binary_recall': 0.60100377, 'binary_specificity': 0.8415277, 'binary_f1_score': 0.34849036}
confusion matrix:
      0     1
0  7822  1473
1   318   479
early stop counter: 1
val acc:0.8122518062591553, best validation acc: 0.8209530711174011, corresponding to test acc:                         0.8284779787063599 / 0.8284779787063599
after epoch: 11,now: 2024-08-09 21:58:25.474840,epoch time: 0:19:40.044675,used: 3:54:35.782084,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9093547, 'precision': 0.90941966, 'recall': 0.9093549, 'specificity': 0.9093549, 'f1': 0.90935117, 'auroc': 0.9713023, 'binary_precision': 0.91458684, 'binary_recall': 0.90305233, 'binary_specificity': 0.9156575, 'binary_f1_score': 0.9087831}
confusion matrix:
       0      1
0  23667   2180
1   2506  23343
---- Validation: 
scalar performance:
{'acc': 0.8596122, 'precision': 0.5176491, 'recall': 0.58400816, 'specificity': 0.58400816, 'f1': 0.50837475, 'auroc': 0.66149473, 'binary_precision': 0.055107526, 'binary_recall': 0.2942584, 'binary_specificity': 0.87375796, 'binary_f1_score': 0.09283019}
confusion matrix:
       0     1
0  14597  2109
1    295   123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8658343, 'precision': 0.6317185, 'recall': 0.72010994, 'specificity': 0.72010994, 'f1': 0.65816796, 'auroc': 0.7868105, 'binary_precision': 0.30510846, 'binary_recall': 0.5470514, 'binary_specificity': 0.8931684, 'binary_f1_score': 0.39173406}
confusion matrix:
      0    1
0  8302  993
1   361  436
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-09 22:17:51.870929,epoch time: 0:19:26.396089,used: 4:14:02.178173,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91422933, 'precision': 0.9142962, 'recall': 0.91423035, 'specificity': 0.91423035, 'f1': 0.91422606, 'auroc': 0.9736656, 'binary_precision': 0.91959876, 'binary_recall': 0.9078601, 'binary_specificity': 0.92060053, 'binary_f1_score': 0.9136917}
confusion matrix:
       0      1
0  23792   2052
1   2382  23470
---- Validation: 
scalar performance:
{'acc': 0.8615978, 'precision': 0.5180979, 'recall': 0.5850257, 'specificity': 0.5850257, 'f1': 0.5095563, 'auroc': 0.66599625, 'binary_precision': 0.055959962, 'binary_recall': 0.2942584, 'binary_specificity': 0.8757931, 'binary_f1_score': 0.0940367}
confusion matrix:
       0     1
0  14631  2075
1    295   123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87227505, 'precision': 0.6407919, 'recall': 0.72876847, 'specificity': 0.72876847, 'f1': 0.6684265, 'auroc': 0.7888727, 'binary_precision': 0.3219971, 'binary_recall': 0.55834377, 'binary_specificity': 0.8991931, 'binary_f1_score': 0.40844423}
confusion matrix:
      0    1
0  8358  937
1   352  445
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-09 22:36:28.861118,epoch time: 0:18:36.990189,used: 4:32:39.168362,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90985763, 'precision': 0.91210115, 'recall': 0.90985334, 'specificity': 0.90985334, 'f1': 0.90973413, 'auroc': 0.9764424, 'binary_precision': 0.8817235, 'binary_recall': 0.9467332, 'binary_specificity': 0.8729735, 'binary_f1_score': 0.9130727}
confusion matrix:
       0      1
0  22562   3283
1   1377  24474
---- Validation: 
scalar performance:
{'acc': 0.7916959, 'precision': 0.51934254, 'recall': 0.6331698, 'specificity': 0.6331698, 'f1': 0.49040085, 'auroc': 0.6993364, 'binary_precision': 0.05510031, 'binary_recall': 0.46650717, 'binary_specificity': 0.7998324, 'binary_f1_score': 0.09855951}
confusion matrix:
       0     1
0  13362  3344
1    223   195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8630599, 'precision': 0.61869943, 'recall': 0.68992573, 'specificity': 0.68992573, 'f1': 0.64087653, 'auroc': 0.7382885, 'binary_precision': 0.284451, 'binary_recall': 0.4843162, 'binary_specificity': 0.89553523, 'binary_f1_score': 0.35840297}
confusion matrix:
      0    1
0  8324  971
1   411  386
early stop counter: 1
val acc:0.7916958928108215, best validation acc: 0.8615977764129639, corresponding to test acc:                         0.8722750544548035 / 0.8722750544548035
after epoch: 14,now: 2024-08-09 22:55:09.207195,epoch time: 0:18:40.346077,used: 4:51:19.514439,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.91873646, 'precision': 0.91904503, 'recall': 0.9187333, 'specificity': 0.9187333, 'f1': 0.9187211, 'auroc': 0.9776523, 'binary_precision': 0.9077317, 'binary_recall': 0.9322735, 'binary_specificity': 0.9051931, 'binary_f1_score': 0.91983896}
confusion matrix:
       0      1
0  23392   2450
1   1751  24103
---- Validation: 
scalar performance:
{'acc': 0.83981544, 'precision': 0.5203359, 'recall': 0.61118186, 'specificity': 0.61118186, 'f1': 0.50680435, 'auroc': 0.67991626, 'binary_precision': 0.05882353, 'binary_recall': 0.3708134, 'binary_specificity': 0.85155034, 'binary_f1_score': 0.10153947}
confusion matrix:
       0     1
0  14226  2480
1    263   155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86821246, 'precision': 0.6382484, 'recall': 0.7334457, 'specificity': 0.7334457, 'f1': 0.6665862, 'auroc': 0.7817626, 'binary_precision': 0.31582585, 'binary_recall': 0.57340026, 'binary_specificity': 0.89349115, 'binary_f1_score': 0.40730837}
confusion matrix:
      0    1
0  8305  990
1   340  457
early stop counter: 2
val acc:0.8398154377937317, best validation acc: 0.8615977764129639, corresponding to test acc:                         0.8722750544548035 / 0.8722750544548035
after epoch: 15,now: 2024-08-09 23:14:15.071668,epoch time: 0:19:05.864473,used: 5:10:25.378912,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_03_49_seed_2_24132710
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:10:25.378912 at 2024-08-09 23:14:15.071668
persisted model performance metric: 

scalar performance:
{'acc': 0.87227505, 'precision': 0.6407919, 'recall': 0.72876847, 'specificity': 0.72876847, 'f1': 0.6684265, 'auroc': 0.7888727, 'binary_precision': 0.3219971, 'binary_recall': 0.55834377, 'binary_specificity': 0.8991931, 'binary_f1_score': 0.40844423}
confusion matrix:
      0    1
0  8358  937
1   352  445
oracle model performance metric: 

scalar performance:
{'acc': 0.87227505, 'precision': 0.6407919, 'recall': 0.72876847, 'specificity': 0.72876847, 'f1': 0.6684265, 'auroc': 0.7888727, 'binary_precision': 0.3219971, 'binary_recall': 0.55834377, 'binary_specificity': 0.8991931, 'binary_f1_score': 0.40844423}
confusion matrix:
      0    1
0  8358  937
1   352  445
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624066 GiB | 624065 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624066 GiB | 624065 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 579948 KiB | 618484 GiB | 618484 GiB |
|       from large pool | 165120 KiB | 508176 KiB | 617636 GiB | 617635 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1476 MiB |    864 MiB |
|       from large pool | 550912 KiB | 661504 KiB |   1342 MiB |    804 MiB |
|       from small pool |  75776 KiB |  77824 KiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 378036 GiB | 378036 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 377090 GiB | 377090 GiB |
|       from small pool |   9343 KiB |  16938 KiB |    946 GiB |    946 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7231    |  132534 K  |  132530 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90198 K  |   90193 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7231    |  132534 K  |  132530 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90198 K  |   90193 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      99    |      45    |
|       from large pool |      17    |      17    |      32    |      15    |
|       from small pool |      37    |      38    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3243    |   70663 K  |   70663 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |      49    |    3240    |   42929 K  |   42929 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 579948 KiB | 618484 GiB | 618484 GiB |
|       from large pool |  16640 KiB | 508176 KiB | 617636 GiB | 617636 GiB |
|       from small pool |      0 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1476 MiB |   1250 MiB |
|       from large pool | 184320 KiB | 661504 KiB |   1342 MiB |   1162 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    134 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 378037 GiB | 378037 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 377090 GiB | 377090 GiB |
|       from small pool |      0 KiB |  16938 KiB |    946 GiB |    946 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7231    |  132534 K  |  132534 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90198 K  |   90198 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7231    |  132534 K  |  132534 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90198 K  |   90198 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      99    |      67    |
|       from large pool |       9    |      17    |      32    |      23    |
|       from small pool |      23    |      38    |      67    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3243    |   70665 K  |   70665 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |       0    |    3240    |   42931 K  |   42931 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 23:30:29 2024]
Finished job 0.
1 of 1 steps (100%) done
