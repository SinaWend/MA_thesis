Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 11:59:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959

 Experiment start at: 2024-08-10 12:07:30.882059
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97050697, 'precision': 0.97056484, 'recall': 0.9705103, 'specificity': 0.9705103, 'f1': 0.9705062, 'auroc': 0.9946101, 'binary_precision': 0.97593296, 'binary_recall': 0.9648424, 'binary_specificity': 0.9761782, 'binary_f1_score': 0.9703559}
confusion matrix:
       0      1
0  24710    603
1    891  24452
---- Validation: 
scalar performance:
{'acc': 0.9568996, 'precision': 0.65130085, 'recall': 0.80519986, 'specificity': 0.80519986, 'f1': 0.6990049, 'auroc': 0.8918981, 'binary_precision': 0.3116279, 'binary_recall': 0.6457831, 'binary_specificity': 0.9646166, 'binary_f1_score': 0.42039216}
confusion matrix:
       0    1
0  16139  592
1    147  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9163536, 'precision': 0.67184633, 'recall': 0.59169704, 'specificity': 0.59169704, 'f1': 0.6156494, 'auroc': 0.8503358, 'binary_precision': 0.40656567, 'binary_recall': 0.20854922, 'binary_specificity': 0.9748448, 'binary_f1_score': 0.27568492}
confusion matrix:
      0    1
0  9107  235
1   611  161
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 12:23:54.842752,epoch time: 0:16:23.960693,used: 0:16:23.960693,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9797655, 'precision': 0.9797654, 'recall': 0.97976553, 'specificity': 0.97976553, 'f1': 0.9797655, 'auroc': 0.9971709, 'binary_precision': 0.97987133, 'binary_recall': 0.979678, 'binary_specificity': 0.97985303, 'binary_f1_score': 0.97977465}
confusion matrix:
       0      1
0  24804    510
1    515  24827
---- Validation: 
scalar performance:
{'acc': 0.9626152, 'precision': 0.6774837, 'recall': 0.84220165, 'specificity': 0.84220165, 'f1': 0.7307905, 'auroc': 0.9144544, 'binary_precision': 0.36219513, 'binary_recall': 0.71566266, 'binary_specificity': 0.96874064, 'binary_f1_score': 0.48097172}
confusion matrix:
       0    1
0  16208  523
1    118  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91427726, 'precision': 0.66743106, 'recall': 0.602456, 'specificity': 0.602456, 'f1': 0.6244572, 'auroc': 0.89422846, 'binary_precision': 0.39606127, 'binary_recall': 0.23445596, 'binary_specificity': 0.970456, 'binary_f1_score': 0.29454842}
confusion matrix:
      0    1
0  9066  276
1   591  181
better model found
persisted
after epoch: 2,now: 2024-08-10 12:39:05.725047,epoch time: 0:15:10.882295,used: 0:31:34.842988,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96261054, 'precision': 0.9642935, 'recall': 0.9625928, 'specificity': 0.9625928, 'f1': 0.9625757, 'auroc': 0.9977509, 'binary_precision': 0.93648785, 'binary_recall': 0.9925818, 'binary_specificity': 0.9326038, 'binary_f1_score': 0.9637193}
confusion matrix:
       0      1
0  23607   1706
1    188  25155
---- Validation: 
scalar performance:
{'acc': 0.90942496, 'precision': 0.590242, 'recall': 0.8607693, 'specificity': 0.8607693, 'f1': 0.6267963, 'auroc': 0.91750884, 'binary_precision': 0.18563536, 'binary_recall': 0.80963856, 'binary_specificity': 0.91190004, 'binary_f1_score': 0.30202246}
confusion matrix:
       0     1
0  15257  1474
1     79   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9149693, 'precision': 0.6705337, 'recall': 0.60283065, 'specificity': 0.60283065, 'f1': 0.6254934, 'auroc': 0.8861947, 'binary_precision': 0.40222222, 'binary_recall': 0.23445596, 'binary_specificity': 0.9712053, 'binary_f1_score': 0.29623568}
confusion matrix:
      0    1
0  9073  269
1   591  181
early stop counter: 1
val acc:0.9094249606132507, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9163535833358765
after epoch: 3,now: 2024-08-10 12:54:04.596917,epoch time: 0:14:58.871870,used: 0:46:33.714858,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98144346, 'precision': 0.9816529, 'recall': 0.98143816, 'specificity': 0.98143816, 'f1': 0.98144126, 'auroc': 0.99853754, 'binary_precision': 0.97173566, 'binary_recall': 0.9917525, 'binary_specificity': 0.9711238, 'binary_f1_score': 0.98164207}
confusion matrix:
       0      1
0  24584    731
1    209  25132
---- Validation: 
scalar performance:
{'acc': 0.94115245, 'precision': 0.62846345, 'recall': 0.8676271, 'specificity': 0.8676271, 'f1': 0.68153435, 'auroc': 0.9276335, 'binary_precision': 0.2624, 'binary_recall': 0.79036146, 'binary_specificity': 0.9448927, 'binary_f1_score': 0.393994}
confusion matrix:
       0    1
0  15809  922
1     87  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9219893, 'precision': 0.64739776, 'recall': 0.51334965, 'specificity': 0.51334965, 'f1': 0.50832933, 'auroc': 0.88903296, 'binary_precision': 0.36923078, 'binary_recall': 0.031088082, 'binary_specificity': 0.9956112, 'binary_f1_score': 0.057347666}
confusion matrix:
      0   1
0  9301  41
1   748  24
new oracle model saved
early stop counter: 2
val acc:0.9411524534225464, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9219893217086792
after epoch: 4,now: 2024-08-10 13:09:17.797673,epoch time: 0:15:13.200756,used: 1:01:46.915614,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9722639, 'precision': 0.97311467, 'recall': 0.9722514, 'specificity': 0.9722514, 'f1': 0.9722509, 'auroc': 0.9984673, 'binary_precision': 0.95319957, 'binary_recall': 0.9933315, 'binary_specificity': 0.95117134, 'binary_f1_score': 0.9728518}
confusion matrix:
       0      1
0  24077   1236
1    169  25174
---- Validation: 
scalar performance:
{'acc': 0.9206229, 'precision': 0.6029746, 'recall': 0.87590665, 'specificity': 0.87590665, 'f1': 0.64678144, 'auroc': 0.9290009, 'binary_precision': 0.21052632, 'binary_recall': 0.82891566, 'binary_specificity': 0.92289764, 'binary_f1_score': 0.33577356}
confusion matrix:
       0     1
0  15441  1290
1     71   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9177378, 'precision': 0.65352505, 'recall': 0.55085605, 'specificity': 0.55085605, 'f1': 0.5680927, 'auroc': 0.8987489, 'binary_precision': 0.37603307, 'binary_recall': 0.11787565, 'binary_specificity': 0.9838364, 'binary_f1_score': 0.1794872}
confusion matrix:
      0    1
0  9191  151
1   681   91
early stop counter: 3
val acc:0.9206228852272034, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9219893217086792
after epoch: 5,now: 2024-08-10 13:24:27.258550,epoch time: 0:15:09.460877,used: 1:16:56.376491,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9694804, 'precision': 0.97078145, 'recall': 0.9694639, 'specificity': 0.9694639, 'f1': 0.9694586, 'auroc': 0.99869657, 'binary_precision': 0.9461902, 'binary_recall': 0.99562025, 'binary_specificity': 0.9433075, 'binary_f1_score': 0.9702761}
confusion matrix:
       0      1
0  23877   1435
1    111  25233
---- Validation: 
scalar performance:
{'acc': 0.88726234, 'precision': 0.573496, 'recall': 0.8458884, 'specificity': 0.8458884, 'f1': 0.5976305, 'auroc': 0.9054867, 'binary_precision': 0.15247253, 'binary_recall': 0.80240965, 'binary_specificity': 0.88936704, 'binary_f1_score': 0.2562524}
confusion matrix:
       0     1
0  14880  1851
1     82   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92159384, 'precision': 0.6170169, 'recall': 0.5089765, 'specificity': 0.5089765, 'f1': 0.50011915, 'auroc': 0.8767909, 'binary_precision': 0.3090909, 'binary_recall': 0.022020726, 'binary_specificity': 0.99593234, 'binary_f1_score': 0.041112456}
confusion matrix:
      0   1
0  9304  38
1   755  17
early stop counter: 4
val acc:0.8872623443603516, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9219893217086792
after epoch: 6,now: 2024-08-10 13:39:34.928337,epoch time: 0:15:07.669787,used: 1:32:04.046278,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9780085, 'precision': 0.9784001, 'recall': 0.9780007, 'specificity': 0.9780007, 'f1': 0.97800374, 'auroc': 0.99874717, 'binary_precision': 0.96485037, 'binary_recall': 0.9921869, 'binary_specificity': 0.9638145, 'binary_f1_score': 0.9783277}
confusion matrix:
       0      1
0  24398    916
1    198  25144
---- Validation: 
scalar performance:
{'acc': 0.95637465, 'precision': 0.646865, 'recall': 0.7920066, 'specificity': 0.7920066, 'f1': 0.69232196, 'auroc': 0.89484304, 'binary_precision': 0.30342385, 'binary_recall': 0.6192771, 'binary_specificity': 0.9647361, 'binary_f1_score': 0.40729}
confusion matrix:
       0    1
0  16141  590
1    158  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92376906, 'precision': 0.96188074, 'recall': 0.50064766, 'specificity': 0.50064766, 'f1': 0.4814787, 'auroc': 0.830746, 'binary_precision': 1.0, 'binary_recall': 0.0012953368, 'binary_specificity': 1.0, 'binary_f1_score': 0.0025873221}
confusion matrix:
      0  1
0  9342  0
1   771  1
new oracle model saved
early stop counter: 5
val acc:0.9563746452331543, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9237690567970276
after epoch: 7,now: 2024-08-10 13:54:28.233049,epoch time: 0:14:53.304712,used: 1:46:57.350990,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95520765, 'precision': 0.9584154, 'recall': 0.9551797, 'specificity': 0.9551797, 'f1': 0.95512724, 'auroc': 0.9983233, 'binary_precision': 0.920236, 'binary_recall': 0.99688303, 'binary_specificity': 0.91347635, 'binary_f1_score': 0.9570273}
confusion matrix:
       0      1
0  23121   2190
1     79  25266
---- Validation: 
scalar performance:
{'acc': 0.8900618, 'precision': 0.5769526, 'recall': 0.8578972, 'specificity': 0.8578972, 'f1': 0.6034154, 'auroc': 0.91796815, 'binary_precision': 0.15877438, 'binary_recall': 0.8240964, 'binary_specificity': 0.89169806, 'binary_f1_score': 0.26625144}
confusion matrix:
       0     1
0  14919  1812
1     73   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9219893, 'precision': 0.6812005, 'recall': 0.53236234, 'specificity': 0.53236234, 'f1': 0.54174125, 'auroc': 0.88684106, 'binary_precision': 0.43410853, 'binary_recall': 0.07253886, 'binary_specificity': 0.99218583, 'binary_f1_score': 0.12430632}
confusion matrix:
      0   1
0  9269  73
1   716  56
early stop counter: 6
val acc:0.8900617957115173, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9237690567970276
after epoch: 8,now: 2024-08-10 14:09:38.893469,epoch time: 0:15:10.660420,used: 2:02:08.011410,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9629264, 'precision': 0.96504617, 'recall': 0.9629091, 'specificity': 0.9629091, 'f1': 0.9628831, 'auroc': 0.9985157, 'binary_precision': 0.93377703, 'binary_recall': 0.99656683, 'binary_specificity': 0.92925143, 'binary_f1_score': 0.9641507}
confusion matrix:
       0      1
0  23524   1791
1     87  25254
---- Validation: 
scalar performance:
{'acc': 0.8966523, 'precision': 0.57678175, 'recall': 0.8342507, 'specificity': 0.8342507, 'f1': 0.60457516, 'auroc': 0.90544116, 'binary_precision': 0.15989976, 'binary_recall': 0.7686747, 'binary_specificity': 0.89982665, 'binary_f1_score': 0.2647303}
confusion matrix:
       0     1
0  15055  1676
1     96   319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9235713, 'precision': 0.70540303, 'recall': 0.51004696, 'specificity': 0.51004696, 'f1': 0.5011645, 'auroc': 0.8344733, 'binary_precision': 0.4857143, 'binary_recall': 0.022020726, 'binary_specificity': 0.9980732, 'binary_f1_score': 0.04213135}
confusion matrix:
      0   1
0  9324  18
1   755  17
early stop counter: 7
val acc:0.8966522812843323, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9237690567970276
after epoch: 9,now: 2024-08-10 14:24:50.910451,epoch time: 0:15:12.016982,used: 2:17:20.028392,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9489103, 'precision': 0.9531895, 'recall': 0.94887966, 'specificity': 0.94887966, 'f1': 0.948787, 'auroc': 0.9986719, 'binary_precision': 0.90931004, 'binary_recall': 0.99735636, 'binary_specificity': 0.90040296, 'binary_f1_score': 0.95130026}
confusion matrix:
       0      1
0  22791   2521
1     67  25277
---- Validation: 
scalar performance:
{'acc': 0.821591, 'precision': 0.5441839, 'recall': 0.78873956, 'specificity': 0.78873956, 'f1': 0.5349667, 'auroc': 0.8630147, 'binary_precision': 0.09571865, 'binary_recall': 0.75421685, 'binary_specificity': 0.8232622, 'binary_f1_score': 0.16987787}
confusion matrix:
       0     1
0  13774  2957
1    102   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221871, 'precision': 0.6841105, 'recall': 0.53187525, 'specificity': 0.53187525, 'f1': 0.5409596, 'auroc': 0.83041424, 'binary_precision': 0.44, 'binary_recall': 0.071243525, 'binary_specificity': 0.992507, 'binary_f1_score': 0.122631}
confusion matrix:
      0   1
0  9272  70
1   717  55
early stop counter: 8
val acc:0.8215910196304321, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9237690567970276
after epoch: 10,now: 2024-08-10 14:39:41.047679,epoch time: 0:14:50.137228,used: 2:32:10.165620,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9617222, 'precision': 0.9638846, 'recall': 0.96169806, 'specificity': 0.96169806, 'f1': 0.9616761, 'auroc': 0.9987613, 'binary_precision': 0.93239, 'binary_recall': 0.9956995, 'binary_specificity': 0.9276966, 'binary_f1_score': 0.96300536}
confusion matrix:
       0      1
0  23480   1830
1    109  25237
---- Validation: 
scalar performance:
{'acc': 0.8956608, 'precision': 0.5690267, 'recall': 0.7937949, 'specificity': 0.7937949, 'f1': 0.5928021, 'auroc': 0.8813779, 'binary_precision': 0.14660494, 'binary_recall': 0.686747, 'binary_specificity': 0.9008427, 'binary_f1_score': 0.24162781}
confusion matrix:
       0     1
0  15072  1659
1    130   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92376906, 'precision': 0.96188074, 'recall': 0.50064766, 'specificity': 0.50064766, 'f1': 0.4814787, 'auroc': 0.780114, 'binary_precision': 1.0, 'binary_recall': 0.0012953368, 'binary_specificity': 1.0, 'binary_f1_score': 0.0025873221}
confusion matrix:
      0  1
0  9342  0
1   771  1
early stop counter: 9
val acc:0.8956608176231384, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9237690567970276
after epoch: 11,now: 2024-08-10 14:54:46.805605,epoch time: 0:15:05.757926,used: 2:47:15.923546,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95765555, 'precision': 0.9605731, 'recall': 0.95763206, 'specificity': 0.95763206, 'f1': 0.9575869, 'auroc': 0.99908984, 'binary_precision': 0.92406404, 'binary_recall': 0.99731684, 'binary_specificity': 0.9179473, 'binary_f1_score': 0.959294}
confusion matrix:
       0      1
0  23236   2077
1     68  25275
---- Validation: 
scalar performance:
{'acc': 0.787239, 'precision': 0.5406111, 'recall': 0.80286074, 'specificity': 0.80286074, 'f1': 0.5176852, 'auroc': 0.883166, 'binary_precision': 0.086889856, 'binary_recall': 0.8192771, 'binary_specificity': 0.7864443, 'binary_f1_score': 0.15711646}
confusion matrix:
       0     1
0  13158  3573
1     75   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92633975, 'precision': 0.91774356, 'recall': 0.51926947, 'specificity': 0.51926947, 'f1': 0.5180888, 'auroc': 0.7880906, 'binary_precision': 0.90909094, 'binary_recall': 0.038860105, 'binary_specificity': 0.99967885, 'binary_f1_score': 0.07453416}
confusion matrix:
      0   1
0  9339   3
1   742  30
new oracle model saved
early stop counter: 10
val acc:0.7872390151023865, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9263397455215454
after epoch: 12,now: 2024-08-10 15:09:49.775253,epoch time: 0:15:02.969648,used: 3:02:18.893194,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9694015, 'precision': 0.97080207, 'recall': 0.9693843, 'specificity': 0.9693843, 'f1': 0.9693779, 'auroc': 0.9990586, 'binary_precision': 0.9452803, 'binary_recall': 0.9965278, 'binary_specificity': 0.94224083, 'binary_f1_score': 0.97022784}
confusion matrix:
       0      1
0  23850   1462
1     88  25256
---- Validation: 
scalar performance:
{'acc': 0.8634667, 'precision': 0.5615962, 'recall': 0.83487034, 'specificity': 0.83487034, 'f1': 0.57358384, 'auroc': 0.90061677, 'binary_precision': 0.12875867, 'binary_recall': 0.8048193, 'binary_specificity': 0.8649214, 'binary_f1_score': 0.22200066}
confusion matrix:
       0     1
0  14471  2260
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9260431, 'precision': 0.8075311, 'recall': 0.52742696, 'specificity': 0.52742696, 'f1': 0.5333453, 'auroc': 0.84092903, 'binary_precision': 0.6875, 'binary_recall': 0.05699482, 'binary_specificity': 0.9978591, 'binary_f1_score': 0.10526316}
confusion matrix:
      0   1
0  9322  20
1   728  44
early stop counter: 11
val acc:0.8634666800498962, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9263397455215454
after epoch: 13,now: 2024-08-10 15:25:03.465257,epoch time: 0:15:13.690004,used: 3:17:32.583198,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95173323, 'precision': 0.9555532, 'recall': 0.951708, 'specificity': 0.951708, 'f1': 0.95162994, 'auroc': 0.9987738, 'binary_precision': 0.9139758, 'binary_recall': 0.99739563, 'binary_specificity': 0.9060204, 'binary_f1_score': 0.9538653}
confusion matrix:
       0      1
0  22935   2379
1     66  25276
---- Validation: 
scalar performance:
{'acc': 0.8877289, 'precision': 0.56604624, 'recall': 0.800305, 'specificity': 0.800305, 'f1': 0.5867044, 'auroc': 0.8850451, 'binary_precision': 0.14013346, 'binary_recall': 0.70843375, 'binary_specificity': 0.8921762, 'binary_f1_score': 0.23398328}
confusion matrix:
       0     1
0  14927  1804
1    121   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9257465, 'precision': 0.8630916, 'recall': 0.5177601, 'specificity': 0.5177601, 'f1': 0.51536167, 'auroc': 0.7253238, 'binary_precision': 0.8, 'binary_recall': 0.03626943, 'binary_specificity': 0.9992507, 'binary_f1_score': 0.069392815}
confusion matrix:
      0   1
0  9335   7
1   744  28
early stop counter: 12
val acc:0.8877289295196533, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9263397455215454
after epoch: 14,now: 2024-08-10 15:40:07.860558,epoch time: 0:15:04.395301,used: 3:32:36.978499,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9595704, 'precision': 0.9622552, 'recall': 0.95954347, 'specificity': 0.95954347, 'f1': 0.95950997, 'auroc': 0.998829, 'binary_precision': 0.9272041, 'binary_recall': 0.9975144, 'binary_specificity': 0.9215725, 'binary_f1_score': 0.96107507}
confusion matrix:
       0      1
0  23325   1985
1     63  25283
---- Validation: 
scalar performance:
{'acc': 0.84812784, 'precision': 0.552553, 'recall': 0.80586183, 'specificity': 0.80586183, 'f1': 0.5557272, 'auroc': 0.87449634, 'binary_precision': 0.11201701, 'binary_recall': 0.76144576, 'binary_specificity': 0.8502779, 'binary_f1_score': 0.19530283}
confusion matrix:
       0     1
0  14226  2505
1     99   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9259442, 'precision': 0.8111075, 'recall': 0.525591, 'specificity': 0.525591, 'f1': 0.530031, 'auroc': 0.75846696, 'binary_precision': 0.69491524, 'binary_recall': 0.053108808, 'binary_specificity': 0.9980732, 'binary_f1_score': 0.098676294}
confusion matrix:
      0   1
0  9324  18
1   731  41
early stop counter: 13
val acc:0.8481278419494629, best validation acc: 0.9626151919364929, corresponding to test acc:                         0.9142772555351257 / 0.9263397455215454
after epoch: 15,now: 2024-08-10 15:55:10.683807,epoch time: 0:15:02.823249,used: 3:47:39.801748,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:47:39.801748 at 2024-08-10 15:55:10.683807
persisted model performance metric: 

scalar performance:
{'acc': 0.91427726, 'precision': 0.66743106, 'recall': 0.602456, 'specificity': 0.602456, 'f1': 0.6244572, 'auroc': 0.89422846, 'binary_precision': 0.39606127, 'binary_recall': 0.23445596, 'binary_specificity': 0.970456, 'binary_f1_score': 0.29454842}
confusion matrix:
      0    1
0  9066  276
1   591  181
oracle model performance metric: 

scalar performance:
{'acc': 0.92633975, 'precision': 0.91774356, 'recall': 0.51926947, 'specificity': 0.51926947, 'f1': 0.5180888, 'auroc': 0.7880906, 'binary_precision': 0.90909094, 'binary_recall': 0.038860105, 'binary_specificity': 0.99967885, 'binary_f1_score': 0.07453416}
confusion matrix:
      0   1
0  9339   3
1   742  30
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239140 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239140 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459821 KiB |   3197 MiB | 235997 GiB | 235996 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 235333 GiB | 235332 GiB |
|       from small pool |  71981 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3464 MiB |   3464 MiB |   3464 MiB |      0 B   |
|       from large pool |   3354 MiB |   3354 MiB |   3354 MiB |      0 B   |
|       from small pool |    110 MiB |    110 MiB |    110 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    791 MiB |   1030 MiB | 173229 GiB | 173228 GiB |
|       from large pool |    782 MiB |   1027 MiB | 172554 GiB | 172553 GiB |
|       from small pool |      8 MiB |     11 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4959    |    7362    |   50034 K  |   50029 K  |
|       from large pool |      87    |     529    |   17451 K  |   17450 K  |
|       from small pool |    4872    |    7273    |   32583 K  |   32578 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4959    |    7362    |   50034 K  |   50029 K  |
|       from large pool |      87    |     529    |   17451 K  |   17450 K  |
|       from small pool |    4872    |    7273    |   32583 K  |   32578 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     115    |     115    |       0    |
|       from large pool |      60    |      60    |      60    |       0    |
|       from small pool |      55    |      55    |      55    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3198    |   23916 K  |   23916 K  |
|       from large pool |      24    |      33    |    8227 K  |    8227 K  |
|       from small pool |      46    |    3175    |   15688 K  |   15688 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239140 GiB | 239140 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239140 GiB | 239140 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1254 MiB |   3464 MiB |   3464 MiB |   2210 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     80 MiB |    110 MiB |    110 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173229 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     15 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50034 K  |   50034 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32583 K  |   32583 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50034 K  |   50034 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32583 K  |   32583 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     115    |     115    |      53    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      40    |      55    |      55    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23918 K  |   23918 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15690 K  |   15690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239140 GiB | 239140 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239140 GiB | 239140 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1254 MiB |   3464 MiB |   3464 MiB |   2210 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     80 MiB |    110 MiB |    110 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173229 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     15 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50034 K  |   50034 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32583 K  |   32583 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50034 K  |   50034 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32583 K  |   32583 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     115    |     115    |      53    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      40    |      55    |      55    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23918 K  |   23918 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15690 K  |   15690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959

 Experiment start at: 2024-08-10 16:04:40.096034
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96096945, 'precision': 0.96116626, 'recall': 0.96096146, 'specificity': 0.96096146, 'f1': 0.9609648, 'auroc': 0.9937154, 'binary_precision': 0.95183414, 'binary_recall': 0.97114325, 'binary_specificity': 0.9507797, 'binary_f1_score': 0.96139175}
confusion matrix:
       0      1
0  24146   1250
1    734  24702
---- Validation: 
scalar performance:
{'acc': 0.9043976, 'precision': 0.5765903, 'recall': 0.791615, 'specificity': 0.791615, 'f1': 0.60525244, 'auroc': 0.8529245, 'binary_precision': 0.16237402, 'binary_recall': 0.6728538, 'binary_specificity': 0.91037625, 'binary_f1_score': 0.2616148}
confusion matrix:
       0     1
0  15196  1496
1    141   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9148746, 'precision': 0.71406007, 'recall': 0.8077142, 'specificity': 0.8077142, 'f1': 0.74939, 'auroc': 0.8985956, 'binary_precision': 0.45502645, 'binary_recall': 0.68163806, 'binary_specificity': 0.93379045, 'binary_f1_score': 0.545743}
confusion matrix:
      0    1
0  8716  618
1   241  516
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 16:20:34.377247,epoch time: 0:15:54.281213,used: 0:15:54.281213,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96893686, 'precision': 0.9693432, 'recall': 0.968926, 'specificity': 0.968926, 'f1': 0.96892965, 'auroc': 0.99662346, 'binary_precision': 0.9557194, 'binary_recall': 0.9834873, 'binary_specificity': 0.9543647, 'binary_f1_score': 0.9694045}
confusion matrix:
       0      1
0  24238   1159
1    420  25015
---- Validation: 
scalar performance:
{'acc': 0.9487239, 'precision': 0.6408148, 'recall': 0.83356285, 'specificity': 0.83356285, 'f1': 0.6923612, 'auroc': 0.87791014, 'binary_precision': 0.28934968, 'binary_recall': 0.71229696, 'binary_specificity': 0.9548287, 'binary_f1_score': 0.41152814}
confusion matrix:
       0    1
0  15938  754
1    124  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92012686, 'precision': 0.6832492, 'recall': 0.5872015, 'specificity': 0.5872015, 'f1': 0.6131797, 'auroc': 0.8794795, 'binary_precision': 0.4289855, 'binary_recall': 0.19550858, 'binary_specificity': 0.97889435, 'binary_f1_score': 0.26860255}
confusion matrix:
      0    1
0  9137  197
1   609  148
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 16:35:31.422128,epoch time: 0:14:57.044881,used: 0:30:51.326094,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.958294, 'precision': 0.95996416, 'recall': 0.95826924, 'specificity': 0.95826924, 'f1': 0.9582545, 'auroc': 0.99637663, 'binary_precision': 0.932453, 'binary_recall': 0.9882455, 'binary_specificity': 0.928293, 'binary_f1_score': 0.95953894}
confusion matrix:
       0      1
0  23574   1821
1    299  25138
---- Validation: 
scalar performance:
{'acc': 0.8865269, 'precision': 0.57335985, 'recall': 0.832175, 'specificity': 0.832175, 'f1': 0.5972107, 'auroc': 0.88890594, 'binary_precision': 0.15321101, 'binary_recall': 0.774942, 'binary_specificity': 0.8894081, 'binary_f1_score': 0.2558407}
confusion matrix:
       0     1
0  14846  1846
1     97   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9179467, 'precision': 0.6499803, 'recall': 0.5556763, 'specificity': 0.5556763, 'f1': 0.57409334, 'auroc': 0.8887744, 'binary_precision': 0.3670412, 'binary_recall': 0.12945838, 'binary_specificity': 0.98189414, 'binary_f1_score': 0.19140625}
confusion matrix:
      0    1
0  9165  169
1   659   98
early stop counter: 1
val acc:0.886526882648468, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9201268553733826
after epoch: 3,now: 2024-08-10 16:50:44.978027,epoch time: 0:15:13.555899,used: 0:46:04.881993,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98422253, 'precision': 0.98423374, 'recall': 0.984221, 'specificity': 0.984221, 'f1': 0.9842224, 'auroc': 0.9982449, 'binary_precision': 0.98207295, 'binary_recall': 0.9864748, 'binary_specificity': 0.9819671, 'binary_f1_score': 0.98426896}
confusion matrix:
       0      1
0  24940    458
1    344  25090
---- Validation: 
scalar performance:
{'acc': 0.93821174, 'precision': 0.6267614, 'recall': 0.8632053, 'specificity': 0.8632053, 'f1': 0.67865413, 'auroc': 0.9055718, 'binary_precision': 0.25940138, 'binary_recall': 0.7842227, 'binary_specificity': 0.94218785, 'binary_f1_score': 0.38985005}
confusion matrix:
       0    1
0  15727  965
1     93  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92438805, 'precision': 0.61892986, 'recall': 0.50271326, 'specificity': 0.50271326, 'f1': 0.48681247, 'auroc': 0.8852974, 'binary_precision': 0.3125, 'binary_recall': 0.00660502, 'binary_specificity': 0.9988215, 'binary_f1_score': 0.012936611}
confusion matrix:
      0   1
0  9323  11
1   752   5
new oracle model saved
early stop counter: 2
val acc:0.9382117390632629, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.92438805103302
after epoch: 4,now: 2024-08-10 17:05:59.812925,epoch time: 0:15:14.834898,used: 1:01:19.716891,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9689172, 'precision': 0.96997607, 'recall': 0.9689005, 'specificity': 0.9689005, 'f1': 0.9688989, 'auroc': 0.9980234, 'binary_precision': 0.9478447, 'binary_recall': 0.99249035, 'binary_specificity': 0.94531065, 'binary_f1_score': 0.9696539}
confusion matrix:
       0      1
0  24009   1389
1    191  25243
---- Validation: 
scalar performance:
{'acc': 0.8997839, 'precision': 0.58430564, 'recall': 0.8502761, 'specificity': 0.8502761, 'f1': 0.6161493, 'auroc': 0.9039562, 'binary_precision': 0.17435378, 'binary_recall': 0.79814386, 'binary_specificity': 0.90240836, 'binary_f1_score': 0.28618968}
confusion matrix:
       0     1
0  15063  1629
1     87   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.924289, 'precision': 0.518063, 'recall': 0.500232, 'specificity': 0.500232, 'f1': 0.48163098, 'auroc': 0.864848, 'binary_precision': 0.11111111, 'binary_recall': 0.001321004, 'binary_specificity': 0.99914294, 'binary_f1_score': 0.0026109663}
confusion matrix:
      0  1
0  9326  8
1   756  1
early stop counter: 3
val acc:0.8997839093208313, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.92438805103302
after epoch: 5,now: 2024-08-10 17:21:11.849745,epoch time: 0:15:12.036820,used: 1:16:31.753711,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9673237, 'precision': 0.9679166, 'recall': 0.9673092, 'specificity': 0.9673092, 'f1': 0.9673127, 'auroc': 0.996613, 'binary_precision': 0.9514659, 'binary_recall': 0.9849432, 'binary_specificity': 0.94967514, 'binary_f1_score': 0.9679152}
confusion matrix:
       0      1
0  24117   1278
1    383  25054
---- Validation: 
scalar performance:
{'acc': 0.92682356, 'precision': 0.5914524, 'recall': 0.7692134, 'specificity': 0.7692134, 'f1': 0.62735116, 'auroc': 0.8822707, 'binary_precision': 0.19374068, 'binary_recall': 0.60324824, 'binary_specificity': 0.9351785, 'binary_f1_score': 0.2932882}
confusion matrix:
       0     1
0  15610  1082
1    171   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.88162637, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
new oracle model saved
early stop counter: 4
val acc:0.9268235564231873, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9249826669692993
after epoch: 6,now: 2024-08-10 17:36:06.577817,epoch time: 0:14:54.728072,used: 1:31:26.481783,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.949638, 'precision': 0.9534389, 'recall': 0.9496021, 'specificity': 0.9496021, 'f1': 0.9495294, 'auroc': 0.997066, 'binary_precision': 0.91212076, 'binary_recall': 0.99524295, 'binary_specificity': 0.90396124, 'binary_f1_score': 0.9518707}
confusion matrix:
       0      1
0  22957   2439
1    121  25315
---- Validation: 
scalar performance:
{'acc': 0.80079424, 'precision': 0.54512787, 'recall': 0.8108046, 'specificity': 0.8108046, 'f1': 0.5293329, 'auroc': 0.8758775, 'binary_precision': 0.095986985, 'binary_recall': 0.8213457, 'binary_specificity': 0.8002636, 'binary_f1_score': 0.17188638}
confusion matrix:
       0     1
0  13358  3334
1     77   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92518085, 'precision': 0.83762515, 'recall': 0.501928, 'specificity': 0.501928, 'f1': 0.48450446, 'auroc': 0.8675864, 'binary_precision': 0.75, 'binary_recall': 0.003963012, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.007884363}
confusion matrix:
      0  1
0  9333  1
1   754  3
new oracle model saved
early stop counter: 5
val acc:0.800794243812561, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9251808524131775
after epoch: 7,now: 2024-08-10 17:51:22.951190,epoch time: 0:15:16.373373,used: 1:46:42.855156,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94279194, 'precision': 0.94813955, 'recall': 0.94275117, 'specificity': 0.94275117, 'f1': 0.94261706, 'auroc': 0.99681664, 'binary_precision': 0.8993724, 'binary_recall': 0.9972479, 'binary_specificity': 0.8882545, 'binary_f1_score': 0.9457847}
confusion matrix:
       0      1
0  22559   2838
1     70  25365
---- Validation: 
scalar performance:
{'acc': 0.7935525, 'precision': 0.54525995, 'recall': 0.82065195, 'specificity': 0.82065195, 'f1': 0.5268166, 'auroc': 0.8839762, 'binary_precision': 0.09541189, 'binary_recall': 0.8491879, 'binary_specificity': 0.792116, 'binary_f1_score': 0.1715491}
confusion matrix:
       0     1
0  13222  3470
1     65   366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.78650343, 'recall': 0.5069441, 'specificity': 0.5069441, 'f1': 0.49483845, 'auroc': 0.8961288, 'binary_precision': 0.64705884, 'binary_recall': 0.014531043, 'binary_specificity': 0.99935716, 'binary_f1_score': 0.028423773}
confusion matrix:
      0   1
0  9328   6
1   746  11
new oracle model saved
early stop counter: 6
val acc:0.7935525178909302, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9254781603813171
after epoch: 8,now: 2024-08-10 18:06:37.521288,epoch time: 0:15:14.570098,used: 2:01:57.425254,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95406437, 'precision': 0.9571512, 'recall': 0.9540305, 'specificity': 0.9540305, 'f1': 0.95398426, 'auroc': 0.9970646, 'binary_precision': 0.9197921, 'binary_recall': 0.99496794, 'binary_specificity': 0.91309315, 'binary_f1_score': 0.95590425}
confusion matrix:
       0      1
0  23188   2207
1    128  25309
---- Validation: 
scalar performance:
{'acc': 0.8490335, 'precision': 0.55713856, 'recall': 0.82198536, 'specificity': 0.82198536, 'f1': 0.56289464, 'auroc': 0.88571936, 'binary_precision': 0.1205074, 'binary_recall': 0.79350346, 'binary_specificity': 0.85046726, 'binary_f1_score': 0.20923829}
confusion matrix:
       0     1
0  14196  2496
1     89   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92488354, 'precision': 0.6625719, 'recall': 0.5011603, 'specificity': 0.5011603, 'f1': 0.48310873, 'auroc': 0.8518802, 'binary_precision': 0.4, 'binary_recall': 0.002642008, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.0052493443}
confusion matrix:
      0  1
0  9331  3
1   755  2
early stop counter: 7
val acc:0.8490334749221802, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9254781603813171
after epoch: 9,now: 2024-08-10 18:21:44.480836,epoch time: 0:15:06.959548,used: 2:17:04.384802,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94344115, 'precision': 0.9484625, 'recall': 0.9434017, 'specificity': 0.9434017, 'f1': 0.9432789, 'auroc': 0.996351, 'binary_precision': 0.90119505, 'binary_recall': 0.9961864, 'binary_specificity': 0.890617, 'binary_f1_score': 0.9463129}
confusion matrix:
       0      1
0  22619   2778
1     97  25338
---- Validation: 
scalar performance:
{'acc': 0.81282485, 'precision': 0.5478598, 'recall': 0.81584513, 'specificity': 0.81584513, 'f1': 0.5374315, 'auroc': 0.873968, 'binary_precision': 0.10143678, 'binary_recall': 0.8190255, 'binary_specificity': 0.81266475, 'binary_f1_score': 0.18051648}
confusion matrix:
       0     1
0  13565  3127
1     78   353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92587453, 'precision': 0.79661834, 'recall': 0.5114069, 'specificity': 0.5114069, 'f1': 0.50367886, 'auroc': 0.87358934, 'binary_precision': 0.6666667, 'binary_recall': 0.023778072, 'binary_specificity': 0.9990358, 'binary_f1_score': 0.045918368}
confusion matrix:
      0   1
0  9325   9
1   739  18
new oracle model saved
early stop counter: 8
val acc:0.8128248453140259, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 10,now: 2024-08-10 18:36:37.816275,epoch time: 0:14:53.335439,used: 2:31:57.720241,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95341516, 'precision': 0.9567927, 'recall': 0.95337975, 'specificity': 0.95337975, 'f1': 0.95332634, 'auroc': 0.9976437, 'binary_precision': 0.9177199, 'binary_recall': 0.99622595, 'binary_specificity': 0.91053355, 'binary_f1_score': 0.95536286}
confusion matrix:
       0      1
0  23123   2272
1     96  25341
---- Validation: 
scalar performance:
{'acc': 0.84745663, 'precision': 0.5568994, 'recall': 0.82343686, 'specificity': 0.82343686, 'f1': 0.56203985, 'auroc': 0.8913387, 'binary_precision': 0.1199024, 'binary_recall': 0.79814386, 'binary_specificity': 0.8487299, 'binary_f1_score': 0.20848486}
confusion matrix:
       0     1
0  14167  2525
1     87   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.7125335, 'recall': 0.50060695, 'specificity': 0.50060695, 'f1': 0.48183033, 'auroc': 0.8708473, 'binary_precision': 0.5, 'binary_recall': 0.001321004, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0026350461}
confusion matrix:
      0  1
0  9333  1
1   756  1
early stop counter: 9
val acc:0.8474566340446472, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 11,now: 2024-08-10 18:51:45.474867,epoch time: 0:15:07.658592,used: 2:47:05.378833,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9689566, 'precision': 0.9703058, 'recall': 0.9689356, 'specificity': 0.9689356, 'f1': 0.9689332, 'auroc': 0.99826217, 'binary_precision': 0.9453113, 'binary_recall': 0.9955575, 'binary_specificity': 0.94231373, 'binary_f1_score': 0.96978396}
confusion matrix:
       0      1
0  23931   1465
1    113  25323
---- Validation: 
scalar performance:
{'acc': 0.8943526, 'precision': 0.57378256, 'recall': 0.81019574, 'specificity': 0.81019574, 'f1': 0.5995009, 'auroc': 0.8848992, 'binary_precision': 0.1555, 'binary_recall': 0.7215777, 'binary_specificity': 0.8988138, 'binary_f1_score': 0.25586176}
confusion matrix:
       0     1
0  15003  1689
1    120   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.85169387, 'recall': 0.50451636, 'specificity': 0.50451636, 'f1': 0.4897729, 'auroc': 0.869171, 'binary_precision': 0.7777778, 'binary_recall': 0.009247027, 'binary_specificity': 0.9997857, 'binary_f1_score': 0.018276762}
confusion matrix:
      0  1
0  9332  2
1   750  7
early stop counter: 10
val acc:0.8943526148796082, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 12,now: 2024-08-10 19:06:50.376383,epoch time: 0:15:04.901516,used: 3:02:10.280349,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8999449, 'precision': 0.9162183, 'recall': 0.89987105, 'specificity': 0.89987105, 'f1': 0.8989452, 'auroc': 0.9974637, 'binary_precision': 0.834105, 'binary_recall': 0.99866325, 'binary_specificity': 0.80107886, 'binary_f1_score': 0.90899664}
confusion matrix:
       0      1
0  20345   5052
1     34  25401
---- Validation: 
scalar performance:
{'acc': 0.5662559, 'precision': 0.5244355, 'recall': 0.7470144, 'specificity': 0.7470144, 'f1': 0.4062924, 'auroc': 0.88805103, 'binary_precision': 0.051768325, 'binary_recall': 0.937355, 'binary_specificity': 0.5566739, 'binary_f1_score': 0.09811779}
confusion matrix:
      0     1
0  9292  7400
1    27   404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9268655, 'precision': 0.774769, 'recall': 0.53075755, 'specificity': 0.53075755, 'f1': 0.53953874, 'auroc': 0.78869164, 'binary_precision': 0.62025315, 'binary_recall': 0.06472919, 'binary_specificity': 0.99678594, 'binary_f1_score': 0.11722487}
confusion matrix:
      0   1
0  9304  30
1   708  49
new oracle model saved
early stop counter: 11
val acc:0.5662559270858765, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9268655180931091
after epoch: 13,now: 2024-08-10 19:21:39.250698,epoch time: 0:14:48.874315,used: 3:16:59.154664,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9321687, 'precision': 0.9398516, 'recall': 0.93211424, 'specificity': 0.93211424, 'f1': 0.93186533, 'auroc': 0.99717844, 'binary_precision': 0.8819259, 'binary_recall': 0.9980737, 'binary_specificity': 0.86615473, 'binary_f1_score': 0.9364119}
confusion matrix:
       0      1
0  21996   3399
1     49  25388
---- Validation: 
scalar performance:
{'acc': 0.7788355, 'precision': 0.5419949, 'recall': 0.81084317, 'specificity': 0.81084317, 'f1': 0.5169324, 'auroc': 0.867674, 'binary_precision': 0.08912831, 'binary_recall': 0.84454757, 'binary_specificity': 0.77713877, 'binary_f1_score': 0.16124031}
confusion matrix:
       0     1
0  12972  3720
1     67   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92646915, 'precision': 0.85232294, 'recall': 0.51354915, 'specificity': 0.51354915, 'f1': 0.50766003, 'auroc': 0.84784746, 'binary_precision': 0.7777778, 'binary_recall': 0.027741084, 'binary_specificity': 0.99935716, 'binary_f1_score': 0.05357143}
confusion matrix:
      0   1
0  9328   6
1   736  21
early stop counter: 12
val acc:0.7788354754447937, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9268655180931091
after epoch: 14,now: 2024-08-10 19:36:43.820982,epoch time: 0:15:04.570284,used: 3:32:03.724948,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9399197, 'precision': 0.9458627, 'recall': 0.9398767, 'specificity': 0.9398767, 'f1': 0.9397148, 'auroc': 0.99725115, 'binary_precision': 0.8945735, 'binary_recall': 0.9974838, 'binary_specificity': 0.88226956, 'binary_f1_score': 0.94323}
confusion matrix:
       0      1
0  22407   2990
1     64  25371
---- Validation: 
scalar performance:
{'acc': 0.8206506, 'precision': 0.5497649, 'recall': 0.8187289, 'specificity': 0.8187289, 'f1': 0.5428529, 'auroc': 0.8748265, 'binary_precision': 0.10526316, 'binary_recall': 0.81670535, 'binary_specificity': 0.82075244, 'binary_f1_score': 0.18649007}
confusion matrix:
       0     1
0  13700  2992
1     79   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9260727, 'precision': 0.84415996, 'recall': 0.5103002, 'specificity': 0.5103002, 'f1': 0.5013427, 'auroc': 0.87368786, 'binary_precision': 0.7619048, 'binary_recall': 0.021136064, 'binary_specificity': 0.99946433, 'binary_f1_score': 0.04113111}
confusion matrix:
      0   1
0  9329   5
1   741  16
early stop counter: 13
val acc:0.820650577545166, best validation acc: 0.9487239122390747, corresponding to test acc:                         0.9201268553733826 / 0.9268655180931091
after epoch: 15,now: 2024-08-10 19:51:50.204171,epoch time: 0:15:06.383189,used: 3:47:10.108137,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:47:10.108137 at 2024-08-10 19:51:50.204171
persisted model performance metric: 

scalar performance:
{'acc': 0.92012686, 'precision': 0.6832492, 'recall': 0.5872015, 'specificity': 0.5872015, 'f1': 0.6131797, 'auroc': 0.8794795, 'binary_precision': 0.4289855, 'binary_recall': 0.19550858, 'binary_specificity': 0.97889435, 'binary_f1_score': 0.26860255}
confusion matrix:
      0    1
0  9137  197
1   609  148
oracle model performance metric: 

scalar performance:
{'acc': 0.9268655, 'precision': 0.774769, 'recall': 0.53075755, 'specificity': 0.53075755, 'f1': 0.53953874, 'auroc': 0.78869164, 'binary_precision': 0.62025315, 'binary_recall': 0.06472919, 'binary_specificity': 0.99678594, 'binary_f1_score': 0.11722487}
confusion matrix:
      0   1
0  9304  30
1   708  49
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 472248 KiB |   3238 MiB | 482772 GiB | 482771 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481409 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 472248 KiB |   3238 MiB | 482772 GiB | 482771 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481409 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 474901 GiB | 474900 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 473559 GiB | 473559 GiB |
|       from small pool |  71980 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3462 MiB |   3464 MiB |   5672 MiB |   2210 MiB |
|       from large pool |   3354 MiB |   3354 MiB |   5534 MiB |   2180 MiB |
|       from small pool |    108 MiB |    110 MiB |    138 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    806 MiB |   1050 MiB | 354697 GiB | 354696 GiB |
|       from large pool |    796 MiB |   1046 MiB | 353334 GiB | 353333 GiB |
|       from small pool |     10 MiB |     15 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7384    |  100574 K  |  100569 K  |
|       from large pool |      87    |     529    |   35136 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65437 K  |   65433 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7384    |  100574 K  |  100569 K  |
|       from large pool |      87    |     529    |   35136 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65437 K  |   65433 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     111    |     115    |     164    |      53    |
|       from large pool |      57    |      60    |      95    |      38    |
|       from small pool |      54    |      55    |      69    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3211    |   47843 K  |   47843 K  |
|       from large pool |      26    |      33    |   16342 K  |   16342 K  |
|       from small pool |      51    |    3186    |   31500 K  |   31500 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473559 GiB | 473559 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5672 MiB |   4404 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    138 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354697 GiB | 354697 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353334 GiB | 353334 GiB |
|       from small pool |      0 KiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100574 K  |  100574 K  |
|       from large pool |       2    |     529    |   35136 K  |   35136 K  |
|       from small pool |       0    |    7295    |   65437 K  |   65437 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100574 K  |  100574 K  |
|       from large pool |       2    |     529    |   35136 K  |   35136 K  |
|       from small pool |       0    |    7295    |   65437 K  |   65437 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     164    |      99    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      69    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47845 K  |   47845 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31502 K  |   31502 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473559 GiB | 473559 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5672 MiB |   4404 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    138 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354697 GiB | 354697 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353334 GiB | 353334 GiB |
|       from small pool |      0 KiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100574 K  |  100574 K  |
|       from large pool |       2    |     529    |   35136 K  |   35136 K  |
|       from small pool |       0    |    7295    |   65437 K  |   65437 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100574 K  |  100574 K  |
|       from large pool |       2    |     529    |   35136 K  |   35136 K  |
|       from small pool |       0    |    7295    |   65437 K  |   65437 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     164    |      99    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      69    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47845 K  |   47845 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31502 K  |   31502 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959

 Experiment start at: 2024-08-10 20:00:49.062144
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9584494, 'precision': 0.9594779, 'recall': 0.9584476, 'specificity': 0.9584476, 'f1': 0.958426, 'auroc': 0.9947094, 'binary_precision': 0.93775856, 'binary_recall': 0.982089, 'binary_specificity': 0.93480617, 'binary_f1_score': 0.959412}
confusion matrix:
       0      1
0  24161   1685
1    463  25387
---- Validation: 
scalar performance:
{'acc': 0.90831584, 'precision': 0.5843846, 'recall': 0.82938915, 'specificity': 0.82938915, 'f1': 0.6177161, 'auroc': 0.8853544, 'binary_precision': 0.17567568, 'binary_recall': 0.7464115, 'binary_specificity': 0.9123668, 'binary_f1_score': 0.28441203}
confusion matrix:
       0     1
0  15242  1464
1    106   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90546966, 'precision': 0.69967747, 'recall': 0.7794818, 'specificity': 0.7794818, 'f1': 0.7302127, 'auroc': 0.86687136, 'binary_precision': 0.43238586, 'binary_recall': 0.629862, 'binary_specificity': 0.92910165, 'binary_f1_score': 0.51276815}
confusion matrix:
      0    1
0  8636  659
1   295  502
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 20:17:08.428582,epoch time: 0:16:19.366438,used: 0:16:19.366438,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9746209, 'precision': 0.9747939, 'recall': 0.97461975, 'specificity': 0.97461975, 'f1': 0.97461855, 'auroc': 0.99727654, 'binary_precision': 0.9657594, 'binary_recall': 0.98413986, 'binary_specificity': 0.96509963, 'binary_f1_score': 0.97486305}
confusion matrix:
       0      1
0  24943    902
1    410  25441
---- Validation: 
scalar performance:
{'acc': 0.928171, 'precision': 0.6057123, 'recall': 0.8418976, 'specificity': 0.8418976, 'f1': 0.6500116, 'auroc': 0.9052119, 'binary_precision': 0.21805556, 'binary_recall': 0.75119615, 'binary_specificity': 0.93259907, 'binary_f1_score': 0.33799788}
confusion matrix:
       0     1
0  15580  1126
1    104   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91944116, 'precision': 0.7165235, 'recall': 0.6648982, 'specificity': 0.6648982, 'f1': 0.6861338, 'auroc': 0.88112617, 'binary_precision': 0.48653197, 'binary_recall': 0.36260977, 'binary_specificity': 0.9671866, 'binary_f1_score': 0.41552842}
confusion matrix:
      0    1
0  8990  305
1   508  289
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 20:32:30.271844,epoch time: 0:15:21.843262,used: 0:31:41.209700,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9684502, 'precision': 0.96933514, 'recall': 0.9684477, 'specificity': 0.9684477, 'f1': 0.96843517, 'auroc': 0.99773276, 'binary_precision': 0.94898415, 'binary_recall': 0.9901358, 'binary_specificity': 0.9467595, 'binary_f1_score': 0.9691233}
confusion matrix:
       0      1
0  24469   1376
1    255  25596
---- Validation: 
scalar performance:
{'acc': 0.9299813, 'precision': 0.60925126, 'recall': 0.84865665, 'specificity': 0.84865665, 'f1': 0.6551559, 'auroc': 0.90873134, 'binary_precision': 0.2248062, 'binary_recall': 0.7631579, 'binary_specificity': 0.9341554, 'binary_f1_score': 0.3473054}
confusion matrix:
       0     1
0  15606  1100
1     99   319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91676575, 'precision': 0.6907646, 'recall': 0.5986335, 'specificity': 0.5986335, 'f1': 0.6255364, 'auroc': 0.8792653, 'binary_precision': 0.44556963, 'binary_recall': 0.2208281, 'binary_specificity': 0.97643894, 'binary_f1_score': 0.295302}
confusion matrix:
      0    1
0  9076  219
1   621  176
better model found
persisted
after epoch: 3,now: 2024-08-10 20:48:02.242337,epoch time: 0:15:31.970493,used: 0:47:13.180193,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98384786, 'precision': 0.98391044, 'recall': 0.98384655, 'specificity': 0.98384655, 'f1': 0.9838474, 'auroc': 0.9986557, 'binary_precision': 0.9784663, 'binary_recall': 0.98947936, 'binary_specificity': 0.9782138, 'binary_f1_score': 0.98394203}
confusion matrix:
       0      1
0  25279    563
1    272  25582
---- Validation: 
scalar performance:
{'acc': 0.94335437, 'precision': 0.62816876, 'recall': 0.84151554, 'specificity': 0.84151554, 'f1': 0.678965, 'auroc': 0.91382, 'binary_precision': 0.2632933, 'binary_recall': 0.73444974, 'binary_specificity': 0.94858134, 'binary_f1_score': 0.38762626}
confusion matrix:
       0    1
0  15847  859
1    111  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9182521, 'precision': 0.7017597, 'recall': 0.60861737, 'specificity': 0.60861737, 'f1': 0.63706976, 'auroc': 0.8894861, 'binary_precision': 0.46601942, 'binary_recall': 0.24090339, 'binary_specificity': 0.97633135, 'binary_f1_score': 0.31761786}
confusion matrix:
      0    1
0  9075  220
1   605  192
better model found
persisted
after epoch: 4,now: 2024-08-10 21:03:33.406903,epoch time: 0:15:31.164566,used: 1:02:44.344759,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98305476, 'precision': 0.9831238, 'recall': 0.9830534, 'specificity': 0.9830534, 'f1': 0.9830541, 'auroc': 0.9985509, 'binary_precision': 0.97740823, 'binary_recall': 0.98897654, 'binary_specificity': 0.97713023, 'binary_f1_score': 0.98315835}
confusion matrix:
       0      1
0  25251    591
1    285  25569
---- Validation: 
scalar performance:
{'acc': 0.95999765, 'precision': 0.66594666, 'recall': 0.8232218, 'specificity': 0.8232218, 'f1': 0.71627563, 'auroc': 0.9094212, 'binary_precision': 0.34011975, 'binary_recall': 0.67942584, 'binary_specificity': 0.9670178, 'binary_f1_score': 0.45331207}
confusion matrix:
       0    1
0  16155  551
1    134  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9205311, 'precision': 0.5969826, 'recall': 0.50145173, 'specificity': 0.50145173, 'f1': 0.48301715, 'auroc': 0.8523717, 'binary_precision': 0.27272728, 'binary_recall': 0.0037641155, 'binary_specificity': 0.9991393, 'binary_f1_score': 0.007425742}
confusion matrix:
      0  1
0  9287  8
1   794  3
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-10 21:19:07.687157,epoch time: 0:15:34.280254,used: 1:18:18.625013,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96400106, 'precision': 0.9657012, 'recall': 0.9639941, 'specificity': 0.9639941, 'f1': 0.9639678, 'auroc': 0.9982357, 'binary_precision': 0.9376208, 'binary_recall': 0.9941595, 'binary_specificity': 0.93382865, 'binary_f1_score': 0.9650628}
confusion matrix:
       0      1
0  24132   1710
1    151  25703
---- Validation: 
scalar performance:
{'acc': 0.89797944, 'precision': 0.57741284, 'recall': 0.82992285, 'specificity': 0.82992285, 'f1': 0.60572654, 'auroc': 0.9060918, 'binary_precision': 0.16148752, 'binary_recall': 0.7583732, 'binary_specificity': 0.9014725, 'binary_f1_score': 0.2662747}
confusion matrix:
       0     1
0  15060  1646
1    101   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.7126627, 'recall': 0.5292516, 'specificity': 0.5292516, 'f1': 0.536066, 'auroc': 0.8338473, 'binary_precision': 0.5, 'binary_recall': 0.06398996, 'binary_specificity': 0.99451315, 'binary_f1_score': 0.1134594}
confusion matrix:
      0   1
0  9244  51
1   746  51
new oracle model saved
early stop counter: 1
val acc:0.8979794383049011, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9210265278816223
after epoch: 6,now: 2024-08-10 21:34:38.144910,epoch time: 0:15:30.457753,used: 1:33:49.082766,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.948584, 'precision': 0.9525362, 'recall': 0.9485696, 'specificity': 0.9485696, 'f1': 0.94847035, 'auroc': 0.9980047, 'binary_precision': 0.9103226, 'binary_recall': 0.9952429, 'binary_specificity': 0.9018963, 'binary_f1_score': 0.95089054}
confusion matrix:
       0      1
0  23305   2535
1    123  25733
---- Validation: 
scalar performance:
{'acc': 0.8605466, 'precision': 0.5616308, 'recall': 0.83872795, 'specificity': 0.83872795, 'f1': 0.57277864, 'auroc': 0.90509754, 'binary_precision': 0.12858221, 'binary_recall': 0.81578946, 'binary_specificity': 0.86166644, 'binary_f1_score': 0.22214983}
confusion matrix:
       0     1
0  14395  2311
1     77   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92191833, 'precision': 0.7514069, 'recall': 0.5194116, 'specificity': 0.5194116, 'f1': 0.51825887, 'auroc': 0.8464959, 'binary_precision': 0.57894737, 'binary_recall': 0.041405268, 'binary_specificity': 0.997418, 'binary_f1_score': 0.07728337}
confusion matrix:
      0   1
0  9271  24
1   764  33
new oracle model saved
early stop counter: 2
val acc:0.8605465888977051, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9219183325767517
after epoch: 7,now: 2024-08-10 21:51:41.404303,epoch time: 0:17:03.259393,used: 1:50:52.342159,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9575596, 'precision': 0.9603751, 'recall': 0.95755506, 'specificity': 0.95755506, 'f1': 0.9574943, 'auroc': 0.9986713, 'binary_precision': 0.9244017, 'binary_recall': 0.99663454, 'binary_specificity': 0.9184755, 'binary_f1_score': 0.95916015}
confusion matrix:
       0      1
0  23738   2107
1     87  25764
---- Validation: 
scalar performance:
{'acc': 0.8652184, 'precision': 0.56435084, 'recall': 0.8457873, 'specificity': 0.8457873, 'f1': 0.5781487, 'auroc': 0.90767205, 'binary_precision': 0.13372093, 'binary_recall': 0.82535887, 'binary_specificity': 0.8662157, 'binary_f1_score': 0.23015344}
confusion matrix:
       0     1
0  14471  2235
1     73   345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9232065, 'precision': 0.80710584, 'recall': 0.5241259, 'specificity': 0.5241259, 'f1': 0.526736, 'auroc': 0.85137963, 'binary_precision': 0.6896552, 'binary_recall': 0.050188206, 'binary_specificity': 0.9980635, 'binary_f1_score': 0.09356725}
confusion matrix:
      0   1
0  9277  18
1   757  40
new oracle model saved
early stop counter: 3
val acc:0.8652184009552002, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9232065081596375
after epoch: 8,now: 2024-08-10 22:07:48.263169,epoch time: 0:16:06.858866,used: 2:06:59.201025,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9483519, 'precision': 0.9526429, 'recall': 0.9483406, 'specificity': 0.9483406, 'f1': 0.9482283, 'auroc': 0.9985963, 'binary_precision': 0.9086294, 'binary_recall': 0.99698305, 'binary_specificity': 0.89969814, 'binary_f1_score': 0.950758}
confusion matrix:
       0      1
0  23250   2592
1     78  25776
---- Validation: 
scalar performance:
{'acc': 0.8128358, 'precision': 0.54919624, 'recall': 0.8364343, 'specificity': 0.8364343, 'f1': 0.53887206, 'auroc': 0.90272427, 'binary_precision': 0.10265184, 'binary_recall': 0.861244, 'binary_specificity': 0.8116246, 'binary_f1_score': 0.1834395}
confusion matrix:
       0     1
0  13559  3147
1     58   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92201746, 'precision': 0.7536882, 'recall': 0.52061254, 'specificity': 0.52061254, 'f1': 0.52048, 'auroc': 0.7792596, 'binary_precision': 0.5833333, 'binary_recall': 0.04391468, 'binary_specificity': 0.9973104, 'binary_f1_score': 0.081680275}
confusion matrix:
      0   1
0  9270  25
1   762  35
early stop counter: 4
val acc:0.8128358125686646, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9232065081596375
after epoch: 9,now: 2024-08-10 22:23:12.464382,epoch time: 0:15:24.201213,used: 2:22:23.402238,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9549869, 'precision': 0.9580433, 'recall': 0.95498526, 'specificity': 0.95498526, 'f1': 0.95491153, 'auroc': 0.9985726, 'binary_precision': 0.9206366, 'binary_recall': 0.9958219, 'binary_specificity': 0.9141486, 'binary_f1_score': 0.95675445}
confusion matrix:
       0      1
0  23628   2219
1    108  25741
---- Validation: 
scalar performance:
{'acc': 0.90066576, 'precision': 0.57852954, 'recall': 0.82663465, 'specificity': 0.82663465, 'f1': 0.607864, 'auroc': 0.9006137, 'binary_precision': 0.16396019, 'binary_recall': 0.74880385, 'binary_specificity': 0.90446544, 'binary_f1_score': 0.26901588}
confusion matrix:
       0     1
0  15110  1596
1    105   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9232065, 'precision': 0.8179206, 'recall': 0.52240515, 'specificity': 0.52240515, 'f1': 0.52353936, 'auroc': 0.79388744, 'binary_precision': 0.71153843, 'binary_recall': 0.04642409, 'binary_specificity': 0.9983862, 'binary_f1_score': 0.08716137}
confusion matrix:
      0   1
0  9280  15
1   760  37
early stop counter: 5
val acc:0.9006657600402832, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9232065081596375
after epoch: 10,now: 2024-08-10 22:38:24.609810,epoch time: 0:15:12.145428,used: 2:37:35.547666,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.969959, 'precision': 0.97107613, 'recall': 0.9699515, 'specificity': 0.9699515, 'f1': 0.96994084, 'auroc': 0.9986181, 'binary_precision': 0.9482129, 'binary_recall': 0.9942373, 'binary_specificity': 0.94566566, 'binary_f1_score': 0.9706798}
confusion matrix:
       0      1
0  24436   1404
1    149  25707
---- Validation: 
scalar performance:
{'acc': 0.9120533, 'precision': 0.5854851, 'recall': 0.8196422, 'specificity': 0.8196422, 'f1': 0.61969775, 'auroc': 0.89889437, 'binary_precision': 0.178487, 'binary_recall': 0.72248805, 'binary_specificity': 0.9167964, 'binary_f1_score': 0.28625593}
confusion matrix:
       0     1
0  15316  1390
1    116   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92201746, 'precision': 0.8500265, 'recall': 0.50856775, 'specificity': 0.50856775, 'f1': 0.49686193, 'auroc': 0.80798763, 'binary_precision': 0.7777778, 'binary_recall': 0.017565873, 'binary_specificity': 0.99956965, 'binary_f1_score': 0.03435583}
confusion matrix:
      0   1
0  9291   4
1   783  14
early stop counter: 6
val acc:0.9120532870292664, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9232065081596375
after epoch: 11,now: 2024-08-10 22:53:54.757581,epoch time: 0:15:30.147771,used: 2:53:05.695437,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92173475, 'precision': 0.93188846, 'recall': 0.92172587, 'specificity': 0.92172587, 'f1': 0.92127097, 'auroc': 0.997931, 'binary_precision': 0.8656962, 'binary_recall': 0.9983753, 'binary_specificity': 0.84507644, 'binary_f1_score': 0.9273139}
confusion matrix:
       0      1
0  21841   4004
1     42  25809
---- Validation: 
scalar performance:
{'acc': 0.82241297, 'precision': 0.5505087, 'recall': 0.8320128, 'specificity': 0.8320128, 'f1': 0.54414445, 'auroc': 0.88177824, 'binary_precision': 0.10580102, 'binary_recall': 0.84210527, 'binary_specificity': 0.8219203, 'binary_f1_score': 0.18798397}
confusion matrix:
       0     1
0  13731  2975
1     66   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231074, 'precision': 0.7683021, 'recall': 0.5343961, 'specificity': 0.5343961, 'f1': 0.5449105, 'auroc': 0.8356143, 'binary_precision': 0.6105263, 'binary_recall': 0.0727729, 'binary_specificity': 0.99601936, 'binary_f1_score': 0.13004483}
confusion matrix:
      0   1
0  9258  37
1   739  58
early stop counter: 7
val acc:0.8224129676818848, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9232065081596375
after epoch: 12,now: 2024-08-10 23:09:27.063207,epoch time: 0:15:32.305626,used: 3:08:38.001063,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9121209, 'precision': 0.92476416, 'recall': 0.9121008, 'specificity': 0.9121008, 'f1': 0.91145915, 'auroc': 0.9982612, 'binary_precision': 0.851539, 'binary_recall': 0.9983368, 'binary_specificity': 0.82586485, 'binary_f1_score': 0.91911334}
confusion matrix:
       0      1
0  21342   4500
1     43  25811
---- Validation: 
scalar performance:
{'acc': 0.7117496, 'precision': 0.5352546, 'recall': 0.81611514, 'specificity': 0.81611514, 'f1': 0.48129466, 'auroc': 0.9000994, 'binary_precision': 0.07312925, 'binary_recall': 0.92583734, 'binary_specificity': 0.7063929, 'binary_f1_score': 0.13555168}
confusion matrix:
       0     1
0  11801  4905
1     31   387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92181927, 'precision': 0.7386261, 'recall': 0.52451986, 'specificity': 0.52451986, 'f1': 0.5276812, 'auroc': 0.8402827, 'binary_precision': 0.55263156, 'binary_recall': 0.052697618, 'binary_specificity': 0.9963421, 'binary_f1_score': 0.096219935}
confusion matrix:
      0   1
0  9261  34
1   755  42
early stop counter: 8
val acc:0.7117496132850647, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9232065081596375
after epoch: 13,now: 2024-08-10 23:25:00.005987,epoch time: 0:15:32.942780,used: 3:24:10.943843,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9480811, 'precision': 0.95256597, 'recall': 0.94806767, 'specificity': 0.94806767, 'f1': 0.9479511, 'auroc': 0.99884415, 'binary_precision': 0.9075813, 'binary_recall': 0.9977954, 'binary_specificity': 0.89833987, 'binary_f1_score': 0.9505527}
confusion matrix:
       0      1
0  23214   2627
1     57  25798
---- Validation: 
scalar performance:
{'acc': 0.8590283, 'precision': 0.5599578, 'recall': 0.83095235, 'specificity': 0.83095235, 'f1': 0.5698946, 'auroc': 0.9013562, 'binary_precision': 0.12565641, 'binary_recall': 0.8014354, 'binary_specificity': 0.8604693, 'binary_f1_score': 0.21725032}
confusion matrix:
       0     1
0  14375  2331
1     83   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92261195, 'precision': 0.7835151, 'recall': 0.5215089, 'specificity': 0.5215089, 'f1': 0.52200323, 'auroc': 0.8794812, 'binary_precision': 0.64285713, 'binary_recall': 0.045169387, 'binary_specificity': 0.99784833, 'binary_f1_score': 0.08440797}
confusion matrix:
      0   1
0  9275  20
1   761  36
early stop counter: 9
val acc:0.8590282797813416, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9232065081596375
after epoch: 14,now: 2024-08-10 23:40:30.751140,epoch time: 0:15:30.745153,used: 3:39:41.688996,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9496286, 'precision': 0.9537512, 'recall': 0.9496212, 'specificity': 0.9496212, 'f1': 0.9495133, 'auroc': 0.9987438, 'binary_precision': 0.910539, 'binary_recall': 0.9972536, 'binary_specificity': 0.90198886, 'binary_f1_score': 0.9519256}
confusion matrix:
       0      1
0  23311   2533
1     71  25781
---- Validation: 
scalar performance:
{'acc': 0.82784396, 'precision': 0.54776585, 'recall': 0.80330765, 'specificity': 0.80330765, 'f1': 0.5422366, 'auroc': 0.87211144, 'binary_precision': 0.10220126, 'binary_recall': 0.77751195, 'binary_specificity': 0.8291033, 'binary_f1_score': 0.18065591}
confusion matrix:
       0     1
0  13851  2855
1     93   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92092746, 'precision': 0.70944524, 'recall': 0.52460927, 'specificity': 0.52460927, 'f1': 0.52796894, 'auroc': 0.84226143, 'binary_precision': 0.49425286, 'binary_recall': 0.05395232, 'binary_specificity': 0.99526626, 'binary_f1_score': 0.09728507}
confusion matrix:
      0   1
0  9251  44
1   754  43
early stop counter: 10
val acc:0.827843964099884, best validation acc: 0.9599976539611816, corresponding to test acc:                         0.9205310940742493 / 0.9232065081596375
after epoch: 15,now: 2024-08-10 23:56:13.380828,epoch time: 0:15:42.629688,used: 3:55:24.318684,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_00_48_seed_2_24141959
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:55:24.318684 at 2024-08-10 23:56:13.380828
persisted model performance metric: 

scalar performance:
{'acc': 0.9205311, 'precision': 0.5969826, 'recall': 0.50145173, 'specificity': 0.50145173, 'f1': 0.48301715, 'auroc': 0.8523717, 'binary_precision': 0.27272728, 'binary_recall': 0.0037641155, 'binary_specificity': 0.9991393, 'binary_f1_score': 0.007425742}
confusion matrix:
      0  1
0  9287  8
1   794  3
oracle model performance metric: 

scalar performance:
{'acc': 0.9232065, 'precision': 0.80710584, 'recall': 0.5241259, 'specificity': 0.5241259, 'f1': 0.526736, 'auroc': 0.85137963, 'binary_precision': 0.6896552, 'binary_recall': 0.050188206, 'binary_specificity': 0.9980635, 'binary_f1_score': 0.09356725}
confusion matrix:
      0   1
0  9277  18
1   757  40
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 470488 KiB |   3238 MiB | 732912 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 470488 KiB |   3238 MiB | 732912 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 722604 GiB | 722603 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |  71980 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3482 MiB |   3482 MiB |   7886 MiB |   4404 MiB |
|       from large pool |   3374 MiB |   3374 MiB |   7722 MiB |   4348 MiB |
|       from small pool |    108 MiB |    110 MiB |    164 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 440871 KiB |   1050 MiB | 539869 GiB | 539868 GiB |
|       from large pool | 430496 KiB |   1046 MiB | 537780 GiB | 537779 GiB |
|       from small pool |  10375 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7492    |  152705 K  |  152700 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99184 K  |   99179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7492    |  152705 K  |  152700 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99184 K  |   99179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     115    |     211    |      99    |
|       from large pool |      58    |      60    |     129    |      71    |
|       from small pool |      54    |      55    |      82    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3258    |   72562 K  |   72562 K  |
|       from large pool |      19    |      33    |   24786 K  |   24786 K  |
|       from small pool |      49    |    3240    |   47776 K  |   47776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 732912 GiB | 732912 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 732912 GiB | 732912 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 722604 GiB | 722604 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |      0 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    890 MiB |   3482 MiB |   7886 MiB |   6996 MiB |
|       from large pool |    808 MiB |   3374 MiB |   7722 MiB |   6914 MiB |
|       from small pool |     82 MiB |    110 MiB |    164 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 539869 GiB | 539869 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 537780 GiB | 537780 GiB |
|       from small pool |      0 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7492    |  152705 K  |  152705 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99184 K  |   99184 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7492    |  152705 K  |  152705 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99184 K  |   99184 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     115    |     211    |     150    |
|       from large pool |      20    |      60    |     129    |     109    |
|       from small pool |      41    |      55    |      82    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3258    |   72564 K  |   72564 K  |
|       from large pool |       4    |      33    |   24786 K  |   24786 K  |
|       from small pool |       0    |    3240    |   47778 K  |   47778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug 10 23:58:08 2024]
Finished job 0.
1 of 1 steps (100%) done
