Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 11:59:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963

 Experiment start at: 2024-08-10 12:07:45.500773
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96578884, 'precision': 0.9659585, 'recall': 0.96578217, 'specificity': 0.96578217, 'f1': 0.9657854, 'auroc': 0.99474007, 'binary_precision': 0.9572441, 'binary_recall': 0.9751835, 'binary_specificity': 0.9563809, 'binary_f1_score': 0.9661305}
confusion matrix:
       0      1
0  24206   1104
1    629  24717
---- Validation: 
scalar performance:
{'acc': 0.9593491, 'precision': 0.6558378, 'recall': 0.7900059, 'specificity': 0.7900059, 'f1': 0.7002556, 'auroc': 0.86909485, 'binary_precision': 0.321519, 'binary_recall': 0.6120482, 'binary_specificity': 0.96796364, 'binary_f1_score': 0.4215768}
confusion matrix:
       0    1
0  16195  536
1    161  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91566145, 'precision': 0.6697346, 'recall': 0.5942931, 'specificity': 0.5942931, 'f1': 0.6176877, 'auroc': 0.8439421, 'binary_precision': 0.40193704, 'binary_recall': 0.2150259, 'binary_specificity': 0.9735603, 'binary_f1_score': 0.2801688}
confusion matrix:
      0    1
0  9095  247
1   606  166
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 12:24:18.006457,epoch time: 0:16:32.505684,used: 0:16:32.505684,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9785613, 'precision': 0.9785705, 'recall': 0.97856, 'specificity': 0.97856, 'f1': 0.97856116, 'auroc': 0.9972168, 'binary_precision': 0.976619, 'binary_recall': 0.9806266, 'binary_specificity': 0.97649336, 'binary_f1_score': 0.97861874}
confusion matrix:
       0      1
0  24717    595
1    491  24853
---- Validation: 
scalar performance:
{'acc': 0.95719117, 'precision': 0.6592373, 'recall': 0.84059733, 'specificity': 0.84059733, 'f1': 0.71292615, 'auroc': 0.9054624, 'binary_precision': 0.32568306, 'binary_recall': 0.7180723, 'binary_specificity': 0.96312237, 'binary_f1_score': 0.44812033}
confusion matrix:
       0    1
0  16114  617
1    117  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9161558, 'precision': 0.6797632, 'recall': 0.61297923, 'specificity': 0.61297923, 'f1': 0.6362829, 'auroc': 0.88602006, 'binary_precision': 0.41914892, 'binary_recall': 0.25518134, 'binary_specificity': 0.97077715, 'binary_f1_score': 0.31723028}
confusion matrix:
      0    1
0  9069  273
1   575  197
new oracle model saved
early stop counter: 1
val acc:0.9571911692619324, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9161558151245117
after epoch: 2,now: 2024-08-10 12:39:49.292756,epoch time: 0:15:31.286299,used: 0:32:03.791983,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9787192, 'precision': 0.9790535, 'recall': 0.9787115, 'specificity': 0.9787115, 'f1': 0.9787152, 'auroc': 0.99847424, 'binary_precision': 0.96654487, 'binary_recall': 0.9917926, 'binary_specificity': 0.9656303, 'binary_f1_score': 0.979006}
confusion matrix:
       0      1
0  24443    870
1    208  25135
---- Validation: 
scalar performance:
{'acc': 0.9345037, 'precision': 0.61988324, 'recall': 0.8771445, 'specificity': 0.8771445, 'f1': 0.6709471, 'auroc': 0.9282572, 'binary_precision': 0.24458875, 'binary_recall': 0.8168675, 'binary_specificity': 0.93742156, 'binary_f1_score': 0.3764575}
confusion matrix:
       0     1
0  15684  1047
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9159581, 'precision': 0.67362154, 'recall': 0.599801, 'specificity': 0.599801, 'f1': 0.62349784, 'auroc': 0.9041854, 'binary_precision': 0.4088785, 'binary_recall': 0.22668394, 'binary_specificity': 0.97291803, 'binary_f1_score': 0.2916667}
confusion matrix:
      0    1
0  9089  253
1   597  175
early stop counter: 2
val acc:0.9345036745071411, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9161558151245117
after epoch: 3,now: 2024-08-10 12:55:11.493229,epoch time: 0:15:22.200473,used: 0:47:25.992456,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9845625, 'precision': 0.9845927, 'recall': 0.98456013, 'specificity': 0.98456013, 'f1': 0.9845622, 'auroc': 0.9986632, 'binary_precision': 0.9809289, 'binary_recall': 0.98836017, 'binary_specificity': 0.9807601, 'binary_f1_score': 0.98463047}
confusion matrix:
       0      1
0  24825    487
1    295  25049
---- Validation: 
scalar performance:
{'acc': 0.936195, 'precision': 0.6185289, 'recall': 0.85686237, 'specificity': 0.85686237, 'f1': 0.66810596, 'auroc': 0.9151302, 'binary_precision': 0.24299774, 'binary_recall': 0.773494, 'binary_specificity': 0.9402307, 'binary_f1_score': 0.36981565}
confusion matrix:
       0     1
0  15731  1000
1     94   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92011076, 'precision': 0.63440263, 'recall': 0.52124494, 'specificity': 0.52124494, 'f1': 0.5231309, 'auroc': 0.8901928, 'binary_precision': 0.34210527, 'binary_recall': 0.050518136, 'binary_specificity': 0.99197173, 'binary_f1_score': 0.08803613}
confusion matrix:
      0   1
0  9267  75
1   733  39
new oracle model saved
early stop counter: 3
val acc:0.9361950159072876, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9201107621192932
after epoch: 4,now: 2024-08-10 13:10:41.313100,epoch time: 0:15:29.819871,used: 1:02:55.812327,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97406036, 'precision': 0.97481555, 'recall': 0.97405016, 'specificity': 0.97405016, 'f1': 0.97404957, 'auroc': 0.99861, 'binary_precision': 0.9560068, 'binary_recall': 0.99388343, 'binary_specificity': 0.95421684, 'binary_f1_score': 0.9745773}
confusion matrix:
       0      1
0  24156   1159
1    155  25186
---- Validation: 
scalar performance:
{'acc': 0.90219295, 'precision': 0.5856703, 'recall': 0.86528814, 'specificity': 0.86528814, 'f1': 0.6188931, 'auroc': 0.9223304, 'binary_precision': 0.17607802, 'binary_recall': 0.826506, 'binary_specificity': 0.9040703, 'binary_f1_score': 0.29030892}
confusion matrix:
       0     1
0  15126  1605
1     72   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92040735, 'precision': 0.6841244, 'recall': 0.56418407, 'specificity': 0.56418407, 'f1': 0.58711934, 'auroc': 0.8965417, 'binary_precision': 0.43529412, 'binary_recall': 0.14378238, 'binary_specificity': 0.98458576, 'binary_f1_score': 0.21616358}
confusion matrix:
      0    1
0  9198  144
1   661  111
new oracle model saved
early stop counter: 4
val acc:0.9021929502487183, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9204073548316956
after epoch: 5,now: 2024-08-10 13:26:08.203850,epoch time: 0:15:26.890750,used: 1:18:22.703077,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97084254, 'precision': 0.9718886, 'recall': 0.97082776, 'specificity': 0.97082776, 'f1': 0.9708257, 'auroc': 0.99860907, 'binary_precision': 0.9498285, 'binary_recall': 0.9942393, 'binary_specificity': 0.94741625, 'binary_f1_score': 0.9715266}
confusion matrix:
       0      1
0  23981   1331
1    146  25198
---- Validation: 
scalar performance:
{'acc': 0.9319958, 'precision': 0.6085656, 'recall': 0.8359117, 'specificity': 0.8359117, 'f1': 0.6538046, 'auroc': 0.9145482, 'binary_precision': 0.22409992, 'binary_recall': 0.73493975, 'binary_specificity': 0.9368836, 'binary_f1_score': 0.34346846}
confusion matrix:
       0     1
0  15675  1056
1    110   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92268145, 'precision': 0.68814796, 'recall': 0.5256072, 'specificity': 0.5256072, 'f1': 0.5303764, 'auroc': 0.8871063, 'binary_precision': 0.4489796, 'binary_recall': 0.05699482, 'binary_specificity': 0.99421966, 'binary_f1_score': 0.101149425}
confusion matrix:
      0   1
0  9288  54
1   728  44
new oracle model saved
early stop counter: 5
val acc:0.9319958090782166, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.922681450843811
after epoch: 6,now: 2024-08-10 13:41:26.215934,epoch time: 0:15:18.012084,used: 1:33:40.715161,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.962729, 'precision': 0.96483517, 'recall': 0.9627091, 'specificity': 0.9627091, 'f1': 0.9626856, 'auroc': 0.99881643, 'binary_precision': 0.9336933, 'binary_recall': 0.9962514, 'binary_specificity': 0.92916685, 'binary_f1_score': 0.96395844}
confusion matrix:
       0      1
0  23520   1793
1     95  25248
---- Validation: 
scalar performance:
{'acc': 0.88860375, 'precision': 0.57717574, 'recall': 0.8641997, 'specificity': 0.8641997, 'f1': 0.6033985, 'auroc': 0.9255413, 'binary_precision': 0.15883158, 'binary_recall': 0.8385542, 'binary_specificity': 0.8898452, 'binary_f1_score': 0.26707596}
confusion matrix:
       0     1
0  14888  1843
1     67   348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233735, 'precision': 0.6438097, 'recall': 0.50221604, 'specificity': 0.50221604, 'f1': 0.48518056, 'auroc': 0.8598273, 'binary_precision': 0.36363637, 'binary_recall': 0.005181347, 'binary_specificity': 0.9992507, 'binary_f1_score': 0.010217113}
confusion matrix:
      0  1
0  9335  7
1   768  4
new oracle model saved
early stop counter: 6
val acc:0.8886037468910217, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9233735203742981
after epoch: 7,now: 2024-08-10 13:56:45.697947,epoch time: 0:15:19.482013,used: 1:49:00.197174,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.973705, 'precision': 0.97454894, 'recall': 0.9736942, 'specificity': 0.9736942, 'f1': 0.97369283, 'auroc': 0.9989406, 'binary_precision': 0.95466423, 'binary_recall': 0.99467266, 'binary_specificity': 0.95271575, 'binary_f1_score': 0.9742579}
confusion matrix:
       0      1
0  24118   1197
1    135  25206
---- Validation: 
scalar performance:
{'acc': 0.92639685, 'precision': 0.6080714, 'recall': 0.8694657, 'specificity': 0.8694657, 'f1': 0.6542326, 'auroc': 0.9236242, 'binary_precision': 0.22119816, 'binary_recall': 0.80963856, 'binary_specificity': 0.9292929, 'binary_f1_score': 0.3474664}
confusion matrix:
       0     1
0  15548  1183
1     79   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9242634, 'precision': 0.7749876, 'recall': 0.50923336, 'specificity': 0.50923336, 'f1': 0.49913448, 'auroc': 0.88443416, 'binary_precision': 0.625, 'binary_recall': 0.019430052, 'binary_specificity': 0.9990366, 'binary_f1_score': 0.037688445}
confusion matrix:
      0   1
0  9333   9
1   757  15
new oracle model saved
early stop counter: 7
val acc:0.9263968467712402, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9242634177207947
after epoch: 8,now: 2024-08-10 14:12:12.605016,epoch time: 0:15:26.907069,used: 2:04:27.104243,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.931479, 'precision': 0.939366, 'recall': 0.9314394, 'specificity': 0.9314394, 'f1': 0.93116575, 'auroc': 0.998647, 'binary_precision': 0.8806474, 'binary_recall': 0.99834275, 'binary_specificity': 0.864536, 'binary_f1_score': 0.93580896}
confusion matrix:
       0      1
0  21884   3429
1     42  25301
---- Validation: 
scalar performance:
{'acc': 0.7148606, 'precision': 0.5340908, 'recall': 0.80572164, 'specificity': 0.80572164, 'f1': 0.48103935, 'auroc': 0.9061325, 'binary_precision': 0.07162007, 'binary_recall': 0.9012048, 'binary_specificity': 0.71023846, 'binary_f1_score': 0.13269469}
confusion matrix:
       0     1
0  11883  4848
1     41   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212972, 'precision': 0.6918739, 'recall': 0.56407166, 'specificity': 0.56407166, 'f1': 0.5875515, 'auroc': 0.8786188, 'binary_precision': 0.45081967, 'binary_recall': 0.14248705, 'binary_specificity': 0.9856562, 'binary_f1_score': 0.21653543}
confusion matrix:
      0    1
0  9208  134
1   662  110
early stop counter: 8
val acc:0.7148606181144714, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9242634177207947
after epoch: 9,now: 2024-08-10 14:27:46.583215,epoch time: 0:15:33.978199,used: 2:20:01.082442,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9664403, 'precision': 0.9681342, 'recall': 0.9664261, 'specificity': 0.9664261, 'f1': 0.96640915, 'auroc': 0.99876666, 'binary_precision': 0.9400923, 'binary_recall': 0.9964088, 'binary_specificity': 0.9364433, 'binary_f1_score': 0.96743166}
confusion matrix:
       0      1
0  23707   1609
1     91  25249
---- Validation: 
scalar performance:
{'acc': 0.9075586, 'precision': 0.58122474, 'recall': 0.8186903, 'specificity': 0.8186903, 'f1': 0.61294687, 'auroc': 0.89744043, 'binary_precision': 0.16986457, 'binary_recall': 0.7253012, 'binary_specificity': 0.9120794, 'binary_f1_score': 0.27526292}
confusion matrix:
       0     1
0  15260  1471
1    114   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92456, 'precision': 0.802583, 'recall': 0.5105822, 'specificity': 0.5105822, 'f1': 0.5016964, 'auroc': 0.83361495, 'binary_precision': 0.68, 'binary_recall': 0.022020726, 'binary_specificity': 0.99914366, 'binary_f1_score': 0.042659976}
confusion matrix:
      0   1
0  9334   8
1   755  17
new oracle model saved
early stop counter: 9
val acc:0.9075586199760437, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.924560010433197
after epoch: 10,now: 2024-08-10 14:43:15.920934,epoch time: 0:15:29.337719,used: 2:35:30.420161,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96245265, 'precision': 0.964744, 'recall': 0.9624333, 'specificity': 0.9624333, 'f1': 0.96240515, 'auroc': 0.999125, 'binary_precision': 0.932249, 'binary_recall': 0.9974351, 'binary_specificity': 0.92743146, 'binary_f1_score': 0.963741}
confusion matrix:
       0      1
0  23477   1837
1     65  25277
---- Validation: 
scalar performance:
{'acc': 0.7787239, 'precision': 0.54235893, 'recall': 0.82669604, 'specificity': 0.82669604, 'f1': 0.51677346, 'auroc': 0.91083044, 'binary_precision': 0.08862917, 'binary_recall': 0.87710845, 'binary_specificity': 0.77628356, 'binary_f1_score': 0.16099072}
confusion matrix:
       0     1
0  12988  3743
1     51   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9250544, 'precision': 0.82947904, 'recall': 0.5138205, 'specificity': 0.5138205, 'f1': 0.50792146, 'auroc': 0.8780372, 'binary_precision': 0.73333335, 'binary_recall': 0.02849741, 'binary_specificity': 0.99914366, 'binary_f1_score': 0.054862842}
confusion matrix:
      0   1
0  9334   8
1   750  22
new oracle model saved
early stop counter: 10
val acc:0.7787238955497742, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9250543713569641
after epoch: 11,now: 2024-08-10 14:58:50.942943,epoch time: 0:15:35.022009,used: 2:51:05.442170,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9575174, 'precision': 0.9605059, 'recall': 0.95749515, 'specificity': 0.95749515, 'f1': 0.9574469, 'auroc': 0.9988693, 'binary_precision': 0.9235462, 'binary_recall': 0.99767184, 'binary_specificity': 0.91731846, 'binary_f1_score': 0.95917904}
confusion matrix:
       0      1
0  23221   2093
1     59  25283
---- Validation: 
scalar performance:
{'acc': 0.8033361, 'precision': 0.54247653, 'recall': 0.79935956, 'specificity': 0.79935956, 'f1': 0.5261281, 'auroc': 0.87052894, 'binary_precision': 0.09123583, 'binary_recall': 0.79518074, 'binary_specificity': 0.8035383, 'binary_f1_score': 0.16369049}
confusion matrix:
       0     1
0  13444  3287
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9247578, 'precision': 0.9239184, 'recall': 0.5077185, 'specificity': 0.5077185, 'f1': 0.4957166, 'auroc': 0.8470179, 'binary_precision': 0.9230769, 'binary_recall': 0.015544041, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.030573247}
confusion matrix:
      0   1
0  9341   1
1   760  12
early stop counter: 11
val acc:0.8033360838890076, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9250543713569641
after epoch: 12,now: 2024-08-10 15:14:33.303904,epoch time: 0:15:42.360961,used: 3:06:47.803131,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9286955, 'precision': 0.9371995, 'recall': 0.9286543, 'specificity': 0.9286543, 'f1': 0.92834246, 'auroc': 0.99872303, 'binary_precision': 0.8763726, 'binary_recall': 0.9983033, 'binary_specificity': 0.8590053, 'binary_f1_score': 0.9333727}
confusion matrix:
       0      1
0  21744   3569
1     43  25300
---- Validation: 
scalar performance:
{'acc': 0.6896069, 'precision': 0.5323618, 'recall': 0.803356, 'specificity': 0.803356, 'f1': 0.46856233, 'auroc': 0.89239776, 'binary_precision': 0.06751278, 'binary_recall': 0.92289156, 'binary_specificity': 0.6838204, 'binary_f1_score': 0.12582128}
confusion matrix:
       0     1
0  11441  5290
1     32   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.925351, 'precision': 0.80764836, 'recall': 0.5193284, 'specificity': 0.5193284, 'f1': 0.518496, 'auroc': 0.88725233, 'binary_precision': 0.6888889, 'binary_recall': 0.04015544, 'binary_specificity': 0.9985014, 'binary_f1_score': 0.0758874}
confusion matrix:
      0   1
0  9328  14
1   741  31
new oracle model saved
early stop counter: 12
val acc:0.6896069049835205, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9253510236740112
after epoch: 13,now: 2024-08-10 15:30:05.811060,epoch time: 0:15:32.507156,used: 3:22:20.310287,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9708031, 'precision': 0.97215617, 'recall': 0.9707831, 'specificity': 0.9707831, 'f1': 0.9707812, 'auroc': 0.9992782, 'binary_precision': 0.9470668, 'binary_recall': 0.9973962, 'binary_specificity': 0.94417006, 'binary_f1_score': 0.9715801}
confusion matrix:
       0      1
0  23896   1413
1     66  25281
---- Validation: 
scalar performance:
{'acc': 0.9044675, 'precision': 0.5852506, 'recall': 0.8535294, 'specificity': 0.8535294, 'f1': 0.6186207, 'auroc': 0.91808486, 'binary_precision': 0.17594065, 'binary_recall': 0.8, 'binary_specificity': 0.9070588, 'binary_f1_score': 0.28844485}
confusion matrix:
       0     1
0  15176  1555
1     83   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92396677, 'precision': 0.9619721, 'recall': 0.501943, 'specificity': 0.501943, 'f1': 0.48410538, 'auroc': 0.8771355, 'binary_precision': 1.0, 'binary_recall': 0.0038860103, 'binary_specificity': 1.0, 'binary_f1_score': 0.0077419356}
confusion matrix:
      0  1
0  9342  0
1   769  3
early stop counter: 13
val acc:0.9044675230979919, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9253510236740112
after epoch: 14,now: 2024-08-10 15:45:43.736415,epoch time: 0:15:37.925355,used: 3:37:58.235642,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95870185, 'precision': 0.9615856, 'recall': 0.9586816, 'specificity': 0.9586816, 'f1': 0.9586359, 'auroc': 0.99911857, 'binary_precision': 0.92522955, 'binary_recall': 0.9981058, 'binary_specificity': 0.91925734, 'binary_f1_score': 0.96028703}
confusion matrix:
       0      1
0  23271   2044
1     48  25293
---- Validation: 
scalar performance:
{'acc': 0.8220576, 'precision': 0.5483994, 'recall': 0.8195269, 'specificity': 0.8195269, 'f1': 0.5409958, 'auroc': 0.8880739, 'binary_precision': 0.1022933, 'binary_recall': 0.8168675, 'binary_specificity': 0.82218635, 'binary_f1_score': 0.18181817}
confusion matrix:
       0     1
0  13756  2975
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.925351, 'precision': 0.9626126, 'recall': 0.51101035, 'specificity': 0.51101035, 'f1': 0.5021266, 'auroc': 0.8381411, 'binary_precision': 1.0, 'binary_recall': 0.022020726, 'binary_specificity': 1.0, 'binary_f1_score': 0.043092523}
confusion matrix:
      0   1
0  9342   0
1   755  17
early stop counter: 14
val acc:0.8220576047897339, best validation acc: 0.9593490958213806, corresponding to test acc:                         0.9156614542007446 / 0.9253510236740112
after epoch: 15,now: 2024-08-10 16:01:21.435705,epoch time: 0:15:37.699290,used: 3:53:35.934932,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_45_seed_0_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:53:35.934932 at 2024-08-10 16:01:21.435705
persisted model performance metric: 

scalar performance:
{'acc': 0.91566145, 'precision': 0.6697346, 'recall': 0.5942931, 'specificity': 0.5942931, 'f1': 0.6176877, 'auroc': 0.8439421, 'binary_precision': 0.40193704, 'binary_recall': 0.2150259, 'binary_specificity': 0.9735603, 'binary_f1_score': 0.2801688}
confusion matrix:
      0    1
0  9095  247
1   606  166
oracle model performance metric: 

scalar performance:
{'acc': 0.925351, 'precision': 0.80764836, 'recall': 0.5193284, 'specificity': 0.5193284, 'f1': 0.518496, 'auroc': 0.88725233, 'binary_precision': 0.6888889, 'binary_recall': 0.04015544, 'binary_specificity': 0.9985014, 'binary_f1_score': 0.0758874}
confusion matrix:
      0   1
0  9328  14
1   741  31
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459821 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |  71981 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3464 MiB |   3464 MiB |   3464 MiB |      0 B   |
|       from large pool |   3354 MiB |   3354 MiB |   3354 MiB |      0 B   |
|       from small pool |    110 MiB |    110 MiB |    110 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    793 MiB |   1030 MiB | 173229 GiB | 173228 GiB |
|       from large pool |    782 MiB |   1027 MiB | 172554 GiB | 172553 GiB |
|       from small pool |     10 MiB |     11 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4959    |    7362    |   50037 K  |   50032 K  |
|       from large pool |      87    |     529    |   17451 K  |   17451 K  |
|       from small pool |    4872    |    7273    |   32586 K  |   32581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4959    |    7362    |   50037 K  |   50032 K  |
|       from large pool |      87    |     529    |   17451 K  |   17451 K  |
|       from small pool |    4872    |    7273    |   32586 K  |   32581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     115    |     115    |       0    |
|       from large pool |      60    |      60    |      60    |       0    |
|       from small pool |      55    |      55    |      55    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3198    |   23909 K  |   23908 K  |
|       from large pool |      24    |      33    |    8227 K  |    8227 K  |
|       from small pool |      47    |    3175    |   15681 K  |   15681 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1256 MiB |   3464 MiB |   3464 MiB |   2208 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     82 MiB |    110 MiB |    110 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173230 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     18 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32586 K  |   32586 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32586 K  |   32586 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     115    |     115    |      52    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      41    |      55    |      55    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23911 K  |   23911 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15683 K  |   15683 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1256 MiB |   3464 MiB |   3464 MiB |   2208 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     82 MiB |    110 MiB |    110 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173230 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     18 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32586 K  |   32586 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32586 K  |   32586 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     115    |     115    |      52    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      41    |      55    |      55    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23911 K  |   23911 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15683 K  |   15683 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963

 Experiment start at: 2024-08-10 16:11:11.384291
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96675324, 'precision': 0.9667696, 'recall': 0.9667511, 'specificity': 0.9667511, 'f1': 0.96675277, 'auroc': 0.9939741, 'binary_precision': 0.96418655, 'binary_recall': 0.9695695, 'binary_specificity': 0.96393275, 'binary_f1_score': 0.9668705}
confusion matrix:
       0      1
0  24481    916
1    774  24661
---- Validation: 
scalar performance:
{'acc': 0.9453367, 'precision': 0.6198767, 'recall': 0.77192813, 'specificity': 0.77192813, 'f1': 0.6616329, 'auroc': 0.84746003, 'binary_precision': 0.25074038, 'binary_recall': 0.58932716, 'binary_specificity': 0.9545291, 'binary_f1_score': 0.35180056}
confusion matrix:
       0    1
0  15933  759
1    177  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92012686, 'precision': 0.7153256, 'recall': 0.73347265, 'specificity': 0.73347265, 'f1': 0.7239118, 'auroc': 0.8859296, 'binary_precision': 0.47037485, 'binary_recall': 0.51387054, 'binary_specificity': 0.95307475, 'binary_f1_score': 0.4911616}
confusion matrix:
      0    1
0  8896  438
1   368  389
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 16:27:58.356883,epoch time: 0:16:46.972592,used: 0:16:46.972592,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97883224, 'precision': 0.97883224, 'recall': 0.97883224, 'specificity': 0.97883224, 'f1': 0.97883224, 'auroc': 0.99688315, 'binary_precision': 0.9788857, 'binary_recall': 0.9788087, 'binary_specificity': 0.9788558, 'binary_f1_score': 0.9788472}
confusion matrix:
       0      1
0  24860    537
1    539  24896
---- Validation: 
scalar performance:
{'acc': 0.9261228, 'precision': 0.6054475, 'recall': 0.8389225, 'specificity': 0.8389225, 'f1': 0.6491151, 'auroc': 0.8809273, 'binary_precision': 0.21786198, 'binary_recall': 0.74709976, 'binary_specificity': 0.93074524, 'binary_f1_score': 0.3373494}
confusion matrix:
       0     1
0  15536  1156
1    109   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230998, 'precision': 0.7151719, 'recall': 0.65678513, 'specificity': 0.65678513, 'f1': 0.680073, 'auroc': 0.9055186, 'binary_precision': 0.48237476, 'binary_recall': 0.34346104, 'binary_specificity': 0.9701093, 'binary_f1_score': 0.40123457}
confusion matrix:
      0    1
0  9055  279
1   497  260
new oracle model saved
early stop counter: 1
val acc:0.926122784614563, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9230998158454895
after epoch: 2,now: 2024-08-10 16:43:31.492779,epoch time: 0:15:33.135896,used: 0:32:20.108488,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.978006, 'precision': 0.97817266, 'recall': 0.97799945, 'specificity': 0.97799945, 'f1': 0.97800386, 'auroc': 0.9980335, 'binary_precision': 0.96942085, 'binary_recall': 0.9871825, 'binary_specificity': 0.96881646, 'binary_f1_score': 0.9782211}
confusion matrix:
       0      1
0  24606    792
1    326  25108
---- Validation: 
scalar performance:
{'acc': 0.9367517, 'precision': 0.6201065, 'recall': 0.8409838, 'specificity': 0.8409838, 'f1': 0.6687086, 'auroc': 0.89672166, 'binary_precision': 0.24728683, 'binary_recall': 0.7401392, 'binary_specificity': 0.9418284, 'binary_f1_score': 0.3707147}
confusion matrix:
       0    1
0  15721  971
1    112  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9189377, 'precision': 0.66680235, 'recall': 0.5695645, 'specificity': 0.5695645, 'f1': 0.5920348, 'auroc': 0.90566134, 'binary_precision': 0.3986711, 'binary_recall': 0.15852048, 'binary_specificity': 0.9806085, 'binary_f1_score': 0.2268431}
confusion matrix:
      0    1
0  9153  181
1   637  120
early stop counter: 2
val acc:0.9367517232894897, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9230998158454895
after epoch: 3,now: 2024-08-10 16:58:59.582339,epoch time: 0:15:28.089560,used: 0:47:48.198048,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9591202, 'precision': 0.96123916, 'recall': 0.959095, 'specificity': 0.959095, 'f1': 0.95907164, 'auroc': 0.99727464, 'binary_precision': 0.93016315, 'binary_recall': 0.9928445, 'binary_specificity': 0.92534554, 'binary_f1_score': 0.96048224}
confusion matrix:
       0      1
0  23501   1896
1    182  25253
---- Validation: 
scalar performance:
{'acc': 0.8265491, 'precision': 0.55359995, 'recall': 0.8375762, 'specificity': 0.8375762, 'f1': 0.5502471, 'auroc': 0.8987747, 'binary_precision': 0.11189239, 'binary_recall': 0.8491879, 'binary_specificity': 0.8259645, 'binary_f1_score': 0.19773096}
confusion matrix:
       0     1
0  13787  2905
1     65   366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9186404, 'precision': 0.65886545, 'recall': 0.5609067, 'specificity': 0.5609067, 'f1': 0.5811766, 'auroc': 0.90835214, 'binary_precision': 0.38405797, 'binary_recall': 0.14002642, 'binary_specificity': 0.981787, 'binary_f1_score': 0.20522748}
confusion matrix:
      0    1
0  9164  170
1   651  106
early stop counter: 3
val acc:0.8265491127967834, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9230998158454895
after epoch: 4,now: 2024-08-10 17:14:19.506902,epoch time: 0:15:19.924563,used: 1:03:08.122611,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95697594, 'precision': 0.9595431, 'recall': 0.9569481, 'specificity': 0.9569481, 'f1': 0.9569138, 'auroc': 0.99798167, 'binary_precision': 0.92538244, 'binary_recall': 0.9941813, 'binary_specificity': 0.9197149, 'binary_f1_score': 0.9585489}
confusion matrix:
       0      1
0  23358   2039
1    148  25287
---- Validation: 
scalar performance:
{'acc': 0.81848973, 'precision': 0.5520665, 'recall': 0.8390932, 'specificity': 0.8390932, 'f1': 0.5452385, 'auroc': 0.909621, 'binary_precision': 0.10851126, 'binary_recall': 0.8607889, 'binary_specificity': 0.81739753, 'binary_f1_score': 0.19272727}
confusion matrix:
       0     1
0  13644  3048
1     60   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9224061, 'precision': 0.63016415, 'recall': 0.51438755, 'specificity': 0.51438755, 'f1': 0.51090205, 'auroc': 0.90362227, 'binary_precision': 0.33333334, 'binary_recall': 0.034346104, 'binary_specificity': 0.994429, 'binary_f1_score': 0.06227545}
confusion matrix:
      0   1
0  9282  52
1   731  26
early stop counter: 4
val acc:0.8184897303581238, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9230998158454895
after epoch: 5,now: 2024-08-10 17:29:46.546039,epoch time: 0:15:27.039137,used: 1:18:35.161748,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94725764, 'precision': 0.9516505, 'recall': 0.94722474, 'specificity': 0.94722474, 'f1': 0.94712627, 'auroc': 0.99731266, 'binary_precision': 0.9072748, 'binary_recall': 0.996422, 'binary_specificity': 0.8980275, 'binary_f1_score': 0.94976103}
confusion matrix:
       0      1
0  22809   2590
1     91  25342
---- Validation: 
scalar performance:
{'acc': 0.7681481, 'precision': 0.5420734, 'recall': 0.82231355, 'specificity': 0.82231355, 'f1': 0.51291364, 'auroc': 0.9041976, 'binary_precision': 0.08820107, 'binary_recall': 0.87935036, 'binary_specificity': 0.7652768, 'binary_f1_score': 0.16032149}
confusion matrix:
       0     1
0  12774  3918
1     52   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92141515, 'precision': 0.63647395, 'recall': 0.52234894, 'specificity': 0.52234894, 'f1': 0.5252845, 'auroc': 0.8936544, 'binary_precision': 0.3448276, 'binary_recall': 0.05284016, 'binary_specificity': 0.9918577, 'binary_f1_score': 0.09163803}
confusion matrix:
      0   1
0  9258  76
1   717  40
early stop counter: 5
val acc:0.7681481242179871, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9230998158454895
after epoch: 6,now: 2024-08-10 17:45:17.143386,epoch time: 0:15:30.597347,used: 1:34:05.759095,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95011014, 'precision': 0.9538182, 'recall': 0.95007294, 'specificity': 0.95007294, 'f1': 0.95000505, 'auroc': 0.996454, 'binary_precision': 0.9130027, 'binary_recall': 0.99512523, 'binary_specificity': 0.90502065, 'binary_f1_score': 0.95229673}
confusion matrix:
       0      1
0  22983   2412
1    124  25313
---- Validation: 
scalar performance:
{'acc': 0.8296443, 'precision': 0.5531238, 'recall': 0.8289926, 'specificity': 0.8289926, 'f1': 0.55068, 'auroc': 0.8808347, 'binary_precision': 0.1115625, 'binary_recall': 0.82830626, 'binary_specificity': 0.8296789, 'binary_f1_score': 0.19664003}
confusion matrix:
       0     1
0  13849  2843
1     74   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92418987, 'precision': 0.663138, 'recall': 0.5092824, 'specificity': 0.5092824, 'f1': 0.5003435, 'auroc': 0.8809322, 'binary_precision': 0.4, 'binary_recall': 0.021136064, 'binary_specificity': 0.9974288, 'binary_f1_score': 0.040150568}
confusion matrix:
      0   1
0  9310  24
1   741  16
new oracle model saved
early stop counter: 6
val acc:0.8296443223953247, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9241898655891418
after epoch: 7,now: 2024-08-10 18:01:05.775507,epoch time: 0:15:48.632121,used: 1:49:54.391216,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9646679, 'precision': 0.966342, 'recall': 0.9646456, 'specificity': 0.9646456, 'f1': 0.964635, 'auroc': 0.9979428, 'binary_precision': 0.9385877, 'binary_recall': 0.99445647, 'binary_specificity': 0.93483484, 'binary_f1_score': 0.96571475}
confusion matrix:
       0      1
0  23742   1655
1    141  25294
---- Validation: 
scalar performance:
{'acc': 0.8161537, 'precision': 0.55023026, 'recall': 0.82885396, 'specificity': 0.82885396, 'f1': 0.5418775, 'auroc': 0.89730835, 'binary_precision': 0.10543131, 'binary_recall': 0.8422274, 'binary_specificity': 0.8154805, 'binary_f1_score': 0.1874032}
confusion matrix:
       0     1
0  13612  3080
1     68   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92587453, 'precision': 0.8454262, 'recall': 0.50837225, 'specificity': 0.50837225, 'f1': 0.49752545, 'auroc': 0.8649522, 'binary_precision': 0.7647059, 'binary_recall': 0.017173052, 'binary_specificity': 0.99957144, 'binary_f1_score': 0.033591732}
confusion matrix:
      0   1
0  9330   4
1   744  13
new oracle model saved
early stop counter: 7
val acc:0.8161537051200867, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 8,now: 2024-08-10 18:16:31.637792,epoch time: 0:15:25.862285,used: 2:05:20.253501,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93970335, 'precision': 0.9456328, 'recall': 0.93965805, 'specificity': 0.93965805, 'f1': 0.9394977, 'auroc': 0.99731624, 'binary_precision': 0.89442503, 'binary_recall': 0.99720865, 'binary_specificity': 0.88210744, 'binary_f1_score': 0.9430244}
confusion matrix:
       0      1
0  22402   2994
1     71  25365
---- Validation: 
scalar performance:
{'acc': 0.7915085, 'precision': 0.5458145, 'recall': 0.8275145, 'specificity': 0.8275145, 'f1': 0.52678347, 'auroc': 0.89096487, 'binary_precision': 0.0960103, 'binary_recall': 0.8654292, 'binary_specificity': 0.78959984, 'binary_f1_score': 0.17284524}
confusion matrix:
       0     1
0  13180  3512
1     58   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92458624, 'precision': 0.6572162, 'recall': 0.5040343, 'specificity': 0.5040343, 'f1': 0.48942593, 'auroc': 0.8824375, 'binary_precision': 0.3888889, 'binary_recall': 0.009247027, 'binary_specificity': 0.9988215, 'binary_f1_score': 0.018064516}
confusion matrix:
      0   1
0  9323  11
1   750   7
early stop counter: 8
val acc:0.7915084958076477, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 9,now: 2024-08-10 18:32:01.701778,epoch time: 0:15:30.063986,used: 2:20:50.317487,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9437559, 'precision': 0.94878674, 'recall': 0.9437185, 'specificity': 0.9437185, 'f1': 0.9435945, 'auroc': 0.9971873, 'binary_precision': 0.90144753, 'binary_recall': 0.99654007, 'binary_specificity': 0.8908969, 'binary_f1_score': 0.94661164}
confusion matrix:
       0      1
0  22627   2771
1     88  25346
---- Validation: 
scalar performance:
{'acc': 0.7864276, 'precision': 0.54348546, 'recall': 0.8147372, 'specificity': 0.8147372, 'f1': 0.52177656, 'auroc': 0.882984, 'binary_precision': 0.09205867, 'binary_recall': 0.84454757, 'binary_specificity': 0.7849269, 'binary_f1_score': 0.16602051}
confusion matrix:
       0     1
0  13102  3590
1     67   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.71278656, 'recall': 0.50424856, 'specificity': 0.50424856, 'f1': 0.48957986, 'auroc': 0.88673306, 'binary_precision': 0.5, 'binary_recall': 0.009247027, 'binary_specificity': 0.99925005, 'binary_f1_score': 0.018158237}
confusion matrix:
      0  1
0  9327  7
1   750  7
early stop counter: 9
val acc:0.7864276170730591, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 10,now: 2024-08-10 18:47:42.398800,epoch time: 0:15:40.697022,used: 2:36:31.014509,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91731584, 'precision': 0.92855376, 'recall': 0.9172491, 'specificity': 0.9172491, 'f1': 0.9167613, 'auroc': 0.99785876, 'binary_precision': 0.8593623, 'binary_recall': 0.998113, 'binary_specificity': 0.83638513, 'binary_f1_score': 0.9235554}
confusion matrix:
       0      1
0  21240   4155
1     48  25389
---- Validation: 
scalar performance:
{'acc': 0.61502075, 'precision': 0.52754354, 'recall': 0.77089626, 'specificity': 0.77089626, 'f1': 0.43170896, 'auroc': 0.90654314, 'binary_precision': 0.05784412, 'binary_recall': 0.9350348, 'binary_specificity': 0.6067577, 'binary_f1_score': 0.108948365}
confusion matrix:
       0     1
0  10128  6564
1     28   403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9235953, 'precision': 0.6742381, 'recall': 0.52170664, 'specificity': 0.52170664, 'f1': 0.5238511, 'auroc': 0.89694065, 'binary_precision': 0.42045453, 'binary_recall': 0.048877146, 'binary_specificity': 0.9945361, 'binary_f1_score': 0.08757397}
confusion matrix:
      0   1
0  9283  51
1   720  37
early stop counter: 10
val acc:0.615020751953125, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 11,now: 2024-08-10 19:03:18.038779,epoch time: 0:15:35.639979,used: 2:52:06.654488,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95164466, 'precision': 0.9554215, 'recall': 0.9516107, 'specificity': 0.9516107, 'f1': 0.9515416, 'auroc': 0.9981704, 'binary_precision': 0.9141343, 'binary_recall': 0.997012, 'binary_specificity': 0.9062094, 'binary_f1_score': 0.9537761}
confusion matrix:
       0      1
0  23015   2382
1     76  25359
---- Validation: 
scalar performance:
{'acc': 0.78391635, 'precision': 0.54576427, 'recall': 0.83605194, 'specificity': 0.83605194, 'f1': 0.5238181, 'auroc': 0.91178036, 'binary_precision': 0.09512014, 'binary_recall': 0.8909513, 'binary_specificity': 0.78115267, 'binary_f1_score': 0.17188899}
confusion matrix:
       0     1
0  13039  3653
1     47   384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92587453, 'precision': 0.76846015, 'recall': 0.51565546, 'specificity': 0.51565546, 'f1': 0.51203406, 'auroc': 0.9033881, 'binary_precision': 0.6097561, 'binary_recall': 0.0330251, 'binary_specificity': 0.99828583, 'binary_f1_score': 0.06265665}
confusion matrix:
      0   1
0  9318  16
1   732  25
early stop counter: 11
val acc:0.7839163541793823, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 12,now: 2024-08-10 19:18:54.677872,epoch time: 0:15:36.639093,used: 3:07:43.293581,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.90753853, 'precision': 0.9214256, 'recall': 0.90747076, 'specificity': 0.90747076, 'f1': 0.90676033, 'auroc': 0.9981214, 'binary_precision': 0.84511167, 'binary_recall': 0.99815214, 'binary_specificity': 0.8167894, 'binary_f1_score': 0.9152787}
confusion matrix:
       0      1
0  20744   4653
1     47  25388
---- Validation: 
scalar performance:
{'acc': 0.5944052, 'precision': 0.5259877, 'recall': 0.7591922, 'specificity': 0.7591922, 'f1': 0.42082506, 'auroc': 0.88819045, 'binary_precision': 0.05493304, 'binary_recall': 0.93271464, 'binary_specificity': 0.58566976, 'binary_f1_score': 0.103755325}
confusion matrix:
      0     1
0  9776  6916
1    29   402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92587453, 'precision': 0.7579125, 'recall': 0.51869017, 'specificity': 0.51869017, 'f1': 0.5178245, 'auroc': 0.8854129, 'binary_precision': 0.5882353, 'binary_recall': 0.03963012, 'binary_specificity': 0.99775016, 'binary_f1_score': 0.074257426}
confusion matrix:
      0   1
0  9313  21
1   727  30
early stop counter: 12
val acc:0.5944051742553711, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 13,now: 2024-08-10 19:34:22.574665,epoch time: 0:15:27.896793,used: 3:23:11.190374,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9490085, 'precision': 0.9531418, 'recall': 0.9489691, 'specificity': 0.9489691, 'f1': 0.9488888, 'auroc': 0.9981663, 'binary_precision': 0.91007, 'binary_recall': 0.99657977, 'binary_specificity': 0.90135854, 'binary_f1_score': 0.95136225}
confusion matrix:
       0      1
0  22890   2505
1     87  25350
---- Validation: 
scalar performance:
{'acc': 0.80167025, 'precision': 0.5437074, 'recall': 0.79882246, 'specificity': 0.79882246, 'f1': 0.5277352, 'auroc': 0.86926043, 'binary_precision': 0.09394687, 'binary_recall': 0.7958237, 'binary_specificity': 0.80182123, 'binary_f1_score': 0.1680549}
confusion matrix:
       0     1
0  13384  3308
1     88   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.85169387, 'recall': 0.50451636, 'specificity': 0.50451636, 'f1': 0.4897729, 'auroc': 0.8750353, 'binary_precision': 0.7777778, 'binary_recall': 0.009247027, 'binary_specificity': 0.9997857, 'binary_f1_score': 0.018276762}
confusion matrix:
      0  1
0  9332  2
1   750  7
early stop counter: 13
val acc:0.801670253276825, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9258745312690735
after epoch: 14,now: 2024-08-10 19:50:20.219597,epoch time: 0:15:57.644932,used: 3:39:08.835306,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9476511, 'precision': 0.9520062, 'recall': 0.9476087, 'specificity': 0.9476087, 'f1': 0.9475212, 'auroc': 0.9981234, 'binary_precision': 0.9078537, 'binary_recall': 0.9965406, 'binary_specificity': 0.8986769, 'binary_f1_score': 0.9501321}
confusion matrix:
       0      1
0  22821   2573
1     88  25350
---- Validation: 
scalar performance:
{'acc': 0.786194, 'precision': 0.54567736, 'recall': 0.83269966, 'specificity': 0.83269966, 'f1': 0.52457875, 'auroc': 0.90402794, 'binary_precision': 0.0952381, 'binary_recall': 0.88167053, 'binary_specificity': 0.7837287, 'binary_f1_score': 0.17190681}
confusion matrix:
       0     1
0  13082  3610
1     51   380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92676646, 'precision': 0.88656425, 'recall': 0.51431674, 'specificity': 0.51431674, 'f1': 0.50904965, 'auroc': 0.89499795, 'binary_precision': 0.84615386, 'binary_recall': 0.029062087, 'binary_specificity': 0.99957144, 'binary_f1_score': 0.056194123}
confusion matrix:
      0   1
0  9330   4
1   735  22
new oracle model saved
early stop counter: 14
val acc:0.7861940264701843, best validation acc: 0.9453366994857788, corresponding to test acc:                         0.9201268553733826 / 0.9267664551734924
after epoch: 15,now: 2024-08-10 20:06:08.276798,epoch time: 0:15:48.057201,used: 3:54:56.892507,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:54:56.892507 at 2024-08-10 20:06:08.276798
persisted model performance metric: 

scalar performance:
{'acc': 0.92012686, 'precision': 0.7153256, 'recall': 0.73347265, 'specificity': 0.73347265, 'f1': 0.7239118, 'auroc': 0.8859296, 'binary_precision': 0.47037485, 'binary_recall': 0.51387054, 'binary_specificity': 0.95307475, 'binary_f1_score': 0.4911616}
confusion matrix:
      0    1
0  8896  438
1   368  389
oracle model performance metric: 

scalar performance:
{'acc': 0.92676646, 'precision': 0.88656425, 'recall': 0.51431674, 'specificity': 0.51431674, 'f1': 0.50904965, 'auroc': 0.89499795, 'binary_precision': 0.84615386, 'binary_recall': 0.029062087, 'binary_specificity': 0.99957144, 'binary_f1_score': 0.056194123}
confusion matrix:
      0   1
0  9330   4
1   735  22
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 472248 KiB |   3238 MiB | 482772 GiB | 482771 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481409 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 472248 KiB |   3238 MiB | 482772 GiB | 482771 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481409 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 474901 GiB | 474900 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 473559 GiB | 473559 GiB |
|       from small pool |  71980 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3462 MiB |   3464 MiB |   5670 MiB |   2208 MiB |
|       from large pool |   3354 MiB |   3354 MiB |   5534 MiB |   2180 MiB |
|       from small pool |    108 MiB |    110 MiB |    136 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    806 MiB |   1050 MiB | 354697 GiB | 354696 GiB |
|       from large pool |    796 MiB |   1046 MiB | 353334 GiB | 353333 GiB |
|       from small pool |     10 MiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7384    |  100575 K  |  100570 K  |
|       from large pool |      87    |     529    |   35137 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65438 K  |   65433 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7384    |  100575 K  |  100570 K  |
|       from large pool |      87    |     529    |   35137 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65438 K  |   65433 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     111    |     115    |     163    |      52    |
|       from large pool |      57    |      60    |      95    |      38    |
|       from small pool |      54    |      55    |      68    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3211    |   47844 K  |   47844 K  |
|       from large pool |      26    |      33    |   16342 K  |   16342 K  |
|       from small pool |      51    |    3186    |   31501 K  |   31501 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473559 GiB | 473559 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5670 MiB |   4402 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    136 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354697 GiB | 354697 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353334 GiB | 353334 GiB |
|       from small pool |      0 KiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100575 K  |  100575 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65438 K  |   65438 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100575 K  |  100575 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65438 K  |   65438 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     163    |      98    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      68    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47846 K  |   47846 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31503 K  |   31503 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473559 GiB | 473559 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5670 MiB |   4402 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    136 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354697 GiB | 354697 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353334 GiB | 353334 GiB |
|       from small pool |      0 KiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100575 K  |  100575 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65438 K  |   65438 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100575 K  |  100575 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65438 K  |   65438 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     163    |      98    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      68    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47846 K  |   47846 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31503 K  |   31503 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963

 Experiment start at: 2024-08-10 20:16:03.203983
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9720094, 'precision': 0.9720595, 'recall': 0.9720106, 'specificity': 0.9720106, 'f1': 0.9720087, 'auroc': 0.99429476, 'binary_precision': 0.9769787, 'binary_recall': 0.9668136, 'binary_specificity': 0.97720766, 'binary_f1_score': 0.9718696}
confusion matrix:
       0      1
0  25253    589
1    858  24996
---- Validation: 
scalar performance:
{'acc': 0.9537491, 'precision': 0.6428827, 'recall': 0.80252576, 'specificity': 0.80252576, 'f1': 0.6902258, 'auroc': 0.87095875, 'binary_precision': 0.29495615, 'binary_recall': 0.6435407, 'binary_specificity': 0.96151084, 'binary_f1_score': 0.4045113}
confusion matrix:
       0    1
0  16063  643
1    149  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.919243, 'precision': 0.7194281, 'recall': 0.6957629, 'specificity': 0.6957629, 'f1': 0.70670307, 'auroc': 0.8638747, 'binary_precision': 0.4872159, 'binary_recall': 0.43036386, 'binary_specificity': 0.9611619, 'binary_f1_score': 0.45702866}
confusion matrix:
      0    1
0  8934  361
1   454  343
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 20:32:41.464080,epoch time: 0:16:38.260097,used: 0:16:38.260097,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9789152, 'precision': 0.9789207, 'recall': 0.978915, 'specificity': 0.978915, 'f1': 0.9789151, 'auroc': 0.99709415, 'binary_precision': 0.97733057, 'binary_recall': 0.98058176, 'binary_specificity': 0.97724813, 'binary_f1_score': 0.9789534}
confusion matrix:
       0      1
0  25256    588
1    502  25350
---- Validation: 
scalar performance:
{'acc': 0.957545, 'precision': 0.6584811, 'recall': 0.82546353, 'specificity': 0.82546353, 'f1': 0.70956665, 'auroc': 0.8963281, 'binary_precision': 0.3250283, 'binary_recall': 0.6866029, 'binary_specificity': 0.9643242, 'binary_f1_score': 0.44119903}
confusion matrix:
       0    1
0  16110  596
1    131  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9172612, 'precision': 0.6804503, 'recall': 0.5650624, 'specificity': 0.5650624, 'f1': 0.58760655, 'auroc': 0.86862206, 'binary_precision': 0.43014705, 'binary_recall': 0.1468005, 'binary_specificity': 0.98332435, 'binary_f1_score': 0.21889615}
confusion matrix:
      0    1
0  9140  155
1   680  117
better model found
persisted
after epoch: 2,now: 2024-08-10 20:48:27.223926,epoch time: 0:15:45.759846,used: 0:32:24.019943,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9691659, 'precision': 0.97001076, 'recall': 0.9691626, 'specificity': 0.9691626, 'f1': 0.96915185, 'auroc': 0.99786186, 'binary_precision': 0.9501225, 'binary_recall': 0.99032956, 'binary_specificity': 0.94799566, 'binary_f1_score': 0.9698094}
confusion matrix:
       0      1
0  24500   1344
1    250  25602
---- Validation: 
scalar performance:
{'acc': 0.88536555, 'precision': 0.57378685, 'recall': 0.8502817, 'specificity': 0.8502817, 'f1': 0.5975865, 'auroc': 0.908772, 'binary_precision': 0.152809, 'binary_recall': 0.8133971, 'binary_specificity': 0.88716626, 'binary_f1_score': 0.2572834}
confusion matrix:
       0     1
0  14821  1885
1     78   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91508126, 'precision': 0.6815158, 'recall': 0.5977191, 'specificity': 0.5977191, 'f1': 0.6229925, 'auroc': 0.8810194, 'binary_precision': 0.42718446, 'binary_recall': 0.2208281, 'binary_specificity': 0.97461003, 'binary_f1_score': 0.2911497}
confusion matrix:
      0    1
0  9059  236
1   621  176
early stop counter: 1
val acc:0.8853655457496643, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9192429780960083
after epoch: 3,now: 2024-08-10 21:04:15.961123,epoch time: 0:15:48.737197,used: 0:48:12.757140,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9673089, 'precision': 0.9687131, 'recall': 0.96730256, 'specificity': 0.96730256, 'f1': 0.9672841, 'auroc': 0.9985298, 'binary_precision': 0.94311595, 'binary_recall': 0.99462366, 'binary_specificity': 0.9399814, 'binary_f1_score': 0.96818525}
confusion matrix:
       0      1
0  24291   1551
1    139  25715
---- Validation: 
scalar performance:
{'acc': 0.8829713, 'precision': 0.57277215, 'recall': 0.8513871, 'specificity': 0.8513871, 'f1': 0.5954831, 'auroc': 0.9129385, 'binary_precision': 0.1506608, 'binary_recall': 0.8181818, 'binary_specificity': 0.88459235, 'binary_f1_score': 0.2544643}
confusion matrix:
       0     1
0  14778  1928
1     76   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.919243, 'precision': 0.674417, 'recall': 0.5277097, 'specificity': 0.5277097, 'f1': 0.53349686, 'auroc': 0.8683874, 'binary_precision': 0.42372882, 'binary_recall': 0.06273526, 'binary_specificity': 0.99268425, 'binary_f1_score': 0.109289624}
confusion matrix:
      0   1
0  9227  68
1   747  50
early stop counter: 2
val acc:0.8829712867736816, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9192429780960083
after epoch: 4,now: 2024-08-10 21:20:19.813537,epoch time: 0:16:03.852414,used: 1:04:16.609554,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98417675, 'precision': 0.98424816, 'recall': 0.9841758, 'specificity': 0.9841758, 'f1': 0.98417616, 'auroc': 0.9987006, 'binary_precision': 0.9784054, 'binary_recall': 0.9902135, 'binary_specificity': 0.978138, 'binary_f1_score': 0.9842741}
confusion matrix:
       0      1
0  25279    565
1    253  25599
---- Validation: 
scalar performance:
{'acc': 0.9541579, 'precision': 0.6484499, 'recall': 0.8237276, 'specificity': 0.8237276, 'f1': 0.69925064, 'auroc': 0.911355, 'binary_precision': 0.30499467, 'binary_recall': 0.6866029, 'binary_specificity': 0.9608524, 'binary_f1_score': 0.4223694}
confusion matrix:
       0    1
0  16052  654
1    131  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92112565, 'precision': 0.7606424, 'recall': 0.5017745, 'specificity': 0.5017745, 'f1': 0.48320612, 'auroc': 0.8068181, 'binary_precision': 0.6, 'binary_recall': 0.0037641155, 'binary_specificity': 0.9997848, 'binary_f1_score': 0.007481297}
confusion matrix:
      0  1
0  9293  2
1   794  3
new oracle model saved
early stop counter: 3
val acc:0.9541578888893127, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9211256504058838
after epoch: 5,now: 2024-08-10 21:36:29.643087,epoch time: 0:16:09.829550,used: 1:20:26.439104,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9711583, 'precision': 0.9722502, 'recall': 0.9711546, 'specificity': 0.9711546, 'f1': 0.97114146, 'auroc': 0.9988494, 'binary_precision': 0.9495811, 'binary_recall': 0.9951648, 'binary_specificity': 0.9471444, 'binary_f1_score': 0.9718387}
confusion matrix:
       0      1
0  24478   1366
1    125  25727
---- Validation: 
scalar performance:
{'acc': 0.8670871, 'precision': 0.5662545, 'recall': 0.8537425, 'specificity': 0.8537425, 'f1': 0.5814717, 'auroc': 0.91621566, 'binary_precision': 0.13710937, 'binary_recall': 0.8397129, 'binary_specificity': 0.86777204, 'binary_f1_score': 0.23572868}
confusion matrix:
       0     1
0  14497  2209
1     67   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9216211, 'precision': 0.739573, 'recall': 0.51752955, 'specificity': 0.51752955, 'f1': 0.5147954, 'auroc': 0.7960269, 'binary_precision': 0.5555556, 'binary_recall': 0.037641153, 'binary_specificity': 0.997418, 'binary_f1_score': 0.070505284}
confusion matrix:
      0   1
0  9271  24
1   767  30
new oracle model saved
early stop counter: 4
val acc:0.8670871257781982, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9216210842132568
after epoch: 6,now: 2024-08-10 21:52:54.313240,epoch time: 0:16:24.670153,used: 1:36:51.109257,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9737891, 'precision': 0.9746237, 'recall': 0.9737874, 'specificity': 0.9737874, 'f1': 0.9737775, 'auroc': 0.99887776, 'binary_precision': 0.9547395, 'binary_recall': 0.9947389, 'binary_specificity': 0.95283604, 'binary_f1_score': 0.9743288}
confusion matrix:
       0      1
0  24627   1219
1    136  25714
---- Validation: 
scalar performance:
{'acc': 0.8806354, 'precision': 0.5731225, 'recall': 0.86068606, 'specificity': 0.86068606, 'f1': 0.5953799, 'auroc': 0.91987073, 'binary_precision': 0.1507732, 'binary_recall': 0.8397129, 'binary_specificity': 0.88165927, 'binary_f1_score': 0.25564456}
confusion matrix:
       0     1
0  14729  1977
1     67   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9216211, 'precision': 0.739573, 'recall': 0.51752955, 'specificity': 0.51752955, 'f1': 0.5147954, 'auroc': 0.7952406, 'binary_precision': 0.5555556, 'binary_recall': 0.037641153, 'binary_specificity': 0.997418, 'binary_f1_score': 0.070505284}
confusion matrix:
      0   1
0  9271  24
1   767  30
early stop counter: 5
val acc:0.8806353807449341, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9216210842132568
after epoch: 7,now: 2024-08-10 22:08:55.720797,epoch time: 0:16:01.407557,used: 1:52:52.516814,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.919046, 'precision': 0.9297162, 'recall': 0.9190307, 'specificity': 0.9190307, 'f1': 0.91853833, 'auroc': 0.99783915, 'binary_precision': 0.86205053, 'binary_recall': 0.9977952, 'binary_specificity': 0.8402662, 'binary_f1_score': 0.9249691}
confusion matrix:
       0      1
0  21715   4128
1     57  25796
---- Validation: 
scalar performance:
{'acc': 0.6725648, 'precision': 0.5307087, 'recall': 0.79253376, 'specificity': 0.79253376, 'f1': 0.4596541, 'auroc': 0.89690053, 'binary_precision': 0.06446198, 'binary_recall': 0.9186603, 'binary_specificity': 0.6664073, 'binary_f1_score': 0.12047059}
confusion matrix:
       0     1
0  11133  5573
1     34   384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9225129, 'precision': 0.75781435, 'recall': 0.52891135, 'specificity': 0.52891135, 'f1': 0.5354269, 'auroc': 0.75301, 'binary_precision': 0.5903614, 'binary_recall': 0.061480552, 'binary_specificity': 0.9963421, 'binary_f1_score': 0.11136363}
confusion matrix:
      0   1
0  9261  34
1   748  49
new oracle model saved
early stop counter: 6
val acc:0.6725648045539856, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9225128889083862
after epoch: 8,now: 2024-08-10 22:25:39.945796,epoch time: 0:16:44.224999,used: 2:09:36.741813,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9604418, 'precision': 0.96260554, 'recall': 0.9604339, 'specificity': 0.9604339, 'f1': 0.960395, 'auroc': 0.99807537, 'binary_precision': 0.93102574, 'binary_recall': 0.994585, 'binary_specificity': 0.9262828, 'binary_f1_score': 0.96175635}
confusion matrix:
       0      1
0  23937   1905
1    140  25714
---- Validation: 
scalar performance:
{'acc': 0.9010161, 'precision': 0.5625066, 'recall': 0.7416785, 'specificity': 0.7416785, 'f1': 0.5839207, 'auroc': 0.8685936, 'binary_precision': 0.13659647, 'binary_recall': 0.57416266, 'binary_specificity': 0.9091943, 'binary_f1_score': 0.22068965}
confusion matrix:
       0     1
0  15189  1517
1    178   240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92221564, 'precision': 0.8778539, 'recall': 0.5092489, 'specificity': 0.5092489, 'f1': 0.49814054, 'auroc': 0.74923766, 'binary_precision': 0.8333333, 'binary_recall': 0.018820576, 'binary_specificity': 0.99967724, 'binary_f1_score': 0.036809813}
confusion matrix:
      0   1
0  9292   3
1   782  15
early stop counter: 7
val acc:0.901016116142273, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9225128889083862
after epoch: 9,now: 2024-08-10 22:41:57.624035,epoch time: 0:16:17.678239,used: 2:25:54.420052,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9063951, 'precision': 0.9206423, 'recall': 0.9063773, 'specificity': 0.9063773, 'f1': 0.90559304, 'auroc': 0.99776894, 'binary_precision': 0.84327626, 'binary_recall': 0.9983754, 'binary_specificity': 0.81437916, 'binary_f1_score': 0.91429484}
confusion matrix:
       0      1
0  21046   4797
1     42  25811
---- Validation: 
scalar performance:
{'acc': 0.6450596, 'precision': 0.52827996, 'recall': 0.778437, 'specificity': 0.778437, 'f1': 0.44518682, 'auroc': 0.8947642, 'binary_precision': 0.059738643, 'binary_recall': 0.9186603, 'binary_specificity': 0.6382138, 'binary_f1_score': 0.1121823}
confusion matrix:
       0     1
0  10662  6044
1     34   384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234047, 'precision': 0.7782674, 'recall': 0.5345575, 'specificity': 0.5345575, 'f1': 0.5452107, 'auroc': 0.8066788, 'binary_precision': 0.6304348, 'binary_recall': 0.0727729, 'binary_specificity': 0.9963421, 'binary_f1_score': 0.13048369}
confusion matrix:
      0   1
0  9261  34
1   739  58
new oracle model saved
early stop counter: 8
val acc:0.6450595855712891, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9234046936035156
after epoch: 10,now: 2024-08-10 22:58:13.263437,epoch time: 0:16:15.639402,used: 2:42:10.059454,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9565343, 'precision': 0.959476, 'recall': 0.95652354, 'specificity': 0.95652354, 'f1': 0.95646393, 'auroc': 0.9984392, 'binary_precision': 0.9227794, 'binary_recall': 0.99648035, 'binary_specificity': 0.91656667, 'binary_f1_score': 0.95821476}
confusion matrix:
       0      1
0  23685   2156
1     91  25764
---- Validation: 
scalar performance:
{'acc': 0.8439033, 'precision': 0.55829203, 'recall': 0.85119045, 'specificity': 0.85119045, 'f1': 0.56255573, 'auroc': 0.909825, 'binary_precision': 0.120753445, 'binary_recall': 0.8588517, 'binary_specificity': 0.8435293, 'binary_f1_score': 0.21173693}
confusion matrix:
       0     1
0  14092  2614
1     59   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92290926, 'precision': 0.91798764, 'recall': 0.5130668, 'specificity': 0.5130668, 'f1': 0.50552094, 'auroc': 0.82350194, 'binary_precision': 0.9130435, 'binary_recall': 0.026348809, 'binary_specificity': 0.9997848, 'binary_f1_score': 0.05121951}
confusion matrix:
      0   1
0  9293   2
1   776  21
early stop counter: 9
val acc:0.8439033031463623, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9234046936035156
after epoch: 11,now: 2024-08-10 23:14:20.647343,epoch time: 0:16:07.383906,used: 2:58:17.443360,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95846874, 'precision': 0.9611894, 'recall': 0.9584613, 'specificity': 0.9584613, 'f1': 0.9584069, 'auroc': 0.997429, 'binary_precision': 0.92581546, 'binary_recall': 0.9968282, 'binary_specificity': 0.92009443, 'binary_f1_score': 0.9600104}
confusion matrix:
       0      1
0  23778   2065
1     82  25771
---- Validation: 
scalar performance:
{'acc': 0.86889744, 'precision': 0.5562738, 'recall': 0.78586197, 'specificity': 0.78586197, 'f1': 0.5674899, 'auroc': 0.87429345, 'binary_precision': 0.12111157, 'binary_recall': 0.6985646, 'binary_specificity': 0.87315935, 'binary_f1_score': 0.20643337}
confusion matrix:
       0     1
0  14587  2119
1    126   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92221564, 'precision': 0.79975843, 'recall': 0.5138374, 'specificity': 0.5138374, 'f1': 0.5073964, 'auroc': 0.86132133, 'binary_precision': 0.6764706, 'binary_recall': 0.028858218, 'binary_specificity': 0.99881655, 'binary_f1_score': 0.05535499}
confusion matrix:
      0   1
0  9284  11
1   774  23
early stop counter: 10
val acc:0.8688974380493164, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9234046936035156
after epoch: 12,now: 2024-08-10 23:30:28.956368,epoch time: 0:16:08.309025,used: 3:14:25.752385,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93506265, 'precision': 0.9420438, 'recall': 0.9350554, 'specificity': 0.9350554, 'f1': 0.93480456, 'auroc': 0.9986372, 'binary_precision': 0.8865214, 'binary_recall': 0.9978724, 'binary_specificity': 0.87223834, 'binary_f1_score': 0.938907}
confusion matrix:
       0      1
0  22543   3302
1     55  25796
---- Validation: 
scalar performance:
{'acc': 0.67636067, 'precision': 0.5292984, 'recall': 0.7769855, 'specificity': 0.7769855, 'f1': 0.45968044, 'auroc': 0.86540604, 'binary_precision': 0.0629478, 'binary_recall': 0.8827751, 'binary_specificity': 0.671196, 'binary_f1_score': 0.11751593}
confusion matrix:
       0     1
0  11213  5493
1     49   369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92281014, 'precision': 0.7872209, 'recall': 0.5233371, 'specificity': 0.5233371, 'f1': 0.52535444, 'auroc': 0.8476239, 'binary_precision': 0.65, 'binary_recall': 0.048933502, 'binary_specificity': 0.99774075, 'binary_f1_score': 0.09101517}
confusion matrix:
      0   1
0  9274  21
1   758  39
early stop counter: 11
val acc:0.6763606667518616, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9234046936035156
after epoch: 13,now: 2024-08-10 23:46:50.823167,epoch time: 0:16:21.866799,used: 3:30:47.619184,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9241721, 'precision': 0.9337354, 'recall': 0.92415774, 'specificity': 0.92415774, 'f1': 0.92375004, 'auroc': 0.9983482, 'binary_precision': 0.8693792, 'binary_recall': 0.9983754, 'binary_specificity': 0.84994, 'binary_f1_score': 0.92942274}
confusion matrix:
       0      1
0  21965   3878
1     42  25811
---- Validation: 
scalar performance:
{'acc': 0.7448026, 'precision': 0.53866273, 'recall': 0.8237252, 'specificity': 0.8237252, 'f1': 0.4988736, 'auroc': 0.89771676, 'binary_precision': 0.08046709, 'binary_recall': 0.9066986, 'binary_specificity': 0.7407518, 'binary_f1_score': 0.1478159}
confusion matrix:
       0     1
0  12375  4331
1     39   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92191833, 'precision': 0.73026013, 'recall': 0.5417805, 'specificity': 0.5417805, 'f1': 0.55678785, 'auroc': 0.82874, 'binary_precision': 0.53333336, 'binary_recall': 0.090338774, 'binary_specificity': 0.9932222, 'binary_f1_score': 0.15450644}
confusion matrix:
      0   1
0  9232  63
1   725  72
early stop counter: 12
val acc:0.7448025941848755, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9234046936035156
after epoch: 14,now: 2024-08-11 00:03:00.736333,epoch time: 0:16:09.913166,used: 3:46:57.532350,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9222764, 'precision': 0.93197453, 'recall': 0.9222561, 'specificity': 0.9222561, 'f1': 0.9218351, 'auroc': 0.9982153, 'binary_precision': 0.8673171, 'binary_recall': 0.9971379, 'binary_specificity': 0.8473743, 'binary_f1_score': 0.9277078}
confusion matrix:
       0      1
0  21897   3944
1     74  25781
---- Validation: 
scalar performance:
{'acc': 0.7083041, 'precision': 0.5310354, 'recall': 0.77819574, 'specificity': 0.77819574, 'f1': 0.47487384, 'auroc': 0.84070176, 'binary_precision': 0.06730951, 'binary_recall': 0.8516746, 'binary_specificity': 0.70471686, 'binary_f1_score': 0.12475907}
confusion matrix:
       0     1
0  11773  4933
1     62   356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236029, 'precision': 0.9030476, 'recall': 0.5186054, 'specificity': 0.5186054, 'f1': 0.5161817, 'auroc': 0.80411136, 'binary_precision': 0.88235295, 'binary_recall': 0.037641153, 'binary_specificity': 0.99956965, 'binary_f1_score': 0.07220216}
confusion matrix:
      0   1
0  9291   4
1   767  30
new oracle model saved
early stop counter: 13
val acc:0.7083041071891785, best validation acc: 0.9575449824333191, corresponding to test acc:                         0.9172611832618713 / 0.9236028790473938
after epoch: 15,now: 2024-08-11 00:19:12.269371,epoch time: 0:16:11.533038,used: 4:03:09.065388,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_02_seed_2_24141963
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:03:09.065388 at 2024-08-11 00:19:12.269371
persisted model performance metric: 

scalar performance:
{'acc': 0.9172612, 'precision': 0.6804503, 'recall': 0.5650624, 'specificity': 0.5650624, 'f1': 0.58760655, 'auroc': 0.86862206, 'binary_precision': 0.43014705, 'binary_recall': 0.1468005, 'binary_specificity': 0.98332435, 'binary_f1_score': 0.21889615}
confusion matrix:
      0    1
0  9140  155
1   680  117
oracle model performance metric: 

scalar performance:
{'acc': 0.9236029, 'precision': 0.9030476, 'recall': 0.5186054, 'specificity': 0.5186054, 'f1': 0.5161817, 'auroc': 0.80411136, 'binary_precision': 0.88235295, 'binary_recall': 0.037641153, 'binary_specificity': 0.99956965, 'binary_f1_score': 0.07220216}
confusion matrix:
      0   1
0  9291   4
1   767  30
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 470488 KiB |   3238 MiB | 732911 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730823 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 470488 KiB |   3238 MiB | 732911 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730823 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 722603 GiB | 722603 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |  71980 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3482 MiB |   3482 MiB |   7884 MiB |   4402 MiB |
|       from large pool |   3374 MiB |   3374 MiB |   7722 MiB |   4348 MiB |
|       from small pool |    108 MiB |    110 MiB |    162 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 440871 KiB |   1050 MiB | 539869 GiB | 539868 GiB |
|       from large pool | 430496 KiB |   1046 MiB | 537780 GiB | 537779 GiB |
|       from small pool |  10375 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7492    |  152704 K  |  152699 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99182 K  |   99178 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7492    |  152704 K  |  152699 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99182 K  |   99178 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     115    |     210    |      98    |
|       from large pool |      58    |      60    |     129    |      71    |
|       from small pool |      54    |      55    |      81    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3258    |   72563 K  |   72563 K  |
|       from large pool |      19    |      33    |   24786 K  |   24786 K  |
|       from small pool |      49    |    3240    |   47777 K  |   47777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 732911 GiB | 732911 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 732911 GiB | 732911 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 722603 GiB | 722603 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |      0 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    890 MiB |   3482 MiB |   7884 MiB |   6994 MiB |
|       from large pool |    808 MiB |   3374 MiB |   7722 MiB |   6914 MiB |
|       from small pool |     82 MiB |    110 MiB |    162 MiB |     80 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 539869 GiB | 539869 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 537780 GiB | 537780 GiB |
|       from small pool |      0 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7492    |  152704 K  |  152704 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99182 K  |   99182 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7492    |  152704 K  |  152704 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99182 K  |   99182 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     115    |     210    |     149    |
|       from large pool |      20    |      60    |     129    |     109    |
|       from small pool |      41    |      55    |      81    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3258    |   72566 K  |   72566 K  |
|       from large pool |       4    |      33    |   24786 K  |   24786 K  |
|       from small pool |       0    |    3240    |   47779 K  |   47779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 00:21:10 2024]
Finished job 0.
1 of 1 steps (100%) done
