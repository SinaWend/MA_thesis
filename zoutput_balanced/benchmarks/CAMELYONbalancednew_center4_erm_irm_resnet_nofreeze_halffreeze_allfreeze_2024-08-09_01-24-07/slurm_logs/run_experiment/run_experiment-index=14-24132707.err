Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 09:04:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/14.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=14
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707

 Experiment start at: 2024-08-09 09:11:43.830229
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91244864, 'precision': 0.9128099, 'recall': 0.91243935, 'specificity': 0.91243935, 'f1': 0.9124282, 'auroc': 0.97455895, 'binary_precision': 0.90075517, 'binary_recall': 0.92716223, 'binary_specificity': 0.8977165, 'binary_f1_score': 0.913768}
confusion matrix:
       0      1
0  22723   2589
1   1846  23498
---- Validation: 
scalar performance:
{'acc': 0.8209495, 'precision': 0.51360977, 'recall': 0.5816223, 'specificity': 0.5816223, 'f1': 0.49136958, 'auroc': 0.65778273, 'binary_precision': 0.046773642, 'binary_recall': 0.33012047, 'binary_specificity': 0.83312416, 'binary_f1_score': 0.0819378}
confusion matrix:
       0     1
0  13939  2792
1    278   137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8394305, 'precision': 0.60583043, 'recall': 0.71166503, 'specificity': 0.71166503, 'f1': 0.62811816, 'auroc': 0.7502638, 'binary_precision': 0.25203726, 'binary_recall': 0.56088084, 'binary_specificity': 0.86244917, 'binary_f1_score': 0.3477912}
confusion matrix:
      0     1
0  8057  1285
1   339   433
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 09:33:19.923599,epoch time: 0:21:36.093370,used: 0:21:36.093370,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9397505, 'precision': 0.9398677, 'recall': 0.9397554, 'specificity': 0.9397554, 'f1': 0.939747, 'auroc': 0.9848678, 'binary_precision': 0.9471974, 'binary_recall': 0.93149984, 'binary_specificity': 0.9480109, 'binary_f1_score': 0.9392831}
confusion matrix:
       0      1
0  23997   1316
1   1736  23607
---- Validation: 
scalar performance:
{'acc': 0.88679576, 'precision': 0.52926445, 'recall': 0.61653703, 'specificity': 0.61653703, 'f1': 0.5319891, 'auroc': 0.71394706, 'binary_precision': 0.076581575, 'binary_recall': 0.3325301, 'binary_specificity': 0.9005439, 'binary_f1_score': 0.12449256}
confusion matrix:
       0     1
0  15067  1664
1    277   138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9077516, 'precision': 0.68834203, 'recall': 0.73141825, 'specificity': 0.73141825, 'f1': 0.7068166, 'auroc': 0.806574, 'binary_precision': 0.41692466, 'binary_recall': 0.5233161, 'binary_specificity': 0.9395204, 'binary_f1_score': 0.4641011}
confusion matrix:
      0    1
0  8777  565
1   368  404
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 09:53:41.645049,epoch time: 0:20:21.721450,used: 0:41:57.814820,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95337176, 'precision': 0.9533741, 'recall': 0.9533712, 'specificity': 0.9533712, 'f1': 0.95337164, 'auroc': 0.99042046, 'binary_precision': 0.9524672, 'binary_recall': 0.9544217, 'binary_specificity': 0.95232075, 'binary_f1_score': 0.9534434}
confusion matrix:
       0      1
0  24108   1207
1   1155  24186
---- Validation: 
scalar performance:
{'acc': 0.8938528, 'precision': 0.541801, 'recall': 0.6624507, 'specificity': 0.6624507, 'f1': 0.55193055, 'auroc': 0.76072764, 'binary_precision': 0.099258415, 'binary_recall': 0.4192771, 'binary_specificity': 0.9056243, 'binary_f1_score': 0.16051662}
confusion matrix:
       0     1
0  15152  1579
1    241   174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90844375, 'precision': 0.68699706, 'recall': 0.7193158, 'specificity': 0.7193158, 'f1': 0.7013809, 'auroc': 0.81597805, 'binary_precision': 0.41630435, 'binary_recall': 0.496114, 'binary_specificity': 0.94251764, 'binary_f1_score': 0.45271868}
confusion matrix:
      0    1
0  8805  537
1   389  383
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 10:14:15.163087,epoch time: 0:20:33.518038,used: 1:02:31.332858,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95532614, 'precision': 0.9554243, 'recall': 0.9553204, 'specificity': 0.9553204, 'f1': 0.9553233, 'auroc': 0.9915416, 'binary_precision': 0.94893235, 'binary_recall': 0.9625217, 'binary_specificity': 0.94811916, 'binary_f1_score': 0.9556787}
confusion matrix:
       0      1
0  23995   1313
1    950  24398
---- Validation: 
scalar performance:
{'acc': 0.8768226, 'precision': 0.53781486, 'recall': 0.67017347, 'specificity': 0.67017347, 'f1': 0.5423593, 'auroc': 0.7698138, 'binary_precision': 0.09068982, 'binary_recall': 0.45301205, 'binary_specificity': 0.8873349, 'binary_f1_score': 0.1511254}
confusion matrix:
       0     1
0  14846  1885
1    227   188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91318965, 'precision': 0.6963678, 'recall': 0.7111902, 'specificity': 0.7111902, 'f1': 0.70341325, 'auroc': 0.8256229, 'binary_precision': 0.43660286, 'binary_recall': 0.47279793, 'binary_specificity': 0.9495825, 'binary_f1_score': 0.45398006}
confusion matrix:
      0    1
0  8871  471
1   407  365
new oracle model saved
early stop counter: 1
val acc:0.8768225908279419, best validation acc: 0.8938527703285217, corresponding to test acc:                         0.9084437489509583 / 0.9131896495819092
after epoch: 4,now: 2024-08-09 10:34:55.933492,epoch time: 0:20:40.770405,used: 1:23:12.103263,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95909667, 'precision': 0.9595963, 'recall': 0.95910645, 'specificity': 0.95910645, 'f1': 0.9590862, 'auroc': 0.9922918, 'binary_precision': 0.974899, 'binary_recall': 0.94250876, 'binary_specificity': 0.9757042, 'binary_f1_score': 0.9584303}
confusion matrix:
       0      1
0  24698    615
1   1457  23886
---- Validation: 
scalar performance:
{'acc': 0.90994984, 'precision': 0.54558027, 'recall': 0.6483751, 'specificity': 0.6483751, 'f1': 0.5598038, 'auroc': 0.7602948, 'binary_precision': 0.10771369, 'binary_recall': 0.37349397, 'binary_specificity': 0.9232562, 'binary_f1_score': 0.16720605}
confusion matrix:
       0     1
0  15447  1284
1    260   155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9169468, 'precision': 0.7005439, 'recall': 0.6793577, 'specificity': 0.6793577, 'f1': 0.6891647, 'auroc': 0.8265101, 'binary_precision': 0.4502924, 'binary_recall': 0.39896372, 'binary_specificity': 0.95975167, 'binary_f1_score': 0.4230769}
confusion matrix:
      0    1
0  8966  376
1   464  308
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 10:55:29.949770,epoch time: 0:20:34.016278,used: 1:43:46.119541,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9614656, 'precision': 0.9618577, 'recall': 0.9614731, 'specificity': 0.9614731, 'f1': 0.96145785, 'auroc': 0.9928359, 'binary_precision': 0.97544414, 'binary_recall': 0.9468056, 'binary_specificity': 0.9761406, 'binary_f1_score': 0.9609115}
confusion matrix:
       0      1
0  24711    604
1   1348  23993
---- Validation: 
scalar performance:
{'acc': 0.93497026, 'precision': 0.566031, 'recall': 0.6529711, 'specificity': 0.6529711, 'f1': 0.5879351, 'auroc': 0.7731596, 'binary_precision': 0.14859438, 'binary_recall': 0.3566265, 'binary_specificity': 0.94931567, 'binary_f1_score': 0.20978029}
confusion matrix:
       0    1
0  15883  848
1    267  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9165513, 'precision': 0.69625527, 'recall': 0.6654782, 'specificity': 0.6654782, 'f1': 0.6791258, 'auroc': 0.8516245, 'binary_precision': 0.44392523, 'binary_recall': 0.369171, 'binary_specificity': 0.9617855, 'binary_f1_score': 0.40311173}
confusion matrix:
      0    1
0  8985  357
1   487  285
better model found
persisted
after epoch: 6,now: 2024-08-09 11:16:11.417977,epoch time: 0:20:41.468207,used: 2:04:27.587748,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96300536, 'precision': 0.9630745, 'recall': 0.9630088, 'specificity': 0.9630088, 'f1': 0.9630042, 'auroc': 0.99315923, 'binary_precision': 0.96887237, 'binary_recall': 0.9567911, 'binary_specificity': 0.96922654, 'binary_f1_score': 0.9627938}
confusion matrix:
       0      1
0  24535    779
1   1095  24247
---- Validation: 
scalar performance:
{'acc': 0.9221976, 'precision': 0.5629622, 'recall': 0.6840242, 'specificity': 0.6840242, 'f1': 0.585796, 'auroc': 0.7905017, 'binary_precision': 0.14073496, 'binary_recall': 0.43373495, 'binary_specificity': 0.93431354, 'binary_f1_score': 0.21251476}
confusion matrix:
       0     1
0  15632  1099
1    235   180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91467273, 'precision': 0.69452465, 'recall': 0.68406814, 'specificity': 0.68406814, 'f1': 0.6891023, 'auroc': 0.8585279, 'binary_precision': 0.43741402, 'binary_recall': 0.4119171, 'binary_specificity': 0.9562192, 'binary_f1_score': 0.42428285}
confusion matrix:
      0    1
0  8933  409
1   454  318
early stop counter: 1
val acc:0.9221975803375244, best validation acc: 0.9349702596664429, corresponding to test acc:                         0.9165512919425964 / 0.9169468283653259
after epoch: 7,now: 2024-08-09 11:36:56.529316,epoch time: 0:20:45.111339,used: 2:25:12.699087,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96533483, 'precision': 0.9654718, 'recall': 0.96534026, 'specificity': 0.96534026, 'f1': 0.9653325, 'auroc': 0.9936452, 'binary_precision': 0.9736166, 'binary_recall': 0.95663667, 'binary_specificity': 0.9740439, 'binary_f1_score': 0.96505195}
confusion matrix:
       0      1
0  24655    657
1   1099  24245
---- Validation: 
scalar performance:
{'acc': 0.92517203, 'precision': 0.5649493, 'recall': 0.6820235, 'specificity': 0.6820235, 'f1': 0.5884799, 'auroc': 0.79073215, 'binary_precision': 0.14484452, 'binary_recall': 0.426506, 'binary_specificity': 0.93754107, 'binary_f1_score': 0.21624924}
confusion matrix:
       0     1
0  15686  1045
1    238   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91605693, 'precision': 0.6958933, 'recall': 0.6711521, 'specificity': 0.6711521, 'f1': 0.6824105, 'auroc': 0.8548695, 'binary_precision': 0.44227886, 'binary_recall': 0.38212436, 'binary_specificity': 0.9601798, 'binary_f1_score': 0.41000694}
confusion matrix:
      0    1
0  8970  372
1   477  295
early stop counter: 2
val acc:0.9251720309257507, best validation acc: 0.9349702596664429, corresponding to test acc:                         0.9165512919425964 / 0.9169468283653259
after epoch: 8,now: 2024-08-09 11:57:33.314761,epoch time: 0:20:36.785445,used: 2:45:49.484532,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9699739, 'precision': 0.96997446, 'recall': 0.96997434, 'specificity': 0.96997434, 'f1': 0.9699739, 'auroc': 0.9952345, 'binary_precision': 0.9706417, 'binary_recall': 0.96930116, 'binary_specificity': 0.9706475, 'binary_f1_score': 0.96997094}
confusion matrix:
       0      1
0  24570    743
1    778  24565
---- Validation: 
scalar performance:
{'acc': 0.9120495, 'precision': 0.5665602, 'recall': 0.73052144, 'specificity': 0.73052144, 'f1': 0.5912018, 'auroc': 0.8298447, 'binary_precision': 0.14536016, 'binary_recall': 0.53975904, 'binary_specificity': 0.92128384, 'binary_f1_score': 0.22903885}
confusion matrix:
       0     1
0  15414  1317
1    191   224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91427726, 'precision': 0.7020721, 'recall': 0.72603846, 'specificity': 0.72603846, 'f1': 0.7131464, 'auroc': 0.86085, 'binary_precision': 0.44558993, 'binary_recall': 0.503886, 'binary_specificity': 0.948191, 'binary_f1_score': 0.47294834}
confusion matrix:
      0    1
0  8858  484
1   383  389
early stop counter: 3
val acc:0.9120494723320007, best validation acc: 0.9349702596664429, corresponding to test acc:                         0.9165512919425964 / 0.9169468283653259
after epoch: 9,now: 2024-08-09 12:18:20.762178,epoch time: 0:20:47.447417,used: 3:06:36.931949,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_11_43_seed_0_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 3:06:36.931949 at 2024-08-09 12:18:20.762178
persisted model performance metric: 

scalar performance:
{'acc': 0.9165513, 'precision': 0.69625527, 'recall': 0.6654782, 'specificity': 0.6654782, 'f1': 0.6791258, 'auroc': 0.8516245, 'binary_precision': 0.44392523, 'binary_recall': 0.369171, 'binary_specificity': 0.9617855, 'binary_f1_score': 0.40311173}
confusion matrix:
      0    1
0  8985  357
1   487  285
oracle model performance metric: 

scalar performance:
{'acc': 0.9169468, 'precision': 0.7005439, 'recall': 0.6793577, 'specificity': 0.6793577, 'f1': 0.6891647, 'auroc': 0.8265101, 'binary_precision': 0.4502924, 'binary_recall': 0.39896372, 'binary_specificity': 0.95975167, 'binary_f1_score': 0.4230769}
confusion matrix:
      0    1
0  8966  376
1   464  308
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/14.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205702 KiB | 575148 KiB | 147161 GiB | 147161 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 146953 GiB | 146953 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    207 GiB |    207 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205702 KiB | 575148 KiB | 147161 GiB | 147161 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 146953 GiB | 146953 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    207 GiB |    207 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201269 KiB | 563485 KiB | 145546 GiB | 145545 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 145344 GiB | 145344 GiB |
|       from small pool |  36149 KiB |  74518 KiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 739328 KiB | 739328 KiB | 739328 KiB |      0 B   |
|       from large pool | 661504 KiB | 661504 KiB | 661504 KiB |      0 B   |
|       from small pool |  77824 KiB |  77824 KiB |  77824 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  46201 KiB | 149348 KiB |  99957 GiB |  99957 GiB |
|       from large pool |  36864 KiB | 148352 KiB |  99736 GiB |  99736 GiB |
|       from small pool |   9337 KiB |   9337 KiB |    221 GiB |    221 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4698    |    7081    |   29429 K  |   29425 K  |
|       from large pool |      36    |      76    |    9966 K  |    9966 K  |
|       from small pool |    4662    |    7044    |   19462 K  |   19458 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4698    |    7081    |   29429 K  |   29425 K  |
|       from large pool |      36    |      76    |    9966 K  |    9966 K  |
|       from small pool |    4662    |    7044    |   19462 K  |   19458 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      55    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      38    |      38    |      38    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3184    |   14801 K  |   14801 K  |
|       from large pool |       7    |      11    |    5672 K  |    5672 K  |
|       from small pool |      30    |    3177    |    9128 K  |    9128 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 147161 GiB | 147161 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 146953 GiB | 146953 GiB |
|       from small pool |      0 KiB |  76198 KiB |    207 GiB |    207 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 147161 GiB | 147161 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 146953 GiB | 146953 GiB |
|       from small pool |      0 KiB |  76198 KiB |    207 GiB |    207 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 145546 GiB | 145546 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 145344 GiB | 145344 GiB |
|       from small pool |      0 KiB |  74518 KiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 251904 KiB | 739328 KiB | 739328 KiB | 487424 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  47104 KiB |  77824 KiB |  77824 KiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB |  99957 GiB |  99957 GiB |
|       from large pool |  24320 KiB | 148352 KiB |  99736 GiB |  99736 GiB |
|       from small pool |      0 KiB |  16932 KiB |    221 GiB |    221 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7081    |   29429 K  |   29429 K  |
|       from large pool |       2    |      76    |    9966 K  |    9966 K  |
|       from small pool |       0    |    7044    |   19462 K  |   19462 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7081    |   29429 K  |   29429 K  |
|       from large pool |       2    |      76    |    9966 K  |    9966 K  |
|       from small pool |       0    |    7044    |   19462 K  |   19462 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      55    |      55    |      22    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      23    |      38    |      38    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   14803 K  |   14803 K  |
|       from large pool |       3    |      13    |    5672 K  |    5672 K  |
|       from small pool |       0    |    3177    |    9130 K  |    9130 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 147161 GiB | 147161 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 146953 GiB | 146953 GiB |
|       from small pool |      0 KiB |  76198 KiB |    207 GiB |    207 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 147161 GiB | 147161 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 146953 GiB | 146953 GiB |
|       from small pool |      0 KiB |  76198 KiB |    207 GiB |    207 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 145546 GiB | 145546 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 145344 GiB | 145344 GiB |
|       from small pool |      0 KiB |  74518 KiB |    201 GiB |    201 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 251904 KiB | 739328 KiB | 739328 KiB | 487424 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  47104 KiB |  77824 KiB |  77824 KiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB |  99957 GiB |  99957 GiB |
|       from large pool |  24320 KiB | 148352 KiB |  99736 GiB |  99736 GiB |
|       from small pool |      0 KiB |  16932 KiB |    221 GiB |    221 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7081    |   29429 K  |   29429 K  |
|       from large pool |       2    |      76    |    9966 K  |    9966 K  |
|       from small pool |       0    |    7044    |   19462 K  |   19462 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7081    |   29429 K  |   29429 K  |
|       from large pool |       2    |      76    |    9966 K  |    9966 K  |
|       from small pool |       0    |    7044    |   19462 K  |   19462 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      55    |      55    |      22    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      23    |      38    |      38    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   14803 K  |   14803 K  |
|       from large pool |       3    |      13    |    5672 K  |    5672 K  |
|       from small pool |       0    |    3177    |    9130 K  |    9130 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707

 Experiment start at: 2024-08-09 12:39:32.932469
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9009089, 'precision': 0.9016582, 'recall': 0.9008936, 'specificity': 0.9008936, 'f1': 0.90086013, 'auroc': 0.96959424, 'binary_precision': 0.8844863, 'binary_recall': 0.9224267, 'binary_specificity': 0.87936056, 'binary_f1_score': 0.9030582}
confusion matrix:
       0      1
0  22334   3064
1   1973  23461
---- Validation: 
scalar performance:
{'acc': 0.8279507, 'precision': 0.51055753, 'recall': 0.55802083, 'specificity': 0.55802083, 'f1': 0.48966536, 'auroc': 0.6273561, 'binary_precision': 0.04289349, 'binary_recall': 0.2737819, 'binary_specificity': 0.84225976, 'binary_f1_score': 0.074167185}
confusion matrix:
       0     1
0  14059  2633
1    313   118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8338123, 'precision': 0.6150273, 'recall': 0.75600576, 'specificity': 0.75600576, 'f1': 0.6395596, 'auroc': 0.7948239, 'binary_precision': 0.26116303, 'binary_recall': 0.664465, 'binary_specificity': 0.8475466, 'binary_f1_score': 0.3749534}
confusion matrix:
      0     1
0  7911  1423
1   254   503
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 13:01:16.152221,epoch time: 0:21:43.219752,used: 0:21:43.219752,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93401796, 'precision': 0.9344392, 'recall': 0.9340303, 'specificity': 0.9340303, 'f1': 0.93400323, 'auroc': 0.98299503, 'binary_precision': 0.9481653, 'binary_recall': 0.9183441, 'binary_specificity': 0.9497165, 'binary_f1_score': 0.9330164}
confusion matrix:
       0      1
0  24119   1277
1   2077  23359
---- Validation: 
scalar performance:
{'acc': 0.8867021, 'precision': 0.51909745, 'recall': 0.5700728, 'specificity': 0.5700728, 'f1': 0.5173584, 'auroc': 0.6483656, 'binary_precision': 0.05954466, 'binary_recall': 0.23665893, 'binary_specificity': 0.9034867, 'binary_f1_score': 0.09514926}
confusion matrix:
       0     1
0  15081  1611
1    329   102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9108116, 'precision': 0.6920509, 'recall': 0.7326858, 'specificity': 0.7326858, 'f1': 0.7097051, 'auroc': 0.8175081, 'binary_precision': 0.42352942, 'binary_recall': 0.52311754, 'binary_specificity': 0.9422541, 'binary_f1_score': 0.4680851}
confusion matrix:
      0    1
0  8795  539
1   361  396
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 13:22:04.097768,epoch time: 0:20:47.945547,used: 0:42:31.165299,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95207745, 'precision': 0.9523367, 'recall': 0.95208746, 'specificity': 0.95208746, 'f1': 0.9520713, 'auroc': 0.9890623, 'binary_precision': 0.96337485, 'binary_recall': 0.93996936, 'binary_specificity': 0.96420556, 'binary_f1_score': 0.95152825}
confusion matrix:
       0      1
0  24486    909
1   1527  23910
---- Validation: 
scalar performance:
{'acc': 0.9040472, 'precision': 0.53298014, 'recall': 0.60496247, 'specificity': 0.60496247, 'f1': 0.54064095, 'auroc': 0.7112826, 'binary_precision': 0.08549932, 'binary_recall': 0.2900232, 'binary_specificity': 0.9199017, 'binary_f1_score': 0.1320655}
confusion matrix:
       0     1
0  15355  1337
1    306   125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9163611, 'precision': 0.7020142, 'recall': 0.71565676, 'specificity': 0.71565676, 'f1': 0.7085366, 'auroc': 0.83179235, 'binary_precision': 0.44649446, 'binary_recall': 0.47952443, 'binary_specificity': 0.95178914, 'binary_f1_score': 0.4624204}
confusion matrix:
      0    1
0  8884  450
1   394  363
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 13:42:21.867001,epoch time: 0:20:17.769233,used: 1:02:48.934532,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9598481, 'precision': 0.9599769, 'recall': 0.9598552, 'specificity': 0.9598552, 'f1': 0.9598457, 'auroc': 0.99199116, 'binary_precision': 0.9678826, 'binary_recall': 0.9513307, 'binary_specificity': 0.9683796, 'binary_f1_score': 0.9595353}
confusion matrix:
       0      1
0  24592    803
1   1238  24199
---- Validation: 
scalar performance:
{'acc': 0.9250131, 'precision': 0.5530453, 'recall': 0.63379836, 'specificity': 0.63379836, 'f1': 0.57039326, 'auroc': 0.7646396, 'binary_precision': 0.12422907, 'binary_recall': 0.32714617, 'binary_specificity': 0.9404505, 'binary_f1_score': 0.18007663}
confusion matrix:
       0    1
0  15698  994
1    290  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91507286, 'precision': 0.6899539, 'recall': 0.67672354, 'specificity': 0.67672354, 'f1': 0.6830187, 'auroc': 0.8429669, 'binary_precision': 0.42857143, 'binary_recall': 0.39630118, 'binary_specificity': 0.9571459, 'binary_f1_score': 0.41180506}
confusion matrix:
      0    1
0  8934  400
1   457  300
better model found
persisted
after epoch: 4,now: 2024-08-09 14:03:01.724647,epoch time: 0:20:39.857646,used: 1:23:28.792178,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9619531, 'precision': 0.9620373, 'recall': 0.9619583, 'specificity': 0.9619583, 'f1': 0.9619517, 'auroc': 0.993227, 'binary_precision': 0.9684647, 'binary_recall': 0.9550619, 'binary_specificity': 0.9688546, 'binary_f1_score': 0.96171665}
confusion matrix:
       0      1
0  24606    791
1   1143  24292
---- Validation: 
scalar performance:
{'acc': 0.90731764, 'precision': 0.5510427, 'recall': 0.6676674, 'specificity': 0.6676674, 'f1': 0.56746507, 'auroc': 0.78120357, 'binary_precision': 0.11822985, 'binary_recall': 0.4153132, 'binary_specificity': 0.9200216, 'binary_f1_score': 0.18406169}
confusion matrix:
       0     1
0  15357  1335
1    252   179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9156674, 'precision': 0.6994921, 'recall': 0.71224713, 'specificity': 0.71224713, 'f1': 0.70560414, 'auroc': 0.85572875, 'binary_precision': 0.4419753, 'binary_recall': 0.4729194, 'binary_specificity': 0.95157486, 'binary_f1_score': 0.45692405}
confusion matrix:
      0    1
0  8882  452
1   399  358
early stop counter: 1
val acc:0.9073176383972168, best validation acc: 0.9250131249427795, corresponding to test acc:                         0.9150728583335876 / 0.9163610935211182
after epoch: 5,now: 2024-08-09 14:23:32.497593,epoch time: 0:20:30.772946,used: 1:43:59.565124,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.962799, 'precision': 0.96326923, 'recall': 0.9628117, 'specificity': 0.9628117, 'f1': 0.9627903, 'auroc': 0.9930614, 'binary_precision': 0.9782264, 'binary_recall': 0.94672906, 'binary_specificity': 0.9788943, 'binary_f1_score': 0.9622201}
confusion matrix:
       0      1
0  24860    536
1   1355  24081
---- Validation: 
scalar performance:
{'acc': 0.9392046, 'precision': 0.57727045, 'recall': 0.66141975, 'specificity': 0.66141975, 'f1': 0.6011709, 'auroc': 0.7883519, 'binary_precision': 0.1713362, 'binary_recall': 0.3689095, 'binary_specificity': 0.95393, 'binary_f1_score': 0.23399557}
confusion matrix:
       0    1
0  15923  769
1    272  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91992867, 'precision': 0.69989276, 'recall': 0.64718086, 'specificity': 0.64718086, 'f1': 0.6683098, 'auroc': 0.8585627, 'binary_precision': 0.453211, 'binary_recall': 0.32628798, 'binary_specificity': 0.9680737, 'binary_f1_score': 0.3794163}
confusion matrix:
      0    1
0  9036  298
1   510  247
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 14:44:29.046911,epoch time: 0:20:56.549318,used: 2:04:56.114442,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96175635, 'precision': 0.96211934, 'recall': 0.9617681, 'specificity': 0.9617681, 'f1': 0.96174955, 'auroc': 0.9927553, 'binary_precision': 0.9752782, 'binary_recall': 0.947596, 'binary_specificity': 0.97594017, 'binary_f1_score': 0.96123785}
confusion matrix:
       0      1
0  24784    611
1   1333  24104
---- Validation: 
scalar performance:
{'acc': 0.93663496, 'precision': 0.57669747, 'recall': 0.67027307, 'specificity': 0.67027307, 'f1': 0.6016996, 'auroc': 0.7952029, 'binary_precision': 0.16969697, 'binary_recall': 0.3897912, 'binary_specificity': 0.9507549, 'binary_f1_score': 0.23645319}
confusion matrix:
       0    1
0  15870  822
1    263  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9156674, 'precision': 0.6824614, 'recall': 0.64244974, 'specificity': 0.64244974, 'f1': 0.6591712, 'auroc': 0.8615049, 'binary_precision': 0.41896552, 'binary_recall': 0.32100397, 'binary_specificity': 0.96389544, 'binary_f1_score': 0.3635004}
confusion matrix:
      0    1
0  8997  337
1   514  243
early stop counter: 1
val acc:0.9366349577903748, best validation acc: 0.9392045736312866, corresponding to test acc:                         0.9199286699295044 / 0.9199286699295044
after epoch: 7,now: 2024-08-09 15:05:36.404091,epoch time: 0:21:07.357180,used: 2:26:03.471622,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96687126, 'precision': 0.9669218, 'recall': 0.9668755, 'specificity': 0.9668755, 'f1': 0.96687055, 'auroc': 0.9939158, 'binary_precision': 0.9719816, 'binary_recall': 0.96151125, 'binary_specificity': 0.97223973, 'binary_f1_score': 0.966718}
confusion matrix:
       0      1
0  24691    705
1    979  24457
---- Validation: 
scalar performance:
{'acc': 0.9255388, 'precision': 0.5752139, 'recall': 0.708657, 'specificity': 0.708657, 'f1': 0.6029767, 'auroc': 0.8168287, 'binary_precision': 0.1645469, 'binary_recall': 0.48027843, 'binary_specificity': 0.9370357, 'binary_f1_score': 0.24511546}
confusion matrix:
       0     1
0  15641  1051
1    224   207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197304, 'precision': 0.70679337, 'recall': 0.68652445, 'specificity': 0.68652445, 'f1': 0.6959709, 'auroc': 0.8667885, 'binary_precision': 0.46085674, 'binary_recall': 0.41215324, 'binary_specificity': 0.96089566, 'binary_f1_score': 0.43514645}
confusion matrix:
      0    1
0  8969  365
1   445  312
early stop counter: 2
val acc:0.9255387783050537, best validation acc: 0.9392045736312866, corresponding to test acc:                         0.9199286699295044 / 0.9199286699295044
after epoch: 8,now: 2024-08-09 15:26:51.916956,epoch time: 0:21:15.512865,used: 2:47:18.984487,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97110087, 'precision': 0.9711678, 'recall': 0.97110593, 'specificity': 0.97110593, 'f1': 0.9711001, 'auroc': 0.99495345, 'binary_precision': 0.9769941, 'binary_recall': 0.96497226, 'binary_specificity': 0.9772396, 'binary_f1_score': 0.970946}
confusion matrix:
       0      1
0  24817    578
1    891  24546
---- Validation: 
scalar performance:
{'acc': 0.9301524, 'precision': 0.58611786, 'recall': 0.7313659, 'specificity': 0.7313659, 'f1': 0.61835146, 'auroc': 0.83771056, 'binary_precision': 0.18518518, 'binary_recall': 0.52204174, 'binary_specificity': 0.94069016, 'binary_f1_score': 0.27339002}
confusion matrix:
       0    1
0  15702  990
1    206  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91655934, 'precision': 0.6949612, 'recall': 0.6787409, 'specificity': 0.6787409, 'f1': 0.6863819, 'auroc': 0.8744566, 'binary_precision': 0.4383164, 'binary_recall': 0.3989432, 'binary_specificity': 0.95853865, 'binary_f1_score': 0.417704}
confusion matrix:
      0    1
0  8947  387
1   455  302
early stop counter: 3
val acc:0.930152416229248, best validation acc: 0.9392045736312866, corresponding to test acc:                         0.9199286699295044 / 0.9199286699295044
after epoch: 9,now: 2024-08-09 15:51:41.262850,epoch time: 0:24:49.345894,used: 3:12:08.330381,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_12_39_32_seed_1_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 3:12:08.330381 at 2024-08-09 15:51:41.262850
persisted model performance metric: 

scalar performance:
{'acc': 0.91992867, 'precision': 0.69989276, 'recall': 0.64718086, 'specificity': 0.64718086, 'f1': 0.6683098, 'auroc': 0.8585627, 'binary_precision': 0.453211, 'binary_recall': 0.32628798, 'binary_specificity': 0.9680737, 'binary_f1_score': 0.3794163}
confusion matrix:
      0    1
0  9036  298
1   510  247
oracle model performance metric: 

scalar performance:
{'acc': 0.91992867, 'precision': 0.69989276, 'recall': 0.64718086, 'specificity': 0.64718086, 'f1': 0.6683098, 'auroc': 0.8585627, 'binary_precision': 0.453211, 'binary_recall': 0.32628798, 'binary_specificity': 0.9680737, 'binary_f1_score': 0.3794163}
confusion matrix:
      0    1
0  9036  298
1   510  247
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 581067 KiB | 294503 GiB | 294503 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 294088 GiB | 294088 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    414 GiB |    414 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 581067 KiB | 294503 GiB | 294503 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 294088 GiB | 294088 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    414 GiB |    414 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 574656 KiB | 291413 GiB | 291413 GiB |
|       from large pool | 165120 KiB | 502884 KiB | 291011 GiB | 291011 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    402 GiB |    402 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1088 MiB | 487424 KiB |
|       from large pool | 550912 KiB | 661504 KiB |    984 MiB | 456704 KiB |
|       from small pool |  75776 KiB |  77824 KiB |    104 MiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 182824 GiB | 182824 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 182382 GiB | 182382 GiB |
|       from small pool |   9343 KiB |  16932 KiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7103    |   58918 K  |   58914 K  |
|       from large pool |      36    |      76    |   19956 K  |   19956 K  |
|       from small pool |    4650    |    7066    |   38962 K  |   38958 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7103    |   58918 K  |   58914 K  |
|       from large pool |      36    |      76    |   19956 K  |   19956 K  |
|       from small pool |    4650    |    7066    |   38962 K  |   38958 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      76    |      22    |
|       from large pool |      17    |      17    |      24    |       7    |
|       from small pool |      37    |      38    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3191    |   30894 K  |   30894 K  |
|       from large pool |       3    |      13    |   12620 K  |   12620 K  |
|       from small pool |      30    |    3188    |   18273 K  |   18273 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 294503 GiB | 294503 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 294088 GiB | 294088 GiB |
|       from small pool |      0 KiB |  76198 KiB |    414 GiB |    414 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 294503 GiB | 294503 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 294088 GiB | 294088 GiB |
|       from small pool |      0 KiB |  76198 KiB |    414 GiB |    414 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 291413 GiB | 291413 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 291011 GiB | 291011 GiB |
|       from small pool |      0 KiB |  74518 KiB |    402 GiB |    402 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1088 MiB |    862 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    104 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 182825 GiB | 182824 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 182382 GiB | 182382 GiB |
|       from small pool |      0 KiB |  16938 KiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7103    |   58918 K  |   58918 K  |
|       from large pool |       2    |      76    |   19956 K  |   19956 K  |
|       from small pool |       0    |    7066    |   38962 K  |   38962 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7103    |   58918 K  |   58918 K  |
|       from large pool |       2    |      76    |   19956 K  |   19956 K  |
|       from small pool |       0    |    7066    |   38962 K  |   38962 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      76    |      44    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      52    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3191    |   30896 K  |   30896 K  |
|       from large pool |       3    |      13    |   12620 K  |   12620 K  |
|       from small pool |       0    |    3188    |   18275 K  |   18275 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 294503 GiB | 294503 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 294088 GiB | 294088 GiB |
|       from small pool |      0 KiB |  76198 KiB |    414 GiB |    414 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 294503 GiB | 294503 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 294088 GiB | 294088 GiB |
|       from small pool |      0 KiB |  76198 KiB |    414 GiB |    414 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 291413 GiB | 291413 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 291011 GiB | 291011 GiB |
|       from small pool |      0 KiB |  74518 KiB |    402 GiB |    402 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1088 MiB |    862 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    104 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 182825 GiB | 182824 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 182382 GiB | 182382 GiB |
|       from small pool |      0 KiB |  16938 KiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7103    |   58918 K  |   58918 K  |
|       from large pool |       2    |      76    |   19956 K  |   19956 K  |
|       from small pool |       0    |    7066    |   38962 K  |   38962 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7103    |   58918 K  |   58918 K  |
|       from large pool |       2    |      76    |   19956 K  |   19956 K  |
|       from small pool |       0    |    7066    |   38962 K  |   38962 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      76    |      44    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      52    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3191    |   30896 K  |   30896 K  |
|       from large pool |       3    |      13    |   12620 K  |   12620 K  |
|       from small pool |       0    |    3188    |   18275 K  |   18275 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707

 Experiment start at: 2024-08-09 16:19:18.223635
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9087357, 'precision': 0.9087608, 'recall': 0.90873635, 'specificity': 0.90873635, 'f1': 0.90873444, 'auroc': 0.9710293, 'binary_precision': 0.91200095, 'binary_recall': 0.9048043, 'binary_specificity': 0.91266835, 'binary_f1_score': 0.9083884}
confusion matrix:
       0      1
0  23587   2257
1   2461  23391
---- Validation: 
scalar performance:
{'acc': 0.8616561, 'precision': 0.51997405, 'recall': 0.5943856, 'specificity': 0.5943856, 'f1': 0.51232696, 'auroc': 0.66572666, 'binary_precision': 0.059195664, 'binary_recall': 0.31339714, 'binary_specificity': 0.87537414, 'binary_f1_score': 0.09958191}
confusion matrix:
       0     1
0  14624  2082
1    287   131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83382875, 'precision': 0.61398757, 'recall': 0.736575, 'specificity': 0.736575, 'f1': 0.63773406, 'auroc': 0.77708566, 'binary_precision': 0.2647059, 'binary_recall': 0.621079, 'binary_specificity': 0.852071, 'binary_f1_score': 0.3712036}
confusion matrix:
      0     1
0  7920  1375
1   302   495
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 16:47:05.002170,epoch time: 0:27:46.778535,used: 0:27:46.778535,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93527544, 'precision': 0.93661046, 'recall': 0.9352722, 'specificity': 0.9352722, 'f1': 0.9352256, 'auroc': 0.98713535, 'binary_precision': 0.9124968, 'binary_recall': 0.9629028, 'binary_specificity': 0.9076417, 'binary_f1_score': 0.9370224}
confusion matrix:
       0      1
0  23458   2387
1    959  24892
---- Validation: 
scalar performance:
{'acc': 0.8143541, 'precision': 0.5260625, 'recall': 0.66577476, 'specificity': 0.66577476, 'f1': 0.50721306, 'auroc': 0.74683034, 'binary_precision': 0.06683401, 'binary_recall': 0.5095694, 'binary_specificity': 0.8219801, 'binary_f1_score': 0.1181692}
confusion matrix:
       0     1
0  13732  2974
1    205   213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8504756, 'precision': 0.6263456, 'recall': 0.7421708, 'specificity': 0.7421708, 'f1': 0.6539881, 'auroc': 0.7859293, 'binary_precision': 0.2893491, 'binary_recall': 0.61355084, 'binary_specificity': 0.8707907, 'binary_f1_score': 0.39324486}
confusion matrix:
      0     1
0  8094  1201
1   308   489
new oracle model saved
early stop counter: 1
val acc:0.8143541216850281, best validation acc: 0.861656129360199, corresponding to test acc:                         0.8338287472724915 / 0.8504756093025208
after epoch: 2,now: 2024-08-09 17:14:55.455904,epoch time: 0:27:50.453734,used: 0:55:37.232269,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9493965, 'precision': 0.9503027, 'recall': 0.9493973, 'specificity': 0.9493973, 'f1': 0.94937104, 'auroc': 0.9888445, 'binary_precision': 0.97051316, 'binary_recall': 0.9269604, 'binary_specificity': 0.97183424, 'binary_f1_score': 0.94823694}
confusion matrix:
       0      1
0  25119    728
1   1888  23961
---- Validation: 
scalar performance:
{'acc': 0.927003, 'precision': 0.5524207, 'recall': 0.63254154, 'specificity': 0.63254154, 'f1': 0.569719, 'auroc': 0.7409109, 'binary_precision': 0.12250454, 'binary_recall': 0.32296652, 'binary_specificity': 0.9421166, 'binary_f1_score': 0.17763157}
confusion matrix:
       0    1
0  15739  967
1    283  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.911415, 'precision': 0.7014874, 'recall': 0.7247798, 'specificity': 0.7247798, 'f1': 0.71226084, 'auroc': 0.82626635, 'binary_precision': 0.44605118, 'binary_recall': 0.50313675, 'binary_specificity': 0.9464228, 'binary_f1_score': 0.47287738}
confusion matrix:
      0    1
0  8797  498
1   396  401
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 17:46:56.280507,epoch time: 0:32:00.824603,used: 1:27:38.056872,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9553544, 'precision': 0.9553789, 'recall': 0.9553551, 'specificity': 0.9553551, 'f1': 0.9553538, 'auroc': 0.9907527, 'binary_precision': 0.9587701, 'binary_recall': 0.9516497, 'binary_specificity': 0.9590605, 'binary_f1_score': 0.9551966}
confusion matrix:
       0      1
0  24785   1058
1   1250  24603
---- Validation: 
scalar performance:
{'acc': 0.90054893, 'precision': 0.5443072, 'recall': 0.659802, 'specificity': 0.659802, 'f1': 0.556771, 'auroc': 0.7562089, 'binary_precision': 0.10461538, 'binary_recall': 0.40669855, 'binary_specificity': 0.9129055, 'binary_f1_score': 0.16642193}
confusion matrix:
       0     1
0  15251  1455
1    248   170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9053706, 'precision': 0.6893023, 'recall': 0.7306754, 'specificity': 0.7306754, 'f1': 0.70713294, 'auroc': 0.828719, 'binary_precision': 0.4203629, 'binary_recall': 0.523212, 'binary_specificity': 0.9381388, 'binary_f1_score': 0.4661822}
confusion matrix:
      0    1
0  8720  575
1   380  417
early stop counter: 1
val acc:0.9005489349365234, best validation acc: 0.927003026008606, corresponding to test acc:                         0.9114149808883667 / 0.9114149808883667
after epoch: 4,now: 2024-08-09 18:16:29.162877,epoch time: 0:29:32.882370,used: 1:57:10.939242,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9591071, 'precision': 0.959568, 'recall': 0.95910895, 'specificity': 0.95910895, 'f1': 0.95909697, 'auroc': 0.99206126, 'binary_precision': 0.974152, 'binary_recall': 0.9432517, 'binary_specificity': 0.97496617, 'binary_f1_score': 0.9584529}
confusion matrix:
       0      1
0  25198    647
1   1467  24384
---- Validation: 
scalar performance:
{'acc': 0.9341859, 'precision': 0.56294554, 'recall': 0.64438653, 'specificity': 0.64438653, 'f1': 0.5834773, 'auroc': 0.78531516, 'binary_precision': 0.143001, 'binary_recall': 0.33971292, 'binary_specificity': 0.9490602, 'binary_f1_score': 0.20127569}
confusion matrix:
       0    1
0  15855  851
1    276  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9140904, 'precision': 0.7050857, 'recall': 0.70673114, 'specificity': 0.70673114, 'f1': 0.70590395, 'auroc': 0.83925855, 'binary_precision': 0.45646766, 'binary_recall': 0.4604768, 'binary_specificity': 0.95298547, 'binary_f1_score': 0.45846346}
confusion matrix:
      0    1
0  8858  437
1   430  367
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 18:45:57.436466,epoch time: 0:29:28.273589,used: 2:26:39.212831,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96378833, 'precision': 0.9637961, 'recall': 0.963788, 'specificity': 0.963788, 'f1': 0.96378815, 'auroc': 0.99340296, 'binary_precision': 0.9619356, 'binary_recall': 0.96580535, 'binary_specificity': 0.9617706, 'binary_f1_score': 0.9638666}
confusion matrix:
       0      1
0  24856    988
1    884  24968
---- Validation: 
scalar performance:
{'acc': 0.90597993, 'precision': 0.5576473, 'recall': 0.70573646, 'specificity': 0.70573646, 'f1': 0.5772913, 'auroc': 0.8045291, 'binary_precision': 0.12889166, 'binary_recall': 0.4952153, 'binary_specificity': 0.9162576, 'binary_f1_score': 0.20454547}
confusion matrix:
       0     1
0  15307  1399
1    211   207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91161317, 'precision': 0.7030649, 'recall': 0.730623, 'specificity': 0.730623, 'f1': 0.7156427, 'auroc': 0.8494009, 'binary_precision': 0.44820064, 'binary_recall': 0.5156838, 'binary_specificity': 0.9455621, 'binary_f1_score': 0.47957993}
confusion matrix:
      0    1
0  8789  506
1   386  411
early stop counter: 1
val acc:0.9059799313545227, best validation acc: 0.9341859221458435, corresponding to test acc:                         0.9140903949737549 / 0.9140903949737549
after epoch: 6,now: 2024-08-09 19:23:46.058948,epoch time: 0:37:48.622482,used: 3:04:27.835313,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95997757, 'precision': 0.9608141, 'recall': 0.9599842, 'specificity': 0.9599842, 'f1': 0.95995975, 'auroc': 0.99318254, 'binary_precision': 0.98052603, 'binary_recall': 0.9386216, 'binary_specificity': 0.9813467, 'binary_f1_score': 0.9591163}
confusion matrix:
       0      1
0  25358    482
1   1587  24269
---- Validation: 
scalar performance:
{'acc': 0.9344195, 'precision': 0.56440127, 'recall': 0.648005, 'specificity': 0.648005, 'f1': 0.5855179, 'auroc': 0.78013825, 'binary_precision': 0.14572865, 'binary_recall': 0.34688994, 'binary_specificity': 0.9491201, 'binary_f1_score': 0.20523709}
confusion matrix:
       0    1
0  15856  850
1    273  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9190448, 'precision': 0.71435595, 'recall': 0.66066813, 'specificity': 0.66066813, 'f1': 0.6824746, 'auroc': 0.82969713, 'binary_precision': 0.48287672, 'binary_recall': 0.35382685, 'binary_specificity': 0.9675094, 'binary_f1_score': 0.40839973}
confusion matrix:
      0    1
0  8993  302
1   515  282
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-09 19:57:49.358694,epoch time: 0:34:03.299746,used: 3:38:31.135059,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9682374, 'precision': 0.96824884, 'recall': 0.9682379, 'specificity': 0.9682379, 'f1': 0.9682372, 'auroc': 0.99420273, 'binary_precision': 0.97060996, 'binary_recall': 0.9657293, 'binary_specificity': 0.97074646, 'binary_f1_score': 0.96816343}
confusion matrix:
       0      1
0  25087    756
1    886  24967
---- Validation: 
scalar performance:
{'acc': 0.91935295, 'precision': 0.5732031, 'recall': 0.7324164, 'specificity': 0.7324164, 'f1': 0.6011721, 'auroc': 0.82191277, 'binary_precision': 0.15875266, 'binary_recall': 0.53588516, 'binary_specificity': 0.9289477, 'binary_f1_score': 0.24494259}
confusion matrix:
       0     1
0  15519  1187
1    194   224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91349584, 'precision': 0.7036993, 'recall': 0.70812905, 'specificity': 0.70812905, 'f1': 0.70588183, 'auroc': 0.8505539, 'binary_precision': 0.45343137, 'binary_recall': 0.4642409, 'binary_specificity': 0.9520172, 'binary_f1_score': 0.45877248}
confusion matrix:
      0    1
0  8849  446
1   427  370
early stop counter: 1
val acc:0.9193529486656189, best validation acc: 0.9344195127487183, corresponding to test acc:                         0.9190447926521301 / 0.9190447926521301
after epoch: 8,now: 2024-08-09 20:27:59.204220,epoch time: 0:30:09.845526,used: 4:08:40.980585,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96941733, 'precision': 0.9696308, 'recall': 0.96941733, 'specificity': 0.96941733, 'f1': 0.9694139, 'auroc': 0.9948921, 'binary_precision': 0.97964185, 'binary_recall': 0.9587589, 'binary_specificity': 0.98007584, 'binary_f1_score': 0.9690879}
confusion matrix:
       0      1
0  25333    515
1   1066  24782
---- Validation: 
scalar performance:
{'acc': 0.933894, 'precision': 0.58547044, 'recall': 0.72120893, 'specificity': 0.72120893, 'f1': 0.61705804, 'auroc': 0.83054984, 'binary_precision': 0.1840708, 'binary_recall': 0.49760765, 'binary_specificity': 0.9448103, 'binary_f1_score': 0.26873386}
confusion matrix:
       0    1
0  15784  922
1    210  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9133968, 'precision': 0.6924402, 'recall': 0.65645486, 'specificity': 0.65645486, 'f1': 0.67195135, 'auroc': 0.845652, 'binary_precision': 0.43956044, 'binary_recall': 0.35131744, 'binary_specificity': 0.96159226, 'binary_f1_score': 0.39051604}
confusion matrix:
      0    1
0  8938  357
1   517  280
early stop counter: 2
val acc:0.9338939785957336, best validation acc: 0.9344195127487183, corresponding to test acc:                         0.9190447926521301 / 0.9190447926521301
after epoch: 9,now: 2024-08-09 20:57:35.685942,epoch time: 0:29:36.481722,used: 4:38:17.462307,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9672508, 'precision': 0.96775216, 'recall': 0.96725464, 'specificity': 0.96725464, 'f1': 0.96724224, 'auroc': 0.9949609, 'binary_precision': 0.98312336, 'binary_recall': 0.95083934, 'binary_specificity': 0.98367, 'binary_f1_score': 0.9667119}
confusion matrix:
       0      1
0  25420    422
1   1271  24583
---- Validation: 
scalar performance:
{'acc': 0.947559, 'precision': 0.6038094, 'recall': 0.7083863, 'specificity': 0.7083863, 'f1': 0.6355995, 'auroc': 0.8246947, 'binary_precision': 0.22157772, 'binary_recall': 0.4569378, 'binary_specificity': 0.9598348, 'binary_f1_score': 0.2984375}
confusion matrix:
       0    1
0  16035  671
1    227  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9142885, 'precision': 0.68963754, 'recall': 0.63342303, 'specificity': 0.63342303, 'f1': 0.65500456, 'auroc': 0.8522945, 'binary_precision': 0.43772894, 'binary_recall': 0.29987454, 'binary_specificity': 0.9669715, 'binary_f1_score': 0.35591957}
confusion matrix:
      0    1
0  8988  307
1   558  239
better model found
persisted
after epoch: 10,now: 2024-08-09 21:26:27.537392,epoch time: 0:28:51.851450,used: 5:07:09.313757,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96738625, 'precision': 0.9677601, 'recall': 0.96739006, 'specificity': 0.96739006, 'f1': 0.9673799, 'auroc': 0.99501723, 'binary_precision': 0.9810517, 'binary_recall': 0.9532005, 'binary_specificity': 0.98157966, 'binary_f1_score': 0.96692556}
confusion matrix:
       0      1
0  25365    476
1   1210  24645
---- Validation: 
scalar performance:
{'acc': 0.9490189, 'precision': 0.60818607, 'recall': 0.71263325, 'specificity': 0.71263325, 'f1': 0.6406137, 'auroc': 0.8254516, 'binary_precision': 0.2301305, 'binary_recall': 0.46411484, 'binary_specificity': 0.96115166, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  16057  649
1    224  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9142885, 'precision': 0.6764548, 'recall': 0.5949945, 'specificity': 0.5949945, 'f1': 0.6194732, 'auroc': 0.8495623, 'binary_precision': 0.41747573, 'binary_recall': 0.21580929, 'binary_specificity': 0.9741797, 'binary_f1_score': 0.28453267}
confusion matrix:
      0    1
0  9055  240
1   625  172
better model found
persisted
after epoch: 11,now: 2024-08-09 21:54:33.877929,epoch time: 0:28:06.340537,used: 5:35:15.654294,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97090685, 'precision': 0.9710295, 'recall': 0.97090876, 'specificity': 0.97090876, 'f1': 0.97090507, 'auroc': 0.9950659, 'binary_precision': 0.97868997, 'binary_recall': 0.9627911, 'binary_specificity': 0.9790264, 'binary_f1_score': 0.9706754}
confusion matrix:
       0      1
0  25300    542
1    962  24892
---- Validation: 
scalar performance:
{'acc': 0.94767576, 'precision': 0.6098616, 'recall': 0.7282723, 'specificity': 0.7282723, 'f1': 0.6449344, 'auroc': 0.834585, 'binary_precision': 0.23266219, 'binary_recall': 0.49760765, 'binary_specificity': 0.9589369, 'binary_f1_score': 0.31707317}
confusion matrix:
       0    1
0  16020  686
1    210  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91567576, 'precision': 0.6985271, 'recall': 0.647368, 'specificity': 0.647368, 'f1': 0.66792333, 'auroc': 0.8587643, 'binary_precision': 0.45328718, 'binary_recall': 0.32873276, 'binary_specificity': 0.96600324, 'binary_f1_score': 0.38109088}
confusion matrix:
      0    1
0  8979  316
1   535  262
early stop counter: 1
val acc:0.9476757645606995, best validation acc: 0.9490188956260681, corresponding to test acc:                         0.9142885208129883 / 0.9190447926521301
after epoch: 12,now: 2024-08-09 22:23:02.499582,epoch time: 0:28:28.621653,used: 6:03:44.275947,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.971255, 'precision': 0.9715692, 'recall': 0.97125804, 'specificity': 0.97125804, 'f1': 0.9712503, 'auroc': 0.99534285, 'binary_precision': 0.9837992, 'binary_recall': 0.95830435, 'binary_specificity': 0.98421174, 'binary_f1_score': 0.9708844}
confusion matrix:
       0      1
0  25434    408
1   1078  24776
---- Validation: 
scalar performance:
{'acc': 0.94995326, 'precision': 0.61809987, 'recall': 0.73993576, 'specificity': 0.73993576, 'f1': 0.65508497, 'auroc': 0.84648645, 'binary_precision': 0.24856816, 'binary_recall': 0.51913875, 'binary_specificity': 0.9607327, 'binary_f1_score': 0.33617347}
confusion matrix:
       0    1
0  16050  656
1    201  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9129013, 'precision': 0.6745833, 'recall': 0.6057126, 'specificity': 0.6057126, 'f1': 0.62879086, 'auroc': 0.85483253, 'binary_precision': 0.41201717, 'binary_recall': 0.24090339, 'binary_specificity': 0.9705218, 'binary_f1_score': 0.30403802}
confusion matrix:
      0    1
0  9021  274
1   605  192
better model found
persisted
after epoch: 13,now: 2024-08-09 22:51:13.465546,epoch time: 0:28:10.965964,used: 6:31:55.241911,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97249305, 'precision': 0.9725561, 'recall': 0.9724937, 'specificity': 0.9724937, 'f1': 0.9724922, 'auroc': 0.9956093, 'binary_precision': 0.9780439, 'binary_recall': 0.96669376, 'binary_specificity': 0.97829366, 'binary_f1_score': 0.97233576}
confusion matrix:
       0      1
0  25284    561
1    861  24990
---- Validation: 
scalar performance:
{'acc': 0.93436116, 'precision': 0.5930271, 'recall': 0.74827194, 'specificity': 0.74827194, 'f1': 0.6284429, 'auroc': 0.8434473, 'binary_precision': 0.19777398, 'binary_recall': 0.55263156, 'binary_specificity': 0.9439124, 'binary_f1_score': 0.29129887}
confusion matrix:
       0    1
0  15769  937
1    187  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121086, 'precision': 0.69487697, 'recall': 0.68386, 'specificity': 0.68386, 'f1': 0.6891508, 'auroc': 0.86836994, 'binary_precision': 0.43983957, 'binary_recall': 0.412798, 'binary_specificity': 0.954922, 'binary_f1_score': 0.42589}
confusion matrix:
      0    1
0  8876  419
1   468  329
early stop counter: 1
val acc:0.9343611598014832, best validation acc: 0.9499532580375671, corresponding to test acc:                         0.9129012823104858 / 0.9190447926521301
after epoch: 14,now: 2024-08-09 23:19:29.880795,epoch time: 0:28:16.415249,used: 7:00:11.657160,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9737504, 'precision': 0.9737743, 'recall': 0.9737496, 'specificity': 0.9737496, 'f1': 0.97375, 'auroc': 0.9964079, 'binary_precision': 0.97046286, 'binary_recall': 0.9772569, 'binary_specificity': 0.97024226, 'binary_f1_score': 0.973848}
confusion matrix:
       0      1
0  25073    769
1    588  25266
---- Validation: 
scalar performance:
{'acc': 0.9286966, 'precision': 0.5914221, 'recall': 0.77102613, 'specificity': 0.77102613, 'f1': 0.6277243, 'auroc': 0.8573097, 'binary_precision': 0.19327731, 'binary_recall': 0.6052632, 'binary_specificity': 0.93678916, 'binary_f1_score': 0.29299363}
confusion matrix:
       0     1
0  15650  1056
1    165   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.910325, 'precision': 0.6903565, 'recall': 0.68575954, 'specificity': 0.68575954, 'f1': 0.6880196, 'auroc': 0.8685188, 'binary_precision': 0.43041238, 'binary_recall': 0.41907153, 'binary_specificity': 0.95244753, 'binary_f1_score': 0.42466626}
confusion matrix:
      0    1
0  8853  442
1   463  334
early stop counter: 2
val acc:0.9286965727806091, best validation acc: 0.9499532580375671, corresponding to test acc:                         0.9129012823104858 / 0.9190447926521301
after epoch: 15,now: 2024-08-09 23:47:21.872580,epoch time: 0:27:51.991785,used: 7:28:03.648945,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_16_19_17_seed_2_24132707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 7:28:03.648945 at 2024-08-09 23:47:21.872580
persisted model performance metric: 

scalar performance:
{'acc': 0.9129013, 'precision': 0.6745833, 'recall': 0.6057126, 'specificity': 0.6057126, 'f1': 0.62879086, 'auroc': 0.85483253, 'binary_precision': 0.41201717, 'binary_recall': 0.24090339, 'binary_specificity': 0.9705218, 'binary_f1_score': 0.30403802}
confusion matrix:
      0    1
0  9021  274
1   605  192
oracle model performance metric: 

scalar performance:
{'acc': 0.9190448, 'precision': 0.71435595, 'recall': 0.66066813, 'specificity': 0.66066813, 'f1': 0.6824746, 'auroc': 0.82969713, 'binary_precision': 0.48287672, 'binary_recall': 0.35382685, 'binary_specificity': 0.9675094, 'binary_f1_score': 0.40839973}
confusion matrix:
      0    1
0  8993  302
1   515  282
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 586359 KiB | 534789 GiB | 534788 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 534035 GiB | 534035 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    753 GiB |    753 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 586359 KiB | 534789 GiB | 534788 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 534035 GiB | 534035 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    753 GiB |    753 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 579948 KiB | 529300 GiB | 529300 GiB |
|       from large pool | 165120 KiB | 508176 KiB | 528569 GiB | 528569 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    730 GiB |    730 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1474 MiB |    862 MiB |
|       from large pool | 550912 KiB | 661504 KiB |   1342 MiB |    804 MiB |
|       from small pool |  75776 KiB |  77824 KiB |    132 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23039 KiB | 174644 KiB | 317394 GiB | 317394 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 316593 GiB | 316593 GiB |
|       from small pool |   7295 KiB |  16938 KiB |    801 GiB |    801 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7211    |  107710 K  |  107705 K  |
|       from large pool |      36    |      76    |   36246 K  |   36246 K  |
|       from small pool |    4650    |    7174    |   71464 K  |   71459 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7211    |  107710 K  |  107705 K  |
|       from large pool |      36    |      76    |   36246 K  |   36246 K  |
|       from small pool |    4650    |    7174    |   71464 K  |   71459 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      98    |      44    |
|       from large pool |      17    |      17    |      32    |      15    |
|       from small pool |      37    |      38    |      66    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3245    |   57560 K  |   57560 K  |
|       from large pool |       3    |      13    |   23969 K  |   23969 K  |
|       from small pool |      28    |    3242    |   33591 K  |   33591 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 586359 KiB | 534789 GiB | 534789 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 534035 GiB | 534035 GiB |
|       from small pool |      0 KiB |  76198 KiB |    753 GiB |    753 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 586359 KiB | 534789 GiB | 534789 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 534035 GiB | 534035 GiB |
|       from small pool |      0 KiB |  76198 KiB |    753 GiB |    753 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 579948 KiB | 529300 GiB | 529300 GiB |
|       from large pool |  16640 KiB | 508176 KiB | 528569 GiB | 528569 GiB |
|       from small pool |      0 KiB |  74518 KiB |    730 GiB |    730 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 739328 KiB |   1474 MiB |   1250 MiB |
|       from large pool | 184320 KiB | 661504 KiB |   1342 MiB |   1162 MiB |
|       from small pool |  45056 KiB |  77824 KiB |    132 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 317394 GiB | 317394 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 316593 GiB | 316593 GiB |
|       from small pool |      0 KiB |  16938 KiB |    801 GiB |    801 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7211    |  107710 K  |  107710 K  |
|       from large pool |       2    |      76    |   36246 K  |   36246 K  |
|       from small pool |       0    |    7174    |   71464 K  |   71464 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7211    |  107710 K  |  107710 K  |
|       from large pool |       2    |      76    |   36246 K  |   36246 K  |
|       from small pool |       0    |    7174    |   71464 K  |   71464 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      55    |      98    |      67    |
|       from large pool |       9    |      17    |      32    |      23    |
|       from small pool |      22    |      38    |      66    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3245    |   57562 K  |   57562 K  |
|       from large pool |       3    |      13    |   23969 K  |   23969 K  |
|       from small pool |       0    |    3242    |   33593 K  |   33593 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug 10 00:05:34 2024]
Finished job 0.
1 of 1 steps (100%) done
