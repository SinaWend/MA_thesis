Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 06:12:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701

 Experiment start at: 2024-08-09 06:19:34.519106
before training, model accuracy: 0.6347637176513672
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.945732, 'precision': 0.94874763, 'recall': 0.94571257, 'specificity': 0.94571257, 'f1': 0.945639, 'auroc': 0.9945773, 'binary_precision': 0.9120791, 'binary_recall': 0.9866219, 'binary_specificity': 0.9048033, 'binary_f1_score': 0.9478873}
confusion matrix:
       0      1
0  22906   2410
1    339  25001
---- Validation: 
scalar performance:
{'acc': 0.890645, 'precision': 0.57441443, 'recall': 0.84057206, 'specificity': 0.84057206, 'f1': 0.5997846, 'auroc': 0.9049713, 'binary_precision': 0.15468307, 'binary_recall': 0.7879518, 'binary_specificity': 0.8931923, 'binary_f1_score': 0.25860023}
confusion matrix:
       0     1
0  14944  1787
1     88   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9088392, 'precision': 0.68650484, 'recall': 0.7135885, 'specificity': 0.7135885, 'f1': 0.69878274, 'auroc': 0.8796105, 'binary_precision': 0.41629463, 'binary_recall': 0.48316061, 'binary_specificity': 0.9440163, 'binary_f1_score': 0.4472422}
confusion matrix:
      0    1
0  8819  523
1   399  373
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 06:36:48.592976,epoch time: 0:17:14.073870,used: 0:17:14.073870,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9756988, 'precision': 0.97569877, 'recall': 0.97569895, 'specificity': 0.97569895, 'f1': 0.9756988, 'auroc': 0.99682903, 'binary_precision': 0.97592264, 'binary_recall': 0.9754991, 'binary_specificity': 0.97589886, 'binary_f1_score': 0.9757108}
confusion matrix:
       0      1
0  24700    610
1    621  24725
---- Validation: 
scalar performance:
{'acc': 0.9657063, 'precision': 0.68611246, 'recall': 0.81911194, 'specificity': 0.81911194, 'f1': 0.733237, 'auroc': 0.9176371, 'binary_precision': 0.38068965, 'binary_recall': 0.6650602, 'binary_specificity': 0.9731636, 'binary_f1_score': 0.48421052}
confusion matrix:
       0    1
0  16282  449
1    139  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210006, 'precision': 0.6901589, 'recall': 0.56628764, 'specificity': 0.56628764, 'f1': 0.5901967, 'auroc': 0.9120134, 'binary_precision': 0.44705883, 'binary_recall': 0.14766839, 'binary_specificity': 0.98490685, 'binary_f1_score': 0.22200584}
confusion matrix:
      0    1
0  9201  141
1   658  114
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 06:53:16.962949,epoch time: 0:16:28.369973,used: 0:33:42.443843,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9760147, 'precision': 0.97623765, 'recall': 0.97600836, 'specificity': 0.97600836, 'f1': 0.97601163, 'auroc': 0.99796844, 'binary_precision': 0.9660794, 'binary_recall': 0.98670244, 'binary_specificity': 0.96531427, 'binary_f1_score': 0.976282}
confusion matrix:
       0      1
0  24435    878
1    337  25006
---- Validation: 
scalar performance:
{'acc': 0.9567246, 'precision': 0.6584873, 'recall': 0.84388304, 'specificity': 0.84388304, 'f1': 0.71269816, 'auroc': 0.92544544, 'binary_precision': 0.3240043, 'binary_recall': 0.7253012, 'binary_specificity': 0.96246487, 'binary_f1_score': 0.44791666}
confusion matrix:
       0    1
0  16103  628
1    114  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.919913, 'precision': 0.669651, 'recall': 0.54846865, 'specificity': 0.54846865, 'f1': 0.56569356, 'auroc': 0.91006434, 'binary_precision': 0.40865386, 'binary_recall': 0.11010363, 'binary_specificity': 0.98683363, 'binary_f1_score': 0.1734694}
confusion matrix:
      0    1
0  9219  123
1   687   85
early stop counter: 1
val acc:0.9567245841026306, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.921000599861145
after epoch: 3,now: 2024-08-09 07:09:43.347438,epoch time: 0:16:26.384489,used: 0:50:08.828332,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9672694, 'precision': 0.9685365, 'recall': 0.9672582, 'specificity': 0.9672582, 'f1': 0.9672467, 'auroc': 0.9983239, 'binary_precision': 0.9442798, 'binary_recall': 0.9931726, 'binary_specificity': 0.9413438, 'binary_f1_score': 0.96810925}
confusion matrix:
       0      1
0  23832   1485
1    173  25166
---- Validation: 
scalar performance:
{'acc': 0.9438353, 'precision': 0.62682873, 'recall': 0.83492863, 'specificity': 0.83492863, 'f1': 0.6768331, 'auroc': 0.90780073, 'binary_precision': 0.2609075, 'binary_recall': 0.72048193, 'binary_specificity': 0.9493754, 'binary_f1_score': 0.38308778}
confusion matrix:
       0    1
0  15884  847
1    116  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210995, 'precision': 0.6576083, 'recall': 0.525345, 'specificity': 0.525345, 'f1': 0.53004485, 'auroc': 0.89934266, 'binary_precision': 0.38793105, 'binary_recall': 0.058290154, 'binary_specificity': 0.99239993, 'binary_f1_score': 0.10135135}
confusion matrix:
      0   1
0  9271  71
1   727  45
new oracle model saved
early stop counter: 2
val acc:0.9438353180885315, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9210994839668274
after epoch: 4,now: 2024-08-09 07:26:33.389993,epoch time: 0:16:50.042555,used: 1:06:58.870887,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9467388, 'precision': 0.9512397, 'recall': 0.94670534, 'specificity': 0.94670534, 'f1': 0.9466028, 'auroc': 0.99848044, 'binary_precision': 0.90634084, 'binary_recall': 0.9965279, 'binary_specificity': 0.8968828, 'binary_f1_score': 0.9492972}
confusion matrix:
       0      1
0  22701   2610
1     88  25257
---- Validation: 
scalar performance:
{'acc': 0.8655663, 'precision': 0.56179416, 'recall': 0.8312465, 'specificity': 0.8312465, 'f1': 0.57450914, 'auroc': 0.901522, 'binary_precision': 0.12941177, 'binary_recall': 0.79518074, 'binary_specificity': 0.8673122, 'binary_f1_score': 0.22259699}
confusion matrix:
       0     1
0  14511  2220
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92119837, 'precision': 0.6879523, 'recall': 0.5574825, 'specificity': 0.5574825, 'f1': 0.57877785, 'auroc': 0.89564824, 'binary_precision': 0.44394618, 'binary_recall': 0.12823834, 'binary_specificity': 0.9867266, 'binary_f1_score': 0.19899496}
confusion matrix:
      0    1
0  9218  124
1   673   99
new oracle model saved
early stop counter: 3
val acc:0.8655663132667542, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9211983680725098
after epoch: 5,now: 2024-08-09 07:43:22.647181,epoch time: 0:16:49.257188,used: 1:23:48.128075,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95122, 'precision': 0.9549366, 'recall': 0.95119506, 'specificity': 0.95119506, 'f1': 0.9511183, 'auroc': 0.99855614, 'binary_precision': 0.91395473, 'binary_recall': 0.99629074, 'binary_specificity': 0.9060994, 'binary_f1_score': 0.95334834}
confusion matrix:
       0      1
0  22937   2377
1     94  25248
---- Validation: 
scalar performance:
{'acc': 0.88702905, 'precision': 0.5682657, 'recall': 0.8152205, 'specificity': 0.8152205, 'f1': 0.58983237, 'auroc': 0.89440864, 'binary_precision': 0.14372659, 'binary_recall': 0.739759, 'binary_specificity': 0.890682, 'binary_f1_score': 0.24068992}
confusion matrix:
       0     1
0  14902  1829
1    108   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92396677, 'precision': 0.72952294, 'recall': 0.5144201, 'specificity': 0.5144201, 'f1': 0.50956744, 'auroc': 0.88250077, 'binary_precision': 0.53333336, 'binary_recall': 0.031088082, 'binary_specificity': 0.9977521, 'binary_f1_score': 0.05875153}
confusion matrix:
      0   1
0  9321  21
1   748  24
new oracle model saved
early stop counter: 4
val acc:0.8870290517807007, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 6,now: 2024-08-09 07:59:41.173358,epoch time: 0:16:18.526177,used: 1:40:06.654252,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94989735, 'precision': 0.9540479, 'recall': 0.94986534, 'specificity': 0.94986534, 'f1': 0.9497801, 'auroc': 0.99865985, 'binary_precision': 0.9108037, 'binary_recall': 0.99755377, 'binary_specificity': 0.9021769, 'binary_f1_score': 0.952207}
confusion matrix:
       0      1
0  22835   2476
1     62  25283
---- Validation: 
scalar performance:
{'acc': 0.8621253, 'precision': 0.5620802, 'recall': 0.8412326, 'specificity': 0.8412326, 'f1': 0.5738687, 'auroc': 0.9018899, 'binary_precision': 0.12932675, 'binary_recall': 0.8192771, 'binary_specificity': 0.8631881, 'binary_f1_score': 0.22339028}
confusion matrix:
       0     1
0  14442  2289
1     75   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92179155, 'precision': 0.6598711, 'recall': 0.51977825, 'specificity': 0.51977825, 'f1': 0.5202291, 'auroc': 0.9006156, 'binary_precision': 0.39325842, 'binary_recall': 0.045336787, 'binary_specificity': 0.99421966, 'binary_f1_score': 0.08130082}
confusion matrix:
      0   1
0  9288  54
1   737  35
early stop counter: 5
val acc:0.8621252775192261, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 7,now: 2024-08-09 08:16:16.048376,epoch time: 0:16:34.875018,used: 1:56:41.529270,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9486734, 'precision': 0.9531563, 'recall': 0.9486421, 'specificity': 0.9486421, 'f1': 0.9485436, 'auroc': 0.9988992, 'binary_precision': 0.9082424, 'binary_recall': 0.9982639, 'binary_specificity': 0.89902025, 'binary_f1_score': 0.9511278}
confusion matrix:
       0      1
0  22756   2556
1     44  25300
---- Validation: 
scalar performance:
{'acc': 0.8245072, 'precision': 0.5478055, 'recall': 0.8113826, 'specificity': 0.8113826, 'f1': 0.5410332, 'auroc': 0.8830383, 'binary_precision': 0.10165848, 'binary_recall': 0.7975904, 'binary_specificity': 0.8251748, 'binary_f1_score': 0.18033233}
confusion matrix:
       0     1
0  13806  2925
1     84   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91714454, 'precision': 0.6336484, 'recall': 0.53746367, 'specificity': 0.53746367, 'f1': 0.5489328, 'auroc': 0.8731353, 'binary_precision': 0.3382353, 'binary_recall': 0.08937824, 'binary_specificity': 0.98554915, 'binary_f1_score': 0.14139344}
confusion matrix:
      0    1
0  9207  135
1   703   69
early stop counter: 6
val acc:0.8245071768760681, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 8,now: 2024-08-09 08:34:01.358560,epoch time: 0:17:45.310184,used: 2:14:26.839454,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94729155, 'precision': 0.9518945, 'recall': 0.9472637, 'specificity': 0.9472637, 'f1': 0.94715464, 'auroc': 0.998677, 'binary_precision': 0.90642476, 'binary_recall': 0.9976324, 'binary_specificity': 0.896895, 'binary_f1_score': 0.94984406}
confusion matrix:
       0      1
0  22704   2610
1     60  25282
---- Validation: 
scalar performance:
{'acc': 0.83512187, 'precision': 0.5506912, 'recall': 0.81564665, 'specificity': 0.81564665, 'f1': 0.54875183, 'auroc': 0.8744267, 'binary_precision': 0.107421875, 'binary_recall': 0.79518074, 'binary_specificity': 0.8361126, 'binary_f1_score': 0.18927445}
confusion matrix:
       0     1
0  13989  2742
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9188254, 'precision': 0.6398746, 'recall': 0.53183794, 'specificity': 0.53183794, 'f1': 0.5406203, 'auroc': 0.87276745, 'binary_precision': 0.35151514, 'binary_recall': 0.07512953, 'binary_specificity': 0.9885464, 'binary_f1_score': 0.123799354}
confusion matrix:
      0    1
0  9235  107
1   714   58
early stop counter: 7
val acc:0.8351218700408936, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 9,now: 2024-08-09 08:51:11.344015,epoch time: 0:17:09.985455,used: 2:31:36.824909,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9449029, 'precision': 0.95001376, 'recall': 0.94487345, 'specificity': 0.94487345, 'f1': 0.9447434, 'auroc': 0.99875504, 'binary_precision': 0.90219367, 'binary_recall': 0.9980664, 'binary_specificity': 0.8916805, 'binary_f1_score': 0.9477115}
confusion matrix:
       0      1
0  22572   2742
1     49  25293
---- Validation: 
scalar performance:
{'acc': 0.7421556, 'precision': 0.53626144, 'recall': 0.80678344, 'specificity': 0.80678344, 'f1': 0.4946816, 'auroc': 0.8824556, 'binary_precision': 0.07671175, 'binary_recall': 0.8746988, 'binary_specificity': 0.738868, 'binary_f1_score': 0.14105304}
confusion matrix:
       0     1
0  12362  4369
1     52   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210995, 'precision': 0.64830136, 'recall': 0.52059186, 'specificity': 0.52059186, 'f1': 0.52181745, 'auroc': 0.8687148, 'binary_precision': 0.37, 'binary_recall': 0.04792746, 'binary_specificity': 0.9932563, 'binary_f1_score': 0.08486238}
confusion matrix:
      0   1
0  9279  63
1   735  37
early stop counter: 8
val acc:0.7421556115150452, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 10,now: 2024-08-09 09:07:14.489630,epoch time: 0:16:03.145615,used: 2:47:39.970524,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.952819, 'precision': 0.9564832, 'recall': 0.95279074, 'specificity': 0.95279074, 'f1': 0.9527221, 'auroc': 0.99865687, 'binary_precision': 0.91574293, 'binary_recall': 0.99747473, 'binary_specificity': 0.9081068, 'binary_f1_score': 0.9548631}
confusion matrix:
       0      1
0  22986   2326
1     64  25280
---- Validation: 
scalar performance:
{'acc': 0.85145223, 'precision': 0.5510925, 'recall': 0.78994125, 'specificity': 0.78994125, 'f1': 0.5546939, 'auroc': 0.8720349, 'binary_precision': 0.1100951, 'binary_recall': 0.7253012, 'binary_specificity': 0.8545813, 'binary_f1_score': 0.1911718}
confusion matrix:
       0     1
0  14298  2433
1    114   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9200119, 'precision': 0.62503797, 'recall': 0.51822066, 'specificity': 0.51822066, 'f1': 0.5178652, 'auroc': 0.8420578, 'binary_precision': 0.32380953, 'binary_recall': 0.04404145, 'binary_specificity': 0.99239993, 'binary_f1_score': 0.07753706}
confusion matrix:
      0   1
0  9271  71
1   738  34
early stop counter: 9
val acc:0.8514522314071655, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 11,now: 2024-08-09 09:24:18.628171,epoch time: 0:17:04.138541,used: 3:04:44.109065,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9360589, 'precision': 0.9429321, 'recall': 0.93602455, 'specificity': 0.93602455, 'f1': 0.93580645, 'auroc': 0.99861693, 'binary_precision': 0.88789445, 'binary_recall': 0.9982243, 'binary_specificity': 0.8738248, 'binary_f1_score': 0.9398325}
confusion matrix:
       0      1
0  22120   3194
1     45  25297
---- Validation: 
scalar performance:
{'acc': 0.8421206, 'precision': 0.54697335, 'recall': 0.77811015, 'specificity': 0.77811015, 'f1': 0.54580694, 'auroc': 0.86378515, 'binary_precision': 0.10235947, 'binary_recall': 0.7108434, 'binary_specificity': 0.84537685, 'binary_f1_score': 0.17895058}
confusion matrix:
       0     1
0  14144  2587
1    120   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91200316, 'precision': 0.5831624, 'recall': 0.52576834, 'specificity': 0.52576834, 'f1': 0.5309673, 'auroc': 0.7825222, 'binary_precision': 0.23893805, 'binary_recall': 0.06994819, 'binary_specificity': 0.98158854, 'binary_f1_score': 0.10821644}
confusion matrix:
      0    1
0  9170  172
1   718   54
early stop counter: 10
val acc:0.8421205878257751, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 12,now: 2024-08-09 09:40:48.921467,epoch time: 0:16:30.293296,used: 3:21:14.402361,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9333149, 'precision': 0.94080794, 'recall': 0.93326604, 'specificity': 0.93326604, 'f1': 0.9330251, 'auroc': 0.9982873, 'binary_precision': 0.88352364, 'binary_recall': 0.998343, 'binary_specificity': 0.86818916, 'binary_f1_score': 0.9374305}
confusion matrix:
       0      1
0  21973   3336
1     42  25305
---- Validation: 
scalar performance:
{'acc': 0.8264318, 'precision': 0.54817426, 'recall': 0.8111938, 'specificity': 0.8111938, 'f1': 0.5422205, 'auroc': 0.87738353, 'binary_precision': 0.10245266, 'binary_recall': 0.79518074, 'binary_specificity': 0.82720697, 'binary_f1_score': 0.18151817}
confusion matrix:
       0     1
0  13840  2891
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9165513, 'precision': 0.5994649, 'recall': 0.5216948, 'specificity': 0.5216948, 'f1': 0.524369, 'auroc': 0.8216301, 'binary_precision': 0.2721519, 'binary_recall': 0.055699483, 'binary_specificity': 0.98769003, 'binary_f1_score': 0.09247313}
confusion matrix:
      0    1
0  9227  115
1   729   43
early stop counter: 11
val acc:0.8264318108558655, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 13,now: 2024-08-09 09:56:58.831685,epoch time: 0:16:09.910218,used: 3:37:24.312579,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9242933, 'precision': 0.9337808, 'recall': 0.9242466, 'specificity': 0.9242466, 'f1': 0.9238714, 'auroc': 0.9976619, 'binary_precision': 0.8697865, 'binary_recall': 0.99810606, 'binary_specificity': 0.85038716, 'binary_f1_score': 0.9295387}
confusion matrix:
       0      1
0  21525   3787
1     48  25296
---- Validation: 
scalar performance:
{'acc': 0.77948207, 'precision': 0.53675187, 'recall': 0.7789122, 'specificity': 0.7789122, 'f1': 0.5096598, 'auroc': 0.843915, 'binary_precision': 0.08050848, 'binary_recall': 0.7783133, 'binary_specificity': 0.7795111, 'binary_f1_score': 0.14592277}
confusion matrix:
       0     1
0  13042  3689
1     92   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91131103, 'precision': 0.5733171, 'recall': 0.52242297, 'specificity': 0.52242297, 'f1': 0.52592695, 'auroc': 0.80479133, 'binary_precision': 0.21973094, 'binary_recall': 0.0634715, 'binary_specificity': 0.98137444, 'binary_f1_score': 0.098492466}
confusion matrix:
      0    1
0  9168  174
1   723   49
early stop counter: 12
val acc:0.7794820666313171, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 14,now: 2024-08-09 10:13:17.195015,epoch time: 0:16:18.363330,used: 3:53:42.675909,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9217467, 'precision': 0.932073, 'recall': 0.9216918, 'specificity': 0.9216918, 'f1': 0.9212694, 'auroc': 0.9982898, 'binary_precision': 0.8654543, 'binary_recall': 0.9988953, 'binary_specificity': 0.8444883, 'binary_f1_score': 0.9273993}
confusion matrix:
       0      1
0  21374   3936
1     28  25318
---- Validation: 
scalar performance:
{'acc': 0.736265, 'precision': 0.53000534, 'recall': 0.7544178, 'specificity': 0.7544178, 'f1': 0.48453823, 'auroc': 0.8333667, 'binary_precision': 0.06759318, 'binary_recall': 0.773494, 'binary_specificity': 0.7353416, 'binary_f1_score': 0.124322236}
confusion matrix:
       0     1
0  12303  4428
1     94   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9009294, 'precision': 0.53319794, 'recall': 0.5144266, 'specificity': 0.5144266, 'f1': 0.51502776, 'auroc': 0.727749, 'binary_precision': 0.140625, 'binary_recall': 0.058290154, 'binary_specificity': 0.97056305, 'binary_f1_score': 0.08241758}
confusion matrix:
      0    1
0  9067  275
1   727   45
early stop counter: 13
val acc:0.7362650036811829, best validation acc: 0.9657062888145447, corresponding to test acc:                         0.921000599861145 / 0.9239667654037476
after epoch: 15,now: 2024-08-09 10:30:02.142696,epoch time: 0:16:44.947681,used: 4:10:27.623590,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_06_19_34_seed_0_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:10:27.623590 at 2024-08-09 10:30:02.142696
persisted model performance metric: 

scalar performance:
{'acc': 0.9210006, 'precision': 0.6901589, 'recall': 0.56628764, 'specificity': 0.56628764, 'f1': 0.5901967, 'auroc': 0.9120134, 'binary_precision': 0.44705883, 'binary_recall': 0.14766839, 'binary_specificity': 0.98490685, 'binary_f1_score': 0.22200584}
confusion matrix:
      0    1
0  9201  141
1   658  114
oracle model performance metric: 

scalar performance:
{'acc': 0.92396677, 'precision': 0.72952294, 'recall': 0.5144201, 'specificity': 0.5144201, 'f1': 0.50956744, 'auroc': 0.88250077, 'binary_precision': 0.53333336, 'binary_recall': 0.031088082, 'binary_specificity': 0.9977521, 'binary_f1_score': 0.05875153}
confusion matrix:
      0   1
0  9321  21
1   748  24
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493870 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool | 403328 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |  90542 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493870 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool | 403328 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |  90542 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476753 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |  88913 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11490 MiB |  11490 MiB |  11490 MiB |      0 B   |
|       from large pool |  11362 MiB |  11362 MiB |  11362 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 751313 KiB |   1257 MiB | 127124 GiB | 127124 GiB |
|       from large pool | 741504 KiB |   1255 MiB | 126061 GiB | 126060 GiB |
|       from small pool |   9809 KiB |     10 MiB |   1063 GiB |   1063 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5175    |    7578    |   56675 K  |   56670 K  |
|       from large pool |      87    |     908    |   21002 K  |   21002 K  |
|       from small pool |    5088    |    7489    |   35672 K  |   35667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5175    |    7578    |   56675 K  |   56670 K  |
|       from large pool |      87    |     908    |   21002 K  |   21002 K  |
|       from small pool |    5088    |    7489    |   35672 K  |   35667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     408    |     408    |       0    |
|       from large pool |     344    |     344    |     344    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    3196    |   30746 K  |   30746 K  |
|       from large pool |      19    |     189    |   13629 K  |   13629 K  |
|       from small pool |      50    |    3175    |   17117 K  |   17117 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |      0 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11490 MiB |  11490 MiB |  10274 MiB |
|       from large pool |   1118 MiB |  11362 MiB |  11362 MiB |  10244 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1257 MiB | 127125 GiB | 127125 GiB |
|       from large pool |  50944 KiB |   1255 MiB | 126061 GiB | 126061 GiB |
|       from small pool |      0 KiB |     24 MiB |   1063 GiB |   1063 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56675 K  |   56675 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35672 K  |   35672 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56675 K  |   56675 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35672 K  |   35672 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     408    |     408    |     329    |
|       from large pool |      30    |     344    |     344    |     314    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3196    |   30749 K  |   30749 K  |
|       from large pool |       4    |     189    |   13629 K  |   13629 K  |
|       from small pool |       0    |    3175    |   17119 K  |   17119 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |      0 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11490 MiB |  11490 MiB |  10274 MiB |
|       from large pool |   1118 MiB |  11362 MiB |  11362 MiB |  10244 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1257 MiB | 127125 GiB | 127125 GiB |
|       from large pool |  50944 KiB |   1255 MiB | 126061 GiB | 126061 GiB |
|       from small pool |      0 KiB |     24 MiB |   1063 GiB |   1063 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56675 K  |   56675 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35672 K  |   35672 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56675 K  |   56675 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35672 K  |   35672 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     408    |     408    |     329    |
|       from large pool |      30    |     344    |     344    |     314    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3196    |   30749 K  |   30749 K  |
|       from large pool |       4    |     189    |   13629 K  |   13629 K  |
|       from small pool |       0    |    3175    |   17119 K  |   17119 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701

 Experiment start at: 2024-08-09 10:51:12.459302
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96508104, 'precision': 0.96575063, 'recall': 0.9650961, 'specificity': 0.9650961, 'f1': 0.9650693, 'auroc': 0.99268556, 'binary_precision': 0.9836079, 'binary_recall': 0.9459821, 'binary_specificity': 0.98421013, 'binary_f1_score': 0.9644282}
confusion matrix:
       0      1
0  24995    401
1   1374  24062
---- Validation: 
scalar performance:
{'acc': 0.9591193, 'precision': 0.63657385, 'recall': 0.6987575, 'specificity': 0.6987575, 'f1': 0.66112125, 'auroc': 0.818054, 'binary_precision': 0.28818896, 'binary_recall': 0.42459396, 'binary_specificity': 0.97292113, 'binary_f1_score': 0.34333956}
confusion matrix:
       0    1
0  16240  452
1    248  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92458624, 'precision': 0.7229786, 'recall': 0.6672996, 'specificity': 0.6672996, 'f1': 0.69004023, 'auroc': 0.89653957, 'binary_precision': 0.4964029, 'binary_recall': 0.36459708, 'binary_specificity': 0.9700021, 'binary_f1_score': 0.4204113}
confusion matrix:
      0    1
0  9054  280
1   481  276
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 11:09:22.070455,epoch time: 0:18:09.611153,used: 0:18:09.611153,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94615597, 'precision': 0.9496825, 'recall': 0.94611776, 'specificity': 0.94611776, 'f1': 0.94604695, 'auroc': 0.9955554, 'binary_precision': 0.91007626, 'binary_recall': 0.9902508, 'binary_specificity': 0.9019847, 'binary_f1_score': 0.94847226}
confusion matrix:
       0      1
0  22905   2489
1    248  25190
---- Validation: 
scalar performance:
{'acc': 0.87835073, 'precision': 0.5703773, 'recall': 0.83815265, 'specificity': 0.83815265, 'f1': 0.5907838, 'auroc': 0.8937924, 'binary_precision': 0.14670658, 'binary_recall': 0.7958237, 'binary_specificity': 0.88048166, 'binary_f1_score': 0.24774286}
confusion matrix:
       0     1
0  14697  1995
1     88   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9205232, 'precision': 0.6931571, 'recall': 0.6092654, 'specificity': 0.6092654, 'f1': 0.636173, 'auroc': 0.8961704, 'binary_precision': 0.44552058, 'binary_recall': 0.24306473, 'binary_specificity': 0.975466, 'binary_f1_score': 0.31452993}
confusion matrix:
      0    1
0  9105  229
1   573  184
early stop counter: 1
val acc:0.8783507347106934, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9245862364768982
after epoch: 2,now: 2024-08-09 11:27:08.311578,epoch time: 0:17:46.241123,used: 0:35:55.852276,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93826723, 'precision': 0.943851, 'recall': 0.9382232, 'specificity': 0.9382232, 'f1': 0.93806815, 'auroc': 0.9958048, 'binary_precision': 0.8942641, 'binary_recall': 0.99418145, 'binary_specificity': 0.8822649, 'binary_f1_score': 0.94157946}
confusion matrix:
       0      1
0  22406   2990
1    148  25288
---- Validation: 
scalar performance:
{'acc': 0.85329676, 'precision': 0.55874515, 'recall': 0.824172, 'specificity': 0.824172, 'f1': 0.5665579, 'auroc': 0.8796996, 'binary_precision': 0.123688966, 'binary_recall': 0.79350346, 'binary_specificity': 0.85484064, 'binary_f1_score': 0.21401751}
confusion matrix:
       0     1
0  14269  2423
1     89   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92002773, 'precision': 0.6805159, 'recall': 0.58229244, 'specificity': 0.58229244, 'f1': 0.60766363, 'auroc': 0.890556, 'binary_precision': 0.42424244, 'binary_recall': 0.18494056, 'binary_specificity': 0.9796443, 'binary_f1_score': 0.2575897}
confusion matrix:
      0    1
0  9144  190
1   617  140
early stop counter: 2
val acc:0.8532967567443848, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9245862364768982
after epoch: 3,now: 2024-08-09 11:44:55.062297,epoch time: 0:17:46.750719,used: 0:53:42.602995,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94157225, 'precision': 0.9466305, 'recall': 0.94153047, 'specificity': 0.94153047, 'f1': 0.94140244, 'auroc': 0.99656, 'binary_precision': 0.89929616, 'binary_recall': 0.99461395, 'binary_specificity': 0.888447, 'binary_f1_score': 0.9445564}
confusion matrix:
       0      1
0  22563   2833
1    137  25299
---- Validation: 
scalar performance:
{'acc': 0.8569176, 'precision': 0.56120807, 'recall': 0.83281004, 'specificity': 0.83281004, 'f1': 0.57122755, 'auroc': 0.8859153, 'binary_precision': 0.1281768, 'binary_recall': 0.8074246, 'binary_specificity': 0.85819554, 'binary_f1_score': 0.2212333}
confusion matrix:
       0     1
0  14325  2367
1     83   348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92488354, 'precision': 0.7105901, 'recall': 0.52179605, 'specificity': 0.52179605, 'f1': 0.5237889, 'auroc': 0.8842866, 'binary_precision': 0.49315068, 'binary_recall': 0.047556143, 'binary_specificity': 0.996036, 'binary_f1_score': 0.08674699}
confusion matrix:
      0   1
0  9297  37
1   721  36
new oracle model saved
early stop counter: 3
val acc:0.8569176197052002, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9248835444450378
after epoch: 4,now: 2024-08-09 12:02:13.932283,epoch time: 0:17:18.869986,used: 1:11:01.472981,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93917215, 'precision': 0.94485545, 'recall': 0.9391278, 'specificity': 0.9391278, 'f1': 0.93897307, 'auroc': 0.9965358, 'binary_precision': 0.8947703, 'binary_recall': 0.99551815, 'binary_specificity': 0.88273746, 'binary_f1_score': 0.94245946}
confusion matrix:
       0      1
0  22418   2978
1    114  25322
---- Validation: 
scalar performance:
{'acc': 0.8545232, 'precision': 0.5600763, 'recall': 0.83045185, 'specificity': 0.83045185, 'f1': 0.5688497, 'auroc': 0.8860171, 'binary_precision': 0.12599854, 'binary_recall': 0.80510443, 'binary_specificity': 0.8557992, 'binary_f1_score': 0.21789639}
confusion matrix:
       0     1
0  14285  2407
1     84   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92518085, 'precision': 0.73573256, 'recall': 0.5073904, 'specificity': 0.5073904, 'f1': 0.49594864, 'auroc': 0.8580972, 'binary_precision': 0.54545456, 'binary_recall': 0.015852047, 'binary_specificity': 0.99892867, 'binary_f1_score': 0.030808728}
confusion matrix:
      0   1
0  9324  10
1   745  12
new oracle model saved
early stop counter: 4
val acc:0.8545231819152832, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9251808524131775
after epoch: 5,now: 2024-08-09 12:19:17.598590,epoch time: 0:17:03.666307,used: 1:28:05.139288,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9502872, 'precision': 0.9536988, 'recall': 0.95025325, 'specificity': 0.95025325, 'f1': 0.9501909, 'auroc': 0.9969989, 'binary_precision': 0.9145525, 'binary_recall': 0.9934738, 'binary_specificity': 0.9070326, 'binary_f1_score': 0.95238096}
confusion matrix:
       0      1
0  23035   2361
1    166  25270
---- Validation: 
scalar performance:
{'acc': 0.86468494, 'precision': 0.55807966, 'recall': 0.7961091, 'specificity': 0.7961091, 'f1': 0.5690795, 'auroc': 0.86529344, 'binary_precision': 0.12430279, 'binary_recall': 0.72389793, 'binary_specificity': 0.86832017, 'binary_f1_score': 0.21217273}
confusion matrix:
       0     1
0  14494  2198
1    119   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92528, 'precision': 0.7628821, 'recall': 0.5056231, 'specificity': 0.5056231, 'f1': 0.4922351, 'auroc': 0.8333155, 'binary_precision': 0.6, 'binary_recall': 0.011889036, 'binary_specificity': 0.99935716, 'binary_f1_score': 0.023316063}
confusion matrix:
      0  1
0  9328  6
1   748  9
new oracle model saved
early stop counter: 5
val acc:0.8646849393844604, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.925279974937439
after epoch: 6,now: 2024-08-09 12:36:39.081098,epoch time: 0:17:21.482508,used: 1:45:26.621796,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9360049, 'precision': 0.9426868, 'recall': 0.9359518, 'specificity': 0.9359518, 'f1': 0.93575704, 'auroc': 0.9972433, 'binary_precision': 0.8885153, 'binary_recall': 0.99724823, 'binary_specificity': 0.8746554, 'binary_f1_score': 0.939747}
confusion matrix:
       0      1
0  22211   3183
1     70  25368
---- Validation: 
scalar performance:
{'acc': 0.8217602, 'precision': 0.5509934, 'recall': 0.8260789, 'specificity': 0.8260789, 'f1': 0.5449417, 'auroc': 0.8678855, 'binary_precision': 0.10728199, 'binary_recall': 0.8306264, 'binary_specificity': 0.8215313, 'binary_f1_score': 0.19002123}
confusion matrix:
       0     1
0  13713  2979
1     73   358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.7280338, 'recall': 0.5300076, 'specificity': 0.5300076, 'f1': 0.5381974, 'auroc': 0.8440248, 'binary_precision': 0.5268817, 'binary_recall': 0.06472919, 'binary_specificity': 0.99528605, 'binary_f1_score': 0.115294114}
confusion matrix:
      0   1
0  9290  44
1   708  49
new oracle model saved
early stop counter: 6
val acc:0.8217601776123047, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9254781603813171
after epoch: 7,now: 2024-08-09 12:53:28.950423,epoch time: 0:16:49.869325,used: 2:02:16.491121,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9426149, 'precision': 0.9480268, 'recall': 0.9425739, 'specificity': 0.9425739, 'f1': 0.94243735, 'auroc': 0.99782753, 'binary_precision': 0.89897233, 'binary_recall': 0.9974052, 'binary_specificity': 0.88774264, 'binary_f1_score': 0.9456341}
confusion matrix:
       0      1
0  22546   2851
1     66  25369
---- Validation: 
scalar performance:
{'acc': 0.8353092, 'precision': 0.55312395, 'recall': 0.8194666, 'specificity': 0.8194666, 'f1': 0.5526418, 'auroc': 0.87022793, 'binary_precision': 0.1123012, 'binary_recall': 0.8027842, 'binary_specificity': 0.83614904, 'binary_f1_score': 0.19703871}
confusion matrix:
       0     1
0  13957  2735
1     85   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92518085, 'precision': 0.72796535, 'recall': 0.5110319, 'specificity': 0.5110319, 'f1': 0.5032882, 'auroc': 0.83128357, 'binary_precision': 0.5294118, 'binary_recall': 0.023778072, 'binary_specificity': 0.99828583, 'binary_f1_score': 0.04551201}
confusion matrix:
      0   1
0  9318  16
1   739  18
early stop counter: 7
val acc:0.8353092074394226, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9254781603813171
after epoch: 8,now: 2024-08-09 13:10:10.859900,epoch time: 0:16:41.909477,used: 2:18:58.400598,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9248111, 'precision': 0.9340354, 'recall': 0.9247625, 'specificity': 0.9247625, 'f1': 0.92440367, 'auroc': 0.9951889, 'binary_precision': 0.8709279, 'binary_recall': 0.9975622, 'binary_specificity': 0.8519627, 'binary_f1_score': 0.9299538}
confusion matrix:
       0      1
0  21639   3760
1     62  25371
---- Validation: 
scalar performance:
{'acc': 0.8087368, 'precision': 0.5423141, 'recall': 0.77984416, 'specificity': 0.77984416, 'f1': 0.5283786, 'auroc': 0.83453023, 'binary_precision': 0.09255014, 'binary_recall': 0.7494199, 'binary_specificity': 0.8102684, 'binary_f1_score': 0.16475388}
confusion matrix:
       0     1
0  13525  3167
1    108   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90922606, 'precision': 0.57093674, 'recall': 0.5272919, 'specificity': 0.5272919, 'f1': 0.533141, 'auroc': 0.7620194, 'binary_precision': 0.2129964, 'binary_recall': 0.077939235, 'binary_specificity': 0.9766445, 'binary_f1_score': 0.114119925}
confusion matrix:
      0    1
0  9116  218
1   698   59
early stop counter: 8
val acc:0.8087368011474609, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9254781603813171
after epoch: 9,now: 2024-08-09 13:26:57.939608,epoch time: 0:16:47.079708,used: 2:35:45.480306,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9405689, 'precision': 0.94581604, 'recall': 0.9405285, 'specificity': 0.9405285, 'f1': 0.94038975, 'auroc': 0.9952735, 'binary_precision': 0.89763695, 'binary_recall': 0.99465305, 'binary_specificity': 0.8864039, 'binary_f1_score': 0.94365805}
confusion matrix:
       0      1
0  22512   2885
1    136  25299
---- Validation: 
scalar performance:
{'acc': 0.8559832, 'precision': 0.5396147, 'recall': 0.70123476, 'specificity': 0.70123476, 'f1': 0.53980803, 'auroc': 0.8316776, 'binary_precision': 0.09283713, 'binary_recall': 0.53828305, 'binary_specificity': 0.86418647, 'binary_f1_score': 0.15836176}
confusion matrix:
       0     1
0  14425  2267
1    199   232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236944, 'precision': 0.646878, 'recall': 0.51022846, 'specificity': 0.51022846, 'f1': 0.50246257, 'auroc': 0.7933415, 'binary_precision': 0.36734694, 'binary_recall': 0.023778072, 'binary_specificity': 0.9966788, 'binary_f1_score': 0.044665013}
confusion matrix:
      0   1
0  9303  31
1   739  18
early stop counter: 9
val acc:0.8559831976890564, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9254781603813171
after epoch: 10,now: 2024-08-09 13:43:26.490035,epoch time: 0:16:28.550427,used: 2:52:14.030733,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9216635, 'precision': 0.931497, 'recall': 0.92160124, 'specificity': 0.92160124, 'f1': 0.92120683, 'auroc': 0.9935041, 'binary_precision': 0.86656415, 'binary_recall': 0.9969729, 'binary_specificity': 0.84622955, 'binary_f1_score': 0.9272056}
confusion matrix:
       0      1
0  21490   3905
1     77  25360
---- Validation: 
scalar performance:
{'acc': 0.8264323, 'precision': 0.54076153, 'recall': 0.74710524, 'specificity': 0.74710524, 'f1': 0.53229904, 'auroc': 0.82106006, 'binary_precision': 0.09187279, 'binary_recall': 0.6635731, 'binary_specificity': 0.83063745, 'binary_f1_score': 0.16139954}
confusion matrix:
       0     1
0  13865  2827
1    145   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9118026, 'precision': 0.55608106, 'recall': 0.51654595, 'specificity': 0.51654595, 'f1': 0.51712906, 'auroc': 0.70080894, 'binary_precision': 0.18483412, 'binary_recall': 0.051519156, 'binary_specificity': 0.98157275, 'binary_f1_score': 0.08057851}
confusion matrix:
      0    1
0  9162  172
1   718   39
early stop counter: 10
val acc:0.8264322876930237, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9254781603813171
after epoch: 11,now: 2024-08-09 14:00:12.476554,epoch time: 0:16:45.986519,used: 3:09:00.017252,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9388181, 'precision': 0.9449712, 'recall': 0.9387719, 'specificity': 0.9387719, 'f1': 0.9386013, 'auroc': 0.99652326, 'binary_precision': 0.89284205, 'binary_recall': 0.99744457, 'binary_specificity': 0.88009924, 'binary_f1_score': 0.94224906}
confusion matrix:
       0      1
0  22351   3045
1     65  25371
---- Validation: 
scalar performance:
{'acc': 0.8447702, 'precision': 0.55089116, 'recall': 0.78815484, 'specificity': 0.78815484, 'f1': 0.55263054, 'auroc': 0.8534801, 'binary_precision': 0.10998249, 'binary_recall': 0.7285383, 'binary_specificity': 0.8477714, 'binary_f1_score': 0.19111383}
confusion matrix:
       0     1
0  14151  2541
1    117   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210187, 'precision': 0.59972465, 'recall': 0.5124237, 'specificity': 0.5124237, 'f1': 0.5077942, 'auroc': 0.756158, 'binary_precision': 0.27272728, 'binary_recall': 0.031704094, 'binary_specificity': 0.9931433, 'binary_f1_score': 0.056804728}
confusion matrix:
      0   1
0  9270  64
1   733  24
early stop counter: 11
val acc:0.8447701930999756, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9254781603813171
after epoch: 12,now: 2024-08-09 14:16:59.261495,epoch time: 0:16:46.784941,used: 3:25:46.802193,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93722457, 'precision': 0.94371045, 'recall': 0.93718183, 'specificity': 0.93718183, 'f1': 0.9369901, 'auroc': 0.9974139, 'binary_precision': 0.89024174, 'binary_recall': 0.997523, 'binary_specificity': 0.8768407, 'binary_f1_score': 0.940834}
confusion matrix:
       0      1
0  22270   3128
1     63  25371
---- Validation: 
scalar performance:
{'acc': 0.83630204, 'precision': 0.5463485, 'recall': 0.77137995, 'specificity': 0.77137995, 'f1': 0.5434337, 'auroc': 0.8440907, 'binary_precision': 0.10174614, 'binary_recall': 0.7030162, 'binary_specificity': 0.8397436, 'binary_f1_score': 0.17776474}
confusion matrix:
       0     1
0  14017  2675
1    128   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92161334, 'precision': 0.6070903, 'recall': 0.5121382, 'specificity': 0.5121382, 'f1': 0.50703454, 'auroc': 0.7881707, 'binary_precision': 0.2875, 'binary_recall': 0.030383091, 'binary_specificity': 0.99389327, 'binary_f1_score': 0.054958187}
confusion matrix:
      0   1
0  9277  57
1   734  23
early stop counter: 12
val acc:0.8363020420074463, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9254781603813171
after epoch: 13,now: 2024-08-09 14:33:33.008506,epoch time: 0:16:33.747011,used: 3:42:20.549204,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93234575, 'precision': 0.93992704, 'recall': 0.93228906, 'specificity': 0.93228906, 'f1': 0.93204695, 'auroc': 0.99621594, 'binary_precision': 0.8823918, 'binary_recall': 0.99779856, 'binary_specificity': 0.86677957, 'binary_f1_score': 0.93655336}
confusion matrix:
       0      1
0  22011   3383
1     56  25382
---- Validation: 
scalar performance:
{'acc': 0.8141681, 'precision': 0.5431421, 'recall': 0.77923954, 'specificity': 0.77923954, 'f1': 0.53143156, 'auroc': 0.8400785, 'binary_precision': 0.094367445, 'binary_recall': 0.7424594, 'binary_specificity': 0.81601965, 'binary_f1_score': 0.1674516}
confusion matrix:
       0     1
0  13621  3071
1    111   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9135864, 'precision': 0.5615273, 'recall': 0.5162963, 'specificity': 0.5162963, 'f1': 0.51644623, 'auroc': 0.7678441, 'binary_precision': 0.1957672, 'binary_recall': 0.048877146, 'binary_specificity': 0.9837155, 'binary_f1_score': 0.07822409}
confusion matrix:
      0    1
0  9182  152
1   720   37
early stop counter: 13
val acc:0.8141680955886841, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9254781603813171
after epoch: 14,now: 2024-08-09 14:50:14.029574,epoch time: 0:16:41.021068,used: 3:59:01.570272,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9250472, 'precision': 0.93406415, 'recall': 0.9249991, 'specificity': 0.9249991, 'f1': 0.92465013, 'auroc': 0.99564636, 'binary_precision': 0.8716697, 'binary_recall': 0.99697244, 'binary_specificity': 0.85302573, 'binary_f1_score': 0.93011993}
confusion matrix:
       0      1
0  21666   3733
1     77  25356
---- Validation: 
scalar performance:
{'acc': 0.82316184, 'precision': 0.537279, 'recall': 0.7273456, 'specificity': 0.7273456, 'f1': 0.5263213, 'auroc': 0.8151655, 'binary_precision': 0.086069494, 'binary_recall': 0.6264501, 'binary_specificity': 0.82824105, 'binary_f1_score': 0.15134528}
confusion matrix:
       0     1
0  13825  2867
1    161   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9116044, 'precision': 0.5306203, 'recall': 0.5079417, 'specificity': 0.5079417, 'f1': 0.5033584, 'auroc': 0.6239878, 'binary_precision': 0.13513513, 'binary_recall': 0.0330251, 'binary_specificity': 0.98285836, 'binary_f1_score': 0.05307856}
confusion matrix:
      0    1
0  9174  160
1   732   25
early stop counter: 14
val acc:0.8231618404388428, best validation acc: 0.9591193199157715, corresponding to test acc:                         0.9245862364768982 / 0.9254781603813171
after epoch: 15,now: 2024-08-09 15:06:50.891566,epoch time: 0:16:36.861992,used: 4:15:38.432264,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_10_51_12_seed_1_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:15:38.432264 at 2024-08-09 15:06:50.891566
persisted model performance metric: 

scalar performance:
{'acc': 0.92458624, 'precision': 0.7229786, 'recall': 0.6672996, 'specificity': 0.6672996, 'f1': 0.69004023, 'auroc': 0.89653957, 'binary_precision': 0.4964029, 'binary_recall': 0.36459708, 'binary_specificity': 0.9700021, 'binary_f1_score': 0.4204113}
confusion matrix:
      0    1
0  9054  280
1   481  276
oracle model performance metric: 

scalar performance:
{'acc': 0.92547816, 'precision': 0.7280338, 'recall': 0.5300076, 'specificity': 0.5300076, 'f1': 0.5381974, 'auroc': 0.8440248, 'binary_precision': 0.5268817, 'binary_recall': 0.06472919, 'binary_specificity': 0.99528605, 'binary_f1_score': 0.115294114}
confusion matrix:
      0   1
0  9290  44
1   708  49
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493800 KiB |  10995 MiB | 678402 GiB | 678401 GiB |
|       from large pool | 403264 KiB |  10922 MiB | 676547 GiB | 676546 GiB |
|       from small pool |  90536 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493800 KiB |  10995 MiB | 678402 GiB | 678401 GiB |
|       from large pool | 403264 KiB |  10922 MiB | 676547 GiB | 676546 GiB |
|       from small pool |  90536 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10880 MiB | 669616 GiB | 669615 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 667782 GiB | 667781 GiB |
|       from small pool |  88912 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11506 MiB |  11506 MiB |  21780 MiB |  10274 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  21624 MiB |  10244 MiB |
|       from small pool |    126 MiB |    128 MiB |    156 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    807 MiB |   1335 MiB | 284400 GiB | 284399 GiB |
|       from large pool |    798 MiB |   1332 MiB | 282186 GiB | 282185 GiB |
|       from small pool |      9 MiB |     24 MiB |   2213 GiB |   2213 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7600    |  114015 K  |  114010 K  |
|       from large pool |      87    |     908    |   42321 K  |   42321 K  |
|       from small pool |    5076    |    7511    |   71694 K  |   71689 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7600    |  114015 K  |  114010 K  |
|       from large pool |      87    |     908    |   42321 K  |   42321 K  |
|       from small pool |    5076    |    7511    |   71694 K  |   71689 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     408    |     737    |     329    |
|       from large pool |     345    |     345    |     659    |     314    |
|       from small pool |      63    |      64    |      78    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3213    |   61207 K  |   61207 K  |
|       from large pool |      24    |     197    |   26772 K  |   26772 K  |
|       from small pool |      52    |    3187    |   34435 K  |   34435 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 678402 GiB | 678402 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676547 GiB | 676547 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 678402 GiB | 678402 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676547 GiB | 676547 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 669616 GiB | 669616 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 667782 GiB | 667782 GiB |
|       from small pool |      0 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1290 MiB |  11506 MiB |  21780 MiB |  20490 MiB |
|       from large pool |   1192 MiB |  11380 MiB |  21624 MiB |  20432 MiB |
|       from small pool |     98 MiB |    128 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1335 MiB | 284400 GiB | 284400 GiB |
|       from large pool |  50944 KiB |   1332 MiB | 282186 GiB | 282186 GiB |
|       from small pool |      0 KiB |     32 MiB |   2213 GiB |   2213 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  114015 K  |  114015 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71694 K  |   71694 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  114015 K  |  114015 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71694 K  |   71694 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     408    |     737    |     653    |
|       from large pool |      35    |     345    |     659    |     624    |
|       from small pool |      49    |      64    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3213    |   61209 K  |   61209 K  |
|       from large pool |       4    |     197    |   26772 K  |   26772 K  |
|       from small pool |       0    |    3187    |   34437 K  |   34437 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 678402 GiB | 678402 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676547 GiB | 676547 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 678402 GiB | 678402 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676547 GiB | 676547 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 669616 GiB | 669616 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 667782 GiB | 667782 GiB |
|       from small pool |      0 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1290 MiB |  11506 MiB |  21780 MiB |  20490 MiB |
|       from large pool |   1192 MiB |  11380 MiB |  21624 MiB |  20432 MiB |
|       from small pool |     98 MiB |    128 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1335 MiB | 284400 GiB | 284400 GiB |
|       from large pool |  50944 KiB |   1332 MiB | 282186 GiB | 282186 GiB |
|       from small pool |      0 KiB |     32 MiB |   2213 GiB |   2213 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  114015 K  |  114015 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71694 K  |   71694 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  114015 K  |  114015 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71694 K  |   71694 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     408    |     737    |     653    |
|       from large pool |      35    |     345    |     659    |     624    |
|       from small pool |      49    |      64    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3213    |   61209 K  |   61209 K  |
|       from large pool |       4    |     197    |   26772 K  |   26772 K  |
|       from small pool |       0    |    3187    |   34437 K  |   34437 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701

 Experiment start at: 2024-08-09 15:27:20.556467
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95939726, 'precision': 0.96011835, 'recall': 0.95939344, 'specificity': 0.95939344, 'f1': 0.9593811, 'auroc': 0.9947798, 'binary_precision': 0.94195133, 'binary_recall': 0.97915137, 'binary_specificity': 0.9396355, 'binary_f1_score': 0.96019113}
confusion matrix:
       0      1
0  24283   1560
1    539  25314
---- Validation: 
scalar performance:
{'acc': 0.91246206, 'precision': 0.58518875, 'recall': 0.81635296, 'specificity': 0.81635296, 'f1': 0.6192728, 'auroc': 0.8817712, 'binary_precision': 0.1780822, 'binary_recall': 0.715311, 'binary_specificity': 0.91739494, 'binary_f1_score': 0.2851693}
confusion matrix:
       0     1
0  15326  1380
1    119   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8976417, 'precision': 0.689298, 'recall': 0.7912919, 'specificity': 0.7912919, 'f1': 0.72467494, 'auroc': 0.87579954, 'binary_precision': 0.40895063, 'binary_recall': 0.6649937, 'binary_specificity': 0.9175901, 'binary_f1_score': 0.50645006}
confusion matrix:
      0    1
0  8529  766
1   267  530
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 15:45:14.410175,epoch time: 0:17:53.853708,used: 0:17:53.853708,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96001625, 'precision': 0.96168447, 'recall': 0.9600093, 'specificity': 0.9600093, 'f1': 0.95997965, 'auroc': 0.99721235, 'binary_precision': 0.9339901, 'binary_recall': 0.9900209, 'binary_specificity': 0.9299977, 'binary_f1_score': 0.9611897}
confusion matrix:
       0      1
0  24033   1809
1    258  25596
---- Validation: 
scalar performance:
{'acc': 0.8969283, 'precision': 0.57687926, 'recall': 0.8305504, 'specificity': 0.8305504, 'f1': 0.6047342, 'auroc': 0.90004694, 'binary_precision': 0.1603631, 'binary_recall': 0.76076555, 'binary_specificity': 0.9003352, 'binary_f1_score': 0.26488966}
confusion matrix:
       0     1
0  15041  1665
1    100   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91607213, 'precision': 0.70827883, 'recall': 0.69117373, 'specificity': 0.69117373, 'f1': 0.69923604, 'auroc': 0.8693313, 'binary_precision': 0.46556473, 'binary_recall': 0.42409033, 'binary_specificity': 0.95825714, 'binary_f1_score': 0.4438608}
confusion matrix:
      0    1
0  8907  388
1   459  338
new oracle model saved
early stop counter: 1
val acc:0.8969283103942871, best validation acc: 0.912462055683136, corresponding to test acc:                         0.8976417183876038 / 0.9160721302032471
after epoch: 2,now: 2024-08-09 16:02:18.590122,epoch time: 0:17:04.179947,used: 0:34:58.033655,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98106235, 'precision': 0.98119366, 'recall': 0.9810611, 'specificity': 0.9810611, 'f1': 0.98106104, 'auroc': 0.9984133, 'binary_precision': 0.9732846, 'binary_recall': 0.9892852, 'binary_specificity': 0.97283703, 'binary_f1_score': 0.98121965}
confusion matrix:
       0      1
0  25142    702
1    277  25575
---- Validation: 
scalar performance:
{'acc': 0.9310909, 'precision': 0.61123097, 'recall': 0.8515578, 'specificity': 0.8515578, 'f1': 0.65798473, 'auroc': 0.91371274, 'binary_precision': 0.22863248, 'binary_recall': 0.7679426, 'binary_specificity': 0.935173, 'binary_f1_score': 0.35236004}
confusion matrix:
       0     1
0  15623  1083
1     97   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9190448, 'precision': 0.68926406, 'recall': 0.55054456, 'specificity': 0.55054456, 'f1': 0.5689804, 'auroc': 0.8683389, 'binary_precision': 0.45, 'binary_recall': 0.112923466, 'binary_specificity': 0.9881657, 'binary_f1_score': 0.18054163}
confusion matrix:
      0    1
0  9185  110
1   707   90
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 16:19:26.949381,epoch time: 0:17:08.359259,used: 0:52:06.392914,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9545226, 'precision': 0.95757985, 'recall': 0.9545163, 'specificity': 0.9545163, 'f1': 0.954446, 'auroc': 0.998124, 'binary_precision': 0.920216, 'binary_recall': 0.99535817, 'binary_specificity': 0.91367435, 'binary_f1_score': 0.95631325}
confusion matrix:
       0      1
0  23613   2231
1    120  25732
---- Validation: 
scalar performance:
{'acc': 0.86229855, 'precision': 0.56184536, 'recall': 0.83612716, 'specificity': 0.83612716, 'f1': 0.5736326, 'auroc': 0.90331113, 'binary_precision': 0.1292049, 'binary_recall': 0.80861247, 'binary_specificity': 0.8636418, 'binary_f1_score': 0.22280818}
confusion matrix:
       0     1
0  14428  2278
1     80   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91914386, 'precision': 0.692016, 'recall': 0.5540397, 'specificity': 0.5540397, 'f1': 0.5739615, 'auroc': 0.87064564, 'binary_precision': 0.4549763, 'binary_recall': 0.120451696, 'binary_specificity': 0.98762774, 'binary_f1_score': 0.1904762}
confusion matrix:
      0    1
0  9180  115
1   701   96
new oracle model saved
early stop counter: 1
val acc:0.8622985482215881, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9191438555717468
after epoch: 4,now: 2024-08-09 16:37:14.119506,epoch time: 0:17:47.170125,used: 1:09:53.563039,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.963266, 'precision': 0.9650674, 'recall': 0.9632564, 'specificity': 0.9632564, 'f1': 0.9632299, 'auroc': 0.9984402, 'binary_precision': 0.93620044, 'binary_recall': 0.9943147, 'binary_specificity': 0.93219817, 'binary_f1_score': 0.9643828}
confusion matrix:
       0      1
0  24088   1752
1    147  25709
---- Validation: 
scalar performance:
{'acc': 0.8955851, 'precision': 0.5777674, 'recall': 0.8403582, 'specificity': 0.8403582, 'f1': 0.6057987, 'auroc': 0.91190886, 'binary_precision': 0.16156127, 'binary_recall': 0.78229666, 'binary_specificity': 0.89841974, 'binary_f1_score': 0.26781327}
confusion matrix:
       0     1
0  15009  1697
1     91   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9208284, 'precision': 0.7015116, 'recall': 0.51365787, 'specificity': 0.51365787, 'f1': 0.5076754, 'auroc': 0.84812677, 'binary_precision': 0.48, 'binary_recall': 0.030112924, 'binary_specificity': 0.9972028, 'binary_f1_score': 0.056670602}
confusion matrix:
      0   1
0  9269  26
1   773  24
new oracle model saved
early stop counter: 2
val acc:0.8955851197242737, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9208284020423889
after epoch: 5,now: 2024-08-09 16:55:33.063775,epoch time: 0:18:18.944269,used: 1:28:12.507308,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95409703, 'precision': 0.95725256, 'recall': 0.954089, 'specificity': 0.954089, 'f1': 0.95401716, 'auroc': 0.99808764, 'binary_precision': 0.91931564, 'binary_recall': 0.99559045, 'binary_specificity': 0.9125875, 'binary_f1_score': 0.955934}
confusion matrix:
       0      1
0  23584   2259
1    114  25739
---- Validation: 
scalar performance:
{'acc': 0.8402826, 'precision': 0.5501475, 'recall': 0.8003527, 'specificity': 0.8003527, 'f1': 0.5498074, 'auroc': 0.866457, 'binary_precision': 0.10742121, 'binary_recall': 0.7583732, 'binary_specificity': 0.8423321, 'binary_f1_score': 0.1881864}
confusion matrix:
       0     1
0  14072  2634
1    101   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92191833, 'precision': 0.7439195, 'recall': 0.52342653, 'specificity': 0.52342653, 'f1': 0.52568537, 'auroc': 0.7815422, 'binary_precision': 0.5633803, 'binary_recall': 0.050188206, 'binary_specificity': 0.9966649, 'binary_f1_score': 0.0921659}
confusion matrix:
      0   1
0  9264  31
1   757  40
new oracle model saved
early stop counter: 3
val acc:0.8402826189994812, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9219183325767517
after epoch: 6,now: 2024-08-09 17:13:35.995175,epoch time: 0:18:02.931400,used: 1:46:15.438708,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9420071, 'precision': 0.9472984, 'recall': 0.9420008, 'specificity': 0.9420008, 'f1': 0.94183445, 'auroc': 0.99786985, 'binary_precision': 0.89867765, 'binary_recall': 0.99636376, 'binary_specificity': 0.88763785, 'binary_f1_score': 0.94500285}
confusion matrix:
       0      1
0  22941   2904
1     94  25757
---- Validation: 
scalar performance:
{'acc': 0.83345014, 'precision': 0.5465839, 'recall': 0.7863547, 'specificity': 0.7863547, 'f1': 0.5424832, 'auroc': 0.8587126, 'binary_precision': 0.100983605, 'binary_recall': 0.7368421, 'binary_specificity': 0.83586735, 'binary_f1_score': 0.17762399}
confusion matrix:
       0     1
0  13964  2742
1    110   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92290926, 'precision': 0.771333, 'recall': 0.52970004, 'specificity': 0.52970004, 'f1': 0.5367984, 'auroc': 0.7774912, 'binary_precision': 0.61728394, 'binary_recall': 0.06273526, 'binary_specificity': 0.9966649, 'binary_f1_score': 0.11389522}
confusion matrix:
      0   1
0  9264  31
1   747  50
new oracle model saved
early stop counter: 4
val acc:0.8334501385688782, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9229092597961426
after epoch: 7,now: 2024-08-09 17:31:36.073368,epoch time: 0:18:00.078193,used: 2:04:15.516901,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92566156, 'precision': 0.9345399, 'recall': 0.9256505, 'specificity': 0.9256505, 'f1': 0.9252786, 'auroc': 0.997442, 'binary_precision': 0.8724657, 'binary_recall': 0.99709886, 'binary_specificity': 0.85420215, 'binary_f1_score': 0.930628}
confusion matrix:
       0      1
0  22076   3768
1     75  25777
---- Validation: 
scalar performance:
{'acc': 0.821829, 'precision': 0.538564, 'recall': 0.7454115, 'specificity': 0.7454115, 'f1': 0.5272861, 'auroc': 0.8275075, 'binary_precision': 0.08717466, 'binary_recall': 0.6650718, 'binary_specificity': 0.82575125, 'binary_f1_score': 0.15414472}
confusion matrix:
       0     1
0  13795  2911
1    140   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91914386, 'precision': 0.6895264, 'recall': 0.5488777, 'specificity': 0.5488777, 'f1': 0.56662214, 'auroc': 0.7572829, 'binary_precision': 0.4507772, 'binary_recall': 0.10915935, 'binary_specificity': 0.988596, 'binary_f1_score': 0.17575759}
confusion matrix:
      0    1
0  9189  106
1   710   87
early stop counter: 5
val acc:0.8218290209770203, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9229092597961426
after epoch: 8,now: 2024-08-09 17:48:59.672186,epoch time: 0:17:23.598818,used: 2:21:39.115719,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9354689, 'precision': 0.94224966, 'recall': 0.9354545, 'specificity': 0.9354545, 'f1': 0.9352191, 'auroc': 0.99731797, 'binary_precision': 0.8875465, 'binary_recall': 0.99733114, 'binary_specificity': 0.8735779, 'binary_f1_score': 0.9392416}
confusion matrix:
       0      1
0  22575   3267
1     69  25785
---- Validation: 
scalar performance:
{'acc': 0.8590283, 'precision': 0.5528076, 'recall': 0.78430265, 'specificity': 0.78430265, 'f1': 0.559571, 'auroc': 0.8624641, 'binary_precision': 0.114075795, 'binary_recall': 0.70574164, 'binary_specificity': 0.86286366, 'binary_f1_score': 0.1964048}
confusion matrix:
       0     1
0  14415  2291
1    123   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92112565, 'precision': 0.7174944, 'recall': 0.51209855, 'specificity': 0.51209855, 'f1': 0.5044869, 'auroc': 0.6639979, 'binary_precision': 0.5121951, 'binary_recall': 0.026348809, 'binary_specificity': 0.99784833, 'binary_f1_score': 0.050119333}
confusion matrix:
      0   1
0  9275  20
1   776  21
early stop counter: 6
val acc:0.8590282797813416, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9229092597961426
after epoch: 9,now: 2024-08-09 18:06:42.913082,epoch time: 0:17:43.240896,used: 2:39:22.356615,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.93632, 'precision': 0.9429287, 'recall': 0.9363129, 'specificity': 0.9363129, 'f1': 0.9360809, 'auroc': 0.99739397, 'binary_precision': 0.88885444, 'binary_recall': 0.9973695, 'binary_specificity': 0.87525636, 'binary_f1_score': 0.9399905}
confusion matrix:
       0      1
0  22621   3224
1     68  25783
---- Validation: 
scalar performance:
{'acc': 0.79537493, 'precision': 0.54352903, 'recall': 0.81465673, 'specificity': 0.81465673, 'f1': 0.5247451, 'auroc': 0.8581811, 'binary_precision': 0.09223045, 'binary_recall': 0.8349282, 'binary_specificity': 0.79438525, 'binary_f1_score': 0.16611138}
confusion matrix:
       0     1
0  13271  3435
1     69   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91785574, 'precision': 0.66102237, 'recall': 0.5332658, 'specificity': 0.5332658, 'f1': 0.54259145, 'auroc': 0.7132263, 'binary_precision': 0.3961039, 'binary_recall': 0.07653701, 'binary_specificity': 0.98999465, 'binary_f1_score': 0.128286}
confusion matrix:
      0   1
0  9202  93
1   736  61
early stop counter: 7
val acc:0.7953749299049377, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9229092597961426
after epoch: 10,now: 2024-08-09 18:24:46.292951,epoch time: 0:18:03.379869,used: 2:57:25.736484,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92589366, 'precision': 0.93474746, 'recall': 0.92588264, 'specificity': 0.92588264, 'f1': 0.92551315, 'auroc': 0.9970329, 'binary_precision': 0.8727445, 'binary_recall': 0.9972149, 'binary_specificity': 0.85455036, 'binary_f1_score': 0.93083715}
confusion matrix:
       0      1
0  22085   3759
1     72  25780
---- Validation: 
scalar performance:
{'acc': 0.8287783, 'precision': 0.54130256, 'recall': 0.75597054, 'specificity': 0.75597054, 'f1': 0.53346497, 'auroc': 0.83090985, 'binary_precision': 0.092147954, 'binary_recall': 0.67942584, 'binary_specificity': 0.83251524, 'binary_f1_score': 0.1622857}
confusion matrix:
       0     1
0  13908  2798
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9162703, 'precision': 0.6448577, 'recall': 0.5341258, 'specificity': 0.5341258, 'f1': 0.5437833, 'auroc': 0.8080575, 'binary_precision': 0.36363637, 'binary_recall': 0.08030113, 'binary_specificity': 0.9879505, 'binary_f1_score': 0.13155189}
confusion matrix:
      0    1
0  9183  112
1   733   64
early stop counter: 8
val acc:0.8287783265113831, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9229092597961426
after epoch: 11,now: 2024-08-09 18:41:58.803914,epoch time: 0:17:12.510963,used: 3:14:38.247447,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.93800294, 'precision': 0.94438505, 'recall': 0.937989, 'specificity': 0.937989, 'f1': 0.93777823, 'auroc': 0.9978883, 'binary_precision': 0.89118797, 'binary_recall': 0.99787265, 'binary_specificity': 0.8781054, 'binary_f1_score': 0.94151783}
confusion matrix:
       0      1
0  22692   3150
1     55  25799
---- Validation: 
scalar performance:
{'acc': 0.8465312, 'precision': 0.5555817, 'recall': 0.82688, 'specificity': 0.82688, 'f1': 0.5595983, 'auroc': 0.87635124, 'binary_precision': 0.1168516, 'binary_recall': 0.8062201, 'binary_specificity': 0.8475398, 'binary_f1_score': 0.20411871}
confusion matrix:
       0     1
0  14159  2547
1     81   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9198375, 'precision': 0.6675244, 'recall': 0.5154142, 'specificity': 0.5154142, 'f1': 0.51143205, 'auroc': 0.84819317, 'binary_precision': 0.4117647, 'binary_recall': 0.035131745, 'binary_specificity': 0.9956966, 'binary_f1_score': 0.06473988}
confusion matrix:
      0   1
0  9255  40
1   769  28
early stop counter: 9
val acc:0.8465312123298645, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9229092597961426
after epoch: 12,now: 2024-08-09 18:59:14.065789,epoch time: 0:17:15.261875,used: 3:31:53.509322,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.919723, 'precision': 0.93047154, 'recall': 0.91971993, 'specificity': 0.91971993, 'f1': 0.9192183, 'auroc': 0.9977367, 'binary_precision': 0.8624595, 'binary_recall': 0.9987233, 'binary_specificity': 0.84071654, 'binary_f1_score': 0.9256032}
confusion matrix:
       0      1
0  21730   4117
1     33  25816
---- Validation: 
scalar performance:
{'acc': 0.7515183, 'precision': 0.53400874, 'recall': 0.77701867, 'specificity': 0.77701867, 'f1': 0.49563676, 'auroc': 0.8201761, 'binary_precision': 0.07451763, 'binary_recall': 0.80382776, 'binary_specificity': 0.7502095, 'binary_f1_score': 0.13639131}
confusion matrix:
       0     1
0  12533  4173
1     82   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8866429, 'precision': 0.56714875, 'recall': 0.5507348, 'specificity': 0.5507348, 'f1': 0.55687284, 'auroc': 0.7236557, 'binary_precision': 0.20543294, 'binary_recall': 0.15181932, 'binary_specificity': 0.94965035, 'binary_f1_score': 0.17460318}
confusion matrix:
      0    1
0  8827  468
1   676  121
early stop counter: 10
val acc:0.7515183091163635, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9229092597961426
after epoch: 13,now: 2024-08-09 19:18:27.014064,epoch time: 0:19:12.948275,used: 3:51:06.457597,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.94140744, 'precision': 0.94704545, 'recall': 0.94139874, 'specificity': 0.94139874, 'f1': 0.94122136, 'auroc': 0.9978514, 'binary_precision': 0.8968803, 'binary_recall': 0.9975244, 'binary_specificity': 0.88527316, 'binary_f1_score': 0.94452894}
confusion matrix:
       0      1
0  22879   2965
1     64  25788
---- Validation: 
scalar performance:
{'acc': 0.84454566, 'precision': 0.5499903, 'recall': 0.7920413, 'specificity': 0.7920413, 'f1': 0.55098265, 'auroc': 0.84994566, 'binary_precision': 0.10769231, 'binary_recall': 0.7368421, 'binary_specificity': 0.8472405, 'binary_f1_score': 0.18791947}
confusion matrix:
       0     1
0  14154  2552
1    110   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9137931, 'precision': 0.6680926, 'recall': 0.58268076, 'specificity': 0.58268076, 'f1': 0.6059593, 'auroc': 0.8509129, 'binary_precision': 0.40266666, 'binary_recall': 0.18946047, 'binary_specificity': 0.975901, 'binary_f1_score': 0.25767916}
confusion matrix:
      0    1
0  9071  224
1   646  151
early stop counter: 11
val acc:0.8445456624031067, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9229092597961426
after epoch: 14,now: 2024-08-09 19:36:49.088929,epoch time: 0:18:22.074865,used: 4:09:28.532462,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92751855, 'precision': 0.93613297, 'recall': 0.9275077, 'specificity': 0.9275077, 'f1': 0.92715764, 'auroc': 0.9969474, 'binary_precision': 0.87487704, 'binary_recall': 0.9977565, 'binary_specificity': 0.8572589, 'binary_f1_score': 0.93228525}
confusion matrix:
       0      1
0  22155   3689
1     58  25794
---- Validation: 
scalar performance:
{'acc': 0.83934826, 'precision': 0.53571254, 'recall': 0.7054081, 'specificity': 0.7054081, 'f1': 0.52888846, 'auroc': 0.82558256, 'binary_precision': 0.08413547, 'binary_recall': 0.5645933, 'binary_specificity': 0.84622294, 'binary_f1_score': 0.1464474}
confusion matrix:
       0     1
0  14137  2569
1    182   236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8958581, 'precision': 0.6128726, 'recall': 0.5878569, 'specificity': 0.5878569, 'f1': 0.5979953, 'auroc': 0.8156966, 'binary_precision': 0.2911184, 'binary_recall': 0.22208281, 'binary_specificity': 0.953631, 'binary_f1_score': 0.2519573}
confusion matrix:
      0    1
0  8864  431
1   620  177
early stop counter: 12
val acc:0.8393482565879822, best validation acc: 0.9310908913612366, corresponding to test acc:                         0.9190447926521301 / 0.9229092597961426
after epoch: 15,now: 2024-08-09 19:54:19.450110,epoch time: 0:17:30.361181,used: 4:26:58.893643,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_27_20_seed_2_24132701
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:26:58.893643 at 2024-08-09 19:54:19.450110
persisted model performance metric: 

scalar performance:
{'acc': 0.9190448, 'precision': 0.68926406, 'recall': 0.55054456, 'specificity': 0.55054456, 'f1': 0.5689804, 'auroc': 0.8683389, 'binary_precision': 0.45, 'binary_recall': 0.112923466, 'binary_specificity': 0.9881657, 'binary_f1_score': 0.18054163}
confusion matrix:
      0    1
0  9185  110
1   707   90
oracle model performance metric: 

scalar performance:
{'acc': 0.92290926, 'precision': 0.771333, 'recall': 0.52970004, 'specificity': 0.52970004, 'f1': 0.5367984, 'auroc': 0.7774912, 'binary_precision': 0.61728394, 'binary_recall': 0.06273526, 'binary_specificity': 0.9966649, 'binary_f1_score': 0.11389522}
confusion matrix:
      0   1
0  9264  31
1   747  50
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494824 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 404288 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494824 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 404288 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10880 MiB |    998 TiB |    998 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    995 TiB |    995 TiB |
|       from small pool |  88912 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11476 MiB |  11506 MiB |  31966 MiB |  20490 MiB |
|       from large pool |  11350 MiB |  11380 MiB |  31782 MiB |  20432 MiB |
|       from small pool |    126 MiB |    128 MiB |    184 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 736023 KiB |   1557 MiB | 470271 GiB | 470271 GiB |
|       from large pool | 724160 KiB |   1555 MiB | 466898 GiB | 466898 GiB |
|       from small pool |  11863 KiB |     32 MiB |   3373 GiB |   3373 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7708    |  173394 K  |  173388 K  |
|       from large pool |      87    |     908    |   64564 K  |   64564 K  |
|       from small pool |    5076    |    7619    |  108829 K  |  108824 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7708    |  173394 K  |  173388 K  |
|       from large pool |      87    |     908    |   64564 K  |   64564 K  |
|       from small pool |    5076    |    7619    |  108829 K  |  108824 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     405    |     408    |    1058    |     653    |
|       from large pool |     342    |     345    |     966    |     624    |
|       from small pool |      63    |      64    |      92    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3263    |   94344 K  |   94344 K  |
|       from large pool |      22    |     198    |   42071 K  |   42071 K  |
|       from small pool |      51    |    3240    |   52273 K  |   52273 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    998 TiB |    998 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    995 TiB |    995 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1202 MiB |  11506 MiB |  31966 MiB |  30764 MiB |
|       from large pool |   1102 MiB |  11380 MiB |  31782 MiB |  30680 MiB |
|       from small pool |    100 MiB |    128 MiB |    184 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1557 MiB | 470272 GiB | 470272 GiB |
|       from large pool |  50944 KiB |   1555 MiB | 466898 GiB | 466898 GiB |
|       from small pool |      0 KiB |     32 MiB |   3373 GiB |   3373 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7708    |  173394 K  |  173394 K  |
|       from large pool |       2    |     908    |   64564 K  |   64564 K  |
|       from small pool |       0    |    7619    |  108829 K  |  108829 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7708    |  173394 K  |  173394 K  |
|       from large pool |       2    |     908    |   64564 K  |   64564 K  |
|       from small pool |       0    |    7619    |  108829 K  |  108829 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     408    |    1058    |     975    |
|       from large pool |      33    |     345    |     966    |     933    |
|       from small pool |      50    |      64    |      92    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3263    |   94346 K  |   94346 K  |
|       from large pool |       4    |     198    |   42071 K  |   42071 K  |
|       from small pool |       0    |    3240    |   52275 K  |   52275 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 20:07:27 2024]
Finished job 0.
1 of 1 steps (100%) done
