Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 22:47:25 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725

 Experiment start at: 2024-08-09 22:55:25.483390
before training, model accuracy: 0.6347637176513672
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97074383, 'precision': 0.9708872, 'recall': 0.9707498, 'specificity': 0.9707498, 'f1': 0.97074187, 'auroc': 0.9954328, 'binary_precision': 0.97927296, 'binary_recall': 0.961886, 'binary_specificity': 0.9796136, 'binary_f1_score': 0.9705016}
confusion matrix:
       0      1
0  24795    516
1    966  24379
---- Validation: 
scalar performance:
{'acc': 0.9659396, 'precision': 0.6777133, 'recall': 0.7675343, 'specificity': 0.7675343, 'f1': 0.7125905, 'auroc': 0.8828169, 'binary_precision': 0.3665087, 'binary_recall': 0.55903614, 'binary_specificity': 0.9760325, 'binary_f1_score': 0.4427481}
confusion matrix:
       0    1
0  16330  401
1    183  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92011076, 'precision': 0.66416246, 'recall': 0.54025763, 'specificity': 0.54025763, 'f1': 0.5537803, 'auroc': 0.85735846, 'binary_precision': 0.3988764, 'binary_recall': 0.09196891, 'binary_specificity': 0.9885464, 'binary_f1_score': 0.14947367}
confusion matrix:
      0    1
0  9235  107
1   701   71
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 23:14:12.662479,epoch time: 0:18:47.179089,used: 0:18:47.179089,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97177035, 'precision': 0.9721002, 'recall': 0.9717621, 'specificity': 0.9717621, 'f1': 0.97176504, 'auroc': 0.9973315, 'binary_precision': 0.9597785, 'binary_recall': 0.9848485, 'binary_specificity': 0.95867574, 'binary_f1_score': 0.9721518}
confusion matrix:
       0      1
0  24266   1046
1    384  24960
---- Validation: 
scalar performance:
{'acc': 0.9450017, 'precision': 0.63080555, 'recall': 0.8437509, 'specificity': 0.8437509, 'f1': 0.68238187, 'auroc': 0.9181316, 'binary_precision': 0.26842105, 'binary_recall': 0.7373494, 'binary_specificity': 0.9501524, 'binary_f1_score': 0.39356914}
confusion matrix:
       0    1
0  15897  834
1    109  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91467273, 'precision': 0.6833835, 'recall': 0.6412896, 'specificity': 0.6412896, 'f1': 0.65868646, 'auroc': 0.8865143, 'binary_precision': 0.4219554, 'binary_recall': 0.31865284, 'binary_specificity': 0.9639264, 'binary_f1_score': 0.36309963}
confusion matrix:
      0    1
0  9005  337
1   526  246
early stop counter: 1
val acc:0.9450017213821411, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9201107621192932
after epoch: 2,now: 2024-08-09 23:31:15.210258,epoch time: 0:17:02.547779,used: 0:35:49.726868,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9826279, 'precision': 0.9826292, 'recall': 0.9826275, 'specificity': 0.9826275, 'f1': 0.98262787, 'auroc': 0.99820983, 'binary_precision': 0.98199296, 'binary_recall': 0.98331034, 'binary_specificity': 0.9819446, 'binary_f1_score': 0.98265123}
confusion matrix:
       0      1
0  24854    457
1    423  24922
---- Validation: 
scalar performance:
{'acc': 0.9630234, 'precision': 0.6753825, 'recall': 0.821262, 'specificity': 0.821262, 'f1': 0.7244833, 'auroc': 0.911521, 'binary_precision': 0.35907337, 'binary_recall': 0.67228913, 'binary_specificity': 0.9702349, 'binary_f1_score': 0.46812078}
confusion matrix:
       0    1
0  16233  498
1    136  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9200119, 'precision': 0.64194, 'recall': 0.52535045, 'specificity': 0.52535045, 'f1': 0.53012514, 'auroc': 0.90420437, 'binary_precision': 0.35658914, 'binary_recall': 0.059585493, 'binary_specificity': 0.9911154, 'binary_f1_score': 0.10210877}
confusion matrix:
      0   1
0  9259  83
1   726  46
early stop counter: 2
val acc:0.9630234241485596, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9201107621192932
after epoch: 3,now: 2024-08-09 23:48:54.207829,epoch time: 0:17:38.997571,used: 0:53:28.724439,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9777519, 'precision': 0.97831583, 'recall': 0.9777425, 'specificity': 0.9777425, 'f1': 0.97774506, 'auroc': 0.9990108, 'binary_precision': 0.9620302, 'binary_recall': 0.99479127, 'binary_specificity': 0.9606937, 'binary_f1_score': 0.9781365}
confusion matrix:
       0      1
0  24319    995
1    132  25210
---- Validation: 
scalar performance:
{'acc': 0.9296629, 'precision': 0.6118802, 'recall': 0.86878943, 'specificity': 0.86878943, 'f1': 0.6596276, 'auroc': 0.9250103, 'binary_precision': 0.22892392, 'binary_recall': 0.8048193, 'binary_specificity': 0.9327595, 'binary_f1_score': 0.3564568}
confusion matrix:
       0     1
0  15606  1125
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92011076, 'precision': 0.66416246, 'recall': 0.54025763, 'specificity': 0.54025763, 'f1': 0.5537803, 'auroc': 0.9025539, 'binary_precision': 0.3988764, 'binary_recall': 0.09196891, 'binary_specificity': 0.9885464, 'binary_f1_score': 0.14947367}
confusion matrix:
      0    1
0  9235  107
1   701   71
early stop counter: 3
val acc:0.9296628832817078, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9201107621192932
after epoch: 4,now: 2024-08-10 00:06:29.731808,epoch time: 0:17:35.523979,used: 1:11:04.248418,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97637004, 'precision': 0.9767984, 'recall': 0.97636235, 'specificity': 0.97636235, 'f1': 0.97636443, 'auroc': 0.9984678, 'binary_precision': 0.9626351, 'binary_recall': 0.9912395, 'binary_specificity': 0.96148527, 'binary_f1_score': 0.9767279}
confusion matrix:
       0      1
0  24340    975
1    222  25119
---- Validation: 
scalar performance:
{'acc': 0.94296044, 'precision': 0.62368894, 'recall': 0.8274308, 'specificity': 0.8274308, 'f1': 0.6723988, 'auroc': 0.9052247, 'binary_precision': 0.25500435, 'binary_recall': 0.7060241, 'binary_specificity': 0.94883746, 'binary_f1_score': 0.37468028}
confusion matrix:
       0    1
0  15875  856
1    122  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238679, 'precision': 0.7538029, 'recall': 0.5042661, 'specificity': 0.5042661, 'f1': 0.4891281, 'auroc': 0.88837135, 'binary_precision': 0.5833333, 'binary_recall': 0.0090673575, 'binary_specificity': 0.9994648, 'binary_f1_score': 0.017857142}
confusion matrix:
      0  1
0  9337  5
1   765  7
new oracle model saved
early stop counter: 4
val acc:0.9429604411125183, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9238678812980652
after epoch: 5,now: 2024-08-10 00:23:42.173892,epoch time: 0:17:12.442084,used: 1:28:16.690502,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97196776, 'precision': 0.97295475, 'recall': 0.97195435, 'specificity': 0.97195435, 'f1': 0.97195256, 'auroc': 0.99878085, 'binary_precision': 0.9514966, 'binary_recall': 0.9946731, 'binary_specificity': 0.94923556, 'binary_f1_score': 0.97260594}
confusion matrix:
       0      1
0  24028   1285
1    135  25208
---- Validation: 
scalar performance:
{'acc': 0.94132745, 'precision': 0.6201594, 'recall': 0.82424414, 'specificity': 0.82424414, 'f1': 0.66786903, 'auroc': 0.89833605, 'binary_precision': 0.24808185, 'binary_recall': 0.70120484, 'binary_specificity': 0.9472835, 'binary_f1_score': 0.36649874}
confusion matrix:
       0    1
0  15849  882
1    124  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238679, 'precision': 0.7745522, 'recall': 0.50307775, 'specificity': 0.50307775, 'f1': 0.48661387, 'auroc': 0.87716305, 'binary_precision': 0.625, 'binary_recall': 0.006476684, 'binary_specificity': 0.99967885, 'binary_f1_score': 0.012820512}
confusion matrix:
      0  1
0  9339  3
1   767  5
early stop counter: 5
val acc:0.9413274526596069, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9238678812980652
after epoch: 6,now: 2024-08-10 00:41:10.759569,epoch time: 0:17:28.585677,used: 1:45:45.276179,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96880925, 'precision': 0.9700766, 'recall': 0.968798, 'specificity': 0.968798, 'f1': 0.96878767, 'auroc': 0.99867165, 'binary_precision': 0.9457766, 'binary_recall': 0.99467224, 'binary_specificity': 0.9429237, 'binary_f1_score': 0.9696084}
confusion matrix:
       0      1
0  23872   1445
1    135  25204
---- Validation: 
scalar performance:
{'acc': 0.91280764, 'precision': 0.5857908, 'recall': 0.8213799, 'specificity': 0.8213799, 'f1': 0.6203205, 'auroc': 0.8982365, 'binary_precision': 0.17895363, 'binary_recall': 0.7253012, 'binary_specificity': 0.9174586, 'binary_f1_score': 0.28707677}
confusion matrix:
       0     1
0  15350  1381
1    114   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9235713, 'precision': 0.70540303, 'recall': 0.51004696, 'specificity': 0.51004696, 'f1': 0.5011645, 'auroc': 0.89697367, 'binary_precision': 0.4857143, 'binary_recall': 0.022020726, 'binary_specificity': 0.9980732, 'binary_f1_score': 0.04213135}
confusion matrix:
      0   1
0  9324  18
1   755  17
early stop counter: 6
val acc:0.9128076434135437, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9238678812980652
after epoch: 7,now: 2024-08-10 00:58:29.326426,epoch time: 0:17:18.566857,used: 2:03:03.843036,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95307565, 'precision': 0.9566674, 'recall': 0.9530477, 'specificity': 0.9530477, 'f1': 0.9529811, 'auroc': 0.9988854, 'binary_precision': 0.9163253, 'binary_recall': 0.99727744, 'binary_specificity': 0.90881795, 'binary_f1_score': 0.9550891}
confusion matrix:
       0      1
0  23004   2308
1     69  25275
---- Validation: 
scalar performance:
{'acc': 0.8491193, 'precision': 0.5558026, 'recall': 0.8263438, 'specificity': 0.8263438, 'f1': 0.5606937, 'auroc': 0.8935458, 'binary_precision': 0.117336154, 'binary_recall': 0.80240965, 'binary_specificity': 0.8502779, 'binary_f1_score': 0.20473409}
confusion matrix:
       0     1
0  14226  2505
1     82   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234724, 'precision': 0.7032647, 'recall': 0.5147466, 'specificity': 0.5147466, 'f1': 0.51039547, 'auroc': 0.8549863, 'binary_precision': 0.48076922, 'binary_recall': 0.03238342, 'binary_specificity': 0.99710983, 'binary_f1_score': 0.060679607}
confusion matrix:
      0   1
0  9315  27
1   747  25
early stop counter: 7
val acc:0.8491193056106567, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9238678812980652
after epoch: 8,now: 2024-08-10 01:15:38.774507,epoch time: 0:17:09.448081,used: 2:20:13.291117,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9643675, 'precision': 0.96639985, 'recall': 0.964348, 'specificity': 0.964348, 'f1': 0.9643276, 'auroc': 0.9990879, 'binary_precision': 0.9357598, 'binary_recall': 0.9972379, 'binary_specificity': 0.9314581, 'binary_f1_score': 0.9655212}
confusion matrix:
       0      1
0  23578   1735
1     70  25273
---- Validation: 
scalar performance:
{'acc': 0.88376296, 'precision': 0.57258093, 'recall': 0.8511449, 'specificity': 0.8511449, 'f1': 0.59540486, 'auroc': 0.9065957, 'binary_precision': 0.15026596, 'binary_recall': 0.8168675, 'binary_specificity': 0.8854223, 'binary_f1_score': 0.25383753}
confusion matrix:
       0     1
0  14814  1917
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92396677, 'precision': 0.81919885, 'recall': 0.5031313, 'specificity': 0.5031313, 'f1': 0.48664886, 'auroc': 0.8846325, 'binary_precision': 0.71428573, 'binary_recall': 0.006476684, 'binary_specificity': 0.9997859, 'binary_f1_score': 0.01283697}
confusion matrix:
      0  1
0  9340  2
1   767  5
new oracle model saved
early stop counter: 8
val acc:0.8837629556655884, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9239667654037476
after epoch: 9,now: 2024-08-10 01:33:16.558569,epoch time: 0:17:37.784062,used: 2:37:51.075179,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95560247, 'precision': 0.9588573, 'recall': 0.9555726, 'specificity': 0.9555726, 'f1': 0.9555215, 'auroc': 0.9987433, 'binary_precision': 0.92038876, 'binary_recall': 0.9975538, 'binary_specificity': 0.91359144, 'binary_f1_score': 0.957419}
confusion matrix:
       0      1
0  23123   2187
1     62  25284
---- Validation: 
scalar performance:
{'acc': 0.8396711, 'precision': 0.55342263, 'recall': 0.82737714, 'specificity': 0.82737714, 'f1': 0.55415636, 'auroc': 0.8929733, 'binary_precision': 0.11229236, 'binary_recall': 0.81445783, 'binary_specificity': 0.84029645, 'binary_f1_score': 0.19737226}
confusion matrix:
       0     1
0  14059  2672
1     77   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92376906, 'precision': 0.71973836, 'recall': 0.51074815, 'specificity': 0.51074815, 'f1': 0.5024552, 'auroc': 0.85280234, 'binary_precision': 0.51428574, 'binary_recall': 0.023316063, 'binary_specificity': 0.99818027, 'binary_f1_score': 0.044609666}
confusion matrix:
      0   1
0  9325  17
1   754  18
early stop counter: 9
val acc:0.8396710753440857, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9239667654037476
after epoch: 10,now: 2024-08-10 01:50:32.624827,epoch time: 0:17:16.066258,used: 2:55:07.141437,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95017374, 'precision': 0.9542702, 'recall': 0.9501438, 'specificity': 0.9501438, 'f1': 0.9500588, 'auroc': 0.998842, 'binary_precision': 0.91128975, 'binary_recall': 0.9975142, 'binary_specificity': 0.9027734, 'binary_f1_score': 0.9524545}
confusion matrix:
       0      1
0  22851   2461
1     63  25281
---- Validation: 
scalar performance:
{'acc': 0.8604922, 'precision': 0.5601696, 'recall': 0.8321713, 'specificity': 0.8321713, 'f1': 0.57060313, 'auroc': 0.9004992, 'binary_precision': 0.12599319, 'binary_recall': 0.80240965, 'binary_specificity': 0.86193293, 'binary_f1_score': 0.2177894}
confusion matrix:
       0     1
0  14421  2310
1     82   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92376906, 'precision': 0.7201291, 'recall': 0.510154, 'specificity': 0.510154, 'f1': 0.5012704, 'auroc': 0.84543663, 'binary_precision': 0.5151515, 'binary_recall': 0.022020726, 'binary_specificity': 0.9982873, 'binary_f1_score': 0.042236026}
confusion matrix:
      0   1
0  9326  16
1   755  17
early stop counter: 10
val acc:0.8604922294616699, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9239667654037476
after epoch: 11,now: 2024-08-10 02:07:38.949225,epoch time: 0:17:06.324398,used: 3:12:13.465835,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9491867, 'precision': 0.95345676, 'recall': 0.94916177, 'specificity': 0.94916177, 'f1': 0.9490648, 'auroc': 0.9983883, 'binary_precision': 0.90958154, 'binary_recall': 0.9975928, 'binary_specificity': 0.9007308, 'binary_f1_score': 0.95155644}
confusion matrix:
       0      1
0  22802   2513
1     61  25280
---- Validation: 
scalar performance:
{'acc': 0.84900266, 'precision': 0.5547416, 'recall': 0.8192344, 'specificity': 0.8192344, 'f1': 0.5591404, 'auroc': 0.88523906, 'binary_precision': 0.11562942, 'binary_recall': 0.7879518, 'binary_specificity': 0.850517, 'binary_f1_score': 0.20166513}
confusion matrix:
       0     1
0  14230  2501
1     88   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234724, 'precision': 0.69683284, 'recall': 0.50880516, 'specificity': 0.50880516, 'f1': 0.49873292, 'auroc': 0.8271012, 'binary_precision': 0.46875, 'binary_recall': 0.019430052, 'binary_specificity': 0.99818027, 'binary_f1_score': 0.037313435}
confusion matrix:
      0   1
0  9325  17
1   757  15
early stop counter: 11
val acc:0.8490026593208313, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9239667654037476
after epoch: 12,now: 2024-08-10 02:25:11.678610,epoch time: 0:17:32.729385,used: 3:29:46.195220,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93447965, 'precision': 0.94171643, 'recall': 0.9344393, 'specificity': 0.9344393, 'f1': 0.93420595, 'auroc': 0.9984782, 'binary_precision': 0.8853354, 'binary_recall': 0.9983428, 'binary_specificity': 0.87053573, 'binary_f1_score': 0.93844926}
confusion matrix:
       0      1
0  22035   3277
1     42  25302
---- Validation: 
scalar performance:
{'acc': 0.80438584, 'precision': 0.5442021, 'recall': 0.8116468, 'specificity': 0.8116468, 'f1': 0.5288602, 'auroc': 0.87209094, 'binary_precision': 0.0939486, 'binary_recall': 0.8192771, 'binary_specificity': 0.8040165, 'binary_f1_score': 0.16856717}
confusion matrix:
       0     1
0  13452  3279
1     75   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9159581, 'precision': 0.58819544, 'recall': 0.518997, 'specificity': 0.518997, 'f1': 0.5200051, 'auroc': 0.78620356, 'binary_precision': 0.25, 'binary_recall': 0.050518136, 'binary_specificity': 0.98747593, 'binary_f1_score': 0.08405173}
confusion matrix:
      0    1
0  9225  117
1   733   39
early stop counter: 12
val acc:0.8043858408927917, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9239667654037476
after epoch: 13,now: 2024-08-10 02:42:32.099070,epoch time: 0:17:20.420460,used: 3:47:06.615680,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9272347, 'precision': 0.9362346, 'recall': 0.927195, 'specificity': 0.927195, 'f1': 0.9268528, 'auroc': 0.99904466, 'binary_precision': 0.8737144, 'binary_recall': 0.99893457, 'binary_specificity': 0.85545546, 'binary_f1_score': 0.93213785}
confusion matrix:
       0      1
0  21655   3659
1     27  25315
---- Validation: 
scalar performance:
{'acc': 0.79242975, 'precision': 0.54351264, 'recall': 0.8207946, 'specificity': 0.8207946, 'f1': 0.52350336, 'auroc': 0.8860498, 'binary_precision': 0.09168831, 'binary_recall': 0.8506024, 'binary_specificity': 0.7909868, 'binary_f1_score': 0.16553341}
confusion matrix:
       0     1
0  13234  3497
1     62   353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9154637, 'precision': 0.5809257, 'recall': 0.5175411, 'specificity': 0.5175411, 'f1': 0.51767635, 'auroc': 0.75820696, 'binary_precision': 0.2356688, 'binary_recall': 0.04792746, 'binary_specificity': 0.9871548, 'binary_f1_score': 0.07965554}
confusion matrix:
      0    1
0  9222  120
1   735   37
early stop counter: 13
val acc:0.7924297451972961, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9239667654037476
after epoch: 14,now: 2024-08-10 03:00:04.411704,epoch time: 0:17:32.312634,used: 4:04:38.928314,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92032534, 'precision': 0.930964, 'recall': 0.92028505, 'specificity': 0.92028505, 'f1': 0.91982543, 'auroc': 0.9983598, 'binary_precision': 0.86338055, 'binary_recall': 0.9987767, 'binary_specificity': 0.8417934, 'binary_f1_score': 0.92615634}
confusion matrix:
       0      1
0  21310   4005
1     31  25310
---- Validation: 
scalar performance:
{'acc': 0.8248571, 'precision': 0.5416267, 'recall': 0.76573944, 'specificity': 0.76573944, 'f1': 0.5325042, 'auroc': 0.85765046, 'binary_precision': 0.092055485, 'binary_recall': 0.7036145, 'binary_specificity': 0.82786447, 'binary_f1_score': 0.16281015}
confusion matrix:
       0     1
0  13851  2880
1    123   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8985565, 'precision': 0.53777266, 'recall': 0.51848936, 'specificity': 0.51848936, 'f1': 0.52075195, 'auroc': 0.7315291, 'binary_precision': 0.14917128, 'binary_recall': 0.06994819, 'binary_specificity': 0.9670306, 'binary_f1_score': 0.095238104}
confusion matrix:
      0    1
0  9034  308
1   718   54
early stop counter: 14
val acc:0.8248571157455444, best validation acc: 0.9659395813941956, corresponding to test acc:                         0.9201107621192932 / 0.9239667654037476
after epoch: 15,now: 2024-08-10 03:17:32.836577,epoch time: 0:17:28.424873,used: 4:22:07.353187,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_22_55_25_seed_0_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:22:07.353187 at 2024-08-10 03:17:32.836577
persisted model performance metric: 

scalar performance:
{'acc': 0.92011076, 'precision': 0.66416246, 'recall': 0.54025763, 'specificity': 0.54025763, 'f1': 0.5537803, 'auroc': 0.85735846, 'binary_precision': 0.3988764, 'binary_recall': 0.09196891, 'binary_specificity': 0.9885464, 'binary_f1_score': 0.14947367}
confusion matrix:
      0    1
0  9235  107
1   701   71
oracle model performance metric: 

scalar performance:
{'acc': 0.92396677, 'precision': 0.81919885, 'recall': 0.5031313, 'specificity': 0.5031313, 'f1': 0.48664886, 'auroc': 0.8846325, 'binary_precision': 0.71428573, 'binary_recall': 0.006476684, 'binary_specificity': 0.9997859, 'binary_f1_score': 0.01283697}
confusion matrix:
      0  1
0  9340  2
1   767  5
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493870 KiB |  10995 MiB | 335649 GiB | 335648 GiB |
|       from large pool | 403328 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |  90542 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493870 KiB |  10995 MiB | 335649 GiB | 335648 GiB |
|       from large pool | 403328 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |  90542 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476753 KiB |  10880 MiB | 332150 GiB | 332149 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 331243 GiB | 331242 GiB |
|       from small pool |  88913 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11490 MiB |  11490 MiB |  11490 MiB |      0 B   |
|       from large pool |  11362 MiB |  11362 MiB |  11362 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 751313 KiB |   1257 MiB | 127120 GiB | 127120 GiB |
|       from large pool | 741504 KiB |   1255 MiB | 126061 GiB | 126060 GiB |
|       from small pool |   9809 KiB |     10 MiB |   1059 GiB |   1059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5175    |    7578    |   56673 K  |   56668 K  |
|       from large pool |      87    |     908    |   21002 K  |   21002 K  |
|       from small pool |    5088    |    7489    |   35671 K  |   35665 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5175    |    7578    |   56673 K  |   56668 K  |
|       from large pool |      87    |     908    |   21002 K  |   21002 K  |
|       from small pool |    5088    |    7489    |   35671 K  |   35665 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     408    |     408    |       0    |
|       from large pool |     344    |     344    |     344    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3196    |   30694 K  |   30694 K  |
|       from large pool |      19    |     189    |   13629 K  |   13629 K  |
|       from small pool |      54    |    3175    |   17065 K  |   17065 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |      0 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11490 MiB |  11490 MiB |  10274 MiB |
|       from large pool |   1118 MiB |  11362 MiB |  11362 MiB |  10244 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1257 MiB | 127121 GiB | 127121 GiB |
|       from large pool |  50944 KiB |   1255 MiB | 126061 GiB | 126061 GiB |
|       from small pool |      0 KiB |     26 MiB |   1059 GiB |   1059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56673 K  |   56673 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35671 K  |   35671 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56673 K  |   56673 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35671 K  |   35671 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     408    |     408    |     329    |
|       from large pool |      30    |     344    |     344    |     314    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3196    |   30696 K  |   30696 K  |
|       from large pool |       4    |     189    |   13629 K  |   13629 K  |
|       from small pool |       0    |    3175    |   17067 K  |   17067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |      0 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11490 MiB |  11490 MiB |  10274 MiB |
|       from large pool |   1118 MiB |  11362 MiB |  11362 MiB |  10244 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1257 MiB | 127121 GiB | 127121 GiB |
|       from large pool |  50944 KiB |   1255 MiB | 126061 GiB | 126061 GiB |
|       from small pool |      0 KiB |     26 MiB |   1059 GiB |   1059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56673 K  |   56673 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35671 K  |   35671 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56673 K  |   56673 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35671 K  |   35671 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     408    |     408    |     329    |
|       from large pool |      30    |     344    |     344    |     314    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3196    |   30696 K  |   30696 K  |
|       from large pool |       4    |     189    |   13629 K  |   13629 K  |
|       from small pool |       0    |    3175    |   17067 K  |   17067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725

 Experiment start at: 2024-08-10 03:39:10.240557
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96169734, 'precision': 0.96177423, 'recall': 0.9616924, 'specificity': 0.9616924, 'f1': 0.96169543, 'auroc': 0.9931819, 'binary_precision': 0.95600855, 'binary_recall': 0.9679981, 'binary_specificity': 0.9553867, 'binary_f1_score': 0.9619659}
confusion matrix:
       0      1
0  24263   1133
1    814  24622
---- Validation: 
scalar performance:
{'acc': 0.9063832, 'precision': 0.57455474, 'recall': 0.7745513, 'specificity': 0.7745513, 'f1': 0.60240984, 'auroc': 0.82589006, 'binary_precision': 0.15930232, 'binary_recall': 0.63573086, 'binary_specificity': 0.9133717, 'binary_f1_score': 0.2547652}
confusion matrix:
       0     1
0  15246  1446
1    157   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92389256, 'precision': 0.73232543, 'recall': 0.7943809, 'specificity': 0.7943809, 'f1': 0.7584883, 'auroc': 0.896139, 'binary_precision': 0.49440488, 'binary_recall': 0.64200795, 'binary_specificity': 0.9467538, 'binary_f1_score': 0.5586207}
confusion matrix:
      0    1
0  8837  497
1   271  486
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 03:57:45.050333,epoch time: 0:18:34.809776,used: 0:18:34.809776,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96301544, 'precision': 0.96381485, 'recall': 0.9629992, 'specificity': 0.9629992, 'f1': 0.9629985, 'auroc': 0.99632597, 'binary_precision': 0.9447549, 'binary_recall': 0.9836059, 'binary_specificity': 0.9423925, 'binary_f1_score': 0.96378905}
confusion matrix:
       0      1
0  23933   1463
1    417  25019
---- Validation: 
scalar performance:
{'acc': 0.9278748, 'precision': 0.60360694, 'recall': 0.81947863, 'specificity': 0.81947863, 'f1': 0.64589155, 'auroc': 0.87774473, 'binary_precision': 0.21529745, 'binary_recall': 0.70533645, 'binary_specificity': 0.93362087, 'binary_f1_score': 0.3298969}
confusion matrix:
       0     1
0  15584  1108
1    127   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92002773, 'precision': 0.6836222, 'recall': 0.58957565, 'specificity': 0.58957565, 'f1': 0.6156559, 'auroc': 0.90053564, 'binary_precision': 0.42937854, 'binary_recall': 0.2007926, 'binary_specificity': 0.9783587, 'binary_f1_score': 0.27362737}
confusion matrix:
      0    1
0  9132  202
1   605  152
better model found
persisted
after epoch: 2,now: 2024-08-10 04:15:04.303077,epoch time: 0:17:19.252744,used: 0:35:54.062520,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9436575, 'precision': 0.9478811, 'recall': 0.94361377, 'specificity': 0.94361377, 'f1': 0.9435204, 'auroc': 0.9963012, 'binary_precision': 0.9046134, 'binary_recall': 0.99202013, 'binary_specificity': 0.89520735, 'binary_f1_score': 0.94630265}
confusion matrix:
       0      1
0  22732   2661
1    203  25236
---- Validation: 
scalar performance:
{'acc': 0.8619401, 'precision': 0.56192356, 'recall': 0.8263451, 'specificity': 0.8263451, 'f1': 0.57381296, 'auroc': 0.8790262, 'binary_precision': 0.13011864, 'binary_recall': 0.7888631, 'binary_specificity': 0.863827, 'binary_f1_score': 0.22339027}
confusion matrix:
       0     1
0  14419  2273
1     91   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.921316, 'precision': 0.6865902, 'recall': 0.57631254, 'specificity': 0.57631254, 'f1': 0.60187083, 'auroc': 0.9018559, 'binary_precision': 0.43728814, 'binary_recall': 0.17040952, 'binary_specificity': 0.9822156, 'binary_f1_score': 0.24524716}
confusion matrix:
      0    1
0  9168  166
1   628  129
early stop counter: 1
val acc:0.8619400858879089, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9238925576210022
after epoch: 3,now: 2024-08-10 04:32:44.396816,epoch time: 0:17:40.093739,used: 0:53:34.156259,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9558349, 'precision': 0.9580499, 'recall': 0.95580363, 'specificity': 0.95580363, 'f1': 0.9557793, 'auroc': 0.9968575, 'binary_precision': 0.926423, 'binary_recall': 0.9904084, 'binary_specificity': 0.9211988, 'binary_f1_score': 0.95734775}
confusion matrix:
       0      1
0  23392   2001
1    244  25195
---- Validation: 
scalar performance:
{'acc': 0.90305436, 'precision': 0.5768628, 'recall': 0.79770696, 'specificity': 0.79770696, 'f1': 0.60549635, 'auroc': 0.8705213, 'binary_precision': 0.16254805, 'binary_recall': 0.68677497, 'binary_specificity': 0.9086389, 'binary_f1_score': 0.26287743}
confusion matrix:
       0     1
0  15167  1525
1    135   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9247845, 'precision': 0.62923485, 'recall': 0.50110674, 'specificity': 0.50110674, 'f1': 0.4830785, 'auroc': 0.8631979, 'binary_precision': 0.33333334, 'binary_recall': 0.002642008, 'binary_specificity': 0.99957144, 'binary_f1_score': 0.005242464}
confusion matrix:
      0  1
0  9330  4
1   755  2
new oracle model saved
early stop counter: 2
val acc:0.9030543565750122, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9247844815254211
after epoch: 4,now: 2024-08-10 04:50:29.377407,epoch time: 0:17:44.980591,used: 1:11:19.136850,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9544578, 'precision': 0.95742345, 'recall': 0.9544247, 'specificity': 0.9544247, 'f1': 0.9543815, 'auroc': 0.99699867, 'binary_precision': 0.9207978, 'binary_recall': 0.9945355, 'binary_specificity': 0.91431385, 'binary_f1_score': 0.95624727}
confusion matrix:
       0      1
0  23219   2176
1    139  25298
---- Validation: 
scalar performance:
{'acc': 0.8629913, 'precision': 0.56290627, 'recall': 0.83027464, 'specificity': 0.83027464, 'f1': 0.57554734, 'auroc': 0.87873805, 'binary_precision': 0.13187236, 'binary_recall': 0.7958237, 'binary_specificity': 0.8647256, 'binary_f1_score': 0.22625329}
confusion matrix:
       0     1
0  14434  2258
1     88   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9255772, 'precision': 0.74622244, 'recall': 0.5161017, 'specificity': 0.5161017, 'f1': 0.5130019, 'auroc': 0.8763671, 'binary_precision': 0.5652174, 'binary_recall': 0.034346104, 'binary_specificity': 0.9978573, 'binary_f1_score': 0.06475716}
confusion matrix:
      0   1
0  9314  20
1   731  26
new oracle model saved
early stop counter: 3
val acc:0.8629912734031677, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9255772233009338
after epoch: 5,now: 2024-08-10 05:07:57.047704,epoch time: 0:17:27.670297,used: 1:28:46.807147,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9385033, 'precision': 0.9446956, 'recall': 0.9384546, 'specificity': 0.9384546, 'f1': 0.9382838, 'auroc': 0.99749196, 'binary_precision': 0.8924262, 'binary_recall': 0.99732673, 'binary_specificity': 0.8795826, 'binary_f1_score': 0.941965}
confusion matrix:
       0      1
0  22337   3058
1     68  25369
---- Validation: 
scalar performance:
{'acc': 0.821293, 'precision': 0.5526949, 'recall': 0.8394009, 'specificity': 0.8394009, 'f1': 0.54711556, 'auroc': 0.88889897, 'binary_precision': 0.10982487, 'binary_recall': 0.85846865, 'binary_specificity': 0.8203331, 'binary_f1_score': 0.19473684}
confusion matrix:
       0     1
0  13693  2999
1     61   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9279556, 'precision': 0.8249754, 'recall': 0.5313468, 'specificity': 0.5313468, 'f1': 0.5406152, 'auroc': 0.84800166, 'binary_precision': 0.7205882, 'binary_recall': 0.06472919, 'binary_specificity': 0.99796444, 'binary_f1_score': 0.11878787}
confusion matrix:
      0   1
0  9315  19
1   708  49
new oracle model saved
early stop counter: 4
val acc:0.8212929964065552, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 6,now: 2024-08-10 05:25:42.326611,epoch time: 0:17:45.278907,used: 1:46:32.086054,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9578022, 'precision': 0.9604275, 'recall': 0.9577755, 'specificity': 0.9577755, 'f1': 0.9577402, 'auroc': 0.9980476, 'binary_precision': 0.9258365, 'binary_recall': 0.99539983, 'binary_specificity': 0.9201512, 'binary_f1_score': 0.9593589}
confusion matrix:
       0      1
0  23370   2028
1    117  25317
---- Validation: 
scalar performance:
{'acc': 0.87011623, 'precision': 0.5676062, 'recall': 0.8429702, 'specificity': 0.8429702, 'f1': 0.5844545, 'auroc': 0.88538206, 'binary_precision': 0.14068136, 'binary_recall': 0.8143852, 'binary_specificity': 0.8715552, 'binary_f1_score': 0.23991796}
confusion matrix:
       0     1
0  14548  2144
1     80   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.8264836, 'recall': 0.5051233, 'specificity': 0.5051233, 'f1': 0.4910492, 'auroc': 0.83122015, 'binary_precision': 0.72727275, 'binary_recall': 0.010568032, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.020833334}
confusion matrix:
      0  1
0  9331  3
1   749  8
early stop counter: 5
val acc:0.8701162338256836, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 7,now: 2024-08-10 05:43:15.006821,epoch time: 0:17:32.680210,used: 2:04:04.766264,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.949579, 'precision': 0.953454, 'recall': 0.94954455, 'specificity': 0.94954455, 'f1': 0.9494683, 'auroc': 0.997671, 'binary_precision': 0.91172236, 'binary_recall': 0.9956359, 'binary_specificity': 0.9034532, 'binary_f1_score': 0.95183325}
confusion matrix:
       0      1
0  22945   2452
1    111  25324
---- Validation: 
scalar performance:
{'acc': 0.85551596, 'precision': 0.55579126, 'recall': 0.8004473, 'specificity': 0.8004473, 'f1': 0.5630277, 'auroc': 0.85797393, 'binary_precision': 0.119269475, 'binary_recall': 0.7424594, 'binary_specificity': 0.85843515, 'binary_f1_score': 0.20552343}
confusion matrix:
       0     1
0  14329  2363
1    111   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92528, 'precision': 0.862671, 'recall': 0.50258845, 'specificity': 0.50258845, 'f1': 0.48583636, 'auroc': 0.8196092, 'binary_precision': 0.8, 'binary_recall': 0.005284016, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.010498689}
confusion matrix:
      0  1
0  9333  1
1   753  4
early stop counter: 6
val acc:0.8555159568786621, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 8,now: 2024-08-10 06:00:27.036479,epoch time: 0:17:12.029658,used: 2:21:16.795922,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93415564, 'precision': 0.9413911, 'recall': 0.93410283, 'specificity': 0.93410283, 'f1': 0.93387914, 'auroc': 0.9973035, 'binary_precision': 0.88508475, 'binary_recall': 0.997995, 'binary_specificity': 0.87021065, 'binary_f1_score': 0.9381548}
confusion matrix:
       0      1
0  22099   3296
1     51  25386
---- Validation: 
scalar performance:
{'acc': 0.8330316, 'precision': 0.5511289, 'recall': 0.80925727, 'specificity': 0.80925727, 'f1': 0.54906845, 'auroc': 0.85793746, 'binary_precision': 0.108891755, 'binary_recall': 0.7842227, 'binary_specificity': 0.8342919, 'binary_f1_score': 0.19123057}
confusion matrix:
       0     1
0  13926  2766
1     93   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92488354, 'precision': 0.7096604, 'recall': 0.5181545, 'specificity': 0.5181545, 'f1': 0.5171024, 'auroc': 0.76266253, 'binary_precision': 0.4918033, 'binary_recall': 0.03963012, 'binary_specificity': 0.9966788, 'binary_f1_score': 0.07334964}
confusion matrix:
      0   1
0  9303  31
1   727  30
early stop counter: 7
val acc:0.8330315947532654, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 9,now: 2024-08-10 06:18:05.348230,epoch time: 0:17:38.311751,used: 2:38:55.107673,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9325425, 'precision': 0.94005865, 'recall': 0.9324912, 'specificity': 0.9324912, 'f1': 0.93224764, 'auroc': 0.99747515, 'binary_precision': 0.8827438, 'binary_recall': 0.99771976, 'binary_specificity': 0.86726254, 'binary_f1_score': 0.9367168}
confusion matrix:
       0      1
0  22025   3371
1     58  25378
---- Validation: 
scalar performance:
{'acc': 0.82456344, 'precision': 0.5480336, 'recall': 0.80039334, 'specificity': 0.80039334, 'f1': 0.5418319, 'auroc': 0.85066915, 'binary_precision': 0.10305461, 'binary_recall': 0.774942, 'binary_specificity': 0.8258447, 'binary_f1_score': 0.1819172}
confusion matrix:
       0     1
0  13785  2907
1     97   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92537904, 'precision': 0.77542806, 'recall': 0.5062836, 'specificity': 0.5062836, 'f1': 0.4935384, 'auroc': 0.80939394, 'binary_precision': 0.625, 'binary_recall': 0.01321004, 'binary_specificity': 0.99935716, 'binary_f1_score': 0.025873221}
confusion matrix:
      0   1
0  9328   6
1   747  10
early stop counter: 8
val acc:0.8245634436607361, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 10,now: 2024-08-10 06:35:32.984260,epoch time: 0:17:27.636030,used: 2:56:22.743703,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.93063426, 'precision': 0.9383434, 'recall': 0.93058217, 'specificity': 0.93058217, 'f1': 0.9303222, 'auroc': 0.9961802, 'binary_precision': 0.88040835, 'binary_recall': 0.9967762, 'binary_specificity': 0.8643881, 'binary_f1_score': 0.9349854}
confusion matrix:
       0      1
0  21952   3444
1     82  25354
---- Validation: 
scalar performance:
{'acc': 0.83717805, 'precision': 0.5449131, 'recall': 0.76052785, 'specificity': 0.76052785, 'f1': 0.54168636, 'auroc': 0.82225984, 'binary_precision': 0.09955827, 'binary_recall': 0.6798144, 'binary_specificity': 0.8412413, 'binary_f1_score': 0.1736811}
confusion matrix:
       0     1
0  14042  2650
1    138   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92458624, 'precision': 0.6882375, 'recall': 0.51071054, 'specificity': 0.51071054, 'f1': 0.5029561, 'auroc': 0.7642151, 'binary_precision': 0.45, 'binary_recall': 0.023778072, 'binary_specificity': 0.99764305, 'binary_f1_score': 0.045169383}
confusion matrix:
      0   1
0  9312  22
1   739  18
early stop counter: 9
val acc:0.8371780514717102, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 11,now: 2024-08-10 06:52:54.305368,epoch time: 0:17:21.321108,used: 3:13:44.064811,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9187323, 'precision': 0.9296427, 'recall': 0.9186634, 'specificity': 0.9186634, 'f1': 0.918204, 'auroc': 0.9973607, 'binary_precision': 0.86139286, 'binary_recall': 0.998231, 'binary_specificity': 0.83909583, 'binary_f1_score': 0.9247774}
confusion matrix:
       0      1
0  21308   4086
1     45  25393
---- Validation: 
scalar performance:
{'acc': 0.75985515, 'precision': 0.53810936, 'recall': 0.7965874, 'specificity': 0.7965874, 'f1': 0.50460464, 'auroc': 0.859333, 'binary_precision': 0.08179959, 'binary_recall': 0.8352668, 'binary_specificity': 0.757908, 'binary_f1_score': 0.14900662}
confusion matrix:
       0     1
0  12651  4041
1     71   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92418987, 'precision': 0.66978705, 'recall': 0.5111032, 'specificity': 0.5111032, 'f1': 0.5039234, 'auroc': 0.816474, 'binary_precision': 0.41304347, 'binary_recall': 0.025099074, 'binary_specificity': 0.9971073, 'binary_f1_score': 0.04732254}
confusion matrix:
      0   1
0  9307  27
1   738  19
early stop counter: 10
val acc:0.7598551511764526, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 12,now: 2024-08-10 07:10:22.986375,epoch time: 0:17:28.681007,used: 3:31:12.745818,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8982531, 'precision': 0.9152354, 'recall': 0.8981736, 'specificity': 0.8981736, 'f1': 0.89718866, 'auroc': 0.9967047, 'binary_precision': 0.83145773, 'binary_recall': 0.9992137, 'binary_specificity': 0.7971334, 'binary_f1_score': 0.9076494}
confusion matrix:
       0      1
0  20244   5152
1     20  25416
---- Validation: 
scalar performance:
{'acc': 0.70145416, 'precision': 0.5317639, 'recall': 0.7801946, 'specificity': 0.7801946, 'f1': 0.47349292, 'auroc': 0.8422042, 'binary_precision': 0.068571426, 'binary_recall': 0.86310905, 'binary_specificity': 0.6972801, 'binary_f1_score': 0.12704918}
confusion matrix:
       0     1
0  11639  5053
1     59   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90922606, 'precision': 0.56179065, 'recall': 0.52243644, 'specificity': 0.52243644, 'f1': 0.5261993, 'auroc': 0.7434602, 'binary_precision': 0.1954023, 'binary_recall': 0.067371204, 'binary_specificity': 0.97750163, 'binary_f1_score': 0.10019646}
confusion matrix:
      0    1
0  9124  210
1   706   51
early stop counter: 11
val acc:0.7014541625976562, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 13,now: 2024-08-10 07:27:41.561640,epoch time: 0:17:18.575265,used: 3:48:31.321083,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92339474, 'precision': 0.9331952, 'recall': 0.9233327, 'specificity': 0.9233327, 'f1': 0.92295134, 'auroc': 0.997543, 'binary_precision': 0.8682438, 'binary_recall': 0.9984275, 'binary_specificity': 0.8482378, 'binary_f1_score': 0.9287961}
confusion matrix:
       0      1
0  21541   3854
1     40  25397
---- Validation: 
scalar performance:
{'acc': 0.8061671, 'precision': 0.5435385, 'recall': 0.7920878, 'specificity': 0.7920878, 'f1': 0.52913415, 'auroc': 0.8352997, 'binary_precision': 0.09415402, 'binary_recall': 0.77726215, 'binary_specificity': 0.8069135, 'binary_f1_score': 0.16796191}
confusion matrix:
       0     1
0  13469  3223
1     96   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90337926, 'precision': 0.5424453, 'recall': 0.518669, 'specificity': 0.518669, 'f1': 0.52099746, 'auroc': 0.73507595, 'binary_precision': 0.1572327, 'binary_recall': 0.0660502, 'binary_specificity': 0.9712878, 'binary_f1_score': 0.093023255}
confusion matrix:
      0    1
0  9066  268
1   707   50
early stop counter: 12
val acc:0.8061671257019043, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 14,now: 2024-08-10 07:45:01.869156,epoch time: 0:17:20.307516,used: 4:05:51.628599,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92490953, 'precision': 0.934334, 'recall': 0.92484874, 'specificity': 0.92484874, 'f1': 0.9244926, 'auroc': 0.99761134, 'binary_precision': 0.8705608, 'binary_recall': 0.9983882, 'binary_specificity': 0.8513093, 'binary_f1_score': 0.9301031}
confusion matrix:
       0      1
0  21619   3776
1     41  25396
---- Validation: 
scalar performance:
{'acc': 0.7852596, 'precision': 0.5391388, 'recall': 0.7813641, 'specificity': 0.7813641, 'f1': 0.5155743, 'auroc': 0.83397734, 'binary_precision': 0.08554648, 'binary_recall': 0.77726215, 'binary_specificity': 0.7854661, 'binary_f1_score': 0.1541293}
confusion matrix:
       0     1
0  13111  3581
1     96   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9153701, 'precision': 0.5784073, 'recall': 0.51968825, 'specificity': 0.51968825, 'f1': 0.521617, 'auroc': 0.72875, 'binary_precision': 0.22905028, 'binary_recall': 0.05416116, 'binary_specificity': 0.98521537, 'binary_f1_score': 0.08760684}
confusion matrix:
      0    1
0  9196  138
1   716   41
early stop counter: 13
val acc:0.7852596044540405, best validation acc: 0.9278748035430908, corresponding to test acc:                         0.9200277328491211 / 0.9279556274414062
after epoch: 15,now: 2024-08-10 08:02:22.037252,epoch time: 0:17:20.168096,used: 4:23:11.796695,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_39_09_seed_1_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:23:11.796695 at 2024-08-10 08:02:22.037252
persisted model performance metric: 

scalar performance:
{'acc': 0.92002773, 'precision': 0.6836222, 'recall': 0.58957565, 'specificity': 0.58957565, 'f1': 0.6156559, 'auroc': 0.90053564, 'binary_precision': 0.42937854, 'binary_recall': 0.2007926, 'binary_specificity': 0.9783587, 'binary_f1_score': 0.27362737}
confusion matrix:
      0    1
0  9132  202
1   605  152
oracle model performance metric: 

scalar performance:
{'acc': 0.9279556, 'precision': 0.8249754, 'recall': 0.5313468, 'specificity': 0.5313468, 'f1': 0.5406152, 'auroc': 0.84800166, 'binary_precision': 0.7205882, 'binary_recall': 0.06472919, 'binary_specificity': 0.99796444, 'binary_f1_score': 0.11878787}
confusion matrix:
      0   1
0  9315  19
1   708  49
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493800 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool | 403264 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |  90536 KiB |    125 MiB |   1855 GiB |   1854 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493800 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool | 403264 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |  90536 KiB |    125 MiB |   1855 GiB |   1854 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10880 MiB | 669615 GiB | 669615 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 667782 GiB | 667781 GiB |
|       from small pool |  88912 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11506 MiB |  11506 MiB |  21780 MiB |  10274 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  21624 MiB |  10244 MiB |
|       from small pool |    126 MiB |    128 MiB |    156 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    807 MiB |   1335 MiB | 284405 GiB | 284404 GiB |
|       from large pool |    798 MiB |   1332 MiB | 282186 GiB | 282185 GiB |
|       from small pool |      9 MiB |     26 MiB |   2219 GiB |   2219 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7600    |  114013 K  |  114008 K  |
|       from large pool |      87    |     908    |   42321 K  |   42321 K  |
|       from small pool |    5076    |    7511    |   71692 K  |   71687 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7600    |  114013 K  |  114008 K  |
|       from large pool |      87    |     908    |   42321 K  |   42321 K  |
|       from small pool |    5076    |    7511    |   71692 K  |   71687 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     408    |     737    |     329    |
|       from large pool |     345    |     345    |     659    |     314    |
|       from small pool |      63    |      64    |      78    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3212    |   61143 K  |   61143 K  |
|       from large pool |      24    |     197    |   26772 K  |   26772 K  |
|       from small pool |      52    |    3186    |   34371 K  |   34371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 669615 GiB | 669615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 667782 GiB | 667782 GiB |
|       from small pool |      0 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1290 MiB |  11506 MiB |  21780 MiB |  20490 MiB |
|       from large pool |   1192 MiB |  11380 MiB |  21624 MiB |  20432 MiB |
|       from small pool |     98 MiB |    128 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1335 MiB | 284405 GiB | 284405 GiB |
|       from large pool |  50944 KiB |   1332 MiB | 282186 GiB | 282186 GiB |
|       from small pool |      0 KiB |     32 MiB |   2219 GiB |   2219 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  114013 K  |  114013 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71692 K  |   71692 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  114013 K  |  114013 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71692 K  |   71692 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     408    |     737    |     653    |
|       from large pool |      35    |     345    |     659    |     624    |
|       from small pool |      49    |      64    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3212    |   61146 K  |   61146 K  |
|       from large pool |       4    |     197    |   26772 K  |   26772 K  |
|       from small pool |       0    |    3186    |   34373 K  |   34373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 678401 GiB | 678401 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676546 GiB | 676546 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 669615 GiB | 669615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 667782 GiB | 667782 GiB |
|       from small pool |      0 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1290 MiB |  11506 MiB |  21780 MiB |  20490 MiB |
|       from large pool |   1192 MiB |  11380 MiB |  21624 MiB |  20432 MiB |
|       from small pool |     98 MiB |    128 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1335 MiB | 284405 GiB | 284405 GiB |
|       from large pool |  50944 KiB |   1332 MiB | 282186 GiB | 282186 GiB |
|       from small pool |      0 KiB |     32 MiB |   2219 GiB |   2219 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  114013 K  |  114013 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71692 K  |   71692 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  114013 K  |  114013 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71692 K  |   71692 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     408    |     737    |     653    |
|       from large pool |      35    |     345    |     659    |     624    |
|       from small pool |      49    |      64    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3212    |   61146 K  |   61146 K  |
|       from large pool |       4    |     197    |   26772 K  |   26772 K  |
|       from small pool |       0    |    3186    |   34373 K  |   34373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725

 Experiment start at: 2024-08-10 08:23:48.639255
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9690885, 'precision': 0.96946514, 'recall': 0.9690907, 'specificity': 0.9690907, 'f1': 0.96908236, 'auroc': 0.9946915, 'binary_precision': 0.9828012, 'binary_recall': 0.9548971, 'binary_specificity': 0.9832843, 'binary_f1_score': 0.9686482}
confusion matrix:
       0      1
0  25412    432
1   1166  24686
---- Validation: 
scalar performance:
{'acc': 0.9661294, 'precision': 0.6808319, 'recall': 0.771551, 'specificity': 0.771551, 'f1': 0.7161212, 'auroc': 0.86735225, 'binary_precision': 0.3726415, 'binary_recall': 0.56698567, 'binary_specificity': 0.97611636, 'binary_f1_score': 0.44971538}
confusion matrix:
       0    1
0  16307  399
1    181  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239001, 'precision': 0.73964655, 'recall': 0.6093893, 'specificity': 0.6093893, 'f1': 0.6441676, 'auroc': 0.8392173, 'binary_precision': 0.54178673, 'binary_recall': 0.23588456, 'binary_specificity': 0.982894, 'binary_f1_score': 0.32867134}
confusion matrix:
      0    1
0  9136  159
1   609  188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 08:42:27.323280,epoch time: 0:18:38.684025,used: 0:18:38.684025,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97429204, 'precision': 0.9748193, 'recall': 0.9742888, 'specificity': 0.9742888, 'f1': 0.97428477, 'auroc': 0.99784184, 'binary_precision': 0.95904464, 'binary_recall': 0.9909102, 'binary_specificity': 0.95766747, 'binary_f1_score': 0.9747171}
confusion matrix:
       0      1
0  24749   1094
1    235  25618
---- Validation: 
scalar performance:
{'acc': 0.927295, 'precision': 0.60726935, 'recall': 0.8554436, 'specificity': 0.8554436, 'f1': 0.6526082, 'auroc': 0.9100645, 'binary_precision': 0.2204192, 'binary_recall': 0.7799043, 'binary_specificity': 0.9309829, 'binary_f1_score': 0.34370056}
confusion matrix:
       0     1
0  15553  1153
1     92   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230083, 'precision': 0.7329066, 'recall': 0.68518865, 'specificity': 0.68518865, 'f1': 0.70551217, 'auroc': 0.89679396, 'binary_precision': 0.51607716, 'binary_recall': 0.40276036, 'binary_specificity': 0.967617, 'binary_f1_score': 0.45243126}
confusion matrix:
      0    1
0  8994  301
1   476  321
early stop counter: 1
val acc:0.9272950291633606, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 2,now: 2024-08-10 09:00:12.086240,epoch time: 0:17:44.762960,used: 0:36:23.446985,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96104145, 'precision': 0.96274835, 'recall': 0.9610368, 'specificity': 0.9610368, 'f1': 0.9610052, 'auroc': 0.99760914, 'binary_precision': 0.9346827, 'binary_recall': 0.99137396, 'binary_specificity': 0.9306996, 'binary_f1_score': 0.9621941}
confusion matrix:
       0      1
0  24053   1791
1    223  25629
---- Validation: 
scalar performance:
{'acc': 0.8844312, 'precision': 0.5711469, 'recall': 0.83697414, 'specificity': 0.83697414, 'f1': 0.5934606, 'auroc': 0.91054296, 'binary_precision': 0.14826499, 'binary_recall': 0.78708136, 'binary_specificity': 0.886867, 'binary_f1_score': 0.24952598}
confusion matrix:
       0     1
0  14816  1890
1     89   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91874754, 'precision': 0.69605386, 'recall': 0.5744727, 'specificity': 0.5744727, 'f1': 0.60030526, 'auroc': 0.859853, 'binary_precision': 0.4599303, 'binary_recall': 0.16562107, 'binary_specificity': 0.98332435, 'binary_f1_score': 0.24354243}
confusion matrix:
      0    1
0  9140  155
1   665  132
early stop counter: 2
val acc:0.8844311833381653, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 3,now: 2024-08-10 09:17:58.769300,epoch time: 0:17:46.683060,used: 0:54:10.130045,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9613316, 'precision': 0.96327776, 'recall': 0.9613254, 'specificity': 0.9613254, 'f1': 0.9612906, 'auroc': 0.9980916, 'binary_precision': 0.9332994, 'binary_recall': 0.99369514, 'binary_specificity': 0.9289556, 'binary_f1_score': 0.9625508}
confusion matrix:
       0      1
0  24007   1836
1    163  25690
---- Validation: 
scalar performance:
{'acc': 0.8809273, 'precision': 0.5666992, 'recall': 0.8200172, 'specificity': 0.8200172, 'f1': 0.5860216, 'auroc': 0.8939879, 'binary_precision': 0.14025743, 'binary_recall': 0.75598085, 'binary_specificity': 0.88405365, 'binary_f1_score': 0.2366155}
confusion matrix:
       0     1
0  14769  1937
1    102   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9208284, 'precision': 0.7074255, 'recall': 0.5274233, 'specificity': 0.5274233, 'f1': 0.53292, 'auroc': 0.88201606, 'binary_precision': 0.48979592, 'binary_recall': 0.060225848, 'binary_specificity': 0.99462074, 'binary_f1_score': 0.10726257}
confusion matrix:
      0   1
0  9245  50
1   749  48
early stop counter: 3
val acc:0.880927324295044, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 4,now: 2024-08-10 09:35:45.477494,epoch time: 0:17:46.708194,used: 1:11:56.838239,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9547741, 'precision': 0.95736474, 'recall': 0.95476973, 'specificity': 0.95476973, 'f1': 0.95470965, 'auroc': 0.9976334, 'binary_precision': 0.9229718, 'binary_recall': 0.9923794, 'binary_specificity': 0.91716, 'binary_f1_score': 0.95641804}
confusion matrix:
       0      1
0  23704   2141
1    197  25654
---- Validation: 
scalar performance:
{'acc': 0.88057697, 'precision': 0.56020457, 'recall': 0.7825179, 'specificity': 0.7825179, 'f1': 0.57636553, 'auroc': 0.8749038, 'binary_precision': 0.12938496, 'binary_recall': 0.67942584, 'binary_specificity': 0.88561, 'binary_f1_score': 0.21737465}
confusion matrix:
       0     1
0  14795  1911
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92023385, 'precision': 0.66779983, 'recall': 0.5104673, 'specificity': 0.5104673, 'f1': 0.5017278, 'auroc': 0.86097616, 'binary_precision': 0.41304347, 'binary_recall': 0.023839397, 'binary_specificity': 0.9970952, 'binary_f1_score': 0.045077108}
confusion matrix:
      0   1
0  9268  27
1   778  19
early stop counter: 4
val acc:0.8805769681930542, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 5,now: 2024-08-10 09:53:25.332053,epoch time: 0:17:39.854559,used: 1:29:36.692798,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94115597, 'precision': 0.9467571, 'recall': 0.9411452, 'specificity': 0.9411452, 'f1': 0.94096994, 'auroc': 0.9983511, 'binary_precision': 0.89678204, 'binary_recall': 0.997099, 'binary_specificity': 0.8851913, 'binary_f1_score': 0.94428366}
confusion matrix:
       0      1
0  22876   2967
1     75  25778
---- Validation: 
scalar performance:
{'acc': 0.82959586, 'precision': 0.5508212, 'recall': 0.82286537, 'specificity': 0.82286537, 'f1': 0.5471171, 'auroc': 0.8853655, 'binary_precision': 0.10716531, 'binary_recall': 0.81578946, 'binary_specificity': 0.82994133, 'binary_f1_score': 0.18944445}
confusion matrix:
       0     1
0  13865  2841
1     77   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92221564, 'precision': 0.79055464, 'recall': 0.5149845, 'specificity': 0.5149845, 'f1': 0.5096548, 'auroc': 0.8222984, 'binary_precision': 0.65789473, 'binary_recall': 0.03136763, 'binary_specificity': 0.9986014, 'binary_f1_score': 0.059880238}
confusion matrix:
      0   1
0  9282  13
1   772  25
early stop counter: 5
val acc:0.8295958638191223, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 6,now: 2024-08-10 10:11:02.249013,epoch time: 0:17:36.916960,used: 1:47:13.609758,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94537294, 'precision': 0.94985557, 'recall': 0.9453633, 'specificity': 0.9453633, 'f1': 0.9452357, 'auroc': 0.99787116, 'binary_precision': 0.90499806, 'binary_recall': 0.99524236, 'binary_specificity': 0.89548427, 'binary_f1_score': 0.9479773}
confusion matrix:
       0      1
0  23142   2701
1    123  25730
---- Validation: 
scalar performance:
{'acc': 0.8629409, 'precision': 0.5505837, 'recall': 0.7629831, 'specificity': 0.7629831, 'f1': 0.55749476, 'auroc': 0.8599648, 'binary_precision': 0.11093183, 'binary_recall': 0.65789473, 'binary_specificity': 0.8680714, 'binary_f1_score': 0.18985157}
confusion matrix:
       0     1
0  14502  2204
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92132384, 'precision': 0.7269212, 'recall': 0.51507396, 'specificity': 0.51507396, 'f1': 0.51020336, 'auroc': 0.81999946, 'binary_precision': 0.53061223, 'binary_recall': 0.032622334, 'binary_specificity': 0.9975256, 'binary_f1_score': 0.06146572}
confusion matrix:
      0   1
0  9272  23
1   771  26
early stop counter: 6
val acc:0.8629409074783325, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 7,now: 2024-08-10 10:28:38.895033,epoch time: 0:17:36.646020,used: 2:04:50.255778,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9325673, 'precision': 0.94012964, 'recall': 0.93255466, 'specificity': 0.93255466, 'f1': 0.93227506, 'auroc': 0.99844646, 'binary_precision': 0.88248575, 'binary_recall': 0.998066, 'binary_specificity': 0.8670433, 'binary_f1_score': 0.936724}
confusion matrix:
       0      1
0  22407   3436
1     50  25803
---- Validation: 
scalar performance:
{'acc': 0.793915, 'precision': 0.5443733, 'recall': 0.82323843, 'specificity': 0.82323843, 'f1': 0.52533174, 'auroc': 0.8913936, 'binary_precision': 0.093333334, 'binary_recall': 0.85406697, 'binary_specificity': 0.7924099, 'binary_f1_score': 0.16827716}
confusion matrix:
       0     1
0  13238  3468
1     61   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92281014, 'precision': 0.78261805, 'recall': 0.5244842, 'specificity': 0.5244842, 'f1': 0.52746177, 'auroc': 0.8134146, 'binary_precision': 0.640625, 'binary_recall': 0.05144291, 'binary_specificity': 0.9975256, 'binary_f1_score': 0.09523809}
confusion matrix:
      0   1
0  9272  23
1   756  41
early stop counter: 7
val acc:0.7939149737358093, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 8,now: 2024-08-10 10:46:20.513042,epoch time: 0:17:41.618009,used: 2:22:31.873787,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93148404, 'precision': 0.93923736, 'recall': 0.9314712, 'specificity': 0.9314712, 'f1': 0.93117905, 'auroc': 0.9976761, 'binary_precision': 0.8809288, 'binary_recall': 0.9978726, 'binary_specificity': 0.86506987, 'binary_f1_score': 0.9357612}
confusion matrix:
       0      1
0  22356   3487
1     55  25798
---- Validation: 
scalar performance:
{'acc': 0.80594486, 'precision': 0.539541, 'recall': 0.77109176, 'specificity': 0.77109176, 'f1': 0.5231631, 'auroc': 0.82982445, 'binary_precision': 0.087240696, 'binary_recall': 0.73444974, 'binary_specificity': 0.8077338, 'binary_f1_score': 0.15595631}
confusion matrix:
       0     1
0  13494  3212
1    111   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92241377, 'precision': 0.8037623, 'recall': 0.51566565, 'specificity': 0.51566565, 'f1': 0.51090413, 'auroc': 0.78446776, 'binary_precision': 0.68421054, 'binary_recall': 0.032622334, 'binary_specificity': 0.99870896, 'binary_f1_score': 0.062275447}
confusion matrix:
      0   1
0  9283  12
1   771  26
early stop counter: 8
val acc:0.8059448599815369, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 9,now: 2024-08-10 11:03:57.745449,epoch time: 0:17:37.232407,used: 2:40:09.106194,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9382737, 'precision': 0.9446728, 'recall': 0.9382645, 'specificity': 0.9382645, 'f1': 0.93805, 'auroc': 0.99766994, 'binary_precision': 0.89136815, 'binary_recall': 0.9982206, 'binary_specificity': 0.8783083, 'binary_f1_score': 0.94177324}
confusion matrix:
       0      1
0  22699   3145
1     46  25806
---- Validation: 
scalar performance:
{'acc': 0.8492759, 'precision': 0.5476983, 'recall': 0.76880825, 'specificity': 0.76880825, 'f1': 0.54920536, 'auroc': 0.85945237, 'binary_precision': 0.10457038, 'binary_recall': 0.68421054, 'binary_specificity': 0.85340595, 'binary_f1_score': 0.18141451}
confusion matrix:
       0     1
0  14257  2449
1    132   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9196393, 'precision': 0.688123, 'recall': 0.5353812, 'specificity': 0.5353812, 'f1': 0.5461676, 'auroc': 0.82557786, 'binary_precision': 0.45, 'binary_recall': 0.07904642, 'binary_specificity': 0.99171597, 'binary_f1_score': 0.13447171}
confusion matrix:
      0   1
0  9218  77
1   734  63
early stop counter: 9
val acc:0.8492758870124817, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 10,now: 2024-08-10 11:21:37.042106,epoch time: 0:17:39.296657,used: 2:57:48.402851,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94092387, 'precision': 0.94664466, 'recall': 0.94091725, 'specificity': 0.94091725, 'f1': 0.9407335, 'auroc': 0.9974056, 'binary_precision': 0.89612514, 'binary_recall': 0.9974856, 'binary_specificity': 0.884349, 'binary_f1_score': 0.9440926}
confusion matrix:
       0      1
0  22856   2989
1     65  25786
---- Validation: 
scalar performance:
{'acc': 0.8428521, 'precision': 0.5480702, 'recall': 0.7818434, 'specificity': 0.7818434, 'f1': 0.5476942, 'auroc': 0.85332, 'binary_precision': 0.10442047, 'binary_recall': 0.71770334, 'binary_specificity': 0.8459835, 'binary_f1_score': 0.1823154}
confusion matrix:
       0     1
0  14133  2573
1    118   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9207293, 'precision': 0.69546616, 'recall': 0.51245695, 'specificity': 0.51245695, 'f1': 0.5053838, 'auroc': 0.8290912, 'binary_precision': 0.4680851, 'binary_recall': 0.027603513, 'binary_specificity': 0.9973104, 'binary_f1_score': 0.0521327}
confusion matrix:
      0   1
0  9270  25
1   775  22
early stop counter: 10
val acc:0.8428521156311035, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 11,now: 2024-08-10 11:39:18.451160,epoch time: 0:17:41.409054,used: 3:15:29.811905,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92645466, 'precision': 0.93545884, 'recall': 0.92644906, 'specificity': 0.92644906, 'f1': 0.9260719, 'auroc': 0.9974891, 'binary_precision': 0.8728607, 'binary_recall': 0.99833655, 'binary_specificity': 0.8545616, 'binary_f1_score': 0.93139166}
confusion matrix:
       0      1
0  22087   3759
1     43  25807
---- Validation: 
scalar performance:
{'acc': 0.8168068, 'precision': 0.5457848, 'recall': 0.8046484, 'specificity': 0.8046484, 'f1': 0.5356158, 'auroc': 0.86009014, 'binary_precision': 0.09790003, 'binary_recall': 0.791866, 'binary_specificity': 0.81743085, 'binary_f1_score': 0.17425638}
confusion matrix:
       0     1
0  13656  3050
1     87   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92092746, 'precision': 0.7040782, 'recall': 0.5096967, 'specificity': 0.5096967, 'f1': 0.4998147, 'auroc': 0.8270067, 'binary_precision': 0.4857143, 'binary_recall': 0.021329988, 'binary_specificity': 0.9980635, 'binary_f1_score': 0.040865388}
confusion matrix:
      0   1
0  9277  18
1   780  17
early stop counter: 11
val acc:0.8168067932128906, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 12,now: 2024-08-10 11:56:58.236875,epoch time: 0:17:39.785715,used: 3:33:09.597620,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9387187, 'precision': 0.9449508, 'recall': 0.93870264, 'specificity': 0.93870264, 'f1': 0.9385018, 'auroc': 0.9978702, 'binary_precision': 0.8923593, 'binary_recall': 0.9978341, 'binary_specificity': 0.8795712, 'binary_f1_score': 0.9421539}
confusion matrix:
       0      1
0  22729   3112
1     56  25799
---- Validation: 
scalar performance:
{'acc': 0.8446625, 'precision': 0.54985666, 'recall': 0.7909349, 'specificity': 0.7909349, 'f1': 0.5508299, 'auroc': 0.8634176, 'binary_precision': 0.107493, 'binary_recall': 0.73444974, 'binary_specificity': 0.8474201, 'binary_f1_score': 0.18753819}
confusion matrix:
       0     1
0  14157  2549
1    111   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212247, 'precision': 0.72239655, 'recall': 0.51387304, 'specificity': 0.51387304, 'f1': 0.5079175, 'auroc': 0.855834, 'binary_precision': 0.5217391, 'binary_recall': 0.030112924, 'binary_specificity': 0.99763316, 'binary_f1_score': 0.056939505}
confusion matrix:
      0   1
0  9273  22
1   773  24
early stop counter: 12
val acc:0.8446624875068665, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 13,now: 2024-08-10 12:14:43.764299,epoch time: 0:17:45.527424,used: 3:50:55.125044,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9426455, 'precision': 0.94815814, 'recall': 0.94263685, 'specificity': 0.94263685, 'f1': 0.9424678, 'auroc': 0.9982879, 'binary_precision': 0.89849216, 'binary_recall': 0.9980659, 'binary_specificity': 0.88720787, 'binary_f1_score': 0.9456651}
confusion matrix:
       0      1
0  22929   2915
1     50  25802
---- Validation: 
scalar performance:
{'acc': 0.84711516, 'precision': 0.5499755, 'recall': 0.78752697, 'specificity': 0.78752697, 'f1': 0.55178946, 'auroc': 0.8630248, 'binary_precision': 0.107982896, 'binary_recall': 0.7248804, 'binary_specificity': 0.8501736, 'binary_f1_score': 0.18796526}
confusion matrix:
       0     1
0  14203  2503
1    115   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9199366, 'precision': 0.6857096, 'recall': 0.52579206, 'specificity': 0.52579206, 'f1': 0.53016114, 'auroc': 0.8225918, 'binary_precision': 0.44660193, 'binary_recall': 0.057716437, 'binary_specificity': 0.9938677, 'binary_f1_score': 0.10222223}
confusion matrix:
      0   1
0  9238  57
1   751  46
early stop counter: 13
val acc:0.847115159034729, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 14,now: 2024-08-10 12:32:34.536096,epoch time: 0:17:50.771797,used: 4:08:45.896841,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92088366, 'precision': 0.9313443, 'recall': 0.9208746, 'specificity': 0.9208746, 'f1': 0.9203999, 'auroc': 0.99789, 'binary_precision': 0.86420083, 'binary_recall': 0.99872345, 'binary_specificity': 0.84302574, 'binary_f1_score': 0.9266051}
confusion matrix:
       0      1
0  21788   4057
1     33  25818
---- Validation: 
scalar performance:
{'acc': 0.8065872, 'precision': 0.5460307, 'recall': 0.82040316, 'specificity': 0.82040316, 'f1': 0.5322669, 'auroc': 0.87398785, 'binary_precision': 0.097160354, 'binary_recall': 0.8349282, 'binary_specificity': 0.8058781, 'binary_f1_score': 0.17406484}
confusion matrix:
       0     1
0  13463  3243
1     69   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92201746, 'precision': 0.7500272, 'recall': 0.5223332, 'specificity': 0.5223332, 'f1': 0.523666, 'auroc': 0.82789123, 'binary_precision': 0.57575756, 'binary_recall': 0.047678795, 'binary_specificity': 0.99698764, 'binary_f1_score': 0.08806489}
confusion matrix:
      0   1
0  9267  28
1   759  38
early stop counter: 14
val acc:0.8065872192382812, best validation acc: 0.9661294221878052, corresponding to test acc:                         0.9239001274108887 / 0.9239001274108887
after epoch: 15,now: 2024-08-10 12:50:32.060425,epoch time: 0:17:57.524329,used: 4:26:43.421170,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_08_23_48_seed_2_24132725
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:26:43.421170 at 2024-08-10 12:50:32.060425
persisted model performance metric: 

scalar performance:
{'acc': 0.9239001, 'precision': 0.73964655, 'recall': 0.6093893, 'specificity': 0.6093893, 'f1': 0.6441676, 'auroc': 0.8392173, 'binary_precision': 0.54178673, 'binary_recall': 0.23588456, 'binary_specificity': 0.982894, 'binary_f1_score': 0.32867134}
confusion matrix:
      0    1
0  9136  159
1   609  188
oracle model performance metric: 

scalar performance:
{'acc': 0.9239001, 'precision': 0.73964655, 'recall': 0.6093893, 'specificity': 0.6093893, 'f1': 0.6441676, 'auroc': 0.8392173, 'binary_precision': 0.54178673, 'binary_recall': 0.23588456, 'binary_specificity': 0.982894, 'binary_f1_score': 0.32867134}
confusion matrix:
      0    1
0  9136  159
1   609  188
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494824 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 404288 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494824 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 404288 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10880 MiB |    998 TiB |    998 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    995 TiB |    995 TiB |
|       from small pool |  88912 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11476 MiB |  11506 MiB |  31966 MiB |  20490 MiB |
|       from large pool |  11350 MiB |  11380 MiB |  31782 MiB |  20432 MiB |
|       from small pool |    126 MiB |    128 MiB |    184 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 731927 KiB |   1557 MiB | 470282 GiB | 470281 GiB |
|       from large pool | 724160 KiB |   1555 MiB | 466897 GiB | 466897 GiB |
|       from small pool |   7767 KiB |     32 MiB |   3384 GiB |   3384 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7708    |  173387 K  |  173382 K  |
|       from large pool |      87    |     908    |   64564 K  |   64564 K  |
|       from small pool |    5076    |    7619    |  108823 K  |  108818 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7708    |  173387 K  |  173382 K  |
|       from large pool |      87    |     908    |   64564 K  |   64564 K  |
|       from small pool |    5076    |    7619    |  108823 K  |  108818 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     405    |     408    |    1058    |     653    |
|       from large pool |     342    |     345    |     966    |     624    |
|       from small pool |      63    |      64    |      92    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3263    |   94254 K  |   94254 K  |
|       from large pool |      22    |     198    |   42071 K  |   42071 K  |
|       from small pool |      46    |    3240    |   52183 K  |   52183 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    998 TiB |    998 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    995 TiB |    995 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |  11506 MiB |  31966 MiB |  30768 MiB |
|       from large pool |   1102 MiB |  11380 MiB |  31782 MiB |  30680 MiB |
|       from small pool |     96 MiB |    128 MiB |    184 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1557 MiB | 470282 GiB | 470282 GiB |
|       from large pool |  50944 KiB |   1555 MiB | 466898 GiB | 466898 GiB |
|       from small pool |      0 KiB |     32 MiB |   3384 GiB |   3384 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7708    |  173387 K  |  173387 K  |
|       from large pool |       2    |     908    |   64564 K  |   64564 K  |
|       from small pool |       0    |    7619    |  108823 K  |  108823 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7708    |  173387 K  |  173387 K  |
|       from large pool |       2    |     908    |   64564 K  |   64564 K  |
|       from small pool |       0    |    7619    |  108823 K  |  108823 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     408    |    1058    |     977    |
|       from large pool |      33    |     345    |     966    |     933    |
|       from small pool |      48    |      64    |      92    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3263    |   94256 K  |   94256 K  |
|       from large pool |       4    |     198    |   42071 K  |   42071 K  |
|       from small pool |       0    |    3240    |   52185 K  |   52185 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug 10 13:04:17 2024]
Finished job 0.
1 of 1 steps (100%) done
