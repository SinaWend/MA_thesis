Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 07:04:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/20.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=20
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703

 Experiment start at: 2024-08-09 07:11:40.923245
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.73823434, 'precision': 0.76390076, 'recall': 0.73813576, 'specificity': 0.73813576, 'f1': 0.7316582, 'auroc': 0.8400532, 'binary_precision': 0.68175805, 'binary_recall': 0.8942156, 'binary_specificity': 0.5820559, 'binary_f1_score': 0.7736661}
confusion matrix:
       0      1
0  14733  10579
1   2681  22663
---- Validation: 
scalar performance:
{'acc': 0.50717366, 'precision': 0.50828373, 'recall': 0.5876836, 'specificity': 0.5876836, 'f1': 0.36387077, 'auroc': 0.63399863, 'binary_precision': 0.03246829, 'binary_recall': 0.67228913, 'binary_specificity': 0.5030781, 'binary_f1_score': 0.061944935}
confusion matrix:
      0     1
0  8417  8314
1   136   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.22839628, 'precision': 0.4621327, 'recall': 0.4112022, 'specificity': 0.4112022, 'f1': 0.214568, 'auroc': 0.34071612, 'binary_precision': 0.0605, 'binary_recall': 0.626943, 'binary_specificity': 0.19546136, 'binary_f1_score': 0.11035111}
confusion matrix:
      0     1
0  1826  7516
1   288   484
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 07:27:48.366549,epoch time: 0:16:07.443304,used: 0:16:07.443304,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8259831, 'precision': 0.83072776, 'recall': 0.82595706, 'specificity': 0.82595706, 'f1': 0.82534873, 'auroc': 0.9053943, 'binary_precision': 0.7912231, 'binary_recall': 0.88586766, 'binary_specificity': 0.7660465, 'binary_f1_score': 0.8358748}
confusion matrix:
       0      1
0  19394   5923
1   2892  22447
---- Validation: 
scalar performance:
{'acc': 0.7023796, 'precision': 0.5095617, 'recall': 0.5843133, 'specificity': 0.5843133, 'f1': 0.44625002, 'auroc': 0.61080813, 'binary_precision': 0.037672583, 'binary_recall': 0.46024096, 'binary_specificity': 0.70838565, 'binary_f1_score': 0.06964448}
confusion matrix:
       0     1
0  11852  4879
1    224   191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46845955, 'precision': 0.5177072, 'recall': 0.56194806, 'specificity': 0.56194806, 'f1': 0.3863315, 'auroc': 0.54487354, 'binary_precision': 0.09198865, 'binary_recall': 0.6722798, 'binary_specificity': 0.45161635, 'binary_f1_score': 0.16183348}
confusion matrix:
      0     1
0  4219  5123
1   253   519
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 07:42:54.537468,epoch time: 0:15:06.170919,used: 0:31:13.614223,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84015715, 'precision': 0.84071636, 'recall': 0.8401475, 'specificity': 0.8401475, 'f1': 0.84008884, 'auroc': 0.9201063, 'binary_precision': 0.8270303, 'binary_recall': 0.8604183, 'binary_specificity': 0.81987673, 'binary_f1_score': 0.843394}
confusion matrix:
       0      1
0  20756   4560
1   3537  21803
---- Validation: 
scalar performance:
{'acc': 0.7856643, 'precision': 0.5088398, 'recall': 0.5611922, 'specificity': 0.5611922, 'f1': 0.4736709, 'auroc': 0.6048598, 'binary_precision': 0.038243625, 'binary_recall': 0.3253012, 'binary_specificity': 0.79708326, 'binary_f1_score': 0.06844106}
confusion matrix:
       0     1
0  13336  3395
1    280   135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65088, 'precision': 0.5464613, 'recall': 0.65416, 'specificity': 0.65416, 'f1': 0.49913353, 'auroc': 0.6657091, 'binary_precision': 0.13456954, 'binary_recall': 0.6580311, 'binary_specificity': 0.650289, 'binary_f1_score': 0.22344403}
confusion matrix:
      0     1
0  6075  3267
1   264   508
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 07:57:33.889679,epoch time: 0:14:39.352211,used: 0:45:52.966434,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8593651, 'precision': 0.8672856, 'recall': 0.8593159, 'specificity': 0.8593159, 'f1': 0.85859096, 'auroc': 0.94492304, 'binary_precision': 0.81351733, 'binary_recall': 0.93272835, 'binary_specificity': 0.78590333, 'binary_f1_score': 0.8690538}
confusion matrix:
       0      1
0  19892   5419
1   1705  23640
---- Validation: 
scalar performance:
{'acc': 0.76035225, 'precision': 0.5112772, 'recall': 0.5858202, 'specificity': 0.5858202, 'f1': 0.46875745, 'auroc': 0.6314326, 'binary_precision': 0.04145978, 'binary_recall': 0.40240964, 'binary_specificity': 0.7692308, 'binary_f1_score': 0.07517443}
confusion matrix:
       0     1
0  12870  3861
1    248   167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6216136, 'precision': 0.54855424, 'recall': 0.6668367, 'specificity': 0.6668367, 'f1': 0.48741803, 'auroc': 0.6821989, 'binary_precision': 0.13342932, 'binary_recall': 0.7202073, 'binary_specificity': 0.6134661, 'binary_f1_score': 0.22514679}
confusion matrix:
      0     1
0  5731  3611
1   216   556
early stop counter: 1
val acc:0.7603522539138794, best validation acc: 0.7856643199920654, corresponding to test acc:                         0.650879979133606 / 0.650879979133606
after epoch: 4,now: 2024-08-09 08:12:07.204235,epoch time: 0:14:33.314556,used: 1:00:26.280990,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86915666, 'precision': 0.8727173, 'recall': 0.8691239, 'specificity': 0.8691239, 'f1': 0.86883616, 'auroc': 0.9471537, 'binary_precision': 0.83645517, 'binary_recall': 0.91797197, 'binary_specificity': 0.8202758, 'binary_f1_score': 0.8753198}
confusion matrix:
       0      1
0  20762   4549
1   2079  23266
---- Validation: 
scalar performance:
{'acc': 0.761752, 'precision': 0.5120222, 'recall': 0.5912372, 'specificity': 0.5912372, 'f1': 0.4702355, 'auroc': 0.65205765, 'binary_precision': 0.042622134, 'binary_recall': 0.4120482, 'binary_specificity': 0.77042615, 'binary_f1_score': 0.07725322}
confusion matrix:
       0     1
0  12890  3841
1    244   171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68232155, 'precision': 0.5639597, 'recall': 0.7074229, 'specificity': 0.7074229, 'f1': 0.5295904, 'auroc': 0.7258393, 'binary_precision': 0.15898296, 'binary_recall': 0.73704666, 'binary_specificity': 0.67779917, 'binary_f1_score': 0.2615491}
confusion matrix:
      0     1
0  6332  3010
1   203   569
new oracle model saved
early stop counter: 2
val acc:0.7617520093917847, best validation acc: 0.7856643199920654, corresponding to test acc:                         0.650879979133606 / 0.6823215484619141
after epoch: 5,now: 2024-08-09 08:27:52.209506,epoch time: 0:15:45.005271,used: 1:16:11.286261,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.86587965, 'precision': 0.87335527, 'recall': 0.86584616, 'specificity': 0.86584616, 'f1': 0.8651973, 'auroc': 0.9512066, 'binary_precision': 0.8206431, 'binary_recall': 0.9365825, 'binary_specificity': 0.7951098, 'binary_f1_score': 0.87478805}
confusion matrix:
       0      1
0  20129   5187
1   1607  23733
---- Validation: 
scalar performance:
{'acc': 0.7243672, 'precision': 0.5081954, 'recall': 0.5685563, 'specificity': 0.5685563, 'f1': 0.4523469, 'auroc': 0.6134485, 'binary_precision': 0.036152355, 'binary_recall': 0.40481928, 'binary_specificity': 0.73229337, 'binary_f1_score': 0.066376925}
confusion matrix:
       0     1
0  12252  4479
1    247   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59511566, 'precision': 0.546151, 'recall': 0.661405, 'specificity': 0.661405, 'f1': 0.47244993, 'auroc': 0.6896871, 'binary_precision': 0.12788354, 'binary_recall': 0.7396373, 'binary_specificity': 0.58317274, 'binary_f1_score': 0.21806377}
confusion matrix:
      0     1
0  5448  3894
1   201   571
early stop counter: 3
val acc:0.7243672013282776, best validation acc: 0.7856643199920654, corresponding to test acc:                         0.650879979133606 / 0.6823215484619141
after epoch: 6,now: 2024-08-09 08:43:39.264598,epoch time: 0:15:47.055092,used: 1:31:58.341353,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88368607, 'precision': 0.88983005, 'recall': 0.88364637, 'specificity': 0.88364637, 'f1': 0.8832183, 'auroc': 0.96370053, 'binary_precision': 0.84104776, 'binary_recall': 0.9463778, 'binary_specificity': 0.820915, 'binary_f1_score': 0.8906093}
confusion matrix:
       0      1
0  20779   4533
1   1359  23985
---- Validation: 
scalar performance:
{'acc': 0.73789805, 'precision': 0.51201576, 'recall': 0.5978133, 'specificity': 0.5978133, 'f1': 0.4620479, 'auroc': 0.6346299, 'binary_precision': 0.041994162, 'binary_recall': 0.4506024, 'binary_specificity': 0.7450242, 'binary_f1_score': 0.07682826}
confusion matrix:
       0     1
0  12465  4266
1    228   187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68588096, 'precision': 0.5584507, 'recall': 0.6867721, 'specificity': 0.6867721, 'f1': 0.5259158, 'auroc': 0.7037287, 'binary_precision': 0.15315835, 'binary_recall': 0.68782383, 'binary_specificity': 0.6857204, 'binary_f1_score': 0.25053078}
confusion matrix:
      0     1
0  6406  2936
1   241   531
new oracle model saved
early stop counter: 4
val acc:0.737898051738739, best validation acc: 0.7856643199920654, corresponding to test acc:                         0.650879979133606 / 0.6858809590339661
after epoch: 7,now: 2024-08-09 08:58:34.420202,epoch time: 0:14:55.155604,used: 1:46:53.496957,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8848113, 'precision': 0.8877942, 'recall': 0.88478017, 'specificity': 0.88478017, 'f1': 0.88458335, 'auroc': 0.9607484, 'binary_precision': 0.85396034, 'binary_recall': 0.92858833, 'binary_specificity': 0.84097195, 'binary_f1_score': 0.88971215}
confusion matrix:
       0      1
0  21285   4025
1   1810  23536
---- Validation: 
scalar performance:
{'acc': 0.77003384, 'precision': 0.5085457, 'recall': 0.5625826, 'specificity': 0.5625826, 'f1': 0.4682352, 'auroc': 0.61886406, 'binary_precision': 0.037493445, 'binary_recall': 0.34457833, 'binary_specificity': 0.78058696, 'binary_f1_score': 0.06762829}
confusion matrix:
       0     1
0  13060  3671
1    272   143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7297805, 'precision': 0.5657705, 'recall': 0.6933055, 'specificity': 0.6933055, 'f1': 0.55146897, 'auroc': 0.7247238, 'binary_precision': 0.1693086, 'binary_recall': 0.6502591, 'binary_specificity': 0.73635197, 'binary_f1_score': 0.26866472}
confusion matrix:
      0     1
0  6879  2463
1   270   502
new oracle model saved
early stop counter: 5
val acc:0.7700338363647461, best validation acc: 0.7856643199920654, corresponding to test acc:                         0.650879979133606 / 0.7297804951667786
after epoch: 8,now: 2024-08-09 09:13:37.318957,epoch time: 0:15:02.898755,used: 2:01:56.395712,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8904375, 'precision': 0.89048874, 'recall': 0.89043474, 'specificity': 0.89043474, 'f1': 0.8904333, 'auroc': 0.96049523, 'binary_precision': 0.8861313, 'binary_recall': 0.8961326, 'binary_specificity': 0.8847369, 'binary_f1_score': 0.89110386}
confusion matrix:
       0      1
0  22398   2918
1   2632  22708
---- Validation: 
scalar performance:
{'acc': 0.82054126, 'precision': 0.506444, 'recall': 0.53794056, 'specificity': 0.53794056, 'f1': 0.48091072, 'auroc': 0.5996764, 'binary_precision': 0.0349406, 'binary_recall': 0.24096386, 'binary_specificity': 0.83491725, 'binary_f1_score': 0.06103143}
confusion matrix:
       0     1
0  13969  2762
1    315   100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7868301, 'precision': 0.58489263, 'recall': 0.71527535, 'specificity': 0.71527535, 'f1': 0.59254277, 'auroc': 0.74489117, 'binary_precision': 0.20653096, 'binary_recall': 0.63082904, 'binary_specificity': 0.79972166, 'binary_f1_score': 0.3111821}
confusion matrix:
      0     1
0  7471  1871
1   285   487
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-09 09:29:00.142119,epoch time: 0:15:22.823162,used: 2:17:19.218874,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.89448434, 'precision': 0.8955858, 'recall': 0.8944688, 'specificity': 0.8944688, 'f1': 0.8944081, 'auroc': 0.96413374, 'binary_precision': 0.8748594, 'binary_recall': 0.9208065, 'binary_specificity': 0.868131, 'binary_f1_score': 0.8972451}
confusion matrix:
       0      1
0  21975   3338
1   2007  23336
---- Validation: 
scalar performance:
{'acc': 0.8031611, 'precision': 0.5124179, 'recall': 0.58073205, 'specificity': 0.58073205, 'f1': 0.4842172, 'auroc': 0.655269, 'binary_precision': 0.044334974, 'binary_recall': 0.34698796, 'binary_specificity': 0.81447613, 'binary_f1_score': 0.07862408}
confusion matrix:
       0     1
0  13627  3104
1    271   144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7917738, 'precision': 0.58650756, 'recall': 0.71557486, 'specificity': 0.71557486, 'f1': 0.5958486, 'auroc': 0.74508345, 'binary_precision': 0.21, 'binary_recall': 0.62564766, 'binary_specificity': 0.80550206, 'binary_f1_score': 0.31445312}
confusion matrix:
      0     1
0  7525  1817
1   289   483
new oracle model saved
early stop counter: 1
val acc:0.803161084651947, best validation acc: 0.820541262626648, corresponding to test acc:                         0.7868301272392273 / 0.791773796081543
after epoch: 10,now: 2024-08-09 09:43:31.109654,epoch time: 0:14:30.967535,used: 2:31:50.186409,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.89450413, 'precision': 0.8983058, 'recall': 0.89448094, 'specificity': 0.89448094, 'f1': 0.8942478, 'auroc': 0.9693589, 'binary_precision': 0.85951096, 'binary_recall': 0.94329125, 'binary_specificity': 0.8456707, 'binary_f1_score': 0.89945436}
confusion matrix:
       0      1
0  21409   3907
1   1437  23903
---- Validation: 
scalar performance:
{'acc': 0.7569696, 'precision': 0.51019377, 'recall': 0.5782122, 'specificity': 0.5782122, 'f1': 0.46615836, 'auroc': 0.62655026, 'binary_precision': 0.039744847, 'binary_recall': 0.39036146, 'binary_specificity': 0.766063, 'binary_f1_score': 0.072144285}
confusion matrix:
       0     1
0  12817  3914
1    253   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7763496, 'precision': 0.58364666, 'recall': 0.7208908, 'specificity': 0.7208908, 'f1': 0.58784103, 'auroc': 0.7441201, 'binary_precision': 0.2022382, 'binary_recall': 0.6554404, 'binary_specificity': 0.78634125, 'binary_f1_score': 0.309102}
confusion matrix:
      0     1
0  7346  1996
1   266   506
early stop counter: 2
val acc:0.7569695711135864, best validation acc: 0.820541262626648, corresponding to test acc:                         0.7868301272392273 / 0.791773796081543
after epoch: 11,now: 2024-08-09 09:57:41.871381,epoch time: 0:14:10.761727,used: 2:46:00.948136,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.90948755, 'precision': 0.91100943, 'recall': 0.90946835, 'specificity': 0.90946835, 'f1': 0.9094008, 'auroc': 0.97430456, 'binary_precision': 0.8861565, 'binary_recall': 0.939828, 'binary_specificity': 0.8791087, 'binary_f1_score': 0.91220343}
confusion matrix:
       0      1
0  22252   3060
1   1525  23819
---- Validation: 
scalar performance:
{'acc': 0.8150589, 'precision': 0.5182008, 'recall': 0.613852, 'specificity': 0.613852, 'f1': 0.49614722, 'auroc': 0.6705831, 'binary_precision': 0.05404531, 'binary_recall': 0.40240964, 'binary_specificity': 0.8252944, 'binary_f1_score': 0.095292434}
confusion matrix:
       0     1
0  13808  2923
1    248   167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8411113, 'precision': 0.6108553, 'recall': 0.72386366, 'specificity': 0.72386366, 'f1': 0.6346561, 'auroc': 0.76468325, 'binary_precision': 0.2599195, 'binary_recall': 0.58549225, 'binary_specificity': 0.86223507, 'binary_f1_score': 0.36001593}
confusion matrix:
      0     1
0  8055  1287
1   320   452
new oracle model saved
early stop counter: 3
val acc:0.8150588870048523, best validation acc: 0.820541262626648, corresponding to test acc:                         0.7868301272392273 / 0.8411113023757935
after epoch: 12,now: 2024-08-09 10:11:55.383966,epoch time: 0:14:13.512585,used: 3:00:14.460721,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8986497, 'precision': 0.90129435, 'recall': 0.8986321, 'specificity': 0.8986321, 'f1': 0.8984796, 'auroc': 0.9705961, 'binary_precision': 0.86882555, 'binary_recall': 0.93918467, 'binary_specificity': 0.85807955, 'binary_f1_score': 0.9026361}
confusion matrix:
       0      1
0  21724   3593
1   1541  23798
---- Validation: 
scalar performance:
{'acc': 0.79225475, 'precision': 0.51655734, 'recall': 0.61391646, 'specificity': 0.61391646, 'f1': 0.48656738, 'auroc': 0.6816647, 'binary_precision': 0.050556984, 'binary_recall': 0.426506, 'binary_specificity': 0.8013269, 'binary_f1_score': 0.090398364}
confusion matrix:
       0     1
0  13407  3324
1    238   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85129523, 'precision': 0.61616874, 'recall': 0.71987003, 'specificity': 0.71987003, 'f1': 0.64137757, 'auroc': 0.76835287, 'binary_precision': 0.27182046, 'binary_recall': 0.5647668, 'binary_specificity': 0.87497324, 'binary_f1_score': 0.36700335}
confusion matrix:
      0     1
0  8174  1168
1   336   436
new oracle model saved
early stop counter: 4
val acc:0.7922547459602356, best validation acc: 0.820541262626648, corresponding to test acc:                         0.7868301272392273 / 0.8512952327728271
after epoch: 13,now: 2024-08-09 10:26:32.293130,epoch time: 0:14:36.909164,used: 3:14:51.369885,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9189829, 'precision': 0.9195126, 'recall': 0.9189725, 'specificity': 0.9189725, 'f1': 0.918956, 'auroc': 0.97826433, 'binary_precision': 0.90475285, 'binary_recall': 0.93666893, 'binary_specificity': 0.90127605, 'binary_f1_score': 0.9204343}
confusion matrix:
       0      1
0  22814   2499
1   1605  23738
---- Validation: 
scalar performance:
{'acc': 0.8439869, 'precision': 0.5202128, 'recall': 0.6087009, 'specificity': 0.6087009, 'f1': 0.50771177, 'auroc': 0.68290794, 'binary_precision': 0.05859375, 'binary_recall': 0.36144578, 'binary_specificity': 0.855956, 'binary_f1_score': 0.10084034}
confusion matrix:
       0     1
0  14321  2410
1    265   150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86573064, 'precision': 0.63713205, 'recall': 0.7502618, 'specificity': 0.7502618, 'f1': 0.6676643, 'auroc': 0.7935096, 'binary_precision': 0.30899608, 'binary_recall': 0.61398965, 'binary_specificity': 0.8865339, 'binary_f1_score': 0.41110146}
confusion matrix:
      0     1
0  8282  1060
1   298   474
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-09 10:41:28.037603,epoch time: 0:14:55.744473,used: 3:29:47.114358,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9148571, 'precision': 0.9154427, 'recall': 0.914846, 'specificity': 0.914846, 'f1': 0.91482556, 'auroc': 0.9754162, 'binary_precision': 0.8999924, 'binary_recall': 0.93355167, 'binary_specificity': 0.89614034, 'binary_f1_score': 0.9164649}
confusion matrix:
       0      1
0  22684   2629
1   1684  23659
---- Validation: 
scalar performance:
{'acc': 0.83891284, 'precision': 0.5175819, 'recall': 0.5967015, 'specificity': 0.5967015, 'f1': 0.5024209, 'auroc': 0.6882175, 'binary_precision': 0.053971875, 'binary_recall': 0.3421687, 'binary_specificity': 0.85123426, 'binary_f1_score': 0.093237035}
confusion matrix:
       0     1
0  14242  2489
1    273   142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8532727, 'precision': 0.62044996, 'recall': 0.7286644, 'specificity': 0.7286644, 'f1': 0.64691913, 'auroc': 0.7797693, 'binary_precision': 0.278882, 'binary_recall': 0.5816062, 'binary_specificity': 0.8757225, 'binary_f1_score': 0.37699413}
confusion matrix:
      0     1
0  8181  1161
1   323   449
early stop counter: 1
val acc:0.838912844657898, best validation acc: 0.8439869284629822, corresponding to test acc:                         0.8657306432723999 / 0.8657306432723999
after epoch: 15,now: 2024-08-09 10:56:13.976897,epoch time: 0:14:45.939294,used: 3:44:33.053652,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_11_40_seed_0_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:44:33.053652 at 2024-08-09 10:56:13.976897
persisted model performance metric: 

scalar performance:
{'acc': 0.86573064, 'precision': 0.63713205, 'recall': 0.7502618, 'specificity': 0.7502618, 'f1': 0.6676643, 'auroc': 0.7935096, 'binary_precision': 0.30899608, 'binary_recall': 0.61398965, 'binary_specificity': 0.8865339, 'binary_f1_score': 0.41110146}
confusion matrix:
      0     1
0  8282  1060
1   298   474
oracle model performance metric: 

scalar performance:
{'acc': 0.86573064, 'precision': 0.63713205, 'recall': 0.7502618, 'specificity': 0.7502618, 'f1': 0.6676643, 'auroc': 0.7935096, 'binary_precision': 0.30899608, 'binary_recall': 0.61398965, 'binary_specificity': 0.8865339, 'binary_f1_score': 0.41110146}
confusion matrix:
      0     1
0  8282  1060
1   298   474
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/20.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205702 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205029 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205702 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205029 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201269 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 202776 GiB | 202776 GiB |
|       from small pool |  36149 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 739328 KiB | 739328 KiB | 739328 KiB |      0 B   |
|       from large pool | 661504 KiB | 661504 KiB | 661504 KiB |      0 B   |
|       from small pool |  77824 KiB |  77824 KiB |  77824 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44153 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  36864 KiB | 148352 KiB | 139038 GiB | 139038 GiB |
|       from small pool |   7289 KiB |   9156 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4698    |    7101    |   43618 K  |   43613 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29718 K  |   29714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4698    |    7101    |   43618 K  |   43613 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29718 K  |   29714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      55    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      38    |      38    |      38    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    3182    |   22781 K  |   22781 K  |
|       from large pool |       7    |      11    |    8644 K  |    8644 K  |
|       from small pool |      44    |    3176    |   14137 K  |   14137 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202776 GiB | 202776 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139038 GiB | 139038 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43618 K  |   43618 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29718 K  |   29718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43618 K  |   43618 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29718 K  |   29718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205318 GiB | 205318 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202776 GiB | 202776 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139038 GiB | 139038 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43618 K  |   43618 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29718 K  |   29718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43618 K  |   43618 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29718 K  |   29718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703

 Experiment start at: 2024-08-09 11:16:55.694118
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.68012273, 'precision': 0.7343116, 'recall': 0.6799333, 'specificity': 0.6799333, 'f1': 0.66035223, 'auroc': 0.827158, 'binary_precision': 0.6218269, 'binary_recall': 0.92066365, 'binary_specificity': 0.43920302, 'binary_f1_score': 0.74229753}
confusion matrix:
       0      1
0  11154  14242
1   2018  23418
---- Validation: 
scalar performance:
{'acc': 0.35449395, 'precision': 0.49241745, 'recall': 0.4293239, 'specificity': 0.4293239, 'f1': 0.2761887, 'auroc': 0.40292156, 'binary_precision': 0.019801086, 'binary_recall': 0.50812066, 'binary_specificity': 0.3505272, 'binary_f1_score': 0.038116787}
confusion matrix:
      0      1
0  5851  10841
1   212    219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.22287187, 'precision': 0.4944345, 'recall': 0.48827577, 'specificity': 0.48827577, 'f1': 0.2145773, 'auroc': 0.468839, 'binary_precision': 0.073038444, 'binary_recall': 0.8005284, 'binary_specificity': 0.17602314, 'binary_f1_score': 0.13386348}
confusion matrix:
      0     1
0  1643  7691
1   151   606
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 11:32:21.720729,epoch time: 0:15:26.026611,used: 0:15:26.026611,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.78946334, 'precision': 0.80673003, 'recall': 0.7893559, 'specificity': 0.7893559, 'f1': 0.7864157, 'auroc': 0.8955196, 'binary_precision': 0.7341808, 'binary_recall': 0.90809387, 'binary_specificity': 0.6706179, 'binary_f1_score': 0.81192887}
confusion matrix:
       0      1
0  17029   8364
1   2338  23101
---- Validation: 
scalar performance:
{'acc': 0.6507037, 'precision': 0.5067118, 'recall': 0.5620406, 'specificity': 0.5620406, 'f1': 0.42430025, 'auroc': 0.54493445, 'binary_precision': 0.03392677, 'binary_recall': 0.4686775, 'binary_specificity': 0.6554038, 'binary_f1_score': 0.063273296}
confusion matrix:
       0     1
0  10940  5752
1    229   202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5482113, 'precision': 0.555175, 'recall': 0.69873345, 'specificity': 0.69873345, 'f1': 0.45322028, 'auroc': 0.75720626, 'binary_precision': 0.12929018, 'binary_recall': 0.87582564, 'binary_specificity': 0.5216413, 'binary_f1_score': 0.22531861}
confusion matrix:
      0     1
0  4869  4465
1    94   663
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 11:46:59.960294,epoch time: 0:14:38.239565,used: 0:30:04.266176,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8221986, 'precision': 0.83312476, 'recall': 0.82212734, 'specificity': 0.82212734, 'f1': 0.82070595, 'auroc': 0.9195629, 'binary_precision': 0.7729906, 'binary_recall': 0.9127221, 'binary_specificity': 0.7315325, 'binary_f1_score': 0.83706504}
confusion matrix:
       0      1
0  18578   6818
1   2220  23216
---- Validation: 
scalar performance:
{'acc': 0.7070023, 'precision': 0.50588655, 'recall': 0.5491016, 'specificity': 0.5491016, 'f1': 0.44405612, 'auroc': 0.5582322, 'binary_precision': 0.033563875, 'binary_recall': 0.38283062, 'binary_specificity': 0.7153726, 'binary_f1_score': 0.06171685}
confusion matrix:
       0     1
0  11941  4751
1    266   165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55623823, 'precision': 0.55417585, 'recall': 0.6951823, 'specificity': 0.6951823, 'f1': 0.4570527, 'auroc': 0.7571264, 'binary_precision': 0.12945628, 'binary_recall': 0.8586526, 'binary_specificity': 0.531712, 'binary_f1_score': 0.22499134}
confusion matrix:
      0     1
0  4963  4371
1   107   650
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 12:01:42.832675,epoch time: 0:14:42.872381,used: 0:44:47.138557,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.83799577, 'precision': 0.8516221, 'recall': 0.83791053, 'specificity': 0.83791053, 'f1': 0.8363866, 'auroc': 0.93838245, 'binary_precision': 0.7826187, 'binary_recall': 0.93635505, 'binary_specificity': 0.739466, 'binary_f1_score': 0.85261214}
confusion matrix:
       0      1
0  18778   6616
1   1619  23819
---- Validation: 
scalar performance:
{'acc': 0.68089706, 'precision': 0.5057345, 'recall': 0.5504038, 'specificity': 0.5504038, 'f1': 0.43447497, 'auroc': 0.55482435, 'binary_precision': 0.033030245, 'binary_recall': 0.41299304, 'binary_specificity': 0.68781453, 'binary_f1_score': 0.061168384}
confusion matrix:
       0     1
0  11481  5211
1    253   178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6090576, 'precision': 0.55344373, 'recall': 0.68913853, 'specificity': 0.68913853, 'f1': 0.4845176, 'auroc': 0.73685277, 'binary_precision': 0.13557385, 'binary_recall': 0.78335536, 'binary_specificity': 0.59492177, 'binary_f1_score': 0.23114403}
confusion matrix:
      0     1
0  5553  3781
1   164   593
new oracle model saved
early stop counter: 1
val acc:0.680897057056427, best validation acc: 0.7070022821426392, corresponding to test acc:                         0.5562382340431213 / 0.609057605266571
after epoch: 4,now: 2024-08-09 12:16:28.851661,epoch time: 0:14:46.018986,used: 0:59:33.157543,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.859557, 'precision': 0.8651635, 'recall': 0.8595082, 'specificity': 0.8595082, 'f1': 0.85900414, 'auroc': 0.946826, 'binary_precision': 0.82011265, 'binary_recall': 0.9214499, 'binary_specificity': 0.79756653, 'binary_f1_score': 0.86783296}
confusion matrix:
       0      1
0  20255   5141
1   1998  23438
---- Validation: 
scalar performance:
{'acc': 0.73520994, 'precision': 0.5081297, 'recall': 0.56356966, 'specificity': 0.56356966, 'f1': 0.45676664, 'auroc': 0.57534987, 'binary_precision': 0.037220843, 'binary_recall': 0.38283062, 'binary_specificity': 0.74430865, 'binary_f1_score': 0.0678454}
confusion matrix:
       0     1
0  12424  4268
1    266   165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7243088, 'precision': 0.5724566, 'recall': 0.7229118, 'specificity': 0.7229118, 'f1': 0.55564404, 'auroc': 0.77130544, 'binary_precision': 0.17516842, 'binary_recall': 0.7212682, 'binary_specificity': 0.7245554, 'binary_f1_score': 0.28187922}
confusion matrix:
      0     1
0  6763  2571
1   211   546
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 12:31:22.773470,epoch time: 0:14:53.921809,used: 1:14:27.079352,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.86610794, 'precision': 0.86791265, 'recall': 0.86608183, 'specificity': 0.86608183, 'f1': 0.86593765, 'auroc': 0.9476346, 'binary_precision': 0.8423316, 'binary_recall': 0.9010812, 'binary_specificity': 0.8310824, 'binary_f1_score': 0.8707166}
confusion matrix:
       0      1
0  21107   4290
1   2516  22919
---- Validation: 
scalar performance:
{'acc': 0.8121824, 'precision': 0.50917655, 'recall': 0.5544537, 'specificity': 0.5544537, 'f1': 0.4830286, 'auroc': 0.55455154, 'binary_precision': 0.04027732, 'binary_recall': 0.28306264, 'binary_specificity': 0.8258447, 'binary_f1_score': 0.07052024}
confusion matrix:
       0     1
0  13785  2907
1    309   122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8281637, 'precision': 0.59602165, 'recall': 0.70500463, 'specificity': 0.70500463, 'f1': 0.61495245, 'auroc': 0.78895175, 'binary_precision': 0.23232877, 'binary_recall': 0.5601057, 'binary_specificity': 0.8499036, 'binary_f1_score': 0.32842758}
confusion matrix:
      0     1
0  7933  1401
1   333   424
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 12:46:16.914070,epoch time: 0:14:54.140600,used: 1:29:21.219952,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8712425, 'precision': 0.8760239, 'recall': 0.871196, 'specificity': 0.871196, 'f1': 0.87082183, 'auroc': 0.9557417, 'binary_precision': 0.8338281, 'binary_recall': 0.9275465, 'binary_specificity': 0.81484544, 'binary_f1_score': 0.87819403}
confusion matrix:
       0      1
0  20693   4702
1   1843  23594
---- Validation: 
scalar performance:
{'acc': 0.7729954, 'precision': 0.5089816, 'recall': 0.5626077, 'specificity': 0.5626077, 'f1': 0.47051576, 'auroc': 0.5945416, 'binary_precision': 0.0392, 'binary_recall': 0.34106728, 'binary_specificity': 0.7841481, 'binary_f1_score': 0.0703181}
confusion matrix:
       0     1
0  13089  3603
1    284   147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8025964, 'precision': 0.5855114, 'recall': 0.7051437, 'specificity': 0.7051437, 'f1': 0.5973001, 'auroc': 0.7643198, 'binary_precision': 0.20995773, 'binary_recall': 0.5904888, 'binary_specificity': 0.8197986, 'binary_f1_score': 0.30977133}
confusion matrix:
      0     1
0  7652  1682
1   310   447
early stop counter: 1
val acc:0.7729954123497009, best validation acc: 0.8121824264526367, corresponding to test acc:                         0.8281636834144592 / 0.8281636834144592
after epoch: 7,now: 2024-08-09 13:00:56.359056,epoch time: 0:14:39.444986,used: 1:44:00.664938,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8792886, 'precision': 0.8833078, 'recall': 0.8792504, 'specificity': 0.8792504, 'f1': 0.87896365, 'auroc': 0.96168953, 'binary_precision': 0.8442439, 'binary_recall': 0.93041086, 'binary_specificity': 0.82808995, 'binary_f1_score': 0.8852355}
confusion matrix:
       0      1
0  21031   4366
1   1770  23665
---- Validation: 
scalar performance:
{'acc': 0.78853005, 'precision': 0.51068515, 'recall': 0.5705756, 'specificity': 0.5705756, 'f1': 0.4778565, 'auroc': 0.6225046, 'binary_precision': 0.04219288, 'binary_recall': 0.34106728, 'binary_specificity': 0.8000839, 'binary_f1_score': 0.07509578}
confusion matrix:
       0     1
0  13355  3337
1    284   147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77197504, 'precision': 0.5828668, 'recall': 0.7262212, 'specificity': 0.7262212, 'f1': 0.58513314, 'auroc': 0.777571, 'binary_precision': 0.1986729, 'binary_recall': 0.672391, 'binary_specificity': 0.7800514, 'binary_f1_score': 0.3067189}
confusion matrix:
      0     1
0  7281  2053
1   248   509
early stop counter: 2
val acc:0.7885300517082214, best validation acc: 0.8121824264526367, corresponding to test acc:                         0.8281636834144592 / 0.8281636834144592
after epoch: 8,now: 2024-08-09 13:15:29.993477,epoch time: 0:14:33.634421,used: 1:58:34.299359,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8860757, 'precision': 0.8879839, 'recall': 0.88604677, 'specificity': 0.88604677, 'f1': 0.88592994, 'auroc': 0.9612543, 'binary_precision': 0.86098045, 'binary_recall': 0.92105985, 'binary_specificity': 0.8510337, 'binary_f1_score': 0.8900074}
confusion matrix:
       0      1
0  21612   3783
1   2008  23429
---- Validation: 
scalar performance:
{'acc': 0.81118965, 'precision': 0.51034105, 'recall': 0.56185544, 'specificity': 0.56185544, 'f1': 0.48439163, 'auroc': 0.60714316, 'binary_precision': 0.042156864, 'binary_recall': 0.29930395, 'binary_specificity': 0.8244069, 'binary_f1_score': 0.07390432}
confusion matrix:
       0     1
0  13761  2931
1    302   129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82747, 'precision': 0.6024673, 'recall': 0.7258724, 'specificity': 0.7258724, 'f1': 0.6229437, 'auroc': 0.7830296, 'binary_precision': 0.24132492, 'binary_recall': 0.6063408, 'binary_specificity': 0.8454039, 'binary_f1_score': 0.3452426}
confusion matrix:
      0     1
0  7891  1443
1   298   459
early stop counter: 3
val acc:0.8111896514892578, best validation acc: 0.8121824264526367, corresponding to test acc:                         0.8281636834144592 / 0.8281636834144592
after epoch: 9,now: 2024-08-09 13:30:04.033804,epoch time: 0:14:34.040327,used: 2:13:08.339686,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8898922, 'precision': 0.8920102, 'recall': 0.8898633, 'specificity': 0.8898633, 'f1': 0.88973796, 'auroc': 0.96570027, 'binary_precision': 0.8633916, 'binary_recall': 0.92656076, 'binary_specificity': 0.85316586, 'binary_f1_score': 0.89386153}
confusion matrix:
       0      1
0  21667   3729
1   1868  23568
---- Validation: 
scalar performance:
{'acc': 0.8113648, 'precision': 0.51615155, 'recall': 0.5981097, 'specificity': 0.5981097, 'f1': 0.49271044, 'auroc': 0.6580692, 'binary_precision': 0.051586032, 'binary_recall': 0.37354988, 'binary_specificity': 0.82266957, 'binary_f1_score': 0.09065316}
confusion matrix:
       0     1
0  13732  2960
1    270   161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8340105, 'precision': 0.6146216, 'recall': 0.75429213, 'specificity': 0.75429213, 'f1': 0.6390779, 'auroc': 0.7960131, 'binary_precision': 0.26068822, 'binary_recall': 0.66050196, 'binary_specificity': 0.8480823, 'binary_f1_score': 0.37383178}
confusion matrix:
      0     1
0  7916  1418
1   257   500
new oracle model saved
early stop counter: 4
val acc:0.8113648295402527, best validation acc: 0.8121824264526367, corresponding to test acc:                         0.8281636834144592 / 0.8340104818344116
after epoch: 10,now: 2024-08-09 13:44:31.056276,epoch time: 0:14:27.022472,used: 2:27:35.362158,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.89538085, 'precision': 0.89901954, 'recall': 0.8953452, 'specificity': 0.8953452, 'f1': 0.89513564, 'auroc': 0.97109306, 'binary_precision': 0.86110216, 'binary_recall': 0.94303125, 'binary_specificity': 0.8476592, 'binary_f1_score': 0.9002064}
confusion matrix:
       0      1
0  21528   3869
1   1449  23986
---- Validation: 
scalar performance:
{'acc': 0.7909829, 'precision': 0.51676416, 'recall': 0.6113885, 'specificity': 0.6113885, 'f1': 0.4871042, 'auroc': 0.6610303, 'binary_precision': 0.051822323, 'binary_recall': 0.42227378, 'binary_specificity': 0.80050325, 'binary_f1_score': 0.092315495}
confusion matrix:
       0     1
0  13362  3330
1    249   182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83519965, 'precision': 0.61709344, 'recall': 0.7603973, 'specificity': 0.7603973, 'f1': 0.642343, 'auroc': 0.808465, 'binary_precision': 0.264553, 'binary_recall': 0.672391, 'binary_specificity': 0.8484037, 'binary_f1_score': 0.37970904}
confusion matrix:
      0     1
0  7919  1415
1   248   509
new oracle model saved
early stop counter: 5
val acc:0.7909829020500183, best validation acc: 0.8121824264526367, corresponding to test acc:                         0.8281636834144592 / 0.8351996541023254
after epoch: 11,now: 2024-08-09 13:59:00.335245,epoch time: 0:14:29.278969,used: 2:42:04.641127,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8994728, 'precision': 0.9014739, 'recall': 0.8994492, 'specificity': 0.8994492, 'f1': 0.8993435, 'auroc': 0.9702362, 'binary_precision': 0.8732964, 'binary_recall': 0.93469113, 'binary_specificity': 0.86420727, 'binary_f1_score': 0.90295136}
confusion matrix:
       0      1
0  21950   3449
1   1661  23772
---- Validation: 
scalar performance:
{'acc': 0.81860656, 'precision': 0.5176689, 'recall': 0.6040843, 'specificity': 0.6040843, 'f1': 0.497095, 'auroc': 0.66459477, 'binary_precision': 0.054315228, 'binary_recall': 0.37819025, 'binary_specificity': 0.8299784, 'binary_f1_score': 0.09498834}
confusion matrix:
       0     1
0  13854  2838
1    268   163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8568031, 'precision': 0.6249643, 'recall': 0.7405145, 'specificity': 0.7405145, 'f1': 0.65318865, 'auroc': 0.7867168, 'binary_precision': 0.28526843, 'binary_recall': 0.6036988, 'binary_specificity': 0.8773302, 'binary_f1_score': 0.38745233}
confusion matrix:
      0     1
0  8189  1145
1   300   457
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-09 14:13:19.345749,epoch time: 0:14:19.010504,used: 2:56:23.651631,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.90647626, 'precision': 0.9087175, 'recall': 0.90644574, 'specificity': 0.90644574, 'f1': 0.9063432, 'auroc': 0.9748627, 'binary_precision': 0.8786569, 'binary_recall': 0.94338953, 'binary_specificity': 0.8695019, 'binary_f1_score': 0.90987337}
confusion matrix:
       0      1
0  22081   3314
1   1440  23997
---- Validation: 
scalar performance:
{'acc': 0.80797756, 'precision': 0.518086, 'recall': 0.6121943, 'specificity': 0.6121943, 'f1': 0.49439192, 'auroc': 0.6606064, 'binary_precision': 0.05456813, 'binary_recall': 0.40603247, 'binary_specificity': 0.8183561, 'binary_f1_score': 0.0962067}
confusion matrix:
       0     1
0  13660  3032
1    256   175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84183925, 'precision': 0.6216316, 'recall': 0.76277256, 'specificity': 0.76277256, 'f1': 0.6488397, 'auroc': 0.7977356, 'binary_precision': 0.27361035, 'binary_recall': 0.669749, 'binary_specificity': 0.85579604, 'binary_f1_score': 0.38850573}
confusion matrix:
      0     1
0  7988  1346
1   250   507
early stop counter: 1
val acc:0.807977557182312, best validation acc: 0.8186065554618835, corresponding to test acc:                         0.8568031191825867 / 0.8568031191825867
after epoch: 13,now: 2024-08-09 14:27:40.429621,epoch time: 0:14:21.083872,used: 3:10:44.735503,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9070861, 'precision': 0.9097685, 'recall': 0.9070559, 'specificity': 0.9070559, 'f1': 0.9069292, 'auroc': 0.97630465, 'binary_precision': 0.8768011, 'binary_recall': 0.94743466, 'binary_specificity': 0.86667717, 'binary_f1_score': 0.91075045}
confusion matrix:
       0      1
0  22011   3386
1   1337  24098
---- Validation: 
scalar performance:
{'acc': 0.80459034, 'precision': 0.51807654, 'recall': 0.6138474, 'specificity': 0.6138474, 'f1': 0.4933087, 'auroc': 0.6786797, 'binary_precision': 0.05441761, 'binary_recall': 0.41299304, 'binary_specificity': 0.8147017, 'binary_f1_score': 0.09616424}
confusion matrix:
       0     1
0  13599  3093
1    253   178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86651474, 'precision': 0.63297296, 'recall': 0.7409086, 'specificity': 0.7409086, 'f1': 0.6624519, 'auroc': 0.80600256, 'binary_precision': 0.30174732, 'binary_recall': 0.59313077, 'binary_specificity': 0.88868654, 'binary_f1_score': 0.4}
confusion matrix:
      0     1
0  8295  1039
1   308   449
new oracle model saved
early stop counter: 2
val acc:0.8045903444290161, best validation acc: 0.8186065554618835, corresponding to test acc:                         0.8568031191825867 / 0.8665147423744202
after epoch: 14,now: 2024-08-09 14:42:24.221977,epoch time: 0:14:43.792356,used: 3:25:28.527859,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9139912, 'precision': 0.91447043, 'recall': 0.9139772, 'specificity': 0.9139772, 'f1': 0.9139643, 'auroc': 0.9757627, 'binary_precision': 0.9005819, 'binary_recall': 0.93088806, 'binary_specificity': 0.89706635, 'binary_f1_score': 0.9154842}
confusion matrix:
       0      1
0  22781   2614
1   1758  23679
---- Validation: 
scalar performance:
{'acc': 0.8558664, 'precision': 0.5238987, 'recall': 0.6152843, 'specificity': 0.6152843, 'f1': 0.51689816, 'auroc': 0.689069, 'binary_precision': 0.06641124, 'binary_recall': 0.36194897, 'binary_specificity': 0.8686197, 'binary_f1_score': 0.11223022}
confusion matrix:
       0     1
0  14499  2193
1    275   156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89901894, 'precision': 0.6603824, 'recall': 0.7008201, 'specificity': 0.7008201, 'f1': 0.677372, 'auroc': 0.81481713, 'binary_precision': 0.36494845, 'binary_recall': 0.4676354, 'binary_specificity': 0.9340047, 'binary_f1_score': 0.40995944}
confusion matrix:
      0    1
0  8718  616
1   403  354
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-09 14:57:05.423624,epoch time: 0:14:41.201647,used: 3:40:09.729506,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_16_55_seed_1_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:40:09.729506 at 2024-08-09 14:57:05.423624
persisted model performance metric: 

scalar performance:
{'acc': 0.89901894, 'precision': 0.6603824, 'recall': 0.7008201, 'specificity': 0.7008201, 'f1': 0.677372, 'auroc': 0.81481713, 'binary_precision': 0.36494845, 'binary_recall': 0.4676354, 'binary_specificity': 0.9340047, 'binary_f1_score': 0.40995944}
confusion matrix:
      0    1
0  8718  616
1   403  354
oracle model performance metric: 

scalar performance:
{'acc': 0.89901894, 'precision': 0.6603824, 'recall': 0.7008201, 'specificity': 0.7008201, 'f1': 0.677372, 'auroc': 0.81481713, 'binary_precision': 0.36494845, 'binary_recall': 0.4676354, 'binary_specificity': 0.9340047, 'binary_f1_score': 0.40995944}
confusion matrix:
      0    1
0  8718  616
1   403  354
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 574656 KiB | 407881 GiB | 407881 GiB |
|       from large pool | 165120 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1090 MiB | 489472 KiB |
|       from large pool | 550912 KiB | 661504 KiB |    984 MiB | 456704 KiB |
|       from small pool |  75776 KiB |  77824 KiB |    106 MiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 257068 GiB | 257068 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |   9343 KiB |  14884 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7123    |   87545 K  |   87540 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59624 K  |   59620 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7123    |   87545 K  |   87540 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59624 K  |   59620 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      77    |      23    |
|       from large pool |      17    |      17    |      24    |       7    |
|       from small pool |      37    |      38    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      50    |    3190    |   46443 K  |   46443 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |      47    |    3187    |   28390 K  |   28390 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407881 GiB | 407881 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257068 GiB | 257068 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |      0 KiB |  16938 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59624 K  |   59624 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59624 K  |   59624 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46445 K  |   46445 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |       0    |    3187    |   28392 K  |   28392 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407881 GiB | 407881 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257068 GiB | 257068 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |      0 KiB |  16938 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59624 K  |   59624 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87545 K  |   87545 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59624 K  |   59624 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46445 K  |   46445 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |       0    |    3187    |   28392 K  |   28392 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703

 Experiment start at: 2024-08-09 15:17:21.383123
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7464601, 'precision': 0.7708431, 'recall': 0.7464194, 'specificity': 0.7464194, 'f1': 0.7406016, 'auroc': 0.8565078, 'binary_precision': 0.68964595, 'binary_recall': 0.8964997, 'binary_specificity': 0.59633917, 'binary_f1_score': 0.7795846}
confusion matrix:
       0      1
0  15410  10431
1   2676  23179
---- Validation: 
scalar performance:
{'acc': 0.5954216, 'precision': 0.51237136, 'recall': 0.6258766, 'specificity': 0.6258766, 'f1': 0.40737596, 'auroc': 0.6768955, 'binary_precision': 0.03895184, 'binary_recall': 0.65789473, 'binary_specificity': 0.5938585, 'binary_f1_score': 0.07354908}
confusion matrix:
      0     1
0  9921  6785
1   143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3302616, 'precision': 0.4995706, 'recall': 0.49876297, 'specificity': 0.49876297, 'f1': 0.29623753, 'auroc': 0.5158466, 'binary_precision': 0.07871679, 'binary_recall': 0.6988708, 'binary_specificity': 0.29865518, 'binary_f1_score': 0.14149626}
confusion matrix:
      0     1
0  2776  6519
1   240   557
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 15:33:02.840625,epoch time: 0:15:41.457502,used: 0:15:41.457502,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8172199, 'precision': 0.8264221, 'recall': 0.81720686, 'specificity': 0.81720686, 'f1': 0.8159183, 'auroc': 0.91133714, 'binary_precision': 0.77165383, 'binary_recall': 0.90116817, 'binary_specificity': 0.7332456, 'binary_f1_score': 0.8313973}
confusion matrix:
       0      1
0  18950   6894
1   2555  23297
---- Validation: 
scalar performance:
{'acc': 0.69411355, 'precision': 0.51295125, 'recall': 0.6158126, 'specificity': 0.6158126, 'f1': 0.4475441, 'auroc': 0.64718413, 'binary_precision': 0.042347133, 'binary_recall': 0.5334928, 'binary_specificity': 0.6981324, 'binary_f1_score': 0.07846587}
confusion matrix:
       0     1
0  11663  5043
1    195   223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5176377, 'precision': 0.52691233, 'recall': 0.5924545, 'specificity': 0.5924545, 'f1': 0.4201521, 'auroc': 0.6338395, 'binary_precision': 0.10529377, 'binary_recall': 0.6813049, 'binary_specificity': 0.5036041, 'binary_f1_score': 0.1823984}
confusion matrix:
      0     1
0  4681  4614
1   254   543
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 15:47:57.069471,epoch time: 0:14:54.228846,used: 0:30:35.686348,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.83343005, 'precision': 0.8495322, 'recall': 0.8334176, 'specificity': 0.8334176, 'f1': 0.8314857, 'auroc': 0.9328016, 'binary_precision': 0.77453977, 'binary_recall': 0.9407373, 'binary_specificity': 0.7260979, 'binary_f1_score': 0.8495869}
confusion matrix:
       0      1
0  18766   7079
1   1532  24319
---- Validation: 
scalar performance:
{'acc': 0.64488435, 'precision': 0.51178664, 'recall': 0.613907, 'specificity': 0.613907, 'f1': 0.4271625, 'auroc': 0.65371597, 'binary_precision': 0.03951862, 'binary_recall': 0.5813397, 'binary_specificity': 0.6464743, 'binary_f1_score': 0.0740064}
confusion matrix:
       0     1
0  10800  5906
1    175   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46145463, 'precision': 0.53579664, 'recall': 0.61931026, 'specificity': 0.61931026, 'f1': 0.39382076, 'auroc': 0.7011464, 'binary_precision': 0.108541526, 'binary_recall': 0.8067754, 'binary_specificity': 0.43184507, 'binary_f1_score': 0.19134057}
confusion matrix:
      0     1
0  4014  5281
1   154   643
early stop counter: 1
val acc:0.6448843479156494, best validation acc: 0.694113552570343, corresponding to test acc:                         0.5176377296447754 / 0.5176377296447754
after epoch: 3,now: 2024-08-09 16:02:54.874532,epoch time: 0:14:57.805061,used: 0:45:33.491409,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.84673864, 'precision': 0.8581171, 'recall': 0.84671104, 'specificity': 0.84671104, 'f1': 0.84550416, 'auroc': 0.93884647, 'binary_precision': 0.79436, 'binary_recall': 0.935837, 'binary_specificity': 0.75758517, 'binary_f1_score': 0.85931426}
confusion matrix:
       0      1
0  19576   6264
1   1659  24197
---- Validation: 
scalar performance:
{'acc': 0.7138519, 'precision': 0.51607925, 'recall': 0.6387574, 'specificity': 0.6387574, 'f1': 0.45875785, 'auroc': 0.67380756, 'binary_precision': 0.047272727, 'binary_recall': 0.5598086, 'binary_specificity': 0.7177062, 'binary_f1_score': 0.087183304}
confusion matrix:
       0     1
0  11990  4716
1    184   234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.628914, 'precision': 0.5491586, 'recall': 0.66261387, 'specificity': 0.66261387, 'f1': 0.4928741, 'auroc': 0.6957463, 'binary_precision': 0.13765979, 'binary_recall': 0.7026349, 'binary_specificity': 0.6225928, 'binary_f1_score': 0.23021583}
confusion matrix:
      0     1
0  5787  3508
1   237   560
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 16:17:53.614311,epoch time: 0:14:58.739779,used: 1:00:32.231188,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86735916, 'precision': 0.869718, 'recall': 0.8673514, 'specificity': 0.8673514, 'f1': 0.86714554, 'auroc': 0.94660145, 'binary_precision': 0.840235, 'binary_recall': 0.9072835, 'binary_specificity': 0.8274194, 'binary_f1_score': 0.87247294}
confusion matrix:
       0      1
0  21383   4460
1   2397  23456
---- Validation: 
scalar performance:
{'acc': 0.76822007, 'precision': 0.5121673, 'recall': 0.5896496, 'specificity': 0.5896496, 'f1': 0.47274846, 'auroc': 0.63530564, 'binary_precision': 0.043220993, 'binary_recall': 0.40191388, 'binary_specificity': 0.77738535, 'binary_f1_score': 0.07804877}
confusion matrix:
       0     1
0  12987  3719
1    250   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6593341, 'precision': 0.5552314, 'recall': 0.6774074, 'specificity': 0.6774074, 'f1': 0.51239705, 'auroc': 0.716694, 'binary_precision': 0.14833555, 'binary_recall': 0.6988708, 'binary_specificity': 0.65594405, 'binary_f1_score': 0.24472758}
confusion matrix:
      0     1
0  6097  3198
1   240   557
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 16:33:01.995437,epoch time: 0:15:08.381126,used: 1:15:40.612314,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8760059, 'precision': 0.87919486, 'recall': 0.8759935, 'specificity': 0.8759935, 'f1': 0.8757421, 'auroc': 0.9550368, 'binary_precision': 0.84448856, 'binary_recall': 0.9218333, 'binary_specificity': 0.83015364, 'binary_f1_score': 0.8814675}
confusion matrix:
       0      1
0  21452   4389
1   2021  23834
---- Validation: 
scalar performance:
{'acc': 0.79181266, 'precision': 0.51773906, 'recall': 0.62156725, 'specificity': 0.62156725, 'f1': 0.4882108, 'auroc': 0.68115205, 'binary_precision': 0.05260165, 'binary_recall': 0.44258374, 'binary_specificity': 0.8005507, 'binary_f1_score': 0.09402796}
confusion matrix:
       0     1
0  13374  3332
1    233   185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74881095, 'precision': 0.56860316, 'recall': 0.6852591, 'specificity': 0.6852591, 'f1': 0.5625771, 'auroc': 0.72035307, 'binary_precision': 0.17933579, 'binary_recall': 0.6097867, 'binary_specificity': 0.7607316, 'binary_f1_score': 0.27715996}
confusion matrix:
      0     1
0  7071  2224
1   311   486
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 16:48:51.430407,epoch time: 0:15:49.434970,used: 1:31:30.047284,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8500464, 'precision': 0.8703822, 'recall': 0.85003734, 'specificity': 0.85003734, 'f1': 0.84795713, 'auroc': 0.95836854, 'binary_precision': 0.78361434, 'binary_recall': 0.96719533, 'binary_specificity': 0.73287934, 'binary_f1_score': 0.8657801}
confusion matrix:
       0      1
0  18942   6904
1    848  25002
---- Validation: 
scalar performance:
{'acc': 0.7060266, 'precision': 0.5187216, 'recall': 0.6650692, 'specificity': 0.6650692, 'f1': 0.45909443, 'auroc': 0.71497387, 'binary_precision': 0.05062305, 'binary_recall': 0.6220096, 'binary_specificity': 0.7081288, 'binary_f1_score': 0.093626216}
confusion matrix:
       0     1
0  11830  4876
1    158   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72621876, 'precision': 0.56764257, 'recall': 0.69478977, 'specificity': 0.69478977, 'f1': 0.55312, 'auroc': 0.72733366, 'binary_precision': 0.17385533, 'binary_recall': 0.6574655, 'binary_specificity': 0.732114, 'binary_f1_score': 0.27499342}
confusion matrix:
      0     1
0  6805  2490
1   273   524
early stop counter: 1
val acc:0.7060266137123108, best validation acc: 0.7918126583099365, corresponding to test acc:                         0.7488109469413757 / 0.7488109469413757
after epoch: 7,now: 2024-08-09 17:04:34.107929,epoch time: 0:15:42.677522,used: 1:47:12.724806,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.88026154, 'precision': 0.88310903, 'recall': 0.88024986, 'specificity': 0.88024986, 'f1': 0.8800363, 'auroc': 0.9585825, 'binary_precision': 0.8501478, 'binary_recall': 0.9233417, 'binary_specificity': 0.837158, 'binary_f1_score': 0.88523436}
confusion matrix:
       0      1
0  21633   4208
1   1982  23873
---- Validation: 
scalar performance:
{'acc': 0.77989954, 'precision': 0.51600975, 'recall': 0.61429536, 'specificity': 0.61429536, 'f1': 0.48189163, 'auroc': 0.66627276, 'binary_precision': 0.049475666, 'binary_recall': 0.4401914, 'binary_specificity': 0.7883994, 'binary_f1_score': 0.088953346}
confusion matrix:
       0     1
0  13171  3535
1    234   184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7712049, 'precision': 0.5731362, 'recall': 0.68422437, 'specificity': 0.68422437, 'f1': 0.57500595, 'auroc': 0.7238889, 'binary_precision': 0.18990976, 'binary_recall': 0.5809285, 'binary_specificity': 0.7875202, 'binary_f1_score': 0.28624418}
confusion matrix:
      0     1
0  7320  1975
1   334   463
new oracle model saved
early stop counter: 2
val acc:0.779899537563324, best validation acc: 0.7918126583099365, corresponding to test acc:                         0.7488109469413757 / 0.7712048888206482
after epoch: 8,now: 2024-08-09 17:20:17.547902,epoch time: 0:15:43.439973,used: 2:02:56.164779,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8975936, 'precision': 0.90012705, 'recall': 0.8975905, 'specificity': 0.8975905, 'f1': 0.8974308, 'auroc': 0.96970963, 'binary_precision': 0.8683079, 'binary_recall': 0.93736947, 'binary_specificity': 0.8578116, 'binary_f1_score': 0.901518}
confusion matrix:
       0      1
0  22171   3675
1   1619  24231
---- Validation: 
scalar performance:
{'acc': 0.7870241, 'precision': 0.51515454, 'recall': 0.6051181, 'specificity': 0.6051181, 'f1': 0.4830548, 'auroc': 0.6546725, 'binary_precision': 0.048391607, 'binary_recall': 0.4138756, 'binary_specificity': 0.7963606, 'binary_f1_score': 0.08665163}
confusion matrix:
       0     1
0  13304  3402
1    245   173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79052716, 'precision': 0.58916223, 'recall': 0.71708274, 'specificity': 0.71708274, 'f1': 0.5990646, 'auroc': 0.75368166, 'binary_precision': 0.21628608, 'binary_recall': 0.629862, 'binary_specificity': 0.8043034, 'binary_f1_score': 0.32200128}
confusion matrix:
      0     1
0  7476  1819
1   295   502
new oracle model saved
early stop counter: 3
val acc:0.7870240807533264, best validation acc: 0.7918126583099365, corresponding to test acc:                         0.7488109469413757 / 0.7905271649360657
after epoch: 9,now: 2024-08-09 17:35:50.502854,epoch time: 0:15:32.954952,used: 2:18:29.119731,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9005919, 'precision': 0.9010756, 'recall': 0.9005872, 'specificity': 0.9005872, 'f1': 0.9005611, 'auroc': 0.9667783, 'binary_precision': 0.88721496, 'binary_recall': 0.9179269, 'binary_specificity': 0.88324755, 'binary_f1_score': 0.9023096}
confusion matrix:
       0      1
0  22824   3017
1   2122  23733
---- Validation: 
scalar performance:
{'acc': 0.84220976, 'precision': 0.51754755, 'recall': 0.5937491, 'specificity': 0.5937491, 'f1': 0.50343716, 'auroc': 0.6798215, 'binary_precision': 0.054254487, 'binary_recall': 0.3325359, 'binary_specificity': 0.8549623, 'binary_f1_score': 0.093288586}
confusion matrix:
       0     1
0  14283  2423
1    279   139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84126043, 'precision': 0.6022656, 'recall': 0.68898904, 'specificity': 0.68898904, 'f1': 0.62283957, 'auroc': 0.7372325, 'binary_precision': 0.250774, 'binary_recall': 0.5081556, 'binary_specificity': 0.8698225, 'binary_f1_score': 0.3358209}
confusion matrix:
      0     1
0  8085  1210
1   392   405
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-09 17:50:54.222936,epoch time: 0:15:03.720082,used: 2:33:32.839813,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9090065, 'precision': 0.9091381, 'recall': 0.9090051, 'specificity': 0.9090051, 'f1': 0.90899897, 'auroc': 0.9714055, 'binary_precision': 0.9018393, 'binary_recall': 0.91795605, 'binary_specificity': 0.90005416, 'binary_f1_score': 0.9098263}
confusion matrix:
       0      1
0  23261   2583
1   2121  23731
---- Validation: 
scalar performance:
{'acc': 0.85172856, 'precision': 0.51884454, 'recall': 0.59512883, 'specificity': 0.59512883, 'f1': 0.50799906, 'auroc': 0.67722344, 'binary_precision': 0.05683243, 'binary_recall': 0.32535884, 'binary_specificity': 0.86489886, 'binary_f1_score': 0.09676272}
confusion matrix:
       0     1
0  14449  2257
1    282   136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85642093, 'precision': 0.61414313, 'recall': 0.69263077, 'specificity': 0.69263077, 'f1': 0.6366127, 'auroc': 0.73631185, 'binary_precision': 0.2745505, 'binary_recall': 0.49811795, 'binary_specificity': 0.8871436, 'binary_f1_score': 0.3539902}
confusion matrix:
      0     1
0  8246  1049
1   400   397
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-09 18:06:08.304824,epoch time: 0:15:14.081888,used: 2:48:46.921701,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91043794, 'precision': 0.9115935, 'recall': 0.9104338, 'specificity': 0.9104338, 'f1': 0.91037446, 'auroc': 0.9750433, 'binary_precision': 0.8898237, 'binary_recall': 0.9369101, 'binary_specificity': 0.88395756, 'binary_f1_score': 0.91276}
confusion matrix:
       0      1
0  22845   2999
1   1631  24221
---- Validation: 
scalar performance:
{'acc': 0.82007706, 'precision': 0.5240117, 'recall': 0.64771545, 'specificity': 0.64771545, 'f1': 0.50612617, 'auroc': 0.7124528, 'binary_precision': 0.0638716, 'binary_recall': 0.46650717, 'binary_specificity': 0.82892376, 'binary_f1_score': 0.11235955}
confusion matrix:
       0     1
0  13848  2858
1    223   195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8528538, 'precision': 0.6160239, 'recall': 0.7056068, 'specificity': 0.7056068, 'f1': 0.63987756, 'auroc': 0.75950575, 'binary_precision': 0.27574968, 'binary_recall': 0.53074026, 'binary_specificity': 0.8804734, 'binary_f1_score': 0.36293435}
confusion matrix:
      0     1
0  8184  1111
1   374   423
early stop counter: 1
val acc:0.8200770616531372, best validation acc: 0.8517285585403442, corresponding to test acc:                         0.8564209342002869 / 0.8564209342002869
after epoch: 12,now: 2024-08-09 18:22:02.428558,epoch time: 0:15:54.123734,used: 3:04:41.045435,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9033968, 'precision': 0.90668654, 'recall': 0.90339327, 'specificity': 0.90339327, 'f1': 0.9032005, 'auroc': 0.9746202, 'binary_precision': 0.8701285, 'binary_recall': 0.9483559, 'binary_specificity': 0.8584307, 'binary_f1_score': 0.9075596}
confusion matrix:
       0      1
0  22187   3659
1   1335  24515
---- Validation: 
scalar performance:
{'acc': 0.8050105, 'precision': 0.5250408, 'recall': 0.665651, 'specificity': 0.665651, 'f1': 0.5027313, 'auroc': 0.7274219, 'binary_precision': 0.064679585, 'binary_recall': 0.51913875, 'binary_specificity': 0.8121633, 'binary_f1_score': 0.115027845}
confusion matrix:
       0     1
0  13568  3138
1    201   217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85642093, 'precision': 0.62061274, 'recall': 0.7109847, 'specificity': 0.7109847, 'f1': 0.64542884, 'auroc': 0.77753127, 'binary_precision': 0.28410596, 'binary_recall': 0.5382685, 'binary_specificity': 0.8837009, 'binary_f1_score': 0.37191156}
confusion matrix:
      0     1
0  8214  1081
1   368   429
early stop counter: 2
val acc:0.8050104975700378, best validation acc: 0.8517285585403442, corresponding to test acc:                         0.8564209342002869 / 0.8564209342002869
after epoch: 13,now: 2024-08-09 18:37:02.542014,epoch time: 0:15:00.113456,used: 3:19:41.158891,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9127205, 'precision': 0.91383934, 'recall': 0.9127155, 'specificity': 0.9127155, 'f1': 0.9126607, 'auroc': 0.9767237, 'binary_precision': 0.8923699, 'binary_recall': 0.93869185, 'binary_specificity': 0.88673913, 'binary_f1_score': 0.91494495}
confusion matrix:
       0      1
0  22916   2927
1   1585  24268
---- Validation: 
scalar performance:
{'acc': 0.7981196, 'precision': 0.5174744, 'recall': 0.61663586, 'specificity': 0.61663586, 'f1': 0.4898892, 'auroc': 0.68422365, 'binary_precision': 0.052430045, 'binary_recall': 0.4258373, 'binary_specificity': 0.80743444, 'binary_f1_score': 0.093364805}
confusion matrix:
       0     1
0  13489  3217
1    240   178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86811334, 'precision': 0.63813704, 'recall': 0.7333919, 'specificity': 0.7333919, 'f1': 0.6664655, 'auroc': 0.7673665, 'binary_precision': 0.31560773, 'binary_recall': 0.57340026, 'binary_specificity': 0.89338356, 'binary_f1_score': 0.40712693}
confusion matrix:
      0    1
0  8304  991
1   340  457
new oracle model saved
early stop counter: 3
val acc:0.7981196045875549, best validation acc: 0.8517285585403442, corresponding to test acc:                         0.8564209342002869 / 0.8681133389472961
after epoch: 14,now: 2024-08-09 18:51:45.347511,epoch time: 0:14:42.805497,used: 3:34:23.964388,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.913649, 'precision': 0.9146368, 'recall': 0.91364527, 'specificity': 0.91364527, 'f1': 0.91359705, 'auroc': 0.976171, 'binary_precision': 0.8944379, 'binary_recall': 0.93803185, 'binary_specificity': 0.8892586, 'binary_f1_score': 0.91571635}
confusion matrix:
       0      1
0  22982   2862
1   1602  24250
---- Validation: 
scalar performance:
{'acc': 0.8379467, 'precision': 0.52174443, 'recall': 0.6207203, 'specificity': 0.6207203, 'f1': 0.5083024, 'auroc': 0.68236357, 'binary_precision': 0.061080076, 'binary_recall': 0.3923445, 'binary_specificity': 0.8490961, 'binary_f1_score': 0.105704166}
confusion matrix:
       0     1
0  14185  2521
1    254   164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85126835, 'precision': 0.6254244, 'recall': 0.73743904, 'specificity': 0.73743904, 'f1': 0.65269655, 'auroc': 0.7752556, 'binary_precision': 0.28846154, 'binary_recall': 0.60225844, 'binary_specificity': 0.8726197, 'binary_f1_score': 0.3900853}
confusion matrix:
      0     1
0  8111  1184
1   317   480
early stop counter: 4
val acc:0.8379467129707336, best validation acc: 0.8517285585403442, corresponding to test acc:                         0.8564209342002869 / 0.8681133389472961
after epoch: 15,now: 2024-08-09 19:06:59.845638,epoch time: 0:15:14.498127,used: 3:49:38.462515,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_17_21_seed_2_24132703
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:49:38.462515 at 2024-08-09 19:06:59.845638
persisted model performance metric: 

scalar performance:
{'acc': 0.85642093, 'precision': 0.61414313, 'recall': 0.69263077, 'specificity': 0.69263077, 'f1': 0.6366127, 'auroc': 0.73631185, 'binary_precision': 0.2745505, 'binary_recall': 0.49811795, 'binary_specificity': 0.8871436, 'binary_f1_score': 0.3539902}
confusion matrix:
      0     1
0  8246  1049
1   400   397
oracle model performance metric: 

scalar performance:
{'acc': 0.86811334, 'precision': 0.63813704, 'recall': 0.7333919, 'specificity': 0.7333919, 'f1': 0.6664655, 'auroc': 0.7673665, 'binary_precision': 0.31560773, 'binary_recall': 0.57340026, 'binary_specificity': 0.89338356, 'binary_f1_score': 0.40712693}
confusion matrix:
      0    1
0  8304  991
1   340  457
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 586359 KiB | 624945 GiB | 624944 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624065 GiB | 624065 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 586359 KiB | 624945 GiB | 624944 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624065 GiB | 624065 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 579948 KiB | 618484 GiB | 618483 GiB |
|       from large pool | 165120 KiB | 508176 KiB | 617635 GiB | 617635 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1476 MiB |    864 MiB |
|       from large pool | 550912 KiB | 661504 KiB |   1342 MiB |    804 MiB |
|       from small pool |  75776 KiB |  77824 KiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 378041 GiB | 378041 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 377090 GiB | 377090 GiB |
|       from small pool |   9343 KiB |  16938 KiB |    950 GiB |    950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7231    |  132534 K  |  132529 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90197 K  |   90193 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7231    |  132534 K  |  132529 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90197 K  |   90193 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      99    |      45    |
|       from large pool |      17    |      17    |      32    |      15    |
|       from small pool |      37    |      38    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3243    |   70671 K  |   70671 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |      49    |    3240    |   42937 K  |   42937 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624065 GiB | 624065 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624065 GiB | 624065 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 579948 KiB | 618484 GiB | 618484 GiB |
|       from large pool |  16640 KiB | 508176 KiB | 617635 GiB | 617635 GiB |
|       from small pool |      0 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1476 MiB |   1250 MiB |
|       from large pool | 184320 KiB | 661504 KiB |   1342 MiB |   1162 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    134 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 378041 GiB | 378041 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 377090 GiB | 377090 GiB |
|       from small pool |      0 KiB |  16938 KiB |    950 GiB |    950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7231    |  132534 K  |  132534 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90197 K  |   90197 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7231    |  132534 K  |  132534 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90197 K  |   90197 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      99    |      67    |
|       from large pool |       9    |      17    |      32    |      23    |
|       from small pool |      23    |      38    |      67    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3243    |   70673 K  |   70673 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |       0    |    3240    |   42939 K  |   42939 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 19:21:40 2024]
Finished job 0.
1 of 1 steps (100%) done
