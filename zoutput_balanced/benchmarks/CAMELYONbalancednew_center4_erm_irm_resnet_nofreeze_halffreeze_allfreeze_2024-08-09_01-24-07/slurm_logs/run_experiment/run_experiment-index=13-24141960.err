Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 11:59:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960

 Experiment start at: 2024-08-10 12:07:37.202211
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663811, 'precision': 0.9666153, 'recall': 0.9663882, 'specificity': 0.9663882, 'f1': 0.96637726, 'auroc': 0.993859, 'binary_precision': 0.9772296, 'binary_recall': 0.9550584, 'binary_specificity': 0.97771806, 'binary_f1_score': 0.9660168}
confusion matrix:
       0      1
0  24748    564
1   1139  24205
---- Validation: 
scalar performance:
{'acc': 0.97002214, 'precision': 0.6898202, 'recall': 0.7120545, 'specificity': 0.7120545, 'f1': 0.70026267, 'auroc': 0.8595809, 'binary_precision': 0.3935484, 'binary_recall': 0.44096386, 'binary_specificity': 0.98314506, 'binary_f1_score': 0.4159091}
confusion matrix:
       0    1
0  16449  282
1    232  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9209017, 'precision': 0.69446284, 'recall': 0.5798995, 'specificity': 0.5798995, 'f1': 0.6066772, 'auroc': 0.87065065, 'binary_precision': 0.4536424, 'binary_recall': 0.17746115, 'binary_specificity': 0.98233783, 'binary_f1_score': 0.25512108}
confusion matrix:
      0    1
0  9177  165
1   635  137
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 12:24:16.426595,epoch time: 0:16:39.224384,used: 0:16:39.224384,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9725008, 'precision': 0.9725494, 'recall': 0.97249746, 'specificity': 0.97249746, 'f1': 0.97249997, 'auroc': 0.9967481, 'binary_precision': 0.96792215, 'binary_recall': 0.9774314, 'binary_specificity': 0.9675635, 'binary_f1_score': 0.97265357}
confusion matrix:
       0      1
0  24490    821
1    572  24773
---- Validation: 
scalar performance:
{'acc': 0.9579494, 'precision': 0.65537, 'recall': 0.8092626, 'specificity': 0.8092626, 'f1': 0.7036538, 'auroc': 0.90619874, 'binary_precision': 0.31957546, 'binary_recall': 0.65301204, 'binary_specificity': 0.9655131, 'binary_f1_score': 0.42913696}
confusion matrix:
       0    1
0  16154  577
1    144  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9165513, 'precision': 0.69388515, 'recall': 0.65537775, 'specificity': 0.65537775, 'f1': 0.67181325, 'auroc': 0.8941627, 'binary_precision': 0.44078946, 'binary_recall': 0.34715027, 'binary_specificity': 0.9636052, 'binary_f1_score': 0.38840577}
confusion matrix:
      0    1
0  9002  340
1   504  268
early stop counter: 1
val acc:0.9579493999481201, best validation acc: 0.9700221419334412, corresponding to test acc:                         0.9209017157554626 / 0.9209017157554626
after epoch: 2,now: 2024-08-10 12:39:26.699391,epoch time: 0:15:10.272796,used: 0:31:49.497180,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9808315, 'precision': 0.9808842, 'recall': 0.9808289, 'specificity': 0.9808289, 'f1': 0.9808309, 'auroc': 0.9982453, 'binary_precision': 0.9759766, 'binary_recall': 0.9859516, 'binary_specificity': 0.9757061, 'binary_f1_score': 0.98093873}
confusion matrix:
       0      1
0  24700    615
1    356  24985
---- Validation: 
scalar performance:
{'acc': 0.96407324, 'precision': 0.68025416, 'recall': 0.8253248, 'specificity': 0.8253248, 'f1': 0.72968125, 'auroc': 0.91506773, 'binary_precision': 0.36862746, 'binary_recall': 0.67951804, 'binary_specificity': 0.97113144, 'binary_f1_score': 0.47796607}
confusion matrix:
       0    1
0  16248  483
1    133  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9200119, 'precision': 0.67768735, 'recall': 0.55862266, 'specificity': 0.55862266, 'f1': 0.57963973, 'auroc': 0.89744073, 'binary_precision': 0.42323652, 'binary_recall': 0.13212435, 'binary_specificity': 0.98512095, 'binary_f1_score': 0.20138203}
confusion matrix:
      0    1
0  9203  139
1   670  102
early stop counter: 2
val acc:0.9640732407569885, best validation acc: 0.9700221419334412, corresponding to test acc:                         0.9209017157554626 / 0.9209017157554626
after epoch: 3,now: 2024-08-10 12:54:34.046739,epoch time: 0:15:07.347348,used: 0:46:56.844528,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9856088, 'precision': 0.9856112, 'recall': 0.98560965, 'specificity': 0.98560965, 'f1': 0.9856088, 'auroc': 0.9986712, 'binary_precision': 0.9868671, 'binary_recall': 0.98433614, 'binary_specificity': 0.98688316, 'binary_f1_score': 0.98559994}
confusion matrix:
       0      1
0  24979    332
1    397  24948
---- Validation: 
scalar performance:
{'acc': 0.97311324, 'precision': 0.72428536, 'recall': 0.7958838, 'specificity': 0.7958838, 'f1': 0.75471723, 'auroc': 0.9186698, 'binary_precision': 0.45833334, 'binary_recall': 0.6096386, 'binary_specificity': 0.982129, 'binary_f1_score': 0.52326787}
confusion matrix:
       0    1
0  16432  299
1    162  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9220882, 'precision': 0.6522224, 'recall': 0.5139973, 'specificity': 0.5139973, 'f1': 0.5095132, 'auroc': 0.88100904, 'binary_precision': 0.37878788, 'binary_recall': 0.03238342, 'binary_specificity': 0.9956112, 'binary_f1_score': 0.059665874}
confusion matrix:
      0   1
0  9301  41
1   747  25
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-10 13:09:39.669835,epoch time: 0:15:05.623096,used: 1:02:02.467624,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95795166, 'precision': 0.9603348, 'recall': 0.9579319, 'specificity': 0.9579319, 'f1': 0.9578959, 'auroc': 0.99814296, 'binary_precision': 0.92735106, 'binary_recall': 0.99380475, 'binary_specificity': 0.92205894, 'binary_f1_score': 0.95942855}
confusion matrix:
       0      1
0  23341   1973
1    157  25185
---- Validation: 
scalar performance:
{'acc': 0.90510905, 'precision': 0.5857684, 'recall': 0.8538581, 'specificity': 0.8538581, 'f1': 0.6194938, 'auroc': 0.91295075, 'binary_precision': 0.17697228, 'binary_recall': 0.8, 'binary_specificity': 0.9077162, 'binary_f1_score': 0.28982976}
confusion matrix:
       0     1
0  15187  1544
1     83   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9200119, 'precision': 0.676952, 'recall': 0.5574344, 'specificity': 0.5574344, 'f1': 0.57806116, 'auroc': 0.90394485, 'binary_precision': 0.42194092, 'binary_recall': 0.12953368, 'binary_specificity': 0.98533505, 'binary_f1_score': 0.19821607}
confusion matrix:
      0    1
0  9205  137
1   672  100
early stop counter: 1
val acc:0.9051090478897095, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.9220882058143616
after epoch: 5,now: 2024-08-10 13:24:48.803419,epoch time: 0:15:09.133584,used: 1:17:11.601208,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97609365, 'precision': 0.9766524, 'recall': 0.97608495, 'specificity': 0.97608495, 'f1': 0.9760863, 'auroc': 0.998713, 'binary_precision': 0.960461, 'binary_recall': 0.9930942, 'binary_specificity': 0.9590756, 'binary_f1_score': 0.97650504}
confusion matrix:
       0      1
0  24279   1036
1    175  25166
---- Validation: 
scalar performance:
{'acc': 0.9089584, 'precision': 0.59247464, 'recall': 0.87580436, 'specificity': 0.87580436, 'f1': 0.6301276, 'auroc': 0.92535853, 'binary_precision': 0.18926248, 'binary_recall': 0.84096384, 'binary_specificity': 0.9106449, 'binary_f1_score': 0.30898628}
confusion matrix:
       0     1
0  15236  1495
1     66   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92149496, 'precision': 0.6755676, 'recall': 0.53447133, 'specificity': 0.53447133, 'f1': 0.5450905, 'auroc': 0.8999845, 'binary_precision': 0.4225352, 'binary_recall': 0.07772021, 'binary_specificity': 0.99122244, 'binary_f1_score': 0.13129103}
confusion matrix:
      0   1
0  9260  82
1   712  60
early stop counter: 2
val acc:0.908958375453949, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.9220882058143616
after epoch: 6,now: 2024-08-10 13:39:56.166449,epoch time: 0:15:07.363030,used: 1:32:18.964238,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.972027, 'precision': 0.97316486, 'recall': 0.9720125, 'specificity': 0.9720125, 'f1': 0.97200954, 'auroc': 0.9990512, 'binary_precision': 0.9501091, 'binary_recall': 0.99640924, 'binary_specificity': 0.94761586, 'binary_f1_score': 0.9727085}
confusion matrix:
       0      1
0  23987   1326
1     91  25252
---- Validation: 
scalar performance:
{'acc': 0.9265135, 'precision': 0.60648006, 'recall': 0.860126, 'specificity': 0.860126, 'f1': 0.65173113, 'auroc': 0.9189954, 'binary_precision': 0.21852098, 'binary_recall': 0.79036146, 'binary_specificity': 0.92989063, 'binary_f1_score': 0.34238}
confusion matrix:
       0     1
0  15558  1173
1     87   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92436224, 'precision': 0.7429131, 'recall': 0.5199815, 'specificity': 0.5199815, 'f1': 0.5199917, 'auroc': 0.88773745, 'binary_precision': 0.55932206, 'binary_recall': 0.042746115, 'binary_specificity': 0.9972169, 'binary_f1_score': 0.079422385}
confusion matrix:
      0   1
0  9316  26
1   739  33
new oracle model saved
early stop counter: 3
val acc:0.9265134930610657, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.9243622422218323
after epoch: 7,now: 2024-08-10 13:55:00.064932,epoch time: 0:15:03.898483,used: 1:47:22.862721,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9485352, 'precision': 0.9527204, 'recall': 0.9485087, 'specificity': 0.9485087, 'f1': 0.94841385, 'auroc': 0.99827445, 'binary_precision': 0.9093299, 'binary_recall': 0.99648803, 'binary_specificity': 0.9005293, 'binary_f1_score': 0.95091593}
confusion matrix:
       0      1
0  22796   2518
1     89  25253
---- Validation: 
scalar performance:
{'acc': 0.77242506, 'precision': 0.5395633, 'recall': 0.8093692, 'specificity': 0.8093692, 'f1': 0.5107008, 'auroc': 0.8896533, 'binary_precision': 0.0839895, 'binary_recall': 0.84819275, 'binary_specificity': 0.7705457, 'binary_f1_score': 0.15284412}
confusion matrix:
       0     1
0  12892  3839
1     63   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92376906, 'precision': 0.7165141, 'recall': 0.5279784, 'specificity': 0.5279784, 'f1': 0.53442615, 'auroc': 0.86334133, 'binary_precision': 0.50537634, 'binary_recall': 0.06088083, 'binary_specificity': 0.995076, 'binary_f1_score': 0.10867052}
confusion matrix:
      0   1
0  9296  46
1   725  47
early stop counter: 4
val acc:0.7724250555038452, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.9243622422218323
after epoch: 8,now: 2024-08-10 14:10:03.372848,epoch time: 0:15:03.307916,used: 2:02:26.170637,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97394186, 'precision': 0.97496074, 'recall': 0.9739282, 'specificity': 0.9739282, 'f1': 0.9739274, 'auroc': 0.9992111, 'binary_precision': 0.9531103, 'binary_recall': 0.9969617, 'binary_specificity': 0.9508948, 'binary_f1_score': 0.9745429}
confusion matrix:
       0      1
0  24070   1243
1     77  25266
---- Validation: 
scalar performance:
{'acc': 0.8601423, 'precision': 0.5636648, 'recall': 0.8566656, 'specificity': 0.8566656, 'f1': 0.57552624, 'auroc': 0.92126065, 'binary_precision': 0.13154961, 'binary_recall': 0.853012, 'binary_specificity': 0.8603192, 'binary_f1_score': 0.22794592}
confusion matrix:
       0     1
0  14394  2337
1     61   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92416453, 'precision': 0.73754275, 'recall': 0.51690376, 'specificity': 0.51690376, 'f1': 0.514259, 'auroc': 0.88297176, 'binary_precision': 0.54901963, 'binary_recall': 0.03626943, 'binary_specificity': 0.99753803, 'binary_f1_score': 0.06804374}
confusion matrix:
      0   1
0  9319  23
1   744  28
early stop counter: 5
val acc:0.8601422905921936, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.9243622422218323
after epoch: 9,now: 2024-08-10 14:25:11.207334,epoch time: 0:15:07.834486,used: 2:17:34.005123,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9644662, 'precision': 0.9663071, 'recall': 0.9644464, 'specificity': 0.9644464, 'f1': 0.96443, 'auroc': 0.9987034, 'binary_precision': 0.9371658, 'binary_recall': 0.9957386, 'binary_specificity': 0.9331542, 'binary_f1_score': 0.9655647}
confusion matrix:
       0      1
0  23620   1692
1    108  25236
---- Validation: 
scalar performance:
{'acc': 0.8816634, 'precision': 0.56837004, 'recall': 0.8312701, 'specificity': 0.8312701, 'f1': 0.5886605, 'auroc': 0.9021512, 'binary_precision': 0.14292036, 'binary_recall': 0.7783133, 'binary_specificity': 0.88422686, 'binary_f1_score': 0.24149533}
confusion matrix:
       0     1
0  14794  1937
1     92   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230769, 'precision': 0.69034994, 'recall': 0.51750326, 'specificity': 0.51750326, 'f1': 0.51573765, 'auroc': 0.83226025, 'binary_precision': 0.45454547, 'binary_recall': 0.038860105, 'binary_specificity': 0.99614644, 'binary_f1_score': 0.071599044}
confusion matrix:
      0   1
0  9306  36
1   742  30
early stop counter: 6
val acc:0.8816633820533752, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.9243622422218323
after epoch: 10,now: 2024-08-10 14:40:08.934871,epoch time: 0:14:57.727537,used: 2:32:31.732660,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.959373, 'precision': 0.9619967, 'recall': 0.95934486, 'specificity': 0.95934486, 'f1': 0.95931345, 'auroc': 0.9987962, 'binary_precision': 0.92736816, 'binary_recall': 0.9968833, 'binary_specificity': 0.92180645, 'binary_f1_score': 0.9608701}
confusion matrix:
       0      1
0  23330   1979
1     79  25268
---- Validation: 
scalar performance:
{'acc': 0.8717485, 'precision': 0.56589645, 'recall': 0.84263873, 'specificity': 0.84263873, 'f1': 0.58230424, 'auroc': 0.9086033, 'binary_precision': 0.13710333, 'binary_recall': 0.8120482, 'binary_specificity': 0.8732293, 'binary_f1_score': 0.23459798}
confusion matrix:
       0     1
0  14610  2121
1     78   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238679, 'precision': 0.74347025, 'recall': 0.50545436, 'specificity': 0.50545436, 'f1': 0.4916168, 'auroc': 0.8233209, 'binary_precision': 0.5625, 'binary_recall': 0.0116580315, 'binary_specificity': 0.9992507, 'binary_f1_score': 0.02284264}
confusion matrix:
      0  1
0  9335  7
1   763  9
early stop counter: 7
val acc:0.8717485070228577, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.9243622422218323
after epoch: 11,now: 2024-08-10 14:55:07.745405,epoch time: 0:14:58.810534,used: 2:47:30.543194,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9368288, 'precision': 0.9435668, 'recall': 0.93679726, 'specificity': 0.93679726, 'f1': 0.93658483, 'auroc': 0.99857616, 'binary_precision': 0.88902557, 'binary_recall': 0.99834263, 'binary_specificity': 0.8752518, 'binary_f1_score': 0.94051826}
confusion matrix:
       0      1
0  22157   3158
1     42  25299
---- Validation: 
scalar performance:
{'acc': 0.8078269, 'precision': 0.5466358, 'recall': 0.82633424, 'specificity': 0.82633424, 'f1': 0.533434, 'auroc': 0.89593136, 'binary_precision': 0.09798995, 'binary_recall': 0.8457831, 'binary_specificity': 0.8068854, 'binary_f1_score': 0.17563172}
confusion matrix:
       0     1
0  13500  3231
1     64   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9242634, 'precision': 0.7251746, 'recall': 0.5466646, 'specificity': 0.5466646, 'f1': 0.5647603, 'auroc': 0.8386178, 'binary_precision': 0.52, 'binary_recall': 0.10103627, 'binary_specificity': 0.9922929, 'binary_f1_score': 0.16919741}
confusion matrix:
      0   1
0  9270  72
1   694  78
early stop counter: 8
val acc:0.8078268766403198, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.9243622422218323
after epoch: 12,now: 2024-08-10 15:10:14.186064,epoch time: 0:15:06.440659,used: 3:02:36.983853,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95514846, 'precision': 0.9583533, 'recall': 0.955127, 'specificity': 0.955127, 'f1': 0.95506847, 'auroc': 0.99865454, 'binary_precision': 0.92015445, 'binary_recall': 0.99684304, 'binary_specificity': 0.913411, 'binary_f1_score': 0.95696485}
confusion matrix:
       0      1
0  23123   2192
1     80  25261
---- Validation: 
scalar performance:
{'acc': 0.8508107, 'precision': 0.55297124, 'recall': 0.8037118, 'specificity': 0.8037118, 'f1': 0.55718917, 'auroc': 0.876611, 'binary_precision': 0.1130372, 'binary_recall': 0.75421685, 'binary_specificity': 0.85320663, 'binary_f1_score': 0.19660804}
confusion matrix:
       0     1
0  14275  2456
1    102   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92456, 'precision': 0.9168339, 'recall': 0.5064232, 'specificity': 0.5064232, 'f1': 0.49315196, 'auroc': 0.7636181, 'binary_precision': 0.90909094, 'binary_recall': 0.012953368, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.025542786}
confusion matrix:
      0   1
0  9341   1
1   762  10
new oracle model saved
early stop counter: 9
val acc:0.850810706615448, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.924560010433197
after epoch: 13,now: 2024-08-10 15:25:23.489892,epoch time: 0:15:09.303828,used: 3:17:46.287681,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9743565, 'precision': 0.9751084, 'recall': 0.9743455, 'specificity': 0.9743455, 'f1': 0.9743458, 'auroc': 0.9988878, 'binary_precision': 0.95634514, 'binary_recall': 0.9941204, 'binary_specificity': 0.9545706, 'binary_f1_score': 0.974867}
confusion matrix:
       0      1
0  24164   1150
1    149  25193
---- Validation: 
scalar performance:
{'acc': 0.9441269, 'precision': 0.61216426, 'recall': 0.7669319, 'specificity': 0.7669319, 'f1': 0.65278053, 'auroc': 0.89712644, 'binary_precision': 0.23512195, 'binary_recall': 0.58072287, 'binary_specificity': 0.95314085, 'binary_f1_score': 0.33472222}
confusion matrix:
       0    1
0  15947  784
1    174  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238679, 'precision': 0.96192646, 'recall': 0.5012953, 'specificity': 0.5012953, 'f1': 0.4827937, 'auroc': 0.7484726, 'binary_precision': 1.0, 'binary_recall': 0.0025906735, 'binary_specificity': 1.0, 'binary_f1_score': 0.005167959}
confusion matrix:
      0  1
0  9342  0
1   770  2
early stop counter: 10
val acc:0.9441269040107727, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.924560010433197
after epoch: 14,now: 2024-08-10 15:40:27.408919,epoch time: 0:15:03.919027,used: 3:32:50.206708,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96973705, 'precision': 0.97120893, 'recall': 0.9697217, 'specificity': 0.9697217, 'f1': 0.96971273, 'auroc': 0.99924445, 'binary_precision': 0.9450114, 'binary_recall': 0.99755347, 'binary_specificity': 0.9418899, 'binary_f1_score': 0.9705718}
confusion matrix:
       0      1
0  23843   1471
1     62  25280
---- Validation: 
scalar performance:
{'acc': 0.87559783, 'precision': 0.5690795, 'recall': 0.85283566, 'specificity': 0.85283566, 'f1': 0.58805424, 'auroc': 0.9134757, 'binary_precision': 0.1429759, 'binary_recall': 0.82891566, 'binary_specificity': 0.8767557, 'binary_f1_score': 0.24388516}
confusion matrix:
       0     1
0  14669  2062
1     71   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9256476, 'precision': 0.8133843, 'recall': 0.5218656, 'specificity': 0.5218656, 'f1': 0.5232036, 'auroc': 0.78233826, 'binary_precision': 0.7, 'binary_recall': 0.045336787, 'binary_specificity': 0.99839437, 'binary_f1_score': 0.085158154}
confusion matrix:
      0   1
0  9327  15
1   737  35
new oracle model saved
early stop counter: 11
val acc:0.8755978345870972, best validation acc: 0.9731132388114929, corresponding to test acc:                         0.9220882058143616 / 0.9256476163864136
after epoch: 15,now: 2024-08-10 15:55:30.789074,epoch time: 0:15:03.380155,used: 3:47:53.586863,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_37_seed_0_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:47:53.586863 at 2024-08-10 15:55:30.789074
persisted model performance metric: 

scalar performance:
{'acc': 0.9220882, 'precision': 0.6522224, 'recall': 0.5139973, 'specificity': 0.5139973, 'f1': 0.5095132, 'auroc': 0.88100904, 'binary_precision': 0.37878788, 'binary_recall': 0.03238342, 'binary_specificity': 0.9956112, 'binary_f1_score': 0.059665874}
confusion matrix:
      0   1
0  9301  41
1   747  25
oracle model performance metric: 

scalar performance:
{'acc': 0.9256476, 'precision': 0.8133843, 'recall': 0.5218656, 'specificity': 0.5218656, 'f1': 0.5232036, 'auroc': 0.78233826, 'binary_precision': 0.7, 'binary_recall': 0.045336787, 'binary_specificity': 0.99839437, 'binary_f1_score': 0.085158154}
confusion matrix:
      0   1
0  9327  15
1   737  35
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459821 KiB |   3197 MiB | 235997 GiB | 235996 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 235333 GiB | 235332 GiB |
|       from small pool |  71981 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3464 MiB |   3464 MiB |   3464 MiB |      0 B   |
|       from large pool |   3354 MiB |   3354 MiB |   3354 MiB |      0 B   |
|       from small pool |    110 MiB |    110 MiB |    110 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    793 MiB |   1030 MiB | 173229 GiB | 173228 GiB |
|       from large pool |    782 MiB |   1027 MiB | 172554 GiB | 172553 GiB |
|       from small pool |     10 MiB |     11 MiB |    675 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4959    |    7362    |   50035 K  |   50030 K  |
|       from large pool |      87    |     529    |   17451 K  |   17450 K  |
|       from small pool |    4872    |    7273    |   32584 K  |   32579 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4959    |    7362    |   50035 K  |   50030 K  |
|       from large pool |      87    |     529    |   17451 K  |   17450 K  |
|       from small pool |    4872    |    7273    |   32584 K  |   32579 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     115    |     115    |       0    |
|       from large pool |      60    |      60    |      60    |       0    |
|       from small pool |      55    |      55    |      55    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3198    |   23898 K  |   23898 K  |
|       from large pool |      24    |      33    |    8227 K  |    8227 K  |
|       from small pool |      52    |    3175    |   15671 K  |   15671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1256 MiB |   3464 MiB |   3464 MiB |   2208 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     82 MiB |    110 MiB |    110 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173229 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     17 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50035 K  |   50035 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32584 K  |   32584 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50035 K  |   50035 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32584 K  |   32584 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     115    |     115    |      52    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      41    |      55    |      55    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23900 K  |   23900 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15673 K  |   15673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1256 MiB |   3464 MiB |   3464 MiB |   2208 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     82 MiB |    110 MiB |    110 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173229 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     17 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50035 K  |   50035 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32584 K  |   32584 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50035 K  |   50035 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32584 K  |   32584 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     115    |     115    |      52    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      41    |      55    |      55    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23900 K  |   23900 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15673 K  |   15673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960

 Experiment start at: 2024-08-10 16:04:40.094749
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96700895, 'precision': 0.96708846, 'recall': 0.9670142, 'specificity': 0.9670142, 'f1': 0.9670079, 'auroc': 0.99310875, 'binary_precision': 0.97338116, 'binary_recall': 0.9603318, 'binary_specificity': 0.97369665, 'binary_f1_score': 0.96681243}
confusion matrix:
       0      1
0  24728    668
1   1009  24427
---- Validation: 
scalar performance:
{'acc': 0.9346493, 'precision': 0.60035914, 'recall': 0.76531637, 'specificity': 0.76531637, 'f1': 0.63854074, 'auroc': 0.8369994, 'binary_precision': 0.2118928, 'binary_recall': 0.587007, 'binary_specificity': 0.9436257, 'binary_f1_score': 0.31138462}
confusion matrix:
       0    1
0  15751  941
1    178  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91883856, 'precision': 0.71647817, 'recall': 0.76555073, 'specificity': 0.76555073, 'f1': 0.73766136, 'auroc': 0.9010024, 'binary_precision': 0.46729958, 'binary_recall': 0.5852048, 'binary_specificity': 0.94589674, 'binary_f1_score': 0.51964813}
confusion matrix:
      0    1
0  8829  505
1   314  443
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 16:20:43.916444,epoch time: 0:16:03.821695,used: 0:16:03.821695,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97413045, 'precision': 0.97414035, 'recall': 0.9741326, 'specificity': 0.9741326, 'f1': 0.9741304, 'auroc': 0.9966451, 'binary_precision': 0.9765319, 'binary_recall': 0.97165656, 'binary_specificity': 0.97660863, 'binary_f1_score': 0.97408813}
confusion matrix:
       0      1
0  24800    594
1    721  24717
---- Validation: 
scalar performance:
{'acc': 0.9573089, 'precision': 0.64772564, 'recall': 0.76111674, 'specificity': 0.76111674, 'f1': 0.68662065, 'auroc': 0.87178576, 'binary_precision': 0.30719796, 'binary_recall': 0.55452436, 'binary_specificity': 0.96770906, 'binary_f1_score': 0.39536807}
confusion matrix:
       0    1
0  16153  539
1    192  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9181449, 'precision': 0.6573079, 'recall': 0.5630666, 'specificity': 0.5630666, 'f1': 0.58358014, 'auroc': 0.8840623, 'binary_precision': 0.38062283, 'binary_recall': 0.14531043, 'binary_specificity': 0.9808228, 'binary_f1_score': 0.21032505}
confusion matrix:
      0    1
0  9155  179
1   647  110
better model found
persisted
after epoch: 2,now: 2024-08-10 16:35:54.377860,epoch time: 0:15:10.461416,used: 0:31:14.283111,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9698615, 'precision': 0.9703059, 'recall': 0.9698496, 'specificity': 0.9698496, 'f1': 0.9698538, 'auroc': 0.99725115, 'binary_precision': 0.95604396, 'binary_recall': 0.9850606, 'binary_specificity': 0.95463854, 'binary_f1_score': 0.97033536}
confusion matrix:
       0      1
0  24244   1152
1    380  25056
---- Validation: 
scalar performance:
{'acc': 0.9100625, 'precision': 0.5893542, 'recall': 0.8363357, 'specificity': 0.8363357, 'f1': 0.62501943, 'auroc': 0.88922894, 'binary_precision': 0.1854793, 'binary_recall': 0.75870067, 'binary_specificity': 0.91397077, 'binary_f1_score': 0.29808572}
confusion matrix:
       0     1
0  15256  1436
1    104   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91804576, 'precision': 0.6532779, 'recall': 0.5587645, 'specificity': 0.5587645, 'f1': 0.57811576, 'auroc': 0.8892778, 'binary_precision': 0.3731884, 'binary_recall': 0.13606341, 'binary_specificity': 0.98146564, 'binary_f1_score': 0.19941916}
confusion matrix:
      0    1
0  9161  173
1   654  103
early stop counter: 1
val acc:0.9100624918937683, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9188385605812073
after epoch: 3,now: 2024-08-10 16:51:06.263961,epoch time: 0:15:11.886101,used: 0:46:26.169212,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9602612, 'precision': 0.9621508, 'recall': 0.9602362, 'specificity': 0.9602362, 'f1': 0.960219, 'auroc': 0.9976592, 'binary_precision': 0.9327961, 'binary_recall': 0.9920585, 'binary_specificity': 0.9284139, 'binary_f1_score': 0.961515}
confusion matrix:
       0      1
0  23578   1818
1    202  25234
---- Validation: 
scalar performance:
{'acc': 0.8765987, 'precision': 0.5714454, 'recall': 0.84968555, 'specificity': 0.84968555, 'f1': 0.5918677, 'auroc': 0.9007745, 'binary_precision': 0.14811715, 'binary_recall': 0.8213457, 'binary_specificity': 0.8780254, 'binary_f1_score': 0.25097483}
confusion matrix:
       0     1
0  14656  2036
1     77   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92161334, 'precision': 0.53557724, 'recall': 0.5024272, 'specificity': 0.5024272, 'f1': 0.48828486, 'auroc': 0.8689758, 'binary_precision': 0.14583333, 'binary_recall': 0.009247027, 'binary_specificity': 0.99560744, 'binary_f1_score': 0.017391305}
confusion matrix:
      0   1
0  9293  41
1   750   7
new oracle model saved
early stop counter: 2
val acc:0.8765987157821655, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.921613335609436
after epoch: 4,now: 2024-08-10 17:06:21.028624,epoch time: 0:15:14.764663,used: 1:01:40.933875,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98197985, 'precision': 0.98202455, 'recall': 0.9819757, 'specificity': 0.9819757, 'f1': 0.98197937, 'auroc': 0.99860835, 'binary_precision': 0.97760296, 'binary_recall': 0.9865954, 'binary_specificity': 0.97735596, 'binary_f1_score': 0.9820786}
confusion matrix:
       0      1
0  24818    575
1    341  25098
---- Validation: 
scalar performance:
{'acc': 0.9406062, 'precision': 0.621645, 'recall': 0.8180978, 'specificity': 0.8180978, 'f1': 0.6687761, 'auroc': 0.8960074, 'binary_precision': 0.25169492, 'binary_recall': 0.68909514, 'binary_specificity': 0.9471004, 'binary_f1_score': 0.36871508}
confusion matrix:
       0    1
0  15809  883
1    134  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92418987, 'precision': 0.54587924, 'recall': 0.50078535, 'specificity': 0.50078535, 'f1': 0.4828975, 'auroc': 0.8521509, 'binary_precision': 0.16666667, 'binary_recall': 0.002642008, 'binary_specificity': 0.99892867, 'binary_f1_score': 0.0052015604}
confusion matrix:
      0   1
0  9324  10
1   755   2
new oracle model saved
early stop counter: 3
val acc:0.9406061768531799, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9241898655891418
after epoch: 5,now: 2024-08-10 17:21:32.947851,epoch time: 0:15:11.919227,used: 1:16:52.853102,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95565784, 'precision': 0.95807827, 'recall': 0.9556279, 'specificity': 0.9556279, 'f1': 0.9555971, 'auroc': 0.9973166, 'binary_precision': 0.92498624, 'binary_recall': 0.99182296, 'binary_specificity': 0.91943294, 'binary_f1_score': 0.95723933}
confusion matrix:
       0      1
0  23349   2046
1    208  25229
---- Validation: 
scalar performance:
{'acc': 0.87350345, 'precision': 0.557874, 'recall': 0.7757691, 'specificity': 0.7757691, 'f1': 0.5712272, 'auroc': 0.86571044, 'binary_precision': 0.12526998, 'binary_recall': 0.6728538, 'binary_specificity': 0.8786844, 'binary_f1_score': 0.21121632}
confusion matrix:
       0     1
0  14667  2025
1    141   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.71265996, 'recall': 0.50242776, 'specificity': 0.50242776, 'f1': 0.48573554, 'auroc': 0.87181544, 'binary_precision': 0.5, 'binary_recall': 0.005284016, 'binary_specificity': 0.99957144, 'binary_f1_score': 0.010457517}
confusion matrix:
      0  1
0  9330  4
1   753  4
new oracle model saved
early stop counter: 4
val acc:0.8735034465789795, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9249826669692993
after epoch: 6,now: 2024-08-10 17:36:34.975006,epoch time: 0:15:02.027155,used: 1:31:54.880257,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9603203, 'precision': 0.962559, 'recall': 0.960293, 'specificity': 0.960293, 'f1': 0.96027046, 'auroc': 0.9981234, 'binary_precision': 0.9305755, 'binary_recall': 0.9949284, 'binary_specificity': 0.9256576, 'binary_f1_score': 0.96167654}
confusion matrix:
       0      1
0  23508   1888
1    129  25307
---- Validation: 
scalar performance:
{'acc': 0.86129767, 'precision': 0.56373644, 'recall': 0.8395772, 'specificity': 0.8395772, 'f1': 0.57622164, 'auroc': 0.89080006, 'binary_precision': 0.13293052, 'binary_recall': 0.81670535, 'binary_specificity': 0.86244905, 'binary_f1_score': 0.22864567}
confusion matrix:
       0     1
0  14396  2296
1     79   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9247845, 'precision': 0.7043255, 'recall': 0.51567316, 'specificity': 0.51567316, 'f1': 0.51246804, 'auroc': 0.88161945, 'binary_precision': 0.4814815, 'binary_recall': 0.034346104, 'binary_specificity': 0.9970002, 'binary_f1_score': 0.06411837}
confusion matrix:
      0   1
0  9306  28
1   731  26
early stop counter: 5
val acc:0.8612976670265198, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9249826669692993
after epoch: 7,now: 2024-08-10 17:51:43.444074,epoch time: 0:15:08.469068,used: 1:47:03.349325,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9667139, 'precision': 0.9681624, 'recall': 0.966691, 'specificity': 0.966691, 'f1': 0.9666869, 'auroc': 0.9982918, 'binary_precision': 0.942327, 'binary_recall': 0.9943389, 'binary_specificity': 0.9390431, 'binary_f1_score': 0.96763456}
confusion matrix:
       0      1
0  23847   1548
1    144  25293
---- Validation: 
scalar performance:
{'acc': 0.88273084, 'precision': 0.5716953, 'recall': 0.8336184, 'specificity': 0.8336184, 'f1': 0.59384406, 'auroc': 0.89120305, 'binary_precision': 0.14971124, 'binary_recall': 0.78190255, 'binary_specificity': 0.8853343, 'binary_f1_score': 0.25130498}
confusion matrix:
       0     1
0  14778  1914
1     94   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92468536, 'precision': 0.644467, 'recall': 0.50226706, 'specificity': 0.50226706, 'f1': 0.48563483, 'auroc': 0.86193043, 'binary_precision': 0.36363637, 'binary_recall': 0.005284016, 'binary_specificity': 0.99925005, 'binary_f1_score': 0.010416667}
confusion matrix:
      0  1
0  9327  7
1   753  4
early stop counter: 6
val acc:0.8827308416366577, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9249826669692993
after epoch: 8,now: 2024-08-10 18:06:54.684516,epoch time: 0:15:11.240442,used: 2:02:14.589767,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9700976, 'precision': 0.9712759, 'recall': 0.970079, 'specificity': 0.970079, 'f1': 0.970078, 'auroc': 0.9986577, 'binary_precision': 0.9478968, 'binary_recall': 0.99492824, 'binary_specificity': 0.94522977, 'binary_f1_score': 0.9708432}
confusion matrix:
       0      1
0  24006   1391
1    129  25306
---- Validation: 
scalar performance:
{'acc': 0.90679204, 'precision': 0.58669484, 'recall': 0.8357884, 'specificity': 0.8357884, 'f1': 0.62070614, 'auroc': 0.8909478, 'binary_precision': 0.18012081, 'binary_recall': 0.7610209, 'binary_specificity': 0.91055596, 'binary_f1_score': 0.29129663}
confusion matrix:
       0     1
0  15199  1493
1    103   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92518085, 'precision': 0.77520955, 'recall': 0.5031418, 'specificity': 0.5031418, 'f1': 0.48709422, 'auroc': 0.8635181, 'binary_precision': 0.625, 'binary_recall': 0.00660502, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.013071896}
confusion matrix:
      0  1
0  9331  3
1   752  5
new oracle model saved
early stop counter: 7
val acc:0.9067920446395874, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9251808524131775
after epoch: 9,now: 2024-08-10 18:22:05.310750,epoch time: 0:15:10.626234,used: 2:17:25.216001,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95782185, 'precision': 0.9604666, 'recall': 0.95779514, 'specificity': 0.95779514, 'f1': 0.95775944, 'auroc': 0.9973131, 'binary_precision': 0.92574584, 'binary_recall': 0.9955571, 'binary_specificity': 0.9200331, 'binary_f1_score': 0.95938313}
confusion matrix:
       0      1
0  23367   2031
1    113  25321
---- Validation: 
scalar performance:
{'acc': 0.8156865, 'precision': 0.54965425, 'recall': 0.82522386, 'specificity': 0.82522386, 'f1': 0.5409201, 'auroc': 0.8780835, 'binary_precision': 0.10449927, 'binary_recall': 0.8352668, 'binary_specificity': 0.8151809, 'binary_f1_score': 0.1857585}
confusion matrix:
       0     1
0  13607  3085
1     71   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.8264836, 'recall': 0.5051233, 'specificity': 0.5051233, 'f1': 0.4910492, 'auroc': 0.80629945, 'binary_precision': 0.72727275, 'binary_recall': 0.010568032, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.020833334}
confusion matrix:
      0  1
0  9331  3
1   749  8
new oracle model saved
early stop counter: 8
val acc:0.8156865239143372, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9254781603813171
after epoch: 10,now: 2024-08-10 18:37:05.711597,epoch time: 0:15:00.400847,used: 2:32:25.616848,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9558546, 'precision': 0.95855427, 'recall': 0.9558275, 'specificity': 0.9558275, 'f1': 0.95578766, 'auroc': 0.99757886, 'binary_precision': 0.9235462, 'binary_recall': 0.9940631, 'binary_specificity': 0.9175919, 'binary_f1_score': 0.9575081}
confusion matrix:
       0      1
0  23305   2093
1    151  25283
---- Validation: 
scalar performance:
{'acc': 0.8410909, 'precision': 0.5545175, 'recall': 0.8190417, 'specificity': 0.8190417, 'f1': 0.5565589, 'auroc': 0.8752912, 'binary_precision': 0.11525538, 'binary_recall': 0.7958237, 'binary_specificity': 0.84225976, 'binary_f1_score': 0.20135017}
confusion matrix:
       0     1
0  14059  2633
1     88   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.89133424, 'recall': 0.50390947, 'specificity': 0.50390947, 'f1': 0.48848993, 'auroc': 0.84249, 'binary_precision': 0.85714287, 'binary_recall': 0.007926024, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.015706806}
confusion matrix:
      0  1
0  9333  1
1   751  6
early stop counter: 9
val acc:0.8410909175872803, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9254781603813171
after epoch: 11,now: 2024-08-10 18:52:06.438685,epoch time: 0:15:00.727088,used: 2:47:26.343936,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9503856, 'precision': 0.9540865, 'recall': 0.95035195, 'specificity': 0.95035195, 'f1': 0.95028174, 'auroc': 0.99745625, 'binary_precision': 0.91327876, 'binary_recall': 0.99536073, 'binary_specificity': 0.9053432, 'binary_f1_score': 0.9525548}
confusion matrix:
       0      1
0  22993   2404
1    118  25317
---- Validation: 
scalar performance:
{'acc': 0.845471, 'precision': 0.54429626, 'recall': 0.7444389, 'specificity': 0.7444389, 'f1': 0.54343635, 'auroc': 0.8302183, 'binary_precision': 0.0994575, 'binary_recall': 0.63805103, 'binary_specificity': 0.85082674, 'binary_f1_score': 0.17209011}
confusion matrix:
       0     1
0  14202  2490
1    156   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.7996972, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 10
val acc:0.8454710245132446, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9254781603813171
after epoch: 12,now: 2024-08-10 19:07:11.744006,epoch time: 0:15:05.305321,used: 3:02:31.649257,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95376927, 'precision': 0.9571452, 'recall': 0.9537389, 'specificity': 0.9537389, 'f1': 0.9536816, 'auroc': 0.9981599, 'binary_precision': 0.91803694, 'binary_recall': 0.9965794, 'binary_specificity': 0.9108985, 'binary_f1_score': 0.9556972}
confusion matrix:
       0      1
0  23135   2263
1     87  25347
---- Validation: 
scalar performance:
{'acc': 0.8104304, 'precision': 0.54785913, 'recall': 0.8191376, 'specificity': 0.8191376, 'f1': 0.5365624, 'auroc': 0.8642854, 'binary_precision': 0.1011618, 'binary_recall': 0.82830626, 'binary_specificity': 0.8099688, 'binary_f1_score': 0.18030304}
confusion matrix:
       0     1
0  13520  3172
1     74   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9255772, 'precision': 0.9003087, 'recall': 0.50456995, 'specificity': 0.50456995, 'f1': 0.48981163, 'auroc': 0.8378037, 'binary_precision': 0.875, 'binary_recall': 0.009247027, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.018300653}
confusion matrix:
      0  1
0  9333  1
1   750  7
new oracle model saved
early stop counter: 11
val acc:0.8104304075241089, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9255772233009338
after epoch: 13,now: 2024-08-10 19:22:10.920005,epoch time: 0:14:59.175999,used: 3:17:30.825256,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.94220173, 'precision': 0.94777495, 'recall': 0.94216454, 'specificity': 0.94216454, 'f1': 0.9420179, 'auroc': 0.99821985, 'binary_precision': 0.89798665, 'binary_recall': 0.9978375, 'binary_specificity': 0.8864916, 'binary_f1_score': 0.9452825}
confusion matrix:
       0      1
0  22516   2883
1     55  25378
---- Validation: 
scalar performance:
{'acc': 0.7575191, 'precision': 0.5399882, 'recall': 0.81460154, 'specificity': 0.81460154, 'f1': 0.506088, 'auroc': 0.8797163, 'binary_precision': 0.08424581, 'binary_recall': 0.87470996, 'binary_specificity': 0.7544932, 'binary_f1_score': 0.15368935}
confusion matrix:
       0     1
0  12594  4098
1     54   377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92646915, 'precision': 0.8344866, 'recall': 0.514763, 'specificity': 0.514763, 'f1': 0.51005816, 'auroc': 0.8523194, 'binary_precision': 0.7419355, 'binary_recall': 0.030383091, 'binary_specificity': 0.99914294, 'binary_f1_score': 0.058375634}
confusion matrix:
      0   1
0  9326   8
1   734  23
new oracle model saved
early stop counter: 12
val acc:0.7575191259384155, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9264691472053528
after epoch: 14,now: 2024-08-10 19:37:08.842079,epoch time: 0:14:57.922074,used: 3:32:28.747330,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9356114, 'precision': 0.9426018, 'recall': 0.93555963, 'specificity': 0.93555963, 'f1': 0.9353509, 'auroc': 0.99847674, 'binary_precision': 0.8871847, 'binary_recall': 0.9982702, 'binary_specificity': 0.872849, 'binary_f1_score': 0.93945503}
confusion matrix:
       0      1
0  22166   3229
1     44  25393
---- Validation: 
scalar performance:
{'acc': 0.7191497, 'precision': 0.53422964, 'recall': 0.7926612, 'specificity': 0.7926612, 'f1': 0.48363975, 'auroc': 0.8802203, 'binary_precision': 0.073127925, 'binary_recall': 0.8700696, 'binary_specificity': 0.7152528, 'binary_f1_score': 0.13491635}
confusion matrix:
       0     1
0  11939  4753
1     56   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92676646, 'precision': 0.8209701, 'recall': 0.51917225, 'specificity': 0.51917225, 'f1': 0.5184838, 'auroc': 0.8445226, 'binary_precision': 0.71428573, 'binary_recall': 0.03963012, 'binary_specificity': 0.9987144, 'binary_f1_score': 0.07509387}
confusion matrix:
      0   1
0  9322  12
1   727  30
new oracle model saved
early stop counter: 13
val acc:0.7191497087478638, best validation acc: 0.9573088884353638, corresponding to test acc:                         0.9181448817253113 / 0.9267664551734924
after epoch: 15,now: 2024-08-10 19:52:11.347016,epoch time: 0:15:02.504937,used: 3:47:31.252267,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_04_39_seed_1_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:47:31.252267 at 2024-08-10 19:52:11.347016
persisted model performance metric: 

scalar performance:
{'acc': 0.9181449, 'precision': 0.6573079, 'recall': 0.5630666, 'specificity': 0.5630666, 'f1': 0.58358014, 'auroc': 0.8840623, 'binary_precision': 0.38062283, 'binary_recall': 0.14531043, 'binary_specificity': 0.9808228, 'binary_f1_score': 0.21032505}
confusion matrix:
      0    1
0  9155  179
1   647  110
oracle model performance metric: 

scalar performance:
{'acc': 0.92676646, 'precision': 0.8209701, 'recall': 0.51917225, 'specificity': 0.51917225, 'f1': 0.5184838, 'auroc': 0.8445226, 'binary_precision': 0.71428573, 'binary_recall': 0.03963012, 'binary_specificity': 0.9987144, 'binary_f1_score': 0.07509387}
confusion matrix:
      0   1
0  9322  12
1   727  30
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 472248 KiB |   3238 MiB | 482772 GiB | 482771 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481409 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 472248 KiB |   3238 MiB | 482772 GiB | 482771 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481409 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 473560 GiB | 473559 GiB |
|       from small pool |  71980 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3462 MiB |   3464 MiB |   5670 MiB |   2208 MiB |
|       from large pool |   3354 MiB |   3354 MiB |   5534 MiB |   2180 MiB |
|       from small pool |    108 MiB |    110 MiB |    136 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    804 MiB |   1050 MiB | 354697 GiB | 354696 GiB |
|       from large pool |    796 MiB |   1046 MiB | 353334 GiB | 353333 GiB |
|       from small pool |      8 MiB |     17 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7384    |  100576 K  |  100571 K  |
|       from large pool |      87    |     529    |   35137 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65439 K  |   65434 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7384    |  100576 K  |  100571 K  |
|       from large pool |      87    |     529    |   35137 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65439 K  |   65434 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     111    |     115    |     163    |      52    |
|       from large pool |      57    |      60    |      95    |      38    |
|       from small pool |      54    |      55    |      68    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3211    |   47829 K  |   47829 K  |
|       from large pool |      26    |      33    |   16342 K  |   16342 K  |
|       from small pool |      48    |    3186    |   31487 K  |   31487 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473560 GiB | 473560 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1266 MiB |   3464 MiB |   5670 MiB |   4404 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     80 MiB |    110 MiB |    136 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354698 GiB | 354697 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353334 GiB | 353334 GiB |
|       from small pool |      0 KiB |     17 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100576 K  |  100576 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65439 K  |   65439 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100576 K  |  100576 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65439 K  |   65439 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     115    |     163    |      99    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      40    |      55    |      68    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47832 K  |   47832 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31489 K  |   31489 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473560 GiB | 473560 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1266 MiB |   3464 MiB |   5670 MiB |   4404 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     80 MiB |    110 MiB |    136 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354698 GiB | 354697 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353334 GiB | 353334 GiB |
|       from small pool |      0 KiB |     17 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100576 K  |  100576 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65439 K  |   65439 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100576 K  |  100576 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65439 K  |   65439 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     115    |     163    |      99    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      40    |      55    |      68    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47832 K  |   47832 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31489 K  |   31489 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960

 Experiment start at: 2024-08-10 20:01:13.153494
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9540003, 'precision': 0.9557133, 'recall': 0.9539932, 'specificity': 0.9539932, 'f1': 0.95395654, 'auroc': 0.99427164, 'binary_precision': 0.92783207, 'binary_recall': 0.98460585, 'binary_specificity': 0.92338055, 'binary_f1_score': 0.95537627}
confusion matrix:
       0      1
0  23862   1980
1    398  25456
---- Validation: 
scalar performance:
{'acc': 0.9038776, 'precision': 0.5803395, 'recall': 0.824782, 'specificity': 0.824782, 'f1': 0.6110717, 'auroc': 0.8798897, 'binary_precision': 0.16774891, 'binary_recall': 0.7416268, 'binary_specificity': 0.9079373, 'binary_f1_score': 0.27360988}
confusion matrix:
       0     1
0  15168  1538
1    108   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9060642, 'precision': 0.7024255, 'recall': 0.788408, 'specificity': 0.788408, 'f1': 0.7348065, 'auroc': 0.88812184, 'binary_precision': 0.43628693, 'binary_recall': 0.64868253, 'binary_specificity': 0.9281334, 'binary_f1_score': 0.5216952}
confusion matrix:
      0    1
0  8627  668
1   280  517
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 20:17:29.853247,epoch time: 0:16:16.699753,used: 0:16:16.699753,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97630376, 'precision': 0.9763373, 'recall': 0.9763031, 'specificity': 0.9763031, 'f1': 0.97630334, 'auroc': 0.99702215, 'binary_precision': 0.97237885, 'binary_recall': 0.9804657, 'binary_specificity': 0.97214055, 'binary_f1_score': 0.9764055}
confusion matrix:
       0      1
0  25124    720
1    505  25347
---- Validation: 
scalar performance:
{'acc': 0.9550339, 'precision': 0.65391475, 'recall': 0.8393377, 'specificity': 0.8393377, 'f1': 0.7072682, 'auroc': 0.90237546, 'binary_precision': 0.31512606, 'binary_recall': 0.71770334, 'binary_specificity': 0.96097213, 'binary_f1_score': 0.4379562}
confusion matrix:
       0    1
0  16054  652
1    118  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91597307, 'precision': 0.7012856, 'recall': 0.65498567, 'specificity': 0.65498567, 'f1': 0.6741396, 'auroc': 0.8836123, 'binary_precision': 0.4575707, 'binary_recall': 0.34504393, 'binary_specificity': 0.9649274, 'binary_f1_score': 0.39341918}
confusion matrix:
      0    1
0  8969  326
1   522  275
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 20:32:57.881147,epoch time: 0:15:28.027900,used: 0:31:44.727653,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97111964, 'precision': 0.9718939, 'recall': 0.97111964, 'specificity': 0.97111964, 'f1': 0.9711078, 'auroc': 0.99810207, 'binary_precision': 0.95277935, 'binary_recall': 0.99137264, 'binary_specificity': 0.9508666, 'binary_f1_score': 0.971693}
confusion matrix:
       0      1
0  24578   1270
1    223  25625
---- Validation: 
scalar performance:
{'acc': 0.9112941, 'precision': 0.5929101, 'recall': 0.86357033, 'specificity': 0.86357033, 'f1': 0.63091767, 'auroc': 0.9210849, 'binary_precision': 0.19090399, 'binary_recall': 0.8133971, 'binary_specificity': 0.91374356, 'binary_f1_score': 0.3092315}
confusion matrix:
       0     1
0  15265  1441
1     78   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91656756, 'precision': 0.6900083, 'recall': 0.59967303, 'specificity': 0.59967303, 'f1': 0.6264067, 'auroc': 0.8735151, 'binary_precision': 0.44389027, 'binary_recall': 0.22333752, 'binary_specificity': 0.9760086, 'binary_f1_score': 0.29716194}
confusion matrix:
      0    1
0  9072  223
1   619  178
new oracle model saved
early stop counter: 1
val acc:0.9112941026687622, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9165675640106201
after epoch: 3,now: 2024-08-10 20:48:23.546247,epoch time: 0:15:25.665100,used: 0:47:10.392753,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9627631, 'precision': 0.96418947, 'recall': 0.9627588, 'specificity': 0.9627588, 'f1': 0.9627342, 'auroc': 0.9977758, 'binary_precision': 0.9384965, 'binary_recall': 0.9904456, 'binary_specificity': 0.93507195, 'binary_f1_score': 0.9637715}
confusion matrix:
       0      1
0  24166   1678
1    247  25605
---- Validation: 
scalar performance:
{'acc': 0.9220976, 'precision': 0.59259355, 'recall': 0.80962884, 'specificity': 0.80962884, 'f1': 0.63052344, 'auroc': 0.8971521, 'binary_precision': 0.19344042, 'binary_recall': 0.69138753, 'binary_specificity': 0.9278702, 'binary_f1_score': 0.30230126}
confusion matrix:
       0     1
0  15501  1205
1    129   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91527945, 'precision': 0.6415646, 'recall': 0.5381764, 'specificity': 0.5381764, 'f1': 0.5497891, 'auroc': 0.8346527, 'binary_precision': 0.35643566, 'binary_recall': 0.090338774, 'binary_specificity': 0.986014, 'binary_f1_score': 0.14414415}
confusion matrix:
      0    1
0  9165  130
1   725   72
early stop counter: 2
val acc:0.9220976233482361, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9165675640106201
after epoch: 4,now: 2024-08-10 21:03:54.057866,epoch time: 0:15:30.511619,used: 1:02:40.904372,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9735956, 'precision': 0.974218, 'recall': 0.97359353, 'specificity': 0.97359353, 'f1': 0.97358686, 'auroc': 0.99847245, 'binary_precision': 0.95706713, 'binary_recall': 0.9916831, 'binary_specificity': 0.95550394, 'binary_f1_score': 0.9740677}
confusion matrix:
       0      1
0  24695   1150
1    215  25636
---- Validation: 
scalar performance:
{'acc': 0.91970336, 'precision': 0.5965923, 'recall': 0.8422228, 'specificity': 0.8422228, 'f1': 0.63680387, 'auroc': 0.90960455, 'binary_precision': 0.19962335, 'binary_recall': 0.76076555, 'binary_specificity': 0.9236801, 'binary_f1_score': 0.31626058}
confusion matrix:
       0     1
0  15431  1275
1    100   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197384, 'precision': 0.67277765, 'recall': 0.5193753, 'specificity': 0.5193753, 'f1': 0.5187926, 'auroc': 0.8149316, 'binary_precision': 0.42168674, 'binary_recall': 0.04391468, 'binary_specificity': 0.9948359, 'binary_f1_score': 0.07954545}
confusion matrix:
      0   1
0  9247  48
1   762  35
new oracle model saved
early stop counter: 3
val acc:0.9197033643722534, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9197384119033813
after epoch: 5,now: 2024-08-10 21:19:27.441885,epoch time: 0:15:33.384019,used: 1:18:14.288391,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9677151, 'precision': 0.96903235, 'recall': 0.96770895, 'specificity': 0.96770895, 'f1': 0.96769214, 'auroc': 0.99852645, 'binary_precision': 0.94423425, 'binary_recall': 0.9941595, 'binary_specificity': 0.94125843, 'binary_f1_score': 0.9685539}
confusion matrix:
       0      1
0  24324   1518
1    151  25703
---- Validation: 
scalar performance:
{'acc': 0.86463445, 'precision': 0.561432, 'recall': 0.82799435, 'specificity': 0.82799435, 'f1': 0.57374835, 'auroc': 0.90642893, 'binary_precision': 0.12890625, 'binary_recall': 0.7894737, 'binary_specificity': 0.86651504, 'binary_f1_score': 0.22162525}
confusion matrix:
       0     1
0  14476  2230
1     88   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91785574, 'precision': 0.6674229, 'recall': 0.5390014, 'specificity': 0.5390014, 'f1': 0.5515466, 'auroc': 0.8028177, 'binary_precision': 0.40804598, 'binary_recall': 0.08908407, 'binary_specificity': 0.9889188, 'binary_f1_score': 0.146241}
confusion matrix:
      0    1
0  9192  103
1   726   71
early stop counter: 4
val acc:0.8646344542503357, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9197384119033813
after epoch: 6,now: 2024-08-10 21:35:11.369640,epoch time: 0:15:43.927755,used: 1:33:58.216146,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95784974, 'precision': 0.96038806, 'recall': 0.9578426, 'specificity': 0.9578426, 'f1': 0.9577911, 'auroc': 0.9984478, 'binary_precision': 0.92625135, 'binary_recall': 0.9949329, 'binary_specificity': 0.9207522, 'binary_f1_score': 0.9593645}
confusion matrix:
       0      1
0  23795   2048
1    131  25722
---- Validation: 
scalar performance:
{'acc': 0.8676127, 'precision': 0.56275266, 'recall': 0.82952076, 'specificity': 0.82952076, 'f1': 0.57655364, 'auroc': 0.90012896, 'binary_precision': 0.1315265, 'binary_recall': 0.7894737, 'binary_specificity': 0.8695678, 'binary_f1_score': 0.22548683}
confusion matrix:
       0     1
0  14527  2179
1     88   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92201746, 'precision': 0.7500272, 'recall': 0.5223332, 'specificity': 0.5223332, 'f1': 0.523666, 'auroc': 0.81896234, 'binary_precision': 0.57575756, 'binary_recall': 0.047678795, 'binary_specificity': 0.99698764, 'binary_f1_score': 0.08806489}
confusion matrix:
      0   1
0  9267  28
1   759  38
new oracle model saved
early stop counter: 5
val acc:0.8676127195358276, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9220174551010132
after epoch: 7,now: 2024-08-10 21:51:41.402070,epoch time: 0:16:30.032430,used: 1:50:28.248576,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9605579, 'precision': 0.9628653, 'recall': 0.9605579, 'specificity': 0.9605579, 'f1': 0.96050864, 'auroc': 0.99868786, 'binary_precision': 0.93018466, 'binary_recall': 0.9958604, 'binary_specificity': 0.92525536, 'binary_f1_score': 0.9619028}
confusion matrix:
       0      1
0  23916   1932
1    107  25741
---- Validation: 
scalar performance:
{'acc': 0.8852488, 'precision': 0.57200426, 'recall': 0.8397256, 'specificity': 0.8397256, 'f1': 0.59492815, 'auroc': 0.9088105, 'binary_precision': 0.14984156, 'binary_recall': 0.791866, 'binary_specificity': 0.8875853, 'binary_f1_score': 0.25199848}
confusion matrix:
       0     1
0  14828  1878
1     87   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239992, 'precision': 0.8995971, 'recall': 0.5216884, 'specificity': 0.5216884, 'f1': 0.5219938, 'auroc': 0.8443191, 'binary_precision': 0.875, 'binary_recall': 0.04391468, 'binary_specificity': 0.99946207, 'binary_f1_score': 0.08363202}
confusion matrix:
      0   1
0  9290   5
1   762  35
new oracle model saved
early stop counter: 6
val acc:0.8852487802505493, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9239991903305054
after epoch: 8,now: 2024-08-10 22:07:48.254529,epoch time: 0:16:06.852459,used: 2:06:35.101035,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9527816, 'precision': 0.9564189, 'recall': 0.9527799, 'specificity': 0.9527799, 'f1': 0.95268726, 'auroc': 0.9989881, 'binary_precision': 0.91568404, 'binary_recall': 0.99740803, 'binary_specificity': 0.9081518, 'binary_f1_score': 0.9548005}
confusion matrix:
       0      1
0  23473   2374
1     67  25782
---- Validation: 
scalar performance:
{'acc': 0.8060617, 'precision': 0.5475346, 'recall': 0.8329625, 'specificity': 0.8329625, 'f1': 0.53411615, 'auroc': 0.90596235, 'binary_precision': 0.09936517, 'binary_recall': 0.861244, 'binary_specificity': 0.80468094, 'binary_f1_score': 0.17817372}
confusion matrix:
       0     1
0  13443  3263
1     58   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92290926, 'precision': 0.752205, 'recall': 0.5417448, 'specificity': 0.5417448, 'f1': 0.5569807, 'auroc': 0.7552584, 'binary_precision': 0.57723576, 'binary_recall': 0.08908407, 'binary_specificity': 0.99440557, 'binary_f1_score': 0.15434782}
confusion matrix:
      0   1
0  9243  52
1   726  71
early stop counter: 7
val acc:0.8060616850852966, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9239991903305054
after epoch: 9,now: 2024-08-10 22:23:23.691217,epoch time: 0:15:35.436688,used: 2:22:10.537723,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.961467, 'precision': 0.9637065, 'recall': 0.96146035, 'specificity': 0.96146035, 'f1': 0.96142006, 'auroc': 0.998628, 'binary_precision': 0.93152964, 'binary_recall': 0.99617064, 'binary_specificity': 0.92675, 'binary_f1_score': 0.96276635}
confusion matrix:
       0      1
0  23950   1893
1     99  25754
---- Validation: 
scalar performance:
{'acc': 0.90516233, 'precision': 0.57745576, 'recall': 0.8044481, 'specificity': 0.8044481, 'f1': 0.6069031, 'auroc': 0.8879145, 'binary_precision': 0.1631285, 'binary_recall': 0.6985646, 'binary_specificity': 0.9103316, 'binary_f1_score': 0.26449275}
confusion matrix:
       0     1
0  15208  1498
1    126   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92241377, 'precision': 0.78190994, 'recall': 0.51910704, 'specificity': 0.51910704, 'f1': 0.51753426, 'auroc': 0.7816133, 'binary_precision': 0.64, 'binary_recall': 0.040150564, 'binary_specificity': 0.9980635, 'binary_f1_score': 0.0755608}
confusion matrix:
      0   1
0  9277  18
1   765  32
early stop counter: 8
val acc:0.9051623344421387, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9239991903305054
after epoch: 10,now: 2024-08-10 22:38:51.672364,epoch time: 0:15:27.981147,used: 2:37:38.518870,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94158155, 'precision': 0.94715333, 'recall': 0.94157505, 'specificity': 0.94157505, 'f1': 0.9413984, 'auroc': 0.99831176, 'binary_precision': 0.8972681, 'binary_recall': 0.9973695, 'binary_specificity': 0.88578063, 'binary_f1_score': 0.9446745}
confusion matrix:
       0      1
0  22893   2952
1     68  25783
---- Validation: 
scalar performance:
{'acc': 0.8246905, 'precision': 0.548483, 'recall': 0.8133539, 'specificity': 0.8133539, 'f1': 0.5421402, 'auroc': 0.87232256, 'binary_precision': 0.102950215, 'binary_recall': 0.8014354, 'binary_specificity': 0.8252724, 'binary_f1_score': 0.18246187}
confusion matrix:
       0     1
0  13787  2919
1     83   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9208284, 'precision': 0.71135837, 'recall': 0.5497922, 'specificity': 0.5497922, 'f1': 0.5686188, 'auroc': 0.8238503, 'binary_precision': 0.4943182, 'binary_recall': 0.10915935, 'binary_specificity': 0.99042493, 'binary_f1_score': 0.17882837}
confusion matrix:
      0   1
0  9206  89
1   710  87
early stop counter: 9
val acc:0.8246905207633972, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9239991903305054
after epoch: 11,now: 2024-08-10 22:54:19.597695,epoch time: 0:15:27.925331,used: 2:53:06.444201,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9538262, 'precision': 0.9573938, 'recall': 0.9538194, 'specificity': 0.9538194, 'f1': 0.95373553, 'auroc': 0.99885404, 'binary_precision': 0.91703695, 'binary_recall': 0.9979499, 'binary_specificity': 0.9096889, 'binary_f1_score': 0.9557841}
confusion matrix:
       0      1
0  23510   2334
1     53  25799
---- Validation: 
scalar performance:
{'acc': 0.8846064, 'precision': 0.57047856, 'recall': 0.832399, 'specificity': 0.832399, 'f1': 0.59251827, 'auroc': 0.8996339, 'binary_precision': 0.14719203, 'binary_recall': 0.77751195, 'binary_specificity': 0.887286, 'binary_f1_score': 0.24752477}
confusion matrix:
       0     1
0  14823  1883
1     93   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92201746, 'precision': 0.75992954, 'recall': 0.5183183, 'specificity': 0.5183183, 'f1': 0.51616186, 'auroc': 0.8022211, 'binary_precision': 0.59615386, 'binary_recall': 0.03889586, 'binary_specificity': 0.99774075, 'binary_f1_score': 0.07302709}
confusion matrix:
      0   1
0  9274  21
1   766  31
early stop counter: 10
val acc:0.8846064209938049, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9239991903305054
after epoch: 12,now: 2024-08-10 23:09:47.723933,epoch time: 0:15:28.126238,used: 3:08:34.570439,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9317549, 'precision': 0.9395255, 'recall': 0.9317497, 'specificity': 0.9317497, 'f1': 0.9314514, 'auroc': 0.99866796, 'binary_precision': 0.8811036, 'binary_recall': 0.9982205, 'binary_specificity': 0.86527896, 'binary_f1_score': 0.9360128}
confusion matrix:
       0      1
0  22364   3482
1     46  25804
---- Validation: 
scalar performance:
{'acc': 0.7764541, 'precision': 0.5434137, 'recall': 0.83528197, 'specificity': 0.83528197, 'f1': 0.5174039, 'auroc': 0.9045534, 'binary_precision': 0.09014423, 'binary_recall': 0.8971292, 'binary_specificity': 0.7734347, 'binary_f1_score': 0.163827}
confusion matrix:
       0     1
0  12921  3785
1     43   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234047, 'precision': 0.7661513, 'recall': 0.5408667, 'specificity': 0.5408667, 'f1': 0.555687, 'auroc': 0.77680063, 'binary_precision': 0.6052632, 'binary_recall': 0.08657465, 'binary_specificity': 0.9951587, 'binary_f1_score': 0.15148188}
confusion matrix:
      0   1
0  9250  45
1   728  69
early stop counter: 11
val acc:0.7764540910720825, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9239991903305054
after epoch: 13,now: 2024-08-10 23:25:20.766471,epoch time: 0:15:33.042538,used: 3:24:07.612977,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9283891, 'precision': 0.9370203, 'recall': 0.92837274, 'specificity': 0.92837274, 'f1': 0.92803186, 'auroc': 0.99868596, 'binary_precision': 0.8756614, 'binary_recall': 0.9986076, 'binary_specificity': 0.8581379, 'binary_f1_score': 0.933102}
confusion matrix:
       0      1
0  22176   3666
1     36  25818
---- Validation: 
scalar performance:
{'acc': 0.7886008, 'precision': 0.5452505, 'recall': 0.8368423, 'specificity': 0.8368423, 'f1': 0.5244893, 'auroc': 0.90579474, 'binary_precision': 0.09406694, 'binary_recall': 0.88755983, 'binary_specificity': 0.78612477, 'binary_f1_score': 0.17010546}
confusion matrix:
       0     1
0  13133  3573
1     47   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9205311, 'precision': 0.7111857, 'recall': 0.57314676, 'specificity': 0.57314676, 'f1': 0.6000168, 'auroc': 0.80704397, 'binary_precision': 0.49042144, 'binary_recall': 0.16060226, 'binary_specificity': 0.98569125, 'binary_f1_score': 0.24196598}
confusion matrix:
      0    1
0  9162  133
1   669  128
early stop counter: 12
val acc:0.7886008024215698, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9239991903305054
after epoch: 14,now: 2024-08-10 23:40:47.600308,epoch time: 0:15:26.833837,used: 3:39:34.446814,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94753945, 'precision': 0.9521164, 'recall': 0.94752777, 'specificity': 0.94752777, 'f1': 0.9474054, 'auroc': 0.998894, 'binary_precision': 0.90668494, 'binary_recall': 0.9977953, 'binary_specificity': 0.89726025, 'binary_f1_score': 0.9500608}
confusion matrix:
       0      1
0  23187   2655
1     57  25797
---- Validation: 
scalar performance:
{'acc': 0.85219574, 'precision': 0.5581451, 'recall': 0.8332818, 'specificity': 0.8332818, 'f1': 0.5651121, 'auroc': 0.8944637, 'binary_precision': 0.121732906, 'binary_recall': 0.8133971, 'binary_specificity': 0.8531665, 'binary_f1_score': 0.21177204}
confusion matrix:
       0     1
0  14253  2453
1     78   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92290926, 'precision': 0.7432786, 'recall': 0.5537896, 'specificity': 0.5537896, 'f1': 0.5753969, 'auroc': 0.8209508, 'binary_precision': 0.55757576, 'binary_recall': 0.11543287, 'binary_specificity': 0.9921463, 'binary_f1_score': 0.19126819}
confusion matrix:
      0   1
0  9222  73
1   705  92
early stop counter: 13
val acc:0.8521957397460938, best validation acc: 0.9550338983535767, corresponding to test acc:                         0.9159730672836304 / 0.9239991903305054
after epoch: 15,now: 2024-08-10 23:56:21.536223,epoch time: 0:15:33.935915,used: 3:55:08.382729,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_01_12_seed_2_24141960
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:55:08.382729 at 2024-08-10 23:56:21.536223
persisted model performance metric: 

scalar performance:
{'acc': 0.91597307, 'precision': 0.7012856, 'recall': 0.65498567, 'specificity': 0.65498567, 'f1': 0.6741396, 'auroc': 0.8836123, 'binary_precision': 0.4575707, 'binary_recall': 0.34504393, 'binary_specificity': 0.9649274, 'binary_f1_score': 0.39341918}
confusion matrix:
      0    1
0  8969  326
1   522  275
oracle model performance metric: 

scalar performance:
{'acc': 0.9239992, 'precision': 0.8995971, 'recall': 0.5216884, 'specificity': 0.5216884, 'f1': 0.5219938, 'auroc': 0.8443191, 'binary_precision': 0.875, 'binary_recall': 0.04391468, 'binary_specificity': 0.99946207, 'binary_f1_score': 0.08363202}
confusion matrix:
      0   1
0  9290   5
1   762  35
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 470488 KiB |   3238 MiB | 732911 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 470488 KiB |   3238 MiB | 732911 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 722604 GiB | 722603 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |  71980 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3482 MiB |   3482 MiB |   7886 MiB |   4404 MiB |
|       from large pool |   3374 MiB |   3374 MiB |   7722 MiB |   4348 MiB |
|       from small pool |    108 MiB |    110 MiB |    164 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 440871 KiB |   1050 MiB | 539869 GiB | 539868 GiB |
|       from large pool | 430496 KiB |   1046 MiB | 537780 GiB | 537779 GiB |
|       from small pool |  10375 KiB |     17 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7492    |  152705 K  |  152700 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99183 K  |   99178 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7492    |  152705 K  |  152700 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99183 K  |   99178 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     115    |     211    |      99    |
|       from large pool |      58    |      60    |     129    |      71    |
|       from small pool |      54    |      55    |      82    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3259    |   72549 K  |   72549 K  |
|       from large pool |      19    |      33    |   24786 K  |   24786 K  |
|       from small pool |      49    |    3241    |   47763 K  |   47763 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 732911 GiB | 732911 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 732911 GiB | 732911 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 722604 GiB | 722604 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |      0 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    890 MiB |   3482 MiB |   7886 MiB |   6996 MiB |
|       from large pool |    808 MiB |   3374 MiB |   7722 MiB |   6914 MiB |
|       from small pool |     82 MiB |    110 MiB |    164 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 539869 GiB | 539869 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 537780 GiB | 537780 GiB |
|       from small pool |      0 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7492    |  152705 K  |  152705 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99183 K  |   99183 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7492    |  152705 K  |  152705 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99183 K  |   99183 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     115    |     211    |     150    |
|       from large pool |      20    |      60    |     129    |     109    |
|       from small pool |      41    |      55    |      82    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3259    |   72551 K  |   72551 K  |
|       from large pool |       4    |      33    |   24786 K  |   24786 K  |
|       from small pool |       0    |    3241    |   47765 K  |   47765 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug 10 23:58:13 2024]
Finished job 0.
1 of 1 steps (100%) done
