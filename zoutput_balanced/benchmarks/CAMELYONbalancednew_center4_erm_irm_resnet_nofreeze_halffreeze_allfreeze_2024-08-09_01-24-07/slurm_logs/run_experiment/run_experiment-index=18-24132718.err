Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 19:54:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/18.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=18
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718

 Experiment start at: 2024-08-09 20:00:20.739880
before training, model accuracy: 0.6349614262580872
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7700371, 'precision': 0.78365016, 'recall': 0.7699765, 'specificity': 0.7699765, 'f1': 0.7672176, 'auroc': 0.8604369, 'binary_precision': 0.72164845, 'binary_recall': 0.87960696, 'binary_specificity': 0.66034603, 'binary_f1_score': 0.79283667}
confusion matrix:
       0      1
0  16716   8598
1   3051  22291
---- Validation: 
scalar performance:
{'acc': 0.5705704, 'precision': 0.5089505, 'recall': 0.5931448, 'specificity': 0.5931448, 'f1': 0.39314687, 'auroc': 0.6333846, 'binary_precision': 0.034316353, 'binary_recall': 0.6168675, 'binary_specificity': 0.569422, 'binary_f1_score': 0.06501587}
confusion matrix:
      0     1
0  9527  7204
1   159   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34654933, 'precision': 0.4875687, 'recall': 0.46090114, 'specificity': 0.46090114, 'f1': 0.30087978, 'auroc': 0.41974333, 'binary_precision': 0.06807755, 'binary_recall': 0.59585494, 'binary_specificity': 0.32594734, 'binary_f1_score': 0.12219418}
confusion matrix:
      0     1
0  3045  6297
1   312   460
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 20:14:08.806369,epoch time: 0:13:48.066489,used: 0:13:48.066489,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8230022, 'precision': 0.84292495, 'recall': 0.8229165, 'specificity': 0.8229165, 'f1': 0.8203665, 'auroc': 0.9242522, 'binary_precision': 0.7604465, 'binary_recall': 0.9434625, 'binary_specificity': 0.7023706, 'binary_f1_score': 0.8421257}
confusion matrix:
       0      1
0  17777   7533
1   1433  23913
---- Validation: 
scalar performance:
{'acc': 0.648956, 'precision': 0.513126, 'recall': 0.6274351, 'specificity': 0.6274351, 'f1': 0.4301226, 'auroc': 0.6798173, 'binary_precision': 0.041107107, 'binary_recall': 0.6048193, 'binary_specificity': 0.6500508, 'binary_f1_score': 0.07698205}
confusion matrix:
       0     1
0  10876  5855
1    164   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.40913585, 'precision': 0.52199733, 'recall': 0.5726136, 'specificity': 0.5726136, 'f1': 0.3539498, 'auroc': 0.5837074, 'binary_precision': 0.092546195, 'binary_recall': 0.76554406, 'binary_specificity': 0.37968314, 'binary_f1_score': 0.16512991}
confusion matrix:
      0     1
0  3547  5795
1   181   591
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 20:27:08.801114,epoch time: 0:12:59.994745,used: 0:26:48.061234,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84436196, 'precision': 0.8522021, 'recall': 0.8443119, 'specificity': 0.8443119, 'f1': 0.8434775, 'auroc': 0.9292952, 'binary_precision': 0.79982144, 'binary_recall': 0.9189189, 'binary_specificity': 0.7697049, 'binary_f1_score': 0.85524386}
confusion matrix:
       0      1
0  19482   5829
1   2055  23290
---- Validation: 
scalar performance:
{'acc': 0.6847078, 'precision': 0.51079667, 'recall': 0.59875697, 'specificity': 0.59875697, 'f1': 0.44124246, 'auroc': 0.6511229, 'binary_precision': 0.038980234, 'binary_recall': 0.50843376, 'binary_specificity': 0.6890802, 'binary_f1_score': 0.072409056}
confusion matrix:
       0     1
0  11529  5202
1    204   211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45056358, 'precision': 0.5373647, 'recall': 0.6271231, 'specificity': 0.6271231, 'f1': 0.38655666, 'auroc': 0.6696341, 'binary_precision': 0.10617284, 'binary_recall': 0.83549225, 'binary_specificity': 0.418754, 'binary_f1_score': 0.18840367}
confusion matrix:
      0     1
0  3912  5430
1   127   645
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 20:40:09.817949,epoch time: 0:13:01.016835,used: 0:39:49.078069,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.84844834, 'precision': 0.86589503, 'recall': 0.8483708, 'specificity': 0.8483708, 'f1': 0.84659964, 'auroc': 0.94891095, 'binary_precision': 0.7861747, 'binary_recall': 0.95754755, 'binary_specificity': 0.739194, 'binary_f1_score': 0.8634399}
confusion matrix:
       0      1
0  18709   6601
1   1076  24270
---- Validation: 
scalar performance:
{'acc': 0.67613435, 'precision': 0.5116647, 'recall': 0.6084631, 'specificity': 0.6084631, 'f1': 0.43903905, 'auroc': 0.6577773, 'binary_precision': 0.03993553, 'binary_recall': 0.5373494, 'binary_specificity': 0.6795768, 'binary_f1_score': 0.07434572}
confusion matrix:
       0     1
0  11370  5361
1    192   223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4956496, 'precision': 0.5344732, 'recall': 0.62122756, 'specificity': 0.62122756, 'f1': 0.4114748, 'auroc': 0.6509341, 'binary_precision': 0.10766721, 'binary_recall': 0.76943004, 'binary_specificity': 0.47302505, 'binary_f1_score': 0.18890126}
confusion matrix:
      0     1
0  4419  4923
1   178   594
new oracle model saved
early stop counter: 1
val acc:0.6761343479156494, best validation acc: 0.6847078204154968, corresponding to test acc:                         0.45056357979774475 / 0.4956496059894562
after epoch: 4,now: 2024-08-09 20:53:11.208173,epoch time: 0:13:01.390224,used: 0:52:50.468293,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8696502, 'precision': 0.87464434, 'recall': 0.86961377, 'specificity': 0.86961377, 'f1': 0.86920637, 'auroc': 0.94983697, 'binary_precision': 0.83154655, 'binary_recall': 0.92732006, 'binary_specificity': 0.8119074, 'binary_f1_score': 0.87682587}
confusion matrix:
       0      1
0  20551   4761
1   1842  23502
---- Validation: 
scalar performance:
{'acc': 0.7235507, 'precision': 0.5077157, 'recall': 0.5646131, 'specificity': 0.5646131, 'f1': 0.45144108, 'auroc': 0.6192045, 'binary_precision': 0.035445757, 'binary_recall': 0.39759037, 'binary_specificity': 0.73163587, 'binary_f1_score': 0.06508876}
confusion matrix:
       0     1
0  12241  4490
1    250   165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.573858, 'precision': 0.5453304, 'recall': 0.65999836, 'specificity': 0.65999836, 'f1': 0.46100098, 'auroc': 0.7076409, 'binary_precision': 0.124734834, 'binary_recall': 0.761658, 'binary_specificity': 0.5583387, 'binary_f1_score': 0.21436384}
confusion matrix:
      0     1
0  5216  4126
1   184   588
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 21:06:05.867578,epoch time: 0:12:54.659405,used: 1:05:45.127698,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8623658, 'precision': 0.8735116, 'recall': 0.86231124, 'specificity': 0.86231124, 'f1': 0.86131847, 'auroc': 0.95391047, 'binary_precision': 0.8091472, 'binary_recall': 0.94866633, 'binary_specificity': 0.7759561, 'binary_f1_score': 0.8733699}
confusion matrix:
       0      1
0  19641   5671
1   1301  24043
---- Validation: 
scalar performance:
{'acc': 0.7404059, 'precision': 0.5098313, 'recall': 0.57912445, 'specificity': 0.57912445, 'f1': 0.4600451, 'auroc': 0.62138313, 'binary_precision': 0.038848262, 'binary_recall': 0.40963855, 'binary_specificity': 0.7486104, 'binary_f1_score': 0.07096639}
confusion matrix:
       0     1
0  12525  4206
1    245   170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.695966, 'precision': 0.5553747, 'recall': 0.67262447, 'specificity': 0.67262447, 'f1': 0.5271687, 'auroc': 0.69771856, 'binary_precision': 0.15095483, 'binary_recall': 0.6450777, 'binary_specificity': 0.7001713, 'binary_f1_score': 0.24465731}
confusion matrix:
      0     1
0  6541  2801
1   274   498
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 21:19:08.167919,epoch time: 0:13:02.300341,used: 1:18:47.428039,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8705188, 'precision': 0.8815334, 'recall': 0.8704752, 'specificity': 0.8704752, 'f1': 0.869568, 'auroc': 0.9625567, 'binary_precision': 0.81683534, 'binary_recall': 0.9554082, 'binary_specificity': 0.7855422, 'binary_f1_score': 0.8807042}
confusion matrix:
       0      1
0  19886   5429
1   1130  24211
---- Validation: 
scalar performance:
{'acc': 0.7222093, 'precision': 0.51508445, 'recall': 0.6285472, 'specificity': 0.6285472, 'f1': 0.46041387, 'auroc': 0.68495345, 'binary_precision': 0.045948204, 'binary_recall': 0.5301205, 'binary_specificity': 0.7269739, 'binary_f1_score': 0.08456659}
confusion matrix:
       0     1
0  12163  4568
1    195   220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62181133, 'precision': 0.55685294, 'recall': 0.69665104, 'specificity': 0.69665104, 'f1': 0.4944128, 'auroc': 0.7424809, 'binary_precision': 0.14208676, 'binary_recall': 0.7849741, 'binary_specificity': 0.608328, 'binary_f1_score': 0.24061942}
confusion matrix:
      0     1
0  5683  3659
1   166   606
early stop counter: 1
val acc:0.7222092747688293, best validation acc: 0.7404059171676636, corresponding to test acc:                         0.6959660053253174 / 0.6959660053253174
after epoch: 7,now: 2024-08-09 21:32:39.262695,epoch time: 0:13:31.094776,used: 1:32:18.522815,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8906546, 'precision': 0.89095974, 'recall': 0.8906474, 'specificity': 0.8906474, 'f1': 0.8906319, 'auroc': 0.96129984, 'binary_precision': 0.8801643, 'binary_recall': 0.9045815, 'binary_specificity': 0.8767134, 'binary_f1_score': 0.8922059}
confusion matrix:
       0      1
0  22194   3121
1   2418  22923
---- Validation: 
scalar performance:
{'acc': 0.8312726, 'precision': 0.50983036, 'recall': 0.55518866, 'specificity': 0.55518866, 'f1': 0.4889423, 'auroc': 0.6124188, 'binary_precision': 0.04077094, 'binary_recall': 0.26506025, 'binary_specificity': 0.84531707, 'binary_f1_score': 0.07067137}
confusion matrix:
       0     1
0  14143  2588
1    305   110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77684397, 'precision': 0.5772688, 'recall': 0.69976914, 'specificity': 0.69976914, 'f1': 0.5807513, 'auroc': 0.7434017, 'binary_precision': 0.19381443, 'binary_recall': 0.6088083, 'binary_specificity': 0.79073006, 'binary_f1_score': 0.29402566}
confusion matrix:
      0     1
0  7387  1955
1   302   470
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-09 21:46:07.589197,epoch time: 0:13:28.326502,used: 1:45:46.849317,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8803301, 'precision': 0.8871117, 'recall': 0.88028306, 'specificity': 0.88028306, 'f1': 0.87979424, 'auroc': 0.9632151, 'binary_precision': 0.8360519, 'binary_recall': 0.9464215, 'binary_specificity': 0.8141446, 'binary_f1_score': 0.88781977}
confusion matrix:
       0      1
0  20606   4704
1   1358  23988
---- Validation: 
scalar performance:
{'acc': 0.74892104, 'precision': 0.51351106, 'recall': 0.6069863, 'specificity': 0.6069863, 'f1': 0.46785256, 'auroc': 0.66228104, 'binary_precision': 0.044496488, 'binary_recall': 0.45783132, 'binary_specificity': 0.7561413, 'binary_f1_score': 0.081109926}
confusion matrix:
       0     1
0  12651  4080
1    225   190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72157407, 'precision': 0.567422, 'recall': 0.70312274, 'specificity': 0.70312274, 'f1': 0.5499241, 'auroc': 0.7424272, 'binary_precision': 0.16989665, 'binary_recall': 0.68134713, 'binary_specificity': 0.72489834, 'binary_f1_score': 0.2719752}
confusion matrix:
      0     1
0  6772  2570
1   246   526
early stop counter: 1
val acc:0.7489210367202759, best validation acc: 0.8312726020812988, corresponding to test acc:                         0.7768439650535583 / 0.7768439650535583
after epoch: 9,now: 2024-08-09 21:59:19.988627,epoch time: 0:13:12.399430,used: 1:58:59.248747,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8921944, 'precision': 0.8966169, 'recall': 0.89216316, 'specificity': 0.89216316, 'f1': 0.8918875, 'auroc': 0.9688663, 'binary_precision': 0.8548836, 'binary_recall': 0.9449158, 'binary_specificity': 0.8394106, 'binary_f1_score': 0.8976478}
confusion matrix:
       0      1
0  21248   4065
1   1396  23947
---- Validation: 
scalar performance:
{'acc': 0.7779657, 'precision': 0.51301205, 'recall': 0.5936704, 'specificity': 0.5936704, 'f1': 0.47697824, 'auroc': 0.63030005, 'binary_precision': 0.044575725, 'binary_recall': 0.4, 'binary_specificity': 0.7873409, 'binary_f1_score': 0.08021261}
confusion matrix:
       0     1
0  13173  3558
1    249   166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7567728, 'precision': 0.5770099, 'recall': 0.7144525, 'specificity': 0.7144525, 'f1': 0.5736922, 'auroc': 0.74070424, 'binary_precision': 0.1890199, 'binary_recall': 0.66450775, 'binary_specificity': 0.7643973, 'binary_f1_score': 0.29432017}
confusion matrix:
      0     1
0  7141  2201
1   259   513
early stop counter: 2
val acc:0.7779657244682312, best validation acc: 0.8312726020812988, corresponding to test acc:                         0.7768439650535583 / 0.7768439650535583
after epoch: 10,now: 2024-08-09 22:12:25.268590,epoch time: 0:13:05.279963,used: 2:12:04.528710,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8984721, 'precision': 0.89871067, 'recall': 0.89846337, 'specificity': 0.89846337, 'f1': 0.8984553, 'auroc': 0.9661732, 'binary_precision': 0.88913286, 'binary_recall': 0.9106368, 'binary_specificity': 0.88629, 'binary_f1_score': 0.8997563}
confusion matrix:
       0      1
0  22432   2878
1   2265  23081
---- Validation: 
scalar performance:
{'acc': 0.8253237, 'precision': 0.5117616, 'recall': 0.5685895, 'specificity': 0.5685895, 'f1': 0.490006, 'auroc': 0.6281922, 'binary_precision': 0.04384724, 'binary_recall': 0.2987952, 'binary_specificity': 0.83838385, 'binary_f1_score': 0.0764724}
confusion matrix:
       0     1
0  14027  2704
1    291   124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81006527, 'precision': 0.5894586, 'recall': 0.7046813, 'specificity': 0.7046813, 'f1': 0.6038681, 'auroc': 0.750775, 'binary_precision': 0.21907091, 'binary_recall': 0.5803109, 'binary_specificity': 0.8290516, 'binary_f1_score': 0.31806886}
confusion matrix:
      0     1
0  7745  1597
1   324   448
new oracle model saved
early stop counter: 3
val acc:0.8253237009048462, best validation acc: 0.8312726020812988, corresponding to test acc:                         0.7768439650535583 / 0.8100652694702148
after epoch: 11,now: 2024-08-09 22:25:25.481053,epoch time: 0:13:00.212463,used: 2:25:04.741173,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.89649796, 'precision': 0.9005948, 'recall': 0.89646405, 'specificity': 0.89646405, 'f1': 0.8962269, 'auroc': 0.972949, 'binary_precision': 0.8602509, 'binary_recall': 0.9469718, 'binary_specificity': 0.8459563, 'binary_f1_score': 0.9015307}
confusion matrix:
       0      1
0  21412   3899
1   1344  24001
---- Validation: 
scalar performance:
{'acc': 0.79050505, 'precision': 0.5138655, 'recall': 0.5953959, 'specificity': 0.5953959, 'f1': 0.48224315, 'auroc': 0.67086995, 'binary_precision': 0.046272494, 'binary_recall': 0.39036146, 'binary_specificity': 0.80043036, 'binary_f1_score': 0.08273748}
confusion matrix:
       0     1
0  13392  3339
1    253   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7884121, 'precision': 0.59144384, 'recall': 0.7351444, 'specificity': 0.7351444, 'f1': 0.6005537, 'auroc': 0.77954066, 'binary_precision': 0.21571073, 'binary_recall': 0.6722798, 'binary_specificity': 0.798009, 'binary_f1_score': 0.32662055}
confusion matrix:
      0     1
0  7455  1887
1   253   519
early stop counter: 4
val acc:0.790505051612854, best validation acc: 0.8312726020812988, corresponding to test acc:                         0.7768439650535583 / 0.8100652694702148
after epoch: 12,now: 2024-08-09 22:38:34.314452,epoch time: 0:13:08.833399,used: 2:38:13.574572,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9024202, 'precision': 0.9046744, 'recall': 0.90239966, 'specificity': 0.90239966, 'f1': 0.9022809, 'auroc': 0.97260046, 'binary_precision': 0.87460977, 'binary_recall': 0.9396654, 'binary_specificity': 0.86513394, 'binary_f1_score': 0.9059712}
confusion matrix:
       0      1
0  21900   3414
1   1529  23813
---- Validation: 
scalar performance:
{'acc': 0.82812315, 'precision': 0.5164587, 'recall': 0.5958725, 'specificity': 0.5958725, 'f1': 0.49762452, 'auroc': 0.68614364, 'binary_precision': 0.051699717, 'binary_recall': 0.35180724, 'binary_specificity': 0.83993787, 'binary_f1_score': 0.09015128}
confusion matrix:
       0     1
0  14053  2678
1    269   146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82489616, 'precision': 0.60609746, 'recall': 0.73647535, 'specificity': 0.73647535, 'f1': 0.62699336, 'auroc': 0.7874463, 'binary_precision': 0.24708861, 'binary_recall': 0.63212436, 'binary_specificity': 0.8408264, 'binary_f1_score': 0.3552967}
confusion matrix:
      0     1
0  7855  1487
1   284   488
new oracle model saved
early stop counter: 5
val acc:0.828123152256012, best validation acc: 0.8312726020812988, corresponding to test acc:                         0.7768439650535583 / 0.8248961567878723
after epoch: 13,now: 2024-08-09 22:51:46.372157,epoch time: 0:13:12.057705,used: 2:51:25.632277,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.890319, 'precision': 0.9004805, 'recall': 0.8902813, 'specificity': 0.8902813, 'f1': 0.889612, 'auroc': 0.9782078, 'binary_precision': 0.83680624, 'binary_recall': 0.9698895, 'binary_specificity': 0.8106731, 'binary_f1_score': 0.8984464}
confusion matrix:
       0      1
0  20523   4793
1    763  24577
---- Validation: 
scalar performance:
{'acc': 0.7674093, 'precision': 0.5185031, 'recall': 0.63995844, 'specificity': 0.63995844, 'f1': 0.480916, 'auroc': 0.70244014, 'binary_precision': 0.052592035, 'binary_recall': 0.5060241, 'binary_specificity': 0.77389276, 'binary_f1_score': 0.0952813}
confusion matrix:
       0     1
0  12948  3783
1    205   210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8150089, 'precision': 0.5995552, 'recall': 0.72993493, 'specificity': 0.72993493, 'f1': 0.6171354, 'auroc': 0.7723186, 'binary_precision': 0.23466924, 'binary_recall': 0.6295337, 'binary_specificity': 0.8303361, 'binary_f1_score': 0.34189236}
confusion matrix:
      0     1
0  7757  1585
1   286   486
early stop counter: 6
val acc:0.7674093246459961, best validation acc: 0.8312726020812988, corresponding to test acc:                         0.7768439650535583 / 0.8248961567878723
after epoch: 14,now: 2024-08-09 23:05:04.455227,epoch time: 0:13:18.083070,used: 3:04:43.715347,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.90836227, 'precision': 0.909015, 'recall': 0.90835047, 'specificity': 0.90835047, 'f1': 0.90832394, 'auroc': 0.97323585, 'binary_precision': 0.8928233, 'binary_recall': 0.9282642, 'binary_specificity': 0.8884368, 'binary_f1_score': 0.91019887}
confusion matrix:
       0      1
0  22489   2824
1   1818  23525
---- Validation: 
scalar performance:
{'acc': 0.8330223, 'precision': 0.51572704, 'recall': 0.58898336, 'specificity': 0.58898336, 'f1': 0.49801245, 'auroc': 0.66905886, 'binary_precision': 0.050660793, 'binary_recall': 0.3325301, 'binary_specificity': 0.84543663, 'binary_f1_score': 0.0879261}
confusion matrix:
       0     1
0  14145  2586
1    277   138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85811746, 'precision': 0.6321161, 'recall': 0.75445867, 'specificity': 0.75445867, 'f1': 0.66213506, 'auroc': 0.78721523, 'binary_precision': 0.29774252, 'binary_recall': 0.63212436, 'binary_specificity': 0.87679297, 'binary_f1_score': 0.40481126}
confusion matrix:
      0     1
0  8191  1151
1   284   488
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-09 23:18:15.981825,epoch time: 0:13:11.526598,used: 3:17:55.241945,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_20_00_20_seed_0_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:17:55.241945 at 2024-08-09 23:18:15.981825
persisted model performance metric: 

scalar performance:
{'acc': 0.85811746, 'precision': 0.6321161, 'recall': 0.75445867, 'specificity': 0.75445867, 'f1': 0.66213506, 'auroc': 0.78721523, 'binary_precision': 0.29774252, 'binary_recall': 0.63212436, 'binary_specificity': 0.87679297, 'binary_f1_score': 0.40481126}
confusion matrix:
      0     1
0  8191  1151
1   284   488
oracle model performance metric: 

scalar performance:
{'acc': 0.85811746, 'precision': 0.6321161, 'recall': 0.75445867, 'specificity': 0.75445867, 'f1': 0.66213506, 'auroc': 0.78721523, 'binary_precision': 0.29774252, 'binary_recall': 0.63212436, 'binary_specificity': 0.87679297, 'binary_f1_score': 0.40481126}
confusion matrix:
      0     1
0  8191  1151
1   284   488
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/18.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205702 KiB | 644140 KiB | 475797 GiB | 475796 GiB |
|       from large pool | 167936 KiB | 570688 KiB | 475648 GiB | 475648 GiB |
|       from small pool |  37766 KiB |  75805 KiB |    148 GiB |    148 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205702 KiB | 644140 KiB | 475797 GiB | 475796 GiB |
|       from large pool | 167936 KiB | 570688 KiB | 475648 GiB | 475648 GiB |
|       from small pool |  37766 KiB |  75805 KiB |    148 GiB |    148 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201269 KiB | 632477 KiB | 474378 GiB | 474378 GiB |
|       from large pool | 165120 KiB | 560704 KiB | 474239 GiB | 474239 GiB |
|       from small pool |  36149 KiB |  74125 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 688128 KiB | 688128 KiB | 688128 KiB |      0 B   |
|       from large pool | 610304 KiB | 610304 KiB | 610304 KiB |      0 B   |
|       from small pool |  77824 KiB |  77824 KiB |  77824 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44153 KiB | 192527 KiB | 219543 GiB | 219543 GiB |
|       from large pool |  36864 KiB | 187968 KiB | 219389 GiB | 219389 GiB |
|       from small pool |   7289 KiB |   9156 KiB |    153 GiB |    153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4698    |    7101    |   43398 K  |   43393 K  |
|       from large pool |      36    |      76    |   16660 K  |   16660 K  |
|       from small pool |    4662    |    7063    |   26738 K  |   26733 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4698    |    7101    |   43398 K  |   43393 K  |
|       from large pool |      36    |      76    |   16660 K  |   16660 K  |
|       from small pool |    4662    |    7063    |   26738 K  |   26733 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      54    |       0    |
|       from large pool |      16    |      16    |      16    |       0    |
|       from small pool |      38    |      38    |      38    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    3182    |   23209 K  |   23209 K  |
|       from large pool |       7    |      11    |    9654 K  |    9654 K  |
|       from small pool |      44    |    3176    |   13554 K  |   13554 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 644140 KiB | 475797 GiB | 475797 GiB |
|       from large pool |  16640 KiB | 570688 KiB | 475648 GiB | 475648 GiB |
|       from small pool |      0 KiB |  75805 KiB |    148 GiB |    148 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 644140 KiB | 475797 GiB | 475797 GiB |
|       from large pool |  16640 KiB | 570688 KiB | 475648 GiB | 475648 GiB |
|       from small pool |      0 KiB |  75805 KiB |    148 GiB |    148 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632477 KiB | 474378 GiB | 474378 GiB |
|       from large pool |  16640 KiB | 560704 KiB | 474239 GiB | 474239 GiB |
|       from small pool |      0 KiB |  74125 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 688128 KiB | 688128 KiB | 438272 KiB |
|       from large pool | 204800 KiB | 610304 KiB | 610304 KiB | 405504 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 192527 KiB | 219543 GiB | 219543 GiB |
|       from large pool |  24320 KiB | 187968 KiB | 219390 GiB | 219390 GiB |
|       from small pool |      0 KiB |  14884 KiB |    153 GiB |    153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43398 K  |   43398 K  |
|       from large pool |       2    |      76    |   16660 K  |   16660 K  |
|       from small pool |       0    |    7063    |   26738 K  |   26738 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43398 K  |   43398 K  |
|       from large pool |       2    |      76    |   16660 K  |   16660 K  |
|       from small pool |       0    |    7063    |   26738 K  |   26738 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      54    |      54    |      22    |
|       from large pool |      10    |      16    |      16    |       6    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   23211 K  |   23211 K  |
|       from large pool |       3    |      13    |    9654 K  |    9654 K  |
|       from small pool |       0    |    3176    |   13556 K  |   13556 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 644140 KiB | 475797 GiB | 475797 GiB |
|       from large pool |  16640 KiB | 570688 KiB | 475648 GiB | 475648 GiB |
|       from small pool |      0 KiB |  75805 KiB |    148 GiB |    148 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 644140 KiB | 475797 GiB | 475797 GiB |
|       from large pool |  16640 KiB | 570688 KiB | 475648 GiB | 475648 GiB |
|       from small pool |      0 KiB |  75805 KiB |    148 GiB |    148 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632477 KiB | 474378 GiB | 474378 GiB |
|       from large pool |  16640 KiB | 560704 KiB | 474239 GiB | 474239 GiB |
|       from small pool |      0 KiB |  74125 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 688128 KiB | 688128 KiB | 438272 KiB |
|       from large pool | 204800 KiB | 610304 KiB | 610304 KiB | 405504 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 192527 KiB | 219543 GiB | 219543 GiB |
|       from large pool |  24320 KiB | 187968 KiB | 219390 GiB | 219390 GiB |
|       from small pool |      0 KiB |  14884 KiB |    153 GiB |    153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43398 K  |   43398 K  |
|       from large pool |       2    |      76    |   16660 K  |   16660 K  |
|       from small pool |       0    |    7063    |   26738 K  |   26738 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43398 K  |   43398 K  |
|       from large pool |       2    |      76    |   16660 K  |   16660 K  |
|       from small pool |       0    |    7063    |   26738 K  |   26738 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      54    |      54    |      22    |
|       from large pool |      10    |      16    |      16    |       6    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   23211 K  |   23211 K  |
|       from large pool |       3    |      13    |    9654 K  |    9654 K  |
|       from small pool |       0    |    3176    |   13556 K  |   13556 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718

 Experiment start at: 2024-08-09 23:36:48.329350
before training, model accuracy: 0.20513328909873962
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6687126, 'precision': 0.7329187, 'recall': 0.6684644, 'specificity': 0.6684644, 'f1': 0.6439953, 'auroc': 0.8237785, 'binary_precision': 0.61086476, 'binary_recall': 0.9313286, 'binary_specificity': 0.4056002, 'binary_f1_score': 0.7378009}
confusion matrix:
       0      1
0  10299  15093
1   1747  23693
---- Validation: 
scalar performance:
{'acc': 0.28756642, 'precision': 0.4911456, 'recall': 0.42663997, 'specificity': 0.42663997, 'f1': 0.23645951, 'auroc': 0.41397935, 'binary_precision': 0.020143533, 'binary_recall': 0.57308584, 'binary_specificity': 0.2801941, 'binary_f1_score': 0.03891909}
confusion matrix:
      0      1
0  4677  12015
1   184    247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.1601427, 'precision': 0.50466734, 'recall': 0.5059569, 'specificity': 0.5059569, 'f1': 0.15969084, 'auroc': 0.47716707, 'binary_precision': 0.07593407, 'binary_recall': 0.9128137, 'binary_specificity': 0.09910006, 'binary_f1_score': 0.14020494}
confusion matrix:
     0     1
0  925  8409
1   66   691
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 23:52:01.018620,epoch time: 0:15:12.689270,used: 0:15:12.689270,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7805516, 'precision': 0.8048271, 'recall': 0.78044605, 'specificity': 0.78044605, 'f1': 0.7760498, 'auroc': 0.9014548, 'binary_precision': 0.7189915, 'binary_recall': 0.9216434, 'binary_specificity': 0.6392487, 'binary_f1_score': 0.8078016}
confusion matrix:
       0      1
0  16235   9162
1   1993  23442
---- Validation: 
scalar performance:
{'acc': 0.53109854, 'precision': 0.49783906, 'recall': 0.47809112, 'specificity': 0.47809112, 'f1': 0.36640295, 'auroc': 0.4552985, 'binary_precision': 0.022858579, 'binary_recall': 0.42227378, 'binary_specificity': 0.5339085, 'binary_f1_score': 0.043369472}
confusion matrix:
      0     1
0  8912  7780
1   249   182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.24705184, 'precision': 0.53013146, 'recall': 0.56446743, 'specificity': 0.56446743, 'f1': 0.23844121, 'auroc': 0.60217613, 'binary_precision': 0.08594601, 'binary_recall': 0.9379128, 'binary_specificity': 0.19102207, 'binary_f1_score': 0.15746287}
confusion matrix:
      0     1
0  1783  7551
1    47   710
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 00:05:18.667257,epoch time: 0:13:17.648637,used: 0:28:30.337907,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.81204754, 'precision': 0.8284699, 'recall': 0.8119551, 'specificity': 0.8119551, 'f1': 0.80963707, 'auroc': 0.9205514, 'binary_precision': 0.7552306, 'binary_recall': 0.9238118, 'binary_specificity': 0.70009845, 'binary_f1_score': 0.8310582}
confusion matrix:
       0      1
0  17779   7616
1   1938  23499
---- Validation: 
scalar performance:
{'acc': 0.6672896, 'precision': 0.5045818, 'recall': 0.54116416, 'specificity': 0.54116416, 'f1': 0.42807433, 'auroc': 0.55856276, 'binary_precision': 0.031327873, 'binary_recall': 0.40835267, 'binary_specificity': 0.6739756, 'binary_f1_score': 0.058191434}
confusion matrix:
       0     1
0  11250  5442
1    255   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54870677, 'precision': 0.55457115, 'recall': 0.6965736, 'specificity': 0.6965736, 'f1': 0.453108, 'auroc': 0.7462236, 'binary_precision': 0.12883675, 'binary_recall': 0.87054163, 'binary_specificity': 0.52260554, 'binary_f1_score': 0.22445503}
confusion matrix:
      0     1
0  4878  4456
1    98   659
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 00:18:46.444258,epoch time: 0:13:27.777001,used: 0:41:58.114908,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8415565, 'precision': 0.8468696, 'recall': 0.8415078, 'specificity': 0.8415078, 'f1': 0.840934, 'auroc': 0.9313767, 'binary_precision': 0.80413634, 'binary_recall': 0.90340465, 'binary_specificity': 0.779611, 'binary_f1_score': 0.85088503}
confusion matrix:
       0      1
0  19799   5597
1   2457  22979
---- Validation: 
scalar performance:
{'acc': 0.74560535, 'precision': 0.5094898, 'recall': 0.572292, 'specificity': 0.572292, 'f1': 0.46210998, 'auroc': 0.59892595, 'binary_precision': 0.039427366, 'binary_recall': 0.3897912, 'binary_specificity': 0.7547927, 'binary_f1_score': 0.071611255}
confusion matrix:
       0     1
0  12599  4093
1    263   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6610841, 'precision': 0.5627347, 'recall': 0.71301305, 'specificity': 0.71301305, 'f1': 0.5179275, 'auroc': 0.7755544, 'binary_precision': 0.15280312, 'binary_recall': 0.77410835, 'binary_specificity': 0.6519177, 'binary_f1_score': 0.25522646}
confusion matrix:
      0     1
0  6085  3249
1   171   586
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-10 00:31:56.484734,epoch time: 0:13:10.040476,used: 0:55:08.155384,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8503502, 'precision': 0.85538507, 'recall': 0.850301, 'specificity': 0.850301, 'f1': 0.84980553, 'auroc': 0.94093156, 'binary_precision': 0.8132907, 'binary_recall': 0.9098164, 'binary_specificity': 0.7907856, 'binary_f1_score': 0.85884994}
confusion matrix:
       0      1
0  20082   5313
1   2294  23143
---- Validation: 
scalar performance:
{'acc': 0.7288442, 'precision': 0.50576377, 'recall': 0.5456128, 'specificity': 0.5456128, 'f1': 0.4514909, 'auroc': 0.5513632, 'binary_precision': 0.033658106, 'binary_recall': 0.35266823, 'binary_specificity': 0.7385574, 'binary_f1_score': 0.061451387}
confusion matrix:
       0     1
0  12328  4364
1    279   152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6574175, 'precision': 0.5595946, 'recall': 0.70253396, 'specificity': 0.70253396, 'f1': 0.5133844, 'auroc': 0.7523905, 'binary_precision': 0.14880332, 'binary_recall': 0.7556143, 'binary_specificity': 0.64945364, 'binary_f1_score': 0.2486416}
confusion matrix:
      0     1
0  6062  3272
1   185   572
early stop counter: 1
val acc:0.7288442254066467, best validation acc: 0.7456053495407104, corresponding to test acc:                         0.6610841155052185 / 0.6610841155052185
after epoch: 5,now: 2024-08-10 00:45:11.937102,epoch time: 0:13:15.452368,used: 1:08:23.607752,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8527699, 'precision': 0.85902345, 'recall': 0.8527154, 'specificity': 0.8527154, 'f1': 0.8521122, 'auroc': 0.9460455, 'binary_precision': 0.81184644, 'binary_recall': 0.9187011, 'binary_specificity': 0.7867297, 'binary_f1_score': 0.8619749}
confusion matrix:
       0      1
0  19979   5416
1   2068  23369
---- Validation: 
scalar performance:
{'acc': 0.7677977, 'precision': 0.51001334, 'recall': 0.57124317, 'specificity': 0.57124317, 'f1': 0.47023273, 'auroc': 0.6284789, 'binary_precision': 0.040684115, 'binary_recall': 0.36426914, 'binary_specificity': 0.77821714, 'binary_f1_score': 0.073193476}
confusion matrix:
       0     1
0  12990  3702
1    274   157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7678129, 'precision': 0.57480365, 'recall': 0.7027286, 'specificity': 0.7027286, 'f1': 0.5746727, 'auroc': 0.77232635, 'binary_precision': 0.18705603, 'binary_recall': 0.62615585, 'binary_specificity': 0.77930146, 'binary_f1_score': 0.28805834}
confusion matrix:
      0     1
0  7274  2060
1   283   474
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-10 00:58:33.201119,epoch time: 0:13:21.264017,used: 1:21:44.871769,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8586717, 'precision': 0.8693224, 'recall': 0.85860825, 'specificity': 0.85860825, 'f1': 0.85763, 'auroc': 0.95797265, 'binary_precision': 0.80679107, 'binary_recall': 0.943503, 'binary_specificity': 0.7737134, 'binary_f1_score': 0.86980784}
confusion matrix:
       0      1
0  19650   5747
1   1437  23998
---- Validation: 
scalar performance:
{'acc': 0.70291424, 'precision': 0.5126838, 'recall': 0.6080323, 'specificity': 0.6080323, 'f1': 0.45107913, 'auroc': 0.64614666, 'binary_precision': 0.042991754, 'binary_recall': 0.50812066, 'binary_specificity': 0.7079439, 'binary_f1_score': 0.07927602}
confusion matrix:
       0     1
0  11817  4875
1    212   219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7010207, 'precision': 0.5695128, 'recall': 0.72367597, 'specificity': 0.72367597, 'f1': 0.542658, 'auroc': 0.7816498, 'binary_precision': 0.1672556, 'binary_recall': 0.75033027, 'binary_specificity': 0.69702166, 'binary_f1_score': 0.27353722}
confusion matrix:
      0     1
0  6506  2828
1   189   568
early stop counter: 1
val acc:0.7029142379760742, best validation acc: 0.7677977085113525, corresponding to test acc:                         0.7678129076957703 / 0.7678129076957703
after epoch: 7,now: 2024-08-10 01:12:15.404399,epoch time: 0:13:42.203280,used: 1:35:27.075049,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8808034, 'precision': 0.8809575, 'recall': 0.8807963, 'specificity': 0.8807963, 'f1': 0.88078994, 'auroc': 0.95559967, 'binary_precision': 0.8734724, 'binary_recall': 0.89081544, 'binary_specificity': 0.87077725, 'binary_f1_score': 0.8820587}
confusion matrix:
       0      1
0  22116   3282
1   2777  22657
---- Validation: 
scalar performance:
{'acc': 0.8419669, 'precision': 0.5117169, 'recall': 0.5595592, 'specificity': 0.5595592, 'f1': 0.49533278, 'auroc': 0.5841576, 'binary_precision': 0.045181926, 'binary_recall': 0.26218098, 'binary_specificity': 0.85693747, 'binary_f1_score': 0.07708049}
confusion matrix:
       0     1
0  14304  2388
1    318   113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8157764, 'precision': 0.60449076, 'recall': 0.7498981, 'specificity': 0.7498981, 'f1': 0.6232076, 'auroc': 0.8028197, 'binary_precision': 0.24009433, 'binary_recall': 0.672391, 'binary_specificity': 0.8274052, 'binary_f1_score': 0.3538408}
confusion matrix:
      0     1
0  7723  1611
1   248   509
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-10 01:25:42.598251,epoch time: 0:13:27.193852,used: 1:48:54.268901,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8832822, 'precision': 0.88520485, 'recall': 0.88325584, 'specificity': 0.88325584, 'f1': 0.8831312, 'auroc': 0.96146595, 'binary_precision': 0.8581766, 'binary_recall': 0.91853744, 'binary_specificity': 0.8479742, 'binary_f1_score': 0.88733166}
confusion matrix:
       0      1
0  21536   3861
1   2072  23363
---- Validation: 
scalar performance:
{'acc': 0.8042399, 'precision': 0.51370335, 'recall': 0.5854142, 'specificity': 0.5854142, 'f1': 0.48703343, 'auroc': 0.6367644, 'binary_precision': 0.04741246, 'binary_recall': 0.3549884, 'binary_specificity': 0.81583995, 'binary_f1_score': 0.08365227}
confusion matrix:
       0     1
0  13618  3074
1    278   153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8086414, 'precision': 0.6013109, 'recall': 0.7490759, 'specificity': 0.7490759, 'f1': 0.61764854, 'auroc': 0.81454146, 'binary_precision': 0.23342416, 'binary_recall': 0.678996, 'binary_specificity': 0.81915575, 'binary_f1_score': 0.34741467}
confusion matrix:
      0     1
0  7646  1688
1   243   514
early stop counter: 1
val acc:0.8042399287223816, best validation acc: 0.8419669270515442, corresponding to test acc:                         0.8157764077186584 / 0.8157764077186584
after epoch: 9,now: 2024-08-10 01:39:11.112945,epoch time: 0:13:28.514694,used: 2:02:22.783595,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.88101983, 'precision': 0.88595724, 'recall': 0.88097763, 'specificity': 0.88097763, 'f1': 0.8806297, 'auroc': 0.9649534, 'binary_precision': 0.8424902, 'binary_recall': 0.9374877, 'binary_specificity': 0.8244675, 'binary_f1_score': 0.8874539}
confusion matrix:
       0      1
0  20939   4458
1   1590  23845
---- Validation: 
scalar performance:
{'acc': 0.7946622, 'precision': 0.5149571, 'recall': 0.5974537, 'specificity': 0.5974537, 'f1': 0.48577335, 'auroc': 0.6782831, 'binary_precision': 0.04910845, 'binary_recall': 0.3897912, 'binary_specificity': 0.80511624, 'binary_f1_score': 0.08722742}
confusion matrix:
       0     1
0  13439  3253
1    263   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82657814, 'precision': 0.60736084, 'recall': 0.7429913, 'specificity': 0.7429913, 'f1': 0.6288909, 'auroc': 0.78696156, 'binary_precision': 0.24784154, 'binary_recall': 0.6446499, 'binary_specificity': 0.84133273, 'binary_f1_score': 0.35803375}
confusion matrix:
      0     1
0  7853  1481
1   269   488
new oracle model saved
early stop counter: 2
val acc:0.7946621775627136, best validation acc: 0.8419669270515442, corresponding to test acc:                         0.8157764077186584 / 0.8265781402587891
after epoch: 10,now: 2024-08-10 01:52:35.190568,epoch time: 0:13:24.077623,used: 2:15:46.861218,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8855839, 'precision': 0.894359, 'recall': 0.8855252, 'specificity': 0.8855252, 'f1': 0.88493264, 'auroc': 0.9723271, 'binary_precision': 0.83572894, 'binary_recall': 0.9600566, 'binary_specificity': 0.81099385, 'binary_f1_score': 0.89358896}
confusion matrix:
       0      1
0  20596   4800
1   1016  24420
---- Validation: 
scalar performance:
{'acc': 0.76330084, 'precision': 0.51812017, 'recall': 0.6333545, 'specificity': 0.6333545, 'f1': 0.4796739, 'auroc': 0.688676, 'binary_precision': 0.052839506, 'binary_recall': 0.4965197, 'binary_specificity': 0.7701893, 'binary_f1_score': 0.095514394}
confusion matrix:
       0     1
0  12856  3836
1    217   214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7779209, 'precision': 0.5936789, 'recall': 0.75796115, 'specificity': 0.75796115, 'f1': 0.5992402, 'auroc': 0.8165457, 'binary_precision': 0.21417566, 'binary_recall': 0.7344782, 'binary_specificity': 0.7814442, 'binary_f1_score': 0.3316433}
confusion matrix:
      0     1
0  7294  2040
1   201   556
early stop counter: 3
val acc:0.7633008360862732, best validation acc: 0.8419669270515442, corresponding to test acc:                         0.8157764077186584 / 0.8265781402587891
after epoch: 11,now: 2024-08-10 02:06:04.375303,epoch time: 0:13:29.184735,used: 2:29:16.045953,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8839904, 'precision': 0.8933878, 'recall': 0.8839296, 'specificity': 0.8839296, 'f1': 0.8832817, 'auroc': 0.97209835, 'binary_precision': 0.8327826, 'binary_recall': 0.96115744, 'binary_specificity': 0.80670184, 'binary_f1_score': 0.8923768}
confusion matrix:
       0      1
0  20487   4909
1    988  24448
---- Validation: 
scalar performance:
{'acc': 0.72755945, 'precision': 0.5166833, 'recall': 0.6353649, 'specificity': 0.6353649, 'f1': 0.4651251, 'auroc': 0.6801789, 'binary_precision': 0.049382716, 'binary_recall': 0.53828305, 'binary_specificity': 0.7324467, 'binary_f1_score': 0.09046598}
confusion matrix:
       0     1
0  12226  4466
1    199   232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7660291, 'precision': 0.5802821, 'recall': 0.72240025, 'specificity': 0.72240025, 'f1': 0.58018243, 'auroc': 0.7732679, 'binary_precision': 0.19389313, 'binary_recall': 0.67107004, 'binary_specificity': 0.77373046, 'binary_f1_score': 0.30085874}
confusion matrix:
      0     1
0  7222  2112
1   249   508
early stop counter: 4
val acc:0.7275594472885132, best validation acc: 0.8419669270515442, corresponding to test acc:                         0.8157764077186584 / 0.8265781402587891
after epoch: 12,now: 2024-08-10 02:19:24.927687,epoch time: 0:13:20.552384,used: 2:42:36.598337,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.89357096, 'precision': 0.89905345, 'recall': 0.8935272, 'specificity': 0.8935272, 'f1': 0.89319646, 'auroc': 0.9725319, 'binary_precision': 0.8524659, 'binary_recall': 0.95207393, 'binary_specificity': 0.8349805, 'binary_f1_score': 0.89952075}
confusion matrix:
       0      1
0  21206   4191
1   1219  24216
---- Validation: 
scalar performance:
{'acc': 0.7900485, 'precision': 0.5212941, 'recall': 0.64368325, 'specificity': 0.64368325, 'f1': 0.49306402, 'auroc': 0.72041667, 'binary_precision': 0.058839932, 'binary_recall': 0.48955917, 'binary_specificity': 0.79780734, 'binary_f1_score': 0.10505352}
confusion matrix:
       0     1
0  13317  3375
1    220   211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8402537, 'precision': 0.6244991, 'recall': 0.7758749, 'specificity': 0.7758749, 'f1': 0.6523224, 'auroc': 0.84269905, 'binary_precision': 0.2767624, 'binary_recall': 0.7001321, 'binary_specificity': 0.85161775, 'binary_f1_score': 0.39670655}
confusion matrix:
      0     1
0  7949  1385
1   227   530
new oracle model saved
early stop counter: 5
val acc:0.7900484800338745, best validation acc: 0.8419669270515442, corresponding to test acc:                         0.8157764077186584 / 0.8402537107467651
after epoch: 13,now: 2024-08-10 02:32:38.904018,epoch time: 0:13:13.976331,used: 2:55:50.574668,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8950071, 'precision': 0.9022849, 'recall': 0.8949542, 'specificity': 0.8949542, 'f1': 0.8945209, 'auroc': 0.9772806, 'binary_precision': 0.84837246, 'binary_recall': 0.96214026, 'binary_specificity': 0.82776815, 'binary_f1_score': 0.9016819}
confusion matrix:
       0      1
0  21022   4374
1    963  24473
---- Validation: 
scalar performance:
{'acc': 0.764352, 'precision': 0.51810175, 'recall': 0.63276356, 'specificity': 0.63276356, 'f1': 0.48001167, 'auroc': 0.70464313, 'binary_precision': 0.0528536, 'binary_recall': 0.49419954, 'binary_specificity': 0.77132756, 'binary_f1_score': 0.095494285}
confusion matrix:
       0     1
0  12875  3817
1    218   213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8589833, 'precision': 0.6297816, 'recall': 0.75079703, 'specificity': 0.75079703, 'f1': 0.65947026, 'auroc': 0.8176958, 'binary_precision': 0.2931677, 'binary_recall': 0.6235139, 'binary_specificity': 0.8780801, 'binary_f1_score': 0.3988171}
confusion matrix:
      0     1
0  8196  1138
1   285   472
new oracle model saved
early stop counter: 6
val acc:0.764352023601532, best validation acc: 0.8419669270515442, corresponding to test acc:                         0.8157764077186584 / 0.8589832782745361
after epoch: 14,now: 2024-08-10 02:45:59.039084,epoch time: 0:13:20.135066,used: 3:09:10.709734,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8995318, 'precision': 0.9037237, 'recall': 0.8994957, 'specificity': 0.8994957, 'f1': 0.8992644, 'auroc': 0.97512233, 'binary_precision': 0.8627619, 'binary_recall': 0.9503814, 'binary_specificity': 0.8486101, 'binary_f1_score': 0.9044546}
confusion matrix:
       0      1
0  21553   3845
1   1262  24172
---- Validation: 
scalar performance:
{'acc': 0.81305844, 'precision': 0.52223015, 'recall': 0.63627297, 'specificity': 0.63627297, 'f1': 0.5018474, 'auroc': 0.7075199, 'binary_precision': 0.061431285, 'binary_recall': 0.450116, 'binary_specificity': 0.8224299, 'binary_f1_score': 0.10810812}
confusion matrix:
       0     1
0  13728  2964
1    237   194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87156874, 'precision': 0.6407992, 'recall': 0.75153077, 'specificity': 0.75153077, 'f1': 0.67203194, 'auroc': 0.82806593, 'binary_precision': 0.31578946, 'binary_recall': 0.6103038, 'binary_specificity': 0.89275765, 'binary_f1_score': 0.41621622}
confusion matrix:
      0     1
0  8333  1001
1   295   462
new oracle model saved
early stop counter: 7
val acc:0.8130584359169006, best validation acc: 0.8419669270515442, corresponding to test acc:                         0.8157764077186584 / 0.8715687394142151
after epoch: 15,now: 2024-08-10 03:00:05.824897,epoch time: 0:14:06.785813,used: 3:23:17.495547,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_36_48_seed_1_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:23:17.495547 at 2024-08-10 03:00:05.824897
persisted model performance metric: 

scalar performance:
{'acc': 0.8157764, 'precision': 0.60449076, 'recall': 0.7498981, 'specificity': 0.7498981, 'f1': 0.6232076, 'auroc': 0.8028197, 'binary_precision': 0.24009433, 'binary_recall': 0.672391, 'binary_specificity': 0.8274052, 'binary_f1_score': 0.3538408}
confusion matrix:
      0     1
0  7723  1611
1   248   509
oracle model performance metric: 

scalar performance:
{'acc': 0.87156874, 'precision': 0.6407992, 'recall': 0.75153077, 'specificity': 0.75153077, 'f1': 0.67203194, 'auroc': 0.82806593, 'binary_precision': 0.31578946, 'binary_recall': 0.6103038, 'binary_specificity': 0.89275765, 'binary_f1_score': 0.41621622}
confusion matrix:
      0     1
0  8333  1001
1   295   462
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 644140 KiB |    933 TiB |    933 TiB |
|       from large pool | 168576 KiB | 570688 KiB |    932 TiB |    932 TiB |
|       from small pool |  37760 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 644140 KiB |    933 TiB |    933 TiB |
|       from large pool | 168576 KiB | 570688 KiB |    932 TiB |    932 TiB |
|       from small pool |  37760 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 632477 KiB |    930 TiB |    930 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    930 TiB |    930 TiB |
|       from small pool |  36148 KiB |  74125 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 706560 KiB | 706560 KiB |   1118 MiB | 438272 KiB |
|       from large pool | 630784 KiB | 630784 KiB |   1012 MiB | 405504 KiB |
|       from small pool |  75776 KiB |  77824 KiB |    106 MiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 241231 KiB | 401938 GiB | 401938 GiB |
|       from large pool |  15744 KiB | 240320 KiB | 401630 GiB | 401630 GiB |
|       from small pool |   9343 KiB |  14884 KiB |    307 GiB |    307 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7123    |   87100 K  |   87096 K  |
|       from large pool |      36    |      76    |   33465 K  |   33465 K  |
|       from small pool |    4650    |    7085    |   53635 K  |   53630 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7123    |   87100 K  |   87096 K  |
|       from large pool |      36    |      76    |   33465 K  |   33465 K  |
|       from small pool |    4650    |    7085    |   53635 K  |   53630 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      76    |      22    |
|       from large pool |      17    |      17    |      23    |       6    |
|       from small pool |      37    |      38    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      46    |    3190    |   46114 K  |   46114 K  |
|       from large pool |       3    |      13    |   18909 K  |   18909 K  |
|       from small pool |      43    |    3187    |   27205 K  |   27205 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 644140 KiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB | 570688 KiB |    932 TiB |    932 TiB |
|       from small pool |      0 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 644140 KiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB | 570688 KiB |    932 TiB |    932 TiB |
|       from small pool |      0 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632477 KiB |    930 TiB |    930 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    930 TiB |    930 TiB |
|       from small pool |      0 KiB |  74125 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 706560 KiB |   1118 MiB |    892 MiB |
|       from large pool | 184320 KiB | 630784 KiB |   1012 MiB |    832 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 241231 KiB | 401938 GiB | 401938 GiB |
|       from large pool |  24320 KiB | 240320 KiB | 401631 GiB | 401631 GiB |
|       from small pool |      0 KiB |  16938 KiB |    307 GiB |    307 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87100 K  |   87100 K  |
|       from large pool |       2    |      76    |   33465 K  |   33465 K  |
|       from small pool |       0    |    7085    |   53635 K  |   53635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87100 K  |   87100 K  |
|       from large pool |       2    |      76    |   33465 K  |   33465 K  |
|       from small pool |       0    |    7085    |   53635 K  |   53635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      54    |      76    |      44    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46116 K  |   46116 K  |
|       from large pool |       3    |      13    |   18909 K  |   18909 K  |
|       from small pool |       0    |    3187    |   27207 K  |   27207 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 644140 KiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB | 570688 KiB |    932 TiB |    932 TiB |
|       from small pool |      0 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 644140 KiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB | 570688 KiB |    932 TiB |    932 TiB |
|       from small pool |      0 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632477 KiB |    930 TiB |    930 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    930 TiB |    930 TiB |
|       from small pool |      0 KiB |  74125 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 706560 KiB |   1118 MiB |    892 MiB |
|       from large pool | 184320 KiB | 630784 KiB |   1012 MiB |    832 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 241231 KiB | 401938 GiB | 401938 GiB |
|       from large pool |  24320 KiB | 240320 KiB | 401631 GiB | 401631 GiB |
|       from small pool |      0 KiB |  16938 KiB |    307 GiB |    307 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87100 K  |   87100 K  |
|       from large pool |       2    |      76    |   33465 K  |   33465 K  |
|       from small pool |       0    |    7085    |   53635 K  |   53635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87100 K  |   87100 K  |
|       from large pool |       2    |      76    |   33465 K  |   33465 K  |
|       from small pool |       0    |    7085    |   53635 K  |   53635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      54    |      76    |      44    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46116 K  |   46116 K  |
|       from large pool |       3    |      13    |   18909 K  |   18909 K  |
|       from small pool |       0    |    3187    |   27207 K  |   27207 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718

 Experiment start at: 2024-08-10 03:19:25.163816
before training, model accuracy: 0.10671819001436234
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7602329, 'precision': 0.77048135, 'recall': 0.7602141, 'specificity': 0.7602141, 'f1': 0.7579311, 'auroc': 0.85942346, 'binary_precision': 0.71787983, 'binary_recall': 0.8575794, 'binary_specificity': 0.6628487, 'binary_f1_score': 0.78153586}
confusion matrix:
       0      1
0  17130   8713
1   3682  22171
---- Validation: 
scalar performance:
{'acc': 0.6173207, 'precision': 0.51302737, 'recall': 0.63010263, 'specificity': 0.63010263, 'f1': 0.41728508, 'auroc': 0.68204594, 'binary_precision': 0.040311705, 'binary_recall': 0.6435407, 'binary_specificity': 0.61666465, 'binary_f1_score': 0.07587083}
confusion matrix:
       0     1
0  10302  6404
1    149   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.2945898, 'precision': 0.5164035, 'recall': 0.5413422, 'specificity': 0.5413422, 'f1': 0.27538416, 'auroc': 0.58830214, 'binary_precision': 0.08690538, 'binary_recall': 0.8343789, 'binary_specificity': 0.24830554, 'binary_f1_score': 0.15741508}
confusion matrix:
      0     1
0  2308  6987
1   132   665
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 03:35:37.469715,epoch time: 0:16:12.305899,used: 0:16:12.305899,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.81538224, 'precision': 0.837095, 'recall': 0.81534296, 'specificity': 0.81534296, 'f1': 0.81234765, 'auroc': 0.9220458, 'binary_precision': 0.7516197, 'binary_recall': 0.9422571, 'binary_specificity': 0.6884288, 'binary_f1_score': 0.8362108}
confusion matrix:
       0      1
0  17789   8051
1   1493  24363
---- Validation: 
scalar performance:
{'acc': 0.62923384, 'precision': 0.51298344, 'recall': 0.6280446, 'specificity': 0.6280446, 'f1': 0.42215672, 'auroc': 0.68645537, 'binary_precision': 0.04058869, 'binary_recall': 0.6267943, 'binary_specificity': 0.6292949, 'binary_f1_score': 0.07624037}
confusion matrix:
       0     1
0  10513  6193
1    156   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36791518, 'precision': 0.5233271, 'recall': 0.56967735, 'specificity': 0.56967735, 'f1': 0.32925066, 'auroc': 0.6287118, 'binary_precision': 0.093859136, 'binary_recall': 0.8092848, 'binary_specificity': 0.33006993, 'binary_f1_score': 0.16820967}
confusion matrix:
      0     1
0  3068  6227
1   152   645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 03:50:00.062725,epoch time: 0:14:22.593010,used: 0:30:34.898909,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8410515, 'precision': 0.84937835, 'recall': 0.84103656, 'specificity': 0.84103656, 'f1': 0.8400946, 'auroc': 0.93459237, 'binary_precision': 0.79548955, 'binary_recall': 0.91823, 'binary_specificity': 0.7638432, 'binary_f1_score': 0.85246426}
confusion matrix:
       0      1
0  19740   6103
1   2114  23739
---- Validation: 
scalar performance:
{'acc': 0.70760334, 'precision': 0.5144711, 'recall': 0.626225, 'specificity': 0.626225, 'f1': 0.45443922, 'auroc': 0.67265075, 'binary_precision': 0.044832375, 'binary_recall': 0.54066986, 'binary_specificity': 0.7117802, 'binary_f1_score': 0.082799055}
confusion matrix:
       0     1
0  11891  4815
1    192   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5581649, 'precision': 0.5425376, 'recall': 0.6460014, 'specificity': 0.6460014, 'f1': 0.4522954, 'auroc': 0.7168548, 'binary_precision': 0.12309592, 'binary_recall': 0.7503137, 'binary_specificity': 0.5416891, 'binary_f1_score': 0.21149425}
confusion matrix:
      0     1
0  5035  4260
1   199   598
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 04:04:19.344222,epoch time: 0:14:19.281497,used: 0:44:54.180406,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85192275, 'precision': 0.8628634, 'recall': 0.85190934, 'specificity': 0.85190934, 'f1': 0.85079473, 'auroc': 0.94554317, 'binary_precision': 0.7998945, 'binary_recall': 0.93872815, 'binary_specificity': 0.7650905, 'binary_f1_score': 0.8637682}
confusion matrix:
       0      1
0  19773   6071
1   1584  24268
---- Validation: 
scalar performance:
{'acc': 0.7119832, 'precision': 0.51656115, 'recall': 0.64363086, 'specificity': 0.64363086, 'f1': 0.45866525, 'auroc': 0.69061375, 'binary_precision': 0.047876604, 'binary_recall': 0.5717703, 'binary_specificity': 0.7154914, 'binary_f1_score': 0.0883549}
confusion matrix:
       0     1
0  11953  4753
1    179   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60761, 'precision': 0.5461316, 'recall': 0.6550634, 'specificity': 0.6550634, 'f1': 0.4800947, 'auroc': 0.7144084, 'binary_precision': 0.13195252, 'binary_recall': 0.7114178, 'binary_specificity': 0.598709, 'binary_f1_score': 0.22261484}
confusion matrix:
      0     1
0  5565  3730
1   230   567
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-10 04:18:39.590055,epoch time: 0:14:20.245833,used: 0:59:14.426239,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8622911, 'precision': 0.871403, 'recall': 0.86227596, 'specificity': 0.86227596, 'f1': 0.8614377, 'auroc': 0.95088375, 'binary_precision': 0.8132776, 'binary_recall': 0.94058716, 'binary_specificity': 0.7839647, 'binary_f1_score': 0.87231183}
confusion matrix:
       0      1
0  20260   5583
1   1536  24317
---- Validation: 
scalar performance:
{'acc': 0.70304835, 'precision': 0.51407796, 'recall': 0.6238905, 'specificity': 0.6238905, 'f1': 0.45226142, 'auroc': 0.6739402, 'binary_precision': 0.044149246, 'binary_recall': 0.54066986, 'binary_specificity': 0.70711124, 'binary_f1_score': 0.08163265}
confusion matrix:
       0     1
0  11813  4893
1    192   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59492666, 'precision': 0.5531604, 'recall': 0.6808709, 'specificity': 0.6808709, 'f1': 0.47927988, 'auroc': 0.7486586, 'binary_precision': 0.1374752, 'binary_recall': 0.78293604, 'binary_specificity': 0.5788058, 'binary_f1_score': 0.23388305}
confusion matrix:
      0     1
0  5380  3915
1   173   624
early stop counter: 1
val acc:0.7030483484268188, best validation acc: 0.7119832038879395, corresponding to test acc:                         0.6076099872589111 / 0.6076099872589111
after epoch: 5,now: 2024-08-10 04:32:58.657074,epoch time: 0:14:19.067019,used: 1:13:33.493258,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8724079, 'precision': 0.87850785, 'recall': 0.87239814, 'specificity': 0.87239814, 'f1': 0.8718897, 'auroc': 0.95780015, 'binary_precision': 0.83049566, 'binary_recall': 0.9358657, 'binary_specificity': 0.8089305, 'binary_f1_score': 0.88003784}
confusion matrix:
       0      1
0  20906   4938
1   1658  24194
---- Validation: 
scalar performance:
{'acc': 0.75887644, 'precision': 0.51477027, 'recall': 0.6128508, 'specificity': 0.6128508, 'f1': 0.47311383, 'auroc': 0.6797875, 'binary_precision': 0.046886448, 'binary_recall': 0.45933014, 'binary_specificity': 0.76637137, 'binary_f1_score': 0.08508753}
confusion matrix:
       0     1
0  12803  3903
1    226   192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.603151, 'precision': 0.5566379, 'recall': 0.6922184, 'specificity': 0.6922184, 'f1': 0.48619014, 'auroc': 0.77852803, 'binary_precision': 0.14196429, 'binary_recall': 0.79799247, 'binary_specificity': 0.5864443, 'binary_f1_score': 0.24104604}
confusion matrix:
      0     1
0  5451  3844
1   161   636
better model found
persisted
after epoch: 6,now: 2024-08-10 04:47:19.450655,epoch time: 0:14:20.793581,used: 1:27:54.286839,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.87312365, 'precision': 0.881017, 'recall': 0.8731125, 'specificity': 0.8731125, 'f1': 0.8724607, 'auroc': 0.9606209, 'binary_precision': 0.82621485, 'binary_recall': 0.94507194, 'binary_specificity': 0.80115306, 'binary_f1_score': 0.88165563}
confusion matrix:
       0      1
0  20705   5139
1   1420  24432
---- Validation: 
scalar performance:
{'acc': 0.74550337, 'precision': 0.5180483, 'recall': 0.644483, 'specificity': 0.644483, 'f1': 0.47278208, 'auroc': 0.6892563, 'binary_precision': 0.051252846, 'binary_recall': 0.5382775, 'binary_specificity': 0.7506884, 'binary_f1_score': 0.09359401}
confusion matrix:
       0     1
0  12541  4165
1    193   225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6800436, 'precision': 0.5630454, 'recall': 0.69840056, 'specificity': 0.69840056, 'f1': 0.5290017, 'auroc': 0.74205697, 'binary_precision': 0.1603352, 'binary_recall': 0.7202008, 'binary_specificity': 0.67660034, 'binary_f1_score': 0.2622801}
confusion matrix:
      0     1
0  6289  3006
1   223   574
new oracle model saved
early stop counter: 1
val acc:0.7455033659934998, best validation acc: 0.7588764429092407, corresponding to test acc:                         0.6031510233879089 / 0.6800435781478882
after epoch: 7,now: 2024-08-10 05:01:36.683490,epoch time: 0:14:17.232835,used: 1:42:11.519674,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8801068, 'precision': 0.8852751, 'recall': 0.8800956, 'specificity': 0.8800956, 'f1': 0.87970114, 'auroc': 0.9617971, 'binary_precision': 0.84070027, 'binary_recall': 0.9379956, 'binary_specificity': 0.8221956, 'binary_f1_score': 0.8866869}
confusion matrix:
       0      1
0  21248   4595
1   1603  24250
---- Validation: 
scalar performance:
{'acc': 0.77738845, 'precision': 0.5149174, 'recall': 0.6071772, 'specificity': 0.6071772, 'f1': 0.47955707, 'auroc': 0.6561506, 'binary_precision': 0.04770789, 'binary_recall': 0.42822966, 'binary_specificity': 0.78612477, 'binary_f1_score': 0.08585132}
confusion matrix:
       0     1
0  13133  3573
1    239   179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7687277, 'precision': 0.57996523, 'recall': 0.7075426, 'specificity': 0.7075426, 'f1': 0.5819179, 'auroc': 0.7541642, 'binary_precision': 0.19850922, 'binary_recall': 0.6348808, 'binary_specificity': 0.7802044, 'binary_f1_score': 0.3024507}
confusion matrix:
      0     1
0  7252  2043
1   291   506
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-10 05:16:00.908314,epoch time: 0:14:24.224824,used: 1:56:35.744498,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8797392, 'precision': 0.88744134, 'recall': 0.8797283, 'specificity': 0.8797283, 'f1': 0.87913644, 'auroc': 0.9658507, 'binary_precision': 0.832853, 'binary_recall': 0.9502166, 'binary_specificity': 0.80924004, 'binary_f1_score': 0.8876723}
confusion matrix:
       0      1
0  20914   4930
1   1287  24565
---- Validation: 
scalar performance:
{'acc': 0.73732775, 'precision': 0.51648164, 'recall': 0.63446164, 'specificity': 0.63446164, 'f1': 0.46782097, 'auroc': 0.6936012, 'binary_precision': 0.048672568, 'binary_recall': 0.5263158, 'binary_specificity': 0.7426075, 'binary_f1_score': 0.089104906}
confusion matrix:
       0     1
0  12406  4300
1    198   220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7344431, 'precision': 0.5736154, 'recall': 0.71015215, 'specificity': 0.71015215, 'f1': 0.56256706, 'auroc': 0.7552589, 'binary_precision': 0.18288986, 'binary_recall': 0.6813049, 'binary_specificity': 0.7389995, 'binary_f1_score': 0.28836963}
confusion matrix:
      0     1
0  6869  2426
1   254   543
early stop counter: 1
val acc:0.7373277544975281, best validation acc: 0.7773884534835815, corresponding to test acc:                         0.768727719783783 / 0.768727719783783
after epoch: 9,now: 2024-08-10 05:30:23.970030,epoch time: 0:14:23.061716,used: 2:10:58.806214,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8846913, 'precision': 0.8901886, 'recall': 0.8846844, 'specificity': 0.8846844, 'f1': 0.88428235, 'auroc': 0.96686745, 'binary_precision': 0.8439034, 'binary_recall': 0.9440254, 'binary_specificity': 0.8253434, 'binary_f1_score': 0.891161}
confusion matrix:
       0      1
0  21331   4514
1   1447  24404
---- Validation: 
scalar performance:
{'acc': 0.7695632, 'precision': 0.5185526, 'recall': 0.638154, 'specificity': 0.638154, 'f1': 0.48186988, 'auroc': 0.6949897, 'binary_precision': 0.052965026, 'binary_recall': 0.5, 'binary_specificity': 0.77630794, 'binary_f1_score': 0.09578368}
confusion matrix:
       0     1
0  12969  3737
1    209   209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.767935, 'precision': 0.5887665, 'recall': 0.7369374, 'specificity': 0.7369374, 'f1': 0.5913542, 'auroc': 0.7822592, 'binary_precision': 0.2096956, 'binary_recall': 0.70012546, 'binary_specificity': 0.77374935, 'binary_f1_score': 0.32272992}
confusion matrix:
      0     1
0  7192  2103
1   239   558
early stop counter: 2
val acc:0.7695631980895996, best validation acc: 0.7773884534835815, corresponding to test acc:                         0.768727719783783 / 0.768727719783783
after epoch: 10,now: 2024-08-10 05:44:41.952998,epoch time: 0:14:17.982968,used: 2:25:16.789182,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90409315, 'precision': 0.9042791, 'recall': 0.90409064, 'specificity': 0.90409064, 'f1': 0.90408176, 'auroc': 0.96856, 'binary_precision': 0.8956677, 'binary_recall': 0.91479075, 'binary_specificity': 0.8933906, 'binary_f1_score': 0.90512824}
confusion matrix:
       0      1
0  23087   2755
1   2203  23651
---- Validation: 
scalar performance:
{'acc': 0.836954, 'precision': 0.5171722, 'recall': 0.5945542, 'specificity': 0.5945542, 'f1': 0.5013801, 'auroc': 0.66119957, 'binary_precision': 0.05342363, 'binary_recall': 0.33971292, 'binary_specificity': 0.84939545, 'binary_f1_score': 0.09232769}
confusion matrix:
       0     1
0  14190  2516
1    276   142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84165674, 'precision': 0.61689115, 'recall': 0.7310741, 'specificity': 0.7310741, 'f1': 0.64183694, 'auroc': 0.7758441, 'binary_precision': 0.27205464, 'binary_recall': 0.5997491, 'binary_specificity': 0.86239916, 'binary_f1_score': 0.3743148}
confusion matrix:
      0     1
0  8016  1279
1   319   478
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-10 05:58:57.599167,epoch time: 0:14:15.646169,used: 2:39:32.435351,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.89652973, 'precision': 0.9034219, 'recall': 0.8965196, 'specificity': 0.8965196, 'f1': 0.8960842, 'auroc': 0.9772275, 'binary_precision': 0.8507304, 'binary_recall': 0.9618598, 'binary_specificity': 0.8311794, 'binary_f1_score': 0.9028885}
confusion matrix:
       0      1
0  21481   4363
1    986  24866
---- Validation: 
scalar performance:
{'acc': 0.76068676, 'precision': 0.5206828, 'recall': 0.65926206, 'specificity': 0.65926206, 'f1': 0.4816401, 'auroc': 0.7150587, 'binary_precision': 0.05577016, 'binary_recall': 0.55263156, 'binary_specificity': 0.7658925, 'binary_f1_score': 0.10131579}
confusion matrix:
       0     1
0  12795  3911
1    187   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78458184, 'precision': 0.5911239, 'recall': 0.72934127, 'specificity': 0.72934127, 'f1': 0.5995535, 'auroc': 0.7731519, 'binary_precision': 0.21724845, 'binary_recall': 0.663739, 'binary_specificity': 0.7949435, 'binary_f1_score': 0.32735148}
confusion matrix:
      0     1
0  7389  1906
1   268   529
early stop counter: 1
val acc:0.7606867551803589, best validation acc: 0.8369539976119995, corresponding to test acc:                         0.8416567444801331 / 0.8416567444801331
after epoch: 12,now: 2024-08-10 06:13:15.051038,epoch time: 0:14:17.451871,used: 2:53:49.887222,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9127012, 'precision': 0.9127396, 'recall': 0.91270006, 'specificity': 0.91270006, 'f1': 0.912699, 'auroc': 0.97348356, 'binary_precision': 0.90881574, 'binary_recall': 0.91749823, 'binary_specificity': 0.9079019, 'binary_f1_score': 0.91313636}
confusion matrix:
       0      1
0  23462   2380
1   2133  23721
---- Validation: 
scalar performance:
{'acc': 0.8448961, 'precision': 0.52180463, 'recall': 0.6161182, 'specificity': 0.6161182, 'f1': 0.510404, 'auroc': 0.6988609, 'binary_precision': 0.061520375, 'binary_recall': 0.37559807, 'binary_specificity': 0.8566383, 'binary_f1_score': 0.1057239}
confusion matrix:
       0     1
0  14311  2395
1    261   157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85057473, 'precision': 0.62874794, 'recall': 0.7496809, 'specificity': 0.7496809, 'f1': 0.6571744, 'auroc': 0.79676545, 'binary_precision': 0.29271138, 'binary_recall': 0.629862, 'binary_specificity': 0.86949974, 'binary_f1_score': 0.39968154}
confusion matrix:
      0     1
0  8082  1213
1   295   502
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-10 06:27:31.946563,epoch time: 0:14:16.895525,used: 3:08:06.782747,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8840916, 'precision': 0.8963444, 'recall': 0.8840848, 'specificity': 0.8840848, 'f1': 0.88318753, 'auroc': 0.97882426, 'binary_precision': 0.8266763, 'binary_recall': 0.97199225, 'binary_specificity': 0.7961774, 'binary_f1_score': 0.89346415}
confusion matrix:
       0      1
0  20578   5268
1    724  25126
---- Validation: 
scalar performance:
{'acc': 0.7396636, 'precision': 0.52289975, 'recall': 0.6881397, 'specificity': 0.6881397, 'f1': 0.4769484, 'auroc': 0.7588258, 'binary_precision': 0.05798687, 'binary_recall': 0.6339713, 'binary_specificity': 0.74230814, 'binary_f1_score': 0.10625502}
confusion matrix:
       0     1
0  12401  4305
1    153   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8014269, 'precision': 0.6048938, 'recall': 0.7556928, 'specificity': 0.7556928, 'f1': 0.62032485, 'auroc': 0.78917706, 'binary_precision': 0.2404301, 'binary_recall': 0.7013802, 'binary_specificity': 0.81000537, 'binary_f1_score': 0.35810375}
confusion matrix:
      0     1
0  7529  1766
1   238   559
early stop counter: 1
val acc:0.7396636009216309, best validation acc: 0.8448960781097412, corresponding to test acc:                         0.8505747318267822 / 0.8505747318267822
after epoch: 14,now: 2024-08-10 06:41:48.273713,epoch time: 0:14:16.327150,used: 3:22:23.109897,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.90902585, 'precision': 0.9132581, 'recall': 0.9090219, 'specificity': 0.9090219, 'f1': 0.9087918, 'auroc': 0.9803861, 'binary_precision': 0.87145615, 'binary_recall': 0.95961314, 'binary_specificity': 0.8584307, 'binary_f1_score': 0.9134125}
confusion matrix:
       0      1
0  22187   3659
1   1044  24806
---- Validation: 
scalar performance:
{'acc': 0.78766644, 'precision': 0.52256286, 'recall': 0.65909445, 'specificity': 0.65909445, 'f1': 0.49350497, 'auroc': 0.7196698, 'binary_precision': 0.05990153, 'binary_recall': 0.52392346, 'binary_specificity': 0.7942655, 'binary_f1_score': 0.10751104}
confusion matrix:
       0     1
0  13269  3437
1    199   219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8387832, 'precision': 0.6202492, 'recall': 0.7472945, 'specificity': 0.7472945, 'f1': 0.64605623, 'auroc': 0.78611314, 'binary_precision': 0.2754329, 'binary_recall': 0.63864493, 'binary_specificity': 0.85594404, 'binary_f1_score': 0.38487715}
confusion matrix:
      0     1
0  7956  1339
1   288   509
early stop counter: 2
val acc:0.7876664400100708, best validation acc: 0.8448960781097412, corresponding to test acc:                         0.8505747318267822 / 0.8505747318267822
after epoch: 15,now: 2024-08-10 06:55:58.001825,epoch time: 0:14:09.728112,used: 3:36:32.838009,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_19_24_seed_2_24132718
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:36:32.838009 at 2024-08-10 06:55:58.001825
persisted model performance metric: 

scalar performance:
{'acc': 0.85057473, 'precision': 0.62874794, 'recall': 0.7496809, 'specificity': 0.7496809, 'f1': 0.6571744, 'auroc': 0.79676545, 'binary_precision': 0.29271138, 'binary_recall': 0.629862, 'binary_specificity': 0.86949974, 'binary_f1_score': 0.39968154}
confusion matrix:
      0     1
0  8082  1213
1   295   502
oracle model performance metric: 

scalar performance:
{'acc': 0.85057473, 'precision': 0.62874794, 'recall': 0.7496809, 'specificity': 0.7496809, 'f1': 0.6571744, 'auroc': 0.79676545, 'binary_precision': 0.29271138, 'binary_recall': 0.629862, 'binary_specificity': 0.86949974, 'binary_f1_score': 0.39968154}
confusion matrix:
      0     1
0  8082  1213
1   295   502
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 644140 KiB |   1415 TiB |   1415 TiB |
|       from large pool | 168576 KiB | 570688 KiB |   1414 TiB |   1414 TiB |
|       from small pool |  37760 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 644140 KiB |   1415 TiB |   1415 TiB |
|       from large pool | 168576 KiB | 570688 KiB |   1414 TiB |   1414 TiB |
|       from small pool |  37760 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 632477 KiB |   1411 TiB |   1411 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1410 TiB |   1410 TiB |
|       from small pool |  36148 KiB |  74125 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 706560 KiB | 706560 KiB |   1582 MiB |    892 MiB |
|       from large pool | 630784 KiB | 630784 KiB |   1448 MiB |    832 MiB |
|       from small pool |  75776 KiB |  77824 KiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 241231 KiB | 589345 GiB | 589345 GiB |
|       from large pool |  15744 KiB | 240320 KiB | 588879 GiB | 588879 GiB |
|       from small pool |   9343 KiB |  16938 KiB |    466 GiB |    466 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7231    |  131859 K  |  131855 K  |
|       from large pool |      36    |      76    |   50744 K  |   50744 K  |
|       from small pool |    4650    |    7193    |   81115 K  |   81110 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7231    |  131859 K  |  131855 K  |
|       from large pool |      36    |      76    |   50744 K  |   50744 K  |
|       from small pool |    4650    |    7193    |   81115 K  |   81110 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      98    |      44    |
|       from large pool |      17    |      17    |      31    |      14    |
|       from small pool |      37    |      38    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3243    |   69566 K  |   69566 K  |
|       from large pool |       3    |      13    |   28438 K  |   28438 K  |
|       from small pool |      49    |    3240    |   41128 K  |   41128 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 644140 KiB |   1415 TiB |   1415 TiB |
|       from large pool |  16640 KiB | 570688 KiB |   1414 TiB |   1414 TiB |
|       from small pool |      0 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 644140 KiB |   1415 TiB |   1415 TiB |
|       from large pool |  16640 KiB | 570688 KiB |   1414 TiB |   1414 TiB |
|       from small pool |      0 KiB |  75805 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632477 KiB |   1411 TiB |   1411 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1410 TiB |   1410 TiB |
|       from small pool |      0 KiB |  74125 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 706560 KiB |   1582 MiB |   1356 MiB |
|       from large pool | 184320 KiB | 630784 KiB |   1448 MiB |   1268 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    134 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 241231 KiB | 589345 GiB | 589345 GiB |
|       from large pool |  24320 KiB | 240320 KiB | 588879 GiB | 588879 GiB |
|       from small pool |      0 KiB |  16938 KiB |    466 GiB |    466 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7231    |  131859 K  |  131859 K  |
|       from large pool |       2    |      76    |   50744 K  |   50744 K  |
|       from small pool |       0    |    7193    |   81115 K  |   81115 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7231    |  131859 K  |  131859 K  |
|       from large pool |       2    |      76    |   50744 K  |   50744 K  |
|       from small pool |       0    |    7193    |   81115 K  |   81115 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      54    |      98    |      66    |
|       from large pool |       9    |      17    |      31    |      22    |
|       from small pool |      23    |      38    |      67    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3243    |   69568 K  |   69568 K  |
|       from large pool |       3    |      13    |   28438 K  |   28438 K  |
|       from small pool |       0    |    3240    |   41130 K  |   41130 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug 10 07:08:17 2024]
Finished job 0.
1 of 1 steps (100%) done
