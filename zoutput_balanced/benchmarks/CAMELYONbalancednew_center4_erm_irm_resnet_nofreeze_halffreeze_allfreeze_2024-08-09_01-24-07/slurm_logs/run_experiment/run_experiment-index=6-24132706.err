Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 08:54:45 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706

 Experiment start at: 2024-08-09 09:03:23.501259
before training, model accuracy: 0.6349614262580872
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.971494, 'precision': 0.97152793, 'recall': 0.9714966, 'specificity': 0.9714966, 'f1': 0.9714936, 'auroc': 0.9948963, 'binary_precision': 0.9756777, 'binary_recall': 0.96713096, 'binary_specificity': 0.9758622, 'binary_f1_score': 0.9713856}
confusion matrix:
       0      1
0  24702    611
1    833  24510
---- Validation: 
scalar performance:
{'acc': 0.95894086, 'precision': 0.65912014, 'recall': 0.8121205, 'specificity': 0.8121205, 'f1': 0.70774686, 'auroc': 0.8950612, 'binary_precision': 0.3269461, 'binary_recall': 0.6578313, 'binary_specificity': 0.9664097, 'binary_f1_score': 0.43679997}
confusion matrix:
       0    1
0  16169  562
1    142  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9173423, 'precision': 0.6612873, 'recall': 0.5637132, 'specificity': 0.5637132, 'f1': 0.58459353, 'auroc': 0.8564153, 'binary_precision': 0.38965517, 'binary_recall': 0.14637306, 'binary_specificity': 0.9810533, 'binary_f1_score': 0.21280602}
confusion matrix:
      0    1
0  9165  177
1   659  113
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 09:19:39.416838,epoch time: 0:16:15.915579,used: 0:16:15.915579,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9794101, 'precision': 0.97943425, 'recall': 0.97940826, 'specificity': 0.97940826, 'f1': 0.9794098, 'auroc': 0.99735934, 'binary_precision': 0.9761709, 'binary_recall': 0.9828348, 'binary_specificity': 0.97598165, 'binary_f1_score': 0.9794915}
confusion matrix:
       0      1
0  24706    608
1    435  24907
---- Validation: 
scalar performance:
{'acc': 0.9570745, 'precision': 0.6593225, 'recall': 0.8428874, 'specificity': 0.8428874, 'f1': 0.7133845, 'auroc': 0.9147568, 'binary_precision': 0.3257329, 'binary_recall': 0.72289157, 'binary_specificity': 0.9628833, 'binary_f1_score': 0.44910178}
confusion matrix:
       0    1
0  16110  621
1    115  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9163536, 'precision': 0.66253304, 'recall': 0.57446676, 'specificity': 0.57446676, 'f1': 0.59679323, 'auroc': 0.89328945, 'binary_precision': 0.39053255, 'binary_recall': 0.17098446, 'binary_specificity': 0.977949, 'binary_f1_score': 0.23783787}
confusion matrix:
      0    1
0  9136  206
1   640  132
early stop counter: 1
val acc:0.9570745229721069, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9173423051834106
after epoch: 2,now: 2024-08-09 09:34:43.623209,epoch time: 0:15:04.206371,used: 0:31:20.121950,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96010345, 'precision': 0.96216565, 'recall': 0.9600837, 'specificity': 0.9600837, 'f1': 0.9600577, 'auroc': 0.997735, 'binary_precision': 0.9314415, 'binary_recall': 0.99337095, 'binary_specificity': 0.9267965, 'binary_f1_score': 0.96141}
confusion matrix:
       0      1
0  23460   1853
1    168  25175
---- Validation: 
scalar performance:
{'acc': 0.8908783, 'precision': 0.57689697, 'recall': 0.8547908, 'specificity': 0.8547908, 'f1': 0.6035223, 'auroc': 0.9145347, 'binary_precision': 0.1588566, 'binary_recall': 0.8168675, 'binary_specificity': 0.89271414, 'binary_f1_score': 0.26598665}
confusion matrix:
       0     1
0  14936  1795
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91645247, 'precision': 0.6484701, 'recall': 0.55491346, 'specificity': 0.55491346, 'f1': 0.57289606, 'auroc': 0.882927, 'binary_precision': 0.36531365, 'binary_recall': 0.12823834, 'binary_specificity': 0.98158854, 'binary_f1_score': 0.18983701}
confusion matrix:
      0    1
0  9170  172
1   673   99
early stop counter: 2
val acc:0.8908783197402954, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9173423051834106
after epoch: 3,now: 2024-08-09 09:49:32.893885,epoch time: 0:14:49.270676,used: 0:46:09.392626,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97376424, 'precision': 0.97454464, 'recall': 0.97375387, 'specificity': 0.97375387, 'f1': 0.973753, 'auroc': 0.9984853, 'binary_precision': 0.95542824, 'binary_recall': 0.9939229, 'binary_specificity': 0.95358485, 'binary_f1_score': 0.9742955}
confusion matrix:
       0      1
0  24140   1175
1    154  25187
---- Validation: 
scalar performance:
{'acc': 0.9142657, 'precision': 0.5969913, 'recall': 0.876174, 'specificity': 0.876174, 'f1': 0.63747394, 'auroc': 0.93324494, 'binary_precision': 0.19839908, 'binary_recall': 0.83614457, 'binary_specificity': 0.91620344, 'binary_f1_score': 0.3207024}
confusion matrix:
       0     1
0  15329  1402
1     68   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230769, 'precision': 0.67077625, 'recall': 0.50859106, 'specificity': 0.50859106, 'f1': 0.49853343, 'auroc': 0.89135504, 'binary_precision': 0.41666666, 'binary_recall': 0.019430052, 'binary_specificity': 0.9977521, 'binary_f1_score': 0.037128713}
confusion matrix:
      0   1
0  9321  21
1   757  15
new oracle model saved
early stop counter: 3
val acc:0.9142656922340393, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9230769276618958
after epoch: 4,now: 2024-08-09 10:04:33.204402,epoch time: 0:15:00.310517,used: 1:01:09.703143,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9684144, 'precision': 0.9697509, 'recall': 0.9683987, 'specificity': 0.9683987, 'f1': 0.9683911, 'auroc': 0.9986145, 'binary_precision': 0.94484204, 'binary_recall': 0.9949493, 'binary_specificity': 0.94184804, 'binary_f1_score': 0.9692485}
confusion matrix:
       0      1
0  23841   1472
1    128  25215
---- Validation: 
scalar performance:
{'acc': 0.8955442, 'precision': 0.58175445, 'recall': 0.867756, 'specificity': 0.867756, 'f1': 0.6117717, 'auroc': 0.9227074, 'binary_precision': 0.16795367, 'binary_recall': 0.8385542, 'binary_specificity': 0.89695776, 'binary_f1_score': 0.27985525}
confusion matrix:
       0     1
0  15007  1724
1     67   348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92189044, 'precision': 0.6685011, 'recall': 0.5233966, 'specificity': 0.5233966, 'f1': 0.5266112, 'auroc': 0.8891517, 'binary_precision': 0.41, 'binary_recall': 0.053108808, 'binary_specificity': 0.9936844, 'binary_f1_score': 0.09403669}
confusion matrix:
      0   1
0  9283  59
1   731  41
early stop counter: 4
val acc:0.895544171333313, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9230769276618958
after epoch: 5,now: 2024-08-09 10:19:32.307195,epoch time: 0:14:59.102793,used: 1:16:08.805936,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9669733, 'precision': 0.96853966, 'recall': 0.9669551, 'specificity': 0.9669551, 'f1': 0.96694475, 'auroc': 0.9986737, 'binary_precision': 0.94160664, 'binary_recall': 0.9957386, 'binary_specificity': 0.9381716, 'binary_f1_score': 0.96791637}
confusion matrix:
       0      1
0  23747   1565
1    108  25236
---- Validation: 
scalar performance:
{'acc': 0.8378631, 'precision': 0.5521913, 'recall': 0.821751, 'specificity': 0.821751, 'f1': 0.5518023, 'auroc': 0.8975316, 'binary_precision': 0.11012199, 'binary_recall': 0.8048193, 'binary_specificity': 0.8386827, 'binary_f1_score': 0.1937355}
confusion matrix:
       0     1
0  14032  2699
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9227803, 'precision': 0.6575959, 'recall': 0.5090247, 'specificity': 0.5090247, 'f1': 0.4995669, 'auroc': 0.8837775, 'binary_precision': 0.3902439, 'binary_recall': 0.020725388, 'binary_specificity': 0.99732393, 'binary_f1_score': 0.039360393}
confusion matrix:
      0   1
0  9317  25
1   756  16
early stop counter: 5
val acc:0.8378630876541138, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9230769276618958
after epoch: 6,now: 2024-08-09 10:34:39.887243,epoch time: 0:15:07.580048,used: 1:31:16.385984,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9775742, 'precision': 0.97803533, 'recall': 0.9775657, 'specificity': 0.9775657, 'f1': 0.97756857, 'auroc': 0.998837, 'binary_precision': 0.9633259, 'binary_recall': 0.99297607, 'binary_specificity': 0.96215534, 'binary_f1_score': 0.9779264}
confusion matrix:
       0      1
0  24356    958
1    178  25164
---- Validation: 
scalar performance:
{'acc': 0.93526185, 'precision': 0.5952267, 'recall': 0.7553398, 'specificity': 0.7553398, 'f1': 0.6317679, 'auroc': 0.8849129, 'binary_precision': 0.20171674, 'binary_recall': 0.56626505, 'binary_specificity': 0.94441456, 'binary_f1_score': 0.29746833}
confusion matrix:
       0    1
0  15801  930
1    180  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238679, 'precision': 0.96192646, 'recall': 0.5012953, 'specificity': 0.5012953, 'f1': 0.4827937, 'auroc': 0.85745484, 'binary_precision': 1.0, 'binary_recall': 0.0025906735, 'binary_specificity': 1.0, 'binary_f1_score': 0.005167959}
confusion matrix:
      0  1
0  9342  0
1   770  2
new oracle model saved
early stop counter: 6
val acc:0.9352618455886841, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9238678812980652
after epoch: 7,now: 2024-08-09 10:49:39.697778,epoch time: 0:14:59.810535,used: 1:46:16.196519,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95354944, 'precision': 0.9570185, 'recall': 0.9535203, 'specificity': 0.9535203, 'f1': 0.953459, 'auroc': 0.9985962, 'binary_precision': 0.9173686, 'binary_recall': 0.99696195, 'binary_specificity': 0.91007864, 'binary_f1_score': 0.9555107}
confusion matrix:
       0      1
0  23035   2276
1     77  25268
---- Validation: 
scalar performance:
{'acc': 0.8931529, 'precision': 0.5762264, 'recall': 0.843032, 'specificity': 0.843032, 'f1': 0.6030314, 'auroc': 0.90784866, 'binary_precision': 0.15822479, 'binary_recall': 0.79036146, 'binary_specificity': 0.8957026, 'binary_f1_score': 0.2636656}
confusion matrix:
       0     1
0  14986  1745
1     87   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233735, 'precision': 0.69433016, 'recall': 0.5111282, 'specificity': 0.5111282, 'f1': 0.5034115, 'auroc': 0.8908494, 'binary_precision': 0.46341464, 'binary_recall': 0.024611399, 'binary_specificity': 0.997645, 'binary_f1_score': 0.04674047}
confusion matrix:
      0   1
0  9320  22
1   753  19
early stop counter: 7
val acc:0.8931528925895691, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9238678812980652
after epoch: 8,now: 2024-08-09 11:04:28.930463,epoch time: 0:14:49.232685,used: 2:01:05.429204,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95064753, 'precision': 0.9545938, 'recall': 0.95062363, 'specificity': 0.95062363, 'f1': 0.9505383, 'auroc': 0.9981108, 'binary_precision': 0.91236687, 'binary_recall': 0.9971193, 'binary_specificity': 0.904128, 'binary_f1_score': 0.9528622}
confusion matrix:
       0      1
0  22888   2427
1     73  25268
---- Validation: 
scalar performance:
{'acc': 0.8651581, 'precision': 0.56197304, 'recall': 0.83338714, 'specificity': 0.83338714, 'f1': 0.5746451, 'auroc': 0.89911026, 'binary_precision': 0.12963685, 'binary_recall': 0.8, 'binary_specificity': 0.86677426, 'binary_f1_score': 0.22311828}
confusion matrix:
       0     1
0  14502  2229
1     83   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92406565, 'precision': 0.7337779, 'recall': 0.5156619, 'specificity': 0.5156619, 'f1': 0.51192164, 'auroc': 0.84649456, 'binary_precision': 0.5416667, 'binary_recall': 0.033678755, 'binary_specificity': 0.997645, 'binary_f1_score': 0.063414626}
confusion matrix:
      0   1
0  9320  22
1   746  26
new oracle model saved
early stop counter: 8
val acc:0.8651580810546875, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9240656495094299
after epoch: 9,now: 2024-08-09 11:18:50.652506,epoch time: 0:14:21.722043,used: 2:15:27.151247,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94446856, 'precision': 0.9496162, 'recall': 0.9444349, 'specificity': 0.9444349, 'f1': 0.94430625, 'auroc': 0.99881315, 'binary_precision': 0.9016651, 'binary_recall': 0.99782985, 'binary_specificity': 0.89103985, 'binary_f1_score': 0.94731325}
confusion matrix:
       0      1
0  22554   2758
1     55  25289
---- Validation: 
scalar performance:
{'acc': 0.7779074, 'precision': 0.5359084, 'recall': 0.77340555, 'specificity': 0.77340555, 'f1': 0.50795573, 'auroc': 0.84700036, 'binary_precision': 0.07913669, 'binary_recall': 0.7686747, 'binary_specificity': 0.7781364, 'binary_f1_score': 0.14349978}
confusion matrix:
       0     1
0  13019  3712
1     96   319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91941863, 'precision': 0.59961283, 'recall': 0.5131464, 'specificity': 0.5131464, 'f1': 0.508941, 'auroc': 0.8448725, 'binary_precision': 0.2736842, 'binary_recall': 0.033678755, 'binary_specificity': 0.99261403, 'binary_f1_score': 0.059976928}
confusion matrix:
      0   1
0  9273  69
1   746  26
early stop counter: 9
val acc:0.7779073715209961, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9240656495094299
after epoch: 10,now: 2024-08-09 11:34:04.471280,epoch time: 0:15:13.818774,used: 2:30:40.970021,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94585043, 'precision': 0.9505582, 'recall': 0.94581425, 'specificity': 0.94581425, 'f1': 0.94570553, 'auroc': 0.9987587, 'binary_precision': 0.9046801, 'binary_recall': 0.99680424, 'binary_specificity': 0.8948242, 'binary_f1_score': 0.9485106}
confusion matrix:
       0      1
0  22648   2662
1     81  25265
---- Validation: 
scalar performance:
{'acc': 0.8168086, 'precision': 0.54361826, 'recall': 0.7909887, 'specificity': 0.7909887, 'f1': 0.53251034, 'auroc': 0.86880827, 'binary_precision': 0.09434524, 'binary_recall': 0.7638554, 'binary_specificity': 0.818122, 'binary_f1_score': 0.16794701}
confusion matrix:
       0     1
0  13688  3043
1     98   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92376906, 'precision': 0.96188074, 'recall': 0.50064766, 'specificity': 0.50064766, 'f1': 0.4814787, 'auroc': 0.78262025, 'binary_precision': 1.0, 'binary_recall': 0.0012953368, 'binary_specificity': 1.0, 'binary_f1_score': 0.0025873221}
confusion matrix:
      0  1
0  9342  0
1   771  1
early stop counter: 10
val acc:0.8168085813522339, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9240656495094299
after epoch: 11,now: 2024-08-09 11:49:05.597093,epoch time: 0:15:01.125813,used: 2:45:42.095834,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9355456, 'precision': 0.9425817, 'recall': 0.9355084, 'specificity': 0.9355084, 'f1': 0.9352846, 'auroc': 0.99901116, 'binary_precision': 0.88692605, 'binary_recall': 0.9984611, 'binary_specificity': 0.8725556, 'binary_f1_score': 0.9393945}
confusion matrix:
       0      1
0  22087   3226
1     39  25304
---- Validation: 
scalar performance:
{'acc': 0.67805904, 'precision': 0.52906656, 'recall': 0.77629006, 'specificity': 0.77629006, 'f1': 0.4599762, 'auroc': 0.85710144, 'binary_precision': 0.062553555, 'binary_recall': 0.8795181, 'binary_specificity': 0.67306197, 'binary_f1_score': 0.116799995}
confusion matrix:
       0     1
0  11261  5470
1     50   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92268145, 'precision': 0.6465964, 'recall': 0.5077829, 'specificity': 0.5077829, 'f1': 0.49714798, 'auroc': 0.7833832, 'binary_precision': 0.36842105, 'binary_recall': 0.018134715, 'binary_specificity': 0.997431, 'binary_f1_score': 0.034567904}
confusion matrix:
      0   1
0  9318  24
1   758  14
early stop counter: 11
val acc:0.6780590415000916, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9240656495094299
after epoch: 12,now: 2024-08-09 12:03:56.026122,epoch time: 0:14:50.429029,used: 3:00:32.524863,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9518912, 'precision': 0.9557221, 'recall': 0.95186234, 'specificity': 0.95186234, 'f1': 0.9517877, 'auroc': 0.99900424, 'binary_precision': 0.91409665, 'binary_recall': 0.9975931, 'binary_specificity': 0.9061315, 'binary_f1_score': 0.95402145}
confusion matrix:
       0      1
0  22936   2376
1     61  25283
---- Validation: 
scalar performance:
{'acc': 0.8018197, 'precision': 0.5430366, 'recall': 0.8056321, 'specificity': 0.8056321, 'f1': 0.526338, 'auroc': 0.8703104, 'binary_precision': 0.09192886, 'binary_recall': 0.80963856, 'binary_specificity': 0.8016257, 'binary_f1_score': 0.16511057}
confusion matrix:
       0     1
0  13412  3319
1     79   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92268145, 'precision': 0.6228896, 'recall': 0.5048121, 'specificity': 0.5048121, 'f1': 0.49112436, 'auroc': 0.82854486, 'binary_precision': 0.32142857, 'binary_recall': 0.0116580315, 'binary_specificity': 0.9979662, 'binary_f1_score': 0.022499999}
confusion matrix:
      0   1
0  9323  19
1   763   9
early stop counter: 12
val acc:0.8018196821212769, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9240656495094299
after epoch: 13,now: 2024-08-09 12:18:54.897705,epoch time: 0:14:58.871583,used: 3:15:31.396446,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9386252, 'precision': 0.9450499, 'recall': 0.9385921, 'specificity': 0.9385921, 'f1': 0.93839973, 'auroc': 0.99873257, 'binary_precision': 0.8917157, 'binary_recall': 0.99857944, 'binary_specificity': 0.8786047, 'binary_f1_score': 0.9421269}
confusion matrix:
       0      1
0  22241   3073
1     36  25306
---- Validation: 
scalar performance:
{'acc': 0.8374548, 'precision': 0.54826283, 'recall': 0.7945183, 'specificity': 0.7945183, 'f1': 0.5461072, 'auroc': 0.8708267, 'binary_precision': 0.103874415, 'binary_recall': 0.7493976, 'binary_specificity': 0.839639, 'binary_f1_score': 0.1824582}
confusion matrix:
       0     1
0  14048  2683
1    104   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212972, 'precision': 0.60527515, 'recall': 0.5082218, 'specificity': 0.5082218, 'f1': 0.4988082, 'auroc': 0.7797284, 'binary_precision': 0.2857143, 'binary_recall': 0.020725388, 'binary_specificity': 0.99571824, 'binary_f1_score': 0.038647342}
confusion matrix:
      0   1
0  9302  40
1   756  16
early stop counter: 13
val acc:0.8374547958374023, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9240656495094299
after epoch: 14,now: 2024-08-09 12:33:50.079140,epoch time: 0:14:55.181435,used: 3:30:26.577881,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94381714, 'precision': 0.94920534, 'recall': 0.9437783, 'specificity': 0.9437783, 'f1': 0.94364476, 'auroc': 0.99892783, 'binary_precision': 0.900185, 'binary_recall': 0.99842185, 'binary_specificity': 0.8891347, 'binary_f1_score': 0.946762}
confusion matrix:
       0      1
0  22504   2806
1     40  25306
---- Validation: 
scalar performance:
{'acc': 0.7913799, 'precision': 0.5386697, 'recall': 0.7826588, 'specificity': 0.7826588, 'f1': 0.5166124, 'auroc': 0.85156924, 'binary_precision': 0.08438486, 'binary_recall': 0.773494, 'binary_specificity': 0.79182357, 'binary_f1_score': 0.15216877}
confusion matrix:
       0     1
0  13248  3483
1     94   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9223848, 'precision': 0.6462169, 'recall': 0.50999886, 'specificity': 0.50999886, 'f1': 0.5016998, 'auroc': 0.7925174, 'binary_precision': 0.36734694, 'binary_recall': 0.023316063, 'binary_specificity': 0.99668163, 'binary_f1_score': 0.043848965}
confusion matrix:
      0   1
0  9311  31
1   754  18
early stop counter: 14
val acc:0.7913799285888672, best validation acc: 0.958940863609314, corresponding to test acc:                         0.9173423051834106 / 0.9240656495094299
after epoch: 15,now: 2024-08-09 12:48:46.177619,epoch time: 0:14:56.098479,used: 3:45:22.676360,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_03_23_seed_0_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:45:22.676360 at 2024-08-09 12:48:46.177619
persisted model performance metric: 

scalar performance:
{'acc': 0.9173423, 'precision': 0.6612873, 'recall': 0.5637132, 'specificity': 0.5637132, 'f1': 0.58459353, 'auroc': 0.8564153, 'binary_precision': 0.38965517, 'binary_recall': 0.14637306, 'binary_specificity': 0.9810533, 'binary_f1_score': 0.21280602}
confusion matrix:
      0    1
0  9165  177
1   659  113
oracle model performance metric: 

scalar performance:
{'acc': 0.92406565, 'precision': 0.7337779, 'recall': 0.5156619, 'specificity': 0.5156619, 'f1': 0.51192164, 'auroc': 0.84649456, 'binary_precision': 0.5416667, 'binary_recall': 0.033678755, 'binary_specificity': 0.997645, 'binary_f1_score': 0.063414626}
confusion matrix:
      0   1
0  9320  22
1   746  26
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491246 KiB |  11067 MiB | 650981 GiB | 650980 GiB |
|       from large pool | 400704 KiB |  10993 MiB | 650132 GiB | 650131 GiB |
|       from small pool |  90542 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 491246 KiB |  11067 MiB | 650981 GiB | 650980 GiB |
|       from large pool | 400704 KiB |  10993 MiB | 650132 GiB | 650131 GiB |
|       from small pool |  90542 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476753 KiB |  10961 MiB | 647946 GiB | 647946 GiB |
|       from large pool | 387840 KiB |  10889 MiB | 647107 GiB | 647107 GiB |
|       from small pool |  88913 KiB |    123 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11376 MiB |  11376 MiB |  11376 MiB |      0 B   |
|       from large pool |  11248 MiB |  11248 MiB |  11248 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1362 MiB |   2034 MiB | 212926 GiB | 212925 GiB |
|       from large pool |   1352 MiB |   2031 MiB | 211937 GiB | 211935 GiB |
|       from small pool |      9 MiB |     10 MiB |    989 GiB |    989 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5175    |    7578    |   56055 K  |   56050 K  |
|       from large pool |      87    |     909    |   24283 K  |   24283 K  |
|       from small pool |    5088    |    7489    |   31772 K  |   31767 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5175    |    7578    |   56055 K  |   56050 K  |
|       from large pool |      87    |     909    |   24283 K  |   24283 K  |
|       from small pool |    5088    |    7489    |   31772 K  |   31767 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     236    |     236    |     236    |       0    |
|       from large pool |     172    |     172    |     172    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3199    |   26516 K  |   26516 K  |
|       from large pool |      23    |      62    |    9996 K  |    9996 K  |
|       from small pool |      54    |    3175    |   16520 K  |   16520 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11067 MiB | 650981 GiB | 650981 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 650132 GiB | 650131 GiB |
|       from small pool |      0 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11067 MiB | 650981 GiB | 650981 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 650132 GiB | 650131 GiB |
|       from small pool |      0 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB | 647946 GiB | 647946 GiB |
|       from large pool |  16640 KiB |  10889 MiB | 647107 GiB | 647107 GiB |
|       from small pool |      0 KiB |    123 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1842 MiB |  11376 MiB |  11376 MiB |   9534 MiB |
|       from large pool |   1744 MiB |  11248 MiB |  11248 MiB |   9504 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2034 MiB | 212927 GiB | 212927 GiB |
|       from large pool | 134912 KiB |   2031 MiB | 211937 GiB | 211937 GiB |
|       from small pool |      0 KiB |     28 MiB |    990 GiB |    990 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56055 K  |   56055 K  |
|       from large pool |       2    |     909    |   24283 K  |   24283 K  |
|       from small pool |       0    |    7489    |   31772 K  |   31772 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56055 K  |   56055 K  |
|       from large pool |       2    |     909    |   24283 K  |   24283 K  |
|       from small pool |       0    |    7489    |   31772 K  |   31772 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     236    |     236    |     157    |
|       from large pool |      30    |     172    |     172    |     142    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3199    |   26518 K  |   26518 K  |
|       from large pool |       4    |      62    |    9996 K  |    9996 K  |
|       from small pool |       0    |    3175    |   16522 K  |   16522 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11067 MiB | 650981 GiB | 650981 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 650132 GiB | 650131 GiB |
|       from small pool |      0 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11067 MiB | 650981 GiB | 650981 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 650132 GiB | 650131 GiB |
|       from small pool |      0 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB | 647946 GiB | 647946 GiB |
|       from large pool |  16640 KiB |  10889 MiB | 647107 GiB | 647107 GiB |
|       from small pool |      0 KiB |    123 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1842 MiB |  11376 MiB |  11376 MiB |   9534 MiB |
|       from large pool |   1744 MiB |  11248 MiB |  11248 MiB |   9504 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2034 MiB | 212927 GiB | 212927 GiB |
|       from large pool | 134912 KiB |   2031 MiB | 211937 GiB | 211937 GiB |
|       from small pool |      0 KiB |     28 MiB |    990 GiB |    990 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56055 K  |   56055 K  |
|       from large pool |       2    |     909    |   24283 K  |   24283 K  |
|       from small pool |       0    |    7489    |   31772 K  |   31772 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56055 K  |   56055 K  |
|       from large pool |       2    |     909    |   24283 K  |   24283 K  |
|       from small pool |       0    |    7489    |   31772 K  |   31772 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     236    |     236    |     157    |
|       from large pool |      30    |     172    |     172    |     142    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3199    |   26518 K  |   26518 K  |
|       from large pool |       4    |      62    |    9996 K  |    9996 K  |
|       from small pool |       0    |    3175    |   16522 K  |   16522 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706

 Experiment start at: 2024-08-09 13:06:47.680613
before training, model accuracy: 0.20513328909873962
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95449716, 'precision': 0.9552741, 'recall': 0.954481, 'specificity': 0.954481, 'f1': 0.9544766, 'auroc': 0.9934977, 'binary_precision': 0.936662, 'binary_recall': 0.9749961, 'binary_specificity': 0.933966, 'binary_f1_score': 0.95544475}
confusion matrix:
       0      1
0  23719   1677
1    636  24800
---- Validation: 
scalar performance:
{'acc': 0.8858261, 'precision': 0.5676586, 'recall': 0.80130184, 'specificity': 0.80130184, 'f1': 0.58864343, 'auroc': 0.85313797, 'binary_precision': 0.14359215, 'binary_recall': 0.71229696, 'binary_specificity': 0.8903067, 'binary_f1_score': 0.23900352}
confusion matrix:
       0     1
0  14861  1831
1    124   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92032504, 'precision': 0.7258119, 'recall': 0.8112674, 'specificity': 0.8112674, 'f1': 0.7593695, 'auroc': 0.90239966, 'binary_precision': 0.47826087, 'binary_recall': 0.682959, 'binary_specificity': 0.93957573, 'binary_f1_score': 0.56256807}
confusion matrix:
      0    1
0  8770  564
1   240  517
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 13:22:29.572178,epoch time: 0:15:41.891565,used: 0:15:41.891565,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96033996, 'precision': 0.96160525, 'recall': 0.9603205, 'specificity': 0.9603205, 'f1': 0.96031153, 'auroc': 0.9964835, 'binary_precision': 0.9376238, 'binary_recall': 0.9863574, 'binary_specificity': 0.93428355, 'binary_f1_score': 0.9613734}
confusion matrix:
       0      1
0  23728   1669
1    347  25088
---- Validation: 
scalar performance:
{'acc': 0.9222099, 'precision': 0.6007086, 'recall': 0.83691555, 'specificity': 0.83691555, 'f1': 0.6423171, 'auroc': 0.88003, 'binary_precision': 0.20841424, 'binary_recall': 0.74709976, 'binary_specificity': 0.92673135, 'binary_f1_score': 0.32591093}
confusion matrix:
       0     1
0  15469  1223
1    109   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210187, 'precision': 0.6821198, 'recall': 0.57129633, 'specificity': 0.57129633, 'f1': 0.59564114, 'auroc': 0.8866112, 'binary_precision': 0.429078, 'binary_recall': 0.15984148, 'binary_specificity': 0.98275125, 'binary_f1_score': 0.23291625}
confusion matrix:
      0    1
0  9173  161
1   636  121
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 13:37:19.343867,epoch time: 0:14:49.771689,used: 0:30:31.663254,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9521561, 'precision': 0.9549661, 'recall': 0.95212376, 'specificity': 0.95212376, 'f1': 0.9520797, 'auroc': 0.99601674, 'binary_precision': 0.9194166, 'binary_recall': 0.99127257, 'binary_specificity': 0.912975, 'binary_f1_score': 0.95399344}
confusion matrix:
       0      1
0  23185   2210
1    222  25215
---- Validation: 
scalar performance:
{'acc': 0.87216026, 'precision': 0.5657204, 'recall': 0.8259364, 'specificity': 0.8259364, 'f1': 0.5823027, 'auroc': 0.88056695, 'binary_precision': 0.13797364, 'binary_recall': 0.77726215, 'binary_specificity': 0.8746106, 'binary_f1_score': 0.23434767}
confusion matrix:
       0     1
0  14599  2093
1     96   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92161334, 'precision': 0.6381316, 'recall': 0.52184916, 'specificity': 0.52184916, 'f1': 0.5244008, 'auroc': 0.894734, 'binary_precision': 0.3482143, 'binary_recall': 0.051519156, 'binary_specificity': 0.99217916, 'binary_f1_score': 0.08975835}
confusion matrix:
      0   1
0  9261  73
1   718  39
new oracle model saved
early stop counter: 1
val acc:0.8721602559089661, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.921613335609436
after epoch: 3,now: 2024-08-09 13:52:02.022638,epoch time: 0:14:42.678771,used: 0:45:14.342025,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9788519, 'precision': 0.9790925, 'recall': 0.97884405, 'specificity': 0.97884405, 'f1': 0.978849, 'auroc': 0.9982842, 'binary_precision': 0.9685324, 'binary_recall': 0.9898954, 'binary_specificity': 0.96779275, 'binary_f1_score': 0.9790974}
confusion matrix:
       0      1
0  24580    818
1    257  25177
---- Validation: 
scalar performance:
{'acc': 0.8995503, 'precision': 0.58333576, 'recall': 0.8456358, 'specificity': 0.8456358, 'f1': 0.61466175, 'auroc': 0.8994703, 'binary_precision': 0.17267649, 'binary_recall': 0.7888631, 'binary_specificity': 0.90240836, 'binary_f1_score': 0.28333333}
confusion matrix:
       0     1
0  15063  1629
1     91   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92468536, 'precision': 0.6054216, 'recall': 0.50105315, 'specificity': 0.50105315, 'f1': 0.48304835, 'auroc': 0.8966249, 'binary_precision': 0.2857143, 'binary_recall': 0.002642008, 'binary_specificity': 0.99946433, 'binary_f1_score': 0.005235602}
confusion matrix:
      0  1
0  9329  5
1   755  2
new oracle model saved
early stop counter: 2
val acc:0.8995503187179565, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9246853590011597
after epoch: 4,now: 2024-08-09 14:07:10.840482,epoch time: 0:15:08.817844,used: 1:00:23.159869,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95481193, 'precision': 0.9577994, 'recall': 0.95478344, 'specificity': 0.95478344, 'f1': 0.95473605, 'auroc': 0.99764216, 'binary_precision': 0.9209942, 'binary_recall': 0.995046, 'binary_specificity': 0.9145208, 'binary_f1_score': 0.9565891}
confusion matrix:
       0      1
0  23227   2171
1    126  25308
---- Validation: 
scalar performance:
{'acc': 0.8231034, 'precision': 0.5507526, 'recall': 0.82224727, 'specificity': 0.82224727, 'f1': 0.5450873, 'auroc': 0.8901992, 'binary_precision': 0.10707804, 'binary_recall': 0.8213457, 'binary_specificity': 0.8231488, 'binary_f1_score': 0.18945678}
confusion matrix:
       0     1
0  13740  2952
1     77   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92458624, 'precision': 0.46247646, 'recall': 0.49978572, 'specificity': 0.49978572, 'f1': 0.48040783, 'auroc': 0.88006794, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99957144, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9330  4
1   757  0
early stop counter: 3
val acc:0.8231034278869629, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9246853590011597
after epoch: 5,now: 2024-08-09 14:22:06.845319,epoch time: 0:14:56.004837,used: 1:15:19.164706,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9577038, 'precision': 0.9596683, 'recall': 0.95767695, 'specificity': 0.95767695, 'f1': 0.95765674, 'auroc': 0.99602735, 'binary_precision': 0.92982394, 'binary_recall': 0.9902111, 'binary_specificity': 0.92514277, 'binary_f1_score': 0.9590679}
confusion matrix:
       0      1
0  23494   1901
1    249  25188
---- Validation: 
scalar performance:
{'acc': 0.89680547, 'precision': 0.56353575, 'recall': 0.74929625, 'specificity': 0.74929625, 'f1': 0.5846921, 'auroc': 0.8544364, 'binary_precision': 0.13852814, 'binary_recall': 0.5939675, 'binary_specificity': 0.904625, 'binary_f1_score': 0.22465992}
confusion matrix:
       0     1
0  15100  1592
1    175   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.8728604, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
new oracle model saved
early stop counter: 4
val acc:0.896805465221405, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9249826669692993
after epoch: 6,now: 2024-08-09 14:36:53.503545,epoch time: 0:14:46.658226,used: 1:30:05.822932,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9216832, 'precision': 0.931353, 'recall': 0.92162436, 'specificity': 0.92162436, 'f1': 0.92123437, 'auroc': 0.9959376, 'binary_precision': 0.8669654, 'binary_recall': 0.9963831, 'binary_specificity': 0.84686565, 'binary_f1_score': 0.92717993}
confusion matrix:
       0      1
0  21507   3889
1     92  25344
---- Validation: 
scalar performance:
{'acc': 0.7070023, 'precision': 0.5314123, 'recall': 0.77399915, 'specificity': 0.77399915, 'f1': 0.475345, 'auroc': 0.8448596, 'binary_precision': 0.068498306, 'binary_recall': 0.84454757, 'binary_specificity': 0.70345074, 'binary_f1_score': 0.12671888}
confusion matrix:
       0     1
0  11742  4950
1     67   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.8687051, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 5
val acc:0.7070022821426392, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9249826669692993
after epoch: 7,now: 2024-08-09 14:51:36.168198,epoch time: 0:14:42.664653,used: 1:44:48.487585,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9144437, 'precision': 0.92650944, 'recall': 0.91438085, 'specificity': 0.91438085, 'f1': 0.9138255, 'auroc': 0.9950489, 'binary_precision': 0.85495925, 'binary_recall': 0.99838805, 'binary_specificity': 0.83037364, 'binary_f1_score': 0.9211237}
confusion matrix:
       0      1
0  21089   4308
1     41  25394
---- Validation: 
scalar performance:
{'acc': 0.65940547, 'precision': 0.52862924, 'recall': 0.7687986, 'specificity': 0.7687986, 'f1': 0.4523263, 'auroc': 0.84258395, 'binary_precision': 0.06182054, 'binary_recall': 0.8839907, 'binary_specificity': 0.65360653, 'binary_f1_score': 0.11555959}
confusion matrix:
       0     1
0  10910  5782
1     50   381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.85169387, 'recall': 0.50451636, 'specificity': 0.50451636, 'f1': 0.4897729, 'auroc': 0.8893151, 'binary_precision': 0.7777778, 'binary_recall': 0.009247027, 'binary_specificity': 0.9997857, 'binary_f1_score': 0.018276762}
confusion matrix:
      0  1
0  9332  2
1   750  7
new oracle model saved
early stop counter: 6
val acc:0.6594054698944092, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9254781603813171
after epoch: 8,now: 2024-08-09 15:06:29.889850,epoch time: 0:14:53.721652,used: 1:59:42.209237,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93142116, 'precision': 0.93903494, 'recall': 0.93136686, 'specificity': 0.93136686, 'f1': 0.9311166, 'auroc': 0.99548864, 'binary_precision': 0.88142484, 'binary_recall': 0.9970909, 'binary_specificity': 0.86564285, 'binary_f1_score': 0.9356969}
confusion matrix:
       0      1
0  21983   3412
1     74  25363
---- Validation: 
scalar performance:
{'acc': 0.7918005, 'precision': 0.54360056, 'recall': 0.8095821, 'specificity': 0.8095821, 'f1': 0.5239486, 'auroc': 0.86676955, 'binary_precision': 0.092775464, 'binary_recall': 0.82830626, 'binary_specificity': 0.7908579, 'binary_f1_score': 0.1668614}
confusion matrix:
       0     1
0  13201  3491
1     74   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92518085, 'precision': 0.962583, 'recall': 0.501321, 'specificity': 0.501321, 'f1': 0.4831993, 'auroc': 0.8540516, 'binary_precision': 1.0, 'binary_recall': 0.002642008, 'binary_specificity': 1.0, 'binary_f1_score': 0.0052700923}
confusion matrix:
      0  1
0  9334  0
1   755  2
early stop counter: 7
val acc:0.7918004989624023, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9254781603813171
after epoch: 9,now: 2024-08-09 15:21:27.563865,epoch time: 0:14:57.674015,used: 2:14:39.883252,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9249489, 'precision': 0.93418556, 'recall': 0.92489445, 'specificity': 0.92489445, 'f1': 0.924541, 'auroc': 0.99559784, 'binary_precision': 0.87104416, 'binary_recall': 0.9977197, 'binary_specificity': 0.85206914, 'binary_f1_score': 0.93008846}
confusion matrix:
       0      1
0  21640   3757
1     58  25377
---- Validation: 
scalar performance:
{'acc': 0.76248324, 'precision': 0.53732777, 'recall': 0.78776413, 'specificity': 0.78776413, 'f1': 0.50461435, 'auroc': 0.84874, 'binary_precision': 0.080912866, 'binary_recall': 0.8143852, 'binary_specificity': 0.7611431, 'binary_f1_score': 0.14720067}
confusion matrix:
       0     1
0  12705  3987
1     80   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92537904, 'precision': 0.75850946, 'recall': 0.50810444, 'specificity': 0.50810444, 'f1': 0.49728382, 'auroc': 0.88615507, 'binary_precision': 0.59090906, 'binary_recall': 0.017173052, 'binary_specificity': 0.9990358, 'binary_f1_score': 0.033376124}
confusion matrix:
      0   1
0  9325   9
1   744  13
early stop counter: 8
val acc:0.7624832391738892, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9254781603813171
after epoch: 10,now: 2024-08-09 15:35:50.285577,epoch time: 0:14:22.721712,used: 2:29:02.604964,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.93240476, 'precision': 0.93994355, 'recall': 0.9323508, 'specificity': 0.9323508, 'f1': 0.9321081, 'auroc': 0.9973247, 'binary_precision': 0.88255954, 'binary_recall': 0.99768054, 'binary_specificity': 0.8670211, 'binary_f1_score': 0.9365958}
confusion matrix:
       0      1
0  22018   3377
1     59  25378
---- Validation: 
scalar performance:
{'acc': 0.7565847, 'precision': 0.53771615, 'recall': 0.79604006, 'specificity': 0.79604006, 'f1': 0.5028335, 'auroc': 0.8630949, 'binary_precision': 0.08095986, 'binary_recall': 0.837587, 'binary_specificity': 0.7544932, 'binary_f1_score': 0.14764826}
confusion matrix:
       0     1
0  12594  4098
1     70   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.87109977, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 9
val acc:0.7565847039222717, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9254781603813171
after epoch: 11,now: 2024-08-09 15:50:47.991815,epoch time: 0:14:57.706238,used: 2:44:00.311202,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9643925, 'precision': 0.9663514, 'recall': 0.96436715, 'specificity': 0.96436715, 'f1': 0.9643537, 'auroc': 0.99838984, 'binary_precision': 0.9363227, 'binary_recall': 0.996619, 'binary_specificity': 0.9321153, 'binary_f1_score': 0.9655304}
confusion matrix:
       0      1
0  23672   1724
1     86  25350
---- Validation: 
scalar performance:
{'acc': 0.8802196, 'precision': 0.56317246, 'recall': 0.7905153, 'specificity': 0.7905153, 'f1': 0.58070713, 'auroc': 0.8758852, 'binary_precision': 0.13513513, 'binary_recall': 0.6960557, 'binary_specificity': 0.88497484, 'binary_f1_score': 0.22632968}
confusion matrix:
       0     1
0  14772  1920
1    131   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.89514345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 10
val acc:0.880219578742981, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9254781603813171
after epoch: 12,now: 2024-08-09 16:05:46.862468,epoch time: 0:14:58.870653,used: 2:58:59.181855,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8701212, 'precision': 0.8966849, 'recall': 0.87002444, 'specificity': 0.87002444, 'f1': 0.86788857, 'auroc': 0.99691105, 'binary_precision': 0.7942197, 'binary_recall': 0.99937093, 'binary_specificity': 0.740678, 'binary_f1_score': 0.8850627}
confusion matrix:
       0      1
0  18811   6586
1     16  25419
---- Validation: 
scalar performance:
{'acc': 0.46574783, 'precision': 0.51954395, 'recall': 0.6965929, 'specificity': 0.6965929, 'f1': 0.35234737, 'auroc': 0.872221, 'binary_precision': 0.04251076, 'binary_recall': 0.93967515, 'binary_specificity': 0.45351067, 'binary_f1_score': 0.08134163}
confusion matrix:
      0     1
0  7570  9122
1    26   405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92518085, 'precision': 0.7215159, 'recall': 0.5207429, 'specificity': 0.5207429, 'f1': 0.52181226, 'auroc': 0.837207, 'binary_precision': 0.5151515, 'binary_recall': 0.044914134, 'binary_specificity': 0.99657166, 'binary_f1_score': 0.08262455}
confusion matrix:
      0   1
0  9302  32
1   723  34
early stop counter: 11
val acc:0.4657478332519531, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9254781603813171
after epoch: 13,now: 2024-08-09 16:20:50.557337,epoch time: 0:15:03.694869,used: 3:14:02.876724,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90407616, 'precision': 0.9192059, 'recall': 0.9039978, 'specificity': 0.9039978, 'f1': 0.9031905, 'auroc': 0.9962064, 'binary_precision': 0.83977264, 'binary_recall': 0.9988992, 'binary_specificity': 0.8090963, 'binary_f1_score': 0.91245013}
confusion matrix:
       0      1
0  20547   4848
1     28  25409
---- Validation: 
scalar performance:
{'acc': 0.6732465, 'precision': 0.52979594, 'recall': 0.7747677, 'specificity': 0.7747677, 'f1': 0.45949426, 'auroc': 0.83772576, 'binary_precision': 0.06414585, 'binary_recall': 0.88167053, 'binary_specificity': 0.66786486, 'binary_f1_score': 0.11959088}
confusion matrix:
       0     1
0  11148  5544
1     51   380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9229016, 'precision': 0.6534696, 'recall': 0.5189039, 'specificity': 0.5189039, 'f1': 0.51898366, 'auroc': 0.85861623, 'binary_precision': 0.37931034, 'binary_recall': 0.04359313, 'binary_specificity': 0.9942147, 'binary_f1_score': 0.07819905}
confusion matrix:
      0   1
0  9280  54
1   724  33
early stop counter: 12
val acc:0.6732465028762817, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9254781603813171
after epoch: 14,now: 2024-08-09 16:35:46.066003,epoch time: 0:14:55.508666,used: 3:28:58.385390,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8911119, 'precision': 0.91028595, 'recall': 0.89103115, 'specificity': 0.89103115, 'f1': 0.8898101, 'auroc': 0.9961952, 'binary_precision': 0.8217774, 'binary_recall': 0.9990564, 'binary_specificity': 0.7830059, 'binary_f1_score': 0.9017868}
confusion matrix:
       0      1
0  19886   5511
1     24  25411
---- Validation: 
scalar performance:
{'acc': 0.6552006, 'precision': 0.52848893, 'recall': 0.7689022, 'specificity': 0.7689022, 'f1': 0.4503717, 'auroc': 0.8449085, 'binary_precision': 0.06138804, 'binary_recall': 0.8886311, 'binary_specificity': 0.64917326, 'binary_f1_score': 0.11484258}
confusion matrix:
       0     1
0  10836  5856
1     48   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236944, 'precision': 0.6757363, 'recall': 0.5211533, 'specificity': 0.5211533, 'f1': 0.5228484, 'auroc': 0.89224625, 'binary_precision': 0.42352942, 'binary_recall': 0.047556143, 'binary_specificity': 0.9947504, 'binary_f1_score': 0.08551069}
confusion matrix:
      0   1
0  9285  49
1   721  36
early stop counter: 13
val acc:0.6552006006240845, best validation acc: 0.9222099184989929, corresponding to test acc:                         0.9210187196731567 / 0.9254781603813171
after epoch: 15,now: 2024-08-09 16:50:47.301307,epoch time: 0:15:01.235304,used: 3:43:59.620694,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_06_47_seed_1_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:43:59.620694 at 2024-08-09 16:50:47.301307
persisted model performance metric: 

scalar performance:
{'acc': 0.9210187, 'precision': 0.6821198, 'recall': 0.57129633, 'specificity': 0.57129633, 'f1': 0.59564114, 'auroc': 0.8866112, 'binary_precision': 0.429078, 'binary_recall': 0.15984148, 'binary_specificity': 0.98275125, 'binary_f1_score': 0.23291625}
confusion matrix:
      0    1
0  9173  161
1   636  121
oracle model performance metric: 

scalar performance:
{'acc': 0.92547816, 'precision': 0.85169387, 'recall': 0.50451636, 'specificity': 0.50451636, 'f1': 0.4897729, 'auroc': 0.8893151, 'binary_precision': 0.7777778, 'binary_recall': 0.009247027, 'binary_specificity': 0.9997857, 'binary_f1_score': 0.018276762}
confusion matrix:
      0  1
0  9332  2
1   750  7
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496616 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool | 406080 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |  90536 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496616 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool | 406080 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |  90536 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10961 MiB |   1274 TiB |   1274 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1272 TiB |   1272 TiB |
|       from small pool |  88912 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11368 MiB |  11376 MiB |  20902 MiB |   9534 MiB |
|       from large pool |  11242 MiB |  11248 MiB |  20746 MiB |   9504 MiB |
|       from small pool |    126 MiB |    128 MiB |    156 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1015 MiB |   2228 MiB | 453524 GiB | 453523 GiB |
|       from large pool |   1007 MiB |   2225 MiB | 451506 GiB | 451505 GiB |
|       from small pool |      7 MiB |     28 MiB |   2017 GiB |   2017 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7600    |  112765 K  |  112760 K  |
|       from large pool |      87    |     909    |   48921 K  |   48920 K  |
|       from small pool |    5076    |    7511    |   63844 K  |   63839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7600    |  112765 K  |  112760 K  |
|       from large pool |      87    |     909    |   48921 K  |   48920 K  |
|       from small pool |    5076    |    7511    |   63844 K  |   63839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     233    |     236    |     390    |     157    |
|       from large pool |     170    |     172    |     312    |     142    |
|       from small pool |      63    |      64    |      78    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3206    |   57805 K  |   57805 K  |
|       from large pool |      18    |      62    |   24587 K  |   24587 K  |
|       from small pool |      50    |    3187    |   33217 K  |   33217 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1274 TiB |   1274 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1272 TiB |   1272 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1500 MiB |  11376 MiB |  20902 MiB |  19402 MiB |
|       from large pool |   1404 MiB |  11248 MiB |  20746 MiB |  19342 MiB |
|       from small pool |     96 MiB |    128 MiB |    156 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2228 MiB | 453524 GiB | 453524 GiB |
|       from large pool | 134912 KiB |   2225 MiB | 451506 GiB | 451506 GiB |
|       from small pool |      0 KiB |     29 MiB |   2017 GiB |   2017 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  112765 K  |  112765 K  |
|       from large pool |       2    |     909    |   48921 K  |   48921 K  |
|       from small pool |       0    |    7511    |   63844 K  |   63844 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  112765 K  |  112765 K  |
|       from large pool |       2    |     909    |   48921 K  |   48921 K  |
|       from small pool |       0    |    7511    |   63844 K  |   63844 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     236    |     390    |     310    |
|       from large pool |      32    |     172    |     312    |     280    |
|       from small pool |      48    |      64    |      78    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3206    |   57807 K  |   57807 K  |
|       from large pool |       4    |      62    |   24587 K  |   24587 K  |
|       from small pool |       0    |    3187    |   33219 K  |   33219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1274 TiB |   1274 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1272 TiB |   1272 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1500 MiB |  11376 MiB |  20902 MiB |  19402 MiB |
|       from large pool |   1404 MiB |  11248 MiB |  20746 MiB |  19342 MiB |
|       from small pool |     96 MiB |    128 MiB |    156 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2228 MiB | 453524 GiB | 453524 GiB |
|       from large pool | 134912 KiB |   2225 MiB | 451506 GiB | 451506 GiB |
|       from small pool |      0 KiB |     29 MiB |   2017 GiB |   2017 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  112765 K  |  112765 K  |
|       from large pool |       2    |     909    |   48921 K  |   48921 K  |
|       from small pool |       0    |    7511    |   63844 K  |   63844 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  112765 K  |  112765 K  |
|       from large pool |       2    |     909    |   48921 K  |   48921 K  |
|       from small pool |       0    |    7511    |   63844 K  |   63844 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     236    |     390    |     310    |
|       from large pool |      32    |     172    |     312    |     280    |
|       from small pool |      48    |      64    |      78    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3206    |   57807 K  |   57807 K  |
|       from large pool |       4    |      62    |   24587 K  |   24587 K  |
|       from small pool |       0    |    3187    |   33219 K  |   33219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706

 Experiment start at: 2024-08-09 17:09:11.708730
before training, model accuracy: 0.10671819001436234
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95877826, 'precision': 0.9599523, 'recall': 0.9587763, 'specificity': 0.9587763, 'f1': 0.9587518, 'auroc': 0.99505055, 'binary_precision': 0.93673354, 'binary_recall': 0.9840232, 'binary_specificity': 0.9335294, 'binary_f1_score': 0.9597962}
confusion matrix:
       0      1
0  24128   1718
1    413  25437
---- Validation: 
scalar performance:
{'acc': 0.90755665, 'precision': 0.5845969, 'recall': 0.833665, 'specificity': 0.833665, 'f1': 0.6179548, 'auroc': 0.88939667, 'binary_precision': 0.17584863, 'binary_recall': 0.75598085, 'binary_specificity': 0.91134924, 'binary_f1_score': 0.28532735}
confusion matrix:
       0     1
0  15225  1481
1    102   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9088387, 'precision': 0.70380473, 'recall': 0.76754534, 'specificity': 0.76754534, 'f1': 0.7296718, 'auroc': 0.8686731, 'binary_precision': 0.4430028, 'binary_recall': 0.5997491, 'binary_specificity': 0.9353416, 'binary_f1_score': 0.50959486}
confusion matrix:
      0    1
0  8694  601
1   319  478
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 17:25:27.439102,epoch time: 0:16:15.730372,used: 0:16:15.730372,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97425336, 'precision': 0.9745803, 'recall': 0.9742518, 'specificity': 0.9742518, 'f1': 0.9742488, 'auroc': 0.99758697, 'binary_precision': 0.9621532, 'binary_recall': 0.9873506, 'binary_specificity': 0.96115303, 'binary_f1_score': 0.97458905}
confusion matrix:
       0      1
0  24841   1004
1    327  25524
---- Validation: 
scalar performance:
{'acc': 0.9299813, 'precision': 0.6069702, 'recall': 0.8369942, 'specificity': 0.8369942, 'f1': 0.6515751, 'auroc': 0.9058561, 'binary_precision': 0.22087204, 'binary_recall': 0.73923445, 'binary_specificity': 0.93475395, 'binary_f1_score': 0.34012106}
confusion matrix:
       0     1
0  15616  1090
1    109   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.921522, 'precision': 0.7223238, 'recall': 0.6138339, 'specificity': 0.6138339, 'f1': 0.64582014, 'auroc': 0.87300915, 'binary_precision': 0.50639385, 'binary_recall': 0.24843162, 'binary_specificity': 0.9792361, 'binary_f1_score': 0.33333334}
confusion matrix:
      0    1
0  9102  193
1   599  198
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 17:40:57.619832,epoch time: 0:15:30.180730,used: 0:31:45.911102,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96403974, 'precision': 0.9654933, 'recall': 0.9640366, 'specificity': 0.9640366, 'f1': 0.96401155, 'auroc': 0.9978347, 'binary_precision': 0.9395105, 'binary_recall': 0.9919539, 'binary_specificity': 0.9361192, 'binary_f1_score': 0.9650203}
confusion matrix:
       0      1
0  24194   1651
1    208  25643
---- Validation: 
scalar performance:
{'acc': 0.9189442, 'precision': 0.5944542, 'recall': 0.8348363, 'specificity': 0.8348363, 'f1': 0.63354087, 'auroc': 0.90572137, 'binary_precision': 0.19573401, 'binary_recall': 0.7464115, 'binary_specificity': 0.9232611, 'binary_f1_score': 0.31013918}
confusion matrix:
       0     1
0  15424  1282
1    106   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9179548, 'precision': 0.68817264, 'recall': 0.5700275, 'specificity': 0.5700275, 'f1': 0.59428686, 'auroc': 0.8798171, 'binary_precision': 0.44483986, 'binary_recall': 0.15683815, 'binary_specificity': 0.98321676, 'binary_f1_score': 0.23191096}
confusion matrix:
      0    1
0  9139  156
1   672  125
early stop counter: 1
val acc:0.9189441800117493, best validation acc: 0.9299812912940979, corresponding to test acc:                         0.9215220212936401 / 0.9215220212936401
after epoch: 3,now: 2024-08-09 17:56:28.820650,epoch time: 0:15:31.200818,used: 0:47:17.111920,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98260987, 'precision': 0.9827819, 'recall': 0.9826077, 'specificity': 0.9826077, 'f1': 0.98260826, 'auroc': 0.9987922, 'binary_precision': 0.97372717, 'binary_recall': 0.9919935, 'binary_specificity': 0.9732219, 'binary_f1_score': 0.98277545}
confusion matrix:
       0      1
0  25150    692
1    207  25647
---- Validation: 
scalar performance:
{'acc': 0.9364634, 'precision': 0.614865, 'recall': 0.83215266, 'specificity': 0.83215266, 'f1': 0.6617773, 'auroc': 0.907363, 'binary_precision': 0.23704867, 'binary_recall': 0.72248805, 'binary_specificity': 0.9418173, 'binary_f1_score': 0.35697398}
confusion matrix:
       0    1
0  15734  972
1    116  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91745937, 'precision': 0.6834605, 'recall': 0.5680378, 'specificity': 0.5680378, 'f1': 0.59147936, 'auroc': 0.88728285, 'binary_precision': 0.43571427, 'binary_recall': 0.15307403, 'binary_specificity': 0.9830016, 'binary_f1_score': 0.22655526}
confusion matrix:
      0    1
0  9137  158
1   675  122
better model found
persisted
after epoch: 4,now: 2024-08-09 18:12:07.443977,epoch time: 0:15:38.623327,used: 1:02:55.735247,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97771585, 'precision': 0.97809184, 'recall': 0.97771263, 'specificity': 0.97771263, 'f1': 0.9777114, 'auroc': 0.99856484, 'binary_precision': 0.9647426, 'binary_recall': 0.9916841, 'binary_specificity': 0.9637412, 'binary_f1_score': 0.9780279}
confusion matrix:
       0      1
0  24905    937
1    215  25639
---- Validation: 
scalar performance:
{'acc': 0.93809855, 'precision': 0.61463326, 'recall': 0.8189958, 'specificity': 0.8189958, 'f1': 0.66057557, 'auroc': 0.9016342, 'binary_precision': 0.23731588, 'binary_recall': 0.6937799, 'binary_specificity': 0.94421166, 'binary_f1_score': 0.35365853}
confusion matrix:
       0    1
0  15774  932
1    128  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9208284, 'precision': 0.6606725, 'recall': 0.50218666, 'specificity': 0.50218666, 'f1': 0.48433942, 'auroc': 0.837126, 'binary_precision': 0.4, 'binary_recall': 0.0050188205, 'binary_specificity': 0.9993545, 'binary_f1_score': 0.009913258}
confusion matrix:
      0  1
0  9289  6
1   793  4
better model found
persisted
after epoch: 5,now: 2024-08-09 18:27:32.169892,epoch time: 0:15:24.725915,used: 1:18:20.461162,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9559734, 'precision': 0.958856, 'recall': 0.9559642, 'specificity': 0.9559642, 'f1': 0.9559035, 'auroc': 0.99822986, 'binary_precision': 0.9225448, 'binary_recall': 0.99555194, 'binary_specificity': 0.9163764, 'binary_f1_score': 0.9576589}
confusion matrix:
       0      1
0  23681   2161
1    115  25739
---- Validation: 
scalar performance:
{'acc': 0.8653936, 'precision': 0.56212187, 'recall': 0.8307159, 'specificity': 0.8307159, 'f1': 0.5749764, 'auroc': 0.8965558, 'binary_precision': 0.13014504, 'binary_recall': 0.79425836, 'binary_specificity': 0.8671735, 'binary_f1_score': 0.22364432}
confusion matrix:
       0     1
0  14487  2219
1     86   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9208284, 'precision': 0.70427346, 'recall': 0.51824635, 'specificity': 0.51824635, 'f1': 0.51640296, 'auroc': 0.8332256, 'binary_precision': 0.4848485, 'binary_recall': 0.040150564, 'binary_specificity': 0.9963421, 'binary_f1_score': 0.074159905}
confusion matrix:
      0   1
0  9261  34
1   765  32
early stop counter: 1
val acc:0.8653935790061951, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9215220212936401
after epoch: 6,now: 2024-08-09 18:42:48.147109,epoch time: 0:15:15.977217,used: 1:33:36.438379,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9383125, 'precision': 0.9443156, 'recall': 0.9382945, 'specificity': 0.9382945, 'f1': 0.93810165, 'auroc': 0.9981992, 'binary_precision': 0.892747, 'binary_recall': 0.9963645, 'binary_specificity': 0.88022447, 'binary_f1_score': 0.941714}
confusion matrix:
       0      1
0  22745   3095
1     94  25762
---- Validation: 
scalar performance:
{'acc': 0.8051857, 'precision': 0.5443651, 'recall': 0.80918866, 'specificity': 0.80918866, 'f1': 0.529488, 'auroc': 0.8793938, 'binary_precision': 0.09449694, 'binary_recall': 0.8133971, 'binary_specificity': 0.8049802, 'binary_f1_score': 0.16932271}
confusion matrix:
       0     1
0  13448  3258
1     78   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92043203, 'precision': 0.6483661, 'recall': 0.5048393, 'specificity': 0.5048393, 'f1': 0.49022684, 'auroc': 0.83155906, 'binary_precision': 0.375, 'binary_recall': 0.011292347, 'binary_specificity': 0.9983862, 'binary_f1_score': 0.021924485}
confusion matrix:
      0   1
0  9280  15
1   788   9
early stop counter: 2
val acc:0.8051856756210327, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9215220212936401
after epoch: 7,now: 2024-08-09 18:58:05.066702,epoch time: 0:15:16.919593,used: 1:48:53.357972,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9494545, 'precision': 0.95363164, 'recall': 0.94944894, 'specificity': 0.94944894, 'f1': 0.9493375, 'auroc': 0.99886036, 'binary_precision': 0.9101306, 'binary_recall': 0.9974082, 'binary_specificity': 0.9014897, 'binary_f1_score': 0.95177275}
confusion matrix:
       0      1
0  23299   2546
1     67  25784
---- Validation: 
scalar performance:
{'acc': 0.8437281, 'precision': 0.55626875, 'recall': 0.83710575, 'specificity': 0.83710575, 'f1': 0.5596355, 'auroc': 0.90088654, 'binary_precision': 0.11754742, 'binary_recall': 0.8301435, 'binary_specificity': 0.844068, 'binary_f1_score': 0.2059347}
confusion matrix:
       0     1
0  14101  2605
1     71   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221165, 'precision': 0.8213092, 'recall': 0.5109158, 'specificity': 0.5109158, 'f1': 0.5016003, 'auroc': 0.85879403, 'binary_precision': 0.72, 'binary_recall': 0.022584694, 'binary_specificity': 0.9992469, 'binary_f1_score': 0.043795623}
confusion matrix:
      0   1
0  9288   7
1   779  18
new oracle model saved
early stop counter: 3
val acc:0.8437281250953674, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9221165180206299
after epoch: 8,now: 2024-08-09 19:13:46.004746,epoch time: 0:15:40.938044,used: 2:04:34.296016,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9327801, 'precision': 0.9402349, 'recall': 0.932765, 'specificity': 0.932765, 'f1': 0.93249273, 'auroc': 0.9986235, 'binary_precision': 0.8830053, 'binary_recall': 0.9977953, 'binary_specificity': 0.8677347, 'binary_f1_score': 0.9368974}
confusion matrix:
       0      1
0  22424   3418
1     57  25797
---- Validation: 
scalar performance:
{'acc': 0.72880167, 'precision': 0.53540576, 'recall': 0.8061946, 'specificity': 0.8061946, 'f1': 0.48843047, 'auroc': 0.89453584, 'binary_precision': 0.07467794, 'binary_recall': 0.88755983, 'binary_specificity': 0.7248294, 'binary_f1_score': 0.13776457}
confusion matrix:
       0     1
0  12109  4597
1     47   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92132384, 'precision': 0.72636306, 'recall': 0.51564753, 'specificity': 0.51564753, 'f1': 0.51130795, 'auroc': 0.8271783, 'binary_precision': 0.5294118, 'binary_recall': 0.033877037, 'binary_specificity': 0.997418, 'binary_f1_score': 0.06367925}
confusion matrix:
      0   1
0  9271  24
1   770  27
early stop counter: 4
val acc:0.7288016676902771, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9221165180206299
after epoch: 9,now: 2024-08-09 19:29:16.620006,epoch time: 0:15:30.615260,used: 2:20:04.911276,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.93324435, 'precision': 0.94057167, 'recall': 0.93324184, 'specificity': 0.93324184, 'f1': 0.9329654, 'auroc': 0.9984004, 'binary_precision': 0.88376397, 'binary_recall': 0.9977175, 'binary_specificity': 0.8687662, 'binary_f1_score': 0.9372899}
confusion matrix:
       0      1
0  22455   3392
1     59  25790
---- Validation: 
scalar performance:
{'acc': 0.83496845, 'precision': 0.55032426, 'recall': 0.81045777, 'specificity': 0.81045777, 'f1': 0.5482714, 'auroc': 0.87932, 'binary_precision': 0.10704961, 'binary_recall': 0.784689, 'binary_specificity': 0.8362265, 'binary_f1_score': 0.18839747}
confusion matrix:
       0     1
0  13970  2736
1     90   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.921522, 'precision': 0.745196, 'recall': 0.5123137, 'specificity': 0.5123137, 'f1': 0.5047147, 'auroc': 0.82262987, 'binary_precision': 0.5675676, 'binary_recall': 0.026348809, 'binary_specificity': 0.9982786, 'binary_f1_score': 0.05035971}
confusion matrix:
      0   1
0  9279  16
1   776  21
early stop counter: 5
val acc:0.8349684476852417, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9221165180206299
after epoch: 10,now: 2024-08-09 19:44:30.512161,epoch time: 0:15:13.892155,used: 2:35:18.803431,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9636142, 'precision': 0.9655498, 'recall': 0.9636042, 'specificity': 0.9636042, 'f1': 0.96357584, 'auroc': 0.9987879, 'binary_precision': 0.93560815, 'binary_recall': 0.99578434, 'binary_specificity': 0.93142414, 'binary_f1_score': 0.9647588}
confusion matrix:
       0      1
0  24068   1772
1    109  25747
---- Validation: 
scalar performance:
{'acc': 0.8799346, 'precision': 0.5671274, 'recall': 0.8253397, 'specificity': 0.8253397, 'f1': 0.58639383, 'auroc': 0.8968342, 'binary_precision': 0.14078948, 'binary_recall': 0.7679426, 'binary_specificity': 0.88273674, 'binary_f1_score': 0.23795405}
confusion matrix:
       0     1
0  14747  1959
1     97   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92132384, 'precision': 0.860692, 'recall': 0.5024556, 'specificity': 0.5024556, 'f1': 0.48450464, 'auroc': 0.7956714, 'binary_precision': 0.8, 'binary_recall': 0.0050188205, 'binary_specificity': 0.9998924, 'binary_f1_score': 0.009975062}
confusion matrix:
      0  1
0  9294  1
1   793  4
early stop counter: 6
val acc:0.8799346089363098, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9221165180206299
after epoch: 11,now: 2024-08-09 19:59:37.615744,epoch time: 0:15:07.103583,used: 2:50:25.907014,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.89637494, 'precision': 0.9138, 'recall': 0.896363, 'specificity': 0.896363, 'f1': 0.89527047, 'auroc': 0.9974831, 'binary_precision': 0.8289144, 'binary_recall': 0.99895555, 'binary_specificity': 0.79377055, 'binary_f1_score': 0.9060258}
confusion matrix:
       0      1
0  20515   5330
1     27  25824
---- Validation: 
scalar performance:
{'acc': 0.74474424, 'precision': 0.53619003, 'recall': 0.8015367, 'specificity': 0.8015367, 'f1': 0.49575675, 'auroc': 0.8666889, 'binary_precision': 0.0770383, 'binary_recall': 0.861244, 'binary_specificity': 0.7418293, 'binary_f1_score': 0.14142604}
confusion matrix:
       0     1
0  12393  4313
1     58   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9206302, 'precision': 0.70090145, 'recall': 0.52387434, 'specificity': 0.52387434, 'f1': 0.52670527, 'auroc': 0.86076355, 'binary_precision': 0.47727272, 'binary_recall': 0.052697618, 'binary_specificity': 0.9950511, 'binary_f1_score': 0.094915256}
confusion matrix:
      0   1
0  9249  46
1   755  42
early stop counter: 7
val acc:0.7447442412376404, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9221165180206299
after epoch: 12,now: 2024-08-09 20:14:46.235744,epoch time: 0:15:08.620000,used: 3:05:34.527014,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.90051454, 'precision': 0.9165495, 'recall': 0.9004918, 'specificity': 0.9004918, 'f1': 0.8995441, 'auroc': 0.99827135, 'binary_precision': 0.8348802, 'binary_recall': 0.9985689, 'binary_specificity': 0.80241466, 'binary_f1_score': 0.90941757}
confusion matrix:
       0      1
0  20736   5106
1     37  25817
---- Validation: 
scalar performance:
{'acc': 0.69411355, 'precision': 0.5331261, 'recall': 0.8059102, 'specificity': 0.8059102, 'f1': 0.47147894, 'auroc': 0.88889766, 'binary_precision': 0.06902718, 'binary_recall': 0.923445, 'binary_specificity': 0.6883754, 'binary_f1_score': 0.12845257}
confusion matrix:
       0     1
0  11500  5206
1     32   386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9201348, 'precision': 0.6129446, 'recall': 0.5035308, 'specificity': 0.5035308, 'f1': 0.48772475, 'auroc': 0.85488766, 'binary_precision': 0.3043478, 'binary_recall': 0.008782936, 'binary_specificity': 0.9982786, 'binary_f1_score': 0.017073171}
confusion matrix:
      0   1
0  9279  16
1   790   7
early stop counter: 8
val acc:0.694113552570343, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9221165180206299
after epoch: 13,now: 2024-08-09 20:29:53.653608,epoch time: 0:15:07.417864,used: 3:20:41.944878,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93523675, 'precision': 0.942294, 'recall': 0.93521965, 'specificity': 0.93521965, 'f1': 0.9349756, 'auroc': 0.99894226, 'binary_precision': 0.88649243, 'binary_recall': 0.99833685, 'binary_specificity': 0.8721025, 'binary_f1_score': 0.9390963}
confusion matrix:
       0      1
0  22536   3305
1     43  25812
---- Validation: 
scalar performance:
{'acc': 0.8287783, 'precision': 0.5505837, 'recall': 0.82244635, 'specificity': 0.82244635, 'f1': 0.54649997, 'auroc': 0.8940058, 'binary_precision': 0.10669587, 'binary_recall': 0.81578946, 'binary_specificity': 0.8291033, 'binary_f1_score': 0.18871056}
confusion matrix:
       0     1
0  13851  2855
1     77   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92132384, 'precision': 0.7685515, 'recall': 0.50474983, 'specificity': 0.50474983, 'f1': 0.48938516, 'auroc': 0.8982637, 'binary_precision': 0.61538464, 'binary_recall': 0.010037641, 'binary_specificity': 0.99946207, 'binary_f1_score': 0.019753085}
confusion matrix:
      0  1
0  9290  5
1   789  8
early stop counter: 9
val acc:0.8287783265113831, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9221165180206299
after epoch: 14,now: 2024-08-09 20:45:02.377976,epoch time: 0:15:08.724368,used: 3:35:50.669246,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92980117, 'precision': 0.93793523, 'recall': 0.9297906, 'specificity': 0.9297906, 'f1': 0.92947245, 'auroc': 0.99866545, 'binary_precision': 0.8782896, 'binary_recall': 0.9979112, 'binary_specificity': 0.86167, 'binary_f1_score': 0.934287}
confusion matrix:
       0      1
0  22269   3575
1     54  25798
---- Validation: 
scalar performance:
{'acc': 0.78054196, 'precision': 0.5376133, 'recall': 0.78256357, 'specificity': 0.78256357, 'f1': 0.51132715, 'auroc': 0.8507686, 'binary_precision': 0.082082085, 'binary_recall': 0.784689, 'binary_specificity': 0.7804382, 'binary_f1_score': 0.14861804}
confusion matrix:
       0     1
0  13038  3668
1     90   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92043203, 'precision': 0.66099185, 'recall': 0.50655997, 'specificity': 0.50655997, 'f1': 0.49376842, 'auroc': 0.85357666, 'binary_precision': 0.4, 'binary_recall': 0.015056462, 'binary_specificity': 0.9980635, 'binary_f1_score': 0.029020557}
confusion matrix:
      0   1
0  9277  18
1   785  12
early stop counter: 10
val acc:0.7805419564247131, best validation acc: 0.9380985498428345, corresponding to test acc:                         0.9208284020423889 / 0.9221165180206299
after epoch: 15,now: 2024-08-09 21:00:22.333726,epoch time: 0:15:19.955750,used: 3:51:10.624996,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_17_09_11_seed_2_24132706
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:51:10.624996 at 2024-08-09 21:00:22.333726
persisted model performance metric: 

scalar performance:
{'acc': 0.9208284, 'precision': 0.6606725, 'recall': 0.50218666, 'specificity': 0.50218666, 'f1': 0.48433942, 'auroc': 0.837126, 'binary_precision': 0.4, 'binary_recall': 0.0050188205, 'binary_specificity': 0.9993545, 'binary_f1_score': 0.009913258}
confusion matrix:
      0  1
0  9289  6
1   793  4
oracle model performance metric: 

scalar performance:
{'acc': 0.9221165, 'precision': 0.8213092, 'recall': 0.5109158, 'specificity': 0.5109158, 'f1': 0.5016003, 'auroc': 0.85879403, 'binary_precision': 0.72, 'binary_recall': 0.022584694, 'binary_specificity': 0.9992469, 'binary_f1_score': 0.043795623}
confusion matrix:
      0   1
0  9288   7
1   779  18
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496488 KiB |  11071 MiB |   1951 TiB |   1951 TiB |
|       from large pool | 405952 KiB |  10997 MiB |   1948 TiB |   1948 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496488 KiB |  11071 MiB |   1951 TiB |   1951 TiB |
|       from large pool | 405952 KiB |  10997 MiB |   1948 TiB |   1948 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10961 MiB |   1941 TiB |   1941 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1938 TiB |   1938 TiB |
|       from small pool |  88912 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11232 MiB |  11376 MiB |  30634 MiB |  19402 MiB |
|       from large pool |  11106 MiB |  11248 MiB |  30448 MiB |  19342 MiB |
|       from small pool |    126 MiB |    128 MiB |    186 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1235 MiB |   2514 MiB | 644707 GiB | 644706 GiB |
|       from large pool |   1227 MiB |   2511 MiB | 641601 GiB | 641600 GiB |
|       from small pool |      7 MiB |     29 MiB |   3105 GiB |   3105 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7708    |  171474 K  |  171469 K  |
|       from large pool |      87    |     909    |   74600 K  |   74600 K  |
|       from small pool |    5076    |    7619    |   96874 K  |   96869 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7708    |  171474 K  |  171469 K  |
|       from large pool |      87    |     909    |   74600 K  |   74600 K  |
|       from small pool |    5076    |    7619    |   96874 K  |   96869 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     236    |     544    |     310    |
|       from large pool |     171    |     172    |     451    |     280    |
|       from small pool |      63    |      64    |      93    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3262    |   89619 K  |   89619 K  |
|       from large pool |      21    |      62    |   39135 K  |   39135 K  |
|       from small pool |      50    |    3240    |   50484 K  |   50484 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1951 TiB |   1951 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1948 TiB |   1948 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1951 TiB |   1951 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1948 TiB |   1948 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1941 TiB |   1941 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1938 TiB |   1938 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1720 MiB |  11376 MiB |  30634 MiB |  28914 MiB |
|       from large pool |   1624 MiB |  11248 MiB |  30448 MiB |  28824 MiB |
|       from small pool |     96 MiB |    128 MiB |    186 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2514 MiB | 644708 GiB | 644708 GiB |
|       from large pool | 134912 KiB |   2511 MiB | 641602 GiB | 641602 GiB |
|       from small pool |      0 KiB |     29 MiB |   3105 GiB |   3105 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7708    |  171474 K  |  171474 K  |
|       from large pool |       2    |     909    |   74600 K  |   74600 K  |
|       from small pool |       0    |    7619    |   96874 K  |   96874 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7708    |  171474 K  |  171474 K  |
|       from large pool |       2    |     909    |   74600 K  |   74600 K  |
|       from small pool |       0    |    7619    |   96874 K  |   96874 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     236    |     544    |     463    |
|       from large pool |      33    |     172    |     451    |     418    |
|       from small pool |      48    |      64    |      93    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3262    |   89621 K  |   89621 K  |
|       from large pool |       4    |      62    |   39135 K  |   39135 K  |
|       from small pool |       0    |    3240    |   50486 K  |   50486 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 21:12:00 2024]
Finished job 0.
1 of 1 steps (100%) done
