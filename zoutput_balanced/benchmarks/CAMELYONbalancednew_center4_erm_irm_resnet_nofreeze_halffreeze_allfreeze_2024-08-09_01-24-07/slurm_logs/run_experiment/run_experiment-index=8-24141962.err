Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 11:59:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962

 Experiment start at: 2024-08-10 12:07:49.006871
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9635976, 'precision': 0.9636611, 'recall': 0.96359444, 'specificity': 0.96359444, 'f1': 0.96359617, 'auroc': 0.9942194, 'binary_precision': 0.95837235, 'binary_recall': 0.96933943, 'binary_specificity': 0.9578494, 'binary_f1_score': 0.9638247}
confusion matrix:
       0      1
0  24247   1067
1    777  24565
---- Validation: 
scalar performance:
{'acc': 0.9570162, 'precision': 0.6521603, 'recall': 0.8076095, 'specificity': 0.8076095, 'f1': 0.7002715, 'auroc': 0.8899355, 'binary_precision': 0.31322506, 'binary_recall': 0.6506024, 'binary_specificity': 0.9646166, 'binary_f1_score': 0.42286608}
confusion matrix:
       0    1
0  16139  592
1    145  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9147716, 'precision': 0.67220193, 'recall': 0.60866505, 'specificity': 0.60866505, 'f1': 0.6308336, 'auroc': 0.86441654, 'binary_precision': 0.40466103, 'binary_recall': 0.24740933, 'binary_specificity': 0.9699208, 'binary_f1_score': 0.30707398}
confusion matrix:
      0    1
0  9061  281
1   581  191
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 12:24:18.010928,epoch time: 0:16:29.004057,used: 0:16:29.004057,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9790351, 'precision': 0.97913086, 'recall': 0.9790385, 'specificity': 0.9790385, 'f1': 0.97903407, 'auroc': 0.996808, 'binary_precision': 0.9860266, 'binary_recall': 0.9718627, 'binary_specificity': 0.9862143, 'binary_f1_score': 0.97889334}
confusion matrix:
       0      1
0  24967    349
1    713  24627
---- Validation: 
scalar performance:
{'acc': 0.9736382, 'precision': 0.7288104, 'recall': 0.80555224, 'specificity': 0.80555224, 'f1': 0.761184, 'auroc': 0.9129524, 'binary_precision': 0.46690518, 'binary_recall': 0.62891567, 'binary_specificity': 0.98218876, 'binary_f1_score': 0.53593427}
confusion matrix:
       0    1
0  16433  298
1    154  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9159581, 'precision': 0.6385428, 'recall': 0.5481102, 'specificity': 0.5481102, 'f1': 0.56363684, 'auroc': 0.87870836, 'binary_precision': 0.3464567, 'binary_recall': 0.11398964, 'binary_specificity': 0.9822308, 'binary_f1_score': 0.17153995}
confusion matrix:
      0    1
0  9176  166
1   684   88
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 12:39:52.882748,epoch time: 0:15:34.871820,used: 0:32:03.875877,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9811079, 'precision': 0.98110795, 'recall': 0.9811078, 'specificity': 0.9811078, 'f1': 0.98110783, 'auroc': 0.997759, 'binary_precision': 0.9809847, 'binary_recall': 0.98125565, 'binary_specificity': 0.9809599, 'binary_f1_score': 0.98112017}
confusion matrix:
       0      1
0  24833    482
1    475  24866
---- Validation: 
scalar performance:
{'acc': 0.96354836, 'precision': 0.6793247, 'recall': 0.8321054, 'specificity': 0.8321054, 'f1': 0.7303566, 'auroc': 0.9149823, 'binary_precision': 0.36641222, 'binary_recall': 0.6939759, 'binary_specificity': 0.9702349, 'binary_f1_score': 0.47960037}
confusion matrix:
       0    1
0  16233  498
1    127  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91714454, 'precision': 0.6489553, 'recall': 0.5505349, 'specificity': 0.5505349, 'f1': 0.5674018, 'auroc': 0.8886968, 'binary_precision': 0.3669355, 'binary_recall': 0.11787565, 'binary_specificity': 0.9831942, 'binary_f1_score': 0.17843138}
confusion matrix:
      0    1
0  9185  157
1   681   91
new oracle model saved
early stop counter: 1
val acc:0.9635483622550964, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9171445369720459
after epoch: 3,now: 2024-08-10 12:55:21.973630,epoch time: 0:15:29.090882,used: 0:47:32.966759,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96251184, 'precision': 0.964396, 'recall': 0.9624893, 'specificity': 0.9624893, 'f1': 0.96247244, 'auroc': 0.9981955, 'binary_precision': 0.93499315, 'binary_recall': 0.9942003, 'binary_specificity': 0.9307783, 'binary_f1_score': 0.96368814}
confusion matrix:
       0      1
0  23558   1752
1    147  25199
---- Validation: 
scalar performance:
{'acc': 0.88726234, 'precision': 0.5759707, 'recall': 0.8611625, 'specificity': 0.8611625, 'f1': 0.6012888, 'auroc': 0.91830057, 'binary_precision': 0.15656109, 'binary_recall': 0.8337349, 'binary_specificity': 0.88859004, 'binary_f1_score': 0.26361907}
confusion matrix:
       0     1
0  14867  1864
1     69   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9187265, 'precision': 0.6719526, 'recall': 0.56565076, 'specificity': 0.56565076, 'f1': 0.5878825, 'auroc': 0.88391405, 'binary_precision': 0.4107143, 'binary_recall': 0.14896373, 'binary_specificity': 0.98233783, 'binary_f1_score': 0.21863118}
confusion matrix:
      0    1
0  9177  165
1   657  115
new oracle model saved
early stop counter: 2
val acc:0.8872623443603516, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9187265038490295
after epoch: 4,now: 2024-08-10 13:10:47.267525,epoch time: 0:15:25.293895,used: 1:02:58.260654,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96511763, 'precision': 0.9665095, 'recall': 0.9651026, 'specificity': 0.9651026, 'f1': 0.96509075, 'auroc': 0.99818206, 'binary_precision': 0.94116545, 'binary_recall': 0.9923053, 'binary_specificity': 0.93789995, 'binary_f1_score': 0.966059}
confusion matrix:
       0      1
0  23742   1572
1    195  25147
---- Validation: 
scalar performance:
{'acc': 0.8951359, 'precision': 0.58050257, 'recall': 0.8616721, 'specificity': 0.8616721, 'f1': 0.6098204, 'auroc': 0.9201871, 'binary_precision': 0.16578057, 'binary_recall': 0.826506, 'binary_specificity': 0.8968382, 'binary_f1_score': 0.27616748}
confusion matrix:
       0     1
0  15005  1726
1     72   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91576034, 'precision': 0.65464675, 'recall': 0.56761, 'specificity': 0.56761, 'f1': 0.58833927, 'auroc': 0.8783101, 'binary_precision': 0.3757764, 'binary_recall': 0.15673575, 'binary_specificity': 0.9784843, 'binary_f1_score': 0.22120656}
confusion matrix:
      0    1
0  9141  201
1   651  121
early stop counter: 3
val acc:0.8951358795166016, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9187265038490295
after epoch: 5,now: 2024-08-10 13:26:18.079145,epoch time: 0:15:30.811620,used: 1:18:29.072274,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95662904, 'precision': 0.9593251, 'recall': 0.9566109, 'specificity': 0.9566109, 'f1': 0.95656407, 'auroc': 0.9981086, 'binary_precision': 0.924253, 'binary_recall': 0.9948303, 'binary_specificity': 0.9183915, 'binary_f1_score': 0.95824385}
confusion matrix:
       0      1
0  23250   2066
1    131  25209
---- Validation: 
scalar performance:
{'acc': 0.8887204, 'precision': 0.57630056, 'recall': 0.8583848, 'specificity': 0.8583848, 'f1': 0.6021317, 'auroc': 0.91356707, 'binary_precision': 0.15741165, 'binary_recall': 0.826506, 'binary_specificity': 0.89026356, 'binary_f1_score': 0.26445645}
confusion matrix:
       0     1
0  14895  1836
1     72   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92070395, 'precision': 0.64117134, 'recall': 0.52037776, 'specificity': 0.52037776, 'f1': 0.5215161, 'auroc': 0.8714487, 'binary_precision': 0.35576922, 'binary_recall': 0.04792746, 'binary_specificity': 0.9928281, 'binary_f1_score': 0.084474884}
confusion matrix:
      0   1
0  9275  67
1   735  37
new oracle model saved
early stop counter: 4
val acc:0.8887203931808472, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9207039475440979
after epoch: 6,now: 2024-08-10 13:41:40.386299,epoch time: 0:15:22.307154,used: 1:33:51.379428,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9790351, 'precision': 0.97954345, 'recall': 0.97902614, 'specificity': 0.97902614, 'f1': 0.9790293, 'auroc': 0.9991167, 'binary_precision': 0.9640673, 'binary_recall': 0.99518585, 'binary_specificity': 0.9628664, 'binary_f1_score': 0.9793795}
confusion matrix:
       0      1
0  24374    940
1    122  25220
---- Validation: 
scalar performance:
{'acc': 0.9283798, 'precision': 0.60842496, 'recall': 0.85873246, 'specificity': 0.85873246, 'f1': 0.65446067, 'auroc': 0.92243207, 'binary_precision': 0.2225256, 'binary_recall': 0.7855422, 'binary_specificity': 0.9319228, 'binary_f1_score': 0.3468085}
confusion matrix:
       0     1
0  15592  1139
1     89   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92297804, 'precision': 0.694353, 'recall': 0.5245795, 'specificity': 0.5245795, 'f1': 0.52855384, 'auroc': 0.88663244, 'binary_precision': 0.46153846, 'binary_recall': 0.054404143, 'binary_specificity': 0.99475485, 'binary_f1_score': 0.09733487}
confusion matrix:
      0   1
0  9293  49
1   730  42
new oracle model saved
early stop counter: 5
val acc:0.9283797740936279, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9229780435562134
after epoch: 7,now: 2024-08-10 13:57:07.688256,epoch time: 0:15:27.301957,used: 1:49:18.681385,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9694804, 'precision': 0.9704906, 'recall': 0.9694695, 'specificity': 0.9694695, 'f1': 0.9694636, 'auroc': 0.9984125, 'binary_precision': 0.9488079, 'binary_recall': 0.99254143, 'binary_specificity': 0.94639754, 'binary_f1_score': 0.9701821}
confusion matrix:
       0      1
0  23959   1357
1    189  25151
---- Validation: 
scalar performance:
{'acc': 0.94109416, 'precision': 0.61622626, 'recall': 0.8076755, 'specificity': 0.8076755, 'f1': 0.66167974, 'auroc': 0.90604377, 'binary_precision': 0.2410792, 'binary_recall': 0.66746986, 'binary_specificity': 0.94788116, 'binary_f1_score': 0.35421994}
confusion matrix:
       0    1
0  15859  872
1    138  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92396677, 'precision': 0.7367543, 'recall': 0.51026106, 'specificity': 0.51026106, 'f1': 0.50137657, 'auroc': 0.8682146, 'binary_precision': 0.5483871, 'binary_recall': 0.022020726, 'binary_specificity': 0.9985014, 'binary_f1_score': 0.042341225}
confusion matrix:
      0   1
0  9328  14
1   755  17
new oracle model saved
early stop counter: 6
val acc:0.941094160079956, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9239667654037476
after epoch: 8,now: 2024-08-10 14:12:34.056285,epoch time: 0:15:26.368029,used: 2:04:45.049414,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9685526, 'precision': 0.9700248, 'recall': 0.9685372, 'specificity': 0.9685372, 'f1': 0.9685272, 'auroc': 0.99893737, 'binary_precision': 0.9438568, 'binary_recall': 0.9964091, 'binary_specificity': 0.94066525, 'binary_f1_score': 0.9694212}
confusion matrix:
       0      1
0  23812   1502
1     91  25251
---- Validation: 
scalar performance:
{'acc': 0.8865041, 'precision': 0.5724662, 'recall': 0.84197503, 'specificity': 0.84197503, 'f1': 0.5959233, 'auroc': 0.90071803, 'binary_precision': 0.15061615, 'binary_recall': 0.79518074, 'binary_specificity': 0.8887693, 'binary_f1_score': 0.2532617}
confusion matrix:
       0     1
0  14870  1861
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92268145, 'precision': 0.6582068, 'recall': 0.51015943, 'specificity': 0.51015943, 'f1': 0.5018607, 'auroc': 0.8714894, 'binary_precision': 0.39130434, 'binary_recall': 0.023316063, 'binary_specificity': 0.9970028, 'binary_f1_score': 0.044009782}
confusion matrix:
      0   1
0  9314  28
1   754  18
early stop counter: 7
val acc:0.8865041136741638, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9239667654037476
after epoch: 9,now: 2024-08-10 14:28:03.547086,epoch time: 0:15:29.490801,used: 2:20:14.540215,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9664995, 'precision': 0.9681502, 'recall': 0.96648204, 'specificity': 0.96648204, 'f1': 0.96646905, 'auroc': 0.99889207, 'binary_precision': 0.94049925, 'binary_recall': 0.9960541, 'binary_specificity': 0.9369099, 'binary_f1_score': 0.9674798}
confusion matrix:
       0      1
0  23716   1597
1    100  25243
---- Validation: 
scalar performance:
{'acc': 0.88522106, 'precision': 0.5670318, 'recall': 0.8131192, 'specificity': 0.8131192, 'f1': 0.5875754, 'auroc': 0.89431185, 'binary_precision': 0.1413395, 'binary_recall': 0.7373494, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.2372093}
confusion matrix:
       0     1
0  14872  1859
1    109   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234724, 'precision': 0.7013474, 'recall': 0.51237005, 'specificity': 0.51237005, 'f1': 0.5057992, 'auroc': 0.87405527, 'binary_precision': 0.47727272, 'binary_recall': 0.027202072, 'binary_specificity': 0.99753803, 'binary_f1_score': 0.051470585}
confusion matrix:
      0   1
0  9319  23
1   751  21
early stop counter: 8
val acc:0.8852210640907288, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9239667654037476
after epoch: 10,now: 2024-08-10 14:43:30.057811,epoch time: 0:15:26.510725,used: 2:35:41.050940,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9655717, 'precision': 0.9674357, 'recall': 0.96555185, 'specificity': 0.96555185, 'f1': 0.96553624, 'auroc': 0.9990902, 'binary_precision': 0.9380754, 'binary_recall': 0.9970013, 'binary_specificity': 0.9341024, 'binary_f1_score': 0.9666411}
confusion matrix:
       0      1
0  23644   1668
1     76  25268
---- Validation: 
scalar performance:
{'acc': 0.8807885, 'precision': 0.5705379, 'recall': 0.84727085, 'specificity': 0.84727085, 'f1': 0.59161985, 'auroc': 0.908441, 'binary_precision': 0.14633088, 'binary_recall': 0.8120482, 'binary_specificity': 0.88249356, 'binary_f1_score': 0.24797645}
confusion matrix:
       0     1
0  14765  1966
1     78   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92406565, 'precision': 0.8371017, 'recall': 0.50377893, 'specificity': 0.50377893, 'f1': 0.48794734, 'auroc': 0.8360888, 'binary_precision': 0.75, 'binary_recall': 0.0077720205, 'binary_specificity': 0.9997859, 'binary_f1_score': 0.0153846145}
confusion matrix:
      0  1
0  9340  2
1   766  6
new oracle model saved
early stop counter: 9
val acc:0.8807885050773621, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9240656495094299
after epoch: 11,now: 2024-08-10 14:59:03.478935,epoch time: 0:15:33.421124,used: 2:51:14.472064,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9541417, 'precision': 0.95769536, 'recall': 0.9541156, 'specificity': 0.9541156, 'f1': 0.95405066, 'auroc': 0.9986056, 'binary_precision': 0.9175131, 'binary_recall': 0.99806654, 'binary_specificity': 0.9101647, 'binary_f1_score': 0.9560962}
confusion matrix:
       0      1
0  23039   2274
1     49  25294
---- Validation: 
scalar performance:
{'acc': 0.88370466, 'precision': 0.5696938, 'recall': 0.83349097, 'specificity': 0.83349097, 'f1': 0.5911336, 'auroc': 0.9005079, 'binary_precision': 0.1454872, 'binary_recall': 0.7807229, 'binary_specificity': 0.886259, 'binary_f1_score': 0.24526875}
confusion matrix:
       0     1
0  14828  1903
1     91   324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92436224, 'precision': 0.7429131, 'recall': 0.5199815, 'specificity': 0.5199815, 'f1': 0.5199917, 'auroc': 0.8678528, 'binary_precision': 0.55932206, 'binary_recall': 0.042746115, 'binary_specificity': 0.9972169, 'binary_f1_score': 0.079422385}
confusion matrix:
      0   1
0  9316  26
1   739  33
new oracle model saved
early stop counter: 10
val acc:0.883704662322998, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9243622422218323
after epoch: 12,now: 2024-08-10 15:14:40.199837,epoch time: 0:15:36.720902,used: 3:06:51.192966,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.958919, 'precision': 0.9615377, 'recall': 0.95889676, 'specificity': 0.95889676, 'f1': 0.9588592, 'auroc': 0.9987035, 'binary_precision': 0.9269197, 'binary_recall': 0.9964487, 'binary_specificity': 0.92134476, 'binary_f1_score': 0.9604274}
confusion matrix:
       0      1
0  23322   1991
1     90  25253
---- Validation: 
scalar performance:
{'acc': 0.8708737, 'precision': 0.55957216, 'recall': 0.8045926, 'specificity': 0.8045926, 'f1': 0.5728242, 'auroc': 0.88759136, 'binary_precision': 0.12660855, 'binary_recall': 0.73493975, 'binary_specificity': 0.8742454, 'binary_f1_score': 0.21600567}
confusion matrix:
       0     1
0  14627  2104
1    110   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9244611, 'precision': 0.77520585, 'recall': 0.5123111, 'specificity': 0.5123111, 'f1': 0.5052092, 'auroc': 0.84637177, 'binary_precision': 0.625, 'binary_recall': 0.025906736, 'binary_specificity': 0.99871546, 'binary_f1_score': 0.049751244}
confusion matrix:
      0   1
0  9330  12
1   752  20
new oracle model saved
early stop counter: 11
val acc:0.8708736896514893, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9244611263275146
after epoch: 13,now: 2024-08-10 15:30:16.159621,epoch time: 0:15:35.959784,used: 3:22:27.152750,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95187145, 'precision': 0.9556078, 'recall': 0.9518411, 'specificity': 0.9518411, 'f1': 0.9517703, 'auroc': 0.9985701, 'binary_precision': 0.9145163, 'binary_recall': 0.9970014, 'binary_specificity': 0.9066809, 'binary_f1_score': 0.9539792}
confusion matrix:
       0      1
0  22949   2362
1     76  25269
---- Validation: 
scalar performance:
{'acc': 0.8866791, 'precision': 0.56318927, 'recall': 0.78684276, 'specificity': 0.78684276, 'f1': 0.5822273, 'auroc': 0.8837141, 'binary_precision': 0.13514805, 'binary_recall': 0.68192774, 'binary_specificity': 0.8917578, 'binary_f1_score': 0.22558789}
confusion matrix:
       0     1
0  14920  1811
1    132   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92011076, 'precision': 0.6329502, 'recall': 0.5206508, 'specificity': 0.5206508, 'f1': 0.5221014, 'auroc': 0.79060227, 'binary_precision': 0.3392857, 'binary_recall': 0.049222797, 'binary_specificity': 0.9920788, 'binary_f1_score': 0.08597285}
confusion matrix:
      0   1
0  9268  74
1   734  38
early stop counter: 12
val acc:0.8866791129112244, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9244611263275146
after epoch: 14,now: 2024-08-10 15:45:49.101467,epoch time: 0:15:32.941846,used: 3:38:00.094596,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96511763, 'precision': 0.9671084, 'recall': 0.9650997, 'specificity': 0.9650997, 'f1': 0.9650794, 'auroc': 0.9991287, 'binary_precision': 0.936752, 'binary_recall': 0.9976324, 'binary_specificity': 0.93256694, 'binary_f1_score': 0.96623415}
confusion matrix:
       0      1
0  23607   1707
1     60  25282
---- Validation: 
scalar performance:
{'acc': 0.87180686, 'precision': 0.56056553, 'recall': 0.80859554, 'specificity': 0.80859554, 'f1': 0.5745395, 'auroc': 0.8863194, 'binary_precision': 0.12838683, 'binary_recall': 0.74216866, 'binary_specificity': 0.8750224, 'binary_f1_score': 0.21890546}
confusion matrix:
       0     1
0  14640  2091
1    107   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92515326, 'precision': 0.79648757, 'recall': 0.5186272, 'specificity': 0.5186272, 'f1': 0.51722044, 'auroc': 0.80035734, 'binary_precision': 0.6666667, 'binary_recall': 0.038860105, 'binary_specificity': 0.99839437, 'binary_f1_score': 0.07343942}
confusion matrix:
      0   1
0  9327  15
1   742  30
new oracle model saved
early stop counter: 13
val acc:0.8718068599700928, best validation acc: 0.9736381769180298, corresponding to test acc:                         0.9159581065177917 / 0.9251532554626465
after epoch: 15,now: 2024-08-10 16:01:26.998840,epoch time: 0:15:37.897373,used: 3:53:37.991969,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_48_seed_0_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:53:37.991969 at 2024-08-10 16:01:26.998840
persisted model performance metric: 

scalar performance:
{'acc': 0.9159581, 'precision': 0.6385428, 'recall': 0.5481102, 'specificity': 0.5481102, 'f1': 0.56363684, 'auroc': 0.87870836, 'binary_precision': 0.3464567, 'binary_recall': 0.11398964, 'binary_specificity': 0.9822308, 'binary_f1_score': 0.17153995}
confusion matrix:
      0    1
0  9176  166
1   684   88
oracle model performance metric: 

scalar performance:
{'acc': 0.92515326, 'precision': 0.79648757, 'recall': 0.5186272, 'specificity': 0.5186272, 'f1': 0.51722044, 'auroc': 0.80035734, 'binary_precision': 0.6666667, 'binary_recall': 0.038860105, 'binary_specificity': 0.99839437, 'binary_f1_score': 0.07343942}
confusion matrix:
      0   1
0  9327  15
1   742  30
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 474110 KiB |   3238 MiB | 239816 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 474110 KiB |   3238 MiB | 239816 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459821 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |  71981 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3464 MiB |   3464 MiB |   3464 MiB |      0 B   |
|       from large pool |   3354 MiB |   3354 MiB |   3354 MiB |      0 B   |
|       from small pool |    110 MiB |    110 MiB |    110 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    793 MiB |   1030 MiB | 173229 GiB | 173229 GiB |
|       from large pool |    782 MiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |     10 MiB |     11 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4959    |    7362    |   50038 K  |   50034 K  |
|       from large pool |      87    |     529    |   17451 K  |   17451 K  |
|       from small pool |    4872    |    7273    |   32587 K  |   32582 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4959    |    7362    |   50038 K  |   50034 K  |
|       from large pool |      87    |     529    |   17451 K  |   17451 K  |
|       from small pool |    4872    |    7273    |   32587 K  |   32582 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     115    |     115    |       0    |
|       from large pool |      60    |      60    |      60    |       0    |
|       from small pool |      55    |      55    |      55    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3198    |   23916 K  |   23916 K  |
|       from large pool |      24    |      33    |    8227 K  |    8227 K  |
|       from small pool |      52    |    3175    |   15689 K  |   15689 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239816 GiB | 239816 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239816 GiB | 239816 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1256 MiB |   3464 MiB |   3464 MiB |   2208 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     82 MiB |    110 MiB |    110 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173230 GiB | 173230 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172555 GiB | 172555 GiB |
|       from small pool |      0 KiB |     18 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50038 K  |   50038 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32587 K  |   32587 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50038 K  |   50038 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32587 K  |   32587 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     115    |     115    |      52    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      41    |      55    |      55    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23918 K  |   23918 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15691 K  |   15691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239816 GiB | 239816 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239816 GiB | 239816 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1256 MiB |   3464 MiB |   3464 MiB |   2208 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     82 MiB |    110 MiB |    110 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173230 GiB | 173230 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172555 GiB | 172555 GiB |
|       from small pool |      0 KiB |     18 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50038 K  |   50038 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32587 K  |   32587 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50038 K  |   50038 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32587 K  |   32587 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     115    |     115    |      52    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      41    |      55    |      55    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23918 K  |   23918 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15691 K  |   15691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962

 Experiment start at: 2024-08-10 16:11:18.378916
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.966045, 'precision': 0.9661243, 'recall': 0.9660398, 'specificity': 0.9660398, 'f1': 0.96604323, 'auroc': 0.9938092, 'binary_precision': 0.9602469, 'binary_recall': 0.9724024, 'binary_specificity': 0.9596771, 'binary_f1_score': 0.9662864}
confusion matrix:
       0      1
0  24371   1024
1    702  24735
---- Validation: 
scalar performance:
{'acc': 0.91999066, 'precision': 0.5911741, 'recall': 0.800743, 'specificity': 0.800743, 'f1': 0.6278665, 'auroc': 0.8583516, 'binary_precision': 0.19132149, 'binary_recall': 0.675174, 'binary_specificity': 0.926312, 'binary_f1_score': 0.29815573}
confusion matrix:
       0     1
0  15462  1230
1    140   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9189377, 'precision': 0.7049759, 'recall': 0.69095135, 'specificity': 0.69095135, 'f1': 0.6976351, 'auroc': 0.88782346, 'binary_precision': 0.45649073, 'binary_recall': 0.42272127, 'binary_specificity': 0.9591815, 'binary_f1_score': 0.43895745}
confusion matrix:
      0    1
0  8953  381
1   437  320
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 16:28:02.592041,epoch time: 0:16:44.213125,used: 0:16:44.213125,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9585891, 'precision': 0.95975447, 'recall': 0.95857036, 'specificity': 0.95857036, 'f1': 0.9585616, 'auroc': 0.9961275, 'binary_precision': 0.9367932, 'binary_recall': 0.98360527, 'binary_specificity': 0.93353546, 'binary_f1_score': 0.9596287}
confusion matrix:
       0      1
0  23709   1688
1    417  25018
---- Validation: 
scalar performance:
{'acc': 0.8757811, 'precision': 0.5660545, 'recall': 0.8187524, 'specificity': 0.8187524, 'f1': 0.5837841, 'auroc': 0.88391244, 'binary_precision': 0.13914894, 'binary_recall': 0.75870067, 'binary_specificity': 0.8788042, 'binary_f1_score': 0.23516719}
confusion matrix:
       0     1
0  14669  2023
1    104   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.919235, 'precision': 0.71797436, 'recall': 0.7694066, 'specificity': 0.7694066, 'f1': 0.74004924, 'auroc': 0.9087384, 'binary_precision': 0.46966526, 'binary_recall': 0.59313077, 'binary_specificity': 0.94568247, 'binary_f1_score': 0.5242265}
confusion matrix:
      0    1
0  8827  507
1   308  449
new oracle model saved
early stop counter: 1
val acc:0.8757811188697815, best validation acc: 0.9199906587600708, corresponding to test acc:                         0.9189376831054688 / 0.9192349910736084
after epoch: 2,now: 2024-08-10 16:43:42.685197,epoch time: 0:15:40.093156,used: 0:32:24.306281,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9803077, 'precision': 0.9803109, 'recall': 0.9803089, 'specificity': 0.9803089, 'f1': 0.9803077, 'auroc': 0.9978081, 'binary_precision': 0.9817823, 'binary_recall': 0.97881037, 'binary_specificity': 0.9818075, 'binary_f1_score': 0.98029405}
confusion matrix:
       0      1
0  24933    462
1    539  24898
---- Validation: 
scalar performance:
{'acc': 0.937803, 'precision': 0.6176724, 'recall': 0.8211805, 'specificity': 0.8211805, 'f1': 0.664219, 'auroc': 0.8964238, 'binary_precision': 0.2435275, 'binary_recall': 0.6983759, 'binary_specificity': 0.94398516, 'binary_f1_score': 0.36112776}
confusion matrix:
       0    1
0  15757  935
1    130  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.919235, 'precision': 0.5587836, 'recall': 0.50781786, 'specificity': 0.50781786, 'f1': 0.50007147, 'auroc': 0.8914791, 'binary_precision': 0.19148937, 'binary_recall': 0.023778072, 'binary_specificity': 0.9918577, 'binary_f1_score': 0.04230317}
confusion matrix:
      0   1
0  9258  76
1   739  18
better model found
persisted
after epoch: 3,now: 2024-08-10 16:59:09.687274,epoch time: 0:15:27.002077,used: 0:47:51.308358,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9623269, 'precision': 0.96412444, 'recall': 0.9623037, 'specificity': 0.9623037, 'f1': 0.962289, 'auroc': 0.9979116, 'binary_precision': 0.93542653, 'binary_recall': 0.99327695, 'binary_specificity': 0.93133044, 'binary_f1_score': 0.9634841}
confusion matrix:
       0      1
0  23653   1744
1    171  25264
---- Validation: 
scalar performance:
{'acc': 0.8922502, 'precision': 0.5800831, 'recall': 0.8531928, 'specificity': 0.8531928, 'f1': 0.60842454, 'auroc': 0.9015236, 'binary_precision': 0.16556291, 'binary_recall': 0.81206495, 'binary_specificity': 0.8943206, 'binary_f1_score': 0.27504912}
confusion matrix:
       0     1
0  14928  1764
1     81   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.921316, 'precision': 0.62212956, 'recall': 0.5174399, 'specificity': 0.5174399, 'f1': 0.51675165, 'auroc': 0.8931517, 'binary_precision': 0.31683168, 'binary_recall': 0.04227213, 'binary_specificity': 0.99260765, 'binary_f1_score': 0.07459208}
confusion matrix:
      0   1
0  9265  69
1   725  32
new oracle model saved
early stop counter: 1
val acc:0.8922501802444458, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9213160276412964
after epoch: 4,now: 2024-08-10 17:14:33.528275,epoch time: 0:15:23.841001,used: 1:03:15.149359,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96875983, 'precision': 0.96982515, 'recall': 0.9687394, 'specificity': 0.9687394, 'f1': 0.9687412, 'auroc': 0.9980613, 'binary_precision': 0.94766873, 'binary_recall': 0.9923736, 'binary_specificity': 0.94510514, 'binary_f1_score': 0.96950614}
confusion matrix:
       0      1
0  24000   1394
1    194  25244
---- Validation: 
scalar performance:
{'acc': 0.88787013, 'precision': 0.57817227, 'recall': 0.85659695, 'specificity': 0.85659695, 'f1': 0.60461664, 'auroc': 0.90468526, 'binary_precision': 0.16143702, 'binary_recall': 0.8236659, 'binary_specificity': 0.8895279, 'binary_f1_score': 0.26996198}
confusion matrix:
       0     1
0  14848  1844
1     76   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9217124, 'precision': 0.58995426, 'recall': 0.50855017, 'specificity': 0.50855017, 'f1': 0.5002261, 'auroc': 0.89470375, 'binary_precision': 0.25373134, 'binary_recall': 0.022457067, 'binary_specificity': 0.9946432, 'binary_f1_score': 0.041262135}
confusion matrix:
      0   1
0  9284  50
1   740  17
new oracle model saved
early stop counter: 2
val acc:0.8878701329231262, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9217123985290527
after epoch: 5,now: 2024-08-10 17:30:01.085661,epoch time: 0:15:27.557386,used: 1:18:42.706745,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96596634, 'precision': 0.96734667, 'recall': 0.96594507, 'specificity': 0.96594507, 'f1': 0.96594, 'auroc': 0.99794185, 'binary_precision': 0.94214416, 'binary_recall': 0.9929627, 'binary_specificity': 0.9389274, 'binary_f1_score': 0.96688616}
confusion matrix:
       0      1
0  23845   1551
1    179  25257
---- Validation: 
scalar performance:
{'acc': 0.89049816, 'precision': 0.5787291, 'recall': 0.851164, 'specificity': 0.851164, 'f1': 0.60604, 'auroc': 0.9034234, 'binary_precision': 0.16293184, 'binary_recall': 0.8097448, 'binary_specificity': 0.89258325, 'binary_f1_score': 0.27127868}
confusion matrix:
       0     1
0  14899  1793
1     82   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92468536, 'precision': 0.6054216, 'recall': 0.50105315, 'specificity': 0.50105315, 'f1': 0.48304835, 'auroc': 0.8982597, 'binary_precision': 0.2857143, 'binary_recall': 0.002642008, 'binary_specificity': 0.99946433, 'binary_f1_score': 0.005235602}
confusion matrix:
      0  1
0  9329  5
1   755  2
new oracle model saved
early stop counter: 3
val acc:0.890498161315918, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9246853590011597
after epoch: 6,now: 2024-08-10 17:45:28.124114,epoch time: 0:15:27.038453,used: 1:34:09.745198,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95595294, 'precision': 0.9588387, 'recall': 0.95592344, 'specificity': 0.95592344, 'f1': 0.9558815, 'auroc': 0.99730647, 'binary_precision': 0.9226368, 'binary_recall': 0.99543935, 'binary_specificity': 0.91640747, 'binary_f1_score': 0.9576564}
confusion matrix:
       0      1
0  23274   2123
1    116  25319
---- Validation: 
scalar performance:
{'acc': 0.8392805, 'precision': 0.5565094, 'recall': 0.83619535, 'specificity': 0.83619535, 'f1': 0.55874807, 'auroc': 0.8857051, 'binary_precision': 0.11813097, 'binary_recall': 0.83294666, 'binary_specificity': 0.83944404, 'binary_f1_score': 0.20691642}
confusion matrix:
       0     1
0  14012  2680
1     72   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9255772, 'precision': 0.8628509, 'recall': 0.5051769, 'specificity': 0.5051769, 'f1': 0.49108952, 'auroc': 0.870255, 'binary_precision': 0.8, 'binary_recall': 0.010568032, 'binary_specificity': 0.9997857, 'binary_f1_score': 0.020860497}
confusion matrix:
      0  1
0  9332  2
1   749  8
new oracle model saved
early stop counter: 4
val acc:0.8392804861068726, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9255772233009338
after epoch: 7,now: 2024-08-10 18:01:00.674916,epoch time: 0:15:32.550802,used: 1:49:42.296000,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95831364, 'precision': 0.96054363, 'recall': 0.95828503, 'specificity': 0.95828503, 'f1': 0.95826125, 'auroc': 0.9971868, 'binary_precision': 0.9287028, 'binary_recall': 0.9929237, 'binary_specificity': 0.9236464, 'binary_f1_score': 0.95974004}
confusion matrix:
       0      1
0  23456   1939
1    180  25257
---- Validation: 
scalar performance:
{'acc': 0.8673714, 'precision': 0.56182104, 'recall': 0.81330884, 'specificity': 0.81330884, 'f1': 0.5752779, 'auroc': 0.8759412, 'binary_precision': 0.13081862, 'binary_recall': 0.7563805, 'binary_specificity': 0.87023723, 'binary_f1_score': 0.22305849}
confusion matrix:
       0     1
0  14526  2166
1    105   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92508173, 'precision': 0.7959126, 'recall': 0.50126743, 'specificity': 0.50126743, 'f1': 0.4831691, 'auroc': 0.87702346, 'binary_precision': 0.6666667, 'binary_recall': 0.002642008, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0052631577}
confusion matrix:
      0  1
0  9333  1
1   755  2
early stop counter: 5
val acc:0.8673713803291321, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9255772233009338
after epoch: 8,now: 2024-08-10 18:16:31.490205,epoch time: 0:15:30.815289,used: 2:05:13.111289,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9470019, 'precision': 0.95135105, 'recall': 0.94696337, 'specificity': 0.94696337, 'f1': 0.9468707, 'auroc': 0.99668765, 'binary_precision': 0.9072416, 'binary_recall': 0.9959113, 'binary_specificity': 0.89801544, 'binary_f1_score': 0.9495108}
confusion matrix:
       0      1
0  22806   2590
1    104  25332
---- Validation: 
scalar performance:
{'acc': 0.8166793, 'precision': 0.54578406, 'recall': 0.79521936, 'specificity': 0.79521936, 'f1': 0.5359577, 'auroc': 0.84187967, 'binary_precision': 0.09869591, 'binary_recall': 0.7726218, 'binary_specificity': 0.8178169, 'binary_f1_score': 0.17503285}
confusion matrix:
       0     1
0  13651  3041
1     98   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92637, 'precision': 0.805748, 'recall': 0.5165303, 'specificity': 0.5165303, 'f1': 0.51354206, 'auroc': 0.8652168, 'binary_precision': 0.68421054, 'binary_recall': 0.034346104, 'binary_specificity': 0.9987144, 'binary_f1_score': 0.0654088}
confusion matrix:
      0   1
0  9322  12
1   731  26
new oracle model saved
early stop counter: 6
val acc:0.8166792988777161, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9263700246810913
after epoch: 9,now: 2024-08-10 18:32:06.954065,epoch time: 0:15:35.463860,used: 2:20:48.575149,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94694287, 'precision': 0.95118, 'recall': 0.94690865, 'specificity': 0.94690865, 'f1': 0.94681513, 'auroc': 0.99712515, 'binary_precision': 0.90763384, 'binary_recall': 0.9952426, 'binary_specificity': 0.8985747, 'binary_f1_score': 0.94942147}
confusion matrix:
       0      1
0  22822   2576
1    121  25313
---- Validation: 
scalar performance:
{'acc': 0.81749696, 'precision': 0.5490698, 'recall': 0.8182415, 'specificity': 0.8182415, 'f1': 0.54077035, 'auroc': 0.8673097, 'binary_precision': 0.10382353, 'binary_recall': 0.8190255, 'binary_specificity': 0.81745744, 'binary_f1_score': 0.18428607}
confusion matrix:
       0     1
0  13645  3047
1     78   353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92547816, 'precision': 0.89133424, 'recall': 0.50390947, 'specificity': 0.50390947, 'f1': 0.48848993, 'auroc': 0.87439144, 'binary_precision': 0.85714287, 'binary_recall': 0.007926024, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.015706806}
confusion matrix:
      0  1
0  9333  1
1   751  6
early stop counter: 7
val acc:0.8174969553947449, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9263700246810913
after epoch: 10,now: 2024-08-10 18:47:54.147890,epoch time: 0:15:47.193825,used: 2:36:35.768974,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.93515897, 'precision': 0.9419943, 'recall': 0.9351101, 'specificity': 0.9351101, 'f1': 0.9349023, 'auroc': 0.9973999, 'binary_precision': 0.8872254, 'binary_recall': 0.9971694, 'binary_specificity': 0.87305087, 'binary_f1_score': 0.9389901}
confusion matrix:
       0      1
0  22172   3224
1     72  25364
---- Validation: 
scalar performance:
{'acc': 0.7857268, 'precision': 0.54544175, 'recall': 0.8313298, 'specificity': 0.8313298, 'f1': 0.5240898, 'auroc': 0.8794526, 'binary_precision': 0.09484485, 'binary_recall': 0.87935036, 'binary_specificity': 0.78330934, 'binary_f1_score': 0.17122205}
confusion matrix:
       0     1
0  13075  3617
1     52   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92537904, 'precision': 0.8128013, 'recall': 0.50446284, 'specificity': 0.50446284, 'f1': 0.4897342, 'auroc': 0.8734649, 'binary_precision': 0.7, 'binary_recall': 0.009247027, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.018252933}
confusion matrix:
      0  1
0  9331  3
1   750  7
early stop counter: 8
val acc:0.78572678565979, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9263700246810913
after epoch: 11,now: 2024-08-10 19:03:35.558774,epoch time: 0:15:41.410884,used: 2:52:17.179858,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9526086, 'precision': 0.95628047, 'recall': 0.9525734, 'specificity': 0.9525734, 'f1': 0.9525105, 'auroc': 0.9984851, 'binary_precision': 0.9155448, 'binary_recall': 0.99728733, 'binary_specificity': 0.9078595, 'binary_f1_score': 0.95466954}
confusion matrix:
       0      1
0  23056   2340
1     69  25367
---- Validation: 
scalar performance:
{'acc': 0.78911406, 'precision': 0.5451656, 'recall': 0.8251562, 'specificity': 0.8251562, 'f1': 0.52501625, 'auroc': 0.884297, 'binary_precision': 0.094801225, 'binary_recall': 0.86310905, 'binary_specificity': 0.78720343, 'binary_f1_score': 0.17083812}
confusion matrix:
       0     1
0  13140  3552
1     59   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9260727, 'precision': 0.8748876, 'recall': 0.5090863, 'specificity': 0.5090863, 'f1': 0.498869, 'auroc': 0.88754624, 'binary_precision': 0.8235294, 'binary_recall': 0.018494055, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.03617571}
confusion matrix:
      0   1
0  9331   3
1   743  14
early stop counter: 9
val acc:0.7891140580177307, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9263700246810913
after epoch: 12,now: 2024-08-10 19:19:19.182685,epoch time: 0:15:43.623911,used: 3:08:00.803769,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93903446, 'precision': 0.9453076, 'recall': 0.9389832, 'specificity': 0.9389832, 'f1': 0.93881404, 'auroc': 0.9976413, 'binary_precision': 0.89267004, 'binary_recall': 0.99819165, 'binary_specificity': 0.87977475, 'binary_f1_score': 0.9424864}
confusion matrix:
       0      1
0  22341   3053
1     46  25392
---- Validation: 
scalar performance:
{'acc': 0.75962156, 'precision': 0.53993773, 'recall': 0.8122895, 'specificity': 0.8122895, 'f1': 0.5068486, 'auroc': 0.8653536, 'binary_precision': 0.084367245, 'binary_recall': 0.8677494, 'binary_specificity': 0.7568296, 'binary_f1_score': 0.1537829}
confusion matrix:
       0     1
0  12633  4059
1     57   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92567635, 'precision': 0.84755445, 'recall': 0.50644433, 'specificity': 0.50644433, 'f1': 0.4936691, 'auroc': 0.86446446, 'binary_precision': 0.7692308, 'binary_recall': 0.01321004, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.025974026}
confusion matrix:
      0   1
0  9331   3
1   747  10
early stop counter: 10
val acc:0.7596215605735779, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9263700246810913
after epoch: 13,now: 2024-08-10 19:34:47.628800,epoch time: 0:15:28.446115,used: 3:23:29.249884,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.94967735, 'precision': 0.95371276, 'recall': 0.9496404, 'specificity': 0.9496404, 'f1': 0.9495623, 'auroc': 0.99766207, 'binary_precision': 0.9111199, 'binary_recall': 0.99665827, 'binary_specificity': 0.90262246, 'binary_f1_score': 0.9519714}
confusion matrix:
       0      1
0  22923   2473
1     85  25351
---- Validation: 
scalar performance:
{'acc': 0.8092624, 'precision': 0.5478678, 'recall': 0.82079875, 'specificity': 0.82079875, 'f1': 0.53614837, 'auroc': 0.8666807, 'binary_precision': 0.10104138, 'binary_recall': 0.83294666, 'binary_specificity': 0.80865085, 'binary_f1_score': 0.18022089}
confusion matrix:
       0     1
0  13498  3194
1     72   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92577547, 'precision': 0.8558421, 'recall': 0.5071048, 'specificity': 0.5071048, 'f1': 0.494974, 'auroc': 0.8797419, 'binary_precision': 0.78571427, 'binary_recall': 0.014531043, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.028534371}
confusion matrix:
      0   1
0  9331   3
1   746  11
early stop counter: 11
val acc:0.8092623949050903, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9263700246810913
after epoch: 14,now: 2024-08-10 19:50:43.018725,epoch time: 0:15:55.389925,used: 3:39:24.639809,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93421465, 'precision': 0.94154966, 'recall': 0.9341691, 'specificity': 0.9341691, 'f1': 0.9339355, 'auroc': 0.9974618, 'binary_precision': 0.8848164, 'binary_recall': 0.99850595, 'binary_specificity': 0.8698323, 'binary_f1_score': 0.9382296}
confusion matrix:
       0      1
0  22092   3306
1     38  25396
---- Validation: 
scalar performance:
{'acc': 0.72317934, 'precision': 0.5348669, 'recall': 0.7958582, 'specificity': 0.7958582, 'f1': 0.48603994, 'auroc': 0.8659066, 'binary_precision': 0.07429362, 'binary_recall': 0.8723898, 'binary_specificity': 0.7193266, 'binary_f1_score': 0.13692644}
confusion matrix:
       0     1
0  12007  4685
1     55   376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92627096, 'precision': 0.90434897, 'recall': 0.5098004, 'specificity': 0.5098004, 'f1': 0.5002125, 'auroc': 0.88371825, 'binary_precision': 0.88235295, 'binary_recall': 0.01981506, 'binary_specificity': 0.9997857, 'binary_f1_score': 0.038759686}
confusion matrix:
      0   1
0  9332   2
1   742  15
early stop counter: 12
val acc:0.7231793403625488, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.9192349910736084 / 0.9263700246810913
after epoch: 15,now: 2024-08-10 20:06:30.813037,epoch time: 0:15:47.794312,used: 3:55:12.434121,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_18_seed_1_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:55:12.434121 at 2024-08-10 20:06:30.813037
persisted model performance metric: 

scalar performance:
{'acc': 0.919235, 'precision': 0.5587836, 'recall': 0.50781786, 'specificity': 0.50781786, 'f1': 0.50007147, 'auroc': 0.8914791, 'binary_precision': 0.19148937, 'binary_recall': 0.023778072, 'binary_specificity': 0.9918577, 'binary_f1_score': 0.04230317}
confusion matrix:
      0   1
0  9258  76
1   739  18
oracle model performance metric: 

scalar performance:
{'acc': 0.92637, 'precision': 0.805748, 'recall': 0.5165303, 'specificity': 0.5165303, 'f1': 0.51354206, 'auroc': 0.8652168, 'binary_precision': 0.68421054, 'binary_recall': 0.034346104, 'binary_specificity': 0.9987144, 'binary_f1_score': 0.0654088}
confusion matrix:
      0   1
0  9322  12
1   731  26
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 472248 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 472248 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 473560 GiB | 473559 GiB |
|       from small pool |  71980 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3462 MiB |   3464 MiB |   5670 MiB |   2208 MiB |
|       from large pool |   3354 MiB |   3354 MiB |   5534 MiB |   2180 MiB |
|       from small pool |    108 MiB |    110 MiB |    136 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    806 MiB |   1050 MiB | 354698 GiB | 354697 GiB |
|       from large pool |    796 MiB |   1046 MiB | 353334 GiB | 353334 GiB |
|       from small pool |     10 MiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7384    |  100578 K  |  100573 K  |
|       from large pool |      87    |     529    |   35137 K  |   35137 K  |
|       from small pool |    4860    |    7295    |   65441 K  |   65436 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7384    |  100578 K  |  100573 K  |
|       from large pool |      87    |     529    |   35137 K  |   35137 K  |
|       from small pool |    4860    |    7295    |   65441 K  |   65436 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     111    |     115    |     163    |      52    |
|       from large pool |      57    |      60    |      95    |      38    |
|       from small pool |      54    |      55    |      68    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3211    |   47847 K  |   47847 K  |
|       from large pool |      26    |      33    |   16342 K  |   16342 K  |
|       from small pool |      44    |    3186    |   31504 K  |   31504 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473560 GiB | 473560 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5670 MiB |   4402 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    136 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354698 GiB | 354698 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353335 GiB | 353335 GiB |
|       from small pool |      0 KiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100578 K  |  100578 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65441 K  |   65441 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100578 K  |  100578 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65441 K  |   65441 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     163    |      98    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      68    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47849 K  |   47849 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31507 K  |   31507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473560 GiB | 473560 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5670 MiB |   4402 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    136 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354698 GiB | 354698 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353335 GiB | 353335 GiB |
|       from small pool |      0 KiB |     18 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100578 K  |  100578 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65441 K  |   65441 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100578 K  |  100578 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65441 K  |   65441 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     163    |      98    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      68    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47849 K  |   47849 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31507 K  |   31507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962

 Experiment start at: 2024-08-10 20:16:27.058829
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9714098, 'precision': 0.971571, 'recall': 0.9714098, 'specificity': 0.9714098, 'f1': 0.9714073, 'auroc': 0.9946463, 'binary_precision': 0.98029166, 'binary_recall': 0.9621634, 'binary_specificity': 0.98065615, 'binary_f1_score': 0.97114295}
confusion matrix:
       0      1
0  25348    500
1    978  24870
---- Validation: 
scalar performance:
{'acc': 0.9505957, 'precision': 0.63565457, 'recall': 0.80557454, 'specificity': 0.80557454, 'f1': 0.6832464, 'auroc': 0.86762893, 'binary_precision': 0.28028747, 'binary_recall': 0.65311, 'binary_specificity': 0.95803905, 'binary_f1_score': 0.39224136}
confusion matrix:
       0    1
0  16005  701
1    145  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9113159, 'precision': 0.70929825, 'recall': 0.77003723, 'specificity': 0.77003723, 'f1': 0.7343452, 'auroc': 0.87564725, 'binary_precision': 0.4536862, 'binary_recall': 0.60225844, 'binary_specificity': 0.937816, 'binary_f1_score': 0.51752025}
confusion matrix:
      0    1
0  8717  578
1   317  480
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 20:33:11.158451,epoch time: 0:16:44.099622,used: 0:16:44.099622,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9694561, 'precision': 0.97017217, 'recall': 0.96945, 'specificity': 0.96945, 'f1': 0.96944416, 'auroc': 0.9974993, 'binary_precision': 0.95190054, 'binary_recall': 0.98890007, 'binary_specificity': 0.95, 'binary_f1_score': 0.9700476}
confusion matrix:
       0      1
0  24548   1292
1    287  25569
---- Validation: 
scalar performance:
{'acc': 0.927003, 'precision': 0.60489213, 'recall': 0.84479773, 'specificity': 0.84479773, 'f1': 0.6489475, 'auroc': 0.9001652, 'binary_precision': 0.21623465, 'binary_recall': 0.7583732, 'binary_specificity': 0.9312223, 'binary_f1_score': 0.33651805}
confusion matrix:
       0     1
0  15557  1149
1    101   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9133968, 'precision': 0.71270084, 'recall': 0.76313704, 'specificity': 0.76313704, 'f1': 0.73425037, 'auroc': 0.8918898, 'binary_precision': 0.4618434, 'binary_recall': 0.5846926, 'binary_specificity': 0.9415815, 'binary_f1_score': 0.5160576}
confusion matrix:
      0    1
0  8752  543
1   331  466
new oracle model saved
early stop counter: 1
val acc:0.927003026008606, best validation acc: 0.9505956768989563, corresponding to test acc:                         0.91131591796875 / 0.9133967757225037
after epoch: 2,now: 2024-08-10 20:48:59.130826,epoch time: 0:15:47.972375,used: 0:32:32.071997,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98168135, 'precision': 0.9817728, 'recall': 0.98168087, 'specificity': 0.98168087, 'f1': 0.9816805, 'auroc': 0.9982818, 'binary_precision': 0.97515744, 'binary_recall': 0.98854935, 'binary_specificity': 0.9748123, 'binary_f1_score': 0.98180777}
confusion matrix:
       0      1
0  25195    651
1    296  25554
---- Validation: 
scalar performance:
{'acc': 0.9581289, 'precision': 0.6653293, 'recall': 0.8525864, 'specificity': 0.8525864, 'f1': 0.7209694, 'auroc': 0.9071641, 'binary_precision': 0.3373232, 'binary_recall': 0.7416268, 'binary_specificity': 0.96354604, 'binary_f1_score': 0.46372476}
confusion matrix:
       0    1
0  16097  609
1    108  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91508126, 'precision': 0.66267586, 'recall': 0.5615848, 'specificity': 0.5615848, 'f1': 0.5819064, 'auroc': 0.87220716, 'binary_precision': 0.3951049, 'binary_recall': 0.14178169, 'binary_specificity': 0.98138785, 'binary_f1_score': 0.20867959}
confusion matrix:
      0    1
0  9122  173
1   684  113
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 21:04:52.876033,epoch time: 0:15:53.745207,used: 0:48:25.817204,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9660709, 'precision': 0.96729755, 'recall': 0.96606594, 'specificity': 0.96606594, 'f1': 0.9660483, 'auroc': 0.9980186, 'binary_precision': 0.94340384, 'binary_recall': 0.9916451, 'binary_specificity': 0.9404868, 'binary_f1_score': 0.9669231}
confusion matrix:
       0      1
0  24305   1538
1    216  25637
---- Validation: 
scalar performance:
{'acc': 0.89284045, 'precision': 0.5776943, 'recall': 0.8494477, 'specificity': 0.8494477, 'f1': 0.60511893, 'auroc': 0.91048133, 'binary_precision': 0.16084251, 'binary_recall': 0.80382776, 'binary_specificity': 0.89506763, 'binary_f1_score': 0.26804945}
confusion matrix:
       0     1
0  14953  1753
1     82   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9183512, 'precision': 0.6924676, 'recall': 0.5731104, 'specificity': 0.5731104, 'f1': 0.5983555, 'auroc': 0.852181, 'binary_precision': 0.45296168, 'binary_recall': 0.16311167, 'binary_specificity': 0.9831092, 'binary_f1_score': 0.2398524}
confusion matrix:
      0    1
0  9138  157
1   667  130
new oracle model saved
early stop counter: 1
val acc:0.8928404450416565, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9183511734008789
after epoch: 4,now: 2024-08-10 21:20:56.757251,epoch time: 0:16:03.881218,used: 1:04:29.698422,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96241486, 'precision': 0.964036, 'recall': 0.96240807, 'specificity': 0.96240807, 'f1': 0.9623816, 'auroc': 0.9980734, 'binary_precision': 0.9366668, 'binary_recall': 0.9919161, 'binary_specificity': 0.93289995, 'binary_f1_score': 0.9635001}
confusion matrix:
       0      1
0  24108   1734
1    209  25645
---- Validation: 
scalar performance:
{'acc': 0.91018456, 'precision': 0.5866502, 'recall': 0.8338456, 'specificity': 0.8338456, 'f1': 0.6213239, 'auroc': 0.90518653, 'binary_precision': 0.18, 'binary_recall': 0.7535885, 'binary_specificity': 0.91410273, 'binary_f1_score': 0.29059044}
confusion matrix:
       0     1
0  15271  1435
1    103   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9199366, 'precision': 0.68262637, 'recall': 0.52292424, 'specificity': 0.52292424, 'f1': 0.52512825, 'auroc': 0.8614044, 'binary_precision': 0.4408602, 'binary_recall': 0.05144291, 'binary_specificity': 0.99440557, 'binary_f1_score': 0.092134826}
confusion matrix:
      0   1
0  9243  52
1   756  41
new oracle model saved
early stop counter: 2
val acc:0.9101845622062683, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9199365973472595
after epoch: 5,now: 2024-08-10 21:37:03.839555,epoch time: 0:16:07.082304,used: 1:20:36.780726,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9461854, 'precision': 0.9505992, 'recall': 0.9461758, 'specificity': 0.9461758, 'f1': 0.94605243, 'auroc': 0.9975457, 'binary_precision': 0.9060509, 'binary_recall': 0.99562913, 'binary_specificity': 0.8967225, 'binary_f1_score': 0.94873023}
confusion matrix:
       0      1
0  23174   2669
1    113  25740
---- Validation: 
scalar performance:
{'acc': 0.8380051, 'precision': 0.552737, 'recall': 0.82251024, 'specificity': 0.82251024, 'f1': 0.55270535, 'auroc': 0.88928795, 'binary_precision': 0.11122112, 'binary_recall': 0.8062201, 'binary_specificity': 0.83880043, 'binary_f1_score': 0.19547564}
confusion matrix:
       0     1
0  14013  2693
1     81   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92241377, 'precision': 0.7434844, 'recall': 0.5380345, 'specificity': 0.5380345, 'f1': 0.55087835, 'auroc': 0.8202616, 'binary_precision': 0.5603448, 'binary_recall': 0.081555836, 'binary_specificity': 0.99451315, 'binary_f1_score': 0.14238773}
confusion matrix:
      0   1
0  9244  51
1   732  65
new oracle model saved
early stop counter: 3
val acc:0.8380051255226135, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9224137663841248
after epoch: 6,now: 2024-08-10 21:53:15.749212,epoch time: 0:16:11.909657,used: 1:36:48.690383,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9641365, 'precision': 0.96585584, 'recall': 0.96413064, 'specificity': 0.96413064, 'f1': 0.964103, 'auroc': 0.99846655, 'binary_precision': 0.9376026, 'binary_recall': 0.99446875, 'binary_specificity': 0.93379253, 'binary_f1_score': 0.96519876}
confusion matrix:
       0      1
0  24132   1711
1    143  25710
---- Validation: 
scalar performance:
{'acc': 0.9068559, 'precision': 0.5761144, 'recall': 0.79132116, 'specificity': 0.79132116, 'f1': 0.6050808, 'auroc': 0.87786615, 'binary_precision': 0.16119747, 'binary_recall': 0.6698565, 'binary_specificity': 0.9127858, 'binary_f1_score': 0.25986078}
confusion matrix:
       0     1
0  15249  1457
1    138   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233056, 'precision': 0.7893301, 'recall': 0.5293417, 'specificity': 0.5293417, 'f1': 0.5361533, 'auroc': 0.8245175, 'binary_precision': 0.6533333, 'binary_recall': 0.061480552, 'binary_specificity': 0.9972028, 'binary_f1_score': 0.11238532}
confusion matrix:
      0   1
0  9269  26
1   748  49
new oracle model saved
early stop counter: 4
val acc:0.9068558812141418, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9233055710792542
after epoch: 7,now: 2024-08-10 22:09:14.422248,epoch time: 0:15:58.673036,used: 1:52:47.363419,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9705973, 'precision': 0.9716775, 'recall': 0.9705955, 'specificity': 0.9705955, 'f1': 0.9705804, 'auroc': 0.99865186, 'binary_precision': 0.949125, 'binary_recall': 0.9945068, 'binary_specificity': 0.9466842, 'binary_f1_score': 0.9712861}
confusion matrix:
       0      1
0  24468   1378
1    142  25708
---- Validation: 
scalar performance:
{'acc': 0.9115277, 'precision': 0.5829993, 'recall': 0.80887663, 'specificity': 0.80887663, 'f1': 0.6158938, 'auroc': 0.8930796, 'binary_precision': 0.17409389, 'binary_recall': 0.70095694, 'binary_specificity': 0.9167964, 'binary_f1_score': 0.2789148}
confusion matrix:
       0     1
0  15316  1390
1    125   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9205311, 'precision': 0.65652215, 'recall': 0.50489306, 'specificity': 0.50489306, 'f1': 0.4902671, 'auroc': 0.8315445, 'binary_precision': 0.39130434, 'binary_recall': 0.011292347, 'binary_specificity': 0.9984938, 'binary_f1_score': 0.02195122}
confusion matrix:
      0   1
0  9281  14
1   788   9
early stop counter: 5
val acc:0.911527693271637, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9233055710792542
after epoch: 8,now: 2024-08-10 22:25:51.665797,epoch time: 0:16:37.243549,used: 2:09:24.606968,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9531105, 'precision': 0.95628905, 'recall': 0.9531056, 'specificity': 0.9531056, 'f1': 0.9530283, 'auroc': 0.9980565, 'binary_precision': 0.9182347, 'binary_recall': 0.9948164, 'binary_specificity': 0.91139483, 'binary_f1_score': 0.9549928}
confusion matrix:
       0      1
0  23555   2290
1    134  25717
---- Validation: 
scalar performance:
{'acc': 0.87380284, 'precision': 0.5571184, 'recall': 0.78021234, 'specificity': 0.78021234, 'f1': 0.5700743, 'auroc': 0.864902, 'binary_precision': 0.1232166, 'binary_recall': 0.6818182, 'binary_specificity': 0.8786065, 'binary_f1_score': 0.20871475}
confusion matrix:
       0     1
0  14678  2028
1    133   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92181927, 'precision': 0.7386261, 'recall': 0.52451986, 'specificity': 0.52451986, 'f1': 0.5276812, 'auroc': 0.80486643, 'binary_precision': 0.55263156, 'binary_recall': 0.052697618, 'binary_specificity': 0.9963421, 'binary_f1_score': 0.096219935}
confusion matrix:
      0   1
0  9261  34
1   755  42
early stop counter: 6
val acc:0.8738028407096863, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9233055710792542
after epoch: 9,now: 2024-08-10 22:42:12.016026,epoch time: 0:16:20.350229,used: 2:25:44.957197,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9537295, 'precision': 0.95689595, 'recall': 0.9537231, 'specificity': 0.9537231, 'f1': 0.9536487, 'auroc': 0.9978156, 'binary_precision': 0.91889864, 'binary_recall': 0.9953195, 'binary_specificity': 0.9121266, 'binary_f1_score': 0.9555836}
confusion matrix:
       0      1
0  23573   2271
1    121  25731
---- Validation: 
scalar performance:
{'acc': 0.84069145, 'precision': 0.5467102, 'recall': 0.7760711, 'specificity': 0.7760711, 'f1': 0.5450542, 'auroc': 0.84516096, 'binary_precision': 0.10199862, 'binary_recall': 0.708134, 'binary_specificity': 0.84400815, 'binary_f1_score': 0.17831326}
confusion matrix:
       0     1
0  14100  2606
1    122   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9208284, 'precision': 0.683062, 'recall': 0.5044809, 'specificity': 0.5044809, 'f1': 0.48919022, 'auroc': 0.7190959, 'binary_precision': 0.44444445, 'binary_recall': 0.010037641, 'binary_specificity': 0.99892414, 'binary_f1_score': 0.019631902}
confusion matrix:
      0   1
0  9285  10
1   789   8
early stop counter: 7
val acc:0.8406914472579956, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9233055710792542
after epoch: 10,now: 2024-08-10 22:58:28.973219,epoch time: 0:16:16.957193,used: 2:42:01.914390,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9351207, 'precision': 0.94201136, 'recall': 0.93511343, 'specificity': 0.93511343, 'f1': 0.93486613, 'auroc': 0.99752474, 'binary_precision': 0.88685215, 'binary_recall': 0.99752426, 'binary_specificity': 0.87270266, 'binary_f1_score': 0.93893826}
confusion matrix:
       0      1
0  22555   3290
1     64  25787
---- Validation: 
scalar performance:
{'acc': 0.7922214, 'precision': 0.54501593, 'recall': 0.8305342, 'specificity': 0.8305342, 'f1': 0.52555245, 'auroc': 0.8808733, 'binary_precision': 0.09410548, 'binary_recall': 0.87081337, 'binary_specificity': 0.790255, 'binary_f1_score': 0.16985534}
confusion matrix:
       0     1
0  13202  3504
1     54   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92241377, 'precision': 0.7879126, 'recall': 0.5179599, 'specificity': 0.5179599, 'f1': 0.5153452, 'auroc': 0.8053979, 'binary_precision': 0.65217394, 'binary_recall': 0.037641153, 'binary_specificity': 0.9982786, 'binary_f1_score': 0.071174376}
confusion matrix:
      0   1
0  9279  16
1   767  30
early stop counter: 8
val acc:0.7922214269638062, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9233055710792542
after epoch: 11,now: 2024-08-10 23:14:39.253829,epoch time: 0:16:10.280610,used: 2:58:12.195000,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.94448316, 'precision': 0.9491879, 'recall': 0.9444772, 'specificity': 0.9444772, 'f1': 0.9443369, 'auroc': 0.99780715, 'binary_precision': 0.90324616, 'binary_recall': 0.9956288, 'binary_specificity': 0.89332557, 'binary_f1_score': 0.9471902}
confusion matrix:
       0      1
0  23088   2757
1    113  25738
---- Validation: 
scalar performance:
{'acc': 0.86872226, 'precision': 0.55350685, 'recall': 0.7694448, 'specificity': 0.7694448, 'f1': 0.563398, 'auroc': 0.8622045, 'binary_precision': 0.11651299, 'binary_recall': 0.6650718, 'binary_specificity': 0.8738178, 'binary_f1_score': 0.19828816}
confusion matrix:
       0     1
0  14598  2108
1    140   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92181927, 'precision': 0.83604604, 'recall': 0.5073131, 'specificity': 0.5073131, 'f1': 0.49439463, 'auroc': 0.8371005, 'binary_precision': 0.75, 'binary_recall': 0.015056462, 'binary_specificity': 0.99956965, 'binary_f1_score': 0.029520296}
confusion matrix:
      0   1
0  9291   4
1   785  12
early stop counter: 9
val acc:0.8687222599983215, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9233055710792542
after epoch: 12,now: 2024-08-10 23:30:46.223037,epoch time: 0:16:06.969208,used: 3:14:19.164208,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9432258, 'precision': 0.9483721, 'recall': 0.94321537, 'specificity': 0.94321537, 'f1': 0.9430615, 'auroc': 0.99820876, 'binary_precision': 0.90038437, 'binary_recall': 0.99675083, 'binary_specificity': 0.88967997, 'binary_f1_score': 0.94612}
confusion matrix:
       0      1
0  22992   2851
1     84  25769
---- Validation: 
scalar performance:
{'acc': 0.86118895, 'precision': 0.54646665, 'recall': 0.7410928, 'specificity': 0.7410928, 'f1': 0.55099434, 'auroc': 0.8484846, 'binary_precision': 0.10392236, 'binary_recall': 0.6148325, 'binary_specificity': 0.867353, 'binary_f1_score': 0.17779315}
confusion matrix:
       0     1
0  14490  2216
1    161   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92092746, 'precision': 0.7055752, 'recall': 0.51199096, 'specificity': 0.51199096, 'f1': 0.50437343, 'auroc': 0.6954131, 'binary_precision': 0.4883721, 'binary_recall': 0.026348809, 'binary_specificity': 0.99763316, 'binary_f1_score': 0.049999997}
confusion matrix:
      0   1
0  9273  22
1   776  21
early stop counter: 10
val acc:0.8611889481544495, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9233055710792542
after epoch: 13,now: 2024-08-10 23:47:13.254424,epoch time: 0:16:27.031387,used: 3:30:46.195595,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9455857, 'precision': 0.9503475, 'recall': 0.94558173, 'specificity': 0.94558173, 'f1': 0.9454412, 'auroc': 0.99832153, 'binary_precision': 0.90405864, 'binary_recall': 0.9969826, 'binary_specificity': 0.8941809, 'binary_f1_score': 0.9482495}
confusion matrix:
       0      1
0  23111   2735
1     78  25772
---- Validation: 
scalar performance:
{'acc': 0.855758, 'precision': 0.5469911, 'recall': 0.75347054, 'specificity': 0.75347054, 'f1': 0.55016583, 'auroc': 0.84692526, 'binary_precision': 0.104166664, 'binary_recall': 0.64593303, 'binary_specificity': 0.86100805, 'binary_f1_score': 0.17940198}
confusion matrix:
       0     1
0  14384  2322
1    148   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92112565, 'precision': 0.7275181, 'recall': 0.50464225, 'specificity': 0.50464225, 'f1': 0.4893071, 'auroc': 0.74404913, 'binary_precision': 0.53333336, 'binary_recall': 0.010037641, 'binary_specificity': 0.9992469, 'binary_f1_score': 0.019704433}
confusion matrix:
      0  1
0  9288  7
1   789  8
early stop counter: 11
val acc:0.855758011341095, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9233055710792542
after epoch: 14,now: 2024-08-11 00:03:27.625553,epoch time: 0:16:14.371129,used: 3:47:00.566724,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9248878, 'precision': 0.93429744, 'recall': 0.92487645, 'specificity': 0.92487645, 'f1': 0.92447734, 'auroc': 0.9979466, 'binary_precision': 0.8704097, 'binary_recall': 0.9984527, 'binary_specificity': 0.8513001, 'binary_f1_score': 0.9300449}
confusion matrix:
       0      1
0  22001   3843
1     40  25812
---- Validation: 
scalar performance:
{'acc': 0.7914623, 'precision': 0.5412728, 'recall': 0.80098903, 'specificity': 0.80098903, 'f1': 0.5202648, 'auroc': 0.84880006, 'binary_precision': 0.088488646, 'binary_recall': 0.81100476, 'binary_specificity': 0.7909733, 'binary_f1_score': 0.15956697}
confusion matrix:
       0     1
0  13214  3492
1     79   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92281014, 'precision': 0.7650979, 'recall': 0.53079337, 'specificity': 0.53079337, 'f1': 0.5387098, 'auroc': 0.74635524, 'binary_precision': 0.60465115, 'binary_recall': 0.06524467, 'binary_specificity': 0.9963421, 'binary_f1_score': 0.11778029}
confusion matrix:
      0   1
0  9261  34
1   745  52
early stop counter: 12
val acc:0.7914623022079468, best validation acc: 0.9581289291381836, corresponding to test acc:                         0.915081262588501 / 0.9233055710792542
after epoch: 15,now: 2024-08-11 00:19:34.387404,epoch time: 0:16:06.761851,used: 4:03:07.328575,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_26_seed_2_24141962
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:03:07.328575 at 2024-08-11 00:19:34.387404
persisted model performance metric: 

scalar performance:
{'acc': 0.91508126, 'precision': 0.66267586, 'recall': 0.5615848, 'specificity': 0.5615848, 'f1': 0.5819064, 'auroc': 0.87220716, 'binary_precision': 0.3951049, 'binary_recall': 0.14178169, 'binary_specificity': 0.98138785, 'binary_f1_score': 0.20867959}
confusion matrix:
      0    1
0  9122  173
1   684  113
oracle model performance metric: 

scalar performance:
{'acc': 0.9233056, 'precision': 0.7893301, 'recall': 0.5293417, 'specificity': 0.5293417, 'f1': 0.5361533, 'auroc': 0.8245175, 'binary_precision': 0.6533333, 'binary_recall': 0.061480552, 'binary_specificity': 0.9972028, 'binary_f1_score': 0.11238532}
confusion matrix:
      0   1
0  9269  26
1   748  49
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 470488 KiB |   3238 MiB | 732912 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 470488 KiB |   3238 MiB | 732912 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 722604 GiB | 722604 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 720548 GiB | 720547 GiB |
|       from small pool |  71980 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3482 MiB |   3482 MiB |   7884 MiB |   4402 MiB |
|       from large pool |   3374 MiB |   3374 MiB |   7722 MiB |   4348 MiB |
|       from small pool |    108 MiB |    110 MiB |    162 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 440871 KiB |   1050 MiB | 539869 GiB | 539869 GiB |
|       from large pool | 430496 KiB |   1046 MiB | 537780 GiB | 537780 GiB |
|       from small pool |  10375 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7492    |  152708 K  |  152703 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99186 K  |   99181 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7492    |  152708 K  |  152703 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99186 K  |   99181 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     115    |     210    |      98    |
|       from large pool |      58    |      60    |     129    |      71    |
|       from small pool |      54    |      55    |      81    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3258    |   72572 K  |   72572 K  |
|       from large pool |      19    |      33    |   24786 K  |   24786 K  |
|       from small pool |      52    |    3240    |   47786 K  |   47786 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 732912 GiB | 732912 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 732912 GiB | 732912 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 722604 GiB | 722604 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 720548 GiB | 720548 GiB |
|       from small pool |      0 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    890 MiB |   3482 MiB |   7884 MiB |   6994 MiB |
|       from large pool |    808 MiB |   3374 MiB |   7722 MiB |   6914 MiB |
|       from small pool |     82 MiB |    110 MiB |    162 MiB |     80 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 539870 GiB | 539870 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 537780 GiB | 537780 GiB |
|       from small pool |      0 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7492    |  152708 K  |  152708 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99186 K  |   99186 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7492    |  152708 K  |  152708 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99186 K  |   99186 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     115    |     210    |     149    |
|       from large pool |      20    |      60    |     129    |     109    |
|       from small pool |      41    |      55    |      81    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3258    |   72574 K  |   72574 K  |
|       from large pool |       4    |      33    |   24786 K  |   24786 K  |
|       from small pool |       0    |    3240    |   47788 K  |   47788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 00:21:30 2024]
Finished job 0.
1 of 1 steps (100%) done
