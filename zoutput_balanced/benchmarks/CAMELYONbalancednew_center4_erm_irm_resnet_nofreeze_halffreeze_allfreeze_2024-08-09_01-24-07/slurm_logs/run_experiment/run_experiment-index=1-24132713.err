Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 09:32:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713

 Experiment start at: 2024-08-09 09:39:29.778545
before training, model accuracy: 0.6347637176513672
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9618209, 'precision': 0.962434, 'recall': 0.9618081, 'specificity': 0.9618081, 'f1': 0.9618075, 'auroc': 0.99502194, 'binary_precision': 0.94577307, 'binary_recall': 0.9798785, 'binary_specificity': 0.9437376, 'binary_f1_score': 0.96252376}
confusion matrix:
       0      1
0  23886   1424
1    510  24836
---- Validation: 
scalar performance:
{'acc': 0.9392278, 'precision': 0.61719, 'recall': 0.8266931, 'specificity': 0.8266931, 'f1': 0.6644169, 'auroc': 0.88821936, 'binary_precision': 0.24197531, 'binary_recall': 0.70843375, 'binary_specificity': 0.9449525, 'binary_f1_score': 0.36073622}
confusion matrix:
       0    1
0  15810  921
1    121  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.915266, 'precision': 0.67533267, 'recall': 0.61130923, 'specificity': 0.61130923, 'f1': 0.6338001, 'auroc': 0.87062263, 'binary_precision': 0.4105263, 'binary_recall': 0.2525907, 'binary_specificity': 0.9700278, 'binary_f1_score': 0.3127506}
confusion matrix:
      0    1
0  9062  280
1   577  195
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 09:56:30.551309,epoch time: 0:17:00.772764,used: 0:17:00.772764,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97368526, 'precision': 0.97371525, 'recall': 0.9736831, 'specificity': 0.9736831, 'f1': 0.9736848, 'auroc': 0.9968675, 'binary_precision': 0.97008264, 'binary_recall': 0.97754717, 'binary_specificity': 0.96981907, 'binary_f1_score': 0.9738006}
confusion matrix:
       0      1
0  24550    764
1    569  24773
---- Validation: 
scalar performance:
{'acc': 0.94680977, 'precision': 0.6300056, 'recall': 0.8223536, 'specificity': 0.8223536, 'f1': 0.67923605, 'auroc': 0.9038987, 'binary_precision': 0.26797387, 'binary_recall': 0.6915663, 'binary_specificity': 0.95314085, 'binary_f1_score': 0.3862719}
confusion matrix:
       0    1
0  15947  784
1    128  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197152, 'precision': 0.7153168, 'recall': 0.7153168, 'specificity': 0.7153168, 'f1': 0.7153168, 'auroc': 0.89745545, 'binary_precision': 0.47409326, 'binary_recall': 0.47409326, 'binary_specificity': 0.95654035, 'binary_f1_score': 0.47409326}
confusion matrix:
      0    1
0  8936  406
1   406  366
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 10:12:55.142835,epoch time: 0:16:24.591526,used: 0:33:25.364290,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9636173, 'precision': 0.9650358, 'recall': 0.96359885, 'specificity': 0.96359885, 'f1': 0.96358854, 'auroc': 0.9979303, 'binary_precision': 0.93951976, 'binary_recall': 0.991083, 'binary_specificity': 0.9361147, 'binary_f1_score': 0.9646128}
confusion matrix:
       0      1
0  23694   1617
1    226  25119
---- Validation: 
scalar performance:
{'acc': 0.8961857, 'precision': 0.57747024, 'recall': 0.8398863, 'specificity': 0.8398863, 'f1': 0.60551196, 'auroc': 0.905861, 'binary_precision': 0.1609538, 'binary_recall': 0.7807229, 'binary_specificity': 0.89904964, 'binary_f1_score': 0.26688635}
confusion matrix:
       0     1
0  15042  1689
1     91   324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9184299, 'precision': 0.6790143, 'recall': 0.58272046, 'specificity': 0.58272046, 'f1': 0.6078001, 'auroc': 0.8961992, 'binary_precision': 0.4222874, 'binary_recall': 0.1865285, 'binary_specificity': 0.9789124, 'binary_f1_score': 0.25876012}
confusion matrix:
      0    1
0  9145  197
1   628  144
early stop counter: 1
val acc:0.8961856961250305, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9197152256965637
after epoch: 3,now: 2024-08-09 10:29:13.271407,epoch time: 0:16:18.128572,used: 0:49:43.492862,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96375555, 'precision': 0.9656689, 'recall': 0.96374035, 'specificity': 0.96374035, 'f1': 0.9637174, 'auroc': 0.9985874, 'binary_precision': 0.9359374, 'binary_recall': 0.9956985, 'binary_specificity': 0.93178225, 'binary_f1_score': 0.9648935}
confusion matrix:
       0      1
0  23589   1727
1    109  25231
---- Validation: 
scalar performance:
{'acc': 0.87157357, 'precision': 0.56617427, 'recall': 0.84489894, 'specificity': 0.84489894, 'f1': 0.582658, 'auroc': 0.90987027, 'binary_precision': 0.13752535, 'binary_recall': 0.8168675, 'binary_specificity': 0.87293047, 'binary_f1_score': 0.23541668}
confusion matrix:
       0     1
0  14605  2126
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92050624, 'precision': 0.6532289, 'recall': 0.52799463, 'specificity': 0.52799463, 'f1': 0.5345066, 'auroc': 0.8910198, 'binary_precision': 0.37878788, 'binary_recall': 0.06476684, 'binary_specificity': 0.99122244, 'binary_f1_score': 0.11061947}
confusion matrix:
      0   1
0  9260  82
1   722  50
new oracle model saved
early stop counter: 2
val acc:0.8715735673904419, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9205062389373779
after epoch: 4,now: 2024-08-09 10:45:27.052421,epoch time: 0:16:13.781014,used: 1:05:57.273876,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.966539, 'precision': 0.9679533, 'recall': 0.96652174, 'specificity': 0.96652174, 'f1': 0.9665128, 'auroc': 0.9985515, 'binary_precision': 0.94238466, 'binary_recall': 0.99388415, 'binary_specificity': 0.9391593, 'binary_f1_score': 0.96744955}
confusion matrix:
       0      1
0  23772   1540
1    155  25189
---- Validation: 
scalar performance:
{'acc': 0.88463783, 'precision': 0.57099295, 'recall': 0.8386688, 'specificity': 0.8386688, 'f1': 0.5932853, 'auroc': 0.90483886, 'binary_precision': 0.14781433, 'binary_recall': 0.79036146, 'binary_specificity': 0.88697624, 'binary_f1_score': 0.24905087}
confusion matrix:
       0     1
0  14840  1891
1     87   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212972, 'precision': 0.64939374, 'recall': 0.5195106, 'specificity': 0.5195106, 'f1': 0.51985997, 'auroc': 0.89638144, 'binary_precision': 0.3723404, 'binary_recall': 0.045336787, 'binary_specificity': 0.9936844, 'binary_f1_score': 0.0808314}
confusion matrix:
      0   1
0  9283  59
1   737  35
new oracle model saved
early stop counter: 3
val acc:0.8846378326416016, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9212971925735474
after epoch: 5,now: 2024-08-09 11:02:03.817099,epoch time: 0:16:36.764678,used: 1:22:34.038554,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9471139, 'precision': 0.95165503, 'recall': 0.94708425, 'specificity': 0.94708425, 'f1': 0.94697815, 'auroc': 0.99862075, 'binary_precision': 0.9065146, 'binary_recall': 0.99711955, 'binary_specificity': 0.89704895, 'binary_f1_score': 0.9496609}
confusion matrix:
       0      1
0  22707   2606
1     73  25270
---- Validation: 
scalar performance:
{'acc': 0.77242506, 'precision': 0.53928816, 'recall': 0.80701935, 'specificity': 0.80701935, 'f1': 0.5103415, 'auroc': 0.89013505, 'binary_precision': 0.08359207, 'binary_recall': 0.8433735, 'binary_specificity': 0.7706652, 'binary_f1_score': 0.15210779}
confusion matrix:
       0     1
0  12894  3837
1     65   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210995, 'precision': 0.63365036, 'recall': 0.51524454, 'specificity': 0.51524454, 'f1': 0.51219225, 'auroc': 0.85622644, 'binary_precision': 0.34146342, 'binary_recall': 0.03626943, 'binary_specificity': 0.99421966, 'binary_f1_score': 0.065573774}
confusion matrix:
      0   1
0  9288  54
1   744  28
early stop counter: 4
val acc:0.7724250555038452, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9212971925735474
after epoch: 6,now: 2024-08-09 11:18:23.974459,epoch time: 0:16:20.157360,used: 1:38:54.195914,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94654137, 'precision': 0.9510586, 'recall': 0.94651175, 'specificity': 0.94651175, 'f1': 0.9464047, 'auroc': 0.99767435, 'binary_precision': 0.90606725, 'binary_recall': 0.9964487, 'binary_specificity': 0.89657485, 'binary_f1_score': 0.94911116}
confusion matrix:
       0      1
0  22695   2618
1     90  25253
---- Validation: 
scalar performance:
{'acc': 0.8446868, 'precision': 0.5501964, 'recall': 0.7958741, 'specificity': 0.7958741, 'f1': 0.55124223, 'auroc': 0.87038636, 'binary_precision': 0.10781577, 'binary_recall': 0.7445783, 'binary_specificity': 0.84716994, 'binary_f1_score': 0.1883572}
confusion matrix:
       0     1
0  14174  2557
1    106   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9224837, 'precision': 0.65493935, 'recall': 0.51124066, 'specificity': 0.51124066, 'f1': 0.5040698, 'auroc': 0.87105894, 'binary_precision': 0.3846154, 'binary_recall': 0.025906736, 'binary_specificity': 0.9965746, 'binary_f1_score': 0.048543688}
confusion matrix:
      0   1
0  9310  32
1   752  20
new oracle model saved
early stop counter: 5
val acc:0.8446868062019348, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9224836826324463
after epoch: 7,now: 2024-08-09 11:34:53.634165,epoch time: 0:16:29.659706,used: 1:55:23.855620,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93266344, 'precision': 0.94009376, 'recall': 0.93262756, 'specificity': 0.93262756, 'f1': 0.93237424, 'auroc': 0.9974232, 'binary_precision': 0.88304746, 'binary_recall': 0.997514, 'binary_specificity': 0.86774117, 'binary_f1_score': 0.9367971}
confusion matrix:
       0      1
0  21966   3348
1     63  25279
---- Validation: 
scalar performance:
{'acc': 0.81132627, 'precision': 0.5379425, 'recall': 0.75528145, 'specificity': 0.75528145, 'f1': 0.52272403, 'auroc': 0.84836715, 'binary_precision': 0.08505003, 'binary_recall': 0.69638556, 'binary_specificity': 0.8141773, 'binary_f1_score': 0.15158668}
confusion matrix:
       0     1
0  13622  3109
1    126   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92011076, 'precision': 0.624859, 'recall': 0.51768005, 'specificity': 0.51768005, 'f1': 0.5168832, 'auroc': 0.82020926, 'binary_precision': 0.32352942, 'binary_recall': 0.042746115, 'binary_specificity': 0.99261403, 'binary_f1_score': 0.075514875}
confusion matrix:
      0   1
0  9273  69
1   739  33
early stop counter: 6
val acc:0.811326265335083, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9224836826324463
after epoch: 8,now: 2024-08-09 11:51:24.378284,epoch time: 0:16:30.744119,used: 2:11:54.599739,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9434223, 'precision': 0.94854116, 'recall': 0.9433949, 'specificity': 0.9433949, 'f1': 0.94325805, 'auroc': 0.9976381, 'binary_precision': 0.9007525, 'binary_recall': 0.99672467, 'binary_specificity': 0.8900652, 'binary_f1_score': 0.94631153}
confusion matrix:
       0      1
0  22532   2783
1     83  25258
---- Validation: 
scalar performance:
{'acc': 0.8366966, 'precision': 0.5498589, 'recall': 0.80705404, 'specificity': 0.80705404, 'f1': 0.54811215, 'auroc': 0.8796772, 'binary_precision': 0.10630571, 'binary_recall': 0.77590364, 'binary_specificity': 0.8382045, 'binary_f1_score': 0.18699187}
confusion matrix:
       0     1
0  14024  2707
1     93   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9224837, 'precision': 0.6442809, 'recall': 0.5088641, 'specificity': 0.5088641, 'f1': 0.49941415, 'auroc': 0.8533788, 'binary_precision': 0.36363637, 'binary_recall': 0.020725388, 'binary_specificity': 0.9970028, 'binary_f1_score': 0.039215684}
confusion matrix:
      0   1
0  9314  28
1   756  16
early stop counter: 7
val acc:0.8366966247558594, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9224836826324463
after epoch: 9,now: 2024-08-09 12:07:52.060760,epoch time: 0:16:27.682476,used: 2:28:22.282215,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.93363076, 'precision': 0.94086313, 'recall': 0.9335954, 'specificity': 0.9335954, 'f1': 0.93335366, 'auroc': 0.99755657, 'binary_precision': 0.88453466, 'binary_recall': 0.99755347, 'binary_specificity': 0.86963737, 'binary_f1_score': 0.9376506}
confusion matrix:
       0      1
0  22014   3300
1     62  25280
---- Validation: 
scalar performance:
{'acc': 0.8290563, 'precision': 0.5458417, 'recall': 0.7902149, 'specificity': 0.7902149, 'f1': 0.5398561, 'auroc': 0.866471, 'binary_precision': 0.09910771, 'binary_recall': 0.7493976, 'binary_specificity': 0.8310322, 'binary_f1_score': 0.17506334}
confusion matrix:
       0     1
0  13904  2827
1    104   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92070395, 'precision': 0.62771904, 'recall': 0.5156246, 'specificity': 0.5156246, 'f1': 0.51301664, 'auroc': 0.8342984, 'binary_precision': 0.32954547, 'binary_recall': 0.037564766, 'binary_specificity': 0.9936844, 'binary_f1_score': 0.06744186}
confusion matrix:
      0   1
0  9283  59
1   743  29
early stop counter: 8
val acc:0.8290563225746155, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9224836826324463
after epoch: 10,now: 2024-08-09 12:24:06.388144,epoch time: 0:16:14.327384,used: 2:44:36.609599,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94369864, 'precision': 0.94896305, 'recall': 0.9436667, 'specificity': 0.9436667, 'f1': 0.9435303, 'auroc': 0.998765, 'binary_precision': 0.90049505, 'binary_recall': 0.9977114, 'binary_specificity': 0.8896219, 'binary_f1_score': 0.9466138}
confusion matrix:
       0      1
0  22519   2794
1     58  25285
---- Validation: 
scalar performance:
{'acc': 0.8108013, 'precision': 0.54356915, 'recall': 0.79848504, 'specificity': 0.79848504, 'f1': 0.53031325, 'auroc': 0.8802147, 'binary_precision': 0.09365125, 'binary_recall': 0.7855422, 'binary_specificity': 0.8114279, 'binary_f1_score': 0.16735114}
confusion matrix:
       0     1
0  13576  3155
1     89   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9222859, 'precision': 0.6290376, 'recall': 0.5075688, 'specificity': 0.5075688, 'f1': 0.4969559, 'auroc': 0.86630636, 'binary_precision': 0.33333334, 'binary_recall': 0.018134715, 'binary_specificity': 0.9970028, 'binary_f1_score': 0.034398034}
confusion matrix:
      0   1
0  9314  28
1   758  14
early stop counter: 9
val acc:0.8108013272285461, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9224836826324463
after epoch: 11,now: 2024-08-09 12:40:21.463291,epoch time: 0:16:15.075147,used: 3:00:51.684746,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9397307, 'precision': 0.94570816, 'recall': 0.9396988, 'specificity': 0.9396988, 'f1': 0.93952495, 'auroc': 0.9976698, 'binary_precision': 0.8942304, 'binary_recall': 0.997514, 'binary_specificity': 0.88188356, 'binary_f1_score': 0.9430527}
confusion matrix:
       0      1
0  22324   2990
1     63  25279
---- Validation: 
scalar performance:
{'acc': 0.84107083, 'precision': 0.5503881, 'recall': 0.8034207, 'specificity': 0.8034207, 'f1': 0.5503265, 'auroc': 0.8814294, 'binary_precision': 0.10767663, 'binary_recall': 0.7638554, 'binary_specificity': 0.84298605, 'binary_f1_score': 0.18874666}
confusion matrix:
       0     1
0  14104  2627
1     98   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92080283, 'precision': 0.6104981, 'recall': 0.51092494, 'specificity': 0.51092494, 'f1': 0.5042507, 'auroc': 0.8154222, 'binary_precision': 0.29577464, 'binary_recall': 0.027202072, 'binary_specificity': 0.9946478, 'binary_f1_score': 0.049822062}
confusion matrix:
      0   1
0  9292  50
1   751  21
early stop counter: 10
val acc:0.841070830821991, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9224836826324463
after epoch: 12,now: 2024-08-09 12:56:40.421473,epoch time: 0:16:18.958182,used: 3:17:10.642928,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9255567, 'precision': 0.93476576, 'recall': 0.9255079, 'specificity': 0.9255079, 'f1': 0.92515457, 'auroc': 0.99722415, 'binary_precision': 0.87165797, 'binary_recall': 0.99818504, 'binary_specificity': 0.85283077, 'binary_f1_score': 0.93064064}
confusion matrix:
       0      1
0  21586   3725
1     46  25299
---- Validation: 
scalar performance:
{'acc': 0.82345736, 'precision': 0.5451447, 'recall': 0.79322064, 'specificity': 0.79322064, 'f1': 0.5369549, 'auroc': 0.86373186, 'binary_precision': 0.097410604, 'binary_recall': 0.76144576, 'binary_specificity': 0.8249955, 'binary_f1_score': 0.17272478}
confusion matrix:
       0     1
0  13803  2928
1     99   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.909037, 'precision': 0.56667084, 'recall': 0.52297443, 'specificity': 0.52297443, 'f1': 0.5268279, 'auroc': 0.76493204, 'binary_precision': 0.20634921, 'binary_recall': 0.06735751, 'binary_specificity': 0.9785913, 'binary_f1_score': 0.10156249}
confusion matrix:
      0    1
0  9142  200
1   720   52
early stop counter: 11
val acc:0.8234573602676392, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9224836826324463
after epoch: 13,now: 2024-08-09 13:12:59.594342,epoch time: 0:16:19.172869,used: 3:33:29.815797,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9303735, 'precision': 0.938326, 'recall': 0.9303204, 'specificity': 0.9303204, 'f1': 0.9300504, 'auroc': 0.9977025, 'binary_precision': 0.87948245, 'binary_recall': 0.99755406, 'binary_specificity': 0.86308676, 'binary_f1_score': 0.93480474}
confusion matrix:
       0      1
0  21843   3465
1     62  25286
---- Validation: 
scalar performance:
{'acc': 0.821766, 'precision': 0.5390599, 'recall': 0.7512313, 'specificity': 0.7512313, 'f1': 0.5278531, 'auroc': 0.84543014, 'binary_precision': 0.08773025, 'binary_recall': 0.6771084, 'binary_specificity': 0.82535416, 'binary_f1_score': 0.15533444}
confusion matrix:
       0     1
0  13809  2922
1    134   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91170657, 'precision': 0.5578217, 'recall': 0.5155073, 'specificity': 0.5155073, 'f1': 0.5150811, 'auroc': 0.70319283, 'binary_precision': 0.1897436, 'binary_recall': 0.04792746, 'binary_specificity': 0.9830871, 'binary_f1_score': 0.076525345}
confusion matrix:
      0    1
0  9184  158
1   735   37
early stop counter: 12
val acc:0.8217660188674927, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9224836826324463
after epoch: 14,now: 2024-08-09 13:29:21.486728,epoch time: 0:16:21.892386,used: 3:49:51.708183,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.921115, 'precision': 0.9315357, 'recall': 0.92107207, 'specificity': 0.92107207, 'f1': 0.9206304, 'auroc': 0.9982115, 'binary_precision': 0.86461467, 'binary_recall': 0.9986978, 'binary_specificity': 0.8434463, 'binary_f1_score': 0.92683196}
confusion matrix:
       0      1
0  21351   3963
1     33  25309
---- Validation: 
scalar performance:
{'acc': 0.77236676, 'precision': 0.53609014, 'recall': 0.779966, 'specificity': 0.779966, 'f1': 0.506128, 'auroc': 0.84999144, 'binary_precision': 0.078947365, 'binary_recall': 0.7879518, 'binary_specificity': 0.77198017, 'binary_f1_score': 0.14351547}
confusion matrix:
       0     1
0  12916  3815
1     88   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.912893, 'precision': 0.56408757, 'recall': 0.5161496, 'specificity': 0.5161496, 'f1': 0.5158876, 'auroc': 0.77810013, 'binary_precision': 0.2021858, 'binary_recall': 0.04792746, 'binary_specificity': 0.98437166, 'binary_f1_score': 0.07748692}
confusion matrix:
      0    1
0  9196  146
1   735   37
early stop counter: 13
val acc:0.7723667621612549, best validation acc: 0.9468097686767578, corresponding to test acc:                         0.9197152256965637 / 0.9224836826324463
after epoch: 15,now: 2024-08-09 13:45:36.634710,epoch time: 0:16:15.147982,used: 4:06:06.856165,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_39_29_seed_0_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:06:06.856165 at 2024-08-09 13:45:36.634710
persisted model performance metric: 

scalar performance:
{'acc': 0.9197152, 'precision': 0.7153168, 'recall': 0.7153168, 'specificity': 0.7153168, 'f1': 0.7153168, 'auroc': 0.89745545, 'binary_precision': 0.47409326, 'binary_recall': 0.47409326, 'binary_specificity': 0.95654035, 'binary_f1_score': 0.47409326}
confusion matrix:
      0    1
0  8936  406
1   406  366
oracle model performance metric: 

scalar performance:
{'acc': 0.9224837, 'precision': 0.65493935, 'recall': 0.51124066, 'specificity': 0.51124066, 'f1': 0.5040698, 'auroc': 0.87105894, 'binary_precision': 0.3846154, 'binary_recall': 0.025906736, 'binary_specificity': 0.9965746, 'binary_f1_score': 0.048543688}
confusion matrix:
      0   1
0  9310  32
1   752  20
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493870 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool | 403328 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |  90542 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493870 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool | 403328 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |  90542 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476753 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |  88913 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11490 MiB |  11490 MiB |  11490 MiB |      0 B   |
|       from large pool |  11362 MiB |  11362 MiB |  11362 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 751313 KiB |   1257 MiB | 127121 GiB | 127120 GiB |
|       from large pool | 741504 KiB |   1255 MiB | 126061 GiB | 126060 GiB |
|       from small pool |   9809 KiB |     10 MiB |   1059 GiB |   1059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5175    |    7578    |   56675 K  |   56670 K  |
|       from large pool |      87    |     908    |   21002 K  |   21002 K  |
|       from small pool |    5088    |    7489    |   35672 K  |   35667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5175    |    7578    |   56675 K  |   56670 K  |
|       from large pool |      87    |     908    |   21002 K  |   21002 K  |
|       from small pool |    5088    |    7489    |   35672 K  |   35667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     408    |     408    |       0    |
|       from large pool |     344    |     344    |     344    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3196    |   30694 K  |   30694 K  |
|       from large pool |      19    |     189    |   13629 K  |   13629 K  |
|       from small pool |      54    |    3175    |   17065 K  |   17065 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |      0 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11490 MiB |  11490 MiB |  10274 MiB |
|       from large pool |   1118 MiB |  11362 MiB |  11362 MiB |  10244 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1257 MiB | 127121 GiB | 127121 GiB |
|       from large pool |  50944 KiB |   1255 MiB | 126061 GiB | 126061 GiB |
|       from small pool |      0 KiB |     26 MiB |   1059 GiB |   1059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56675 K  |   56675 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35672 K  |   35672 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56675 K  |   56675 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35672 K  |   35672 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     408    |     408    |     329    |
|       from large pool |      30    |     344    |     344    |     314    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3196    |   30696 K  |   30696 K  |
|       from large pool |       4    |     189    |   13629 K  |   13629 K  |
|       from small pool |       0    |    3175    |   17067 K  |   17067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 335649 GiB | 335649 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 334731 GiB | 334731 GiB |
|       from small pool |      0 KiB |    125 MiB |    917 GiB |    917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 332150 GiB | 332150 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 331243 GiB | 331243 GiB |
|       from small pool |      0 KiB |    124 MiB |    907 GiB |    907 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11490 MiB |  11490 MiB |  10274 MiB |
|       from large pool |   1118 MiB |  11362 MiB |  11362 MiB |  10244 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1257 MiB | 127121 GiB | 127121 GiB |
|       from large pool |  50944 KiB |   1255 MiB | 126061 GiB | 126061 GiB |
|       from small pool |      0 KiB |     26 MiB |   1059 GiB |   1059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56675 K  |   56675 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35672 K  |   35672 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56675 K  |   56675 K  |
|       from large pool |       2    |     908    |   21002 K  |   21002 K  |
|       from small pool |       0    |    7489    |   35672 K  |   35672 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     408    |     408    |     329    |
|       from large pool |      30    |     344    |     344    |     314    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3196    |   30696 K  |   30696 K  |
|       from large pool |       4    |     189    |   13629 K  |   13629 K  |
|       from small pool |       0    |    3175    |   17067 K  |   17067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713

 Experiment start at: 2024-08-09 14:05:35.559599
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9621892, 'precision': 0.9629313, 'recall': 0.96217275, 'specificity': 0.96217275, 'f1': 0.962173, 'auroc': 0.99527216, 'binary_precision': 0.944602, 'binary_recall': 0.982034, 'binary_specificity': 0.94231147, 'binary_f1_score': 0.9629544}
confusion matrix:
       0      1
0  23930   1465
1    457  24980
---- Validation: 
scalar performance:
{'acc': 0.9038136, 'precision': 0.57766885, 'recall': 0.79922646, 'specificity': 0.79922646, 'f1': 0.6067997, 'auroc': 0.859614, 'binary_precision': 0.1640884, 'binary_recall': 0.68909514, 'binary_specificity': 0.9093578, 'binary_f1_score': 0.26506025}
confusion matrix:
       0     1
0  15179  1513
1    134   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9218115, 'precision': 0.7218312, 'recall': 0.74712896, 'specificity': 0.74712896, 'f1': 0.7335762, 'auroc': 0.8925084, 'binary_precision': 0.48122066, 'binary_recall': 0.5416116, 'binary_specificity': 0.95264626, 'binary_f1_score': 0.5096333}
confusion matrix:
      0    1
0  8892  442
1   347  410
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 14:23:01.079189,epoch time: 0:17:25.519590,used: 0:17:25.519590,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97716004, 'precision': 0.9771637, 'recall': 0.97716105, 'specificity': 0.97716105, 'f1': 0.97716, 'auroc': 0.9967413, 'binary_precision': 0.97866213, 'binary_recall': 0.97562224, 'binary_specificity': 0.9786999, 'binary_f1_score': 0.9771398}
confusion matrix:
       0      1
0  24858    541
1    620  24813
---- Validation: 
scalar performance:
{'acc': 0.95380485, 'precision': 0.6452899, 'recall': 0.7954839, 'specificity': 0.7954839, 'f1': 0.6912843, 'auroc': 0.8789798, 'binary_precision': 0.30044347, 'binary_recall': 0.6287703, 'binary_specificity': 0.9621975, 'binary_f1_score': 0.40660167}
confusion matrix:
       0    1
0  16061  631
1    160  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91992867, 'precision': 0.6722696, 'recall': 0.56767243, 'specificity': 0.56767243, 'f1': 0.59043306, 'auroc': 0.8918343, 'binary_precision': 0.409894, 'binary_recall': 0.15323646, 'binary_specificity': 0.9821084, 'binary_f1_score': 0.22307692}
confusion matrix:
      0    1
0  9167  167
1   641  116
better model found
persisted
after epoch: 2,now: 2024-08-09 14:39:37.118787,epoch time: 0:16:36.039598,used: 0:34:01.559188,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9749764, 'precision': 0.97503966, 'recall': 0.974972, 'specificity': 0.974972, 'f1': 0.97497535, 'auroc': 0.9974977, 'binary_precision': 0.9697512, 'binary_recall': 0.9805787, 'binary_specificity': 0.96936524, 'binary_f1_score': 0.9751349}
confusion matrix:
       0      1
0  24618    778
1    494  24942
---- Validation: 
scalar performance:
{'acc': 0.93540853, 'precision': 0.61399007, 'recall': 0.8210825, 'specificity': 0.8210825, 'f1': 0.6596116, 'auroc': 0.882942, 'binary_precision': 0.23612197, 'binary_recall': 0.70069605, 'binary_specificity': 0.94146895, 'binary_f1_score': 0.35321635}
confusion matrix:
       0    1
0  15715  977
1    129  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9215142, 'precision': 0.61519265, 'recall': 0.51451236, 'specificity': 0.51451236, 'f1': 0.511435, 'auroc': 0.89119935, 'binary_precision': 0.30337077, 'binary_recall': 0.035667107, 'binary_specificity': 0.9933576, 'binary_f1_score': 0.06382979}
confusion matrix:
      0   1
0  9272  62
1   730  27
early stop counter: 1
val acc:0.9354085326194763, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9218115210533142
after epoch: 3,now: 2024-08-09 14:55:57.745673,epoch time: 0:16:20.626886,used: 0:50:22.186074,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96856314, 'precision': 0.96974957, 'recall': 0.9685434, 'specificity': 0.9685434, 'f1': 0.9685423, 'auroc': 0.9982474, 'binary_precision': 0.94633764, 'binary_recall': 0.9935131, 'binary_specificity': 0.9435738, 'binary_f1_score': 0.9693517}
confusion matrix:
       0      1
0  23963   1433
1    165  25271
---- Validation: 
scalar performance:
{'acc': 0.8858261, 'precision': 0.57484037, 'recall': 0.843117, 'specificity': 0.843117, 'f1': 0.5992245, 'auroc': 0.89452744, 'binary_precision': 0.15551537, 'binary_recall': 0.79814386, 'binary_specificity': 0.8880901, 'binary_f1_score': 0.26031026}
confusion matrix:
       0     1
0  14824  1868
1     87   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9219106, 'precision': 0.6265286, 'recall': 0.5159405, 'specificity': 0.5159405, 'f1': 0.5139025, 'auroc': 0.9042324, 'binary_precision': 0.3258427, 'binary_recall': 0.038309116, 'binary_specificity': 0.9935719, 'binary_f1_score': 0.06855792}
confusion matrix:
      0   1
0  9274  60
1   728  29
new oracle model saved
early stop counter: 2
val acc:0.8858261108398438, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9219105839729309
after epoch: 4,now: 2024-08-09 15:12:37.238694,epoch time: 0:16:39.493021,used: 1:07:01.679095,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94936264, 'precision': 0.9534141, 'recall': 0.94932735, 'specificity': 0.94932735, 'f1': 0.9492464, 'auroc': 0.99792767, 'binary_precision': 0.9107406, 'binary_recall': 0.9964616, 'binary_specificity': 0.9021932, 'binary_f1_score': 0.95167464}
confusion matrix:
       0      1
0  22913   2484
1     90  25345
---- Validation: 
scalar performance:
{'acc': 0.77083457, 'precision': 0.541881, 'recall': 0.8180407, 'specificity': 0.8180407, 'f1': 0.5137093, 'auroc': 0.8973098, 'binary_precision': 0.08818675, 'binary_recall': 0.8677494, 'binary_specificity': 0.7683321, 'binary_f1_score': 0.16010274}
confusion matrix:
       0     1
0  12825  3867
1     57   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239917, 'precision': 0.573734, 'recall': 0.5018921, 'specificity': 0.5018921, 'f1': 0.48540035, 'auroc': 0.8868579, 'binary_precision': 0.22222222, 'binary_recall': 0.005284016, 'binary_specificity': 0.9985001, 'binary_f1_score': 0.010322581}
confusion matrix:
      0   1
0  9320  14
1   753   4
new oracle model saved
early stop counter: 3
val acc:0.7708345651626587, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9239916801452637
after epoch: 5,now: 2024-08-09 15:29:07.709138,epoch time: 0:16:30.470444,used: 1:23:32.149539,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93921155, 'precision': 0.94512385, 'recall': 0.93916404, 'specificity': 0.93916404, 'f1': 0.9390044, 'auroc': 0.99658215, 'binary_precision': 0.8940297, 'binary_recall': 0.9966584, 'binary_specificity': 0.88166964, 'binary_f1_score': 0.94255865}
confusion matrix:
       0      1
0  22390   3005
1     85  25352
---- Validation: 
scalar performance:
{'acc': 0.8490919, 'precision': 0.5564853, 'recall': 0.81749475, 'specificity': 0.81749475, 'f1': 0.5619847, 'auroc': 0.8691293, 'binary_precision': 0.11947685, 'binary_recall': 0.7842227, 'binary_specificity': 0.85076684, 'binary_f1_score': 0.20736197}
confusion matrix:
       0     1
0  14201  2491
1     93   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92528, 'precision': 0.79608876, 'recall': 0.5038023, 'specificity': 0.5038023, 'f1': 0.48841593, 'auroc': 0.87562907, 'binary_precision': 0.6666667, 'binary_recall': 0.007926024, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.015665796}
confusion matrix:
      0  1
0  9331  3
1   751  6
new oracle model saved
early stop counter: 4
val acc:0.8490918874740601, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.925279974937439
after epoch: 6,now: 2024-08-09 15:49:02.357150,epoch time: 0:19:54.648012,used: 1:43:26.797551,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96199244, 'precision': 0.9637693, 'recall': 0.9619682, 'specificity': 0.9619682, 'f1': 0.9619546, 'auroc': 0.9977504, 'binary_precision': 0.9352593, 'binary_recall': 0.99276614, 'binary_specificity': 0.9311703, 'binary_f1_score': 0.96315503}
confusion matrix:
       0      1
0  23648   1748
1    184  25252
---- Validation: 
scalar performance:
{'acc': 0.88185483, 'precision': 0.5636461, 'recall': 0.78909373, 'specificity': 0.78909373, 'f1': 0.5818017, 'auroc': 0.87034935, 'binary_precision': 0.13619745, 'binary_recall': 0.6914153, 'binary_specificity': 0.8867721, 'binary_f1_score': 0.22756778}
confusion matrix:
       0     1
0  14802  1890
1    133   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.85507524, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 5
val acc:0.8818548321723938, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.925279974937439
after epoch: 7,now: 2024-08-09 16:09:53.211772,epoch time: 0:20:50.854622,used: 2:04:17.652173,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9315785, 'precision': 0.9393121, 'recall': 0.93152905, 'specificity': 0.93152905, 'f1': 0.93127066, 'auroc': 0.9973438, 'binary_precision': 0.88121116, 'binary_recall': 0.997759, 'binary_specificity': 0.86529905, 'binary_f1_score': 0.93587047}
confusion matrix:
       0      1
0  21976   3421
1     57  25378
---- Validation: 
scalar performance:
{'acc': 0.72750103, 'precision': 0.53606117, 'recall': 0.8037255, 'specificity': 0.8037255, 'f1': 0.48923522, 'auroc': 0.86324, 'binary_precision': 0.07624575, 'binary_recall': 0.8839907, 'binary_specificity': 0.7234603, 'binary_f1_score': 0.1403832}
confusion matrix:
       0     1
0  12076  4616
1     50   381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92537904, 'precision': 0.96267474, 'recall': 0.50264204, 'specificity': 0.50264204, 'f1': 0.48587, 'auroc': 0.86706746, 'binary_precision': 1.0, 'binary_recall': 0.005284016, 'binary_specificity': 1.0, 'binary_f1_score': 0.010512483}
confusion matrix:
      0  1
0  9334  0
1   753  4
new oracle model saved
early stop counter: 6
val acc:0.7275010347366333, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9253790378570557
after epoch: 8,now: 2024-08-09 16:30:29.830093,epoch time: 0:20:36.618321,used: 2:24:54.270494,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94218206, 'precision': 0.94776773, 'recall': 0.9421339, 'specificity': 0.9421339, 'f1': 0.94199675, 'auroc': 0.99701214, 'binary_precision': 0.8979729, 'binary_recall': 0.9978379, 'binary_specificity': 0.88642985, 'binary_f1_score': 0.94527507}
confusion matrix:
       0      1
0  22510   2884
1     55  25383
---- Validation: 
scalar performance:
{'acc': 0.82000816, 'precision': 0.5498971, 'recall': 0.82065964, 'specificity': 0.82065964, 'f1': 0.54280615, 'auroc': 0.86980325, 'binary_precision': 0.10538851, 'binary_recall': 0.8213457, 'binary_specificity': 0.81997365, 'binary_f1_score': 0.1868074}
confusion matrix:
       0     1
0  13687  3005
1     77   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92528, 'precision': 0.862671, 'recall': 0.50258845, 'specificity': 0.50258845, 'f1': 0.48583636, 'auroc': 0.85879815, 'binary_precision': 0.8, 'binary_recall': 0.005284016, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.010498689}
confusion matrix:
      0  1
0  9333  1
1   753  4
early stop counter: 7
val acc:0.8200081586837769, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9253790378570557
after epoch: 9,now: 2024-08-09 16:51:54.269591,epoch time: 0:21:24.439498,used: 2:46:18.709992,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9318146, 'precision': 0.93946123, 'recall': 0.9317628, 'specificity': 0.9317628, 'f1': 0.93151104, 'auroc': 0.99598515, 'binary_precision': 0.88168865, 'binary_recall': 0.9976018, 'binary_specificity': 0.86592376, 'binary_f1_score': 0.9360705}
confusion matrix:
       0      1
0  21991   3405
1     61  25375
---- Validation: 
scalar performance:
{'acc': 0.7970566, 'precision': 0.5407831, 'recall': 0.78176427, 'specificity': 0.78176427, 'f1': 0.52210337, 'auroc': 0.83061314, 'binary_precision': 0.08909287, 'binary_recall': 0.76566124, 'binary_specificity': 0.79786724, 'binary_f1_score': 0.15961307}
confusion matrix:
       0     1
0  13318  3374
1    101   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9255772, 'precision': 0.79635334, 'recall': 0.5076046, 'specificity': 0.5076046, 'f1': 0.49613518, 'auroc': 0.8390275, 'binary_precision': 0.6666667, 'binary_recall': 0.015852047, 'binary_specificity': 0.99935716, 'binary_f1_score': 0.030967742}
confusion matrix:
      0   1
0  9328   6
1   745  12
new oracle model saved
early stop counter: 8
val acc:0.7970566153526306, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9255772233009338
after epoch: 10,now: 2024-08-09 17:14:07.193016,epoch time: 0:22:12.923425,used: 3:08:31.633417,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.912437, 'precision': 0.9251156, 'recall': 0.9123692, 'specificity': 0.9123692, 'f1': 0.9117697, 'auroc': 0.996739, 'binary_precision': 0.8518966, 'binary_recall': 0.998624, 'binary_specificity': 0.82611436, 'binary_f1_score': 0.9194433}
confusion matrix:
       0      1
0  20980   4416
1     35  25401
---- Validation: 
scalar performance:
{'acc': 0.6915844, 'precision': 0.53105223, 'recall': 0.77852273, 'specificity': 0.77852273, 'f1': 0.46859375, 'auroc': 0.8452438, 'binary_precision': 0.06696428, 'binary_recall': 0.8700696, 'binary_specificity': 0.6869758, 'binary_f1_score': 0.124357484}
confusion matrix:
       0     1
0  11467  5225
1     56   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92528, 'precision': 0.75704205, 'recall': 0.50623006, 'specificity': 0.50623006, 'f1': 0.49349493, 'auroc': 0.8173896, 'binary_precision': 0.5882353, 'binary_recall': 0.01321004, 'binary_specificity': 0.99925005, 'binary_f1_score': 0.025839793}
confusion matrix:
      0   1
0  9327   7
1   747  10
early stop counter: 9
val acc:0.6915844082832336, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9255772233009338
after epoch: 11,now: 2024-08-09 17:39:54.346679,epoch time: 0:25:47.153663,used: 3:34:18.787080,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9435395, 'precision': 0.9487044, 'recall': 0.9434974, 'specificity': 0.9434974, 'f1': 0.9433728, 'auroc': 0.99763143, 'binary_precision': 0.9007601, 'binary_recall': 0.99701214, 'binary_specificity': 0.8899827, 'binary_f1_score': 0.9464452}
confusion matrix:
       0      1
0  22602   2794
1     76  25360
---- Validation: 
scalar performance:
{'acc': 0.80710155, 'precision': 0.53994876, 'recall': 0.76431364, 'specificity': 0.76431364, 'f1': 0.52455753, 'auroc': 0.8325, 'binary_precision': 0.08877434, 'binary_recall': 0.71925753, 'binary_specificity': 0.80936974, 'binary_f1_score': 0.15804231}
confusion matrix:
       0     1
0  13510  3182
1    121   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92518085, 'precision': 0.83762515, 'recall': 0.501928, 'specificity': 0.501928, 'f1': 0.48450446, 'auroc': 0.84588397, 'binary_precision': 0.75, 'binary_recall': 0.003963012, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.007884363}
confusion matrix:
      0  1
0  9333  1
1   754  3
early stop counter: 10
val acc:0.8071015477180481, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9255772233009338
after epoch: 12,now: 2024-08-09 18:02:00.971943,epoch time: 0:22:06.625264,used: 3:56:25.412344,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9210733, 'precision': 0.9315255, 'recall': 0.9210183, 'specificity': 0.9210183, 'f1': 0.9205855, 'auroc': 0.99826765, 'binary_precision': 0.8645429, 'binary_recall': 0.99874187, 'binary_specificity': 0.84329474, 'binary_f1_score': 0.92680967}
confusion matrix:
       0      1
0  21418   3980
1     32  25402
---- Validation: 
scalar performance:
{'acc': 0.7193249, 'precision': 0.53450066, 'recall': 0.79501134, 'specificity': 0.79501134, 'f1': 0.48403668, 'auroc': 0.88125, 'binary_precision': 0.073503606, 'binary_recall': 0.87470996, 'binary_specificity': 0.7153127, 'binary_f1_score': 0.1356115}
confusion matrix:
       0     1
0  11940  4752
1     54   377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92488354, 'precision': 0.70100486, 'recall': 0.5060158, 'specificity': 0.5060158, 'f1': 0.49332142, 'auroc': 0.81034744, 'binary_precision': 0.47619048, 'binary_recall': 0.01321004, 'binary_specificity': 0.9988215, 'binary_f1_score': 0.025706941}
confusion matrix:
      0   1
0  9323  11
1   747  10
early stop counter: 11
val acc:0.7193248867988586, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9255772233009338
after epoch: 13,now: 2024-08-09 18:25:48.324664,epoch time: 0:23:47.352721,used: 4:20:12.765065,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.922057, 'precision': 0.93205786, 'recall': 0.9219942, 'specificity': 0.9219942, 'f1': 0.92159545, 'auroc': 0.9960314, 'binary_precision': 0.8665301, 'binary_recall': 0.99795574, 'binary_specificity': 0.8460327, 'binary_f1_score': 0.92761093}
confusion matrix:
       0      1
0  21485   3910
1     52  25385
---- Validation: 
scalar performance:
{'acc': 0.7932605, 'precision': 0.537494, 'recall': 0.76060486, 'specificity': 0.76060486, 'f1': 0.51628894, 'auroc': 0.8153956, 'binary_precision': 0.08380187, 'binary_recall': 0.7262181, 'binary_specificity': 0.7949916, 'binary_f1_score': 0.15026404}
confusion matrix:
       0     1
0  13270  3422
1    118   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9217124, 'precision': 0.5820512, 'recall': 0.50733626, 'specificity': 0.50733626, 'f1': 0.4978919, 'auroc': 0.7625404, 'binary_precision': 0.23809524, 'binary_recall': 0.01981506, 'binary_specificity': 0.9948575, 'binary_f1_score': 0.03658536}
confusion matrix:
      0   1
0  9286  48
1   742  15
early stop counter: 12
val acc:0.7932605147361755, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9255772233009338
after epoch: 14,now: 2024-08-09 18:48:52.013796,epoch time: 0:23:03.689132,used: 4:43:16.454197,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.924162, 'precision': 0.9339099, 'recall': 0.924103, 'specificity': 0.924103, 'f1': 0.92372644, 'auroc': 0.99700075, 'binary_precision': 0.86907, 'binary_recall': 0.9989385, 'binary_specificity': 0.8492676, 'binary_f1_score': 0.92948985}
confusion matrix:
       0      1
0  21568   3828
1     27  25409
---- Validation: 
scalar performance:
{'acc': 0.77562344, 'precision': 0.54070246, 'recall': 0.803545, 'specificity': 0.803545, 'f1': 0.5140174, 'auroc': 0.84457767, 'binary_precision': 0.08694599, 'binary_recall': 0.83294666, 'binary_specificity': 0.7741433, 'binary_f1_score': 0.15745613}
confusion matrix:
       0     1
0  12922  3770
1     72   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236944, 'precision': 0.6619149, 'recall': 0.514477, 'specificity': 0.514477, 'f1': 0.5106035, 'auroc': 0.825042, 'binary_precision': 0.3968254, 'binary_recall': 0.0330251, 'binary_specificity': 0.9959289, 'binary_f1_score': 0.06097561}
confusion matrix:
      0   1
0  9296  38
1   732  25
early stop counter: 13
val acc:0.7756234407424927, best validation acc: 0.9538048505783081, corresponding to test acc:                         0.9199286699295044 / 0.9255772233009338
after epoch: 15,now: 2024-08-09 19:20:33.748259,epoch time: 0:31:41.734463,used: 5:14:58.188660,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_14_05_35_seed_1_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:14:58.188660 at 2024-08-09 19:20:33.748259
persisted model performance metric: 

scalar performance:
{'acc': 0.91992867, 'precision': 0.6722696, 'recall': 0.56767243, 'specificity': 0.56767243, 'f1': 0.59043306, 'auroc': 0.8918343, 'binary_precision': 0.409894, 'binary_recall': 0.15323646, 'binary_specificity': 0.9821084, 'binary_f1_score': 0.22307692}
confusion matrix:
      0    1
0  9167  167
1   641  116
oracle model performance metric: 

scalar performance:
{'acc': 0.9255772, 'precision': 0.79635334, 'recall': 0.5076046, 'specificity': 0.5076046, 'f1': 0.49613518, 'auroc': 0.8390275, 'binary_precision': 0.6666667, 'binary_recall': 0.015852047, 'binary_specificity': 0.99935716, 'binary_f1_score': 0.030967742}
confusion matrix:
      0   1
0  9328   6
1   745  12
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493800 KiB |  10995 MiB | 678402 GiB | 678401 GiB |
|       from large pool | 403264 KiB |  10922 MiB | 676547 GiB | 676546 GiB |
|       from small pool |  90536 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493800 KiB |  10995 MiB | 678402 GiB | 678401 GiB |
|       from large pool | 403264 KiB |  10922 MiB | 676547 GiB | 676546 GiB |
|       from small pool |  90536 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10880 MiB | 669616 GiB | 669615 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 667782 GiB | 667782 GiB |
|       from small pool |  88912 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11506 MiB |  11506 MiB |  21780 MiB |  10274 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  21624 MiB |  10244 MiB |
|       from small pool |    126 MiB |    128 MiB |    156 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    807 MiB |   1335 MiB | 284371 GiB | 284370 GiB |
|       from large pool |    798 MiB |   1332 MiB | 282186 GiB | 282186 GiB |
|       from small pool |      9 MiB |     26 MiB |   2184 GiB |   2184 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7600    |  114016 K  |  114011 K  |
|       from large pool |      87    |     908    |   42321 K  |   42321 K  |
|       from small pool |    5076    |    7511    |   71695 K  |   71690 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7600    |  114016 K  |  114011 K  |
|       from large pool |      87    |     908    |   42321 K  |   42321 K  |
|       from small pool |    5076    |    7511    |   71695 K  |   71690 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     408    |     737    |     329    |
|       from large pool |     345    |     345    |     659    |     314    |
|       from small pool |      63    |      64    |      78    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    3212    |   61161 K  |   61161 K  |
|       from large pool |      24    |     197    |   26772 K  |   26772 K  |
|       from small pool |      54    |    3186    |   34389 K  |   34389 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 678402 GiB | 678402 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676547 GiB | 676547 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 678402 GiB | 678402 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676547 GiB | 676547 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 669616 GiB | 669616 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 667782 GiB | 667782 GiB |
|       from small pool |      0 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1290 MiB |  11506 MiB |  21780 MiB |  20490 MiB |
|       from large pool |   1192 MiB |  11380 MiB |  21624 MiB |  20432 MiB |
|       from small pool |     98 MiB |    128 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1335 MiB | 284371 GiB | 284371 GiB |
|       from large pool |  50944 KiB |   1332 MiB | 282186 GiB | 282186 GiB |
|       from small pool |      0 KiB |     29 MiB |   2184 GiB |   2184 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  114016 K  |  114016 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71695 K  |   71695 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  114016 K  |  114016 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71695 K  |   71695 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     408    |     737    |     653    |
|       from large pool |      35    |     345    |     659    |     624    |
|       from small pool |      49    |      64    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3212    |   61164 K  |   61164 K  |
|       from large pool |       4    |     197    |   26772 K  |   26772 K  |
|       from small pool |       0    |    3186    |   34391 K  |   34391 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB | 678402 GiB | 678402 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676547 GiB | 676547 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB | 678402 GiB | 678402 GiB |
|       from large pool |  16640 KiB |  10922 MiB | 676547 GiB | 676547 GiB |
|       from small pool |      0 KiB |    125 MiB |   1855 GiB |   1855 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 669616 GiB | 669616 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 667782 GiB | 667782 GiB |
|       from small pool |      0 KiB |    124 MiB |   1833 GiB |   1833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1290 MiB |  11506 MiB |  21780 MiB |  20490 MiB |
|       from large pool |   1192 MiB |  11380 MiB |  21624 MiB |  20432 MiB |
|       from small pool |     98 MiB |    128 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1335 MiB | 284371 GiB | 284371 GiB |
|       from large pool |  50944 KiB |   1332 MiB | 282186 GiB | 282186 GiB |
|       from small pool |      0 KiB |     29 MiB |   2184 GiB |   2184 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  114016 K  |  114016 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71695 K  |   71695 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  114016 K  |  114016 K  |
|       from large pool |       2    |     908    |   42321 K  |   42321 K  |
|       from small pool |       0    |    7511    |   71695 K  |   71695 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     408    |     737    |     653    |
|       from large pool |      35    |     345    |     659    |     624    |
|       from small pool |      49    |      64    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3212    |   61164 K  |   61164 K  |
|       from large pool |       4    |     197    |   26772 K  |   26772 K  |
|       from small pool |       0    |    3186    |   34391 K  |   34391 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713

 Experiment start at: 2024-08-09 19:55:21.441452
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9684115, 'precision': 0.968485, 'recall': 0.96841, 'specificity': 0.96841, 'f1': 0.96841013, 'auroc': 0.99508876, 'binary_precision': 0.9626743, 'binary_recall': 0.9746268, 'binary_specificity': 0.9621933, 'binary_f1_score': 0.9686136}
confusion matrix:
       0      1
0  24865    977
1    656  25198
---- Validation: 
scalar performance:
{'acc': 0.91654986, 'precision': 0.5865537, 'recall': 0.80561936, 'specificity': 0.80561936, 'f1': 0.62148106, 'auroc': 0.8698509, 'binary_precision': 0.18147448, 'binary_recall': 0.68899524, 'binary_specificity': 0.9222435, 'binary_f1_score': 0.28728178}
confusion matrix:
       0     1
0  15407  1299
1    130   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91270316, 'precision': 0.7074022, 'recall': 0.7403916, 'specificity': 0.7403916, 'f1': 0.7222329, 'auroc': 0.8602028, 'binary_precision': 0.4552239, 'binary_recall': 0.5357591, 'binary_specificity': 0.9450242, 'binary_f1_score': 0.492219}
confusion matrix:
      0    1
0  8784  511
1   370  427
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 20:19:57.987484,epoch time: 0:24:36.546032,used: 0:24:36.546032,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95649564, 'precision': 0.9583608, 'recall': 0.95649076, 'specificity': 0.95649076, 'f1': 0.95645106, 'auroc': 0.99646896, 'binary_precision': 0.9291611, 'binary_recall': 0.9883568, 'binary_specificity': 0.9246247, 'binary_f1_score': 0.9578453}
confusion matrix:
       0      1
0  23896   1948
1    301  25551
---- Validation: 
scalar performance:
{'acc': 0.876022, 'precision': 0.5652911, 'recall': 0.8245006, 'specificity': 0.8245006, 'f1': 0.58265275, 'auroc': 0.88784695, 'binary_precision': 0.13707961, 'binary_recall': 0.7703349, 'binary_specificity': 0.87866634, 'binary_f1_score': 0.23274304}
confusion matrix:
       0     1
0  14679  2027
1     96   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91508126, 'precision': 0.68385774, 'recall': 0.6040282, 'specificity': 0.6040282, 'f1': 0.6293005, 'auroc': 0.8483224, 'binary_precision': 0.43087557, 'binary_recall': 0.23462985, 'binary_specificity': 0.9734266, 'binary_f1_score': 0.30381805}
confusion matrix:
      0    1
0  9048  247
1   610  187
new oracle model saved
early stop counter: 1
val acc:0.8760219812393188, best validation acc: 0.9165498614311218, corresponding to test acc:                         0.9127031564712524 / 0.915081262588501
after epoch: 2,now: 2024-08-09 20:42:58.666492,epoch time: 0:23:00.679008,used: 0:47:37.225040,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9678892, 'precision': 0.9689586, 'recall': 0.96788454, 'specificity': 0.96788454, 'f1': 0.96787065, 'auroc': 0.9978818, 'binary_precision': 0.94661254, 'binary_recall': 0.9917224, 'binary_specificity': 0.94404674, 'binary_f1_score': 0.96864253}
confusion matrix:
       0      1
0  24397   1446
1    214  25639
---- Validation: 
scalar performance:
{'acc': 0.9174258, 'precision': 0.594199, 'recall': 0.84105563, 'specificity': 0.84105563, 'f1': 0.63316405, 'auroc': 0.906343, 'binary_precision': 0.19485295, 'binary_recall': 0.76076555, 'binary_specificity': 0.92134565, 'binary_f1_score': 0.3102439}
confusion matrix:
       0     1
0  15392  1314
1    100   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9182521, 'precision': 0.63891804, 'recall': 0.5179949, 'specificity': 0.5179949, 'f1': 0.5166909, 'auroc': 0.8500942, 'binary_precision': 0.35416666, 'binary_recall': 0.042659976, 'binary_specificity': 0.99332976, 'binary_f1_score': 0.07614782}
confusion matrix:
      0   1
0  9233  62
1   763  34
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 21:05:52.841064,epoch time: 0:22:54.174572,used: 1:10:31.399612,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95666975, 'precision': 0.9589269, 'recall': 0.95666164, 'specificity': 0.95666164, 'f1': 0.9566159, 'auroc': 0.9973014, 'binary_precision': 0.9268002, 'binary_recall': 0.9916841, 'binary_specificity': 0.9216392, 'binary_f1_score': 0.95814496}
confusion matrix:
       0      1
0  23817   2025
1    215  25639
---- Validation: 
scalar performance:
{'acc': 0.9064471, 'precision': 0.5746505, 'recall': 0.7852804, 'specificity': 0.7852804, 'f1': 0.6028317, 'auroc': 0.8782076, 'binary_precision': 0.15859285, 'binary_recall': 0.65789473, 'binary_specificity': 0.9126661, 'binary_f1_score': 0.25557622}
confusion matrix:
       0     1
0  15247  1459
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92043203, 'precision': 0.66099185, 'recall': 0.50655997, 'specificity': 0.50655997, 'f1': 0.49376842, 'auroc': 0.8428832, 'binary_precision': 0.4, 'binary_recall': 0.015056462, 'binary_specificity': 0.9980635, 'binary_f1_score': 0.029020557}
confusion matrix:
      0   1
0  9277  18
1   785  12
new oracle model saved
early stop counter: 1
val acc:0.9064471125602722, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9204320311546326
after epoch: 4,now: 2024-08-09 21:28:44.550697,epoch time: 0:22:51.709633,used: 1:33:23.109245,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9589717, 'precision': 0.96125436, 'recall': 0.95896757, 'specificity': 0.95896757, 'f1': 0.9589206, 'auroc': 0.99830973, 'binary_precision': 0.92883474, 'binary_recall': 0.9941201, 'binary_specificity': 0.9238151, 'binary_f1_score': 0.9603692}
confusion matrix:
       0      1
0  23876   1969
1    152  25699
---- Validation: 
scalar performance:
{'acc': 0.9086078, 'precision': 0.5846337, 'recall': 0.8295388, 'specificity': 0.8295388, 'f1': 0.6181227, 'auroc': 0.9079777, 'binary_precision': 0.17617166, 'binary_recall': 0.7464115, 'binary_specificity': 0.9126661, 'binary_f1_score': 0.28506166}
confusion matrix:
       0     1
0  15247  1459
1    106   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.71109897, 'recall': 0.5080298, 'specificity': 0.5080298, 'f1': 0.49638498, 'auroc': 0.8602899, 'binary_precision': 0.5, 'binary_recall': 0.017565873, 'binary_specificity': 0.9984938, 'binary_f1_score': 0.033939395}
confusion matrix:
      0   1
0  9281  14
1   783  14
new oracle model saved
early stop counter: 2
val acc:0.9086077809333801, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9210265278816223
after epoch: 5,now: 2024-08-09 21:51:24.985603,epoch time: 0:22:40.434906,used: 1:56:03.544151,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96241486, 'precision': 0.96418786, 'recall': 0.96241367, 'specificity': 0.96241367, 'f1': 0.96237886, 'auroc': 0.99820924, 'binary_precision': 0.93550974, 'binary_recall': 0.9933073, 'binary_specificity': 0.9315201, 'binary_f1_score': 0.9635425}
confusion matrix:
       0      1
0  24077   1770
1    173  25676
---- Validation: 
scalar performance:
{'acc': 0.8919645, 'precision': 0.5646524, 'recall': 0.7778579, 'specificity': 0.7778579, 'f1': 0.5855391, 'auroc': 0.87448037, 'binary_precision': 0.13874874, 'binary_recall': 0.65789473, 'binary_specificity': 0.8978211, 'binary_f1_score': 0.22916666}
confusion matrix:
       0     1
0  14999  1707
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9225129, 'precision': 0.87441003, 'recall': 0.5117045, 'specificity': 0.5117045, 'f1': 0.5029786, 'auroc': 0.8416778, 'binary_precision': 0.82608694, 'binary_recall': 0.023839397, 'binary_specificity': 0.99956965, 'binary_f1_score': 0.046341464}
confusion matrix:
      0   1
0  9291   4
1   778  19
new oracle model saved
early stop counter: 3
val acc:0.8919644951820374, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9225128889083862
after epoch: 6,now: 2024-08-09 22:14:18.037886,epoch time: 0:22:53.052283,used: 2:18:56.596434,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94752014, 'precision': 0.9517586, 'recall': 0.9475089, 'specificity': 0.9475089, 'f1': 0.9473958, 'auroc': 0.99810195, 'binary_precision': 0.9080585, 'binary_recall': 0.99590003, 'binary_specificity': 0.8991177, 'binary_f1_score': 0.9499529}
confusion matrix:
       0      1
0  23235   2607
1    106  25748
---- Validation: 
scalar performance:
{'acc': 0.8725181, 'precision': 0.5601898, 'recall': 0.8017125, 'specificity': 0.8017125, 'f1': 0.5742234, 'auroc': 0.8747152, 'binary_precision': 0.12810788, 'binary_recall': 0.72727275, 'binary_specificity': 0.8761523, 'binary_f1_score': 0.21784306}
confusion matrix:
       0     1
0  14637  2069
1    114   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92172015, 'precision': 0.8455738, 'recall': 0.50611216, 'specificity': 0.50611216, 'f1': 0.49195752, 'auroc': 0.79153556, 'binary_precision': 0.7692308, 'binary_recall': 0.0125470515, 'binary_specificity': 0.99967724, 'binary_f1_score': 0.024691356}
confusion matrix:
      0   1
0  9292   3
1   787  10
early stop counter: 4
val acc:0.8725181221961975, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9225128889083862
after epoch: 7,now: 2024-08-09 22:36:16.221175,epoch time: 0:21:58.183289,used: 2:40:54.779723,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9369584, 'precision': 0.9434425, 'recall': 0.93694437, 'specificity': 0.93694437, 'f1': 0.9367256, 'auroc': 0.9979197, 'binary_precision': 0.88987815, 'binary_recall': 0.9973698, 'binary_specificity': 0.87651885, 'binary_f1_score': 0.9405627}
confusion matrix:
       0      1
0  22651   3191
1     68  25786
---- Validation: 
scalar performance:
{'acc': 0.8012147, 'precision': 0.5440645, 'recall': 0.8118185, 'specificity': 0.8118185, 'f1': 0.5276266, 'auroc': 0.86709684, 'binary_precision': 0.09363092, 'binary_recall': 0.8229665, 'binary_specificity': 0.80067044, 'binary_f1_score': 0.16813295}
confusion matrix:
       0     1
0  13376  3330
1     74   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239001, 'precision': 0.79832, 'recall': 0.53425294, 'specificity': 0.53425294, 'f1': 0.5447315, 'auroc': 0.75136983, 'binary_precision': 0.67058825, 'binary_recall': 0.07151819, 'binary_specificity': 0.99698764, 'binary_f1_score': 0.12925169}
confusion matrix:
      0   1
0  9267  28
1   740  57
new oracle model saved
early stop counter: 5
val acc:0.8012146949768066, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9239001274108887
after epoch: 8,now: 2024-08-09 22:58:32.775493,epoch time: 0:22:16.554318,used: 3:03:11.334041,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9466497, 'precision': 0.9512688, 'recall': 0.94663596, 'specificity': 0.94663596, 'f1': 0.9465116, 'auroc': 0.9985328, 'binary_precision': 0.90568024, 'binary_recall': 0.9971766, 'binary_specificity': 0.89609534, 'binary_f1_score': 0.9492287}
confusion matrix:
       0      1
0  23156   2685
1     73  25782
---- Validation: 
scalar performance:
{'acc': 0.83479327, 'precision': 0.5494529, 'recall': 0.8045367, 'specificity': 0.8045367, 'f1': 0.546984, 'auroc': 0.8697041, 'binary_precision': 0.10565914, 'binary_recall': 0.77272725, 'binary_specificity': 0.8363462, 'binary_f1_score': 0.18589927}
confusion matrix:
       0     1
0  13972  2734
1     95   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92181927, 'precision': 0.7881788, 'recall': 0.51018083, 'specificity': 0.51018083, 'f1': 0.5002801, 'auroc': 0.74309134, 'binary_precision': 0.65384614, 'binary_recall': 0.021329988, 'binary_specificity': 0.9990317, 'binary_f1_score': 0.041312274}
confusion matrix:
      0   1
0  9286   9
1   780  17
early stop counter: 6
val acc:0.8347932696342468, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9239001274108887
after epoch: 9,now: 2024-08-09 23:20:15.545459,epoch time: 0:21:42.769966,used: 3:24:54.104007,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.92666745, 'precision': 0.93544716, 'recall': 0.9266592, 'specificity': 0.9266592, 'f1': 0.9262949, 'auroc': 0.9977529, 'binary_precision': 0.873645, 'binary_recall': 0.9976403, 'binary_specificity': 0.8556781, 'binary_f1_score': 0.9315345}
confusion matrix:
       0      1
0  22115   3730
1     61  25790
---- Validation: 
scalar performance:
{'acc': 0.82807755, 'precision': 0.5463799, 'recall': 0.7929312, 'specificity': 0.7929312, 'f1': 0.54037523, 'auroc': 0.85296917, 'binary_precision': 0.10006333, 'binary_recall': 0.75598085, 'binary_specificity': 0.8298815, 'binary_f1_score': 0.17673378}
confusion matrix:
       0     1
0  13864  2842
1    102   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221165, 'precision': 0.772841, 'recall': 0.5166514, 'specificity': 0.5166514, 'f1': 0.5129357, 'auroc': 0.7604487, 'binary_precision': 0.62222224, 'binary_recall': 0.035131745, 'binary_specificity': 0.99817103, 'binary_f1_score': 0.066508316}
confusion matrix:
      0   1
0  9278  17
1   769  28
early stop counter: 7
val acc:0.8280775547027588, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9239001274108887
after epoch: 10,now: 2024-08-09 23:42:21.038712,epoch time: 0:22:05.493253,used: 3:46:59.597260,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9104573, 'precision': 0.9236938, 'recall': 0.91044366, 'specificity': 0.91044366, 'f1': 0.9097505, 'auroc': 0.9980353, 'binary_precision': 0.84884447, 'binary_recall': 0.9988009, 'binary_specificity': 0.8220864, 'binary_f1_score': 0.9177374}
confusion matrix:
       0      1
0  21246   4598
1     31  25821
---- Validation: 
scalar performance:
{'acc': 0.7766877, 'precision': 0.5411182, 'recall': 0.8155755, 'specificity': 0.8155755, 'f1': 0.5144949, 'auroc': 0.8670529, 'binary_precision': 0.086851045, 'binary_recall': 0.8564593, 'binary_specificity': 0.7746917, 'binary_f1_score': 0.15770924}
confusion matrix:
       0     1
0  12942  3764
1     60   358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918153, 'precision': 0.66211104, 'recall': 0.53113294, 'specificity': 0.53113294, 'f1': 0.53917706, 'auroc': 0.69915324, 'binary_precision': 0.3986014, 'binary_recall': 0.07151819, 'binary_specificity': 0.9907477, 'binary_f1_score': 0.121276595}
confusion matrix:
      0   1
0  9209  86
1   740  57
early stop counter: 8
val acc:0.7766876816749573, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9239001274108887
after epoch: 11,now: 2024-08-10 00:04:07.941411,epoch time: 0:21:46.902699,used: 4:08:46.499959,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9495899, 'precision': 0.9536197, 'recall': 0.9495808, 'specificity': 0.9495808, 'f1': 0.94947696, 'auroc': 0.99820757, 'binary_precision': 0.91091317, 'binary_recall': 0.9966735, 'binary_specificity': 0.9024881, 'binary_f1_score': 0.95186555}
confusion matrix:
       0      1
0  23323   2520
1     86  25767
---- Validation: 
scalar performance:
{'acc': 0.86953986, 'precision': 0.5450265, 'recall': 0.71854913, 'specificity': 0.71854913, 'f1': 0.5511939, 'auroc': 0.85432756, 'binary_precision': 0.10245184, 'binary_recall': 0.5598086, 'binary_specificity': 0.8772896, 'binary_f1_score': 0.17320503}
confusion matrix:
       0     1
0  14656  2050
1    184   234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9214229, 'precision': 0.7425323, 'recall': 0.51053923, 'specificity': 0.51053923, 'f1': 0.50122726, 'auroc': 0.804619, 'binary_precision': 0.5625, 'binary_recall': 0.022584694, 'binary_specificity': 0.9984938, 'binary_f1_score': 0.043425817}
confusion matrix:
      0   1
0  9281  14
1   779  18
early stop counter: 9
val acc:0.8695398569107056, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9239001274108887
after epoch: 12,now: 2024-08-10 00:26:24.582840,epoch time: 0:22:16.641429,used: 4:31:03.141388,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.94947386, 'precision': 0.9536357, 'recall': 0.94946647, 'specificity': 0.94946647, 'f1': 0.9493571, 'auroc': 0.99868965, 'binary_precision': 0.91022384, 'binary_recall': 0.99733096, 'binary_specificity': 0.9016019, 'binary_f1_score': 0.95178854}
confusion matrix:
       0      1
0  23301   2543
1     69  25783
---- Validation: 
scalar performance:
{'acc': 0.8559916, 'precision': 0.55382574, 'recall': 0.79674125, 'specificity': 0.79674125, 'f1': 0.56011546, 'auroc': 0.8668322, 'binary_precision': 0.11532682, 'binary_recall': 0.73444974, 'binary_specificity': 0.8590327, 'binary_f1_score': 0.19935064}
confusion matrix:
       0     1
0  14351  2355
1    111   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9208284, 'precision': 0.6795479, 'recall': 0.5039073, 'specificity': 0.5039073, 'f1': 0.4879865, 'auroc': 0.8430833, 'binary_precision': 0.4375, 'binary_recall': 0.008782936, 'binary_specificity': 0.9990317, 'binary_f1_score': 0.017220173}
confusion matrix:
      0  1
0  9286  9
1   790  7
early stop counter: 10
val acc:0.8559916019439697, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9239001274108887
after epoch: 13,now: 2024-08-10 00:49:58.130136,epoch time: 0:23:33.547296,used: 4:54:36.688684,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9158542, 'precision': 0.92760277, 'recall': 0.915835, 'specificity': 0.915835, 'f1': 0.9152697, 'auroc': 0.99765253, 'binary_precision': 0.8567826, 'binary_recall': 0.99868494, 'binary_specificity': 0.83298504, 'binary_f1_score': 0.9223076}
confusion matrix:
       0      1
0  21526   4316
1     34  25820
---- Validation: 
scalar performance:
{'acc': 0.7698552, 'precision': 0.53507173, 'recall': 0.77125525, 'specificity': 0.77125525, 'f1': 0.5039823, 'auroc': 0.8259759, 'binary_precision': 0.07747661, 'binary_recall': 0.77272725, 'binary_specificity': 0.7697833, 'binary_f1_score': 0.14083278}
confusion matrix:
       0     1
0  12860  3846
1     95   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92023385, 'precision': 0.697675, 'recall': 0.53455687, 'specificity': 0.53455687, 'f1': 0.54490215, 'auroc': 0.7711774, 'binary_precision': 0.46923077, 'binary_recall': 0.07653701, 'binary_specificity': 0.99257666, 'binary_f1_score': 0.13160734}
confusion matrix:
      0   1
0  9226  69
1   736  61
early stop counter: 11
val acc:0.7698552012443542, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9239001274108887
after epoch: 14,now: 2024-08-10 01:14:12.666646,epoch time: 0:24:14.536510,used: 5:18:51.225194,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.916067, 'precision': 0.927703, 'recall': 0.9160638, 'specificity': 0.9160638, 'f1': 0.9154918, 'auroc': 0.99722064, 'binary_precision': 0.8571666, 'binary_recall': 0.9985299, 'binary_specificity': 0.8335977, 'binary_f1_score': 0.9224639}
confusion matrix:
       0      1
0  21546   4301
1     38  25811
---- Validation: 
scalar performance:
{'acc': 0.8075216, 'precision': 0.54111505, 'recall': 0.7812298, 'specificity': 0.7812298, 'f1': 0.5258844, 'auroc': 0.8293269, 'binary_precision': 0.089794755, 'binary_recall': 0.7535885, 'binary_specificity': 0.8088711, 'binary_f1_score': 0.16046867}
confusion matrix:
       0     1
0  13513  3193
1    103   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9164685, 'precision': 0.61923635, 'recall': 0.51989436, 'specificity': 0.51989436, 'f1': 0.52046394, 'auroc': 0.69155574, 'binary_precision': 0.31451613, 'binary_recall': 0.048933502, 'binary_specificity': 0.9908553, 'binary_f1_score': 0.084690556}
confusion matrix:
      0   1
0  9210  85
1   758  39
early stop counter: 12
val acc:0.8075215816497803, best validation acc: 0.917425811290741, corresponding to test acc:                         0.9182521104812622 / 0.9239001274108887
after epoch: 15,now: 2024-08-10 01:40:36.054395,epoch time: 0:26:23.387749,used: 5:45:14.612943,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_55_21_seed_2_24132713
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:45:14.612943 at 2024-08-10 01:40:36.054395
persisted model performance metric: 

scalar performance:
{'acc': 0.9182521, 'precision': 0.63891804, 'recall': 0.5179949, 'specificity': 0.5179949, 'f1': 0.5166909, 'auroc': 0.8500942, 'binary_precision': 0.35416666, 'binary_recall': 0.042659976, 'binary_specificity': 0.99332976, 'binary_f1_score': 0.07614782}
confusion matrix:
      0   1
0  9233  62
1   763  34
oracle model performance metric: 

scalar performance:
{'acc': 0.9239001, 'precision': 0.79832, 'recall': 0.53425294, 'specificity': 0.53425294, 'f1': 0.5447315, 'auroc': 0.75136983, 'binary_precision': 0.67058825, 'binary_recall': 0.07151819, 'binary_specificity': 0.99698764, 'binary_f1_score': 0.12925169}
confusion matrix:
      0   1
0  9267  28
1   740  57
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494824 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 404288 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494824 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 404288 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10880 MiB |    998 TiB |    998 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    995 TiB |    995 TiB |
|       from small pool |  88912 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11476 MiB |  11506 MiB |  31966 MiB |  20490 MiB |
|       from large pool |  11350 MiB |  11380 MiB |  31782 MiB |  20432 MiB |
|       from small pool |    126 MiB |    128 MiB |    184 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 733975 KiB |   1557 MiB | 470243 GiB | 470242 GiB |
|       from large pool | 724160 KiB |   1555 MiB | 466898 GiB | 466898 GiB |
|       from small pool |   9815 KiB |     29 MiB |   3344 GiB |   3344 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7708    |  173395 K  |  173390 K  |
|       from large pool |      87    |     908    |   64564 K  |   64564 K  |
|       from small pool |    5076    |    7619    |  108830 K  |  108825 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7708    |  173395 K  |  173390 K  |
|       from large pool |      87    |     908    |   64564 K  |   64564 K  |
|       from small pool |    5076    |    7619    |  108830 K  |  108825 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     405    |     408    |    1058    |     653    |
|       from large pool |     342    |     345    |     966    |     624    |
|       from small pool |      63    |      64    |      92    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3263    |   94259 K  |   94259 K  |
|       from large pool |      22    |     198    |   42071 K  |   42071 K  |
|       from small pool |      52    |    3240    |   52188 K  |   52188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10995 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10922 MiB |   1007 TiB |   1007 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    998 TiB |    998 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    995 TiB |    995 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1200 MiB |  11506 MiB |  31966 MiB |  30766 MiB |
|       from large pool |   1102 MiB |  11380 MiB |  31782 MiB |  30680 MiB |
|       from small pool |     98 MiB |    128 MiB |    184 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1557 MiB | 470243 GiB | 470243 GiB |
|       from large pool |  50944 KiB |   1555 MiB | 466899 GiB | 466899 GiB |
|       from small pool |      0 KiB |     29 MiB |   3344 GiB |   3344 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7708    |  173395 K  |  173395 K  |
|       from large pool |       2    |     908    |   64564 K  |   64564 K  |
|       from small pool |       0    |    7619    |  108830 K  |  108830 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7708    |  173395 K  |  173395 K  |
|       from large pool |       2    |     908    |   64564 K  |   64564 K  |
|       from small pool |       0    |    7619    |  108830 K  |  108830 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     408    |    1058    |     976    |
|       from large pool |      33    |     345    |     966    |     933    |
|       from small pool |      49    |      64    |      92    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3263    |   94262 K  |   94262 K  |
|       from large pool |       4    |     198    |   42071 K  |   42071 K  |
|       from small pool |       0    |    3240    |   52190 K  |   52190 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug 10 01:58:17 2024]
Finished job 0.
1 of 1 steps (100%) done
