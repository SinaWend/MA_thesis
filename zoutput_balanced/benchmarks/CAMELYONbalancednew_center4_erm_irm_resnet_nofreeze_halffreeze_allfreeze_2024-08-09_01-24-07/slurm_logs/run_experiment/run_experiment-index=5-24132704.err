Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 07:16:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704

 Experiment start at: 2024-08-09 07:23:10.556242
before training, model accuracy: 0.6349614262580872
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96563095, 'precision': 0.96588075, 'recall': 0.96562546, 'specificity': 0.96562546, 'f1': 0.96562606, 'auroc': 0.9954292, 'binary_precision': 0.9552101, 'binary_recall': 0.9771113, 'binary_specificity': 0.95413965, 'binary_f1_score': 0.9660366}
confusion matrix:
       0      1
0  24155   1161
1    580  24760
---- Validation: 
scalar performance:
{'acc': 0.9540418, 'precision': 0.643904, 'recall': 0.8084352, 'specificity': 0.8084352, 'f1': 0.6922503, 'auroc': 0.89171493, 'binary_precision': 0.29661942, 'binary_recall': 0.6554217, 'binary_specificity': 0.9614488, 'binary_f1_score': 0.40840843}
confusion matrix:
       0    1
0  16086  645
1    143  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91902316, 'precision': 0.7068067, 'recall': 0.67513436, 'specificity': 0.67513436, 'f1': 0.68924, 'auroc': 0.88520837, 'binary_precision': 0.4635659, 'binary_recall': 0.3873057, 'binary_specificity': 0.962963, 'binary_f1_score': 0.42201835}
confusion matrix:
      0    1
0  8996  346
1   473  299
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 07:39:46.774469,epoch time: 0:16:36.218227,used: 0:16:36.218227,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9731522, 'precision': 0.97327995, 'recall': 0.9731481, 'specificity': 0.9731481, 'f1': 0.97315025, 'auroc': 0.9970877, 'binary_precision': 0.9656324, 'binary_recall': 0.98125565, 'binary_specificity': 0.9650405, 'binary_f1_score': 0.97338134}
confusion matrix:
       0      1
0  24430    885
1    475  24866
---- Validation: 
scalar performance:
{'acc': 0.96273184, 'precision': 0.6748687, 'recall': 0.8246374, 'specificity': 0.8246374, 'f1': 0.72475815, 'auroc': 0.91751635, 'binary_precision': 0.35786802, 'binary_recall': 0.67951804, 'binary_specificity': 0.9697567, 'binary_f1_score': 0.4688279}
confusion matrix:
       0    1
0  16225  506
1    133  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9195175, 'precision': 0.64941347, 'recall': 0.5334009, 'specificity': 0.5334009, 'f1': 0.5431452, 'auroc': 0.880576, 'binary_precision': 0.37037036, 'binary_recall': 0.07772021, 'binary_specificity': 0.98908156, 'binary_f1_score': 0.12847966}
confusion matrix:
      0    1
0  9240  102
1   712   60
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 07:55:09.405038,epoch time: 0:15:22.630569,used: 0:31:58.848796,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97366554, 'precision': 0.9741361, 'recall': 0.97365505, 'specificity': 0.97365505, 'f1': 0.9736585, 'auroc': 0.9979691, 'binary_precision': 0.95936483, 'binary_recall': 0.9892681, 'binary_specificity': 0.95804197, 'binary_f1_score': 0.974087}
confusion matrix:
       0      1
0  24249   1062
1    272  25073
---- Validation: 
scalar performance:
{'acc': 0.9502508, 'precision': 0.640939, 'recall': 0.8393909, 'specificity': 0.8393909, 'f1': 0.69348174, 'auroc': 0.9172939, 'binary_precision': 0.28901735, 'binary_recall': 0.72289157, 'binary_specificity': 0.95589024, 'binary_f1_score': 0.41293877}
confusion matrix:
       0    1
0  15993  738
1    115  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92070395, 'precision': 0.6542327, 'recall': 0.52691334, 'specificity': 0.52691334, 'f1': 0.53270715, 'auroc': 0.89730704, 'binary_precision': 0.3809524, 'binary_recall': 0.062176164, 'binary_specificity': 0.9916506, 'binary_f1_score': 0.10690422}
confusion matrix:
      0   1
0  9264  78
1   724  48
new oracle model saved
early stop counter: 1
val acc:0.9502508044242859, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9207039475440979
after epoch: 3,now: 2024-08-09 08:10:34.927304,epoch time: 0:15:25.522266,used: 0:47:24.371062,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94952226, 'precision': 0.952984, 'recall': 0.9494947, 'specificity': 0.9494947, 'f1': 0.94942343, 'auroc': 0.9976241, 'binary_precision': 0.91354215, 'binary_recall': 0.99309504, 'binary_specificity': 0.90589446, 'binary_f1_score': 0.95165896}
confusion matrix:
       0      1
0  22930   2382
1    175  25169
---- Validation: 
scalar performance:
{'acc': 0.87956375, 'precision': 0.5639776, 'recall': 0.81022036, 'specificity': 0.81022036, 'f1': 0.5816485, 'auroc': 0.88898015, 'binary_precision': 0.13527851, 'binary_recall': 0.7373494, 'binary_specificity': 0.8830913, 'binary_f1_score': 0.2286141}
confusion matrix:
       0     1
0  14775  1956
1    109   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91931975, 'precision': 0.6314876, 'recall': 0.52438164, 'specificity': 0.52438164, 'f1': 0.528553, 'auroc': 0.8849312, 'binary_precision': 0.33582088, 'binary_recall': 0.058290154, 'binary_specificity': 0.99047315, 'binary_f1_score': 0.09933774}
confusion matrix:
      0   1
0  9253  89
1   727  45
early stop counter: 2
val acc:0.8795637488365173, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9207039475440979
after epoch: 4,now: 2024-08-09 08:26:13.375053,epoch time: 0:15:38.447749,used: 1:03:02.818811,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9577345, 'precision': 0.9605556, 'recall': 0.9577099, 'specificity': 0.9577099, 'f1': 0.95766807, 'auroc': 0.99873024, 'binary_precision': 0.92466784, 'binary_recall': 0.9967251, 'binary_specificity': 0.9186947, 'binary_f1_score': 0.9593453}
confusion matrix:
       0      1
0  23254   2058
1     83  25261
---- Validation: 
scalar performance:
{'acc': 0.88924533, 'precision': 0.57451415, 'recall': 0.8457295, 'specificity': 0.8457295, 'f1': 0.59961045, 'auroc': 0.9084711, 'binary_precision': 0.15456238, 'binary_recall': 0.8, 'binary_specificity': 0.891459, 'binary_f1_score': 0.2590714}
confusion matrix:
       0     1
0  14915  1816
1     83   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92258257, 'precision': 0.6784186, 'recall': 0.51961225, 'specificity': 0.51961225, 'f1': 0.5197486, 'auroc': 0.8881467, 'binary_precision': 0.43037975, 'binary_recall': 0.04404145, 'binary_specificity': 0.99518305, 'binary_f1_score': 0.079905994}
confusion matrix:
      0   1
0  9297  45
1   738  34
new oracle model saved
early stop counter: 3
val acc:0.889245331287384, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9225825667381287
after epoch: 5,now: 2024-08-09 08:41:40.974925,epoch time: 0:15:27.599872,used: 1:18:30.418683,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9661442, 'precision': 0.96758187, 'recall': 0.96612674, 'specificity': 0.96612674, 'f1': 0.96611726, 'auroc': 0.9985335, 'binary_precision': 0.9418122, 'binary_recall': 0.9937263, 'binary_specificity': 0.93852717, 'binary_f1_score': 0.9670731}
confusion matrix:
       0      1
0  23756   1556
1    159  25185
---- Validation: 
scalar performance:
{'acc': 0.9188732, 'precision': 0.5829392, 'recall': 0.78101534, 'specificity': 0.78101534, 'f1': 0.6160877, 'auroc': 0.8796054, 'binary_precision': 0.17553191, 'binary_recall': 0.6361446, 'binary_specificity': 0.9258861, 'binary_f1_score': 0.2751433}
confusion matrix:
       0     1
0  15491  1240
1    151   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92436224, 'precision': 0.77739036, 'recall': 0.51047516, 'specificity': 0.51047516, 'f1': 0.50158954, 'auroc': 0.86090374, 'binary_precision': 0.6296296, 'binary_recall': 0.022020726, 'binary_specificity': 0.99892956, 'binary_f1_score': 0.042553194}
confusion matrix:
      0   1
0  9332  10
1   755  17
new oracle model saved
early stop counter: 4
val acc:0.9188731908798218, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 6,now: 2024-08-09 08:57:11.150164,epoch time: 0:15:30.175239,used: 1:34:00.593922,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9466598, 'precision': 0.95144886, 'recall': 0.9466294, 'specificity': 0.9466294, 'f1': 0.94651544, 'auroc': 0.9987308, 'binary_precision': 0.9050993, 'binary_recall': 0.9980271, 'binary_specificity': 0.8952317, 'binary_f1_score': 0.9492944}
confusion matrix:
       0      1
0  22661   2652
1     50  25293
---- Validation: 
scalar performance:
{'acc': 0.8338971, 'precision': 0.5512931, 'recall': 0.8220687, 'specificity': 0.8220687, 'f1': 0.5491787, 'auroc': 0.8889247, 'binary_precision': 0.10821256, 'binary_recall': 0.80963856, 'binary_specificity': 0.8344988, 'binary_f1_score': 0.1909091}
confusion matrix:
       0     1
0  13962  2769
1     79   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9122009, 'precision': 0.6105574, 'recall': 0.5419173, 'specificity': 0.5419173, 'f1': 0.5539913, 'auroc': 0.84721506, 'binary_precision': 0.2913669, 'binary_recall': 0.10492228, 'binary_specificity': 0.9789124, 'binary_f1_score': 0.15428571}
confusion matrix:
      0    1
0  9145  197
1   691   81
early stop counter: 5
val acc:0.8338971138000488, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 7,now: 2024-08-09 09:12:19.401264,epoch time: 0:15:08.251100,used: 1:49:08.845022,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95204914, 'precision': 0.9556799, 'recall': 0.95202625, 'specificity': 0.95202625, 'f1': 0.9519516, 'auroc': 0.9983176, 'binary_precision': 0.91513264, 'binary_recall': 0.99656683, 'binary_specificity': 0.90748566, 'binary_f1_score': 0.9541152}
confusion matrix:
       0      1
0  22973   2342
1     87  25254
---- Validation: 
scalar performance:
{'acc': 0.8407209, 'precision': 0.5524442, 'recall': 0.8185156, 'specificity': 0.8185156, 'f1': 0.5531269, 'auroc': 0.8856709, 'binary_precision': 0.110887095, 'binary_recall': 0.79518074, 'binary_specificity': 0.84185046, 'binary_f1_score': 0.19463284}
confusion matrix:
       0     1
0  14085  2646
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92297804, 'precision': 0.6090773, 'recall': 0.5025961, 'specificity': 0.5025961, 'f1': 0.48630008, 'auroc': 0.8699972, 'binary_precision': 0.29411766, 'binary_recall': 0.006476684, 'binary_specificity': 0.99871546, 'binary_f1_score': 0.012674272}
confusion matrix:
      0   1
0  9330  12
1   767   5
early stop counter: 6
val acc:0.8407208919525146, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 8,now: 2024-08-09 09:27:40.496840,epoch time: 0:15:21.095576,used: 2:04:29.940598,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9662034, 'precision': 0.9678235, 'recall': 0.96618724, 'specificity': 0.96618724, 'f1': 0.9661733, 'auroc': 0.99866664, 'binary_precision': 0.94043094, 'binary_recall': 0.9955015, 'binary_specificity': 0.9368729, 'binary_f1_score': 0.967183}
confusion matrix:
       0      1
0  23716   1598
1    114  25228
---- Validation: 
scalar performance:
{'acc': 0.9043509, 'precision': 0.57131577, 'recall': 0.7782738, 'specificity': 0.7782738, 'f1': 0.5976293, 'auroc': 0.8803993, 'binary_precision': 0.15218626, 'binary_recall': 0.6457831, 'binary_specificity': 0.91076446, 'binary_f1_score': 0.24632353}
confusion matrix:
       0     1
0  15238  1493
1    147   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.7121707, 'recall': 0.5047532, 'specificity': 0.5047532, 'f1': 0.49029633, 'auroc': 0.85912067, 'binary_precision': 0.5, 'binary_recall': 0.010362694, 'binary_specificity': 0.99914366, 'binary_f1_score': 0.020304568}
confusion matrix:
      0  1
0  9334  8
1   764  8
early stop counter: 7
val acc:0.9043508768081665, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 9,now: 2024-08-09 09:42:54.006023,epoch time: 0:15:13.509183,used: 2:19:43.449781,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9286165, 'precision': 0.93710494, 'recall': 0.9285808, 'specificity': 0.9285808, 'f1': 0.92826426, 'auroc': 0.99843097, 'binary_precision': 0.8763208, 'binary_recall': 0.99818474, 'binary_specificity': 0.8589769, 'binary_f1_score': 0.9332915}
confusion matrix:
       0      1
0  21745   3570
1     46  25295
---- Validation: 
scalar performance:
{'acc': 0.7793071, 'precision': 0.5399637, 'recall': 0.805846, 'specificity': 0.805846, 'f1': 0.51384526, 'auroc': 0.86385286, 'binary_precision': 0.08520069, 'binary_recall': 0.8337349, 'binary_specificity': 0.7779571, 'binary_f1_score': 0.15460232}
confusion matrix:
       0     1
0  13016  3715
1     69   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9163536, 'precision': 0.6020645, 'recall': 0.52337015, 'specificity': 0.52337015, 'f1': 0.52711207, 'auroc': 0.82745194, 'binary_precision': 0.27710843, 'binary_recall': 0.059585493, 'binary_specificity': 0.9871548, 'binary_f1_score': 0.09808103}
confusion matrix:
      0    1
0  9222  120
1   726   46
early stop counter: 8
val acc:0.7793071269989014, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 10,now: 2024-08-09 09:58:09.909002,epoch time: 0:15:15.902979,used: 2:34:59.352760,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.93951356, 'precision': 0.9456251, 'recall': 0.93948126, 'specificity': 0.93948126, 'f1': 0.9393024, 'auroc': 0.99889255, 'binary_precision': 0.89357644, 'binary_recall': 0.99794805, 'binary_specificity': 0.88101447, 'binary_f1_score': 0.9428827}
confusion matrix:
       0      1
0  22302   3012
1     52  25290
---- Validation: 
scalar performance:
{'acc': 0.83704656, 'precision': 0.55484736, 'recall': 0.8424814, 'specificity': 0.8424814, 'f1': 0.555263, 'auroc': 0.90460765, 'binary_precision': 0.11417451, 'binary_recall': 0.84819275, 'binary_specificity': 0.83677006, 'binary_f1_score': 0.20125787}
confusion matrix:
       0     1
0  14000  2731
1     63   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92416453, 'precision': 0.77192354, 'recall': 0.5079915, 'specificity': 0.5079915, 'f1': 0.496661, 'auroc': 0.85645443, 'binary_precision': 0.61904764, 'binary_recall': 0.016839378, 'binary_specificity': 0.99914366, 'binary_f1_score': 0.032786883}
confusion matrix:
      0   1
0  9334   8
1   759  13
early stop counter: 9
val acc:0.8370465636253357, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 11,now: 2024-08-09 10:13:29.524809,epoch time: 0:15:19.615807,used: 2:50:18.968567,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.94401455, 'precision': 0.94933456, 'recall': 0.9439759, 'specificity': 0.9439759, 'f1': 0.94384485, 'auroc': 0.999058, 'binary_precision': 0.9006193, 'binary_recall': 0.998264, 'binary_specificity': 0.8896879, 'binary_f1_score': 0.94693106}
confusion matrix:
       0      1
0  22518   2792
1     44  25302
---- Validation: 
scalar performance:
{'acc': 0.80362767, 'precision': 0.5402836, 'recall': 0.7818849, 'specificity': 0.7818849, 'f1': 0.5232389, 'auroc': 0.85750914, 'binary_precision': 0.0879397, 'binary_recall': 0.7590361, 'binary_specificity': 0.80473375, 'binary_f1_score': 0.15761822}
confusion matrix:
       0     1
0  13464  3267
1    100   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92287916, 'precision': 0.6120567, 'recall': 0.5031367, 'specificity': 0.5031367, 'f1': 0.48750988, 'auroc': 0.8608854, 'binary_precision': 0.3, 'binary_recall': 0.0077720205, 'binary_specificity': 0.9985014, 'binary_f1_score': 0.015151515}
confusion matrix:
      0   1
0  9328  14
1   766   6
early stop counter: 10
val acc:0.8036276698112488, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 12,now: 2024-08-09 10:29:00.086732,epoch time: 0:15:30.561923,used: 3:05:49.530490,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91442275, 'precision': 0.9264525, 'recall': 0.914383, 'specificity': 0.914383, 'f1': 0.91380954, 'auroc': 0.9985659, 'binary_precision': 0.8549461, 'binary_recall': 0.99830306, 'binary_specificity': 0.83046293, 'binary_f1_score': 0.92108}
confusion matrix:
       0      1
0  21024   4292
1     43  25297
---- Validation: 
scalar performance:
{'acc': 0.672635, 'precision': 0.5293836, 'recall': 0.7817353, 'specificity': 0.7817353, 'f1': 0.45805278, 'auroc': 0.87740415, 'binary_precision': 0.06260518, 'binary_recall': 0.89638555, 'binary_specificity': 0.66708505, 'binary_f1_score': 0.117036335}
confusion matrix:
       0     1
0  11161  5570
1     43   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89895195, 'precision': 0.55620754, 'recall': 0.5299923, 'specificity': 0.5299923, 'f1': 0.53568995, 'auroc': 0.78844404, 'binary_precision': 0.18434343, 'binary_recall': 0.09455959, 'binary_specificity': 0.96542495, 'binary_f1_score': 0.125}
confusion matrix:
      0    1
0  9019  323
1   699   73
early stop counter: 11
val acc:0.672635018825531, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 13,now: 2024-08-09 10:44:28.825526,epoch time: 0:15:28.738794,used: 3:21:18.269284,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9297023, 'precision': 0.9380008, 'recall': 0.92965615, 'specificity': 0.92965615, 'f1': 0.92936254, 'auroc': 0.9987578, 'binary_precision': 0.87787956, 'binary_recall': 0.99838233, 'binary_specificity': 0.86093, 'binary_f1_score': 0.93426126}
confusion matrix:
       0      1
0  21791   3520
1     41  25304
---- Validation: 
scalar performance:
{'acc': 0.8220576, 'precision': 0.54157376, 'recall': 0.7690047, 'specificity': 0.7690047, 'f1': 0.53147846, 'auroc': 0.8509173, 'binary_precision': 0.09169765, 'binary_recall': 0.713253, 'binary_specificity': 0.82475644, 'binary_f1_score': 0.16250344}
confusion matrix:
       0     1
0  13799  2932
1    119   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.908246, 'precision': 0.5572502, 'recall': 0.5195755, 'specificity': 0.5195755, 'f1': 0.52182907, 'auroc': 0.77106714, 'binary_precision': 0.188, 'binary_recall': 0.06088083, 'binary_specificity': 0.9782702, 'binary_f1_score': 0.091976516}
confusion matrix:
      0    1
0  9139  203
1   725   47
early stop counter: 12
val acc:0.8220576047897339, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 14,now: 2024-08-09 10:59:59.104159,epoch time: 0:15:30.278633,used: 3:36:48.547917,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9346178, 'precision': 0.9419011, 'recall': 0.9345849, 'specificity': 0.9345849, 'f1': 0.9343439, 'auroc': 0.998822, 'binary_precision': 0.88529754, 'binary_recall': 0.99869776, 'binary_specificity': 0.8704721, 'binary_f1_score': 0.9385848}
confusion matrix:
       0      1
0  22036   3279
1     33  25308
---- Validation: 
scalar performance:
{'acc': 0.8152339, 'precision': 0.54025084, 'recall': 0.7678581, 'specificity': 0.7678581, 'f1': 0.52728426, 'auroc': 0.8439931, 'binary_precision': 0.088981785, 'binary_recall': 0.7180723, 'binary_specificity': 0.8176439, 'binary_f1_score': 0.15834218}
confusion matrix:
       0     1
0  13680  3051
1    117   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88827366, 'precision': 0.52581674, 'recall': 0.516488, 'specificity': 0.516488, 'f1': 0.5182287, 'auroc': 0.73178834, 'binary_precision': 0.12552302, 'binary_recall': 0.07772021, 'binary_specificity': 0.9552558, 'binary_f1_score': 0.096}
confusion matrix:
      0    1
0  8924  418
1   712   60
early stop counter: 13
val acc:0.8152338862419128, best validation acc: 0.9627318382263184, corresponding to test acc:                         0.9195175170898438 / 0.9243622422218323
after epoch: 15,now: 2024-08-09 11:15:39.920081,epoch time: 0:15:40.815922,used: 3:52:29.363839,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_07_23_10_seed_0_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:52:29.363839 at 2024-08-09 11:15:39.920081
persisted model performance metric: 

scalar performance:
{'acc': 0.9195175, 'precision': 0.64941347, 'recall': 0.5334009, 'specificity': 0.5334009, 'f1': 0.5431452, 'auroc': 0.880576, 'binary_precision': 0.37037036, 'binary_recall': 0.07772021, 'binary_specificity': 0.98908156, 'binary_f1_score': 0.12847966}
confusion matrix:
      0    1
0  9240  102
1   712   60
oracle model performance metric: 

scalar performance:
{'acc': 0.92436224, 'precision': 0.77739036, 'recall': 0.51047516, 'specificity': 0.51047516, 'f1': 0.50158954, 'auroc': 0.86090374, 'binary_precision': 0.6296296, 'binary_recall': 0.022020726, 'binary_specificity': 0.99892956, 'binary_f1_score': 0.042553194}
confusion matrix:
      0   1
0  9332  10
1   755  17
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491246 KiB |  11067 MiB | 650981 GiB | 650980 GiB |
|       from large pool | 400704 KiB |  10993 MiB | 650132 GiB | 650131 GiB |
|       from small pool |  90542 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 491246 KiB |  11067 MiB | 650981 GiB | 650980 GiB |
|       from large pool | 400704 KiB |  10993 MiB | 650132 GiB | 650131 GiB |
|       from small pool |  90542 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476753 KiB |  10961 MiB | 647947 GiB | 647946 GiB |
|       from large pool | 387840 KiB |  10889 MiB | 647107 GiB | 647107 GiB |
|       from small pool |  88913 KiB |    123 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11376 MiB |  11376 MiB |  11376 MiB |      0 B   |
|       from large pool |  11248 MiB |  11248 MiB |  11248 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1362 MiB |   2034 MiB | 212927 GiB | 212925 GiB |
|       from large pool |   1352 MiB |   2031 MiB | 211937 GiB | 211935 GiB |
|       from small pool |      9 MiB |     10 MiB |    989 GiB |    989 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5175    |    7578    |   56056 K  |   56051 K  |
|       from large pool |      87    |     909    |   24283 K  |   24283 K  |
|       from small pool |    5088    |    7489    |   31773 K  |   31768 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5175    |    7578    |   56056 K  |   56051 K  |
|       from large pool |      87    |     909    |   24283 K  |   24283 K  |
|       from small pool |    5088    |    7489    |   31773 K  |   31768 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     236    |     236    |     236    |       0    |
|       from large pool |     172    |     172    |     172    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3199    |   26516 K  |   26516 K  |
|       from large pool |      23    |      62    |    9996 K  |    9996 K  |
|       from small pool |      54    |    3175    |   16520 K  |   16520 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11067 MiB | 650981 GiB | 650981 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 650132 GiB | 650132 GiB |
|       from small pool |      0 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11067 MiB | 650981 GiB | 650981 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 650132 GiB | 650132 GiB |
|       from small pool |      0 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB | 647947 GiB | 647947 GiB |
|       from large pool |  16640 KiB |  10889 MiB | 647107 GiB | 647107 GiB |
|       from small pool |      0 KiB |    123 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1842 MiB |  11376 MiB |  11376 MiB |   9534 MiB |
|       from large pool |   1744 MiB |  11248 MiB |  11248 MiB |   9504 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2034 MiB | 212927 GiB | 212927 GiB |
|       from large pool | 134912 KiB |   2031 MiB | 211937 GiB | 211937 GiB |
|       from small pool |      0 KiB |     26 MiB |    990 GiB |    990 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56056 K  |   56056 K  |
|       from large pool |       2    |     909    |   24283 K  |   24283 K  |
|       from small pool |       0    |    7489    |   31773 K  |   31773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56056 K  |   56056 K  |
|       from large pool |       2    |     909    |   24283 K  |   24283 K  |
|       from small pool |       0    |    7489    |   31773 K  |   31773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     236    |     236    |     157    |
|       from large pool |      30    |     172    |     172    |     142    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3199    |   26518 K  |   26518 K  |
|       from large pool |       4    |      62    |    9996 K  |    9996 K  |
|       from small pool |       0    |    3175    |   16522 K  |   16522 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11067 MiB | 650981 GiB | 650981 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 650132 GiB | 650132 GiB |
|       from small pool |      0 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11067 MiB | 650981 GiB | 650981 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 650132 GiB | 650132 GiB |
|       from small pool |      0 KiB |    125 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB | 647947 GiB | 647947 GiB |
|       from large pool |  16640 KiB |  10889 MiB | 647107 GiB | 647107 GiB |
|       from small pool |      0 KiB |    123 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1842 MiB |  11376 MiB |  11376 MiB |   9534 MiB |
|       from large pool |   1744 MiB |  11248 MiB |  11248 MiB |   9504 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2034 MiB | 212927 GiB | 212927 GiB |
|       from large pool | 134912 KiB |   2031 MiB | 211937 GiB | 211937 GiB |
|       from small pool |      0 KiB |     26 MiB |    990 GiB |    990 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7578    |   56056 K  |   56056 K  |
|       from large pool |       2    |     909    |   24283 K  |   24283 K  |
|       from small pool |       0    |    7489    |   31773 K  |   31773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7578    |   56056 K  |   56056 K  |
|       from large pool |       2    |     909    |   24283 K  |   24283 K  |
|       from small pool |       0    |    7489    |   31773 K  |   31773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     236    |     236    |     157    |
|       from large pool |      30    |     172    |     172    |     142    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3199    |   26518 K  |   26518 K  |
|       from large pool |       4    |      62    |    9996 K  |    9996 K  |
|       from small pool |       0    |    3175    |   16522 K  |   16522 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704

 Experiment start at: 2024-08-09 11:34:52.026471
before training, model accuracy: 0.20513328909873962
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9707861, 'precision': 0.9710673, 'recall': 0.9707944, 'specificity': 0.9707944, 'f1': 0.97078216, 'auroc': 0.9945055, 'binary_precision': 0.9827447, 'binary_recall': 0.9584398, 'binary_specificity': 0.98314893, 'binary_f1_score': 0.97044015}
confusion matrix:
       0      1
0  24971    428
1   1057  24376
---- Validation: 
scalar performance:
{'acc': 0.96069616, 'precision': 0.64777774, 'recall': 0.7153883, 'specificity': 0.7153883, 'f1': 0.6744879, 'auroc': 0.812696, 'binary_precision': 0.30974844, 'binary_recall': 0.45707658, 'binary_specificity': 0.9737, 'binary_f1_score': 0.36925963}
confusion matrix:
       0    1
0  16253  439
1    234  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92062235, 'precision': 0.70186067, 'recall': 0.6427003, 'specificity': 0.6427003, 'f1': 0.6656776, 'auroc': 0.88468754, 'binary_precision': 0.45785442, 'binary_recall': 0.31571993, 'binary_specificity': 0.9696807, 'binary_f1_score': 0.37372947}
confusion matrix:
      0    1
0  9051  283
1   518  239
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 11:51:10.181778,epoch time: 0:16:18.155307,used: 0:16:18.155307,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9536906, 'precision': 0.95547336, 'recall': 0.95366853, 'specificity': 0.95366853, 'f1': 0.9536437, 'auroc': 0.99558234, 'binary_precision': 0.9271543, 'binary_recall': 0.98482347, 'binary_specificity': 0.9225136, 'binary_f1_score': 0.9551192}
confusion matrix:
       0      1
0  23430   1968
1    386  25048
---- Validation: 
scalar performance:
{'acc': 0.8673714, 'precision': 0.56182104, 'recall': 0.81330884, 'specificity': 0.81330884, 'f1': 0.5752779, 'auroc': 0.8742653, 'binary_precision': 0.13081862, 'binary_recall': 0.7563805, 'binary_specificity': 0.87023723, 'binary_f1_score': 0.22305849}
confusion matrix:
       0     1
0  14526  2166
1    105   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9207214, 'precision': 0.71349806, 'recall': 0.70830286, 'specificity': 0.70830286, 'f1': 0.7108583, 'auroc': 0.89949584, 'binary_precision': 0.47082767, 'binary_recall': 0.4583884, 'binary_specificity': 0.95821726, 'binary_f1_score': 0.46452478}
confusion matrix:
      0    1
0  8944  390
1   410  347
new oracle model saved
early stop counter: 1
val acc:0.8673713803291321, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9207214117050171
after epoch: 2,now: 2024-08-09 12:06:32.528029,epoch time: 0:15:22.346251,used: 0:31:40.501558,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9703533, 'precision': 0.9704006, 'recall': 0.9703493, 'specificity': 0.9703493, 'f1': 0.9703524, 'auroc': 0.9965703, 'binary_precision': 0.9658905, 'binary_recall': 0.9751936, 'binary_specificity': 0.965505, 'binary_f1_score': 0.9705198}
confusion matrix:
       0      1
0  24519    876
1    631  24806
---- Validation: 
scalar performance:
{'acc': 0.9275244, 'precision': 0.5910224, 'recall': 0.76392215, 'specificity': 0.76392215, 'f1': 0.62653583, 'auroc': 0.8694774, 'binary_precision': 0.19318181, 'binary_recall': 0.5916473, 'binary_specificity': 0.936197, 'binary_f1_score': 0.29126212}
confusion matrix:
       0     1
0  15627  1065
1    176   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239917, 'precision': 0.63479376, 'recall': 0.5061406, 'specificity': 0.5061406, 'f1': 0.49416652, 'auroc': 0.90410143, 'binary_precision': 0.34375, 'binary_recall': 0.014531043, 'binary_specificity': 0.99775016, 'binary_f1_score': 0.027883396}
confusion matrix:
      0   1
0  9313  21
1   746  11
new oracle model saved
early stop counter: 2
val acc:0.9275243878364563, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9239916801452637
after epoch: 3,now: 2024-08-09 12:21:59.589331,epoch time: 0:15:27.061302,used: 0:47:07.562860,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9585694, 'precision': 0.96096855, 'recall': 0.9585397, 'specificity': 0.9585397, 'f1': 0.9585135, 'auroc': 0.99780834, 'binary_precision': 0.92791903, 'binary_recall': 0.9944569, 'binary_specificity': 0.92262256, 'binary_f1_score': 0.9600364}
confusion matrix:
       0      1
0  23430   1965
1    141  25296
---- Validation: 
scalar performance:
{'acc': 0.8926006, 'precision': 0.57858557, 'recall': 0.8432013, 'specificity': 0.8432013, 'f1': 0.6062803, 'auroc': 0.89344776, 'binary_precision': 0.1631579, 'binary_recall': 0.7911833, 'binary_specificity': 0.89521927, 'binary_f1_score': 0.27052757}
confusion matrix:
       0     1
0  14943  1749
1     90   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92389256, 'precision': 0.6491735, 'recall': 0.5091217, 'specificity': 0.5091217, 'f1': 0.5001878, 'auroc': 0.89765525, 'binary_precision': 0.37209302, 'binary_recall': 0.021136064, 'binary_specificity': 0.9971073, 'binary_f1_score': 0.040000003}
confusion matrix:
      0   1
0  9307  27
1   741  16
early stop counter: 3
val acc:0.8926005959510803, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9239916801452637
after epoch: 4,now: 2024-08-09 12:37:18.034654,epoch time: 0:15:18.445323,used: 1:02:26.008183,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9614613, 'precision': 0.9631254, 'recall': 0.96143436, 'specificity': 0.96143436, 'f1': 0.96142507, 'auroc': 0.99760544, 'binary_precision': 0.9355892, 'binary_recall': 0.99123394, 'binary_specificity': 0.9316347, 'binary_f1_score': 0.9626081}
confusion matrix:
       0      1
0  23657   1736
1    223  25216
---- Validation: 
scalar performance:
{'acc': 0.8886293, 'precision': 0.57012486, 'recall': 0.8072602, 'specificity': 0.8072602, 'f1': 0.59291077, 'auroc': 0.87939036, 'binary_precision': 0.14823641, 'binary_recall': 0.7215777, 'binary_specificity': 0.8929427, 'binary_f1_score': 0.24594702}
confusion matrix:
       0     1
0  14905  1787
1    120   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92508173, 'precision': 0.73202103, 'recall': 0.5043021, 'specificity': 0.5043021, 'f1': 0.48961842, 'auroc': 0.88061506, 'binary_precision': 0.53846157, 'binary_recall': 0.009247027, 'binary_specificity': 0.99935716, 'binary_f1_score': 0.01818182}
confusion matrix:
      0  1
0  9328  6
1   750  7
new oracle model saved
early stop counter: 4
val acc:0.8886293172836304, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.925081729888916
after epoch: 5,now: 2024-08-09 12:52:45.196436,epoch time: 0:15:27.161782,used: 1:17:53.169965,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96126455, 'precision': 0.9633428, 'recall': 0.9612383, 'specificity': 0.9612383, 'f1': 0.96121943, 'auroc': 0.9977884, 'binary_precision': 0.93250763, 'binary_recall': 0.9945746, 'binary_specificity': 0.92790204, 'binary_f1_score': 0.9625415}
confusion matrix:
       0      1
0  23565   1831
1    138  25298
---- Validation: 
scalar performance:
{'acc': 0.8816796, 'precision': 0.5714734, 'recall': 0.83533955, 'specificity': 0.83533955, 'f1': 0.5932539, 'auroc': 0.88265896, 'binary_precision': 0.1491421, 'binary_recall': 0.78654295, 'binary_specificity': 0.88413614, 'binary_f1_score': 0.25073966}
confusion matrix:
       0     1
0  14758  1934
1     92   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9260727, 'precision': 0.84415996, 'recall': 0.5103002, 'specificity': 0.5103002, 'f1': 0.5013427, 'auroc': 0.8656515, 'binary_precision': 0.7619048, 'binary_recall': 0.021136064, 'binary_specificity': 0.99946433, 'binary_f1_score': 0.04113111}
confusion matrix:
      0   1
0  9329   5
1   741  16
new oracle model saved
early stop counter: 5
val acc:0.8816795945167542, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9260727167129517
after epoch: 6,now: 2024-08-09 13:07:59.056588,epoch time: 0:15:13.860152,used: 1:33:07.030117,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9484183, 'precision': 0.9521563, 'recall': 0.9483826, 'specificity': 0.9483826, 'f1': 0.9483086, 'auroc': 0.9965491, 'binary_precision': 0.9112409, 'binary_recall': 0.9937097, 'binary_specificity': 0.9030556, 'binary_f1_score': 0.95069015}
confusion matrix:
       0      1
0  22934   2462
1    160  25276
---- Validation: 
scalar performance:
{'acc': 0.8747299, 'precision': 0.56136256, 'recall': 0.7933502, 'specificity': 0.7933502, 'f1': 0.57665044, 'auroc': 0.859952, 'binary_precision': 0.13123924, 'binary_recall': 0.7076566, 'binary_specificity': 0.8790439, 'binary_f1_score': 0.2214156}
confusion matrix:
       0     1
0  14673  2019
1    126   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92528, 'precision': 0.96262884, 'recall': 0.5019815, 'specificity': 0.5019815, 'f1': 0.4845364, 'auroc': 0.81986725, 'binary_precision': 1.0, 'binary_recall': 0.003963012, 'binary_specificity': 1.0, 'binary_f1_score': 0.007894737}
confusion matrix:
      0  1
0  9334  0
1   754  3
early stop counter: 6
val acc:0.8747298717498779, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9260727167129517
after epoch: 7,now: 2024-08-09 13:22:51.600193,epoch time: 0:14:52.543605,used: 1:47:59.573722,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94113946, 'precision': 0.94677436, 'recall': 0.9410975, 'specificity': 0.9410975, 'f1': 0.9409493, 'auroc': 0.99804294, 'binary_precision': 0.89678586, 'binary_recall': 0.9971299, 'binary_specificity': 0.88506514, 'binary_f1_score': 0.94429964}
confusion matrix:
       0      1
0  22478   2919
1     73  25362
---- Validation: 
scalar performance:
{'acc': 0.80459034, 'precision': 0.54747367, 'recall': 0.82405305, 'specificity': 0.82405305, 'f1': 0.53389835, 'auroc': 0.8792654, 'binary_precision': 0.09991765, 'binary_recall': 0.84454757, 'binary_specificity': 0.8035586, 'binary_f1_score': 0.17869416}
confusion matrix:
       0     1
0  13413  3279
1     67   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92567635, 'precision': 0.90729904, 'recall': 0.5052305, 'specificity': 0.5052305, 'f1': 0.49112993, 'auroc': 0.8634569, 'binary_precision': 0.8888889, 'binary_recall': 0.010568032, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.02088773}
confusion matrix:
      0  1
0  9333  1
1   749  8
early stop counter: 7
val acc:0.8045903444290161, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9260727167129517
after epoch: 8,now: 2024-08-09 13:37:45.582081,epoch time: 0:14:53.981888,used: 2:02:53.555610,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9412378, 'precision': 0.94688773, 'recall': 0.9411937, 'specificity': 0.9411937, 'f1': 0.9410474, 'auroc': 0.9975066, 'binary_precision': 0.8968358, 'binary_recall': 0.99728733, 'binary_specificity': 0.8851, 'binary_f1_score': 0.9443979}
confusion matrix:
       0      1
0  22478   2918
1     69  25367
---- Validation: 
scalar performance:
{'acc': 0.8281259, 'precision': 0.55298156, 'recall': 0.830474, 'specificity': 0.830474, 'f1': 0.5499489, 'auroc': 0.8759552, 'binary_precision': 0.11114551, 'binary_recall': 0.83294666, 'binary_specificity': 0.82800144, 'binary_f1_score': 0.19612129}
confusion matrix:
       0     1
0  13821  2871
1     72   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9265682, 'precision': 0.8090156, 'recall': 0.5184582, 'specificity': 0.5184582, 'f1': 0.5171807, 'auroc': 0.8723713, 'binary_precision': 0.6904762, 'binary_recall': 0.038309116, 'binary_specificity': 0.9986072, 'binary_f1_score': 0.07259074}
confusion matrix:
      0   1
0  9321  13
1   728  29
new oracle model saved
early stop counter: 8
val acc:0.8281258940696716, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9265682101249695
after epoch: 9,now: 2024-08-09 13:52:32.562060,epoch time: 0:14:46.979979,used: 2:17:40.535589,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9304965, 'precision': 0.9383974, 'recall': 0.9304412, 'specificity': 0.9304412, 'f1': 0.93017584, 'auroc': 0.9960208, 'binary_precision': 0.8797504, 'binary_recall': 0.9974447, 'binary_specificity': 0.8634377, 'binary_f1_score': 0.934908}
confusion matrix:
       0      1
0  21927   3468
1     65  25372
---- Validation: 
scalar performance:
{'acc': 0.824213, 'precision': 0.5485671, 'recall': 0.8047342, 'specificity': 0.8047342, 'f1': 0.5424509, 'auroc': 0.8590655, 'binary_precision': 0.10384025, 'binary_recall': 0.7842227, 'binary_specificity': 0.8252456, 'binary_f1_score': 0.18339664}
confusion matrix:
       0     1
0  13775  2917
1     93   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92577547, 'precision': 0.77223206, 'recall': 0.5131742, 'specificity': 0.5131742, 'f1': 0.5072356, 'auroc': 0.84261584, 'binary_precision': 0.61764705, 'binary_recall': 0.027741084, 'binary_specificity': 0.9986072, 'binary_f1_score': 0.05309735}
confusion matrix:
      0   1
0  9321  13
1   736  21
early stop counter: 9
val acc:0.8242130279541016, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9265682101249695
after epoch: 10,now: 2024-08-09 14:07:31.868597,epoch time: 0:14:59.306537,used: 2:32:39.842126,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92551935, 'precision': 0.93456495, 'recall': 0.92545986, 'specificity': 0.92545986, 'f1': 0.9251226, 'auroc': 0.99748456, 'binary_precision': 0.87207425, 'binary_recall': 0.99748397, 'binary_specificity': 0.8534357, 'binary_f1_score': 0.93057287}
confusion matrix:
       0      1
0  21673   3722
1     64  25373
---- Validation: 
scalar performance:
{'acc': 0.78561, 'precision': 0.5448605, 'recall': 0.82674944, 'specificity': 0.82674944, 'f1': 0.5232801, 'auroc': 0.8897047, 'binary_precision': 0.09398496, 'binary_recall': 0.8700696, 'binary_specificity': 0.7834292, 'binary_f1_score': 0.16964488}
confusion matrix:
       0     1
0  13077  3615
1     56   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.927361, 'precision': 0.82534343, 'recall': 0.5249561, 'specificity': 0.5249561, 'f1': 0.5291687, 'auroc': 0.799536, 'binary_precision': 0.7222222, 'binary_recall': 0.051519156, 'binary_specificity': 0.998393, 'binary_f1_score': 0.096177556}
confusion matrix:
      0   1
0  9319  15
1   718  39
new oracle model saved
early stop counter: 10
val acc:0.785610020160675, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.927361011505127
after epoch: 11,now: 2024-08-09 14:22:29.196348,epoch time: 0:14:57.327751,used: 2:47:37.169877,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9251062, 'precision': 0.9344734, 'recall': 0.9250456, 'specificity': 0.9250456, 'f1': 0.9246931, 'auroc': 0.99786353, 'binary_precision': 0.8708848, 'binary_recall': 0.99834883, 'binary_specificity': 0.85174245, 'binary_f1_score': 0.9302709}
confusion matrix:
       0      1
0  21630   3765
1     42  25395
---- Validation: 
scalar performance:
{'acc': 0.7741634, 'precision': 0.5429004, 'recall': 0.8231386, 'specificity': 0.8231386, 'f1': 0.5163182, 'auroc': 0.8880065, 'binary_precision': 0.08997613, 'binary_recall': 0.87470996, 'binary_specificity': 0.7715672, 'binary_f1_score': 0.16316813}
confusion matrix:
       0     1
0  12879  3813
1     54   377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9282529, 'precision': 0.87615716, 'recall': 0.527259, 'specificity': 0.527259, 'f1': 0.53329533, 'auroc': 0.8156478, 'binary_precision': 0.8235294, 'binary_recall': 0.055482168, 'binary_specificity': 0.9990358, 'binary_f1_score': 0.103960395}
confusion matrix:
      0   1
0  9325   9
1   715  42
new oracle model saved
early stop counter: 11
val acc:0.7741634249687195, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9282528758049011
after epoch: 12,now: 2024-08-09 14:37:20.036995,epoch time: 0:14:50.840647,used: 3:02:28.010524,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9165683, 'precision': 0.92806304, 'recall': 0.9165071, 'specificity': 0.9165071, 'f1': 0.9159962, 'auroc': 0.9981023, 'binary_precision': 0.8581035, 'binary_recall': 0.9983487, 'binary_specificity': 0.83466554, 'binary_f1_score': 0.9229287}
confusion matrix:
       0      1
0  21198   4199
1     42  25393
---- Validation: 
scalar performance:
{'acc': 0.7391228, 'precision': 0.5361365, 'recall': 0.7961248, 'specificity': 0.7961248, 'f1': 0.49398482, 'auroc': 0.85673183, 'binary_precision': 0.07729367, 'binary_recall': 0.8561485, 'binary_specificity': 0.73610115, 'binary_f1_score': 0.14178672}
confusion matrix:
       0     1
0  12287  4405
1     62   369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9268655, 'precision': 0.8296845, 'recall': 0.51922584, 'specificity': 0.51922584, 'f1': 0.51855767, 'auroc': 0.8066478, 'binary_precision': 0.73170733, 'binary_recall': 0.03963012, 'binary_specificity': 0.9988215, 'binary_f1_score': 0.07518797}
confusion matrix:
      0   1
0  9323  11
1   727  30
early stop counter: 12
val acc:0.7391228079795837, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9282528758049011
after epoch: 13,now: 2024-08-09 14:52:08.487989,epoch time: 0:14:48.450994,used: 3:17:16.461518,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92111266, 'precision': 0.93160295, 'recall': 0.92105144, 'specificity': 0.92105144, 'f1': 0.92062265, 'auroc': 0.99769396, 'binary_precision': 0.8645117, 'binary_recall': 0.9988992, 'binary_specificity': 0.84320366, 'binary_f1_score': 0.9268595}
confusion matrix:
       0      1
0  21414   3982
1     28  25408
---- Validation: 
scalar performance:
{'acc': 0.8097296, 'precision': 0.5469381, 'recall': 0.8131274, 'specificity': 0.8131274, 'f1': 0.53505325, 'auroc': 0.8740203, 'binary_precision': 0.09968847, 'binary_recall': 0.81670535, 'binary_specificity': 0.8095495, 'binary_f1_score': 0.17768803}
confusion matrix:
       0     1
0  13513  3179
1     79   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9179467, 'precision': 0.611807, 'recall': 0.52715033, 'specificity': 0.52715033, 'f1': 0.5333345, 'auroc': 0.7860458, 'binary_precision': 0.2947977, 'binary_recall': 0.067371204, 'binary_specificity': 0.9869295, 'binary_f1_score': 0.10967741}
confusion matrix:
      0    1
0  9212  122
1   706   51
early stop counter: 13
val acc:0.8097295761108398, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9282528758049011
after epoch: 14,now: 2024-08-09 15:06:57.718348,epoch time: 0:14:49.230359,used: 3:32:05.691877,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92788005, 'precision': 0.9364258, 'recall': 0.9278251, 'specificity': 0.9278251, 'f1': 0.92751896, 'auroc': 0.99783146, 'binary_precision': 0.87555206, 'binary_recall': 0.9976804, 'binary_specificity': 0.85796976, 'binary_f1_score': 0.93263507}
confusion matrix:
       0      1
0  21789   3607
1     59  25377
---- Validation: 
scalar performance:
{'acc': 0.82316184, 'precision': 0.54447293, 'recall': 0.7770717, 'specificity': 0.7770717, 'f1': 0.5363929, 'auroc': 0.8476813, 'binary_precision': 0.09736434, 'binary_recall': 0.7285383, 'binary_specificity': 0.8256051, 'binary_f1_score': 0.17177242}
confusion matrix:
       0     1
0  13781  2911
1    117   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91992867, 'precision': 0.61512583, 'recall': 0.5209385, 'specificity': 0.5209385, 'f1': 0.52308106, 'auroc': 0.72322524, 'binary_precision': 0.30232558, 'binary_recall': 0.051519156, 'binary_specificity': 0.9903578, 'binary_f1_score': 0.08803611}
confusion matrix:
      0   1
0  9244  90
1   718  39
early stop counter: 14
val acc:0.8231618404388428, best validation acc: 0.9606961607933044, corresponding to test acc:                         0.9206223487854004 / 0.9282528758049011
after epoch: 15,now: 2024-08-09 15:21:48.908211,epoch time: 0:14:51.189863,used: 3:46:56.881740,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_11_34_51_seed_1_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:46:56.881740 at 2024-08-09 15:21:48.908211
persisted model performance metric: 

scalar performance:
{'acc': 0.92062235, 'precision': 0.70186067, 'recall': 0.6427003, 'specificity': 0.6427003, 'f1': 0.6656776, 'auroc': 0.88468754, 'binary_precision': 0.45785442, 'binary_recall': 0.31571993, 'binary_specificity': 0.9696807, 'binary_f1_score': 0.37372947}
confusion matrix:
      0    1
0  9051  283
1   518  239
oracle model performance metric: 

scalar performance:
{'acc': 0.9282529, 'precision': 0.87615716, 'recall': 0.527259, 'specificity': 0.527259, 'f1': 0.53329533, 'auroc': 0.8156478, 'binary_precision': 0.8235294, 'binary_recall': 0.055482168, 'binary_specificity': 0.9990358, 'binary_f1_score': 0.103960395}
confusion matrix:
      0   1
0  9325   9
1   715  42
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496616 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool | 406080 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |  90536 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496616 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool | 406080 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |  90536 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10961 MiB |   1274 TiB |   1274 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1272 TiB |   1272 TiB |
|       from small pool |  88912 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11368 MiB |  11376 MiB |  20902 MiB |   9534 MiB |
|       from large pool |  11242 MiB |  11248 MiB |  20746 MiB |   9504 MiB |
|       from small pool |    126 MiB |    128 MiB |    156 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1015 MiB |   2100 MiB | 453524 GiB | 453523 GiB |
|       from large pool |   1007 MiB |   2097 MiB | 451506 GiB | 451505 GiB |
|       from small pool |      7 MiB |     26 MiB |   2017 GiB |   2017 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7600    |  112767 K  |  112762 K  |
|       from large pool |      87    |     909    |   48921 K  |   48920 K  |
|       from small pool |    5076    |    7511    |   63846 K  |   63841 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7600    |  112767 K  |  112762 K  |
|       from large pool |      87    |     909    |   48921 K  |   48920 K  |
|       from small pool |    5076    |    7511    |   63846 K  |   63841 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     233    |     236    |     390    |     157    |
|       from large pool |     170    |     172    |     312    |     142    |
|       from small pool |      63    |      64    |      78    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3206    |   57812 K  |   57812 K  |
|       from large pool |      18    |      62    |   24587 K  |   24587 K  |
|       from small pool |      50    |    3187    |   33224 K  |   33224 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1274 TiB |   1274 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1272 TiB |   1272 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1500 MiB |  11376 MiB |  20902 MiB |  19402 MiB |
|       from large pool |   1404 MiB |  11248 MiB |  20746 MiB |  19342 MiB |
|       from small pool |     96 MiB |    128 MiB |    156 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2100 MiB | 453524 GiB | 453524 GiB |
|       from large pool | 134912 KiB |   2097 MiB | 451506 GiB | 451506 GiB |
|       from small pool |      0 KiB |     31 MiB |   2017 GiB |   2017 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  112767 K  |  112767 K  |
|       from large pool |       2    |     909    |   48921 K  |   48921 K  |
|       from small pool |       0    |    7511    |   63846 K  |   63846 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  112767 K  |  112767 K  |
|       from large pool |       2    |     909    |   48921 K  |   48921 K  |
|       from small pool |       0    |    7511    |   63846 K  |   63846 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     236    |     390    |     310    |
|       from large pool |      32    |     172    |     312    |     280    |
|       from small pool |      48    |      64    |      78    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3206    |   57815 K  |   57815 K  |
|       from large pool |       4    |      62    |   24587 K  |   24587 K  |
|       from small pool |       0    |    3187    |   33227 K  |   33227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1280 TiB |   1280 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1278 TiB |   1278 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1274 TiB |   1274 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1272 TiB |   1272 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1500 MiB |  11376 MiB |  20902 MiB |  19402 MiB |
|       from large pool |   1404 MiB |  11248 MiB |  20746 MiB |  19342 MiB |
|       from small pool |     96 MiB |    128 MiB |    156 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2100 MiB | 453524 GiB | 453524 GiB |
|       from large pool | 134912 KiB |   2097 MiB | 451506 GiB | 451506 GiB |
|       from small pool |      0 KiB |     31 MiB |   2017 GiB |   2017 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7600    |  112767 K  |  112767 K  |
|       from large pool |       2    |     909    |   48921 K  |   48921 K  |
|       from small pool |       0    |    7511    |   63846 K  |   63846 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7600    |  112767 K  |  112767 K  |
|       from large pool |       2    |     909    |   48921 K  |   48921 K  |
|       from small pool |       0    |    7511    |   63846 K  |   63846 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     236    |     390    |     310    |
|       from large pool |      32    |     172    |     312    |     280    |
|       from small pool |      48    |      64    |      78    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3206    |   57815 K  |   57815 K  |
|       from large pool |       4    |      62    |   24587 K  |   24587 K  |
|       from small pool |       0    |    3187    |   33227 K  |   33227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704

 Experiment start at: 2024-08-09 15:40:14.598986
before training, model accuracy: 0.10671819001436234
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9673089, 'precision': 0.968018, 'recall': 0.96731186, 'specificity': 0.96731186, 'f1': 0.9672966, 'auroc': 0.99436086, 'binary_precision': 0.98627436, 'binary_recall': 0.94781834, 'binary_specificity': 0.98680544, 'binary_f1_score': 0.966664}
confusion matrix:
       0      1
0  25503    341
1   1349  24503
---- Validation: 
scalar performance:
{'acc': 0.965779, 'precision': 0.67335886, 'recall': 0.74454784, 'specificity': 0.74454784, 'f1': 0.7022291, 'auroc': 0.8528413, 'binary_precision': 0.3590604, 'binary_recall': 0.5119617, 'binary_specificity': 0.977134, 'binary_f1_score': 0.42209074}
confusion matrix:
       0    1
0  16324  382
1    204  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.7216253, 'recall': 0.6451107, 'specificity': 0.6451107, 'f1': 0.67306143, 'auroc': 0.84517545, 'binary_precision': 0.5, 'binary_recall': 0.3174404, 'binary_specificity': 0.97278106, 'binary_f1_score': 0.3883346}
confusion matrix:
      0    1
0  9042  253
1   544  253
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 15:56:47.223170,epoch time: 0:16:32.624184,used: 0:16:32.624184,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9694561, 'precision': 0.96982, 'recall': 0.9694555, 'specificity': 0.9694555, 'f1': 0.9694501, 'auroc': 0.9969394, 'binary_precision': 0.9567525, 'binary_recall': 0.98336494, 'binary_specificity': 0.9555461, 'binary_f1_score': 0.9698762}
confusion matrix:
       0      1
0  24698   1149
1    430  25419
---- Validation: 
scalar performance:
{'acc': 0.9235576, 'precision': 0.5972923, 'recall': 0.8255383, 'specificity': 0.8255383, 'f1': 0.637626, 'auroc': 0.89357114, 'binary_precision': 0.20200668, 'binary_recall': 0.72248805, 'binary_specificity': 0.9285885, 'binary_f1_score': 0.31573445}
confusion matrix:
       0     1
0  15513  1193
1    116   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91200954, 'precision': 0.67114145, 'recall': 0.6063756, 'specificity': 0.6063756, 'f1': 0.62855554, 'auroc': 0.82327765, 'binary_precision': 0.40501043, 'binary_recall': 0.2434128, 'binary_specificity': 0.96933836, 'binary_f1_score': 0.30407524}
confusion matrix:
      0    1
0  9010  285
1   603  194
early stop counter: 1
val acc:0.9235575795173645, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9210265278816223
after epoch: 2,now: 2024-08-09 16:12:28.915807,epoch time: 0:15:41.692637,used: 0:32:14.316821,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9638657, 'precision': 0.96499586, 'recall': 0.9638609, 'specificity': 0.9638609, 'f1': 0.96384346, 'auroc': 0.99731016, 'binary_precision': 0.94211984, 'binary_recall': 0.9884733, 'binary_specificity': 0.93924856, 'binary_f1_score': 0.9647401}
confusion matrix:
       0      1
0  24273   1570
1    298  25555
---- Validation: 
scalar performance:
{'acc': 0.91018456, 'precision': 0.58293575, 'recall': 0.81401944, 'specificity': 0.81401944, 'f1': 0.6156979, 'auroc': 0.8963748, 'binary_precision': 0.17365967, 'binary_recall': 0.71291864, 'binary_specificity': 0.9151203, 'binary_f1_score': 0.27928773}
confusion matrix:
       0     1
0  15288  1418
1    120   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92023385, 'precision': 0.6971011, 'recall': 0.5334097, 'specificity': 0.5334097, 'f1': 0.54302484, 'auroc': 0.8466407, 'binary_precision': 0.46825397, 'binary_recall': 0.074027605, 'binary_specificity': 0.99279183, 'binary_f1_score': 0.12784399}
confusion matrix:
      0   1
0  9228  67
1   738  59
early stop counter: 2
val acc:0.9101845622062683, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9210265278816223
after epoch: 3,now: 2024-08-09 16:28:16.983373,epoch time: 0:15:48.067566,used: 0:48:02.384387,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97506577, 'precision': 0.97562957, 'recall': 0.97506446, 'specificity': 0.97506446, 'f1': 0.9750584, 'auroc': 0.9983169, 'binary_precision': 0.959273, 'binary_recall': 0.9922631, 'binary_specificity': 0.95786583, 'binary_f1_score': 0.9754892}
confusion matrix:
       0      1
0  24757   1089
1    200  25650
---- Validation: 
scalar performance:
{'acc': 0.9223312, 'precision': 0.6019161, 'recall': 0.85639834, 'specificity': 0.85639834, 'f1': 0.64487916, 'auroc': 0.92046803, 'binary_precision': 0.20955414, 'binary_recall': 0.78708136, 'binary_specificity': 0.9257153, 'binary_f1_score': 0.3309859}
confusion matrix:
       0     1
0  15465  1241
1     89   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.917063, 'precision': 0.6817957, 'recall': 0.57069045, 'specificity': 0.57069045, 'f1': 0.5944879, 'auroc': 0.8714551, 'binary_precision': 0.4319728, 'binary_recall': 0.15934755, 'binary_specificity': 0.9820334, 'binary_f1_score': 0.23281392}
confusion matrix:
      0    1
0  9128  167
1   670  127
early stop counter: 3
val acc:0.9223312139511108, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9210265278816223
after epoch: 4,now: 2024-08-09 16:44:09.354969,epoch time: 0:15:52.371596,used: 1:03:54.755983,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9519692, 'precision': 0.9552188, 'recall': 0.9519659, 'specificity': 0.9519659, 'f1': 0.9518831, 'auroc': 0.9975871, 'binary_precision': 0.91677666, 'binary_recall': 0.9941973, 'binary_specificity': 0.9097346, 'binary_f1_score': 0.95391864}
confusion matrix:
       0      1
0  23513   2333
1    150  25700
---- Validation: 
scalar performance:
{'acc': 0.86375844, 'precision': 0.56300247, 'recall': 0.8403741, 'specificity': 0.8403741, 'f1': 0.57575285, 'auroc': 0.90005237, 'binary_precision': 0.13130535, 'binary_recall': 0.81578946, 'binary_specificity': 0.8649587, 'binary_f1_score': 0.22620232}
confusion matrix:
       0     1
0  14450  2256
1     77   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9205311, 'precision': 0.69372183, 'recall': 0.51808494, 'specificity': 0.51808494, 'f1': 0.5161936, 'auroc': 0.7647818, 'binary_precision': 0.46376812, 'binary_recall': 0.040150564, 'binary_specificity': 0.99601936, 'binary_f1_score': 0.073903}
confusion matrix:
      0   1
0  9258  37
1   765  32
early stop counter: 4
val acc:0.8637584447860718, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9210265278816223
after epoch: 5,now: 2024-08-09 16:59:54.281828,epoch time: 0:15:44.926859,used: 1:19:39.682842,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96694136, 'precision': 0.9683869, 'recall': 0.9669392, 'specificity': 0.9669392, 'f1': 0.9669157, 'auroc': 0.9984642, 'binary_precision': 0.9423859, 'binary_recall': 0.9947002, 'binary_specificity': 0.9391782, 'binary_f1_score': 0.9678366}
confusion matrix:
       0      1
0  24274   1572
1    137  25713
---- Validation: 
scalar performance:
{'acc': 0.91526514, 'precision': 0.5926815, 'recall': 0.84344697, 'specificity': 0.84344697, 'f1': 0.6308058, 'auroc': 0.9130267, 'binary_precision': 0.1916418, 'binary_recall': 0.7679426, 'binary_specificity': 0.9189513, 'binary_f1_score': 0.30673674}
confusion matrix:
       0     1
0  15352  1354
1     97   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9195402, 'precision': 0.6238316, 'recall': 0.50722295, 'specificity': 0.50722295, 'f1': 0.49567828, 'auroc': 0.8310598, 'binary_precision': 0.3255814, 'binary_recall': 0.017565873, 'binary_specificity': 0.99688005, 'binary_f1_score': 0.033333335}
confusion matrix:
      0   1
0  9266  29
1   783  14
early stop counter: 5
val acc:0.9152651429176331, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9210265278816223
after epoch: 6,now: 2024-08-09 17:15:36.842815,epoch time: 0:15:42.560987,used: 1:35:22.243829,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9326834, 'precision': 0.9401288, 'recall': 0.9326607, 'specificity': 0.9326607, 'f1': 0.93239504, 'auroc': 0.9979996, 'binary_precision': 0.88297105, 'binary_recall': 0.99764085, 'binary_specificity': 0.8676806, 'binary_f1_score': 0.93680996}
confusion matrix:
       0      1
0  22420   3419
1     61  25796
---- Validation: 
scalar performance:
{'acc': 0.8322238, 'precision': 0.5465628, 'recall': 0.7880587, 'specificity': 0.7880587, 'f1': 0.54204106, 'auroc': 0.8577989, 'binary_precision': 0.10081301, 'binary_recall': 0.7416268, 'binary_specificity': 0.8344906, 'binary_f1_score': 0.17749785}
confusion matrix:
       0     1
0  13941  2765
1    108   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92092746, 'precision': 0.7134663, 'recall': 0.55672866, 'specificity': 0.55672866, 'f1': 0.5786033, 'auroc': 0.67715037, 'binary_precision': 0.49748743, 'binary_recall': 0.12421581, 'binary_specificity': 0.98924154, 'binary_f1_score': 0.19879517}
confusion matrix:
      0    1
0  9195  100
1   698   99
early stop counter: 6
val acc:0.8322237730026245, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9210265278816223
after epoch: 7,now: 2024-08-09 17:31:31.794568,epoch time: 0:15:54.951753,used: 1:51:17.195582,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.935082, 'precision': 0.9418961, 'recall': 0.9350724, 'specificity': 0.9350724, 'f1': 0.93482983, 'auroc': 0.99746025, 'binary_precision': 0.88706124, 'binary_recall': 0.99713755, 'binary_specificity': 0.8730073, 'binary_f1_score': 0.938884}
confusion matrix:
       0      1
0  22562   3282
1     74  25778
---- Validation: 
scalar performance:
{'acc': 0.83035505, 'precision': 0.54636246, 'recall': 0.7894335, 'specificity': 0.7894335, 'f1': 0.54112685, 'auroc': 0.84542096, 'binary_precision': 0.10028929, 'binary_recall': 0.7464115, 'binary_specificity': 0.8324554, 'binary_f1_score': 0.17682062}
confusion matrix:
       0     1
0  13907  2799
1    106   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92479193, 'precision': 0.8067509, 'recall': 0.54219335, 'specificity': 0.54219335, 'f1': 0.55818576, 'auroc': 0.6439094, 'binary_precision': 0.6862745, 'binary_recall': 0.08782936, 'binary_specificity': 0.9965573, 'binary_f1_score': 0.1557286}
confusion matrix:
      0   1
0  9263  32
1   727  70
new oracle model saved
early stop counter: 7
val acc:0.8303550481796265, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9247919321060181
after epoch: 8,now: 2024-08-09 17:47:25.958740,epoch time: 0:15:54.164172,used: 2:07:11.359754,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92927885, 'precision': 0.93743265, 'recall': 0.9292604, 'specificity': 0.9292604, 'f1': 0.92894566, 'auroc': 0.9969995, 'binary_precision': 0.8777782, 'binary_recall': 0.997486, 'binary_specificity': 0.8610348, 'binary_f1_score': 0.9338113}
confusion matrix:
       0      1
0  22250   3591
1     65  25790
---- Validation: 
scalar performance:
{'acc': 0.80956554, 'precision': 0.5471888, 'recall': 0.8254283, 'specificity': 0.8254283, 'f1': 0.5349347, 'auroc': 0.8752643, 'binary_precision': 0.09923879, 'binary_recall': 0.84210527, 'binary_specificity': 0.80875134, 'binary_f1_score': 0.1775536}
confusion matrix:
       0     1
0  13511  3195
1     66   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92181927, 'precision': 0.7476015, 'recall': 0.5187843, 'specificity': 0.5187843, 'f1': 0.517107, 'auroc': 0.7898658, 'binary_precision': 0.5714286, 'binary_recall': 0.040150564, 'binary_specificity': 0.997418, 'binary_f1_score': 0.075029306}
confusion matrix:
      0   1
0  9271  24
1   765  32
early stop counter: 8
val acc:0.809565544128418, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9247919321060181
after epoch: 9,now: 2024-08-09 18:03:17.143432,epoch time: 0:15:51.184692,used: 2:23:02.544446,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9469785, 'precision': 0.9514965, 'recall': 0.9469669, 'specificity': 0.9469669, 'f1': 0.9468446, 'auroc': 0.9981288, 'binary_precision': 0.90638953, 'binary_recall': 0.99694437, 'binary_specificity': 0.8969894, 'binary_f1_score': 0.9495128}
confusion matrix:
       0      1
0  23180   2662
1     79  25775
---- Validation: 
scalar performance:
{'acc': 0.8490423, 'precision': 0.55511796, 'recall': 0.818837, 'specificity': 0.818837, 'f1': 0.5597624, 'auroc': 0.88489, 'binary_precision': 0.116460174, 'binary_recall': 0.78708136, 'binary_specificity': 0.8505926, 'binary_f1_score': 0.20289853}
confusion matrix:
       0     1
0  14210  2496
1     89   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9216211, 'precision': 0.79437166, 'recall': 0.5072055, 'specificity': 0.5072055, 'f1': 0.49430472, 'auroc': 0.80414474, 'binary_precision': 0.6666667, 'binary_recall': 0.015056462, 'binary_specificity': 0.9993545, 'binary_f1_score': 0.029447854}
confusion matrix:
      0   1
0  9289   6
1   785  12
early stop counter: 9
val acc:0.8490422964096069, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9247919321060181
after epoch: 10,now: 2024-08-09 18:18:51.524256,epoch time: 0:15:34.380824,used: 2:38:36.925270,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9251586, 'precision': 0.93446755, 'recall': 0.92514163, 'specificity': 0.92514163, 'f1': 0.92475355, 'auroc': 0.9963573, 'binary_precision': 0.87092966, 'binary_recall': 0.9982981, 'binary_specificity': 0.85198516, 'binary_f1_score': 0.9302744}
confusion matrix:
       0      1
0  22017   3825
1     44  25810
---- Validation: 
scalar performance:
{'acc': 0.77966595, 'precision': 0.53731394, 'recall': 0.7809484, 'specificity': 0.7809484, 'f1': 0.51060414, 'auroc': 0.8303786, 'binary_precision': 0.081566475, 'binary_recall': 0.78229666, 'binary_specificity': 0.77960014, 'binary_f1_score': 0.14772984}
confusion matrix:
       0     1
0  13024  3682
1     91   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9128022, 'precision': 0.6519821, 'recall': 0.56550956, 'specificity': 0.56550956, 'f1': 0.5854559, 'auroc': 0.711578, 'binary_precision': 0.3730887, 'binary_recall': 0.15307403, 'binary_specificity': 0.97794515, 'binary_f1_score': 0.21708183}
confusion matrix:
      0    1
0  9090  205
1   675  122
early stop counter: 10
val acc:0.7796659469604492, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9247919321060181
after epoch: 11,now: 2024-08-09 18:33:56.957618,epoch time: 0:15:05.433362,used: 2:53:42.358632,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9209997, 'precision': 0.93124515, 'recall': 0.9209848, 'specificity': 0.9209848, 'f1': 0.9205258, 'auroc': 0.99696386, 'binary_precision': 0.8648232, 'binary_recall': 0.9980273, 'binary_specificity': 0.8439423, 'binary_f1_score': 0.92666286}
confusion matrix:
       0      1
0  21810   4033
1     51  25802
---- Validation: 
scalar performance:
{'acc': 0.80588645, 'precision': 0.5427234, 'recall': 0.79555297, 'specificity': 0.79555297, 'f1': 0.5275026, 'auroc': 0.85314715, 'binary_precision': 0.0920831, 'binary_recall': 0.784689, 'binary_specificity': 0.80641687, 'binary_f1_score': 0.16482411}
confusion matrix:
       0     1
0  13472  3234
1     90   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212247, 'precision': 0.71720463, 'recall': 0.55402225, 'specificity': 0.55402225, 'f1': 0.57492363, 'auroc': 0.74181634, 'binary_precision': 0.50537634, 'binary_recall': 0.11794228, 'binary_specificity': 0.99010223, 'binary_f1_score': 0.19125126}
confusion matrix:
      0   1
0  9203  92
1   703  94
early stop counter: 11
val acc:0.805886447429657, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9247919321060181
after epoch: 12,now: 2024-08-09 18:49:09.362010,epoch time: 0:15:12.404392,used: 3:08:54.763024,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9083875, 'precision': 0.9223987, 'recall': 0.90837336, 'specificity': 0.90837336, 'f1': 0.90761936, 'auroc': 0.997848, 'binary_precision': 0.8455069, 'binary_recall': 0.99941975, 'binary_specificity': 0.817327, 'binary_f1_score': 0.9160433}
confusion matrix:
       0      1
0  21123   4721
1     15  25837
---- Validation: 
scalar performance:
{'acc': 0.72214437, 'precision': 0.53354645, 'recall': 0.79345274, 'specificity': 0.79345274, 'f1': 0.483485, 'auroc': 0.8414217, 'binary_precision': 0.07165416, 'binary_recall': 0.8684211, 'binary_specificity': 0.7184844, 'binary_f1_score': 0.13238512}
confusion matrix:
       0     1
0  12003  4703
1     55   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88555294, 'precision': 0.5783021, 'recall': 0.56505567, 'specificity': 0.56505567, 'f1': 0.5706246, 'auroc': 0.6834449, 'binary_precision': 0.22546013, 'binary_recall': 0.18444166, 'binary_specificity': 0.9456697, 'binary_f1_score': 0.20289855}
confusion matrix:
      0    1
0  8790  505
1   650  147
early stop counter: 12
val acc:0.722144365310669, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9247919321060181
after epoch: 13,now: 2024-08-09 19:04:23.528601,epoch time: 0:15:14.166591,used: 3:24:08.929615,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9357784, 'precision': 0.9426677, 'recall': 0.93576396, 'specificity': 0.93576396, 'f1': 0.9355261, 'auroc': 0.9985504, 'binary_precision': 0.8875017, 'binary_recall': 0.99810475, 'binary_specificity': 0.8734231, 'binary_f1_score': 0.9395594}
confusion matrix:
       0      1
0  22571   3271
1     49  25805
---- Validation: 
scalar performance:
{'acc': 0.8243401, 'precision': 0.549486, 'recall': 0.821338, 'specificity': 0.821338, 'f1': 0.5434116, 'auroc': 0.87970734, 'binary_precision': 0.104459375, 'binary_recall': 0.8181818, 'binary_specificity': 0.8244942, 'binary_f1_score': 0.18526544}
confusion matrix:
       0     1
0  13774  2932
1     76   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231074, 'precision': 0.7775558, 'recall': 0.5303812, 'specificity': 0.5303812, 'f1': 0.5379892, 'auroc': 0.70636, 'binary_precision': 0.6296296, 'binary_recall': 0.06398996, 'binary_specificity': 0.99677247, 'binary_f1_score': 0.11617312}
confusion matrix:
      0   1
0  9265  30
1   746  51
early stop counter: 13
val acc:0.8243401050567627, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9247919321060181
after epoch: 14,now: 2024-08-09 19:19:43.798666,epoch time: 0:15:20.270065,used: 3:39:29.199680,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9247717, 'precision': 0.93424547, 'recall': 0.92476606, 'specificity': 0.92476606, 'f1': 0.9243585, 'auroc': 0.9988115, 'binary_precision': 0.87012506, 'binary_recall': 0.99860734, 'binary_specificity': 0.85092473, 'binary_f1_score': 0.9299494}
confusion matrix:
       0      1
0  21993   3853
1     36  25814
---- Validation: 
scalar performance:
{'acc': 0.7621467, 'precision': 0.5343933, 'recall': 0.77196956, 'specificity': 0.77196956, 'f1': 0.5001923, 'auroc': 0.8380506, 'binary_precision': 0.07588768, 'binary_recall': 0.78229666, 'binary_specificity': 0.7616425, 'binary_f1_score': 0.13835414}
confusion matrix:
       0     1
0  12724  3982
1     91   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9195402, 'precision': 0.6799552, 'recall': 0.52787113, 'specificity': 0.52787113, 'f1': 0.53375775, 'auroc': 0.7013699, 'binary_precision': 0.4347826, 'binary_recall': 0.06273526, 'binary_specificity': 0.993007, 'binary_f1_score': 0.10964913}
confusion matrix:
      0   1
0  9230  65
1   747  50
early stop counter: 14
val acc:0.7621467113494873, best validation acc: 0.9657790064811707, corresponding to test acc:                         0.9210265278816223 / 0.9247919321060181
after epoch: 15,now: 2024-08-09 19:35:00.911943,epoch time: 0:15:17.113277,used: 3:54:46.312957,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_15_40_14_seed_2_24132704
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:54:46.312957 at 2024-08-09 19:35:00.911943
persisted model performance metric: 

scalar performance:
{'acc': 0.9210265, 'precision': 0.7216253, 'recall': 0.6451107, 'specificity': 0.6451107, 'f1': 0.67306143, 'auroc': 0.84517545, 'binary_precision': 0.5, 'binary_recall': 0.3174404, 'binary_specificity': 0.97278106, 'binary_f1_score': 0.3883346}
confusion matrix:
      0    1
0  9042  253
1   544  253
oracle model performance metric: 

scalar performance:
{'acc': 0.92479193, 'precision': 0.8067509, 'recall': 0.54219335, 'specificity': 0.54219335, 'f1': 0.55818576, 'auroc': 0.6439094, 'binary_precision': 0.6862745, 'binary_recall': 0.08782936, 'binary_specificity': 0.9965573, 'binary_f1_score': 0.1557286}
confusion matrix:
      0   1
0  9263  32
1   727  70
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496488 KiB |  11071 MiB |   1951 TiB |   1951 TiB |
|       from large pool | 405952 KiB |  10997 MiB |   1948 TiB |   1948 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496488 KiB |  11071 MiB |   1951 TiB |   1951 TiB |
|       from large pool | 405952 KiB |  10997 MiB |   1948 TiB |   1948 TiB |
|       from small pool |  90536 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476752 KiB |  10961 MiB |   1941 TiB |   1941 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1938 TiB |   1938 TiB |
|       from small pool |  88912 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11232 MiB |  11376 MiB |  30634 MiB |  19402 MiB |
|       from large pool |  11106 MiB |  11248 MiB |  30448 MiB |  19342 MiB |
|       from small pool |    126 MiB |    128 MiB |    186 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1237 MiB |   2514 MiB | 644711 GiB | 644710 GiB |
|       from large pool |   1227 MiB |   2511 MiB | 641601 GiB | 641600 GiB |
|       from small pool |      9 MiB |     31 MiB |   3109 GiB |   3109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5163    |    7708    |  171474 K  |  171469 K  |
|       from large pool |      87    |     909    |   74600 K  |   74600 K  |
|       from small pool |    5076    |    7619    |   96873 K  |   96868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5163    |    7708    |  171474 K  |  171469 K  |
|       from large pool |      87    |     909    |   74600 K  |   74600 K  |
|       from small pool |    5076    |    7619    |   96873 K  |   96868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     236    |     544    |     310    |
|       from large pool |     171    |     172    |     451    |     280    |
|       from small pool |      63    |      64    |      93    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3263    |   89595 K  |   89595 K  |
|       from large pool |      21    |      62    |   39135 K  |   39134 K  |
|       from small pool |      54    |    3241    |   50460 K  |   50460 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1951 TiB |   1951 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1948 TiB |   1948 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1951 TiB |   1951 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1948 TiB |   1948 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1941 TiB |   1941 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1938 TiB |   1938 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1722 MiB |  11376 MiB |  30634 MiB |  28912 MiB |
|       from large pool |   1624 MiB |  11248 MiB |  30448 MiB |  28824 MiB |
|       from small pool |     98 MiB |    128 MiB |    186 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2514 MiB | 644712 GiB | 644711 GiB |
|       from large pool | 134912 KiB |   2511 MiB | 641602 GiB | 641601 GiB |
|       from small pool |      0 KiB |     33 MiB |   3110 GiB |   3110 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7708    |  171474 K  |  171474 K  |
|       from large pool |       2    |     909    |   74600 K  |   74600 K  |
|       from small pool |       0    |    7619    |   96873 K  |   96873 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7708    |  171474 K  |  171474 K  |
|       from large pool |       2    |     909    |   74600 K  |   74600 K  |
|       from small pool |       0    |    7619    |   96873 K  |   96873 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     236    |     544    |     462    |
|       from large pool |      33    |     172    |     451    |     418    |
|       from small pool |      49    |      64    |      93    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3263    |   89597 K  |   89597 K  |
|       from large pool |       4    |      62    |   39135 K  |   39135 K  |
|       from small pool |       0    |    3241    |   50462 K  |   50462 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 19:46:09 2024]
Finished job 0.
1 of 1 steps (100%) done
