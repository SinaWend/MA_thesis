Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 19:22:47 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/17.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=17
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715

 Experiment start at: 2024-08-09 19:33:00.263280
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7515398, 'precision': 0.7715864, 'recall': 0.7514539, 'specificity': 0.7514539, 'f1': 0.7468261, 'auroc': 0.84818685, 'binary_precision': 0.69795805, 'binary_recall': 0.887429, 'binary_specificity': 0.6154788, 'binary_f1_score': 0.78137165}
confusion matrix:
       0      1
0  15579   9733
1   2853  22491
---- Validation: 
scalar performance:
{'acc': 0.4876356, 'precision': 0.50545853, 'recall': 0.55769837, 'specificity': 0.55769837, 'f1': 0.35232526, 'auroc': 0.59551847, 'binary_precision': 0.02945806, 'binary_recall': 0.6313253, 'binary_specificity': 0.4840715, 'binary_f1_score': 0.056289613}
confusion matrix:
      0     1
0  8099  8632
1   153   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.22859403, 'precision': 0.47033614, 'recall': 0.43210435, 'specificity': 0.43210435, 'f1': 0.21615681, 'auroc': 0.37051243, 'binary_precision': 0.06432821, 'binary_recall': 0.6722798, 'binary_specificity': 0.19192892, 'binary_f1_score': 0.11742081}
confusion matrix:
      0     1
0  1793  7549
1   253   519
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 19:49:36.032450,epoch time: 0:16:35.769170,used: 0:16:35.769170,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.80260974, 'precision': 0.8267244, 'recall': 0.80251855, 'specificity': 0.80251855, 'f1': 0.79886603, 'auroc': 0.9078733, 'binary_precision': 0.73812926, 'binary_recall': 0.9384099, 'binary_specificity': 0.66662717, 'binary_f1_score': 0.82630676}
confusion matrix:
       0      1
0  16873   8438
1   1561  23784
---- Validation: 
scalar performance:
{'acc': 0.6288347, 'precision': 0.50909364, 'recall': 0.59010136, 'specificity': 0.59010136, 'f1': 0.41760403, 'auroc': 0.6369278, 'binary_precision': 0.03559719, 'binary_recall': 0.5493976, 'binary_specificity': 0.6308051, 'binary_f1_score': 0.066862166}
confusion matrix:
       0     1
0  10554  6177
1    187   228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.25726715, 'precision': 0.5144871, 'recall': 0.53318274, 'specificity': 0.53318274, 'f1': 0.24525402, 'auroc': 0.5469539, 'binary_precision': 0.08219688, 'binary_recall': 0.8588083, 'binary_specificity': 0.20755726, 'binary_f1_score': 0.15003395}
confusion matrix:
      0     1
0  1939  7403
1   109   663
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 20:04:21.525253,epoch time: 0:14:45.492803,used: 0:31:21.261973,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.83824223, 'precision': 0.8544772, 'recall': 0.8381789, 'specificity': 0.8381789, 'f1': 0.8363508, 'auroc': 0.9367808, 'binary_precision': 0.77876395, 'binary_recall': 0.945192, 'binary_specificity': 0.7311658, 'binary_f1_score': 0.8539446}
confusion matrix:
       0      1
0  18508   6805
1   1389  23954
---- Validation: 
scalar performance:
{'acc': 0.69631404, 'precision': 0.5110419, 'recall': 0.5988293, 'specificity': 0.5988293, 'f1': 0.44586164, 'auroc': 0.63723403, 'binary_precision': 0.039584935, 'binary_recall': 0.49638554, 'binary_specificity': 0.7012731, 'binary_f1_score': 0.07332266}
confusion matrix:
       0     1
0  11733  4998
1    209   206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48556456, 'precision': 0.53513074, 'recall': 0.6228981, 'specificity': 0.6228981, 'f1': 0.40612903, 'auroc': 0.63714325, 'binary_precision': 0.10738969, 'binary_recall': 0.7849741, 'binary_specificity': 0.4608221, 'binary_f1_score': 0.1889322}
confusion matrix:
      0     1
0  4305  5037
1   166   606
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 20:19:25.159751,epoch time: 0:15:03.634498,used: 0:46:24.896471,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.86062855, 'precision': 0.86105704, 'recall': 0.86061835, 'specificity': 0.86061835, 'f1': 0.86058474, 'auroc': 0.93972886, 'binary_precision': 0.8487658, 'binary_recall': 0.8778361, 'binary_specificity': 0.8434006, 'binary_f1_score': 0.86305624}
confusion matrix:
       0      1
0  21349   3964
1   3096  22247
---- Validation: 
scalar performance:
{'acc': 0.7730083, 'precision': 0.5064458, 'recall': 0.54648274, 'specificity': 0.54648274, 'f1': 0.46630147, 'auroc': 0.58920956, 'binary_precision': 0.034288775, 'binary_recall': 0.30843374, 'binary_specificity': 0.7845317, 'binary_f1_score': 0.06171649}
confusion matrix:
       0     1
0  13126  3605
1    287   128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5920506, 'precision': 0.54792887, 'recall': 0.6680639, 'specificity': 0.6680639, 'f1': 0.47230104, 'auroc': 0.70890915, 'binary_precision': 0.12931034, 'binary_recall': 0.757772, 'binary_specificity': 0.5783558, 'binary_f1_score': 0.22092144}
confusion matrix:
      0     1
0  5403  3939
1   187   585
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 20:34:22.514253,epoch time: 0:14:57.354502,used: 1:01:22.250973,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8650308, 'precision': 0.8769912, 'recall': 0.8649851, 'specificity': 0.8649851, 'f1': 0.86394125, 'auroc': 0.95719016, 'binary_precision': 0.8099705, 'binary_recall': 0.95402706, 'binary_specificity': 0.7759431, 'binary_f1_score': 0.8761166}
confusion matrix:
       0      1
0  19643   5672
1   1165  24176
---- Validation: 
scalar performance:
{'acc': 0.6931646, 'precision': 0.51335275, 'recall': 0.62071425, 'specificity': 0.62071425, 'f1': 0.44751576, 'auroc': 0.6699686, 'binary_precision': 0.042657606, 'binary_recall': 0.5445783, 'binary_specificity': 0.6968502, 'binary_f1_score': 0.0791178}
confusion matrix:
       0     1
0  11659  5072
1    189   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5587305, 'precision': 0.5460377, 'recall': 0.66309834, 'specificity': 0.66309834, 'f1': 0.45356548, 'auroc': 0.70413655, 'binary_precision': 0.123751275, 'binary_recall': 0.7862694, 'binary_specificity': 0.5399272, 'binary_f1_score': 0.21384533}
confusion matrix:
      0     1
0  5044  4298
1   165   607
early stop counter: 1
val acc:0.693164587020874, best validation acc: 0.7730082869529724, corresponding to test acc:                         0.5920506119728088 / 0.5920506119728088
after epoch: 5,now: 2024-08-09 20:48:50.458790,epoch time: 0:14:27.944537,used: 1:15:50.195510,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8661955, 'precision': 0.87890315, 'recall': 0.86614853, 'specificity': 0.86614853, 'f1': 0.86505353, 'auroc': 0.9600813, 'binary_precision': 0.80964136, 'binary_recall': 0.95769703, 'binary_specificity': 0.7746, 'binary_f1_score': 0.87746763}
confusion matrix:
       0      1
0  19609   5706
1   1072  24269
---- Validation: 
scalar performance:
{'acc': 0.6909483, 'precision': 0.5116506, 'recall': 0.6054794, 'specificity': 0.6054794, 'f1': 0.4446135, 'auroc': 0.6582241, 'binary_precision': 0.040286146, 'binary_recall': 0.51566267, 'binary_specificity': 0.69529617, 'binary_f1_score': 0.07473372}
confusion matrix:
       0     1
0  11633  5098
1    201   214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62477756, 'precision': 0.5534725, 'recall': 0.68399715, 'specificity': 0.68399715, 'f1': 0.493091, 'auroc': 0.7131889, 'binary_precision': 0.13900167, 'binary_recall': 0.753886, 'binary_specificity': 0.6141083, 'binary_f1_score': 0.23472475}
confusion matrix:
      0     1
0  5737  3605
1   190   582
new oracle model saved
early stop counter: 2
val acc:0.6909483075141907, best validation acc: 0.7730082869529724, corresponding to test acc:                         0.5920506119728088 / 0.6247775554656982
after epoch: 6,now: 2024-08-09 21:03:25.074002,epoch time: 0:14:34.615212,used: 1:30:24.810722,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.87008446, 'precision': 0.88017213, 'recall': 0.87003946, 'specificity': 0.87003946, 'f1': 0.869207, 'auroc': 0.95963264, 'binary_precision': 0.8183824, 'binary_recall': 0.951464, 'binary_specificity': 0.788615, 'binary_f1_score': 0.8799197}
confusion matrix:
       0      1
0  19963   5351
1   1230  24112
---- Validation: 
scalar performance:
{'acc': 0.7531786, 'precision': 0.51321805, 'recall': 0.6032932, 'specificity': 0.6032932, 'f1': 0.46893013, 'auroc': 0.65035534, 'binary_precision': 0.04418438, 'binary_recall': 0.44578314, 'binary_specificity': 0.7608033, 'binary_f1_score': 0.080399826}
confusion matrix:
       0     1
0  12729  4002
1    230   185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6880562, 'precision': 0.5649037, 'recall': 0.70874476, 'specificity': 0.70874476, 'f1': 0.5330684, 'auroc': 0.7264024, 'binary_precision': 0.16102418, 'binary_recall': 0.7331606, 'binary_specificity': 0.68432885, 'binary_f1_score': 0.26405412}
confusion matrix:
      0     1
0  6393  2949
1   206   566
new oracle model saved
early stop counter: 3
val acc:0.753178596496582, best validation acc: 0.7730082869529724, corresponding to test acc:                         0.5920506119728088 / 0.6880561709403992
after epoch: 7,now: 2024-08-09 21:18:17.730166,epoch time: 0:14:52.656164,used: 1:45:17.466886,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8846731, 'precision': 0.88709784, 'recall': 0.8846528, 'specificity': 0.8846528, 'f1': 0.88448834, 'auroc': 0.9617845, 'binary_precision': 0.856589, 'binary_recall': 0.924194, 'binary_specificity': 0.8451116, 'binary_f1_score': 0.88910824}
confusion matrix:
       0      1
0  21394   3921
1   1921  23420
---- Validation: 
scalar performance:
{'acc': 0.79686224, 'precision': 0.5121406, 'recall': 0.5810293, 'specificity': 0.5810293, 'f1': 0.48184946, 'auroc': 0.6483979, 'binary_precision': 0.043723974, 'binary_recall': 0.35421687, 'binary_specificity': 0.8078417, 'binary_f1_score': 0.07783956}
confusion matrix:
       0     1
0  13516  3215
1    268   147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7705161, 'precision': 0.57645774, 'recall': 0.7022853, 'specificity': 0.7022853, 'f1': 0.57781863, 'auroc': 0.7446643, 'binary_precision': 0.19131128, 'binary_recall': 0.6217617, 'binary_specificity': 0.78280884, 'binary_f1_score': 0.29259372}
confusion matrix:
      0     1
0  7313  2029
1   292   480
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-09 21:33:08.307789,epoch time: 0:14:50.577623,used: 2:00:08.044509,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8778032, 'precision': 0.88661265, 'recall': 0.8777585, 'specificity': 0.8777585, 'f1': 0.877094, 'auroc': 0.96558845, 'binary_precision': 0.82840097, 'binary_recall': 0.95320207, 'binary_specificity': 0.802315, 'binary_f1_score': 0.8864303}
confusion matrix:
       0      1
0  20309   5004
1   1186  24157
---- Validation: 
scalar performance:
{'acc': 0.7041292, 'precision': 0.5130949, 'recall': 0.6157582, 'specificity': 0.6157582, 'f1': 0.45128557, 'auroc': 0.65481603, 'binary_precision': 0.04261587, 'binary_recall': 0.5228916, 'binary_specificity': 0.7086247, 'binary_f1_score': 0.07880879}
confusion matrix:
       0     1
0  11856  4875
1    198   217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7274076, 'precision': 0.56800234, 'recall': 0.7021215, 'specificity': 0.7021215, 'f1': 0.55287284, 'auroc': 0.72426116, 'binary_precision': 0.17168376, 'binary_recall': 0.6722798, 'binary_specificity': 0.73196316, 'binary_f1_score': 0.27351782}
confusion matrix:
      0     1
0  6838  2504
1   253   519
early stop counter: 1
val acc:0.7041292190551758, best validation acc: 0.7968622446060181, corresponding to test acc:                         0.7705160975456238 / 0.7705160975456238
after epoch: 9,now: 2024-08-09 21:47:46.482778,epoch time: 0:14:38.174989,used: 2:14:46.219498,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8924313, 'precision': 0.8940027, 'recall': 0.8924089, 'specificity': 0.8924089, 'f1': 0.8923199, 'auroc': 0.9650359, 'binary_precision': 0.8692973, 'binary_recall': 0.9239328, 'binary_specificity': 0.860885, 'binary_f1_score': 0.89578277}
confusion matrix:
       0      1
0  21789   3521
1   1928  23418
---- Validation: 
scalar performance:
{'acc': 0.80415255, 'precision': 0.5123709, 'recall': 0.58006513, 'specificity': 0.58006513, 'f1': 0.48445925, 'auroc': 0.6487664, 'binary_precision': 0.044286158, 'binary_recall': 0.34457833, 'binary_specificity': 0.815552, 'binary_f1_score': 0.07848518}
confusion matrix:
       0     1
0  13645  3086
1    272   143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78762114, 'precision': 0.5905324, 'recall': 0.73293376, 'specificity': 0.73293376, 'f1': 0.5992656, 'auroc': 0.76392573, 'binary_precision': 0.21428572, 'binary_recall': 0.6683938, 'binary_specificity': 0.7974738, 'binary_f1_score': 0.3245283}
confusion matrix:
      0     1
0  7450  1892
1   256   516
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-09 22:02:43.960780,epoch time: 0:14:57.478002,used: 2:29:43.697500,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9058552, 'precision': 0.9067584, 'recall': 0.90583944, 'specificity': 0.90583944, 'f1': 0.90580046, 'auroc': 0.97142124, 'binary_precision': 0.8877582, 'binary_recall': 0.9293352, 'binary_specificity': 0.88234365, 'binary_f1_score': 0.908071}
confusion matrix:
       0      1
0  22333   2978
1   1791  23554
---- Validation: 
scalar performance:
{'acc': 0.8138924, 'precision': 0.51186347, 'recall': 0.5733065, 'specificity': 0.5733065, 'f1': 0.4867295, 'auroc': 0.6293547, 'binary_precision': 0.043721236, 'binary_recall': 0.32048193, 'binary_specificity': 0.8261311, 'binary_f1_score': 0.076945335}
confusion matrix:
       0     1
0  13822  2909
1    282   133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8303342, 'precision': 0.60524684, 'recall': 0.7251595, 'specificity': 0.7251595, 'f1': 0.6266973, 'auroc': 0.7622713, 'binary_precision': 0.24786325, 'binary_recall': 0.60103625, 'binary_specificity': 0.8492828, 'binary_f1_score': 0.35098335}
confusion matrix:
      0     1
0  7934  1408
1   308   464
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-09 22:17:50.464931,epoch time: 0:15:06.504151,used: 2:44:50.201651,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8997947, 'precision': 0.902689, 'recall': 0.89977133, 'specificity': 0.89977133, 'f1': 0.89961046, 'auroc': 0.9722016, 'binary_precision': 0.8686872, 'binary_recall': 0.9421119, 'binary_specificity': 0.8574307, 'binary_f1_score': 0.90391093}
confusion matrix:
       0      1
0  21705   3609
1   1467  23875
---- Validation: 
scalar performance:
{'acc': 0.8008865, 'precision': 0.5119539, 'recall': 0.5783916, 'specificity': 0.5783916, 'f1': 0.48284972, 'auroc': 0.66319287, 'binary_precision': 0.0435312, 'binary_recall': 0.34457833, 'binary_specificity': 0.8122049, 'binary_f1_score': 0.07729729}
confusion matrix:
       0     1
0  13589  3142
1    272   143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8004746, 'precision': 0.59529775, 'recall': 0.7345443, 'specificity': 0.7345443, 'f1': 0.60853994, 'auroc': 0.7587811, 'binary_precision': 0.22433628, 'binary_recall': 0.6567358, 'binary_specificity': 0.81235284, 'binary_f1_score': 0.33443272}
confusion matrix:
      0     1
0  7589  1753
1   265   507
early stop counter: 1
val acc:0.8008865118026733, best validation acc: 0.8138924241065979, corresponding to test acc:                         0.8303341865539551 / 0.8303341865539551
after epoch: 12,now: 2024-08-09 22:32:29.943625,epoch time: 0:14:39.478694,used: 2:59:29.680345,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.90198594, 'precision': 0.90728414, 'recall': 0.9019522, 'specificity': 0.9019522, 'f1': 0.90166074, 'auroc': 0.97652245, 'binary_precision': 0.86097926, 'binary_recall': 0.9589236, 'binary_specificity': 0.84498084, 'binary_f1_score': 0.9073158}
confusion matrix:
       0      1
0  21389   3924
1   1041  24302
---- Validation: 
scalar performance:
{'acc': 0.78893036, 'precision': 0.5178905, 'recall': 0.6251373, 'specificity': 0.6251373, 'f1': 0.48733345, 'auroc': 0.7001734, 'binary_precision': 0.05251397, 'binary_recall': 0.45301205, 'binary_specificity': 0.79726255, 'binary_f1_score': 0.09411765}
confusion matrix:
       0     1
0  13339  3392
1    227   188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78158987, 'precision': 0.5914751, 'recall': 0.742146, 'specificity': 0.742146, 'f1': 0.59838843, 'auroc': 0.7710583, 'binary_precision': 0.21385902, 'binary_recall': 0.69559586, 'binary_specificity': 0.7886962, 'binary_f1_score': 0.32713982}
confusion matrix:
      0     1
0  7368  1974
1   235   537
early stop counter: 2
val acc:0.788930356502533, best validation acc: 0.8138924241065979, corresponding to test acc:                         0.8303341865539551 / 0.8303341865539551
after epoch: 13,now: 2024-08-09 22:47:17.202581,epoch time: 0:14:47.258956,used: 3:14:16.939301,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9129027, 'precision': 0.9138672, 'recall': 0.91288656, 'specificity': 0.91288656, 'f1': 0.91284966, 'auroc': 0.97611415, 'binary_precision': 0.8940552, 'binary_recall': 0.9369501, 'binary_specificity': 0.88882303, 'binary_f1_score': 0.9150002}
confusion matrix:
       0      1
0  22497   2814
1   1598  23747
---- Validation: 
scalar performance:
{'acc': 0.84083754, 'precision': 0.5131739, 'recall': 0.57066417, 'specificity': 0.57066417, 'f1': 0.49654838, 'auroc': 0.62588835, 'binary_precision': 0.046630096, 'binary_recall': 0.28674698, 'binary_specificity': 0.8545813, 'binary_f1_score': 0.080215715}
confusion matrix:
       0     1
0  14298  2433
1    296   119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8633577, 'precision': 0.6276361, 'recall': 0.72639966, 'specificity': 0.72639966, 'f1': 0.6549895, 'auroc': 0.7813612, 'binary_precision': 0.29419702, 'binary_recall': 0.5647668, 'binary_specificity': 0.88803256, 'binary_f1_score': 0.38686776}
confusion matrix:
      0     1
0  8296  1046
1   336   436
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-09 23:02:20.174486,epoch time: 0:15:02.971905,used: 3:29:19.911206,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9198713, 'precision': 0.9199265, 'recall': 0.9198682, 'specificity': 0.9198682, 'f1': 0.91986823, 'auroc': 0.9772492, 'binary_precision': 0.91524565, 'binary_recall': 0.92553866, 'binary_specificity': 0.9141977, 'binary_f1_score': 0.9203634}
confusion matrix:
       0      1
0  23142   2172
1   1887  23455
---- Validation: 
scalar performance:
{'acc': 0.8706987, 'precision': 0.51837265, 'recall': 0.58126533, 'specificity': 0.58126533, 'f1': 0.51218706, 'auroc': 0.6555743, 'binary_precision': 0.056594487, 'binary_recall': 0.27710843, 'binary_specificity': 0.8854223, 'binary_f1_score': 0.093992636}
confusion matrix:
       0     1
0  14814  1917
1    300   115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87235516, 'precision': 0.6359545, 'recall': 0.72651696, 'specificity': 0.72651696, 'f1': 0.66364753, 'auroc': 0.77755034, 'binary_precision': 0.31127274, 'binary_recall': 0.55440414, 'binary_specificity': 0.89862984, 'binary_f1_score': 0.3986959}
confusion matrix:
      0    1
0  8395  947
1   344  428
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-09 23:16:55.320204,epoch time: 0:14:35.145718,used: 3:43:55.056924,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_19_33_00_seed_0_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:43:55.056924 at 2024-08-09 23:16:55.320204
persisted model performance metric: 

scalar performance:
{'acc': 0.87235516, 'precision': 0.6359545, 'recall': 0.72651696, 'specificity': 0.72651696, 'f1': 0.66364753, 'auroc': 0.77755034, 'binary_precision': 0.31127274, 'binary_recall': 0.55440414, 'binary_specificity': 0.89862984, 'binary_f1_score': 0.3986959}
confusion matrix:
      0    1
0  8395  947
1   344  428
oracle model performance metric: 

scalar performance:
{'acc': 0.87235516, 'precision': 0.6359545, 'recall': 0.72651696, 'specificity': 0.72651696, 'f1': 0.66364753, 'auroc': 0.77755034, 'binary_precision': 0.31127274, 'binary_recall': 0.55440414, 'binary_specificity': 0.89862984, 'binary_f1_score': 0.3986959}
confusion matrix:
      0    1
0  8395  947
1   344  428
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/17.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205702 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205702 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201269 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 202777 GiB | 202776 GiB |
|       from small pool |  36149 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 739328 KiB | 739328 KiB | 739328 KiB |      0 B   |
|       from large pool | 661504 KiB | 661504 KiB | 661504 KiB |      0 B   |
|       from small pool |  77824 KiB |  77824 KiB |  77824 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44153 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  36864 KiB | 148352 KiB | 139039 GiB | 139038 GiB |
|       from small pool |   7289 KiB |   9156 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4698    |    7101    |   43620 K  |   43616 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29721 K  |   29716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4698    |    7101    |   43620 K  |   43616 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29721 K  |   29716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      55    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      38    |      38    |      38    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    3182    |   22781 K  |   22781 K  |
|       from large pool |       7    |      11    |    8644 K  |    8644 K  |
|       from small pool |      44    |    3176    |   14137 K  |   14137 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202777 GiB | 202777 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139039 GiB | 139039 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29721 K  |   29721 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29721 K  |   29721 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202777 GiB | 202777 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139039 GiB | 139039 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29721 K  |   29721 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29721 K  |   29721 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715

 Experiment start at: 2024-08-09 23:37:23.819348
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6692635, 'precision': 0.71741474, 'recall': 0.66907805, 'specificity': 0.66907805, 'f1': 0.6497299, 'auroc': 0.8030734, 'binary_precision': 0.6152941, 'binary_recall': 0.904702, 'binary_specificity': 0.4334541, 'binary_f1_score': 0.7324463}
confusion matrix:
       0      1
0  11008  14388
1   2424  23012
---- Validation: 
scalar performance:
{'acc': 0.3631957, 'precision': 0.49166515, 'recall': 0.4213556, 'specificity': 0.4213556, 'f1': 0.28056598, 'auroc': 0.38271782, 'binary_precision': 0.019101845, 'binary_recall': 0.4825986, 'binary_specificity': 0.36011264, 'binary_f1_score': 0.036749117}
confusion matrix:
      0      1
0  6011  10681
1   223    208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.29630363, 'precision': 0.5114671, 'recall': 0.5310041, 'specificity': 0.5310041, 'f1': 0.27401817, 'auroc': 0.5390643, 'binary_precision': 0.080756016, 'binary_recall': 0.80713344, 'binary_specificity': 0.25487465, 'binary_f1_score': 0.14682207}
confusion matrix:
      0     1
0  2379  6955
1   146   611
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 23:53:02.175289,epoch time: 0:15:38.355941,used: 0:15:38.355941,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.798375, 'precision': 0.80594075, 'recall': 0.79831004, 'specificity': 0.79831004, 'f1': 0.7970965, 'auroc': 0.8907887, 'binary_precision': 0.758036, 'binary_recall': 0.87702954, 'binary_specificity': 0.7195905, 'binary_f1_score': 0.8132028}
confusion matrix:
       0      1
0  18274   7121
1   3128  22309
---- Validation: 
scalar performance:
{'acc': 0.63271624, 'precision': 0.4988835, 'recall': 0.48952693, 'specificity': 0.48952693, 'f1': 0.4085216, 'auroc': 0.44522607, 'binary_precision': 0.023739837, 'binary_recall': 0.3387471, 'binary_specificity': 0.6403067, 'binary_f1_score': 0.044370152}
confusion matrix:
       0     1
0  10688  6004
1    285   146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.43186998, 'precision': 0.53237826, 'recall': 0.6103538, 'specificity': 0.6103538, 'f1': 0.37198827, 'auroc': 0.6438219, 'binary_precision': 0.099871345, 'binary_recall': 0.82034343, 'binary_specificity': 0.40036425, 'binary_f1_score': 0.17806453}
confusion matrix:
      0     1
0  3737  5597
1   136   621
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 00:07:50.528862,epoch time: 0:14:48.353573,used: 0:30:26.709514,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8306382, 'precision': 0.83851284, 'recall': 0.8305751, 'specificity': 0.8305751, 'f1': 0.8296286, 'auroc': 0.9255314, 'binary_precision': 0.7870889, 'binary_recall': 0.9068679, 'binary_specificity': 0.75428236, 'binary_f1_score': 0.8427436}
confusion matrix:
       0      1
0  19155   6240
1   2369  23068
---- Validation: 
scalar performance:
{'acc': 0.6910004, 'precision': 0.5017397, 'recall': 0.5149009, 'specificity': 0.5149009, 'f1': 0.4331999, 'auroc': 0.4942658, 'binary_precision': 0.027604977, 'binary_recall': 0.32946634, 'binary_specificity': 0.7003355, 'binary_f1_score': 0.050941706}
confusion matrix:
       0     1
0  11690  5002
1    289   142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5424636, 'precision': 0.54756635, 'recall': 0.67134917, 'specificity': 0.67134917, 'f1': 0.44504026, 'auroc': 0.7157689, 'binary_precision': 0.122013316, 'binary_recall': 0.8229855, 'binary_specificity': 0.51971287, 'binary_f1_score': 0.21251918}
confusion matrix:
      0     1
0  4851  4483
1   134   623
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 00:22:45.792955,epoch time: 0:14:55.264093,used: 0:45:21.973607,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8381531, 'precision': 0.851346, 'recall': 0.8380731, 'specificity': 0.8380731, 'f1': 0.8365967, 'auroc': 0.9366657, 'binary_precision': 0.7834695, 'binary_recall': 0.93497664, 'binary_specificity': 0.7411695, 'binary_f1_score': 0.85254425}
confusion matrix:
       0      1
0  18822   6573
1   1654  23783
---- Validation: 
scalar performance:
{'acc': 0.6835251, 'precision': 0.5074465, 'recall': 0.5653134, 'specificity': 0.5653134, 'f1': 0.437517, 'auroc': 0.5721653, 'binary_precision': 0.035394933, 'binary_recall': 0.44083527, 'binary_specificity': 0.6897915, 'binary_f1_score': 0.06552854}
confusion matrix:
       0     1
0  11514  5178
1    241   190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6029135, 'precision': 0.5548254, 'recall': 0.6949214, 'specificity': 0.6949214, 'f1': 0.48247543, 'auroc': 0.75183415, 'binary_precision': 0.13613972, 'binary_recall': 0.8031704, 'binary_specificity': 0.58667237, 'binary_f1_score': 0.2328164}
confusion matrix:
      0     1
0  5476  3858
1   149   608
new oracle model saved
early stop counter: 1
val acc:0.6835250854492188, best validation acc: 0.6910004019737244, corresponding to test acc:                         0.5424636006355286 / 0.602913498878479
after epoch: 4,now: 2024-08-10 00:37:50.504166,epoch time: 0:15:04.711211,used: 1:00:26.684818,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.85613394, 'precision': 0.8589001, 'recall': 0.8560977, 'specificity': 0.8560977, 'f1': 0.85584724, 'auroc': 0.94054276, 'binary_precision': 0.82759744, 'binary_recall': 0.89998823, 'binary_specificity': 0.8122071, 'binary_f1_score': 0.8622762}
confusion matrix:
       0      1
0  20626   4769
1   2544  22893
---- Validation: 
scalar performance:
{'acc': 0.7793027, 'precision': 0.50704366, 'recall': 0.54776055, 'specificity': 0.54776055, 'f1': 0.46986184, 'auroc': 0.5621806, 'binary_precision': 0.03628809, 'binary_recall': 0.30394432, 'binary_specificity': 0.7915768, 'binary_f1_score': 0.064835444}
confusion matrix:
       0     1
0  13213  3479
1    300   131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74383116, 'precision': 0.57669926, 'recall': 0.7261814, 'specificity': 0.7261814, 'f1': 0.5679853, 'auroc': 0.7776657, 'binary_precision': 0.18439226, 'binary_recall': 0.70541614, 'binary_specificity': 0.74694663, 'binary_f1_score': 0.29236245}
confusion matrix:
      0     1
0  6972  2362
1   223   534
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-10 00:52:53.761467,epoch time: 0:15:03.257301,used: 1:15:29.942119,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.86416036, 'precision': 0.86910975, 'recall': 0.86411715, 'specificity': 0.86411715, 'f1': 0.8636935, 'auroc': 0.9497001, 'binary_precision': 0.82655436, 'binary_recall': 0.92199725, 'binary_specificity': 0.806237, 'binary_f1_score': 0.87167096}
confusion matrix:
       0      1
0  20476   4921
1   1984  23451
---- Validation: 
scalar performance:
{'acc': 0.77568185, 'precision': 0.50894123, 'recall': 0.5617253, 'specificity': 0.5617253, 'f1': 0.47132826, 'auroc': 0.5803046, 'binary_precision': 0.03918919, 'binary_recall': 0.3364269, 'binary_specificity': 0.7870237, 'binary_f1_score': 0.07020092}
confusion matrix:
       0     1
0  13137  3555
1    286   145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7085522, 'precision': 0.5685344, 'recall': 0.71682227, 'specificity': 0.71682227, 'f1': 0.5450015, 'auroc': 0.76189435, 'binary_precision': 0.16747868, 'binary_recall': 0.7265522, 'binary_specificity': 0.70709234, 'binary_f1_score': 0.27220985}
confusion matrix:
      0     1
0  6600  2734
1   207   550
early stop counter: 1
val acc:0.7756818532943726, best validation acc: 0.779302716255188, corresponding to test acc:                         0.7438311576843262 / 0.7438311576843262
after epoch: 6,now: 2024-08-10 01:07:35.827880,epoch time: 0:14:42.066413,used: 1:30:12.008532,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.87775415, 'precision': 0.8782954, 'recall': 0.8777379, 'specificity': 0.8777379, 'f1': 0.877707, 'auroc': 0.95441544, 'binary_precision': 0.86420125, 'binary_recall': 0.8966114, 'binary_specificity': 0.8588643, 'binary_f1_score': 0.88010806}
confusion matrix:
       0      1
0  21810   3584
1   2630  22808
---- Validation: 
scalar performance:
{'acc': 0.8208258, 'precision': 0.50819534, 'recall': 0.54645544, 'specificity': 0.54645544, 'f1': 0.48418444, 'auroc': 0.5658683, 'binary_precision': 0.038824763, 'binary_recall': 0.2575406, 'binary_specificity': 0.83537024, 'binary_f1_score': 0.0674772}
confusion matrix:
       0     1
0  13944  2748
1    320   111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8144882, 'precision': 0.5934317, 'recall': 0.7158203, 'specificity': 0.7158203, 'f1': 0.60952246, 'auroc': 0.76543486, 'binary_precision': 0.22441918, 'binary_recall': 0.5997358, 'binary_specificity': 0.8319049, 'binary_f1_score': 0.32661873}
confusion matrix:
      0     1
0  7765  1569
1   303   454
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-10 01:22:27.610549,epoch time: 0:14:51.782669,used: 1:45:03.791201,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.87740004, 'precision': 0.88115764, 'recall': 0.8773571, 'specificity': 0.8773571, 'f1': 0.8770883, 'auroc': 0.95971525, 'binary_precision': 0.8435286, 'binary_recall': 0.9269597, 'binary_specificity': 0.8277546, 'binary_f1_score': 0.8832784}
confusion matrix:
       0      1
0  21020   4374
1   1858  23580
---- Validation: 
scalar performance:
{'acc': 0.77211934, 'precision': 0.50968146, 'recall': 0.5678091, 'specificity': 0.5678091, 'f1': 0.47119206, 'auroc': 0.619236, 'binary_precision': 0.0402649, 'binary_recall': 0.35266823, 'binary_specificity': 0.7829499, 'binary_f1_score': 0.072277695}
confusion matrix:
       0     1
0  13069  3623
1    279   152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847587, 'precision': 0.5875062, 'recall': 0.73009676, 'specificity': 0.73009676, 'f1': 0.5946157, 'auroc': 0.7761086, 'binary_precision': 0.2080066, 'binary_recall': 0.66578597, 'binary_specificity': 0.79440755, 'binary_f1_score': 0.3169811}
confusion matrix:
      0     1
0  7415  1919
1   253   504
early stop counter: 1
val acc:0.7721193432807922, best validation acc: 0.8208258152008057, corresponding to test acc:                         0.8144881725311279 / 0.8144881725311279
after epoch: 8,now: 2024-08-10 01:37:18.399595,epoch time: 0:14:50.789046,used: 1:59:54.580247,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8835576, 'precision': 0.8856021, 'recall': 0.88352615, 'specificity': 0.88352615, 'f1': 0.883397, 'auroc': 0.96021855, 'binary_precision': 0.8577398, 'binary_recall': 0.91988367, 'binary_specificity': 0.8471686, 'binary_f1_score': 0.88772553}
confusion matrix:
       0      1
0  21513   3881
1   2038  23400
---- Validation: 
scalar performance:
{'acc': 0.7964142, 'precision': 0.5094016, 'recall': 0.55992764, 'specificity': 0.55992764, 'f1': 0.47853273, 'auroc': 0.5881739, 'binary_precision': 0.04032501, 'binary_recall': 0.31090486, 'binary_specificity': 0.8089504, 'binary_f1_score': 0.07139052}
confusion matrix:
       0     1
0  13503  3189
1    297   134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80418193, 'precision': 0.5944984, 'recall': 0.73209894, 'specificity': 0.73209894, 'f1': 0.6084094, 'auroc': 0.7748965, 'binary_precision': 0.22282855, 'binary_recall': 0.64729196, 'binary_specificity': 0.8169059, 'binary_f1_score': 0.33152908}
confusion matrix:
      0     1
0  7625  1709
1   267   490
early stop counter: 2
val acc:0.7964141964912415, best validation acc: 0.8208258152008057, corresponding to test acc:                         0.8144881725311279 / 0.8144881725311279
after epoch: 9,now: 2024-08-10 01:51:50.983157,epoch time: 0:14:32.583562,used: 2:14:27.163809,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.88631177, 'precision': 0.89008534, 'recall': 0.88627505, 'specificity': 0.88627505, 'f1': 0.88602924, 'auroc': 0.9651387, 'binary_precision': 0.85190487, 'binary_recall': 0.93540394, 'binary_specificity': 0.8371461, 'binary_f1_score': 0.89170396}
confusion matrix:
       0      1
0  21261   4136
1   1643  23792
---- Validation: 
scalar performance:
{'acc': 0.7883549, 'precision': 0.5123221, 'recall': 0.5817871, 'specificity': 0.5817871, 'f1': 0.48008174, 'auroc': 0.62541723, 'binary_precision': 0.044767607, 'binary_recall': 0.36426914, 'binary_specificity': 0.7993051, 'binary_f1_score': 0.079735905}
confusion matrix:
       0     1
0  13342  3350
1    274   157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79922706, 'precision': 0.59320295, 'recall': 0.7336691, 'specificity': 0.7336691, 'f1': 0.6055438, 'auroc': 0.7754587, 'binary_precision': 0.21961997, 'binary_recall': 0.65653896, 'binary_specificity': 0.81079924, 'binary_f1_score': 0.32913908}
confusion matrix:
      0     1
0  7568  1766
1   260   497
early stop counter: 3
val acc:0.7883548736572266, best validation acc: 0.8208258152008057, corresponding to test acc:                         0.8144881725311279 / 0.8144881725311279
after epoch: 10,now: 2024-08-10 02:06:35.612573,epoch time: 0:14:44.629416,used: 2:29:11.793225,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.89774156, 'precision': 0.89839715, 'recall': 0.8977265, 'specificity': 0.8977265, 'f1': 0.8976969, 'auroc': 0.9668375, 'binary_precision': 0.88242185, 'binary_recall': 0.9179477, 'binary_specificity': 0.87750524, 'binary_f1_score': 0.8998343}
confusion matrix:
       0      1
0  22286   3111
1   2087  23348
---- Validation: 
scalar performance:
{'acc': 0.83052033, 'precision': 0.5149277, 'recall': 0.5819416, 'specificity': 0.5819416, 'f1': 0.49671954, 'auroc': 0.63181806, 'binary_precision': 0.05023662, 'binary_recall': 0.3201856, 'binary_specificity': 0.8436976, 'binary_f1_score': 0.08684707}
confusion matrix:
       0     1
0  14083  2609
1    293   138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88702804, 'precision': 0.64902353, 'recall': 0.7222574, 'specificity': 0.7222574, 'f1': 0.674939, 'auroc': 0.8034722, 'binary_precision': 0.3381234, 'binary_recall': 0.5284016, 'binary_specificity': 0.91611314, 'binary_f1_score': 0.41237113}
confusion matrix:
      0    1
0  8551  783
1   357  400
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-10 02:21:48.674546,epoch time: 0:15:13.061973,used: 2:44:24.855198,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8809215, 'precision': 0.89096606, 'recall': 0.8808616, 'specificity': 0.8808616, 'f1': 0.88013977, 'auroc': 0.97180223, 'binary_precision': 0.8284862, 'binary_recall': 0.9609593, 'binary_specificity': 0.80076385, 'binary_f1_score': 0.88981926}
confusion matrix:
       0      1
0  20337   5060
1    993  24442
---- Validation: 
scalar performance:
{'acc': 0.77025056, 'precision': 0.51914483, 'recall': 0.63804924, 'specificity': 0.63804924, 'f1': 0.48344114, 'auroc': 0.71521175, 'binary_precision': 0.05466565, 'binary_recall': 0.4988399, 'binary_specificity': 0.7772586, 'binary_f1_score': 0.09853346}
confusion matrix:
       0     1
0  12974  3718
1    216   215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8150827, 'precision': 0.604082, 'recall': 0.74952316, 'specificity': 0.74952316, 'f1': 0.6225541, 'auroc': 0.7854087, 'binary_precision': 0.23930418, 'binary_recall': 0.672391, 'binary_specificity': 0.82665527, 'binary_f1_score': 0.35298198}
confusion matrix:
      0     1
0  7716  1618
1   248   509
early stop counter: 1
val acc:0.7702505588531494, best validation acc: 0.8305203318595886, corresponding to test acc:                         0.8870280385017395 / 0.8870280385017395
after epoch: 12,now: 2024-08-10 02:36:35.652089,epoch time: 0:14:46.977543,used: 2:59:11.832741,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.90415484, 'precision': 0.90549064, 'recall': 0.90412897, 'specificity': 0.90412897, 'f1': 0.9040718, 'auroc': 0.9731079, 'binary_precision': 0.88244265, 'binary_recall': 0.93274105, 'binary_specificity': 0.8755169, 'binary_f1_score': 0.906895}
confusion matrix:
       0      1
0  22232   3161
1   1711  23728
---- Validation: 
scalar performance:
{'acc': 0.8388133, 'precision': 0.52123636, 'recall': 0.61331844, 'specificity': 0.61331844, 'f1': 0.50824445, 'auroc': 0.68912125, 'binary_precision': 0.061062947, 'binary_recall': 0.37587008, 'binary_specificity': 0.85076684, 'binary_f1_score': 0.105058365}
confusion matrix:
       0     1
0  14201  2491
1    269   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88177586, 'precision': 0.6437689, 'recall': 0.72609454, 'specificity': 0.72609454, 'f1': 0.6711359, 'auroc': 0.7938981, 'binary_precision': 0.32670906, 'binary_recall': 0.5429326, 'binary_specificity': 0.90925646, 'binary_f1_score': 0.40794045}
confusion matrix:
      0    1
0  8487  847
1   346  411
better model found
persisted
after epoch: 13,now: 2024-08-10 02:51:18.229122,epoch time: 0:14:42.577033,used: 3:13:54.409774,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90360403, 'precision': 0.9082415, 'recall': 0.90355587, 'specificity': 0.90355587, 'f1': 0.90332186, 'auroc': 0.97772473, 'binary_precision': 0.86495614, 'binary_recall': 0.95675933, 'binary_specificity': 0.85035247, 'binary_f1_score': 0.9085446}
confusion matrix:
       0      1
0  21593   3800
1   1100  24339
---- Validation: 
scalar performance:
{'acc': 0.7854932, 'precision': 0.5169845, 'recall': 0.6153536, 'specificity': 0.6153536, 'f1': 0.48561388, 'auroc': 0.654678, 'binary_precision': 0.05196241, 'binary_recall': 0.4361949, 'binary_specificity': 0.79451233, 'binary_f1_score': 0.092862435}
confusion matrix:
       0     1
0  13262  3430
1    243   188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8528392, 'precision': 0.6215958, 'recall': 0.73897874, 'specificity': 0.73897874, 'f1': 0.6489958, 'auroc': 0.78270316, 'binary_precision': 0.2785888, 'binary_recall': 0.6050198, 'binary_specificity': 0.8729376, 'binary_f1_score': 0.38150772}
confusion matrix:
      0     1
0  8148  1186
1   299   458
early stop counter: 1
val acc:0.7854931950569153, best validation acc: 0.838813304901123, corresponding to test acc:                         0.8817758560180664 / 0.8870280385017395
after epoch: 14,now: 2024-08-10 03:06:24.379030,epoch time: 0:15:06.149908,used: 3:29:00.559682,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9142666, 'precision': 0.91470146, 'recall': 0.91425514, 'specificity': 0.91425514, 'f1': 0.9142425, 'auroc': 0.9759511, 'binary_precision': 0.9014476, 'binary_recall': 0.9303688, 'binary_specificity': 0.89814156, 'binary_f1_score': 0.9156799}
confusion matrix:
       0      1
0  22811   2587
1   1771  23663
---- Validation: 
scalar performance:
{'acc': 0.85948724, 'precision': 0.52125597, 'recall': 0.5990593, 'specificity': 0.5990593, 'f1': 0.51400423, 'auroc': 0.698644, 'binary_precision': 0.062084258, 'binary_recall': 0.32482597, 'binary_specificity': 0.8732926, 'binary_f1_score': 0.10424423}
confusion matrix:
       0     1
0  14577  2115
1    291   140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89188385, 'precision': 0.66032434, 'recall': 0.73823476, 'specificity': 0.73823476, 'f1': 0.6881925, 'auroc': 0.817923, 'binary_precision': 0.3582343, 'binary_recall': 0.55746365, 'binary_specificity': 0.9190058, 'binary_f1_score': 0.4361757}
confusion matrix:
      0    1
0  8578  756
1   335  422
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-10 03:21:01.916874,epoch time: 0:14:37.537844,used: 3:43:38.097526,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_23_37_23_seed_1_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:43:38.097526 at 2024-08-10 03:21:01.916874
persisted model performance metric: 

scalar performance:
{'acc': 0.89188385, 'precision': 0.66032434, 'recall': 0.73823476, 'specificity': 0.73823476, 'f1': 0.6881925, 'auroc': 0.817923, 'binary_precision': 0.3582343, 'binary_recall': 0.55746365, 'binary_specificity': 0.9190058, 'binary_f1_score': 0.4361757}
confusion matrix:
      0    1
0  8578  756
1   335  422
oracle model performance metric: 

scalar performance:
{'acc': 0.89188385, 'precision': 0.66032434, 'recall': 0.73823476, 'specificity': 0.73823476, 'f1': 0.6881925, 'auroc': 0.817923, 'binary_precision': 0.3582343, 'binary_recall': 0.55746365, 'binary_specificity': 0.9190058, 'binary_f1_score': 0.4361757}
confusion matrix:
      0    1
0  8578  756
1   335  422
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 574656 KiB | 407882 GiB | 407881 GiB |
|       from large pool | 165120 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1090 MiB | 489472 KiB |
|       from large pool | 550912 KiB | 661504 KiB |    984 MiB | 456704 KiB |
|       from small pool |  75776 KiB |  77824 KiB |    106 MiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 257068 GiB | 257068 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 256438 GiB | 256438 GiB |
|       from small pool |   9343 KiB |  14884 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7123    |   87546 K  |   87541 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59625 K  |   59621 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7123    |   87546 K  |   87541 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59625 K  |   59621 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      77    |      23    |
|       from large pool |      17    |      17    |      24    |       7    |
|       from small pool |      37    |      38    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      50    |    3189    |   46405 K  |   46405 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |      47    |    3186    |   28352 K  |   28352 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407882 GiB | 407882 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257068 GiB | 257068 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256439 GiB | 256438 GiB |
|       from small pool |      0 KiB |  16938 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87546 K  |   87546 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87546 K  |   87546 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3189    |   46407 K  |   46407 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |       0    |    3186    |   28354 K  |   28354 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407882 GiB | 407882 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257068 GiB | 257068 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256439 GiB | 256438 GiB |
|       from small pool |      0 KiB |  16938 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87546 K  |   87546 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87546 K  |   87546 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59625 K  |   59625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3189    |   46407 K  |   46407 K  |
|       from large pool |       3    |      13    |   18052 K  |   18052 K  |
|       from small pool |       0    |    3186    |   28354 K  |   28354 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715

 Experiment start at: 2024-08-10 03:41:14.642664
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7424752, 'precision': 0.7691219, 'recall': 0.7424387, 'specificity': 0.7424387, 'f1': 0.7359197, 'auroc': 0.8581669, 'binary_precision': 0.684497, 'binary_recall': 0.89982206, 'binary_specificity': 0.58505535, 'binary_f1_score': 0.77752703}
confusion matrix:
       0      1
0  15119  10723
1   2590  23264
---- Validation: 
scalar performance:
{'acc': 0.5534338, 'precision': 0.51192063, 'recall': 0.62418354, 'specificity': 0.62418354, 'f1': 0.38851404, 'auroc': 0.68975174, 'binary_precision': 0.03737361, 'binary_recall': 0.6985646, 'binary_specificity': 0.5498025, 'binary_f1_score': 0.07095129}
confusion matrix:
      0     1
0  9185  7521
1   126   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32798257, 'precision': 0.5145736, 'recall': 0.5405428, 'specificity': 0.5405428, 'f1': 0.29917777, 'auroc': 0.58258533, 'binary_precision': 0.08718444, 'binary_recall': 0.79297364, 'binary_specificity': 0.2881119, 'binary_f1_score': 0.15709668}
confusion matrix:
      0     1
0  2678  6617
1   165   632
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 03:57:23.647985,epoch time: 0:16:09.005321,used: 0:16:09.005321,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8202375, 'precision': 0.8273869, 'recall': 0.82022893, 'specificity': 0.82022893, 'f1': 0.81924796, 'auroc': 0.91069865, 'binary_precision': 0.77903605, 'binary_recall': 0.89412403, 'binary_specificity': 0.7463339, 'binary_f1_score': 0.8326219}
confusion matrix:
       0      1
0  19289   6556
1   2737  23114
---- Validation: 
scalar performance:
{'acc': 0.71075684, 'precision': 0.51488024, 'recall': 0.62900746, 'specificity': 0.62900746, 'f1': 0.4561153, 'auroc': 0.66047215, 'binary_precision': 0.0455001, 'binary_recall': 0.5430622, 'binary_specificity': 0.7149527, 'binary_f1_score': 0.08396523}
confusion matrix:
       0     1
0  11944  4762
1    191   227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49207294, 'precision': 0.52180123, 'recall': 0.5745611, 'specificity': 0.5745611, 'f1': 0.40322483, 'auroc': 0.62054145, 'binary_precision': 0.099240884, 'binary_recall': 0.67252195, 'binary_specificity': 0.47660032, 'binary_f1_score': 0.17295903}
confusion matrix:
      0     1
0  4430  4865
1   261   536
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 04:12:24.313385,epoch time: 0:15:00.665400,used: 0:31:09.670721,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84172857, 'precision': 0.8549403, 'recall': 0.84171736, 'specificity': 0.84171736, 'f1': 0.8402388, 'auroc': 0.9349941, 'binary_precision': 0.78649026, 'binary_recall': 0.9381842, 'binary_specificity': 0.7452505, 'binary_f1_score': 0.8556661}
confusion matrix:
       0      1
0  19261   6584
1   1598  24253
---- Validation: 
scalar performance:
{'acc': 0.69411355, 'precision': 0.5158744, 'recall': 0.6426362, 'specificity': 0.6426362, 'f1': 0.4510952, 'auroc': 0.6793409, 'binary_precision': 0.046310242, 'binary_recall': 0.5885168, 'binary_specificity': 0.69675565, 'binary_f1_score': 0.08586387}
confusion matrix:
       0     1
0  11640  5066
1    172   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55330956, 'precision': 0.53692865, 'recall': 0.6267323, 'specificity': 0.6267323, 'f1': 0.44573736, 'auroc': 0.68023336, 'binary_precision': 0.11734378, 'binary_recall': 0.7139272, 'binary_specificity': 0.5395374, 'binary_f1_score': 0.20155862}
confusion matrix:
      0     1
0  5015  4280
1   228   569
new oracle model saved
early stop counter: 1
val acc:0.694113552570343, best validation acc: 0.7107568383216858, corresponding to test acc:                         0.4920729398727417 / 0.5533095598220825
after epoch: 3,now: 2024-08-10 04:27:25.527693,epoch time: 0:15:01.214308,used: 0:46:10.885029,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8588092, 'precision': 0.86533487, 'recall': 0.85879624, 'specificity': 0.85879624, 'f1': 0.8581728, 'auroc': 0.945228, 'binary_precision': 0.81655633, 'binary_recall': 0.92561793, 'binary_specificity': 0.7919746, 'binary_f1_score': 0.86767346}
confusion matrix:
       0      1
0  20467   5376
1   1923  23930
---- Validation: 
scalar performance:
{'acc': 0.7504672, 'precision': 0.5164674, 'recall': 0.6295333, 'specificity': 0.6295333, 'f1': 0.47245857, 'auroc': 0.6842307, 'binary_precision': 0.049122807, 'binary_recall': 0.50239235, 'binary_specificity': 0.75667423, 'binary_f1_score': 0.089494996}
confusion matrix:
       0     1
0  12641  4065
1    208   210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6947087, 'precision': 0.5543141, 'recall': 0.6639184, 'specificity': 0.6639184, 'f1': 0.5268536, 'auroc': 0.7049465, 'binary_precision': 0.15225334, 'binary_recall': 0.6273526, 'binary_specificity': 0.70048416, 'binary_f1_score': 0.24503799}
confusion matrix:
      0     1
0  6511  2784
1   297   500
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-10 04:42:56.019882,epoch time: 0:15:30.492189,used: 1:01:41.377218,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8692742, 'precision': 0.8723934, 'recall': 0.8692653, 'specificity': 0.8692653, 'f1': 0.86899793, 'auroc': 0.9493035, 'binary_precision': 0.83835983, 'binary_recall': 0.9150195, 'binary_specificity': 0.8235112, 'binary_f1_score': 0.8750138}
confusion matrix:
       0      1
0  21282   4561
1   2197  23656
---- Validation: 
scalar performance:
{'acc': 0.77078956, 'precision': 0.51229095, 'recall': 0.58980024, 'specificity': 0.58980024, 'f1': 0.47377044, 'auroc': 0.6541034, 'binary_precision': 0.04347826, 'binary_recall': 0.39952153, 'binary_specificity': 0.780079, 'binary_f1_score': 0.07842217}
confusion matrix:
       0     1
0  13032  3674
1    251   167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66854936, 'precision': 0.5631977, 'recall': 0.7024847, 'specificity': 0.7024847, 'f1': 0.5238782, 'auroc': 0.7571226, 'binary_precision': 0.15862808, 'binary_recall': 0.74278545, 'binary_specificity': 0.66218394, 'binary_f1_score': 0.26142633}
confusion matrix:
      0     1
0  6155  3140
1   205   592
better model found
persisted
after epoch: 5,now: 2024-08-10 04:58:04.454341,epoch time: 0:15:08.434459,used: 1:16:49.811677,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8739748, 'precision': 0.878759, 'recall': 0.87396175, 'specificity': 0.87396175, 'f1': 0.87357277, 'auroc': 0.9567716, 'binary_precision': 0.8362486, 'binary_recall': 0.9301462, 'binary_specificity': 0.8177773, 'binary_f1_score': 0.88070166}
confusion matrix:
       0      1
0  21133   4709
1   1806  24048
---- Validation: 
scalar performance:
{'acc': 0.75035036, 'precision': 0.5142985, 'recall': 0.6119798, 'specificity': 0.6119798, 'f1': 0.4695463, 'auroc': 0.6669375, 'binary_precision': 0.04591476, 'binary_recall': 0.46650717, 'binary_specificity': 0.7574524, 'binary_f1_score': 0.08360129}
confusion matrix:
       0     1
0  12654  4052
1    223   195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68261987, 'precision': 0.5595169, 'recall': 0.6854601, 'specificity': 0.6854601, 'f1': 0.5268137, 'auroc': 0.7411564, 'binary_precision': 0.15667808, 'binary_recall': 0.6888331, 'binary_specificity': 0.6820871, 'binary_f1_score': 0.25528947}
confusion matrix:
      0     1
0  6340  2955
1   248   549
early stop counter: 1
val acc:0.7503503561019897, best validation acc: 0.7707895636558533, corresponding to test acc:                         0.6685493588447571 / 0.6947087049484253
after epoch: 6,now: 2024-08-10 05:13:00.776007,epoch time: 0:14:56.321666,used: 1:31:46.133343,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8732784, 'precision': 0.87703675, 'recall': 0.8732687, 'specificity': 0.8732687, 'f1': 0.87295973, 'auroc': 0.953822, 'binary_precision': 0.8394415, 'binary_recall': 0.92318106, 'binary_specificity': 0.82335645, 'binary_f1_score': 0.87932205}
confusion matrix:
       0      1
0  21278   4565
1   1986  23867
---- Validation: 
scalar performance:
{'acc': 0.7698552, 'precision': 0.5135769, 'recall': 0.59981763, 'specificity': 0.59981763, 'f1': 0.47521496, 'auroc': 0.6479722, 'binary_precision': 0.045419354, 'binary_recall': 0.42105263, 'binary_specificity': 0.7785826, 'binary_f1_score': 0.08199394}
confusion matrix:
       0     1
0  13007  3699
1    242   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73513675, 'precision': 0.56758296, 'recall': 0.68988055, 'specificity': 0.68988055, 'f1': 0.5564954, 'auroc': 0.72924525, 'binary_precision': 0.17543253, 'binary_recall': 0.6361355, 'binary_specificity': 0.7436256, 'binary_f1_score': 0.27502036}
confusion matrix:
      0     1
0  6912  2383
1   290   507
new oracle model saved
early stop counter: 2
val acc:0.7698552012443542, best validation acc: 0.7707895636558533, corresponding to test acc:                         0.6685493588447571 / 0.7351367473602295
after epoch: 7,now: 2024-08-10 05:28:13.476576,epoch time: 0:15:12.700569,used: 1:46:58.833912,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.87349117, 'precision': 0.88227624, 'recall': 0.87347066, 'specificity': 0.87347066, 'f1': 0.87275577, 'auroc': 0.96151984, 'binary_precision': 0.82439286, 'binary_recall': 0.94925547, 'binary_specificity': 0.79768586, 'binary_f1_score': 0.88242906}
confusion matrix:
       0      1
0  20613   5228
1   1312  24543
---- Validation: 
scalar performance:
{'acc': 0.72202754, 'precision': 0.5152497, 'recall': 0.6289526, 'specificity': 0.6289526, 'f1': 0.46071482, 'auroc': 0.6832837, 'binary_precision': 0.046385292, 'binary_recall': 0.53110045, 'binary_specificity': 0.72680473, 'binary_f1_score': 0.08531899}
confusion matrix:
       0     1
0  12142  4564
1    196   222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355331, 'precision': 0.5706937, 'recall': 0.69984627, 'specificity': 0.69984627, 'f1': 0.559933, 'auroc': 0.7399013, 'binary_precision': 0.17945206, 'binary_recall': 0.6574655, 'binary_specificity': 0.742227, 'binary_f1_score': 0.28194782}
confusion matrix:
      0     1
0  6899  2396
1   273   524
new oracle model saved
early stop counter: 3
val acc:0.7220275402069092, best validation acc: 0.7707895636558533, corresponding to test acc:                         0.6685493588447571 / 0.7355331182479858
after epoch: 8,now: 2024-08-10 05:43:22.673286,epoch time: 0:15:09.196710,used: 2:02:08.030622,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8910941, 'precision': 0.8975528, 'recall': 0.8910768, 'specificity': 0.8910768, 'f1': 0.89064693, 'auroc': 0.97100604, 'binary_precision': 0.8469482, 'binary_recall': 0.9547863, 'binary_specificity': 0.82736737, 'binary_f1_score': 0.8976401}
confusion matrix:
       0      1
0  21380   4461
1   1169  24686
---- Validation: 
scalar performance:
{'acc': 0.7667601, 'precision': 0.5217516, 'recall': 0.6647072, 'specificity': 0.6647072, 'f1': 0.48520175, 'auroc': 0.7254057, 'binary_precision': 0.05764473, 'binary_recall': 0.55741626, 'binary_specificity': 0.7719981, 'binary_f1_score': 0.1044843}
confusion matrix:
       0     1
0  12897  3809
1    185   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76416963, 'precision': 0.5878943, 'recall': 0.7371875, 'specificity': 0.7371875, 'f1': 0.58904517, 'auroc': 0.7845595, 'binary_precision': 0.2076099, 'binary_recall': 0.7051443, 'binary_specificity': 0.7692308, 'binary_f1_score': 0.32077625}
confusion matrix:
      0     1
0  7150  2145
1   235   562
new oracle model saved
early stop counter: 4
val acc:0.7667601108551025, best validation acc: 0.7707895636558533, corresponding to test acc:                         0.6685493588447571 / 0.7641696333885193
after epoch: 9,now: 2024-08-10 05:58:20.724244,epoch time: 0:14:58.050958,used: 2:17:06.081580,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.89327997, 'precision': 0.89874935, 'recall': 0.8932663, 'specificity': 0.8932663, 'f1': 0.89291036, 'auroc': 0.97149134, 'binary_precision': 0.85210705, 'binary_recall': 0.9518063, 'binary_specificity': 0.8347264, 'binary_f1_score': 0.8992016}
confusion matrix:
       0      1
0  21571   4271
1   1246  24608
---- Validation: 
scalar performance:
{'acc': 0.7575333, 'precision': 0.5187088, 'recall': 0.6448172, 'specificity': 0.6448172, 'f1': 0.47790667, 'auroc': 0.70925236, 'binary_precision': 0.052707236, 'binary_recall': 0.5263158, 'binary_specificity': 0.76331854, 'binary_f1_score': 0.09581882}
confusion matrix:
       0     1
0  12752  3954
1    198   220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7815101, 'precision': 0.5945762, 'recall': 0.7437334, 'specificity': 0.7437334, 'f1': 0.6024496, 'auroc': 0.79739606, 'binary_precision': 0.22085646, 'binary_recall': 0.6988708, 'binary_specificity': 0.78859603, 'binary_f1_score': 0.3356433}
confusion matrix:
      0     1
0  7330  1965
1   240   557
new oracle model saved
early stop counter: 5
val acc:0.7575333118438721, best validation acc: 0.7707895636558533, corresponding to test acc:                         0.6685493588447571 / 0.7815101146697998
after epoch: 10,now: 2024-08-10 06:13:44.104937,epoch time: 0:15:23.380693,used: 2:32:29.462273,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90144306, 'precision': 0.90357924, 'recall': 0.9014374, 'specificity': 0.9014374, 'f1': 0.9013115, 'auroc': 0.97053003, 'binary_precision': 0.87425625, 'binary_recall': 0.9377998, 'binary_specificity': 0.86507505, 'binary_f1_score': 0.90491384}
confusion matrix:
       0      1
0  22357   3487
1   1608  24244
---- Validation: 
scalar performance:
{'acc': 0.8008643, 'precision': 0.5195497, 'recall': 0.629705, 'specificity': 0.629705, 'f1': 0.49368525, 'auroc': 0.7028097, 'binary_precision': 0.055819478, 'binary_recall': 0.44976076, 'binary_specificity': 0.8096492, 'binary_f1_score': 0.09931326}
confusion matrix:
       0     1
0  13526  3180
1    230   188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8057868, 'precision': 0.5940892, 'recall': 0.7156162, 'specificity': 0.7156162, 'f1': 0.60873055, 'auroc': 0.762249, 'binary_precision': 0.22737928, 'binary_recall': 0.608532, 'binary_specificity': 0.8227004, 'binary_f1_score': 0.33105803}
confusion matrix:
      0     1
0  7647  1648
1   312   485
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-10 06:28:55.887338,epoch time: 0:15:11.782401,used: 2:47:41.244674,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8973615, 'precision': 0.901093, 'recall': 0.8973559, 'specificity': 0.8973559, 'f1': 0.89712125, 'auroc': 0.97205675, 'binary_precision': 0.86243516, 'binary_recall': 0.94557273, 'binary_specificity': 0.8491391, 'binary_f1_score': 0.90209246}
confusion matrix:
       0      1
0  21946   3899
1   1407  24444
---- Validation: 
scalar performance:
{'acc': 0.7630811, 'precision': 0.5158338, 'recall': 0.6196706, 'specificity': 0.6196706, 'f1': 0.4759821, 'auroc': 0.6813047, 'binary_precision': 0.04862317, 'binary_recall': 0.46889952, 'binary_specificity': 0.7704418, 'binary_f1_score': 0.08810969}
confusion matrix:
       0     1
0  12871  3835
1    222   196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.804895, 'precision': 0.5967161, 'recall': 0.7248826, 'specificity': 0.7248826, 'f1': 0.6116512, 'auroc': 0.76289153, 'binary_precision': 0.23069853, 'binary_recall': 0.629862, 'binary_specificity': 0.8199032, 'binary_f1_score': 0.33770603}
confusion matrix:
      0     1
0  7621  1674
1   295   502
early stop counter: 1
val acc:0.7630810737609863, best validation acc: 0.8008642792701721, corresponding to test acc:                         0.8057867884635925 / 0.8057867884635925
after epoch: 12,now: 2024-08-10 06:43:51.524748,epoch time: 0:14:55.637410,used: 3:02:36.882084,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91088283, 'precision': 0.91192126, 'recall': 0.9108809, 'specificity': 0.9108809, 'f1': 0.9108264, 'auroc': 0.9754517, 'binary_precision': 0.8912587, 'binary_recall': 0.9359768, 'binary_specificity': 0.88578504, 'binary_f1_score': 0.91307056}
confusion matrix:
       0      1
0  22894   2952
1   1655  24195
---- Validation: 
scalar performance:
{'acc': 0.8112007, 'precision': 0.5198154, 'recall': 0.6256726, 'specificity': 0.6256726, 'f1': 0.49736542, 'auroc': 0.68951976, 'binary_precision': 0.056692913, 'binary_recall': 0.430622, 'binary_specificity': 0.8207231, 'binary_f1_score': 0.10019482}
confusion matrix:
       0     1
0  13711  2995
1    238   180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8391796, 'precision': 0.61361945, 'recall': 0.7257143, 'specificity': 0.7257143, 'f1': 0.6375675, 'auroc': 0.771772, 'binary_precision': 0.26640272, 'binary_recall': 0.5909661, 'binary_specificity': 0.8604626, 'binary_f1_score': 0.3672515}
confusion matrix:
      0     1
0  7998  1297
1   326   471
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-10 06:58:51.135810,epoch time: 0:14:59.611062,used: 3:17:36.493146,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91684073, 'precision': 0.91800785, 'recall': 0.91683364, 'specificity': 0.91683364, 'f1': 0.91678166, 'auroc': 0.97785413, 'binary_precision': 0.8959879, 'binary_recall': 0.9432218, 'binary_specificity': 0.8904454, 'binary_f1_score': 0.9189983}
confusion matrix:
       0      1
0  23010   2831
1   1468  24387
---- Validation: 
scalar performance:
{'acc': 0.86667836, 'precision': 0.5272937, 'recall': 0.62728184, 'specificity': 0.62728184, 'f1': 0.52438915, 'auroc': 0.72103655, 'binary_precision': 0.0720514, 'binary_recall': 0.37559807, 'binary_specificity': 0.8789656, 'binary_f1_score': 0.12090874}
confusion matrix:
       0     1
0  14684  2022
1    261   157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8599881, 'precision': 0.63023, 'recall': 0.7312752, 'specificity': 0.7312752, 'f1': 0.65784836, 'auroc': 0.7887891, 'binary_precision': 0.29973993, 'binary_recall': 0.5784191, 'binary_specificity': 0.88413125, 'binary_f1_score': 0.3948608}
confusion matrix:
      0     1
0  8218  1077
1   336   461
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-10 07:13:47.223244,epoch time: 0:14:56.087434,used: 3:32:32.580580,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92270195, 'precision': 0.9230155, 'recall': 0.92269987, 'specificity': 0.92269987, 'f1': 0.92268735, 'auroc': 0.9796792, 'binary_precision': 0.9115388, 'binary_recall': 0.9362912, 'binary_specificity': 0.9091085, 'binary_f1_score': 0.92374915}
confusion matrix:
       0      1
0  23495   2349
1   1647  24205
---- Validation: 
scalar performance:
{'acc': 0.85225415, 'precision': 0.5247473, 'recall': 0.6268868, 'specificity': 0.6268868, 'f1': 0.5167759, 'auroc': 0.690607, 'binary_precision': 0.06685808, 'binary_recall': 0.38995215, 'binary_specificity': 0.8638214, 'binary_f1_score': 0.11414566}
confusion matrix:
       0     1
0  14431  2275
1    255   163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87841856, 'precision': 0.6265832, 'recall': 0.66901195, 'specificity': 0.66901195, 'f1': 0.64304614, 'auroc': 0.7409893, 'binary_precision': 0.30454546, 'binary_recall': 0.42032623, 'binary_specificity': 0.91769767, 'binary_f1_score': 0.35318923}
confusion matrix:
      0    1
0  8530  765
1   462  335
new oracle model saved
early stop counter: 1
val acc:0.8522541522979736, best validation acc: 0.8666783571243286, corresponding to test acc:                         0.8599880933761597 / 0.8784185647964478
after epoch: 15,now: 2024-08-10 07:28:36.972562,epoch time: 0:14:49.749318,used: 3:47:22.329898,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_03_41_14_seed_2_24132715
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:47:22.329898 at 2024-08-10 07:28:36.972562
persisted model performance metric: 

scalar performance:
{'acc': 0.8599881, 'precision': 0.63023, 'recall': 0.7312752, 'specificity': 0.7312752, 'f1': 0.65784836, 'auroc': 0.7887891, 'binary_precision': 0.29973993, 'binary_recall': 0.5784191, 'binary_specificity': 0.88413125, 'binary_f1_score': 0.3948608}
confusion matrix:
      0     1
0  8218  1077
1   336   461
oracle model performance metric: 

scalar performance:
{'acc': 0.87841856, 'precision': 0.6265832, 'recall': 0.66901195, 'specificity': 0.66901195, 'f1': 0.64304614, 'auroc': 0.7409893, 'binary_precision': 0.30454546, 'binary_recall': 0.42032623, 'binary_specificity': 0.91769767, 'binary_f1_score': 0.35318923}
confusion matrix:
      0    1
0  8530  765
1   462  335
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 579948 KiB | 618484 GiB | 618484 GiB |
|       from large pool | 165120 KiB | 508176 KiB | 617636 GiB | 617636 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1476 MiB |    864 MiB |
|       from large pool | 550912 KiB | 661504 KiB |   1342 MiB |    804 MiB |
|       from small pool |  75776 KiB |  77824 KiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 378041 GiB | 378041 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 377091 GiB | 377091 GiB |
|       from small pool |   9343 KiB |  16938 KiB |    950 GiB |    950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7231    |  132536 K  |  132531 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90200 K  |   90195 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7231    |  132536 K  |  132531 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90200 K  |   90195 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      99    |      45    |
|       from large pool |      17    |      17    |      32    |      15    |
|       from small pool |      37    |      38    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3243    |   70634 K  |   70634 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |      49    |    3240    |   42899 K  |   42899 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 579948 KiB | 618484 GiB | 618484 GiB |
|       from large pool |  16640 KiB | 508176 KiB | 617636 GiB | 617636 GiB |
|       from small pool |      0 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1476 MiB |   1250 MiB |
|       from large pool | 184320 KiB | 661504 KiB |   1342 MiB |   1162 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    134 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 378041 GiB | 378041 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 377091 GiB | 377091 GiB |
|       from small pool |      0 KiB |  16938 KiB |    950 GiB |    950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7231    |  132536 K  |  132536 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90200 K  |   90200 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7231    |  132536 K  |  132536 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90200 K  |   90200 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      99    |      67    |
|       from large pool |       9    |      17    |      32    |      23    |
|       from small pool |      23    |      38    |      67    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3243    |   70636 K  |   70636 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |       0    |    3240    |   42901 K  |   42901 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug 10 07:41:37 2024]
Finished job 0.
1 of 1 steps (100%) done
