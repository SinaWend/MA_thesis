Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  9 09:30:28 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/16.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=16
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712

 Experiment start at: 2024-08-09 09:38:23.058313
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7658915, 'precision': 0.7877115, 'recall': 0.7658044, 'specificity': 0.7658044, 'f1': 0.7613274, 'auroc': 0.86527646, 'binary_precision': 0.70863634, 'binary_recall': 0.90360636, 'binary_specificity': 0.6280025, 'binary_f1_score': 0.7943324}
confusion matrix:
       0      1
0  15896   9416
1   2443  22901
---- Validation: 
scalar performance:
{'acc': 0.5793771, 'precision': 0.51134646, 'recall': 0.6176312, 'specificity': 0.6176312, 'f1': 0.39928836, 'auroc': 0.67070675, 'binary_precision': 0.037178267, 'binary_recall': 0.6578313, 'binary_specificity': 0.57743114, 'binary_f1_score': 0.07037897}
confusion matrix:
      0     1
0  9661  7070
1   142   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3200514, 'precision': 0.4888118, 'recall': 0.4667583, 'specificity': 0.4667583, 'f1': 0.28468162, 'auroc': 0.42683056, 'binary_precision': 0.06964613, 'binary_recall': 0.6398964, 'binary_specificity': 0.2936202, 'binary_f1_score': 0.12561984}
confusion matrix:
      0     1
0  2743  6599
1   278   494
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 09:54:41.668817,epoch time: 0:16:18.610504,used: 0:16:18.610504,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.81253946, 'precision': 0.8335284, 'recall': 0.8124652, 'specificity': 0.8124652, 'f1': 0.809518, 'auroc': 0.9128338, 'binary_precision': 0.75000787, 'binary_recall': 0.9379316, 'binary_specificity': 0.6869988, 'binary_f1_score': 0.83350873}
confusion matrix:
       0      1
0  17390   7923
1   1573  23770
---- Validation: 
scalar performance:
{'acc': 0.64592326, 'precision': 0.50993896, 'recall': 0.59650767, 'specificity': 0.59650767, 'f1': 0.4253341, 'auroc': 0.6357676, 'binary_precision': 0.037000656, 'binary_recall': 0.5445783, 'binary_specificity': 0.648437, 'binary_f1_score': 0.06929327}
confusion matrix:
       0     1
0  10849  5882
1    189   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3215345, 'precision': 0.5231502, 'recall': 0.564407, 'specificity': 0.564407, 'f1': 0.29567412, 'auroc': 0.5784453, 'binary_precision': 0.08873582, 'binary_recall': 0.85103625, 'binary_specificity': 0.2777778, 'binary_f1_score': 0.1607143}
confusion matrix:
      0     1
0  2595  6747
1   115   657
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 10:10:15.404477,epoch time: 0:15:33.735660,used: 0:31:52.346164,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8381238, 'precision': 0.85115194, 'recall': 0.838063, 'specificity': 0.838063, 'f1': 0.83659106, 'auroc': 0.92550266, 'binary_precision': 0.783672, 'binary_recall': 0.9343829, 'binary_specificity': 0.741743, 'binary_f1_score': 0.8524171}
confusion matrix:
       0      1
0  18775   6537
1   1663  23681
---- Validation: 
scalar performance:
{'acc': 0.6707104, 'precision': 0.50892, 'recall': 0.5833601, 'specificity': 0.5833601, 'f1': 0.4337251, 'auroc': 0.61917335, 'binary_precision': 0.036176626, 'binary_recall': 0.49156627, 'binary_specificity': 0.6751539, 'binary_f1_score': 0.06739346}
confusion matrix:
       0     1
0  11296  5435
1    211   204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45728692, 'precision': 0.5314491, 'recall': 0.60818505, 'specificity': 0.60818505, 'f1': 0.38763595, 'auroc': 0.61490786, 'binary_precision': 0.10234362, 'binary_recall': 0.7862694, 'binary_specificity': 0.43010062, 'binary_f1_score': 0.18111295}
confusion matrix:
      0     1
0  4018  5324
1   165   607
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 10:26:32.444318,epoch time: 0:16:17.039841,used: 0:48:09.386005,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8619117, 'precision': 0.86509395, 'recall': 0.8618785, 'specificity': 0.8618785, 'f1': 0.8616023, 'auroc': 0.94229686, 'binary_precision': 0.8311857, 'binary_recall': 0.90854573, 'binary_specificity': 0.81521136, 'binary_f1_score': 0.86814576}
confusion matrix:
       0      1
0  20633   4677
1   2318  23028
---- Validation: 
scalar performance:
{'acc': 0.77948207, 'precision': 0.51207155, 'recall': 0.5862229, 'specificity': 0.5862229, 'f1': 0.47617608, 'auroc': 0.6564516, 'binary_precision': 0.043159608, 'binary_recall': 0.38313252, 'binary_specificity': 0.78931326, 'binary_f1_score': 0.07757989}
confusion matrix:
       0     1
0  13206  3525
1    256   159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63713664, 'precision': 0.5489685, 'recall': 0.6657332, 'specificity': 0.6657332, 'f1': 0.49512887, 'auroc': 0.6865814, 'binary_precision': 0.13574661, 'binary_recall': 0.69948184, 'binary_specificity': 0.6319846, 'binary_f1_score': 0.22736844}
confusion matrix:
      0     1
0  5904  3438
1   232   540
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 10:41:47.524950,epoch time: 0:15:15.080632,used: 1:03:24.466637,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.85296905, 'precision': 0.8656498, 'recall': 0.8529139, 'specificity': 0.8529139, 'f1': 0.8516692, 'auroc': 0.9467653, 'binary_precision': 0.7977042, 'binary_recall': 0.9460206, 'binary_specificity': 0.7598072, 'binary_f1_score': 0.86555475}
confusion matrix:
       0      1
0  19233   6080
1   1368  23975
---- Validation: 
scalar performance:
{'acc': 0.70366263, 'precision': 0.5105787, 'recall': 0.5931953, 'specificity': 0.5931953, 'f1': 0.4479853, 'auroc': 0.637903, 'binary_precision': 0.039114974, 'binary_recall': 0.47710842, 'binary_specificity': 0.70928216, 'binary_f1_score': 0.07230236}
confusion matrix:
       0     1
0  11867  4864
1    217   198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56525606, 'precision': 0.5462485, 'recall': 0.66366005, 'specificity': 0.66366005, 'f1': 0.4571766, 'auroc': 0.69483525, 'binary_precision': 0.124663495, 'binary_recall': 0.7797927, 'binary_specificity': 0.5475273, 'binary_f1_score': 0.21496163}
confusion matrix:
      0     1
0  5115  4227
1   170   602
early stop counter: 1
val acc:0.703662633895874, best validation acc: 0.7794820666313171, corresponding to test acc:                         0.6371366381645203 / 0.6371366381645203
after epoch: 5,now: 2024-08-09 10:57:06.964748,epoch time: 0:15:19.439798,used: 1:18:43.906435,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8710518, 'precision': 0.87626994, 'recall': 0.87101924, 'specificity': 0.87101924, 'f1': 0.8705962, 'auroc': 0.9503858, 'binary_precision': 0.8320975, 'binary_recall': 0.92987925, 'binary_specificity': 0.8121593, 'binary_f1_score': 0.87827516}
confusion matrix:
       0      1
0  20559   4755
1   1777  23565
---- Validation: 
scalar performance:
{'acc': 0.74932927, 'precision': 0.5157068, 'recall': 0.6248195, 'specificity': 0.6248195, 'f1': 0.4709023, 'auroc': 0.689433, 'binary_precision': 0.047752153, 'binary_recall': 0.4939759, 'binary_specificity': 0.75566316, 'binary_f1_score': 0.087085806}
confusion matrix:
       0     1
0  12643  4088
1    210   205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.666403, 'precision': 0.56197333, 'recall': 0.7053415, 'specificity': 0.7053415, 'f1': 0.5204291, 'auroc': 0.74184406, 'binary_precision': 0.15417331, 'binary_recall': 0.7512953, 'binary_specificity': 0.6593877, 'binary_f1_score': 0.25584474}
confusion matrix:
      0     1
0  6160  3182
1   192   580
new oracle model saved
early stop counter: 2
val acc:0.7493292689323425, best validation acc: 0.7794820666313171, corresponding to test acc:                         0.6371366381645203 / 0.6664029955863953
after epoch: 6,now: 2024-08-09 11:12:31.508170,epoch time: 0:15:24.543422,used: 1:34:08.449857,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88056695, 'precision': 0.882087, 'recall': 0.88054705, 'specificity': 0.88054705, 'f1': 0.88044405, 'auroc': 0.9566748, 'binary_precision': 0.85814524, 'binary_recall': 0.9120502, 'binary_specificity': 0.8490439, 'binary_f1_score': 0.8842769}
confusion matrix:
       0      1
0  21491   3821
1   2229  23115
---- Validation: 
scalar performance:
{'acc': 0.79482096, 'precision': 0.51172113, 'recall': 0.5788084, 'specificity': 0.5788084, 'f1': 0.48061404, 'auroc': 0.65287757, 'binary_precision': 0.04300442, 'binary_recall': 0.35180724, 'binary_specificity': 0.80580956, 'binary_f1_score': 0.07664042}
confusion matrix:
       0     1
0  13482  3249
1    269   146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7513348, 'precision': 0.5635805, 'recall': 0.67407763, 'specificity': 0.67407763, 'f1': 0.55697834, 'auroc': 0.71819955, 'binary_precision': 0.17026107, 'binary_recall': 0.58290154, 'binary_specificity': 0.7652537, 'binary_f1_score': 0.2635432}
confusion matrix:
      0     1
0  7149  2193
1   322   450
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-09 11:28:16.089056,epoch time: 0:15:44.580886,used: 1:49:53.030743,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.88011295, 'precision': 0.8815175, 'recall': 0.88009256, 'specificity': 0.88009256, 'f1': 0.8799983, 'auroc': 0.9551541, 'binary_precision': 0.85853547, 'binary_recall': 0.9103965, 'binary_specificity': 0.8497886, 'binary_f1_score': 0.88370574}
confusion matrix:
       0      1
0  21509   3802
1   2271  23074
---- Validation: 
scalar performance:
{'acc': 0.8088184, 'precision': 0.5120936, 'recall': 0.57658124, 'specificity': 0.57658124, 'f1': 0.48550785, 'auroc': 0.6227242, 'binary_precision': 0.043963045, 'binary_recall': 0.3325301, 'binary_specificity': 0.82063234, 'binary_f1_score': 0.07765897}
confusion matrix:
       0     1
0  13730  3001
1    277   138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8016611, 'precision': 0.5813526, 'recall': 0.68943727, 'specificity': 0.68943727, 'f1': 0.59226507, 'auroc': 0.7405455, 'binary_precision': 0.20534861, 'binary_recall': 0.5569948, 'binary_specificity': 0.8218797, 'binary_f1_score': 0.30006978}
confusion matrix:
      0     1
0  7678  1664
1   342   430
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-09 11:44:23.321673,epoch time: 0:16:07.232617,used: 2:06:00.263360,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.87571067, 'precision': 0.8844882, 'recall': 0.8756689, 'specificity': 0.8756689, 'f1': 0.87498856, 'auroc': 0.9646925, 'binary_precision': 0.8265327, 'binary_recall': 0.95118773, 'binary_specificity': 0.8001501, 'binary_f1_score': 0.8844898}
confusion matrix:
       0      1
0  20255   5059
1   1237  24105
---- Validation: 
scalar performance:
{'acc': 0.76367664, 'precision': 0.5179027, 'recall': 0.63687086, 'specificity': 0.63687086, 'f1': 0.47881973, 'auroc': 0.69949627, 'binary_precision': 0.051541306, 'binary_recall': 0.5036145, 'binary_specificity': 0.7701273, 'binary_f1_score': 0.093512304}
confusion matrix:
       0     1
0  12885  3846
1    206   209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7378881, 'precision': 0.57812506, 'recall': 0.7309665, 'specificity': 0.7309665, 'f1': 0.5676048, 'auroc': 0.7600448, 'binary_precision': 0.18631051, 'binary_recall': 0.72279793, 'binary_specificity': 0.7391351, 'binary_f1_score': 0.29625696}
confusion matrix:
      0     1
0  6905  2437
1   214   558
early stop counter: 1
val acc:0.763676643371582, best validation acc: 0.8088183999061584, corresponding to test acc:                         0.8016610741615295 / 0.8016610741615295
after epoch: 9,now: 2024-08-09 12:00:31.692415,epoch time: 0:16:08.370742,used: 2:22:08.634102,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8916614, 'precision': 0.89676577, 'recall': 0.8916323, 'specificity': 0.8916323, 'f1': 0.89130664, 'auroc': 0.96984804, 'binary_precision': 0.8518912, 'binary_recall': 0.94830513, 'binary_specificity': 0.8349595, 'binary_f1_score': 0.8975163}
confusion matrix:
       0      1
0  21137   4178
1   1310  24031
---- Validation: 
scalar performance:
{'acc': 0.7846728, 'precision': 0.51826984, 'recall': 0.63000536, 'specificity': 0.63000536, 'f1': 0.48644748, 'auroc': 0.70842874, 'binary_precision': 0.052933153, 'binary_recall': 0.46746987, 'binary_specificity': 0.7925408, 'binary_f1_score': 0.09509804}
confusion matrix:
       0     1
0  13260  3471
1    221   194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78762114, 'precision': 0.5809761, 'recall': 0.70203817, 'specificity': 0.70203817, 'f1': 0.58822864, 'auroc': 0.74489176, 'binary_precision': 0.2013889, 'binary_recall': 0.60103625, 'binary_specificity': 0.80304, 'binary_f1_score': 0.30169052}
confusion matrix:
      0     1
0  7502  1840
1   308   464
early stop counter: 2
val acc:0.7846727967262268, best validation acc: 0.8088183999061584, corresponding to test acc:                         0.8016610741615295 / 0.8016610741615295
after epoch: 10,now: 2024-08-09 12:16:14.802465,epoch time: 0:15:43.110050,used: 2:37:51.744152,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9000908, 'precision': 0.9011409, 'recall': 0.9000777, 'specificity': 0.9000777, 'f1': 0.9000233, 'auroc': 0.9684869, 'binary_precision': 0.880745, 'binary_recall': 0.9256146, 'binary_specificity': 0.8745408, 'binary_f1_score': 0.9026226}
confusion matrix:
       0      1
0  22139   3176
1   1885  23456
---- Validation: 
scalar performance:
{'acc': 0.8101598, 'precision': 0.51263267, 'recall': 0.57961845, 'specificity': 0.57961845, 'f1': 0.48668915, 'auroc': 0.6529986, 'binary_precision': 0.044871796, 'binary_recall': 0.33734939, 'binary_specificity': 0.8218875, 'binary_f1_score': 0.07920792}
confusion matrix:
       0     1
0  13751  2980
1    275   140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263793, 'precision': 0.59450907, 'recall': 0.69865865, 'specificity': 0.69865865, 'f1': 0.61275446, 'auroc': 0.75163275, 'binary_precision': 0.23114754, 'binary_recall': 0.54792744, 'binary_specificity': 0.84938985, 'binary_f1_score': 0.32513452}
confusion matrix:
      0     1
0  7935  1407
1   349   423
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-09 12:32:07.199846,epoch time: 0:15:52.397381,used: 2:53:44.141533,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.90011054, 'precision': 0.90117, 'recall': 0.90009534, 'specificity': 0.90009534, 'f1': 0.90004206, 'auroc': 0.97028756, 'binary_precision': 0.88070124, 'binary_recall': 0.9257389, 'binary_specificity': 0.8744519, 'binary_f1_score': 0.90265864}
confusion matrix:
       0      1
0  22135   3178
1   1882  23461
---- Validation: 
scalar performance:
{'acc': 0.82363236, 'precision': 0.51248264, 'recall': 0.57359755, 'specificity': 0.57359755, 'f1': 0.49054682, 'auroc': 0.6367841, 'binary_precision': 0.044994768, 'binary_recall': 0.31084338, 'binary_specificity': 0.8363517, 'binary_f1_score': 0.07861061}
confusion matrix:
       0     1
0  13993  2738
1    286   129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81757957, 'precision': 0.60110426, 'recall': 0.73132646, 'specificity': 0.73132646, 'f1': 0.6195402, 'auroc': 0.7694367, 'binary_precision': 0.23765281, 'binary_recall': 0.6295337, 'binary_specificity': 0.8331193, 'binary_f1_score': 0.34504792}
confusion matrix:
      0     1
0  7783  1559
1   286   486
better model found
persisted
after epoch: 12,now: 2024-08-09 12:47:49.691747,epoch time: 0:15:42.491901,used: 3:09:26.633434,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9038811, 'precision': 0.90579784, 'recall': 0.9038608, 'specificity': 0.9038608, 'f1': 0.90376425, 'auroc': 0.9731183, 'binary_precision': 0.878056, 'binary_recall': 0.93816835, 'binary_specificity': 0.8695532, 'binary_f1_score': 0.90711737}
confusion matrix:
       0      1
0  22011   3302
1   1567  23776
---- Validation: 
scalar performance:
{'acc': 0.8055523, 'precision': 0.5158781, 'recall': 0.60310614, 'specificity': 0.60310614, 'f1': 0.4898698, 'auroc': 0.66898006, 'binary_precision': 0.049953748, 'binary_recall': 0.39036146, 'binary_specificity': 0.8158508, 'binary_f1_score': 0.08857299}
confusion matrix:
       0     1
0  13650  3081
1    253   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8480324, 'precision': 0.6117653, 'recall': 0.71335065, 'specificity': 0.71335065, 'f1': 0.63576555, 'auroc': 0.7723596, 'binary_precision': 0.26403454, 'binary_recall': 0.55440414, 'binary_specificity': 0.87229717, 'binary_f1_score': 0.35771}
confusion matrix:
      0     1
0  8149  1193
1   344   428
new oracle model saved
early stop counter: 1
val acc:0.8055523037910461, best validation acc: 0.8236323595046997, corresponding to test acc:                         0.8175795674324036 / 0.8480324149131775
after epoch: 13,now: 2024-08-09 13:03:09.231179,epoch time: 0:15:19.539432,used: 3:24:46.172866,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.916693, 'precision': 0.9168389, 'recall': 0.9166875, 'specificity': 0.9166875, 'f1': 0.91668487, 'auroc': 0.976687, 'binary_precision': 0.909186, 'binary_recall': 0.9259756, 'binary_specificity': 0.90739936, 'binary_f1_score': 0.91750395}
confusion matrix:
       0      1
0  22969   2344
1   1876  23467
---- Validation: 
scalar performance:
{'acc': 0.84987754, 'precision': 0.5229512, 'recall': 0.6199438, 'specificity': 0.6199438, 'f1': 0.5133808, 'auroc': 0.7157864, 'binary_precision': 0.063485645, 'binary_recall': 0.37831324, 'binary_specificity': 0.86157435, 'binary_f1_score': 0.108725764}
confusion matrix:
       0     1
0  14415  2316
1    258   157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86207235, 'precision': 0.6263276, 'recall': 0.7257039, 'specificity': 0.7257039, 'f1': 0.6534905, 'auroc': 0.7901742, 'binary_precision': 0.2916388, 'binary_recall': 0.5647668, 'binary_specificity': 0.88664097, 'binary_f1_score': 0.3846493}
confusion matrix:
      0     1
0  8283  1059
1   336   436
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-09 13:18:40.900739,epoch time: 0:15:31.669560,used: 3:40:17.842426,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.904039, 'precision': 0.9094229, 'recall': 0.9040073, 'specificity': 0.9040073, 'f1': 0.9037176, 'auroc': 0.9776763, 'binary_precision': 0.8626111, 'binary_recall': 0.9612896, 'binary_specificity': 0.8467251, 'binary_f1_score': 0.90928096}
confusion matrix:
       0      1
0  21434   3880
1    981  24361
---- Validation: 
scalar performance:
{'acc': 0.811093, 'precision': 0.521409, 'recall': 0.6376684, 'specificity': 0.6376684, 'f1': 0.49945784, 'auroc': 0.7162615, 'binary_precision': 0.059025608, 'binary_recall': 0.4554217, 'binary_specificity': 0.8199151, 'binary_f1_score': 0.1045065}
confusion matrix:
       0     1
0  13718  3013
1    226   189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8635555, 'precision': 0.62841433, 'recall': 0.7282892, 'specificity': 0.7282892, 'f1': 0.65602255, 'auroc': 0.7868435, 'binary_precision': 0.29542395, 'binary_recall': 0.56865287, 'binary_specificity': 0.8879255, 'binary_f1_score': 0.38883966}
confusion matrix:
      0     1
0  8295  1047
1   333   439
new oracle model saved
early stop counter: 1
val acc:0.8110929727554321, best validation acc: 0.8498775362968445, corresponding to test acc:                         0.8620723485946655 / 0.8635554909706116
after epoch: 15,now: 2024-08-09 13:34:02.808955,epoch time: 0:15:21.908216,used: 3:55:39.750642,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_09_38_22_seed_0_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:55:39.750642 at 2024-08-09 13:34:02.808955
persisted model performance metric: 

scalar performance:
{'acc': 0.86207235, 'precision': 0.6263276, 'recall': 0.7257039, 'specificity': 0.7257039, 'f1': 0.6534905, 'auroc': 0.7901742, 'binary_precision': 0.2916388, 'binary_recall': 0.5647668, 'binary_specificity': 0.88664097, 'binary_f1_score': 0.3846493}
confusion matrix:
      0     1
0  8283  1059
1   336   436
oracle model performance metric: 

scalar performance:
{'acc': 0.8635555, 'precision': 0.62841433, 'recall': 0.7282892, 'specificity': 0.7282892, 'f1': 0.65602255, 'auroc': 0.7868435, 'binary_precision': 0.29542395, 'binary_recall': 0.56865287, 'binary_specificity': 0.8879255, 'binary_f1_score': 0.38883966}
confusion matrix:
      0     1
0  8295  1047
1   333   439
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/16.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205702 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205702 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |  37766 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201269 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 202777 GiB | 202776 GiB |
|       from small pool |  36149 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 739328 KiB | 739328 KiB | 739328 KiB |      0 B   |
|       from large pool | 661504 KiB | 661504 KiB | 661504 KiB |      0 B   |
|       from small pool |  77824 KiB |  77824 KiB |  77824 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44153 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  36864 KiB | 148352 KiB | 139039 GiB | 139038 GiB |
|       from small pool |   7289 KiB |   9156 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4698    |    7101    |   43620 K  |   43616 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29721 K  |   29716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4698    |    7101    |   43620 K  |   43616 K  |
|       from large pool |      36    |      76    |   13899 K  |   13899 K  |
|       from small pool |    4662    |    7063    |   29721 K  |   29716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      55    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      38    |      38    |      38    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    3182    |   22781 K  |   22781 K  |
|       from large pool |       7    |      11    |    8644 K  |    8644 K  |
|       from small pool |      44    |    3176    |   14137 K  |   14137 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202777 GiB | 202777 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139039 GiB | 139039 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29721 K  |   29721 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29721 K  |   29721 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 575148 KiB | 205319 GiB | 205319 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 205030 GiB | 205030 GiB |
|       from small pool |      0 KiB |  76198 KiB |    288 GiB |    288 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563485 KiB | 203055 GiB | 203055 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 202777 GiB | 202777 GiB |
|       from small pool |      0 KiB |  74518 KiB |    278 GiB |    278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB | 739328 KiB | 739328 KiB | 489472 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  45056 KiB |  77824 KiB |  77824 KiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149348 KiB | 139351 GiB | 139351 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 139039 GiB | 139039 GiB |
|       from small pool |      0 KiB |  14884 KiB |    312 GiB |    312 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29721 K  |   29721 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7101    |   43620 K  |   43620 K  |
|       from large pool |       2    |      76    |   13899 K  |   13899 K  |
|       from small pool |       0    |    7063    |   29721 K  |   29721 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      55    |      23    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      22    |      38    |      38    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3182    |   22783 K  |   22783 K  |
|       from large pool |       3    |      13    |    8644 K  |    8644 K  |
|       from small pool |       0    |    3176    |   14139 K  |   14139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712

 Experiment start at: 2024-08-09 13:55:27.988089
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6762669, 'precision': 0.7150644, 'recall': 0.67611635, 'specificity': 0.67611635, 'f1': 0.66086125, 'auroc': 0.7996768, 'binary_precision': 0.623896, 'binary_recall': 0.88877094, 'binary_specificity': 0.4634617, 'binary_f1_score': 0.7331431}
confusion matrix:
       0      1
0  11771  13627
1   2829  22605
---- Validation: 
scalar performance:
{'acc': 0.34713542, 'precision': 0.48939884, 'recall': 0.40181676, 'specificity': 0.40181676, 'f1': 0.2705574, 'auroc': 0.39088857, 'binary_precision': 0.017767409, 'binary_recall': 0.45939675, 'binary_specificity': 0.34423676, 'binary_f1_score': 0.034211665}
confusion matrix:
      0      1
0  5746  10946
1   233    198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.24249332, 'precision': 0.5165027, 'recall': 0.5359052, 'specificity': 0.5359052, 'f1': 0.23316455, 'auroc': 0.5546596, 'binary_precision': 0.08113368, 'binary_recall': 0.88110965, 'binary_specificity': 0.19070067, 'binary_f1_score': 0.14858542}
confusion matrix:
      0     1
0  1780  7554
1    90   667
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 14:12:06.829465,epoch time: 0:16:38.841376,used: 0:16:38.841376,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7812795, 'precision': 0.8079335, 'recall': 0.7811695, 'specificity': 0.7811695, 'f1': 0.77639616, 'auroc': 0.90231013, 'binary_precision': 0.7175241, 'binary_recall': 0.9283664, 'binary_specificity': 0.6339725, 'binary_f1_score': 0.8094406}
confusion matrix:
       0      1
0  16101   9296
1   1822  23613
---- Validation: 
scalar performance:
{'acc': 0.5433043, 'precision': 0.50068814, 'recall': 0.5069544, 'specificity': 0.5069544, 'f1': 0.37430477, 'auroc': 0.4913939, 'binary_precision': 0.025920698, 'binary_recall': 0.4686775, 'binary_specificity': 0.5452312, 'binary_f1_score': 0.049124517}
confusion matrix:
      0     1
0  9101  7591
1   229   202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.40749183, 'precision': 0.53911597, 'recall': 0.6281299, 'specificity': 0.6281299, 'f1': 0.35928258, 'auroc': 0.7046148, 'binary_precision': 0.102345414, 'binary_recall': 0.8877147, 'binary_specificity': 0.36854511, 'binary_f1_score': 0.18353134}
confusion matrix:
      0     1
0  3440  5894
1    85   672
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 14:27:37.359864,epoch time: 0:15:30.530399,used: 0:32:09.371775,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.82109696, 'precision': 0.8342458, 'recall': 0.8210189, 'specificity': 0.8210189, 'f1': 0.81929505, 'auroc': 0.92039335, 'binary_precision': 0.7681478, 'binary_recall': 0.92023116, 'binary_specificity': 0.7218066, 'binary_f1_score': 0.83733994}
confusion matrix:
       0      1
0  18331   7065
1   2029  23407
---- Validation: 
scalar performance:
{'acc': 0.6721369, 'precision': 0.50539905, 'recall': 0.5481709, 'specificity': 0.5481709, 'f1': 0.43084505, 'auroc': 0.54778147, 'binary_precision': 0.03247339, 'binary_recall': 0.4176334, 'binary_specificity': 0.6787084, 'binary_f1_score': 0.06026113}
confusion matrix:
       0     1
0  11329  5363
1    251   180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.485383, 'precision': 0.542964, 'recall': 0.652026, 'specificity': 0.652026, 'f1': 0.40966353, 'auroc': 0.69713163, 'binary_precision': 0.11223776, 'binary_recall': 0.84808457, 'binary_specificity': 0.45596743, 'binary_f1_score': 0.19823992}
confusion matrix:
      0     1
0  4256  5078
1   115   642
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 14:43:00.530823,epoch time: 0:15:23.170959,used: 0:47:32.542734,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8306775, 'precision': 0.8480135, 'recall': 0.83058965, 'specificity': 0.83058965, 'f1': 0.828516, 'auroc': 0.9358939, 'binary_precision': 0.7705366, 'binary_recall': 0.9422079, 'binary_specificity': 0.7189715, 'binary_f1_score': 0.8477688}
confusion matrix:
       0      1
0  18259   7137
1   1470  23966
---- Validation: 
scalar performance:
{'acc': 0.6611575, 'precision': 0.50948113, 'recall': 0.58661485, 'specificity': 0.58661485, 'f1': 0.43151122, 'auroc': 0.5939278, 'binary_precision': 0.03770012, 'binary_recall': 0.50812066, 'binary_specificity': 0.66510904, 'binary_f1_score': 0.07019231}
confusion matrix:
       0     1
0  11102  5590
1    212   219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5411753, 'precision': 0.54416764, 'recall': 0.65912104, 'specificity': 0.65912104, 'f1': 0.44206858, 'auroc': 0.6980752, 'binary_precision': 0.11887424, 'binary_recall': 0.7978864, 'binary_specificity': 0.5203557, 'binary_f1_score': 0.20692018}
confusion matrix:
      0     1
0  4857  4477
1   153   604
new oracle model saved
early stop counter: 1
val acc:0.661157488822937, best validation acc: 0.6721369028091431, corresponding to test acc:                         0.485383003950119 / 0.5411753058433533
after epoch: 4,now: 2024-08-09 14:58:18.947684,epoch time: 0:15:18.416861,used: 1:02:50.959595,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8547175, 'precision': 0.85980004, 'recall': 0.8546731, 'specificity': 0.8546731, 'f1': 0.85419154, 'auroc': 0.9427612, 'binary_precision': 0.8172232, 'binary_recall': 0.91409475, 'binary_specificity': 0.7952514, 'binary_f1_score': 0.86294883}
confusion matrix:
       0      1
0  20197   5200
1   2185  23250
---- Validation: 
scalar performance:
{'acc': 0.77223617, 'precision': 0.50571287, 'recall': 0.5396155, 'specificity': 0.5396155, 'f1': 0.4657717, 'auroc': 0.57443494, 'binary_precision': 0.034112275, 'binary_recall': 0.29466358, 'binary_specificity': 0.7845675, 'binary_f1_score': 0.061145887}
confusion matrix:
       0     1
0  13096  3596
1    304   127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71023685, 'precision': 0.5660999, 'recall': 0.70741504, 'specificity': 0.70741504, 'f1': 0.5432924, 'auroc': 0.7668545, 'binary_precision': 0.16486235, 'binary_recall': 0.7040951, 'binary_specificity': 0.71073496, 'binary_f1_score': 0.26716793}
confusion matrix:
      0     1
0  6634  2700
1   224   533
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 15:13:46.229227,epoch time: 0:15:27.281543,used: 1:18:18.241138,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.861721, 'precision': 0.8670837, 'recall': 0.86166865, 'specificity': 0.86166865, 'f1': 0.86120176, 'auroc': 0.94988495, 'binary_precision': 0.82293093, 'binary_recall': 0.92208505, 'binary_specificity': 0.80125225, 'binary_f1_score': 0.86969095}
confusion matrix:
       0      1
0  20347   5047
1   1982  23456
---- Validation: 
scalar performance:
{'acc': 0.75646794, 'precision': 0.51053536, 'recall': 0.57786345, 'specificity': 0.57786345, 'f1': 0.46717602, 'auroc': 0.59339863, 'binary_precision': 0.041226994, 'binary_recall': 0.3897912, 'binary_specificity': 0.7659358, 'binary_f1_score': 0.07456724}
confusion matrix:
       0     1
0  12785  3907
1    263   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6970568, 'precision': 0.5649047, 'recall': 0.7087876, 'specificity': 0.7087876, 'f1': 0.5364289, 'auroc': 0.76021224, 'binary_precision': 0.16116677, 'binary_recall': 0.7225892, 'binary_specificity': 0.69498605, 'binary_f1_score': 0.26355097}
confusion matrix:
      0     1
0  6487  2847
1   210   547
early stop counter: 1
val acc:0.7564679384231567, best validation acc: 0.772236168384552, corresponding to test acc:                         0.7102368474006653 / 0.7102368474006653
after epoch: 6,now: 2024-08-09 15:29:30.374643,epoch time: 0:15:44.145416,used: 1:34:02.386554,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8686064, 'precision': 0.8743974, 'recall': 0.86856234, 'specificity': 0.86856234, 'f1': 0.8680865, 'auroc': 0.9557555, 'binary_precision': 0.8280108, 'binary_recall': 0.93072265, 'binary_specificity': 0.8064021, 'binary_f1_score': 0.87636745}
confusion matrix:
       0      1
0  20481   4917
1   1762  23672
---- Validation: 
scalar performance:
{'acc': 0.77708346, 'precision': 0.51037127, 'recall': 0.57148534, 'specificity': 0.57148534, 'f1': 0.473752, 'auroc': 0.6103007, 'binary_precision': 0.041440953, 'binary_recall': 0.3549884, 'binary_specificity': 0.7879823, 'binary_f1_score': 0.0742178}
confusion matrix:
       0     1
0  13153  3539
1    278   153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7624616, 'precision': 0.57509685, 'recall': 0.7077261, 'specificity': 0.7077261, 'f1': 0.5731749, 'auroc': 0.76762515, 'binary_precision': 0.18630451, 'binary_recall': 0.6433289, 'binary_specificity': 0.7721234, 'binary_f1_score': 0.28893504}
confusion matrix:
      0     1
0  7207  2127
1   270   487
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-09 15:45:05.408773,epoch time: 0:15:35.034130,used: 1:49:37.420684,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8657538, 'precision': 0.87657475, 'recall': 0.86569047, 'specificity': 0.86569047, 'f1': 0.864768, 'auroc': 0.962029, 'binary_precision': 0.81292665, 'binary_recall': 0.95042264, 'binary_specificity': 0.78095835, 'binary_f1_score': 0.87631404}
confusion matrix:
       0      1
0  19834   5563
1   1261  24174
---- Validation: 
scalar performance:
{'acc': 0.75413185, 'precision': 0.5152968, 'recall': 0.61509, 'specificity': 0.61509, 'f1': 0.47274175, 'auroc': 0.67244637, 'binary_precision': 0.0482907, 'binary_recall': 0.4686775, 'binary_specificity': 0.7615025, 'binary_f1_score': 0.0875596}
confusion matrix:
       0     1
0  12711  3981
1    229   202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7642454, 'precision': 0.5857657, 'recall': 0.7426787, 'specificity': 0.7426787, 'f1': 0.58555484, 'auroc': 0.80027175, 'binary_precision': 0.20051698, 'binary_recall': 0.7173051, 'binary_specificity': 0.7680523, 'binary_f1_score': 0.3134199}
confusion matrix:
      0     1
0  7169  2165
1   214   543
new oracle model saved
early stop counter: 1
val acc:0.7541318535804749, best validation acc: 0.7770834565162659, corresponding to test acc:                         0.7624616026878357 / 0.7642453908920288
after epoch: 8,now: 2024-08-09 16:00:42.035152,epoch time: 0:15:36.626379,used: 2:05:14.047063,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.86728835, 'precision': 0.87930125, 'recall': 0.8672148, 'specificity': 0.8672148, 'f1': 0.86621267, 'auroc': 0.96445656, 'binary_precision': 0.81200546, 'binary_recall': 0.9561662, 'binary_specificity': 0.77826345, 'binary_f1_score': 0.87820905}
confusion matrix:
       0      1
0  19764   5631
1   1115  24322
---- Validation: 
scalar performance:
{'acc': 0.74724054, 'precision': 0.5189432, 'recall': 0.64658964, 'specificity': 0.64658964, 'f1': 0.47512692, 'auroc': 0.70034075, 'binary_precision': 0.05340362, 'binary_recall': 0.5406032, 'binary_specificity': 0.7525761, 'binary_f1_score': 0.097204834}
confusion matrix:
       0     1
0  12562  4130
1    198   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78208303, 'precision': 0.5886439, 'recall': 0.73654056, 'specificity': 0.73654056, 'f1': 0.59504235, 'auroc': 0.7915822, 'binary_precision': 0.20880452, 'binary_recall': 0.682959, 'binary_specificity': 0.79012215, 'binary_f1_score': 0.31982678}
confusion matrix:
      0     1
0  7375  1959
1   240   517
new oracle model saved
early stop counter: 2
val acc:0.7472405433654785, best validation acc: 0.7770834565162659, corresponding to test acc:                         0.7624616026878357 / 0.7820830345153809
after epoch: 9,now: 2024-08-09 16:16:20.184578,epoch time: 0:15:38.149426,used: 2:20:52.196489,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8933546, 'precision': 0.8954195, 'recall': 0.89332473, 'specificity': 0.89332473, 'f1': 0.89320993, 'auroc': 0.96738786, 'binary_precision': 0.8670505, 'binary_recall': 0.9293942, 'binary_specificity': 0.85725534, 'binary_f1_score': 0.8971406}
confusion matrix:
       0      1
0  21770   3625
1   1796  23641
---- Validation: 
scalar performance:
{'acc': 0.80686796, 'precision': 0.51300913, 'recall': 0.57998127, 'specificity': 0.57998127, 'f1': 0.48686537, 'auroc': 0.6418955, 'binary_precision': 0.04637224, 'binary_recall': 0.34106728, 'binary_specificity': 0.8188953, 'binary_f1_score': 0.08164398}
confusion matrix:
       0     1
0  13669  3023
1    284   147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8276682, 'precision': 0.60026854, 'recall': 0.7186963, 'specificity': 0.7186963, 'f1': 0.6202214, 'auroc': 0.77575, 'binary_precision': 0.23827292, 'binary_recall': 0.5904888, 'binary_specificity': 0.8469038, 'binary_f1_score': 0.33953667}
confusion matrix:
      0     1
0  7905  1429
1   310   447
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-09 16:32:10.388747,epoch time: 0:15:50.204169,used: 2:36:42.400658,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8842462, 'precision': 0.8910198, 'recall': 0.8841944, 'specificity': 0.8841944, 'f1': 0.8837327, 'auroc': 0.96873856, 'binary_precision': 0.8397512, 'binary_recall': 0.94995284, 'binary_specificity': 0.81843597, 'binary_f1_score': 0.8914591}
confusion matrix:
       0      1
0  20785   4611
1   1273  24163
---- Validation: 
scalar performance:
{'acc': 0.7743386, 'precision': 0.51663136, 'recall': 0.6175433, 'specificity': 0.6175433, 'f1': 0.48142204, 'auroc': 0.6782701, 'binary_precision': 0.051007062, 'binary_recall': 0.4524362, 'binary_specificity': 0.78265035, 'binary_f1_score': 0.091678426}
confusion matrix:
       0     1
0  13064  3628
1    236   195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84154195, 'precision': 0.6164765, 'recall': 0.7462246, 'specificity': 0.7462246, 'f1': 0.64220643, 'auroc': 0.81605923, 'binary_precision': 0.2663707, 'binary_recall': 0.6340819, 'binary_specificity': 0.85836726, 'binary_f1_score': 0.37514657}
confusion matrix:
      0     1
0  8012  1322
1   277   480
new oracle model saved
early stop counter: 1
val acc:0.7743386030197144, best validation acc: 0.8068679571151733, corresponding to test acc:                         0.8276681900024414 / 0.8415419459342957
after epoch: 11,now: 2024-08-09 16:48:39.150422,epoch time: 0:16:28.761675,used: 2:53:11.162333,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8942202, 'precision': 0.8983995, 'recall': 0.8941759, 'specificity': 0.8941759, 'f1': 0.8939343, 'auroc': 0.9717097, 'binary_precision': 0.85781044, 'binary_recall': 0.94531804, 'binary_specificity': 0.8430338, 'binary_f1_score': 0.8994408}
confusion matrix:
       0      1
0  21408   3986
1   1391  24047
---- Validation: 
scalar performance:
{'acc': 0.80540794, 'precision': 0.5200795, 'recall': 0.62669826, 'specificity': 0.62669826, 'f1': 0.49638483, 'auroc': 0.6969058, 'binary_precision': 0.057639524, 'binary_recall': 0.43851507, 'binary_specificity': 0.8148814, 'binary_f1_score': 0.101886794}
confusion matrix:
       0     1
0  13602  3090
1    242   189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83014566, 'precision': 0.6059871, 'recall': 0.7327811, 'specificity': 0.7327811, 'f1': 0.6277217, 'auroc': 0.79218715, 'binary_precision': 0.24722663, 'binary_recall': 0.61822987, 'binary_specificity': 0.84733236, 'binary_f1_score': 0.35320756}
confusion matrix:
      0     1
0  7909  1425
1   289   468
early stop counter: 2
val acc:0.8054079413414001, best validation acc: 0.8068679571151733, corresponding to test acc:                         0.8276681900024414 / 0.8415419459342957
after epoch: 12,now: 2024-08-09 17:04:50.362327,epoch time: 0:16:11.211905,used: 3:09:22.374238,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9082861, 'precision': 0.9103309, 'recall': 0.908257, 'specificity': 0.908257, 'f1': 0.90816736, 'auroc': 0.9759612, 'binary_precision': 0.88157076, 'binary_recall': 0.94346815, 'binary_specificity': 0.87304586, 'binary_f1_score': 0.9114698}
confusion matrix:
       0      1
0  22171   3224
1   1438  23999
---- Validation: 
scalar performance:
{'acc': 0.819249, 'precision': 0.52013963, 'recall': 0.61910564, 'specificity': 0.61910564, 'f1': 0.5008138, 'auroc': 0.6878283, 'binary_precision': 0.05835544, 'binary_recall': 0.40835267, 'binary_specificity': 0.8298586, 'binary_f1_score': 0.102117784}
confusion matrix:
       0     1
0  13852  2840
1    255   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85987514, 'precision': 0.62671155, 'recall': 0.7385335, 'specificity': 0.7385335, 'f1': 0.65515995, 'auroc': 0.7911663, 'binary_precision': 0.289288, 'binary_recall': 0.5957728, 'binary_specificity': 0.8812942, 'binary_f1_score': 0.38946462}
confusion matrix:
      0     1
0  8226  1108
1   306   451
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-09 17:20:54.400647,epoch time: 0:16:04.038320,used: 3:25:26.412558,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8952825, 'precision': 0.9003223, 'recall': 0.8952428, 'specificity': 0.8952428, 'f1': 0.894945, 'auroc': 0.974187, 'binary_precision': 0.8555819, 'binary_recall': 0.95128566, 'binary_specificity': 0.83919996, 'binary_f1_score': 0.90089923}
confusion matrix:
       0      1
0  21314   4084
1   1239  24195
---- Validation: 
scalar performance:
{'acc': 0.78853005, 'precision': 0.5215403, 'recall': 0.64629483, 'specificity': 0.64629483, 'f1': 0.4928963, 'auroc': 0.7071771, 'binary_precision': 0.059148703, 'binary_recall': 0.4965197, 'binary_specificity': 0.79607, 'binary_f1_score': 0.10570512}
confusion matrix:
       0     1
0  13288  3404
1    217   214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8503617, 'precision': 0.624673, 'recall': 0.7546337, 'specificity': 0.7546337, 'f1': 0.65315443, 'auroc': 0.80902493, 'binary_precision': 0.28173912, 'binary_recall': 0.64200795, 'binary_specificity': 0.8672595, 'binary_f1_score': 0.39161965}
confusion matrix:
      0     1
0  8095  1239
1   271   486
early stop counter: 1
val acc:0.7885300517082214, best validation acc: 0.8192489743232727, corresponding to test acc:                         0.8598751425743103 / 0.8598751425743103
after epoch: 14,now: 2024-08-09 17:36:51.988775,epoch time: 0:15:57.588128,used: 3:41:24.000686,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.89573497, 'precision': 0.9037219, 'recall': 0.8956852, 'specificity': 0.8956852, 'f1': 0.8952082, 'auroc': 0.9775239, 'binary_precision': 0.84711397, 'binary_recall': 0.9659511, 'binary_specificity': 0.8254193, 'binary_f1_score': 0.90263796}
confusion matrix:
       0      1
0  20964   4434
1    866  24568
---- Validation: 
scalar performance:
{'acc': 0.7964142, 'precision': 0.5221194, 'recall': 0.6458182, 'specificity': 0.6458182, 'f1': 0.4963146, 'auroc': 0.71105945, 'binary_precision': 0.060431655, 'binary_recall': 0.48723897, 'binary_specificity': 0.80439734, 'binary_f1_score': 0.10752688}
confusion matrix:
       0     1
0  13427  3265
1    221   210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87503713, 'precision': 0.6226749, 'recall': 0.6860359, 'specificity': 0.6860359, 'f1': 0.6442012, 'auroc': 0.7990619, 'binary_precision': 0.29104477, 'binary_recall': 0.4636724, 'binary_specificity': 0.9083994, 'binary_f1_score': 0.3576159}
confusion matrix:
      0    1
0  8479  855
1   406  351
new oracle model saved
early stop counter: 2
val acc:0.7964141964912415, best validation acc: 0.8192489743232727, corresponding to test acc:                         0.8598751425743103 / 0.8750371336936951
after epoch: 15,now: 2024-08-09 17:52:24.571033,epoch time: 0:15:32.582258,used: 3:56:56.582944,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_13_55_27_seed_1_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:56:56.582944 at 2024-08-09 17:52:24.571033
persisted model performance metric: 

scalar performance:
{'acc': 0.85987514, 'precision': 0.62671155, 'recall': 0.7385335, 'specificity': 0.7385335, 'f1': 0.65515995, 'auroc': 0.7911663, 'binary_precision': 0.289288, 'binary_recall': 0.5957728, 'binary_specificity': 0.8812942, 'binary_f1_score': 0.38946462}
confusion matrix:
      0     1
0  8226  1108
1   306   451
oracle model performance metric: 

scalar performance:
{'acc': 0.87503713, 'precision': 0.6226749, 'recall': 0.6860359, 'specificity': 0.6860359, 'f1': 0.6442012, 'auroc': 0.7990619, 'binary_precision': 0.29104477, 'binary_recall': 0.4636724, 'binary_specificity': 0.9083994, 'binary_f1_score': 0.3576159}
confusion matrix:
      0    1
0  8479  855
1   406  351
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool | 168576 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 574656 KiB | 407882 GiB | 407882 GiB |
|       from large pool | 165120 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1090 MiB | 489472 KiB |
|       from large pool | 550912 KiB | 661504 KiB |    984 MiB | 456704 KiB |
|       from small pool |  75776 KiB |  77824 KiB |    106 MiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 257064 GiB | 257064 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 256439 GiB | 256439 GiB |
|       from small pool |   9343 KiB |  14884 KiB |    625 GiB |    625 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7123    |   87548 K  |   87543 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59627 K  |   59623 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7123    |   87548 K  |   87543 K  |
|       from large pool |      36    |      76    |   27920 K  |   27920 K  |
|       from small pool |    4650    |    7085    |   59627 K  |   59623 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      77    |      23    |
|       from large pool |      17    |      17    |      24    |       7    |
|       from small pool |      37    |      38    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    3190    |   46422 K  |   46422 K  |
|       from large pool |       3    |      13    |   18053 K  |   18053 K  |
|       from small pool |      48    |    3187    |   28369 K  |   28369 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407882 GiB | 407882 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257064 GiB | 257064 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256439 GiB | 256439 GiB |
|       from small pool |      0 KiB |  16938 KiB |    625 GiB |    625 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87548 K  |   87548 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59627 K  |   59627 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87548 K  |   87548 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59627 K  |   59627 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46424 K  |   46424 K  |
|       from large pool |       3    |      13    |   18053 K  |   18053 K  |
|       from small pool |       0    |    3187    |   28371 K  |   28371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 581067 KiB | 412215 GiB | 412215 GiB |
|       from large pool |  16640 KiB | 507620 KiB | 411635 GiB | 411635 GiB |
|       from small pool |      0 KiB |  76198 KiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 574656 KiB | 407882 GiB | 407882 GiB |
|       from large pool |  16640 KiB | 502884 KiB | 407322 GiB | 407322 GiB |
|       from small pool |      0 KiB |  74518 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1090 MiB |    864 MiB |
|       from large pool | 184320 KiB | 661504 KiB |    984 MiB |    804 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 257064 GiB | 257064 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 256439 GiB | 256439 GiB |
|       from small pool |      0 KiB |  16938 KiB |    625 GiB |    625 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7123    |   87548 K  |   87548 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59627 K  |   59627 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7123    |   87548 K  |   87548 K  |
|       from large pool |       2    |      76    |   27920 K  |   27920 K  |
|       from small pool |       0    |    7085    |   59627 K  |   59627 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      77    |      45    |
|       from large pool |       9    |      17    |      24    |      15    |
|       from small pool |      23    |      38    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   46424 K  |   46424 K  |
|       from large pool |       3    |      13    |   18053 K  |   18053 K  |
|       from small pool |       0    |    3187    |   28371 K  |   28371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712

 Experiment start at: 2024-08-09 18:15:05.119300
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7504836, 'precision': 0.77859944, 'recall': 0.75046515, 'specificity': 0.75046515, 'f1': 0.7440163, 'auroc': 0.8709203, 'binary_precision': 0.6901239, 'binary_recall': 0.90932655, 'binary_specificity': 0.5916038, 'binary_f1_score': 0.7847045}
confusion matrix:
       0      1
0  15290  10555
1   2344  23507
---- Validation: 
scalar performance:
{'acc': 0.5200304, 'precision': 0.51453316, 'recall': 0.65254736, 'specificity': 0.65254736, 'f1': 0.3752688, 'auroc': 0.72861195, 'binary_precision': 0.039111428, 'binary_recall': 0.791866, 'binary_specificity': 0.5132288, 'binary_f1_score': 0.07454116}
confusion matrix:
      0     1
0  8574  8132
1    87   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.25812525, 'precision': 0.5226705, 'recall': 0.5490775, 'specificity': 0.5490775, 'f1': 0.24785994, 'auroc': 0.6106027, 'binary_precision': 0.08785116, 'binary_recall': 0.89460474, 'binary_specificity': 0.2035503, 'binary_f1_score': 0.15999103}
confusion matrix:
      0     1
0  1892  7403
1    84   713
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 18:32:21.943728,epoch time: 0:17:16.824428,used: 0:17:16.824428,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8145311, 'precision': 0.8333874, 'recall': 0.8145081, 'specificity': 0.8145081, 'f1': 0.81186324, 'auroc': 0.9214345, 'binary_precision': 0.75414854, 'binary_recall': 0.9334313, 'binary_specificity': 0.6955849, 'binary_f1_score': 0.8342667}
confusion matrix:
       0      1
0  17976   7867
1   1721  24132
---- Validation: 
scalar performance:
{'acc': 0.6453515, 'precision': 0.516319, 'recall': 0.65846366, 'specificity': 0.65846366, 'f1': 0.43238482, 'auroc': 0.7170032, 'binary_precision': 0.04519865, 'binary_recall': 0.6722488, 'binary_specificity': 0.64467853, 'binary_f1_score': 0.084702335}
confusion matrix:
       0     1
0  10770  5936
1    137   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4940547, 'precision': 0.52548456, 'recall': 0.5871082, 'specificity': 0.5871082, 'f1': 0.40661672, 'auroc': 0.63171947, 'binary_precision': 0.102564104, 'binary_recall': 0.69761604, 'binary_specificity': 0.47660032, 'binary_f1_score': 0.17883563}
confusion matrix:
      0     1
0  4430  4865
1   241   556
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 18:48:24.552831,epoch time: 0:16:02.609103,used: 0:33:19.433531,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8360608, 'precision': 0.84896296, 'recall': 0.836046, 'specificity': 0.836046, 'f1': 0.8345271, 'auroc': 0.9351665, 'binary_precision': 0.78190196, 'binary_recall': 0.93219095, 'binary_specificity': 0.73990095, 'binary_f1_score': 0.8504579}
confusion matrix:
       0      1
0  19122   6722
1   1753  24099
---- Validation: 
scalar performance:
{'acc': 0.67636067, 'precision': 0.514552, 'recall': 0.6347039, 'specificity': 0.6347039, 'f1': 0.44270054, 'auroc': 0.6774979, 'binary_precision': 0.043965824, 'binary_recall': 0.59090906, 'binary_specificity': 0.67849874, 'binary_f1_score': 0.08184228}
confusion matrix:
       0     1
0  11335  5371
1    171   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5521205, 'precision': 0.5385604, 'recall': 0.632396, 'specificity': 0.632396, 'f1': 0.44629362, 'auroc': 0.68544024, 'binary_precision': 0.118779436, 'binary_recall': 0.72772896, 'binary_specificity': 0.53706294, 'binary_f1_score': 0.20422535}
confusion matrix:
      0     1
0  4992  4303
1   217   580
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 19:05:12.284231,epoch time: 0:16:47.731400,used: 0:50:07.164931,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8634904, 'precision': 0.8651271, 'recall': 0.8634839, 'specificity': 0.8634839, 'f1': 0.8633358, 'auroc': 0.9455178, 'binary_precision': 0.8407295, 'binary_recall': 0.89695585, 'binary_specificity': 0.830012, 'binary_f1_score': 0.86793303}
confusion matrix:
       0      1
0  21450   4393
1   2664  23189
---- Validation: 
scalar performance:
{'acc': 0.79484934, 'precision': 0.5151872, 'recall': 0.6021311, 'specificity': 0.6021311, 'f1': 0.48563275, 'auroc': 0.65985644, 'binary_precision': 0.048702244, 'binary_recall': 0.39952153, 'binary_specificity': 0.8047408, 'binary_f1_score': 0.0868209}
confusion matrix:
       0     1
0  13444  3262
1    251   167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65893775, 'precision': 0.55313784, 'recall': 0.67030954, 'specificity': 0.67030954, 'f1': 0.51030195, 'auroc': 0.7230612, 'binary_precision': 0.145917, 'binary_recall': 0.6838143, 'binary_specificity': 0.65680474, 'binary_f1_score': 0.24051191}
confusion matrix:
      0     1
0  6105  3190
1   252   545
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 19:22:00.353096,epoch time: 0:16:48.068865,used: 1:06:55.233796,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8611498, 'precision': 0.86939025, 'recall': 0.86114407, 'specificity': 0.86114407, 'f1': 0.8603697, 'auroc': 0.95032024, 'binary_precision': 0.81423765, 'binary_recall': 0.93582207, 'binary_specificity': 0.786466, 'binary_f1_score': 0.87080634}
confusion matrix:
       0      1
0  20327   5519
1   1659  24191
---- Validation: 
scalar performance:
{'acc': 0.72926885, 'precision': 0.517301, 'recall': 0.64432627, 'specificity': 0.64432627, 'f1': 0.46596503, 'auroc': 0.7035054, 'binary_precision': 0.049551472, 'binary_recall': 0.5550239, 'binary_specificity': 0.73362863, 'binary_f1_score': 0.09098039}
confusion matrix:
       0     1
0  12256  4450
1    186   232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6564606, 'precision': 0.5585566, 'recall': 0.68961287, 'specificity': 0.68961287, 'f1': 0.5140698, 'auroc': 0.74469984, 'binary_precision': 0.15161796, 'binary_recall': 0.7289837, 'binary_specificity': 0.6502421, 'binary_f1_score': 0.25102615}
confusion matrix:
      0     1
0  6044  3251
1   216   581
early stop counter: 1
val acc:0.7292688488960266, best validation acc: 0.7948493361473083, corresponding to test acc:                         0.6589377522468567 / 0.6589377522468567
after epoch: 5,now: 2024-08-09 19:38:45.582903,epoch time: 0:16:45.229807,used: 1:23:40.463603,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8722725, 'precision': 0.87637216, 'recall': 0.8722564, 'specificity': 0.8722564, 'f1': 0.87192035, 'auroc': 0.9551984, 'binary_precision': 0.8371686, 'binary_recall': 0.9244276, 'binary_specificity': 0.82008517, 'binary_f1_score': 0.87863696}
confusion matrix:
       0      1
0  21191   4649
1   1954  23902
---- Validation: 
scalar performance:
{'acc': 0.74807286, 'precision': 0.51305574, 'recall': 0.60264885, 'specificity': 0.60264885, 'f1': 0.4671101, 'auroc': 0.6664908, 'binary_precision': 0.04400749, 'binary_recall': 0.44976076, 'binary_specificity': 0.7555369, 'binary_f1_score': 0.08017058}
confusion matrix:
       0     1
0  12622  4084
1    230   188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69847405, 'precision': 0.5615067, 'recall': 0.68661064, 'specificity': 0.68661064, 'f1': 0.5355697, 'auroc': 0.7337581, 'binary_precision': 0.1615431, 'binary_recall': 0.67252195, 'binary_specificity': 0.7006993, 'binary_f1_score': 0.26051033}
confusion matrix:
      0     1
0  6513  2782
1   261   536
new oracle model saved
early stop counter: 2
val acc:0.7480728626251221, best validation acc: 0.7948493361473083, corresponding to test acc:                         0.6589377522468567 / 0.6984740495681763
after epoch: 6,now: 2024-08-09 19:55:07.754182,epoch time: 0:16:22.171279,used: 1:40:02.634882,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8855037, 'precision': 0.88720644, 'recall': 0.88549984, 'specificity': 0.88549984, 'f1': 0.88537693, 'auroc': 0.9615853, 'binary_precision': 0.86155856, 'binary_recall': 0.9186492, 'binary_specificity': 0.85235053, 'binary_f1_score': 0.8891884}
confusion matrix:
       0      1
0  22029   3816
1   2103  23748
---- Validation: 
scalar performance:
{'acc': 0.80238265, 'precision': 0.51673704, 'recall': 0.6094908, 'specificity': 0.6094908, 'f1': 0.49021807, 'auroc': 0.6797956, 'binary_precision': 0.051421657, 'binary_recall': 0.40669855, 'binary_specificity': 0.81228304, 'binary_f1_score': 0.09129967}
confusion matrix:
       0     1
0  13570  3136
1    248   170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.711851, 'precision': 0.5644523, 'recall': 0.6910048, 'specificity': 0.6910048, 'f1': 0.5440775, 'auroc': 0.7308223, 'binary_precision': 0.16734952, 'binary_recall': 0.66624844, 'binary_specificity': 0.7157612, 'binary_f1_score': 0.2675063}
confusion matrix:
      0     1
0  6653  2642
1   266   531
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-09 20:11:24.005660,epoch time: 0:16:16.251478,used: 1:56:18.886360,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.88442045, 'precision': 0.88558596, 'recall': 0.8844141, 'specificity': 0.8844141, 'f1': 0.8843318, 'auroc': 0.9614187, 'binary_precision': 0.8644447, 'binary_recall': 0.91188985, 'binary_specificity': 0.8569383, 'binary_f1_score': 0.88753366}
confusion matrix:
       0      1
0  22145   3697
1   2278  23576
---- Validation: 
scalar performance:
{'acc': 0.78918475, 'precision': 0.51575786, 'recall': 0.60855794, 'specificity': 0.60855794, 'f1': 0.48459736, 'auroc': 0.6604145, 'binary_precision': 0.049407113, 'binary_recall': 0.41866028, 'binary_specificity': 0.79845566, 'binary_f1_score': 0.08838383}
confusion matrix:
       0     1
0  13339  3367
1    243   175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7851764, 'precision': 0.5720466, 'recall': 0.6700138, 'specificity': 0.6700138, 'f1': 0.5776737, 'auroc': 0.70981276, 'binary_precision': 0.19135524, 'binary_recall': 0.5332497, 'binary_specificity': 0.80677783, 'binary_f1_score': 0.28164348}
confusion matrix:
      0     1
0  7499  1796
1   372   425
new oracle model saved
early stop counter: 1
val acc:0.7891847491264343, best validation acc: 0.8023826479911804, corresponding to test acc:                         0.7118510007858276 / 0.7851763963699341
after epoch: 8,now: 2024-08-09 20:28:00.918971,epoch time: 0:16:36.913311,used: 2:12:55.799671,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8886955, 'precision': 0.89481425, 'recall': 0.88868344, 'specificity': 0.88868344, 'f1': 0.88826025, 'auroc': 0.9696586, 'binary_precision': 0.84571195, 'binary_recall': 0.9509148, 'binary_specificity': 0.826452, 'binary_f1_score': 0.8952332}
confusion matrix:
       0      1
0  21358   4485
1   1269  24584
---- Validation: 
scalar performance:
{'acc': 0.8030834, 'precision': 0.5203953, 'recall': 0.634341, 'specificity': 0.634341, 'f1': 0.4955895, 'auroc': 0.7034024, 'binary_precision': 0.057254195, 'binary_recall': 0.4569378, 'binary_specificity': 0.8117443, 'binary_f1_score': 0.10175812}
confusion matrix:
       0     1
0  13561  3145
1    227   191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8053904, 'precision': 0.5870399, 'recall': 0.6947528, 'specificity': 0.6947528, 'f1': 0.6001924, 'auroc': 0.75032824, 'binary_precision': 0.21743341, 'binary_recall': 0.5633626, 'binary_specificity': 0.8261431, 'binary_f1_score': 0.3137666}
confusion matrix:
      0     1
0  7679  1616
1   348   449
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-09 20:44:12.366350,epoch time: 0:16:11.447379,used: 2:29:07.247050,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8902236, 'precision': 0.8945018, 'recall': 0.89021957, 'specificity': 0.89021957, 'f1': 0.8899244, 'auroc': 0.96849585, 'binary_precision': 0.8534389, 'binary_recall': 0.9422824, 'binary_specificity': 0.83815676, 'binary_f1_score': 0.89566284}
confusion matrix:
       0      1
0  21663   4183
1   1492  24358
---- Validation: 
scalar performance:
{'acc': 0.7795492, 'precision': 0.5169057, 'recall': 0.62111324, 'specificity': 0.62111324, 'f1': 0.4830058, 'auroc': 0.6784804, 'binary_precision': 0.050842922, 'binary_recall': 0.45454547, 'binary_specificity': 0.78768104, 'binary_f1_score': 0.09145608}
confusion matrix:
       0     1
0  13159  3547
1    228   190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7940943, 'precision': 0.5889416, 'recall': 0.71271, 'specificity': 0.71271, 'f1': 0.59978247, 'auroc': 0.7529923, 'binary_precision': 0.21696863, 'binary_recall': 0.6160602, 'binary_specificity': 0.80935985, 'binary_f1_score': 0.32091504}
confusion matrix:
      0     1
0  7523  1772
1   306   491
early stop counter: 1
val acc:0.7795491814613342, best validation acc: 0.8030834197998047, corresponding to test acc:                         0.8053904175758362 / 0.8053904175758362
after epoch: 10,now: 2024-08-09 21:00:20.655834,epoch time: 0:16:08.289484,used: 2:45:15.536534,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.89707136, 'precision': 0.9005644, 'recall': 0.8970677, 'specificity': 0.8970677, 'f1': 0.8968458, 'auroc': 0.97078216, 'binary_precision': 0.863178, 'binary_recall': 0.9437524, 'binary_specificity': 0.85038304, 'binary_f1_score': 0.9016687}
confusion matrix:
       0      1
0  21979   3867
1   1454  24396
---- Validation: 
scalar performance:
{'acc': 0.8163396, 'precision': 0.5224431, 'recall': 0.63996875, 'specificity': 0.63996875, 'f1': 0.5027175, 'auroc': 0.71082145, 'binary_precision': 0.06115224, 'binary_recall': 0.45454547, 'binary_specificity': 0.82539207, 'binary_f1_score': 0.10780142}
confusion matrix:
       0     1
0  13789  2917
1    228   190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.824019, 'precision': 0.6065584, 'recall': 0.7295289, 'specificity': 0.7295289, 'f1': 0.6272967, 'auroc': 0.7721945, 'binary_precision': 0.2506368, 'binary_recall': 0.61731493, 'binary_specificity': 0.8417429, 'binary_f1_score': 0.35652173}
confusion matrix:
      0     1
0  7824  1471
1   305   492
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-09 21:16:44.991213,epoch time: 0:16:24.335379,used: 3:01:39.871913,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8965877, 'precision': 0.8986957, 'recall': 0.8965821, 'specificity': 0.8965821, 'f1': 0.8964499, 'auroc': 0.9695561, 'binary_precision': 0.86974394, 'binary_recall': 0.9329259, 'binary_specificity': 0.8602384, 'binary_f1_score': 0.90022767}
confusion matrix:
       0      1
0  22232   3612
1   1734  24118
---- Validation: 
scalar performance:
{'acc': 0.8047769, 'precision': 0.51845723, 'recall': 0.6200478, 'specificity': 0.6200478, 'f1': 0.49340576, 'auroc': 0.6942978, 'binary_precision': 0.054251753, 'binary_recall': 0.4258373, 'binary_specificity': 0.81425834, 'binary_f1_score': 0.09624222}
confusion matrix:
       0     1
0  13603  3103
1    240   178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80955213, 'precision': 0.59809184, 'recall': 0.7233959, 'specificity': 0.7233959, 'f1': 0.61434704, 'auroc': 0.77633476, 'binary_precision': 0.23404256, 'binary_recall': 0.621079, 'binary_specificity': 0.82571274, 'binary_f1_score': 0.3399725}
confusion matrix:
      0     1
0  7675  1620
1   302   495
early stop counter: 1
val acc:0.8047769069671631, best validation acc: 0.8163396120071411, corresponding to test acc:                         0.8240190148353577 / 0.8240190148353577
after epoch: 12,now: 2024-08-09 21:33:08.364279,epoch time: 0:16:23.373066,used: 3:18:03.244979,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9059502, 'precision': 0.9090339, 'recall': 0.9059401, 'specificity': 0.9059401, 'f1': 0.905771, 'auroc': 0.97568345, 'binary_precision': 0.8735763, 'binary_recall': 0.94933087, 'binary_specificity': 0.86254936, 'binary_f1_score': 0.90987945}
confusion matrix:
       0      1
0  22290   3552
1   1310  24544
---- Validation: 
scalar performance:
{'acc': 0.8248657, 'precision': 0.52511936, 'recall': 0.6513359, 'specificity': 0.6513359, 'f1': 0.5092049, 'auroc': 0.72298, 'binary_precision': 0.06592667, 'binary_recall': 0.46889952, 'binary_specificity': 0.8337723, 'binary_f1_score': 0.11560012}
confusion matrix:
       0     1
0  13929  2777
1    222   196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86058265, 'precision': 0.6331938, 'recall': 0.7390542, 'specificity': 0.7390542, 'f1': 0.6618157, 'auroc': 0.7943542, 'binary_precision': 0.3042362, 'binary_recall': 0.59473026, 'binary_specificity': 0.88337815, 'binary_f1_score': 0.4025478}
confusion matrix:
      0     1
0  8211  1084
1   323   474
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-09 21:49:15.917310,epoch time: 0:16:07.553031,used: 3:34:10.798010,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91123104, 'precision': 0.91485846, 'recall': 0.911222, 'specificity': 0.911222, 'f1': 0.9110353, 'auroc': 0.98025334, 'binary_precision': 0.8761143, 'binary_recall': 0.9579546, 'binary_specificity': 0.86448944, 'binary_f1_score': 0.9152085}
confusion matrix:
       0      1
0  22341   3502
1   1087  24766
---- Validation: 
scalar performance:
{'acc': 0.7951997, 'precision': 0.5224454, 'recall': 0.6536254, 'specificity': 0.6536254, 'f1': 0.4958682, 'auroc': 0.72273, 'binary_precision': 0.060096838, 'binary_recall': 0.5047847, 'binary_specificity': 0.80246615, 'binary_f1_score': 0.10740646}
confusion matrix:
       0     1
0  13406  3300
1    207   211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493857, 'precision': 0.6211695, 'recall': 0.7283872, 'specificity': 0.7283872, 'f1': 0.64718854, 'auroc': 0.7785991, 'binary_precision': 0.281571, 'binary_recall': 0.5846926, 'binary_specificity': 0.87208176, 'binary_f1_score': 0.38009787}
confusion matrix:
      0     1
0  8106  1189
1   331   466
early stop counter: 1
val acc:0.7951996922492981, best validation acc: 0.8248656988143921, corresponding to test acc:                         0.8605826497077942 / 0.8605826497077942
after epoch: 14,now: 2024-08-09 22:05:28.226227,epoch time: 0:16:12.308917,used: 3:50:23.106927,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9099737, 'precision': 0.9149506, 'recall': 0.90996945, 'specificity': 0.90996945, 'f1': 0.9097023, 'auroc': 0.98136127, 'binary_precision': 0.8695258, 'binary_recall': 0.96471953, 'binary_specificity': 0.85521936, 'binary_f1_score': 0.91465247}
confusion matrix:
       0      1
0  22104   3742
1    912  24938
---- Validation: 
scalar performance:
{'acc': 0.7734758, 'precision': 0.52576464, 'recall': 0.6926402, 'specificity': 0.6926402, 'f1': 0.4929474, 'auroc': 0.75860274, 'binary_precision': 0.06399597, 'binary_recall': 0.6076555, 'binary_specificity': 0.7776248, 'binary_f1_score': 0.11579668}
confusion matrix:
       0     1
0  12991  3715
1    164   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82649624, 'precision': 0.616623, 'recall': 0.7578311, 'specificity': 0.7578311, 'f1': 0.64008015, 'auroc': 0.8047818, 'binary_precision': 0.2652559, 'binary_recall': 0.6762861, 'binary_specificity': 0.83937603, 'binary_f1_score': 0.38105336}
confusion matrix:
      0     1
0  7802  1493
1   258   539
early stop counter: 2
val acc:0.7734758257865906, best validation acc: 0.8248656988143921, corresponding to test acc:                         0.8605826497077942 / 0.8605826497077942
after epoch: 15,now: 2024-08-09 22:21:44.092380,epoch time: 0:16:15.866153,used: 4:06:38.973080,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_18_15_04_seed_2_24132712
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:06:38.973080 at 2024-08-09 22:21:44.092380
persisted model performance metric: 

scalar performance:
{'acc': 0.86058265, 'precision': 0.6331938, 'recall': 0.7390542, 'specificity': 0.7390542, 'f1': 0.6618157, 'auroc': 0.7943542, 'binary_precision': 0.3042362, 'binary_recall': 0.59473026, 'binary_specificity': 0.88337815, 'binary_f1_score': 0.4025478}
confusion matrix:
      0     1
0  8211  1084
1   323   474
oracle model performance metric: 

scalar performance:
{'acc': 0.86058265, 'precision': 0.6331938, 'recall': 0.7390542, 'specificity': 0.7390542, 'f1': 0.6618157, 'auroc': 0.7943542, 'binary_precision': 0.3042362, 'binary_recall': 0.59473026, 'binary_specificity': 0.88337815, 'binary_f1_score': 0.4025478}
confusion matrix:
      0     1
0  8211  1084
1   323   474
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-09_01-24-07/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 206336 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 206336 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool | 168576 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |  37760 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201268 KiB | 579948 KiB | 618484 GiB | 618484 GiB |
|       from large pool | 165120 KiB | 508176 KiB | 617636 GiB | 617636 GiB |
|       from small pool |  36148 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 626688 KiB | 739328 KiB |   1476 MiB |    864 MiB |
|       from large pool | 550912 KiB | 661504 KiB |   1342 MiB |    804 MiB |
|       from small pool |  75776 KiB |  77824 KiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  25087 KiB | 174644 KiB | 378037 GiB | 378037 GiB |
|       from large pool |  15744 KiB | 174364 KiB | 377091 GiB | 377091 GiB |
|       from small pool |   9343 KiB |  16938 KiB |    946 GiB |    946 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4686    |    7231    |  132537 K  |  132533 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90201 K  |   90196 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4686    |    7231    |  132537 K  |  132533 K  |
|       from large pool |      36    |      76    |   42336 K  |   42336 K  |
|       from small pool |    4650    |    7193    |   90201 K  |   90196 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      55    |      99    |      45    |
|       from large pool |      17    |      17    |      32    |      15    |
|       from small pool |      37    |      38    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3243    |   70650 K  |   70650 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |      49    |    3240    |   42916 K  |   42916 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 586359 KiB | 624945 GiB | 624945 GiB |
|       from large pool |  16640 KiB | 512912 KiB | 624066 GiB | 624066 GiB |
|       from small pool |      0 KiB |  76198 KiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 579948 KiB | 618484 GiB | 618484 GiB |
|       from large pool |  16640 KiB | 508176 KiB | 617636 GiB | 617636 GiB |
|       from small pool |      0 KiB |  74518 KiB |    848 GiB |    848 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 739328 KiB |   1476 MiB |   1250 MiB |
|       from large pool | 184320 KiB | 661504 KiB |   1342 MiB |   1162 MiB |
|       from small pool |  47104 KiB |  77824 KiB |    134 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 174644 KiB | 378037 GiB | 378037 GiB |
|       from large pool |  24320 KiB | 174364 KiB | 377091 GiB | 377091 GiB |
|       from small pool |      0 KiB |  16938 KiB |    946 GiB |    946 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7231    |  132537 K  |  132537 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90201 K  |   90201 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7231    |  132537 K  |  132537 K  |
|       from large pool |       2    |      76    |   42336 K  |   42336 K  |
|       from small pool |       0    |    7193    |   90201 K  |   90201 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      32    |      55    |      99    |      67    |
|       from large pool |       9    |      17    |      32    |      23    |
|       from small pool |      23    |      38    |      67    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3243    |   70652 K  |   70652 K  |
|       from large pool |       3    |      13    |   27734 K  |   27734 K  |
|       from small pool |       0    |    3240    |   42918 K  |   42918 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 22:35:28 2024]
Finished job 0.
1 of 1 steps (100%) done
