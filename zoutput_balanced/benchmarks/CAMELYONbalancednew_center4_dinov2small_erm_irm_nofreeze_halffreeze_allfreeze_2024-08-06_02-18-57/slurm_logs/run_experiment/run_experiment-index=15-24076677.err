Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 19:46:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/15.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=15
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677

 Experiment start at: 2024-08-06 19:57:01.017672
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.72826517, 'precision': 0.72954315, 'recall': 0.7282798, 'specificity': 0.7282798, 'f1': 0.7278947, 'auroc': 0.79091036, 'binary_precision': 0.7467696, 'binary_recall': 0.69109637, 'binary_specificity': 0.7654633, 'binary_f1_score': 0.71785516}
confusion matrix:
       0      1
0  19380   5938
1   7827  17511
---- Validation: 
scalar performance:
{'acc': 0.7914382, 'precision': 0.52319103, 'recall': 0.6628453, 'specificity': 0.6628453, 'f1': 0.49550626, 'auroc': 0.7555423, 'binary_precision': 0.060850237, 'binary_recall': 0.52771086, 'binary_specificity': 0.7979798, 'binary_f1_score': 0.10911809}
confusion matrix:
       0     1
0  13351  3380
1    196   219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66106385, 'precision': 0.5542501, 'recall': 0.6792796, 'specificity': 0.6792796, 'f1': 0.5109087, 'auroc': 0.73345256, 'binary_precision': 0.14472981, 'binary_recall': 0.7007772, 'binary_specificity': 0.6577821, 'binary_f1_score': 0.23991132}
confusion matrix:
      0     1
0  6145  3197
1   231   541
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 20:16:08.651145,epoch time: 0:19:07.633473,used: 0:19:07.633473,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.827819, 'precision': 0.82808506, 'recall': 0.8278111, 'specificity': 0.8278111, 'f1': 0.8277817, 'auroc': 0.904564, 'binary_precision': 0.8188795, 'binary_recall': 0.84208035, 'binary_specificity': 0.8135419, 'binary_f1_score': 0.83031785}
confusion matrix:
       0      1
0  20594   4720
1   4002  21340
---- Validation: 
scalar performance:
{'acc': 0.78519773, 'precision': 0.5280653, 'recall': 0.70429516, 'specificity': 0.70429516, 'f1': 0.5000447, 'auroc': 0.7792876, 'binary_precision': 0.06795347, 'binary_recall': 0.6192771, 'binary_specificity': 0.78931326, 'binary_f1_score': 0.122468434}
confusion matrix:
       0     1
0  13206  3525
1    158   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65088, 'precision': 0.5695056, 'recall': 0.73674643, 'specificity': 0.73674643, 'f1': 0.5194727, 'auroc': 0.8087791, 'binary_precision': 0.15963484, 'binary_recall': 0.8380829, 'binary_specificity': 0.63540995, 'binary_f1_score': 0.26818654}
confusion matrix:
      0     1
0  5936  3406
1   125   647
early stop counter: 1
val acc:0.7851977348327637, best validation acc: 0.7914382219314575, corresponding to test acc:                         0.6610638499259949 / 0.6610638499259949
after epoch: 2,now: 2024-08-06 20:31:13.156844,epoch time: 0:15:04.505699,used: 0:34:12.139172,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.85585123, 'precision': 0.8558817, 'recall': 0.85585344, 'specificity': 0.85585344, 'f1': 0.8558486, 'auroc': 0.93180573, 'binary_precision': 0.85929406, 'binary_recall': 0.85122335, 'binary_specificity': 0.86048347, 'binary_f1_score': 0.8552396}
confusion matrix:
       0      1
0  21784   3532
1   3770  21570
---- Validation: 
scalar performance:
{'acc': 0.8320891, 'precision': 0.5349524, 'recall': 0.71069837, 'specificity': 0.71069837, 'f1': 0.5254175, 'auroc': 0.7890929, 'binary_precision': 0.08208955, 'binary_recall': 0.5831325, 'binary_specificity': 0.8382643, 'binary_f1_score': 0.14391913}
confusion matrix:
       0     1
0  14025  2706
1    173   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7129721, 'precision': 0.5829872, 'recall': 0.76263416, 'specificity': 0.76263416, 'f1': 0.5616052, 'auroc': 0.83621395, 'binary_precision': 0.18652545, 'binary_recall': 0.8212435, 'binary_specificity': 0.70402485, 'binary_f1_score': 0.30400383}
confusion matrix:
      0     1
0  6577  2765
1   138   634
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 20:46:08.059071,epoch time: 0:14:54.902227,used: 0:49:07.041399,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87571067, 'precision': 0.87660885, 'recall': 0.87572515, 'specificity': 0.87572515, 'f1': 0.87563944, 'auroc': 0.9466361, 'binary_precision': 0.8951496, 'binary_recall': 0.85128045, 'binary_specificity': 0.90016985, 'binary_f1_score': 0.87266403}
confusion matrix:
       0      1
0  22786   2527
1   3769  21574
---- Validation: 
scalar performance:
{'acc': 0.8699405, 'precision': 0.54370356, 'recall': 0.7124695, 'specificity': 0.7124695, 'f1': 0.54929936, 'auroc': 0.79625845, 'binary_precision': 0.10004407, 'binary_recall': 0.54698795, 'binary_specificity': 0.8779511, 'binary_f1_score': 0.16915052}
confusion matrix:
       0     1
0  14689  2042
1    188   227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7666601, 'precision': 0.5993521, 'recall': 0.78397256, 'specificity': 0.78397256, 'f1': 0.601431, 'auroc': 0.8518379, 'binary_precision': 0.21943463, 'binary_recall': 0.80440414, 'binary_specificity': 0.763541, 'binary_f1_score': 0.34480846}
confusion matrix:
      0     1
0  7133  2209
1   151   621
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 21:01:16.627444,epoch time: 0:15:08.568373,used: 1:04:15.609772,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8883647, 'precision': 0.88882184, 'recall': 0.8883769, 'specificity': 0.8883769, 'f1': 0.88833404, 'auroc': 0.95487916, 'binary_precision': 0.9023334, 'binary_recall': 0.87118286, 'binary_specificity': 0.9055709, 'binary_f1_score': 0.88648456}
confusion matrix:
       0      1
0  22920   2390
1   3265  22081
---- Validation: 
scalar performance:
{'acc': 0.8727983, 'precision': 0.54713964, 'recall': 0.72685814, 'specificity': 0.72685814, 'f1': 0.55510336, 'auroc': 0.8030304, 'binary_precision': 0.10615522, 'binary_recall': 0.57349396, 'binary_specificity': 0.8802223, 'binary_f1_score': 0.17914942}
confusion matrix:
       0     1
0  14727  2004
1    177   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77911806, 'precision': 0.60464096, 'recall': 0.7907163, 'specificity': 0.7907163, 'f1': 0.611975, 'auroc': 0.86198187, 'binary_precision': 0.22965977, 'binary_recall': 0.80440414, 'binary_specificity': 0.7770285, 'binary_f1_score': 0.35730723}
confusion matrix:
      0     1
0  7259  2083
1   151   621
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 21:16:27.731137,epoch time: 0:15:11.103693,used: 1:19:26.713465,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8970507, 'precision': 0.8981076, 'recall': 0.897067, 'specificity': 0.897067, 'f1': 0.89698505, 'auroc': 0.9611888, 'binary_precision': 0.91877836, 'binary_recall': 0.8712516, 'binary_specificity': 0.92288244, 'binary_f1_score': 0.894384}
confusion matrix:
       0      1
0  23360   1952
1   3263  22081
---- Validation: 
scalar performance:
{'acc': 0.87752247, 'precision': 0.5491612, 'recall': 0.7292788, 'specificity': 0.7292788, 'f1': 0.559285, 'auroc': 0.8087131, 'binary_precision': 0.1101342, 'binary_recall': 0.57349396, 'binary_specificity': 0.88506365, 'binary_f1_score': 0.18478262}
confusion matrix:
       0     1
0  14808  1923
1    177   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7952343, 'precision': 0.6118981, 'recall': 0.7982521, 'specificity': 0.7982521, 'f1': 0.62586224, 'auroc': 0.8683734, 'binary_precision': 0.24398896, 'binary_recall': 0.8018135, 'binary_specificity': 0.79469067, 'binary_f1_score': 0.37413114}
confusion matrix:
      0     1
0  7424  1918
1   153   619
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-06 21:33:31.396960,epoch time: 0:17:03.665823,used: 1:36:30.379288,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90293354, 'precision': 0.90354025, 'recall': 0.9029473, 'specificity': 0.9029473, 'f1': 0.90289915, 'auroc': 0.9640969, 'binary_precision': 0.9193661, 'binary_recall': 0.88349247, 'binary_specificity': 0.9224022, 'binary_f1_score': 0.9010724}
confusion matrix:
       0      1
0  23346   1964
1   2953  22393
---- Validation: 
scalar performance:
{'acc': 0.8668494, 'precision': 0.54720455, 'recall': 0.73790914, 'specificity': 0.73790914, 'f1': 0.5536033, 'auroc': 0.8125714, 'binary_precision': 0.105574325, 'binary_recall': 0.60240966, 'binary_specificity': 0.8734086, 'binary_f1_score': 0.17966223}
confusion matrix:
       0     1
0  14613  2118
1    165   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79375124, 'precision': 0.6131241, 'recall': 0.804579, 'specificity': 0.804579, 'f1': 0.6266816, 'auroc': 0.87301624, 'binary_precision': 0.24495341, 'binary_recall': 0.81735754, 'binary_specificity': 0.7918005, 'binary_f1_score': 0.37694147}
confusion matrix:
      0     1
0  7397  1945
1   141   631
early stop counter: 1
val acc:0.866849422454834, best validation acc: 0.8775224685668945, corresponding to test acc:                         0.7952343225479126 / 0.7952343225479126
after epoch: 7,now: 2024-08-06 21:51:33.336301,epoch time: 0:18:01.939341,used: 1:54:32.318629,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90601313, 'precision': 0.906945, 'recall': 0.9060302, 'specificity': 0.9060302, 'f1': 0.9059618, 'auroc': 0.9662477, 'binary_precision': 0.92659676, 'binary_recall': 0.8820327, 'binary_specificity': 0.93002766, 'binary_f1_score': 0.9037657}
confusion matrix:
       0      1
0  23539   1771
1   2990  22356
---- Validation: 
scalar performance:
{'acc': 0.8730899, 'precision': 0.5485069, 'recall': 0.7340572, 'specificity': 0.7340572, 'f1': 0.5571917, 'auroc': 0.8155358, 'binary_precision': 0.108492665, 'binary_recall': 0.5879518, 'binary_specificity': 0.8801626, 'binary_f1_score': 0.1831832}
confusion matrix:
       0     1
0  14726  2005
1    171   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8061103, 'precision': 0.61871225, 'recall': 0.80829847, 'specificity': 0.80829847, 'f1': 0.63720787, 'auroc': 0.8763428, 'binary_precision': 0.25645226, 'binary_recall': 0.81088084, 'binary_specificity': 0.8057161, 'binary_f1_score': 0.38966697}
confusion matrix:
      0     1
0  7527  1815
1   146   626
new oracle model saved
early stop counter: 2
val acc:0.8730899095535278, best validation acc: 0.8775224685668945, corresponding to test acc:                         0.7952343225479126 / 0.8061103224754333
after epoch: 8,now: 2024-08-06 22:10:24.882895,epoch time: 0:18:51.546594,used: 2:13:23.865223,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9135739, 'precision': 0.9144858, 'recall': 0.91358787, 'specificity': 0.91358787, 'f1': 0.91352826, 'auroc': 0.96945155, 'binary_precision': 0.93407595, 'binary_recall': 0.8900683, 'binary_specificity': 0.93710744, 'binary_f1_score': 0.9115413}
confusion matrix:
       0      1
0  23721   1592
1   2786  22557
---- Validation: 
scalar performance:
{'acc': 0.8640499, 'precision': 0.54731673, 'recall': 0.7435243, 'specificity': 0.7435243, 'f1': 0.5529857, 'auroc': 0.8192502, 'binary_precision': 0.10543657, 'binary_recall': 0.6168675, 'binary_specificity': 0.8701811, 'binary_f1_score': 0.18009146}
confusion matrix:
       0     1
0  14559  2172
1    159   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.804034, 'precision': 0.6187279, 'recall': 0.81133354, 'specificity': 0.81133354, 'f1': 0.63652635, 'auroc': 0.8795627, 'binary_precision': 0.25565428, 'binary_recall': 0.8199482, 'binary_specificity': 0.8027189, 'binary_f1_score': 0.3897783}
confusion matrix:
      0     1
0  7499  1843
1   139   633
early stop counter: 3
val acc:0.8640499114990234, best validation acc: 0.8775224685668945, corresponding to test acc:                         0.7952343225479126 / 0.8061103224754333
after epoch: 9,now: 2024-08-06 22:26:39.030921,epoch time: 0:16:14.148026,used: 2:29:38.013249,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9168114, 'precision': 0.9174241, 'recall': 0.9168221, 'specificity': 0.9168221, 'f1': 0.9167823, 'auroc': 0.9713286, 'binary_precision': 0.93355495, 'binary_recall': 0.8976008, 'binary_specificity': 0.9360433, 'binary_f1_score': 0.9152249}
confusion matrix:
       0      1
0  23695   1619
1   2595  22747
---- Validation: 
scalar performance:
{'acc': 0.86107546, 'precision': 0.5465997, 'recall': 0.7443501, 'specificity': 0.7443501, 'f1': 0.55108976, 'auroc': 0.8226482, 'binary_precision': 0.103906564, 'binary_recall': 0.62168676, 'binary_specificity': 0.86701334, 'binary_f1_score': 0.17805384}
confusion matrix:
       0     1
0  14506  2225
1    157   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8061103, 'precision': 0.62065244, 'recall': 0.81542826, 'specificity': 0.81542826, 'f1': 0.63938904, 'auroc': 0.8822027, 'binary_precision': 0.25882354, 'binary_recall': 0.8264249, 'binary_specificity': 0.8044316, 'binary_f1_score': 0.39419216}
confusion matrix:
      0     1
0  7515  1827
1   134   638
early stop counter: 4
val acc:0.8610754609107971, best validation acc: 0.8775224685668945, corresponding to test acc:                         0.7952343225479126 / 0.8061103224754333
after epoch: 10,now: 2024-08-06 22:41:19.238804,epoch time: 0:14:40.207883,used: 2:44:18.221132,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9180551, 'precision': 0.9189983, 'recall': 0.91807204, 'specificity': 0.91807204, 'f1': 0.9180111, 'auroc': 0.9728384, 'binary_precision': 0.9390562, 'binary_recall': 0.8942634, 'binary_specificity': 0.9418807, 'binary_f1_score': 0.91611254}
confusion matrix:
       0      1
0  23839   1471
1   2680  22666
---- Validation: 
scalar performance:
{'acc': 0.85740113, 'precision': 0.54680425, 'recall': 0.7518668, 'specificity': 0.7518668, 'f1': 0.5503129, 'auroc': 0.8262831, 'binary_precision': 0.10382514, 'binary_recall': 0.64096385, 'binary_specificity': 0.8627697, 'binary_f1_score': 0.1787034}
confusion matrix:
       0     1
0  14435  2296
1    149   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80680245, 'precision': 0.6208681, 'recall': 0.81520873, 'specificity': 0.81520873, 'f1': 0.6398652, 'auroc': 0.8836591, 'binary_precision': 0.2593648, 'binary_recall': 0.8251295, 'binary_specificity': 0.80528796, 'binary_f1_score': 0.39467162}
confusion matrix:
      0     1
0  7523  1819
1   135   637
new oracle model saved
early stop counter: 5
val acc:0.8574011325836182, best validation acc: 0.8775224685668945, corresponding to test acc:                         0.7952343225479126 / 0.8068024516105652
after epoch: 11,now: 2024-08-06 22:56:13.275692,epoch time: 0:14:54.036888,used: 2:59:12.258020,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92235863, 'precision': 0.9241554, 'recall': 0.9223728, 'specificity': 0.9223728, 'f1': 0.9222781, 'auroc': 0.9760686, 'binary_precision': 0.9518703, 'binary_recall': 0.8897747, 'binary_specificity': 0.95497096, 'binary_f1_score': 0.91977566}
confusion matrix:
       0      1
0  24177   1140
1   2793  22546
---- Validation: 
scalar performance:
{'acc': 0.8818383, 'precision': 0.5524407, 'recall': 0.7385399, 'specificity': 0.7385399, 'f1': 0.5651791, 'auroc': 0.8272027, 'binary_precision': 0.11624583, 'binary_recall': 0.5879518, 'binary_specificity': 0.88912797, 'binary_f1_score': 0.19411296}
confusion matrix:
       0     1
0  14876  1855
1    171   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83428913, 'precision': 0.63537085, 'recall': 0.8211756, 'specificity': 0.8211756, 'f1': 0.6645968, 'auroc': 0.884061, 'binary_precision': 0.2895717, 'binary_recall': 0.80569947, 'binary_specificity': 0.8366517, 'binary_f1_score': 0.42602742}
confusion matrix:
      0     1
0  7816  1526
1   150   622
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-06 23:11:06.048123,epoch time: 0:14:52.772431,used: 3:14:05.030451,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92490524, 'precision': 0.9258086, 'recall': 0.9249171, 'specificity': 0.9249171, 'f1': 0.9248668, 'auroc': 0.9757682, 'binary_precision': 0.9455501, 'binary_recall': 0.90181917, 'binary_specificity': 0.94801503, 'binary_f1_score': 0.92316705}
confusion matrix:
       0      1
0  23999   1316
1   2488  22853
---- Validation: 
scalar performance:
{'acc': 0.8557681, 'precision': 0.5471656, 'recall': 0.7569047, 'specificity': 0.7569047, 'f1': 0.55035007, 'auroc': 0.83012474, 'binary_precision': 0.10423077, 'binary_recall': 0.65301204, 'binary_specificity': 0.86079735, 'binary_f1_score': 0.17976782}
confusion matrix:
       0     1
0  14402  2329
1    144   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111529, 'precision': 0.6237649, 'recall': 0.81934613, 'specificity': 0.81934613, 'f1': 0.6445758, 'auroc': 0.8850883, 'binary_precision': 0.26468155, 'binary_recall': 0.82901555, 'binary_specificity': 0.8096767, 'binary_f1_score': 0.40125394}
confusion matrix:
      0     1
0  7564  1778
1   132   640
early stop counter: 1
val acc:0.855768084526062, best validation acc: 0.881838321685791, corresponding to test acc:                         0.8342891335487366 / 0.8342891335487366
after epoch: 13,now: 2024-08-06 23:26:28.149848,epoch time: 0:15:22.101725,used: 3:29:27.132176,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92735314, 'precision': 0.9286103, 'recall': 0.92736924, 'specificity': 0.92736924, 'f1': 0.92730165, 'auroc': 0.977952, 'binary_precision': 0.95197165, 'binary_recall': 0.9002091, 'binary_specificity': 0.9545293, 'binary_f1_score': 0.9253671}
confusion matrix:
       0      1
0  24162   1151
1   2529  22814
---- Validation: 
scalar performance:
{'acc': 0.86259186, 'precision': 0.54812616, 'recall': 0.7510017, 'specificity': 0.7510017, 'f1': 0.55375206, 'auroc': 0.8295177, 'binary_precision': 0.10660721, 'binary_recall': 0.63373494, 'binary_specificity': 0.8682685, 'binary_f1_score': 0.18251215}
confusion matrix:
       0     1
0  14527  2204
1    152   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82113904, 'precision': 0.6283722, 'recall': 0.8199987, 'specificity': 0.8199987, 'f1': 0.65293705, 'auroc': 0.88528824, 'binary_precision': 0.27466318, 'binary_recall': 0.81865287, 'binary_specificity': 0.8213445, 'binary_f1_score': 0.4113244}
confusion matrix:
      0     1
0  7673  1669
1   140   632
early stop counter: 2
val acc:0.8625918626785278, best validation acc: 0.881838321685791, corresponding to test acc:                         0.8342891335487366 / 0.8342891335487366
after epoch: 14,now: 2024-08-06 23:41:30.964210,epoch time: 0:15:02.814362,used: 3:44:29.946538,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9283599, 'precision': 0.92921233, 'recall': 0.92837316, 'specificity': 0.92837316, 'f1': 0.92832583, 'auroc': 0.97801334, 'binary_precision': 0.9484881, 'binary_recall': 0.90600955, 'binary_specificity': 0.95073676, 'binary_f1_score': 0.92676234}
confusion matrix:
       0      1
0  24066   1247
1   2382  22961
---- Validation: 
scalar performance:
{'acc': 0.84964424, 'precision': 0.54637367, 'recall': 0.7619913, 'specificity': 0.7619913, 'f1': 0.5473347, 'auroc': 0.8327694, 'binary_precision': 0.10224347, 'binary_recall': 0.6698795, 'binary_specificity': 0.85410315, 'binary_f1_score': 0.17740905}
confusion matrix:
       0     1
0  14290  2441
1    137   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8124382, 'precision': 0.6249738, 'recall': 0.8218243, 'specificity': 0.8218243, 'f1': 0.64636385, 'auroc': 0.88782036, 'binary_precision': 0.2666943, 'binary_recall': 0.83290154, 'binary_specificity': 0.81074715, 'binary_f1_score': 0.40402138}
confusion matrix:
      0     1
0  7574  1768
1   129   643
early stop counter: 3
val acc:0.8496442437171936, best validation acc: 0.881838321685791, corresponding to test acc:                         0.8342891335487366 / 0.8342891335487366
after epoch: 15,now: 2024-08-06 23:56:30.108529,epoch time: 0:14:59.144319,used: 3:59:29.090857,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.93015635, 'precision': 0.93092495, 'recall': 0.93016887, 'specificity': 0.93016887, 'f1': 0.93012655, 'auroc': 0.9790541, 'binary_precision': 0.9492727, 'binary_recall': 0.9089689, 'binary_specificity': 0.95136887, 'binary_f1_score': 0.92868376}
confusion matrix:
       0      1
0  24082   1231
1   2307  23036
---- Validation: 
scalar performance:
{'acc': 0.847078, 'precision': 0.5469679, 'recall': 0.7700759, 'specificity': 0.7700759, 'f1': 0.5473859, 'auroc': 0.8368653, 'binary_precision': 0.10291472, 'binary_recall': 0.68915665, 'binary_specificity': 0.8509952, 'binary_f1_score': 0.17908579}
confusion matrix:
       0     1
0  14238  2493
1    129   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81144947, 'precision': 0.62489045, 'recall': 0.8230716, 'specificity': 0.8230716, 'f1': 0.64594537, 'auroc': 0.8890985, 'binary_precision': 0.26617223, 'binary_recall': 0.8367876, 'binary_specificity': 0.8093556, 'binary_f1_score': 0.40387622}
confusion matrix:
      0     1
0  7561  1781
1   126   646
early stop counter: 4
val acc:0.8470780253410339, best validation acc: 0.881838321685791, corresponding to test acc:                         0.8342891335487366 / 0.8342891335487366
after epoch: 16,now: 2024-08-07 00:11:29.416381,epoch time: 0:14:59.307852,used: 4:14:28.398709,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93248576, 'precision': 0.9331708, 'recall': 0.93249846, 'specificity': 0.93249846, 'f1': 0.93246037, 'auroc': 0.9799008, 'binary_precision': 0.95055485, 'binary_recall': 0.9125237, 'binary_specificity': 0.95247316, 'binary_f1_score': 0.93115103}
confusion matrix:
       0      1
0  24109   1203
1   2217  23127
---- Validation: 
scalar performance:
{'acc': 0.8481862, 'precision': 0.54750574, 'recall': 0.77181864, 'specificity': 0.77181864, 'f1': 0.54850805, 'auroc': 0.83902967, 'binary_precision': 0.10391021, 'binary_recall': 0.6915663, 'binary_specificity': 0.852071, 'binary_f1_score': 0.18067358}
confusion matrix:
       0     1
0  14256  2475
1    128   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8143168, 'precision': 0.6263718, 'recall': 0.82402956, 'specificity': 0.82402956, 'f1': 0.6485574, 'auroc': 0.8898741, 'binary_precision': 0.26919866, 'binary_recall': 0.83549225, 'binary_specificity': 0.8125669, 'binary_f1_score': 0.40719697}
confusion matrix:
      0     1
0  7591  1751
1   127   645
early stop counter: 5
val acc:0.848186194896698, best validation acc: 0.881838321685791, corresponding to test acc:                         0.8342891335487366 / 0.8342891335487366
after epoch: 17,now: 2024-08-07 00:26:19.451015,epoch time: 0:14:50.034634,used: 4:29:18.433343,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93260425, 'precision': 0.9331918, 'recall': 0.93261665, 'specificity': 0.93261665, 'f1': 0.9325826, 'auroc': 0.980847, 'binary_precision': 0.94931364, 'binary_recall': 0.91410536, 'binary_specificity': 0.95112795, 'binary_f1_score': 0.9313769}
confusion matrix:
       0      1
0  24074   1237
1   2177  23168
---- Validation: 
scalar performance:
{'acc': 0.85162723, 'precision': 0.54883754, 'recall': 0.7747568, 'specificity': 0.7747568, 'f1': 0.55150187, 'auroc': 0.84135306, 'binary_precision': 0.106469505, 'binary_recall': 0.6939759, 'binary_specificity': 0.85553765, 'binary_f1_score': 0.18461539}
confusion matrix:
       0     1
0  14314  2417
1    127   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81886494, 'precision': 0.6282623, 'recall': 0.82352084, 'specificity': 0.82352084, 'f1': 0.65213835, 'auroc': 0.88948953, 'binary_precision': 0.2735043, 'binary_recall': 0.82901555, 'binary_specificity': 0.8180261, 'binary_f1_score': 0.41131106}
confusion matrix:
      0     1
0  7642  1700
1   132   640
early stop counter: 6
val acc:0.8516272306442261, best validation acc: 0.881838321685791, corresponding to test acc:                         0.8342891335487366 / 0.8342891335487366
after epoch: 18,now: 2024-08-07 00:41:11.804564,epoch time: 0:14:52.353549,used: 4:44:10.786892,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9332557, 'precision': 0.9344648, 'recall': 0.9332724, 'specificity': 0.9332724, 'f1': 0.93321097, 'auroc': 0.9806733, 'binary_precision': 0.95754343, 'binary_recall': 0.9068024, 'binary_specificity': 0.9597424, 'binary_f1_score': 0.93148243}
confusion matrix:
       0      1
0  24293   1019
1   2362  22982
---- Validation: 
scalar performance:
{'acc': 0.86696607, 'precision': 0.5515795, 'recall': 0.7638174, 'specificity': 0.7638174, 'f1': 0.56003886, 'auroc': 0.8413844, 'binary_precision': 0.11286307, 'binary_recall': 0.6554217, 'binary_specificity': 0.87221324, 'binary_f1_score': 0.19256638}
confusion matrix:
       0     1
0  14593  2138
1    143   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8359699, 'precision': 0.63717645, 'recall': 0.82446206, 'specificity': 0.82446206, 'f1': 0.6671455, 'auroc': 0.8897922, 'binary_precision': 0.29266012, 'binary_recall': 0.81088084, 'binary_specificity': 0.8380433, 'binary_f1_score': 0.43009278}
confusion matrix:
      0     1
0  7829  1513
1   146   626
new oracle model saved
early stop counter: 7
val acc:0.8669660687446594, best validation acc: 0.881838321685791, corresponding to test acc:                         0.8342891335487366 / 0.8359699249267578
after epoch: 19,now: 2024-08-07 00:55:48.666466,epoch time: 0:14:36.861902,used: 4:58:47.648794,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.935289, 'precision': 0.9362416, 'recall': 0.9353029, 'specificity': 0.9353029, 'f1': 0.93525505, 'auroc': 0.9816745, 'binary_precision': 0.95677555, 'binary_recall': 0.91184944, 'binary_specificity': 0.9587564, 'binary_f1_score': 0.9337725}
confusion matrix:
       0      1
0  24269   1044
1   2234  23109
---- Validation: 
scalar performance:
{'acc': 0.85740113, 'precision': 0.5501551, 'recall': 0.7730156, 'specificity': 0.7730156, 'f1': 0.55517447, 'auroc': 0.8437946, 'binary_precision': 0.10931486, 'binary_recall': 0.6843374, 'binary_specificity': 0.86169386, 'binary_f1_score': 0.18851644}
confusion matrix:
       0     1
0  14417  2314
1    131   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8306308, 'precision': 0.6350899, 'recall': 0.82751334, 'specificity': 0.82751334, 'f1': 0.663393, 'auroc': 0.890846, 'binary_precision': 0.28739268, 'binary_recall': 0.8238342, 'binary_specificity': 0.8311925, 'binary_f1_score': 0.42613068}
confusion matrix:
      0     1
0  7765  1577
1   136   636
early stop counter: 8
val acc:0.8574011325836182, best validation acc: 0.881838321685791, corresponding to test acc:                         0.8342891335487366 / 0.8359699249267578
after epoch: 20,now: 2024-08-07 01:10:38.618812,epoch time: 0:14:49.952346,used: 5:13:37.601140,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_57_00_seed_0_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:13:37.601140 at 2024-08-07 01:10:38.618812
persisted model performance metric: 

scalar performance:
{'acc': 0.83428913, 'precision': 0.63537085, 'recall': 0.8211756, 'specificity': 0.8211756, 'f1': 0.6645968, 'auroc': 0.884061, 'binary_precision': 0.2895717, 'binary_recall': 0.80569947, 'binary_specificity': 0.8366517, 'binary_f1_score': 0.42602742}
confusion matrix:
      0     1
0  7816  1526
1   150   622
oracle model performance metric: 

scalar performance:
{'acc': 0.8359699, 'precision': 0.63717645, 'recall': 0.82446206, 'specificity': 0.82446206, 'f1': 0.6671455, 'auroc': 0.8897922, 'binary_precision': 0.29266012, 'binary_recall': 0.81088084, 'binary_specificity': 0.8380433, 'binary_f1_score': 0.43009278}
confusion matrix:
      0     1
0  7829  1513
1   146   626
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/15.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192600 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 192600 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189463 KiB | 457745 KiB | 361395 GiB | 361394 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |  16649 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44967 KiB |  90894 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |  14567 KiB |  15070 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6815    |   81220 K  |   81216 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46330 K  |   46326 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6815    |   81220 K  |   81216 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46330 K  |   46326 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3184    |   42904 K  |   42904 K  |
|       from large pool |       9    |      18    |   24129 K  |   24129 K  |
|       from small pool |      25    |    3176    |   18774 K  |   18774 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  90894 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42906 K  |   42906 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18776 K  |   18776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  90894 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42906 K  |   42906 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18776 K  |   18776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677

 Experiment start at: 2024-08-07 01:34:13.266662
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6334002, 'precision': 0.6375476, 'recall': 0.6333349, 'specificity': 0.6333349, 'f1': 0.63054717, 'auroc': 0.66947377, 'binary_precision': 0.61384946, 'binary_recall': 0.7207391, 'binary_specificity': 0.5459306, 'binary_f1_score': 0.6630138}
confusion matrix:
       0      1
0  13865  11532
1   7103  18332
---- Validation: 
scalar performance:
{'acc': 0.86497694, 'precision': 0.5107671, 'recall': 0.54649824, 'specificity': 0.54649824, 'f1': 0.50008047, 'auroc': 0.7379437, 'binary_precision': 0.044110518, 'binary_recall': 0.21113689, 'binary_specificity': 0.8818596, 'binary_f1_score': 0.072975144}
confusion matrix:
       0     1
0  14720  1972
1    340    91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7954613, 'precision': 0.48263505, 'recall': 0.46943787, 'specificity': 0.46943787, 'f1': 0.47225466, 'auroc': 0.5956528, 'binary_precision': 0.045233123, 'binary_recall': 0.08586526, 'binary_specificity': 0.8530105, 'binary_f1_score': 0.059252504}
confusion matrix:
      0     1
0  7962  1372
1   692    65
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 01:51:37.856444,epoch time: 0:17:24.589782,used: 0:17:24.589782,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7636725, 'precision': 0.76370394, 'recall': 0.7636676, 'specificity': 0.7636676, 'f1': 0.76366305, 'auroc': 0.8337151, 'binary_precision': 0.7610344, 'binary_recall': 0.7693215, 'binary_specificity': 0.7580137, 'binary_f1_score': 0.76515555}
confusion matrix:
       0      1
0  19249   6145
1   5868  19570
---- Validation: 
scalar performance:
{'acc': 0.8742627, 'precision': 0.5190424, 'recall': 0.57838434, 'specificity': 0.57838434, 'f1': 0.51447326, 'auroc': 0.7696594, 'binary_precision': 0.058913935, 'binary_recall': 0.26682135, 'binary_specificity': 0.8899473, 'binary_f1_score': 0.09651699}
confusion matrix:
       0     1
0  14855  1837
1    316   115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8025964, 'precision': 0.5268084, 'recall': 0.5521962, 'specificity': 0.5521962, 'f1': 0.52590895, 'auroc': 0.7131355, 'binary_precision': 0.12, 'binary_recall': 0.25759578, 'binary_specificity': 0.84679663, 'binary_f1_score': 0.16372795}
confusion matrix:
      0     1
0  7904  1430
1   562   195
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 02:07:45.825831,epoch time: 0:16:07.969387,used: 0:33:32.559169,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.82570034, 'precision': 0.82595384, 'recall': 0.8256888, 'specificity': 0.8256888, 'f1': 0.8256628, 'auroc': 0.90105534, 'binary_precision': 0.817069, 'binary_recall': 0.83968234, 'binary_specificity': 0.8116952, 'binary_f1_score': 0.8282213}
confusion matrix:
       0      1
0  20613   4782
1   4078  21359
---- Validation: 
scalar performance:
{'acc': 0.87128425, 'precision': 0.5310708, 'recall': 0.636754, 'specificity': 0.636754, 'f1': 0.53138494, 'auroc': 0.7916768, 'binary_precision': 0.079658605, 'binary_recall': 0.3897912, 'binary_specificity': 0.88371676, 'binary_f1_score': 0.13228346}
confusion matrix:
       0     1
0  14751  1941
1    263   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79863244, 'precision': 0.57391256, 'recall': 0.6738681, 'specificity': 0.6738681, 'f1': 0.5824371, 'auroc': 0.7814498, 'binary_precision': 0.19247468, 'binary_recall': 0.5270806, 'binary_specificity': 0.82065564, 'binary_f1_score': 0.28197882}
confusion matrix:
      0     1
0  7660  1674
1   358   399
early stop counter: 1
val acc:0.8712842464447021, best validation acc: 0.8742626905441284, corresponding to test acc:                         0.802596390247345 / 0.802596390247345
after epoch: 3,now: 2024-08-07 02:22:38.659199,epoch time: 0:14:52.833368,used: 0:48:25.392537,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85554373, 'precision': 0.8555509, 'recall': 0.85554564, 'specificity': 0.85554564, 'f1': 0.85554343, 'auroc': 0.9301698, 'binary_precision': 0.8573629, 'binary_recall': 0.8532846, 'binary_specificity': 0.8578067, 'binary_f1_score': 0.8553189}
confusion matrix:
       0      1
0  21784   3611
1   3732  21705
---- Validation: 
scalar performance:
{'acc': 0.882614, 'precision': 0.54243577, 'recall': 0.67646927, 'specificity': 0.67646927, 'f1': 0.5507302, 'auroc': 0.8063704, 'binary_precision': 0.100253165, 'binary_recall': 0.45939675, 'binary_specificity': 0.8935418, 'binary_f1_score': 0.16458851}
confusion matrix:
       0     1
0  14915  1777
1    233   198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8119116, 'precision': 0.59783185, 'recall': 0.7332425, 'specificity': 0.7332425, 'f1': 0.61429626, 'auroc': 0.8225093, 'binary_precision': 0.22974893, 'binary_recall': 0.6406869, 'binary_specificity': 0.82579815, 'binary_f1_score': 0.3382148}
confusion matrix:
      0     1
0  7708  1626
1   272   485
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 02:37:32.039745,epoch time: 0:14:53.380546,used: 1:03:18.773083,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.873918, 'precision': 0.87432164, 'recall': 0.87393034, 'specificity': 0.87393034, 'f1': 0.8738866, 'auroc': 0.9454131, 'binary_precision': 0.88680166, 'binary_recall': 0.8574799, 'binary_specificity': 0.89038074, 'binary_f1_score': 0.87189436}
confusion matrix:
       0      1
0  22613   2784
1   3625  21810
---- Validation: 
scalar performance:
{'acc': 0.8990247, 'precision': 0.54985625, 'recall': 0.6803659, 'specificity': 0.6803659, 'f1': 0.56473196, 'auroc': 0.8143402, 'binary_precision': 0.11506525, 'binary_recall': 0.450116, 'binary_specificity': 0.91061586, 'binary_f1_score': 0.18327823}
confusion matrix:
       0     1
0  15200  1492
1    237   194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83579427, 'precision': 0.6144285, 'recall': 0.7504009, 'specificity': 0.7504009, 'f1': 0.63906085, 'auroc': 0.84531116, 'binary_precision': 0.2611465, 'binary_recall': 0.64993393, 'binary_specificity': 0.8508678, 'binary_f1_score': 0.37258613}
confusion matrix:
      0     1
0  7942  1392
1   265   492
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 02:52:36.130897,epoch time: 0:15:04.091152,used: 1:18:22.864235,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8843642, 'precision': 0.8844633, 'recall': 0.88437116, 'specificity': 0.88437116, 'f1': 0.8843579, 'auroc': 0.95414495, 'binary_precision': 0.890856, 'binary_recall': 0.87628746, 'binary_specificity': 0.8924549, 'binary_f1_score': 0.88351166}
confusion matrix:
       0      1
0  22663   2731
1   3147  22291
---- Validation: 
scalar performance:
{'acc': 0.8924838, 'precision': 0.553971, 'recall': 0.7131755, 'specificity': 0.7131755, 'f1': 0.56975293, 'auroc': 0.82451904, 'binary_precision': 0.12137487, 'binary_recall': 0.52436197, 'binary_specificity': 0.901989, 'binary_f1_score': 0.19712168}
confusion matrix:
       0     1
0  15056  1636
1    205   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8371816, 'precision': 0.6241536, 'recall': 0.7808906, 'specificity': 0.7808906, 'f1': 0.65147364, 'auroc': 0.8616246, 'binary_precision': 0.27489838, 'binary_recall': 0.71466315, 'binary_specificity': 0.8471181, 'binary_f1_score': 0.3970642}
confusion matrix:
      0     1
0  7907  1427
1   216   541
new oracle model saved
early stop counter: 1
val acc:0.8924837708473206, best validation acc: 0.8990247249603271, corresponding to test acc:                         0.8357942700386047 / 0.8371816277503967
after epoch: 6,now: 2024-08-07 03:07:34.286406,epoch time: 0:14:58.155509,used: 1:33:21.019744,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89380705, 'precision': 0.8940456, 'recall': 0.89381576, 'specificity': 0.89381576, 'f1': 0.8937924, 'auroc': 0.9597993, 'binary_precision': 0.90391904, 'binary_recall': 0.88145787, 'binary_specificity': 0.9061737, 'binary_f1_score': 0.89254713}
confusion matrix:
       0      1
0  23015   2383
1   3015  22419
---- Validation: 
scalar performance:
{'acc': 0.8928926, 'precision': 0.5563074, 'recall': 0.7235564, 'specificity': 0.7235564, 'f1': 0.57328826, 'auroc': 0.83230674, 'binary_precision': 0.12546717, 'binary_recall': 0.5452436, 'binary_specificity': 0.9018692, 'binary_f1_score': 0.20399305}
confusion matrix:
       0     1
0  15054  1638
1    196   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445149, 'precision': 0.63285494, 'recall': 0.79638636, 'specificity': 0.79638636, 'f1': 0.66340935, 'auroc': 0.8724066, 'binary_precision': 0.28985506, 'binary_recall': 0.73976225, 'binary_specificity': 0.8530105, 'binary_f1_score': 0.4165117}
confusion matrix:
      0     1
0  7962  1372
1   197   560
new oracle model saved
early stop counter: 2
val acc:0.892892599105835, best validation acc: 0.8990247249603271, corresponding to test acc:                         0.8357942700386047 / 0.8445149064064026
after epoch: 7,now: 2024-08-07 03:22:36.719798,epoch time: 0:15:02.433392,used: 1:48:23.453136,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.902463, 'precision': 0.9033394, 'recall': 0.9024805, 'specificity': 0.9024805, 'f1': 0.90241265, 'auroc': 0.9640678, 'binary_precision': 0.9223281, 'binary_recall': 0.8791036, 'binary_specificity': 0.92585737, 'binary_f1_score': 0.90019727}
confusion matrix:
       0      1
0  23514   1883
1   3075  22360
---- Validation: 
scalar performance:
{'acc': 0.90276235, 'precision': 0.5608788, 'recall': 0.7207077, 'specificity': 0.7207077, 'f1': 0.58158207, 'auroc': 0.8354513, 'binary_precision': 0.13491124, 'binary_recall': 0.5290023, 'binary_specificity': 0.9124131, 'binary_f1_score': 0.21499293}
confusion matrix:
       0     1
0  15230  1462
1    203   228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8621544, 'precision': 0.6470168, 'recall': 0.8028867, 'specificity': 0.8028867, 'f1': 0.6825752, 'auroc': 0.88033915, 'binary_precision': 0.31823394, 'binary_recall': 0.7331572, 'binary_specificity': 0.87261623, 'binary_f1_score': 0.4438225}
confusion matrix:
      0     1
0  8145  1189
1   202   555
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-07 03:37:34.064300,epoch time: 0:14:57.344502,used: 2:03:20.797638,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90877795, 'precision': 0.91023505, 'recall': 0.9088026, 'specificity': 0.9088026, 'f1': 0.90870047, 'auroc': 0.96865594, 'binary_precision': 0.9348917, 'binary_recall': 0.87891656, 'binary_specificity': 0.9386887, 'binary_f1_score': 0.9060405}
confusion matrix:
       0      1
0  23838   1557
1   3080  22357
---- Validation: 
scalar performance:
{'acc': 0.9123985, 'precision': 0.567461, 'recall': 0.72225976, 'specificity': 0.72225976, 'f1': 0.5921619, 'auroc': 0.83934176, 'binary_precision': 0.14812377, 'binary_recall': 0.52204174, 'binary_specificity': 0.92247784, 'binary_f1_score': 0.23076922}
confusion matrix:
       0     1
0  15398  1294
1    206   225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87563175, 'precision': 0.660057, 'recall': 0.80774415, 'specificity': 0.80774415, 'f1': 0.69856834, 'auroc': 0.8853463, 'binary_precision': 0.344375, 'binary_recall': 0.7278732, 'binary_specificity': 0.88761514, 'binary_f1_score': 0.4675435}
confusion matrix:
      0     1
0  8285  1049
1   206   551
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-07 03:52:31.945769,epoch time: 0:14:57.881469,used: 2:18:18.679107,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9152896, 'precision': 0.91666895, 'recall': 0.91531116, 'specificity': 0.91531116, 'f1': 0.9152223, 'auroc': 0.97197115, 'binary_precision': 0.94083035, 'binary_recall': 0.88645566, 'binary_specificity': 0.94416666, 'binary_f1_score': 0.912834}
confusion matrix:
       0      1
0  23979   1418
1   2888  22547
---- Validation: 
scalar performance:
{'acc': 0.9054488, 'precision': 0.5652721, 'recall': 0.733387, 'specificity': 0.733387, 'f1': 0.58842576, 'auroc': 0.8429414, 'binary_precision': 0.14302884, 'binary_recall': 0.5522042, 'binary_specificity': 0.91456985, 'binary_f1_score': 0.22720762}
confusion matrix:
       0     1
0  15266  1426
1    193   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8747399, 'precision': 0.66076213, 'recall': 0.8139384, 'specificity': 0.8139384, 'f1': 0.6998258, 'auroc': 0.889917, 'binary_precision': 0.3445739, 'binary_recall': 0.7424042, 'binary_specificity': 0.8854725, 'binary_f1_score': 0.47068682}
confusion matrix:
      0     1
0  8265  1069
1   195   562
early stop counter: 1
val acc:0.9054487943649292, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8756317496299744
after epoch: 10,now: 2024-08-07 04:07:26.250558,epoch time: 0:14:54.304789,used: 2:33:12.983896,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91761094, 'precision': 0.9194128, 'recall': 0.9176368, 'specificity': 0.9176368, 'f1': 0.91752577, 'auroc': 0.9736779, 'binary_precision': 0.9471004, 'binary_recall': 0.8847696, 'binary_specificity': 0.950504, 'binary_f1_score': 0.91487455}
confusion matrix:
       0      1
0  24139   1257
1   2931  22505
---- Validation: 
scalar performance:
{'acc': 0.90247035, 'precision': 0.5648089, 'recall': 0.7397703, 'specificity': 0.7397703, 'f1': 0.5874021, 'auroc': 0.8441527, 'binary_precision': 0.1417004, 'binary_recall': 0.5684455, 'binary_specificity': 0.91109514, 'binary_f1_score': 0.22685185}
confusion matrix:
       0     1
0  15208  1484
1    186   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8773164, 'precision': 0.66373783, 'recall': 0.81593806, 'specificity': 0.81593806, 'f1': 0.7034155, 'auroc': 0.89265096, 'binary_precision': 0.35034224, 'binary_recall': 0.74372524, 'binary_specificity': 0.8881509, 'binary_f1_score': 0.47631133}
confusion matrix:
      0     1
0  8290  1044
1   194   563
new oracle model saved
early stop counter: 2
val acc:0.9024703502655029, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.877316415309906
after epoch: 11,now: 2024-08-07 04:22:38.301504,epoch time: 0:15:12.050946,used: 2:48:25.034842,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9203061, 'precision': 0.92157865, 'recall': 0.9203289, 'specificity': 0.9203289, 'f1': 0.92024875, 'auroc': 0.9743993, 'binary_precision': 0.9449484, 'binary_recall': 0.8927547, 'binary_specificity': 0.94790316, 'binary_f1_score': 0.9181104}
confusion matrix:
       0      1
0  24072   1323
1   2728  22709
---- Validation: 
scalar performance:
{'acc': 0.90136075, 'precision': 0.564742, 'recall': 0.7425916, 'specificity': 0.7425916, 'f1': 0.58716077, 'auroc': 0.8453566, 'binary_precision': 0.14139111, 'binary_recall': 0.575406, 'binary_specificity': 0.90977716, 'binary_f1_score': 0.22700231}
confusion matrix:
       0     1
0  15186  1506
1    183   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8784065, 'precision': 0.6658469, 'recall': 0.82016885, 'specificity': 0.82016885, 'f1': 0.7061586, 'auroc': 0.89424384, 'binary_precision': 0.35385573, 'binary_recall': 0.7516512, 'binary_specificity': 0.88868654, 'binary_f1_score': 0.48118398}
confusion matrix:
      0     1
0  8295  1039
1   188   569
new oracle model saved
early stop counter: 3
val acc:0.9013607501983643, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8784065246582031
after epoch: 12,now: 2024-08-07 04:37:37.360264,epoch time: 0:14:59.058760,used: 3:03:24.093602,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9218012, 'precision': 0.9233742, 'recall': 0.9218241, 'specificity': 0.9218241, 'f1': 0.92173135, 'auroc': 0.97523355, 'binary_precision': 0.94936764, 'binary_recall': 0.8912522, 'binary_specificity': 0.952396, 'binary_f1_score': 0.9193925}
confusion matrix:
       0      1
0  24188   1209
1   2766  22669
---- Validation: 
scalar performance:
{'acc': 0.9032296, 'precision': 0.5663063, 'recall': 0.7446803, 'specificity': 0.7446803, 'f1': 0.58972806, 'auroc': 0.84869945, 'binary_precision': 0.14443156, 'binary_recall': 0.57772624, 'binary_specificity': 0.9116343, 'binary_f1_score': 0.2310905}
confusion matrix:
       0     1
0  15217  1475
1    182   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8805867, 'precision': 0.6686199, 'recall': 0.82256126, 'specificity': 0.82256126, 'f1': 0.7095074, 'auroc': 0.8959516, 'binary_precision': 0.3591195, 'binary_recall': 0.75429326, 'binary_specificity': 0.8908292, 'binary_f1_score': 0.4865786}
confusion matrix:
      0     1
0  8315  1019
1   186   571
new oracle model saved
early stop counter: 4
val acc:0.9032295942306519, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8805866837501526
after epoch: 13,now: 2024-08-07 04:52:37.671367,epoch time: 0:15:00.311103,used: 3:18:24.404705,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92624724, 'precision': 0.9279022, 'recall': 0.9262718, 'specificity': 0.9262718, 'f1': 0.9261787, 'auroc': 0.9779614, 'binary_precision': 0.95471126, 'binary_recall': 0.89506996, 'binary_specificity': 0.95747364, 'binary_f1_score': 0.9239291}
confusion matrix:
       0      1
0  24316   1080
1   2669  22767
---- Validation: 
scalar performance:
{'acc': 0.90772647, 'precision': 0.5672529, 'recall': 0.73568535, 'specificity': 0.73568535, 'f1': 0.59158885, 'auroc': 0.84913, 'binary_precision': 0.14689612, 'binary_recall': 0.55452436, 'binary_specificity': 0.9168464, 'binary_f1_score': 0.23226434}
confusion matrix:
       0     1
0  15304  1388
1    192   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.884947, 'precision': 0.6732231, 'recall': 0.82249045, 'specificity': 0.82249045, 'f1': 0.7146051, 'auroc': 0.89687335, 'binary_precision': 0.3686606, 'binary_recall': 0.74900925, 'binary_specificity': 0.8959717, 'binary_f1_score': 0.49411765}
confusion matrix:
      0    1
0  8363  971
1   190  567
new oracle model saved
early stop counter: 5
val acc:0.9077264666557312, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8849470019340515
after epoch: 14,now: 2024-08-07 05:07:36.737227,epoch time: 0:14:59.065860,used: 3:33:23.470565,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9274276, 'precision': 0.92864597, 'recall': 0.9274476, 'specificity': 0.9274476, 'f1': 0.9273783, 'auroc': 0.9783206, 'binary_precision': 0.9516866, 'binary_recall': 0.90068805, 'binary_specificity': 0.9542072, 'binary_f1_score': 0.9254853}
confusion matrix:
       0      1
0  24234   1163
1   2526  22909
---- Validation: 
scalar performance:
{'acc': 0.89581263, 'precision': 0.5642498, 'recall': 0.75556785, 'specificity': 0.75556785, 'f1': 0.58558905, 'auroc': 0.8550962, 'binary_precision': 0.13958444, 'binary_recall': 0.60788864, 'binary_specificity': 0.90324706, 'binary_f1_score': 0.22703639}
confusion matrix:
       0     1
0  15077  1615
1    169   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8775146, 'precision': 0.6667576, 'recall': 0.8275769, 'specificity': 0.8275769, 'f1': 0.70774573, 'auroc': 0.89850235, 'binary_precision': 0.35423008, 'binary_recall': 0.7688243, 'binary_specificity': 0.88632953, 'binary_f1_score': 0.48499998}
confusion matrix:
      0     1
0  8273  1061
1   175   582
early stop counter: 6
val acc:0.8958126306533813, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8849470019340515
after epoch: 15,now: 2024-08-07 05:22:44.208732,epoch time: 0:15:07.471505,used: 3:48:30.942070,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92955226, 'precision': 0.93033934, 'recall': 0.9295683, 'specificity': 0.9295683, 'f1': 0.92952174, 'auroc': 0.97855353, 'binary_precision': 0.9489318, 'binary_recall': 0.90807945, 'binary_specificity': 0.9510572, 'binary_f1_score': 0.92805624}
confusion matrix:
       0      1
0  24154   1243
1   2338  23097
---- Validation: 
scalar performance:
{'acc': 0.8880453, 'precision': 0.56108797, 'recall': 0.7594949, 'specificity': 0.7594949, 'f1': 0.57942224, 'auroc': 0.8555294, 'binary_precision': 0.13290514, 'binary_recall': 0.62412995, 'binary_specificity': 0.8948598, 'binary_f1_score': 0.21914461}
confusion matrix:
       0     1
0  14937  1755
1    162   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87582994, 'precision': 0.6662368, 'recall': 0.83212864, 'specificity': 0.83212864, 'f1': 0.7074087, 'auroc': 0.8990675, 'binary_precision': 0.352205, 'binary_recall': 0.7807133, 'binary_specificity': 0.883544, 'binary_f1_score': 0.4854209}
confusion matrix:
      0     1
0  8247  1087
1   166   591
early stop counter: 7
val acc:0.8880453109741211, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8849470019340515
after epoch: 16,now: 2024-08-07 05:37:44.360763,epoch time: 0:15:00.152031,used: 4:03:31.094101,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93293595, 'precision': 0.9338762, 'recall': 0.9329572, 'specificity': 0.9329572, 'f1': 0.93290174, 'auroc': 0.9800073, 'binary_precision': 0.9543017, 'binary_recall': 0.90954834, 'binary_specificity': 0.95636594, 'binary_f1_score': 0.93138766}
confusion matrix:
       0      1
0  24285   1108
1   2301  23138
---- Validation: 
scalar performance:
{'acc': 0.894119, 'precision': 0.56472415, 'recall': 0.76261014, 'specificity': 0.76261014, 'f1': 0.585998, 'auroc': 0.85566795, 'binary_precision': 0.14010416, 'binary_recall': 0.62412995, 'binary_specificity': 0.9010903, 'binary_f1_score': 0.22883879}
confusion matrix:
       0     1
0  15041  1651
1    162   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88038844, 'precision': 0.6702608, 'recall': 0.83034426, 'specificity': 0.83034426, 'f1': 0.7120036, 'auroc': 0.8994291, 'binary_precision': 0.36093944, 'binary_recall': 0.7714663, 'binary_specificity': 0.8892222, 'binary_f1_score': 0.49178952}
confusion matrix:
      0     1
0  8300  1034
1   173   584
early stop counter: 8
val acc:0.8941190242767334, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8849470019340515
after epoch: 17,now: 2024-08-07 05:52:37.131620,epoch time: 0:14:52.770857,used: 4:18:23.864958,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93421465, 'precision': 0.93542475, 'recall': 0.9342345, 'specificity': 0.9342345, 'f1': 0.93417096, 'auroc': 0.98076844, 'binary_precision': 0.95856684, 'binary_recall': 0.9077649, 'binary_specificity': 0.960704, 'binary_f1_score': 0.93247443}
confusion matrix:
       0      1
0  24399    998
1   2346  23089
---- Validation: 
scalar performance:
{'acc': 0.8998423, 'precision': 0.56670976, 'recall': 0.75650454, 'specificity': 0.75650454, 'f1': 0.58988476, 'auroc': 0.8561964, 'binary_precision': 0.14451827, 'binary_recall': 0.60556847, 'binary_specificity': 0.90744066, 'binary_f1_score': 0.23334825}
confusion matrix:
       0     1
0  15147  1545
1    170   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8841542, 'precision': 0.6740898, 'recall': 0.8299521, 'specificity': 0.8299521, 'f1': 0.71629435, 'auroc': 0.8996435, 'binary_precision': 0.36895674, 'binary_recall': 0.7661823, 'binary_specificity': 0.8937219, 'binary_f1_score': 0.4980679}
confusion matrix:
      0    1
0  8342  992
1   177  580
early stop counter: 9
val acc:0.8998423218727112, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8849470019340515
after epoch: 18,now: 2024-08-07 06:07:35.480576,epoch time: 0:14:58.348956,used: 4:33:22.213914,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93698853, 'precision': 0.9375972, 'recall': 0.937004, 'specificity': 0.937004, 'f1': 0.9369681, 'auroc': 0.9817182, 'binary_precision': 0.9541258, 'binary_recall': 0.91822934, 'binary_specificity': 0.9557787, 'binary_f1_score': 0.93583345}
confusion matrix:
       0      1
0  24272   1123
1   2080  23357
---- Validation: 
scalar performance:
{'acc': 0.87928516, 'precision': 0.5584917, 'recall': 0.76630306, 'specificity': 0.76630306, 'f1': 0.5736017, 'auroc': 0.8577483, 'binary_precision': 0.12716499, 'binary_recall': 0.6473318, 'binary_specificity': 0.8852744, 'binary_f1_score': 0.21257141}
confusion matrix:
       0     1
0  14777  1915
1    152   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87434345, 'precision': 0.6650971, 'recall': 0.833146, 'specificity': 0.833146, 'f1': 0.70609, 'auroc': 0.8998061, 'binary_precision': 0.34961742, 'binary_recall': 0.7846764, 'binary_specificity': 0.8816156, 'binary_f1_score': 0.48371333}
confusion matrix:
      0     1
0  8229  1105
1   163   594
early stop counter: 10
val acc:0.8792851567268372, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8849470019340515
after epoch: 19,now: 2024-08-07 06:22:29.484137,epoch time: 0:14:54.003561,used: 4:48:16.217475,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9370672, 'precision': 0.93806064, 'recall': 0.93708605, 'specificity': 0.93708605, 'f1': 0.93703336, 'auroc': 0.9825555, 'binary_precision': 0.9591196, 'binary_recall': 0.9131546, 'binary_specificity': 0.9610175, 'binary_f1_score': 0.9355729}
confusion matrix:
       0      1
0  24406    990
1   2209  23227
---- Validation: 
scalar performance:
{'acc': 0.8801028, 'precision': 0.56012, 'recall': 0.7735033, 'specificity': 0.7735033, 'f1': 0.57619363, 'auroc': 0.8600557, 'binary_precision': 0.13001825, 'binary_recall': 0.6612529, 'binary_specificity': 0.88575363, 'binary_f1_score': 0.21730843}
confusion matrix:
       0     1
0  14785  1907
1    146   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87533444, 'precision': 0.6664333, 'recall': 0.8348955, 'specificity': 0.8348955, 'f1': 0.7077927, 'auroc': 0.90012324, 'binary_precision': 0.35203782, 'binary_recall': 0.78731835, 'binary_specificity': 0.8824727, 'binary_f1_score': 0.48653063}
confusion matrix:
      0     1
0  8237  1097
1   161   596
early stop counter: 11
val acc:0.880102813243866, best validation acc: 0.9123985171318054, corresponding to test acc:                         0.8756317496299744 / 0.8849470019340515
after epoch: 20,now: 2024-08-07 06:37:26.390064,epoch time: 0:14:56.905927,used: 5:03:13.123402,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_01_34_12_seed_1_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:03:13.123402 at 2024-08-07 06:37:26.390064
persisted model performance metric: 

scalar performance:
{'acc': 0.87563175, 'precision': 0.660057, 'recall': 0.80774415, 'specificity': 0.80774415, 'f1': 0.69856834, 'auroc': 0.8853463, 'binary_precision': 0.344375, 'binary_recall': 0.7278732, 'binary_specificity': 0.88761514, 'binary_f1_score': 0.4675435}
confusion matrix:
      0     1
0  8285  1049
1   206   551
oracle model performance metric: 

scalar performance:
{'acc': 0.884947, 'precision': 0.6732231, 'recall': 0.82249045, 'specificity': 0.82249045, 'f1': 0.7146051, 'auroc': 0.89687335, 'binary_precision': 0.3686606, 'binary_recall': 0.74900925, 'binary_specificity': 0.8959717, 'binary_f1_score': 0.49411765}
confusion matrix:
      0    1
0  8363  971
1   190  567
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |  16648 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    780 MiB | 272384 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     48 MiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  90894 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 384171 GiB | 384171 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6837    |  162968 K  |  162963 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92884 K  |   92880 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6837    |  162968 K  |  162963 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92884 K  |   92880 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      57    |      16    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      24    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3196    |   87551 K  |   87551 K  |
|       from large pool |      10    |      23    |   44070 K  |   44070 K  |
|       from small pool |      20    |    3186    |   43480 K  |   43480 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  90894 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384172 GiB | 384172 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162968 K  |  162968 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162968 K  |  162968 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87553 K  |   87553 K  |
|       from large pool |       3    |      23    |   44070 K  |   44070 K  |
|       from small pool |       0    |    3186    |   43482 K  |   43482 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  90894 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384172 GiB | 384172 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162968 K  |  162968 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162968 K  |  162968 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87553 K  |   87553 K  |
|       from large pool |       3    |      23    |   44070 K  |   44070 K  |
|       from small pool |       0    |    3186    |   43482 K  |   43482 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677

 Experiment start at: 2024-08-07 07:01:16.511934
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.73189414, 'precision': 0.733099, 'recall': 0.73189974, 'specificity': 0.73189974, 'f1': 0.73155034, 'auroc': 0.8079581, 'binary_precision': 0.7498958, 'binary_recall': 0.69600034, 'binary_specificity': 0.7677991, 'binary_f1_score': 0.72194356}
confusion matrix:
       0      1
0  19843   6001
1   7859  17993
---- Validation: 
scalar performance:
{'acc': 0.5799463, 'precision': 0.51338804, 'recall': 0.6377715, 'specificity': 0.6377715, 'f1': 0.40168095, 'auroc': 0.6789263, 'binary_precision': 0.039679304, 'binary_recall': 0.6985646, 'binary_specificity': 0.5769783, 'binary_f1_score': 0.075093225}
confusion matrix:
      0     1
0  9639  7067
1   126   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.540329, 'precision': 0.5557557, 'recall': 0.6913805, 'specificity': 0.6913805, 'f1': 0.45130727, 'auroc': 0.7929145, 'binary_precision': 0.13269599, 'binary_recall': 0.8707654, 'binary_specificity': 0.5119957, 'binary_f1_score': 0.23029701}
confusion matrix:
      0     1
0  4759  4536
1   103   694
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 07:18:57.713834,epoch time: 0:17:41.201900,used: 0:17:41.201900,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8256151, 'precision': 0.8261596, 'recall': 0.82561827, 'specificity': 0.82561827, 'f1': 0.8255433, 'auroc': 0.90276957, 'binary_precision': 0.8395241, 'binary_recall': 0.80519885, 'binary_specificity': 0.84603775, 'binary_f1_score': 0.8220033}
confusion matrix:
       0      1
0  21865   3979
1   5036  20816
---- Validation: 
scalar performance:
{'acc': 0.6571479, 'precision': 0.5192146, 'recall': 0.68433553, 'specificity': 0.68433553, 'f1': 0.44041434, 'auroc': 0.7333844, 'binary_precision': 0.04926434, 'binary_recall': 0.71291864, 'binary_specificity': 0.6557524, 'binary_f1_score': 0.0921602}
confusion matrix:
       0     1
0  10955  5751
1    120   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5950258, 'precision': 0.5653207, 'recall': 0.72336817, 'specificity': 0.72336817, 'f1': 0.48829842, 'auroc': 0.8142421, 'binary_precision': 0.14895433, 'binary_recall': 0.8757842, 'binary_specificity': 0.5709521, 'binary_f1_score': 0.25460514}
confusion matrix:
      0     1
0  5307  3988
1    99   698
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 07:34:19.289059,epoch time: 0:15:21.575225,used: 0:33:02.777125,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.853567, 'precision': 0.8544256, 'recall': 0.8535727, 'specificity': 0.8535727, 'f1': 0.8534796, 'auroc': 0.92970693, 'binary_precision': 0.8719284, 'binary_recall': 0.8289626, 'binary_specificity': 0.8781828, 'binary_f1_score': 0.8499028}
confusion matrix:
       0      1
0  22694   3148
1   4422  21432
---- Validation: 
scalar performance:
{'acc': 0.7264074, 'precision': 0.5240482, 'recall': 0.7046706, 'specificity': 0.7046706, 'f1': 0.47343868, 'auroc': 0.7618568, 'binary_precision': 0.05892082, 'binary_recall': 0.6818182, 'binary_specificity': 0.727523, 'binary_f1_score': 0.10846812}
confusion matrix:
       0     1
0  12154  4552
1    133   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64873165, 'precision': 0.57395905, 'recall': 0.7456409, 'specificity': 0.7456409, 'f1': 0.52341586, 'auroc': 0.8276491, 'binary_precision': 0.16650486, 'binary_recall': 0.8607277, 'binary_specificity': 0.6305541, 'binary_f1_score': 0.2790319}
confusion matrix:
      0     1
0  5861  3434
1   111   686
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 07:49:38.933896,epoch time: 0:15:19.644837,used: 0:48:22.421962,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87078303, 'precision': 0.8710464, 'recall': 0.8707851, 'specificity': 0.8707851, 'f1': 0.87076056, 'auroc': 0.94280434, 'binary_precision': 0.8809713, 'binary_recall': 0.8574578, 'binary_specificity': 0.88411236, 'binary_f1_score': 0.86905557}
confusion matrix:
       0      1
0  22849   2995
1   3685  22167
---- Validation: 
scalar performance:
{'acc': 0.7582341, 'precision': 0.527322, 'recall': 0.71515095, 'specificity': 0.71515095, 'f1': 0.489519, 'auroc': 0.7810148, 'binary_precision': 0.065390006, 'binary_recall': 0.6698565, 'binary_specificity': 0.76044536, 'binary_f1_score': 0.11914894}
confusion matrix:
       0     1
0  12704  4002
1    138   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68192625, 'precision': 0.5805342, 'recall': 0.75907284, 'specificity': 0.75907284, 'f1': 0.54572284, 'auroc': 0.8383148, 'binary_precision': 0.17988856, 'binary_recall': 0.85069007, 'binary_specificity': 0.6674556, 'binary_f1_score': 0.29697767}
confusion matrix:
      0     1
0  6204  3091
1   119   678
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 08:05:09.432291,epoch time: 0:15:30.498395,used: 1:03:52.920357,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88238937, 'precision': 0.8833209, 'recall': 0.8823941, 'specificity': 0.8823941, 'f1': 0.88231874, 'auroc': 0.95235157, 'binary_precision': 0.9022663, 'binary_recall': 0.8577341, 'binary_specificity': 0.9070541, 'binary_f1_score': 0.8794368}
confusion matrix:
       0      1
0  23441   2402
1   3678  22175
---- Validation: 
scalar performance:
{'acc': 0.80623686, 'precision': 0.5330433, 'recall': 0.72225916, 'specificity': 0.72225916, 'f1': 0.5142946, 'auroc': 0.7930003, 'binary_precision': 0.07725947, 'binary_recall': 0.6339713, 'binary_specificity': 0.8105471, 'binary_f1_score': 0.13773389}
confusion matrix:
       0     1
0  13541  3165
1    153   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73335314, 'precision': 0.5912602, 'recall': 0.771505, 'specificity': 0.771505, 'f1': 0.5799335, 'auroc': 0.8456341, 'binary_precision': 0.20369211, 'binary_recall': 0.81681305, 'binary_specificity': 0.7261969, 'binary_f1_score': 0.3260706}
confusion matrix:
      0     1
0  6750  2545
1   146   651
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 08:20:40.317178,epoch time: 0:15:30.884887,used: 1:19:23.805244,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88879216, 'precision': 0.8905496, 'recall': 0.8887961, 'specificity': 0.8887961, 'f1': 0.88866764, 'auroc': 0.9565121, 'binary_precision': 0.91677725, 'binary_recall': 0.8552474, 'binary_specificity': 0.92234474, 'binary_f1_score': 0.884944}
confusion matrix:
       0      1
0  23838   2007
1   3742  22109
---- Validation: 
scalar performance:
{'acc': 0.8241649, 'precision': 0.537131, 'recall': 0.73261374, 'specificity': 0.73261374, 'f1': 0.5260465, 'auroc': 0.80498356, 'binary_precision': 0.08512, 'binary_recall': 0.6363636, 'binary_specificity': 0.82886386, 'binary_f1_score': 0.15015523}
confusion matrix:
       0     1
0  13847  2859
1    152   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75644076, 'precision': 0.59734, 'recall': 0.7760087, 'specificity': 0.7760087, 'f1': 0.59598374, 'auroc': 0.8533648, 'binary_precision': 0.21703577, 'binary_recall': 0.7992472, 'binary_specificity': 0.7527703, 'binary_f1_score': 0.3413719}
confusion matrix:
      0     1
0  6997  2298
1   160   637
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 08:36:02.586913,epoch time: 0:15:22.269735,used: 1:34:46.074979,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9004372, 'precision': 0.9013999, 'recall': 0.90044, 'specificity': 0.90044, 'f1': 0.90037787, 'auroc': 0.9635912, 'binary_precision': 0.9210869, 'binary_recall': 0.8759429, 'binary_specificity': 0.9249371, 'binary_f1_score': 0.89794785}
confusion matrix:
       0      1
0  23905   1940
1   3207  22644
---- Validation: 
scalar performance:
{'acc': 0.82083625, 'precision': 0.5371742, 'recall': 0.73673904, 'specificity': 0.73673904, 'f1': 0.5250007, 'auroc': 0.815932, 'binary_precision': 0.084899746, 'binary_recall': 0.6483254, 'binary_specificity': 0.82515264, 'binary_f1_score': 0.15013851}
confusion matrix:
       0     1
0  13785  2921
1    147   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76010704, 'precision': 0.5995973, 'recall': 0.78086686, 'specificity': 0.78086686, 'f1': 0.59982216, 'auroc': 0.8601321, 'binary_precision': 0.22077028, 'binary_recall': 0.8055207, 'binary_specificity': 0.756213, 'binary_f1_score': 0.3465587}
confusion matrix:
      0     1
0  7029  2266
1   155   642
new oracle model saved
early stop counter: 1
val acc:0.8208362460136414, best validation acc: 0.8241649270057678, corresponding to test acc:                         0.7564407587051392 / 0.7601070404052734
after epoch: 7,now: 2024-08-07 08:51:36.440915,epoch time: 0:15:33.854002,used: 1:50:19.928981,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9030099, 'precision': 0.90430486, 'recall': 0.90301317, 'specificity': 0.90301317, 'f1': 0.90293264, 'auroc': 0.96564186, 'binary_precision': 0.92721534, 'binary_recall': 0.874705, 'binary_specificity': 0.9313213, 'binary_f1_score': 0.90019506}
confusion matrix:
       0      1
0  24070   1775
1   3239  22612
---- Validation: 
scalar performance:
{'acc': 0.83350855, 'precision': 0.5403515, 'recall': 0.7432337, 'specificity': 0.7432337, 'f1': 0.53367037, 'auroc': 0.82389474, 'binary_precision': 0.09109244, 'binary_recall': 0.6483254, 'binary_specificity': 0.838142, 'binary_f1_score': 0.15974066}
confusion matrix:
       0     1
0  14002  2704
1    147   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78220373, 'precision': 0.6084417, 'recall': 0.79056835, 'specificity': 0.79056835, 'f1': 0.617881, 'auroc': 0.8648472, 'binary_precision': 0.23832649, 'binary_recall': 0.8005019, 'binary_specificity': 0.78063476, 'binary_f1_score': 0.36729994}
confusion matrix:
      0     1
0  7256  2039
1   159   638
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-07 09:07:00.535988,epoch time: 0:15:24.095073,used: 2:05:44.024054,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91022515, 'precision': 0.9111523, 'recall': 0.91022885, 'specificity': 0.91022885, 'f1': 0.9101751, 'auroc': 0.96866655, 'binary_precision': 0.9307152, 'binary_recall': 0.8864691, 'binary_specificity': 0.9339886, 'binary_f1_score': 0.9080535}
confusion matrix:
       0      1
0  24138   1706
1   2935  22917
---- Validation: 
scalar performance:
{'acc': 0.8308222, 'precision': 0.5403218, 'recall': 0.7465219, 'specificity': 0.7465219, 'f1': 0.53275186, 'auroc': 0.8307718, 'binary_precision': 0.09078904, 'binary_recall': 0.65789473, 'binary_specificity': 0.83514905, 'binary_f1_score': 0.15955904}
confusion matrix:
       0     1
0  13952  2754
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7850773, 'precision': 0.6099506, 'recall': 0.79270184, 'specificity': 0.79270184, 'f1': 0.62058204, 'auroc': 0.86796224, 'binary_precision': 0.24113208, 'binary_recall': 0.80175656, 'binary_specificity': 0.7836471, 'binary_f1_score': 0.3707572}
confusion matrix:
      0     1
0  7284  2011
1   158   639
new oracle model saved
early stop counter: 1
val acc:0.830822229385376, best validation acc: 0.8335085511207581, corresponding to test acc:                         0.782203733921051 / 0.7850772738456726
after epoch: 9,now: 2024-08-07 09:22:27.205571,epoch time: 0:15:26.669583,used: 2:21:10.693637,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91088283, 'precision': 0.91194, 'recall': 0.91088676, 'specificity': 0.91088676, 'f1': 0.9108262, 'auroc': 0.9696586, 'binary_precision': 0.9328471, 'binary_recall': 0.8855408, 'binary_specificity': 0.9362328, 'binary_f1_score': 0.9085786}
confusion matrix:
       0      1
0  24196   1648
1   2959  22893
---- Validation: 
scalar performance:
{'acc': 0.8405162, 'precision': 0.5431882, 'recall': 0.7526564, 'specificity': 0.7526564, 'f1': 0.5399713, 'auroc': 0.8356948, 'binary_precision': 0.096335076, 'binary_recall': 0.6602871, 'binary_specificity': 0.8450257, 'binary_f1_score': 0.16813889}
confusion matrix:
       0     1
0  14117  2589
1    142   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7951843, 'precision': 0.6136262, 'recall': 0.7936002, 'specificity': 0.7936002, 'f1': 0.62822926, 'auroc': 0.8699393, 'binary_precision': 0.2492101, 'binary_recall': 0.79171896, 'binary_specificity': 0.79548144, 'binary_f1_score': 0.3790928}
confusion matrix:
      0     1
0  7394  1901
1   166   631
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-07 09:37:51.615413,epoch time: 0:15:24.409842,used: 2:36:35.103479,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9174791, 'precision': 0.9184026, 'recall': 0.9174873, 'specificity': 0.9174873, 'f1': 0.91743463, 'auroc': 0.97265494, 'binary_precision': 0.9381468, 'binary_recall': 0.89395523, 'binary_specificity': 0.9410194, 'binary_f1_score': 0.91551805}
confusion matrix:
       0      1
0  24315   1524
1   2742  23115
---- Validation: 
scalar performance:
{'acc': 0.8441953, 'precision': 0.54535466, 'recall': 0.7615394, 'specificity': 0.7615394, 'f1': 0.5442424, 'auroc': 0.8397943, 'binary_precision': 0.10021322, 'binary_recall': 0.67464113, 'binary_specificity': 0.84843767, 'binary_f1_score': 0.17450495}
confusion matrix:
       0     1
0  14174  2532
1    136   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80063415, 'precision': 0.61679566, 'recall': 0.7977059, 'specificity': 0.7977059, 'f1': 0.6336, 'auroc': 0.8722519, 'binary_precision': 0.25513905, 'binary_recall': 0.7942284, 'binary_specificity': 0.8011834, 'binary_f1_score': 0.3862111}
confusion matrix:
      0     1
0  7447  1848
1   164   633
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-07 09:53:16.257244,epoch time: 0:15:24.641831,used: 2:51:59.745310,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91918135, 'precision': 0.9202833, 'recall': 0.9191873, 'specificity': 0.9191873, 'f1': 0.91912913, 'auroc': 0.9732324, 'binary_precision': 0.94186234, 'binary_recall': 0.8935561, 'binary_specificity': 0.9448185, 'binary_f1_score': 0.91707355}
confusion matrix:
       0      1
0  24416   1426
1   2752  23102
---- Validation: 
scalar performance:
{'acc': 0.8479911, 'precision': 0.5469179, 'recall': 0.7658173, 'specificity': 0.7658173, 'f1': 0.5476818, 'auroc': 0.84403, 'binary_precision': 0.10316019, 'binary_recall': 0.67942584, 'binary_specificity': 0.8522088, 'binary_f1_score': 0.1791233}
confusion matrix:
       0     1
0  14237  2469
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8053904, 'precision': 0.61937994, 'recall': 0.80028796, 'specificity': 0.80028796, 'f1': 0.6380538, 'auroc': 0.87405217, 'binary_precision': 0.26017264, 'binary_recall': 0.7942284, 'binary_specificity': 0.8063475, 'binary_f1_score': 0.39195046}
confusion matrix:
      0     1
0  7495  1800
1   164   633
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-07 10:08:37.947692,epoch time: 0:15:21.690448,used: 3:07:21.435758,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9204774, 'precision': 0.9212361, 'recall': 0.9204815, 'specificity': 0.9204815, 'f1': 0.9204421, 'auroc': 0.9747516, 'binary_precision': 0.93916136, 'binary_recall': 0.899238, 'binary_specificity': 0.941725, 'binary_f1_score': 0.91876614}
confusion matrix:
       0      1
0  24337   1506
1   2605  23248
---- Validation: 
scalar performance:
{'acc': 0.83572763, 'precision': 0.5447254, 'recall': 0.77002835, 'specificity': 0.77002835, 'f1': 0.54060876, 'auroc': 0.8479595, 'binary_precision': 0.09828916, 'binary_recall': 0.70095694, 'binary_specificity': 0.8390997, 'binary_f1_score': 0.17240365}
confusion matrix:
       0     1
0  14018  2688
1    125   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.802715, 'precision': 0.6204798, 'recall': 0.8080125, 'specificity': 0.8080125, 'f1': 0.6384016, 'auroc': 0.87702245, 'binary_precision': 0.26043338, 'binary_recall': 0.81430364, 'binary_specificity': 0.80172133, 'binary_f1_score': 0.39464882}
confusion matrix:
      0     1
0  7452  1843
1   148   649
early stop counter: 1
val acc:0.8357276320457458, best validation acc: 0.8479911088943481, corresponding to test acc:                         0.8053904175758362 / 0.8053904175758362
after epoch: 13,now: 2024-08-07 10:24:54.332291,epoch time: 0:16:16.384599,used: 3:23:37.820357,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92494583, 'precision': 0.9264219, 'recall': 0.9249493, 'specificity': 0.9249493, 'f1': 0.9248812, 'auroc': 0.9763012, 'binary_precision': 0.95153934, 'binary_recall': 0.89551663, 'binary_specificity': 0.9543819, 'binary_f1_score': 0.9226784}
confusion matrix:
       0      1
0  24666   1179
1   2701  23150
---- Validation: 
scalar performance:
{'acc': 0.8578019, 'precision': 0.550324, 'recall': 0.7708454, 'specificity': 0.7708454, 'f1': 0.5556059, 'auroc': 0.8502816, 'binary_precision': 0.1098646, 'binary_recall': 0.67942584, 'binary_specificity': 0.86226505, 'binary_f1_score': 0.1891442}
confusion matrix:
       0     1
0  14405  2301
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8249108, 'precision': 0.6303178, 'recall': 0.80801725, 'specificity': 0.80801725, 'f1': 0.6562576, 'auroc': 0.8775302, 'binary_precision': 0.2821204, 'binary_recall': 0.7879548, 'binary_specificity': 0.82807964, 'binary_f1_score': 0.4154813}
confusion matrix:
      0     1
0  7697  1598
1   169   628
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-07 10:42:00.791354,epoch time: 0:17:06.459063,used: 3:40:44.279420,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92842776, 'precision': 0.929326, 'recall': 0.9284313, 'specificity': 0.9284313, 'f1': 0.9283906, 'auroc': 0.97807324, 'binary_precision': 0.94900274, 'binary_recall': 0.9055392, 'binary_specificity': 0.95132333, 'binary_f1_score': 0.9267616}
confusion matrix:
       0      1
0  24586   1258
1   2442  23410
---- Validation: 
scalar performance:
{'acc': 0.8518454, 'precision': 0.54946625, 'recall': 0.77595633, 'specificity': 0.77595633, 'f1': 0.5525493, 'auroc': 0.8530837, 'binary_precision': 0.10773788, 'binary_recall': 0.69617224, 'binary_specificity': 0.8557404, 'binary_f1_score': 0.18659826}
confusion matrix:
       0     1
0  14296  2410
1    127   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82134366, 'precision': 0.6297684, 'recall': 0.81238985, 'specificity': 0.81238985, 'f1': 0.65469015, 'auroc': 0.87861896, 'binary_precision': 0.27977234, 'binary_recall': 0.80175656, 'binary_specificity': 0.82302314, 'binary_f1_score': 0.4148004}
confusion matrix:
      0     1
0  7650  1645
1   158   639
early stop counter: 1
val acc:0.851845383644104, best validation acc: 0.8578019142150879, corresponding to test acc:                         0.8249108195304871 / 0.8249108195304871
after epoch: 15,now: 2024-08-07 10:57:31.909455,epoch time: 0:15:31.118101,used: 3:56:15.397521,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9279248, 'precision': 0.929333, 'recall': 0.9279292, 'specificity': 0.9279292, 'f1': 0.9278661, 'auroc': 0.9783912, 'binary_precision': 0.95395976, 'binary_recall': 0.8992728, 'binary_specificity': 0.95658565, 'binary_f1_score': 0.9258093}
confusion matrix:
       0      1
0  24722   1122
1   2604  23248
---- Validation: 
scalar performance:
{'acc': 0.85996264, 'precision': 0.5522462, 'recall': 0.7789503, 'specificity': 0.7789503, 'f1': 0.5590373, 'auroc': 0.8558381, 'binary_precision': 0.11328125, 'binary_recall': 0.6937799, 'binary_specificity': 0.86412066, 'binary_f1_score': 0.19476159}
confusion matrix:
       0     1
0  14436  2270
1    128   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8269917, 'precision': 0.6323217, 'recall': 0.81144106, 'specificity': 0.81144106, 'f1': 0.6591341, 'auroc': 0.87890196, 'binary_precision': 0.28558517, 'binary_recall': 0.79297364, 'binary_specificity': 0.82990855, 'binary_f1_score': 0.41993353}
confusion matrix:
      0     1
0  7714  1581
1   165   632
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-08-07 11:13:16.704873,epoch time: 0:15:44.795418,used: 4:12:00.192939,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9315421, 'precision': 0.9325268, 'recall': 0.9315458, 'specificity': 0.9315458, 'f1': 0.93150353, 'auroc': 0.97967243, 'binary_precision': 0.9532031, 'binary_recall': 0.90766674, 'binary_specificity': 0.95542485, 'binary_f1_score': 0.92987776}
confusion matrix:
       0      1
0  24692   1152
1   2387  23465
---- Validation: 
scalar performance:
{'acc': 0.8634081, 'precision': 0.55416054, 'recall': 0.78421485, 'specificity': 0.78421485, 'f1': 0.56283414, 'auroc': 0.8571162, 'binary_precision': 0.11687276, 'binary_recall': 0.70095694, 'binary_specificity': 0.86747277, 'binary_f1_score': 0.20034187}
confusion matrix:
       0     1
0  14492  2214
1    125   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8320452, 'precision': 0.63575745, 'recall': 0.81418455, 'specificity': 0.81418455, 'f1': 0.66438395, 'auroc': 0.87961686, 'binary_precision': 0.29232192, 'binary_recall': 0.79297364, 'binary_specificity': 0.8353954, 'binary_f1_score': 0.42717135}
confusion matrix:
      0     1
0  7765  1530
1   165   632
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-08-07 11:29:22.369111,epoch time: 0:16:05.664238,used: 4:28:05.857177,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93142605, 'precision': 0.9324814, 'recall': 0.9314308, 'specificity': 0.9314308, 'f1': 0.9313847, 'auroc': 0.97936463, 'binary_precision': 0.9538944, 'binary_recall': 0.9067033, 'binary_specificity': 0.95615834, 'binary_f1_score': 0.9297004}
confusion matrix:
       0      1
0  24710   1133
1   2412  23441
---- Validation: 
scalar performance:
{'acc': 0.8597874, 'precision': 0.5530996, 'recall': 0.7846917, 'specificity': 0.7846917, 'f1': 0.5602218, 'auroc': 0.8600091, 'binary_precision': 0.11465216, 'binary_recall': 0.70574164, 'binary_specificity': 0.8636418, 'binary_f1_score': 0.19725844}
confusion matrix:
       0     1
0  14428  2278
1    123   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8317479, 'precision': 0.6358638, 'recall': 0.8151703, 'specificity': 0.8151703, 'f1': 0.664447, 'auroc': 0.8808322, 'binary_precision': 0.2923006, 'binary_recall': 0.79548305, 'binary_specificity': 0.83485746, 'binary_f1_score': 0.42751178}
confusion matrix:
      0     1
0  7760  1535
1   163   634
early stop counter: 1
val acc:0.8597874045372009, best validation acc: 0.863408088684082, corresponding to test acc:                         0.8320451974868774 / 0.8320451974868774
after epoch: 18,now: 2024-08-07 11:45:10.340727,epoch time: 0:15:47.971616,used: 4:43:53.828793,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93399876, 'precision': 0.9350977, 'recall': 0.93400556, 'specificity': 0.93400556, 'f1': 0.9339577, 'auroc': 0.9812051, 'binary_precision': 0.9570317, 'binary_recall': 0.90883774, 'binary_specificity': 0.9591734, 'binary_f1_score': 0.9323123}
confusion matrix:
       0      1
0  24786   1055
1   2357  23498
---- Validation: 
scalar performance:
{'acc': 0.8610722, 'precision': 0.5536003, 'recall': 0.7853502, 'specificity': 0.7853502, 'f1': 0.56133133, 'auroc': 0.8613092, 'binary_precision': 0.11564092, 'binary_recall': 0.70574164, 'binary_specificity': 0.8649587, 'binary_f1_score': 0.19872011}
confusion matrix:
       0     1
0  14450  2256
1    123   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.832937, 'precision': 0.6360674, 'recall': 0.8135215, 'specificity': 0.8135215, 'f1': 0.66494566, 'auroc': 0.8801805, 'binary_precision': 0.2931596, 'binary_recall': 0.7904642, 'binary_specificity': 0.8365788, 'binary_f1_score': 0.42769852}
confusion matrix:
      0     1
0  7776  1519
1   167   630
new oracle model saved
early stop counter: 2
val acc:0.8610721826553345, best validation acc: 0.863408088684082, corresponding to test acc:                         0.8320451974868774 / 0.8329370021820068
after epoch: 19,now: 2024-08-07 12:01:08.831157,epoch time: 0:15:58.490430,used: 4:59:52.319223,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9359332, 'precision': 0.9368797, 'recall': 0.93593496, 'specificity': 0.93593496, 'f1': 0.93589866, 'auroc': 0.98130846, 'binary_precision': 0.95723444, 'binary_recall': 0.9126499, 'binary_specificity': 0.95922, 'binary_f1_score': 0.9344107}
confusion matrix:
       0      1
0  24792   1054
1   2258  23592
---- Validation: 
scalar performance:
{'acc': 0.85768515, 'precision': 0.55266196, 'recall': 0.7859467, 'specificity': 0.7859467, 'f1': 0.55895424, 'auroc': 0.86189127, 'binary_precision': 0.11366246, 'binary_recall': 0.7105263, 'binary_specificity': 0.86136717, 'binary_f1_score': 0.19597493}
confusion matrix:
       0     1
0  14390  2316
1    121   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83501786, 'precision': 0.6378533, 'recall': 0.8157983, 'specificity': 0.8157983, 'f1': 0.6675265, 'auroc': 0.8806536, 'binary_precision': 0.29643527, 'binary_recall': 0.79297364, 'binary_specificity': 0.8386229, 'binary_f1_score': 0.43154663}
confusion matrix:
      0     1
0  7795  1500
1   165   632
new oracle model saved
early stop counter: 3
val acc:0.8576851487159729, best validation acc: 0.863408088684082, corresponding to test acc:                         0.8320451974868774 / 0.8350178599357605
after epoch: 20,now: 2024-08-07 12:16:44.907719,epoch time: 0:15:36.076562,used: 5:15:28.395785,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_01_16_seed_2_24076677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:15:28.395785 at 2024-08-07 12:16:44.907719
persisted model performance metric: 

scalar performance:
{'acc': 0.8320452, 'precision': 0.63575745, 'recall': 0.81418455, 'specificity': 0.81418455, 'f1': 0.66438395, 'auroc': 0.87961686, 'binary_precision': 0.29232192, 'binary_recall': 0.79297364, 'binary_specificity': 0.8353954, 'binary_f1_score': 0.42717135}
confusion matrix:
      0     1
0  7765  1530
1   165   632
oracle model performance metric: 

scalar performance:
{'acc': 0.83501786, 'precision': 0.6378533, 'recall': 0.8157983, 'specificity': 0.8157983, 'f1': 0.6675265, 'auroc': 0.8806536, 'binary_precision': 0.29643527, 'binary_recall': 0.79297364, 'binary_specificity': 0.8386229, 'binary_f1_score': 0.43154663}
confusion matrix:
      0     1
0  7795  1500
1   165   632
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  16648 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1066 MiB | 565248 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     58 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  90894 KiB | 611402 GiB | 611402 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 588393 GiB | 588393 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6945    |  246585 K  |  246580 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140323 K  |  140319 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6945    |  246585 K  |  246580 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140323 K  |  140319 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      74    |      33    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3250    |  133395 K  |  133395 K  |
|       from large pool |      10    |      23    |   64619 K  |   64619 K  |
|       from small pool |      20    |    3240    |   68775 K  |   68775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |   1066 MiB |    838 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  28672 KiB |  43008 KiB |     58 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  90894 KiB | 611402 GiB | 611402 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 588393 GiB | 588393 GiB |
|       from small pool |      0 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6945    |  246585 K  |  246585 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140323 K  |  140323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6945    |  246585 K  |  246585 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140323 K  |  140323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      74    |      50    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      14    |      21    |      29    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3250    |  133397 K  |  133397 K  |
|       from large pool |       3    |      23    |   64619 K  |   64619 K  |
|       from small pool |       0    |    3240    |   68777 K  |   68777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 12:33:50 2024]
Finished job 0.
1 of 1 steps (100%) done
