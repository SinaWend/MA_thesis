Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666

 Experiment start at: 2024-08-06 02:34:45.420146
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8621684, 'precision': 0.8705478, 'recall': 0.8622159, 'specificity': 0.8622159, 'f1': 0.8613957, 'auroc': 0.91933787, 'binary_precision': 0.92642826, 'binary_recall': 0.7870107, 'binary_specificity': 0.93742096, 'binary_f1_score': 0.8510475}
confusion matrix:
       0      1
0  23728   1584
1   5398  19946
---- Validation: 
scalar performance:
{'acc': 0.8900035, 'precision': 0.5288586, 'recall': 0.6111311, 'specificity': 0.6111311, 'f1': 0.53205675, 'auroc': 0.75097966, 'binary_precision': 0.076080695, 'binary_recall': 0.3180723, 'binary_specificity': 0.9041898, 'binary_f1_score': 0.1227907}
confusion matrix:
       0     1
0  15128  1603
1    283   132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79493773, 'precision': 0.52558136, 'recall': 0.5509265, 'specificity': 0.5509265, 'f1': 0.5234257, 'auroc': 0.6686175, 'binary_precision': 0.11885246, 'binary_recall': 0.26295337, 'binary_specificity': 0.8388996, 'binary_f1_score': 0.16370969}
confusion matrix:
      0     1
0  7837  1505
1   569   203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 02:56:07.446114,epoch time: 0:21:22.025968,used: 0:21:22.025968,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9070989, 'precision': 0.91433525, 'recall': 0.9071302, 'specificity': 0.9071302, 'f1': 0.9066961, 'auroc': 0.96013033, 'binary_precision': 0.9692105, 'binary_recall': 0.84100235, 'binary_specificity': 0.973258, 'binary_f1_score': 0.9005662}
confusion matrix:
       0      1
0  24639    677
1   4029  21311
---- Validation: 
scalar performance:
{'acc': 0.8776391, 'precision': 0.5381302, 'recall': 0.67059183, 'specificity': 0.67059183, 'f1': 0.54302156, 'auroc': 0.79201937, 'binary_precision': 0.09130646, 'binary_recall': 0.45301205, 'binary_specificity': 0.8881717, 'binary_f1_score': 0.15198061}
confusion matrix:
       0     1
0  14860  1871
1    227   188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77545977, 'precision': 0.5505821, 'recall': 0.6211866, 'specificity': 0.6211866, 'f1': 0.5492386, 'auroc': 0.72565854, 'binary_precision': 0.15571888, 'binary_recall': 0.43911916, 'binary_specificity': 0.8032541, 'binary_f1_score': 0.22990844}
confusion matrix:
      0     1
0  7504  1838
1   433   339
early stop counter: 1
val acc:0.87763911485672, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.7949377298355103
after epoch: 2,now: 2024-08-06 03:14:58.522655,epoch time: 0:18:51.076541,used: 0:40:13.102509,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9198318, 'precision': 0.9261581, 'recall': 0.91987276, 'specificity': 0.91987276, 'f1': 0.9195384, 'auroc': 0.97278136, 'binary_precision': 0.97824913, 'binary_recall': 0.85886765, 'binary_specificity': 0.9808779, 'binary_f1_score': 0.9146795}
confusion matrix:
       0      1
0  24827    484
1   3577  21768
---- Validation: 
scalar performance:
{'acc': 0.84392864, 'precision': 0.5427862, 'recall': 0.74731326, 'specificity': 0.74731326, 'f1': 0.5403869, 'auroc': 0.83006394, 'binary_precision': 0.09581695, 'binary_recall': 0.6457831, 'binary_specificity': 0.84884346, 'binary_f1_score': 0.16687422}
confusion matrix:
       0     1
0  14202  2529
1    147   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7322523, 'precision': 0.56988794, 'recall': 0.7059324, 'specificity': 0.7059324, 'f1': 0.5567632, 'auroc': 0.7664027, 'binary_precision': 0.17494963, 'binary_recall': 0.6748705, 'binary_specificity': 0.7369942, 'binary_f1_score': 0.27786666}
confusion matrix:
      0     1
0  6885  2457
1   251   521
early stop counter: 2
val acc:0.8439286351203918, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.7949377298355103
after epoch: 3,now: 2024-08-06 03:32:44.225302,epoch time: 0:17:45.702647,used: 0:57:58.805156,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.931479, 'precision': 0.9360993, 'recall': 0.93150747, 'specificity': 0.93150747, 'f1': 0.93130016, 'auroc': 0.9781293, 'binary_precision': 0.9811254, 'binary_recall': 0.87996215, 'binary_specificity': 0.98305285, 'binary_f1_score': 0.92779434}
confusion matrix:
       0      1
0  24885    429
1   3042  22300
---- Validation: 
scalar performance:
{'acc': 0.8712819, 'precision': 0.5545703, 'recall': 0.77307856, 'specificity': 0.77307856, 'f1': 0.5656158, 'auroc': 0.8584957, 'binary_precision': 0.11839864, 'binary_recall': 0.6698795, 'binary_specificity': 0.87627757, 'binary_f1_score': 0.20123054}
confusion matrix:
       0     1
0  14661  2070
1    137   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7728891, 'precision': 0.5846736, 'recall': 0.7273356, 'specificity': 0.7273356, 'f1': 0.58783376, 'auroc': 0.8041574, 'binary_precision': 0.20272905, 'binary_recall': 0.6735751, 'binary_specificity': 0.7810961, 'binary_f1_score': 0.3116572}
confusion matrix:
      0     1
0  7297  2045
1   252   520
early stop counter: 3
val acc:0.8712819218635559, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.7949377298355103
after epoch: 4,now: 2024-08-06 03:50:26.411767,epoch time: 0:17:42.186465,used: 1:15:40.991621,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9403427, 'precision': 0.9428239, 'recall': 0.9403634, 'specificity': 0.9403634, 'f1': 0.94026095, 'auroc': 0.980881, 'binary_precision': 0.9761092, 'binary_recall': 0.902849, 'binary_specificity': 0.97787786, 'binary_f1_score': 0.9380509}
confusion matrix:
       0      1
0  24754    560
1   2462  22880
---- Validation: 
scalar performance:
{'acc': 0.84527004, 'precision': 0.5519253, 'recall': 0.8067474, 'specificity': 0.8067474, 'f1': 0.55389977, 'auroc': 0.8752171, 'binary_precision': 0.11064718, 'binary_recall': 0.76626503, 'binary_specificity': 0.8472297, 'binary_f1_score': 0.19337185}
confusion matrix:
       0     1
0  14175  2556
1     97   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74095315, 'precision': 0.5875855, 'recall': 0.76233304, 'specificity': 0.76233304, 'f1': 0.57858145, 'auroc': 0.82280624, 'binary_precision': 0.19843341, 'binary_recall': 0.78756475, 'binary_specificity': 0.73710126, 'binary_f1_score': 0.31699687}
confusion matrix:
      0     1
0  6886  2456
1   164   608
early stop counter: 4
val acc:0.845270037651062, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.7949377298355103
after epoch: 5,now: 2024-08-06 04:08:18.428082,epoch time: 0:17:52.016315,used: 1:33:33.007936,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9448239, 'precision': 0.9466783, 'recall': 0.94484437, 'specificity': 0.94484437, 'f1': 0.9447683, 'auroc': 0.9837526, 'binary_precision': 0.97561693, 'binary_recall': 0.9125237, 'binary_specificity': 0.977165, 'binary_f1_score': 0.9430162}
confusion matrix:
       0      1
0  24734    578
1   2217  23127
---- Validation: 
scalar performance:
{'acc': 0.8578677, 'precision': 0.5571788, 'recall': 0.8179022, 'specificity': 0.8179022, 'f1': 0.56547076, 'auroc': 0.8850366, 'binary_precision': 0.12078019, 'binary_recall': 0.77590364, 'binary_specificity': 0.8599008, 'binary_f1_score': 0.20902304}
confusion matrix:
       0     1
0  14387  2344
1     93   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.770615, 'precision': 0.5969929, 'recall': 0.7718539, 'specificity': 0.7718539, 'f1': 0.60048896, 'auroc': 0.8371092, 'binary_precision': 0.2177243, 'binary_recall': 0.7733161, 'binary_specificity': 0.77039176, 'binary_f1_score': 0.33978373}
confusion matrix:
      0     1
0  7197  2145
1   175   597
early stop counter: 5
val acc:0.8578677177429199, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.7949377298355103
after epoch: 6,now: 2024-08-06 04:25:58.134026,epoch time: 0:17:39.705944,used: 1:51:12.713880,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94831806, 'precision': 0.950263, 'recall': 0.9483337, 'specificity': 0.9483337, 'f1': 0.94826347, 'auroc': 0.9851302, 'binary_precision': 0.9799746, 'binary_recall': 0.9153907, 'binary_specificity': 0.9812767, 'binary_f1_score': 0.9465823}
confusion matrix:
       0      1
0  24842    474
1   2144  23196
---- Validation: 
scalar performance:
{'acc': 0.860084, 'precision': 0.5580604, 'recall': 0.8190378, 'specificity': 0.8190378, 'f1': 0.56743145, 'auroc': 0.8891704, 'binary_precision': 0.12252664, 'binary_recall': 0.77590364, 'binary_specificity': 0.862172, 'binary_f1_score': 0.21163327}
confusion matrix:
       0     1
0  14425  2306
1     93   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77407557, 'precision': 0.59995973, 'recall': 0.7790745, 'specificity': 0.7790745, 'f1': 0.60500497, 'auroc': 0.8441161, 'binary_precision': 0.22238532, 'binary_recall': 0.7849741, 'binary_specificity': 0.7731749, 'binary_f1_score': 0.3465828}
confusion matrix:
      0     1
0  7223  2119
1   166   606
early stop counter: 6
val acc:0.8600839972496033, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.7949377298355103
after epoch: 7,now: 2024-08-06 04:43:41.888468,epoch time: 0:17:43.754442,used: 2:08:56.468322,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.950687, 'precision': 0.9525555, 'recall': 0.9507112, 'specificity': 0.9507112, 'f1': 0.9506378, 'auroc': 0.9869971, 'binary_precision': 0.9818228, 'binary_recall': 0.9184519, 'binary_specificity': 0.9829705, 'binary_f1_score': 0.94908065}
confusion matrix:
       0      1
0  24878    431
1   2067  23280
---- Validation: 
scalar performance:
{'acc': 0.8684825, 'precision': 0.56127733, 'recall': 0.8209913, 'specificity': 0.8209913, 'f1': 0.5746243, 'auroc': 0.8930955, 'binary_precision': 0.12903225, 'binary_recall': 0.7710843, 'binary_specificity': 0.8708983, 'binary_f1_score': 0.22107081}
confusion matrix:
       0     1
0  14571  2160
1     95   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79226816, 'precision': 0.6047684, 'recall': 0.7764454, 'specificity': 0.7764454, 'f1': 0.6168936, 'auroc': 0.84587544, 'binary_precision': 0.23409364, 'binary_recall': 0.757772, 'binary_specificity': 0.7951188, 'binary_f1_score': 0.35768878}
confusion matrix:
      0     1
0  7428  1914
1   187   585
early stop counter: 7
val acc:0.8684824705123901, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.7949377298355103
after epoch: 8,now: 2024-08-06 05:01:27.851223,epoch time: 0:17:45.962755,used: 2:26:42.431077,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95475364, 'precision': 0.9557618, 'recall': 0.95476764, 'specificity': 0.95476764, 'f1': 0.95472956, 'auroc': 0.9879416, 'binary_precision': 0.9773452, 'binary_recall': 0.9311447, 'binary_specificity': 0.9783906, 'binary_f1_score': 0.95368576}
confusion matrix:
       0      1
0  24766    547
1   1745  23598
---- Validation: 
scalar performance:
{'acc': 0.8603756, 'precision': 0.55888784, 'recall': 0.823887, 'specificity': 0.823887, 'f1': 0.5687167, 'auroc': 0.8977872, 'binary_precision': 0.12390726, 'binary_recall': 0.7855422, 'binary_specificity': 0.8622318, 'binary_f1_score': 0.2140512}
confusion matrix:
       0     1
0  14426  2305
1     89   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7928614, 'precision': 0.605734, 'recall': 0.7791431, 'specificity': 0.7791431, 'f1': 0.61817604, 'auroc': 0.8514358, 'binary_precision': 0.2355058, 'binary_recall': 0.76295334, 'binary_specificity': 0.7953329, 'binary_f1_score': 0.35991445}
confusion matrix:
      0     1
0  7430  1912
1   183   589
early stop counter: 8
val acc:0.8603755831718445, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.7949377298355103
after epoch: 9,now: 2024-08-06 05:19:19.565720,epoch time: 0:17:51.714497,used: 2:44:34.145574,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95822805, 'precision': 0.9591806, 'recall': 0.95824075, 'specificity': 0.95824075, 'f1': 0.9582072, 'auroc': 0.98973715, 'binary_precision': 0.98023325, 'binary_recall': 0.93536425, 'binary_specificity': 0.9811172, 'binary_f1_score': 0.9572733}
confusion matrix:
       0      1
0  24836    478
1   1638  23704
---- Validation: 
scalar performance:
{'acc': 0.86877406, 'precision': 0.5630502, 'recall': 0.83171517, 'specificity': 0.83171517, 'f1': 0.5772899, 'auroc': 0.90026337, 'binary_precision': 0.13196951, 'binary_recall': 0.7927711, 'binary_specificity': 0.87065923, 'binary_f1_score': 0.22627234}
confusion matrix:
       0     1
0  14567  2164
1     86   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8117461, 'precision': 0.6113659, 'recall': 0.773918, 'specificity': 0.773918, 'f1': 0.6304533, 'auroc': 0.8518238, 'binary_precision': 0.24933569, 'binary_recall': 0.72927463, 'binary_specificity': 0.8185613, 'binary_f1_score': 0.37161714}
confusion matrix:
      0     1
0  7647  1695
1   209   563
new oracle model saved
early stop counter: 9
val acc:0.8687740564346313, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.8117461204528809
after epoch: 10,now: 2024-08-06 05:37:04.793956,epoch time: 0:17:45.228236,used: 3:02:19.373810,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9611695, 'precision': 0.9617344, 'recall': 0.9611771, 'specificity': 0.9611771, 'f1': 0.96115804, 'auroc': 0.98994744, 'binary_precision': 0.9779941, 'binary_recall': 0.9436047, 'binary_specificity': 0.97874945, 'binary_f1_score': 0.96049166}
confusion matrix:
       0      1
0  24779    538
1   1429  23910
---- Validation: 
scalar performance:
{'acc': 0.8367549, 'precision': 0.5536286, 'recall': 0.83410746, 'specificity': 0.83410746, 'f1': 0.5534483, 'auroc': 0.90507185, 'binary_precision': 0.11223162, 'binary_recall': 0.8313253, 'binary_specificity': 0.8368896, 'binary_f1_score': 0.1977644}
confusion matrix:
       0     1
0  14002  2729
1     70   345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7745699, 'precision': 0.6031505, 'recall': 0.7900368, 'specificity': 0.7900368, 'f1': 0.6086073, 'auroc': 0.860881, 'binary_precision': 0.2264151, 'binary_recall': 0.8082902, 'binary_specificity': 0.77178335, 'binary_f1_score': 0.3537415}
confusion matrix:
      0     1
0  7210  2132
1   148   624
early stop counter: 10
val acc:0.8367549180984497, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.8117461204528809
after epoch: 11,now: 2024-08-06 05:54:47.539397,epoch time: 0:17:42.745441,used: 3:20:02.119251,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9611497, 'precision': 0.96186066, 'recall': 0.96116376, 'specificity': 0.96116376, 'f1': 0.9611356, 'auroc': 0.9912863, 'binary_precision': 0.9801594, 'binary_recall': 0.9414109, 'binary_specificity': 0.9809166, 'binary_f1_score': 0.9603945}
confusion matrix:
       0      1
0  24827    483
1   1485  23861
---- Validation: 
scalar performance:
{'acc': 0.8675493, 'precision': 0.563395, 'recall': 0.8369623, 'specificity': 0.8369623, 'f1': 0.5774275, 'auroc': 0.9080725, 'binary_precision': 0.13232964, 'binary_recall': 0.8048193, 'binary_specificity': 0.8691053, 'binary_f1_score': 0.2272882}
confusion matrix:
       0     1
0  14541  2190
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82193, 'precision': 0.6201995, 'recall': 0.7889371, 'specificity': 0.7889371, 'f1': 0.64352876, 'auroc': 0.86458194, 'binary_precision': 0.26474622, 'binary_recall': 0.75, 'binary_specificity': 0.8278741, 'binary_f1_score': 0.39134845}
confusion matrix:
      0     1
0  7734  1608
1   193   579
new oracle model saved
early stop counter: 11
val acc:0.8675493001937866, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.8219299912452698
after epoch: 12,now: 2024-08-06 06:12:40.817543,epoch time: 0:17:53.278146,used: 3:37:55.397397,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96334094, 'precision': 0.96363235, 'recall': 0.96334743, 'specificity': 0.96334743, 'f1': 0.9633356, 'auroc': 0.99139655, 'binary_precision': 0.9753846, 'binary_recall': 0.95071226, 'binary_specificity': 0.9759826, 'binary_f1_score': 0.9628904}
confusion matrix:
       0      1
0  24707    608
1   1249  24092
---- Validation: 
scalar performance:
{'acc': 0.8462032, 'precision': 0.55727535, 'recall': 0.84247357, 'specificity': 0.84247357, 'f1': 0.5618219, 'auroc': 0.90866435, 'binary_precision': 0.11925977, 'binary_recall': 0.8385542, 'binary_specificity': 0.8463929, 'binary_f1_score': 0.20882088}
confusion matrix:
       0     1
0  14161  2570
1     67   348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8062092, 'precision': 0.6148286, 'recall': 0.7940925, 'specificity': 0.7940925, 'f1': 0.6328347, 'auroc': 0.8674307, 'binary_precision': 0.25167224, 'binary_recall': 0.7797927, 'binary_specificity': 0.8083922, 'binary_f1_score': 0.38053098}
confusion matrix:
      0     1
0  7552  1790
1   170   602
early stop counter: 12
val acc:0.8462032079696655, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.8219299912452698
after epoch: 13,now: 2024-08-06 06:30:20.554414,epoch time: 0:17:39.736871,used: 3:55:35.134268,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96357787, 'precision': 0.9642427, 'recall': 0.96358836, 'specificity': 0.96358836, 'f1': 0.96356535, 'auroc': 0.99159527, 'binary_precision': 0.9819502, 'binary_recall': 0.94455844, 'binary_specificity': 0.98261833, 'binary_f1_score': 0.96289146}
confusion matrix:
       0      1
0  24874    440
1   1405  23937
---- Validation: 
scalar performance:
{'acc': 0.8590925, 'precision': 0.56099, 'recall': 0.8408536, 'specificity': 0.8408536, 'f1': 0.5713456, 'auroc': 0.9109348, 'binary_precision': 0.12709653, 'binary_recall': 0.82168674, 'binary_specificity': 0.86002034, 'binary_f1_score': 0.22014202}
confusion matrix:
       0     1
0  14389  2342
1     74   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8245007, 'precision': 0.62216604, 'recall': 0.7915169, 'specificity': 0.7915169, 'f1': 0.6464936, 'auroc': 0.8692206, 'binary_precision': 0.2683603, 'binary_recall': 0.75259066, 'binary_specificity': 0.83044314, 'binary_f1_score': 0.39564183}
confusion matrix:
      0     1
0  7758  1584
1   191   581
new oracle model saved
early stop counter: 13
val acc:0.8590924739837646, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.8245006799697876
after epoch: 14,now: 2024-08-06 06:47:56.912620,epoch time: 0:17:36.358206,used: 4:13:11.492474,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96488076, 'precision': 0.96543753, 'recall': 0.9648911, 'specificity': 0.9648911, 'f1': 0.9648708, 'auroc': 0.992395, 'binary_precision': 0.9816844, 'binary_recall': 0.94748056, 'binary_specificity': 0.9823016, 'binary_f1_score': 0.96427923}
confusion matrix:
       0      1
0  24865    448
1   1331  24012
---- Validation: 
scalar performance:
{'acc': 0.8724484, 'precision': 0.56623495, 'recall': 0.8429974, 'specificity': 0.8429974, 'f1': 0.5830005, 'auroc': 0.9111513, 'binary_precision': 0.13777596, 'binary_recall': 0.8120482, 'binary_specificity': 0.87394655, 'binary_f1_score': 0.23558196}
confusion matrix:
       0     1
0  14622  2109
1     78   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83883727, 'precision': 0.6278555, 'recall': 0.78442395, 'specificity': 0.78442395, 'f1': 0.656163, 'auroc': 0.8692434, 'binary_precision': 0.2822335, 'binary_recall': 0.7202073, 'binary_specificity': 0.84864056, 'binary_f1_score': 0.4055434}
confusion matrix:
      0     1
0  7928  1414
1   216   556
new oracle model saved
early stop counter: 14
val acc:0.8724483847618103, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.8388372659683228
after epoch: 15,now: 2024-08-06 07:05:41.122200,epoch time: 0:17:44.209580,used: 4:30:55.702054,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9654927, 'precision': 0.96577495, 'recall': 0.96549964, 'specificity': 0.96549964, 'f1': 0.9654879, 'auroc': 0.9922776, 'binary_precision': 0.9773794, 'binary_recall': 0.95308185, 'binary_specificity': 0.9779174, 'binary_f1_score': 0.96507776}
confusion matrix:
       0      1
0  24755    559
1   1189  24153
---- Validation: 
scalar performance:
{'acc': 0.8649831, 'precision': 0.5636699, 'recall': 0.8450468, 'specificity': 0.8450468, 'f1': 0.5770489, 'auroc': 0.9107738, 'binary_precision': 0.13235295, 'binary_recall': 0.8240964, 'binary_specificity': 0.86599725, 'binary_f1_score': 0.22807603}
confusion matrix:
       0     1
0  14489  2242
1     73   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8326083, 'precision': 0.6250695, 'recall': 0.7869935, 'specificity': 0.7869935, 'f1': 0.65171295, 'auroc': 0.86826515, 'binary_precision': 0.2756941, 'binary_recall': 0.7331606, 'binary_specificity': 0.8408264, 'binary_f1_score': 0.40070793}
confusion matrix:
      0     1
0  7855  1487
1   206   566
early stop counter: 15
val acc:0.864983081817627, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.8388372659683228
after epoch: 16,now: 2024-08-06 07:23:30.193752,epoch time: 0:17:49.071552,used: 4:48:44.773606,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9679209, 'precision': 0.96821094, 'recall': 0.9679278, 'specificity': 0.9679278, 'f1': 0.96791625, 'auroc': 0.9929458, 'binary_precision': 0.9800041, 'binary_recall': 0.95537055, 'binary_specificity': 0.9804851, 'binary_f1_score': 0.96753055}
confusion matrix:
       0      1
0  24820    494
1   1131  24211
---- Validation: 
scalar performance:
{'acc': 0.86002564, 'precision': 0.5622402, 'recall': 0.84720635, 'specificity': 0.84720635, 'f1': 0.57344013, 'auroc': 0.91359663, 'binary_precision': 0.12924916, 'binary_recall': 0.8337349, 'binary_specificity': 0.8606778, 'binary_f1_score': 0.22380336}
confusion matrix:
       0     1
0  14400  2331
1     69   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83527786, 'precision': 0.6279513, 'recall': 0.79200345, 'specificity': 0.79200345, 'f1': 0.65573466, 'auroc': 0.87198454, 'binary_precision': 0.28066733, 'binary_recall': 0.74093264, 'binary_specificity': 0.84307426, 'binary_f1_score': 0.40711743}
confusion matrix:
      0     1
0  7876  1466
1   200   572
early stop counter: 16
val acc:0.8600256443023682, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.8388372659683228
after epoch: 17,now: 2024-08-06 07:41:18.206035,epoch time: 0:17:48.012283,used: 5:06:32.785889,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96719044, 'precision': 0.9677936, 'recall': 0.96720046, 'specificity': 0.96720046, 'f1': 0.9671804, 'auroc': 0.99322677, 'binary_precision': 0.9847294, 'binary_recall': 0.94913584, 'binary_specificity': 0.9852651, 'binary_f1_score': 0.966605}
confusion matrix:
       0      1
0  24941    373
1   1289  24053
---- Validation: 
scalar performance:
{'acc': 0.88288814, 'precision': 0.5711403, 'recall': 0.84482193, 'specificity': 0.84482193, 'f1': 0.5930571, 'auroc': 0.9129199, 'binary_precision': 0.14772224, 'binary_recall': 0.8048193, 'binary_specificity': 0.8848246, 'binary_f1_score': 0.24962631}
confusion matrix:
       0     1
0  14804  1927
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85445917, 'precision': 0.6381003, 'recall': 0.7845623, 'specificity': 0.7845623, 'f1': 0.6704023, 'auroc': 0.8716782, 'binary_precision': 0.30381167, 'binary_recall': 0.70207256, 'binary_specificity': 0.867052, 'binary_f1_score': 0.42410022}
confusion matrix:
      0     1
0  8100  1242
1   230   542
new oracle model saved
early stop counter: 17
val acc:0.88288813829422, best validation acc: 0.890003502368927, corresponding to test acc:                         0.7949377298355103 / 0.8544591665267944
after epoch: 18,now: 2024-08-06 07:59:09.134682,epoch time: 0:17:50.928647,used: 5:24:23.714536,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9675458, 'precision': 0.96837604, 'recall': 0.9675558, 'specificity': 0.9675558, 'f1': 0.9675319, 'auroc': 0.9941398, 'binary_precision': 0.9882149, 'binary_recall': 0.94640887, 'binary_specificity': 0.9887028, 'binary_f1_score': 0.96686023}
confusion matrix:
       0      1
0  25030    286
1   1358  23982
---- Validation: 
scalar performance:
{'acc': 0.8981687, 'precision': 0.5802689, 'recall': 0.84912694, 'specificity': 0.84912694, 'f1': 0.610078, 'auroc': 0.9147544, 'binary_precision': 0.16608128, 'binary_recall': 0.7975904, 'binary_specificity': 0.90066344, 'binary_f1_score': 0.27491692}
confusion matrix:
       0     1
0  15069  1662
1     84   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87492585, 'precision': 0.6513423, 'recall': 0.7694988, 'specificity': 0.7694988, 'f1': 0.6850531, 'auroc': 0.8727937, 'binary_precision': 0.33445266, 'binary_recall': 0.6450777, 'binary_specificity': 0.89391994, 'binary_f1_score': 0.44051307}
confusion matrix:
      0    1
0  8351  991
1   274  498
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-08-06 08:16:53.359025,epoch time: 0:17:44.224343,used: 5:42:07.938879,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9714545, 'precision': 0.9716302, 'recall': 0.97146034, 'specificity': 0.97146034, 'f1': 0.9714521, 'auroc': 0.9942162, 'binary_precision': 0.980883, 'binary_recall': 0.96168566, 'binary_specificity': 0.98123497, 'binary_f1_score': 0.9711895}
confusion matrix:
       0      1
0  24838    475
1    971  24372
---- Validation: 
scalar performance:
{'acc': 0.8623002, 'precision': 0.5637229, 'recall': 0.85189664, 'specificity': 0.85189664, 'f1': 0.576293, 'auroc': 0.916976, 'binary_precision': 0.13199697, 'binary_recall': 0.84096384, 'binary_specificity': 0.8628295, 'binary_f1_score': 0.22817914}
confusion matrix:
       0     1
0  14436  2295
1     66   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8471426, 'precision': 0.6372387, 'recall': 0.79961437, 'specificity': 0.79961437, 'f1': 0.6689803, 'auroc': 0.8780587, 'binary_precision': 0.29864725, 'binary_recall': 0.7435233, 'binary_specificity': 0.85570544, 'binary_f1_score': 0.42613217}
confusion matrix:
      0     1
0  7994  1348
1   198   574
early stop counter: 1
val acc:0.8623002171516418, best validation acc: 0.898168683052063, corresponding to test acc:                         0.8749258518218994 / 0.8749258518218994
after epoch: 20,now: 2024-08-06 08:34:51.013884,epoch time: 0:17:57.654859,used: 6:00:05.593738,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:00:05.593738 at 2024-08-06 08:34:51.013884
persisted model performance metric: 

scalar performance:
{'acc': 0.87492585, 'precision': 0.6513423, 'recall': 0.7694988, 'specificity': 0.7694988, 'f1': 0.6850531, 'auroc': 0.8727937, 'binary_precision': 0.33445266, 'binary_recall': 0.6450777, 'binary_specificity': 0.89391994, 'binary_f1_score': 0.44051307}
confusion matrix:
      0    1
0  8351  991
1   274  498
oracle model performance metric: 

scalar performance:
{'acc': 0.87492585, 'precision': 0.6513423, 'recall': 0.7694988, 'specificity': 0.7694988, 'f1': 0.6850531, 'auroc': 0.8727937, 'binary_precision': 0.33445266, 'binary_recall': 0.6450777, 'binary_specificity': 0.89391994, 'binary_f1_score': 0.44051307}
confusion matrix:
      0    1
0  8351  991
1   274  498
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 482684 GiB | 482683 GiB |
|       from small pool |  16663 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59172 KiB | 732464 KiB | 276936 GiB | 276936 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |   8410 KiB |  10961 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6827    |   92213 K  |   92209 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46589 K  |   46584 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6827    |   92213 K  |   92209 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46589 K  |   46584 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3189    |   54235 K  |   54235 K  |
|       from large pool |      10    |     350    |   34657 K  |   34657 K  |
|       from small pool |      23    |    3179    |   19577 K  |   19577 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276936 GiB | 276936 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |      0 KiB |  22549 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92213 K  |   92213 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92213 K  |   92213 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3189    |   54237 K  |   54237 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3179    |   19579 K  |   19579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276936 GiB | 276936 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |      0 KiB |  22549 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92213 K  |   92213 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92213 K  |   92213 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3189    |   54237 K  |   54237 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3179    |   19579 K  |   19579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666

 Experiment start at: 2024-08-06 08:58:12.714164
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.82007396, 'precision': 0.82048935, 'recall': 0.82008946, 'specificity': 0.82008946, 'f1': 0.82002056, 'auroc': 0.8920599, 'binary_precision': 0.8322457, 'binary_recall': 0.8021464, 'binary_specificity': 0.8380326, 'binary_f1_score': 0.8169189}
confusion matrix:
       0      1
0  21281   4113
1   5033  20405
---- Validation: 
scalar performance:
{'acc': 0.8740875, 'precision': 0.50553435, 'recall': 0.5217875, 'specificity': 0.5217875, 'f1': 0.49470428, 'auroc': 0.7291717, 'binary_precision': 0.03504043, 'binary_recall': 0.15081206, 'binary_specificity': 0.892763, 'binary_f1_score': 0.056867886}
confusion matrix:
       0     1
0  14902  1790
1    366    65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7857497, 'precision': 0.4946834, 'recall': 0.4896795, 'specificity': 0.4896795, 'f1': 0.4843238, 'auroc': 0.6431589, 'binary_precision': 0.06609018, 'binary_recall': 0.14134742, 'binary_specificity': 0.83801156, 'binary_f1_score': 0.09006734}
confusion matrix:
      0     1
0  7822  1512
1   650   107
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 09:17:10.332522,epoch time: 0:18:57.618358,used: 0:18:57.618358,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8786591, 'precision': 0.8818593, 'recall': 0.8786969, 'specificity': 0.8786969, 'f1': 0.8784119, 'auroc': 0.9405837, 'binary_precision': 0.9170238, 'binary_recall': 0.8328812, 'binary_specificity': 0.9245127, 'binary_f1_score': 0.8729296}
confusion matrix:
       0      1
0  23478   1917
1   4251  21186
---- Validation: 
scalar performance:
{'acc': 0.894119, 'precision': 0.5169073, 'recall': 0.55692494, 'specificity': 0.55692494, 'f1': 0.51568395, 'auroc': 0.7794858, 'binary_precision': 0.055912595, 'binary_recall': 0.20185615, 'binary_specificity': 0.91199374, 'binary_f1_score': 0.0875692}
confusion matrix:
       0     1
0  15223  1469
1    344    87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.811317, 'precision': 0.5192861, 'recall': 0.5344536, 'specificity': 0.5344536, 'f1': 0.5181704, 'auroc': 0.7176464, 'binary_precision': 0.10799727, 'binary_recall': 0.20871863, 'binary_specificity': 0.86018854, 'binary_f1_score': 0.14234234}
confusion matrix:
      0     1
0  8029  1305
1   599   158
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 09:35:00.652635,epoch time: 0:17:50.320113,used: 0:36:47.938471,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9014007, 'precision': 0.90848124, 'recall': 0.90145254, 'specificity': 0.90145254, 'f1': 0.9009799, 'auroc': 0.9591626, 'binary_precision': 0.96245813, 'binary_recall': 0.83554804, 'binary_specificity': 0.96735704, 'binary_f1_score': 0.8945242}
confusion matrix:
       0      1
0  24567    829
1   4183  21253
---- Validation: 
scalar performance:
{'acc': 0.91333294, 'precision': 0.53092945, 'recall': 0.58599234, 'specificity': 0.58599234, 'f1': 0.53867286, 'auroc': 0.8065027, 'binary_precision': 0.082474224, 'binary_recall': 0.2412993, 'binary_specificity': 0.93068534, 'binary_f1_score': 0.12293143}
confusion matrix:
       0     1
0  15535  1157
1    327   104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84164107, 'precision': 0.54943323, 'recall': 0.57694346, 'specificity': 0.57694346, 'f1': 0.55655545, 'auroc': 0.76787937, 'binary_precision': 0.16170555, 'binary_recall': 0.2655218, 'binary_specificity': 0.8883651, 'binary_f1_score': 0.20099999}
confusion matrix:
      0     1
0  8292  1042
1   556   201
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 09:53:27.981704,epoch time: 0:18:27.329069,used: 0:55:15.267540,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9183782, 'precision': 0.92244583, 'recall': 0.91842073, 'specificity': 0.91842073, 'f1': 0.9181868, 'auroc': 0.97023916, 'binary_precision': 0.964116, 'binary_recall': 0.8692507, 'binary_specificity': 0.96759075, 'binary_f1_score': 0.9142291}
confusion matrix:
       0      1
0  24571    823
1   3326  22112
---- Validation: 
scalar performance:
{'acc': 0.9157274, 'precision': 0.5561224, 'recall': 0.66746026, 'specificity': 0.66746026, 'f1': 0.5753696, 'auroc': 0.8306413, 'binary_precision': 0.12848751, 'binary_recall': 0.40603247, 'binary_specificity': 0.9288881, 'binary_f1_score': 0.19520356}
confusion matrix:
       0     1
0  15505  1187
1    256   175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84263206, 'precision': 0.58655405, 'recall': 0.65759444, 'specificity': 0.65759444, 'f1': 0.6034491, 'auroc': 0.8031086, 'binary_precision': 0.22244489, 'binary_recall': 0.43989432, 'binary_specificity': 0.8752946, 'binary_f1_score': 0.2954747}
confusion matrix:
      0     1
0  8170  1164
1   424   333
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 10:11:34.201459,epoch time: 0:18:06.219755,used: 1:13:21.487295,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9277227, 'precision': 0.9311377, 'recall': 0.9277561, 'specificity': 0.9277561, 'f1': 0.9275831, 'auroc': 0.97671115, 'binary_precision': 0.9696957, 'binary_recall': 0.88315314, 'binary_specificity': 0.97235894, 'binary_f1_score': 0.92440337}
confusion matrix:
       0      1
0  24695    702
1   2972  22463
---- Validation: 
scalar performance:
{'acc': 0.9288092, 'precision': 0.5778516, 'recall': 0.705814, 'specificity': 0.705814, 'f1': 0.6062388, 'auroc': 0.847625, 'binary_precision': 0.17001675, 'binary_recall': 0.4709977, 'binary_specificity': 0.94063026, 'binary_f1_score': 0.24984616}
confusion matrix:
       0    1
0  15701  991
1    228  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8503617, 'precision': 0.60871255, 'recall': 0.7048651, 'specificity': 0.7048651, 'f1': 0.6320244, 'auroc': 0.8272211, 'binary_precision': 0.25880846, 'binary_recall': 0.5336856, 'binary_specificity': 0.8760446, 'binary_f1_score': 0.34857637}
confusion matrix:
      0     1
0  8177  1157
1   353   404
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 10:29:42.864319,epoch time: 0:18:08.662860,used: 1:31:30.150155,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9358082, 'precision': 0.93922436, 'recall': 0.93584645, 'specificity': 0.93584645, 'f1': 0.93568695, 'auroc': 0.98128045, 'binary_precision': 0.9781774, 'binary_recall': 0.89161885, 'binary_specificity': 0.98007405, 'binary_f1_score': 0.93289465}
confusion matrix:
       0      1
0  24888    506
1   2757  22681
---- Validation: 
scalar performance:
{'acc': 0.9346493, 'precision': 0.5915216, 'recall': 0.73028207, 'specificity': 0.73028207, 'f1': 0.62491554, 'auroc': 0.85913956, 'binary_precision': 0.19611308, 'binary_recall': 0.5150812, 'binary_specificity': 0.94548285, 'binary_f1_score': 0.28406912}
confusion matrix:
       0    1
0  15782  910
1    209  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84927166, 'precision': 0.62117463, 'recall': 0.7455474, 'specificity': 0.7455474, 'f1': 0.6485559, 'auroc': 0.8455505, 'binary_precision': 0.2763466, 'binary_recall': 0.6235139, 'binary_specificity': 0.8675809, 'binary_f1_score': 0.38296145}
confusion matrix:
      0     1
0  8098  1236
1   285   472
better model found
persisted
after epoch: 6,now: 2024-08-06 10:47:47.907767,epoch time: 0:18:05.043448,used: 1:49:35.193603,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9444444, 'precision': 0.9458227, 'recall': 0.9444664, 'specificity': 0.9444664, 'f1': 0.9444033, 'auroc': 0.98439145, 'binary_precision': 0.9708087, 'binary_recall': 0.9165356, 'binary_specificity': 0.9723972, 'binary_f1_score': 0.9428918}
confusion matrix:
       0      1
0  24695    701
1   2123  23313
---- Validation: 
scalar performance:
{'acc': 0.9272324, 'precision': 0.59196275, 'recall': 0.76942307, 'specificity': 0.76942307, 'f1': 0.62804437, 'auroc': 0.86852044, 'binary_precision': 0.19475655, 'binary_recall': 0.60324824, 'binary_specificity': 0.9355979, 'binary_f1_score': 0.29445073}
confusion matrix:
       0     1
0  15617  1075
1    171   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84312755, 'precision': 0.62562996, 'recall': 0.7737868, 'specificity': 0.7737868, 'f1': 0.6540667, 'auroc': 0.8588668, 'binary_precision': 0.2796158, 'binary_recall': 0.6922061, 'binary_specificity': 0.8553675, 'binary_f1_score': 0.39832762}
confusion matrix:
      0     1
0  7984  1350
1   233   524
early stop counter: 1
val acc:0.9272323846817017, best validation acc: 0.9346492886543274, corresponding to test acc:                         0.8492716550827026 / 0.850361704826355
after epoch: 7,now: 2024-08-06 11:06:05.521799,epoch time: 0:18:17.614032,used: 2:07:52.807635,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94804454, 'precision': 0.94961405, 'recall': 0.9480691, 'specificity': 0.9480691, 'f1': 0.94800115, 'auroc': 0.986295, 'binary_precision': 0.97638553, 'binary_recall': 0.9183866, 'binary_specificity': 0.97775155, 'binary_f1_score': 0.9464984}
confusion matrix:
       0      1
0  24830    565
1   2076  23361
---- Validation: 
scalar performance:
{'acc': 0.93167084, 'precision': 0.59626997, 'recall': 0.7649188, 'specificity': 0.7649188, 'f1': 0.6334082, 'auroc': 0.86947465, 'binary_precision': 0.20368886, 'binary_recall': 0.58932716, 'binary_specificity': 0.94051045, 'binary_f1_score': 0.30274135}
confusion matrix:
       0    1
0  15699  993
1    177  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.846596, 'precision': 0.6314491, 'recall': 0.78658646, 'specificity': 0.78658646, 'f1': 0.66182446, 'auroc': 0.86665916, 'binary_precision': 0.28906667, 'binary_recall': 0.71598417, 'binary_specificity': 0.85718876, 'binary_f1_score': 0.4118541}
confusion matrix:
      0     1
0  8001  1333
1   215   542
early stop counter: 2
val acc:0.9316708445549011, best validation acc: 0.9346492886543274, corresponding to test acc:                         0.8492716550827026 / 0.850361704826355
after epoch: 8,now: 2024-08-06 11:24:13.289080,epoch time: 0:18:07.767281,used: 2:26:00.574916,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95050365, 'precision': 0.95195335, 'recall': 0.95052487, 'specificity': 0.95052487, 'f1': 0.9504655, 'auroc': 0.98793924, 'binary_precision': 0.97773796, 'binary_recall': 0.92207587, 'binary_specificity': 0.97897387, 'binary_f1_score': 0.94909143}
confusion matrix:
       0      1
0  24863    534
1   1982  23453
---- Validation: 
scalar performance:
{'acc': 0.9356421, 'precision': 0.6021677, 'recall': 0.76695573, 'specificity': 0.76695573, 'f1': 0.64088076, 'auroc': 0.87372226, 'binary_precision': 0.21543682, 'binary_recall': 0.58932716, 'binary_specificity': 0.94458425, 'binary_f1_score': 0.31552795}
confusion matrix:
       0    1
0  15767  925
1    177  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84976715, 'precision': 0.638992, 'recall': 0.80650866, 'specificity': 0.80650866, 'f1': 0.6717777, 'auroc': 0.8761292, 'binary_precision': 0.30057803, 'binary_recall': 0.7556143, 'binary_specificity': 0.85740304, 'binary_f1_score': 0.4300752}
confusion matrix:
      0     1
0  8003  1331
1   185   572
better model found
persisted
after epoch: 9,now: 2024-08-06 11:43:07.378869,epoch time: 0:18:54.089789,used: 2:44:54.664705,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95371026, 'precision': 0.95480865, 'recall': 0.95373166, 'specificity': 0.95373166, 'f1': 0.95368385, 'auroc': 0.9894471, 'binary_precision': 0.97737706, 'binary_recall': 0.92900383, 'binary_specificity': 0.9784595, 'binary_f1_score': 0.95257676}
confusion matrix:
       0      1
0  24847    547
1   1806  23632
---- Validation: 
scalar performance:
{'acc': 0.92658997, 'precision': 0.59547126, 'recall': 0.78830594, 'specificity': 0.78830594, 'f1': 0.633577, 'auroc': 0.87765646, 'binary_precision': 0.20072463, 'binary_recall': 0.64269143, 'binary_specificity': 0.93392044, 'binary_f1_score': 0.30590832}
confusion matrix:
       0     1
0  15589  1103
1    154   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83728075, 'precision': 0.63391787, 'recall': 0.8161464, 'specificity': 0.8161464, 'f1': 0.66357374, 'auroc': 0.8822031, 'binary_precision': 0.287566, 'binary_recall': 0.7912814, 'binary_specificity': 0.84101135, 'binary_f1_score': 0.42183098}
confusion matrix:
      0     1
0  7850  1484
1   158   599
early stop counter: 1
val acc:0.9265899658203125, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 10,now: 2024-08-06 12:01:02.544854,epoch time: 0:17:55.165985,used: 3:02:49.830690,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9558546, 'precision': 0.9565826, 'recall': 0.9558704, 'specificity': 0.9558704, 'f1': 0.9558381, 'auroc': 0.98981786, 'binary_precision': 0.9750123, 'binary_recall': 0.9357603, 'binary_specificity': 0.97598046, 'binary_f1_score': 0.9549832}
confusion matrix:
       0      1
0  24786    610
1   1634  23802
---- Validation: 
scalar performance:
{'acc': 0.93167084, 'precision': 0.6017457, 'recall': 0.7886517, 'specificity': 0.7886517, 'f1': 0.6418981, 'auroc': 0.8792739, 'binary_precision': 0.21334368, 'binary_recall': 0.63805103, 'binary_specificity': 0.9392523, 'binary_f1_score': 0.31976742}
confusion matrix:
       0     1
0  15678  1014
1    156   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84689325, 'precision': 0.64121765, 'recall': 0.82194936, 'specificity': 0.82194936, 'f1': 0.6742769, 'auroc': 0.8855206, 'binary_precision': 0.30181086, 'binary_recall': 0.79260236, 'binary_specificity': 0.85129637, 'binary_f1_score': 0.43715844}
confusion matrix:
      0     1
0  7946  1388
1   157   600
early stop counter: 2
val acc:0.9316708445549011, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 11,now: 2024-08-06 12:19:17.642022,epoch time: 0:18:15.097168,used: 3:21:04.927858,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9562874, 'precision': 0.95751476, 'recall': 0.9563089, 'specificity': 0.9563089, 'f1': 0.9562595, 'auroc': 0.9900043, 'binary_precision': 0.98141927, 'binary_recall': 0.93025905, 'binary_specificity': 0.98235875, 'binary_f1_score': 0.9551546}
confusion matrix:
       0      1
0  24947    448
1   1774  23663
---- Validation: 
scalar performance:
{'acc': 0.93026924, 'precision': 0.60276884, 'recall': 0.8014945, 'specificity': 0.8014945, 'f1': 0.6439487, 'auroc': 0.88155043, 'binary_precision': 0.21465969, 'binary_recall': 0.66589326, 'binary_specificity': 0.93709564, 'binary_f1_score': 0.32466066}
confusion matrix:
       0     1
0  15642  1050
1    144   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8404519, 'precision': 0.6378035, 'recall': 0.8239299, 'specificity': 0.8239299, 'f1': 0.66895956, 'auroc': 0.88838506, 'binary_precision': 0.29406083, 'binary_recall': 0.8044914, 'binary_specificity': 0.84336835, 'binary_f1_score': 0.43069306}
confusion matrix:
      0     1
0  7872  1462
1   148   609
early stop counter: 3
val acc:0.9302692413330078, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 12,now: 2024-08-06 12:37:23.832371,epoch time: 0:18:06.190349,used: 3:39:11.118207,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9590612, 'precision': 0.9598511, 'recall': 0.95907843, 'specificity': 0.95907843, 'f1': 0.9590447, 'auroc': 0.99064445, 'binary_precision': 0.9791171, 'binary_recall': 0.93820024, 'binary_specificity': 0.9799567, 'binary_f1_score': 0.95822203}
confusion matrix:
       0      1
0  24886    509
1   1572  23865
---- Validation: 
scalar performance:
{'acc': 0.93114525, 'precision': 0.60569096, 'recall': 0.80985475, 'specificity': 0.80985475, 'f1': 0.6482335, 'auroc': 0.8842491, 'binary_precision': 0.22005989, 'binary_recall': 0.68213457, 'binary_specificity': 0.93757486, 'binary_f1_score': 0.3327674}
confusion matrix:
       0     1
0  15650  1042
1    137   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8381726, 'precision': 0.6387034, 'recall': 0.8324088, 'specificity': 0.8324088, 'f1': 0.66958886, 'auroc': 0.89265877, 'binary_precision': 0.29397932, 'binary_recall': 0.8256275, 'binary_specificity': 0.83919007, 'binary_f1_score': 0.43357614}
confusion matrix:
      0     1
0  7833  1501
1   132   625
early stop counter: 4
val acc:0.9311452507972717, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 13,now: 2024-08-06 12:55:27.696375,epoch time: 0:18:03.864004,used: 3:57:14.982211,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96155965, 'precision': 0.9618925, 'recall': 0.96157086, 'specificity': 0.96157086, 'f1': 0.96155334, 'auroc': 0.991697, 'binary_precision': 0.9744999, 'binary_recall': 0.94798917, 'binary_specificity': 0.9751526, 'binary_f1_score': 0.9610617}
confusion matrix:
       0      1
0  24764    631
1   1323  24114
---- Validation: 
scalar performance:
{'acc': 0.92454594, 'precision': 0.5977856, 'recall': 0.8098603, 'specificity': 0.8098603, 'f1': 0.6375132, 'auroc': 0.88731766, 'binary_precision': 0.2041237, 'binary_recall': 0.68909514, 'binary_specificity': 0.93062544, 'binary_f1_score': 0.31495228}
confusion matrix:
       0     1
0  15534  1158
1    134   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83678526, 'precision': 0.6388293, 'recall': 0.83590734, 'specificity': 0.83590734, 'f1': 0.66942644, 'auroc': 0.8941746, 'binary_precision': 0.29340762, 'binary_recall': 0.8348745, 'binary_specificity': 0.8369402, 'binary_f1_score': 0.4342151}
confusion matrix:
      0     1
0  7812  1522
1   125   632
early stop counter: 5
val acc:0.92454594373703, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 14,now: 2024-08-06 13:13:35.331138,epoch time: 0:18:07.634763,used: 4:15:22.616974,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9631531, 'precision': 0.96372455, 'recall': 0.96316636, 'specificity': 0.96316636, 'f1': 0.9631425, 'auroc': 0.992532, 'binary_precision': 0.98019075, 'binary_recall': 0.94546884, 'binary_specificity': 0.98086387, 'binary_f1_score': 0.9625167}
confusion matrix:
       0      1
0  24911    486
1   1387  24048
---- Validation: 
scalar performance:
{'acc': 0.917129, 'precision': 0.5913738, 'recall': 0.8150972, 'specificity': 0.8150972, 'f1': 0.6282978, 'auroc': 0.88845146, 'binary_precision': 0.19086358, 'binary_recall': 0.7076566, 'binary_specificity': 0.92253774, 'binary_f1_score': 0.30064067}
confusion matrix:
       0     1
0  15399  1293
1    126   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82429886, 'precision': 0.6326592, 'recall': 0.837048, 'specificity': 0.837048, 'f1': 0.6587933, 'auroc': 0.8941901, 'binary_precision': 0.2797051, 'binary_recall': 0.85204756, 'binary_specificity': 0.8220484, 'binary_f1_score': 0.4211557}
confusion matrix:
      0     1
0  7673  1661
1   112   645
early stop counter: 6
val acc:0.9171289801597595, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 15,now: 2024-08-06 13:31:35.729891,epoch time: 0:18:00.398753,used: 4:33:23.015727,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.962622, 'precision': 0.96314883, 'recall': 0.9626347, 'specificity': 0.9626347, 'f1': 0.9626121, 'auroc': 0.9925903, 'binary_precision': 0.97895724, 'binary_recall': 0.9456261, 'binary_specificity': 0.9796433, 'binary_f1_score': 0.96200305}
confusion matrix:
       0      1
0  24880    517
1   1383  24052
---- Validation: 
scalar performance:
{'acc': 0.9236115, 'precision': 0.5971381, 'recall': 0.8116413, 'specificity': 0.8116413, 'f1': 0.6366504, 'auroc': 0.88873696, 'binary_precision': 0.20271187, 'binary_recall': 0.6937355, 'binary_specificity': 0.9295471, 'binary_f1_score': 0.31374606}
confusion matrix:
       0     1
0  15516  1176
1    132   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8384699, 'precision': 0.6412602, 'recall': 0.8416735, 'specificity': 0.8416735, 'f1': 0.6727451, 'auroc': 0.8970026, 'binary_precision': 0.29725963, 'binary_recall': 0.84544253, 'binary_specificity': 0.83790445, 'binary_f1_score': 0.43986255}
confusion matrix:
      0     1
0  7821  1513
1   117   640
early stop counter: 7
val acc:0.9236115217208862, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 16,now: 2024-08-06 13:49:46.638489,epoch time: 0:18:10.908598,used: 4:51:33.924325,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9643728, 'precision': 0.9648175, 'recall': 0.9643845, 'specificity': 0.9643845, 'f1': 0.9643649, 'auroc': 0.99282813, 'binary_precision': 0.9793831, 'binary_recall': 0.94877136, 'binary_specificity': 0.97999763, 'binary_f1_score': 0.9638342}
confusion matrix:
       0      1
0  24889    508
1   1303  24132
---- Validation: 
scalar performance:
{'acc': 0.9126321, 'precision': 0.58740896, 'recall': 0.81505096, 'specificity': 0.81505096, 'f1': 0.6222216, 'auroc': 0.8901851, 'binary_precision': 0.18284693, 'binary_recall': 0.71229696, 'binary_specificity': 0.91780496, 'binary_f1_score': 0.29099527}
confusion matrix:
       0     1
0  15320  1372
1    124   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83083934, 'precision': 0.6377771, 'recall': 0.84422505, 'specificity': 0.84422505, 'f1': 0.66665083, 'auroc': 0.899124, 'binary_precision': 0.2890764, 'binary_recall': 0.8599736, 'binary_specificity': 0.82847655, 'binary_f1_score': 0.43270192}
confusion matrix:
      0     1
0  7733  1601
1   106   651
early stop counter: 8
val acc:0.9126321077346802, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 17,now: 2024-08-06 14:08:12.108122,epoch time: 0:18:25.469633,used: 5:09:59.393958,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9661827, 'precision': 0.9668052, 'recall': 0.9661965, 'specificity': 0.9661965, 'f1': 0.9661721, 'auroc': 0.99355006, 'binary_precision': 0.9840395, 'binary_recall': 0.9477885, 'binary_specificity': 0.9846045, 'binary_f1_score': 0.96557385}
confusion matrix:
       0      1
0  25006    391
1   1328  24107
---- Validation: 
scalar performance:
{'acc': 0.9118145, 'precision': 0.5862082, 'recall': 0.8123713, 'specificity': 0.8123713, 'f1': 0.6203667, 'auroc': 0.8886272, 'binary_precision': 0.18058023, 'binary_recall': 0.7076566, 'binary_specificity': 0.917086, 'binary_f1_score': 0.28773585}
confusion matrix:
       0     1
0  15308  1384
1    126   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82747, 'precision': 0.63575435, 'recall': 0.84301066, 'specificity': 0.84301066, 'f1': 0.663325, 'auroc': 0.8994561, 'binary_precision': 0.28496504, 'binary_recall': 0.86129457, 'binary_specificity': 0.8247268, 'binary_f1_score': 0.42824304}
confusion matrix:
      0     1
0  7698  1636
1   105   652
early stop counter: 9
val acc:0.9118145108222961, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 18,now: 2024-08-06 14:27:25.212559,epoch time: 0:19:13.104437,used: 5:29:12.498395,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9667139, 'precision': 0.9673656, 'recall': 0.966728, 'specificity': 0.966728, 'f1': 0.96670294, 'auroc': 0.99395597, 'binary_precision': 0.98500633, 'binary_recall': 0.94790643, 'binary_specificity': 0.98554945, 'binary_f1_score': 0.9661003}
confusion matrix:
       0      1
0  25030    367
1   1325  24110
---- Validation: 
scalar performance:
{'acc': 0.91502655, 'precision': 0.589708, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.6257716, 'auroc': 0.88960624, 'binary_precision': 0.18742369, 'binary_recall': 0.71229696, 'binary_specificity': 0.9202612, 'binary_f1_score': 0.29676172}
confusion matrix:
       0     1
0  15361  1331
1    124   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83668613, 'precision': 0.6407883, 'recall': 0.8437439, 'specificity': 0.8437439, 'f1': 0.6717524, 'auroc': 0.9002472, 'binary_precision': 0.2957359, 'binary_recall': 0.85204756, 'binary_specificity': 0.83544034, 'binary_f1_score': 0.4390742}
confusion matrix:
      0     1
0  7798  1536
1   112   645
early stop counter: 10
val acc:0.9150265455245972, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 19,now: 2024-08-06 14:48:21.885493,epoch time: 0:20:56.672934,used: 5:50:09.171329,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9677172, 'precision': 0.9682844, 'recall': 0.96772957, 'specificity': 0.96772957, 'f1': 0.967708, 'auroc': 0.9941431, 'binary_precision': 0.9847602, 'binary_recall': 0.95018476, 'binary_specificity': 0.98527443, 'binary_f1_score': 0.96716356}
confusion matrix:
       0      1
0  25024    374
1   1267  24167
---- Validation: 
scalar performance:
{'acc': 0.9218011, 'precision': 0.59550565, 'recall': 0.812973, 'specificity': 0.812973, 'f1': 0.63435036, 'auroc': 0.8886616, 'binary_precision': 0.19933775, 'binary_recall': 0.6983759, 'binary_specificity': 0.9275701, 'binary_f1_score': 0.3101494}
confusion matrix:
       0     1
0  15483  1209
1    130   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8485779, 'precision': 0.6485932, 'recall': 0.84653044, 'specificity': 0.84653044, 'f1': 0.6837576, 'auroc': 0.9011785, 'binary_precision': 0.31185943, 'binary_recall': 0.8441215, 'binary_specificity': 0.84893936, 'binary_f1_score': 0.4554526}
confusion matrix:
      0     1
0  7924  1410
1   118   639
early stop counter: 11
val acc:0.9218010902404785, best validation acc: 0.9356421232223511, corresponding to test acc:                         0.8497671484947205 / 0.850361704826355
after epoch: 20,now: 2024-08-06 15:09:11.040788,epoch time: 0:20:49.155295,used: 6:10:58.326624,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_58_12_seed_1_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:10:58.326624 at 2024-08-06 15:09:11.040788
persisted model performance metric: 

scalar performance:
{'acc': 0.84976715, 'precision': 0.638992, 'recall': 0.80650866, 'specificity': 0.80650866, 'f1': 0.6717777, 'auroc': 0.8761292, 'binary_precision': 0.30057803, 'binary_recall': 0.7556143, 'binary_specificity': 0.85740304, 'binary_f1_score': 0.4300752}
confusion matrix:
      0     1
0  8003  1331
1   185   572
oracle model performance metric: 

scalar performance:
{'acc': 0.8503617, 'precision': 0.60871255, 'recall': 0.7048651, 'specificity': 0.7048651, 'f1': 0.6320244, 'auroc': 0.8272211, 'binary_precision': 0.25880846, 'binary_recall': 0.5336856, 'binary_specificity': 0.8760446, 'binary_f1_score': 0.34857637}
confusion matrix:
      0     1
0  8177  1157
1   353   404
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |  16662 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8530 MiB |  16792 MiB |   8278 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     40 MiB |     44 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38101 KiB | 732464 KiB | 548715 GiB | 548715 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 533711 GiB | 533711 GiB |
|       from small pool |   6368 KiB |  22549 KiB |  15004 GiB |  15004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6849    |  185256 K  |  185252 K  |
|       from large pool |      79    |     762    |   91848 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93408 K  |   93403 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6849    |  185256 K  |  185252 K  |
|       from large pool |      79    |     762    |   91848 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93408 K  |   93403 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     371    |     716    |     347    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      20    |      22    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3201    |  108226 K  |  108226 K  |
|       from large pool |      11    |     352    |   63923 K  |   63923 K  |
|       from small pool |      24    |    3191    |   44303 K  |   44302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16792 MiB |  16562 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548715 GiB | 548715 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533711 GiB | 533711 GiB |
|       from small pool |      0 KiB |  22549 KiB |  15004 GiB |  15004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185256 K  |  185256 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93408 K  |   93408 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185256 K  |  185256 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93408 K  |   93408 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     716    |     694    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3201    |  108228 K  |  108228 K  |
|       from large pool |       3    |     352    |   63923 K  |   63923 K  |
|       from small pool |       0    |    3191    |   44304 K  |   44304 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16792 MiB |  16562 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548715 GiB | 548715 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533711 GiB | 533711 GiB |
|       from small pool |      0 KiB |  22549 KiB |  15004 GiB |  15004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185256 K  |  185256 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93408 K  |   93408 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185256 K  |  185256 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93408 K  |   93408 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     716    |     694    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3201    |  108228 K  |  108228 K  |
|       from large pool |       3    |     352    |   63923 K  |   63923 K  |
|       from small pool |       0    |    3191    |   44304 K  |   44304 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666

 Experiment start at: 2024-08-06 15:33:20.749296
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86263925, 'precision': 0.8678373, 'recall': 0.8626416, 'specificity': 0.8626416, 'f1': 0.8621529, 'auroc': 0.9277222, 'binary_precision': 0.9115736, 'binary_recall': 0.8032032, 'binary_specificity': 0.9220799, 'binary_f1_score': 0.8539641}
confusion matrix:
       0      1
0  23833   2014
1   5087  20762
---- Validation: 
scalar performance:
{'acc': 0.83940667, 'precision': 0.5210529, 'recall': 0.6156373, 'specificity': 0.6156373, 'f1': 0.5077265, 'auroc': 0.6883544, 'binary_precision': 0.06, 'binary_recall': 0.38038278, 'binary_specificity': 0.8508919, 'binary_f1_score': 0.103650585}
confusion matrix:
       0     1
0  14215  2491
1    259   159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7798256, 'precision': 0.58642524, 'recall': 0.7187294, 'specificity': 0.7187294, 'f1': 0.59274864, 'auroc': 0.77481437, 'binary_precision': 0.20977597, 'binary_recall': 0.6461731, 'binary_specificity': 0.79128563, 'binary_f1_score': 0.31672814}
confusion matrix:
      0     1
0  7355  1940
1   282   515
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 15:53:10.254268,epoch time: 0:19:49.504972,used: 0:19:49.504972,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055633, 'precision': 0.90877426, 'recall': 0.90557706, 'specificity': 0.90557706, 'f1': 0.90537953, 'auroc': 0.96078503, 'binary_precision': 0.94508106, 'binary_recall': 0.86123145, 'binary_specificity': 0.9499226, 'binary_f1_score': 0.90121007}
confusion matrix:
       0      1
0  24546   1294
1   3588  22268
---- Validation: 
scalar performance:
{'acc': 0.8847232, 'precision': 0.5305993, 'recall': 0.6237014, 'specificity': 0.6237014, 'f1': 0.5335696, 'auroc': 0.74166614, 'binary_precision': 0.07900433, 'binary_recall': 0.3492823, 'binary_specificity': 0.89812046, 'binary_f1_score': 0.12886144}
confusion matrix:
       0     1
0  15004  1702
1    272   146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82867616, 'precision': 0.5974686, 'recall': 0.69534934, 'specificity': 0.69534934, 'f1': 0.61644846, 'auroc': 0.7952665, 'binary_precision': 0.2393736, 'binary_recall': 0.5370138, 'binary_specificity': 0.8536848, 'binary_f1_score': 0.33114117}
confusion matrix:
      0     1
0  7935  1360
1   369   428
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 16:12:48.065825,epoch time: 0:19:37.811557,used: 0:39:27.316529,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9208643, 'precision': 0.92464864, 'recall': 0.9208771, 'specificity': 0.9208771, 'f1': 0.9206892, 'auroc': 0.9723089, 'binary_precision': 0.96480435, 'binary_recall': 0.8736415, 'binary_specificity': 0.9681127, 'binary_f1_score': 0.9169627}
confusion matrix:
       0      1
0  25017    824
1   3267  22588
---- Validation: 
scalar performance:
{'acc': 0.90002334, 'precision': 0.53785026, 'recall': 0.63387537, 'specificity': 0.63387537, 'f1': 0.5471543, 'auroc': 0.7703204, 'binary_precision': 0.09308176, 'binary_recall': 0.354067, 'binary_specificity': 0.9136837, 'binary_f1_score': 0.14741036}
confusion matrix:
       0     1
0  15264  1442
1    270   148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85126835, 'precision': 0.60733515, 'recall': 0.6846715, 'specificity': 0.6846715, 'f1': 0.62848866, 'auroc': 0.81030196, 'binary_precision': 0.26216215, 'binary_recall': 0.4868256, 'binary_specificity': 0.88251746, 'binary_f1_score': 0.34079927}
confusion matrix:
      0     1
0  8203  1092
1   409   388
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 16:31:48.263769,epoch time: 0:19:00.197944,used: 0:58:27.514473,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9317936, 'precision': 0.93453604, 'recall': 0.93180275, 'specificity': 0.93180275, 'f1': 0.93168676, 'auroc': 0.9777523, 'binary_precision': 0.9691151, 'binary_recall': 0.89204764, 'binary_specificity': 0.9715579, 'binary_f1_score': 0.9289858}
confusion matrix:
       0      1
0  25107    735
1   2791  23063
---- Validation: 
scalar performance:
{'acc': 0.9017753, 'precision': 0.54882026, 'recall': 0.67675793, 'specificity': 0.67675793, 'f1': 0.5636364, 'auroc': 0.7936745, 'binary_precision': 0.1127451, 'binary_recall': 0.4401914, 'binary_specificity': 0.91332453, 'binary_f1_score': 0.17951219}
confusion matrix:
       0     1
0  15258  1448
1    234   184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8648434, 'precision': 0.62676346, 'recall': 0.7081008, 'specificity': 0.7081008, 'f1': 0.65152115, 'auroc': 0.8309366, 'binary_precision': 0.29735526, 'binary_recall': 0.52195734, 'binary_specificity': 0.8942442, 'binary_f1_score': 0.37887067}
confusion matrix:
      0    1
0  8312  983
1   381  416
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 16:50:07.707597,epoch time: 0:18:19.443828,used: 1:16:46.958301,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93997604, 'precision': 0.9421917, 'recall': 0.93998015, 'specificity': 0.93998015, 'f1': 0.9399011, 'auroc': 0.9825252, 'binary_precision': 0.97352207, 'binary_recall': 0.9045685, 'binary_specificity': 0.97539175, 'binary_f1_score': 0.9377794}
confusion matrix:
       0      1
0  25209    636
1   2467  23384
---- Validation: 
scalar performance:
{'acc': 0.89441717, 'precision': 0.55267507, 'recall': 0.71030664, 'specificity': 0.71030664, 'f1': 0.5681856, 'auroc': 0.80992115, 'binary_precision': 0.118551046, 'binary_recall': 0.5167464, 'binary_specificity': 0.9038669, 'binary_f1_score': 0.19285716}
confusion matrix:
       0     1
0  15100  1606
1    202   216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8692033, 'precision': 0.63773775, 'recall': 0.7288216, 'specificity': 0.7288216, 'f1': 0.66543406, 'auroc': 0.8426068, 'binary_precision': 0.31571528, 'binary_recall': 0.5621079, 'binary_specificity': 0.89553523, 'binary_f1_score': 0.40433213}
confusion matrix:
      0    1
0  8324  971
1   349  448
new oracle model saved
early stop counter: 1
val acc:0.8944171667098999, best validation acc: 0.9017753005027771, corresponding to test acc:                         0.8648434281349182 / 0.8692033290863037
after epoch: 5,now: 2024-08-06 17:09:00.097477,epoch time: 0:18:52.389880,used: 1:35:39.348181,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9428776, 'precision': 0.94510466, 'recall': 0.9428858, 'specificity': 0.9428858, 'f1': 0.9428068, 'auroc': 0.98318005, 'binary_precision': 0.9766474, 'binary_recall': 0.9074805, 'binary_specificity': 0.97829115, 'binary_f1_score': 0.94079435}
confusion matrix:
       0      1
0  25281    561
1   2392  23462
---- Validation: 
scalar performance:
{'acc': 0.9112357, 'precision': 0.56365997, 'recall': 0.7177601, 'specificity': 0.7177601, 'f1': 0.58672553, 'auroc': 0.82124746, 'binary_precision': 0.14033942, 'binary_recall': 0.51435405, 'binary_specificity': 0.92116606, 'binary_f1_score': 0.22051279}
confusion matrix:
       0     1
0  15389  1317
1    203   215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88535476, 'precision': 0.6520165, 'recall': 0.71579444, 'specificity': 0.71579444, 'f1': 0.6756114, 'auroc': 0.85033077, 'binary_precision': 0.34745762, 'binary_recall': 0.5144291, 'binary_specificity': 0.91715974, 'binary_f1_score': 0.41476983}
confusion matrix:
      0    1
0  8525  770
1   387  410
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-06 17:27:44.740010,epoch time: 0:18:44.642533,used: 1:54:23.990714,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9504217, 'precision': 0.95218986, 'recall': 0.95042896, 'specificity': 0.95042896, 'f1': 0.95037377, 'auroc': 0.9873664, 'binary_precision': 0.98052406, 'binary_recall': 0.91912276, 'binary_specificity': 0.98173517, 'binary_f1_score': 0.94883114}
confusion matrix:
       0      1
0  25370    472
1   2091  23763
---- Validation: 
scalar performance:
{'acc': 0.918185, 'precision': 0.5739674, 'recall': 0.73998153, 'specificity': 0.73998153, 'f1': 0.60236317, 'auroc': 0.83325934, 'binary_precision': 0.1598616, 'binary_recall': 0.55263156, 'binary_specificity': 0.9273315, 'binary_f1_score': 0.2479871}
confusion matrix:
       0     1
0  15492  1214
1    187   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8899128, 'precision': 0.6649987, 'recall': 0.7383435, 'specificity': 0.7383435, 'f1': 0.69183826, 'auroc': 0.86193395, 'binary_precision': 0.36960134, 'binary_recall': 0.55834377, 'binary_specificity': 0.9183432, 'binary_f1_score': 0.44477758}
confusion matrix:
      0    1
0  8536  759
1   352  445
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-06 17:46:29.028439,epoch time: 0:18:44.288429,used: 2:13:08.279143,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9537682, 'precision': 0.9552182, 'recall': 0.9537759, 'specificity': 0.9537759, 'f1': 0.9537319, 'auroc': 0.9886831, 'binary_precision': 0.98097813, 'binary_recall': 0.92550766, 'binary_specificity': 0.98204404, 'binary_f1_score': 0.9524359}
confusion matrix:
       0      1
0  25377    464
1   1926  23929
---- Validation: 
scalar performance:
{'acc': 0.92168885, 'precision': 0.57880235, 'recall': 0.74760854, 'specificity': 0.74760854, 'f1': 0.60949886, 'auroc': 0.8376247, 'binary_precision': 0.16917562, 'binary_recall': 0.5645933, 'binary_specificity': 0.9306237, 'binary_f1_score': 0.26034197}
confusion matrix:
       0     1
0  15547  1159
1    182   236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8973444, 'precision': 0.6724709, 'recall': 0.7234504, 'specificity': 0.7234504, 'f1': 0.6932365, 'auroc': 0.86244273, 'binary_precision': 0.3875823, 'binary_recall': 0.5169385, 'binary_specificity': 0.92996234, 'binary_f1_score': 0.44301075}
confusion matrix:
      0    1
0  8644  651
1   385  412
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-06 18:05:14.118884,epoch time: 0:18:45.090445,used: 2:31:53.369588,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9529364, 'precision': 0.9545674, 'recall': 0.9529433, 'specificity': 0.9529433, 'f1': 0.9528946, 'auroc': 0.9886396, 'binary_precision': 0.9818541, 'binary_recall': 0.92295194, 'binary_specificity': 0.9829348, 'binary_f1_score': 0.95149225}
confusion matrix:
       0      1
0  25401    441
1   1992  23862
---- Validation: 
scalar performance:
{'acc': 0.92215604, 'precision': 0.58036315, 'recall': 0.75251293, 'specificity': 0.75251293, 'f1': 0.61182845, 'auroc': 0.8399749, 'binary_precision': 0.17204301, 'binary_recall': 0.57416266, 'binary_specificity': 0.93086314, 'binary_f1_score': 0.26475453}
confusion matrix:
       0     1
0  15551  1155
1    178   240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8999207, 'precision': 0.6770911, 'recall': 0.7237019, 'specificity': 0.7237019, 'f1': 0.69652927, 'auroc': 0.8659818, 'binary_precision': 0.39690223, 'binary_recall': 0.5144291, 'binary_specificity': 0.9329747, 'binary_f1_score': 0.44808742}
confusion matrix:
      0    1
0  8672  623
1   387  410
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-06 18:24:12.569600,epoch time: 0:18:58.450716,used: 2:50:51.820304,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95626354, 'precision': 0.95730597, 'recall': 0.9562654, 'specificity': 0.9562654, 'f1': 0.95623875, 'auroc': 0.9900956, 'binary_precision': 0.97915906, 'binary_recall': 0.9323791, 'binary_specificity': 0.98015165, 'binary_f1_score': 0.95519674}
confusion matrix:
       0      1
0  25333    513
1   1748  24102
---- Validation: 
scalar performance:
{'acc': 0.91993695, 'precision': 0.57989514, 'recall': 0.7595393, 'specificity': 0.7595393, 'f1': 0.6112712, 'auroc': 0.8417809, 'binary_precision': 0.170698, 'binary_recall': 0.59090906, 'binary_specificity': 0.92816955, 'binary_f1_score': 0.26487938}
confusion matrix:
       0     1
0  15506  1200
1    171   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8995244, 'precision': 0.679849, 'recall': 0.7372522, 'specificity': 0.7372522, 'f1': 0.7029038, 'auroc': 0.8691585, 'binary_precision': 0.4, 'binary_recall': 0.544542, 'binary_specificity': 0.92996234, 'binary_f1_score': 0.46121147}
confusion matrix:
      0    1
0  8644  651
1   363  434
early stop counter: 1
val acc:0.9199369549751282, best validation acc: 0.922156035900116, corresponding to test acc:                         0.8999207019805908 / 0.8999207019805908
after epoch: 10,now: 2024-08-06 18:42:45.966195,epoch time: 0:18:33.396595,used: 3:09:25.216899,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95982283, 'precision': 0.9610533, 'recall': 0.9598308, 'specificity': 0.9598308, 'f1': 0.9597965, 'auroc': 0.99114823, 'binary_precision': 0.98494923, 'binary_recall': 0.93394184, 'binary_specificity': 0.9857198, 'binary_f1_score': 0.9587676}
confusion matrix:
       0      1
0  25471    369
1   1708  24148
---- Validation: 
scalar performance:
{'acc': 0.92711985, 'precision': 0.5886665, 'recall': 0.76671934, 'specificity': 0.76671934, 'f1': 0.6238206, 'auroc': 0.8484857, 'binary_precision': 0.18796992, 'binary_recall': 0.5980861, 'binary_specificity': 0.93535256, 'binary_f1_score': 0.28604117}
confusion matrix:
       0     1
0  15626  1080
1    168   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9036861, 'precision': 0.6834976, 'recall': 0.720584, 'specificity': 0.720584, 'f1': 0.69964415, 'auroc': 0.869088, 'binary_precision': 0.41044012, 'binary_recall': 0.50313675, 'binary_specificity': 0.9380312, 'binary_f1_score': 0.45208567}
confusion matrix:
      0    1
0  8719  576
1   396  401
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-06 19:01:16.934926,epoch time: 0:18:30.968731,used: 3:27:56.185630,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96108013, 'precision': 0.9621849, 'recall': 0.9610849, 'specificity': 0.9610849, 'f1': 0.9610572, 'auroc': 0.99190295, 'binary_precision': 0.98482937, 'binary_recall': 0.9366031, 'binary_specificity': 0.9855667, 'binary_f1_score': 0.960111}
confusion matrix:
       0      1
0  25470    373
1   1639  24214
---- Validation: 
scalar performance:
{'acc': 0.92711985, 'precision': 0.58786654, 'recall': 0.7632206, 'specificity': 0.7632206, 'f1': 0.6225946, 'auroc': 0.8504009, 'binary_precision': 0.18655589, 'binary_recall': 0.59090906, 'binary_specificity': 0.93553215, 'binary_f1_score': 0.2835821}
confusion matrix:
       0     1
0  15629  1077
1    171   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9033888, 'precision': 0.68371254, 'recall': 0.72386396, 'specificity': 0.72386396, 'f1': 0.7009996, 'auroc': 0.8697253, 'binary_precision': 0.41028225, 'binary_recall': 0.510665, 'binary_specificity': 0.9370629, 'binary_f1_score': 0.4550028}
confusion matrix:
      0    1
0  8710  585
1   390  407
early stop counter: 1
val acc:0.9271198511123657, best validation acc: 0.9271198511123657, corresponding to test acc:                         0.9036861062049866 / 0.9036861062049866
after epoch: 12,now: 2024-08-06 19:19:40.725875,epoch time: 0:18:23.790949,used: 3:46:19.976579,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9628211, 'precision': 0.9637337, 'recall': 0.9628237, 'specificity': 0.9628237, 'f1': 0.962803, 'auroc': 0.99198353, 'binary_precision': 0.9843339, 'binary_recall': 0.94062126, 'binary_specificity': 0.9850261, 'binary_f1_score': 0.96198124}
confusion matrix:
       0      1
0  25458    387
1   1535  24316
---- Validation: 
scalar performance:
{'acc': 0.9149147, 'precision': 0.5804966, 'recall': 0.7826227, 'specificity': 0.7826227, 'f1': 0.61225003, 'auroc': 0.85692704, 'binary_precision': 0.17057705, 'binary_recall': 0.6435407, 'binary_specificity': 0.92170477, 'binary_f1_score': 0.26967418}
confusion matrix:
       0     1
0  15398  1308
1    149   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9015061, 'precision': 0.68752456, 'recall': 0.75496125, 'specificity': 0.75496125, 'f1': 0.7139339, 'auroc': 0.8736647, 'binary_precision': 0.41228852, 'binary_recall': 0.5809285, 'binary_specificity': 0.92899406, 'binary_f1_score': 0.4822917}
confusion matrix:
      0    1
0  8635  660
1   334  463
early stop counter: 2
val acc:0.9149147272109985, best validation acc: 0.9271198511123657, corresponding to test acc:                         0.9036861062049866 / 0.9036861062049866
after epoch: 13,now: 2024-08-06 19:38:04.188211,epoch time: 0:18:23.462336,used: 4:04:43.438915,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96398175, 'precision': 0.9644364, 'recall': 0.96398604, 'specificity': 0.96398604, 'f1': 0.96397316, 'auroc': 0.9924344, 'binary_precision': 0.97903603, 'binary_recall': 0.94828856, 'binary_specificity': 0.97968346, 'binary_f1_score': 0.96341705}
confusion matrix:
       0      1
0  25316    525
1   1337  24518
---- Validation: 
scalar performance:
{'acc': 0.9249591, 'precision': 0.5881932, 'recall': 0.7749419, 'specificity': 0.7749419, 'f1': 0.6234522, 'auroc': 0.8588124, 'binary_precision': 0.18655097, 'binary_recall': 0.6172249, 'binary_specificity': 0.9326589, 'binary_f1_score': 0.2865075}
confusion matrix:
       0     1
0  15581  1125
1    160   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9042806, 'precision': 0.68561196, 'recall': 0.72434807, 'specificity': 0.72434807, 'f1': 0.70240736, 'auroc': 0.8735684, 'binary_precision': 0.41403866, 'binary_recall': 0.510665, 'binary_specificity': 0.9380312, 'binary_f1_score': 0.45730338}
confusion matrix:
      0    1
0  8719  576
1   390  407
new oracle model saved
early stop counter: 3
val acc:0.924959123134613, best validation acc: 0.9271198511123657, corresponding to test acc:                         0.9036861062049866 / 0.9042806029319763
after epoch: 14,now: 2024-08-06 19:56:33.142601,epoch time: 0:18:28.954390,used: 4:23:12.393305,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96657383, 'precision': 0.9670372, 'recall': 0.9665762, 'specificity': 0.9665762, 'f1': 0.9665656, 'auroc': 0.9935812, 'binary_precision': 0.98178625, 'binary_recall': 0.95079684, 'binary_specificity': 0.98235565, 'binary_f1_score': 0.96604306}
confusion matrix:
       0      1
0  25388    456
1   1272  24580
---- Validation: 
scalar performance:
{'acc': 0.90697265, 'precision': 0.57483745, 'recall': 0.78438354, 'specificity': 0.78438354, 'f1': 0.6031699, 'auroc': 0.8589016, 'binary_precision': 0.15902495, 'binary_recall': 0.6555024, 'binary_specificity': 0.9132647, 'binary_f1_score': 0.25595516}
confusion matrix:
       0     1
0  15257  1449
1    144   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9009116, 'precision': 0.6879734, 'recall': 0.7615212, 'specificity': 0.7615212, 'f1': 0.7161685, 'auroc': 0.8794397, 'binary_precision': 0.41196877, 'binary_recall': 0.59598494, 'binary_specificity': 0.92705756, 'binary_f1_score': 0.48717952}
confusion matrix:
      0    1
0  8617  678
1   322  475
early stop counter: 4
val acc:0.9069726467132568, best validation acc: 0.9271198511123657, corresponding to test acc:                         0.9036861062049866 / 0.9042806029319763
after epoch: 15,now: 2024-08-06 20:15:37.323175,epoch time: 0:19:04.180574,used: 4:42:16.573879,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96583873, 'precision': 0.9665129, 'recall': 0.96584094, 'specificity': 0.96584094, 'f1': 0.9658265, 'auroc': 0.9934615, 'binary_precision': 0.98427635, 'binary_recall': 0.94681054, 'binary_specificity': 0.9848713, 'binary_f1_score': 0.96518}
confusion matrix:
       0      1
0  25454    391
1   1375  24476
---- Validation: 
scalar performance:
{'acc': 0.9227984, 'precision': 0.58827364, 'recall': 0.78549695, 'specificity': 0.78549695, 'f1': 0.62383366, 'auroc': 0.86222386, 'binary_precision': 0.18611111, 'binary_recall': 0.6411483, 'binary_specificity': 0.9298456, 'binary_f1_score': 0.28848225}
confusion matrix:
       0     1
0  15534  1172
1    150   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9061633, 'precision': 0.693651, 'recall': 0.7431505, 'specificity': 0.7431505, 'f1': 0.7144749, 'auroc': 0.87893414, 'binary_precision': 0.4269006, 'binary_recall': 0.54956084, 'binary_specificity': 0.93674016, 'binary_f1_score': 0.4805266}
confusion matrix:
      0    1
0  8707  588
1   359  438
new oracle model saved
early stop counter: 5
val acc:0.9227983951568604, best validation acc: 0.9271198511123657, corresponding to test acc:                         0.9036861062049866 / 0.9061632752418518
after epoch: 16,now: 2024-08-06 20:34:14.635185,epoch time: 0:18:37.312010,used: 5:00:53.885889,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96752167, 'precision': 0.9681104, 'recall': 0.9675251, 'specificity': 0.9675251, 'f1': 0.9675116, 'auroc': 0.9937246, 'binary_precision': 0.98475975, 'binary_recall': 0.94975436, 'binary_specificity': 0.98529583, 'binary_f1_score': 0.96694034}
confusion matrix:
       0      1
0  25463    380
1   1299  24554
---- Validation: 
scalar performance:
{'acc': 0.9205793, 'precision': 0.5858695, 'recall': 0.78435963, 'specificity': 0.78435963, 'f1': 0.6203314, 'auroc': 0.8629633, 'binary_precision': 0.18132612, 'binary_recall': 0.6411483, 'binary_specificity': 0.92757094, 'binary_f1_score': 0.28270042}
confusion matrix:
       0     1
0  15496  1210
1    150   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.905866, 'precision': 0.69566953, 'recall': 0.7556075, 'specificity': 0.7556075, 'f1': 0.72005284, 'auroc': 0.8816011, 'binary_precision': 0.42870456, 'binary_recall': 0.57716435, 'binary_specificity': 0.93405056, 'binary_f1_score': 0.49197862}
confusion matrix:
      0    1
0  8682  613
1   337  460
early stop counter: 6
val acc:0.9205793142318726, best validation acc: 0.9271198511123657, corresponding to test acc:                         0.9036861062049866 / 0.9061632752418518
after epoch: 17,now: 2024-08-06 20:52:31.293231,epoch time: 0:18:16.658046,used: 5:19:10.543935,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9692626, 'precision': 0.96964777, 'recall': 0.96926594, 'specificity': 0.96926594, 'f1': 0.9692565, 'auroc': 0.9944064, 'binary_precision': 0.9831548, 'binary_recall': 0.9549006, 'binary_specificity': 0.9836313, 'binary_f1_score': 0.96882176}
confusion matrix:
       0      1
0  25419    423
1   1166  24688
---- Validation: 
scalar performance:
{'acc': 0.90936697, 'precision': 0.5781728, 'recall': 0.79260814, 'specificity': 0.79260814, 'f1': 0.60842836, 'auroc': 0.8674476, 'binary_precision': 0.16528925, 'binary_recall': 0.6698565, 'binary_specificity': 0.91535974, 'binary_f1_score': 0.26515153}
confusion matrix:
       0     1
0  15292  1414
1    138   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90239793, 'precision': 0.68856907, 'recall': 0.7525776, 'specificity': 0.7525776, 'f1': 0.7139882, 'auroc': 0.8806547, 'binary_precision': 0.41485506, 'binary_recall': 0.57465494, 'binary_specificity': 0.93050027, 'binary_f1_score': 0.48185164}
confusion matrix:
      0    1
0  8649  646
1   339  458
early stop counter: 7
val acc:0.9093669652938843, best validation acc: 0.9271198511123657, corresponding to test acc:                         0.9036861062049866 / 0.9061632752418518
after epoch: 18,now: 2024-08-06 21:11:22.068533,epoch time: 0:18:50.775302,used: 5:38:01.319237,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9698042, 'precision': 0.9701935, 'recall': 0.96980816, 'specificity': 0.96980816, 'f1': 0.9697982, 'auroc': 0.9944252, 'binary_precision': 0.98379004, 'binary_recall': 0.9553665, 'binary_specificity': 0.98424983, 'binary_f1_score': 0.96936995}
confusion matrix:
       0      1
0  25434    407
1   1154  24701
---- Validation: 
scalar performance:
{'acc': 0.9197617, 'precision': 0.5840255, 'recall': 0.77927566, 'specificity': 0.77927566, 'f1': 0.6175622, 'auroc': 0.86626625, 'binary_precision': 0.17789757, 'binary_recall': 0.6315789, 'binary_specificity': 0.9269723, 'binary_f1_score': 0.27760252}
confusion matrix:
       0     1
0  15486  1220
1    154   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9042806, 'precision': 0.69036645, 'recall': 0.74499625, 'specificity': 0.74499625, 'f1': 0.71285343, 'auroc': 0.8812064, 'binary_precision': 0.41990522, 'binary_recall': 0.55583435, 'binary_specificity': 0.93415815, 'binary_f1_score': 0.4784017}
confusion matrix:
      0    1
0  8683  612
1   354  443
early stop counter: 8
val acc:0.9197617173194885, best validation acc: 0.9271198511123657, corresponding to test acc:                         0.9036861062049866 / 0.9061632752418518
after epoch: 19,now: 2024-08-06 21:31:38.462428,epoch time: 0:20:16.393895,used: 5:58:17.713132,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9695141, 'precision': 0.96985835, 'recall': 0.96951675, 'specificity': 0.96951675, 'f1': 0.96950865, 'auroc': 0.9947158, 'binary_precision': 0.98262495, 'binary_recall': 0.9559432, 'binary_specificity': 0.9830902, 'binary_f1_score': 0.96910053}
confusion matrix:
       0      1
0  25406    437
1   1139  24714
---- Validation: 
scalar performance:
{'acc': 0.9166667, 'precision': 0.58288425, 'recall': 0.7870193, 'specificity': 0.7870193, 'f1': 0.6158955, 'auroc': 0.86958736, 'binary_precision': 0.17514488, 'binary_recall': 0.6507177, 'binary_specificity': 0.92332095, 'binary_f1_score': 0.27600205}
confusion matrix:
       0     1
0  15425  1281
1    146   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9034879, 'precision': 0.69067967, 'recall': 0.7531693, 'specificity': 0.7531693, 'f1': 0.7157073, 'auroc': 0.88313055, 'binary_precision': 0.4190302, 'binary_recall': 0.57465494, 'binary_specificity': 0.9316837, 'binary_f1_score': 0.4846561}
confusion matrix:
      0    1
0  8660  635
1   339  458
early stop counter: 9
val acc:0.9166666865348816, best validation acc: 0.9271198511123657, corresponding to test acc:                         0.9036861062049866 / 0.9061632752418518
after epoch: 20,now: 2024-08-06 21:52:18.476533,epoch time: 0:20:40.014105,used: 6:18:57.727237,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_20_seed_2_24076666
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:18:57.727237 at 2024-08-06 21:52:18.476533
persisted model performance metric: 

scalar performance:
{'acc': 0.9036861, 'precision': 0.6834976, 'recall': 0.720584, 'specificity': 0.720584, 'f1': 0.69964415, 'auroc': 0.869088, 'binary_precision': 0.41044012, 'binary_recall': 0.50313675, 'binary_specificity': 0.9380312, 'binary_f1_score': 0.45208567}
confusion matrix:
      0    1
0  8719  576
1   396  401
oracle model performance metric: 

scalar performance:
{'acc': 0.9061633, 'precision': 0.693651, 'recall': 0.7431505, 'specificity': 0.7431505, 'f1': 0.7144749, 'auroc': 0.87893414, 'binary_precision': 0.4269006, 'binary_recall': 0.54956084, 'binary_specificity': 0.93674016, 'binary_f1_score': 0.4805266}
confusion matrix:
      0    1
0  8707  588
1   359  438
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  16662 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25074 MiB |  16562 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     72 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40149 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |   8416 KiB |  22549 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6957    |  280987 K  |  280983 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141131 K  |  141126 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6957    |  280987 K  |  280983 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141131 K  |  141126 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1062    |     694    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      19    |      22    |      36    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3255    |  158803 K  |  158803 K  |
|       from large pool |      11    |     352    |   94473 K  |   94473 K  |
|       from small pool |      24    |    3245    |   64330 K  |   64330 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25074 MiB |  24842 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  26624 KiB |     44 MiB |     72 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |  22555 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  280987 K  |  280987 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141131 K  |  141131 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  280987 K  |  280987 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141131 K  |  141131 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1062    |    1039    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      13    |      22    |      36    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3255    |  158805 K  |  158805 K  |
|       from large pool |       3    |     352    |   94473 K  |   94473 K  |
|       from small pool |       0    |    3245    |   64332 K  |   64332 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug  6 22:12:07 2024]
Finished job 0.
1 of 1 steps (100%) done
