Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675

 Experiment start at: 2024-08-06 02:34:45.405358
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9911165, 'precision': 0.9911198, 'recall': 0.99111724, 'specificity': 0.99111724, 'f1': 0.9911165, 'auroc': 0.9994841, 'binary_precision': 0.99252045, 'binary_recall': 0.9897005, 'binary_specificity': 0.99253404, 'binary_f1_score': 0.9911085}
confusion matrix:
       0      1
0  25126    189
1    261  25080
---- Validation: 
scalar performance:
{'acc': 0.93858624, 'precision': 0.6289456, 'recall': 0.89333564, 'specificity': 0.89333564, 'f1': 0.6838184, 'auroc': 0.9410938, 'binary_precision': 0.2619403, 'binary_recall': 0.8457831, 'binary_specificity': 0.94088817, 'binary_f1_score': 0.39999998}
confusion matrix:
       0    1
0  15742  989
1     64  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87631005, 'precision': 0.68100244, 'recall': 0.8861067, 'specificity': 0.8861067, 'f1': 0.7272407, 'auroc': 0.9255159, 'binary_precision': 0.37158176, 'binary_recall': 0.8976684, 'binary_specificity': 0.87454504, 'binary_f1_score': 0.5255973}
confusion matrix:
      0     1
0  8170  1172
1    79   693
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 03:01:32.120419,epoch time: 0:26:46.715061,used: 0:26:46.715061,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9919654, 'precision': 0.9919788, 'recall': 0.991964, 'specificity': 0.991964, 'f1': 0.99196535, 'auroc': 0.9996362, 'binary_precision': 0.98955554, 'binary_recall': 0.9944363, 'binary_specificity': 0.9894916, 'binary_f1_score': 0.9919899}
confusion matrix:
       0      1
0  25047    266
1    141  25202
---- Validation: 
scalar performance:
{'acc': 0.95503324, 'precision': 0.6653901, 'recall': 0.9111626, 'specificity': 0.9111626, 'f1': 0.72934943, 'auroc': 0.9558843, 'binary_precision': 0.33426443, 'binary_recall': 0.86506027, 'binary_specificity': 0.95726496, 'binary_f1_score': 0.48220283}
confusion matrix:
       0    1
0  16016  715
1     56  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8814514, 'precision': 0.6849897, 'recall': 0.88235426, 'specificity': 0.88235426, 'f1': 0.73215723, 'auroc': 0.9188115, 'binary_precision': 0.38079286, 'binary_recall': 0.8834197, 'binary_specificity': 0.8812888, 'binary_f1_score': 0.53218883}
confusion matrix:
      0     1
0  8233  1109
1    90   682
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 03:31:14.902719,epoch time: 0:29:42.782300,used: 0:56:29.497361,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9930512, 'precision': 0.99310637, 'recall': 0.9930546, 'specificity': 0.9930546, 'f1': 0.99305105, 'auroc': 0.99968123, 'binary_precision': 0.99848413, 'binary_recall': 0.98761046, 'binary_specificity': 0.99849874, 'binary_f1_score': 0.99301755}
confusion matrix:
       0      1
0  25274     38
1    314  25030
---- Validation: 
scalar performance:
{'acc': 0.9648315, 'precision': 0.69477254, 'recall': 0.9032589, 'specificity': 0.9032589, 'f1': 0.7587601, 'auroc': 0.960001, 'binary_precision': 0.39366516, 'binary_recall': 0.8385542, 'binary_specificity': 0.96796364, 'binary_f1_score': 0.53579676}
confusion matrix:
       0    1
0  16195  536
1     67  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8502076, 'precision': 0.65403587, 'recall': 0.8565292, 'specificity': 0.8565292, 'f1': 0.6905301, 'auroc': 0.9002299, 'binary_precision': 0.32113627, 'binary_recall': 0.86398965, 'binary_specificity': 0.8490687, 'binary_f1_score': 0.46823445}
confusion matrix:
      0     1
0  7932  1410
1   105   667
better model found
persisted
after epoch: 3,now: 2024-08-06 03:59:04.713053,epoch time: 0:27:49.810334,used: 1:24:19.307695,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9911165, 'precision': 0.9912007, 'recall': 0.99112105, 'specificity': 0.99112105, 'f1': 0.99111617, 'auroc': 0.9995265, 'binary_precision': 0.99780047, 'binary_recall': 0.98441505, 'binary_specificity': 0.99782705, 'binary_f1_score': 0.9910626}
confusion matrix:
       0      1
0  25256     55
1    395  24950
---- Validation: 
scalar performance:
{'acc': 0.9650064, 'precision': 0.64497095, 'recall': 0.6660118, 'specificity': 0.6660118, 'f1': 0.6546951, 'auroc': 0.86743814, 'binary_precision': 0.30607966, 'binary_recall': 0.35180724, 'binary_specificity': 0.9802164, 'binary_f1_score': 0.32735428}
confusion matrix:
       0    1
0  16400  331
1    269  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.909037, 'precision': 0.69525176, 'recall': 0.75112677, 'specificity': 0.75112677, 'f1': 0.71835244, 'auroc': 0.8853055, 'binary_precision': 0.42745098, 'binary_recall': 0.5647668, 'binary_specificity': 0.93748665, 'binary_f1_score': 0.48660716}
confusion matrix:
      0    1
0  8758  584
1   336  436
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 04:26:45.129529,epoch time: 0:27:40.416476,used: 1:51:59.724171,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99255764, 'precision': 0.99264777, 'recall': 0.9925623, 'specificity': 0.9925623, 'f1': 0.9925573, 'auroc': 0.9996608, 'binary_precision': 0.9994799, 'binary_recall': 0.9856382, 'binary_specificity': 0.9994864, 'binary_f1_score': 0.99251074}
confusion matrix:
       0      1
0  25298     13
1    364  24981
---- Validation: 
scalar performance:
{'acc': 0.9698472, 'precision': 0.6267367, 'recall': 0.5697977, 'specificity': 0.5697977, 'f1': 0.58904207, 'auroc': 0.91841894, 'binary_precision': 0.27433628, 'binary_recall': 0.1493976, 'binary_specificity': 0.99019784, 'binary_f1_score': 0.19344774}
confusion matrix:
       0    1
0  16567  164
1    353   62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9224837, 'precision': 0.7223133, 'recall': 0.6972086, 'specificity': 0.6972086, 'f1': 0.7087797, 'auroc': 0.89093447, 'binary_precision': 0.49115044, 'binary_recall': 0.43134716, 'binary_specificity': 0.96307003, 'binary_f1_score': 0.45931035}
confusion matrix:
      0    1
0  8997  345
1   439  333
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 04:54:28.013642,epoch time: 0:27:42.884113,used: 2:19:42.608284,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9880962, 'precision': 0.9881784, 'recall': 0.9880922, 'specificity': 0.9880922, 'f1': 0.98809564, 'auroc': 0.99935377, 'binary_precision': 0.98199886, 'binary_recall': 0.99443656, 'binary_specificity': 0.9817478, 'binary_f1_score': 0.98817855}
confusion matrix:
       0      1
0  24850    462
1    141  25203
---- Validation: 
scalar performance:
{'acc': 0.9533419, 'precision': 0.65463114, 'recall': 0.87269807, 'specificity': 0.87269807, 'f1': 0.7127158, 'auroc': 0.93122494, 'binary_precision': 0.3147257, 'binary_recall': 0.7879518, 'binary_specificity': 0.95744425, 'binary_f1_score': 0.44979364}
confusion matrix:
       0    1
0  16019  712
1     88  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5248171, 'precision': 0.5594717, 'recall': 0.70950234, 'specificity': 0.70950234, 'f1': 0.44301483, 'auroc': 0.8829115, 'binary_precision': 0.13099158, 'binary_recall': 0.92746115, 'binary_specificity': 0.49154356, 'binary_f1_score': 0.22956075}
confusion matrix:
      0     1
0  4592  4750
1    56   716
early stop counter: 1
val acc:0.9533419013023376, best validation acc: 0.9698472023010254, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 6,now: 2024-08-06 05:22:19.759556,epoch time: 0:27:51.745914,used: 2:47:34.354198,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99666375, 'precision': 0.99667037, 'recall': 0.9966651, 'specificity': 0.9966651, 'f1': 0.99666375, 'auroc': 0.9998998, 'binary_precision': 0.9986532, 'binary_recall': 0.9946735, 'binary_specificity': 0.9986567, 'binary_f1_score': 0.99665934}
confusion matrix:
       0      1
0  25277     34
1    135  25210
---- Validation: 
scalar performance:
{'acc': 0.96564794, 'precision': 0.6842605, 'recall': 0.80968255, 'specificity': 0.80968255, 'f1': 0.7293429, 'auroc': 0.9457469, 'binary_precision': 0.3774648, 'binary_recall': 0.6457831, 'binary_specificity': 0.97358197, 'binary_f1_score': 0.47644442}
confusion matrix:
       0    1
0  16289  442
1    147  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023532, 'precision': 0.6278051, 'recall': 0.8478549, 'specificity': 0.8478549, 'f1': 0.6458859, 'auroc': 0.90624774, 'binary_precision': 0.2657503, 'binary_recall': 0.9015544, 'binary_specificity': 0.7941554, 'binary_f1_score': 0.41049838}
confusion matrix:
      0     1
0  7419  1923
1    76   696
early stop counter: 2
val acc:0.9656479358673096, best validation acc: 0.9698472023010254, corresponding to test acc:                         0.9224836826324463 / 0.9224836826324463
after epoch: 7,now: 2024-08-06 05:50:09.008787,epoch time: 0:27:49.249231,used: 3:15:23.603429,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9939395, 'precision': 0.99400836, 'recall': 0.9939424, 'specificity': 0.9939424, 'f1': 0.99393934, 'auroc': 0.9998308, 'binary_precision': 0.99996006, 'binary_recall': 0.9879242, 'binary_specificity': 0.9999605, 'binary_f1_score': 0.9939057}
confusion matrix:
       0      1
0  25315      1
1    306  25034
---- Validation: 
scalar performance:
{'acc': 0.9776041, 'precision': 0.7717278, 'recall': 0.6724669, 'specificity': 0.6724669, 'f1': 0.71026474, 'auroc': 0.94038284, 'binary_precision': 0.55938697, 'binary_recall': 0.35180724, 'binary_specificity': 0.9931265, 'binary_f1_score': 0.4319527}
confusion matrix:
       0    1
0  16616  115
1    269  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7811944, 'precision': 0.61635995, 'recall': 0.8316481, 'specificity': 0.8316481, 'f1': 0.62519646, 'auroc': 0.901047, 'binary_precision': 0.24423145, 'binary_recall': 0.8911917, 'binary_specificity': 0.7721045, 'binary_f1_score': 0.3833937}
confusion matrix:
      0     1
0  7213  2129
1    84   688
better model found
persisted
after epoch: 8,now: 2024-08-06 06:17:48.879500,epoch time: 0:27:39.870713,used: 3:43:03.474142,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99526215, 'precision': 0.995273, 'recall': 0.99526364, 'specificity': 0.99526364, 'f1': 0.99526215, 'auroc': 0.9998173, 'binary_precision': 0.9977396, 'binary_recall': 0.9927791, 'binary_specificity': 0.9977482, 'binary_f1_score': 0.99525315}
confusion matrix:
       0      1
0  25256     57
1    183  25160
---- Validation: 
scalar performance:
{'acc': 0.9541001, 'precision': 0.65053815, 'recall': 0.8401884, 'specificity': 0.8401884, 'f1': 0.7039265, 'auroc': 0.9396759, 'binary_precision': 0.30824742, 'binary_recall': 0.72048193, 'binary_specificity': 0.9598948, 'binary_f1_score': 0.43176895}
confusion matrix:
       0    1
0  16060  671
1    116  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8106585, 'precision': 0.63025856, 'recall': 0.84462684, 'specificity': 0.84462684, 'f1': 0.6516686, 'auroc': 0.9021206, 'binary_precision': 0.27222002, 'binary_recall': 0.884715, 'binary_specificity': 0.80453867, 'binary_f1_score': 0.4163365}
confusion matrix:
      0     1
0  7516  1826
1    89   683
early stop counter: 1
val acc:0.9541000723838806, best validation acc: 0.97760409116745, corresponding to test acc:                         0.7811943888664246 / 0.9224836826324463
after epoch: 9,now: 2024-08-06 06:45:42.807283,epoch time: 0:27:53.927783,used: 4:10:57.401925,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9973745, 'precision': 0.9973837, 'recall': 0.99737585, 'specificity': 0.99737585, 'f1': 0.9973744, 'auroc': 0.99996233, 'binary_precision': 0.99968284, 'binary_recall': 0.99506766, 'binary_specificity': 0.999684, 'binary_f1_score': 0.9973699}
confusion matrix:
       0      1
0  25305      8
1    125  25218
---- Validation: 
scalar performance:
{'acc': 0.9773125, 'precision': 0.75830674, 'recall': 0.81683445, 'specificity': 0.81683445, 'f1': 0.7843539, 'auroc': 0.9564778, 'binary_precision': 0.5253906, 'binary_recall': 0.64819276, 'binary_specificity': 0.9854761, 'binary_f1_score': 0.58036673}
confusion matrix:
       0    1
0  16488  243
1    146  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80798894, 'precision': 0.63095355, 'recall': 0.8514998, 'specificity': 0.8514998, 'f1': 0.65145004, 'auroc': 0.911283, 'binary_precision': 0.27184087, 'binary_recall': 0.90284973, 'binary_specificity': 0.80014986, 'binary_f1_score': 0.4178657}
confusion matrix:
      0     1
0  7475  1867
1    75   697
early stop counter: 2
val acc:0.9773125052452087, best validation acc: 0.97760409116745, corresponding to test acc:                         0.7811943888664246 / 0.9224836826324463
after epoch: 10,now: 2024-08-06 07:13:21.543395,epoch time: 0:27:38.736112,used: 4:38:36.138037,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99619, 'precision': 0.9962162, 'recall': 0.9961921, 'specificity': 0.9961921, 'f1': 0.99618995, 'auroc': 0.99994004, 'binary_precision': 0.99996024, 'binary_recall': 0.99242365, 'binary_specificity': 0.9999605, 'binary_f1_score': 0.9961777}
confusion matrix:
       0      1
0  25313      1
1    192  25150
---- Validation: 
scalar performance:
{'acc': 0.97678757, 'precision': 0.7767105, 'recall': 0.5780537, 'specificity': 0.5780537, 'f1': 0.6186341, 'auroc': 0.93867767, 'binary_precision': 0.57391304, 'binary_recall': 0.15903614, 'binary_specificity': 0.9970713, 'binary_f1_score': 0.24905661}
confusion matrix:
       0   1
0  16682  49
1    349  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90468657, 'precision': 0.7070074, 'recall': 0.8539357, 'specificity': 0.8539357, 'f1': 0.7531873, 'auroc': 0.9200993, 'binary_precision': 0.43229902, 'binary_recall': 0.79404145, 'binary_specificity': 0.91383004, 'binary_f1_score': 0.5598173}
confusion matrix:
      0    1
0  8537  805
1   159  613
early stop counter: 3
val acc:0.9767875671386719, best validation acc: 0.97760409116745, corresponding to test acc:                         0.7811943888664246 / 0.9224836826324463
after epoch: 11,now: 2024-08-06 07:41:09.118677,epoch time: 0:27:47.575282,used: 5:06:23.713319,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9955188, 'precision': 0.9955518, 'recall': 0.9955214, 'specificity': 0.9955214, 'f1': 0.9955187, 'auroc': 0.9998909, 'binary_precision': 0.9997612, 'binary_recall': 0.99127996, 'binary_specificity': 0.99976295, 'binary_f1_score': 0.99550253}
confusion matrix:
       0      1
0  25306      6
1    221  25123
---- Validation: 
scalar performance:
{'acc': 0.97410476, 'precision': 0.6812192, 'recall': 0.5555302, 'specificity': 0.5555302, 'f1': 0.5823115, 'auroc': 0.9384293, 'binary_precision': 0.384, 'binary_recall': 0.11566265, 'binary_specificity': 0.99539775, 'binary_f1_score': 0.17777778}
confusion matrix:
       0   1
0  16654  77
1    367  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9246589, 'precision': 0.72698617, 'recall': 0.6187704, 'specificity': 0.6187704, 'f1': 0.6515706, 'auroc': 0.88337696, 'binary_precision': 0.5128866, 'binary_recall': 0.25777203, 'binary_specificity': 0.9797688, 'binary_f1_score': 0.34310344}
confusion matrix:
      0    1
0  9153  189
1   573  199
new oracle model saved
early stop counter: 4
val acc:0.9741047620773315, best validation acc: 0.97760409116745, corresponding to test acc:                         0.7811943888664246 / 0.9246588945388794
after epoch: 12,now: 2024-08-06 08:08:47.579104,epoch time: 0:27:38.460427,used: 5:34:02.173746,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9973745, 'precision': 0.997375, 'recall': 0.99737495, 'specificity': 0.99737495, 'f1': 0.9973745, 'auroc': 0.9999071, 'binary_precision': 0.9981034, 'binary_recall': 0.9966463, 'binary_specificity': 0.9981036, 'binary_f1_score': 0.9973743}
confusion matrix:
       0      1
0  25263     48
1     85  25260
---- Validation: 
scalar performance:
{'acc': 0.9827365, 'precision': 0.81694937, 'recall': 0.81843877, 'specificity': 0.81843877, 'f1': 0.81769216, 'auroc': 0.9598892, 'binary_precision': 0.64268583, 'binary_recall': 0.6457831, 'binary_specificity': 0.99109435, 'binary_f1_score': 0.6442308}
confusion matrix:
       0    1
0  16582  149
1    147  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75647616, 'precision': 0.61078525, 'recall': 0.8354979, 'specificity': 0.8354979, 'f1': 0.608579, 'auroc': 0.91384363, 'binary_precision': 0.22944, 'binary_recall': 0.9287565, 'binary_specificity': 0.74223936, 'binary_f1_score': 0.36797538}
confusion matrix:
      0     1
0  6934  2408
1    55   717
better model found
persisted
after epoch: 13,now: 2024-08-06 08:36:33.883155,epoch time: 0:27:46.304051,used: 6:01:48.477797,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9725008, 'precision': 0.97380626, 'recall': 0.97248226, 'specificity': 0.97248226, 'f1': 0.9724811, 'auroc': 0.9996737, 'binary_precision': 0.94911313, 'binary_recall': 0.9985797, 'binary_specificity': 0.94638485, 'binary_f1_score': 0.97321826}
confusion matrix:
       0      1
0  23953   1357
1     36  25310
---- Validation: 
scalar performance:
{'acc': 0.7499125, 'precision': 0.5384394, 'recall': 0.8201575, 'specificity': 0.8201575, 'f1': 0.50048834, 'auroc': 0.90055513, 'binary_precision': 0.080390036, 'binary_recall': 0.8939759, 'binary_specificity': 0.74633914, 'binary_f1_score': 0.14751492}
confusion matrix:
       0     1
0  12487  4244
1     44   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32469845, 'precision': 0.5465425, 'recall': 0.62434614, 'specificity': 0.62434614, 'f1': 0.3032631, 'auroc': 0.8913443, 'binary_precision': 0.09976216, 'binary_recall': 0.9779793, 'binary_specificity': 0.2707129, 'binary_f1_score': 0.18105514}
confusion matrix:
      0     1
0  2529  6813
1    17   755
early stop counter: 1
val acc:0.7499125003814697, best validation acc: 0.9827365279197693, corresponding to test acc:                         0.7564761638641357 / 0.9246588945388794
after epoch: 14,now: 2024-08-06 09:04:28.309126,epoch time: 0:27:54.425971,used: 6:29:42.903768,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99771005, 'precision': 0.99771273, 'recall': 0.99771076, 'specificity': 0.99771076, 'f1': 0.99771005, 'auroc': 0.9999273, 'binary_precision': 0.9990109, 'binary_recall': 0.9964091, 'binary_specificity': 0.9990124, 'binary_f1_score': 0.9977084}
confusion matrix:
       0      1
0  25289     25
1     91  25251
---- Validation: 
scalar performance:
{'acc': 0.98011196, 'precision': 0.8003573, 'recall': 0.7371984, 'specificity': 0.7371984, 'f1': 0.7648237, 'auroc': 0.9441906, 'binary_precision': 0.61349696, 'binary_recall': 0.48192772, 'binary_specificity': 0.9924691, 'binary_f1_score': 0.5398111}
confusion matrix:
       0    1
0  16605  126
1    215  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86306113, 'precision': 0.6650013, 'recall': 0.86408114, 'specificity': 0.86408114, 'f1': 0.7059424, 'auroc': 0.91336, 'binary_precision': 0.34273988, 'binary_recall': 0.865285, 'binary_specificity': 0.8628773, 'binary_f1_score': 0.49099597}
confusion matrix:
      0     1
0  8061  1281
1   104   668
early stop counter: 2
val acc:0.9801119565963745, best validation acc: 0.9827365279197693, corresponding to test acc:                         0.7564761638641357 / 0.9246588945388794
after epoch: 15,now: 2024-08-06 09:32:05.202609,epoch time: 0:27:36.893483,used: 6:57:19.797251,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9972955, 'precision': 0.99730474, 'recall': 0.9972968, 'specificity': 0.9972968, 'f1': 0.9972955, 'auroc': 0.99990034, 'binary_precision': 0.99960357, 'binary_recall': 0.99498874, 'binary_specificity': 0.99960494, 'binary_f1_score': 0.9972908}
confusion matrix:
       0      1
0  25303     10
1    127  25216
---- Validation: 
scalar performance:
{'acc': 0.9798204, 'precision': 0.8367568, 'recall': 0.6489289, 'specificity': 0.6489289, 'f1': 0.70459735, 'auroc': 0.9529871, 'binary_precision': 0.6906077, 'binary_recall': 0.30120483, 'binary_specificity': 0.9966529, 'binary_f1_score': 0.4194631}
confusion matrix:
       0    1
0  16675   56
1    290  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86306113, 'precision': 0.6601465, 'recall': 0.8438802, 'specificity': 0.8438802, 'f1': 0.6995722, 'auroc': 0.894242, 'binary_precision': 0.33705476, 'binary_recall': 0.8212435, 'binary_specificity': 0.8665168, 'binary_f1_score': 0.4779495}
confusion matrix:
      0     1
0  8095  1247
1   138   634
early stop counter: 3
val acc:0.9798203706741333, best validation acc: 0.9827365279197693, corresponding to test acc:                         0.7564761638641357 / 0.9246588945388794
after epoch: 16,now: 2024-08-06 09:59:11.782543,epoch time: 0:27:06.579934,used: 7:24:26.377185,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9979272, 'precision': 0.99792755, 'recall': 0.9979275, 'specificity': 0.9979275, 'f1': 0.9979272, 'auroc': 0.99992055, 'binary_precision': 0.99849874, 'binary_recall': 0.99735606, 'binary_specificity': 0.9984989, 'binary_f1_score': 0.99792707}
confusion matrix:
       0      1
0  25277     38
1     67  25274
---- Validation: 
scalar performance:
{'acc': 0.9670477, 'precision': 0.6805515, 'recall': 0.7540029, 'specificity': 0.7540029, 'f1': 0.71041864, 'auroc': 0.948859, 'binary_precision': 0.37288135, 'binary_recall': 0.5301205, 'binary_specificity': 0.97788537, 'binary_f1_score': 0.43781093}
confusion matrix:
       0    1
0  16361  370
1    195  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45600158, 'precision': 0.5539874, 'recall': 0.68175757, 'specificity': 0.68175757, 'f1': 0.39764705, 'auroc': 0.8689568, 'binary_precision': 0.11817888, 'binary_recall': 0.9481865, 'binary_specificity': 0.41532862, 'binary_f1_score': 0.21016365}
confusion matrix:
      0     1
0  3880  5462
1    40   732
early stop counter: 4
val acc:0.9670476913452148, best validation acc: 0.9827365279197693, corresponding to test acc:                         0.7564761638641357 / 0.9246588945388794
after epoch: 17,now: 2024-08-06 10:26:34.254747,epoch time: 0:27:22.472204,used: 7:51:48.849389,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9927353, 'precision': 0.992821, 'recall': 0.9927322, 'specificity': 0.9927322, 'f1': 0.992735, 'auroc': 0.9999479, 'binary_precision': 0.98644227, 'binary_recall': 0.9992107, 'binary_specificity': 0.98625374, 'binary_f1_score': 0.9927855}
confusion matrix:
       0      1
0  24968    348
1     20  25320
---- Validation: 
scalar performance:
{'acc': 0.92202264, 'precision': 0.60945976, 'recall': 0.90482235, 'specificity': 0.90482235, 'f1': 0.6567719, 'auroc': 0.9537188, 'binary_precision': 0.22195417, 'binary_recall': 0.886747, 'binary_specificity': 0.92289764, 'binary_f1_score': 0.355041}
confusion matrix:
       0     1
0  15441  1290
1     47   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51117265, 'precision': 0.5634616, 'recall': 0.7217232, 'specificity': 0.7217232, 'f1': 0.4369559, 'auroc': 0.91601956, 'binary_precision': 0.13209876, 'binary_recall': 0.9702073, 'binary_specificity': 0.47323912, 'binary_f1_score': 0.2325365}
confusion matrix:
      0     1
0  4421  4921
1    23   749
early stop counter: 5
val acc:0.9220226407051086, best validation acc: 0.9827365279197693, corresponding to test acc:                         0.7564761638641357 / 0.9246588945388794
after epoch: 18,now: 2024-08-06 10:55:00.602427,epoch time: 0:28:26.347680,used: 8:20:15.197069,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 18 with time: 8:20:15.197069 at 2024-08-06 10:55:00.602427
persisted model performance metric: 

scalar performance:
{'acc': 0.75647616, 'precision': 0.61078525, 'recall': 0.8354979, 'specificity': 0.8354979, 'f1': 0.608579, 'auroc': 0.91384363, 'binary_precision': 0.22944, 'binary_recall': 0.9287565, 'binary_specificity': 0.74223936, 'binary_f1_score': 0.36797538}
confusion matrix:
      0     1
0  6934  2408
1    55   717
oracle model performance metric: 

scalar performance:
{'acc': 0.9246589, 'precision': 0.72698617, 'recall': 0.6187704, 'specificity': 0.6187704, 'f1': 0.6515706, 'auroc': 0.88337696, 'binary_precision': 0.5128866, 'binary_recall': 0.25777203, 'binary_specificity': 0.9797688, 'binary_f1_score': 0.34310344}
confusion matrix:
      0    1
0  9153  189
1   573  199
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454863 KiB |   2002 MiB | 661679 GiB | 661678 GiB |
|       from large pool | 412453 KiB |   1969 MiB | 653009 GiB | 653009 GiB |
|       from small pool |  42410 KiB |     61 MiB |   8669 GiB |   8669 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454863 KiB |   2002 MiB | 661679 GiB | 661678 GiB |
|       from large pool | 412453 KiB |   1969 MiB | 653009 GiB | 653009 GiB |
|       from small pool |  42410 KiB |     61 MiB |   8669 GiB |   8669 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447934 KiB |   1998 MiB | 661468 GiB | 661467 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 652815 GiB | 652815 GiB |
|       from small pool |  40859 KiB |     60 MiB |   8652 GiB |   8652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2280 MiB |   2280 MiB |   2280 MiB |      0 B   |
|       from large pool |   2210 MiB |   2210 MiB |   2210 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 395056 KiB | 395056 KiB | 512047 GiB | 512047 GiB |
|       from large pool | 384219 KiB | 384219 KiB | 502958 GiB | 502958 GiB |
|       from small pool |  10837 KiB |  14447 KiB |   9089 GiB |   9089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4934    |    7317    |  125146 K  |  125141 K  |
|       from large pool |     187    |     311    |   61201 K  |   61201 K  |
|       from small pool |    4747    |    7129    |   63944 K  |   63940 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4934    |    7317    |  125146 K  |  125141 K  |
|       from large pool |     187    |     311    |   61201 K  |   61201 K  |
|       from small pool |    4747    |    7129    |   63944 K  |   63940 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     128    |     128    |       0    |
|       from large pool |      93    |      93    |      93    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    3221    |   57050 K  |   57050 K  |
|       from large pool |      39    |      92    |   32547 K  |   32547 K  |
|       from small pool |      30    |    3182    |   24503 K  |   24503 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB | 661679 GiB | 661678 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 653009 GiB | 653009 GiB |
|       from small pool |      0 KiB |     61 MiB |   8669 GiB |   8669 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB | 661679 GiB | 661678 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 653009 GiB | 653009 GiB |
|       from small pool |      0 KiB |     61 MiB |   8669 GiB |   8669 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 661468 GiB | 661468 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 652815 GiB | 652815 GiB |
|       from small pool |      0 KiB |     60 MiB |   8652 GiB |   8652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    830 MiB |   2280 MiB |   2280 MiB |   1450 MiB |
|       from large pool |    778 MiB |   2210 MiB |   2210 MiB |   1432 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 474509 KiB | 512048 GiB | 512048 GiB |
|       from large pool |  24320 KiB | 449880 KiB | 502958 GiB | 502958 GiB |
|       from small pool |      0 KiB |  26410 KiB |   9089 GiB |   9089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7317    |  125146 K  |  125146 K  |
|       from large pool |       2    |     311    |   61201 K  |   61201 K  |
|       from small pool |       0    |    7129    |   63944 K  |   63944 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7317    |  125146 K  |  125146 K  |
|       from large pool |       2    |     311    |   61201 K  |   61201 K  |
|       from small pool |       0    |    7129    |   63944 K  |   63944 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     128    |     128    |      67    |
|       from large pool |      35    |      93    |      93    |      58    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3221    |   57052 K  |   57052 K  |
|       from large pool |       4    |      92    |   32547 K  |   32547 K  |
|       from small pool |       0    |    3182    |   24505 K  |   24505 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB | 661679 GiB | 661678 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 653009 GiB | 653009 GiB |
|       from small pool |      0 KiB |     61 MiB |   8669 GiB |   8669 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB | 661679 GiB | 661678 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 653009 GiB | 653009 GiB |
|       from small pool |      0 KiB |     61 MiB |   8669 GiB |   8669 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 661468 GiB | 661468 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 652815 GiB | 652815 GiB |
|       from small pool |      0 KiB |     60 MiB |   8652 GiB |   8652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    830 MiB |   2280 MiB |   2280 MiB |   1450 MiB |
|       from large pool |    778 MiB |   2210 MiB |   2210 MiB |   1432 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 474509 KiB | 512048 GiB | 512048 GiB |
|       from large pool |  24320 KiB | 449880 KiB | 502958 GiB | 502958 GiB |
|       from small pool |      0 KiB |  26410 KiB |   9089 GiB |   9089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7317    |  125146 K  |  125146 K  |
|       from large pool |       2    |     311    |   61201 K  |   61201 K  |
|       from small pool |       0    |    7129    |   63944 K  |   63944 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7317    |  125146 K  |  125146 K  |
|       from large pool |       2    |     311    |   61201 K  |   61201 K  |
|       from small pool |       0    |    7129    |   63944 K  |   63944 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     128    |     128    |      67    |
|       from large pool |      35    |      93    |      93    |      58    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3221    |   57052 K  |   57052 K  |
|       from large pool |       4    |      92    |   32547 K  |   32547 K  |
|       from small pool |       0    |    3182    |   24505 K  |   24505 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675

 Experiment start at: 2024-08-06 11:20:30.089059
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98825544, 'precision': 0.9884851, 'recall': 0.9882641, 'specificity': 0.9882641, 'f1': 0.9882542, 'auroc': 0.99954534, 'binary_precision': 0.9992764, 'binary_recall': 0.977237, 'binary_specificity': 0.99929124, 'binary_f1_score': 0.9881338}
confusion matrix:
       0      1
0  25378     18
1    579  24857
---- Validation: 
scalar performance:
{'acc': 0.9588273, 'precision': 0.6368849, 'recall': 0.70312834, 'specificity': 0.70312834, 'f1': 0.66268057, 'auroc': 0.9106295, 'binary_precision': 0.28858024, 'binary_recall': 0.4338747, 'binary_specificity': 0.972382, 'binary_f1_score': 0.34661725}
confusion matrix:
       0    1
0  16231  461
1    244  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9100188, 'precision': 0.7073977, 'recall': 0.82147664, 'specificity': 0.82147664, 'f1': 0.74735546, 'auroc': 0.8984639, 'binary_precision': 0.43896523, 'binary_recall': 0.7173051, 'binary_specificity': 0.92564815, 'binary_f1_score': 0.54463387}
confusion matrix:
      0    1
0  8640  694
1   214  543
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 11:47:20.197473,epoch time: 0:26:50.108414,used: 0:26:50.108414,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9937834, 'precision': 0.9937966, 'recall': 0.99378574, 'specificity': 0.99378574, 'f1': 0.99378335, 'auroc': 0.999625, 'binary_precision': 0.9965606, 'binary_recall': 0.9909974, 'binary_specificity': 0.9965741, 'binary_f1_score': 0.9937712}
confusion matrix:
       0      1
0  25308     87
1    229  25208
---- Validation: 
scalar performance:
{'acc': 0.9695731, 'precision': 0.71893674, 'recall': 0.8917224, 'specificity': 0.8917224, 'f1': 0.7784127, 'auroc': 0.952861, 'binary_precision': 0.44289342, 'binary_recall': 0.8097448, 'binary_specificity': 0.9737, 'binary_f1_score': 0.5726005}
confusion matrix:
       0    1
0  16253  439
1     82  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8740462, 'precision': 0.66781276, 'recall': 0.8457309, 'specificity': 0.8457309, 'f1': 0.70995915, 'auroc': 0.9060142, 'binary_precision': 0.35263762, 'binary_recall': 0.81241745, 'binary_specificity': 0.87904435, 'binary_f1_score': 0.4918033}
confusion matrix:
      0     1
0  8205  1129
1   142   615
better model found
persisted
after epoch: 2,now: 2024-08-06 12:13:08.212372,epoch time: 0:25:48.014899,used: 0:52:38.123313,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9916588, 'precision': 0.9917178, 'recall': 0.991663, 'specificity': 0.991663, 'f1': 0.99165857, 'auroc': 0.9996874, 'binary_precision': 0.9972959, 'binary_recall': 0.9860035, 'binary_specificity': 0.9973225, 'binary_f1_score': 0.99161756}
confusion matrix:
       0      1
0  25329     68
1    356  25079
---- Validation: 
scalar performance:
{'acc': 0.9699819, 'precision': 0.7166849, 'recall': 0.84672654, 'specificity': 0.84672654, 'f1': 0.7652072, 'auroc': 0.95233285, 'binary_precision': 0.44079885, 'binary_recall': 0.71693736, 'binary_specificity': 0.9765157, 'binary_f1_score': 0.5459364}
confusion matrix:
       0    1
0  16300  392
1    122  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90456843, 'precision': 0.70303255, 'recall': 0.8458425, 'specificity': 0.8458425, 'f1': 0.7482085, 'auroc': 0.91645247, 'binary_precision': 0.42547032, 'binary_recall': 0.7767503, 'binary_specificity': 0.91493464, 'binary_f1_score': 0.5497896}
confusion matrix:
      0    1
0  8540  794
1   169  588
better model found
persisted
after epoch: 3,now: 2024-08-06 12:38:51.689157,epoch time: 0:25:43.476785,used: 1:18:21.600098,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.978065, 'precision': 0.9789653, 'recall': 0.9780848, 'specificity': 0.9780848, 'f1': 0.97805536, 'auroc': 0.9995994, 'binary_precision': 0.9999589, 'binary_recall': 0.95620894, 'binary_specificity': 0.9999606, 'binary_f1_score': 0.9775947}
confusion matrix:
       0      1
0  25392      1
1   1114  24325
---- Validation: 
scalar performance:
{'acc': 0.97891724, 'precision': 0.8728647, 'recall': 0.6162408, 'specificity': 0.6162408, 'f1': 0.67403734, 'auroc': 0.9503789, 'binary_precision': 0.7651515, 'binary_recall': 0.23433875, 'binary_specificity': 0.99814284, 'binary_f1_score': 0.3587922}
confusion matrix:
       0    1
0  16661   31
1    330  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9011991, 'precision': 0.7013935, 'recall': 0.8628361, 'specificity': 0.8628361, 'f1': 0.7491813, 'auroc': 0.9161154, 'binary_precision': 0.4188092, 'binary_recall': 0.81770146, 'binary_specificity': 0.90797085, 'binary_f1_score': 0.553915}
confusion matrix:
      0    1
0  8475  859
1   138  619
better model found
persisted
after epoch: 4,now: 2024-08-06 13:04:35.650687,epoch time: 0:25:43.961530,used: 1:44:05.561628,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9958294, 'precision': 0.99583626, 'recall': 0.9958282, 'specificity': 0.9958282, 'f1': 0.9958294, 'auroc': 0.9999051, 'binary_precision': 0.9941614, 'binary_recall': 0.997523, 'binary_specificity': 0.9941334, 'binary_f1_score': 0.9958394}
confusion matrix:
       0      1
0  25249    149
1     63  25371
---- Validation: 
scalar performance:
{'acc': 0.93657655, 'precision': 0.6280385, 'recall': 0.88383925, 'specificity': 0.88383925, 'f1': 0.6815978, 'auroc': 0.94182444, 'binary_precision': 0.26077428, 'binary_recall': 0.82830626, 'binary_specificity': 0.9393722, 'binary_f1_score': 0.39666665}
confusion matrix:
       0     1
0  15680  1012
1     74   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6151026, 'precision': 0.57350606, 'recall': 0.76220363, 'specificity': 0.76220363, 'f1': 0.5030917, 'auroc': 0.8876686, 'binary_precision': 0.15584415, 'binary_recall': 0.9352708, 'binary_specificity': 0.5891365, 'binary_f1_score': 0.2671698}
confusion matrix:
      0     1
0  5499  3835
1    49   708
early stop counter: 1
val acc:0.9365765452384949, best validation acc: 0.9789172410964966, corresponding to test acc:                         0.9011991024017334 / 0.910018801689148
after epoch: 5,now: 2024-08-06 13:30:17.827143,epoch time: 0:25:42.176456,used: 2:09:47.738084,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99041945, 'precision': 0.9905576, 'recall': 0.99042654, 'specificity': 0.99042654, 'f1': 0.9904188, 'auroc': 0.9996264, 'binary_precision': 0.999, 'binary_recall': 0.98183745, 'binary_specificity': 0.99901557, 'binary_f1_score': 0.9903444}
confusion matrix:
       0      1
0  25370     25
1    462  24975
---- Validation: 
scalar performance:
{'acc': 0.9762308, 'precision': 0.7569354, 'recall': 0.79568505, 'specificity': 0.79568505, 'f1': 0.7748393, 'auroc': 0.95246744, 'binary_precision': 0.52409637, 'binary_recall': 0.60556847, 'binary_specificity': 0.9858016, 'binary_f1_score': 0.5618945}
confusion matrix:
       0    1
0  16455  237
1    170  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84134376, 'precision': 0.65131044, 'recall': 0.87539446, 'specificity': 0.87539446, 'f1': 0.68545115, 'auroc': 0.92819536, 'binary_precision': 0.31076235, 'binary_recall': 0.91545576, 'binary_specificity': 0.83533317, 'binary_f1_score': 0.46401075}
confusion matrix:
      0     1
0  7797  1537
1    64   693
early stop counter: 2
val acc:0.976230800151825, best validation acc: 0.9789172410964966, corresponding to test acc:                         0.9011991024017334 / 0.910018801689148
after epoch: 6,now: 2024-08-06 13:56:26.355519,epoch time: 0:26:08.528376,used: 2:35:56.266460,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9907735, 'precision': 0.99093366, 'recall': 0.9907808, 'specificity': 0.9907808, 'f1': 0.99077284, 'auroc': 0.9998673, 'binary_precision': 1.0, 'binary_recall': 0.98156154, 'binary_specificity': 1.0, 'binary_f1_score': 0.990695}
confusion matrix:
       0      1
0  25396      0
1    469  24967
---- Validation: 
scalar performance:
{'acc': 0.97494596, 'precision': 0.7436398, 'recall': 0.56108737, 'specificity': 0.56108737, 'f1': 0.59419537, 'auroc': 0.9465765, 'binary_precision': 0.509434, 'binary_recall': 0.12529002, 'binary_specificity': 0.99688476, 'binary_f1_score': 0.2011173}
confusion matrix:
       0   1
0  16640  52
1    377  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9046675, 'precision': 0.700197, 'recall': 0.8295088, 'specificity': 0.8295088, 'f1': 0.74261636, 'auroc': 0.88783824, 'binary_precision': 0.4227581, 'binary_recall': 0.7410832, 'binary_specificity': 0.9179344, 'binary_f1_score': 0.5383878}
confusion matrix:
      0    1
0  8568  766
1   196  561
early stop counter: 3
val acc:0.9749459624290466, best validation acc: 0.9789172410964966, corresponding to test acc:                         0.9011991024017334 / 0.910018801689148
after epoch: 7,now: 2024-08-06 14:22:46.589438,epoch time: 0:26:20.233919,used: 3:02:16.500379,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99543595, 'precision': 0.99543965, 'recall': 0.9954372, 'specificity': 0.9954372, 'f1': 0.9954359, 'auroc': 0.99982584, 'binary_precision': 0.99700266, 'binary_recall': 0.993867, 'binary_specificity': 0.9970074, 'binary_f1_score': 0.9954323}
confusion matrix:
       0      1
0  25320     76
1    156  25280
---- Validation: 
scalar performance:
{'acc': 0.97985166, 'precision': 0.7954378, 'recall': 0.79076135, 'specificity': 0.79076135, 'f1': 0.79307956, 'auroc': 0.9525666, 'binary_precision': 0.6014151, 'binary_recall': 0.5916473, 'binary_specificity': 0.9898754, 'binary_f1_score': 0.5964912}
confusion matrix:
       0    1
0  16523  169
1    176  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9118026, 'precision': 0.7128951, 'recall': 0.8364004, 'specificity': 0.8364004, 'f1': 0.75541645, 'auroc': 0.9036347, 'binary_precision': 0.44743082, 'binary_recall': 0.74768823, 'binary_specificity': 0.9251125, 'binary_f1_score': 0.55984175}
confusion matrix:
      0    1
0  8635  699
1   191  566
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-06 14:48:46.558483,epoch time: 0:25:59.969045,used: 3:28:16.469424,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9964983, 'precision': 0.9965015, 'recall': 0.99649954, 'specificity': 0.99649954, 'f1': 0.9964982, 'auroc': 0.99985147, 'binary_precision': 0.99798906, 'binary_recall': 0.9950073, 'binary_specificity': 0.99799174, 'binary_f1_score': 0.9964959}
confusion matrix:
       0      1
0  25344     51
1    127  25310
---- Validation: 
scalar performance:
{'acc': 0.9686971, 'precision': 0.70232147, 'recall': 0.78730035, 'specificity': 0.78730035, 'f1': 0.7366887, 'auroc': 0.92830545, 'binary_precision': 0.41518578, 'binary_recall': 0.5962877, 'binary_specificity': 0.97831297, 'binary_f1_score': 0.4895238}
confusion matrix:
       0    1
0  16330  362
1    174  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5414726, 'precision': 0.56084394, 'recall': 0.7187613, 'specificity': 0.7187613, 'f1': 0.4529119, 'auroc': 0.8951392, 'binary_precision': 0.1331058, 'binary_recall': 0.9273448, 'binary_specificity': 0.51017785, 'binary_f1_score': 0.23279722}
confusion matrix:
      0     1
0  4762  4572
1    55   702
early stop counter: 1
val acc:0.9686970710754395, best validation acc: 0.9798516631126404, corresponding to test acc:                         0.9118025898933411 / 0.9118025898933411
after epoch: 9,now: 2024-08-06 15:15:27.237155,epoch time: 0:26:40.678672,used: 3:54:57.148096,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99665564, 'precision': 0.9966556, 'recall': 0.9966558, 'specificity': 0.9966558, 'f1': 0.99665564, 'auroc': 0.9998814, 'binary_precision': 0.996815, 'binary_recall': 0.99650156, 'binary_specificity': 0.99681, 'binary_f1_score': 0.99665827}
confusion matrix:
       0      1
0  25311     81
1     89  25351
---- Validation: 
scalar performance:
{'acc': 0.9504176, 'precision': 0.65459085, 'recall': 0.88641787, 'specificity': 0.88641787, 'f1': 0.7140244, 'auroc': 0.9445724, 'binary_precision': 0.31405693, 'binary_recall': 0.8190255, 'binary_specificity': 0.9538102, 'binary_f1_score': 0.45401934}
confusion matrix:
       0    1
0  15921  771
1     78  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58745414, 'precision': 0.5680983, 'recall': 0.74483055, 'specificity': 0.74483055, 'f1': 0.48390752, 'auroc': 0.8845215, 'binary_precision': 0.14624013, 'binary_recall': 0.9299868, 'binary_specificity': 0.5596743, 'binary_f1_score': 0.25273737}
confusion matrix:
      0     1
0  5224  4110
1    53   704
early stop counter: 2
val acc:0.9504175782203674, best validation acc: 0.9798516631126404, corresponding to test acc:                         0.9118025898933411 / 0.9118025898933411
after epoch: 10,now: 2024-08-06 15:44:00.840755,epoch time: 0:28:33.603600,used: 4:23:30.751696,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.997777, 'precision': 0.99777776, 'recall': 0.9977766, 'specificity': 0.9977766, 'f1': 0.997777, 'auroc': 0.99994004, 'binary_precision': 0.99732906, 'binary_recall': 0.9982309, 'binary_specificity': 0.99732244, 'binary_f1_score': 0.9977797}
confusion matrix:
       0      1
0  25328     68
1     45  25391
---- Validation: 
scalar performance:
{'acc': 0.9706827, 'precision': 0.7169328, 'recall': 0.81092155, 'specificity': 0.81092155, 'f1': 0.7547481, 'auroc': 0.94197714, 'binary_precision': 0.4432, 'binary_recall': 0.64269143, 'binary_specificity': 0.97915167, 'binary_f1_score': 0.5246212}
confusion matrix:
       0    1
0  16344  348
1    154  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4861758, 'precision': 0.55823493, 'recall': 0.704044, 'specificity': 0.704044, 'f1': 0.41807714, 'auroc': 0.8944621, 'binary_precision': 0.12359741, 'binary_recall': 0.9603699, 'binary_specificity': 0.44771802, 'binary_f1_score': 0.21900888}
confusion matrix:
      0     1
0  4179  5155
1    30   727
early stop counter: 3
val acc:0.970682680606842, best validation acc: 0.9798516631126404, corresponding to test acc:                         0.9118025898933411 / 0.9118025898933411
after epoch: 11,now: 2024-08-06 16:12:50.620143,epoch time: 0:28:49.779388,used: 4:52:20.531084,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9963212, 'precision': 0.99634445, 'recall': 0.99632376, 'specificity': 0.99632376, 'f1': 0.9963212, 'auroc': 0.99989045, 'binary_precision': 0.9999208, 'binary_recall': 0.99272627, 'binary_specificity': 0.99992126, 'binary_f1_score': 0.99631053}
confusion matrix:
       0      1
0  25396      2
1    185  25249
---- Validation: 
scalar performance:
{'acc': 0.9811949, 'precision': 0.8971882, 'recall': 0.6637447, 'specificity': 0.6637447, 'f1': 0.7295375, 'auroc': 0.9201313, 'binary_precision': 0.81142855, 'binary_recall': 0.32946634, 'binary_specificity': 0.99802303, 'binary_f1_score': 0.46864685}
confusion matrix:
       0    1
0  16659   33
1    289  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.812308, 'precision': 0.6284305, 'recall': 0.8414911, 'specificity': 0.8414911, 'f1': 0.65006995, 'auroc': 0.908459, 'binary_precision': 0.26918393, 'binary_recall': 0.87582564, 'binary_specificity': 0.8071566, 'binary_f1_score': 0.41180128}
confusion matrix:
      0     1
0  7534  1800
1    94   663
better model found
persisted
after epoch: 12,now: 2024-08-06 16:38:32.998253,epoch time: 0:25:42.378110,used: 5:18:02.909194,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9971278, 'precision': 0.9971278, 'recall': 0.9971278, 'specificity': 0.9971278, 'f1': 0.9971278, 'auroc': 0.99990535, 'binary_precision': 0.99709105, 'binary_recall': 0.9971695, 'binary_specificity': 0.99708605, 'binary_f1_score': 0.9971303}
confusion matrix:
       0      1
0  25321     74
1     72  25365
---- Validation: 
scalar performance:
{'acc': 0.95433044, 'precision': 0.64267224, 'recall': 0.7776712, 'specificity': 0.7776712, 'f1': 0.6855034, 'auroc': 0.9036002, 'binary_precision': 0.29616725, 'binary_recall': 0.5916473, 'binary_specificity': 0.96369517, 'binary_f1_score': 0.39473686}
confusion matrix:
       0    1
0  16086  606
1    176  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3244475, 'precision': 0.54426444, 'recall': 0.6208702, 'specificity': 0.6208702, 'f1': 0.30209303, 'auroc': 0.86728275, 'binary_precision': 0.09750266, 'binary_recall': 0.9696169, 'binary_specificity': 0.27212343, 'binary_f1_score': 0.17718768}
confusion matrix:
      0     1
0  2540  6794
1    23   734
early stop counter: 1
val acc:0.9543304443359375, best validation acc: 0.9811949133872986, corresponding to test acc:                         0.8123080134391785 / 0.9118025898933411
after epoch: 13,now: 2024-08-06 17:05:36.676263,epoch time: 0:27:03.678010,used: 5:45:06.587204,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99476707, 'precision': 0.9947717, 'recall': 0.9947684, 'specificity': 0.9947684, 'f1': 0.99476707, 'auroc': 0.99981093, 'binary_precision': 0.99648875, 'binary_recall': 0.9930411, 'binary_specificity': 0.99649566, 'binary_f1_score': 0.99476194}
confusion matrix:
       0      1
0  25308     89
1    177  25258
---- Validation: 
scalar performance:
{'acc': 0.9758804, 'precision': 0.7979475, 'recall': 0.5536557, 'specificity': 0.5536557, 'f1': 0.5865817, 'auroc': 0.9548403, 'binary_precision': 0.6184211, 'binary_recall': 0.109048724, 'binary_specificity': 0.99826264, 'binary_f1_score': 0.18540435}
confusion matrix:
       0   1
0  16663  29
1    384  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8570013, 'precision': 0.6494995, 'recall': 0.8274132, 'specificity': 0.8274132, 'f1': 0.68587786, 'auroc': 0.8785917, 'binary_precision': 0.31813362, 'binary_recall': 0.79260236, 'binary_specificity': 0.8622241, 'binary_f1_score': 0.4540295}
confusion matrix:
      0     1
0  8048  1286
1   157   600
early stop counter: 2
val acc:0.9758803844451904, best validation acc: 0.9811949133872986, corresponding to test acc:                         0.8123080134391785 / 0.9118025898933411
after epoch: 14,now: 2024-08-06 17:35:34.832516,epoch time: 0:29:58.156253,used: 6:15:04.743457,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9973442, 'precision': 0.9973447, 'recall': 0.9973439, 'specificity': 0.9973439, 'f1': 0.9973442, 'auroc': 0.99988353, 'binary_precision': 0.9970141, 'binary_recall': 0.9976804, 'binary_specificity': 0.9970074, 'binary_f1_score': 0.9973472}
confusion matrix:
       0      1
0  25320     76
1     59  25377
---- Validation: 
scalar performance:
{'acc': 0.9733692, 'precision': 0.73609155, 'recall': 0.8394228, 'specificity': 0.8394228, 'f1': 0.77762914, 'auroc': 0.9427204, 'binary_precision': 0.4800638, 'binary_recall': 0.6983759, 'binary_specificity': 0.9804697, 'binary_f1_score': 0.56899816}
confusion matrix:
       0    1
0  16366  326
1    130  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72014666, 'precision': 0.59536624, 'recall': 0.8092743, 'specificity': 0.8092743, 'f1': 0.57605505, 'auroc': 0.90934837, 'binary_precision': 0.20052159, 'binary_recall': 0.91413474, 'binary_specificity': 0.70441395, 'binary_f1_score': 0.32889733}
confusion matrix:
      0     1
0  6575  2759
1    65   692
early stop counter: 3
val acc:0.9733691811561584, best validation acc: 0.9811949133872986, corresponding to test acc:                         0.8123080134391785 / 0.9118025898933411
after epoch: 15,now: 2024-08-06 18:04:39.216466,epoch time: 0:29:04.383950,used: 6:44:09.127407,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.996754, 'precision': 0.9967608, 'recall': 0.9967557, 'specificity': 0.9967557, 'f1': 0.99675393, 'auroc': 0.9998741, 'binary_precision': 0.9988157, 'binary_recall': 0.99469274, 'binary_specificity': 0.99881864, 'binary_f1_score': 0.99674994}
confusion matrix:
       0      1
0  25365     30
1    135  25302
---- Validation: 
scalar performance:
{'acc': 0.9759388, 'precision': 0.7560585, 'recall': 0.7130351, 'specificity': 0.7130351, 'f1': 0.7324217, 'auroc': 0.94246876, 'binary_precision': 0.5266107, 'binary_recall': 0.4361949, 'binary_specificity': 0.9898754, 'binary_f1_score': 0.47715738}
confusion matrix:
       0    1
0  16523  169
1    243  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66247153, 'precision': 0.57864153, 'recall': 0.7714218, 'specificity': 0.7714218, 'f1': 0.5323432, 'auroc': 0.89270985, 'binary_precision': 0.1697831, 'binary_recall': 0.8996037, 'binary_specificity': 0.6432398, 'binary_f1_score': 0.28565437}
confusion matrix:
      0     1
0  6004  3330
1    76   681
early stop counter: 4
val acc:0.9759387969970703, best validation acc: 0.9811949133872986, corresponding to test acc:                         0.8123080134391785 / 0.9118025898933411
after epoch: 16,now: 2024-08-06 18:35:04.088324,epoch time: 0:30:24.871858,used: 7:14:33.999265,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99852455, 'precision': 0.9985268, 'recall': 0.9985256, 'specificity': 0.9985256, 'f1': 0.99852455, 'auroc': 0.9999654, 'binary_precision': 0.99980295, 'binary_recall': 0.9972481, 'binary_specificity': 0.9998031, 'binary_f1_score': 0.9985239}
confusion matrix:
       0      1
0  25390      5
1     70  25367
---- Validation: 
scalar performance:
{'acc': 0.97932607, 'precision': 0.8287619, 'recall': 0.6706971, 'specificity': 0.6706971, 'f1': 0.7232588, 'auroc': 0.9456357, 'binary_precision': 0.67420816, 'binary_recall': 0.34570765, 'binary_specificity': 0.99568653, 'binary_f1_score': 0.4570552}
confusion matrix:
       0    1
0  16620   72
1    282  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.618571, 'precision': 0.57479495, 'recall': 0.7665062, 'specificity': 0.7665062, 'f1': 0.5059444, 'auroc': 0.8982265, 'binary_precision': 0.15766165, 'binary_recall': 0.9405548, 'binary_specificity': 0.59245765, 'binary_f1_score': 0.270055}
confusion matrix:
      0     1
0  5530  3804
1    45   712
early stop counter: 5
val acc:0.979326069355011, best validation acc: 0.9811949133872986, corresponding to test acc:                         0.8123080134391785 / 0.9118025898933411
after epoch: 17,now: 2024-08-06 19:03:41.968557,epoch time: 0:28:37.880233,used: 7:43:11.879498,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_11_20_29_seed_1_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 7:43:11.879498 at 2024-08-06 19:03:41.968557
persisted model performance metric: 

scalar performance:
{'acc': 0.812308, 'precision': 0.6284305, 'recall': 0.8414911, 'specificity': 0.8414911, 'f1': 0.65006995, 'auroc': 0.908459, 'binary_precision': 0.26918393, 'binary_recall': 0.87582564, 'binary_specificity': 0.8071566, 'binary_f1_score': 0.41180128}
confusion matrix:
      0     1
0  7534  1800
1    94   663
oracle model performance metric: 

scalar performance:
{'acc': 0.9118026, 'precision': 0.7128951, 'recall': 0.8364004, 'specificity': 0.8364004, 'f1': 0.75541645, 'auroc': 0.9036347, 'binary_precision': 0.44743082, 'binary_recall': 0.74768823, 'binary_specificity': 0.9251125, 'binary_f1_score': 0.55984175}
confusion matrix:
      0    1
0  8635  699
1   191  566
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456543 KiB |   2002 MiB |   1259 TiB |   1259 TiB |
|       from large pool | 414139 KiB |   1969 MiB |   1243 TiB |   1243 TiB |
|       from small pool |  42404 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456543 KiB |   2002 MiB |   1259 TiB |   1259 TiB |
|       from large pool | 414139 KiB |   1969 MiB |   1243 TiB |   1243 TiB |
|       from small pool |  42404 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |   1998 MiB |   1259 TiB |   1259 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1242 TiB |   1242 TiB |
|       from small pool |  40858 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2280 MiB |   3726 MiB |   1450 MiB |
|       from large pool |   2212 MiB |   2212 MiB |   3644 MiB |   1432 MiB |
|       from small pool |     64 MiB |     70 MiB |     82 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 370848 KiB | 474509 KiB |    969 TiB |    969 TiB |
|       from large pool | 362053 KiB | 449880 KiB |    952 TiB |    952 TiB |
|       from small pool |   8795 KiB |  26410 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7339    |  243881 K  |  243876 K  |
|       from large pool |     187    |     311    |  119316 K  |  119316 K  |
|       from small pool |    4735    |    7151    |  124565 K  |  124560 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7339    |  243881 K  |  243876 K  |
|       from large pool |     187    |     311    |  119316 K  |  119316 K  |
|       from small pool |    4735    |    7151    |  124565 K  |  124560 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     128    |     193    |      67    |
|       from large pool |      94    |      94    |     152    |      58    |
|       from small pool |      32    |      35    |      41    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    3227    |  118442 K  |  118442 K  |
|       from large pool |      34    |      95    |   70450 K  |   70450 K  |
|       from small pool |      29    |    3193    |   47992 K  |   47992 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |   1259 TiB |   1259 TiB |
|       from large pool |  16640 KiB |   1969 MiB |   1243 TiB |   1243 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |   1259 TiB |   1259 TiB |
|       from large pool |  16640 KiB |   1969 MiB |   1243 TiB |   1243 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1259 TiB |   1259 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    808 MiB |   2280 MiB |   3726 MiB |   2918 MiB |
|       from large pool |    758 MiB |   2212 MiB |   3644 MiB |   2886 MiB |
|       from small pool |     50 MiB |     70 MiB |     82 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 474509 KiB |    969 TiB |    969 TiB |
|       from large pool |  24320 KiB | 449880 KiB |    952 TiB |    952 TiB |
|       from small pool |      0 KiB |  26410 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7339    |  243881 K  |  243881 K  |
|       from large pool |       2    |     311    |  119316 K  |  119316 K  |
|       from small pool |       0    |    7151    |  124565 K  |  124565 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7339    |  243881 K  |  243881 K  |
|       from large pool |       2    |     311    |  119316 K  |  119316 K  |
|       from small pool |       0    |    7151    |  124565 K  |  124565 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     128    |     193    |     134    |
|       from large pool |      34    |      94    |     152    |     118    |
|       from small pool |      25    |      35    |      41    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3227    |  118444 K  |  118444 K  |
|       from large pool |       4    |      95    |   70450 K  |   70450 K  |
|       from small pool |       0    |    3193    |   47994 K  |   47994 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |   1259 TiB |   1259 TiB |
|       from large pool |  16640 KiB |   1969 MiB |   1243 TiB |   1243 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |   1259 TiB |   1259 TiB |
|       from large pool |  16640 KiB |   1969 MiB |   1243 TiB |   1243 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1259 TiB |   1259 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    808 MiB |   2280 MiB |   3726 MiB |   2918 MiB |
|       from large pool |    758 MiB |   2212 MiB |   3644 MiB |   2886 MiB |
|       from small pool |     50 MiB |     70 MiB |     82 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 474509 KiB |    969 TiB |    969 TiB |
|       from large pool |  24320 KiB | 449880 KiB |    952 TiB |    952 TiB |
|       from small pool |      0 KiB |  26410 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7339    |  243881 K  |  243881 K  |
|       from large pool |       2    |     311    |  119316 K  |  119316 K  |
|       from small pool |       0    |    7151    |  124565 K  |  124565 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7339    |  243881 K  |  243881 K  |
|       from large pool |       2    |     311    |  119316 K  |  119316 K  |
|       from small pool |       0    |    7151    |  124565 K  |  124565 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     128    |     193    |     134    |
|       from large pool |      34    |      94    |     152    |     118    |
|       from small pool |      25    |      35    |      41    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3227    |  118444 K  |  118444 K  |
|       from large pool |       4    |      95    |   70450 K  |   70450 K  |
|       from small pool |       0    |    3193    |   47994 K  |   47994 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675

 Experiment start at: 2024-08-06 19:30:18.852285
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9773483, 'precision': 0.977988, 'recall': 0.9773505, 'specificity': 0.9773505, 'f1': 0.9773408, 'auroc': 0.9974036, 'binary_precision': 0.9955027, 'binary_recall': 0.95903444, 'binary_specificity': 0.99566644, 'binary_f1_score': 0.97692835}
confusion matrix:
       0      1
0  25733    112
1   1059  24792
---- Validation: 
scalar performance:
{'acc': 0.92933893, 'precision': 0.5785857, 'recall': 0.7153757, 'specificity': 0.7153757, 'f1': 0.6080009, 'auroc': 0.84275043, 'binary_precision': 0.17054908, 'binary_recall': 0.49043062, 'binary_specificity': 0.94032085, 'binary_f1_score': 0.25308642}
confusion matrix:
       0    1
0  15709  997
1    213  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89239, 'precision': 0.66819054, 'recall': 0.73682046, 'specificity': 0.73682046, 'f1': 0.693999, 'auroc': 0.85561603, 'binary_precision': 0.37639007, 'binary_recall': 0.55207026, 'binary_specificity': 0.9215707, 'binary_f1_score': 0.44760934}
confusion matrix:
      0    1
0  8566  729
1   357  440
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 19:57:25.066807,epoch time: 0:27:06.214522,used: 0:27:06.214522,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99498993, 'precision': 0.99499214, 'recall': 0.99499017, 'specificity': 0.99499017, 'f1': 0.99498993, 'auroc': 0.9997395, 'binary_precision': 0.9960848, 'binary_recall': 0.99388874, 'binary_specificity': 0.9960916, 'binary_f1_score': 0.9949855}
confusion matrix:
       0      1
0  25741    101
1    158  25696
---- Validation: 
scalar performance:
{'acc': 0.94919413, 'precision': 0.63773054, 'recall': 0.8305136, 'specificity': 0.8305136, 'f1': 0.68878776, 'auroc': 0.9295907, 'binary_precision': 0.2831094, 'binary_recall': 0.70574164, 'binary_specificity': 0.95528555, 'binary_f1_score': 0.40410957}
confusion matrix:
       0    1
0  15959  747
1    123  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83759415, 'precision': 0.64832044, 'recall': 0.8498898, 'specificity': 0.8498898, 'f1': 0.68063563, 'auroc': 0.9106058, 'binary_precision': 0.31036037, 'binary_recall': 0.8644918, 'binary_specificity': 0.8352878, 'binary_f1_score': 0.45674512}
confusion matrix:
      0     1
0  7764  1531
1   108   689
better model found
persisted
after epoch: 2,now: 2024-08-06 20:23:25.984985,epoch time: 0:26:00.918178,used: 0:53:07.132700,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98661405, 'precision': 0.98661464, 'recall': 0.9866142, 'specificity': 0.9866142, 'f1': 0.98661405, 'auroc': 0.99899185, 'binary_precision': 0.9872207, 'binary_recall': 0.98599887, 'binary_specificity': 0.9872296, 'binary_f1_score': 0.9866094}
confusion matrix:
       0      1
0  25511    330
1    362  25493
---- Validation: 
scalar performance:
{'acc': 0.9474422, 'precision': 0.6198126, 'recall': 0.76780486, 'specificity': 0.76780486, 'f1': 0.66116273, 'auroc': 0.9066585, 'binary_precision': 0.2505176, 'binary_recall': 0.57894737, 'binary_specificity': 0.9566623, 'binary_f1_score': 0.34971097}
confusion matrix:
       0    1
0  15982  724
1    176  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3591954, 'precision': 0.54938906, 'recall': 0.63835937, 'specificity': 0.63835937, 'f1': 0.33079574, 'auroc': 0.8644434, 'binary_precision': 0.10712306, 'binary_recall': 0.9698871, 'binary_specificity': 0.30683163, 'binary_f1_score': 0.19293648}
confusion matrix:
      0     1
0  2852  6443
1    24   773
early stop counter: 1
val acc:0.9474421739578247, best validation acc: 0.9491941332817078, corresponding to test acc:                         0.8375941514968872 / 0.8923900127410889
after epoch: 3,now: 2024-08-06 20:49:12.630157,epoch time: 0:25:46.645172,used: 1:18:53.777872,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99059886, 'precision': 0.99072444, 'recall': 0.99059796, 'specificity': 0.99059796, 'f1': 0.9905983, 'auroc': 0.9998677, 'binary_precision': 0.9829037, 'binary_recall': 0.9985687, 'binary_specificity': 0.9826272, 'binary_f1_score': 0.9906743}
confusion matrix:
       0      1
0  25396    449
1     37  25814
---- Validation: 
scalar performance:
{'acc': 0.8242817, 'precision': 0.55652773, 'recall': 0.8749553, 'specificity': 0.8749553, 'f1': 0.5531221, 'auroc': 0.94960177, 'binary_precision': 0.11523612, 'binary_recall': 0.9282297, 'binary_specificity': 0.82168084, 'binary_f1_score': 0.20501982}
confusion matrix:
       0     1
0  13727  2979
1     30   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.35176378, 'precision': 0.548956, 'recall': 0.6348985, 'specificity': 0.6348985, 'f1': 0.325209, 'auroc': 0.89687365, 'binary_precision': 0.10612916, 'binary_recall': 0.97114176, 'binary_specificity': 0.29865518, 'binary_f1_score': 0.19134735}
confusion matrix:
      0     1
0  2776  6519
1    23   774
early stop counter: 2
val acc:0.8242816925048828, best validation acc: 0.9491941332817078, corresponding to test acc:                         0.8375941514968872 / 0.8923900127410889
after epoch: 4,now: 2024-08-06 21:15:16.023554,epoch time: 0:26:03.393397,used: 1:44:57.171269,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99375194, 'precision': 0.99375796, 'recall': 0.99375236, 'specificity': 0.99375236, 'f1': 0.99375194, 'auroc': 0.9997933, 'binary_precision': 0.9955359, 'binary_recall': 0.9919548, 'binary_specificity': 0.99554986, 'binary_f1_score': 0.99374217}
confusion matrix:
       0      1
0  25727    115
1    208  25646
---- Validation: 
scalar performance:
{'acc': 0.96490306, 'precision': 0.68518096, 'recall': 0.82690215, 'specificity': 0.82690215, 'f1': 0.7342969, 'auroc': 0.9382218, 'binary_precision': 0.37848607, 'binary_recall': 0.6818182, 'binary_specificity': 0.9719861, 'binary_f1_score': 0.48676348}
confusion matrix:
       0    1
0  16238  468
1    133  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5544986, 'precision': 0.5637911, 'recall': 0.71914744, 'specificity': 0.71914744, 'f1': 0.46446258, 'auroc': 0.84211797, 'binary_precision': 0.14136125, 'binary_recall': 0.91468006, 'binary_specificity': 0.5236148, 'binary_f1_score': 0.24487737}
confusion matrix:
      0     1
0  4867  4428
1    68   729
better model found
persisted
after epoch: 5,now: 2024-08-06 21:45:50.525972,epoch time: 0:30:34.502418,used: 2:15:31.673687,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9932683, 'precision': 0.9933475, 'recall': 0.99326956, 'specificity': 0.99326956, 'f1': 0.99326813, 'auroc': 0.9998212, 'binary_precision': 0.9996474, 'binary_recall': 0.9868874, 'binary_specificity': 0.99965173, 'binary_f1_score': 0.9932264}
confusion matrix:
       0      1
0  25834      9
1    339  25514
---- Validation: 
scalar performance:
{'acc': 0.97512263, 'precision': 0.7410525, 'recall': 0.7924875, 'specificity': 0.7924875, 'f1': 0.7640816, 'auroc': 0.9451727, 'binary_precision': 0.49215686, 'binary_recall': 0.6004785, 'binary_specificity': 0.9844966, 'binary_f1_score': 0.5409483}
confusion matrix:
       0    1
0  16447  259
1    167  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83432424, 'precision': 0.6195359, 'recall': 0.7534772, 'specificity': 0.7534772, 'f1': 0.6447771, 'auroc': 0.81983495, 'binary_precision': 0.2724909, 'binary_recall': 0.6574655, 'binary_specificity': 0.849489, 'binary_f1_score': 0.3852941}
confusion matrix:
      0     1
0  7896  1399
1   273   524
better model found
persisted
after epoch: 6,now: 2024-08-06 22:12:19.220866,epoch time: 0:26:28.694894,used: 2:42:00.368581,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9914113, 'precision': 0.9914119, 'recall': 0.99141127, 'specificity': 0.99141127, 'f1': 0.9914113, 'auroc': 0.9994329, 'binary_precision': 0.9908806, 'binary_recall': 0.9919539, 'binary_specificity': 0.9908686, 'binary_f1_score': 0.99141693}
confusion matrix:
       0      1
0  25609    236
1    208  25643
---- Validation: 
scalar performance:
{'acc': 0.9727867, 'precision': 0.72179407, 'recall': 0.7772955, 'specificity': 0.7772955, 'f1': 0.7461818, 'auroc': 0.9256381, 'binary_precision': 0.4543726, 'binary_recall': 0.5717703, 'binary_specificity': 0.9828206, 'binary_f1_score': 0.5063559}
confusion matrix:
       0    1
0  16419  287
1    179  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8154974, 'precision': 0.6324222, 'recall': 0.83215857, 'specificity': 0.83215857, 'f1': 0.65598863, 'auroc': 0.8925249, 'binary_precision': 0.28023112, 'binary_recall': 0.8519448, 'binary_specificity': 0.81237227, 'binary_f1_score': 0.42173913}
confusion matrix:
      0     1
0  7551  1744
1   118   679
early stop counter: 1
val acc:0.9727867245674133, best validation acc: 0.9751226305961609, corresponding to test acc:                         0.8343242406845093 / 0.8923900127410889
after epoch: 7,now: 2024-08-06 22:38:50.987712,epoch time: 0:26:31.766846,used: 3:08:32.135427,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99493194, 'precision': 0.9949386, 'recall': 0.99493235, 'specificity': 0.99493235, 'f1': 0.99493194, 'auroc': 0.9997549, 'binary_precision': 0.9968163, 'binary_recall': 0.9930378, 'binary_specificity': 0.9968269, 'binary_f1_score': 0.9949235}
confusion matrix:
       0      1
0  25760     82
1    180  25674
---- Validation: 
scalar performance:
{'acc': 0.9739547, 'precision': 0.73454404, 'recall': 0.8362062, 'specificity': 0.8362062, 'f1': 0.7755146, 'auroc': 0.941085, 'binary_precision': 0.4768977, 'binary_recall': 0.69138753, 'binary_specificity': 0.9810248, 'binary_f1_score': 0.5644531}
confusion matrix:
       0    1
0  16389  317
1    129  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83323425, 'precision': 0.6335943, 'recall': 0.8039324, 'specificity': 0.8039324, 'f1': 0.6620133, 'auroc': 0.86076725, 'binary_precision': 0.29024622, 'binary_recall': 0.7691343, 'binary_specificity': 0.8387305, 'binary_f1_score': 0.42145067}
confusion matrix:
      0     1
0  7796  1499
1   184   613
early stop counter: 2
val acc:0.9739546775817871, best validation acc: 0.9751226305961609, corresponding to test acc:                         0.8343242406845093 / 0.8923900127410889
after epoch: 8,now: 2024-08-06 23:05:07.574154,epoch time: 0:26:16.586442,used: 3:34:48.721869,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9919336, 'precision': 0.9919474, 'recall': 0.99193406, 'specificity': 0.99193406, 'f1': 0.9919335, 'auroc': 0.99962693, 'binary_precision': 0.99459416, 'binary_recall': 0.9892465, 'binary_specificity': 0.9946216, 'binary_f1_score': 0.9919131}
confusion matrix:
       0      1
0  25705    139
1    278  25574
---- Validation: 
scalar performance:
{'acc': 0.9550339, 'precision': 0.5939175, 'recall': 0.63291276, 'specificity': 0.63291276, 'f1': 0.60947776, 'auroc': 0.9152234, 'binary_precision': 0.20568562, 'binary_recall': 0.2942584, 'binary_specificity': 0.9715671, 'binary_f1_score': 0.24212599}
confusion matrix:
       0    1
0  16231  475
1    295  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91785574, 'precision': 0.7258573, 'recall': 0.78505874, 'specificity': 0.78505874, 'f1': 0.750791, 'auroc': 0.90204126, 'binary_precision': 0.48449612, 'binary_recall': 0.6273526, 'binary_specificity': 0.94276494, 'binary_f1_score': 0.54674685}
confusion matrix:
      0    1
0  8763  532
1   297  500
new oracle model saved
early stop counter: 3
val acc:0.9550338983535767, best validation acc: 0.9751226305961609, corresponding to test acc:                         0.8343242406845093 / 0.9178557395935059
after epoch: 9,now: 2024-08-06 23:34:19.130838,epoch time: 0:29:11.556684,used: 4:04:00.278553,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9972725, 'precision': 0.9972731, 'recall': 0.9972727, 'specificity': 0.9972727, 'f1': 0.9972725, 'auroc': 0.9999155, 'binary_precision': 0.9978701, 'binary_recall': 0.99667364, 'binary_specificity': 0.9978717, 'binary_f1_score': 0.9972715}
confusion matrix:
       0      1
0  25787     55
1     86  25768
---- Validation: 
scalar performance:
{'acc': 0.97880167, 'precision': 0.77276963, 'recall': 0.8328591, 'specificity': 0.8328591, 'f1': 0.79960066, 'auroc': 0.9505347, 'binary_precision': 0.5536062, 'binary_recall': 0.67942584, 'binary_specificity': 0.98629236, 'binary_f1_score': 0.6100967}
confusion matrix:
       0    1
0  16477  229
1    134  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5990884, 'precision': 0.57145166, 'recall': 0.7445011, 'specificity': 0.7445011, 'f1': 0.49487197, 'auroc': 0.8663671, 'binary_precision': 0.15516876, 'binary_recall': 0.9171895, 'binary_specificity': 0.5718128, 'binary_f1_score': 0.26543212}
confusion matrix:
      0     1
0  5315  3980
1    66   731
better model found
persisted
after epoch: 10,now: 2024-08-07 00:01:08.253188,epoch time: 0:26:49.122350,used: 4:30:49.400903,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99692434, 'precision': 0.9969374, 'recall': 0.9969249, 'specificity': 0.9969249, 'f1': 0.99692434, 'auroc': 0.9998656, 'binary_precision': 0.9995334, 'binary_recall': 0.994314, 'binary_specificity': 0.9995357, 'binary_f1_score': 0.99691695}
confusion matrix:
       0      1
0  25831     12
1    147  25706
---- Validation: 
scalar performance:
{'acc': 0.96566224, 'precision': 0.6243321, 'recall': 0.6092038, 'specificity': 0.6092038, 'f1': 0.6162144, 'auroc': 0.9057616, 'binary_precision': 0.26775956, 'binary_recall': 0.23444976, 'binary_specificity': 0.9839579, 'binary_f1_score': 0.25}
confusion matrix:
       0    1
0  16438  268
1    320   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46145463, 'precision': 0.5512848, 'recall': 0.66863644, 'specificity': 0.66863644, 'f1': 0.4012978, 'auroc': 0.8501038, 'binary_precision': 0.11958662, 'binary_recall': 0.91468006, 'binary_specificity': 0.4225928, 'binary_f1_score': 0.21151893}
confusion matrix:
      0     1
0  3928  5367
1    68   729
early stop counter: 1
val acc:0.9656622409820557, best validation acc: 0.9788016676902771, corresponding to test acc:                         0.5990883708000183 / 0.9178557395935059
after epoch: 11,now: 2024-08-07 00:27:10.713505,epoch time: 0:26:02.460317,used: 4:56:51.861220,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9962473, 'precision': 0.99627286, 'recall': 0.996248, 'specificity': 0.996248, 'f1': 0.9962472, 'auroc': 0.9999094, 'binary_precision': 0.9998831, 'binary_recall': 0.99261206, 'binary_specificity': 0.9998839, 'binary_f1_score': 0.9962343}
confusion matrix:
       0      1
0  25840      3
1    191  25662
---- Validation: 
scalar performance:
{'acc': 0.97442186, 'precision': 0.6727722, 'recall': 0.5320562, 'specificity': 0.5320562, 'f1': 0.55019206, 'auroc': 0.9139198, 'binary_precision': 0.36842105, 'binary_recall': 0.066985644, 'binary_specificity': 0.99712676, 'binary_f1_score': 0.11336032}
confusion matrix:
       0   1
0  16658  48
1    390  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8181728, 'precision': 0.62921447, 'recall': 0.8158306, 'specificity': 0.8158306, 'f1': 0.65315974, 'auroc': 0.8684844, 'binary_precision': 0.27763495, 'binary_recall': 0.81304896, 'binary_specificity': 0.81861216, 'binary_f1_score': 0.41392523}
confusion matrix:
      0     1
0  7609  1686
1   149   648
early stop counter: 2
val acc:0.9744218587875366, best validation acc: 0.9788016676902771, corresponding to test acc:                         0.5990883708000183 / 0.9178557395935059
after epoch: 12,now: 2024-08-07 00:54:17.913208,epoch time: 0:27:07.199703,used: 5:23:59.060923,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99756265, 'precision': 0.99757075, 'recall': 0.99756265, 'specificity': 0.99756265, 'f1': 0.99756265, 'auroc': 0.99993396, 'binary_precision': 0.9995727, 'binary_recall': 0.99555093, 'binary_specificity': 0.9995744, 'binary_f1_score': 0.99755776}
confusion matrix:
       0      1
0  25837     11
1    115  25733
---- Validation: 
scalar performance:
{'acc': 0.9747723, 'precision': 0.723685, 'recall': 0.61270654, 'specificity': 0.61270654, 'f1': 0.64852774, 'auroc': 0.9388355, 'binary_precision': 0.46634614, 'binary_recall': 0.23205742, 'binary_specificity': 0.9933557, 'binary_f1_score': 0.30990416}
confusion matrix:
       0    1
0  16595  111
1    321   97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6458581, 'precision': 0.57704395, 'recall': 0.75727284, 'specificity': 0.75727284, 'f1': 0.5243995, 'auroc': 0.8621056, 'binary_precision': 0.16901073, 'binary_recall': 0.889586, 'binary_specificity': 0.62495965, 'binary_f1_score': 0.2840545}
confusion matrix:
      0     1
0  5809  3486
1    88   709
early stop counter: 3
val acc:0.9747722744941711, best validation acc: 0.9788016676902771, corresponding to test acc:                         0.5990883708000183 / 0.9178557395935059
after epoch: 13,now: 2024-08-07 01:22:58.813658,epoch time: 0:28:40.900450,used: 5:52:39.961373,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99835575, 'precision': 0.9983573, 'recall': 0.998356, 'specificity': 0.998356, 'f1': 0.9983558, 'auroc': 0.9999354, 'binary_precision': 0.99926376, 'binary_recall': 0.99744713, 'binary_specificity': 0.9992648, 'binary_f1_score': 0.9983547}
confusion matrix:
       0      1
0  25824     19
1     66  25787
---- Validation: 
scalar performance:
{'acc': 0.97880167, 'precision': 0.7756461, 'recall': 0.7955393, 'specificity': 0.7955393, 'f1': 0.7852202, 'auroc': 0.94843805, 'binary_precision': 0.5612472, 'binary_recall': 0.6028708, 'binary_specificity': 0.9882078, 'binary_f1_score': 0.58131486}
confusion matrix:
       0    1
0  16509  197
1    166  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77269125, 'precision': 0.60885096, 'recall': 0.8020375, 'specificity': 0.8020375, 'f1': 0.6145678, 'auroc': 0.8813145, 'binary_precision': 0.23560579, 'binary_recall': 0.8368883, 'binary_specificity': 0.76718664, 'binary_f1_score': 0.36769566}
confusion matrix:
      0     1
0  7131  2164
1   130   667
early stop counter: 4
val acc:0.9788016676902771, best validation acc: 0.9788016676902771, corresponding to test acc:                         0.5990883708000183 / 0.9178557395935059
after epoch: 14,now: 2024-08-07 01:48:50.578073,epoch time: 0:25:51.764415,used: 6:18:31.725788,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9981623, 'precision': 0.9981663, 'recall': 0.9981628, 'specificity': 0.9981628, 'f1': 0.9981623, 'auroc': 0.9999459, 'binary_precision': 0.9996509, 'binary_recall': 0.9966739, 'binary_specificity': 0.99965173, 'binary_f1_score': 0.9981601}
confusion matrix:
       0      1
0  25831      9
1     86  25770
---- Validation: 
scalar performance:
{'acc': 0.97669935, 'precision': 0.7630173, 'recall': 0.6381853, 'specificity': 0.6381853, 'f1': 0.6798916, 'auroc': 0.9452307, 'binary_precision': 0.5437788, 'binary_recall': 0.28229666, 'binary_specificity': 0.994074, 'binary_f1_score': 0.37165356}
confusion matrix:
       0    1
0  16607   99
1    300  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61553705, 'precision': 0.56763506, 'recall': 0.72934115, 'specificity': 0.72934115, 'f1': 0.5010639, 'auroc': 0.85045755, 'binary_precision': 0.15444967, 'binary_recall': 0.8644918, 'binary_specificity': 0.5941904, 'binary_f1_score': 0.26207682}
confusion matrix:
      0     1
0  5523  3772
1   108   689
early stop counter: 5
val acc:0.9766993522644043, best validation acc: 0.9788016676902771, corresponding to test acc:                         0.5990883708000183 / 0.9178557395935059
after epoch: 15,now: 2024-08-07 02:14:44.999534,epoch time: 0:25:54.421461,used: 6:44:26.147249,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_19_30_18_seed_2_24076675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 6:44:26.147249 at 2024-08-07 02:14:44.999534
persisted model performance metric: 

scalar performance:
{'acc': 0.5990884, 'precision': 0.57145166, 'recall': 0.7445011, 'specificity': 0.7445011, 'f1': 0.49487197, 'auroc': 0.8663671, 'binary_precision': 0.15516876, 'binary_recall': 0.9171895, 'binary_specificity': 0.5718128, 'binary_f1_score': 0.26543212}
confusion matrix:
      0     1
0  5315  3980
1    66   731
oracle model performance metric: 

scalar performance:
{'acc': 0.91785574, 'precision': 0.7258573, 'recall': 0.78505874, 'specificity': 0.78505874, 'f1': 0.750791, 'auroc': 0.90204126, 'binary_precision': 0.48449612, 'binary_recall': 0.6273526, 'binary_specificity': 0.94276494, 'binary_f1_score': 0.54674685}
confusion matrix:
      0    1
0  8763  532
1   297  500
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457558 KiB |   2003 MiB |   1812 TiB |   1812 TiB |
|       from large pool | 415154 KiB |   1970 MiB |   1788 TiB |   1788 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457558 KiB |   2003 MiB |   1812 TiB |   1812 TiB |
|       from large pool | 415154 KiB |   1970 MiB |   1788 TiB |   1788 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |   1998 MiB |   1811 TiB |   1811 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1787 TiB |   1787 TiB |
|       from small pool |  40858 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2274 MiB |   2280 MiB |   5192 MiB |   2918 MiB |
|       from large pool |   2210 MiB |   2212 MiB |   5096 MiB |   2886 MiB |
|       from small pool |     64 MiB |     70 MiB |     96 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 345257 KiB | 474509 KiB |   1370 TiB |   1370 TiB |
|       from large pool | 334414 KiB | 449880 KiB |   1345 TiB |   1345 TiB |
|       from small pool |  10843 KiB |  26410 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7447    |  350633 K  |  350628 K  |
|       from large pool |     187    |     311    |  171668 K  |  171667 K  |
|       from small pool |    4735    |    7259    |  178965 K  |  178960 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7447    |  350633 K  |  350628 K  |
|       from large pool |     187    |     311    |  171668 K  |  171667 K  |
|       from small pool |    4735    |    7259    |  178965 K  |  178960 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     128    |     259    |     134    |
|       from large pool |      93    |      94    |     211    |     118    |
|       from small pool |      32    |      35    |      48    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    3280    |  172601 K  |  172601 K  |
|       from large pool |      33    |      95    |  103600 K  |  103600 K  |
|       from small pool |      30    |    3247    |   69001 K  |   69001 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |   1812 TiB |   1812 TiB |
|       from large pool |  16640 KiB |   1970 MiB |   1788 TiB |   1788 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |   1812 TiB |   1812 TiB |
|       from large pool |  16640 KiB |   1970 MiB |   1788 TiB |   1788 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1811 TiB |   1811 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1787 TiB |   1787 TiB |
|       from small pool |      0 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    784 MiB |   2280 MiB |   5192 MiB |   4408 MiB |
|       from large pool |    732 MiB |   2212 MiB |   5096 MiB |   4364 MiB |
|       from small pool |     52 MiB |     70 MiB |     96 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 474509 KiB |   1370 TiB |   1370 TiB |
|       from large pool |  24320 KiB | 449880 KiB |   1345 TiB |   1345 TiB |
|       from small pool |      0 KiB |  26410 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7447    |  350633 K  |  350633 K  |
|       from large pool |       2    |     311    |  171668 K  |  171668 K  |
|       from small pool |       0    |    7259    |  178965 K  |  178965 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7447    |  350633 K  |  350633 K  |
|       from large pool |       2    |     311    |  171668 K  |  171668 K  |
|       from small pool |       0    |    7259    |  178965 K  |  178965 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     128    |     259    |     200    |
|       from large pool |      33    |      94    |     211    |     178    |
|       from small pool |      26    |      35    |      48    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3280    |  172603 K  |  172603 K  |
|       from large pool |       4    |      95    |  103600 K  |  103600 K  |
|       from small pool |       0    |    3247    |   69003 K  |   69003 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 02:32:16 2024]
Finished job 0.
1 of 1 steps (100%) done
