Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 21:32:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678

 Experiment start at: 2024-08-06 21:48:20.082774
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86287904, 'precision': 0.86928475, 'recall': 0.86292845, 'specificity': 0.86292845, 'f1': 0.8622932, 'auroc': 0.91955936, 'binary_precision': 0.91810954, 'binary_recall': 0.79705685, 'binary_specificity': 0.92880005, 'binary_f1_score': 0.85331136}
confusion matrix:
       0      1
0  23507   1802
1   5144  20203
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.88131344, 'precision': 0.5267957, 'recall': 0.61137795, 'specificity': 0.61137795, 'f1': 0.5271392, 'auroc': 0.7467139, 'binary_precision': 0.07188161, 'binary_recall': 0.32771084, 'binary_specificity': 0.8950451, 'binary_f1_score': 0.11790203}
confusion matrix:
       0     1
0  14975  1756
1    279   136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.786138, 'precision': 0.5241358, 'recall': 0.55032206, 'specificity': 0.55032206, 'f1': 0.5200087, 'auroc': 0.66383445, 'binary_precision': 0.115958035, 'binary_recall': 0.27202073, 'binary_specificity': 0.8286234, 'binary_f1_score': 0.16260163}
confusion matrix:
      0     1
0  7741  1601
1   562   210
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 22:12:59.426731,epoch time: 0:24:39.343957,used: 0:24:39.343957,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.904039, 'precision': 0.911252, 'recall': 0.9040835, 'specificity': 0.9040835, 'f1': 0.90362334, 'auroc': 0.95978063, 'binary_precision': 0.96588427, 'binary_recall': 0.83779836, 'binary_specificity': 0.9703686, 'binary_f1_score': 0.89729345}
confusion matrix:
       0      1
0  24561    750
1   4111  21234
---- Validation: 
scalar performance:
{'acc': 0.8565263, 'precision': 0.5360168, 'recall': 0.68797207, 'specificity': 0.68797207, 'f1': 0.53434706, 'auroc': 0.7961339, 'binary_precision': 0.08586472, 'binary_recall': 0.5108434, 'binary_specificity': 0.8651007, 'binary_f1_score': 0.14701803}
confusion matrix:
       0     1
0  14474  2257
1    203   212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76023334, 'precision': 0.558233, 'recall': 0.652158, 'specificity': 0.652158, 'f1': 0.55384034, 'auroc': 0.73502815, 'binary_precision': 0.16443361, 'binary_recall': 0.5246114, 'binary_specificity': 0.7797046, 'binary_f1_score': 0.25038642}
confusion matrix:
      0     1
0  7284  2058
1   367   405
early stop counter: 1
val acc:0.8565263152122498, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.7861379981040955
after epoch: 2,now: 2024-08-06 22:33:23.794673,epoch time: 0:20:24.367942,used: 0:45:03.711899,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92099655, 'precision': 0.92621636, 'recall': 0.92103374, 'specificity': 0.92103374, 'f1': 0.92075855, 'auroc': 0.9732605, 'binary_precision': 0.9735522, 'binary_recall': 0.86561453, 'binary_specificity': 0.97645295, 'binary_f1_score': 0.91641605}
confusion matrix:
       0      1
0  24715    596
1   3406  21939
---- Validation: 
scalar performance:
{'acc': 0.83780473, 'precision': 0.54361725, 'recall': 0.76179945, 'specificity': 0.76179945, 'f1': 0.53961873, 'auroc': 0.8370073, 'binary_precision': 0.09652115, 'binary_recall': 0.68192774, 'binary_specificity': 0.84167117, 'binary_f1_score': 0.16910666}
confusion matrix:
       0     1
0  14082  2649
1    132   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73511964, 'precision': 0.57566345, 'recall': 0.7241206, 'specificity': 0.7241206, 'f1': 0.56392986, 'auroc': 0.78719926, 'binary_precision': 0.18269551, 'binary_recall': 0.7111399, 'binary_specificity': 0.73710126, 'binary_f1_score': 0.2907069}
confusion matrix:
      0     1
0  6886  2456
1   223   549
early stop counter: 2
val acc:0.8378047347068787, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.7861379981040955
after epoch: 3,now: 2024-08-06 22:53:30.513377,epoch time: 0:20:06.718704,used: 1:05:10.430603,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9327424, 'precision': 0.9360193, 'recall': 0.93277156, 'specificity': 0.93277156, 'f1': 0.93261886, 'auroc': 0.97824013, 'binary_precision': 0.9739867, 'binary_recall': 0.8893273, 'binary_specificity': 0.9762159, 'binary_f1_score': 0.92973375}
confusion matrix:
       0      1
0  24709    602
1   2805  22540
---- Validation: 
scalar performance:
{'acc': 0.85028577, 'precision': 0.54962736, 'recall': 0.782294, 'specificity': 0.782294, 'f1': 0.55221945, 'auroc': 0.8600439, 'binary_precision': 0.107585706, 'binary_recall': 0.7108434, 'binary_specificity': 0.85374457, 'binary_f1_score': 0.18688628}
confusion matrix:
       0     1
0  14284  2447
1    120   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7545976, 'precision': 0.5860958, 'recall': 0.7471415, 'specificity': 0.7471415, 'f1': 0.58263963, 'auroc': 0.8141961, 'binary_precision': 0.2, 'binary_recall': 0.738342, 'binary_specificity': 0.7559409, 'binary_f1_score': 0.31474325}
confusion matrix:
      0     1
0  7062  2280
1   202   570
early stop counter: 3
val acc:0.8502857685089111, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.7861379981040955
after epoch: 4,now: 2024-08-06 23:13:44.717606,epoch time: 0:20:14.204229,used: 1:25:24.634832,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9378751, 'precision': 0.9398813, 'recall': 0.9378952, 'specificity': 0.9378952, 'f1': 0.9378061, 'auroc': 0.9816469, 'binary_precision': 0.96973675, 'binary_recall': 0.90403664, 'binary_specificity': 0.97175366, 'binary_f1_score': 0.9357349}
confusion matrix:
       0      1
0  24598    715
1   2432  22911
---- Validation: 
scalar performance:
{'acc': 0.84562, 'precision': 0.5518722, 'recall': 0.80575174, 'specificity': 0.80575174, 'f1': 0.55393845, 'auroc': 0.8768096, 'binary_precision': 0.11060712, 'binary_recall': 0.7638554, 'binary_specificity': 0.8476481, 'binary_f1_score': 0.19323377}
confusion matrix:
       0     1
0  14182  2549
1     98   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7619142, 'precision': 0.59245753, 'recall': 0.76357913, 'specificity': 0.76357913, 'f1': 0.59225947, 'auroc': 0.83126825, 'binary_precision': 0.2097232, 'binary_recall': 0.76554406, 'binary_specificity': 0.7616142, 'binary_f1_score': 0.3292479}
confusion matrix:
      0     1
0  7115  2227
1   181   591
early stop counter: 4
val acc:0.8456199765205383, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.7861379981040955
after epoch: 5,now: 2024-08-06 23:34:37.858080,epoch time: 0:20:53.140474,used: 1:46:17.775306,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94249445, 'precision': 0.9450668, 'recall': 0.94252, 'specificity': 0.94252, 'f1': 0.94241357, 'auroc': 0.9836223, 'binary_precision': 0.97907054, 'binary_recall': 0.9043993, 'binary_specificity': 0.9806408, 'binary_f1_score': 0.9402547}
confusion matrix:
       0      1
0  24821    490
1   2423  22922
---- Validation: 
scalar performance:
{'acc': 0.8523854, 'precision': 0.55458057, 'recall': 0.81156826, 'specificity': 0.81156826, 'f1': 0.56000143, 'auroc': 0.88574755, 'binary_precision': 0.11583152, 'binary_recall': 0.7686747, 'binary_specificity': 0.8544618, 'binary_f1_score': 0.20132534}
confusion matrix:
       0     1
0  14296  2435
1     96   319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7848527, 'precision': 0.6002196, 'recall': 0.7688664, 'specificity': 0.7688664, 'f1': 0.6092637, 'auroc': 0.8416531, 'binary_precision': 0.22599532, 'binary_recall': 0.75, 'binary_specificity': 0.78773284, 'binary_f1_score': 0.34733054}
confusion matrix:
      0     1
0  7359  1983
1   193   579
early stop counter: 5
val acc:0.852385401725769, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.7861379981040955
after epoch: 6,now: 2024-08-06 23:55:07.154701,epoch time: 0:20:29.296621,used: 2:06:47.071927,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9498184, 'precision': 0.9512331, 'recall': 0.9498328, 'specificity': 0.9498328, 'f1': 0.9497801, 'auroc': 0.9866687, 'binary_precision': 0.9766275, 'binary_recall': 0.9217474, 'binary_specificity': 0.9779182, 'binary_f1_score': 0.9483942}
confusion matrix:
       0      1
0  24756    559
1   1983  23358
---- Validation: 
scalar performance:
{'acc': 0.84789455, 'precision': 0.553671, 'recall': 0.8139669, 'specificity': 0.8139669, 'f1': 0.5572494, 'auroc': 0.88990986, 'binary_precision': 0.11377245, 'binary_recall': 0.7783133, 'binary_specificity': 0.84962046, 'binary_f1_score': 0.19852489}
confusion matrix:
       0     1
0  14215  2516
1     92   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78050226, 'precision': 0.59959096, 'recall': 0.7712646, 'specificity': 0.7712646, 'f1': 0.6070143, 'auroc': 0.84828424, 'binary_precision': 0.22387491, 'binary_recall': 0.7603627, 'binary_specificity': 0.78216654, 'binary_f1_score': 0.34590453}
confusion matrix:
      0     1
0  7307  2035
1   185   587
early stop counter: 6
val acc:0.847894549369812, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.7861379981040955
after epoch: 7,now: 2024-08-07 00:15:25.920667,epoch time: 0:20:18.765966,used: 2:27:05.837893,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95412195, 'precision': 0.9553802, 'recall': 0.95414174, 'specificity': 0.95414174, 'f1': 0.9540916, 'auroc': 0.98725855, 'binary_precision': 0.97950596, 'binary_recall': 0.9277232, 'binary_specificity': 0.9805603, 'binary_f1_score': 0.9529116}
confusion matrix:
       0      1
0  24817    492
1   1832  23515
---- Validation: 
scalar performance:
{'acc': 0.85098565, 'precision': 0.5557951, 'recall': 0.82260036, 'specificity': 0.82260036, 'f1': 0.5612916, 'auroc': 0.89537716, 'binary_precision': 0.11758399, 'binary_recall': 0.7927711, 'binary_specificity': 0.8524296, 'binary_f1_score': 0.20479302}
confusion matrix:
       0     1
0  14262  2469
1     86   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7942456, 'precision': 0.6072583, 'recall': 0.78286314, 'specificity': 0.78286314, 'f1': 0.6203531, 'auroc': 0.856508, 'binary_precision': 0.23788546, 'binary_recall': 0.76943004, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.3634139}
confusion matrix:
      0     1
0  7439  1903
1   178   594
new oracle model saved
early stop counter: 7
val acc:0.8509856462478638, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.7942456007003784
after epoch: 8,now: 2024-08-07 00:36:01.733988,epoch time: 0:20:35.813321,used: 2:47:41.651214,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9547339, 'precision': 0.9562535, 'recall': 0.9547522, 'specificity': 0.9547522, 'f1': 0.95469743, 'auroc': 0.9889653, 'binary_precision': 0.98274344, 'binary_recall': 0.92578125, 'binary_specificity': 0.98372316, 'binary_f1_score': 0.9534123}
confusion matrix:
       0      1
0  24900    412
1   1881  23463
---- Validation: 
scalar performance:
{'acc': 0.8802053, 'precision': 0.56624514, 'recall': 0.8222984, 'specificity': 0.8222984, 'f1': 0.5851532, 'auroc': 0.89760613, 'binary_precision': 0.13914575, 'binary_recall': 0.76144576, 'binary_specificity': 0.88315105, 'binary_f1_score': 0.23529412}
confusion matrix:
       0     1
0  14776  1955
1     99   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83409137, 'precision': 0.6239103, 'recall': 0.78007245, 'specificity': 0.78007245, 'f1': 0.6505383, 'auroc': 0.8623069, 'binary_precision': 0.2748509, 'binary_recall': 0.71632123, 'binary_specificity': 0.8438236, 'binary_f1_score': 0.3972701}
confusion matrix:
      0     1
0  7883  1459
1   219   553
new oracle model saved
early stop counter: 8
val acc:0.8802052736282349, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.8340913653373718
after epoch: 9,now: 2024-08-07 00:56:31.775136,epoch time: 0:20:30.041148,used: 3:08:11.692362,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95427984, 'precision': 0.9557278, 'recall': 0.9542955, 'specificity': 0.9542955, 'f1': 0.9542446, 'auroc': 0.9884999, 'binary_precision': 0.98155427, 'binary_recall': 0.92601216, 'binary_specificity': 0.9825788, 'binary_f1_score': 0.9529746}
confusion matrix:
       0      1
0  24873    441
1   1875  23467
---- Validation: 
scalar performance:
{'acc': 0.8706404, 'precision': 0.56373197, 'recall': 0.8314966, 'specificity': 0.8314966, 'f1': 0.57882845, 'auroc': 0.9018522, 'binary_precision': 0.13338755, 'binary_recall': 0.79036146, 'binary_specificity': 0.87263167, 'binary_f1_score': 0.2282533}
confusion matrix:
       0     1
0  14600  2131
1     87   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288511, 'precision': 0.6231776, 'recall': 0.78733623, 'specificity': 0.78733623, 'f1': 0.6486725, 'auroc': 0.86779773, 'binary_precision': 0.2715579, 'binary_recall': 0.738342, 'binary_specificity': 0.83633053, 'binary_f1_score': 0.39707422}
confusion matrix:
      0     1
0  7813  1529
1   202   570
early stop counter: 9
val acc:0.8706403970718384, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.8340913653373718
after epoch: 10,now: 2024-08-07 01:17:13.280841,epoch time: 0:20:41.505705,used: 3:28:53.198067,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95702386, 'precision': 0.9582521, 'recall': 0.95704126, 'specificity': 0.95704126, 'f1': 0.95699614, 'auroc': 0.989925, 'binary_precision': 0.98214436, 'binary_recall': 0.93103176, 'binary_specificity': 0.9830508, 'binary_f1_score': 0.9559053}
confusion matrix:
       0      1
0  24882    429
1   1748  23597
---- Validation: 
scalar performance:
{'acc': 0.87408143, 'precision': 0.56482756, 'recall': 0.8297349, 'specificity': 0.8297349, 'f1': 0.58141124, 'auroc': 0.90398467, 'binary_precision': 0.13575606, 'binary_recall': 0.78313255, 'binary_specificity': 0.87633735, 'binary_f1_score': 0.23139907}
confusion matrix:
       0     1
0  14662  2069
1     90   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84022146, 'precision': 0.62888825, 'recall': 0.7851732, 'specificity': 0.7851732, 'f1': 0.6576409, 'auroc': 0.86948085, 'binary_precision': 0.28425357, 'binary_recall': 0.7202073, 'binary_specificity': 0.85013914, 'binary_f1_score': 0.40762463}
confusion matrix:
      0     1
0  7942  1400
1   216   556
new oracle model saved
early stop counter: 10
val acc:0.8740814328193665, best validation acc: 0.8813134431838989, corresponding to test acc:                         0.7861379981040955 / 0.8402214646339417
after epoch: 11,now: 2024-08-07 01:37:50.533017,epoch time: 0:20:37.252176,used: 3:49:30.450243,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9597876, 'precision': 0.96108615, 'recall': 0.95980334, 'specificity': 0.95980334, 'f1': 0.95976025, 'auroc': 0.9907857, 'binary_precision': 0.9857036, 'binary_recall': 0.9331571, 'binary_specificity': 0.98644966, 'binary_f1_score': 0.9587109}
confusion matrix:
       0      1
0  24970    343
1   1694  23649
---- Validation: 
scalar performance:
{'acc': 0.88440454, 'precision': 0.57009035, 'recall': 0.83384955, 'specificity': 0.83384955, 'f1': 0.59189457, 'auroc': 0.9062639, 'binary_precision': 0.1462754, 'binary_recall': 0.7807229, 'binary_specificity': 0.88697624, 'binary_f1_score': 0.24638784}
confusion matrix:
       0     1
0  14840  1891
1     91   324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8524817, 'precision': 0.63688433, 'recall': 0.78527427, 'specificity': 0.78527427, 'f1': 0.66880083, 'auroc': 0.87314534, 'binary_precision': 0.30110496, 'binary_recall': 0.70595855, 'binary_specificity': 0.86459005, 'binary_f1_score': 0.42215338}
confusion matrix:
      0     1
0  8077  1265
1   227   545
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-07 01:58:08.189110,epoch time: 0:20:17.656093,used: 4:09:48.106336,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96093255, 'precision': 0.9615685, 'recall': 0.9609436, 'specificity': 0.9609436, 'f1': 0.96091974, 'auroc': 0.99139965, 'binary_precision': 0.978849, 'binary_recall': 0.942272, 'binary_specificity': 0.9796152, 'binary_f1_score': 0.9602123}
confusion matrix:
       0      1
0  24797    516
1   1463  23880
---- Validation: 
scalar performance:
{'acc': 0.8699988, 'precision': 0.56452256, 'recall': 0.83821744, 'specificity': 0.83821744, 'f1': 0.5797924, 'auroc': 0.9077326, 'binary_precision': 0.1345689, 'binary_recall': 0.8048193, 'binary_specificity': 0.8716156, 'binary_f1_score': 0.23058337}
confusion matrix:
       0     1
0  14583  2148
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8503065, 'precision': 0.6362082, 'recall': 0.7882558, 'specificity': 0.7882558, 'f1': 0.667861, 'auroc': 0.8732981, 'binary_precision': 0.2990249, 'binary_recall': 0.7150259, 'binary_specificity': 0.8614858, 'binary_f1_score': 0.42169595}
confusion matrix:
      0     1
0  8048  1294
1   220   552
early stop counter: 1
val acc:0.8699988126754761, best validation acc: 0.8844045400619507, corresponding to test acc:                         0.8524817228317261 / 0.8524817228317261
after epoch: 13,now: 2024-08-07 02:18:20.142338,epoch time: 0:20:11.953228,used: 4:30:00.059564,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9640714, 'precision': 0.96452326, 'recall': 0.96407944, 'specificity': 0.96407944, 'f1': 0.96406305, 'auroc': 0.9920734, 'binary_precision': 0.97914034, 'binary_recall': 0.94838405, 'binary_specificity': 0.97977483, 'binary_f1_score': 0.96351683}
confusion matrix:
       0      1
0  24803    512
1   1308  24033
---- Validation: 
scalar performance:
{'acc': 0.84486175, 'precision': 0.5556486, 'recall': 0.83356166, 'specificity': 0.83356166, 'f1': 0.5590622, 'auroc': 0.90902185, 'binary_precision': 0.11650154, 'binary_recall': 0.82168674, 'binary_specificity': 0.84543663, 'binary_f1_score': 0.20406942}
confusion matrix:
       0     1
0  14145  2586
1     74   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8266759, 'precision': 0.6247383, 'recall': 0.7968534, 'specificity': 0.7968534, 'f1': 0.6500835, 'auroc': 0.87748694, 'binary_precision': 0.27260083, 'binary_recall': 0.761658, 'binary_specificity': 0.83204883, 'binary_f1_score': 0.40150222}
confusion matrix:
      0     1
0  7773  1569
1   184   588
early stop counter: 2
val acc:0.8448617458343506, best validation acc: 0.8844045400619507, corresponding to test acc:                         0.8524817228317261 / 0.8524817228317261
after epoch: 14,now: 2024-08-07 02:38:47.550075,epoch time: 0:20:27.407737,used: 4:50:27.467301,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96486104, 'precision': 0.9656484, 'recall': 0.9648725, 'specificity': 0.9648725, 'f1': 0.96484673, 'auroc': 0.9929005, 'binary_precision': 0.98493457, 'binary_recall': 0.9442033, 'binary_specificity': 0.9855416, 'binary_f1_score': 0.9641389}
confusion matrix:
       0      1
0  24948    366
1   1414  23928
---- Validation: 
scalar performance:
{'acc': 0.8765893, 'precision': 0.56775314, 'recall': 0.8415944, 'specificity': 0.8415944, 'f1': 0.58639246, 'auroc': 0.91103595, 'binary_precision': 0.14098775, 'binary_recall': 0.8048193, 'binary_specificity': 0.8783695, 'binary_f1_score': 0.23994252}
confusion matrix:
       0     1
0  14696  2035
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8597983, 'precision': 0.6437495, 'recall': 0.79042315, 'specificity': 0.79042315, 'f1': 0.6777345, 'auroc': 0.87979186, 'binary_precision': 0.31436783, 'binary_recall': 0.7085492, 'binary_specificity': 0.87229717, 'binary_f1_score': 0.43550956}
confusion matrix:
      0     1
0  8149  1193
1   225   547
new oracle model saved
early stop counter: 3
val acc:0.876589298248291, best validation acc: 0.8844045400619507, corresponding to test acc:                         0.8524817228317261 / 0.8597983121871948
after epoch: 15,now: 2024-08-07 02:59:14.981747,epoch time: 0:20:27.431672,used: 5:10:54.898973,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9668746, 'precision': 0.96738875, 'recall': 0.9668858, 'specificity': 0.9668858, 'f1': 0.966866, 'auroc': 0.99295294, 'binary_precision': 0.98305917, 'binary_recall': 0.9501677, 'binary_specificity': 0.98360395, 'binary_f1_score': 0.9663336}
confusion matrix:
       0      1
0  24896    415
1   1263  24082
---- Validation: 
scalar performance:
{'acc': 0.8630001, 'precision': 0.56175, 'recall': 0.8369812, 'specificity': 0.8369812, 'f1': 0.5736627, 'auroc': 0.9117931, 'binary_precision': 0.12893324, 'binary_recall': 0.80963856, 'binary_specificity': 0.86432374, 'binary_f1_score': 0.2224429}
confusion matrix:
       0     1
0  14461  2270
1     79   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8458572, 'precision': 0.6357256, 'recall': 0.7971362, 'specificity': 0.7971362, 'f1': 0.66692895, 'auroc': 0.88109094, 'binary_precision': 0.2960083, 'binary_recall': 0.7396373, 'binary_specificity': 0.854635, 'binary_f1_score': 0.42280638}
confusion matrix:
      0     1
0  7984  1358
1   201   571
early stop counter: 4
val acc:0.8630000948905945, best validation acc: 0.8844045400619507, corresponding to test acc:                         0.8524817228317261 / 0.8597983121871948
after epoch: 16,now: 2024-08-07 03:20:18.212328,epoch time: 0:21:03.230581,used: 5:31:58.129554,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9651769, 'precision': 0.9660171, 'recall': 0.9651886, 'specificity': 0.9651886, 'f1': 0.9651618, 'auroc': 0.9928323, 'binary_precision': 0.9859439, 'binary_recall': 0.94384813, 'binary_specificity': 0.9865292, 'binary_f1_score': 0.9644369}
confusion matrix:
       0      1
0  24973    341
1   1423  23919
---- Validation: 
scalar performance:
{'acc': 0.88376296, 'precision': 0.5704938, 'recall': 0.8382206, 'specificity': 0.8382206, 'f1': 0.59232837, 'auroc': 0.9126173, 'binary_precision': 0.14682184, 'binary_recall': 0.79036146, 'binary_specificity': 0.8860797, 'binary_f1_score': 0.24764061}
confusion matrix:
       0     1
0  14825  1906
1     87   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8721574, 'precision': 0.65580136, 'recall': 0.79592514, 'specificity': 0.79592514, 'f1': 0.69247466, 'auroc': 0.881654, 'binary_precision': 0.33829919, 'binary_recall': 0.70595855, 'binary_specificity': 0.8858917, 'binary_f1_score': 0.4574066}
confusion matrix:
      0     1
0  8276  1066
1   227   545
new oracle model saved
early stop counter: 5
val acc:0.8837629556655884, best validation acc: 0.8844045400619507, corresponding to test acc:                         0.8524817228317261 / 0.8721573948860168
after epoch: 17,now: 2024-08-07 03:40:16.909654,epoch time: 0:19:58.697326,used: 5:51:56.826880,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9667956, 'precision': 0.9675333, 'recall': 0.96680903, 'specificity': 0.96680903, 'f1': 0.96678317, 'auroc': 0.99334526, 'binary_precision': 0.98627263, 'binary_recall': 0.94681394, 'binary_specificity': 0.9868041, 'binary_f1_score': 0.9661405}
confusion matrix:
       0      1
0  24977    334
1   1348  23997
---- Validation: 
scalar performance:
{'acc': 0.88370466, 'precision': 0.5708426, 'recall': 0.8405406, 'specificity': 0.8405406, 'f1': 0.59282786, 'auroc': 0.9135276, 'binary_precision': 0.14738722, 'binary_recall': 0.79518074, 'binary_specificity': 0.88590044, 'binary_f1_score': 0.24868123}
confusion matrix:
       0     1
0  14822  1909
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8721574, 'precision': 0.657658, 'recall': 0.80305487, 'specificity': 0.80305487, 'f1': 0.695131, 'auroc': 0.88609254, 'binary_precision': 0.3406728, 'binary_recall': 0.7215026, 'binary_specificity': 0.88460714, 'binary_f1_score': 0.4628168}
confusion matrix:
      0     1
0  8264  1078
1   215   557
early stop counter: 6
val acc:0.883704662322998, best validation acc: 0.8844045400619507, corresponding to test acc:                         0.8524817228317261 / 0.8721573948860168
after epoch: 18,now: 2024-08-07 04:00:13.159169,epoch time: 0:19:56.249515,used: 6:11:53.076395,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9696976, 'precision': 0.96999156, 'recall': 0.9697056, 'specificity': 0.9697056, 'f1': 0.9696932, 'auroc': 0.99433774, 'binary_precision': 0.98190504, 'binary_recall': 0.9570707, 'binary_specificity': 0.9823404, 'binary_f1_score': 0.9693288}
confusion matrix:
       0      1
0  24865    447
1   1088  24256
---- Validation: 
scalar performance:
{'acc': 0.86335003, 'precision': 0.5626046, 'recall': 0.8418602, 'specificity': 0.8418602, 'f1': 0.5750058, 'auroc': 0.9156743, 'binary_precision': 0.1303681, 'binary_recall': 0.8192771, 'binary_specificity': 0.86444324, 'binary_f1_score': 0.2249421}
confusion matrix:
       0     1
0  14463  2268
1     75   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85347044, 'precision': 0.64343536, 'recall': 0.8066046, 'specificity': 0.8066046, 'f1': 0.67739487, 'auroc': 0.8884176, 'binary_precision': 0.31016043, 'binary_recall': 0.7512953, 'binary_specificity': 0.8619139, 'binary_f1_score': 0.4390613}
confusion matrix:
      0     1
0  8052  1290
1   192   580
early stop counter: 7
val acc:0.8633500337600708, best validation acc: 0.8844045400619507, corresponding to test acc:                         0.8524817228317261 / 0.8721573948860168
after epoch: 19,now: 2024-08-07 04:20:26.052297,epoch time: 0:20:12.893128,used: 6:32:05.969523,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.969816, 'precision': 0.9702008, 'recall': 0.9698263, 'specificity': 0.9698263, 'f1': 0.96981025, 'auroc': 0.9945866, 'binary_precision': 0.9838297, 'binary_recall': 0.9553776, 'binary_specificity': 0.984275, 'binary_f1_score': 0.96939486}
confusion matrix:
       0      1
0  24912    398
1   1131  24215
---- Validation: 
scalar performance:
{'acc': 0.8809635, 'precision': 0.5693184, 'recall': 0.839136, 'specificity': 0.839136, 'f1': 0.58987343, 'auroc': 0.9153521, 'binary_precision': 0.14435695, 'binary_recall': 0.79518074, 'binary_specificity': 0.8830913, 'binary_f1_score': 0.24435394}
confusion matrix:
       0     1
0  14775  1956
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87957287, 'precision': 0.66297245, 'recall': 0.79518604, 'specificity': 0.79518604, 'f1': 0.70033914, 'auroc': 0.885471, 'binary_precision': 0.35328948, 'binary_recall': 0.69559586, 'binary_specificity': 0.8947763, 'binary_f1_score': 0.4685864}
confusion matrix:
      0    1
0  8359  983
1   235  537
new oracle model saved
early stop counter: 8
val acc:0.8809635043144226, best validation acc: 0.8844045400619507, corresponding to test acc:                         0.8524817228317261 / 0.879572868347168
after epoch: 20,now: 2024-08-07 04:40:31.743550,epoch time: 0:20:05.691253,used: 6:52:11.660776,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_48_19_seed_0_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:52:11.660776 at 2024-08-07 04:40:31.743550
persisted model performance metric: 

scalar performance:
{'acc': 0.8524817, 'precision': 0.63688433, 'recall': 0.78527427, 'specificity': 0.78527427, 'f1': 0.66880083, 'auroc': 0.87314534, 'binary_precision': 0.30110496, 'binary_recall': 0.70595855, 'binary_specificity': 0.86459005, 'binary_f1_score': 0.42215338}
confusion matrix:
      0     1
0  8077  1265
1   227   545
oracle model performance metric: 

scalar performance:
{'acc': 0.87957287, 'precision': 0.66297245, 'recall': 0.79518604, 'specificity': 0.79518604, 'f1': 0.70033914, 'auroc': 0.885471, 'binary_precision': 0.35328948, 'binary_recall': 0.69559586, 'binary_specificity': 0.8947763, 'binary_f1_score': 0.4685864}
confusion matrix:
      0    1
0  8359  983
1   235  537
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 482683 GiB | 482683 GiB |
|       from small pool |  16663 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59172 KiB | 732464 KiB | 276936 GiB | 276936 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 269472 GiB | 269472 GiB |
|       from small pool |   8410 KiB |  10852 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6827    |   92214 K  |   92209 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46589 K  |   46585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6827    |   92214 K  |   92209 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46589 K  |   46585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3188    |   54210 K  |   54210 K  |
|       from large pool |      10    |     350    |   34657 K  |   34657 K  |
|       from small pool |      23    |    3178    |   19553 K  |   19553 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482683 GiB | 482683 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276936 GiB | 276936 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269472 GiB | 269472 GiB |
|       from small pool |      0 KiB |  22549 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92214 K  |   92214 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92214 K  |   92214 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3188    |   54212 K  |   54212 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3178    |   19555 K  |   19555 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482683 GiB | 482683 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276936 GiB | 276936 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269472 GiB | 269472 GiB |
|       from small pool |      0 KiB |  22549 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92214 K  |   92214 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92214 K  |   92214 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3188    |   54212 K  |   54212 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3178    |   19555 K  |   19555 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678

 Experiment start at: 2024-08-07 05:09:04.700940
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.82534623, 'precision': 0.826516, 'recall': 0.8253697, 'specificity': 0.8253697, 'f1': 0.82519686, 'auroc': 0.89630795, 'binary_precision': 0.8462568, 'binary_recall': 0.7954867, 'binary_specificity': 0.8552528, 'binary_f1_score': 0.8200867}
confusion matrix:
       0      1
0  21720   3676
1   5202  20234
---- Validation: 
scalar performance:
{'acc': 0.87735796, 'precision': 0.5026153, 'recall': 0.5099033, 'specificity': 0.5099033, 'f1': 0.49125385, 'auroc': 0.7256812, 'binary_precision': 0.029859155, 'binary_recall': 0.122969836, 'binary_specificity': 0.8968368, 'binary_f1_score': 0.04805077}
confusion matrix:
       0     1
0  14970  1722
1    378    53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79209197, 'precision': 0.49168494, 'recall': 0.48461074, 'specificity': 0.48461074, 'f1': 0.48210815, 'auroc': 0.63576007, 'binary_precision': 0.06090373, 'binary_recall': 0.12285337, 'binary_specificity': 0.84636813, 'binary_f1_score': 0.08143608}
confusion matrix:
      0     1
0  7900  1434
1   664    93
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 05:30:12.518250,epoch time: 0:21:07.817310,used: 0:21:07.817310,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8824756, 'precision': 0.886987, 'recall': 0.88252234, 'specificity': 0.88252234, 'f1': 0.8821411, 'auroc': 0.94096935, 'binary_precision': 0.928987, 'binary_recall': 0.82848495, 'binary_specificity': 0.9365598, 'binary_f1_score': 0.8758623}
confusion matrix:
       0      1
0  23783   1611
1   4363  21075
---- Validation: 
scalar performance:
{'acc': 0.90101033, 'precision': 0.514146, 'recall': 0.5435075, 'specificity': 0.5435075, 'f1': 0.51299995, 'auroc': 0.7754677, 'binary_precision': 0.051136363, 'binary_recall': 0.16705337, 'binary_specificity': 0.91996163, 'binary_f1_score': 0.078303434}
confusion matrix:
       0     1
0  15356  1336
1    359    72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82380337, 'precision': 0.5126151, 'recall': 0.5199604, 'specificity': 0.5199604, 'f1': 0.5118116, 'auroc': 0.7100208, 'binary_precision': 0.09707972, 'binary_recall': 0.16248348, 'binary_specificity': 0.87743735, 'binary_f1_score': 0.12154151}
confusion matrix:
      0     1
0  8190  1144
1   634   123
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 05:50:55.142842,epoch time: 0:20:42.624592,used: 0:41:50.441902,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9032696, 'precision': 0.9101725, 'recall': 0.90332067, 'specificity': 0.90332067, 'f1': 0.90286887, 'auroc': 0.95918846, 'binary_precision': 0.9635805, 'binary_recall': 0.83837867, 'binary_specificity': 0.96826273, 'binary_f1_score': 0.89663005}
confusion matrix:
       0      1
0  24590    806
1   4111  21325
---- Validation: 
scalar performance:
{'acc': 0.9160778, 'precision': 0.53403324, 'recall': 0.59192073, 'specificity': 0.59192073, 'f1': 0.5432911, 'auroc': 0.8078499, 'binary_precision': 0.0883797, 'binary_recall': 0.25058004, 'binary_specificity': 0.93326145, 'binary_f1_score': 0.1306715}
confusion matrix:
       0     1
0  15578  1114
1    323   108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84748787, 'precision': 0.54481554, 'recall': 0.56432366, 'specificity': 0.56432366, 'f1': 0.5505763, 'auroc': 0.75885487, 'binary_precision': 0.15459365, 'binary_recall': 0.23117569, 'binary_specificity': 0.8974716, 'binary_f1_score': 0.18528323}
confusion matrix:
      0    1
0  8377  957
1   582  175
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 06:11:14.109110,epoch time: 0:20:18.966268,used: 1:02:09.408170,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.91839784, 'precision': 0.9226086, 'recall': 0.9184412, 'specificity': 0.9184412, 'f1': 0.91819966, 'auroc': 0.9715167, 'binary_precision': 0.9650096, 'binary_recall': 0.8684252, 'binary_specificity': 0.9684571, 'binary_f1_score': 0.9141734}
confusion matrix:
       0      1
0  24593    801
1   3347  22091
---- Validation: 
scalar performance:
{'acc': 0.92448753, 'precision': 0.55326813, 'recall': 0.63578904, 'specificity': 0.63578904, 'f1': 0.570773, 'auroc': 0.8293315, 'binary_precision': 0.12456446, 'binary_recall': 0.33178654, 'binary_specificity': 0.9397915, 'binary_f1_score': 0.18112731}
confusion matrix:
       0     1
0  15687  1005
1    288   143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85710037, 'precision': 0.5857595, 'recall': 0.63385475, 'specificity': 0.63385475, 'f1': 0.60055625, 'auroc': 0.8034214, 'binary_precision': 0.22534081, 'binary_recall': 0.3712021, 'binary_specificity': 0.8965074, 'binary_f1_score': 0.2804391}
confusion matrix:
      0    1
0  8368  966
1   476  281
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 06:31:22.731292,epoch time: 0:20:08.622182,used: 1:22:18.030352,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9280965, 'precision': 0.9320674, 'recall': 0.92813426, 'specificity': 0.92813426, 'f1': 0.9279351, 'auroc': 0.97727656, 'binary_precision': 0.9736854, 'binary_recall': 0.8800912, 'binary_specificity': 0.97617733, 'binary_f1_score': 0.92452556}
confusion matrix:
       0      1
0  24791    605
1   3050  22386
---- Validation: 
scalar performance:
{'acc': 0.9351165, 'precision': 0.574513, 'recall': 0.6694942, 'specificity': 0.6694942, 'f1': 0.5991658, 'auroc': 0.8449998, 'binary_precision': 0.16535433, 'binary_recall': 0.3897912, 'binary_specificity': 0.94919723, 'binary_f1_score': 0.23220457}
confusion matrix:
       0    1
0  15844  848
1    263  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8621544, 'precision': 0.603001, 'recall': 0.6657195, 'specificity': 0.6657195, 'f1': 0.6222107, 'auroc': 0.82653224, 'binary_precision': 0.25464398, 'binary_recall': 0.4346103, 'binary_specificity': 0.8968288, 'binary_f1_score': 0.32113227}
confusion matrix:
      0    1
0  8371  963
1   428  329
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 06:51:27.642057,epoch time: 0:20:04.910765,used: 1:42:22.941117,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9403919, 'precision': 0.942924, 'recall': 0.94042027, 'specificity': 0.94042027, 'f1': 0.94030917, 'auroc': 0.9837499, 'binary_precision': 0.9766007, 'binary_recall': 0.9024966, 'binary_specificity': 0.9783439, 'binary_f1_score': 0.93808746}
confusion matrix:
       0      1
0  24847    550
1   2480  22955
---- Validation: 
scalar performance:
{'acc': 0.93710214, 'precision': 0.587765, 'recall': 0.7044168, 'specificity': 0.7044168, 'f1': 0.6179883, 'auroc': 0.8558408, 'binary_precision': 0.19001919, 'binary_recall': 0.45939675, 'binary_specificity': 0.94943684, 'binary_f1_score': 0.2688391}
confusion matrix:
       0    1
0  15848  844
1    233  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8669111, 'precision': 0.62821287, 'recall': 0.7247357, 'specificity': 0.7247357, 'f1': 0.65564245, 'auroc': 0.84755826, 'binary_precision': 0.2951049, 'binary_recall': 0.55746365, 'binary_specificity': 0.8920077, 'binary_f1_score': 0.3859168}
confusion matrix:
      0     1
0  8326  1008
1   335   422
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 07:11:55.733456,epoch time: 0:20:28.091399,used: 2:02:51.032516,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94145423, 'precision': 0.94457173, 'recall': 0.9414906, 'specificity': 0.9414906, 'f1': 0.9413547, 'auroc': 0.98504615, 'binary_precision': 0.98201716, 'binary_recall': 0.8994811, 'binary_specificity': 0.98350006, 'binary_f1_score': 0.9389388}
confusion matrix:
       0      1
0  24975    419
1   2557  22881
---- Validation: 
scalar performance:
{'acc': 0.9449863, 'precision': 0.6026451, 'recall': 0.7107209, 'specificity': 0.7107209, 'f1': 0.6347169, 'auroc': 0.8616173, 'binary_precision': 0.21953897, 'binary_recall': 0.46403712, 'binary_specificity': 0.95740473, 'binary_f1_score': 0.2980626}
confusion matrix:
       0    1
0  15981  711
1    231  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87047863, 'precision': 0.6328787, 'recall': 0.7290919, 'specificity': 0.7290919, 'f1': 0.6610544, 'auroc': 0.85723877, 'binary_precision': 0.30385163, 'binary_recall': 0.5627477, 'binary_specificity': 0.89543605, 'binary_f1_score': 0.39462715}
confusion matrix:
      0    1
0  8358  976
1   331  426
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-07 07:32:18.214861,epoch time: 0:20:22.481405,used: 2:23:13.513921,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9471002, 'precision': 0.9486767, 'recall': 0.9471225, 'specificity': 0.9471225, 'f1': 0.9470556, 'auroc': 0.9863876, 'binary_precision': 0.9754599, 'binary_recall': 0.917358, 'binary_specificity': 0.97688705, 'binary_f1_score': 0.9455172}
confusion matrix:
       0      1
0  24810    587
1   2102  23333
---- Validation: 
scalar performance:
{'acc': 0.9399054, 'precision': 0.6036217, 'recall': 0.7465396, 'specificity': 0.7465396, 'f1': 0.64060223, 'auroc': 0.8687953, 'binary_precision': 0.2195122, 'binary_recall': 0.54292345, 'binary_specificity': 0.95015574, 'binary_f1_score': 0.31262523}
confusion matrix:
       0    1
0  15860  832
1    197  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86393815, 'precision': 0.6391935, 'recall': 0.76925564, 'specificity': 0.76925564, 'f1': 0.67167604, 'auroc': 0.867133, 'binary_precision': 0.308933, 'binary_recall': 0.65786, 'binary_specificity': 0.88065135, 'binary_f1_score': 0.42043057}
confusion matrix:
      0     1
0  8220  1114
1   259   498
early stop counter: 1
val acc:0.9399054050445557, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 8,now: 2024-08-07 07:52:42.898989,epoch time: 0:20:24.684128,used: 2:43:38.198049,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.950838, 'precision': 0.95203733, 'recall': 0.9508605, 'specificity': 0.9508605, 'f1': 0.9508071, 'auroc': 0.9880438, 'binary_precision': 0.97553796, 'binary_recall': 0.9249548, 'binary_specificity': 0.97676617, 'binary_f1_score': 0.9495732}
confusion matrix:
       0      1
0  24804    590
1   1909  23529
---- Validation: 
scalar performance:
{'acc': 0.9410734, 'precision': 0.60660684, 'recall': 0.75052905, 'specificity': 0.75052905, 'f1': 0.64441276, 'auroc': 0.8720329, 'binary_precision': 0.22528517, 'binary_recall': 0.54988396, 'binary_specificity': 0.9511742, 'binary_f1_score': 0.3196224}
confusion matrix:
       0    1
0  15877  815
1    194  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8614607, 'precision': 0.6412556, 'recall': 0.7836968, 'specificity': 0.7836968, 'f1': 0.674816, 'auroc': 0.8738595, 'binary_precision': 0.31024274, 'binary_recall': 0.6922061, 'binary_specificity': 0.8751875, 'binary_f1_score': 0.42845464}
confusion matrix:
      0     1
0  8169  1165
1   233   524
early stop counter: 2
val acc:0.9410734176635742, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 9,now: 2024-08-07 08:12:39.093501,epoch time: 0:19:56.194512,used: 3:03:34.392561,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9527463, 'precision': 0.95396686, 'recall': 0.95276475, 'specificity': 0.95276475, 'f1': 0.9527159, 'auroc': 0.98848355, 'binary_precision': 0.9776838, 'binary_recall': 0.9267123, 'binary_specificity': 0.9788172, 'binary_f1_score': 0.9515159}
confusion matrix:
       0      1
0  24860    538
1   1864  23570
---- Validation: 
scalar performance:
{'acc': 0.9411902, 'precision': 0.6076925, 'recall': 0.75397944, 'specificity': 0.75397944, 'f1': 0.64602894, 'auroc': 0.87553024, 'binary_precision': 0.22727273, 'binary_recall': 0.55684453, 'binary_specificity': 0.9511143, 'binary_f1_score': 0.32279757}
confusion matrix:
       0    1
0  15876  816
1    191  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8610643, 'precision': 0.6437175, 'recall': 0.79380035, 'specificity': 0.79380035, 'f1': 0.67818487, 'auroc': 0.87779087, 'binary_precision': 0.31326, 'binary_recall': 0.71466315, 'binary_specificity': 0.8729376, 'binary_f1_score': 0.4355878}
confusion matrix:
      0     1
0  8148  1186
1   216   541
early stop counter: 3
val acc:0.9411901831626892, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 10,now: 2024-08-07 08:32:44.496872,epoch time: 0:20:05.403371,used: 3:23:39.795932,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9547136, 'precision': 0.9562436, 'recall': 0.9547342, 'specificity': 0.9547342, 'f1': 0.954677, 'auroc': 0.9898485, 'binary_precision': 0.9828421, 'binary_recall': 0.9256507, 'binary_specificity': 0.98381764, 'binary_f1_score': 0.95338947}
confusion matrix:
       0      1
0  24987    411
1   1891  23543
---- Validation: 
scalar performance:
{'acc': 0.9447527, 'precision': 0.61439073, 'recall': 0.7546765, 'specificity': 0.7546765, 'f1': 0.65342605, 'auroc': 0.87629443, 'binary_precision': 0.24068479, 'binary_recall': 0.55452436, 'binary_specificity': 0.9548287, 'binary_f1_score': 0.33567417}
confusion matrix:
       0    1
0  15938  754
1    192  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86413634, 'precision': 0.64824927, 'recall': 0.80153036, 'specificity': 0.80153036, 'f1': 0.68409723, 'auroc': 0.8843142, 'binary_precision': 0.3210956, 'binary_recall': 0.7278732, 'binary_specificity': 0.8751875, 'binary_f1_score': 0.44561264}
confusion matrix:
      0     1
0  8169  1165
1   206   551
early stop counter: 4
val acc:0.9447526931762695, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 11,now: 2024-08-07 08:53:12.295934,epoch time: 0:20:27.799062,used: 3:44:07.594994,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9576251, 'precision': 0.95874333, 'recall': 0.95764464, 'specificity': 0.95764464, 'f1': 0.9576005, 'auroc': 0.99077606, 'binary_precision': 0.9815903, 'binary_recall': 0.93281174, 'binary_specificity': 0.98247755, 'binary_f1_score': 0.95657957}
confusion matrix:
       0      1
0  24951    445
1   1709  23727
---- Validation: 
scalar performance:
{'acc': 0.93879575, 'precision': 0.6100579, 'recall': 0.77987456, 'specificity': 0.77987456, 'f1': 0.6514735, 'auroc': 0.8803953, 'binary_precision': 0.23056768, 'binary_recall': 0.612529, 'binary_specificity': 0.9472202, 'binary_f1_score': 0.33502537}
confusion matrix:
       0    1
0  15811  881
1    167  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.854722, 'precision': 0.64455897, 'recall': 0.81464946, 'specificity': 0.81464946, 'f1': 0.6793238, 'auroc': 0.8868461, 'binary_precision': 0.31052914, 'binary_recall': 0.7675033, 'binary_specificity': 0.8617956, 'binary_f1_score': 0.44216135}
confusion matrix:
      0     1
0  8044  1290
1   176   581
early stop counter: 5
val acc:0.9387957453727722, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 12,now: 2024-08-07 09:13:42.193029,epoch time: 0:20:29.897095,used: 4:04:37.492089,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9613629, 'precision': 0.96177447, 'recall': 0.96137476, 'specificity': 0.96137476, 'f1': 0.961355, 'auroc': 0.9917759, 'binary_precision': 0.9757581, 'binary_recall': 0.9462966, 'binary_specificity': 0.976453, 'binary_f1_score': 0.96080154}
confusion matrix:
       0      1
0  24798    598
1   1366  24070
---- Validation: 
scalar performance:
{'acc': 0.9249547, 'precision': 0.5992165, 'recall': 0.8145905, 'specificity': 0.8145905, 'f1': 0.6396571, 'auroc': 0.8833817, 'binary_precision': 0.20673077, 'binary_recall': 0.6983759, 'binary_specificity': 0.93080515, 'binary_f1_score': 0.31902492}
confusion matrix:
       0     1
0  15537  1155
1    130   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8396591, 'precision': 0.6397634, 'recall': 0.83321226, 'specificity': 0.83321226, 'f1': 0.6711967, 'auroc': 0.8910984, 'binary_precision': 0.29606822, 'binary_recall': 0.8256275, 'binary_specificity': 0.84079707, 'binary_f1_score': 0.4358438}
confusion matrix:
      0     1
0  7848  1486
1   132   625
early stop counter: 6
val acc:0.9249547123908997, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 13,now: 2024-08-07 09:34:07.319019,epoch time: 0:20:25.125990,used: 4:25:02.618079,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9603006, 'precision': 0.9607741, 'recall': 0.9603133, 'specificity': 0.9603133, 'f1': 0.96029115, 'auroc': 0.9912921, 'binary_precision': 0.97574353, 'binary_recall': 0.9441343, 'binary_specificity': 0.97649235, 'binary_f1_score': 0.95967877}
confusion matrix:
       0      1
0  24799    597
1   1421  24015
---- Validation: 
scalar performance:
{'acc': 0.93254685, 'precision': 0.60600495, 'recall': 0.8026627, 'specificity': 0.8026627, 'f1': 0.648232, 'auroc': 0.8823601, 'binary_precision': 0.2211094, 'binary_recall': 0.66589326, 'binary_specificity': 0.9394321, 'binary_f1_score': 0.3319838}
confusion matrix:
       0     1
0  15681  1011
1    144   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8451095, 'precision': 0.6426876, 'recall': 0.83190995, 'specificity': 0.83190995, 'f1': 0.67583543, 'auroc': 0.89126444, 'binary_precision': 0.30264446, 'binary_recall': 0.81638044, 'binary_specificity': 0.84743947, 'binary_f1_score': 0.4415863}
confusion matrix:
      0     1
0  7910  1424
1   139   618
early stop counter: 7
val acc:0.932546854019165, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 14,now: 2024-08-07 09:54:54.718121,epoch time: 0:20:47.399102,used: 4:45:50.017181,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96372366, 'precision': 0.96416104, 'recall': 0.9637364, 'specificity': 0.9637364, 'f1': 0.96371573, 'auroc': 0.9927136, 'binary_precision': 0.9786181, 'binary_recall': 0.948225, 'binary_specificity': 0.97924787, 'binary_f1_score': 0.9631818}
confusion matrix:
       0      1
0  24868    527
1   1317  24120
---- Validation: 
scalar performance:
{'acc': 0.9335397, 'precision': 0.6069828, 'recall': 0.80091166, 'specificity': 0.80091166, 'f1': 0.6493746, 'auroc': 0.88286984, 'binary_precision': 0.22317933, 'binary_recall': 0.6612529, 'binary_specificity': 0.94057035, 'binary_f1_score': 0.33372366}
confusion matrix:
       0    1
0  15700  992
1    146  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84818155, 'precision': 0.6453642, 'recall': 0.8347844, 'specificity': 0.8347844, 'f1': 0.6796675, 'auroc': 0.8940753, 'binary_precision': 0.30769232, 'binary_recall': 0.8190225, 'binary_specificity': 0.85054636, 'binary_f1_score': 0.44733045}
confusion matrix:
      0     1
0  7939  1395
1   137   620
early stop counter: 8
val acc:0.9335396885871887, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 15,now: 2024-08-07 10:15:21.543929,epoch time: 0:20:26.825808,used: 5:06:16.842989,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.966045, 'precision': 0.9665332, 'recall': 0.9660585, 'specificity': 0.9660585, 'f1': 0.9660368, 'auroc': 0.99335396, 'binary_precision': 0.981833, 'binary_recall': 0.9497189, 'binary_specificity': 0.9823981, 'binary_f1_score': 0.96550894}
confusion matrix:
       0      1
0  24948    447
1   1279  24158
---- Validation: 
scalar performance:
{'acc': 0.9229107, 'precision': 0.596317, 'recall': 0.8112818, 'specificity': 0.8112818, 'f1': 0.6354758, 'auroc': 0.8838902, 'binary_precision': 0.20107599, 'binary_recall': 0.6937355, 'binary_specificity': 0.9288282, 'binary_f1_score': 0.3117831}
confusion matrix:
       0     1
0  15504  1188
1    132   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83519965, 'precision': 0.6394536, 'recall': 0.84172654, 'specificity': 0.84172654, 'f1': 0.66978955, 'auroc': 0.89600694, 'binary_precision': 0.2933394, 'binary_recall': 0.8494055, 'binary_specificity': 0.83404756, 'binary_f1_score': 0.43608}
confusion matrix:
      0     1
0  7785  1549
1   114   643
early stop counter: 9
val acc:0.9229106903076172, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 16,now: 2024-08-07 10:35:50.242793,epoch time: 0:20:28.698864,used: 5:26:45.541853,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9666155, 'precision': 0.9671873, 'recall': 0.9666301, 'specificity': 0.9666301, 'f1': 0.9666061, 'auroc': 0.99341834, 'binary_precision': 0.9837395, 'binary_recall': 0.948972, 'binary_specificity': 0.9842883, 'binary_f1_score': 0.96604306}
confusion matrix:
       0      1
0  24996    399
1   1298  24139
---- Validation: 
scalar performance:
{'acc': 0.9330141, 'precision': 0.6059515, 'recall': 0.7995119, 'specificity': 0.7995119, 'f1': 0.64796835, 'auroc': 0.88441086, 'binary_precision': 0.2211838, 'binary_recall': 0.6589327, 'binary_specificity': 0.9400911, 'binary_f1_score': 0.33119532}
confusion matrix:
       0     1
0  15692  1000
1    147   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85174906, 'precision': 0.6475836, 'recall': 0.83428514, 'specificity': 0.83428514, 'f1': 0.682951, 'auroc': 0.89627767, 'binary_precision': 0.3125317, 'binary_recall': 0.81373847, 'binary_specificity': 0.8548318, 'binary_f1_score': 0.4516129}
confusion matrix:
      0     1
0  7979  1355
1   141   616
early stop counter: 10
val acc:0.9330140948295593, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 17,now: 2024-08-07 10:55:55.613574,epoch time: 0:20:05.370781,used: 5:46:50.912634,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9667336, 'precision': 0.96716243, 'recall': 0.966745, 'specificity': 0.966745, 'f1': 0.9667264, 'auroc': 0.99361, 'binary_precision': 0.9815055, 'binary_recall': 0.95144486, 'binary_specificity': 0.9820451, 'binary_f1_score': 0.9662414}
confusion matrix:
       0      1
0  24941    456
1   1235  24200
---- Validation: 
scalar performance:
{'acc': 0.9155522, 'precision': 0.58955693, 'recall': 0.8131583, 'specificity': 0.8131583, 'f1': 0.6255449, 'auroc': 0.88611674, 'binary_precision': 0.18730746, 'binary_recall': 0.70533645, 'binary_specificity': 0.9209801, 'binary_f1_score': 0.2960078}
confusion matrix:
       0     1
0  15373  1319
1    127   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8298484, 'precision': 0.63603455, 'recall': 0.8394408, 'specificity': 0.8394408, 'f1': 0.6643299, 'auroc': 0.8968568, 'binary_precision': 0.28647688, 'binary_recall': 0.85072654, 'binary_specificity': 0.82815516, 'binary_f1_score': 0.42861897}
confusion matrix:
      0     1
0  7730  1604
1   113   644
early stop counter: 11
val acc:0.9155521988868713, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 18,now: 2024-08-07 11:15:43.246551,epoch time: 0:19:47.632977,used: 6:06:38.545611,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96543515, 'precision': 0.9661864, 'recall': 0.9654535, 'specificity': 0.9654535, 'f1': 0.96542215, 'auroc': 0.9939407, 'binary_precision': 0.9851278, 'binary_recall': 0.94520223, 'binary_specificity': 0.9857047, 'binary_f1_score': 0.96475214}
confusion matrix:
       0      1
0  25030    363
1   1394  24045
---- Validation: 
scalar performance:
{'acc': 0.92133385, 'precision': 0.59428513, 'recall': 0.8093429, 'specificity': 0.8093429, 'f1': 0.6325216, 'auroc': 0.8851544, 'binary_precision': 0.19708994, 'binary_recall': 0.6914153, 'binary_specificity': 0.92727053, 'binary_f1_score': 0.30674216}
confusion matrix:
       0     1
0  15478  1214
1    133   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8373799, 'precision': 0.6398709, 'recall': 0.83865654, 'specificity': 0.83865654, 'f1': 0.6708187, 'auroc': 0.8971556, 'binary_precision': 0.29499072, 'binary_recall': 0.8401585, 'binary_specificity': 0.8371545, 'binary_f1_score': 0.4366632}
confusion matrix:
      0     1
0  7814  1520
1   121   636
early stop counter: 12
val acc:0.9213338494300842, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 19,now: 2024-08-07 11:37:12.142945,epoch time: 0:21:28.896394,used: 6:28:07.442005,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96911395, 'precision': 0.9695804, 'recall': 0.96912587, 'specificity': 0.96912587, 'f1': 0.96910685, 'auroc': 0.9947201, 'binary_precision': 0.98456854, 'binary_recall': 0.95321405, 'binary_specificity': 0.9850376, 'binary_f1_score': 0.96863765}
confusion matrix:
       0      1
0  25017    380
1   1190  24245
---- Validation: 
scalar performance:
{'acc': 0.91333294, 'precision': 0.58784866, 'recall': 0.8142803, 'specificity': 0.8142803, 'f1': 0.62291306, 'auroc': 0.88263524, 'binary_precision': 0.18378378, 'binary_recall': 0.7099768, 'binary_specificity': 0.91858375, 'binary_f1_score': 0.29198474}
confusion matrix:
       0     1
0  15333  1359
1    125   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8404519, 'precision': 0.6423626, 'recall': 0.841531, 'specificity': 0.841531, 'f1': 0.67452466, 'auroc': 0.8989501, 'binary_precision': 0.2996712, 'binary_recall': 0.84280056, 'binary_specificity': 0.8402614, 'binary_f1_score': 0.44213444}
confusion matrix:
      0     1
0  7843  1491
1   119   638
early stop counter: 13
val acc:0.9133329391479492, best validation acc: 0.9449862837791443, corresponding to test acc:                         0.870478630065918 / 0.870478630065918
after epoch: 20,now: 2024-08-07 11:58:07.834716,epoch time: 0:20:55.691771,used: 6:49:03.133776,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_05_09_04_seed_1_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:49:03.133776 at 2024-08-07 11:58:07.834716
persisted model performance metric: 

scalar performance:
{'acc': 0.87047863, 'precision': 0.6328787, 'recall': 0.7290919, 'specificity': 0.7290919, 'f1': 0.6610544, 'auroc': 0.85723877, 'binary_precision': 0.30385163, 'binary_recall': 0.5627477, 'binary_specificity': 0.89543605, 'binary_f1_score': 0.39462715}
confusion matrix:
      0    1
0  8358  976
1   331  426
oracle model performance metric: 

scalar performance:
{'acc': 0.87047863, 'precision': 0.6328787, 'recall': 0.7290919, 'specificity': 0.7290919, 'f1': 0.6610544, 'auroc': 0.85723877, 'binary_precision': 0.30385163, 'binary_recall': 0.5627477, 'binary_specificity': 0.89543605, 'binary_f1_score': 0.39462715}
confusion matrix:
      0    1
0  8358  976
1   331  426
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |  16662 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8530 MiB |  16788 MiB |   8278 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38101 KiB | 732464 KiB | 538446 GiB | 538446 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 523441 GiB | 523441 GiB |
|       from small pool |   6368 KiB |  22549 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6849    |  185257 K  |  185253 K  |
|       from large pool |      79    |     762    |   91848 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93409 K  |   93404 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6849    |  185257 K  |  185253 K  |
|       from large pool |      79    |     762    |   91848 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93409 K  |   93404 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     371    |     714    |     347    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      19    |      22    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3199    |  104652 K  |  104652 K  |
|       from large pool |      11    |     351    |   64521 K  |   64521 K  |
|       from small pool |      21    |    3189    |   40131 K  |   40131 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 538446 GiB | 538446 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 523441 GiB | 523441 GiB |
|       from small pool |      0 KiB |  22549 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185257 K  |  185257 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185257 K  |  185257 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  104654 K  |  104654 K  |
|       from large pool |       3    |     351    |   64521 K  |   64521 K  |
|       from small pool |       0    |    3189    |   40133 K  |   40133 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 538446 GiB | 538446 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 523441 GiB | 523441 GiB |
|       from small pool |      0 KiB |  22549 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185257 K  |  185257 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185257 K  |  185257 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  104654 K  |  104654 K  |
|       from large pool |       3    |     351    |   64521 K  |   64521 K  |
|       from small pool |       0    |    3189    |   40133 K  |   40133 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678

 Experiment start at: 2024-08-07 12:26:30.506351
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8648445, 'precision': 0.86871517, 'recall': 0.8648485, 'specificity': 0.8648485, 'f1': 0.8644898, 'auroc': 0.9304816, 'binary_precision': 0.9065127, 'binary_recall': 0.81361705, 'binary_specificity': 0.9160799, 'binary_f1_score': 0.85755646}
confusion matrix:
       0      1
0  23677   2169
1   4818  21032
---- Validation: 
scalar performance:
{'acc': 0.8304719, 'precision': 0.5200853, 'recall': 0.61572313, 'specificity': 0.61572313, 'f1': 0.50368613, 'auroc': 0.6833514, 'binary_precision': 0.057986483, 'binary_recall': 0.38995215, 'binary_specificity': 0.8414941, 'binary_f1_score': 0.10096005}
confusion matrix:
       0     1
0  14058  2648
1    255   163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77051127, 'precision': 0.5828612, 'recall': 0.7153936, 'specificity': 0.7153936, 'f1': 0.5857371, 'auroc': 0.775078, 'binary_precision': 0.20273973, 'binary_recall': 0.6499373, 'binary_specificity': 0.78084993, 'binary_f1_score': 0.30906922}
confusion matrix:
      0     1
0  7258  2037
1   279   518
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 12:47:12.144991,epoch time: 0:20:41.638640,used: 0:20:41.638640,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90602756, 'precision': 0.9101521, 'recall': 0.9060372, 'specificity': 0.9060372, 'f1': 0.9057921, 'auroc': 0.9596503, 'binary_precision': 0.95133066, 'binary_recall': 0.85587746, 'binary_specificity': 0.956197, 'binary_f1_score': 0.90108323}
confusion matrix:
       0      1
0  24711   1132
1   3726  22127
---- Validation: 
scalar performance:
{'acc': 0.8914973, 'precision': 0.53084755, 'recall': 0.616677, 'specificity': 0.616677, 'f1': 0.5353325, 'auroc': 0.7345612, 'binary_precision': 0.079929985, 'binary_recall': 0.3277512, 'binary_specificity': 0.90560275, 'binary_f1_score': 0.12851782}
confusion matrix:
       0     1
0  15129  1577
1    281   137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364051, 'precision': 0.60131794, 'recall': 0.694383, 'specificity': 0.694383, 'f1': 0.6216891, 'auroc': 0.7951044, 'binary_precision': 0.24763593, 'binary_recall': 0.52572143, 'binary_specificity': 0.8630446, 'binary_f1_score': 0.33668137}
confusion matrix:
      0     1
0  8022  1273
1   378   419
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 13:06:57.873133,epoch time: 0:19:45.728142,used: 0:40:27.366782,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92393994, 'precision': 0.92678034, 'recall': 0.9239526, 'specificity': 0.9239526, 'f1': 0.9238148, 'auroc': 0.97204363, 'binary_precision': 0.9616745, 'binary_recall': 0.8831219, 'binary_specificity': 0.9647833, 'binary_f1_score': 0.9207258}
confusion matrix:
       0      1
0  24930    910
1   3022  22834
---- Validation: 
scalar performance:
{'acc': 0.9112357, 'precision': 0.53956693, 'recall': 0.6221281, 'specificity': 0.6221281, 'f1': 0.5510561, 'auroc': 0.7625238, 'binary_precision': 0.097222224, 'binary_recall': 0.3181818, 'binary_specificity': 0.92607445, 'binary_f1_score': 0.14893618}
confusion matrix:
       0     1
0  15471  1235
1    285   133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86187077, 'precision': 0.6126636, 'recall': 0.67666185, 'specificity': 0.67666185, 'f1': 0.63294697, 'auroc': 0.81027365, 'binary_precision': 0.27471697, 'binary_recall': 0.45671266, 'binary_specificity': 0.8966111, 'binary_f1_score': 0.34307256}
confusion matrix:
      0    1
0  8334  961
1   433  364
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 13:26:52.211321,epoch time: 0:19:54.338188,used: 1:00:21.704970,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93289614, 'precision': 0.9347067, 'recall': 0.93289864, 'specificity': 0.93289864, 'f1': 0.93282646, 'auroc': 0.977889, 'binary_precision': 0.9627807, 'binary_recall': 0.900619, 'binary_specificity': 0.9651784, 'binary_f1_score': 0.930663}
confusion matrix:
       0      1
0  24946    900
1   2569  23281
---- Validation: 
scalar performance:
{'acc': 0.903352, 'precision': 0.5481429, 'recall': 0.6705686, 'specificity': 0.6705686, 'f1': 0.5628439, 'auroc': 0.78779733, 'binary_precision': 0.11173886, 'binary_recall': 0.4258373, 'binary_specificity': 0.9152999, 'binary_f1_score': 0.17702635}
confusion matrix:
       0     1
0  15291  1415
1    240   178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8626635, 'precision': 0.6205638, 'recall': 0.6960197, 'specificity': 0.6960197, 'f1': 0.64361864, 'auroc': 0.8242197, 'binary_precision': 0.28705713, 'binary_recall': 0.49811795, 'binary_specificity': 0.89392143, 'binary_f1_score': 0.3642202}
confusion matrix:
      0    1
0  8309  986
1   400  397
new oracle model saved
early stop counter: 1
val acc:0.9033520221710205, best validation acc: 0.9112356901168823, corresponding to test acc:                         0.8618707656860352 / 0.8626635074615479
after epoch: 4,now: 2024-08-07 13:47:04.338728,epoch time: 0:20:12.127407,used: 1:20:33.832377,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94092387, 'precision': 0.9434264, 'recall': 0.9409311, 'specificity': 0.9409311, 'f1': 0.9408411, 'auroc': 0.9818969, 'binary_precision': 0.976787, 'binary_recall': 0.9033381, 'binary_specificity': 0.97852415, 'binary_f1_score': 0.93862784}
confusion matrix:
       0      1
0  25288    555
1   2499  23354
---- Validation: 
scalar performance:
{'acc': 0.91958654, 'precision': 0.56070423, 'recall': 0.6812215, 'specificity': 0.6812215, 'f1': 0.58244956, 'auroc': 0.8042867, 'binary_precision': 0.13646702, 'binary_recall': 0.430622, 'binary_specificity': 0.9318209, 'binary_f1_score': 0.2072539}
confusion matrix:
       0     1
0  15567  1139
1    238   180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8814903, 'precision': 0.6403945, 'recall': 0.6959162, 'specificity': 0.6959162, 'f1': 0.661158, 'auroc': 0.8380394, 'binary_precision': 0.3275713, 'binary_recall': 0.47553325, 'binary_specificity': 0.9162991, 'binary_f1_score': 0.38792223}
confusion matrix:
      0    1
0  8517  778
1   418  379
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 14:07:43.828938,epoch time: 0:20:39.490210,used: 1:41:13.322587,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9439802, 'precision': 0.9452244, 'recall': 0.94397914, 'specificity': 0.94397914, 'f1': 0.9439409, 'auroc': 0.98343337, 'binary_precision': 0.96875125, 'binary_recall': 0.9175533, 'binary_specificity': 0.97040504, 'binary_f1_score': 0.94245744}
confusion matrix:
       0      1
0  25084    765
1   2131  23716
---- Validation: 
scalar performance:
{'acc': 0.91427237, 'precision': 0.5645105, 'recall': 0.7123189, 'specificity': 0.7123189, 'f1': 0.5881356, 'auroc': 0.8161087, 'binary_precision': 0.14237057, 'binary_recall': 0.5, 'binary_specificity': 0.92463785, 'binary_f1_score': 0.22163308}
confusion matrix:
       0     1
0  15447  1259
1    209   209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88357115, 'precision': 0.65009105, 'recall': 0.7171204, 'specificity': 0.7171204, 'f1': 0.674376, 'auroc': 0.848256, 'binary_precision': 0.3432836, 'binary_recall': 0.5194479, 'binary_specificity': 0.9147929, 'binary_f1_score': 0.41337994}
confusion matrix:
      0    1
0  8503  792
1   383  414
new oracle model saved
early stop counter: 1
val acc:0.9142723679542542, best validation acc: 0.9195865392684937, corresponding to test acc:                         0.8814902901649475 / 0.8835711479187012
after epoch: 6,now: 2024-08-07 14:28:15.169754,epoch time: 0:20:31.340816,used: 2:01:44.663403,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94926107, 'precision': 0.9508184, 'recall': 0.9492656, 'specificity': 0.9492656, 'f1': 0.94921756, 'auroc': 0.986276, 'binary_precision': 0.977354, 'binary_recall': 0.9198515, 'binary_specificity': 0.9786798, 'binary_f1_score': 0.9477313}
confusion matrix:
       0      1
0  25293    551
1   2072  23780
---- Validation: 
scalar performance:
{'acc': 0.9118197, 'precision': 0.56624115, 'recall': 0.7273893, 'specificity': 0.7273893, 'f1': 0.59062773, 'auroc': 0.82504094, 'binary_precision': 0.1449935, 'binary_recall': 0.5334928, 'binary_specificity': 0.92128575, 'binary_f1_score': 0.22801636}
confusion matrix:
       0     1
0  15391  1315
1    195   223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8874356, 'precision': 0.6626474, 'recall': 0.7421607, 'specificity': 0.7421607, 'f1': 0.6908015, 'auroc': 0.8607136, 'binary_precision': 0.36407378, 'binary_recall': 0.5696361, 'binary_specificity': 0.9146853, 'binary_f1_score': 0.44422704}
confusion matrix:
      0    1
0  8502  793
1   343  454
new oracle model saved
early stop counter: 2
val acc:0.9118196964263916, best validation acc: 0.9195865392684937, corresponding to test acc:                         0.8814902901649475 / 0.8874356150627136
after epoch: 7,now: 2024-08-07 14:49:15.738645,epoch time: 0:21:00.568891,used: 2:22:45.232294,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9539616, 'precision': 0.9549269, 'recall': 0.9539643, 'specificity': 0.9539643, 'f1': 0.95393735, 'auroc': 0.9884782, 'binary_precision': 0.97591144, 'binary_recall': 0.9309118, 'binary_specificity': 0.9770168, 'binary_f1_score': 0.9528806}
confusion matrix:
       0      1
0  25251    594
1   1786  24065
---- Validation: 
scalar performance:
{'acc': 0.9131044, 'precision': 0.5696539, 'recall': 0.7385439, 'specificity': 0.7385439, 'f1': 0.59581554, 'auroc': 0.83120203, 'binary_precision': 0.15123859, 'binary_recall': 0.5550239, 'binary_specificity': 0.92206395, 'binary_f1_score': 0.23770493}
confusion matrix:
       0     1
0  15404  1302
1    186   232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89139915, 'precision': 0.6643094, 'recall': 0.72825277, 'specificity': 0.72825277, 'f1': 0.6886354, 'auroc': 0.859942, 'binary_precision': 0.37011296, 'binary_recall': 0.5345044, 'binary_specificity': 0.92200106, 'binary_f1_score': 0.43737167}
confusion matrix:
      0    1
0  8570  725
1   371  426
new oracle model saved
early stop counter: 3
val acc:0.9131044149398804, best validation acc: 0.9195865392684937, corresponding to test acc:                         0.8814902901649475 / 0.8913991451263428
after epoch: 8,now: 2024-08-07 15:09:45.468624,epoch time: 0:20:29.729979,used: 2:43:14.962273,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9546967, 'precision': 0.9559969, 'recall': 0.9547008, 'specificity': 0.9547008, 'f1': 0.9546647, 'auroc': 0.98885083, 'binary_precision': 0.9803842, 'binary_recall': 0.92797464, 'binary_specificity': 0.981427, 'binary_f1_score': 0.95345974}
confusion matrix:
       0      1
0  25364    480
1   1862  23990
---- Validation: 
scalar performance:
{'acc': 0.9107101, 'precision': 0.57069385, 'recall': 0.7513118, 'specificity': 0.7513118, 'f1': 0.59725237, 'auroc': 0.8360865, 'binary_precision': 0.15259537, 'binary_recall': 0.58373207, 'binary_specificity': 0.91889143, 'binary_f1_score': 0.2419435}
confusion matrix:
       0     1
0  15351  1355
1    174   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8941736, 'precision': 0.67314506, 'recall': 0.74524504, 'specificity': 0.74524504, 'f1': 0.7001587, 'auroc': 0.8645597, 'binary_precision': 0.38487682, 'binary_recall': 0.5683814, 'binary_specificity': 0.92210865, 'binary_f1_score': 0.45896655}
confusion matrix:
      0    1
0  8571  724
1   344  453
new oracle model saved
early stop counter: 4
val acc:0.9107100963592529, best validation acc: 0.9195865392684937, corresponding to test acc:                         0.8814902901649475 / 0.8941736221313477
after epoch: 9,now: 2024-08-07 15:32:12.695511,epoch time: 0:22:27.226887,used: 3:05:42.189160,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9575209, 'precision': 0.9589132, 'recall': 0.9575262, 'specificity': 0.9575262, 'f1': 0.957489, 'auroc': 0.990167, 'binary_precision': 0.98423874, 'binary_recall': 0.9299501, 'binary_specificity': 0.98510236, 'binary_f1_score': 0.9563246}
confusion matrix:
       0      1
0  25458    385
1   1811  24042
---- Validation: 
scalar performance:
{'acc': 0.91018456, 'precision': 0.57320285, 'recall': 0.7650373, 'specificity': 0.7650373, 'f1': 0.6009946, 'auroc': 0.84077823, 'binary_precision': 0.15686275, 'binary_recall': 0.61244017, 'binary_specificity': 0.91763437, 'binary_f1_score': 0.24975611}
confusion matrix:
       0     1
0  15330  1376
1    162   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8958581, 'precision': 0.6778757, 'recall': 0.7536158, 'specificity': 0.7536158, 'f1': 0.70612544, 'auroc': 0.8669901, 'binary_precision': 0.39291736, 'binary_recall': 0.5846926, 'binary_specificity': 0.922539, 'binary_f1_score': 0.46999496}
confusion matrix:
      0    1
0  8575  720
1   331  466
new oracle model saved
early stop counter: 5
val acc:0.9101845622062683, best validation acc: 0.9195865392684937, corresponding to test acc:                         0.8814902901649475 / 0.895858108997345
after epoch: 10,now: 2024-08-07 15:53:53.998921,epoch time: 0:21:41.303410,used: 3:27:23.492570,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9612349, 'precision': 0.96214825, 'recall': 0.9612366, 'specificity': 0.9612366, 'f1': 0.96121585, 'auroc': 0.99161947, 'binary_precision': 0.98271257, 'binary_recall': 0.93899417, 'binary_specificity': 0.9834791, 'binary_f1_score': 0.9603561}
confusion matrix:
       0      1
0  25419    427
1   1577  24273
---- Validation: 
scalar performance:
{'acc': 0.9140388, 'precision': 0.5755408, 'recall': 0.7623477, 'specificity': 0.7623477, 'f1': 0.6047242, 'auroc': 0.8439086, 'binary_precision': 0.16174583, 'binary_recall': 0.6028708, 'binary_specificity': 0.9218245, 'binary_f1_score': 0.25506073}
confusion matrix:
       0     1
0  15400  1306
1    166   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89724535, 'precision': 0.678131, 'recall': 0.74576545, 'specificity': 0.74576545, 'f1': 0.70417535, 'auroc': 0.8670552, 'binary_precision': 0.39492118, 'binary_recall': 0.565872, 'binary_specificity': 0.92565894, 'binary_f1_score': 0.46518824}
confusion matrix:
      0    1
0  8604  691
1   346  451
new oracle model saved
early stop counter: 6
val acc:0.9140387773513794, best validation acc: 0.9195865392684937, corresponding to test acc:                         0.8814902901649475 / 0.8972453474998474
after epoch: 11,now: 2024-08-07 16:14:29.577081,epoch time: 0:20:35.578160,used: 3:47:59.070730,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.961351, 'precision': 0.9621248, 'recall': 0.961355, 'specificity': 0.961355, 'f1': 0.96133506, 'auroc': 0.99172676, 'binary_precision': 0.9810834, 'binary_recall': 0.94085795, 'binary_specificity': 0.98185194, 'binary_f1_score': 0.9605498}
confusion matrix:
       0      1
0  25374    469
1   1529  24324
---- Validation: 
scalar performance:
{'acc': 0.9111773, 'precision': 0.57500213, 'recall': 0.7702111, 'specificity': 0.7702111, 'f1': 0.6037756, 'auroc': 0.84833056, 'binary_precision': 0.16019717, 'binary_recall': 0.6220096, 'binary_specificity': 0.91841257, 'binary_f1_score': 0.25477704}
confusion matrix:
       0     1
0  15343  1363
1    158   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8971462, 'precision': 0.6806358, 'recall': 0.7566093, 'specificity': 0.7566093, 'f1': 0.7091067, 'auroc': 0.87055135, 'binary_precision': 0.39796782, 'binary_recall': 0.5897114, 'binary_specificity': 0.9235073, 'binary_f1_score': 0.4752275}
confusion matrix:
      0    1
0  8584  711
1   327  470
early stop counter: 7
val acc:0.9111772775650024, best validation acc: 0.9195865392684937, corresponding to test acc:                         0.8814902901649475 / 0.8972453474998474
after epoch: 12,now: 2024-08-07 16:34:40.054681,epoch time: 0:20:10.477600,used: 4:08:09.548330,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9631113, 'precision': 0.9639772, 'recall': 0.96311545, 'specificity': 0.96311545, 'f1': 0.9630943, 'auroc': 0.9921428, 'binary_precision': 0.98407054, 'binary_recall': 0.9414768, 'binary_specificity': 0.9847541, 'binary_f1_score': 0.96230257}
confusion matrix:
       0      1
0  25449    394
1   1513  24340
---- Validation: 
scalar performance:
{'acc': 0.91701704, 'precision': 0.5795487, 'recall': 0.7697053, 'specificity': 0.7697053, 'f1': 0.61082846, 'auroc': 0.84767926, 'binary_precision': 0.16941331, 'binary_recall': 0.6148325, 'binary_specificity': 0.924578, 'binary_f1_score': 0.26563308}
confusion matrix:
       0     1
0  15446  1260
1    161   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9003171, 'precision': 0.6838433, 'recall': 0.7480066, 'specificity': 0.7480066, 'f1': 0.7091238, 'auroc': 0.87388444, 'binary_precision': 0.4061096, 'binary_recall': 0.56712675, 'binary_specificity': 0.9288865, 'binary_f1_score': 0.47329846}
confusion matrix:
      0    1
0  8634  661
1   345  452
new oracle model saved
early stop counter: 8
val acc:0.9170170426368713, best validation acc: 0.9195865392684937, corresponding to test acc:                         0.8814902901649475 / 0.9003170728683472
after epoch: 13,now: 2024-08-07 16:54:28.671618,epoch time: 0:19:48.616937,used: 4:27:58.165267,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9652004, 'precision': 0.9658892, 'recall': 0.96520865, 'specificity': 0.96520865, 'f1': 0.9651879, 'auroc': 0.9934128, 'binary_precision': 0.9839099, 'binary_recall': 0.9458989, 'binary_specificity': 0.98451835, 'binary_f1_score': 0.96453}
confusion matrix:
       0      1
0  25437    400
1   1399  24460
---- Validation: 
scalar performance:
{'acc': 0.9274702, 'precision': 0.58775556, 'recall': 0.76106775, 'specificity': 0.76106775, 'f1': 0.62235665, 'auroc': 0.8505107, 'binary_precision': 0.18645358, 'binary_recall': 0.5861244, 'binary_specificity': 0.936011, 'binary_f1_score': 0.28290993}
confusion matrix:
       0     1
0  15637  1069
1    173   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9049742, 'precision': 0.6879184, 'recall': 0.728166, 'specificity': 0.728166, 'f1': 0.70531136, 'auroc': 0.87221134, 'binary_precision': 0.4180162, 'binary_recall': 0.51819324, 'binary_specificity': 0.9381388, 'binary_f1_score': 0.46274513}
confusion matrix:
      0    1
0  8720  575
1   384  413
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-07 17:14:51.513980,epoch time: 0:20:22.842362,used: 4:48:21.007629,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9663997, 'precision': 0.96683097, 'recall': 0.96640146, 'specificity': 0.96640146, 'f1': 0.96639204, 'auroc': 0.99329364, 'binary_precision': 0.9810485, 'binary_recall': 0.95118177, 'binary_specificity': 0.9816212, 'binary_f1_score': 0.9658843}
confusion matrix:
       0      1
0  25370    475
1   1262  24589
---- Validation: 
scalar performance:
{'acc': 0.92040414, 'precision': 0.5841939, 'recall': 0.7772724, 'specificity': 0.7772724, 'f1': 0.61778545, 'auroc': 0.8541515, 'binary_precision': 0.17835262, 'binary_recall': 0.6267943, 'binary_specificity': 0.9277505, 'binary_f1_score': 0.27768946}
confusion matrix:
       0     1
0  15499  1207
1    156   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9036861, 'precision': 0.68877864, 'recall': 0.7429528, 'specificity': 0.7429528, 'f1': 0.71106994, 'auroc': 0.87423384, 'binary_precision': 0.4170616, 'binary_recall': 0.55207026, 'binary_specificity': 0.9338354, 'binary_f1_score': 0.475162}
confusion matrix:
      0    1
0  8680  615
1   357  440
early stop counter: 1
val acc:0.9204041361808777, best validation acc: 0.9274702072143555, corresponding to test acc:                         0.9049742221832275 / 0.9049742221832275
after epoch: 15,now: 2024-08-07 17:35:38.061228,epoch time: 0:20:46.547248,used: 5:09:07.554877,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96680593, 'precision': 0.96720576, 'recall': 0.9668082, 'specificity': 0.9668082, 'f1': 0.96679896, 'auroc': 0.99332404, 'binary_precision': 0.9809118, 'binary_recall': 0.9521507, 'binary_specificity': 0.9814657, 'binary_f1_score': 0.9663173}
confusion matrix:
       0      1
0  25365    479
1   1237  24615
---- Validation: 
scalar performance:
{'acc': 0.913046, 'precision': 0.5787905, 'recall': 0.78166497, 'specificity': 0.78166497, 'f1': 0.6096024, 'auroc': 0.8564676, 'binary_precision': 0.16718459, 'binary_recall': 0.6435407, 'binary_specificity': 0.9197893, 'binary_f1_score': 0.2654169}
confusion matrix:
       0     1
0  15366  1340
1    149   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9038843, 'precision': 0.68956476, 'recall': 0.7447811, 'specificity': 0.7447811, 'f1': 0.7122231, 'auroc': 0.8726069, 'binary_precision': 0.41831917, 'binary_recall': 0.55583435, 'binary_specificity': 0.9337278, 'binary_f1_score': 0.47737068}
confusion matrix:
      0    1
0  8679  616
1   354  443
early stop counter: 2
val acc:0.9130460023880005, best validation acc: 0.9274702072143555, corresponding to test acc:                         0.9049742221832275 / 0.9049742221832275
after epoch: 16,now: 2024-08-07 17:56:23.141066,epoch time: 0:20:45.079838,used: 5:29:52.634715,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96580005, 'precision': 0.96651626, 'recall': 0.9658054, 'specificity': 0.9658054, 'f1': 0.9657872, 'auroc': 0.9931313, 'binary_precision': 0.9848625, 'binary_recall': 0.94616127, 'binary_specificity': 0.9854495, 'binary_f1_score': 0.965124}
confusion matrix:
       0      1
0  25465    376
1   1392  24463
---- Validation: 
scalar performance:
{'acc': 0.9138636, 'precision': 0.57856715, 'recall': 0.777419, 'specificity': 0.777419, 'f1': 0.6092964, 'auroc': 0.85772955, 'binary_precision': 0.16698173, 'binary_recall': 0.6339713, 'binary_specificity': 0.9208667, 'binary_f1_score': 0.26433915}
confusion matrix:
       0     1
0  15384  1322
1    153   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9043797, 'precision': 0.6900593, 'recall': 0.74275583, 'specificity': 0.74275583, 'f1': 0.7118914, 'auroc': 0.87343895, 'binary_precision': 0.41969407, 'binary_recall': 0.5508156, 'binary_specificity': 0.9346961, 'binary_f1_score': 0.4763972}
confusion matrix:
      0    1
0  8688  607
1   358  439
early stop counter: 3
val acc:0.9138635993003845, best validation acc: 0.9274702072143555, corresponding to test acc:                         0.9049742221832275 / 0.9049742221832275
after epoch: 17,now: 2024-08-07 18:16:29.262390,epoch time: 0:20:06.121324,used: 5:49:58.756039,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96932065, 'precision': 0.9698999, 'recall': 0.9693213, 'specificity': 0.9693213, 'f1': 0.96931124, 'auroc': 0.9943401, 'binary_precision': 0.98640794, 'binary_recall': 0.95175827, 'binary_specificity': 0.98688436, 'binary_f1_score': 0.9687734}
confusion matrix:
       0      1
0  25508    339
1   1247  24602
---- Validation: 
scalar performance:
{'acc': 0.9100093, 'precision': 0.57473725, 'recall': 0.7731112, 'specificity': 0.7731112, 'f1': 0.6032949, 'auroc': 0.8582821, 'binary_precision': 0.1594906, 'binary_recall': 0.62918663, 'binary_specificity': 0.9170358, 'binary_f1_score': 0.2544751}
confusion matrix:
       0     1
0  15320  1386
1    155   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9034879, 'precision': 0.6879879, 'recall': 0.7411246, 'specificity': 0.7411246, 'f1': 0.7099121, 'auroc': 0.8718711, 'binary_precision': 0.4157945, 'binary_recall': 0.54830617, 'binary_specificity': 0.933943, 'binary_f1_score': 0.47294375}
confusion matrix:
      0    1
0  8681  614
1   360  437
early stop counter: 4
val acc:0.9100093245506287, best validation acc: 0.9274702072143555, corresponding to test acc:                         0.9049742221832275 / 0.9049742221832275
after epoch: 18,now: 2024-08-07 18:36:25.603384,epoch time: 0:19:56.340994,used: 6:09:55.097033,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9690692, 'precision': 0.9696642, 'recall': 0.96907055, 'specificity': 0.96907055, 'f1': 0.96905947, 'auroc': 0.99479437, 'binary_precision': 0.9864014, 'binary_recall': 0.9512572, 'binary_specificity': 0.9868839, 'binary_f1_score': 0.9685106}
confusion matrix:
       0      1
0  25507    339
1   1260  24590
---- Validation: 
scalar performance:
{'acc': 0.92501754, 'precision': 0.588261, 'recall': 0.77497184, 'specificity': 0.77497184, 'f1': 0.6235478, 'auroc': 0.8629291, 'binary_precision': 0.18668596, 'binary_recall': 0.6172249, 'binary_specificity': 0.9327188, 'binary_f1_score': 0.28666666}
confusion matrix:
       0     1
0  15582  1124
1    160   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9068569, 'precision': 0.6935562, 'recall': 0.73607075, 'specificity': 0.73607075, 'f1': 0.71187836, 'auroc': 0.8748326, 'binary_precision': 0.42799598, 'binary_recall': 0.5332497, 'binary_specificity': 0.9388919, 'binary_f1_score': 0.47486034}
confusion matrix:
      0    1
0  8727  568
1   372  425
new oracle model saved
early stop counter: 5
val acc:0.9250175356864929, best validation acc: 0.9274702072143555, corresponding to test acc:                         0.9049742221832275 / 0.906856894493103
after epoch: 19,now: 2024-08-07 18:56:07.004335,epoch time: 0:19:41.400951,used: 6:29:36.497984,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97069407, 'precision': 0.9713478, 'recall': 0.97069764, 'specificity': 0.97069764, 'f1': 0.97068405, 'auroc': 0.99483263, 'binary_precision': 0.9889505, 'binary_recall': 0.9520365, 'binary_specificity': 0.98935884, 'binary_f1_score': 0.9701424}
confusion matrix:
       0      1
0  25568    275
1   1240  24613
---- Validation: 
scalar performance:
{'acc': 0.92215604, 'precision': 0.58453846, 'recall': 0.77117276, 'specificity': 0.77117276, 'f1': 0.61818427, 'auroc': 0.8614326, 'binary_precision': 0.17939733, 'binary_recall': 0.61244017, 'binary_specificity': 0.9299054, 'binary_f1_score': 0.27750674}
confusion matrix:
       0     1
0  15535  1171
1    162   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90764964, 'precision': 0.6926062, 'recall': 0.7238828, 'specificity': 0.7238828, 'f1': 0.70661277, 'auroc': 0.8723728, 'binary_precision': 0.4282678, 'binary_recall': 0.50564617, 'binary_specificity': 0.9421194, 'binary_f1_score': 0.46375147}
confusion matrix:
      0    1
0  8757  538
1   394  403
new oracle model saved
early stop counter: 6
val acc:0.922156035900116, best validation acc: 0.9274702072143555, corresponding to test acc:                         0.9049742221832275 / 0.9076496362686157
after epoch: 20,now: 2024-08-07 19:15:51.239467,epoch time: 0:19:44.235132,used: 6:49:20.733116,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_12_26_30_seed_2_24076678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:49:20.733116 at 2024-08-07 19:15:51.239467
persisted model performance metric: 

scalar performance:
{'acc': 0.9049742, 'precision': 0.6879184, 'recall': 0.728166, 'specificity': 0.728166, 'f1': 0.70531136, 'auroc': 0.87221134, 'binary_precision': 0.4180162, 'binary_recall': 0.51819324, 'binary_specificity': 0.9381388, 'binary_f1_score': 0.46274513}
confusion matrix:
      0    1
0  8720  575
1   384  413
oracle model performance metric: 

scalar performance:
{'acc': 0.90764964, 'precision': 0.6926062, 'recall': 0.7238828, 'specificity': 0.7238828, 'f1': 0.70661277, 'auroc': 0.8723728, 'binary_precision': 0.4282678, 'binary_recall': 0.50564617, 'binary_specificity': 0.9421194, 'binary_f1_score': 0.46375147}
confusion matrix:
      0    1
0  8757  538
1   394  403
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  16662 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8530 MiB |  25068 MiB |  16558 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     38 MiB |     44 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40149 KiB | 732464 KiB |    791 TiB |    791 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    768 TiB |    768 TiB |
|       from small pool |   8416 KiB |  22549 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6957    |  280988 K  |  280983 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141131 K  |  141127 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6957    |  280988 K  |  280983 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141131 K  |  141127 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     371    |    1059    |     692    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      19    |      22    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3255    |  155869 K  |  155869 K  |
|       from large pool |      11    |     351    |   95710 K  |   95710 K  |
|       from small pool |      24    |    3245    |   60158 K  |   60158 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25068 MiB |  24836 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  26624 KiB |     44 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |    791 TiB |    791 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    768 TiB |    768 TiB |
|       from small pool |      0 KiB |  22555 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  280988 K  |  280988 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141131 K  |  141131 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  280988 K  |  280988 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141131 K  |  141131 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1059    |    1036    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      13    |      22    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3255    |  155871 K  |  155871 K  |
|       from large pool |       3    |     351    |   95710 K  |   95710 K  |
|       from small pool |       0    |    3245    |   60160 K  |   60160 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 19:34:13 2024]
Finished job 0.
1 of 1 steps (100%) done
