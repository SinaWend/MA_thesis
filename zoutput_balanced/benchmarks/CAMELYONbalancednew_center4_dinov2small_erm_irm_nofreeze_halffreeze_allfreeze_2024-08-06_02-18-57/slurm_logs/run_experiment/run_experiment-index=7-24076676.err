Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 12:31:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676

 Experiment start at: 2024-08-06 12:39:48.347042
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95240444, 'precision': 0.95411205, 'recall': 0.95242023, 'specificity': 0.95242023, 'f1': 0.95236087, 'auroc': 0.9864963, 'binary_precision': 0.9820873, 'binary_recall': 0.92166847, 'binary_specificity': 0.98317206, 'binary_f1_score': 0.95091915}
confusion matrix:
       0      1
0  24889    426
1   1985  23356
---- Validation: 
scalar performance:
{'acc': 0.8935612, 'precision': 0.57349116, 'recall': 0.8256172, 'specificity': 0.8256172, 'f1': 0.5990449, 'auroc': 0.8932941, 'binary_precision': 0.1537328, 'binary_recall': 0.75421685, 'binary_specificity': 0.89701754, 'binary_f1_score': 0.25540593}
confusion matrix:
       0     1
0  15008  1723
1    102   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8109551, 'precision': 0.61481005, 'recall': 0.78715515, 'specificity': 0.78715515, 'f1': 0.63425004, 'auroc': 0.8610399, 'binary_precision': 0.2534602, 'binary_recall': 0.75906736, 'binary_specificity': 0.815243, 'binary_f1_score': 0.38002592}
confusion matrix:
      0     1
0  7616  1726
1   186   586
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 13:06:45.487120,epoch time: 0:26:57.140078,used: 0:26:57.140078,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96251184, 'precision': 0.9629071, 'recall': 0.9625206, 'specificity': 0.9625206, 'f1': 0.9625043, 'auroc': 0.99146104, 'binary_precision': 0.9765816, 'binary_recall': 0.9477962, 'binary_specificity': 0.9772449, 'binary_f1_score': 0.9619736}
confusion matrix:
       0      1
0  24737    576
1   1323  24020
---- Validation: 
scalar performance:
{'acc': 0.8907034, 'precision': 0.5738611, 'recall': 0.83707714, 'specificity': 0.83707714, 'f1': 0.59897625, 'auroc': 0.90913355, 'binary_precision': 0.15377314, 'binary_recall': 0.7807229, 'binary_specificity': 0.89343137, 'binary_f1_score': 0.25693893}
confusion matrix:
       0     1
0  14948  1783
1     91   324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8516907, 'precision': 0.6372075, 'recall': 0.788411, 'specificity': 0.788411, 'f1': 0.6692094, 'auroc': 0.8757647, 'binary_precision': 0.3010929, 'binary_recall': 0.7137306, 'binary_specificity': 0.8630914, 'binary_f1_score': 0.42352036}
confusion matrix:
      0     1
0  8063  1279
1   221   551
new oracle model saved
early stop counter: 1
val acc:0.8907033801078796, best validation acc: 0.8935611844062805, corresponding to test acc:                         0.8109551072120667 / 0.8516907095909119
after epoch: 2,now: 2024-08-06 13:32:55.290555,epoch time: 0:26:09.803435,used: 0:53:06.943513,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96973705, 'precision': 0.9702389, 'recall': 0.9697474, 'specificity': 0.9697474, 'f1': 0.9697294, 'auroc': 0.99378, 'binary_precision': 0.98576033, 'binary_recall': 0.95328283, 'binary_specificity': 0.9862121, 'binary_f1_score': 0.9692496}
confusion matrix:
       0      1
0  24963    349
1   1184  24160
---- Validation: 
scalar performance:
{'acc': 0.8979354, 'precision': 0.5786937, 'recall': 0.8407828, 'specificity': 0.8407828, 'f1': 0.607678, 'auroc': 0.91244996, 'binary_precision': 0.1633888, 'binary_recall': 0.7807229, 'binary_specificity': 0.9008427, 'binary_f1_score': 0.2702252}
confusion matrix:
       0     1
0  15072  1659
1     91   324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87047654, 'precision': 0.6481947, 'recall': 0.77362597, 'specificity': 0.77362597, 'f1': 0.6820504, 'auroc': 0.8772239, 'binary_precision': 0.3271208, 'binary_recall': 0.65932643, 'binary_specificity': 0.8879255, 'binary_f1_score': 0.4372852}
confusion matrix:
      0     1
0  8295  1047
1   263   509
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 13:58:08.023182,epoch time: 0:25:12.732627,used: 1:18:19.676140,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97415906, 'precision': 0.9742553, 'recall': 0.9741639, 'specificity': 0.9741639, 'f1': 0.9741579, 'auroc': 0.99539226, 'binary_precision': 0.9811819, 'binary_recall': 0.96689683, 'binary_specificity': 0.981431, 'binary_f1_score': 0.973987}
confusion matrix:
       0      1
0  24841    470
1    839  24506
---- Validation: 
scalar performance:
{'acc': 0.90265954, 'precision': 0.5828043, 'recall': 0.8467283, 'specificity': 0.8467283, 'f1': 0.6146628, 'auroc': 0.92281485, 'binary_precision': 0.17138365, 'binary_recall': 0.7879518, 'binary_specificity': 0.90550476, 'binary_f1_score': 0.2815325}
confusion matrix:
       0     1
0  15150  1581
1     88   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90003955, 'precision': 0.6806025, 'recall': 0.75873333, 'specificity': 0.75873333, 'f1': 0.70978415, 'auroc': 0.8837104, 'binary_precision': 0.39635733, 'binary_recall': 0.5919689, 'binary_specificity': 0.9254978, 'binary_f1_score': 0.4748052}
confusion matrix:
      0    1
0  8646  696
1   315  457
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 14:23:04.176231,epoch time: 0:24:56.153049,used: 1:43:15.829189,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9763503, 'precision': 0.97671634, 'recall': 0.97635967, 'specificity': 0.97635967, 'f1': 0.9763461, 'auroc': 0.9964349, 'binary_precision': 0.9900954, 'binary_recall': 0.9623594, 'binary_specificity': 0.9903599, 'binary_f1_score': 0.9760304}
confusion matrix:
       0      1
0  25067    244
1    954  24391
---- Validation: 
scalar performance:
{'acc': 0.945235, 'precision': 0.61889136, 'recall': 0.78629863, 'specificity': 0.78629863, 'f1': 0.6625784, 'auroc': 0.9101885, 'binary_precision': 0.24759153, 'binary_recall': 0.6192771, 'binary_specificity': 0.9533202, 'binary_f1_score': 0.35375085}
confusion matrix:
       0    1
0  15950  781
1    158  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212972, 'precision': 0.7170485, 'recall': 0.6888424, 'specificity': 0.6888424, 'f1': 0.70166194, 'auroc': 0.8774081, 'binary_precision': 0.48192772, 'binary_recall': 0.41450778, 'binary_specificity': 0.963177, 'binary_f1_score': 0.44568247}
confusion matrix:
      0    1
0  8998  344
1   452  320
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 14:48:29.150894,epoch time: 0:25:24.974663,used: 2:08:40.803852,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97864026, 'precision': 0.978883, 'recall': 0.9786475, 'specificity': 0.9786475, 'f1': 0.9786378, 'auroc': 0.99724674, 'binary_precision': 0.9898248, 'binary_recall': 0.96725065, 'binary_specificity': 0.99004424, 'binary_f1_score': 0.97840756}
confusion matrix:
       0      1
0  25060    252
1    830  24514
---- Validation: 
scalar performance:
{'acc': 0.9420273, 'precision': 0.6115466, 'recall': 0.77995527, 'specificity': 0.77995527, 'f1': 0.6535105, 'auroc': 0.9059844, 'binary_precision': 0.23317972, 'binary_recall': 0.6096386, 'binary_specificity': 0.95027196, 'binary_f1_score': 0.33733335}
confusion matrix:
       0    1
0  15899  832
1    162  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9198141, 'precision': 0.716114, 'recall': 0.71893525, 'specificity': 0.71893525, 'f1': 0.7175124, 'auroc': 0.88162124, 'binary_precision': 0.47509578, 'binary_recall': 0.4818653, 'binary_specificity': 0.95600516, 'binary_f1_score': 0.4784566}
confusion matrix:
      0    1
0  8931  411
1   400  372
early stop counter: 1
val acc:0.9420272707939148, best validation acc: 0.945235013961792, corresponding to test acc:                         0.9212971925735474 / 0.9212971925735474
after epoch: 6,now: 2024-08-06 15:13:22.312274,epoch time: 0:24:53.161380,used: 2:33:33.965232,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98162115, 'precision': 0.9816714, 'recall': 0.98162466, 'specificity': 0.98162466, 'f1': 0.9816208, 'auroc': 0.99744684, 'binary_precision': 0.98676133, 'binary_recall': 0.97636616, 'binary_specificity': 0.98688316, 'binary_f1_score': 0.9815362}
confusion matrix:
       0      1
0  24979    332
1    599  24746
---- Validation: 
scalar performance:
{'acc': 0.9438353, 'precision': 0.62390256, 'recall': 0.82082945, 'specificity': 0.82082945, 'f1': 0.6720273, 'auroc': 0.9234402, 'binary_precision': 0.2557932, 'binary_recall': 0.6915663, 'binary_specificity': 0.9500926, 'binary_f1_score': 0.37345475}
confusion matrix:
       0    1
0  15896  835
1    128  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9187265, 'precision': 0.71687436, 'recall': 0.7468655, 'specificity': 0.7468655, 'f1': 0.7305703, 'auroc': 0.89165527, 'binary_precision': 0.47191012, 'binary_recall': 0.54404145, 'binary_specificity': 0.94968957, 'binary_f1_score': 0.50541514}
confusion matrix:
      0    1
0  8872  470
1   352  420
early stop counter: 2
val acc:0.9438353180885315, best validation acc: 0.945235013961792, corresponding to test acc:                         0.9212971925735474 / 0.9212971925735474
after epoch: 7,now: 2024-08-06 15:38:15.827776,epoch time: 0:24:53.515502,used: 2:58:27.480734,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9816409, 'precision': 0.98173404, 'recall': 0.9816442, 'specificity': 0.9816442, 'f1': 0.9816401, 'auroc': 0.9973177, 'binary_precision': 0.98855174, 'binary_recall': 0.97458565, 'binary_specificity': 0.9887028, 'binary_f1_score': 0.981519}
confusion matrix:
       0      1
0  25030    286
1    644  24696
---- Validation: 
scalar performance:
{'acc': 0.9483261, 'precision': 0.6303308, 'recall': 0.80903137, 'specificity': 0.80903137, 'f1': 0.6780211, 'auroc': 0.9221741, 'binary_precision': 0.2693438, 'binary_recall': 0.6626506, 'binary_specificity': 0.9554121, 'binary_f1_score': 0.38300836}
confusion matrix:
       0    1
0  15985  746
1    140  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92011076, 'precision': 0.7177364, 'recall': 0.7244431, 'specificity': 0.7244431, 'f1': 0.72102225, 'auroc': 0.88618284, 'binary_precision': 0.4774436, 'binary_recall': 0.49352333, 'binary_specificity': 0.95536286, 'binary_f1_score': 0.4853503}
confusion matrix:
      0    1
0  8925  417
1   391  381
better model found
persisted
after epoch: 8,now: 2024-08-06 16:03:50.355070,epoch time: 0:25:34.527294,used: 3:24:02.008028,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98298323, 'precision': 0.9831282, 'recall': 0.9829885, 'specificity': 0.9829885, 'f1': 0.9829821, 'auroc': 0.99765855, 'binary_precision': 0.9916456, 'binary_recall': 0.97419405, 'binary_specificity': 0.9917829, 'binary_f1_score': 0.9828423}
confusion matrix:
       0      1
0  25105    208
1    654  24689
---- Validation: 
scalar performance:
{'acc': 0.93520355, 'precision': 0.6082176, 'recall': 0.8128817, 'specificity': 0.8128817, 'f1': 0.6521152, 'auroc': 0.9165388, 'binary_precision': 0.22468354, 'binary_recall': 0.6843374, 'binary_specificity': 0.9414261, 'binary_f1_score': 0.33829662}
confusion matrix:
       0    1
0  15751  980
1    131  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9195175, 'precision': 0.7200242, 'recall': 0.75501764, 'specificity': 0.75501764, 'f1': 0.735795, 'auroc': 0.8897337, 'binary_precision': 0.47687224, 'binary_recall': 0.56088084, 'binary_specificity': 0.9491544, 'binary_f1_score': 0.5154762}
confusion matrix:
      0    1
0  8867  475
1   339  433
early stop counter: 1
val acc:0.9352035522460938, best validation acc: 0.9483261108398438, corresponding to test acc:                         0.9201107621192932 / 0.9212971925735474
after epoch: 9,now: 2024-08-06 16:28:46.246774,epoch time: 0:24:55.891704,used: 3:48:57.899732,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98515475, 'precision': 0.9851637, 'recall': 0.9851561, 'specificity': 0.9851561, 'f1': 0.9851547, 'auroc': 0.9982275, 'binary_precision': 0.98739445, 'binary_recall': 0.98287493, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.9851295}
confusion matrix:
       0      1
0  24995    318
1    434  24909
---- Validation: 
scalar performance:
{'acc': 0.91228276, 'precision': 0.588598, 'recall': 0.838735, 'specificity': 0.838735, 'f1': 0.6245541, 'auroc': 0.91856116, 'binary_precision': 0.18361418, 'binary_recall': 0.76144576, 'binary_specificity': 0.91602415, 'binary_f1_score': 0.29588017}
confusion matrix:
       0     1
0  15326  1405
1     99   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9176389, 'precision': 0.71379524, 'recall': 0.74508846, 'specificity': 0.74508846, 'f1': 0.72800744, 'auroc': 0.8888128, 'binary_precision': 0.46599776, 'binary_recall': 0.5414508, 'binary_specificity': 0.9487262, 'binary_f1_score': 0.5008988}
confusion matrix:
      0    1
0  8863  479
1   354  418
early stop counter: 2
val acc:0.9122827649116516, best validation acc: 0.9483261108398438, corresponding to test acc:                         0.9201107621192932 / 0.9212971925735474
after epoch: 10,now: 2024-08-06 16:53:02.184566,epoch time: 0:24:15.937792,used: 4:13:13.837524,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.985214, 'precision': 0.98525476, 'recall': 0.9852166, 'specificity': 0.9852166, 'f1': 0.98521376, 'auroc': 0.9980205, 'binary_precision': 0.9898419, 'binary_recall': 0.98050666, 'binary_specificity': 0.9899265, 'binary_f1_score': 0.9851521}
confusion matrix:
       0      1
0  25059    255
1    494  24848
---- Validation: 
scalar performance:
{'acc': 0.943602, 'precision': 0.61671746, 'recall': 0.7901616, 'specificity': 0.7901616, 'f1': 0.66054595, 'auroc': 0.9134109, 'binary_precision': 0.24301676, 'binary_recall': 0.62891567, 'binary_specificity': 0.95140755, 'binary_f1_score': 0.35057086}
confusion matrix:
       0    1
0  15918  813
1    154  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92287916, 'precision': 0.722924, 'recall': 0.6885104, 'specificity': 0.6885104, 'f1': 0.7038448, 'auroc': 0.88249356, 'binary_precision': 0.4937888, 'binary_recall': 0.4119171, 'binary_specificity': 0.9651038, 'binary_f1_score': 0.4491525}
confusion matrix:
      0    1
0  9016  326
1   454  318
new oracle model saved
early stop counter: 3
val acc:0.9436020255088806, best validation acc: 0.9483261108398438, corresponding to test acc:                         0.9201107621192932 / 0.922879159450531
after epoch: 11,now: 2024-08-06 17:18:20.904368,epoch time: 0:25:18.719802,used: 4:38:32.557326,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.984681, 'precision': 0.9847353, 'recall': 0.98468447, 'specificity': 0.98468447, 'f1': 0.98468065, 'auroc': 0.9979336, 'binary_precision': 0.9900271, 'binary_recall': 0.9792456, 'binary_specificity': 0.9901233, 'binary_f1_score': 0.98460686}
confusion matrix:
       0      1
0  25062    250
1    526  24818
---- Validation: 
scalar performance:
{'acc': 0.9520588, 'precision': 0.6232583, 'recall': 0.7439727, 'specificity': 0.7439727, 'f1': 0.6608492, 'auroc': 0.90031826, 'binary_precision': 0.25860023, 'binary_recall': 0.5253012, 'binary_specificity': 0.9626442, 'binary_f1_score': 0.34658188}
confusion matrix:
       0    1
0  16106  625
1    197  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9258454, 'precision': 0.73452514, 'recall': 0.6669444, 'specificity': 0.6669444, 'f1': 0.6934825, 'auroc': 0.8816419, 'binary_precision': 0.5205224, 'binary_recall': 0.36139897, 'binary_specificity': 0.97248983, 'binary_f1_score': 0.42660552}
confusion matrix:
      0    1
0  9085  257
1   493  279
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-06 17:44:01.508101,epoch time: 0:25:40.603733,used: 5:04:13.161059,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98600364, 'precision': 0.98606074, 'recall': 0.98600733, 'specificity': 0.98600733, 'f1': 0.9860033, 'auroc': 0.99848425, 'binary_precision': 0.9915011, 'binary_recall': 0.98043007, 'binary_specificity': 0.99158466, 'binary_f1_score': 0.98593444}
confusion matrix:
       0      1
0  25098    213
1    496  24849
---- Validation: 
scalar performance:
{'acc': 0.9276216, 'precision': 0.6024649, 'recall': 0.83249545, 'specificity': 0.83249545, 'f1': 0.64528733, 'auroc': 0.91819584, 'binary_precision': 0.21199442, 'binary_recall': 0.7325301, 'binary_specificity': 0.9324607, 'binary_f1_score': 0.3288264}
confusion matrix:
       0     1
0  15601  1130
1    111   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9203085, 'precision': 0.71946824, 'recall': 0.73346233, 'specificity': 0.73346233, 'f1': 0.726178, 'auroc': 0.8980278, 'binary_precision': 0.47941887, 'binary_recall': 0.51295334, 'binary_specificity': 0.9539713, 'binary_f1_score': 0.4956195}
confusion matrix:
      0    1
0  8912  430
1   376  396
early stop counter: 1
val acc:0.927621603012085, best validation acc: 0.9520587921142578, corresponding to test acc:                         0.9258453845977783 / 0.9258453845977783
after epoch: 13,now: 2024-08-06 18:08:38.058064,epoch time: 0:24:36.549963,used: 5:28:49.711022,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98629975, 'precision': 0.9863943, 'recall': 0.9863048, 'specificity': 0.9863048, 'f1': 0.98629916, 'auroc': 0.99848086, 'binary_precision': 0.99335575, 'binary_recall': 0.9791683, 'binary_specificity': 0.99344134, 'binary_f1_score': 0.986211}
confusion matrix:
       0      1
0  25144    166
1    528  24818
---- Validation: 
scalar performance:
{'acc': 0.95141727, 'precision': 0.63052326, 'recall': 0.77889204, 'specificity': 0.77889204, 'f1': 0.67397106, 'auroc': 0.9093982, 'binary_precision': 0.2713348, 'binary_recall': 0.5975904, 'binary_specificity': 0.96019363, 'binary_f1_score': 0.37321293}
confusion matrix:
       0    1
0  16065  666
1    167  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92179155, 'precision': 0.71874976, 'recall': 0.68792176, 'specificity': 0.68792176, 'f1': 0.701809, 'auroc': 0.8835658, 'binary_precision': 0.4854962, 'binary_recall': 0.4119171, 'binary_specificity': 0.9639264, 'binary_f1_score': 0.44569027}
confusion matrix:
      0    1
0  9005  337
1   454  318
early stop counter: 2
val acc:0.9514172673225403, best validation acc: 0.9520587921142578, corresponding to test acc:                         0.9258453845977783 / 0.9258453845977783
after epoch: 14,now: 2024-08-06 18:35:01.057053,epoch time: 0:26:22.998989,used: 5:55:12.710011,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98628, 'precision': 0.9863068, 'recall': 0.9862821, 'specificity': 0.9862821, 'f1': 0.98627985, 'auroc': 0.99842346, 'binary_precision': 0.9900585, 'binary_recall': 0.98244023, 'binary_specificity': 0.99012405, 'binary_f1_score': 0.98623466}
confusion matrix:
       0      1
0  25064    250
1    445  24897
---- Validation: 
scalar performance:
{'acc': 0.9471597, 'precision': 0.6256536, 'recall': 0.7990342, 'specificity': 0.7990342, 'f1': 0.6716275, 'auroc': 0.9159969, 'binary_precision': 0.2604878, 'binary_recall': 0.6433735, 'binary_specificity': 0.95469487, 'binary_f1_score': 0.37083334}
confusion matrix:
       0    1
0  15973  758
1    148  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210995, 'precision': 0.7184981, 'recall': 0.70596564, 'specificity': 0.70596564, 'f1': 0.71198833, 'auroc': 0.8893089, 'binary_precision': 0.4820442, 'binary_recall': 0.45207253, 'binary_specificity': 0.9598587, 'binary_f1_score': 0.46657753}
confusion matrix:
      0    1
0  8967  375
1   423  349
early stop counter: 3
val acc:0.9471597075462341, best validation acc: 0.9520587921142578, corresponding to test acc:                         0.9258453845977783 / 0.9258453845977783
after epoch: 15,now: 2024-08-06 19:02:09.827601,epoch time: 0:27:08.770548,used: 6:22:21.480559,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98675376, 'precision': 0.98675394, 'recall': 0.9867537, 'specificity': 0.9867537, 'f1': 0.9867538, 'auroc': 0.99864614, 'binary_precision': 0.9866272, 'binary_recall': 0.98689973, 'binary_specificity': 0.9866077, 'binary_f1_score': 0.9867635}
confusion matrix:
       0      1
0  24974    339
1    332  25011
---- Validation: 
scalar performance:
{'acc': 0.94395196, 'precision': 0.6187401, 'recall': 0.7962156, 'specificity': 0.7962156, 'f1': 0.6635149, 'auroc': 0.910902, 'binary_precision': 0.24675325, 'binary_recall': 0.64096385, 'binary_specificity': 0.95146734, 'binary_f1_score': 0.35632953}
confusion matrix:
       0    1
0  15919  812
1    149  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9163536, 'precision': 0.7065944, 'recall': 0.72122097, 'specificity': 0.72122097, 'f1': 0.71357167, 'auroc': 0.8890619, 'binary_precision': 0.45552886, 'binary_recall': 0.49093264, 'binary_specificity': 0.9515093, 'binary_f1_score': 0.4725686}
confusion matrix:
      0    1
0  8889  453
1   393  379
early stop counter: 4
val acc:0.9439519643783569, best validation acc: 0.9520587921142578, corresponding to test acc:                         0.9258453845977783 / 0.9258453845977783
after epoch: 16,now: 2024-08-06 19:27:53.380121,epoch time: 0:25:43.552520,used: 6:48:05.033079,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9872473, 'precision': 0.9873423, 'recall': 0.9872509, 'specificity': 0.9872509, 'f1': 0.98724675, 'auroc': 0.9987363, 'binary_precision': 0.9942756, 'binary_recall': 0.98015076, 'binary_specificity': 0.99435115, 'binary_f1_score': 0.98716265}
confusion matrix:
       0      1
0  25172    143
1    503  24838
---- Validation: 
scalar performance:
{'acc': 0.9570162, 'precision': 0.6488645, 'recall': 0.7923354, 'specificity': 0.7923354, 'f1': 0.6942828, 'auroc': 0.9160717, 'binary_precision': 0.30741626, 'binary_recall': 0.6192771, 'binary_specificity': 0.9653936, 'binary_f1_score': 0.4108713}
confusion matrix:
       0    1
0  16152  579
1    158  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92258257, 'precision': 0.7201026, 'recall': 0.67230797, 'specificity': 0.67230797, 'f1': 0.6924319, 'auroc': 0.8874554, 'binary_precision': 0.49072513, 'binary_recall': 0.376943, 'binary_specificity': 0.9676729, 'binary_f1_score': 0.4263736}
confusion matrix:
      0    1
0  9040  302
1   481  291
better model found
persisted
after epoch: 17,now: 2024-08-06 19:55:44.957207,epoch time: 0:27:51.577086,used: 7:15:56.610165,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98740524, 'precision': 0.9874054, 'recall': 0.9874052, 'specificity': 0.9874052, 'f1': 0.98740524, 'auroc': 0.9989078, 'binary_precision': 0.9871805, 'binary_recall': 0.987648, 'binary_specificity': 0.9871623, 'binary_f1_score': 0.9874142}
confusion matrix:
       0      1
0  24991    325
1    313  25027
---- Validation: 
scalar performance:
{'acc': 0.92750496, 'precision': 0.6023168, 'recall': 0.8324356, 'specificity': 0.8324356, 'f1': 0.6450777, 'auroc': 0.9165838, 'binary_precision': 0.21169916, 'binary_recall': 0.7325301, 'binary_specificity': 0.93234116, 'binary_f1_score': 0.3284711}
confusion matrix:
       0     1
0  15599  1132
1    111   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210006, 'precision': 0.71904457, 'recall': 0.71304184, 'specificity': 0.71304184, 'f1': 0.71598816, 'auroc': 0.89111865, 'binary_precision': 0.48197597, 'binary_recall': 0.4676166, 'binary_specificity': 0.9584671, 'binary_f1_score': 0.4746877}
confusion matrix:
      0    1
0  8954  388
1   411  361
early stop counter: 1
val acc:0.9275049567222595, best validation acc: 0.9570162296295166, corresponding to test acc:                         0.9225825667381287 / 0.9258453845977783
after epoch: 18,now: 2024-08-06 20:19:08.955031,epoch time: 0:23:23.997824,used: 7:39:20.607989,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98697096, 'precision': 0.98708093, 'recall': 0.98697674, 'specificity': 0.98697674, 'f1': 0.9869703, 'auroc': 0.9986439, 'binary_precision': 0.9945907, 'binary_recall': 0.9792875, 'binary_specificity': 0.9946659, 'binary_f1_score': 0.9868798}
confusion matrix:
       0      1
0  25174    135
1    525  24822
---- Validation: 
scalar performance:
{'acc': 0.95474166, 'precision': 0.6352943, 'recall': 0.7629714, 'specificity': 0.7629714, 'f1': 0.6758609, 'auroc': 0.9064573, 'binary_precision': 0.28174123, 'binary_recall': 0.5614458, 'binary_specificity': 0.964497, 'binary_f1_score': 0.3752013}
confusion matrix:
       0    1
0  16137  594
1    182  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9220882, 'precision': 0.71595794, 'recall': 0.6548101, 'specificity': 0.6548101, 'f1': 0.6788662, 'auroc': 0.88673145, 'binary_precision': 0.48518518, 'binary_recall': 0.33937824, 'binary_specificity': 0.9702419, 'binary_f1_score': 0.39939025}
confusion matrix:
      0    1
0  9064  278
1   510  262
early stop counter: 2
val acc:0.9547416567802429, best validation acc: 0.9570162296295166, corresponding to test acc:                         0.9225825667381287 / 0.9258453845977783
after epoch: 19,now: 2024-08-06 20:44:11.700024,epoch time: 0:25:02.744993,used: 8:04:23.352982,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9869117, 'precision': 0.98701286, 'recall': 0.9869152, 'specificity': 0.9869152, 'f1': 0.98691106, 'auroc': 0.99854505, 'binary_precision': 0.9941527, 'binary_recall': 0.97959745, 'binary_specificity': 0.9942329, 'binary_f1_score': 0.9868215}
confusion matrix:
       0      1
0  25170    146
1    517  24823
---- Validation: 
scalar performance:
{'acc': 0.9541001, 'precision': 0.63963896, 'recall': 0.78849125, 'specificity': 0.78849125, 'f1': 0.6846815, 'auroc': 0.9160897, 'binary_precision': 0.28911564, 'binary_recall': 0.61445785, 'binary_specificity': 0.96252465, 'binary_f1_score': 0.39321512}
confusion matrix:
       0    1
0  16104  627
1    160  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92179155, 'precision': 0.71569365, 'recall': 0.66296756, 'specificity': 0.66296756, 'f1': 0.6845675, 'auroc': 0.8924665, 'binary_precision': 0.48336253, 'binary_recall': 0.35751295, 'binary_specificity': 0.9684222, 'binary_f1_score': 0.4110201}
confusion matrix:
      0    1
0  9047  295
1   496  276
early stop counter: 3
val acc:0.9541000723838806, best validation acc: 0.9570162296295166, corresponding to test acc:                         0.9225825667381287 / 0.9258453845977783
after epoch: 20,now: 2024-08-06 21:07:17.680232,epoch time: 0:23:05.980208,used: 8:27:29.333190,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_12_39_48_seed_0_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 8:27:29.333190 at 2024-08-06 21:07:17.680232
persisted model performance metric: 

scalar performance:
{'acc': 0.92258257, 'precision': 0.7201026, 'recall': 0.67230797, 'specificity': 0.67230797, 'f1': 0.6924319, 'auroc': 0.8874554, 'binary_precision': 0.49072513, 'binary_recall': 0.376943, 'binary_specificity': 0.9676729, 'binary_f1_score': 0.4263736}
confusion matrix:
      0    1
0  9040  302
1   481  291
oracle model performance metric: 

scalar performance:
{'acc': 0.9258454, 'precision': 0.73452514, 'recall': 0.6669444, 'specificity': 0.6669444, 'f1': 0.6934825, 'auroc': 0.8816419, 'binary_precision': 0.5205224, 'binary_recall': 0.36139897, 'binary_specificity': 0.97248983, 'binary_f1_score': 0.42660552}
confusion matrix:
      0    1
0  9085  257
1   493  279
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198334 KiB |   1195 MiB | 615847 GiB | 615847 GiB |
|       from large pool | 180120 KiB |   1178 MiB | 607255 GiB | 607255 GiB |
|       from small pool |  18214 KiB |     38 MiB |   8592 GiB |   8592 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198334 KiB |   1195 MiB | 615847 GiB | 615847 GiB |
|       from large pool | 180120 KiB |   1178 MiB | 607255 GiB | 607255 GiB |
|       from small pool |  18214 KiB |     38 MiB |   8592 GiB |   8592 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   1193 MiB | 615828 GiB | 615828 GiB |
|       from large pool | 178979 KiB |   1176 MiB | 607253 GiB | 607252 GiB |
|       from small pool |  16663 KiB |     36 MiB |   8575 GiB |   8575 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1346 MiB |   1346 MiB |   1346 MiB |      0 B   |
|       from large pool |   1304 MiB |   1304 MiB |   1304 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  63810 KiB | 161596 KiB | 310327 GiB | 310327 GiB |
|       from large pool |  51304 KiB | 160090 KiB | 301721 GiB | 301721 GiB |
|       from small pool |  12506 KiB |  13009 KiB |   8605 GiB |   8605 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6807    |  106153 K  |  106148 K  |
|       from large pool |      79    |     167    |   56873 K  |   56873 K  |
|       from small pool |    4345    |    6727    |   49279 K  |   49275 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6807    |  106153 K  |  106148 K  |
|       from large pool |      79    |     167    |   56873 K  |   56873 K  |
|       from small pool |    4345    |    6727    |   49279 K  |   49275 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |      76    |      76    |       0    |
|       from large pool |      55    |      55    |      55    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3186    |   60205 K  |   60205 K  |
|       from large pool |       9    |      57    |   39819 K  |   39819 K  |
|       from small pool |      23    |    3177    |   20385 K  |   20385 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB | 615847 GiB | 615847 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 607255 GiB | 607255 GiB |
|       from small pool |      0 KiB |     38 MiB |   8592 GiB |   8592 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB | 615847 GiB | 615847 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 607255 GiB | 607255 GiB |
|       from small pool |      0 KiB |     38 MiB |   8592 GiB |   8592 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB | 615828 GiB | 615828 GiB |
|       from large pool |  16640 KiB |   1176 MiB | 607253 GiB | 607253 GiB |
|       from small pool |      0 KiB |     36 MiB |   8575 GiB |   8575 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   1346 MiB |   1346 MiB |   1090 MiB |
|       from large pool | 231424 KiB |   1304 MiB |   1304 MiB |   1078 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 310327 GiB | 310327 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 301721 GiB | 301721 GiB |
|       from small pool |      0 KiB |  23712 KiB |   8606 GiB |   8606 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |  106153 K  |  106153 K  |
|       from large pool |       2    |     167    |   56873 K  |   56873 K  |
|       from small pool |       0    |    6727    |   49279 K  |   49279 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |  106153 K  |  106153 K  |
|       from large pool |       2    |     167    |   56873 K  |   56873 K  |
|       from small pool |       0    |    6727    |   49279 K  |   49279 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      76    |      76    |      50    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3186    |   60207 K  |   60207 K  |
|       from large pool |       3    |      57    |   39819 K  |   39819 K  |
|       from small pool |       0    |    3177    |   20387 K  |   20387 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB | 615847 GiB | 615847 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 607255 GiB | 607255 GiB |
|       from small pool |      0 KiB |     38 MiB |   8592 GiB |   8592 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB | 615847 GiB | 615847 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 607255 GiB | 607255 GiB |
|       from small pool |      0 KiB |     38 MiB |   8592 GiB |   8592 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB | 615828 GiB | 615828 GiB |
|       from large pool |  16640 KiB |   1176 MiB | 607253 GiB | 607253 GiB |
|       from small pool |      0 KiB |     36 MiB |   8575 GiB |   8575 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 262144 KiB |   1346 MiB |   1346 MiB |   1090 MiB |
|       from large pool | 231424 KiB |   1304 MiB |   1304 MiB |   1078 MiB |
|       from small pool |  30720 KiB |     42 MiB |     42 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 310327 GiB | 310327 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 301721 GiB | 301721 GiB |
|       from small pool |      0 KiB |  23712 KiB |   8606 GiB |   8606 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6807    |  106153 K  |  106153 K  |
|       from large pool |       2    |     167    |   56873 K  |   56873 K  |
|       from small pool |       0    |    6727    |   49279 K  |   49279 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6807    |  106153 K  |  106153 K  |
|       from large pool |       2    |     167    |   56873 K  |   56873 K  |
|       from small pool |       0    |    6727    |   49279 K  |   49279 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      76    |      76    |      50    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |      15    |      21    |      21    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3186    |   60207 K  |   60207 K  |
|       from large pool |       3    |      57    |   39819 K  |   39819 K  |
|       from small pool |       0    |    3177    |   20387 K  |   20387 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_32_22_seed_1_24076676

 Experiment start at: 2024-08-06 21:32:23.059631
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94471985, 'precision': 0.947133, 'recall': 0.9447489, 'specificity': 0.9447489, 'f1': 0.94464767, 'auroc': 0.98565626, 'binary_precision': 0.9801783, 'binary_recall': 0.90788645, 'binary_specificity': 0.98161125, 'binary_f1_score': 0.9426484}
confusion matrix:
       0      1
0  24929    467
1   2343  23093
---- Validation: 
scalar performance:
{'acc': 0.9397886, 'precision': 0.60487026, 'recall': 0.7521304, 'specificity': 0.7521304, 'f1': 0.6426363, 'auroc': 0.8652946, 'binary_precision': 0.22170687, 'binary_recall': 0.55452436, 'binary_specificity': 0.9497364, 'binary_f1_score': 0.31676608}
confusion matrix:
       0    1
0  15853  839
1    192  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556139, 'precision': 0.63471806, 'recall': 0.77628773, 'specificity': 0.77628773, 'f1': 0.66636807, 'auroc': 0.86750895, 'binary_precision': 0.29815456, 'binary_recall': 0.682959, 'binary_specificity': 0.86961645, 'binary_f1_score': 0.41509435}
confusion matrix:
      0     1
0  8117  1217
1   240   517
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 22:00:54.635213,epoch time: 0:28:31.575582,used: 0:28:31.575582,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_32_22_seed_1_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.961658, 'precision': 0.96201986, 'recall': 0.9616697, 'specificity': 0.9616697, 'f1': 0.9616512, 'auroc': 0.99173594, 'binary_precision': 0.9751578, 'binary_recall': 0.9475174, 'binary_specificity': 0.97582203, 'binary_f1_score': 0.96113896}
confusion matrix:
       0      1
0  24781    614
1   1335  24102
---- Validation: 
scalar performance:
{'acc': 0.93342286, 'precision': 0.6075478, 'recall': 0.80424213, 'specificity': 0.80424213, 'f1': 0.6503099, 'auroc': 0.88431954, 'binary_precision': 0.22412452, 'binary_recall': 0.6682135, 'binary_specificity': 0.9402708, 'binary_f1_score': 0.33566436}
confusion matrix:
       0    1
0  15695  997
1    143  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84243387, 'precision': 0.6398945, 'recall': 0.82742894, 'specificity': 0.82742894, 'f1': 0.6719056, 'auroc': 0.8918682, 'binary_precision': 0.29771733, 'binary_recall': 0.8097754, 'binary_specificity': 0.8450825, 'binary_f1_score': 0.43536934}
confusion matrix:
      0     1
0  7888  1446
1   144   613
early stop counter: 1
val acc:0.933422863483429, best validation acc: 0.9397885799407959, corresponding to test acc:                         0.8556138873100281 / 0.8556138873100281
after epoch: 2,now: 2024-08-06 22:26:45.133150,epoch time: 0:25:50.497937,used: 0:54:22.073519,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_32_22_seed_1_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.968209, 'precision': 0.96842283, 'recall': 0.96821713, 'specificity': 0.96821713, 'f1': 0.9682057, 'auroc': 0.9937998, 'binary_precision': 0.97861993, 'binary_recall': 0.95738155, 'binary_specificity': 0.97905266, 'binary_f1_score': 0.9678842}
confusion matrix:
       0      1
0  24865    532
1   1084  24351
---- Validation: 
scalar performance:
{'acc': 0.9118729, 'precision': 0.58866704, 'recall': 0.8248328, 'specificity': 0.8248328, 'f1': 0.62409353, 'auroc': 0.8890555, 'binary_precision': 0.18479532, 'binary_recall': 0.7331787, 'binary_specificity': 0.9164869, 'binary_f1_score': 0.29518917}
confusion matrix:
       0     1
0  15298  1394
1    115   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8216232, 'precision': 0.6299036, 'recall': 0.8313531, 'specificity': 0.8313531, 'f1': 0.6547991, 'auroc': 0.89589685, 'binary_precision': 0.2751186, 'binary_recall': 0.84280056, 'binary_specificity': 0.8199057, 'binary_f1_score': 0.41482443}
confusion matrix:
      0     1
0  7653  1681
1   119   638
early stop counter: 2
val acc:0.911872923374176, best validation acc: 0.9397885799407959, corresponding to test acc:                         0.8556138873100281 / 0.8556138873100281
after epoch: 3,now: 2024-08-06 22:51:39.440339,epoch time: 0:24:54.307189,used: 1:19:16.380708,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_32_22_seed_1_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97226155, 'precision': 0.97226334, 'recall': 0.97226083, 'specificity': 0.97226083, 'f1': 0.97226155, 'auroc': 0.9950939, 'binary_precision': 0.9715452, 'binary_recall': 0.9730728, 'binary_specificity': 0.97144884, 'binary_f1_score': 0.97230846}
confusion matrix:
       0      1
0  24668    725
1    685  24754
---- Validation: 
scalar performance:
{'acc': 0.8628745, 'precision': 0.56002057, 'recall': 0.8121325, 'specificity': 0.8121325, 'f1': 0.5713522, 'auroc': 0.8905125, 'binary_precision': 0.12718786, 'binary_recall': 0.75870067, 'binary_specificity': 0.86556435, 'binary_f1_score': 0.21785475}
confusion matrix:
       0     1
0  14448  2244
1    104   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.785056, 'precision': 0.6159621, 'recall': 0.8316155, 'specificity': 0.8316155, 'f1': 0.62606055, 'auroc': 0.8961964, 'binary_precision': 0.24364561, 'binary_recall': 0.88639367, 'binary_specificity': 0.77683735, 'binary_f1_score': 0.3822273}
confusion matrix:
      0     1
0  7251  2083
1    86   671
early stop counter: 3
val acc:0.8628745079040527, best validation acc: 0.9397885799407959, corresponding to test acc:                         0.8556138873100281 / 0.8556138873100281
after epoch: 4,now: 2024-08-06 23:16:23.975710,epoch time: 0:24:44.535371,used: 1:44:00.916079,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_32_22_seed_1_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9761961, 'precision': 0.97637856, 'recall': 0.97620314, 'specificity': 0.97620314, 'f1': 0.9761941, 'auroc': 0.99652004, 'binary_precision': 0.98587936, 'binary_recall': 0.9662656, 'binary_specificity': 0.98614067, 'binary_f1_score': 0.97597396}
confusion matrix:
       0      1
0  25046    352
1    858  24576
---- Validation: 
scalar performance:
{'acc': 0.8984407, 'precision': 0.5778622, 'recall': 0.81907344, 'specificity': 0.81907344, 'f1': 0.606306, 'auroc': 0.89214265, 'binary_precision': 0.16323379, 'binary_recall': 0.73549885, 'binary_specificity': 0.902648, 'binary_f1_score': 0.26717237}
confusion matrix:
       0     1
0  15067  1625
1    114   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244971, 'precision': 0.63246644, 'recall': 0.83594126, 'specificity': 0.83594126, 'f1': 0.65862894, 'auroc': 0.8970252, 'binary_precision': 0.27956522, 'binary_recall': 0.8494055, 'binary_specificity': 0.822477, 'binary_f1_score': 0.42067385}
confusion matrix:
      0     1
0  7677  1657
1   114   643
early stop counter: 4
val acc:0.8984407186508179, best validation acc: 0.9397885799407959, corresponding to test acc:                         0.8556138873100281 / 0.8556138873100281
after epoch: 5,now: 2024-08-06 23:41:18.709648,epoch time: 0:24:54.733938,used: 2:08:55.650017,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_32_22_seed_1_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9772781, 'precision': 0.9773701, 'recall': 0.97728395, 'specificity': 0.97728395, 'f1': 0.97727716, 'auroc': 0.9967117, 'binary_precision': 0.98420674, 'binary_recall': 0.97016156, 'binary_specificity': 0.98440635, 'binary_f1_score': 0.97713363}
confusion matrix:
       0      1
0  24999    396
1    759  24678
---- Validation: 
scalar performance:
{'acc': 0.86497694, 'precision': 0.56343293, 'recall': 0.8290328, 'specificity': 0.8290328, 'f1': 0.5769048, 'auroc': 0.8942485, 'binary_precision': 0.13304721, 'binary_recall': 0.7911833, 'binary_specificity': 0.8668823, 'binary_f1_score': 0.22778891}
confusion matrix:
       0     1
0  14470  2222
1     90   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81498367, 'precision': 0.6297867, 'recall': 0.8423305, 'specificity': 0.8423305, 'f1': 0.6525176, 'auroc': 0.9008088, 'binary_precision': 0.2719803, 'binary_recall': 0.8745046, 'binary_specificity': 0.8101564, 'binary_f1_score': 0.41491696}
confusion matrix:
      0     1
0  7562  1772
1    95   662
early stop counter: 5
val acc:0.8649769425392151, best validation acc: 0.9397885799407959, corresponding to test acc:                         0.8556138873100281 / 0.8556138873100281
after epoch: 6,now: 2024-08-07 00:06:37.771619,epoch time: 0:25:19.061971,used: 2:34:14.711988,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_21_32_22_seed_1_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 2:34:14.711988 at 2024-08-07 00:06:37.771619
persisted model performance metric: 

scalar performance:
{'acc': 0.8556139, 'precision': 0.63471806, 'recall': 0.77628773, 'specificity': 0.77628773, 'f1': 0.66636807, 'auroc': 0.86750895, 'binary_precision': 0.29815456, 'binary_recall': 0.682959, 'binary_specificity': 0.86961645, 'binary_f1_score': 0.41509435}
confusion matrix:
      0     1
0  8117  1217
1   240   517
oracle model performance metric: 

scalar performance:
{'acc': 0.8556139, 'precision': 0.63471806, 'recall': 0.77628773, 'specificity': 0.77628773, 'f1': 0.66636807, 'auroc': 0.86750895, 'binary_precision': 0.29815456, 'binary_recall': 0.682959, 'binary_specificity': 0.86961645, 'binary_f1_score': 0.41509435}
confusion matrix:
      0     1
0  8117  1217
1   240   517
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   1195 MiB |    801 TiB |    801 TiB |
|       from large pool | 179211 KiB |   1178 MiB |    790 TiB |    790 TiB |
|       from small pool |  18208 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   1195 MiB |    801 TiB |    801 TiB |
|       from large pool | 179211 KiB |   1178 MiB |    790 TiB |    790 TiB |
|       from small pool |  18208 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   1193 MiB |    801 TiB |    801 TiB |
|       from large pool | 178979 KiB |   1176 MiB |    790 TiB |    790 TiB |
|       from small pool |  16662 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1336 MiB |   1346 MiB |   2426 MiB |   1090 MiB |
|       from large pool |   1298 MiB |   1304 MiB |   2376 MiB |   1078 MiB |
|       from small pool |     38 MiB |     42 MiB |     50 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB | 161596 KiB | 424354 GiB | 424354 GiB |
|       from large pool |  31733 KiB | 160090 KiB | 412664 GiB | 412664 GiB |
|       from small pool |  10464 KiB |  23712 KiB |  11689 GiB |  11689 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6829    |  141089 K  |  141085 K  |
|       from large pool |      79    |     167    |   75878 K  |   75878 K  |
|       from small pool |    4333    |    6749    |   65210 K  |   65206 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6829    |  141089 K  |  141085 K  |
|       from large pool |      79    |     167    |   75878 K  |   75878 K  |
|       from small pool |    4333    |    6749    |   65210 K  |   65206 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |     124    |      50    |
|       from large pool |      55    |      55    |      99    |      44    |
|       from small pool |      19    |      21    |      25    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3196    |   83180 K  |   83180 K  |
|       from large pool |      10    |      59    |   53815 K  |   53815 K  |
|       from small pool |      21    |    3186    |   29364 K  |   29364 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |    801 TiB |    801 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |    801 TiB |    801 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |    801 TiB |    801 TiB |
|       from large pool |  16640 KiB |   1176 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   1346 MiB |   2426 MiB |   2192 MiB |
|       from large pool | 210944 KiB |   1304 MiB |   2376 MiB |   2170 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 424354 GiB | 424354 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 412664 GiB | 412664 GiB |
|       from small pool |      0 KiB |  25471 KiB |  11689 GiB |  11689 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  141089 K  |  141089 K  |
|       from large pool |       2    |     167    |   75878 K  |   75878 K  |
|       from small pool |       0    |    6749    |   65210 K  |   65210 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  141089 K  |  141089 K  |
|       from large pool |       2    |     167    |   75878 K  |   75878 K  |
|       from small pool |       0    |    6749    |   65210 K  |   65210 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      76    |     124    |     100    |
|       from large pool |      10    |      55    |      99    |      89    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   83182 K  |   83182 K  |
|       from large pool |       3    |      59    |   53815 K  |   53815 K  |
|       from small pool |       0    |    3186    |   29366 K  |   29366 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |    801 TiB |    801 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |    801 TiB |    801 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     38 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |    801 TiB |    801 TiB |
|       from large pool |  16640 KiB |   1176 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   1346 MiB |   2426 MiB |   2192 MiB |
|       from large pool | 210944 KiB |   1304 MiB |   2376 MiB |   2170 MiB |
|       from small pool |  28672 KiB |     42 MiB |     50 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 424354 GiB | 424354 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 412664 GiB | 412664 GiB |
|       from small pool |      0 KiB |  25471 KiB |  11689 GiB |  11689 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6829    |  141089 K  |  141089 K  |
|       from large pool |       2    |     167    |   75878 K  |   75878 K  |
|       from small pool |       0    |    6749    |   65210 K  |   65210 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6829    |  141089 K  |  141089 K  |
|       from large pool |       2    |     167    |   75878 K  |   75878 K  |
|       from small pool |       0    |    6749    |   65210 K  |   65210 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      76    |     124    |     100    |
|       from large pool |      10    |      55    |      99    |      89    |
|       from small pool |      14    |      21    |      25    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   83182 K  |   83182 K  |
|       from large pool |       3    |      59    |   53815 K  |   53815 K  |
|       from small pool |       0    |    3186    |   29366 K  |   29366 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_32_11_seed_2_24076676

 Experiment start at: 2024-08-07 00:32:11.992562
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9480231, 'precision': 0.9495485, 'recall': 0.9480264, 'specificity': 0.9480264, 'f1': 0.9479792, 'auroc': 0.9854094, 'binary_precision': 0.97576404, 'binary_recall': 0.9188813, 'binary_specificity': 0.9771716, 'binary_f1_score': 0.9464688}
confusion matrix:
       0      1
0  25255    590
1   2097  23754
---- Validation: 
scalar performance:
{'acc': 0.9329596, 'precision': 0.5857089, 'recall': 0.7265613, 'specificity': 0.7265613, 'f1': 0.6177565, 'auroc': 0.8299406, 'binary_precision': 0.18425606, 'binary_recall': 0.5095694, 'binary_specificity': 0.9435532, 'binary_f1_score': 0.27064803}
confusion matrix:
       0    1
0  15763  943
1    205  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89486724, 'precision': 0.66648227, 'recall': 0.7169436, 'specificity': 0.7169436, 'f1': 0.68689215, 'auroc': 0.8593558, 'binary_precision': 0.37663552, 'binary_recall': 0.50564617, 'binary_specificity': 0.928241, 'binary_f1_score': 0.43170863}
confusion matrix:
      0    1
0  8628  667
1   394  403
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 00:56:51.207306,epoch time: 0:24:39.214744,used: 0:24:39.214744,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_32_11_seed_2_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96342075, 'precision': 0.96394664, 'recall': 0.9634247, 'specificity': 0.9634247, 'f1': 0.9634106, 'auroc': 0.9917628, 'binary_precision': 0.9796245, 'binary_recall': 0.946546, 'binary_specificity': 0.9803034, 'binary_f1_score': 0.9628012}
confusion matrix:
       0      1
0  25333    509
1   1382  24472
---- Validation: 
scalar performance:
{'acc': 0.92379117, 'precision': 0.58608484, 'recall': 0.7708446, 'specificity': 0.7708446, 'f1': 0.6203775, 'auroc': 0.84992874, 'binary_precision': 0.182534, 'binary_recall': 0.6100478, 'binary_specificity': 0.93164134, 'binary_f1_score': 0.28099173}
confusion matrix:
       0     1
0  15564  1142
1    163   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8999207, 'precision': 0.672893, 'recall': 0.70821583, 'specificity': 0.70821583, 'f1': 0.6882194, 'auroc': 0.86794794, 'binary_precision': 0.39121553, 'binary_recall': 0.48055208, 'binary_specificity': 0.9358795, 'binary_f1_score': 0.4313063}
confusion matrix:
      0    1
0  8699  596
1   414  383
new oracle model saved
early stop counter: 1
val acc:0.9237911701202393, best validation acc: 0.9329596161842346, corresponding to test acc:                         0.8948672413825989 / 0.8999207019805908
after epoch: 2,now: 2024-08-07 01:22:58.888540,epoch time: 0:26:07.681234,used: 0:50:46.895978,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_32_11_seed_2_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9684502, 'precision': 0.9692241, 'recall': 0.9684557, 'specificity': 0.9684557, 'f1': 0.96843743, 'auroc': 0.99386454, 'binary_precision': 0.9883477, 'binary_recall': 0.94809514, 'binary_specificity': 0.9888162, 'binary_f1_score': 0.96780306}
confusion matrix:
       0      1
0  25552    289
1   1342  24513
---- Validation: 
scalar performance:
{'acc': 0.90773183, 'precision': 0.57074183, 'recall': 0.7614478, 'specificity': 0.7614478, 'f1': 0.59708285, 'auroc': 0.8475457, 'binary_precision': 0.15209581, 'binary_recall': 0.6076555, 'binary_specificity': 0.91524005, 'binary_f1_score': 0.24329503}
confusion matrix:
       0     1
0  15290  1416
1    164   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90249705, 'precision': 0.6796522, 'recall': 0.7147764, 'specificity': 0.7147764, 'f1': 0.69500357, 'auroc': 0.8731463, 'binary_precision': 0.4037075, 'binary_recall': 0.49184442, 'binary_specificity': 0.93770844, 'binary_f1_score': 0.44343892}
confusion matrix:
      0    1
0  8716  579
1   405  392
new oracle model saved
early stop counter: 2
val acc:0.907731831073761, best validation acc: 0.9329596161842346, corresponding to test acc:                         0.8948672413825989 / 0.9024970531463623
after epoch: 3,now: 2024-08-07 01:47:25.645206,epoch time: 0:24:26.756666,used: 1:15:13.652644,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_32_11_seed_2_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9747756, 'precision': 0.9749538, 'recall': 0.97477674, 'specificity': 0.97477674, 'f1': 0.9747733, 'auroc': 0.99562013, 'binary_precision': 0.9841808, 'binary_recall': 0.96506906, 'binary_specificity': 0.98448443, 'binary_f1_score': 0.97453123}
confusion matrix:
       0      1
0  25444    401
1    903  24948
---- Validation: 
scalar performance:
{'acc': 0.92630225, 'precision': 0.58821064, 'recall': 0.7686328, 'specificity': 0.7686328, 'f1': 0.62326926, 'auroc': 0.8623897, 'binary_precision': 0.18694362, 'binary_recall': 0.6028708, 'binary_specificity': 0.93439484, 'binary_f1_score': 0.2853907}
confusion matrix:
       0     1
0  15610  1096
1    166   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9055688, 'precision': 0.6917734, 'recall': 0.73995996, 'specificity': 0.73995996, 'f1': 0.71209675, 'auroc': 0.88249755, 'binary_precision': 0.42367905, 'binary_recall': 0.54328734, 'binary_specificity': 0.9366326, 'binary_f1_score': 0.47608575}
confusion matrix:
      0    1
0  8706  589
1   364  433
new oracle model saved
early stop counter: 3
val acc:0.9263022541999817, best validation acc: 0.9329596161842346, corresponding to test acc:                         0.8948672413825989 / 0.9055687785148621
after epoch: 4,now: 2024-08-07 02:11:04.885456,epoch time: 0:23:39.240250,used: 1:38:52.892894,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_32_11_seed_2_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97651654, 'precision': 0.9767118, 'recall': 0.97651887, 'specificity': 0.97651887, 'f1': 0.9765142, 'auroc': 0.9965111, 'binary_precision': 0.9864182, 'binary_recall': 0.9663495, 'binary_specificity': 0.9866883, 'binary_f1_score': 0.97628075}
confusion matrix:
       0      1
0  25498    344
1    870  24984
---- Validation: 
scalar performance:
{'acc': 0.9230904, 'precision': 0.5850457, 'recall': 0.7693192, 'specificity': 0.7693192, 'f1': 0.6188684, 'auroc': 0.8683911, 'binary_precision': 0.18052594, 'binary_recall': 0.6076555, 'binary_specificity': 0.9309829, 'binary_f1_score': 0.27835616}
confusion matrix:
       0     1
0  15553  1153
1    164   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.903587, 'precision': 0.6945237, 'recall': 0.77042997, 'specificity': 0.77042997, 'f1': 0.7237053, 'auroc': 0.8857517, 'binary_precision': 0.4236111, 'binary_recall': 0.6122961, 'binary_specificity': 0.9285638, 'binary_f1_score': 0.50076956}
confusion matrix:
      0    1
0  8631  664
1   309  488
early stop counter: 4
val acc:0.923090398311615, best validation acc: 0.9329596161842346, corresponding to test acc:                         0.8948672413825989 / 0.9055687785148621
after epoch: 5,now: 2024-08-07 02:34:30.646940,epoch time: 0:23:25.761484,used: 2:02:18.654378,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_32_11_seed_2_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97823817, 'precision': 0.9785758, 'recall': 0.9782407, 'specificity': 0.9782407, 'f1': 0.9782344, 'auroc': 0.99686575, 'binary_precision': 0.9913368, 'binary_recall': 0.964917, 'binary_specificity': 0.99156445, 'binary_f1_score': 0.97794855}
confusion matrix:
       0      1
0  25625    218
1    907  24946
---- Validation: 
scalar performance:
{'acc': 0.9307405, 'precision': 0.59082484, 'recall': 0.7580788, 'specificity': 0.7580788, 'f1': 0.6262831, 'auroc': 0.86616755, 'binary_precision': 0.1928, 'binary_recall': 0.576555, 'binary_specificity': 0.93960255, 'binary_f1_score': 0.28896883}
confusion matrix:
       0     1
0  15697  1009
1    177   241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9049742, 'precision': 0.69153404, 'recall': 0.74422574, 'specificity': 0.74422574, 'f1': 0.713403, 'auroc': 0.87914395, 'binary_precision': 0.4224138, 'binary_recall': 0.553325, 'binary_specificity': 0.9351264, 'binary_f1_score': 0.4790875}
confusion matrix:
      0    1
0  8692  603
1   356  441
early stop counter: 5
val acc:0.930740475654602, best validation acc: 0.9329596161842346, corresponding to test acc:                         0.8948672413825989 / 0.9055687785148621
after epoch: 6,now: 2024-08-07 02:58:48.211970,epoch time: 0:24:17.565030,used: 2:26:36.219408,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_32_11_seed_2_24076676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 2:26:36.219408 at 2024-08-07 02:58:48.211970
persisted model performance metric: 

scalar performance:
{'acc': 0.89486724, 'precision': 0.66648227, 'recall': 0.7169436, 'specificity': 0.7169436, 'f1': 0.68689215, 'auroc': 0.8593558, 'binary_precision': 0.37663552, 'binary_recall': 0.50564617, 'binary_specificity': 0.928241, 'binary_f1_score': 0.43170863}
confusion matrix:
      0    1
0  8628  667
1   394  403
oracle model performance metric: 

scalar performance:
{'acc': 0.9055688, 'precision': 0.6917734, 'recall': 0.73995996, 'specificity': 0.73995996, 'f1': 0.71209675, 'auroc': 0.88249755, 'binary_precision': 0.42367905, 'binary_recall': 0.54328734, 'binary_specificity': 0.9366326, 'binary_f1_score': 0.47608575}
confusion matrix:
      0    1
0  8706  589
1   364  433
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   1195 MiB |   1004 TiB |   1004 TiB |
|       from large pool | 179211 KiB |   1178 MiB |    990 TiB |    990 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   1195 MiB |   1004 TiB |   1004 TiB |
|       from large pool | 179211 KiB |   1178 MiB |    990 TiB |    990 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   1193 MiB |   1004 TiB |   1004 TiB |
|       from large pool | 178979 KiB |   1176 MiB |    990 TiB |    990 TiB |
|       from small pool |  16662 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1336 MiB |   1346 MiB |   3528 MiB |   2192 MiB |
|       from large pool |   1298 MiB |   1304 MiB |   3468 MiB |   2170 MiB |
|       from small pool |     38 MiB |     42 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42197 KiB | 161596 KiB | 539920 GiB | 539920 GiB |
|       from large pool |  31733 KiB | 160090 KiB | 525107 GiB | 525107 GiB |
|       from small pool |  10464 KiB |  25471 KiB |  14812 GiB |  14812 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6937    |  176474 K  |  176469 K  |
|       from large pool |      79    |     167    |   95145 K  |   95145 K  |
|       from small pool |    4333    |    6857    |   81328 K  |   81324 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6937    |  176474 K  |  176469 K  |
|       from large pool |      79    |     167    |   95145 K  |   95145 K  |
|       from small pool |    4333    |    6857    |   81328 K  |   81324 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |     174    |     100    |
|       from large pool |      55    |      55    |     144    |      89    |
|       from small pool |      19    |      21    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3250    |  106449 K  |  106449 K  |
|       from large pool |      10    |      59    |   68008 K  |   68008 K  |
|       from small pool |      21    |    3240    |   38440 K  |   38440 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |   1004 TiB |   1004 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    990 TiB |    990 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |   1004 TiB |   1004 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    990 TiB |    990 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |   1004 TiB |   1004 TiB |
|       from large pool |  16640 KiB |   1176 MiB |    990 TiB |    990 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB |   1346 MiB |   3528 MiB |   3294 MiB |
|       from large pool | 210944 KiB |   1304 MiB |   3468 MiB |   3262 MiB |
|       from small pool |  28672 KiB |     42 MiB |     60 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 161596 KiB | 539920 GiB | 539920 GiB |
|       from large pool |  30464 KiB | 160090 KiB | 525107 GiB | 525107 GiB |
|       from small pool |      0 KiB |  25471 KiB |  14812 GiB |  14812 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6937    |  176474 K  |  176474 K  |
|       from large pool |       2    |     167    |   95145 K  |   95145 K  |
|       from small pool |       0    |    6857    |   81328 K  |   81328 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6937    |  176474 K  |  176474 K  |
|       from large pool |       2    |     167    |   95145 K  |   95145 K  |
|       from small pool |       0    |    6857    |   81328 K  |   81328 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      76    |     174    |     150    |
|       from large pool |      10    |      55    |     144    |     134    |
|       from small pool |      14    |      21    |      30    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3250    |  106451 K  |  106451 K  |
|       from large pool |       3    |      59    |   68008 K  |   68008 K  |
|       from small pool |       0    |    3240    |   38442 K  |   38442 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 03:16:24 2024]
Finished job 0.
1 of 1 steps (100%) done
