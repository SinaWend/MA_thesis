Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:57 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668

 Experiment start at: 2024-08-06 02:34:45.390471
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98600364, 'precision': 0.98603755, 'recall': 0.98600614, 'specificity': 0.98600614, 'f1': 0.9860034, 'auroc': 0.99887, 'binary_precision': 0.9902484, 'binary_recall': 0.9816912, 'binary_specificity': 0.99032116, 'binary_f1_score': 0.9859512}
confusion matrix:
       0      1
0  25068    245
1    464  24879
---- Validation: 
scalar performance:
{'acc': 0.9389945, 'precision': 0.62837124, 'recall': 0.88649523, 'specificity': 0.88649523, 'f1': 0.6826681, 'auroc': 0.9375379, 'binary_precision': 0.2611658, 'binary_recall': 0.8313253, 'binary_specificity': 0.9416652, 'binary_f1_score': 0.39746544}
confusion matrix:
       0    1
0  15755  976
1     70  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9063674, 'precision': 0.7134707, 'recall': 0.8780173, 'specificity': 0.8780173, 'f1': 0.76330984, 'auroc': 0.92076343, 'binary_precision': 0.4408384, 'binary_recall': 0.8445596, 'binary_specificity': 0.91147506, 'binary_f1_score': 0.5792981}
confusion matrix:
      0    1
0  8515  827
1   120  652
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 02:56:07.523760,epoch time: 0:21:22.133289,used: 0:21:22.133289,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98918194, 'precision': 0.9891819, 'recall': 0.98918205, 'specificity': 0.98918205, 'f1': 0.9891819, 'auroc': 0.9993918, 'binary_precision': 0.9894192, 'binary_recall': 0.9889507, 'binary_specificity': 0.9894134, 'binary_f1_score': 0.9891849}
confusion matrix:
       0      1
0  25047    268
1    280  25061
---- Validation: 
scalar performance:
{'acc': 0.97567946, 'precision': 0.74147105, 'recall': 0.7067287, 'specificity': 0.7067287, 'f1': 0.72264904, 'auroc': 0.9465361, 'binary_precision': 0.49717513, 'binary_recall': 0.42409638, 'binary_specificity': 0.98936105, 'binary_f1_score': 0.4577373}
confusion matrix:
       0    1
0  16553  178
1    239  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91793555, 'precision': 0.73099834, 'recall': 0.87180233, 'specificity': 0.87180233, 'f1': 0.77874255, 'auroc': 0.9188718, 'binary_precision': 0.4780303, 'binary_recall': 0.81735754, 'binary_specificity': 0.92624706, 'binary_f1_score': 0.6032505}
confusion matrix:
      0    1
0  8653  689
1   141  631
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 03:14:58.799276,epoch time: 0:18:51.275516,used: 0:40:13.408805,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99386054, 'precision': 0.9938655, 'recall': 0.9938617, 'specificity': 0.9938617, 'f1': 0.99386054, 'auroc': 0.9996741, 'binary_precision': 0.995605, 'binary_recall': 0.9921089, 'binary_specificity': 0.9956145, 'binary_f1_score': 0.9938539}
confusion matrix:
       0      1
0  25200    111
1    200  25145
---- Validation: 
scalar performance:
{'acc': 0.9179984, 'precision': 0.6030164, 'recall': 0.8910109, 'specificity': 0.8910109, 'f1': 0.6468561, 'auroc': 0.9423276, 'binary_precision': 0.20972466, 'binary_recall': 0.8626506, 'binary_specificity': 0.91937125, 'binary_f1_score': 0.3374175}
confusion matrix:
       0     1
0  15382  1349
1     57   358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83527786, 'precision': 0.6476727, 'recall': 0.86686593, 'specificity': 0.86686593, 'f1': 0.6794294, 'auroc': 0.92907274, 'binary_precision': 0.3048035, 'binary_recall': 0.90414506, 'binary_specificity': 0.8295868, 'binary_f1_score': 0.45591116}
confusion matrix:
      0     1
0  7750  1592
1    74   698
early stop counter: 1
val acc:0.9179983735084534, best validation acc: 0.9756794571876526, corresponding to test acc:                         0.9179355502128601 / 0.9179355502128601
after epoch: 3,now: 2024-08-06 03:32:55.883202,epoch time: 0:17:57.083926,used: 0:58:10.492731,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9921628, 'precision': 0.99225056, 'recall': 0.9921666, 'specificity': 0.9921666, 'f1': 0.9921625, 'auroc': 0.9996356, 'binary_precision': 0.9989599, 'binary_recall': 0.98536026, 'binary_specificity': 0.9989729, 'binary_f1_score': 0.9921135}
confusion matrix:
       0      1
0  25288     26
1    371  24971
---- Validation: 
scalar performance:
{'acc': 0.97766244, 'precision': 0.7631587, 'recall': 0.77119124, 'specificity': 0.77119124, 'f1': 0.76711, 'auroc': 0.9504832, 'binary_precision': 0.5373832, 'binary_recall': 0.55421686, 'binary_specificity': 0.9881657, 'binary_f1_score': 0.5456702}
confusion matrix:
       0    1
0  16533  198
1    185  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8747281, 'precision': 0.6753376, 'recall': 0.86683184, 'specificity': 0.86683184, 'f1': 0.719581, 'auroc': 0.92363876, 'binary_precision': 0.36393622, 'binary_recall': 0.85751295, 'binary_specificity': 0.8761507, 'binary_f1_score': 0.5109996}
confusion matrix:
      0     1
0  8185  1157
1   110   662
better model found
persisted
after epoch: 4,now: 2024-08-06 03:51:00.413890,epoch time: 0:18:04.530688,used: 1:16:15.023419,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99228126, 'precision': 0.9923579, 'recall': 0.9922848, 'specificity': 0.9922848, 'f1': 0.99228096, 'auroc': 0.99972403, 'binary_precision': 0.998641, 'binary_recall': 0.98591274, 'binary_specificity': 0.99865687, 'binary_f1_score': 0.992236}
confusion matrix:
       0      1
0  25280     34
1    357  24985
---- Validation: 
scalar performance:
{'acc': 0.9780707, 'precision': 0.77758104, 'recall': 0.6868051, 'specificity': 0.6868051, 'f1': 0.7227285, 'auroc': 0.95013756, 'binary_precision': 0.57039714, 'binary_recall': 0.38072288, 'binary_specificity': 0.99288744, 'binary_f1_score': 0.4566474}
confusion matrix:
       0    1
0  16612  119
1    257  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9260431, 'precision': 0.7416173, 'recall': 0.8037052, 'specificity': 0.8037052, 'f1': 0.7679641, 'auroc': 0.9301305, 'binary_precision': 0.51207244, 'binary_recall': 0.65932643, 'binary_specificity': 0.94808394, 'binary_f1_score': 0.576444}
confusion matrix:
      0    1
0  8857  485
1   263  509
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 04:08:55.729444,epoch time: 0:17:55.315554,used: 1:34:10.338973,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9898136, 'precision': 0.9899843, 'recall': 0.9898193, 'specificity': 0.9898193, 'f1': 0.9898128, 'auroc': 0.99951816, 'binary_precision': 0.99927604, 'binary_recall': 0.9803496, 'binary_specificity': 0.9992889, 'binary_f1_score': 0.9897223}
confusion matrix:
       0      1
0  25295     18
1    498  24845
---- Validation: 
scalar performance:
{'acc': 0.97585446, 'precision': 0.7466028, 'recall': 0.8384111, 'specificity': 0.8384111, 'f1': 0.78469324, 'auroc': 0.9597601, 'binary_precision': 0.5008696, 'binary_recall': 0.6939759, 'binary_specificity': 0.9828462, 'binary_f1_score': 0.5818182}
confusion matrix:
       0    1
0  16444  287
1    127  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91931975, 'precision': 0.7265361, 'recall': 0.81194866, 'specificity': 0.81194866, 'f1': 0.76005435, 'auroc': 0.9249627, 'binary_precision': 0.4800363, 'binary_recall': 0.6852332, 'binary_specificity': 0.9386641, 'binary_f1_score': 0.56456774}
confusion matrix:
      0    1
0  8769  573
1   243  529
early stop counter: 1
val acc:0.9758544564247131, best validation acc: 0.9780706763267517, corresponding to test acc:                         0.9260430932044983 / 0.9260430932044983
after epoch: 6,now: 2024-08-06 04:26:51.874645,epoch time: 0:17:56.145201,used: 1:52:06.484174,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9960715, 'precision': 0.99607253, 'recall': 0.9960722, 'specificity': 0.9960722, 'f1': 0.9960716, 'auroc': 0.99987614, 'binary_precision': 0.99695665, 'binary_recall': 0.9951866, 'binary_specificity': 0.9969577, 'binary_f1_score': 0.99607086}
confusion matrix:
       0      1
0  25233     77
1    122  25224
---- Validation: 
scalar performance:
{'acc': 0.9459349, 'precision': 0.6455654, 'recall': 0.9147252, 'specificity': 0.9147252, 'f1': 0.7064114, 'auroc': 0.9595078, 'binary_precision': 0.29421222, 'binary_recall': 0.8819277, 'binary_specificity': 0.9475226, 'binary_f1_score': 0.44122967}
confusion matrix:
       0    1
0  15853  878
1     49  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7918727, 'precision': 0.62689614, 'recall': 0.8588177, 'specificity': 0.8588177, 'f1': 0.6406531, 'auroc': 0.93329686, 'binary_precision': 0.260338, 'binary_recall': 0.93782383, 'binary_specificity': 0.7798116, 'binary_f1_score': 0.4075429}
confusion matrix:
      0     1
0  7285  2057
1    48   724
early stop counter: 2
val acc:0.9459348917007446, best validation acc: 0.9780706763267517, corresponding to test acc:                         0.9260430932044983 / 0.9260430932044983
after epoch: 7,now: 2024-08-06 04:44:49.634264,epoch time: 0:17:57.759619,used: 2:10:04.243793,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99180746, 'precision': 0.9918692, 'recall': 0.9918045, 'specificity': 0.9918045, 'f1': 0.99180716, 'auroc': 0.9997747, 'binary_precision': 0.9864944, 'binary_recall': 0.99727726, 'binary_specificity': 0.9863317, 'binary_f1_score': 0.9918565}
confusion matrix:
       0      1
0  24968    346
1     69  25273
---- Validation: 
scalar performance:
{'acc': 0.9474513, 'precision': 0.6475285, 'recall': 0.9084525, 'specificity': 0.9084525, 'f1': 0.7082961, 'auroc': 0.9552169, 'binary_precision': 0.29850745, 'binary_recall': 0.8674699, 'binary_specificity': 0.9494352, 'binary_f1_score': 0.44417027}
confusion matrix:
       0    1
0  15885  846
1     55  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7862369, 'precision': 0.62487185, 'recall': 0.85814357, 'specificity': 0.85814357, 'f1': 0.63613486, 'auroc': 0.92183775, 'binary_precision': 0.25579762, 'binary_recall': 0.9430052, 'binary_specificity': 0.77328193, 'binary_f1_score': 0.4024323}
confusion matrix:
      0     1
0  7224  2118
1    44   728
early stop counter: 3
val acc:0.9474512934684753, best validation acc: 0.9780706763267517, corresponding to test acc:                         0.9260430932044983 / 0.9260430932044983
after epoch: 8,now: 2024-08-06 05:02:46.804406,epoch time: 0:17:57.170142,used: 2:28:01.413935,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9928143, 'precision': 0.9929092, 'recall': 0.9928179, 'specificity': 0.9928179, 'f1': 0.99281394, 'auroc': 0.9998262, 'binary_precision': 0.9998799, 'binary_recall': 0.9857543, 'binary_specificity': 0.9998815, 'binary_f1_score': 0.99276686}
confusion matrix:
       0      1
0  25312      3
1    361  24980
---- Validation: 
scalar performance:
{'acc': 0.9811618, 'precision': 0.8095948, 'recall': 0.76358485, 'specificity': 0.76358485, 'f1': 0.7846221, 'auroc': 0.95699966, 'binary_precision': 0.6306818, 'binary_recall': 0.53493977, 'binary_specificity': 0.99223, 'binary_f1_score': 0.57887876}
confusion matrix:
       0    1
0  16601  130
1    193  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9067629, 'precision': 0.71175385, 'recall': 0.8639719, 'specificity': 0.8639719, 'f1': 0.7594321, 'auroc': 0.9250387, 'binary_precision': 0.4400841, 'binary_recall': 0.8134715, 'binary_specificity': 0.9144723, 'binary_f1_score': 0.5711687}
confusion matrix:
      0    1
0  8543  799
1   144  628
better model found
persisted
after epoch: 9,now: 2024-08-06 05:20:40.952827,epoch time: 0:17:54.148421,used: 2:45:55.562356,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99619, 'precision': 0.9961909, 'recall': 0.99619037, 'specificity': 0.99619037, 'f1': 0.99618995, 'auroc': 0.999845, 'binary_precision': 0.9969959, 'binary_recall': 0.9953828, 'binary_specificity': 0.99699795, 'binary_f1_score': 0.9961887}
confusion matrix:
       0      1
0  25240     76
1    117  25223
---- Validation: 
scalar performance:
{'acc': 0.96564794, 'precision': 0.69646096, 'recall': 0.89192796, 'specificity': 0.89192796, 'f1': 0.7582767, 'auroc': 0.95449686, 'binary_precision': 0.39764705, 'binary_recall': 0.81445783, 'binary_specificity': 0.96939814, 'binary_f1_score': 0.53438735}
confusion matrix:
       0    1
0  16219  512
1     77  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8197548, 'precision': 0.6399112, 'recall': 0.8667811, 'specificity': 0.8667811, 'f1': 0.66560173, 'auroc': 0.92589176, 'binary_precision': 0.28767678, 'binary_recall': 0.9222798, 'binary_specificity': 0.8112824, 'binary_f1_score': 0.4385587}
confusion matrix:
      0     1
0  7579  1763
1    60   712
early stop counter: 1
val acc:0.9656479358673096, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 10,now: 2024-08-06 05:38:34.814620,epoch time: 0:17:53.861793,used: 3:03:49.424149,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9954398, 'precision': 0.9954732, 'recall': 0.99544215, 'specificity': 0.99544215, 'f1': 0.99543977, 'auroc': 0.99979603, 'binary_precision': 0.9996816, 'binary_recall': 0.9912004, 'binary_specificity': 0.999684, 'binary_f1_score': 0.99542296}
confusion matrix:
       0      1
0  25306      8
1    223  25119
---- Validation: 
scalar performance:
{'acc': 0.9736965, 'precision': 0.7169536, 'recall': 0.68573874, 'specificity': 0.68573874, 'f1': 0.7000353, 'auroc': 0.93387485, 'binary_precision': 0.44915253, 'binary_recall': 0.38313252, 'binary_specificity': 0.98834497, 'binary_f1_score': 0.41352406}
confusion matrix:
       0    1
0  16536  195
1    256  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9119043, 'precision': 0.7187271, 'recall': 0.85724866, 'specificity': 0.85724866, 'f1': 0.7647661, 'auroc': 0.9269587, 'binary_precision': 0.4556962, 'binary_recall': 0.7927461, 'binary_specificity': 0.92175126, 'binary_f1_score': 0.5787234}
confusion matrix:
      0    1
0  8611  731
1   160  612
early stop counter: 2
val acc:0.9736964702606201, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 11,now: 2024-08-06 05:56:27.026897,epoch time: 0:17:52.212277,used: 3:21:41.636426,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9947686, 'precision': 0.99477684, 'recall': 0.99476767, 'specificity': 0.99476767, 'f1': 0.9947686, 'auroc': 0.99986434, 'binary_precision': 0.99288464, 'binary_recall': 0.9966852, 'binary_specificity': 0.99285007, 'binary_f1_score': 0.99478126}
confusion matrix:
       0      1
0  25134    181
1     84  25257
---- Validation: 
scalar performance:
{'acc': 0.9541584, 'precision': 0.6609906, 'recall': 0.8977901, 'specificity': 0.8977901, 'f1': 0.7228398, 'auroc': 0.95112014, 'binary_precision': 0.3261481, 'binary_recall': 0.8385542, 'binary_specificity': 0.9570259, 'binary_f1_score': 0.4696356}
confusion matrix:
       0    1
0  16012  719
1     67  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7739767, 'precision': 0.6177703, 'recall': 0.8449713, 'specificity': 0.8449713, 'f1': 0.62350273, 'auroc': 0.9190761, 'binary_precision': 0.24321574, 'binary_recall': 0.9287565, 'binary_specificity': 0.76118606, 'binary_f1_score': 0.38548386}
confusion matrix:
      0     1
0  7111  2231
1    55   717
early stop counter: 3
val acc:0.9541584253311157, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 12,now: 2024-08-06 06:14:29.242976,epoch time: 0:18:02.216079,used: 3:39:43.852505,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9940777, 'precision': 0.99408317, 'recall': 0.9940769, 'specificity': 0.9940769, 'f1': 0.9940776, 'auroc': 0.9997326, 'binary_precision': 0.9925646, 'binary_recall': 0.9956198, 'binary_specificity': 0.99253404, 'binary_f1_score': 0.9940898}
confusion matrix:
       0      1
0  25126    189
1    111  25230
---- Validation: 
scalar performance:
{'acc': 0.95614135, 'precision': 0.6676685, 'recall': 0.90703064, 'specificity': 0.90703064, 'f1': 0.73136514, 'auroc': 0.95341325, 'binary_precision': 0.339064, 'binary_recall': 0.85542166, 'binary_specificity': 0.9586396, 'binary_f1_score': 0.48563614}
confusion matrix:
       0    1
0  16039  692
1     60  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8416057, 'precision': 0.65092134, 'recall': 0.8655381, 'specificity': 0.8655381, 'f1': 0.6849428, 'auroc': 0.9204883, 'binary_precision': 0.3122172, 'binary_recall': 0.8937824, 'binary_specificity': 0.8372939, 'binary_f1_score': 0.46277663}
confusion matrix:
      0     1
0  7822  1520
1    82   690
early stop counter: 4
val acc:0.9561413526535034, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 13,now: 2024-08-06 06:32:21.759437,epoch time: 0:17:52.516461,used: 3:57:36.368966,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9888661, 'precision': 0.98909557, 'recall': 0.9888726, 'specificity': 0.9888726, 'f1': 0.9888649, 'auroc': 0.9995991, 'binary_precision': 0.99983865, 'binary_recall': 0.9779032, 'binary_specificity': 0.999842, 'binary_f1_score': 0.98874927}
confusion matrix:
       0      1
0  25309      4
1    560  24783
---- Validation: 
scalar performance:
{'acc': 0.9795287, 'precision': 0.7939484, 'recall': 0.7251502, 'specificity': 0.7251502, 'f1': 0.7546886, 'auroc': 0.9383917, 'binary_precision': 0.60126585, 'binary_recall': 0.45783132, 'binary_specificity': 0.9924691, 'binary_f1_score': 0.5198358}
confusion matrix:
       0    1
0  16605  126
1    225  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9220882, 'precision': 0.72890896, 'recall': 0.7742336, 'specificity': 0.7742336, 'f1': 0.7488471, 'auroc': 0.91701984, 'binary_precision': 0.49150744, 'binary_recall': 0.5997409, 'binary_specificity': 0.9487262, 'binary_f1_score': 0.5402567}
confusion matrix:
      0    1
0  8863  479
1   309  463
early stop counter: 5
val acc:0.9795287251472473, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 14,now: 2024-08-06 06:50:18.444045,epoch time: 0:17:56.684608,used: 4:15:33.053574,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99723625, 'precision': 0.9972363, 'recall': 0.9972365, 'specificity': 0.9972365, 'f1': 0.99723625, 'auroc': 0.9999052, 'binary_precision': 0.99759144, 'binary_recall': 0.9968829, 'binary_specificity': 0.99759007, 'binary_f1_score': 0.997237}
confusion matrix:
       0      1
0  25251     61
1     79  25265
---- Validation: 
scalar performance:
{'acc': 0.9718302, 'precision': 0.7247115, 'recall': 0.8939208, 'specificity': 0.8939208, 'f1': 0.78398216, 'auroc': 0.9528599, 'binary_precision': 0.4541779, 'binary_recall': 0.8120482, 'binary_specificity': 0.9757934, 'binary_f1_score': 0.58254105}
confusion matrix:
       0    1
0  16326  405
1     78  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.752719, 'precision': 0.6096997, 'recall': 0.83465236, 'specificity': 0.83465236, 'f1': 0.60576403, 'auroc': 0.9230057, 'binary_precision': 0.22702873, 'binary_recall': 0.93134713, 'binary_specificity': 0.7379576, 'binary_f1_score': 0.36506727}
confusion matrix:
      0     1
0  6894  2448
1    53   719
early stop counter: 6
val acc:0.9718301892280579, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 15,now: 2024-08-06 07:08:13.701998,epoch time: 0:17:55.257953,used: 4:33:28.311527,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9959926, 'precision': 0.99601597, 'recall': 0.99599457, 'specificity': 0.99599457, 'f1': 0.99599254, 'auroc': 0.99985564, 'binary_precision': 0.9995628, 'binary_recall': 0.99242365, 'binary_specificity': 0.9995655, 'binary_f1_score': 0.99598044}
confusion matrix:
       0      1
0  25303     11
1    192  25150
---- Validation: 
scalar performance:
{'acc': 0.9791205, 'precision': 0.77912503, 'recall': 0.7778131, 'specificity': 0.7778131, 'f1': 0.7784674, 'auroc': 0.94700724, 'binary_precision': 0.5690073, 'binary_recall': 0.56626505, 'binary_specificity': 0.98936105, 'binary_f1_score': 0.5676329}
confusion matrix:
       0    1
0  16553  178
1    180  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9186276, 'precision': 0.7285463, 'recall': 0.84068716, 'specificity': 0.84068716, 'f1': 0.76951754, 'auroc': 0.91324335, 'binary_precision': 0.47887325, 'binary_recall': 0.7487047, 'binary_specificity': 0.93266964, 'binary_f1_score': 0.5841334}
confusion matrix:
      0    1
0  8713  629
1   194  578
early stop counter: 7
val acc:0.9791204929351807, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 16,now: 2024-08-06 07:26:13.012303,epoch time: 0:17:59.310305,used: 4:51:27.621832,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9971968, 'precision': 0.99719745, 'recall': 0.9971971, 'specificity': 0.9971971, 'f1': 0.99719673, 'auroc': 0.9999065, 'binary_precision': 0.9979055, 'binary_recall': 0.99648774, 'binary_specificity': 0.99790645, 'binary_f1_score': 0.9971961}
confusion matrix:
       0      1
0  25263     53
1     89  25251
---- Validation: 
scalar performance:
{'acc': 0.96862245, 'precision': 0.70915926, 'recall': 0.8934521, 'specificity': 0.8934521, 'f1': 0.7702862, 'auroc': 0.9608402, 'binary_precision': 0.4230288, 'binary_recall': 0.81445783, 'binary_specificity': 0.9724464, 'binary_f1_score': 0.5568369}
confusion matrix:
       0    1
0  16270  461
1     77  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.859996, 'precision': 0.66732264, 'recall': 0.88381124, 'specificity': 0.88381124, 'f1': 0.7086115, 'auroc': 0.9241955, 'binary_precision': 0.34307992, 'binary_recall': 0.9119171, 'binary_specificity': 0.85570544, 'binary_f1_score': 0.49858359}
confusion matrix:
      0     1
0  7994  1348
1    68   704
early stop counter: 8
val acc:0.9686224460601807, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 17,now: 2024-08-06 07:44:11.760780,epoch time: 0:17:58.748477,used: 5:09:26.370309,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9957557, 'precision': 0.9957743, 'recall': 0.9957576, 'specificity': 0.9957576, 'f1': 0.9957557, 'auroc': 0.9999032, 'binary_precision': 0.9989674, 'binary_recall': 0.9925423, 'binary_specificity': 0.99897283, 'binary_f1_score': 0.9957445}
confusion matrix:
       0      1
0  25287     26
1    189  25154
---- Validation: 
scalar performance:
{'acc': 0.9753879, 'precision': 0.7452118, 'recall': 0.90044355, 'specificity': 0.90044355, 'f1': 0.8025191, 'auroc': 0.96383286, 'binary_precision': 0.49492016, 'binary_recall': 0.82168674, 'binary_specificity': 0.9792003, 'binary_f1_score': 0.6177536}
confusion matrix:
       0    1
0  16383  348
1     74  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9045877, 'precision': 0.71277815, 'recall': 0.8889369, 'specificity': 0.8889369, 'f1': 0.7641083, 'auroc': 0.9237249, 'binary_precision': 0.43721536, 'binary_recall': 0.8704663, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.5820701}
confusion matrix:
      0    1
0  8477  865
1   100  672
early stop counter: 9
val acc:0.9753878712654114, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 18,now: 2024-08-06 08:02:09.466686,epoch time: 0:17:57.705906,used: 5:27:24.076215,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9965256, 'precision': 0.9965424, 'recall': 0.99652714, 'specificity': 0.99652714, 'f1': 0.9965255, 'auroc': 0.99987817, 'binary_precision': 0.9995633, 'binary_recall': 0.9934888, 'binary_specificity': 0.9995655, 'binary_f1_score': 0.9965168}
confusion matrix:
       0      1
0  25304     11
1    165  25176
---- Validation: 
scalar performance:
{'acc': 0.9773125, 'precision': 0.7578743, 'recall': 0.85090756, 'specificity': 0.85090756, 'f1': 0.79669845, 'auroc': 0.96257865, 'binary_precision': 0.522807, 'binary_recall': 0.7180723, 'binary_specificity': 0.9837428, 'binary_f1_score': 0.60507613}
confusion matrix:
       0    1
0  16459  272
1    117  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9125964, 'precision': 0.7178371, 'recall': 0.84336376, 'specificity': 0.84336376, 'f1': 0.7611084, 'auroc': 0.92538667, 'binary_precision': 0.45652175, 'binary_recall': 0.761658, 'binary_specificity': 0.9250696, 'binary_f1_score': 0.5708738}
confusion matrix:
      0    1
0  8642  700
1   184  588
early stop counter: 10
val acc:0.9773125052452087, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 19,now: 2024-08-06 08:20:05.052316,epoch time: 0:17:55.585630,used: 5:45:19.661845,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9959136, 'precision': 0.99591863, 'recall': 0.9959147, 'specificity': 0.9959147, 'f1': 0.9959136, 'auroc': 0.99987346, 'binary_precision': 0.99766386, 'binary_recall': 0.99416035, 'binary_specificity': 0.9976691, 'binary_f1_score': 0.99590904}
confusion matrix:
       0      1
0  25253     59
1    148  25196
---- Validation: 
scalar performance:
{'acc': 0.9654147, 'precision': 0.69051117, 'recall': 0.8553854, 'specificity': 0.8553854, 'f1': 0.7453879, 'auroc': 0.94904685, 'binary_precision': 0.38762626, 'binary_recall': 0.739759, 'binary_specificity': 0.9710119, 'binary_f1_score': 0.50869924}
confusion matrix:
       0    1
0  16246  485
1    108  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87640893, 'precision': 0.6782519, 'recall': 0.873089, 'specificity': 0.873089, 'f1': 0.72343457, 'auroc': 0.91736066, 'binary_precision': 0.3686813, 'binary_recall': 0.86917096, 'binary_specificity': 0.87700707, 'binary_f1_score': 0.51774687}
confusion matrix:
      0     1
0  8193  1149
1   101   671
early stop counter: 11
val acc:0.9654147028923035, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9067628979682922 / 0.9260430932044983
after epoch: 20,now: 2024-08-06 08:38:00.893892,epoch time: 0:17:55.841576,used: 6:03:15.503421,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:03:15.503421 at 2024-08-06 08:38:00.893892
persisted model performance metric: 

scalar performance:
{'acc': 0.9067629, 'precision': 0.71175385, 'recall': 0.8639719, 'specificity': 0.8639719, 'f1': 0.7594321, 'auroc': 0.9250387, 'binary_precision': 0.4400841, 'binary_recall': 0.8134715, 'binary_specificity': 0.9144723, 'binary_f1_score': 0.5711687}
confusion matrix:
      0    1
0  8543  799
1   144  628
oracle model performance metric: 

scalar performance:
{'acc': 0.9260431, 'precision': 0.7416173, 'recall': 0.8037052, 'specificity': 0.8037052, 'f1': 0.7679641, 'auroc': 0.9301305, 'binary_precision': 0.51207244, 'binary_recall': 0.65932643, 'binary_specificity': 0.94808394, 'binary_f1_score': 0.576444}
confusion matrix:
      0    1
0  8857  485
1   263  509
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459204 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555060 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 459204 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555060 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447934 KiB |  13213 MiB | 562427 GiB | 562426 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |  40859 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  14482 MiB |      0 B   |
|       from large pool |  14412 MiB |  14412 MiB |  14412 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 417339 KiB |   1235 MiB | 450794 GiB | 450793 GiB |
|       from large pool | 406502 KiB |   1232 MiB | 442915 GiB | 442915 GiB |
|       from small pool |  10837 KiB |     17 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4934    |    7337    |  107646 K  |  107641 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56146 K  |   56141 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4934    |    7337    |  107646 K  |  107641 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56146 K  |   56141 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3222    |   64453 K  |   64453 K  |
|       from large pool |      30    |     604    |   37573 K  |   37573 K  |
|       from small pool |      40    |    3191    |   26879 K  |   26879 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562427 GiB | 562427 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14482 MiB |  14482 MiB |  13626 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450794 GiB | 450794 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     42 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |     637    |     575    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64455 K  |   64455 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   26881 K  |   26881 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562427 GiB | 562427 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14482 MiB |  14482 MiB |  13626 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450794 GiB | 450794 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     42 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |     637    |     575    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64455 K  |   64455 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   26881 K  |   26881 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668

 Experiment start at: 2024-08-06 09:00:29.151062
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9829045, 'precision': 0.98292506, 'recall': 0.9829075, 'specificity': 0.9829075, 'f1': 0.9829043, 'auroc': 0.997957, 'binary_precision': 0.986303, 'binary_recall': 0.9794402, 'binary_specificity': 0.98637474, 'binary_f1_score': 0.9828596}
confusion matrix:
       0      1
0  25048    346
1    523  24915
---- Validation: 
scalar performance:
{'acc': 0.91596097, 'precision': 0.5969242, 'recall': 0.84953237, 'specificity': 0.84953237, 'f1': 0.6367763, 'auroc': 0.9201127, 'binary_precision': 0.2, 'binary_recall': 0.7795824, 'binary_specificity': 0.9194824, 'binary_f1_score': 0.31833255}
confusion matrix:
       0     1
0  15348  1344
1     95   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8978298, 'precision': 0.6926167, 'recall': 0.8403791, 'specificity': 0.8403791, 'f1': 0.73711914, 'auroc': 0.9184848, 'binary_precision': 0.40512466, 'binary_recall': 0.77278733, 'binary_specificity': 0.90797085, 'binary_f1_score': 0.5315766}
confusion matrix:
      0    1
0  8475  859
1   172  585
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 09:19:46.191933,epoch time: 0:19:17.040871,used: 0:19:17.040871,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9865439, 'precision': 0.98656666, 'recall': 0.98654675, 'specificity': 0.98654675, 'f1': 0.9865438, 'auroc': 0.99889594, 'binary_precision': 0.9900998, 'binary_recall': 0.9829376, 'binary_specificity': 0.99015594, 'binary_f1_score': 0.9865057}
confusion matrix:
       0      1
0  25146    250
1    434  25002
---- Validation: 
scalar performance:
{'acc': 0.95555687, 'precision': 0.6635364, 'recall': 0.8630607, 'specificity': 0.8630607, 'f1': 0.72063905, 'auroc': 0.9399388, 'binary_precision': 0.33333334, 'binary_recall': 0.76566124, 'binary_specificity': 0.9604601, 'binary_f1_score': 0.46446162}
confusion matrix:
       0    1
0  16032  660
1    101  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918244, 'precision': 0.7267068, 'recall': 0.8526279, 'specificity': 0.8526279, 'f1': 0.7709608, 'auroc': 0.92744076, 'binary_precision': 0.4726248, 'binary_recall': 0.7754293, 'binary_specificity': 0.92982644, 'binary_f1_score': 0.5872936}
confusion matrix:
      0    1
0  8679  655
1   170  587
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 09:38:06.800930,epoch time: 0:18:20.608997,used: 0:37:37.649868,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9894161, 'precision': 0.9895927, 'recall': 0.98942333, 'specificity': 0.98942333, 'f1': 0.9894153, 'auroc': 0.99921477, 'binary_precision': 0.9990779, 'binary_recall': 0.9797523, 'binary_specificity': 0.99909437, 'binary_f1_score': 0.98932076}
confusion matrix:
       0      1
0  25374     23
1    515  24920
---- Validation: 
scalar performance:
{'acc': 0.97296035, 'precision': 0.7298484, 'recall': 0.7860966, 'specificity': 0.7860966, 'f1': 0.7546288, 'auroc': 0.9164888, 'binary_precision': 0.47037038, 'binary_recall': 0.58932716, 'binary_specificity': 0.98286605, 'binary_f1_score': 0.523172}
confusion matrix:
       0    1
0  16406  286
1    177  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91982955, 'precision': 0.72350204, 'recall': 0.8012886, 'specificity': 0.8012886, 'f1': 0.75462437, 'auroc': 0.89989656, 'binary_precision': 0.47533208, 'binary_recall': 0.661823, 'binary_specificity': 0.94075423, 'binary_f1_score': 0.5532855}
confusion matrix:
      0    1
0  8781  553
1   256  501
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 09:56:20.283780,epoch time: 0:18:13.482850,used: 0:55:51.132718,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9857373, 'precision': 0.98573744, 'recall': 0.9857372, 'specificity': 0.9857372, 'f1': 0.9857373, 'auroc': 0.9988041, 'binary_precision': 0.9856531, 'binary_recall': 0.9858468, 'binary_specificity': 0.98562765, 'binary_f1_score': 0.98574996}
confusion matrix:
       0      1
0  25031    365
1    360  25076
---- Validation: 
scalar performance:
{'acc': 0.93114525, 'precision': 0.62396824, 'recall': 0.90478635, 'specificity': 0.90478635, 'f1': 0.67710423, 'auroc': 0.954095, 'binary_precision': 0.25132978, 'binary_recall': 0.87703013, 'binary_specificity': 0.93254256, 'binary_f1_score': 0.39069766}
confusion matrix:
       0     1
0  15566  1126
1     53   378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74432665, 'precision': 0.60587615, 'recall': 0.8326627, 'specificity': 0.8326627, 'f1': 0.5976303, 'auroc': 0.9181471, 'binary_precision': 0.21875964, 'binary_recall': 0.9365918, 'binary_specificity': 0.72873366, 'binary_f1_score': 0.35467735}
confusion matrix:
      0     1
0  6802  2532
1    48   709
early stop counter: 1
val acc:0.9311452507972717, best validation acc: 0.972960352897644, corresponding to test acc:                         0.9198295474052429 / 0.9198295474052429
after epoch: 4,now: 2024-08-06 10:14:37.285254,epoch time: 0:18:17.001474,used: 1:14:08.134192,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99006534, 'precision': 0.9900743, 'recall': 0.99006367, 'specificity': 0.99006367, 'f1': 0.9900652, 'auroc': 0.99939823, 'binary_precision': 0.98817354, 'binary_recall': 0.9920195, 'binary_specificity': 0.9881079, 'binary_f1_score': 0.99009275}
confusion matrix:
       0      1
0  25093    302
1    203  25234
---- Validation: 
scalar performance:
{'acc': 0.93739414, 'precision': 0.6297987, 'recall': 0.88651884, 'specificity': 0.88651884, 'f1': 0.684044, 'auroc': 0.9485957, 'binary_precision': 0.26416484, 'binary_recall': 0.83294666, 'binary_specificity': 0.9400911, 'binary_f1_score': 0.40111732}
confusion matrix:
       0     1
0  15692  1000
1     72   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8398573, 'precision': 0.6498202, 'recall': 0.87277013, 'specificity': 0.87277013, 'f1': 0.68329203, 'auroc': 0.9178444, 'binary_precision': 0.3081733, 'binary_recall': 0.9114927, 'binary_specificity': 0.83404756, 'binary_f1_score': 0.46061414}
confusion matrix:
      0     1
0  7785  1549
1    67   690
early stop counter: 2
val acc:0.9373941421508789, best validation acc: 0.972960352897644, corresponding to test acc:                         0.9198295474052429 / 0.9198295474052429
after epoch: 5,now: 2024-08-06 10:32:55.551179,epoch time: 0:18:18.265925,used: 1:32:26.400117,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9928195, 'precision': 0.99286306, 'recall': 0.99282336, 'specificity': 0.99282336, 'f1': 0.9928194, 'auroc': 0.99957716, 'binary_precision': 0.99769723, 'binary_recall': 0.9879305, 'binary_specificity': 0.9977162, 'binary_f1_score': 0.99278986}
confusion matrix:
       0      1
0  25338     58
1    307  25129
---- Validation: 
scalar performance:
{'acc': 0.9773988, 'precision': 0.7686169, 'recall': 0.7849827, 'specificity': 0.7849827, 'f1': 0.7765388, 'auroc': 0.94213116, 'binary_precision': 0.5480349, 'binary_recall': 0.5823666, 'binary_specificity': 0.98759884, 'binary_f1_score': 0.5646794}
confusion matrix:
       0    1
0  16485  207
1    180  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89366764, 'precision': 0.69034576, 'recall': 0.8551234, 'specificity': 0.8551234, 'f1': 0.7366371, 'auroc': 0.90930635, 'binary_precision': 0.39753568, 'binary_recall': 0.8097754, 'binary_specificity': 0.9004714, 'binary_f1_score': 0.5332753}
confusion matrix:
      0    1
0  8405  929
1   144  613
better model found
persisted
after epoch: 6,now: 2024-08-06 10:51:17.961159,epoch time: 0:18:22.409980,used: 1:50:48.810097,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9936457, 'precision': 0.993646, 'recall': 0.99364555, 'specificity': 0.99364555, 'f1': 0.9936457, 'auroc': 0.99971414, 'binary_precision': 0.9934376, 'binary_recall': 0.9938672, 'binary_specificity': 0.9934239, 'binary_f1_score': 0.99365234}
confusion matrix:
       0      1
0  25228    167
1    156  25281
---- Validation: 
scalar performance:
{'acc': 0.9613386, 'precision': 0.6859577, 'recall': 0.8920194, 'specificity': 0.8920194, 'f1': 0.74797344, 'auroc': 0.9410789, 'binary_precision': 0.37673426, 'binary_recall': 0.8190255, 'binary_specificity': 0.9650132, 'binary_f1_score': 0.51608187}
confusion matrix:
       0    1
0  16108  584
1     78  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9055594, 'precision': 0.70734024, 'recall': 0.8621584, 'specificity': 0.8621584, 'f1': 0.7550515, 'auroc': 0.90987355, 'binary_precision': 0.43117976, 'binary_recall': 0.81109643, 'binary_specificity': 0.91322047, 'binary_f1_score': 0.5630445}
confusion matrix:
      0    1
0  8524  810
1   143  614
early stop counter: 1
val acc:0.9613385796546936, best validation acc: 0.9773988127708435, corresponding to test acc:                         0.8936676383018494 / 0.9198295474052429
after epoch: 7,now: 2024-08-06 11:09:28.850738,epoch time: 0:18:10.889579,used: 2:08:59.699676,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99350804, 'precision': 0.9935752, 'recall': 0.9935125, 'specificity': 0.9935125, 'f1': 0.99350786, 'auroc': 0.99983346, 'binary_precision': 0.99952245, 'binary_recall': 0.98749757, 'binary_specificity': 0.9995275, 'binary_f1_score': 0.9934736}
confusion matrix:
       0      1
0  25385     12
1    318  25117
---- Validation: 
scalar performance:
{'acc': 0.97979325, 'precision': 0.8126558, 'recall': 0.7229231, 'specificity': 0.7229231, 'f1': 0.759783, 'auroc': 0.96020156, 'binary_precision': 0.6393443, 'binary_recall': 0.4524362, 'binary_specificity': 0.99341, 'binary_f1_score': 0.5298914}
confusion matrix:
       0    1
0  16582  110
1    236  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9158656, 'precision': 0.7159207, 'recall': 0.80703604, 'specificity': 0.80703604, 'f1': 0.7506509, 'auroc': 0.9119008, 'binary_precision': 0.45892859, 'binary_recall': 0.678996, 'binary_specificity': 0.93507606, 'binary_f1_score': 0.54768246}
confusion matrix:
      0    1
0  8728  606
1   243  514
better model found
persisted
after epoch: 8,now: 2024-08-06 11:27:45.203961,epoch time: 0:18:16.353223,used: 2:27:16.052899,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99181616, 'precision': 0.9918746, 'recall': 0.99182016, 'specificity': 0.99182016, 'f1': 0.991816, 'auroc': 0.9996469, 'binary_precision': 0.9974153, 'binary_recall': 0.98619956, 'binary_specificity': 0.99744076, 'binary_f1_score': 0.9917757}
confusion matrix:
       0      1
0  25333     65
1    351  25083
---- Validation: 
scalar performance:
{'acc': 0.9711499, 'precision': 0.7255843, 'recall': 0.8767092, 'specificity': 0.8767092, 'f1': 0.7803344, 'auroc': 0.9469436, 'binary_precision': 0.45702592, 'binary_recall': 0.77726215, 'binary_specificity': 0.97615623, 'binary_f1_score': 0.5756014}
confusion matrix:
       0    1
0  16294  398
1     96  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9109107, 'precision': 0.71598226, 'recall': 0.86565804, 'specificity': 0.86565804, 'f1': 0.7639691, 'auroc': 0.929001, 'binary_precision': 0.44825074, 'binary_recall': 0.81241745, 'binary_specificity': 0.91889864, 'binary_f1_score': 0.5777361}
confusion matrix:
      0    1
0  8577  757
1   142  615
early stop counter: 1
val acc:0.9711499214172363, best validation acc: 0.9797932505607605, corresponding to test acc:                         0.9158656001091003 / 0.9198295474052429
after epoch: 9,now: 2024-08-06 11:46:00.834645,epoch time: 0:18:15.630684,used: 2:45:31.683583,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9863472, 'precision': 0.98668456, 'recall': 0.98635876, 'specificity': 0.98635876, 'f1': 0.98634505, 'auroc': 0.9997027, 'binary_precision': 0.99971724, 'binary_recall': 0.97299314, 'binary_specificity': 0.9997243, 'binary_f1_score': 0.98617417}
confusion matrix:
       0      1
0  25387      7
1    687  24751
---- Validation: 
scalar performance:
{'acc': 0.9788004, 'precision': 0.8671535, 'recall': 0.6161809, 'specificity': 0.6161809, 'f1': 0.67337227, 'auroc': 0.9565053, 'binary_precision': 0.75373137, 'binary_recall': 0.23433875, 'binary_specificity': 0.99802303, 'binary_f1_score': 0.35752213}
confusion matrix:
       0    1
0  16659   33
1    330  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197304, 'precision': 0.6565335, 'recall': 0.54875034, 'specificity': 0.54875034, 'f1': 0.5656432, 'auroc': 0.9174373, 'binary_precision': 0.38116592, 'binary_recall': 0.11228534, 'binary_specificity': 0.98521537, 'binary_f1_score': 0.1734694}
confusion matrix:
      0    1
0  9196  138
1   672   85
early stop counter: 2
val acc:0.9788004159927368, best validation acc: 0.9797932505607605, corresponding to test acc:                         0.9158656001091003 / 0.9198295474052429
after epoch: 10,now: 2024-08-06 12:04:26.361988,epoch time: 0:18:25.527343,used: 3:03:57.210926,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99327195, 'precision': 0.9932725, 'recall': 0.99327254, 'specificity': 0.99327254, 'f1': 0.99327195, 'auroc': 0.9994918, 'binary_precision': 0.9940153, 'binary_recall': 0.9925303, 'binary_specificity': 0.9940148, 'binary_f1_score': 0.99327224}
confusion matrix:
       0      1
0  25244    152
1    190  25246
---- Validation: 
scalar performance:
{'acc': 0.90708405, 'precision': 0.5879797, 'recall': 0.84158885, 'specificity': 0.84158885, 'f1': 0.62267303, 'auroc': 0.9226788, 'binary_precision': 0.18236582, 'binary_recall': 0.7726218, 'binary_specificity': 0.91055596, 'binary_f1_score': 0.29508194}
confusion matrix:
       0     1
0  15199  1493
1     98   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89723516, 'precision': 0.69618917, 'recall': 0.86251426, 'specificity': 0.86251426, 'f1': 0.74372256, 'auroc': 0.9151535, 'binary_precision': 0.4081365, 'binary_recall': 0.82166445, 'binary_specificity': 0.90336406, 'binary_f1_score': 0.5453748}
confusion matrix:
      0    1
0  8432  902
1   135  622
early stop counter: 3
val acc:0.907084047794342, best validation acc: 0.9797932505607605, corresponding to test acc:                         0.9158656001091003 / 0.9198295474052429
after epoch: 11,now: 2024-08-06 12:22:41.274950,epoch time: 0:18:14.912962,used: 3:22:12.123888,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99563265, 'precision': 0.9956583, 'recall': 0.995636, 'specificity': 0.995636, 'f1': 0.99563265, 'auroc': 0.9998755, 'binary_precision': 0.99944544, 'binary_recall': 0.99182326, 'binary_specificity': 0.9994487, 'binary_f1_score': 0.9956198}
confusion matrix:
       0      1
0  25380     14
1    208  25230
---- Validation: 
scalar performance:
{'acc': 0.98096126, 'precision': 0.81718445, 'recall': 0.76533735, 'specificity': 0.76533735, 'f1': 0.7887988, 'auroc': 0.958688, 'binary_precision': 0.6462396, 'binary_recall': 0.53828305, 'binary_specificity': 0.9923916, 'binary_f1_score': 0.5873417}
confusion matrix:
       0    1
0  16565  127
1    199  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91527104, 'precision': 0.70641947, 'recall': 0.7551252, 'specificity': 0.7551252, 'f1': 0.727291, 'auroc': 0.9125432, 'binary_precision': 0.44874477, 'binary_recall': 0.5667107, 'binary_specificity': 0.94353974, 'binary_f1_score': 0.50087565}
confusion matrix:
      0    1
0  8807  527
1   328  429
better model found
persisted
after epoch: 12,now: 2024-08-06 12:41:00.752152,epoch time: 0:18:19.477202,used: 3:40:31.601090,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9947474, 'precision': 0.9947895, 'recall': 0.9947514, 'specificity': 0.9947514, 'f1': 0.9947473, 'auroc': 0.9998491, 'binary_precision': 0.99956334, 'binary_recall': 0.98993593, 'binary_specificity': 0.99956685, 'binary_f1_score': 0.9947263}
confusion matrix:
       0      1
0  25384     11
1    256  25181
---- Validation: 
scalar performance:
{'acc': 0.9810781, 'precision': 0.8590284, 'recall': 0.6930684, 'specificity': 0.6930684, 'f1': 0.749722, 'auroc': 0.96050185, 'binary_precision': 0.73362446, 'binary_recall': 0.3897912, 'binary_specificity': 0.9963456, 'binary_f1_score': 0.5090909}
confusion matrix:
       0    1
0  16631   61
1    263  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92062235, 'precision': 0.6950638, 'recall': 0.6141744, 'specificity': 0.6141744, 'f1': 0.64094305, 'auroc': 0.911888, 'binary_precision': 0.44859812, 'binary_recall': 0.25363275, 'binary_specificity': 0.97471607, 'binary_f1_score': 0.3240506}
confusion matrix:
      0    1
0  9098  236
1   565  192
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-06 12:59:11.505866,epoch time: 0:18:10.753714,used: 3:58:42.354804,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99641955, 'precision': 0.9964359, 'recall': 0.996422, 'specificity': 0.996422, 'f1': 0.99641955, 'auroc': 0.9999033, 'binary_precision': 0.99948573, 'binary_recall': 0.9933559, 'binary_specificity': 0.9994881, 'binary_f1_score': 0.9964114}
confusion matrix:
       0      1
0  25383     13
1    169  25267
---- Validation: 
scalar performance:
{'acc': 0.98014367, 'precision': 0.8656392, 'recall': 0.6575548, 'specificity': 0.6575548, 'f1': 0.7180723, 'auroc': 0.96096134, 'binary_precision': 0.74863386, 'binary_recall': 0.31786543, 'binary_specificity': 0.9972442, 'binary_f1_score': 0.4462541}
confusion matrix:
       0    1
0  16646   46
1    294  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236944, 'precision': 0.5415169, 'recall': 0.50112444, 'specificity': 0.50112444, 'f1': 0.48402676, 'auroc': 0.9060758, 'binary_precision': 0.15789473, 'binary_recall': 0.003963012, 'binary_specificity': 0.99828583, 'binary_f1_score': 0.0077319588}
confusion matrix:
      0   1
0  9318  16
1   754   3
new oracle model saved
early stop counter: 1
val acc:0.980143666267395, best validation acc: 0.9810780882835388, corresponding to test acc:                         0.9206223487854004 / 0.923694372177124
after epoch: 14,now: 2024-08-06 13:17:20.877277,epoch time: 0:18:09.371411,used: 4:16:51.726215,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9962622, 'precision': 0.9962623, 'recall': 0.9962621, 'specificity': 0.9962621, 'f1': 0.9962622, 'auroc': 0.99990606, 'binary_precision': 0.99614793, 'binary_recall': 0.99638295, 'binary_specificity': 0.99614125, 'binary_f1_score': 0.9962655}
confusion matrix:
       0      1
0  25299     98
1     92  25343
---- Validation: 
scalar performance:
{'acc': 0.9776908, 'precision': 0.7664434, 'recall': 0.8936258, 'specificity': 0.8936258, 'f1': 0.8167325, 'auroc': 0.9636835, 'binary_precision': 0.5379845, 'binary_recall': 0.80510443, 'binary_specificity': 0.98214716, 'binary_f1_score': 0.64498144}
confusion matrix:
       0    1
0  16394  298
1     84  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9018928, 'precision': 0.69777834, 'recall': 0.8383268, 'specificity': 0.8383268, 'f1': 0.7418932, 'auroc': 0.9071269, 'binary_precision': 0.4161267, 'binary_recall': 0.76354027, 'binary_specificity': 0.91311336, 'binary_f1_score': 0.5386766}
confusion matrix:
      0    1
0  8523  811
1   179  578
early stop counter: 2
val acc:0.9776908159255981, best validation acc: 0.9810780882835388, corresponding to test acc:                         0.9206223487854004 / 0.923694372177124
after epoch: 15,now: 2024-08-06 13:35:29.511582,epoch time: 0:18:08.634305,used: 4:35:00.360520,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9929572, 'precision': 0.99297154, 'recall': 0.9929553, 'specificity': 0.9929553, 'f1': 0.9929571, 'auroc': 0.99973166, 'binary_precision': 0.9904941, 'binary_recall': 0.9954787, 'binary_specificity': 0.99043196, 'binary_f1_score': 0.9929801}
confusion matrix:
       0      1
0  25154    243
1    115  25320
---- Validation: 
scalar performance:
{'acc': 0.9576593, 'precision': 0.67867875, 'recall': 0.92064595, 'specificity': 0.92064595, 'f1': 0.7448273, 'auroc': 0.96511203, 'binary_precision': 0.3605313, 'binary_recall': 0.88167053, 'binary_specificity': 0.95962137, 'binary_f1_score': 0.5117845}
confusion matrix:
       0    1
0  16018  674
1     51  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.754831, 'precision': 0.60644865, 'recall': 0.8262022, 'specificity': 0.8262022, 'f1': 0.60311794, 'auroc': 0.8903865, 'binary_precision': 0.22261712, 'binary_recall': 0.91017175, 'binary_specificity': 0.7422327, 'binary_f1_score': 0.3577362}
confusion matrix:
      0     1
0  6928  2406
1    68   689
early stop counter: 3
val acc:0.9576593041419983, best validation acc: 0.9810780882835388, corresponding to test acc:                         0.9206223487854004 / 0.923694372177124
after epoch: 16,now: 2024-08-06 13:53:43.854930,epoch time: 0:18:14.343348,used: 4:53:14.703868,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99478674, 'precision': 0.9948288, 'recall': 0.9947907, 'specificity': 0.9947907, 'f1': 0.9947867, 'auroc': 0.9998461, 'binary_precision': 0.99960303, 'binary_recall': 0.9899752, 'binary_specificity': 0.9996062, 'binary_f1_score': 0.9947658}
confusion matrix:
       0      1
0  25385     10
1    255  25182
---- Validation: 
scalar performance:
{'acc': 0.9752964, 'precision': 0.75080657, 'recall': 0.6109932, 'specificity': 0.6109932, 'f1': 0.6520303, 'auroc': 0.9481181, 'binary_precision': 0.5212766, 'binary_recall': 0.22737819, 'binary_specificity': 0.9946082, 'binary_f1_score': 0.31663975}
confusion matrix:
       0   1
0  16602  90
1    333  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9110098, 'precision': 0.6963107, 'recall': 0.751001, 'specificity': 0.751001, 'f1': 0.71906877, 'auroc': 0.9064908, 'binary_precision': 0.42900303, 'binary_recall': 0.5627477, 'binary_specificity': 0.93925434, 'binary_f1_score': 0.48685718}
confusion matrix:
      0    1
0  8767  567
1   331  426
early stop counter: 4
val acc:0.9752963781356812, best validation acc: 0.9810780882835388, corresponding to test acc:                         0.9206223487854004 / 0.923694372177124
after epoch: 17,now: 2024-08-06 14:12:13.417370,epoch time: 0:18:29.562440,used: 5:11:44.266308,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99234736, 'precision': 0.9924001, 'recall': 0.9923432, 'specificity': 0.9923432, 'f1': 0.99234706, 'auroc': 0.9998516, 'binary_precision': 0.98750484, 'binary_recall': 0.99732673, 'binary_specificity': 0.9873597, 'binary_f1_score': 0.99239147}
confusion matrix:
       0      1
0  25074    321
1     68  25369
---- Validation: 
scalar performance:
{'acc': 0.9072592, 'precision': 0.57316476, 'recall': 0.76482934, 'specificity': 0.76482934, 'f1': 0.6004044, 'auroc': 0.89809805, 'binary_precision': 0.15708359, 'binary_recall': 0.6148492, 'binary_specificity': 0.91480947, 'binary_f1_score': 0.2502361}
confusion matrix:
       0     1
0  15270  1422
1    166   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8021009, 'precision': 0.5894697, 'recall': 0.7182284, 'specificity': 0.7182284, 'f1': 0.6019014, 'auroc': 0.7947539, 'binary_precision': 0.21533518, 'binary_recall': 0.6195509, 'binary_specificity': 0.8169059, 'binary_f1_score': 0.31959113}
confusion matrix:
      0     1
0  7625  1709
1   288   469
early stop counter: 5
val acc:0.9072592258453369, best validation acc: 0.9810780882835388, corresponding to test acc:                         0.9206223487854004 / 0.923694372177124
after epoch: 18,now: 2024-08-06 14:30:30.014473,epoch time: 0:18:16.597103,used: 5:30:00.863411,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99500316, 'precision': 0.99502414, 'recall': 0.9950007, 'specificity': 0.9950007, 'f1': 0.9950031, 'auroc': 0.999823, 'binary_precision': 0.9919897, 'binary_recall': 0.9980736, 'binary_specificity': 0.99192786, 'binary_f1_score': 0.99502236}
confusion matrix:
       0      1
0  25191    205
1     49  25387
---- Validation: 
scalar performance:
{'acc': 0.90358, 'precision': 0.59427565, 'recall': 0.8929081, 'specificity': 0.8929081, 'f1': 0.63168037, 'auroc': 0.9471413, 'binary_precision': 0.1919192, 'binary_recall': 0.88167053, 'binary_specificity': 0.9041457, 'binary_f1_score': 0.3152219}
confusion matrix:
       0     1
0  15092  1600
1     51   380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56109405, 'precision': 0.56958675, 'recall': 0.7506104, 'specificity': 0.7506104, 'f1': 0.4697639, 'auroc': 0.89250433, 'binary_precision': 0.14321804, 'binary_recall': 0.97357994, 'binary_specificity': 0.5276409, 'binary_f1_score': 0.24970357}
confusion matrix:
      0     1
0  4925  4409
1    20   737
early stop counter: 6
val acc:0.9035800099372864, best validation acc: 0.9810780882835388, corresponding to test acc:                         0.9206223487854004 / 0.923694372177124
after epoch: 19,now: 2024-08-06 14:48:50.046868,epoch time: 0:18:20.032395,used: 5:48:20.895806,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9899866, 'precision': 0.99013066, 'recall': 0.9899807, 'specificity': 0.9899807, 'f1': 0.9899858, 'auroc': 0.9998313, 'binary_precision': 0.98190325, 'binary_recall': 0.998388, 'binary_specificity': 0.98157334, 'binary_f1_score': 0.99007696}
confusion matrix:
       0      1
0  24930    468
1     41  25393
---- Validation: 
scalar performance:
{'acc': 0.93342286, 'precision': 0.6300317, 'recall': 0.92177653, 'specificity': 0.92177653, 'f1': 0.68610716, 'auroc': 0.96161914, 'binary_precision': 0.2625586, 'binary_recall': 0.90951276, 'binary_specificity': 0.93404025, 'binary_f1_score': 0.4074844}
confusion matrix:
       0     1
0  15591  1101
1     39   392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7065702, 'precision': 0.59320235, 'recall': 0.80861187, 'specificity': 0.80861187, 'f1': 0.5673664, 'auroc': 0.90337044, 'binary_precision': 0.19473684, 'binary_recall': 0.92866576, 'binary_specificity': 0.688558, 'binary_f1_score': 0.32196015}
confusion matrix:
      0     1
0  6427  2907
1    54   703
early stop counter: 7
val acc:0.933422863483429, best validation acc: 0.9810780882835388, corresponding to test acc:                         0.9206223487854004 / 0.923694372177124
after epoch: 20,now: 2024-08-06 15:09:11.051779,epoch time: 0:20:21.004911,used: 6:08:41.900717,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_28_seed_1_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:08:41.900717 at 2024-08-06 15:09:11.051779
persisted model performance metric: 

scalar performance:
{'acc': 0.92062235, 'precision': 0.6950638, 'recall': 0.6141744, 'specificity': 0.6141744, 'f1': 0.64094305, 'auroc': 0.911888, 'binary_precision': 0.44859812, 'binary_recall': 0.25363275, 'binary_specificity': 0.97471607, 'binary_f1_score': 0.3240506}
confusion matrix:
      0    1
0  9098  236
1   565  192
oracle model performance metric: 

scalar performance:
{'acc': 0.9236944, 'precision': 0.5415169, 'recall': 0.50112444, 'specificity': 0.50112444, 'f1': 0.48402676, 'auroc': 0.9060758, 'binary_precision': 0.15789473, 'binary_recall': 0.003963012, 'binary_specificity': 0.99828583, 'binary_f1_score': 0.0077319588}
confusion matrix:
      0   1
0  9318  16
1   754   3
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |  40858 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14482 MiB |  28098 MiB |  13626 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  28014 MiB |  13608 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool | 455249 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |  10843 KiB |     42 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7359    |  216546 K  |  216541 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112785 K  |  112780 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7359    |  216546 K  |  216541 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112785 K  |  112780 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1210    |     575    |
|       from large pool |     602    |     602    |    1168    |     566    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3239    |  127600 K  |  127600 K  |
|       from large pool |      36    |     605    |   73199 K  |   73199 K  |
|       from small pool |      37    |    3203    |   54401 K  |   54401 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14482 MiB |  28098 MiB |  27196 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     44 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    1210    |    1146    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3239    |  127602 K  |  127602 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3203    |   54403 K  |   54403 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14482 MiB |  28098 MiB |  27196 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     44 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    1210    |    1146    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3239    |  127602 K  |  127602 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3203    |   54403 K  |   54403 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668

 Experiment start at: 2024-08-06 15:32:53.675477
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9851826, 'precision': 0.98533106, 'recall': 0.98518395, 'specificity': 0.98518395, 'f1': 0.9851815, 'auroc': 0.9988396, 'binary_precision': 0.9938578, 'binary_recall': 0.97640413, 'binary_specificity': 0.9939638, 'binary_f1_score': 0.98505366}
confusion matrix:
       0      1
0  25688    156
1    610  25242
---- Validation: 
scalar performance:
{'acc': 0.97056764, 'precision': 0.71458, 'recall': 0.84263396, 'specificity': 0.84263396, 'f1': 0.7624717, 'auroc': 0.94223, 'binary_precision': 0.43657818, 'binary_recall': 0.708134, 'binary_specificity': 0.977134, 'binary_f1_score': 0.540146}
confusion matrix:
       0    1
0  16324  382
1    122  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918153, 'precision': 0.73330474, 'recall': 0.84544396, 'specificity': 0.84544396, 'f1': 0.7743939, 'auroc': 0.9271823, 'binary_precision': 0.48829702, 'binary_recall': 0.7590966, 'binary_specificity': 0.9317913, 'binary_f1_score': 0.5943026}
confusion matrix:
      0    1
0  8661  634
1   192  605
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 15:53:10.229277,epoch time: 0:20:16.553800,used: 0:20:16.553800,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9904441, 'precision': 0.9904802, 'recall': 0.99044496, 'specificity': 0.99044496, 'f1': 0.99044394, 'auroc': 0.99938893, 'binary_precision': 0.99473256, 'binary_recall': 0.9861138, 'binary_specificity': 0.9947761, 'binary_f1_score': 0.99040437}
confusion matrix:
       0      1
0  25708    135
1    359  25494
---- Validation: 
scalar performance:
{'acc': 0.92250645, 'precision': 0.609637, 'recall': 0.89847285, 'specificity': 0.89847285, 'f1': 0.65683156, 'auroc': 0.9466361, 'binary_precision': 0.22269677, 'binary_recall': 0.8732057, 'binary_specificity': 0.92373997, 'binary_f1_score': 0.3548858}
confusion matrix:
       0     1
0  15432  1274
1     53   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82045186, 'precision': 0.64130133, 'recall': 0.85721695, 'specificity': 0.85721695, 'f1': 0.66756356, 'auroc': 0.9188417, 'binary_precision': 0.29294166, 'binary_recall': 0.9008783, 'binary_specificity': 0.81355566, 'binary_f1_score': 0.4421182}
confusion matrix:
      0     1
0  7562  1733
1    79   718
early stop counter: 1
val acc:0.9225064516067505, best validation acc: 0.9705676436424255, corresponding to test acc:                         0.9181529879570007 / 0.9181529879570007
after epoch: 2,now: 2024-08-06 16:12:47.246606,epoch time: 0:19:37.017329,used: 0:39:53.571129,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9782962, 'precision': 0.97875994, 'recall': 0.97829556, 'specificity': 0.97829556, 'f1': 0.9782909, 'auroc': 0.9986937, 'binary_precision': 0.963869, 'binary_recall': 0.9938489, 'binary_specificity': 0.96274227, 'binary_f1_score': 0.9786294}
confusion matrix:
       0      1
0  24884    963
1    159  25690
---- Validation: 
scalar performance:
{'acc': 0.8846064, 'precision': 0.5768796, 'recall': 0.87205124, 'specificity': 0.87205124, 'f1': 0.60194767, 'auroc': 0.9302957, 'binary_precision': 0.15773286, 'binary_recall': 0.8588517, 'binary_specificity': 0.8852508, 'binary_f1_score': 0.26651818}
confusion matrix:
       0     1
0  14789  1917
1     59   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91260403, 'precision': 0.7256711, 'recall': 0.8642268, 'specificity': 0.8642268, 'f1': 0.77210844, 'auroc': 0.9231728, 'binary_precision': 0.46900073, 'binary_recall': 0.8067754, 'binary_specificity': 0.9216783, 'binary_f1_score': 0.5931734}
confusion matrix:
      0    1
0  8567  728
1   154  643
early stop counter: 2
val acc:0.8846064209938049, best validation acc: 0.9705676436424255, corresponding to test acc:                         0.9181529879570007 / 0.9181529879570007
after epoch: 3,now: 2024-08-06 16:31:47.958183,epoch time: 0:19:00.711577,used: 0:58:54.282706,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9869816, 'precision': 0.98700315, 'recall': 0.98698235, 'specificity': 0.98698235, 'f1': 0.9869815, 'auroc': 0.99858224, 'binary_precision': 0.99030334, 'binary_recall': 0.9836002, 'binary_specificity': 0.99036455, 'binary_f1_score': 0.9869404}
confusion matrix:
       0      1
0  25593    249
1    424  25430
---- Validation: 
scalar performance:
{'acc': 0.92297363, 'precision': 0.6035221, 'recall': 0.8613925, 'specificity': 0.8613925, 'f1': 0.6473168, 'auroc': 0.923908, 'binary_precision': 0.21250798, 'binary_recall': 0.7966507, 'binary_specificity': 0.92613435, 'binary_f1_score': 0.33551633}
confusion matrix:
       0     1
0  15472  1234
1     85   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9206302, 'precision': 0.7074317, 'recall': 0.54394895, 'specificity': 0.54394895, 'f1': 0.5598004, 'auroc': 0.89452827, 'binary_precision': 0.48734176, 'binary_recall': 0.0966123, 'binary_specificity': 0.9912856, 'binary_f1_score': 0.16125655}
confusion matrix:
      0   1
0  9214  81
1   720  77
new oracle model saved
early stop counter: 3
val acc:0.9229736328125, best validation acc: 0.9705676436424255, corresponding to test acc:                         0.9181529879570007 / 0.9206302165985107
after epoch: 4,now: 2024-08-06 16:50:36.290608,epoch time: 0:18:48.332425,used: 1:17:42.615131,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99357784, 'precision': 0.9936019, 'recall': 0.99357826, 'specificity': 0.99357826, 'f1': 0.9935778, 'auroc': 0.9996693, 'binary_precision': 0.9970782, 'binary_recall': 0.9900584, 'binary_specificity': 0.9970981, 'binary_f1_score': 0.9935559}
confusion matrix:
       0      1
0  25770     75
1    257  25594
---- Validation: 
scalar performance:
{'acc': 0.9735459, 'precision': 0.7228603, 'recall': 0.7275361, 'specificity': 0.7275361, 'f1': 0.7251718, 'auroc': 0.9199761, 'binary_precision': 0.45901638, 'binary_recall': 0.46889952, 'binary_specificity': 0.9861726, 'binary_f1_score': 0.4639053}
confusion matrix:
       0    1
0  16475  231
1    222  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92092746, 'precision': 0.72978044, 'recall': 0.7460035, 'specificity': 0.7460035, 'f1': 0.737523, 'auroc': 0.890023, 'binary_precision': 0.49941793, 'binary_recall': 0.5382685, 'binary_specificity': 0.9537386, 'binary_f1_score': 0.51811594}
confusion matrix:
      0    1
0  8865  430
1   368  429
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 17:09:29.924516,epoch time: 0:18:53.633908,used: 1:36:36.249039,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99175954, 'precision': 0.99179995, 'recall': 0.9917593, 'specificity': 0.9917593, 'f1': 0.9917593, 'auroc': 0.9996438, 'binary_precision': 0.9873481, 'binary_recall': 0.9962861, 'binary_specificity': 0.98723257, 'binary_f1_score': 0.9917969}
confusion matrix:
       0      1
0  25517    330
1     96  25753
---- Validation: 
scalar performance:
{'acc': 0.9773418, 'precision': 0.76076424, 'recall': 0.79712355, 'specificity': 0.79712355, 'f1': 0.7776654, 'auroc': 0.93463564, 'binary_precision': 0.5313808, 'binary_recall': 0.6076555, 'binary_specificity': 0.98659164, 'binary_f1_score': 0.56696427}
confusion matrix:
       0    1
0  16482  224
1    164  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9201348, 'precision': 0.7300812, 'recall': 0.77253056, 'specificity': 0.77253056, 'f1': 0.748891, 'auroc': 0.90581113, 'binary_precision': 0.49531737, 'binary_recall': 0.5972397, 'binary_specificity': 0.94782144, 'binary_f1_score': 0.54152447}
confusion matrix:
      0    1
0  8810  485
1   321  476
better model found
persisted
after epoch: 6,now: 2024-08-06 17:28:27.045394,epoch time: 0:18:57.120878,used: 1:55:33.369917,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95032495, 'precision': 0.9543177, 'recall': 0.9503123, 'specificity': 0.9503123, 'f1': 0.9502146, 'auroc': 0.9987724, 'binary_precision': 0.9117949, 'binary_recall': 0.9971379, 'binary_specificity': 0.9034867, 'binary_f1_score': 0.95255864}
confusion matrix:
       0      1
0  23347   2494
1     74  25781
---- Validation: 
scalar performance:
{'acc': 0.9733123, 'precision': 0.72851145, 'recall': 0.81138587, 'specificity': 0.81138587, 'f1': 0.7630181, 'auroc': 0.9441494, 'binary_precision': 0.46608695, 'binary_recall': 0.6411483, 'binary_specificity': 0.98162335, 'binary_f1_score': 0.5397784}
confusion matrix:
       0    1
0  16399  307
1    150  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80132776, 'precision': 0.6250911, 'recall': 0.8267605, 'specificity': 0.8267605, 'f1': 0.642984, 'auroc': 0.88614523, 'binary_precision': 0.26534575, 'binary_recall': 0.85696363, 'binary_specificity': 0.7965573, 'binary_f1_score': 0.40522096}
confusion matrix:
      0     1
0  7404  1891
1   114   683
early stop counter: 1
val acc:0.9733123183250427, best validation acc: 0.9773417711257935, corresponding to test acc:                         0.9201347827911377 / 0.9209274649620056
after epoch: 7,now: 2024-08-06 17:47:24.520369,epoch time: 0:18:57.474975,used: 2:14:30.844892,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99495125, 'precision': 0.9949696, 'recall': 0.9949521, 'specificity': 0.9949521, 'f1': 0.9949512, 'auroc': 0.9998013, 'binary_precision': 0.998054, 'binary_recall': 0.9918391, 'binary_specificity': 0.9980651, 'binary_f1_score': 0.9949368}
confusion matrix:
       0      1
0  25791     50
1    211  25644
---- Validation: 
scalar performance:
{'acc': 0.97932726, 'precision': 0.7781085, 'recall': 0.8284635, 'specificity': 0.8284635, 'f1': 0.8010359, 'auroc': 0.95650494, 'binary_precision': 0.5645161, 'binary_recall': 0.6698565, 'binary_specificity': 0.9870705, 'binary_f1_score': 0.6126915}
confusion matrix:
       0    1
0  16490  216
1    138  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90239793, 'precision': 0.71163213, 'recall': 0.8730253, 'specificity': 0.8730253, 'f1': 0.760236, 'auroc': 0.9134475, 'binary_precision': 0.43832022, 'binary_recall': 0.83814305, 'binary_specificity': 0.9079075, 'binary_f1_score': 0.575614}
confusion matrix:
      0    1
0  8439  856
1   129  668
better model found
persisted
after epoch: 8,now: 2024-08-06 18:06:17.951057,epoch time: 0:18:53.430688,used: 2:33:24.275580,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9897091, 'precision': 0.98981214, 'recall': 0.9897096, 'specificity': 0.9897096, 'f1': 0.98970854, 'auroc': 0.9992409, 'binary_precision': 0.99693805, 'binary_recall': 0.98243713, 'binary_specificity': 0.9969821, 'binary_f1_score': 0.9896345}
confusion matrix:
       0      1
0  25768     78
1    454  25396
---- Validation: 
scalar performance:
{'acc': 0.97903526, 'precision': 0.7876836, 'recall': 0.7303494, 'specificity': 0.7303494, 'f1': 0.7556267, 'auroc': 0.93211794, 'binary_precision': 0.5885886, 'binary_recall': 0.46889952, 'binary_specificity': 0.99179935, 'binary_f1_score': 0.5219707}
confusion matrix:
       0    1
0  16569  137
1    222  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91914386, 'precision': 0.7213205, 'recall': 0.71521014, 'specificity': 0.71521014, 'f1': 0.7182084, 'auroc': 0.885847, 'binary_precision': 0.4877102, 'binary_recall': 0.47302383, 'binary_specificity': 0.95739645, 'binary_f1_score': 0.4802548}
confusion matrix:
      0    1
0  8899  396
1   420  377
early stop counter: 1
val acc:0.9790352582931519, best validation acc: 0.9793272614479065, corresponding to test acc:                         0.9023979306221008 / 0.9209274649620056
after epoch: 9,now: 2024-08-06 18:25:12.131000,epoch time: 0:18:54.179943,used: 2:52:18.455523,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99195296, 'precision': 0.9919803, 'recall': 0.99195206, 'specificity': 0.99195206, 'f1': 0.9919528, 'auroc': 0.9997518, 'binary_precision': 0.9883658, 'binary_recall': 0.9956293, 'binary_specificity': 0.9882749, 'binary_f1_score': 0.99198425}
confusion matrix:
       0      1
0  25539    303
1    113  25741
---- Validation: 
scalar performance:
{'acc': 0.9717356, 'precision': 0.7231582, 'recall': 0.86539114, 'specificity': 0.86539114, 'f1': 0.77546114, 'auroc': 0.94349086, 'binary_precision': 0.4525862, 'binary_recall': 0.7535885, 'binary_specificity': 0.97719383, 'binary_f1_score': 0.56552964}
confusion matrix:
       0    1
0  16325  381
1    103  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9227111, 'precision': 0.738752, 'recall': 0.79744506, 'specificity': 0.79744506, 'f1': 0.7637752, 'auroc': 0.9004841, 'binary_precision': 0.50835794, 'binary_recall': 0.64868253, 'binary_specificity': 0.94620764, 'binary_f1_score': 0.570011}
confusion matrix:
      0    1
0  8795  500
1   280  517
new oracle model saved
early stop counter: 2
val acc:0.9717355966567993, best validation acc: 0.9793272614479065, corresponding to test acc:                         0.9023979306221008 / 0.9227110743522644
after epoch: 10,now: 2024-08-06 18:44:06.193319,epoch time: 0:18:54.062319,used: 3:11:12.517842,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9918756, 'precision': 0.99192613, 'recall': 0.99187636, 'specificity': 0.99187636, 'f1': 0.9918754, 'auroc': 0.9994613, 'binary_precision': 0.9969517, 'binary_recall': 0.98677087, 'binary_specificity': 0.9969819, 'binary_f1_score': 0.9918352}
confusion matrix:
       0      1
0  25766     78
1    342  25510
---- Validation: 
scalar performance:
{'acc': 0.9732539, 'precision': 0.70707947, 'recall': 0.64574945, 'specificity': 0.64574945, 'f1': 0.6706367, 'auroc': 0.89433044, 'binary_precision': 0.43150684, 'binary_recall': 0.3014354, 'binary_specificity': 0.9900634, 'binary_f1_score': 0.3549296}
confusion matrix:
       0    1
0  16540  166
1    292  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9227111, 'precision': 0.7302861, 'recall': 0.61906785, 'specificity': 0.61906785, 'f1': 0.6522838, 'auroc': 0.86197126, 'binary_precision': 0.521519, 'binary_recall': 0.25846925, 'binary_specificity': 0.9796665, 'binary_f1_score': 0.3456376}
confusion matrix:
      0    1
0  9106  189
1   591  206
early stop counter: 3
val acc:0.9732539057731628, best validation acc: 0.9793272614479065, corresponding to test acc:                         0.9023979306221008 / 0.9227110743522644
after epoch: 11,now: 2024-08-06 19:03:02.057412,epoch time: 0:18:55.864093,used: 3:30:08.381935,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99636334, 'precision': 0.9963668, 'recall': 0.9963636, 'specificity': 0.9963636, 'f1': 0.9963634, 'auroc': 0.99982804, 'binary_precision': 0.9977116, 'binary_recall': 0.9950101, 'binary_specificity': 0.9977171, 'binary_f1_score': 0.99635905}
confusion matrix:
       0      1
0  25785     59
1    129  25723
---- Validation: 
scalar performance:
{'acc': 0.95818734, 'precision': 0.6712219, 'recall': 0.8864374, 'specificity': 0.8864374, 'f1': 0.73228836, 'auroc': 0.95170283, 'binary_precision': 0.34733605, 'binary_recall': 0.81100476, 'binary_specificity': 0.96187, 'binary_f1_score': 0.48637015}
confusion matrix:
       0    1
0  16069  637
1     79  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8916964, 'precision': 0.6960125, 'recall': 0.86205363, 'specificity': 0.86205363, 'f1': 0.74258167, 'auroc': 0.9073436, 'binary_precision': 0.40830237, 'binary_recall': 0.8268507, 'binary_specificity': 0.8972566, 'binary_f1_score': 0.54666114}
confusion matrix:
      0    1
0  8340  955
1   138  659
early stop counter: 4
val acc:0.9581873416900635, best validation acc: 0.9793272614479065, corresponding to test acc:                         0.9023979306221008 / 0.9227110743522644
after epoch: 12,now: 2024-08-06 19:21:54.060368,epoch time: 0:18:52.002956,used: 3:49:00.384891,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9933844, 'precision': 0.99346197, 'recall': 0.9933864, 'specificity': 0.9933864, 'f1': 0.9933841, 'auroc': 0.99986035, 'binary_precision': 0.9997258, 'binary_recall': 0.9870436, 'binary_specificity': 0.9997291, 'binary_f1_score': 0.99334425}
confusion matrix:
       0      1
0  25833      7
1    335  25521
---- Validation: 
scalar performance:
{'acc': 0.9793857, 'precision': 0.7902725, 'recall': 0.74335766, 'specificity': 0.74335766, 'f1': 0.764611, 'auroc': 0.9586874, 'binary_precision': 0.5931232, 'binary_recall': 0.4952153, 'binary_specificity': 0.9915001, 'binary_f1_score': 0.5397653}
confusion matrix:
       0    1
0  16564  142
1    211  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9148831, 'precision': 0.72991204, 'recall': 0.86718476, 'specificity': 0.86718476, 'f1': 0.77650803, 'auroc': 0.90644246, 'binary_precision': 0.47710487, 'binary_recall': 0.81053954, 'binary_specificity': 0.92383003, 'binary_f1_score': 0.6006509}
confusion matrix:
      0    1
0  8587  708
1   151  646
better model found
persisted
after epoch: 13,now: 2024-08-06 19:40:42.731760,epoch time: 0:18:48.671392,used: 4:07:49.056283,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9964601, 'precision': 0.99646026, 'recall': 0.99646, 'specificity': 0.99646, 'f1': 0.9964601, 'auroc': 0.99988604, 'binary_precision': 0.9962111, 'binary_recall': 0.996712, 'binary_specificity': 0.996208, 'binary_f1_score': 0.9964615}
confusion matrix:
       0      1
0  25746     98
1     85  25767
---- Validation: 
scalar performance:
{'acc': 0.975765, 'precision': 0.74794424, 'recall': 0.8616251, 'specificity': 0.8616251, 'f1': 0.7932693, 'auroc': 0.9565251, 'binary_precision': 0.5024311, 'binary_recall': 0.7416268, 'binary_specificity': 0.98162335, 'binary_f1_score': 0.5990338}
confusion matrix:
       0    1
0  16399  307
1    108  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8077685, 'precision': 0.63242793, 'recall': 0.84459597, 'specificity': 0.84459597, 'f1': 0.6533234, 'auroc': 0.8973162, 'binary_precision': 0.27667058, 'binary_recall': 0.88833123, 'binary_specificity': 0.8008607, 'binary_f1_score': 0.42193085}
confusion matrix:
      0     1
0  7444  1851
1    89   708
early stop counter: 1
val acc:0.9757649898529053, best validation acc: 0.9793856739997864, corresponding to test acc:                         0.9148830771446228 / 0.9227110743522644
after epoch: 14,now: 2024-08-06 19:59:33.729966,epoch time: 0:18:50.998206,used: 4:26:40.054489,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9963827, 'precision': 0.9964044, 'recall': 0.9963832, 'specificity': 0.9963832, 'f1': 0.9963827, 'auroc': 0.999897, 'binary_precision': 0.9997274, 'binary_recall': 0.9930373, 'binary_specificity': 0.99972916, 'binary_f1_score': 0.99637115}
confusion matrix:
       0      1
0  25837      7
1    180  25672
---- Validation: 
scalar performance:
{'acc': 0.97745854, 'precision': 0.7998428, 'recall': 0.5977559, 'specificity': 0.5977559, 'f1': 0.6446346, 'auroc': 0.95169735, 'binary_precision': 0.619403, 'binary_recall': 0.19856459, 'binary_specificity': 0.9969472, 'binary_f1_score': 0.30072463}
confusion matrix:
       0   1
0  16655  51
1    335  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9043797, 'precision': 0.6815461, 'recall': 0.70719504, 'specificity': 0.70719504, 'f1': 0.693183, 'auroc': 0.8681759, 'binary_precision': 0.4088937, 'binary_recall': 0.47302383, 'binary_specificity': 0.9413663, 'binary_f1_score': 0.4386271}
confusion matrix:
      0    1
0  8750  545
1   420  377
early stop counter: 2
val acc:0.9774585366249084, best validation acc: 0.9793856739997864, corresponding to test acc:                         0.9148830771446228 / 0.9227110743522644
after epoch: 15,now: 2024-08-06 20:18:26.951058,epoch time: 0:18:53.221092,used: 4:45:33.275581,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99477714, 'precision': 0.9947834, 'recall': 0.99477696, 'specificity': 0.99477696, 'f1': 0.9947771, 'auroc': 0.9998245, 'binary_precision': 0.9930612, 'binary_recall': 0.9965185, 'binary_specificity': 0.9930354, 'binary_f1_score': 0.9947868}
confusion matrix:
       0      1
0  25665    180
1     90  25761
---- Validation: 
scalar performance:
{'acc': 0.9638519, 'precision': 0.6908803, 'recall': 0.89283925, 'specificity': 0.89283925, 'f1': 0.75307673, 'auroc': 0.9560648, 'binary_precision': 0.38644066, 'binary_recall': 0.8181818, 'binary_specificity': 0.9674967, 'binary_f1_score': 0.5249424}
confusion matrix:
       0    1
0  16163  543
1     76  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8832739, 'precision': 0.68546903, 'recall': 0.8563342, 'specificity': 0.8563342, 'f1': 0.7303517, 'auroc': 0.9014908, 'binary_precision': 0.3876106, 'binary_recall': 0.8243413, 'binary_specificity': 0.88832706, 'binary_f1_score': 0.52728724}
confusion matrix:
      0     1
0  8257  1038
1   140   657
early stop counter: 3
val acc:0.9638519287109375, best validation acc: 0.9793856739997864, corresponding to test acc:                         0.9148830771446228 / 0.9227110743522644
after epoch: 16,now: 2024-08-06 20:37:15.282768,epoch time: 0:18:48.331710,used: 5:04:21.607291,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99709845, 'precision': 0.997102, 'recall': 0.9970987, 'specificity': 0.9970987, 'f1': 0.9970984, 'auroc': 0.9998981, 'binary_precision': 0.99848723, 'binary_recall': 0.9957065, 'binary_specificity': 0.99849087, 'binary_f1_score': 0.9970949}
confusion matrix:
       0      1
0  25804     39
1    111  25742
---- Validation: 
scalar performance:
{'acc': 0.9727867, 'precision': 0.72763777, 'recall': 0.8449375, 'specificity': 0.8449375, 'f1': 0.7731681, 'auroc': 0.94439894, 'binary_precision': 0.46261683, 'binary_recall': 0.7105263, 'binary_specificity': 0.9793487, 'binary_f1_score': 0.5603773}
confusion matrix:
       0    1
0  16361  345
1    121  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581054, 'precision': 0.66528285, 'recall': 0.8644662, 'specificity': 0.8644662, 'f1': 0.70503974, 'auroc': 0.9060889, 'binary_precision': 0.34320986, 'binary_recall': 0.87202007, 'binary_specificity': 0.8569123, 'binary_f1_score': 0.49255842}
confusion matrix:
      0     1
0  7965  1330
1   102   695
early stop counter: 4
val acc:0.9727867245674133, best validation acc: 0.9793856739997864, corresponding to test acc:                         0.9148830771446228 / 0.9227110743522644
after epoch: 17,now: 2024-08-06 20:56:00.265889,epoch time: 0:18:44.983121,used: 5:23:06.590412,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9945257, 'precision': 0.99453413, 'recall': 0.99452543, 'specificity': 0.99452543, 'f1': 0.9945257, 'auroc': 0.9997777, 'binary_precision': 0.9925261, 'binary_recall': 0.99655735, 'binary_specificity': 0.99249345, 'binary_f1_score': 0.99453765}
confusion matrix:
       0      1
0  25650    194
1     89  25763
---- Validation: 
scalar performance:
{'acc': 0.9614576, 'precision': 0.68110245, 'recall': 0.8834485, 'specificity': 0.8834485, 'f1': 0.7418548, 'auroc': 0.95900893, 'binary_precision': 0.36732456, 'binary_recall': 0.8014354, 'binary_specificity': 0.9654615, 'binary_f1_score': 0.50375944}
confusion matrix:
       0    1
0  16129  577
1     83  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86553705, 'precision': 0.673138, 'recall': 0.87366265, 'specificity': 0.87366265, 'f1': 0.7156595, 'auroc': 0.917518, 'binary_precision': 0.35772356, 'binary_recall': 0.8833124, 'binary_specificity': 0.8640129, 'binary_f1_score': 0.5092224}
confusion matrix:
      0     1
0  8031  1264
1    93   704
early stop counter: 5
val acc:0.9614576101303101, best validation acc: 0.9793856739997864, corresponding to test acc:                         0.9148830771446228 / 0.9227110743522644
after epoch: 18,now: 2024-08-06 21:14:49.510128,epoch time: 0:18:49.244239,used: 5:41:55.834651,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9911792, 'precision': 0.9911905, 'recall': 0.9911789, 'specificity': 0.9911789, 'f1': 0.9911791, 'auroc': 0.9995351, 'binary_precision': 0.9888735, 'binary_recall': 0.99354017, 'binary_specificity': 0.9888175, 'binary_f1_score': 0.99120134}
confusion matrix:
       0      1
0  25555    289
1    167  25685
---- Validation: 
scalar performance:
{'acc': 0.9736043, 'precision': 0.7280108, 'recall': 0.77771443, 'specificity': 0.77771443, 'f1': 0.7502061, 'auroc': 0.9418819, 'binary_precision': 0.46679688, 'binary_recall': 0.5717703, 'binary_specificity': 0.98365855, 'binary_f1_score': 0.5139785}
confusion matrix:
       0    1
0  16433  273
1    179  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86533886, 'precision': 0.666448, 'recall': 0.84602416, 'specificity': 0.84602416, 'f1': 0.7068012, 'auroc': 0.9156921, 'binary_precision': 0.35005337, 'binary_recall': 0.82308656, 'binary_specificity': 0.8689618, 'binary_f1_score': 0.49120182}
confusion matrix:
      0     1
0  8077  1218
1   141   656
early stop counter: 6
val acc:0.9736043214797974, best validation acc: 0.9793856739997864, corresponding to test acc:                         0.9148830771446228 / 0.9227110743522644
after epoch: 19,now: 2024-08-06 21:33:53.324717,epoch time: 0:19:03.814589,used: 6:00:59.649240,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9974853, 'precision': 0.99749064, 'recall': 0.9974855, 'specificity': 0.9974855, 'f1': 0.9974853, 'auroc': 0.9999321, 'binary_precision': 0.9991461, 'binary_recall': 0.9958222, 'binary_specificity': 0.9991488, 'binary_f1_score': 0.9974814}
confusion matrix:
       0      1
0  25823     22
1    108  25743
---- Validation: 
scalar performance:
{'acc': 0.98107916, 'precision': 0.7988838, 'recall': 0.8142002, 'specificity': 0.8142002, 'f1': 0.806337, 'auroc': 0.96053755, 'binary_precision': 0.6068182, 'binary_recall': 0.638756, 'binary_specificity': 0.98964447, 'binary_f1_score': 0.62237763}
confusion matrix:
       0    1
0  16533  173
1    151  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9201348, 'precision': 0.73642564, 'recall': 0.83734286, 'specificity': 0.83734286, 'f1': 0.7747321, 'auroc': 0.91625774, 'binary_precision': 0.49620894, 'binary_recall': 0.7390213, 'binary_specificity': 0.93566436, 'binary_f1_score': 0.59375}
confusion matrix:
      0    1
0  8697  598
1   208  589
better model found
persisted
after epoch: 20,now: 2024-08-06 21:53:12.631031,epoch time: 0:19:19.306314,used: 6:20:18.955554,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_32_53_seed_2_24076668
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:20:18.955554 at 2024-08-06 21:53:12.631031
persisted model performance metric: 

scalar performance:
{'acc': 0.9201348, 'precision': 0.73642564, 'recall': 0.83734286, 'specificity': 0.83734286, 'f1': 0.7747321, 'auroc': 0.91625774, 'binary_precision': 0.49620894, 'binary_recall': 0.7390213, 'binary_specificity': 0.93566436, 'binary_f1_score': 0.59375}
confusion matrix:
      0    1
0  8697  598
1   208  589
oracle model performance metric: 

scalar performance:
{'acc': 0.9227111, 'precision': 0.738752, 'recall': 0.79744506, 'specificity': 0.79744506, 'f1': 0.7637752, 'auroc': 0.9004841, 'binary_precision': 0.50835794, 'binary_recall': 0.64868253, 'binary_specificity': 0.94620764, 'binary_f1_score': 0.570011}
confusion matrix:
      0    1
0  8795  500
1   280  517
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |  40858 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14482 MiB |  41668 MiB |  27196 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  41570 MiB |  27164 MiB |
|       from small pool |     66 MiB |     70 MiB |     98 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool | 455249 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |  10843 KiB |     44 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7467    |  329279 K  |  329274 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158242 K  |
|       from small pool |    4735    |    7278    |  171037 K  |  171032 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7467    |  329279 K  |  329274 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158242 K  |
|       from small pool |    4735    |    7278    |  171037 K  |  171032 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1781    |    1146    |
|       from large pool |     602    |     602    |    1732    |    1130    |
|       from small pool |      33    |      35    |      49    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3293    |  193360 K  |  193360 K  |
|       from large pool |      36    |     605    |  110448 K  |  110448 K  |
|       from small pool |      39    |    3257    |   82911 K  |   82911 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |      0 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14482 MiB |  41668 MiB |  40766 MiB |
|       from large pool |    850 MiB |  14412 MiB |  41570 MiB |  40720 MiB |
|       from small pool |     52 MiB |     70 MiB |     98 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool |  24320 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |      0 KiB |     48 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7467    |  329279 K  |  329279 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171037 K  |  171037 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7467    |  329279 K  |  329279 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171037 K  |  171037 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    1781    |    1717    |
|       from large pool |      38    |     602    |    1732    |    1694    |
|       from small pool |      26    |      35    |      49    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3293    |  193362 K  |  193362 K  |
|       from large pool |       3    |     605    |  110448 K  |  110448 K  |
|       from small pool |       0    |    3257    |   82913 K  |   82913 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug  6 22:12:05 2024]
Finished job 0.
1 of 1 steps (100%) done
