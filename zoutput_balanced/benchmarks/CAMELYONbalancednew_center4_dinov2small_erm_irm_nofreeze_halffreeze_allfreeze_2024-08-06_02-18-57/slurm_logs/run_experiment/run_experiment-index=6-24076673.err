Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:57 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673

 Experiment start at: 2024-08-06 02:34:45.553329
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98675376, 'precision': 0.98681486, 'recall': 0.98675716, 'specificity': 0.98675716, 'f1': 0.98675346, 'auroc': 0.9990094, 'binary_precision': 0.9924158, 'binary_recall': 0.9810204, 'binary_specificity': 0.992494, 'binary_f1_score': 0.9866852}
confusion matrix:
       0      1
0  25123    190
1    481  24862
---- Validation: 
scalar performance:
{'acc': 0.94144404, 'precision': 0.63413054, 'recall': 0.89597493, 'specificity': 0.89597493, 'f1': 0.69068265, 'auroc': 0.9440941, 'binary_precision': 0.27223513, 'binary_recall': 0.84819275, 'binary_specificity': 0.9437571, 'binary_f1_score': 0.412178}
confusion matrix:
       0    1
0  15790  941
1     63  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8873838, 'precision': 0.6923436, 'recall': 0.8891305, 'specificity': 0.8891305, 'f1': 0.74140716, 'auroc': 0.92559826, 'binary_precision': 0.39472175, 'binary_recall': 0.8911917, 'binary_specificity': 0.88706917, 'binary_f1_score': 0.5471173}
confusion matrix:
      0     1
0  8287  1055
1    84   688
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 02:56:08.471847,epoch time: 0:21:22.918518,used: 0:21:22.918518,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9880567, 'precision': 0.9880835, 'recall': 0.98805475, 'specificity': 0.98805475, 'f1': 0.98805654, 'auroc': 0.9991778, 'binary_precision': 0.98460215, 'binary_recall': 0.9916344, 'binary_specificity': 0.984475, 'binary_f1_score': 0.9881058}
confusion matrix:
       0      1
0  24921    393
1    212  25130
---- Validation: 
scalar performance:
{'acc': 0.95678294, 'precision': 0.6670449, 'recall': 0.89208525, 'specificity': 0.89208525, 'f1': 0.7287273, 'auroc': 0.9473134, 'binary_precision': 0.33861387, 'binary_recall': 0.8240964, 'binary_specificity': 0.9600741, 'binary_f1_score': 0.48000005}
confusion matrix:
       0    1
0  16063  668
1     73  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.826577, 'precision': 0.64137733, 'recall': 0.8597795, 'specificity': 0.8597795, 'f1': 0.6695499, 'auroc': 0.92299074, 'binary_precision': 0.292827, 'binary_recall': 0.89896375, 'binary_specificity': 0.82059515, 'binary_f1_score': 0.44175684}
confusion matrix:
      0     1
0  7666  1676
1    78   694
better model found
persisted
after epoch: 2,now: 2024-08-06 03:16:04.387813,epoch time: 0:19:55.915966,used: 0:41:18.834484,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99164957, 'precision': 0.99168587, 'recall': 0.99164724, 'specificity': 0.99164724, 'f1': 0.9916494, 'auroc': 0.99975276, 'binary_precision': 0.9875944, 'binary_recall': 0.99581724, 'binary_specificity': 0.9874773, 'binary_f1_score': 0.9916888}
confusion matrix:
       0      1
0  24997    317
1    106  25236
---- Validation: 
scalar performance:
{'acc': 0.93368715, 'precision': 0.6264975, 'recall': 0.9213736, 'specificity': 0.9213736, 'f1': 0.6818196, 'auroc': 0.95643663, 'binary_precision': 0.25542006, 'binary_recall': 0.90843374, 'binary_specificity': 0.93431354, 'binary_f1_score': 0.39873084}
confusion matrix:
       0     1
0  15632  1099
1     38   377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81995255, 'precision': 0.6392763, 'recall': 0.8639174, 'specificity': 0.8639174, 'f1': 0.6649662, 'auroc': 0.91800237, 'binary_precision': 0.2870483, 'binary_recall': 0.91580313, 'binary_specificity': 0.8120317, 'binary_f1_score': 0.43709427}
confusion matrix:
      0     1
0  7586  1756
1    65   707
early stop counter: 1
val acc:0.933687150478363, best validation acc: 0.9567829370498657, corresponding to test acc:                         0.8265770077705383 / 0.8873838186264038
after epoch: 3,now: 2024-08-06 03:35:58.067029,epoch time: 0:19:53.679216,used: 1:01:12.513700,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9848784, 'precision': 0.9852735, 'recall': 0.98488694, 'specificity': 0.98488694, 'f1': 0.9848755, 'auroc': 0.99909127, 'binary_precision': 0.99926865, 'binary_recall': 0.970485, 'binary_specificity': 0.9992889, 'binary_f1_score': 0.9846665}
confusion matrix:
       0      1
0  25295     18
1    748  24595
---- Validation: 
scalar performance:
{'acc': 0.9610405, 'precision': 0.66046166, 'recall': 0.783823, 'specificity': 0.783823, 'f1': 0.70297635, 'auroc': 0.9175947, 'binary_precision': 0.33110815, 'binary_recall': 0.5975904, 'binary_specificity': 0.9700556, 'binary_f1_score': 0.42611685}
confusion matrix:
       0    1
0  16230  501
1    167  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9264386, 'precision': 0.743695, 'recall': 0.8199612, 'specificity': 0.8199612, 'f1': 0.7749499, 'auroc': 0.9237915, 'binary_precision': 0.51341, 'binary_recall': 0.69430053, 'binary_specificity': 0.9456219, 'binary_f1_score': 0.59030837}
confusion matrix:
      0    1
0  8834  508
1   236  536
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 03:55:52.764630,epoch time: 0:19:54.697601,used: 1:21:07.211301,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99188644, 'precision': 0.9918864, 'recall': 0.99188656, 'specificity': 0.99188656, 'f1': 0.99188644, 'auroc': 0.9995576, 'binary_precision': 0.9920669, 'binary_recall': 0.99171466, 'binary_specificity': 0.99205846, 'binary_f1_score': 0.9918908}
confusion matrix:
       0      1
0  25109    201
1    210  25136
---- Validation: 
scalar performance:
{'acc': 0.9368366, 'precision': 0.6260738, 'recall': 0.8924391, 'specificity': 0.8924391, 'f1': 0.67998064, 'auroc': 0.94198674, 'binary_precision': 0.25620437, 'binary_recall': 0.8457831, 'binary_specificity': 0.9390951, 'binary_f1_score': 0.3932773}
confusion matrix:
       0     1
0  15712  1019
1     64   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90963024, 'precision': 0.70999366, 'recall': 0.82571614, 'specificity': 0.82571614, 'f1': 0.7504194, 'auroc': 0.9186555, 'binary_precision': 0.44382912, 'binary_recall': 0.7266839, 'binary_specificity': 0.9247484, 'binary_f1_score': 0.5510805}
confusion matrix:
      0    1
0  8639  703
1   211  561
early stop counter: 1
val acc:0.9368366003036499, best validation acc: 0.9610404968261719, corresponding to test acc:                         0.9264386296272278 / 0.9264386296272278
after epoch: 5,now: 2024-08-06 04:15:39.318828,epoch time: 0:19:46.554198,used: 1:40:53.765499,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98890555, 'precision': 0.98902345, 'recall': 0.988901, 'specificity': 0.988901, 'f1': 0.98890483, 'auroc': 0.99970573, 'binary_precision': 0.9815772, 'binary_recall': 0.9965276, 'binary_specificity': 0.9812744, 'binary_f1_score': 0.9889959}
confusion matrix:
       0      1
0  24839    474
1     88  25255
---- Validation: 
scalar performance:
{'acc': 0.89496094, 'precision': 0.58551985, 'recall': 0.89330566, 'specificity': 0.89330566, 'f1': 0.6172506, 'auroc': 0.94536054, 'binary_precision': 0.17403574, 'binary_recall': 0.8915663, 'binary_specificity': 0.8950451, 'binary_f1_score': 0.2912239}
confusion matrix:
       0     1
0  14975  1756
1     45   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88906467, 'precision': 0.6933568, 'recall': 0.88528717, 'specificity': 0.88528717, 'f1': 0.7423599, 'auroc': 0.9232892, 'binary_precision': 0.39766082, 'binary_recall': 0.88082904, 'binary_specificity': 0.88974524, 'binary_f1_score': 0.5479452}
confusion matrix:
      0     1
0  8312  1030
1    92   680
early stop counter: 2
val acc:0.8949609398841858, best validation acc: 0.9610404968261719, corresponding to test acc:                         0.9264386296272278 / 0.9264386296272278
after epoch: 6,now: 2024-08-06 04:35:21.006802,epoch time: 0:19:41.687974,used: 2:00:35.453473,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9916693, 'precision': 0.9917238, 'recall': 0.9916725, 'specificity': 0.9916725, 'f1': 0.9916691, 'auroc': 0.99946785, 'binary_precision': 0.99704814, 'binary_recall': 0.9862684, 'binary_specificity': 0.99707663, 'binary_f1_score': 0.99162894}
confusion matrix:
       0      1
0  25239     74
1    348  24995
---- Validation: 
scalar performance:
{'acc': 0.97235507, 'precision': 0.6452793, 'recall': 0.5558086, 'specificity': 0.5558086, 'f1': 0.5786359, 'auroc': 0.9402812, 'binary_precision': 0.3121019, 'binary_recall': 0.118072286, 'binary_specificity': 0.99354494, 'binary_f1_score': 0.17132868}
confusion matrix:
       0    1
0  16623  108
1    366   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9045877, 'precision': 0.7079841, 'recall': 0.86041784, 'specificity': 0.86041784, 'f1': 0.7551869, 'auroc': 0.91990083, 'binary_precision': 0.4330326, 'binary_recall': 0.8082902, 'binary_specificity': 0.9125455, 'binary_f1_score': 0.56394035}
confusion matrix:
      0    1
0  8525  817
1   148  624
better model found
persisted
after epoch: 7,now: 2024-08-06 04:55:10.708105,epoch time: 0:19:49.701303,used: 2:20:25.154776,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99161005, 'precision': 0.9916961, 'recall': 0.99161327, 'specificity': 0.99161327, 'f1': 0.99160975, 'auroc': 0.9997481, 'binary_precision': 0.9983199, 'binary_recall': 0.9848856, 'binary_specificity': 0.99834096, 'binary_f1_score': 0.99155724}
confusion matrix:
       0      1
0  25274     42
1    383  24957
---- Validation: 
scalar performance:
{'acc': 0.9773125, 'precision': 0.75790644, 'recall': 0.8473827, 'specificity': 0.8473827, 'f1': 0.7954893, 'auroc': 0.9521066, 'binary_precision': 0.52304965, 'binary_recall': 0.7108434, 'binary_specificity': 0.98392206, 'binary_f1_score': 0.60265577}
confusion matrix:
       0    1
0  16462  269
1    120  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91200316, 'precision': 0.72166896, 'recall': 0.8763149, 'specificity': 0.8763149, 'f1': 0.77103037, 'auroc': 0.929847, 'binary_precision': 0.458037, 'binary_recall': 0.83419687, 'binary_specificity': 0.9184329, 'binary_f1_score': 0.5913682}
confusion matrix:
      0    1
0  8580  762
1   128  644
better model found
persisted
after epoch: 8,now: 2024-08-06 05:15:18.078869,epoch time: 0:20:07.370764,used: 2:40:32.525540,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99395925, 'precision': 0.9939919, 'recall': 0.99396193, 'specificity': 0.99396193, 'f1': 0.9939592, 'auroc': 0.99974704, 'binary_precision': 0.99816954, 'binary_recall': 0.98974115, 'binary_specificity': 0.99818265, 'binary_f1_score': 0.99393743}
confusion matrix:
       0      1
0  25266     46
1    260  25084
---- Validation: 
scalar performance:
{'acc': 0.97235507, 'precision': 0.72219354, 'recall': 0.82839346, 'specificity': 0.82839346, 'f1': 0.764109, 'auroc': 0.954617, 'binary_precision': 0.45249596, 'binary_recall': 0.6771084, 'binary_specificity': 0.97967845, 'binary_f1_score': 0.54247105}
confusion matrix:
       0    1
0  16391  340
1    134  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8311252, 'precision': 0.64594316, 'recall': 0.86877704, 'specificity': 0.86877704, 'f1': 0.67619413, 'auroc': 0.92029166, 'binary_precision': 0.3005115, 'binary_recall': 0.9132124, 'binary_specificity': 0.82434165, 'binary_f1_score': 0.45221296}
confusion matrix:
      0     1
0  7701  1641
1    67   705
early stop counter: 1
val acc:0.97235506772995, best validation acc: 0.9773125052452087, corresponding to test acc:                         0.9120031595230103 / 0.9264386296272278
after epoch: 9,now: 2024-08-06 05:35:07.120278,epoch time: 0:19:49.041409,used: 3:00:21.566949,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9913732, 'precision': 0.9913771, 'recall': 0.99137425, 'specificity': 0.99137425, 'f1': 0.9913732, 'auroc': 0.9994791, 'binary_precision': 0.9929544, 'binary_recall': 0.989781, 'binary_specificity': 0.9929675, 'binary_f1_score': 0.99136513}
confusion matrix:
       0      1
0  25133    178
1    259  25086
---- Validation: 
scalar performance:
{'acc': 0.83727986, 'precision': 0.55747056, 'recall': 0.8613999, 'specificity': 0.8613999, 'f1': 0.5590253, 'auroc': 0.9306706, 'binary_precision': 0.11828994, 'binary_recall': 0.886747, 'binary_specificity': 0.83605283, 'binary_f1_score': 0.20873512}
confusion matrix:
       0     1
0  13988  2743
1     47   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9042911, 'precision': 0.69904053, 'recall': 0.8133197, 'specificity': 0.8133197, 'f1': 0.7381829, 'auroc': 0.89582896, 'binary_precision': 0.42379472, 'binary_recall': 0.70595855, 'binary_specificity': 0.9206808, 'binary_f1_score': 0.52964044}
confusion matrix:
      0    1
0  8601  741
1   227  545
early stop counter: 2
val acc:0.8372798562049866, best validation acc: 0.9773125052452087, corresponding to test acc:                         0.9120031595230103 / 0.9264386296272278
after epoch: 10,now: 2024-08-06 05:55:02.281446,epoch time: 0:19:55.161168,used: 3:20:16.728117,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9947686, 'precision': 0.9947716, 'recall': 0.9947696, 'specificity': 0.9947696, 'f1': 0.9947686, 'auroc': 0.9998088, 'binary_precision': 0.99616206, 'binary_recall': 0.9933715, 'binary_specificity': 0.99616766, 'binary_f1_score': 0.9947648}
confusion matrix:
       0      1
0  25214     97
1    168  25177
---- Validation: 
scalar performance:
{'acc': 0.9687391, 'precision': 0.7035029, 'recall': 0.8406398, 'specificity': 0.8406398, 'f1': 0.75306123, 'auroc': 0.9488689, 'binary_precision': 0.41442716, 'binary_recall': 0.7060241, 'binary_specificity': 0.9752555, 'binary_f1_score': 0.52228165}
confusion matrix:
       0    1
0  16317  414
1    122  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80433065, 'precision': 0.6291499, 'recall': 0.85011363, 'specificity': 0.85011363, 'f1': 0.6481012, 'auroc': 0.9133862, 'binary_precision': 0.26815212, 'binary_recall': 0.90414506, 'binary_specificity': 0.7960822, 'binary_f1_score': 0.4136296}
confusion matrix:
      0     1
0  7437  1905
1    74   698
early stop counter: 3
val acc:0.9687390923500061, best validation acc: 0.9773125052452087, corresponding to test acc:                         0.9120031595230103 / 0.9264386296272278
after epoch: 11,now: 2024-08-06 06:14:44.165610,epoch time: 0:19:41.884164,used: 3:39:58.612281,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9933473, 'precision': 0.99341655, 'recall': 0.9933506, 'specificity': 0.9933506, 'f1': 0.9933471, 'auroc': 0.9998338, 'binary_precision': 0.99940085, 'binary_recall': 0.98729384, 'binary_specificity': 0.9994075, 'binary_f1_score': 0.99331045}
confusion matrix:
       0      1
0  25299     15
1    322  25020
---- Validation: 
scalar performance:
{'acc': 0.97702086, 'precision': 0.75563717, 'recall': 0.88718104, 'specificity': 0.88718104, 'f1': 0.8068111, 'auroc': 0.96177197, 'binary_precision': 0.51648355, 'binary_recall': 0.7927711, 'binary_specificity': 0.98159105, 'binary_f1_score': 0.62547535}
confusion matrix:
       0    1
0  16423  308
1     86  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78564364, 'precision': 0.6185349, 'recall': 0.83465075, 'specificity': 0.83465075, 'f1': 0.62932324, 'auroc': 0.90554136, 'binary_precision': 0.2483778, 'binary_recall': 0.89248705, 'binary_specificity': 0.7768144, 'binary_f1_score': 0.38860688}
confusion matrix:
      0     1
0  7257  2085
1    83   689
early stop counter: 4
val acc:0.9770208597183228, best validation acc: 0.9773125052452087, corresponding to test acc:                         0.9120031595230103 / 0.9264386296272278
after epoch: 12,now: 2024-08-06 06:34:37.526728,epoch time: 0:19:53.361118,used: 3:59:51.973399,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9952424, 'precision': 0.99524736, 'recall': 0.99524164, 'specificity': 0.99524164, 'f1': 0.9952425, 'auroc': 0.9998156, 'binary_precision': 0.9938226, 'binary_recall': 0.9966853, 'binary_specificity': 0.9937979, 'binary_f1_score': 0.99525195}
confusion matrix:
       0      1
0  25157    157
1     84  25258
---- Validation: 
scalar performance:
{'acc': 0.97311324, 'precision': 0.72766834, 'recall': 0.83700645, 'specificity': 0.83700645, 'f1': 0.7707929, 'auroc': 0.93939656, 'binary_precision': 0.4630225, 'binary_recall': 0.6939759, 'binary_specificity': 0.98003703, 'binary_f1_score': 0.5554484}
confusion matrix:
       0    1
0  16397  334
1    127  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90518093, 'precision': 0.70849025, 'recall': 0.8583624, 'specificity': 0.8583624, 'f1': 0.7553503, 'auroc': 0.9099036, 'binary_precision': 0.43447793, 'binary_recall': 0.8031088, 'binary_specificity': 0.91361594, 'binary_f1_score': 0.56389266}
confusion matrix:
      0    1
0  8535  807
1   152  620
early stop counter: 5
val acc:0.9731132388114929, best validation acc: 0.9773125052452087, corresponding to test acc:                         0.9120031595230103 / 0.9264386296272278
after epoch: 13,now: 2024-08-06 06:54:35.313237,epoch time: 0:19:57.786509,used: 4:19:49.759908,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99508446, 'precision': 0.9950901, 'recall': 0.99508363, 'specificity': 0.99508363, 'f1': 0.99508446, 'auroc': 0.99983186, 'binary_precision': 0.99354863, 'binary_recall': 0.99664587, 'binary_specificity': 0.9935214, 'binary_f1_score': 0.99509484}
confusion matrix:
       0      1
0  25150    164
1     85  25257
---- Validation: 
scalar performance:
{'acc': 0.97987866, 'precision': 0.7804524, 'recall': 0.84399796, 'specificity': 0.84399796, 'f1': 0.8087458, 'auroc': 0.95758015, 'binary_precision': 0.5683594, 'binary_recall': 0.70120484, 'binary_specificity': 0.986791, 'binary_f1_score': 0.62783176}
confusion matrix:
       0    1
0  16510  221
1    124  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9223848, 'precision': 0.73625934, 'recall': 0.8415327, 'specificity': 0.8415327, 'f1': 0.77590835, 'auroc': 0.9213675, 'binary_precision': 0.4944206, 'binary_recall': 0.746114, 'binary_specificity': 0.9369514, 'binary_f1_score': 0.59473413}
confusion matrix:
      0    1
0  8753  589
1   196  576
better model found
persisted
after epoch: 14,now: 2024-08-06 07:14:23.469025,epoch time: 0:19:48.155788,used: 4:39:37.915696,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99620974, 'precision': 0.99621654, 'recall': 0.9962113, 'specificity': 0.9962113, 'f1': 0.99620974, 'auroc': 0.9998697, 'binary_precision': 0.9982569, 'binary_recall': 0.99416107, 'binary_specificity': 0.9982615, 'binary_f1_score': 0.9962048}
confusion matrix:
       0      1
0  25265     44
1    148  25199
---- Validation: 
scalar performance:
{'acc': 0.9843695, 'precision': 0.82936496, 'recall': 0.85099876, 'specificity': 0.85099876, 'f1': 0.8398149, 'auroc': 0.95692164, 'binary_precision': 0.66591424, 'binary_recall': 0.7108434, 'binary_specificity': 0.99115413, 'binary_f1_score': 0.6876457}
confusion matrix:
       0    1
0  16583  148
1    120  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230769, 'precision': 0.7323787, 'recall': 0.783681, 'specificity': 0.783681, 'f1': 0.7546294, 'auroc': 0.9203191, 'binary_precision': 0.49688148, 'binary_recall': 0.61917096, 'binary_specificity': 0.948191, 'binary_f1_score': 0.55132645}
confusion matrix:
      0    1
0  8858  484
1   294  478
better model found
persisted
after epoch: 15,now: 2024-08-06 07:34:28.329454,epoch time: 0:20:04.860429,used: 4:59:42.776125,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.994512, 'precision': 0.9945123, 'recall': 0.9945122, 'specificity': 0.9945122, 'f1': 0.994512, 'auroc': 0.9997386, 'binary_precision': 0.9950221, 'binary_recall': 0.9940011, 'binary_specificity': 0.9950233, 'binary_f1_score': 0.99451137}
confusion matrix:
       0      1
0  25192    126
1    152  25186
---- Validation: 
scalar performance:
{'acc': 0.97742915, 'precision': 0.7584759, 'recall': 0.8956148, 'specificity': 0.8956148, 'f1': 0.8114579, 'auroc': 0.968873, 'binary_precision': 0.5217391, 'binary_recall': 0.80963856, 'binary_specificity': 0.98159105, 'binary_f1_score': 0.6345609}
confusion matrix:
       0    1
0  16423  308
1     79  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90439, 'precision': 0.7130799, 'recall': 0.89239466, 'specificity': 0.89239466, 'f1': 0.76486033, 'auroc': 0.93059766, 'binary_precision': 0.43713734, 'binary_recall': 0.8782383, 'binary_specificity': 0.90655106, 'binary_f1_score': 0.5837279}
confusion matrix:
      0    1
0  8469  873
1    94  678
early stop counter: 1
val acc:0.9774291515350342, best validation acc: 0.9843695163726807, corresponding to test acc:                         0.9230769276618958 / 0.9264386296272278
after epoch: 16,now: 2024-08-06 07:54:26.981303,epoch time: 0:19:58.651849,used: 5:19:41.427974,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9910376, 'precision': 0.9911903, 'recall': 0.99104285, 'specificity': 0.99104285, 'f1': 0.99103695, 'auroc': 0.99987483, 'binary_precision': 1.0, 'binary_recall': 0.98208576, 'binary_specificity': 1.0, 'binary_f1_score': 0.99096197}
confusion matrix:
       0      1
0  25313      0
1    454  24889
---- Validation: 
scalar performance:
{'acc': 0.97830397, 'precision': 0.8320442, 'recall': 0.5952798, 'specificity': 0.5952798, 'f1': 0.64486647, 'auroc': 0.94277966, 'binary_precision': 0.6837607, 'binary_recall': 0.19277108, 'binary_specificity': 0.99778855, 'binary_f1_score': 0.3007519}
confusion matrix:
       0   1
0  16694  37
1    335  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91328853, 'precision': 0.7175277, 'recall': 0.8330438, 'specificity': 0.8330438, 'f1': 0.75851905, 'auroc': 0.9037844, 'binary_precision': 0.45783132, 'binary_recall': 0.738342, 'binary_specificity': 0.92774564, 'binary_f1_score': 0.56519586}
confusion matrix:
      0    1
0  8667  675
1   202  570
early stop counter: 2
val acc:0.9783039689064026, best validation acc: 0.9843695163726807, corresponding to test acc:                         0.9230769276618958 / 0.9264386296272278
after epoch: 17,now: 2024-08-06 08:14:06.013131,epoch time: 0:19:39.031828,used: 5:39:20.459802,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99470943, 'precision': 0.99472696, 'recall': 0.9947078, 'specificity': 0.9947078, 'f1': 0.9947094, 'auroc': 0.99988216, 'binary_precision': 0.99191713, 'binary_recall': 0.99755347, 'binary_specificity': 0.99186224, 'binary_f1_score': 0.9947273}
confusion matrix:
       0      1
0  25108    206
1     62  25280
---- Validation: 
scalar performance:
{'acc': 0.95019245, 'precision': 0.6571839, 'recall': 0.9321809, 'specificity': 0.9321809, 'f1': 0.72204554, 'auroc': 0.9670768, 'binary_precision': 0.3166249, 'binary_recall': 0.913253, 'binary_specificity': 0.9511087, 'binary_f1_score': 0.4702233}
confusion matrix:
       0    1
0  15913  818
1     36  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71801466, 'precision': 0.5994385, 'recall': 0.8206194, 'specificity': 0.8206194, 'f1': 0.5792725, 'auroc': 0.91643023, 'binary_precision': 0.20571591, 'binary_recall': 0.9417098, 'binary_specificity': 0.699529, 'binary_f1_score': 0.33766836}
confusion matrix:
      0     1
0  6535  2807
1    45   727
early stop counter: 3
val acc:0.9501924514770508, best validation acc: 0.9843695163726807, corresponding to test acc:                         0.9230769276618958 / 0.9264386296272278
after epoch: 18,now: 2024-08-06 08:34:06.467835,epoch time: 0:20:00.454704,used: 5:59:20.914506,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99723625, 'precision': 0.99724567, 'recall': 0.9972376, 'specificity': 0.9972376, 'f1': 0.99723625, 'auroc': 0.99996424, 'binary_precision': 0.99956393, 'binary_recall': 0.9949098, 'binary_specificity': 0.9995654, 'binary_f1_score': 0.9972315}
confusion matrix:
       0      1
0  25302     11
1    129  25214
---- Validation: 
scalar performance:
{'acc': 0.9804619, 'precision': 0.79249024, 'recall': 0.7972994, 'specificity': 0.7972994, 'f1': 0.79487383, 'auroc': 0.9670664, 'binary_precision': 0.5947867, 'binary_recall': 0.6048193, 'binary_specificity': 0.9897795, 'binary_f1_score': 0.59976107}
confusion matrix:
       0    1
0  16560  171
1    164  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81767845, 'precision': 0.6336604, 'recall': 0.84605026, 'specificity': 0.84605026, 'f1': 0.6579025, 'auroc': 0.9144212, 'binary_precision': 0.27942386, 'binary_recall': 0.8795337, 'binary_specificity': 0.8125669, 'binary_f1_score': 0.4241099}
confusion matrix:
      0     1
0  7591  1751
1    93   679
early stop counter: 4
val acc:0.9804618954658508, best validation acc: 0.9843695163726807, corresponding to test acc:                         0.9230769276618958 / 0.9264386296272278
after epoch: 19,now: 2024-08-06 08:54:02.701564,epoch time: 0:19:56.233729,used: 6:19:17.148235,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.990702, 'precision': 0.99078023, 'recall': 0.9906976, 'specificity': 0.9906976, 'f1': 0.99070156, 'auroc': 0.99978805, 'binary_precision': 0.9847605, 'binary_recall': 0.9968437, 'binary_specificity': 0.98455155, 'binary_f1_score': 0.9907653}
confusion matrix:
       0      1
0  24919    391
1     80  25266
---- Validation: 
scalar performance:
{'acc': 0.9606322, 'precision': 0.6780012, 'recall': 0.888183, 'specificity': 0.888183, 'f1': 0.7395697, 'auroc': 0.9618377, 'binary_precision': 0.3608137, 'binary_recall': 0.8120482, 'binary_specificity': 0.96431774, 'binary_f1_score': 0.49962938}
confusion matrix:
       0    1
0  16134  597
1     78  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89667785, 'precision': 0.69777596, 'recall': 0.86267173, 'specificity': 0.86267173, 'f1': 0.74512935, 'auroc': 0.92851424, 'binary_precision': 0.41153598, 'binary_recall': 0.82253885, 'binary_specificity': 0.90280455, 'binary_f1_score': 0.54859614}
confusion matrix:
      0    1
0  8434  908
1   137  635
early stop counter: 5
val acc:0.9606322050094604, best validation acc: 0.9843695163726807, corresponding to test acc:                         0.9230769276618958 / 0.9264386296272278
after epoch: 20,now: 2024-08-06 09:13:51.202062,epoch time: 0:19:48.500498,used: 6:39:05.648733,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:39:05.648733 at 2024-08-06 09:13:51.202062
persisted model performance metric: 

scalar performance:
{'acc': 0.9230769, 'precision': 0.7323787, 'recall': 0.783681, 'specificity': 0.783681, 'f1': 0.7546294, 'auroc': 0.9203191, 'binary_precision': 0.49688148, 'binary_recall': 0.61917096, 'binary_specificity': 0.948191, 'binary_f1_score': 0.55132645}
confusion matrix:
      0    1
0  8858  484
1   294  478
oracle model performance metric: 

scalar performance:
{'acc': 0.9264386, 'precision': 0.743695, 'recall': 0.8199612, 'specificity': 0.8199612, 'f1': 0.7749499, 'auroc': 0.9237915, 'binary_precision': 0.51341, 'binary_recall': 0.69430053, 'binary_specificity': 0.9456219, 'binary_f1_score': 0.59030837}
confusion matrix:
      0    1
0  8834  508
1   236  536
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459204 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555060 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 459204 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555060 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447934 KiB |  13213 MiB | 562427 GiB | 562426 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |  40859 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14412 MiB |  14412 MiB |  14412 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 415291 KiB |   1235 MiB | 450793 GiB | 450793 GiB |
|       from large pool | 406502 KiB |   1232 MiB | 442916 GiB | 442915 GiB |
|       from small pool |   8789 KiB |     17 MiB |   7877 GiB |   7877 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4934    |    7337    |  107646 K  |  107642 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56146 K  |   56142 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4934    |    7337    |  107646 K  |  107642 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56146 K  |   56142 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      66    |    3222    |   64595 K  |   64595 K  |
|       from large pool |      30    |     604    |   37573 K  |   37573 K  |
|       from small pool |      36    |    3191    |   27022 K  |   27022 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562427 GiB | 562427 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450794 GiB | 450794 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     42 MiB |   7877 GiB |   7877 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64597 K  |   64597 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   27024 K  |   27024 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562427 GiB | 562427 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450794 GiB | 450794 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     42 MiB |   7877 GiB |   7877 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64597 K  |   64597 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   27024 K  |   27024 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673

 Experiment start at: 2024-08-06 09:40:44.929555
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98709476, 'precision': 0.9870949, 'recall': 0.98709464, 'specificity': 0.98709464, 'f1': 0.9870947, 'auroc': 0.99880445, 'binary_precision': 0.9869517, 'binary_recall': 0.9872621, 'binary_specificity': 0.9869271, 'binary_f1_score': 0.98710686}
confusion matrix:
       0      1
0  25064    332
1    324  25112
---- Validation: 
scalar performance:
{'acc': 0.7728202, 'precision': 0.5456204, 'recall': 0.8473127, 'specificity': 0.8473127, 'f1': 0.5193081, 'auroc': 0.9388331, 'binary_precision': 0.093727976, 'binary_recall': 0.9257541, 'binary_specificity': 0.7688713, 'binary_f1_score': 0.17022184}
confusion matrix:
       0     1
0  12834  3858
1     32   399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8450104, 'precision': 0.65307176, 'recall': 0.87373483, 'specificity': 0.87373483, 'f1': 0.6884834, 'auroc': 0.92576015, 'binary_precision': 0.3149931, 'binary_recall': 0.9075297, 'binary_specificity': 0.83994, 'binary_f1_score': 0.46766505}
confusion matrix:
      0     1
0  7840  1494
1    70   687
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 10:01:46.363335,epoch time: 0:21:01.433780,used: 0:21:01.433780,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9806618, 'precision': 0.9811853, 'recall': 0.98067623, 'specificity': 0.98067623, 'f1': 0.980657, 'auroc': 0.99875426, 'binary_precision': 0.99727523, 'binary_recall': 0.96399087, 'binary_specificity': 0.9973616, 'binary_f1_score': 0.9803506}
confusion matrix:
       0      1
0  25327     67
1    916  24522
---- Validation: 
scalar performance:
{'acc': 0.95380485, 'precision': 0.6606325, 'recall': 0.8734634, 'specificity': 0.8734634, 'f1': 0.71906817, 'auroc': 0.9419103, 'binary_precision': 0.32692307, 'binary_recall': 0.7888631, 'binary_specificity': 0.9580637, 'binary_f1_score': 0.46227056}
confusion matrix:
       0    1
0  15992  700
1     91  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91992867, 'precision': 0.71948105, 'recall': 0.7679608, 'specificity': 0.7679608, 'f1': 0.74049383, 'auroc': 0.90757215, 'binary_precision': 0.47295865, 'binary_recall': 0.5891678, 'binary_specificity': 0.9467538, 'binary_f1_score': 0.5247059}
confusion matrix:
      0    1
0  8837  497
1   311  446
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 10:22:28.684452,epoch time: 0:20:42.321117,used: 0:41:43.754897,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9877439, 'precision': 0.98787475, 'recall': 0.98775125, 'specificity': 0.98775125, 'f1': 0.9877432, 'auroc': 0.9991659, 'binary_precision': 0.9960817, 'binary_recall': 0.9793616, 'binary_specificity': 0.99614084, 'binary_f1_score': 0.9876509}
confusion matrix:
       0      1
0  25296     98
1    525  24913
---- Validation: 
scalar performance:
{'acc': 0.9544472, 'precision': 0.65401137, 'recall': 0.8285874, 'specificity': 0.8285874, 'f1': 0.7055249, 'auroc': 0.9414343, 'binary_precision': 0.31612223, 'binary_recall': 0.6960557, 'binary_specificity': 0.9611191, 'binary_f1_score': 0.4347826}
confusion matrix:
       0    1
0  16043  649
1    131  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9278565, 'precision': 0.7410971, 'recall': 0.76314217, 'specificity': 0.76314217, 'f1': 0.7514909, 'auroc': 0.9283242, 'binary_precision': 0.51740694, 'binary_recall': 0.5693527, 'binary_specificity': 0.95693165, 'binary_f1_score': 0.5421384}
confusion matrix:
      0    1
0  8932  402
1   326  431
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 10:42:53.850278,epoch time: 0:20:25.165826,used: 1:02:08.920723,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9895538, 'precision': 0.98962903, 'recall': 0.9895588, 'specificity': 0.9895588, 'f1': 0.9895535, 'auroc': 0.99938977, 'binary_precision': 0.9958982, 'binary_recall': 0.98317343, 'binary_specificity': 0.99594426, 'binary_f1_score': 0.9894949}
confusion matrix:
       0      1
0  25293    103
1    428  25008
---- Validation: 
scalar performance:
{'acc': 0.97319394, 'precision': 0.7362094, 'recall': 0.8619357, 'specificity': 0.8619357, 'f1': 0.784629, 'auroc': 0.9570792, 'binary_precision': 0.4791045, 'binary_recall': 0.7447796, 'binary_specificity': 0.97909176, 'binary_f1_score': 0.5831062}
confusion matrix:
       0    1
0  16343  349
1    110  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9306313, 'precision': 0.7510409, 'recall': 0.7051625, 'specificity': 0.7051625, 'f1': 0.7251762, 'auroc': 0.9259972, 'binary_precision': 0.54679805, 'binary_recall': 0.43989432, 'binary_specificity': 0.9704307, 'binary_f1_score': 0.4875549}
confusion matrix:
      0    1
0  9058  276
1   424  333
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 11:04:20.474463,epoch time: 0:21:26.624185,used: 1:23:35.544908,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99110794, 'precision': 0.9912101, 'recall': 0.9911135, 'specificity': 0.9911135, 'f1': 0.9911076, 'auroc': 0.99950147, 'binary_precision': 0.9984836, 'binary_recall': 0.9837232, 'binary_specificity': 0.99850374, 'binary_f1_score': 0.99104846}
confusion matrix:
       0      1
0  25359     38
1    414  25021
---- Validation: 
scalar performance:
{'acc': 0.9745372, 'precision': 0.74505186, 'recall': 0.8727959, 'specificity': 0.8727959, 'f1': 0.7945187, 'auroc': 0.96117973, 'binary_precision': 0.49624062, 'binary_recall': 0.76566124, 'binary_specificity': 0.9799305, 'binary_f1_score': 0.6021898}
confusion matrix:
       0    1
0  16357  335
1    101  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91953224, 'precision': 0.7205631, 'recall': 0.7835268, 'specificity': 0.7835268, 'f1': 0.7467586, 'auroc': 0.9279095, 'binary_precision': 0.47247246, 'binary_recall': 0.6235139, 'binary_specificity': 0.94353974, 'binary_f1_score': 0.5375854}
confusion matrix:
      0    1
0  8807  527
1   285  472
better model found
persisted
after epoch: 5,now: 2024-08-06 11:24:55.529638,epoch time: 0:20:35.055175,used: 1:44:10.600083,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9934687, 'precision': 0.9934691, 'recall': 0.99346924, 'specificity': 0.99346924, 'f1': 0.99346864, 'auroc': 0.99962294, 'binary_precision': 0.9941732, 'binary_recall': 0.99276614, 'binary_specificity': 0.99417233, 'binary_f1_score': 0.9934691}
confusion matrix:
       0      1
0  25248    148
1    184  25252
---- Validation: 
scalar performance:
{'acc': 0.9559073, 'precision': 0.6714486, 'recall': 0.9050555, 'specificity': 0.9050555, 'f1': 0.7349499, 'auroc': 0.9563962, 'binary_precision': 0.3468809, 'binary_recall': 0.85150814, 'binary_specificity': 0.9586029, 'binary_f1_score': 0.4929483}
confusion matrix:
       0    1
0  16001  691
1     64  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91507286, 'precision': 0.6950283, 'recall': 0.6985732, 'specificity': 0.6985732, 'f1': 0.6967793, 'auroc': 0.9146914, 'binary_precision': 0.43523315, 'binary_recall': 0.44385734, 'binary_specificity': 0.95328903, 'binary_f1_score': 0.43950292}
confusion matrix:
      0    1
0  8898  436
1   421  336
early stop counter: 1
val acc:0.9559072852134705, best validation acc: 0.974537193775177, corresponding to test acc:                         0.9195322394371033 / 0.9306312799453735
after epoch: 6,now: 2024-08-06 11:45:21.361196,epoch time: 0:20:25.831558,used: 2:04:36.431641,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9922096, 'precision': 0.99230623, 'recall': 0.9922153, 'specificity': 0.9922153, 'f1': 0.9922093, 'auroc': 0.9998529, 'binary_precision': 0.9994017, 'binary_recall': 0.98502123, 'binary_specificity': 0.9994094, 'binary_f1_score': 0.9921593}
confusion matrix:
       0      1
0  25381     15
1    381  25055
---- Validation: 
scalar performance:
{'acc': 0.9762308, 'precision': 0.75745666, 'recall': 0.7708219, 'specificity': 0.7708219, 'f1': 0.76395655, 'auroc': 0.95979565, 'binary_precision': 0.52643174, 'binary_recall': 0.55452436, 'binary_specificity': 0.98711956, 'binary_f1_score': 0.54011303}
confusion matrix:
       0    1
0  16477  215
1    192  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92339706, 'precision': 0.7329772, 'recall': 0.8135349, 'specificity': 0.8135349, 'f1': 0.76530975, 'auroc': 0.9328611, 'binary_precision': 0.49239543, 'binary_recall': 0.68428004, 'binary_specificity': 0.9427898, 'binary_f1_score': 0.5726921}
confusion matrix:
      0    1
0  8800  534
1   239  518
better model found
persisted
after epoch: 7,now: 2024-08-06 12:06:26.806245,epoch time: 0:21:05.445049,used: 2:25:41.876690,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99478674, 'precision': 0.99481237, 'recall': 0.9947897, 'specificity': 0.9947897, 'f1': 0.99478674, 'auroc': 0.99980557, 'binary_precision': 0.99857384, 'binary_recall': 0.990997, 'binary_specificity': 0.9985825, 'binary_f1_score': 0.994771}
confusion matrix:
       0      1
0  25360     36
1    229  25207
---- Validation: 
scalar performance:
{'acc': 0.97401154, 'precision': 0.7422764, 'recall': 0.88608795, 'specificity': 0.88608795, 'f1': 0.7962043, 'auroc': 0.9573084, 'binary_precision': 0.48997134, 'binary_recall': 0.79350346, 'binary_specificity': 0.97867244, 'binary_f1_score': 0.60584587}
confusion matrix:
       0    1
0  16336  356
1     89  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197304, 'precision': 0.7083475, 'recall': 0.69562846, 'specificity': 0.69562846, 'f1': 0.7017237, 'auroc': 0.9111977, 'binary_precision': 0.46251768, 'binary_recall': 0.4319683, 'binary_specificity': 0.9592886, 'binary_f1_score': 0.44672135}
confusion matrix:
      0    1
0  8954  380
1   430  327
early stop counter: 1
val acc:0.9740115404129028, best validation acc: 0.976230800151825, corresponding to test acc:                         0.9233970642089844 / 0.9306312799453735
after epoch: 8,now: 2024-08-06 12:26:46.376399,epoch time: 0:20:19.570154,used: 2:46:01.446844,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99392116, 'precision': 0.9939623, 'recall': 0.9939245, 'specificity': 0.9939245, 'f1': 0.99392104, 'auroc': 0.99966896, 'binary_precision': 0.99865043, 'binary_recall': 0.9891877, 'binary_specificity': 0.99866134, 'binary_f1_score': 0.99389654}
confusion matrix:
       0      1
0  25364     34
1    275  25159
---- Validation: 
scalar performance:
{'acc': 0.97325236, 'precision': 0.70987886, 'recall': 0.6099448, 'specificity': 0.6099448, 'f1': 0.64303005, 'auroc': 0.9444158, 'binary_precision': 0.4394619, 'binary_recall': 0.22737819, 'binary_specificity': 0.9925114, 'binary_f1_score': 0.2996942}
confusion matrix:
       0    1
0  16567  125
1    333   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91854125, 'precision': 0.7070418, 'recall': 0.70955205, 'specificity': 0.70955205, 'f1': 0.7082869, 'auroc': 0.89002925, 'binary_precision': 0.45762712, 'binary_recall': 0.4636724, 'binary_specificity': 0.95543176, 'binary_f1_score': 0.4606299}
confusion matrix:
      0    1
0  8918  416
1   406  351
early stop counter: 2
val acc:0.9732523560523987, best validation acc: 0.976230800151825, corresponding to test acc:                         0.9233970642089844 / 0.9306312799453735
after epoch: 9,now: 2024-08-06 12:46:58.518931,epoch time: 0:20:12.142532,used: 3:06:13.589376,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99525887, 'precision': 0.9952601, 'recall': 0.9952597, 'specificity': 0.9952597, 'f1': 0.99525887, 'auroc': 0.9997755, 'binary_precision': 0.9962576, 'binary_recall': 0.99426013, 'binary_specificity': 0.9962593, 'binary_f1_score': 0.99525785}
confusion matrix:
       0      1
0  25301     95
1    146  25290
---- Validation: 
scalar performance:
{'acc': 0.9685219, 'precision': 0.71247816, 'recall': 0.8764914, 'specificity': 0.8764914, 'f1': 0.7692987, 'auroc': 0.94903475, 'binary_precision': 0.43076923, 'binary_recall': 0.7795824, 'binary_specificity': 0.9734004, 'binary_f1_score': 0.55491334}
confusion matrix:
       0    1
0  16248  444
1     95  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91457736, 'precision': 0.70750064, 'recall': 0.7705306, 'specificity': 0.7705306, 'f1': 0.7333608, 'auroc': 0.90393615, 'binary_precision': 0.44827586, 'binary_recall': 0.6010568, 'binary_specificity': 0.9400043, 'binary_f1_score': 0.513544}
confusion matrix:
      0    1
0  8774  560
1   302  455
early stop counter: 3
val acc:0.9685218930244446, best validation acc: 0.976230800151825, corresponding to test acc:                         0.9233970642089844 / 0.9306312799453735
after epoch: 10,now: 2024-08-06 13:07:39.561809,epoch time: 0:20:41.042878,used: 3:26:54.632254,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9930556, 'precision': 0.9930767, 'recall': 0.99305844, 'specificity': 0.99305844, 'f1': 0.9930555, 'auroc': 0.9996735, 'binary_precision': 0.9965162, 'binary_recall': 0.9895821, 'binary_specificity': 0.99653476, 'binary_f1_score': 0.9930371}
confusion matrix:
       0      1
0  25307     88
1    265  25172
---- Validation: 
scalar performance:
{'acc': 0.9608129, 'precision': 0.68578386, 'recall': 0.90305114, 'specificity': 0.90305114, 'f1': 0.74962914, 'auroc': 0.95451444, 'binary_precision': 0.3757764, 'binary_recall': 0.8422274, 'binary_specificity': 0.96387494, 'binary_f1_score': 0.5196851}
confusion matrix:
       0    1
0  16089  603
1     68  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92091966, 'precision': 0.7336829, 'recall': 0.86924756, 'specificity': 0.86924756, 'f1': 0.78069925, 'auroc': 0.9376071, 'binary_precision': 0.48379448, 'binary_recall': 0.80845445, 'binary_specificity': 0.9300407, 'binary_f1_score': 0.60534126}
confusion matrix:
      0    1
0  8681  653
1   145  612
early stop counter: 4
val acc:0.9608129262924194, best validation acc: 0.976230800151825, corresponding to test acc:                         0.9233970642089844 / 0.9306312799453735
after epoch: 11,now: 2024-08-06 13:28:13.877910,epoch time: 0:20:34.316101,used: 3:47:28.948355,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9967933, 'precision': 0.9967961, 'recall': 0.99679434, 'specificity': 0.99679434, 'f1': 0.9967933, 'auroc': 0.999876, 'binary_precision': 0.9981471, 'binary_recall': 0.9954392, 'binary_specificity': 0.99814945, 'binary_f1_score': 0.99679124}
confusion matrix:
       0      1
0  25351     47
1    116  25318
---- Validation: 
scalar performance:
{'acc': 0.9754716, 'precision': 0.7505999, 'recall': 0.8303299, 'specificity': 0.8303299, 'f1': 0.78451943, 'auroc': 0.9600995, 'binary_precision': 0.5095986, 'binary_recall': 0.6774942, 'binary_specificity': 0.98316556, 'binary_f1_score': 0.5816734}
confusion matrix:
       0    1
0  16411  281
1    139  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91903675, 'precision': 0.72456795, 'recall': 0.8233167, 'specificity': 0.8233167, 'f1': 0.76186913, 'auroc': 0.9277658, 'binary_precision': 0.47359154, 'binary_recall': 0.71070015, 'binary_specificity': 0.9359332, 'binary_f1_score': 0.5684099}
confusion matrix:
      0    1
0  8736  598
1   219  538
early stop counter: 5
val acc:0.9754716157913208, best validation acc: 0.976230800151825, corresponding to test acc:                         0.9233970642089844 / 0.9306312799453735
after epoch: 12,now: 2024-08-06 13:48:49.091176,epoch time: 0:20:35.213266,used: 4:08:04.161621,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99097025, 'precision': 0.9910987, 'recall': 0.99097675, 'specificity': 0.99097675, 'f1': 0.9909697, 'auroc': 0.9997548, 'binary_precision': 0.99924046, 'binary_recall': 0.98270166, 'binary_specificity': 0.99925184, 'binary_f1_score': 0.990902}
confusion matrix:
       0      1
0  25377     19
1    440  24996
---- Validation: 
scalar performance:
{'acc': 0.9804941, 'precision': 0.8017305, 'recall': 0.7990018, 'specificity': 0.7990018, 'f1': 0.8003595, 'auroc': 0.96039796, 'binary_precision': 0.61358315, 'binary_recall': 0.60788864, 'binary_specificity': 0.99011505, 'binary_f1_score': 0.6107226}
confusion matrix:
       0    1
0  16527  165
1    169  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9237935, 'precision': 0.7223744, 'recall': 0.69479007, 'specificity': 0.69479007, 'f1': 0.70739806, 'auroc': 0.91786134, 'binary_precision': 0.49085367, 'binary_recall': 0.42536327, 'binary_specificity': 0.9642168, 'binary_f1_score': 0.45576787}
confusion matrix:
      0    1
0  9000  334
1   435  322
better model found
persisted
after epoch: 13,now: 2024-08-06 14:09:11.969119,epoch time: 0:20:22.877943,used: 4:28:27.039564,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99567205, 'precision': 0.9956933, 'recall': 0.9956751, 'specificity': 0.9956751, 'f1': 0.995672, 'auroc': 0.99987555, 'binary_precision': 0.99916863, 'binary_recall': 0.99217707, 'binary_specificity': 0.99917305, 'binary_f1_score': 0.9956606}
confusion matrix:
       0      1
0  25373     21
1    199  25239
---- Validation: 
scalar performance:
{'acc': 0.9633826, 'precision': 0.6874654, 'recall': 0.8523828, 'specificity': 0.8523828, 'f1': 0.7418835, 'auroc': 0.9382697, 'binary_precision': 0.3819277, 'binary_recall': 0.73549885, 'binary_specificity': 0.9692667, 'binary_f1_score': 0.5027756}
confusion matrix:
       0    1
0  16179  513
1    114  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8976315, 'precision': 0.68937033, 'recall': 0.8257055, 'specificity': 0.8257055, 'f1': 0.73167336, 'auroc': 0.9120288, 'binary_precision': 0.40128756, 'binary_recall': 0.7410832, 'binary_specificity': 0.91032785, 'binary_f1_score': 0.5206497}
confusion matrix:
      0    1
0  8497  837
1   196  561
early stop counter: 1
val acc:0.9633826017379761, best validation acc: 0.9804940819740295, corresponding to test acc:                         0.9237934947013855 / 0.9306312799453735
after epoch: 14,now: 2024-08-06 14:29:48.930181,epoch time: 0:20:36.961062,used: 4:49:04.000626,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9941572, 'precision': 0.99420655, 'recall': 0.9941609, 'specificity': 0.9941609, 'f1': 0.99415714, 'auroc': 0.99977374, 'binary_precision': 0.9993246, 'binary_recall': 0.98899114, 'binary_specificity': 0.99933064, 'binary_f1_score': 0.994131}
confusion matrix:
       0      1
0  25381     17
1    280  25154
---- Validation: 
scalar performance:
{'acc': 0.9764644, 'precision': 0.7584267, 'recall': 0.8285788, 'specificity': 0.8285788, 'f1': 0.7889575, 'auroc': 0.94425344, 'binary_precision': 0.5253623, 'binary_recall': 0.6728538, 'binary_specificity': 0.98430383, 'binary_f1_score': 0.5900305}
confusion matrix:
       0    1
0  16430  262
1    141  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92062235, 'precision': 0.7197243, 'recall': 0.7561971, 'specificity': 0.7561971, 'f1': 0.7360985, 'auroc': 0.9160149, 'binary_precision': 0.47544643, 'binary_recall': 0.5627477, 'binary_specificity': 0.9496465, 'binary_f1_score': 0.5154265}
confusion matrix:
      0    1
0  8864  470
1   331  426
early stop counter: 2
val acc:0.9764643907546997, best validation acc: 0.9804940819740295, corresponding to test acc:                         0.9237934947013855 / 0.9306312799453735
after epoch: 15,now: 2024-08-06 14:50:10.616924,epoch time: 0:20:21.686743,used: 5:09:25.687369,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9954556, 'precision': 0.9954668, 'recall': 0.99545765, 'specificity': 0.99545765, 'f1': 0.9954556, 'auroc': 0.99983114, 'binary_precision': 0.9980241, 'binary_recall': 0.9928841, 'binary_specificity': 0.9980312, 'binary_f1_score': 0.9954475}
confusion matrix:
       0      1
0  25346     50
1    181  25255
---- Validation: 
scalar performance:
{'acc': 0.97897565, 'precision': 0.777302, 'recall': 0.871682, 'specificity': 0.871682, 'f1': 0.81706876, 'auroc': 0.96066177, 'binary_precision': 0.5608919, 'binary_recall': 0.75870067, 'binary_specificity': 0.9846633, 'binary_f1_score': 0.6449704}
confusion matrix:
       0    1
0  16436  256
1    104  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91120803, 'precision': 0.69070286, 'recall': 0.7225822, 'specificity': 0.7225822, 'f1': 0.7049619, 'auroc': 0.9153727, 'binary_precision': 0.4225195, 'binary_recall': 0.5006605, 'binary_specificity': 0.94450396, 'binary_f1_score': 0.45828295}
confusion matrix:
      0    1
0  8816  518
1   378  379
early stop counter: 3
val acc:0.9789756536483765, best validation acc: 0.9804940819740295, corresponding to test acc:                         0.9237934947013855 / 0.9306312799453735
after epoch: 16,now: 2024-08-06 15:10:51.437366,epoch time: 0:20:40.820442,used: 5:30:06.507811,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99494416, 'precision': 0.9949732, 'recall': 0.99494123, 'specificity': 0.99494123, 'f1': 0.994944, 'auroc': 0.99992, 'binary_precision': 0.99137425, 'binary_recall': 0.9985847, 'binary_specificity': 0.99129784, 'binary_f1_score': 0.9949664}
confusion matrix:
       0      1
0  25175    221
1     36  25400
---- Validation: 
scalar performance:
{'acc': 0.95549846, 'precision': 0.66703457, 'recall': 0.88450336, 'specificity': 0.88450336, 'f1': 0.7274202, 'auroc': 0.95376945, 'binary_precision': 0.33916423, 'binary_recall': 0.8097448, 'binary_specificity': 0.9592619, 'binary_f1_score': 0.47808218}
confusion matrix:
       0    1
0  16012  680
1     82  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66683185, 'precision': 0.58157444, 'recall': 0.7810619, 'specificity': 0.7810619, 'f1': 0.5370408, 'auroc': 0.8735384, 'binary_precision': 0.1736407, 'binary_recall': 0.91545576, 'binary_specificity': 0.6466681, 'binary_f1_score': 0.2919124}
confusion matrix:
      0     1
0  6036  3298
1    64   693
early stop counter: 4
val acc:0.955498456954956, best validation acc: 0.9804940819740295, corresponding to test acc:                         0.9237934947013855 / 0.9306312799453735
after epoch: 17,now: 2024-08-06 15:32:17.389685,epoch time: 0:21:25.952319,used: 5:51:32.460130,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9964393, 'precision': 0.9964392, 'recall': 0.9964396, 'specificity': 0.9964396, 'f1': 0.9964392, 'auroc': 0.99990904, 'binary_precision': 0.9968133, 'binary_recall': 0.9960687, 'binary_specificity': 0.9968104, 'binary_f1_score': 0.9964408}
confusion matrix:
       0      1
0  25314     81
1    100  25337
---- Validation: 
scalar performance:
{'acc': 0.9682299, 'precision': 0.69733584, 'recall': 0.7723689, 'specificity': 0.7723689, 'f1': 0.7282448, 'auroc': 0.94558555, 'binary_precision': 0.40599, 'binary_recall': 0.5661253, 'binary_specificity': 0.9786125, 'binary_f1_score': 0.4728682}
confusion matrix:
       0    1
0  16335  357
1    187  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89446044, 'precision': 0.67735815, 'recall': 0.79060996, 'specificity': 0.79060996, 'f1': 0.71420884, 'auroc': 0.8858936, 'binary_precision': 0.38333333, 'binary_recall': 0.668428, 'binary_specificity': 0.91279197, 'binary_f1_score': 0.4872412}
confusion matrix:
      0    1
0  8520  814
1   251  506
early stop counter: 5
val acc:0.9682298898696899, best validation acc: 0.9804940819740295, corresponding to test acc:                         0.9237934947013855 / 0.9306312799453735
after epoch: 18,now: 2024-08-06 15:54:59.486616,epoch time: 0:22:42.096931,used: 6:14:14.557061,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99421626, 'precision': 0.9942775, 'recall': 0.99422026, 'specificity': 0.99422026, 'f1': 0.9942161, 'auroc': 0.99992263, 'binary_precision': 0.99996024, 'binary_recall': 0.98848, 'binary_specificity': 0.9999606, 'binary_f1_score': 0.99418694}
confusion matrix:
       0      1
0  25397      1
1    293  25141
---- Validation: 
scalar performance:
{'acc': 0.976114, 'precision': 0.78524697, 'recall': 0.5808988, 'specificity': 0.5808988, 'f1': 0.6227875, 'auroc': 0.9541716, 'binary_precision': 0.59166664, 'binary_recall': 0.16473317, 'binary_specificity': 0.9970645, 'binary_f1_score': 0.25771326}
confusion matrix:
       0   1
0  16643  49
1    360  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9090279, 'precision': 0.7023893, 'recall': 0.80273294, 'specificity': 0.80273294, 'f1': 0.7387216, 'auroc': 0.9081501, 'binary_precision': 0.43218198, 'binary_recall': 0.677675, 'binary_specificity': 0.9277909, 'binary_f1_score': 0.5277778}
confusion matrix:
      0    1
0  8660  674
1   244  513
early stop counter: 6
val acc:0.9761139750480652, best validation acc: 0.9804940819740295, corresponding to test acc:                         0.9237934947013855 / 0.9306312799453735
after epoch: 19,now: 2024-08-06 16:15:42.799488,epoch time: 0:20:43.312872,used: 6:34:57.869933,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99700975, 'precision': 0.9970108, 'recall': 0.99700934, 'specificity': 0.99700934, 'f1': 0.99700975, 'auroc': 0.9999075, 'binary_precision': 0.99642634, 'binary_recall': 0.9976016, 'binary_specificity': 0.99641705, 'binary_f1_score': 0.9970136}
confusion matrix:
       0      1
0  25307     91
1     61  25373
---- Validation: 
scalar performance:
{'acc': 0.9703907, 'precision': 0.7249327, 'recall': 0.9170048, 'specificity': 0.9170048, 'f1': 0.7893551, 'auroc': 0.9638608, 'binary_precision': 0.45354524, 'binary_recall': 0.8607889, 'binary_specificity': 0.9732207, 'binary_f1_score': 0.59407526}
confusion matrix:
       0    1
0  16245  447
1     60  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88524425, 'precision': 0.68211216, 'recall': 0.860888, 'specificity': 0.860888, 'f1': 0.7279519, 'auroc': 0.8984292, 'binary_precision': 0.3792896, 'binary_recall': 0.8322325, 'binary_specificity': 0.8895436, 'binary_f1_score': 0.52109176}
confusion matrix:
      0     1
0  8303  1031
1   127   630
early stop counter: 7
val acc:0.9703906774520874, best validation acc: 0.9804940819740295, corresponding to test acc:                         0.9237934947013855 / 0.9306312799453735
after epoch: 20,now: 2024-08-06 16:37:12.137572,epoch time: 0:21:29.338084,used: 6:56:27.208017,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_40_44_seed_1_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:56:27.208017 at 2024-08-06 16:37:12.137572
persisted model performance metric: 

scalar performance:
{'acc': 0.9237935, 'precision': 0.7223744, 'recall': 0.69479007, 'specificity': 0.69479007, 'f1': 0.70739806, 'auroc': 0.91786134, 'binary_precision': 0.49085367, 'binary_recall': 0.42536327, 'binary_specificity': 0.9642168, 'binary_f1_score': 0.45576787}
confusion matrix:
      0    1
0  9000  334
1   435  322
oracle model performance metric: 

scalar performance:
{'acc': 0.9306313, 'precision': 0.7510409, 'recall': 0.7051625, 'specificity': 0.7051625, 'f1': 0.7251762, 'auroc': 0.9259972, 'binary_precision': 0.54679805, 'binary_recall': 0.43989432, 'binary_specificity': 0.9704307, 'binary_f1_score': 0.4875549}
confusion matrix:
      0    1
0  9058  276
1   424  333
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |  40858 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  28102 MiB |  13630 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  28014 MiB |  13608 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool | 455249 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |  10843 KiB |     42 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7359    |  216546 K  |  216541 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112785 K  |  112780 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7359    |  216546 K  |  216541 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112785 K  |  112780 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1212    |     577    |
|       from large pool |     602    |     602    |    1168    |     566    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    3240    |  127823 K  |  127823 K  |
|       from large pool |      36    |     605    |   73199 K  |   73199 K  |
|       from small pool |      42    |    3204    |   54624 K  |   54624 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     46 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3240    |  127825 K  |  127825 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3204    |   54626 K  |   54626 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     46 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3240    |  127825 K  |  127825 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3204    |   54626 K  |   54626 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673

 Experiment start at: 2024-08-06 17:03:26.887826
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97645855, 'precision': 0.9770889, 'recall': 0.97646064, 'specificity': 0.97646064, 'f1': 0.9764508, 'auroc': 0.9971334, 'binary_precision': 0.99446005, 'binary_recall': 0.9582608, 'binary_specificity': 0.9946605, 'binary_f1_score': 0.9760248}
confusion matrix:
       0      1
0  25707    138
1   1079  24772
---- Validation: 
scalar performance:
{'acc': 0.9464494, 'precision': 0.6323298, 'recall': 0.8326056, 'specificity': 0.8326056, 'f1': 0.68295324, 'auroc': 0.919729, 'binary_precision': 0.2721461, 'binary_recall': 0.71291864, 'binary_specificity': 0.95229256, 'binary_f1_score': 0.39391935}
confusion matrix:
       0    1
0  15909  797
1    120  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87792313, 'precision': 0.67509663, 'recall': 0.8345019, 'specificity': 0.8345019, 'f1': 0.7168186, 'auroc': 0.9058579, 'binary_precision': 0.3707665, 'binary_recall': 0.78293604, 'binary_specificity': 0.8860678, 'binary_f1_score': 0.50322586}
confusion matrix:
      0     1
0  8236  1059
1   173   624
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 17:26:18.657168,epoch time: 0:22:51.769342,used: 0:22:51.769342,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9902507, 'precision': 0.99025816, 'recall': 0.99025023, 'specificity': 0.99025023, 'f1': 0.9902507, 'auroc': 0.99928606, 'binary_precision': 0.98840165, 'binary_recall': 0.9921482, 'binary_specificity': 0.9883523, 'binary_f1_score': 0.99027145}
confusion matrix:
       0      1
0  25541    301
1    203  25651
---- Validation: 
scalar performance:
{'acc': 0.9400257, 'precision': 0.6196414, 'recall': 0.8281472, 'specificity': 0.8281472, 'f1': 0.6674817, 'auroc': 0.9178263, 'binary_precision': 0.2468828, 'binary_recall': 0.7105263, 'binary_specificity': 0.945768, 'binary_f1_score': 0.36644047}
confusion matrix:
       0    1
0  15800  906
1    121  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.930539, 'precision': 0.7979797, 'recall': 0.62044966, 'specificity': 0.62044966, 'f1': 0.6638613, 'auroc': 0.8890314, 'binary_precision': 0.65686274, 'binary_recall': 0.25219575, 'binary_specificity': 0.9887036, 'binary_f1_score': 0.3644606}
confusion matrix:
      0    1
0  9190  105
1   596  201
new oracle model saved
early stop counter: 1
val acc:0.9400256872177124, best validation acc: 0.9464493989944458, corresponding to test acc:                         0.8779231309890747 / 0.9305390119552612
after epoch: 2,now: 2024-08-06 17:47:37.841568,epoch time: 0:21:19.184400,used: 0:44:10.953742,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99156606, 'precision': 0.99156606, 'recall': 0.99156606, 'specificity': 0.99156606, 'f1': 0.99156606, 'auroc': 0.9993924, 'binary_precision': 0.9916064, 'binary_recall': 0.9915297, 'binary_specificity': 0.9916025, 'binary_f1_score': 0.991568}
confusion matrix:
       0      1
0  25624    217
1    219  25636
---- Validation: 
scalar performance:
{'acc': 0.96075684, 'precision': 0.67362773, 'recall': 0.85160077, 'specificity': 0.85160077, 'f1': 0.72893625, 'auroc': 0.9334948, 'binary_precision': 0.35402298, 'binary_recall': 0.7368421, 'binary_specificity': 0.9663594, 'binary_f1_score': 0.47826084}
confusion matrix:
       0    1
0  16144  562
1    110  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9240983, 'precision': 0.7398449, 'recall': 0.7546076, 'specificity': 0.7546076, 'f1': 0.74693453, 'auroc': 0.9021714, 'binary_precision': 0.51821387, 'binary_recall': 0.553325, 'binary_specificity': 0.95589024, 'binary_f1_score': 0.53519416}
confusion matrix:
      0    1
0  8885  410
1   356  441
better model found
persisted
after epoch: 3,now: 2024-08-06 18:08:20.301516,epoch time: 0:20:42.459948,used: 1:04:53.413690,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99435157, 'precision': 0.99435174, 'recall': 0.9943516, 'specificity': 0.9943516, 'f1': 0.9943516, 'auroc': 0.9997364, 'binary_precision': 0.9946197, 'binary_recall': 0.994081, 'binary_specificity': 0.9946222, 'binary_f1_score': 0.99435025}
confusion matrix:
       0      1
0  25708    139
1    153  25696
---- Validation: 
scalar performance:
{'acc': 0.96747255, 'precision': 0.7032519, 'recall': 0.876035, 'specificity': 0.876035, 'f1': 0.76121485, 'auroc': 0.9542895, 'binary_precision': 0.41213652, 'binary_recall': 0.7799043, 'binary_specificity': 0.9721657, 'binary_f1_score': 0.53928864}
confusion matrix:
       0    1
0  16241  465
1     92  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.910325, 'precision': 0.7194254, 'recall': 0.8469299, 'specificity': 0.8469299, 'f1': 0.7629856, 'auroc': 0.9075168, 'binary_precision': 0.45964125, 'binary_recall': 0.77164364, 'binary_specificity': 0.92221624, 'binary_f1_score': 0.57611245}
confusion matrix:
      0    1
0  8572  723
1   182  615
better model found
persisted
after epoch: 4,now: 2024-08-06 18:30:16.275025,epoch time: 0:21:55.973509,used: 1:26:49.387199,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99313295, 'precision': 0.99320054, 'recall': 0.993135, 'specificity': 0.993135, 'f1': 0.9931327, 'auroc': 0.9996584, 'binary_precision': 0.9990607, 'binary_recall': 0.9871988, 'binary_specificity': 0.9990712, 'binary_f1_score': 0.9930944}
confusion matrix:
       0      1
0  25815     24
1    331  25526
---- Validation: 
scalar performance:
{'acc': 0.9745387, 'precision': 0.7338688, 'recall': 0.7502035, 'specificity': 0.7502035, 'f1': 0.74173737, 'auroc': 0.9375882, 'binary_precision': 0.4799107, 'binary_recall': 0.51435405, 'binary_specificity': 0.98605293, 'binary_f1_score': 0.49653578}
confusion matrix:
       0    1
0  16473  233
1    203  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.913694, 'precision': 0.63082784, 'recall': 0.5390364, 'specificity': 0.5390364, 'f1': 0.5507313, 'auroc': 0.8217245, 'binary_precision': 0.33482143, 'binary_recall': 0.09410289, 'binary_specificity': 0.98396987, 'binary_f1_score': 0.1469148}
confusion matrix:
      0    1
0  9146  149
1   722   75
better model found
persisted
after epoch: 5,now: 2024-08-06 18:51:51.420039,epoch time: 0:21:35.145014,used: 1:48:24.532213,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99139196, 'precision': 0.99140537, 'recall': 0.991392, 'specificity': 0.991392, 'f1': 0.9913919, 'auroc': 0.99919015, 'binary_precision': 0.99397194, 'binary_recall': 0.98878056, 'binary_specificity': 0.9940034, 'binary_f1_score': 0.9913694}
confusion matrix:
       0      1
0  25693    155
1    290  25558
---- Validation: 
scalar performance:
{'acc': 0.9398505, 'precision': 0.61150277, 'recall': 0.79190385, 'specificity': 0.79190385, 'f1': 0.6545385, 'auroc': 0.90754324, 'binary_precision': 0.23251748, 'binary_recall': 0.6363636, 'binary_specificity': 0.947444, 'binary_f1_score': 0.340589}
confusion matrix:
       0    1
0  15828  878
1    152  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8943718, 'precision': 0.67935187, 'recall': 0.76886857, 'specificity': 0.76886857, 'f1': 0.7111075, 'auroc': 0.8760061, 'binary_precision': 0.3929992, 'binary_recall': 0.61982435, 'binary_specificity': 0.91791284, 'binary_f1_score': 0.48101264}
confusion matrix:
      0    1
0  8532  763
1   303  494
early stop counter: 1
val acc:0.9398505091667175, best validation acc: 0.9745386838912964, corresponding to test acc:                         0.9136940240859985 / 0.9305390119552612
after epoch: 6,now: 2024-08-06 19:13:06.688948,epoch time: 0:21:15.268909,used: 2:09:39.801122,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9829581, 'precision': 0.9831236, 'recall': 0.982957, 'specificity': 0.982957, 'f1': 0.98295665, 'auroc': 0.99918103, 'binary_precision': 0.97420996, 'binary_recall': 0.992186, 'binary_specificity': 0.973728, 'binary_f1_score': 0.98311585}
confusion matrix:
       0      1
0  25166    679
1    202  25649
---- Validation: 
scalar performance:
{'acc': 0.9727283, 'precision': 0.7184636, 'recall': 0.7504419, 'specificity': 0.7504419, 'f1': 0.7332653, 'auroc': 0.92613006, 'binary_precision': 0.44906446, 'binary_recall': 0.5167464, 'binary_specificity': 0.9841374, 'binary_f1_score': 0.48053393}
confusion matrix:
       0    1
0  16441  265
1    202  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8924891, 'precision': 0.6885855, 'recall': 0.8211876, 'specificity': 0.8211876, 'f1': 0.72958446, 'auroc': 0.8896657, 'binary_precision': 0.40150478, 'binary_recall': 0.73651195, 'binary_specificity': 0.90586334, 'binary_f1_score': 0.519699}
confusion matrix:
      0    1
0  8420  875
1   210  587
early stop counter: 2
val acc:0.9727283120155334, best validation acc: 0.9745386838912964, corresponding to test acc:                         0.9136940240859985 / 0.9305390119552612
after epoch: 7,now: 2024-08-06 19:34:58.821182,epoch time: 0:21:52.132234,used: 2:31:31.933356,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9869236, 'precision': 0.98705, 'recall': 0.9869232, 'specificity': 0.9869232, 'f1': 0.98692274, 'auroc': 0.9994674, 'binary_precision': 0.97921187, 'binary_recall': 0.9949708, 'binary_specificity': 0.9788757, 'binary_f1_score': 0.9870285}
confusion matrix:
       0      1
0  25301    546
1    130  25719
---- Validation: 
scalar performance:
{'acc': 0.87123334, 'precision': 0.5696388, 'recall': 0.8651974, 'specificity': 0.8651974, 'f1': 0.5876235, 'auroc': 0.93125933, 'binary_precision': 0.14331338, 'binary_recall': 0.8588517, 'binary_specificity': 0.87154317, 'binary_f1_score': 0.24563804}
confusion matrix:
       0     1
0  14560  2146
1     59   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8450258, 'precision': 0.6525049, 'recall': 0.84876215, 'specificity': 0.84876215, 'f1': 0.6872511, 'auroc': 0.9008107, 'binary_precision': 0.3196991, 'binary_recall': 0.8531995, 'binary_specificity': 0.8443249, 'binary_f1_score': 0.46511632}
confusion matrix:
      0     1
0  7848  1447
1   117   680
early stop counter: 3
val acc:0.871233344078064, best validation acc: 0.9745386838912964, corresponding to test acc:                         0.9136940240859985 / 0.9305390119552612
after epoch: 8,now: 2024-08-06 19:56:33.003103,epoch time: 0:21:34.181921,used: 2:53:06.115277,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99355847, 'precision': 0.9935686, 'recall': 0.99355817, 'specificity': 0.99355817, 'f1': 0.99355847, 'auroc': 0.9997009, 'binary_precision': 0.99137366, 'binary_recall': 0.9957837, 'binary_specificity': 0.9913326, 'binary_f1_score': 0.9935738}
confusion matrix:
       0      1
0  25620    224
1    109  25743
---- Validation: 
scalar performance:
{'acc': 0.9431792, 'precision': 0.6383299, 'recall': 0.89740545, 'specificity': 0.89740545, 'f1': 0.69599354, 'auroc': 0.9524578, 'binary_precision': 0.2806324, 'binary_recall': 0.8492823, 'binary_specificity': 0.94552857, 'binary_f1_score': 0.4218657}
confusion matrix:
       0    1
0  15796  910
1     63  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9017043, 'precision': 0.6990951, 'recall': 0.80898356, 'specificity': 0.80898356, 'f1': 0.73704576, 'auroc': 0.87975, 'binary_precision': 0.42551565, 'binary_recall': 0.6988708, 'binary_specificity': 0.9190963, 'binary_f1_score': 0.5289648}
confusion matrix:
      0    1
0  8543  752
1   240  557
early stop counter: 4
val acc:0.943179190158844, best validation acc: 0.9745386838912964, corresponding to test acc:                         0.9136940240859985 / 0.9305390119552612
after epoch: 9,now: 2024-08-06 20:17:29.839871,epoch time: 0:20:56.836768,used: 3:14:02.952045,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9945837, 'precision': 0.99458385, 'recall': 0.9945837, 'specificity': 0.9945837, 'f1': 0.9945837, 'auroc': 0.9996817, 'binary_precision': 0.99481386, 'binary_recall': 0.99435204, 'binary_specificity': 0.99481547, 'binary_f1_score': 0.9945829}
confusion matrix:
       0      1
0  25712    134
1    146  25704
---- Validation: 
scalar performance:
{'acc': 0.97728336, 'precision': 0.7596576, 'recall': 0.81925225, 'specificity': 0.81925225, 'f1': 0.7861401, 'auroc': 0.9544885, 'binary_precision': 0.5280464, 'binary_recall': 0.65311, 'binary_specificity': 0.9853945, 'binary_f1_score': 0.58395725}
confusion matrix:
       0    1
0  16462  244
1    145  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9094332, 'precision': 0.7175304, 'recall': 0.8441516, 'specificity': 0.8441516, 'f1': 0.76072735, 'auroc': 0.91464114, 'binary_precision': 0.4563107, 'binary_recall': 0.76662487, 'binary_specificity': 0.9216783, 'binary_f1_score': 0.5720974}
confusion matrix:
      0    1
0  8567  728
1   186  611
better model found
persisted
after epoch: 10,now: 2024-08-06 20:38:54.579949,epoch time: 0:21:24.740078,used: 3:35:27.692123,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99119854, 'precision': 0.9912828, 'recall': 0.99119985, 'specificity': 0.99119985, 'f1': 0.9911982, 'auroc': 0.99967915, 'binary_precision': 0.9977658, 'binary_recall': 0.98460525, 'binary_specificity': 0.9977944, 'binary_f1_score': 0.9911418}
confusion matrix:
       0      1
0  25786     57
1    398  25455
---- Validation: 
scalar performance:
{'acc': 0.97804254, 'precision': 0.812376, 'recall': 0.61088383, 'specificity': 0.61088383, 'f1': 0.6610854, 'auroc': 0.9568224, 'binary_precision': 0.6438356, 'binary_recall': 0.22488038, 'binary_specificity': 0.9968873, 'binary_f1_score': 0.33333334}
confusion matrix:
       0   1
0  16654  52
1    324  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92826, 'precision': 0.7584006, 'recall': 0.67771554, 'specificity': 0.67771554, 'f1': 0.70861936, 'auroc': 0.9135796, 'binary_precision': 0.5684803, 'binary_recall': 0.38017565, 'binary_specificity': 0.9752555, 'binary_f1_score': 0.4556391}
confusion matrix:
      0    1
0  9065  230
1   494  303
better model found
persisted
after epoch: 11,now: 2024-08-06 20:59:52.160379,epoch time: 0:20:57.580430,used: 3:56:25.272553,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.996286, 'precision': 0.99628776, 'recall': 0.9962859, 'specificity': 0.9962859, 'f1': 0.996286, 'auroc': 0.99991024, 'binary_precision': 0.99536645, 'binary_recall': 0.9972147, 'binary_specificity': 0.9953571, 'binary_f1_score': 0.99628973}
confusion matrix:
       0      1
0  25726    120
1     72  25778
---- Validation: 
scalar performance:
{'acc': 0.97926885, 'precision': 0.77440023, 'recall': 0.87391704, 'specificity': 0.87391704, 'f1': 0.81591123, 'auroc': 0.96453524, 'binary_precision': 0.5547826, 'binary_recall': 0.7631579, 'binary_specificity': 0.9846762, 'binary_f1_score': 0.64249754}
confusion matrix:
       0    1
0  16450  256
1     99  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9119104, 'precision': 0.70966685, 'recall': 0.7646244, 'specificity': 0.7646244, 'f1': 0.7327542, 'auroc': 0.8957758, 'binary_precision': 0.45542637, 'binary_recall': 0.5897114, 'binary_specificity': 0.9395374, 'binary_f1_score': 0.51394206}
confusion matrix:
      0    1
0  8733  562
1   327  470
better model found
persisted
after epoch: 12,now: 2024-08-06 21:21:04.647290,epoch time: 0:21:12.486911,used: 4:17:37.759464,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99394536, 'precision': 0.9940005, 'recall': 0.9939462, 'specificity': 0.9939462, 'f1': 0.9939452, 'auroc': 0.999818, 'binary_precision': 0.99925715, 'binary_recall': 0.98862755, 'binary_specificity': 0.99926484, 'binary_f1_score': 0.9939139}
confusion matrix:
       0      1
0  25825     19
1    294  25558
---- Validation: 
scalar performance:
{'acc': 0.9753562, 'precision': 0.740064, 'recall': 0.7074715, 'specificity': 0.7074715, 'f1': 0.7224876, 'auroc': 0.94732237, 'binary_precision': 0.49444443, 'binary_recall': 0.4258373, 'binary_specificity': 0.9891057, 'binary_f1_score': 0.45758352}
confusion matrix:
       0    1
0  16524  182
1    240  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91567576, 'precision': 0.71406996, 'recall': 0.73569626, 'specificity': 0.73569626, 'f1': 0.7241789, 'auroc': 0.8938749, 'binary_precision': 0.46952596, 'binary_recall': 0.52195734, 'binary_specificity': 0.9494352, 'binary_f1_score': 0.49435532}
confusion matrix:
      0    1
0  8825  470
1   381  416
early stop counter: 1
val acc:0.9753562211990356, best validation acc: 0.9792688488960266, corresponding to test acc:                         0.9119104146957397 / 0.9305390119552612
after epoch: 13,now: 2024-08-06 21:45:50.415386,epoch time: 0:24:45.768096,used: 4:42:23.527560,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99377126, 'precision': 0.9937724, 'recall': 0.9937713, 'specificity': 0.9937713, 'f1': 0.99377126, 'auroc': 0.99967885, 'binary_precision': 0.99449825, 'binary_recall': 0.9930362, 'binary_specificity': 0.99450636, 'binary_f1_score': 0.99376667}
confusion matrix:
       0      1
0  25706    142
1    180  25668
---- Validation: 
scalar performance:
{'acc': 0.9784513, 'precision': 0.7730907, 'recall': 0.7813648, 'specificity': 0.7813648, 'f1': 0.77716136, 'auroc': 0.96015596, 'binary_precision': 0.55684453, 'binary_recall': 0.57416266, 'binary_specificity': 0.988567, 'binary_f1_score': 0.56537104}
confusion matrix:
       0    1
0  16515  191
1    178  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91111773, 'precision': 0.7104777, 'recall': 0.7796802, 'specificity': 0.7796802, 'f1': 0.7383063, 'auroc': 0.9039458, 'binary_precision': 0.45429617, 'binary_recall': 0.62358844, 'binary_specificity': 0.93577194, 'binary_f1_score': 0.52564776}
confusion matrix:
      0    1
0  8698  597
1   300  497
early stop counter: 2
val acc:0.9784513115882874, best validation acc: 0.9792688488960266, corresponding to test acc:                         0.9119104146957397 / 0.9305390119552612
after epoch: 14,now: 2024-08-06 22:09:55.138915,epoch time: 0:24:04.723529,used: 5:06:28.251089,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99676955, 'precision': 0.9967697, 'recall': 0.99676955, 'specificity': 0.99676955, 'f1': 0.99676955, 'auroc': 0.99992204, 'binary_precision': 0.9965591, 'binary_recall': 0.99698305, 'binary_specificity': 0.996556, 'binary_f1_score': 0.996771}
confusion matrix:
       0      1
0  25753     89
1     78  25776
---- Validation: 
scalar performance:
{'acc': 0.96671337, 'precision': 0.70193315, 'recall': 0.8919733, 'specificity': 0.8919733, 'f1': 0.7633631, 'auroc': 0.9544027, 'binary_precision': 0.40865386, 'binary_recall': 0.8133971, 'binary_specificity': 0.9705495, 'binary_f1_score': 0.544}
confusion matrix:
       0    1
0  16214  492
1     78  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121086, 'precision': 0.70782304, 'recall': 0.75096655, 'specificity': 0.75096655, 'f1': 0.7266059, 'auroc': 0.90139, 'binary_precision': 0.45417514, 'binary_recall': 0.5595985, 'binary_specificity': 0.9423346, 'binary_f1_score': 0.50140524}
confusion matrix:
      0    1
0  8759  536
1   351  446
early stop counter: 3
val acc:0.9667133688926697, best validation acc: 0.9792688488960266, corresponding to test acc:                         0.9119104146957397 / 0.9305390119552612
after epoch: 15,now: 2024-08-06 22:32:29.426503,epoch time: 0:22:34.287588,used: 5:29:02.538677,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99512535, 'precision': 0.9951457, 'recall': 0.99512494, 'specificity': 0.99512494, 'f1': 0.9951253, 'auroc': 0.99989974, 'binary_precision': 0.99200463, 'binary_recall': 0.9982979, 'binary_specificity': 0.991952, 'binary_f1_score': 0.9951413}
confusion matrix:
       0      1
0  25637    208
1     44  25807
---- Validation: 
scalar performance:
{'acc': 0.95334035, 'precision': 0.65996146, 'recall': 0.89794815, 'specificity': 0.89794815, 'f1': 0.7216445, 'auroc': 0.95992124, 'binary_precision': 0.32409972, 'binary_recall': 0.8397129, 'binary_specificity': 0.95618343, 'binary_f1_score': 0.4676882}
confusion matrix:
       0    1
0  15974  732
1     67  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5534086, 'precision': 0.56682587, 'recall': 0.7294533, 'specificity': 0.7294533, 'f1': 0.46569452, 'auroc': 0.88577604, 'binary_precision': 0.14368036, 'binary_recall': 0.9385194, 'binary_specificity': 0.5203873, 'binary_f1_score': 0.2492087}
confusion matrix:
      0     1
0  4837  4458
1    49   748
early stop counter: 4
val acc:0.9533403515815735, best validation acc: 0.9792688488960266, corresponding to test acc:                         0.9119104146957397 / 0.9305390119552612
after epoch: 16,now: 2024-08-06 22:53:55.634297,epoch time: 0:21:26.207794,used: 5:50:28.746471,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99535745, 'precision': 0.9953581, 'recall': 0.9953576, 'specificity': 0.9953576, 'f1': 0.9953575, 'auroc': 0.9997751, 'binary_precision': 0.9959723, 'binary_recall': 0.9947395, 'binary_specificity': 0.9959757, 'binary_f1_score': 0.9953555}
confusion matrix:
       0      1
0  25739    104
1    136  25717
---- Validation: 
scalar performance:
{'acc': 0.97494745, 'precision': 0.7373893, 'recall': 0.7445818, 'specificity': 0.7445818, 'f1': 0.74092746, 'auroc': 0.9483229, 'binary_precision': 0.48723897, 'binary_recall': 0.50239235, 'binary_specificity': 0.9867712, 'binary_f1_score': 0.49469966}
confusion matrix:
       0    1
0  16485  221
1    208  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73246133, 'precision': 0.5510962, 'recall': 0.639102, 'specificity': 0.639102, 'f1': 0.53773934, 'auroc': 0.7217264, 'binary_precision': 0.15336977, 'binary_recall': 0.52823085, 'binary_specificity': 0.7499731, 'binary_f1_score': 0.23771879}
confusion matrix:
      0     1
0  6971  2324
1   376   421
early stop counter: 5
val acc:0.974947452545166, best validation acc: 0.9792688488960266, corresponding to test acc:                         0.9119104146957397 / 0.9305390119552612
after epoch: 17,now: 2024-08-06 23:15:06.547424,epoch time: 0:21:10.913127,used: 6:11:39.659598,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9888579, 'precision': 0.9891004, 'recall': 0.98885834, 'specificity': 0.98885834, 'f1': 0.98885655, 'auroc': 0.99989647, 'binary_precision': 1.0, 'binary_recall': 0.97771674, 'binary_specificity': 1.0, 'binary_f1_score': 0.9887329}
confusion matrix:
       0      1
0  25847      0
1    576  25273
---- Validation: 
scalar performance:
{'acc': 0.97266996, 'precision': 0.59624404, 'recall': 0.5206621, 'specificity': 0.5206621, 'f1': 0.53061444, 'auroc': 0.93975955, 'binary_precision': 0.2159091, 'binary_recall': 0.045454547, 'binary_specificity': 0.99586976, 'binary_f1_score': 0.07509882}
confusion matrix:
       0   1
0  16637  69
1    399  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9205311, 'precision': 0.73257595, 'recall': 0.78823185, 'specificity': 0.78823185, 'f1': 0.75638604, 'auroc': 0.884957, 'binary_precision': 0.4975272, 'binary_recall': 0.6311167, 'binary_specificity': 0.94534695, 'binary_f1_score': 0.5564159}
confusion matrix:
      0    1
0  8787  508
1   294  503
early stop counter: 6
val acc:0.9726699590682983, best validation acc: 0.9792688488960266, corresponding to test acc:                         0.9119104146957397 / 0.9305390119552612
after epoch: 18,now: 2024-08-06 23:36:31.981989,epoch time: 0:21:25.434565,used: 6:33:05.094163,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9889353, 'precision': 0.98903143, 'recall': 0.988934, 'specificity': 0.988934, 'f1': 0.98893476, 'auroc': 0.99966824, 'binary_precision': 0.98222256, 'binary_recall': 0.9958999, 'binary_specificity': 0.98196805, 'binary_f1_score': 0.98901397}
confusion matrix:
       0      1
0  25377    466
1    106  25747
---- Validation: 
scalar performance:
{'acc': 0.95573467, 'precision': 0.6321258, 'recall': 0.73590124, 'specificity': 0.73590124, 'f1': 0.6673523, 'auroc': 0.9278469, 'binary_precision': 0.27690288, 'binary_recall': 0.5047847, 'binary_specificity': 0.9670178, 'binary_f1_score': 0.3576271}
confusion matrix:
       0    1
0  16155  551
1    207  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87425685, 'precision': 0.65080076, 'recall': 0.75508094, 'specificity': 0.75508094, 'f1': 0.6822497, 'auroc': 0.8593437, 'binary_precision': 0.33724138, 'binary_recall': 0.61355084, 'binary_specificity': 0.8966111, 'binary_f1_score': 0.43524703}
confusion matrix:
      0    1
0  8334  961
1   308  489
early stop counter: 7
val acc:0.9557346701622009, best validation acc: 0.9792688488960266, corresponding to test acc:                         0.9119104146957397 / 0.9305390119552612
after epoch: 19,now: 2024-08-07 00:01:08.282893,epoch time: 0:24:36.300904,used: 6:57:41.395067,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99357784, 'precision': 0.9936274, 'recall': 0.9935775, 'specificity': 0.9935775, 'f1': 0.9935777, 'auroc': 0.99986744, 'binary_precision': 0.9887008, 'binary_recall': 0.99856865, 'binary_specificity': 0.98858625, 'binary_f1_score': 0.99361026}
confusion matrix:
       0      1
0  25551    295
1     37  25813
---- Validation: 
scalar performance:
{'acc': 0.92221445, 'precision': 0.6098995, 'recall': 0.901822, 'specificity': 0.901822, 'f1': 0.6572536, 'auroc': 0.94644237, 'binary_precision': 0.2230303, 'binary_recall': 0.8803828, 'binary_specificity': 0.9232611, 'binary_f1_score': 0.3558994}
confusion matrix:
       0     1
0  15424  1282
1     50   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84423304, 'precision': 0.6397637, 'recall': 0.8024471, 'specificity': 0.8024471, 'f1': 0.6713089, 'auroc': 0.8675034, 'binary_precision': 0.30379745, 'binary_recall': 0.7528231, 'binary_specificity': 0.852071, 'binary_f1_score': 0.43290043}
confusion matrix:
      0     1
0  7920  1375
1   197   600
early stop counter: 8
val acc:0.9222144484519958, best validation acc: 0.9792688488960266, corresponding to test acc:                         0.9119104146957397 / 0.9305390119552612
after epoch: 20,now: 2024-08-07 00:24:13.822075,epoch time: 0:23:05.539182,used: 7:20:46.934249,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_17_03_26_seed_2_24076673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 7:20:46.934249 at 2024-08-07 00:24:13.822075
persisted model performance metric: 

scalar performance:
{'acc': 0.9119104, 'precision': 0.70966685, 'recall': 0.7646244, 'specificity': 0.7646244, 'f1': 0.7327542, 'auroc': 0.8957758, 'binary_precision': 0.45542637, 'binary_recall': 0.5897114, 'binary_specificity': 0.9395374, 'binary_f1_score': 0.51394206}
confusion matrix:
      0    1
0  8733  562
1   327  470
oracle model performance metric: 

scalar performance:
{'acc': 0.930539, 'precision': 0.7979797, 'recall': 0.62044966, 'specificity': 0.62044966, 'f1': 0.6638613, 'auroc': 0.8890314, 'binary_precision': 0.65686274, 'binary_recall': 0.25219575, 'binary_specificity': 0.9887036, 'binary_f1_score': 0.3644606}
confusion matrix:
      0    1
0  9190  105
1   596  201
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |  40858 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  41672 MiB |  27200 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  41570 MiB |  27164 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool | 455249 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |  10843 KiB |     46 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7467    |  329279 K  |  329274 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158242 K  |
|       from small pool |    4735    |    7278    |  171036 K  |  171032 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7467    |  329279 K  |  329274 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158242 K  |
|       from small pool |    4735    |    7278    |  171036 K  |  171032 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1783    |    1148    |
|       from large pool |     602    |     602    |    1732    |    1130    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3292    |  193421 K  |  193421 K  |
|       from large pool |      36    |     605    |  110448 K  |  110448 K  |
|       from small pool |      41    |    3256    |   82972 K  |   82972 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |      0 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  41672 MiB |  40770 MiB |
|       from large pool |    850 MiB |  14412 MiB |  41570 MiB |  40720 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool |  24320 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |      0 KiB |     46 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7467    |  329279 K  |  329279 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171036 K  |  171036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7467    |  329279 K  |  329279 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171036 K  |  171036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1783    |    1719    |
|       from large pool |      38    |     602    |    1732    |    1694    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3292    |  193423 K  |  193423 K  |
|       from large pool |       3    |     605    |  110448 K  |  110448 K  |
|       from small pool |       0    |    3256    |   82974 K  |   82974 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 00:42:59 2024]
Finished job 0.
1 of 1 steps (100%) done
