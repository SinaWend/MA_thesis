Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:57 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/12.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=12
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669

 Experiment start at: 2024-08-06 02:34:45.390445
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8630567, 'precision': 0.87153494, 'recall': 0.8631014, 'specificity': 0.8631014, 'f1': 0.86228126, 'auroc': 0.9189513, 'binary_precision': 0.92780775, 'binary_recall': 0.78755474, 'binary_specificity': 0.9386481, 'binary_f1_score': 0.8519475}
confusion matrix:
       0      1
0  23760   1553
1   5384  19959
---- Validation: 
scalar performance:
{'acc': 0.88236326, 'precision': 0.52766997, 'recall': 0.6142658, 'specificity': 0.6142658, 'f1': 0.5286666, 'auroc': 0.7472738, 'binary_precision': 0.07348243, 'binary_recall': 0.3325301, 'binary_specificity': 0.89600146, 'binary_f1_score': 0.12036634}
confusion matrix:
       0     1
0  14991  1740
1    277   138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7855448, 'precision': 0.52444637, 'recall': 0.55118924, 'specificity': 0.55118924, 'f1': 0.5202615, 'auroc': 0.6664756, 'binary_precision': 0.11641955, 'binary_recall': 0.2746114, 'binary_specificity': 0.8277671, 'binary_f1_score': 0.16351716}
confusion matrix:
      0     1
0  7733  1609
1   560   212
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 02:56:07.523772,epoch time: 0:21:22.133327,used: 0:21:22.133327,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90936905, 'precision': 0.91563165, 'recall': 0.90940547, 'specificity': 0.90940547, 'f1': 0.9090317, 'auroc': 0.9621234, 'binary_precision': 0.9667986, 'binary_recall': 0.8479659, 'binary_specificity': 0.97084504, 'binary_f1_score': 0.9034916}
confusion matrix:
       0      1
0  24575    738
1   3853  21490
---- Validation: 
scalar performance:
{'acc': 0.84346205, 'precision': 0.5342281, 'recall': 0.69302726, 'specificity': 0.69302726, 'f1': 0.52790934, 'auroc': 0.79404783, 'binary_precision': 0.08182824, 'binary_recall': 0.53493977, 'binary_specificity': 0.8511147, 'binary_f1_score': 0.14194374}
confusion matrix:
       0     1
0  14240  2491
1    193   222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7390745, 'precision': 0.5551309, 'recall': 0.6537756, 'specificity': 0.6537756, 'f1': 0.5433977, 'auroc': 0.7320955, 'binary_precision': 0.1569276, 'binary_recall': 0.5531088, 'binary_specificity': 0.7544423, 'binary_f1_score': 0.244489}
confusion matrix:
      0     1
0  7048  2294
1   345   427
early stop counter: 1
val acc:0.8434620499610901, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 2,now: 2024-08-06 03:14:58.523117,epoch time: 0:18:50.999345,used: 0:40:13.132672,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92107546, 'precision': 0.9266275, 'recall': 0.9211116, 'specificity': 0.9211116, 'f1': 0.9208224, 'auroc': 0.97193325, 'binary_precision': 0.9754544, 'binary_recall': 0.8639915, 'binary_specificity': 0.97823167, 'binary_f1_score': 0.91634583}
confusion matrix:
       0      1
0  24761    551
1   3447  21897
---- Validation: 
scalar performance:
{'acc': 0.8459699, 'precision': 0.5425034, 'recall': 0.74248457, 'specificity': 0.74248457, 'f1': 0.5406182, 'auroc': 0.82727516, 'binary_precision': 0.09556686, 'binary_recall': 0.63373494, 'binary_specificity': 0.85123426, 'binary_f1_score': 0.16608778}
confusion matrix:
       0     1
0  14242  2489
1    152   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7346253, 'precision': 0.57222354, 'recall': 0.71256423, 'specificity': 0.71256423, 'f1': 0.5601476, 'auroc': 0.7791442, 'binary_precision': 0.17833109, 'binary_recall': 0.6865285, 'binary_specificity': 0.7385999, 'binary_f1_score': 0.28311968}
confusion matrix:
      0     1
0  6900  2442
1   242   530
early stop counter: 2
val acc:0.8459699153900146, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 3,now: 2024-08-06 03:32:55.058839,epoch time: 0:17:56.535722,used: 0:58:09.668394,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93015635, 'precision': 0.9343842, 'recall': 0.9301895, 'specificity': 0.9301895, 'f1': 0.92998964, 'auroc': 0.97845256, 'binary_precision': 0.97740704, 'binary_recall': 0.88076544, 'binary_specificity': 0.9796136, 'binary_f1_score': 0.92657316}
confusion matrix:
       0      1
0  24795    516
1   3022  22323
---- Validation: 
scalar performance:
{'acc': 0.8369299, 'precision': 0.5457525, 'recall': 0.77780026, 'specificity': 0.77780026, 'f1': 0.54237086, 'auroc': 0.8493085, 'binary_precision': 0.09983193, 'binary_recall': 0.71566266, 'binary_specificity': 0.83993787, 'binary_f1_score': 0.17522123}
confusion matrix:
       0     1
0  14053  2678
1    118   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7368994, 'precision': 0.58169353, 'recall': 0.74409664, 'specificity': 0.74409664, 'f1': 0.5708716, 'auroc': 0.8036407, 'binary_precision': 0.19042937, 'binary_recall': 0.75259066, 'binary_specificity': 0.7356027, 'binary_f1_score': 0.3039498}
confusion matrix:
      0     1
0  6872  2470
1   191   581
early stop counter: 3
val acc:0.8369299173355103, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 4,now: 2024-08-06 03:50:50.556830,epoch time: 0:17:55.497991,used: 1:16:05.166385,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9395531, 'precision': 0.9428065, 'recall': 0.9395802, 'specificity': 0.9395802, 'f1': 0.9394444, 'auroc': 0.9818442, 'binary_precision': 0.9809203, 'binary_recall': 0.8966225, 'binary_specificity': 0.9825379, 'binary_f1_score': 0.93687904}
confusion matrix:
       0      1
0  24870    442
1   2620  22724
---- Validation: 
scalar performance:
{'acc': 0.8443952, 'precision': 0.54993, 'recall': 0.79454976, 'specificity': 0.79454976, 'f1': 0.55076694, 'auroc': 0.8678237, 'binary_precision': 0.10735448, 'binary_recall': 0.74216866, 'binary_specificity': 0.84693086, 'binary_f1_score': 0.18757613}
confusion matrix:
       0     1
0  14170  2561
1    107   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7438204, 'precision': 0.58974165, 'recall': 0.7680442, 'specificity': 0.7680442, 'f1': 0.58199245, 'auroc': 0.8280539, 'binary_precision': 0.20170547, 'binary_recall': 0.7966321, 'binary_specificity': 0.73945624, 'binary_f1_score': 0.32190526}
confusion matrix:
      0     1
0  6908  2434
1   157   615
early stop counter: 4
val acc:0.8443952202796936, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 5,now: 2024-08-06 04:08:46.859491,epoch time: 0:17:56.302661,used: 1:34:01.469046,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94614655, 'precision': 0.94811344, 'recall': 0.9461702, 'specificity': 0.9461702, 'f1': 0.9460894, 'auroc': 0.9838133, 'binary_precision': 0.9779797, 'binary_recall': 0.9129251, 'binary_specificity': 0.97941524, 'binary_f1_score': 0.9443333}
confusion matrix:
       0      1
0  24789    521
1   2207  23139
---- Validation: 
scalar performance:
{'acc': 0.8442202, 'precision': 0.5519153, 'recall': 0.8085593, 'specificity': 0.8085593, 'f1': 0.55354047, 'auroc': 0.8783267, 'binary_precision': 0.110497236, 'binary_recall': 0.7710843, 'binary_specificity': 0.8460343, 'binary_f1_score': 0.19329508}
confusion matrix:
       0     1
0  14155  2576
1     95   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7544987, 'precision': 0.59328115, 'recall': 0.77263623, 'specificity': 0.77263623, 'f1': 0.5901178, 'auroc': 0.83861005, 'binary_precision': 0.20871638, 'binary_recall': 0.79404145, 'binary_specificity': 0.751231, 'binary_f1_score': 0.33054733}
confusion matrix:
      0     1
0  7018  2324
1   159   613
early stop counter: 5
val acc:0.8442202210426331, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 6,now: 2024-08-06 04:26:44.723396,epoch time: 0:17:57.863905,used: 1:51:59.332951,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94904846, 'precision': 0.950406, 'recall': 0.94906914, 'specificity': 0.94906914, 'f1': 0.9490117, 'auroc': 0.98559946, 'binary_precision': 0.97532153, 'binary_recall': 0.9214897, 'binary_specificity': 0.9766486, 'binary_f1_score': 0.94764173}
confusion matrix:
       0      1
0  24718    591
1   1990  23357
---- Validation: 
scalar performance:
{'acc': 0.83733815, 'precision': 0.5510438, 'recall': 0.8144324, 'specificity': 0.8144324, 'f1': 0.55000347, 'auroc': 0.88538456, 'binary_precision': 0.10825083, 'binary_recall': 0.79036146, 'binary_specificity': 0.83850336, 'binary_f1_score': 0.19042091}
confusion matrix:
       0     1
0  14029  2702
1     87   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74698436, 'precision': 0.594317, 'recall': 0.78223395, 'specificity': 0.78223395, 'f1': 0.5879815, 'auroc': 0.84955144, 'binary_precision': 0.20791109, 'binary_recall': 0.8238342, 'binary_specificity': 0.7406337, 'binary_f1_score': 0.33202818}
confusion matrix:
      0     1
0  6919  2423
1   136   636
early stop counter: 6
val acc:0.8373381495475769, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 7,now: 2024-08-06 04:44:28.881966,epoch time: 0:17:44.158570,used: 2:09:43.491521,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.951753, 'precision': 0.95298773, 'recall': 0.9517706, 'specificity': 0.9517706, 'f1': 0.95172143, 'auroc': 0.9866202, 'binary_precision': 0.97680616, 'binary_recall': 0.9255474, 'binary_specificity': 0.9779938, 'binary_f1_score': 0.95048624}
confusion matrix:
       0      1
0  24754    557
1   1887  23458
---- Validation: 
scalar performance:
{'acc': 0.84701973, 'precision': 0.55421674, 'recall': 0.8193933, 'specificity': 0.8193933, 'f1': 0.55774176, 'auroc': 0.88947767, 'binary_precision': 0.11452514, 'binary_recall': 0.79036146, 'binary_specificity': 0.8484251, 'binary_f1_score': 0.200061}
confusion matrix:
       0     1
0  14195  2536
1     87   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7756575, 'precision': 0.60196894, 'recall': 0.78468406, 'specificity': 0.78468406, 'f1': 0.6077708, 'auroc': 0.85356414, 'binary_precision': 0.2253211, 'binary_recall': 0.7953368, 'binary_specificity': 0.7740313, 'binary_f1_score': 0.35115814}
confusion matrix:
      0     1
0  7231  2111
1   158   614
early stop counter: 7
val acc:0.8470197319984436, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 8,now: 2024-08-06 05:02:18.731656,epoch time: 0:17:49.849690,used: 2:27:33.341211,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.953964, 'precision': 0.95534754, 'recall': 0.9539782, 'specificity': 0.9539782, 'f1': 0.95393, 'auroc': 0.988258, 'binary_precision': 0.9805756, 'binary_recall': 0.9263249, 'binary_specificity': 0.98163146, 'binary_f1_score': 0.95267856}
confusion matrix:
       0      1
0  24850    465
1   1867  23474
---- Validation: 
scalar performance:
{'acc': 0.84789455, 'precision': 0.554691, 'recall': 0.82101643, 'specificity': 0.82101643, 'f1': 0.55870557, 'auroc': 0.8927127, 'binary_precision': 0.11539811, 'binary_recall': 0.7927711, 'binary_specificity': 0.8492618, 'binary_f1_score': 0.20146969}
confusion matrix:
       0     1
0  14209  2522
1     86   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78060114, 'precision': 0.60497254, 'recall': 0.7903309, 'specificity': 0.7903309, 'f1': 0.61290115, 'auroc': 0.858675, 'binary_precision': 0.23054004, 'binary_recall': 0.8018135, 'binary_specificity': 0.77884823, 'binary_f1_score': 0.35811397}
confusion matrix:
      0     1
0  7276  2066
1   153   619
early stop counter: 8
val acc:0.847894549369812, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 9,now: 2024-08-06 05:20:10.082168,epoch time: 0:17:51.350512,used: 2:45:24.691723,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95730025, 'precision': 0.95822126, 'recall': 0.9573109, 'specificity': 0.9573109, 'f1': 0.95727944, 'auroc': 0.9894177, 'binary_precision': 0.97888345, 'binary_recall': 0.93480664, 'binary_specificity': 0.9798151, 'binary_f1_score': 0.95633745}
confusion matrix:
       0      1
0  24805    511
1   1652  23688
---- Validation: 
scalar performance:
{'acc': 0.84474516, 'precision': 0.55427694, 'recall': 0.8241024, 'specificity': 0.8241024, 'f1': 0.55707467, 'auroc': 0.89666796, 'binary_precision': 0.11431514, 'binary_recall': 0.80240965, 'binary_specificity': 0.8457952, 'binary_f1_score': 0.20012018}
confusion matrix:
       0     1
0  14151  2580
1     82   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7793158, 'precision': 0.6053866, 'recall': 0.79319996, 'specificity': 0.79319996, 'f1': 0.61285174, 'auroc': 0.86442125, 'binary_precision': 0.23062731, 'binary_recall': 0.8095855, 'binary_specificity': 0.7768144, 'binary_f1_score': 0.3589891}
confusion matrix:
      0     1
0  7257  2085
1   147   625
early stop counter: 9
val acc:0.8447451591491699, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 10,now: 2024-08-06 05:37:59.962738,epoch time: 0:17:49.880570,used: 3:03:14.572293,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9582083, 'precision': 0.9591727, 'recall': 0.95822465, 'specificity': 0.95822465, 'f1': 0.9581874, 'auroc': 0.98929405, 'binary_precision': 0.9803946, 'binary_recall': 0.93517715, 'binary_specificity': 0.9812722, 'binary_f1_score': 0.9572522}
confusion matrix:
       0      1
0  24836    474
1   1643  23703
---- Validation: 
scalar performance:
{'acc': 0.84585327, 'precision': 0.5543203, 'recall': 0.82232034, 'specificity': 0.82232034, 'f1': 0.55750436, 'auroc': 0.89945936, 'binary_precision': 0.11453287, 'binary_recall': 0.7975904, 'binary_specificity': 0.84705037, 'binary_f1_score': 0.20030257}
confusion matrix:
       0     1
0  14172  2559
1     84   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78416055, 'precision': 0.60872096, 'recall': 0.79998153, 'specificity': 0.79998153, 'f1': 0.618304, 'auroc': 0.87032056, 'binary_precision': 0.23626168, 'binary_recall': 0.81865287, 'binary_specificity': 0.7813102, 'binary_f1_score': 0.36669564}
confusion matrix:
      0     1
0  7299  2043
1   140   632
early stop counter: 10
val acc:0.8458532691001892, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.7855448126792908
after epoch: 11,now: 2024-08-06 05:55:52.461677,epoch time: 0:17:52.498939,used: 3:21:07.071232,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9598863, 'precision': 0.9608399, 'recall': 0.9599017, 'specificity': 0.9599017, 'f1': 0.9598664, 'auroc': 0.99095154, 'binary_precision': 0.9819723, 'binary_recall': 0.937029, 'binary_specificity': 0.9827743, 'binary_f1_score': 0.9589743}
confusion matrix:
       0      1
0  24875    436
1   1596  23749
---- Validation: 
scalar performance:
{'acc': 0.8657996, 'precision': 0.5620758, 'recall': 0.8325409, 'specificity': 0.8325409, 'f1': 0.57498795, 'auroc': 0.9027807, 'binary_precision': 0.1299058, 'binary_recall': 0.7975904, 'binary_specificity': 0.8674915, 'binary_f1_score': 0.2234222}
confusion matrix:
       0     1
0  14514  2217
1     84   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81125176, 'precision': 0.61912364, 'recall': 0.80216944, 'specificity': 0.80216944, 'f1': 0.6393168, 'auroc': 0.8735133, 'binary_precision': 0.25900805, 'binary_recall': 0.7914508, 'binary_specificity': 0.812888, 'binary_f1_score': 0.39029062}
confusion matrix:
      0     1
0  7594  1748
1   161   611
new oracle model saved
early stop counter: 11
val acc:0.865799605846405, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.8112517595291138
after epoch: 12,now: 2024-08-06 06:13:50.663365,epoch time: 0:17:58.201688,used: 3:39:05.272920,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96170247, 'precision': 0.96232843, 'recall': 0.96171194, 'specificity': 0.96171194, 'f1': 0.96169007, 'auroc': 0.99124324, 'binary_precision': 0.9794697, 'binary_recall': 0.94321454, 'binary_specificity': 0.98020935, 'binary_f1_score': 0.9610003}
confusion matrix:
       0      1
0  24814    501
1   1439  23902
---- Validation: 
scalar performance:
{'acc': 0.8650997, 'precision': 0.5621259, 'recall': 0.83453214, 'specificity': 0.83453214, 'f1': 0.5748489, 'auroc': 0.90438396, 'binary_precision': 0.1298752, 'binary_recall': 0.80240965, 'binary_specificity': 0.8666547, 'binary_f1_score': 0.22356497}
confusion matrix:
       0     1
0  14500  2231
1     82   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8122405, 'precision': 0.6191961, 'recall': 0.80092216, 'specificity': 0.80092216, 'f1': 0.6397005, 'auroc': 0.87467754, 'binary_precision': 0.25949636, 'binary_recall': 0.78756475, 'binary_specificity': 0.8142796, 'binary_f1_score': 0.39036918}
confusion matrix:
      0     1
0  7607  1735
1   164   608
new oracle model saved
early stop counter: 12
val acc:0.8650997281074524, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.812240481376648
after epoch: 13,now: 2024-08-06 06:31:48.964548,epoch time: 0:17:58.301183,used: 3:57:03.574103,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96223545, 'precision': 0.9630582, 'recall': 0.96224886, 'specificity': 0.96224886, 'f1': 0.9622195, 'auroc': 0.9912192, 'binary_precision': 0.98273516, 'binary_recall': 0.9410511, 'binary_specificity': 0.9834466, 'binary_f1_score': 0.9614416}
confusion matrix:
       0      1
0  24893    419
1   1494  23850
---- Validation: 
scalar performance:
{'acc': 0.87518954, 'precision': 0.56648815, 'recall': 0.8373524, 'specificity': 0.8373524, 'f1': 0.58415085, 'auroc': 0.9050621, 'binary_precision': 0.13866778, 'binary_recall': 0.7975904, 'binary_specificity': 0.87711436, 'binary_f1_score': 0.2362598}
confusion matrix:
       0     1
0  14675  2056
1     84   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8251928, 'precision': 0.62624097, 'recall': 0.80496275, 'specificity': 0.80496275, 'f1': 0.65152276, 'auroc': 0.8773433, 'binary_precision': 0.27384195, 'binary_recall': 0.78108805, 'binary_specificity': 0.8288375, 'binary_f1_score': 0.40551445}
confusion matrix:
      0     1
0  7743  1599
1   169   603
new oracle model saved
early stop counter: 13
val acc:0.8751895427703857, best validation acc: 0.8823632597923279, corresponding to test acc:                         0.7855448126792908 / 0.8251928091049194
after epoch: 14,now: 2024-08-06 06:49:37.518108,epoch time: 0:17:48.553560,used: 4:14:52.127663,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9646241, 'precision': 0.9654999, 'recall': 0.9646379, 'specificity': 0.9646379, 'f1': 0.9646082, 'auroc': 0.99246454, 'binary_precision': 0.98584867, 'binary_recall': 0.9428267, 'binary_specificity': 0.9864491, 'binary_f1_score': 0.9638578}
confusion matrix:
       0      1
0  24969    343
1   1449  23895
---- Validation: 
scalar performance:
{'acc': 0.8866791, 'precision': 0.5706294, 'recall': 0.83031535, 'specificity': 0.83031535, 'f1': 0.59324896, 'auroc': 0.90625423, 'binary_precision': 0.14760147, 'binary_recall': 0.7710843, 'binary_specificity': 0.88954633, 'binary_f1_score': 0.24777389}
confusion matrix:
       0     1
0  14883  1848
1     95   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84368205, 'precision': 0.6335292, 'recall': 0.7941762, 'specificity': 0.7941762, 'f1': 0.66391104, 'auroc': 0.8757299, 'binary_precision': 0.29203084, 'binary_recall': 0.7357513, 'binary_specificity': 0.8526012, 'binary_f1_score': 0.41810822}
confusion matrix:
      0     1
0  7965  1377
1   204   568
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-06 07:07:33.284354,epoch time: 0:17:55.766246,used: 4:32:47.893909,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9663811, 'precision': 0.96696866, 'recall': 0.96639097, 'specificity': 0.96639097, 'f1': 0.966371, 'auroc': 0.9927803, 'binary_precision': 0.9836723, 'binary_recall': 0.9485439, 'binary_specificity': 0.98423797, 'binary_f1_score': 0.96578884}
confusion matrix:
       0      1
0  24915    399
1   1304  24038
---- Validation: 
scalar performance:
{'acc': 0.8804969, 'precision': 0.5692536, 'recall': 0.84007186, 'specificity': 0.84007186, 'f1': 0.5896548, 'auroc': 0.90835416, 'binary_precision': 0.14416376, 'binary_recall': 0.7975904, 'binary_specificity': 0.88255334, 'binary_f1_score': 0.24419034}
confusion matrix:
       0     1
0  14766  1965
1     84   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84249556, 'precision': 0.6327808, 'recall': 0.7941281, 'specificity': 0.7941281, 'f1': 0.66282654, 'auroc': 0.87600094, 'binary_precision': 0.29045433, 'binary_recall': 0.73704666, 'binary_specificity': 0.8512096, 'binary_f1_score': 0.4166972}
confusion matrix:
      0     1
0  7952  1390
1   203   569
early stop counter: 1
val acc:0.8804969191551208, best validation acc: 0.8866791129112244, corresponding to test acc:                         0.843682050704956 / 0.843682050704956
after epoch: 16,now: 2024-08-06 07:25:38.274563,epoch time: 0:18:04.990209,used: 4:50:52.884118,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9668943, 'precision': 0.96741223, 'recall': 0.9669056, 'specificity': 0.9669056, 'f1': 0.96688575, 'auroc': 0.9929106, 'binary_precision': 0.98313874, 'binary_recall': 0.95012826, 'binary_specificity': 0.983683, 'binary_f1_score': 0.9663517}
confusion matrix:
       0      1
0  24898    413
1   1264  24081
---- Validation: 
scalar performance:
{'acc': 0.8743147, 'precision': 0.5671539, 'recall': 0.8439537, 'specificity': 0.8439537, 'f1': 0.5848768, 'auroc': 0.91046166, 'binary_precision': 0.13960232, 'binary_recall': 0.8120482, 'binary_specificity': 0.8758592, 'binary_f1_score': 0.23824672}
confusion matrix:
       0     1
0  14654  2077
1     78   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372553, 'precision': 0.6313518, 'recall': 0.8002037, 'specificity': 0.8002037, 'f1': 0.66027296, 'auroc': 0.8796916, 'binary_precision': 0.2859941, 'binary_recall': 0.7564767, 'binary_specificity': 0.84393066, 'binary_f1_score': 0.41506752}
confusion matrix:
      0     1
0  7884  1458
1   188   584
early stop counter: 2
val acc:0.8743147253990173, best validation acc: 0.8866791129112244, corresponding to test acc:                         0.843682050704956 / 0.843682050704956
after epoch: 17,now: 2024-08-06 07:43:42.636081,epoch time: 0:18:04.361518,used: 5:08:57.245636,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9668746, 'precision': 0.9674814, 'recall': 0.96688604, 'specificity': 0.96688604, 'f1': 0.96686447, 'auroc': 0.99351585, 'binary_precision': 0.98448247, 'binary_recall': 0.94874525, 'binary_specificity': 0.98502684, 'binary_f1_score': 0.96628356}
confusion matrix:
       0      1
0  24933    379
1   1299  24045
---- Validation: 
scalar performance:
{'acc': 0.8719818, 'precision': 0.5660089, 'recall': 0.8427583, 'specificity': 0.8427583, 'f1': 0.58253586, 'auroc': 0.91090834, 'binary_precision': 0.1373268, 'binary_recall': 0.8120482, 'binary_specificity': 0.8734684, 'binary_f1_score': 0.23492505}
confusion matrix:
       0     1
0  14614  2117
1     78   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8431877, 'precision': 0.63446283, 'recall': 0.7986618, 'specificity': 0.7986618, 'f1': 0.6650323, 'auroc': 0.8803607, 'binary_precision': 0.29298067, 'binary_recall': 0.746114, 'binary_specificity': 0.8512096, 'binary_f1_score': 0.42074507}
confusion matrix:
      0     1
0  7952  1390
1   196   576
early stop counter: 3
val acc:0.8719817996025085, best validation acc: 0.8866791129112244, corresponding to test acc:                         0.843682050704956 / 0.843682050704956
after epoch: 18,now: 2024-08-06 08:01:43.990262,epoch time: 0:18:01.354181,used: 5:26:58.599817,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96823674, 'precision': 0.9685675, 'recall': 0.9682436, 'specificity': 0.9682436, 'f1': 0.96823144, 'auroc': 0.9939263, 'binary_precision': 0.9811451, 'binary_recall': 0.95485574, 'binary_specificity': 0.98163146, 'binary_f1_score': 0.96782196}
confusion matrix:
       0      1
0  24850    465
1   1144  24197
---- Validation: 
scalar performance:
{'acc': 0.86661613, 'precision': 0.56386715, 'recall': 0.8423588, 'specificity': 0.8423588, 'f1': 0.5778318, 'auroc': 0.9130771, 'binary_precision': 0.13294117, 'binary_recall': 0.8168675, 'binary_specificity': 0.8678501, 'binary_f1_score': 0.22866778}
confusion matrix:
       0     1
0  14520  2211
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8411113, 'precision': 0.6359728, 'recall': 0.8088266, 'specificity': 0.8088266, 'f1': 0.6666319, 'auroc': 0.884583, 'binary_precision': 0.29382715, 'binary_recall': 0.77072537, 'binary_specificity': 0.8469279, 'binary_f1_score': 0.4254558}
confusion matrix:
      0     1
0  7912  1430
1   177   595
early stop counter: 4
val acc:0.8666161298751831, best validation acc: 0.8866791129112244, corresponding to test acc:                         0.843682050704956 / 0.843682050704956
after epoch: 19,now: 2024-08-06 08:19:40.193082,epoch time: 0:17:56.202820,used: 5:44:54.802637,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.969816, 'precision': 0.97027576, 'recall': 0.9698253, 'specificity': 0.9698253, 'f1': 0.96980906, 'auroc': 0.9945256, 'binary_precision': 0.98512876, 'binary_recall': 0.95407015, 'binary_specificity': 0.9855805, 'binary_f1_score': 0.9693507}
confusion matrix:
       0      1
0  24948    365
1   1164  24179
---- Validation: 
scalar performance:
{'acc': 0.89163655, 'precision': 0.5738578, 'recall': 0.8340305, 'specificity': 0.8340305, 'f1': 0.5991788, 'auroc': 0.9113828, 'binary_precision': 0.15395683, 'binary_recall': 0.773494, 'binary_specificity': 0.89456695, 'binary_f1_score': 0.2568}
confusion matrix:
       0     1
0  14967  1764
1     94   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86187464, 'precision': 0.6461887, 'recall': 0.7933296, 'specificity': 0.7933296, 'f1': 0.68087006, 'auroc': 0.8849807, 'binary_precision': 0.3188406, 'binary_recall': 0.71243525, 'binary_specificity': 0.87422395, 'binary_f1_score': 0.44052863}
confusion matrix:
      0     1
0  8167  1175
1   222   550
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-08-06 08:37:38.577635,epoch time: 0:17:58.384553,used: 6:02:53.187190,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:02:53.187190 at 2024-08-06 08:37:38.577635
persisted model performance metric: 

scalar performance:
{'acc': 0.86187464, 'precision': 0.6461887, 'recall': 0.7933296, 'specificity': 0.7933296, 'f1': 0.68087006, 'auroc': 0.8849807, 'binary_precision': 0.3188406, 'binary_recall': 0.71243525, 'binary_specificity': 0.87422395, 'binary_f1_score': 0.44052863}
confusion matrix:
      0     1
0  8167  1175
1   222   550
oracle model performance metric: 

scalar performance:
{'acc': 0.86187464, 'precision': 0.6461887, 'recall': 0.7933296, 'specificity': 0.7933296, 'f1': 0.68087006, 'auroc': 0.8849807, 'binary_precision': 0.3188406, 'binary_recall': 0.71243525, 'binary_specificity': 0.87422395, 'binary_f1_score': 0.44052863}
confusion matrix:
      0     1
0  8167  1175
1   222   550
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/12.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 482684 GiB | 482683 GiB |
|       from small pool |  16663 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8528 MiB |   8528 MiB |   8528 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59172 KiB | 732464 KiB | 276937 GiB | 276937 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |   8410 KiB |  10852 KiB |   7464 GiB |   7464 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6827    |   92213 K  |   92209 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46589 K  |   46584 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6827    |   92213 K  |   92209 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46589 K  |   46584 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     370    |     370    |     370    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3190    |   54265 K  |   54265 K  |
|       from large pool |      10    |     350    |   34657 K  |   34657 K  |
|       from small pool |      21    |    3180    |   19608 K  |   19608 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8528 MiB |   8528 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     42 MiB |     42 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276937 GiB | 276937 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |      0 KiB |  22549 KiB |   7464 GiB |   7464 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92213 K  |   92213 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92213 K  |   92213 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     370    |     370    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   54267 K  |   54267 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3180    |   19610 K  |   19610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490154 GiB | 490154 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8528 MiB |   8528 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     42 MiB |     42 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276937 GiB | 276937 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |      0 KiB |  22549 KiB |   7464 GiB |   7464 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92213 K  |   92213 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92213 K  |   92213 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     370    |     370    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   54267 K  |   54267 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3180    |   19610 K  |   19610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669

 Experiment start at: 2024-08-06 09:01:05.048223
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8247167, 'precision': 0.82519627, 'recall': 0.82472956, 'specificity': 0.82472956, 'f1': 0.824656, 'auroc': 0.89646053, 'binary_precision': 0.8378522, 'binary_recall': 0.80556756, 'binary_specificity': 0.8438915, 'binary_f1_score': 0.8213928}
confusion matrix:
       0      1
0  21434   3965
1   4945  20488
---- Validation: 
scalar performance:
{'acc': 0.8755475, 'precision': 0.5034961, 'recall': 0.51349527, 'specificity': 0.51349527, 'f1': 0.49209395, 'auroc': 0.7304267, 'binary_precision': 0.031422272, 'binary_recall': 0.13225058, 'binary_specificity': 0.89474, 'binary_f1_score': 0.05077951}
confusion matrix:
       0     1
0  14935  1757
1    374    57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7899118, 'precision': 0.49477836, 'recall': 0.49010855, 'specificity': 0.49010855, 'f1': 0.48530307, 'auroc': 0.6459205, 'binary_precision': 0.06619988, 'binary_recall': 0.13738441, 'binary_specificity': 0.8428327, 'binary_f1_score': 0.08934709}
confusion matrix:
      0     1
0  7867  1467
1   653   104
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 09:19:58.670227,epoch time: 0:18:53.622004,used: 0:18:53.622004,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8822395, 'precision': 0.8853596, 'recall': 0.882275, 'specificity': 0.882275, 'f1': 0.8820075, 'auroc': 0.94204426, 'binary_precision': 0.92023164, 'binary_recall': 0.83723855, 'binary_specificity': 0.92731136, 'binary_f1_score': 0.8767755}
confusion matrix:
       0      1
0  23550   1846
1   4140  21296
---- Validation: 
scalar performance:
{'acc': 0.89394385, 'precision': 0.51621866, 'recall': 0.5545748, 'specificity': 0.5545748, 'f1': 0.5146533, 'auroc': 0.7803526, 'binary_precision': 0.05466238, 'binary_recall': 0.19721578, 'binary_specificity': 0.91193384, 'binary_f1_score': 0.08559919}
confusion matrix:
       0     1
0  15222  1470
1    346    85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8121098, 'precision': 0.51606345, 'recall': 0.5282059, 'specificity': 0.5282059, 'f1': 0.5144332, 'auroc': 0.70796114, 'binary_precision': 0.10258199, 'binary_recall': 0.19418758, 'binary_specificity': 0.8622241, 'binary_f1_score': 0.13424659}
confusion matrix:
      0     1
0  8048  1286
1   610   147
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 09:38:06.828726,epoch time: 0:18:08.158499,used: 0:37:01.780503,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90285647, 'precision': 0.90747625, 'recall': 0.90289843, 'specificity': 0.90289843, 'f1': 0.90258694, 'auroc': 0.95912695, 'binary_precision': 0.95106065, 'binary_recall': 0.84958327, 'binary_specificity': 0.9562136, 'binary_f1_score': 0.89746255}
confusion matrix:
       0      1
0  24284   1112
1   3826  21610
---- Validation: 
scalar performance:
{'acc': 0.9083105, 'precision': 0.5378514, 'recall': 0.61619025, 'specificity': 0.61619025, 'f1': 0.54821914, 'auroc': 0.8104123, 'binary_precision': 0.09466192, 'binary_recall': 0.3085847, 'binary_specificity': 0.9237958, 'binary_f1_score': 0.14488018}
confusion matrix:
       0     1
0  15420  1272
1    298   133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8342087, 'precision': 0.55392367, 'recall': 0.59174085, 'specificity': 0.59174085, 'f1': 0.56220704, 'auroc': 0.7645881, 'binary_precision': 0.16811594, 'binary_recall': 0.30647293, 'binary_specificity': 0.8770088, 'binary_f1_score': 0.21712682}
confusion matrix:
      0     1
0  8186  1148
1   525   232
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 09:56:20.283777,epoch time: 0:18:13.455051,used: 0:55:15.235554,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9193618, 'precision': 0.9229816, 'recall': 0.91939646, 'specificity': 0.91939646, 'f1': 0.9191934, 'auroc': 0.9697218, 'binary_precision': 0.9622985, 'binary_recall': 0.87304896, 'binary_specificity': 0.96574396, 'binary_f1_score': 0.91550374}
confusion matrix:
       0      1
0  24527    870
1   3229  22206
---- Validation: 
scalar performance:
{'acc': 0.91391695, 'precision': 0.5579258, 'recall': 0.67896324, 'specificity': 0.67896324, 'f1': 0.5780115, 'auroc': 0.8313079, 'binary_precision': 0.13144876, 'binary_recall': 0.43155453, 'binary_specificity': 0.92637193, 'binary_f1_score': 0.20151679}
confusion matrix:
       0     1
0  15463  1229
1    245   186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84411854, 'precision': 0.5930774, 'recall': 0.67235744, 'specificity': 0.67235744, 'f1': 0.61185277, 'auroc': 0.8054082, 'binary_precision': 0.23298429, 'binary_recall': 0.4702774, 'binary_specificity': 0.8744375, 'binary_f1_score': 0.31159738}
confusion matrix:
      0     1
0  8162  1172
1   401   356
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 10:14:31.755003,epoch time: 0:18:11.471226,used: 1:13:26.706780,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92762434, 'precision': 0.9321642, 'recall': 0.92766273, 'specificity': 0.92766273, 'f1': 0.92743814, 'auroc': 0.9775044, 'binary_precision': 0.97664535, 'binary_recall': 0.8763122, 'binary_specificity': 0.97901326, 'binary_f1_score': 0.9237624}
confusion matrix:
       0      1
0  24864    533
1   3146  22289
---- Validation: 
scalar performance:
{'acc': 0.92951, 'precision': 0.5762243, 'recall': 0.69713235, 'specificity': 0.69713235, 'f1': 0.60361946, 'auroc': 0.84783536, 'binary_precision': 0.16723843, 'binary_recall': 0.4524362, 'binary_specificity': 0.9418284, 'binary_f1_score': 0.2442079}
confusion matrix:
       0    1
0  15721  971
1    236  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.858686, 'precision': 0.6189275, 'recall': 0.71725494, 'specificity': 0.71725494, 'f1': 0.64472973, 'auroc': 0.8346149, 'binary_precision': 0.2774451, 'binary_recall': 0.5508587, 'binary_specificity': 0.8836512, 'binary_f1_score': 0.36902654}
confusion matrix:
      0     1
0  8248  1086
1   340   417
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 10:32:43.880742,epoch time: 0:18:12.125739,used: 1:31:38.832519,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93500155, 'precision': 0.93843436, 'recall': 0.9350382, 'specificity': 0.9350382, 'f1': 0.9348778, 'auroc': 0.9812881, 'binary_precision': 0.9774365, 'binary_recall': 0.8906711, 'binary_specificity': 0.9794054, 'binary_f1_score': 0.93203884}
confusion matrix:
       0      1
0  24872    523
1   2781  22656
---- Validation: 
scalar performance:
{'acc': 0.9343573, 'precision': 0.5886701, 'recall': 0.72109115, 'specificity': 0.72109115, 'f1': 0.6206969, 'auroc': 0.8581893, 'binary_precision': 0.19090098, 'binary_recall': 0.4965197, 'binary_specificity': 0.9456626, 'binary_f1_score': 0.27577317}
confusion matrix:
       0    1
0  15785  907
1    217  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8613616, 'precision': 0.6289015, 'recall': 0.7417648, 'specificity': 0.7417648, 'f1': 0.65791774, 'auroc': 0.8491584, 'binary_precision': 0.2931701, 'binary_recall': 0.6010568, 'binary_specificity': 0.8824727, 'binary_f1_score': 0.39411}
confusion matrix:
      0     1
0  8237  1097
1   302   455
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-06 10:51:03.430673,epoch time: 0:18:19.549931,used: 1:49:58.382450,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9421427, 'precision': 0.9449204, 'recall': 0.94217396, 'specificity': 0.94217396, 'f1': 0.9420551, 'auroc': 0.9842297, 'binary_precision': 0.9802724, 'binary_recall': 0.90253973, 'binary_specificity': 0.9818082, 'binary_f1_score': 0.93980145}
confusion matrix:
       0      1
0  24934    462
1   2479  22957
---- Validation: 
scalar performance:
{'acc': 0.9352917, 'precision': 0.5985815, 'recall': 0.75434446, 'specificity': 0.75434446, 'f1': 0.63547987, 'auroc': 0.8668688, 'binary_precision': 0.20894238, 'binary_recall': 0.5638051, 'binary_specificity': 0.94488376, 'binary_f1_score': 0.30489334}
confusion matrix:
       0    1
0  15772  920
1    188  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.860767, 'precision': 0.6352484, 'recall': 0.7645068, 'specificity': 0.7645068, 'f1': 0.6667036, 'auroc': 0.86172795, 'binary_precision': 0.3017136, 'binary_recall': 0.65125495, 'binary_specificity': 0.87775874, 'binary_f1_score': 0.41237974}
confusion matrix:
      0     1
0  8193  1141
1   264   493
better model found
persisted
after epoch: 7,now: 2024-08-06 11:09:19.703387,epoch time: 0:18:16.272714,used: 2:08:14.655164,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9454084, 'precision': 0.9471289, 'recall': 0.9454317, 'specificity': 0.9454317, 'f1': 0.9453578, 'auroc': 0.9855539, 'binary_precision': 0.9750524, 'binary_recall': 0.9142913, 'binary_specificity': 0.97657204, 'binary_f1_score': 0.94369483}
confusion matrix:
       0      1
0  24802    595
1   2180  23255
---- Validation: 
scalar performance:
{'acc': 0.9326637, 'precision': 0.59795254, 'recall': 0.7665582, 'specificity': 0.7665582, 'f1': 0.6356441, 'auroc': 0.87235224, 'binary_precision': 0.20698053, 'binary_recall': 0.5916473, 'binary_specificity': 0.94146895, 'binary_f1_score': 0.3066747}
confusion matrix:
       0    1
0  15715  977
1    176  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549202, 'precision': 0.6365063, 'recall': 0.7844099, 'specificity': 0.7844099, 'f1': 0.66875476, 'auroc': 0.8696207, 'binary_precision': 0.3001696, 'binary_recall': 0.7014531, 'binary_specificity': 0.8673666, 'binary_f1_score': 0.42042756}
confusion matrix:
      0     1
0  8096  1238
1   226   531
early stop counter: 1
val acc:0.9326636791229248, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 8,now: 2024-08-06 11:27:33.683309,epoch time: 0:18:13.979922,used: 2:26:28.635086,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95046425, 'precision': 0.95202506, 'recall': 0.9504863, 'specificity': 0.9504863, 'f1': 0.9504232, 'auroc': 0.98788667, 'binary_precision': 0.9787741, 'binary_recall': 0.920975, 'binary_specificity': 0.97999763, 'binary_f1_score': 0.94899535}
confusion matrix:
       0      1
0  24889    508
1   2010  23425
---- Validation: 
scalar performance:
{'acc': 0.9288676, 'precision': 0.59689116, 'recall': 0.7826933, 'specificity': 0.7826933, 'f1': 0.6352307, 'auroc': 0.87538195, 'binary_precision': 0.20391272, 'binary_recall': 0.6287703, 'binary_specificity': 0.93661636, 'binary_f1_score': 0.30795452}
confusion matrix:
       0     1
0  15634  1058
1    160   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8430284, 'precision': 0.63453615, 'recall': 0.80590075, 'specificity': 0.80590075, 'f1': 0.66533536, 'auroc': 0.8760998, 'binary_precision': 0.29126704, 'binary_recall': 0.7622193, 'binary_specificity': 0.8495822, 'binary_f1_score': 0.42147553}
confusion matrix:
      0     1
0  7930  1404
1   180   577
early stop counter: 2
val acc:0.9288675785064697, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 9,now: 2024-08-06 11:45:52.152248,epoch time: 0:18:18.468939,used: 2:44:47.104025,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9542808, 'precision': 0.9552298, 'recall': 0.95429975, 'specificity': 0.95429975, 'f1': 0.9542582, 'auroc': 0.9889492, 'binary_precision': 0.9762229, 'binary_recall': 0.9313205, 'binary_specificity': 0.977279, 'binary_f1_score': 0.95324314}
confusion matrix:
       0      1
0  24818    577
1   1747  23690
---- Validation: 
scalar performance:
{'acc': 0.9229107, 'precision': 0.59467655, 'recall': 0.8033709, 'specificity': 0.8033709, 'f1': 0.6329545, 'auroc': 0.8817613, 'binary_precision': 0.1982349, 'binary_recall': 0.6774942, 'binary_specificity': 0.92924756, 'binary_f1_score': 0.3067227}
confusion matrix:
       0     1
0  15511  1181
1    139   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8391636, 'precision': 0.6341303, 'recall': 0.81291556, 'specificity': 0.81291556, 'f1': 0.66419625, 'auroc': 0.88155276, 'binary_precision': 0.28878048, 'binary_recall': 0.78203434, 'binary_specificity': 0.84379685, 'binary_f1_score': 0.4218026}
confusion matrix:
      0     1
0  7876  1458
1   165   592
early stop counter: 3
val acc:0.9229106903076172, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 10,now: 2024-08-06 12:04:14.927239,epoch time: 0:18:22.774991,used: 3:03:09.879016,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9566218, 'precision': 0.9573888, 'recall': 0.9566364, 'specificity': 0.9566364, 'f1': 0.9566046, 'auroc': 0.9902468, 'binary_precision': 0.9762969, 'binary_recall': 0.9360305, 'binary_specificity': 0.9772423, 'binary_f1_score': 0.9557398}
confusion matrix:
       0      1
0  24820    578
1   1627  23807
---- Validation: 
scalar performance:
{'acc': 0.92559713, 'precision': 0.59883326, 'recall': 0.8092693, 'specificity': 0.8092693, 'f1': 0.6389554, 'auroc': 0.88216937, 'binary_precision': 0.20627178, 'binary_recall': 0.68677497, 'binary_specificity': 0.9317637, 'binary_f1_score': 0.31725618}
confusion matrix:
       0     1
0  15553  1139
1    135   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8326231, 'precision': 0.63343537, 'recall': 0.8239466, 'specificity': 0.8239466, 'f1': 0.6619614, 'auroc': 0.8868944, 'binary_precision': 0.28465804, 'binary_recall': 0.81373847, 'binary_specificity': 0.8341547, 'binary_f1_score': 0.42177334}
confusion matrix:
      0     1
0  7786  1548
1   141   616
early stop counter: 4
val acc:0.9255971312522888, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 11,now: 2024-08-06 12:22:13.198261,epoch time: 0:17:58.271022,used: 3:21:08.150038,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95793986, 'precision': 0.9586189, 'recall': 0.9579567, 'specificity': 0.9579567, 'f1': 0.9579254, 'auroc': 0.9906012, 'binary_precision': 0.9764826, 'binary_recall': 0.9385565, 'binary_specificity': 0.97735685, 'binary_f1_score': 0.957144}
confusion matrix:
       0      1
0  24819    575
1   1563  23875
---- Validation: 
scalar performance:
{'acc': 0.9219179, 'precision': 0.596557, 'recall': 0.81755346, 'specificity': 0.81755346, 'f1': 0.635954, 'auroc': 0.8860376, 'binary_precision': 0.20118734, 'binary_recall': 0.7076566, 'binary_specificity': 0.9274503, 'binary_f1_score': 0.31330252}
confusion matrix:
       0     1
0  15481  1211
1    126   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83519965, 'precision': 0.63535494, 'recall': 0.8259462, 'specificity': 0.8259462, 'f1': 0.6648736, 'auroc': 0.8897365, 'binary_precision': 0.28831777, 'binary_recall': 0.8150594, 'binary_specificity': 0.83683306, 'binary_f1_score': 0.4259579}
confusion matrix:
      0     1
0  7811  1523
1   140   617
early stop counter: 5
val acc:0.9219179153442383, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 12,now: 2024-08-06 12:40:27.032634,epoch time: 0:18:13.834373,used: 3:39:21.984411,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.960517, 'precision': 0.9612996, 'recall': 0.960535, 'specificity': 0.960535, 'f1': 0.9605013, 'auroc': 0.9913465, 'binary_precision': 0.9805176, 'binary_recall': 0.93977517, 'binary_specificity': 0.9812948, 'binary_f1_score': 0.9597142}
confusion matrix:
       0      1
0  24919    475
1   1532  23906
---- Validation: 
scalar performance:
{'acc': 0.93114525, 'precision': 0.60569096, 'recall': 0.80985475, 'specificity': 0.80985475, 'f1': 0.6482335, 'auroc': 0.88593405, 'binary_precision': 0.22005989, 'binary_recall': 0.68213457, 'binary_specificity': 0.93757486, 'binary_f1_score': 0.3327674}
confusion matrix:
       0     1
0  15650  1042
1    137   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8452086, 'precision': 0.64291936, 'recall': 0.83257043, 'specificity': 0.83257043, 'f1': 0.67613995, 'auroc': 0.89506453, 'binary_precision': 0.30298582, 'binary_recall': 0.81770146, 'binary_specificity': 0.84743947, 'binary_f1_score': 0.4421429}
confusion matrix:
      0     1
0  7910  1424
1   138   619
early stop counter: 6
val acc:0.9311452507972717, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 13,now: 2024-08-06 12:58:34.745989,epoch time: 0:18:07.713355,used: 3:57:29.697766,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96096945, 'precision': 0.9616209, 'recall': 0.96098435, 'specificity': 0.96098435, 'f1': 0.9609566, 'auroc': 0.992319, 'binary_precision': 0.97915983, 'binary_recall': 0.94205064, 'binary_specificity': 0.9799181, 'binary_f1_score': 0.9602468}
confusion matrix:
       0      1
0  24886    510
1   1474  23962
---- Validation: 
scalar performance:
{'acc': 0.92366993, 'precision': 0.59882516, 'recall': 0.8195822, 'specificity': 0.8195822, 'f1': 0.63924277, 'auroc': 0.8887273, 'binary_precision': 0.20564516, 'binary_recall': 0.7099768, 'binary_specificity': 0.92918766, 'binary_f1_score': 0.3189161}
confusion matrix:
       0     1
0  15510  1182
1    125   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8371816, 'precision': 0.6406671, 'recall': 0.842191, 'specificity': 0.842191, 'f1': 0.6717278, 'auroc': 0.89640605, 'binary_precision': 0.29585254, 'binary_recall': 0.84808457, 'binary_specificity': 0.8362974, 'binary_f1_score': 0.43867445}
confusion matrix:
      0     1
0  7806  1528
1   115   642
early stop counter: 7
val acc:0.9236699342727661, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 14,now: 2024-08-06 13:16:39.660768,epoch time: 0:18:04.914779,used: 4:15:34.612545,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96283835, 'precision': 0.9633093, 'recall': 0.96285295, 'specificity': 0.96285295, 'f1': 0.9628297, 'auroc': 0.99247766, 'binary_precision': 0.97830856, 'binary_recall': 0.9467353, 'binary_specificity': 0.9789706, 'binary_f1_score': 0.96226305}
confusion matrix:
       0      1
0  24859    534
1   1355  24084
---- Validation: 
scalar performance:
{'acc': 0.91473454, 'precision': 0.5907476, 'recall': 0.8229102, 'specificity': 0.8229102, 'f1': 0.62734896, 'auroc': 0.8885157, 'binary_precision': 0.18912387, 'binary_recall': 0.7262181, 'binary_specificity': 0.9196022, 'binary_f1_score': 0.3000959}
confusion matrix:
       0     1
0  15350  1342
1    118   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82538897, 'precision': 0.63491005, 'recall': 0.8437066, 'specificity': 0.8437066, 'f1': 0.6617258, 'auroc': 0.8985586, 'binary_precision': 0.28293738, 'binary_recall': 0.8652576, 'binary_specificity': 0.82215554, 'binary_f1_score': 0.4264323}
confusion matrix:
      0     1
0  7674  1660
1   102   655
early stop counter: 8
val acc:0.9147345423698425, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 15,now: 2024-08-06 13:34:55.013137,epoch time: 0:18:15.352369,used: 4:33:49.964914,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96283835, 'precision': 0.9636605, 'recall': 0.96285427, 'specificity': 0.96285427, 'f1': 0.9628228, 'auroc': 0.9929688, 'binary_precision': 0.9833717, 'binary_recall': 0.9416552, 'binary_specificity': 0.98405325, 'binary_f1_score': 0.96206146}
confusion matrix:
       0      1
0  24992    405
1   1484  23951
---- Validation: 
scalar performance:
{'acc': 0.9223267, 'precision': 0.5981636, 'recall': 0.82341385, 'specificity': 0.82341385, 'f1': 0.63838357, 'auroc': 0.88816845, 'binary_precision': 0.20408164, 'binary_recall': 0.71925753, 'binary_specificity': 0.9275701, 'binary_f1_score': 0.31794873}
confusion matrix:
       0     1
0  15483  1209
1    121   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8355961, 'precision': 0.6409661, 'recall': 0.8467963, 'specificity': 0.8467963, 'f1': 0.67169017, 'auroc': 0.89951766, 'binary_precision': 0.29537204, 'binary_recall': 0.8599736, 'binary_specificity': 0.833619, 'binary_f1_score': 0.4397163}
confusion matrix:
      0     1
0  7781  1553
1   106   651
early stop counter: 9
val acc:0.9223266839981079, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 16,now: 2024-08-06 13:53:18.166766,epoch time: 0:18:23.153629,used: 4:52:13.118543,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96488434, 'precision': 0.96539843, 'recall': 0.9648988, 'specificity': 0.9648988, 'f1': 0.96487534, 'auroc': 0.99364555, 'binary_precision': 0.98108447, 'binary_recall': 0.94810915, 'binary_specificity': 0.98168856, 'binary_f1_score': 0.964315}
confusion matrix:
       0      1
0  24929    465
1   1320  24118
---- Validation: 
scalar performance:
{'acc': 0.91333294, 'precision': 0.5909099, 'recall': 0.8301022, 'specificity': 0.8301022, 'f1': 0.6275597, 'auroc': 0.8892611, 'binary_precision': 0.18901359, 'binary_recall': 0.7424594, 'binary_specificity': 0.91774505, 'binary_f1_score': 0.30131826}
confusion matrix:
       0     1
0  15319  1373
1    111   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82182145, 'precision': 0.6339658, 'recall': 0.8466336, 'specificity': 0.8466336, 'f1': 0.6595254, 'auroc': 0.9023081, 'binary_precision': 0.2801014, 'binary_recall': 0.87582564, 'binary_specificity': 0.8174416, 'binary_f1_score': 0.42445582}
confusion matrix:
      0     1
0  7630  1704
1    94   663
early stop counter: 10
val acc:0.9133329391479492, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 17,now: 2024-08-06 14:11:49.768165,epoch time: 0:18:31.601399,used: 5:10:44.719942,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9657106, 'precision': 0.9659657, 'recall': 0.9657209, 'specificity': 0.9657209, 'f1': 0.96570635, 'auroc': 0.9935758, 'binary_precision': 0.97708696, 'binary_recall': 0.9538486, 'binary_specificity': 0.9775931, 'binary_f1_score': 0.9653279}
confusion matrix:
       0      1
0  24825    569
1   1174  24264
---- Validation: 
scalar performance:
{'acc': 0.90363836, 'precision': 0.5828483, 'recall': 0.8273901, 'specificity': 0.8273901, 'f1': 0.6145462, 'auroc': 0.8903076, 'binary_precision': 0.17283951, 'binary_recall': 0.74709976, 'binary_specificity': 0.90768033, 'binary_f1_score': 0.28073233}
confusion matrix:
       0     1
0  15151  1541
1    109   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8227133, 'precision': 0.6345074, 'recall': 0.84711576, 'specificity': 0.84711576, 'f1': 0.66042995, 'auroc': 0.9037738, 'binary_precision': 0.2811705, 'binary_recall': 0.87582564, 'binary_specificity': 0.8184058, 'binary_f1_score': 0.4256822}
confusion matrix:
      0     1
0  7639  1695
1    94   663
early stop counter: 11
val acc:0.9036383628845215, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 18,now: 2024-08-06 14:30:03.057683,epoch time: 0:18:13.289518,used: 5:28:58.009460,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9681696, 'precision': 0.9687388, 'recall': 0.9681849, 'specificity': 0.9681849, 'f1': 0.96816075, 'auroc': 0.99419016, 'binary_precision': 0.9852905, 'binary_recall': 0.9505857, 'binary_specificity': 0.98578405, 'binary_f1_score': 0.96762705}
confusion matrix:
       0      1
0  25033    361
1   1257  24181
---- Validation: 
scalar performance:
{'acc': 0.9175378, 'precision': 0.59336203, 'recall': 0.82321787, 'specificity': 0.82321787, 'f1': 0.631323, 'auroc': 0.89069486, 'binary_precision': 0.19439252, 'binary_recall': 0.72389793, 'binary_specificity': 0.92253774, 'binary_f1_score': 0.3064833}
confusion matrix:
       0     1
0  15399  1293
1    119   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8346051, 'precision': 0.6407543, 'recall': 0.84808147, 'specificity': 0.84808147, 'f1': 0.6711809, 'auroc': 0.9035306, 'binary_precision': 0.2945946, 'binary_recall': 0.8639366, 'binary_specificity': 0.8322263, 'binary_f1_score': 0.43936852}
confusion matrix:
      0     1
0  7768  1566
1   103   654
early stop counter: 12
val acc:0.9175378084182739, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 19,now: 2024-08-06 14:48:23.311580,epoch time: 0:18:20.253897,used: 5:47:18.263357,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9688582, 'precision': 0.96931744, 'recall': 0.96886873, 'specificity': 0.96886873, 'f1': 0.9688511, 'auroc': 0.9944801, 'binary_precision': 0.98416567, 'binary_recall': 0.95309246, 'binary_specificity': 0.98464507, 'binary_f1_score': 0.96837986}
confusion matrix:
       0      1
0  25009    390
1   1193  24240
---- Validation: 
scalar performance:
{'acc': 0.9241371, 'precision': 0.5986918, 'recall': 0.8164314, 'specificity': 0.8164314, 'f1': 0.6389723, 'auroc': 0.8900189, 'binary_precision': 0.2055631, 'binary_recall': 0.7030162, 'binary_specificity': 0.92984664, 'binary_f1_score': 0.31811023}
confusion matrix:
       0     1
0  15521  1171
1    128   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8490734, 'precision': 0.6500395, 'recall': 0.8510468, 'specificity': 0.8510468, 'f1': 0.68563735, 'auroc': 0.9044874, 'binary_precision': 0.31389698, 'binary_recall': 0.8533686, 'binary_specificity': 0.8487251, 'binary_f1_score': 0.45896983}
confusion matrix:
      0     1
0  7922  1412
1   111   646
early stop counter: 13
val acc:0.9241371154785156, best validation acc: 0.9352917075157166, corresponding to test acc:                         0.8607670068740845 / 0.8613616228103638
after epoch: 20,now: 2024-08-06 15:09:11.062874,epoch time: 0:20:47.751294,used: 6:08:06.014651,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_01_04_seed_1_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:08:06.014651 at 2024-08-06 15:09:11.062874
persisted model performance metric: 

scalar performance:
{'acc': 0.860767, 'precision': 0.6352484, 'recall': 0.7645068, 'specificity': 0.7645068, 'f1': 0.6667036, 'auroc': 0.86172795, 'binary_precision': 0.3017136, 'binary_recall': 0.65125495, 'binary_specificity': 0.87775874, 'binary_f1_score': 0.41237974}
confusion matrix:
      0     1
0  8193  1141
1   264   493
oracle model performance metric: 

scalar performance:
{'acc': 0.8613616, 'precision': 0.6289015, 'recall': 0.7417648, 'specificity': 0.7417648, 'f1': 0.65791774, 'auroc': 0.8491584, 'binary_precision': 0.2931701, 'binary_recall': 0.6010568, 'binary_specificity': 0.8824727, 'binary_f1_score': 0.39411}
confusion matrix:
      0     1
0  8237  1097
1   302   455
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |  16662 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8528 MiB |  16788 MiB |   8276 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     42 MiB |     54 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38101 KiB | 732464 KiB | 548717 GiB | 548716 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 533711 GiB | 533711 GiB |
|       from small pool |   6368 KiB |  22549 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6849    |  185257 K  |  185252 K  |
|       from large pool |      79    |     762    |   91848 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93408 K  |   93404 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6849    |  185257 K  |  185252 K  |
|       from large pool |      79    |     762    |   91848 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93408 K  |   93404 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     370    |     714    |     346    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3199    |  104110 K  |  104110 K  |
|       from large pool |      11    |     352    |   63923 K  |   63923 K  |
|       from small pool |      21    |    3189    |   40186 K  |   40186 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8528 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     42 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548717 GiB | 548717 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533711 GiB | 533711 GiB |
|       from small pool |      0 KiB |  22549 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185257 K  |  185257 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93408 K  |   93408 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185257 K  |  185257 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93408 K  |   93408 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     714    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      21    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  104112 K  |  104112 K  |
|       from large pool |       3    |     352    |   63923 K  |   63923 K  |
|       from small pool |       0    |    3189    |   40188 K  |   40188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8528 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     42 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548717 GiB | 548717 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533711 GiB | 533711 GiB |
|       from small pool |      0 KiB |  22549 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185257 K  |  185257 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93408 K  |   93408 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185257 K  |  185257 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93408 K  |   93408 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     714    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      21    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  104112 K  |  104112 K  |
|       from large pool |       3    |     352    |   63923 K  |   63923 K  |
|       from small pool |       0    |    3189    |   40188 K  |   40188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669

 Experiment start at: 2024-08-06 15:33:13.347747
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86161405, 'precision': 0.8646116, 'recall': 0.8616158, 'specificity': 0.8616158, 'f1': 0.86132944, 'auroc': 0.9277842, 'binary_precision': 0.89768136, 'binary_recall': 0.8162792, 'binary_specificity': 0.90695244, 'binary_f1_score': 0.8550472}
confusion matrix:
       0      1
0  23442   2405
1   4749  21100
---- Validation: 
scalar performance:
{'acc': 0.8227634, 'precision': 0.5199926, 'recall': 0.6199361, 'specificity': 0.6199361, 'f1': 0.5012174, 'auroc': 0.68591547, 'binary_precision': 0.0574907, 'binary_recall': 0.40669855, 'binary_specificity': 0.8331737, 'binary_f1_score': 0.10074074}
confusion matrix:
       0     1
0  13919  2787
1    248   170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76248515, 'precision': 0.58166116, 'recall': 0.7179191, 'specificity': 0.7179191, 'f1': 0.58166146, 'auroc': 0.7758738, 'binary_precision': 0.19924812, 'binary_recall': 0.6649937, 'binary_specificity': 0.7708445, 'binary_f1_score': 0.30662423}
confusion matrix:
      0     1
0  7165  2130
1   267   530
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 15:53:10.251453,epoch time: 0:19:56.903706,used: 0:19:56.903706,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9036096, 'precision': 0.9072465, 'recall': 0.90362054, 'specificity': 0.90362054, 'f1': 0.9033956, 'auroc': 0.9595609, 'binary_precision': 0.94579005, 'binary_recall': 0.8563472, 'binary_specificity': 0.9508939, 'binary_f1_score': 0.898849}
confusion matrix:
       0      1
0  24573   1269
1   3714  22140
---- Validation: 
scalar performance:
{'acc': 0.89622754, 'precision': 0.5308609, 'recall': 0.6109376, 'specificity': 0.6109376, 'f1': 0.53623563, 'auroc': 0.73470426, 'binary_precision': 0.08029648, 'binary_recall': 0.3110048, 'binary_specificity': 0.9108704, 'binary_f1_score': 0.12763868}
confusion matrix:
       0     1
0  15217  1489
1    288   130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8366032, 'precision': 0.6004492, 'recall': 0.69162285, 'specificity': 0.69162285, 'f1': 0.6205741, 'auroc': 0.79346865, 'binary_precision': 0.24642856, 'binary_recall': 0.5194479, 'binary_specificity': 0.8637977, 'binary_f1_score': 0.3342753}
confusion matrix:
      0     1
0  8029  1266
1   383   414
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 16:12:47.517856,epoch time: 0:19:37.266403,used: 0:39:34.170109,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91537064, 'precision': 0.9206931, 'recall': 0.91537935, 'specificity': 0.91537935, 'f1': 0.9151033, 'auroc': 0.9708996, 'binary_precision': 0.96805125, 'binary_recall': 0.85912114, 'binary_specificity': 0.97163755, 'binary_f1_score': 0.9103392}
confusion matrix:
       0      1
0  25111    733
1   3642  22210
---- Validation: 
scalar performance:
{'acc': 0.9076734, 'precision': 0.5411864, 'recall': 0.6342974, 'specificity': 0.6342974, 'f1': 0.5530832, 'auroc': 0.76680243, 'binary_precision': 0.09979353, 'binary_recall': 0.34688994, 'binary_specificity': 0.92170477, 'binary_f1_score': 0.15499733}
confusion matrix:
       0     1
0  15398  1308
1    273   145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8567182, 'precision': 0.6183228, 'recall': 0.7036898, 'specificity': 0.7036898, 'f1': 0.6422388, 'auroc': 0.81892216, 'binary_precision': 0.2808913, 'binary_recall': 0.52195734, 'binary_specificity': 0.8854223, 'binary_f1_score': 0.36523265}
confusion matrix:
      0     1
0  8230  1065
1   381   416
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 16:31:48.217726,epoch time: 0:19:00.699870,used: 0:58:34.869979,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93063295, 'precision': 0.93334126, 'recall': 0.9306421, 'specificity': 0.9306421, 'f1': 0.93052536, 'auroc': 0.9769429, 'binary_precision': 0.9676579, 'binary_recall': 0.8910807, 'binary_specificity': 0.9702035, 'binary_f1_score': 0.92779183}
confusion matrix:
       0      1
0  25072    770
1   2816  23038
---- Validation: 
scalar performance:
{'acc': 0.9061551, 'precision': 0.5512954, 'recall': 0.6778364, 'specificity': 0.6778364, 'f1': 0.56785667, 'auroc': 0.7919835, 'binary_precision': 0.117684886, 'binary_recall': 0.43779904, 'binary_specificity': 0.9178738, 'binary_f1_score': 0.1855043}
confusion matrix:
       0     1
0  15334  1372
1    235   183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8634562, 'precision': 0.625255, 'recall': 0.7073477, 'specificity': 0.7073477, 'f1': 0.6499021, 'auroc': 0.82940006, 'binary_precision': 0.29440907, 'binary_recall': 0.52195734, 'binary_specificity': 0.89273804, 'binary_f1_score': 0.37647057}
confusion matrix:
      0    1
0  8298  997
1   381  416
new oracle model saved
early stop counter: 1
val acc:0.9061551094055176, best validation acc: 0.9076734185218811, corresponding to test acc:                         0.8567181825637817 / 0.8634561896324158
after epoch: 4,now: 2024-08-06 16:50:27.967896,epoch time: 0:18:39.750170,used: 1:17:14.620149,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9385639, 'precision': 0.94151354, 'recall': 0.93856865, 'specificity': 0.93856865, 'f1': 0.93846154, 'auroc': 0.9819285, 'binary_precision': 0.97762984, 'binary_recall': 0.89768285, 'binary_specificity': 0.97945446, 'binary_f1_score': 0.93595225}
confusion matrix:
       0      1
0  25314    531
1   2645  23206
---- Validation: 
scalar performance:
{'acc': 0.92040414, 'precision': 0.5632765, 'recall': 0.688638, 'specificity': 0.688638, 'f1': 0.58624375, 'auroc': 0.8037821, 'binary_precision': 0.14123006, 'binary_recall': 0.4449761, 'binary_specificity': 0.9322998, 'binary_f1_score': 0.21440922}
confusion matrix:
       0     1
0  15575  1131
1    232   186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8797067, 'precision': 0.64216423, 'recall': 0.70756626, 'specificity': 0.70756626, 'f1': 0.6654983, 'auroc': 0.844216, 'binary_precision': 0.32895815, 'binary_recall': 0.50313675, 'binary_specificity': 0.9119957, 'binary_f1_score': 0.39781746}
confusion matrix:
      0    1
0  8477  818
1   396  401
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 17:09:14.111419,epoch time: 0:18:46.143523,used: 1:36:00.763672,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9428002, 'precision': 0.94603837, 'recall': 0.9428101, 'specificity': 0.9428101, 'f1': 0.9426971, 'auroc': 0.98446584, 'binary_precision': 0.9841008, 'binary_recall': 0.9001702, 'binary_specificity': 0.98545, 'binary_f1_score': 0.94026625}
confusion matrix:
       0      1
0  25466    376
1   2581  23273
---- Validation: 
scalar performance:
{'acc': 0.93179166, 'precision': 0.57661855, 'recall': 0.6979729, 'specificity': 0.6979729, 'f1': 0.60439277, 'auroc': 0.8127931, 'binary_precision': 0.16755319, 'binary_recall': 0.45215312, 'binary_specificity': 0.94379264, 'binary_f1_score': 0.24450195}
confusion matrix:
       0    1
0  15767  939
1    229  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89466906, 'precision': 0.66201055, 'recall': 0.7030705, 'specificity': 0.7030705, 'f1': 0.6791833, 'auroc': 0.84955287, 'binary_precision': 0.3701172, 'binary_recall': 0.47553325, 'binary_specificity': 0.93060786, 'binary_f1_score': 0.4162548}
confusion matrix:
      0    1
0  8650  645
1   418  379
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-06 17:28:08.018810,epoch time: 0:18:53.907391,used: 1:54:54.671063,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9496673, 'precision': 0.95154464, 'recall': 0.94967103, 'specificity': 0.94967103, 'f1': 0.94961524, 'auroc': 0.9868641, 'binary_precision': 0.9806889, 'binary_recall': 0.9174113, 'binary_specificity': 0.98193073, 'binary_f1_score': 0.9479954}
confusion matrix:
       0      1
0  25378    467
1   2135  23716
---- Validation: 
scalar performance:
{'acc': 0.9225648, 'precision': 0.5724823, 'recall': 0.7177352, 'specificity': 0.7177352, 'f1': 0.59987617, 'auroc': 0.823136, 'binary_precision': 0.15813252, 'binary_recall': 0.50239235, 'binary_specificity': 0.93307793, 'binary_f1_score': 0.24054983}
confusion matrix:
       0     1
0  15588  1118
1    208   210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89139915, 'precision': 0.6614641, 'recall': 0.7185022, 'specificity': 0.7185022, 'f1': 0.6836941, 'auroc': 0.85365874, 'binary_precision': 0.36615935, 'binary_recall': 0.5131744, 'binary_specificity': 0.92383003, 'binary_f1_score': 0.42737725}
confusion matrix:
      0    1
0  8587  708
1   388  409
early stop counter: 1
val acc:0.9225648045539856, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.8946690559387207
after epoch: 7,now: 2024-08-06 17:47:08.169566,epoch time: 0:19:00.150756,used: 2:13:54.821819,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95305246, 'precision': 0.9542931, 'recall': 0.9530575, 'specificity': 0.9530575, 'f1': 0.95302075, 'auroc': 0.9880292, 'binary_precision': 0.97808164, 'binary_recall': 0.92689437, 'binary_specificity': 0.9792207, 'binary_f1_score': 0.9518003}
confusion matrix:
       0      1
0  25306    537
1   1890  23963
---- Validation: 
scalar performance:
{'acc': 0.92250645, 'precision': 0.57470334, 'recall': 0.72703516, 'specificity': 0.72703516, 'f1': 0.6032281, 'auroc': 0.8297917, 'binary_precision': 0.16208178, 'binary_recall': 0.5215311, 'binary_specificity': 0.9325392, 'binary_f1_score': 0.24730572}
confusion matrix:
       0     1
0  15579  1127
1    200   218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8947681, 'precision': 0.6664699, 'recall': 0.7174634, 'specificity': 0.7174634, 'f1': 0.68704855, 'auroc': 0.8570903, 'binary_precision': 0.37651443, 'binary_recall': 0.5069009, 'binary_specificity': 0.92802584, 'binary_f1_score': 0.43208554}
confusion matrix:
      0    1
0  8626  669
1   393  404
new oracle model saved
early stop counter: 2
val acc:0.9225064516067505, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.8947681188583374
after epoch: 8,now: 2024-08-06 18:05:57.516121,epoch time: 0:18:49.346555,used: 2:32:44.168374,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9559347, 'precision': 0.956481, 'recall': 0.9559374, 'specificity': 0.9559374, 'f1': 0.9559217, 'auroc': 0.9893893, 'binary_precision': 0.97231126, 'binary_recall': 0.9386121, 'binary_specificity': 0.97326267, 'binary_f1_score': 0.95516455}
confusion matrix:
       0      1
0  25153    691
1   1587  24265
---- Validation: 
scalar performance:
{'acc': 0.9102429, 'precision': 0.5695642, 'recall': 0.74757355, 'specificity': 0.74757355, 'f1': 0.59552103, 'auroc': 0.83314496, 'binary_precision': 0.15053092, 'binary_recall': 0.576555, 'binary_specificity': 0.9185921, 'binary_f1_score': 0.23873204}
confusion matrix:
       0     1
0  15346  1360
1    177   241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8909037, 'precision': 0.66464376, 'recall': 0.7319987, 'specificity': 0.7319987, 'f1': 0.68991315, 'auroc': 0.8589328, 'binary_precision': 0.37008548, 'binary_recall': 0.54328734, 'binary_specificity': 0.9207101, 'binary_f1_score': 0.44026437}
confusion matrix:
      0    1
0  8558  737
1   364  433
early stop counter: 3
val acc:0.9102429151535034, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.8947681188583374
after epoch: 9,now: 2024-08-06 18:24:50.185058,epoch time: 0:18:52.668937,used: 2:51:36.837311,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95804316, 'precision': 0.95906293, 'recall': 0.95804864, 'specificity': 0.95804864, 'f1': 0.9580202, 'auroc': 0.99011827, 'binary_precision': 0.98075753, 'binary_recall': 0.93443954, 'binary_specificity': 0.98165774, 'binary_f1_score': 0.9570384}
confusion matrix:
       0      1
0  25368    474
1   1695  24159
---- Validation: 
scalar performance:
{'acc': 0.92116326, 'precision': 0.5771815, 'recall': 0.7426742, 'specificity': 0.7426742, 'f1': 0.60708266, 'auroc': 0.8367493, 'binary_precision': 0.1661891, 'binary_recall': 0.5550239, 'binary_specificity': 0.93032444, 'binary_f1_score': 0.2557883}
confusion matrix:
       0     1
0  15542  1164
1    186   232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8973444, 'precision': 0.6712075, 'recall': 0.71886194, 'specificity': 0.71886194, 'f1': 0.69084466, 'auroc': 0.8615327, 'binary_precision': 0.38586438, 'binary_recall': 0.5069009, 'binary_specificity': 0.930823, 'binary_f1_score': 0.43817788}
confusion matrix:
      0    1
0  8652  643
1   393  404
new oracle model saved
early stop counter: 4
val acc:0.9211632609367371, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.8973444104194641
after epoch: 10,now: 2024-08-06 18:43:46.005577,epoch time: 0:18:55.820519,used: 3:10:32.657830,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9586815, 'precision': 0.9593364, 'recall': 0.9586815, 'specificity': 0.9586815, 'f1': 0.9586668, 'auroc': 0.9905752, 'binary_precision': 0.9766806, 'binary_recall': 0.93980193, 'binary_specificity': 0.9775611, 'binary_f1_score': 0.95788646}
confusion matrix:
       0      1
0  25268    580
1   1556  24292
---- Validation: 
scalar performance:
{'acc': 0.92478395, 'precision': 0.58134174, 'recall': 0.74569607, 'specificity': 0.74569607, 'f1': 0.6130202, 'auroc': 0.839447, 'binary_precision': 0.1744012, 'binary_recall': 0.55741626, 'binary_specificity': 0.9339758, 'binary_f1_score': 0.26567844}
confusion matrix:
       0     1
0  15603  1103
1    185   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9006143, 'precision': 0.67741466, 'recall': 0.72006357, 'specificity': 0.72006357, 'f1': 0.6954825, 'auroc': 0.8616543, 'binary_precision': 0.39822134, 'binary_recall': 0.50564617, 'binary_specificity': 0.9344809, 'binary_f1_score': 0.44555002}
confusion matrix:
      0    1
0  8686  609
1   394  403
new oracle model saved
early stop counter: 5
val acc:0.9247839450836182, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.900614321231842
after epoch: 11,now: 2024-08-06 19:02:37.686412,epoch time: 0:18:51.680835,used: 3:29:24.338665,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9614864, 'precision': 0.9619071, 'recall': 0.96148753, 'specificity': 0.96148753, 'f1': 0.9614777, 'auroc': 0.9916291, 'binary_precision': 0.9758666, 'binary_recall': 0.946383, 'binary_specificity': 0.9765921, 'binary_f1_score': 0.9608987}
confusion matrix:
       0      1
0  25241    605
1   1386  24464
---- Validation: 
scalar performance:
{'acc': 0.9146227, 'precision': 0.57456106, 'recall': 0.7556495, 'specificity': 0.7556495, 'f1': 0.6032598, 'auroc': 0.8452953, 'binary_precision': 0.16015625, 'binary_recall': 0.5885168, 'binary_specificity': 0.92278224, 'binary_f1_score': 0.2517912}
confusion matrix:
       0     1
0  15416  1290
1    172   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8960563, 'precision': 0.6744244, 'recall': 0.7388108, 'specificity': 0.7388108, 'f1': 0.69936556, 'auroc': 0.8659365, 'binary_precision': 0.3886926, 'binary_recall': 0.55207026, 'binary_specificity': 0.92555135, 'binary_f1_score': 0.4561949}
confusion matrix:
      0    1
0  8603  692
1   357  440
early stop counter: 6
val acc:0.9146227240562439, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.900614321231842
after epoch: 12,now: 2024-08-06 19:21:29.761423,epoch time: 0:18:52.075011,used: 3:48:16.413676,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9642719, 'precision': 0.96534216, 'recall': 0.96427464, 'specificity': 0.96427464, 'f1': 0.96425146, 'auroc': 0.9929448, 'binary_precision': 0.98768795, 'binary_recall': 0.9402731, 'binary_specificity': 0.98827624, 'binary_f1_score': 0.96339744}
confusion matrix:
       0      1
0  25542    303
1   1544  24307
---- Validation: 
scalar performance:
{'acc': 0.92688626, 'precision': 0.5843235, 'recall': 0.749106, 'specificity': 0.749106, 'f1': 0.6172231, 'auroc': 0.8448453, 'binary_precision': 0.18021472, 'binary_recall': 0.56220096, 'binary_specificity': 0.936011, 'binary_f1_score': 0.27293846}
confusion matrix:
       0     1
0  15637  1069
1    183   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90229887, 'precision': 0.6790825, 'recall': 0.7140953, 'specificity': 0.7140953, 'f1': 0.6943836, 'auroc': 0.86373603, 'binary_precision': 0.40267766, 'binary_recall': 0.4905897, 'binary_specificity': 0.93760085, 'binary_f1_score': 0.44230765}
confusion matrix:
      0    1
0  8715  580
1   406  391
new oracle model saved
early stop counter: 7
val acc:0.926886260509491, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.9022988677024841
after epoch: 13,now: 2024-08-06 19:40:14.274290,epoch time: 0:18:44.512867,used: 4:07:00.926543,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96521974, 'precision': 0.96573013, 'recall': 0.96522295, 'specificity': 0.96522295, 'f1': 0.96521044, 'auroc': 0.9930165, 'binary_precision': 0.9811962, 'binary_recall': 0.94863266, 'binary_specificity': 0.98181325, 'binary_f1_score': 0.9646397}
confusion matrix:
       0      1
0  25373    470
1   1328  24525
---- Validation: 
scalar performance:
{'acc': 0.91427237, 'precision': 0.5752516, 'recall': 0.7601349, 'specificity': 0.7601349, 'f1': 0.60429394, 'auroc': 0.84954345, 'binary_precision': 0.16129032, 'binary_recall': 0.5980861, 'binary_specificity': 0.92218363, 'binary_f1_score': 0.25406504}
confusion matrix:
       0     1
0  15406  1300
1    168   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89942527, 'precision': 0.67717624, 'recall': 0.72744787, 'specificity': 0.72744787, 'f1': 0.697848, 'auroc': 0.86402667, 'binary_precision': 0.39638785, 'binary_recall': 0.523212, 'binary_specificity': 0.9316837, 'binary_f1_score': 0.4510546}
confusion matrix:
      0    1
0  8660  635
1   380  417
early stop counter: 8
val acc:0.9142723679542542, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.9022988677024841
after epoch: 14,now: 2024-08-06 19:59:01.121835,epoch time: 0:18:46.847545,used: 4:25:47.774088,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96560663, 'precision': 0.96646154, 'recall': 0.96560913, 'specificity': 0.96560913, 'f1': 0.96559095, 'auroc': 0.9934689, 'binary_precision': 0.9864608, 'binary_recall': 0.94418013, 'binary_specificity': 0.98703814, 'binary_f1_score': 0.96485746}
confusion matrix:
       0      1
0  25510    335
1   1443  24408
---- Validation: 
scalar performance:
{'acc': 0.9090166, 'precision': 0.5712806, 'recall': 0.75977373, 'specificity': 0.75977373, 'f1': 0.59800833, 'auroc': 0.84895647, 'binary_precision': 0.15328467, 'binary_recall': 0.6028708, 'binary_specificity': 0.91667664, 'binary_f1_score': 0.24442288}
confusion matrix:
       0     1
0  15314  1392
1    166   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9010107, 'precision': 0.67776364, 'recall': 0.7185581, 'specificity': 0.7185581, 'f1': 0.6951769, 'auroc': 0.86278117, 'binary_precision': 0.3992016, 'binary_recall': 0.5018821, 'binary_specificity': 0.935234, 'binary_f1_score': 0.4446915}
confusion matrix:
      0    1
0  8693  602
1   397  400
early stop counter: 9
val acc:0.9090166091918945, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.9022988677024841
after epoch: 15,now: 2024-08-06 20:17:51.619493,epoch time: 0:18:50.497658,used: 4:44:38.271746,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.966303, 'precision': 0.9672328, 'recall': 0.9663047, 'specificity': 0.9663047, 'f1': 0.9662863, 'auroc': 0.99395096, 'binary_precision': 0.9880952, 'binary_recall': 0.9439845, 'binary_specificity': 0.98862493, 'binary_f1_score': 0.9655363}
confusion matrix:
       0      1
0  25552    294
1   1448  24402
---- Validation: 
scalar performance:
{'acc': 0.91906095, 'precision': 0.5784977, 'recall': 0.75675786, 'specificity': 0.75675786, 'f1': 0.6091896, 'auroc': 0.85056543, 'binary_precision': 0.16803841, 'binary_recall': 0.5861244, 'binary_specificity': 0.92739135, 'binary_f1_score': 0.26119402}
confusion matrix:
       0     1
0  15493  1213
1    173   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9053706, 'precision': 0.68352306, 'recall': 0.7065859, 'specificity': 0.7065859, 'f1': 0.6941012, 'auroc': 0.8653833, 'binary_precision': 0.4129956, 'binary_recall': 0.47051442, 'binary_specificity': 0.94265735, 'binary_f1_score': 0.4398827}
confusion matrix:
      0    1
0  8762  533
1   422  375
new oracle model saved
early stop counter: 10
val acc:0.9190609455108643, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.9053705930709839
after epoch: 16,now: 2024-08-06 20:36:34.351100,epoch time: 0:18:42.731607,used: 5:03:21.003353,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96721214, 'precision': 0.9678937, 'recall': 0.9672129, 'specificity': 0.9672129, 'f1': 0.9672003, 'auroc': 0.9941752, 'binary_precision': 0.9857614, 'binary_recall': 0.9481218, 'binary_specificity': 0.98630404, 'binary_f1_score': 0.9665753}
confusion matrix:
       0      1
0  25493    354
1   1341  24508
---- Validation: 
scalar performance:
{'acc': 0.9108269, 'precision': 0.5720279, 'recall': 0.7572028, 'specificity': 0.7572028, 'f1': 0.5992687, 'auroc': 0.8525887, 'binary_precision': 0.1549471, 'binary_recall': 0.59569377, 'binary_specificity': 0.91871184, 'binary_f1_score': 0.24592593}
confusion matrix:
       0     1
0  15348  1358
1    169   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90378517, 'precision': 0.68227816, 'recall': 0.71490216, 'specificity': 0.71490216, 'f1': 0.6967047, 'auroc': 0.86524314, 'binary_precision': 0.4089958, 'binary_recall': 0.4905897, 'binary_specificity': 0.93921465, 'binary_f1_score': 0.4460924}
confusion matrix:
      0    1
0  8730  565
1   406  391
early stop counter: 11
val acc:0.9108269214630127, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.9053705930709839
after epoch: 17,now: 2024-08-06 20:55:20.966054,epoch time: 0:18:46.614954,used: 5:22:07.618307,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9680633, 'precision': 0.96837676, 'recall': 0.9680658, 'specificity': 0.9680658, 'f1': 0.9680581, 'auroc': 0.99437284, 'binary_precision': 0.98054165, 'binary_recall': 0.95509225, 'binary_specificity': 0.98103935, 'binary_f1_score': 0.96764964}
confusion matrix:
       0      1
0  25353    490
1   1161  24692
---- Validation: 
scalar performance:
{'acc': 0.9043448, 'precision': 0.56840515, 'recall': 0.7608781, 'specificity': 0.7608781, 'f1': 0.5932011, 'auroc': 0.8511909, 'binary_precision': 0.14739884, 'binary_recall': 0.6100478, 'binary_specificity': 0.91170835, 'binary_f1_score': 0.23743017}
confusion matrix:
       0     1
0  15231  1475
1    163   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9034879, 'precision': 0.682931, 'recall': 0.7199029, 'specificity': 0.7199029, 'f1': 0.6990261, 'auroc': 0.86738527, 'binary_precision': 0.4094166, 'binary_recall': 0.5018821, 'binary_specificity': 0.9379236, 'binary_f1_score': 0.4509583}
confusion matrix:
      0    1
0  8718  577
1   397  400
early stop counter: 12
val acc:0.9043447971343994, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.9053705930709839
after epoch: 18,now: 2024-08-06 21:14:25.538542,epoch time: 0:19:04.572488,used: 5:41:12.190795,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96974623, 'precision': 0.9701576, 'recall': 0.9697479, 'specificity': 0.9697479, 'f1': 0.9697397, 'auroc': 0.99451745, 'binary_precision': 0.9840941, 'binary_recall': 0.95493406, 'binary_specificity': 0.9845618, 'binary_f1_score': 0.9692948}
confusion matrix:
       0      1
0  25446    399
1   1165  24686
---- Validation: 
scalar performance:
{'acc': 0.8950596, 'precision': 0.56371415, 'recall': 0.76428306, 'specificity': 0.76428306, 'f1': 0.58474004, 'auroc': 0.8555324, 'binary_precision': 0.13767736, 'binary_recall': 0.6267943, 'binary_specificity': 0.90177184, 'binary_f1_score': 0.22576477}
confusion matrix:
       0     1
0  15065  1641
1    156   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9019025, 'precision': 0.68577826, 'recall': 0.7442788, 'specificity': 0.7442788, 'f1': 0.7093814, 'auroc': 0.87077034, 'binary_precision': 0.4107308, 'binary_recall': 0.5570891, 'binary_specificity': 0.93146855, 'binary_f1_score': 0.47284344}
confusion matrix:
      0    1
0  8658  637
1   353  444
early stop counter: 13
val acc:0.8950595855712891, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.9053705930709839
after epoch: 19,now: 2024-08-06 21:33:39.655031,epoch time: 0:19:14.116489,used: 6:00:26.307284,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97028786, 'precision': 0.97082627, 'recall': 0.9702904, 'specificity': 0.9702904, 'f1': 0.97027946, 'auroc': 0.9951988, 'binary_precision': 0.9867873, 'binary_recall': 0.9533498, 'binary_specificity': 0.9872311, 'binary_f1_score': 0.96978045}
confusion matrix:
       0      1
0  25514    330
1   1206  24646
---- Validation: 
scalar performance:
{'acc': 0.8899206, 'precision': 0.5621547, 'recall': 0.76981294, 'specificity': 0.76981294, 'f1': 0.58140427, 'auroc': 0.8576412, 'binary_precision': 0.13416459, 'binary_recall': 0.6435407, 'binary_specificity': 0.89608526, 'binary_f1_score': 0.22203879}
confusion matrix:
       0     1
0  14970  1736
1    149   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8995244, 'precision': 0.6830625, 'recall': 0.75044405, 'specificity': 0.75044405, 'f1': 0.70926154, 'auroc': 0.8726702, 'binary_precision': 0.4040672, 'binary_recall': 0.57340026, 'binary_specificity': 0.9274879, 'binary_f1_score': 0.47406638}
confusion matrix:
      0    1
0  8621  674
1   340  457
early stop counter: 14
val acc:0.8899205923080444, best validation acc: 0.9317916631698608, corresponding to test acc:                         0.8946690559387207 / 0.9053705930709839
after epoch: 20,now: 2024-08-06 21:52:58.065149,epoch time: 0:19:18.410118,used: 6:19:44.717402,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_33_13_seed_2_24076669
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:19:44.717402 at 2024-08-06 21:52:58.065149
persisted model performance metric: 

scalar performance:
{'acc': 0.89466906, 'precision': 0.66201055, 'recall': 0.7030705, 'specificity': 0.7030705, 'f1': 0.6791833, 'auroc': 0.84955287, 'binary_precision': 0.3701172, 'binary_recall': 0.47553325, 'binary_specificity': 0.93060786, 'binary_f1_score': 0.4162548}
confusion matrix:
      0    1
0  8650  645
1   418  379
oracle model performance metric: 

scalar performance:
{'acc': 0.9053706, 'precision': 0.68352306, 'recall': 0.7065859, 'specificity': 0.7065859, 'f1': 0.6941012, 'auroc': 0.8653833, 'binary_precision': 0.4129956, 'binary_recall': 0.47051442, 'binary_specificity': 0.94265735, 'binary_f1_score': 0.4398827}
confusion matrix:
      0    1
0  8762  533
1   422  375
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  16662 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8528 MiB |  25072 MiB |  16558 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     40 MiB |     42 MiB |     70 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40149 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |   8416 KiB |  22549 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6957    |  280986 K  |  280981 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141129 K  |  141125 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6957    |  280986 K  |  280981 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141129 K  |  141125 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     370    |    1061    |     692    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      20    |      21    |      35    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3255    |  154667 K  |  154667 K  |
|       from large pool |      11    |     352    |   94473 K  |   94473 K  |
|       from small pool |      22    |    3245    |   60194 K  |   60194 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8528 MiB |  25072 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  26624 KiB |     42 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |  22555 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  280986 K  |  280986 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141129 K  |  141129 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  280986 K  |  280986 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141129 K  |  141129 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     370    |    1061    |    1038    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      13    |      21    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3255    |  154669 K  |  154669 K  |
|       from large pool |       3    |     352    |   94473 K  |   94473 K  |
|       from small pool |       0    |    3245    |   60196 K  |   60196 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug  6 22:12:09 2024]
Finished job 0.
1 of 1 steps (100%) done
