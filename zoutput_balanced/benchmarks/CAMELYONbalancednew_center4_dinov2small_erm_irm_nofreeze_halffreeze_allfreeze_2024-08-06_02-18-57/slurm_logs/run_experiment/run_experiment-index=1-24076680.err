Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 22:13:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680

 Experiment start at: 2024-08-06 22:23:08.468809
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98730654, 'precision': 0.98733693, 'recall': 0.98730814, 'specificity': 0.98730814, 'f1': 0.98730636, 'auroc': 0.99873424, 'binary_precision': 0.99128634, 'binary_recall': 0.98326623, 'binary_specificity': 0.99135005, 'binary_f1_score': 0.9872599}
confusion matrix:
       0      1
0  25099    219
1    424  24914
---- Validation: 
scalar performance:
{'acc': 0.9615654, 'precision': 0.6675339, 'recall': 0.80876553, 'specificity': 0.80876553, 'f1': 0.71477234, 'auroc': 0.9205241, 'binary_precision': 0.34398976, 'binary_recall': 0.64819276, 'binary_specificity': 0.96933836, 'binary_f1_score': 0.449457}
confusion matrix:
       0    1
0  16218  513
1    146  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212972, 'precision': 0.73106515, 'recall': 0.8136132, 'specificity': 0.8136132, 'f1': 0.76389694, 'auroc': 0.90773857, 'binary_precision': 0.4889299, 'binary_recall': 0.6865285, 'binary_specificity': 0.9406979, 'binary_f1_score': 0.5711207}
confusion matrix:
      0    1
0  8788  554
1   242  530
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 22:42:23.523567,epoch time: 0:19:15.054758,used: 0:19:15.054758,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9907612, 'precision': 0.9907979, 'recall': 0.99076366, 'specificity': 0.99076366, 'f1': 0.9907611, 'auroc': 0.99944055, 'binary_precision': 0.99518234, 'binary_recall': 0.9863073, 'binary_specificity': 0.99522007, 'binary_f1_score': 0.990725}
confusion matrix:
       0      1
0  25193    121
1    347  24995
---- Validation: 
scalar performance:
{'acc': 0.9631984, 'precision': 0.6862546, 'recall': 0.88479817, 'specificity': 0.88479817, 'f1': 0.7471843, 'auroc': 0.9540735, 'binary_precision': 0.37755102, 'binary_recall': 0.80240965, 'binary_specificity': 0.9671866, 'binary_f1_score': 0.51349264}
confusion matrix:
       0    1
0  16182  549
1     82  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91210204, 'precision': 0.71468824, 'recall': 0.82824254, 'specificity': 0.82824254, 'f1': 0.7549988, 'auroc': 0.91116, 'binary_precision': 0.45293644, 'binary_recall': 0.72927463, 'binary_specificity': 0.92721045, 'binary_f1_score': 0.5588089}
confusion matrix:
      0    1
0  8662  680
1   209  563
better model found
persisted
after epoch: 2,now: 2024-08-06 23:00:27.924899,epoch time: 0:18:04.401332,used: 0:37:19.456090,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9853127, 'precision': 0.9853183, 'recall': 0.98531353, 'specificity': 0.98531353, 'f1': 0.98531264, 'auroc': 0.9988118, 'binary_precision': 0.9870881, 'binary_recall': 0.98350435, 'binary_specificity': 0.9871228, 'binary_f1_score': 0.9852929}
confusion matrix:
       0      1
0  24990    326
1    418  24922
---- Validation: 
scalar performance:
{'acc': 0.9760877, 'precision': 0.74639297, 'recall': 0.68813896, 'specificity': 0.68813896, 'f1': 0.71307, 'auroc': 0.9392495, 'binary_precision': 0.50793654, 'binary_recall': 0.38554215, 'binary_specificity': 0.99073577, 'binary_f1_score': 0.43835616}
confusion matrix:
       0    1
0  16576  155
1    255  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92485666, 'precision': 0.73859006, 'recall': 0.80365705, 'specificity': 0.80365705, 'f1': 0.7659184, 'auroc': 0.9044248, 'binary_precision': 0.50595236, 'binary_recall': 0.66062176, 'binary_specificity': 0.94669235, 'binary_f1_score': 0.5730337}
confusion matrix:
      0    1
0  8844  498
1   262  510
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 23:18:44.206173,epoch time: 0:18:16.281274,used: 0:55:35.737364,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9927156, 'precision': 0.9927361, 'recall': 0.99271756, 'specificity': 0.99271756, 'f1': 0.9927155, 'auroc': 0.9995601, 'binary_precision': 0.99606705, 'binary_recall': 0.98934615, 'binary_specificity': 0.996089, 'binary_f1_score': 0.9926952}
confusion matrix:
       0      1
0  25214     99
1    270  25073
---- Validation: 
scalar performance:
{'acc': 0.97567946, 'precision': 0.7421944, 'recall': 0.7302274, 'specificity': 0.7302274, 'f1': 0.7360474, 'auroc': 0.94249666, 'binary_precision': 0.49746192, 'binary_recall': 0.47228914, 'binary_specificity': 0.9881657, 'binary_f1_score': 0.4845488}
confusion matrix:
       0    1
0  16533  198
1    219  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9198141, 'precision': 0.710213, 'recall': 0.6785332, 'specificity': 0.6785332, 'f1': 0.69267654, 'auroc': 0.89857125, 'binary_precision': 0.46986088, 'binary_recall': 0.39378238, 'binary_specificity': 0.9632841, 'binary_f1_score': 0.42847073}
confusion matrix:
      0    1
0  8999  343
1   468  304
early stop counter: 1
val acc:0.9756794571876526, best validation acc: 0.9760876893997192, corresponding to test acc:                         0.9248566627502441 / 0.9248566627502441
after epoch: 4,now: 2024-08-06 23:36:59.332728,epoch time: 0:18:15.126555,used: 1:13:50.863919,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99303144, 'precision': 0.99304956, 'recall': 0.9930294, 'specificity': 0.9930294, 'f1': 0.9930313, 'auroc': 0.99976397, 'binary_precision': 0.9902319, 'binary_recall': 0.9958968, 'binary_specificity': 0.990162, 'binary_f1_score': 0.99305624}
confusion matrix:
       0      1
0  25061    249
1    104  25242
---- Validation: 
scalar performance:
{'acc': 0.96844745, 'precision': 0.7071934, 'recall': 0.88278806, 'specificity': 0.88278806, 'f1': 0.7662214, 'auroc': 0.9524927, 'binary_precision': 0.41964287, 'binary_recall': 0.7927711, 'binary_specificity': 0.97280496, 'binary_f1_score': 0.54879063}
confusion matrix:
       0    1
0  16276  455
1     86  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9159581, 'precision': 0.71307683, 'recall': 0.7673503, 'specificity': 0.7673503, 'f1': 0.7360525, 'auroc': 0.89324164, 'binary_precision': 0.4606855, 'binary_recall': 0.5919689, 'binary_specificity': 0.94273174, 'binary_f1_score': 0.5181406}
confusion matrix:
      0    1
0  8807  535
1   315  457
early stop counter: 2
val acc:0.9684474468231201, best validation acc: 0.9760876893997192, corresponding to test acc:                         0.9248566627502441 / 0.9248566627502441
after epoch: 5,now: 2024-08-06 23:55:07.085692,epoch time: 0:18:07.752964,used: 1:31:58.616883,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9845625, 'precision': 0.9849076, 'recall': 0.9845542, 'specificity': 0.9845542, 'f1': 0.98455966, 'auroc': 0.99967754, 'binary_precision': 0.9721283, 'binary_recall': 0.99775094, 'binary_specificity': 0.97135746, 'binary_f1_score': 0.98477304}
confusion matrix:
       0      1
0  24587    725
1     57  25287
---- Validation: 
scalar performance:
{'acc': 0.9541584, 'precision': 0.6551027, 'recall': 0.86371696, 'specificity': 0.86371696, 'f1': 0.7120599, 'auroc': 0.947729, 'binary_precision': 0.3161546, 'binary_recall': 0.7686747, 'binary_specificity': 0.9587592, 'binary_f1_score': 0.44803366}
confusion matrix:
       0    1
0  16041  690
1     96  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86938894, 'precision': 0.6703222, 'recall': 0.86512995, 'specificity': 0.86512995, 'f1': 0.7130874, 'auroc': 0.91476274, 'binary_precision': 0.35375598, 'binary_recall': 0.8601036, 'binary_specificity': 0.8701563, 'binary_f1_score': 0.5013212}
confusion matrix:
      0     1
0  8129  1213
1   108   664
early stop counter: 3
val acc:0.9541584253311157, best validation acc: 0.9760876893997192, corresponding to test acc:                         0.9248566627502441 / 0.9248566627502441
after epoch: 6,now: 2024-08-07 00:13:14.002909,epoch time: 0:18:06.917217,used: 1:50:05.534100,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9935644, 'precision': 0.99360836, 'recall': 0.99356794, 'specificity': 0.99356794, 'f1': 0.9935643, 'auroc': 0.9998075, 'binary_precision': 0.9984461, 'binary_recall': 0.9886767, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.9935374}
confusion matrix:
       0      1
0  25271     39
1    287  25059
---- Validation: 
scalar performance:
{'acc': 0.9801703, 'precision': 0.79296005, 'recall': 0.77365124, 'specificity': 0.77365124, 'f1': 0.78295374, 'auroc': 0.95662713, 'binary_precision': 0.5968992, 'binary_recall': 0.5566265, 'binary_specificity': 0.990676, 'binary_f1_score': 0.5760598}
confusion matrix:
       0    1
0  16575  156
1    184  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9242634, 'precision': 0.73388994, 'recall': 0.7635281, 'specificity': 0.7635281, 'f1': 0.7475418, 'auroc': 0.91195154, 'binary_precision': 0.5034091, 'binary_recall': 0.5738342, 'binary_specificity': 0.95322204, 'binary_f1_score': 0.53631955}
confusion matrix:
      0    1
0  8905  437
1   329  443
better model found
persisted
after epoch: 7,now: 2024-08-07 00:31:23.397679,epoch time: 0:18:09.394770,used: 2:08:14.928870,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99293274, 'precision': 0.9929335, 'recall': 0.9929333, 'specificity': 0.9929333, 'f1': 0.99293274, 'auroc': 0.9995817, 'binary_precision': 0.99375594, 'binary_recall': 0.9921092, 'binary_specificity': 0.9937574, 'binary_f1_score': 0.9929319}
confusion matrix:
       0      1
0  25152    158
1    200  25146
---- Validation: 
scalar performance:
{'acc': 0.9752712, 'precision': 0.7432856, 'recall': 0.86513567, 'specificity': 0.86513567, 'f1': 0.7909465, 'auroc': 0.96199894, 'binary_precision': 0.49286845, 'binary_recall': 0.7493976, 'binary_specificity': 0.9808738, 'binary_f1_score': 0.5946463}
confusion matrix:
       0    1
0  16411  320
1    104  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.912893, 'precision': 0.70152473, 'recall': 0.74073696, 'specificity': 0.74073696, 'f1': 0.71875924, 'auroc': 0.9058066, 'binary_precision': 0.44195953, 'binary_recall': 0.53756475, 'binary_specificity': 0.9439092, 'binary_f1_score': 0.48509642}
confusion matrix:
      0    1
0  8818  524
1   357  415
early stop counter: 1
val acc:0.9752712249755859, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.9242634177207947 / 0.9248566627502441
after epoch: 8,now: 2024-08-07 00:49:29.585678,epoch time: 0:18:06.187999,used: 2:26:21.116869,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9905638, 'precision': 0.99073035, 'recall': 0.99056935, 'specificity': 0.99056935, 'f1': 0.99056304, 'auroc': 0.99985003, 'binary_precision': 0.9999196, 'binary_recall': 0.9812177, 'binary_specificity': 0.99992096, 'binary_f1_score': 0.99048036}
confusion matrix:
       0      1
0  25311      2
1    476  24867
---- Validation: 
scalar performance:
{'acc': 0.97719586, 'precision': 0.8390846, 'recall': 0.5500645, 'specificity': 0.5500645, 'f1': 0.58263993, 'auroc': 0.95894015, 'binary_precision': 0.7, 'binary_recall': 0.10120482, 'binary_specificity': 0.99892414, 'binary_f1_score': 0.17684212}
confusion matrix:
       0   1
0  16713  18
1    373  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210995, 'precision': 0.6604923, 'recall': 0.52712744, 'specificity': 0.52712744, 'f1': 0.53305405, 'auroc': 0.9059497, 'binary_precision': 0.39344263, 'binary_recall': 0.062176164, 'binary_specificity': 0.9920788, 'binary_f1_score': 0.10738255}
confusion matrix:
      0   1
0  9268  74
1   724  48
early stop counter: 2
val acc:0.9771958589553833, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.9242634177207947 / 0.9248566627502441
after epoch: 9,now: 2024-08-07 01:07:31.519116,epoch time: 0:18:01.933438,used: 2:44:23.050307,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99376184, 'precision': 0.9937713, 'recall': 0.9937631, 'specificity': 0.9937631, 'f1': 0.9937618, 'auroc': 0.9997491, 'binary_precision': 0.99607515, 'binary_recall': 0.99143714, 'binary_specificity': 0.9960891, 'binary_f1_score': 0.9937507}
confusion matrix:
       0      1
0  25215     99
1    217  25125
---- Validation: 
scalar performance:
{'acc': 0.97748744, 'precision': 0.7590412, 'recall': 0.8709711, 'specificity': 0.8709711, 'f1': 0.8042394, 'auroc': 0.96616757, 'binary_precision': 0.52412647, 'binary_recall': 0.7590361, 'binary_specificity': 0.982906, 'binary_f1_score': 0.62007874}
confusion matrix:
       0    1
0  16445  286
1    100  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9103223, 'precision': 0.6709983, 'recall': 0.6460644, 'specificity': 0.6460644, 'f1': 0.65719116, 'auroc': 0.8769679, 'binary_precision': 0.39631337, 'binary_recall': 0.3341969, 'binary_specificity': 0.95793194, 'binary_f1_score': 0.36261418}
confusion matrix:
      0    1
0  8949  393
1   514  258
early stop counter: 3
val acc:0.9774874448776245, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.9242634177207947 / 0.9248566627502441
after epoch: 10,now: 2024-08-07 01:25:33.236401,epoch time: 0:18:01.717285,used: 3:02:24.767592,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9713755, 'precision': 0.97280455, 'recall': 0.97135615, 'specificity': 0.97135615, 'f1': 0.97135305, 'auroc': 0.99956733, 'binary_precision': 0.9469884, 'binary_recall': 0.998698, 'binary_specificity': 0.94401425, 'binary_f1_score': 0.9721561}
confusion matrix:
       0      1
0  23893   1417
1     33  25313
---- Validation: 
scalar performance:
{'acc': 0.9392278, 'precision': 0.63626397, 'recall': 0.9300873, 'specificity': 0.9300873, 'f1': 0.69547945, 'auroc': 0.96565056, 'binary_precision': 0.27462256, 'binary_recall': 0.9204819, 'binary_specificity': 0.9396928, 'binary_f1_score': 0.42303428}
confusion matrix:
       0     1
0  15722  1009
1     33   382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8897568, 'precision': 0.67625356, 'recall': 0.8018871, 'specificity': 0.8018871, 'f1': 0.7148699, 'auroc': 0.8882785, 'binary_precision': 0.37931034, 'binary_recall': 0.6981865, 'binary_specificity': 0.9055877, 'binary_f1_score': 0.49156407}
confusion matrix:
      0    1
0  8460  882
1   233  539
early stop counter: 4
val acc:0.939227819442749, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.9242634177207947 / 0.9248566627502441
after epoch: 11,now: 2024-08-07 01:43:34.976158,epoch time: 0:18:01.739757,used: 3:20:26.507349,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99443305, 'precision': 0.99443454, 'recall': 0.99443346, 'specificity': 0.99443346, 'f1': 0.99443305, 'auroc': 0.99978447, 'binary_precision': 0.995413, 'binary_recall': 0.99344885, 'binary_specificity': 0.9954181, 'binary_f1_score': 0.99443}
confusion matrix:
       0      1
0  25201    116
1    166  25173
---- Validation: 
scalar performance:
{'acc': 0.97043043, 'precision': 0.7081849, 'recall': 0.80625844, 'specificity': 0.80625844, 'f1': 0.74697626, 'auroc': 0.95054376, 'binary_precision': 0.42556635, 'binary_recall': 0.63373494, 'binary_specificity': 0.9787819, 'binary_f1_score': 0.5091965}
confusion matrix:
       0    1
0  16376  355
1    152  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89301956, 'precision': 0.6955057, 'recall': 0.8737626, 'specificity': 0.8737626, 'f1': 0.74386823, 'auroc': 0.9142006, 'binary_precision': 0.40455666, 'binary_recall': 0.85103625, 'binary_specificity': 0.89648896, 'binary_f1_score': 0.548414}
confusion matrix:
      0    1
0  8375  967
1   115  657
early stop counter: 5
val acc:0.9704304337501526, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.9242634177207947 / 0.9248566627502441
after epoch: 12,now: 2024-08-07 02:01:41.621832,epoch time: 0:18:06.645674,used: 3:38:33.153023,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9894978, 'precision': 0.9897071, 'recall': 0.98950315, 'specificity': 0.98950315, 'f1': 0.9894967, 'auroc': 0.99975777, 'binary_precision': 0.9999597, 'binary_recall': 0.9790458, 'binary_specificity': 0.9999605, 'binary_f1_score': 0.9893922}
confusion matrix:
       0      1
0  25314      1
1    531  24810
---- Validation: 
scalar performance:
{'acc': 0.9792955, 'precision': 0.80889785, 'recall': 0.6686338, 'specificity': 0.6686338, 'f1': 0.71694785, 'auroc': 0.96328086, 'binary_precision': 0.6339286, 'binary_recall': 0.3421687, 'binary_specificity': 0.9950989, 'binary_f1_score': 0.44444445}
confusion matrix:
       0    1
0  16649   82
1    273  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.925351, 'precision': 0.7404703, 'recall': 0.81224275, 'specificity': 0.81224275, 'f1': 0.77013826, 'auroc': 0.9279551, 'binary_precision': 0.5082444, 'binary_recall': 0.6787565, 'binary_specificity': 0.94572896, 'binary_f1_score': 0.5812534}
confusion matrix:
      0    1
0  8835  507
1   248  524
new oracle model saved
early stop counter: 6
val acc:0.9792954921722412, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.9242634177207947 / 0.9253510236740112
after epoch: 13,now: 2024-08-07 02:19:40.908196,epoch time: 0:17:59.286364,used: 3:56:32.439387,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9955188, 'precision': 0.99554205, 'recall': 0.99552095, 'specificity': 0.99552095, 'f1': 0.9955187, 'auroc': 0.9998404, 'binary_precision': 0.9990859, 'binary_recall': 0.99195045, 'binary_specificity': 0.9990914, 'binary_f1_score': 0.99550533}
confusion matrix:
       0      1
0  25290     23
1    204  25139
---- Validation: 
scalar performance:
{'acc': 0.9775458, 'precision': 0.76004183, 'recall': 0.83222806, 'specificity': 0.83222806, 'f1': 0.7913816, 'auroc': 0.96074027, 'binary_precision': 0.5280899, 'binary_recall': 0.67951804, 'binary_specificity': 0.98493814, 'binary_f1_score': 0.59430975}
confusion matrix:
       0    1
0  16479  252
1    133  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9154637, 'precision': 0.7144573, 'recall': 0.7837188, 'specificity': 0.7837188, 'f1': 0.7425235, 'auroc': 0.91427284, 'binary_precision': 0.46058878, 'binary_recall': 0.6282383, 'binary_specificity': 0.9391993, 'binary_f1_score': 0.5315068}
confusion matrix:
      0    1
0  8774  568
1   287  485
early stop counter: 7
val acc:0.9775457978248596, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.9242634177207947 / 0.9253510236740112
after epoch: 14,now: 2024-08-07 02:37:41.879918,epoch time: 0:18:00.971722,used: 4:14:33.411109,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9926366, 'precision': 0.9926485, 'recall': 0.99263525, 'specificity': 0.99263525, 'f1': 0.99263656, 'auroc': 0.99969435, 'binary_precision': 0.99037707, 'binary_recall': 0.9949493, 'binary_specificity': 0.99032116, 'binary_f1_score': 0.9926579}
confusion matrix:
       0      1
0  25068    245
1    128  25215
---- Validation: 
scalar performance:
{'acc': 0.9736965, 'precision': 0.7359178, 'recall': 0.9125011, 'specificity': 0.9125011, 'f1': 0.7979568, 'auroc': 0.97130585, 'binary_precision': 0.47567567, 'binary_recall': 0.84819275, 'binary_specificity': 0.9768095, 'binary_f1_score': 0.6095238}
confusion matrix:
       0    1
0  16343  388
1     63  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86553293, 'precision': 0.6628728, 'recall': 0.8470006, 'specificity': 0.8470006, 'f1': 0.70318794, 'auroc': 0.89429235, 'binary_precision': 0.34210527, 'binary_recall': 0.8251295, 'binary_specificity': 0.86887175, 'binary_f1_score': 0.48367503}
confusion matrix:
      0     1
0  8117  1225
1   135   637
early stop counter: 8
val acc:0.9736964702606201, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.9242634177207947 / 0.9253510236740112
after epoch: 15,now: 2024-08-07 02:55:41.481222,epoch time: 0:17:59.601304,used: 4:32:33.012413,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99520296, 'precision': 0.99522257, 'recall': 0.9952049, 'specificity': 0.9952049, 'f1': 0.9952029, 'auroc': 0.9997244, 'binary_precision': 0.99849063, 'binary_recall': 0.991911, 'binary_specificity': 0.9984988, 'binary_f1_score': 0.99518996}
confusion matrix:
       0      1
0  25275     38
1    205  25138
---- Validation: 
scalar performance:
{'acc': 0.9760877, 'precision': 0.7474569, 'recall': 0.78683347, 'specificity': 0.78683347, 'f1': 0.7655761, 'auroc': 0.9483616, 'binary_precision': 0.505176, 'binary_recall': 0.5879518, 'binary_specificity': 0.98571515, 'binary_f1_score': 0.54342985}
confusion matrix:
       0    1
0  16492  239
1    171  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8958869, 'precision': 0.6885704, 'recall': 0.82184154, 'specificity': 0.82184154, 'f1': 0.7300757, 'auroc': 0.9021975, 'binary_precision': 0.4007067, 'binary_recall': 0.73445594, 'binary_specificity': 0.90922713, 'binary_f1_score': 0.5185185}
confusion matrix:
      0    1
0  8494  848
1   205  567
early stop counter: 9
val acc:0.9760876893997192, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.9242634177207947 / 0.9253510236740112
after epoch: 16,now: 2024-08-07 03:13:38.886698,epoch time: 0:17:57.405476,used: 4:50:30.417889,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99202466, 'precision': 0.99214494, 'recall': 0.99202967, 'specificity': 0.99202967, 'f1': 0.99202424, 'auroc': 0.99986583, 'binary_precision': 1.0, 'binary_recall': 0.98405933, 'binary_specificity': 1.0, 'binary_f1_score': 0.99196565}
confusion matrix:
       0      1
0  25312      0
1    404  24940
---- Validation: 
scalar performance:
{'acc': 0.9804036, 'precision': 0.79297435, 'recall': 0.79021984, 'specificity': 0.79021984, 'f1': 0.7915901, 'auroc': 0.97049826, 'binary_precision': 0.59610707, 'binary_recall': 0.5903614, 'binary_specificity': 0.9900783, 'binary_f1_score': 0.5932203}
confusion matrix:
       0    1
0  16565  166
1    170  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8284556, 'precision': 0.6380122, 'recall': 0.8429719, 'specificity': 0.8429719, 'f1': 0.666242, 'auroc': 0.91223484, 'binary_precision': 0.28982976, 'binary_recall': 0.8601036, 'binary_specificity': 0.8258403, 'binary_f1_score': 0.43356186}
confusion matrix:
      0     1
0  7715  1627
1   108   664
better model found
persisted
after epoch: 17,now: 2024-08-07 03:31:30.577138,epoch time: 0:17:51.690440,used: 5:08:22.108329,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99658483, 'precision': 0.99658614, 'recall': 0.9965855, 'specificity': 0.9965855, 'f1': 0.99658483, 'auroc': 0.99986136, 'binary_precision': 0.99758834, 'binary_recall': 0.995581, 'binary_specificity': 0.99759, 'binary_f1_score': 0.99658364}
confusion matrix:
       0      1
0  25250     61
1    112  25233
---- Validation: 
scalar performance:
{'acc': 0.97043043, 'precision': 0.7183437, 'recall': 0.9014281, 'specificity': 0.9014281, 'f1': 0.7802068, 'auroc': 0.96469593, 'binary_precision': 0.44102564, 'binary_recall': 0.82891566, 'binary_specificity': 0.9739406, 'binary_f1_score': 0.5757322}
confusion matrix:
       0    1
0  16295  436
1     71  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8824402, 'precision': 0.6884086, 'recall': 0.8941783, 'specificity': 0.8941783, 'f1': 0.7368444, 'auroc': 0.9264763, 'binary_precision': 0.38537657, 'binary_recall': 0.9080311, 'binary_specificity': 0.88032544, 'binary_f1_score': 0.54110384}
confusion matrix:
      0     1
0  8224  1118
1    71   701
early stop counter: 1
val acc:0.9704304337501526, best validation acc: 0.9804036021232605, corresponding to test acc:                         0.8284556269645691 / 0.9253510236740112
after epoch: 18,now: 2024-08-07 03:49:23.084760,epoch time: 0:17:52.507622,used: 5:26:14.615951,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99650586, 'precision': 0.9965143, 'recall': 0.9965073, 'specificity': 0.9965073, 'f1': 0.99650586, 'auroc': 0.9999161, 'binary_precision': 0.99873173, 'binary_recall': 0.9942787, 'binary_specificity': 0.9987358, 'binary_f1_score': 0.99650025}
confusion matrix:
       0      1
0  25280     32
1    145  25199
---- Validation: 
scalar performance:
{'acc': 0.9780707, 'precision': 0.76321375, 'recall': 0.8841942, 'specificity': 0.8841942, 'f1': 0.81146884, 'auroc': 0.97030216, 'binary_precision': 0.53181076, 'binary_recall': 0.7855422, 'binary_specificity': 0.9828462, 'binary_f1_score': 0.6342412}
confusion matrix:
       0    1
0  16444  287
1     89  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.844473, 'precision': 0.65490276, 'recall': 0.8748142, 'specificity': 0.8748142, 'f1': 0.6903884, 'auroc': 0.9215622, 'binary_precision': 0.31853193, 'binary_recall': 0.91062176, 'binary_specificity': 0.83900666, 'binary_f1_score': 0.47197047}
confusion matrix:
      0     1
0  7838  1504
1    69   703
early stop counter: 2
val acc:0.9780706763267517, best validation acc: 0.9804036021232605, corresponding to test acc:                         0.8284556269645691 / 0.9253510236740112
after epoch: 19,now: 2024-08-07 04:07:16.391090,epoch time: 0:17:53.306330,used: 5:44:07.922281,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9971968, 'precision': 0.9971975, 'recall': 0.9971973, 'specificity': 0.9971973, 'f1': 0.99719673, 'auroc': 0.9999372, 'binary_precision': 0.9979844, 'binary_recall': 0.99640924, 'binary_specificity': 0.99798524, 'binary_f1_score': 0.9971962}
confusion matrix:
       0      1
0  25262     51
1     91  25252
---- Validation: 
scalar performance:
{'acc': 0.9570745, 'precision': 0.66693205, 'recall': 0.88636, 'specificity': 0.88636, 'f1': 0.72781557, 'auroc': 0.95798296, 'binary_precision': 0.33869347, 'binary_recall': 0.8120482, 'binary_specificity': 0.9606718, 'binary_f1_score': 0.47801417}
confusion matrix:
       0    1
0  16073  658
1     78  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8038363, 'precision': 0.6311943, 'recall': 0.8587582, 'specificity': 0.8587582, 'f1': 0.6501065, 'auroc': 0.92152244, 'binary_precision': 0.2702805, 'binary_recall': 0.9235751, 'binary_specificity': 0.7939413, 'binary_f1_score': 0.4181818}
confusion matrix:
      0     1
0  7417  1925
1    59   713
early stop counter: 3
val acc:0.9570745229721069, best validation acc: 0.9804036021232605, corresponding to test acc:                         0.8284556269645691 / 0.9253510236740112
after epoch: 20,now: 2024-08-07 04:25:13.124116,epoch time: 0:17:56.733026,used: 6:02:04.655307,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:02:04.655307 at 2024-08-07 04:25:13.124116
persisted model performance metric: 

scalar performance:
{'acc': 0.8284556, 'precision': 0.6380122, 'recall': 0.8429719, 'specificity': 0.8429719, 'f1': 0.666242, 'auroc': 0.91223484, 'binary_precision': 0.28982976, 'binary_recall': 0.8601036, 'binary_specificity': 0.8258403, 'binary_f1_score': 0.43356186}
confusion matrix:
      0     1
0  7715  1627
1   108   664
oracle model performance metric: 

scalar performance:
{'acc': 0.925351, 'precision': 0.7404703, 'recall': 0.81224275, 'specificity': 0.81224275, 'f1': 0.77013826, 'auroc': 0.9279551, 'binary_precision': 0.5082444, 'binary_recall': 0.6787565, 'binary_specificity': 0.94572896, 'binary_f1_score': 0.5812534}
confusion matrix:
      0    1
0  8835  507
1   248  524
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459204 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555060 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 459204 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555060 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447934 KiB |  13213 MiB | 562427 GiB | 562426 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |  40859 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14412 MiB |  14412 MiB |  14412 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 415291 KiB |   1235 MiB | 450793 GiB | 450792 GiB |
|       from large pool | 406502 KiB |   1232 MiB | 442915 GiB | 442915 GiB |
|       from small pool |   8789 KiB |     17 MiB |   7877 GiB |   7877 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4934    |    7337    |  107646 K  |  107641 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56146 K  |   56141 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4934    |    7337    |  107646 K  |  107641 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56146 K  |   56141 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      66    |    3222    |   64345 K  |   64344 K  |
|       from large pool |      30    |     604    |   37573 K  |   37573 K  |
|       from small pool |      36    |    3191    |   26771 K  |   26771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562427 GiB | 562427 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450793 GiB | 450793 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     42 MiB |   7877 GiB |   7877 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64347 K  |   64347 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   26773 K  |   26773 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562427 GiB | 562427 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450793 GiB | 450793 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     42 MiB |   7877 GiB |   7877 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64347 K  |   64347 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   26773 K  |   26773 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680

 Experiment start at: 2024-08-07 04:47:54.682136
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9883341, 'precision': 0.98835754, 'recall': 0.9883317, 'specificity': 0.9883317, 'f1': 0.98833394, 'auroc': 0.9992164, 'binary_precision': 0.98515743, 'binary_recall': 0.9916257, 'binary_specificity': 0.9850376, 'binary_f1_score': 0.98838097}
confusion matrix:
       0      1
0  25017    380
1    213  25222
---- Validation: 
scalar performance:
{'acc': 0.93050283, 'precision': 0.6181953, 'recall': 0.8773335, 'specificity': 0.8773335, 'f1': 0.6681184, 'auroc': 0.9391055, 'binary_precision': 0.2413088, 'binary_recall': 0.8213457, 'binary_specificity': 0.93332136, 'binary_f1_score': 0.37302423}
confusion matrix:
       0     1
0  15579  1113
1     77   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9128927, 'precision': 0.7154268, 'recall': 0.84063125, 'specificity': 0.84063125, 'f1': 0.7585455, 'auroc': 0.8985144, 'binary_precision': 0.45181674, 'binary_recall': 0.7556143, 'binary_specificity': 0.92564815, 'binary_f1_score': 0.5654968}
confusion matrix:
      0    1
0  8640  694
1   185  572
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 05:07:17.255092,epoch time: 0:19:22.572956,used: 0:19:22.572956,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98782265, 'precision': 0.987847, 'recall': 0.9878198, 'specificity': 0.9878198, 'f1': 0.9878224, 'auroc': 0.9990717, 'binary_precision': 0.9846136, 'binary_recall': 0.99115497, 'binary_specificity': 0.98448455, 'binary_f1_score': 0.98787344}
confusion matrix:
       0      1
0  25000    394
1    225  25213
---- Validation: 
scalar performance:
{'acc': 0.74128366, 'precision': 0.54155993, 'recall': 0.84243864, 'specificity': 0.84243864, 'f1': 0.5015499, 'auroc': 0.9366286, 'binary_precision': 0.08490762, 'binary_recall': 0.9489559, 'binary_specificity': 0.7359214, 'binary_f1_score': 0.1558689}
confusion matrix:
       0     1
0  12284  4408
1     22   409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9093251, 'precision': 0.7129966, 'recall': 0.86237323, 'specificity': 0.86237323, 'f1': 0.7605616, 'auroc': 0.92505413, 'binary_precision': 0.4427536, 'binary_recall': 0.80713344, 'binary_specificity': 0.917613, 'binary_f1_score': 0.57182974}
confusion matrix:
      0    1
0  8565  769
1   146  611
early stop counter: 1
val acc:0.741283655166626, best validation acc: 0.9305028319358826, corresponding to test acc:                         0.9128926992416382 / 0.9128926992416382
after epoch: 2,now: 2024-08-07 05:25:39.730248,epoch time: 0:18:22.475156,used: 0:37:45.048112,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9911867, 'precision': 0.9912061, 'recall': 0.99118423, 'specificity': 0.99118423, 'f1': 0.9911865, 'auroc': 0.9995606, 'binary_precision': 0.9883144, 'binary_recall': 0.9941424, 'binary_specificity': 0.98822606, 'binary_f1_score': 0.9912198}
confusion matrix:
       0      1
0  25096    299
1    149  25288
---- Validation: 
scalar performance:
{'acc': 0.9648426, 'precision': 0.7003823, 'recall': 0.90624815, 'specificity': 0.90624815, 'f1': 0.7645397, 'auroc': 0.9560555, 'binary_precision': 0.40489432, 'binary_recall': 0.84454757, 'binary_specificity': 0.96794873, 'binary_f1_score': 0.5473684}
confusion matrix:
       0    1
0  16157  535
1     67  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9068477, 'precision': 0.7074914, 'recall': 0.85193, 'specificity': 0.85193, 'f1': 0.75351095, 'auroc': 0.905102, 'binary_precision': 0.43345454, 'binary_recall': 0.78731835, 'binary_specificity': 0.9165417, 'binary_f1_score': 0.55909944}
confusion matrix:
      0    1
0  8555  779
1   161  596
better model found
persisted
after epoch: 3,now: 2024-08-07 05:44:04.125700,epoch time: 0:18:24.395452,used: 0:56:09.443564,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9871144, 'precision': 0.9874107, 'recall': 0.9871248, 'specificity': 0.9871248, 'f1': 0.9871127, 'auroc': 0.9997318, 'binary_precision': 0.99963707, 'binary_recall': 0.97460395, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.98696184}
confusion matrix:
       0      1
0  25386      9
1    646  24791
---- Validation: 
scalar performance:
{'acc': 0.97699, 'precision': 0.7872352, 'recall': 0.6344646, 'specificity': 0.6344646, 'f1': 0.6814413, 'auroc': 0.95908815, 'binary_precision': 0.5929648, 'binary_recall': 0.2737819, 'binary_specificity': 0.99514735, 'binary_f1_score': 0.37460318}
confusion matrix:
       0    1
0  16611   81
1    313  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9290457, 'precision': 0.7442035, 'recall': 0.73647296, 'specificity': 0.73647296, 'f1': 0.7402581, 'auroc': 0.9292201, 'binary_precision': 0.52804375, 'binary_recall': 0.50990754, 'binary_specificity': 0.9630383, 'binary_f1_score': 0.51881725}
confusion matrix:
      0    1
0  8989  345
1   371  386
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 06:02:24.126854,epoch time: 0:18:20.001154,used: 1:14:29.444718,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99248505, 'precision': 0.99248695, 'recall': 0.99248445, 'specificity': 0.99248445, 'f1': 0.99248505, 'auroc': 0.9996631, 'binary_precision': 0.9916788, 'binary_recall': 0.9933163, 'binary_specificity': 0.99165255, 'binary_f1_score': 0.99249685}
confusion matrix:
       0      1
0  25185    212
1    170  25265
---- Validation: 
scalar performance:
{'acc': 0.9344157, 'precision': 0.62583226, 'recall': 0.8895117, 'specificity': 0.8895117, 'f1': 0.6789904, 'auroc': 0.94931364, 'binary_precision': 0.25599435, 'binary_recall': 0.8422274, 'binary_specificity': 0.93679607, 'binary_f1_score': 0.39264464}
confusion matrix:
       0     1
0  15637  1055
1     68   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9133882, 'precision': 0.706547, 'recall': 0.7795987, 'specificity': 0.7795987, 'f1': 0.73556733, 'auroc': 0.88184583, 'binary_precision': 0.44475922, 'binary_recall': 0.62219286, 'binary_specificity': 0.9370045, 'binary_f1_score': 0.5187225}
confusion matrix:
      0    1
0  8746  588
1   286  471
early stop counter: 1
val acc:0.9344156980514526, best validation acc: 0.9769899845123291, corresponding to test acc:                         0.9290456771850586 / 0.9290456771850586
after epoch: 5,now: 2024-08-07 06:20:38.602765,epoch time: 0:18:14.475911,used: 1:32:43.920629,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9932326, 'precision': 0.9932633, 'recall': 0.9932294, 'specificity': 0.9932294, 'f1': 0.9932324, 'auroc': 0.9997796, 'binary_precision': 0.9895817, 'binary_recall': 0.99697304, 'binary_specificity': 0.9894857, 'binary_f1_score': 0.9932636}
confusion matrix:
       0      1
0  25127    267
1     77  25361
---- Validation: 
scalar performance:
{'acc': 0.9559073, 'precision': 0.67056376, 'recall': 0.8994048, 'specificity': 0.8994048, 'f1': 0.73323923, 'auroc': 0.951664, 'binary_precision': 0.34541985, 'binary_recall': 0.83990717, 'binary_specificity': 0.9589025, 'binary_f1_score': 0.48951992}
confusion matrix:
       0    1
0  16006  686
1     69  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.900109, 'precision': 0.70184803, 'recall': 0.87317175, 'specificity': 0.87317175, 'f1': 0.75098467, 'auroc': 0.9303727, 'binary_precision': 0.4177049, 'binary_recall': 0.84147954, 'binary_specificity': 0.90486395, 'binary_f1_score': 0.5582822}
confusion matrix:
      0    1
0  8446  888
1   120  637
early stop counter: 2
val acc:0.9559072852134705, best validation acc: 0.9769899845123291, corresponding to test acc:                         0.9290456771850586 / 0.9290456771850586
after epoch: 6,now: 2024-08-07 06:38:51.262908,epoch time: 0:18:12.660143,used: 1:50:56.580772,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9939605, 'precision': 0.9939651, 'recall': 0.9939617, 'specificity': 0.9939617, 'f1': 0.9939605, 'auroc': 0.999652, 'binary_precision': 0.99566025, 'binary_recall': 0.99225444, 'binary_specificity': 0.99566895, 'binary_f1_score': 0.9939544}
confusion matrix:
       0      1
0  25288    110
1    197  25237
---- Validation: 
scalar performance:
{'acc': 0.9697483, 'precision': 0.72077525, 'recall': 0.9031136, 'specificity': 0.9031136, 'f1': 0.78260696, 'auroc': 0.9603934, 'binary_precision': 0.44596273, 'binary_recall': 0.83294666, 'binary_specificity': 0.9732806, 'binary_f1_score': 0.5809061}
confusion matrix:
       0    1
0  16246  446
1     72  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9133882, 'precision': 0.7166919, 'recall': 0.8433268, 'specificity': 0.8433268, 'f1': 0.7602349, 'auroc': 0.9199529, 'binary_precision': 0.4539007, 'binary_recall': 0.7608983, 'binary_specificity': 0.9257553, 'binary_f1_score': 0.5686081}
confusion matrix:
      0    1
0  8641  693
1   181  576
early stop counter: 3
val acc:0.969748318195343, best validation acc: 0.9769899845123291, corresponding to test acc:                         0.9290456771850586 / 0.9290456771850586
after epoch: 7,now: 2024-08-07 06:57:03.673252,epoch time: 0:18:12.410344,used: 2:09:08.991116,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9927015, 'precision': 0.9927925, 'recall': 0.99270666, 'specificity': 0.99270666, 'f1': 0.9927011, 'auroc': 0.9998542, 'binary_precision': 0.999681, 'binary_recall': 0.9857283, 'binary_specificity': 0.999685, 'binary_f1_score': 0.99265563}
confusion matrix:
       0      1
0  25389      8
1    363  25072
---- Validation: 
scalar performance:
{'acc': 0.9811365, 'precision': 0.8223796, 'recall': 0.75864637, 'specificity': 0.75864637, 'f1': 0.78678787, 'auroc': 0.96308094, 'binary_precision': 0.65697676, 'binary_recall': 0.52436197, 'binary_specificity': 0.99293077, 'binary_f1_score': 0.5832258}
confusion matrix:
       0    1
0  16574  118
1    205  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92666733, 'precision': 0.73532146, 'recall': 0.7272972, 'specificity': 0.7272972, 'f1': 0.73121905, 'auroc': 0.9221989, 'binary_precision': 0.5116598, 'binary_recall': 0.4927345, 'binary_specificity': 0.9618599, 'binary_f1_score': 0.5020188}
confusion matrix:
      0    1
0  8978  356
1   384  373
better model found
persisted
after epoch: 8,now: 2024-08-07 07:15:14.613801,epoch time: 0:18:10.940549,used: 2:27:19.931665,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9943146, 'precision': 0.99433374, 'recall': 0.99431735, 'specificity': 0.99431735, 'f1': 0.99431455, 'auroc': 0.9997443, 'binary_precision': 0.99762547, 'binary_recall': 0.9909974, 'binary_specificity': 0.99763733, 'binary_f1_score': 0.99430037}
confusion matrix:
       0      1
0  25335     60
1    229  25208
---- Validation: 
scalar performance:
{'acc': 0.97950125, 'precision': 0.78629106, 'recall': 0.8256159, 'specificity': 0.8256159, 'f1': 0.8045925, 'auroc': 0.9507058, 'binary_precision': 0.5813008, 'binary_recall': 0.6635731, 'binary_specificity': 0.98765874, 'binary_f1_score': 0.6197183}
confusion matrix:
       0    1
0  16486  206
1    145  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91913587, 'precision': 0.7268105, 'recall': 0.83975744, 'specificity': 0.83975744, 'f1': 0.76796585, 'auroc': 0.9320477, 'binary_precision': 0.47518924, 'binary_recall': 0.7463672, 'binary_specificity': 0.9331476, 'binary_f1_score': 0.58067834}
confusion matrix:
      0    1
0  8710  624
1   192  565
early stop counter: 1
val acc:0.9795012474060059, best validation acc: 0.9811365008354187, corresponding to test acc:                         0.926667332649231 / 0.9290456771850586
after epoch: 9,now: 2024-08-07 07:33:29.409040,epoch time: 0:18:14.795239,used: 2:45:34.726904,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99494416, 'precision': 0.99497396, 'recall': 0.9949472, 'specificity': 0.9949472, 'f1': 0.9949441, 'auroc': 0.9998053, 'binary_precision': 0.999009, 'binary_recall': 0.9908787, 'binary_specificity': 0.9990156, 'binary_f1_score': 0.9949273}
confusion matrix:
       0      1
0  25372     25
1    232  25203
---- Validation: 
scalar performance:
{'acc': 0.9681715, 'precision': 0.70881104, 'recall': 0.85822946, 'specificity': 0.85822946, 'f1': 0.7617999, 'auroc': 0.94874835, 'binary_precision': 0.4244032, 'binary_recall': 0.7424594, 'binary_specificity': 0.9739995, 'binary_f1_score': 0.5400844}
confusion matrix:
       0    1
0  16258  434
1    111  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90764046, 'precision': 0.7079484, 'recall': 0.84750307, 'specificity': 0.84750307, 'f1': 0.7531545, 'auroc': 0.92542195, 'binary_precision': 0.43523315, 'binary_recall': 0.7767503, 'binary_specificity': 0.91825587, 'binary_f1_score': 0.5578748}
confusion matrix:
      0    1
0  8571  763
1   169  588
early stop counter: 2
val acc:0.9681714773178101, best validation acc: 0.9811365008354187, corresponding to test acc:                         0.926667332649231 / 0.9290456771850586
after epoch: 10,now: 2024-08-07 07:51:42.299381,epoch time: 0:18:12.890341,used: 3:03:47.617245,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9948261, 'precision': 0.9948435, 'recall': 0.9948286, 'specificity': 0.9948286, 'f1': 0.9948261, 'auroc': 0.9997149, 'binary_precision': 0.9979822, 'binary_recall': 0.99166536, 'binary_specificity': 0.9979918, 'binary_f1_score': 0.99481374}
confusion matrix:
       0      1
0  25345     51
1    212  25224
---- Validation: 
scalar performance:
{'acc': 0.9788588, 'precision': 0.7770885, 'recall': 0.8603207, 'specificity': 0.8603207, 'f1': 0.8128295, 'auroc': 0.9656336, 'binary_precision': 0.5610619, 'binary_recall': 0.73549885, 'binary_specificity': 0.9851426, 'binary_f1_score': 0.63654613}
confusion matrix:
       0    1
0  16444  248
1    114  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92339706, 'precision': 0.70199066, 'recall': 0.57197505, 'specificity': 0.57197505, 'f1': 0.59829724, 'auroc': 0.9308697, 'binary_precision': 0.46875, 'binary_recall': 0.15852048, 'binary_specificity': 0.9854296, 'binary_f1_score': 0.23692004}
confusion matrix:
      0    1
0  9198  136
1   637  120
early stop counter: 3
val acc:0.9788588285446167, best validation acc: 0.9811365008354187, corresponding to test acc:                         0.926667332649231 / 0.9290456771850586
after epoch: 11,now: 2024-08-07 08:09:54.973099,epoch time: 0:18:12.673718,used: 3:22:00.290963,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.995554, 'precision': 0.99556077, 'recall': 0.9955526, 'specificity': 0.9955526, 'f1': 0.995554, 'auroc': 0.9998698, 'binary_precision': 0.9939266, 'binary_recall': 0.9972088, 'binary_specificity': 0.9938964, 'binary_f1_score': 0.99556494}
confusion matrix:
       0      1
0  25240    155
1     71  25366
---- Validation: 
scalar performance:
{'acc': 0.9415406, 'precision': 0.63829905, 'recall': 0.89542645, 'specificity': 0.89542645, 'f1': 0.6954679, 'auroc': 0.9567175, 'binary_precision': 0.28076923, 'binary_recall': 0.84686774, 'binary_specificity': 0.94398516, 'binary_f1_score': 0.42172158}
confusion matrix:
       0    1
0  15757  935
1     66  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91219896, 'precision': 0.71332496, 'recall': 0.8347938, 'specificity': 0.8347938, 'f1': 0.75544024, 'auroc': 0.9237098, 'binary_precision': 0.44860557, 'binary_recall': 0.74372524, 'binary_specificity': 0.92586243, 'binary_f1_score': 0.55964214}
confusion matrix:
      0    1
0  8642  692
1   194  563
early stop counter: 4
val acc:0.9415405988693237, best validation acc: 0.9811365008354187, corresponding to test acc:                         0.926667332649231 / 0.9290456771850586
after epoch: 12,now: 2024-08-07 08:28:15.323613,epoch time: 0:18:20.350514,used: 3:40:20.641477,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9933506, 'precision': 0.99339116, 'recall': 0.9933542, 'specificity': 0.9933542, 'f1': 0.99335057, 'auroc': 0.99955213, 'binary_precision': 0.99805516, 'binary_recall': 0.9886377, 'binary_specificity': 0.99807066, 'binary_f1_score': 0.9933241}
confusion matrix:
       0      1
0  25348     49
1    289  25146
---- Validation: 
scalar performance:
{'acc': 0.97874206, 'precision': 0.7926178, 'recall': 0.73142505, 'specificity': 0.73142505, 'f1': 0.75819963, 'auroc': 0.94568884, 'binary_precision': 0.59882003, 'binary_recall': 0.4709977, 'binary_specificity': 0.9918524, 'binary_f1_score': 0.5272727}
confusion matrix:
       0    1
0  16556  136
1    228  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9156674, 'precision': 0.69108707, 'recall': 0.6740103, 'specificity': 0.6740103, 'f1': 0.6820147, 'auroc': 0.9065395, 'binary_precision': 0.43128654, 'binary_recall': 0.38969618, 'binary_specificity': 0.95832443, 'binary_f1_score': 0.4094379}
confusion matrix:
      0    1
0  8945  389
1   462  295
early stop counter: 5
val acc:0.9787420630455017, best validation acc: 0.9811365008354187, corresponding to test acc:                         0.926667332649231 / 0.9290456771850586
after epoch: 13,now: 2024-08-07 08:46:45.299792,epoch time: 0:18:29.976179,used: 3:58:50.617656,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99350804, 'precision': 0.9935853, 'recall': 0.9935131, 'specificity': 0.9935131, 'f1': 0.9935078, 'auroc': 0.99980944, 'binary_precision': 0.9999602, 'binary_recall': 0.98706555, 'binary_specificity': 0.9999606, 'binary_f1_score': 0.993471}
confusion matrix:
       0      1
0  25395      1
1    329  25107
---- Validation: 
scalar performance:
{'acc': 0.9820125, 'precision': 0.8652791, 'recall': 0.71502024, 'specificity': 0.71502024, 'f1': 0.7696053, 'auroc': 0.9631165, 'binary_precision': 0.7450199, 'binary_recall': 0.4338747, 'binary_specificity': 0.9961658, 'binary_f1_score': 0.54838705}
confusion matrix:
       0    1
0  16628   64
1    244  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9217124, 'precision': 0.6602536, 'recall': 0.5340414, 'specificity': 0.5340414, 'f1': 0.544484, 'auroc': 0.92187166, 'binary_precision': 0.39072847, 'binary_recall': 0.077939235, 'binary_specificity': 0.99014354, 'binary_f1_score': 0.12995595}
confusion matrix:
      0   1
0  9242  92
1   698  59
better model found
persisted
after epoch: 14,now: 2024-08-07 09:05:00.017610,epoch time: 0:18:14.717818,used: 4:17:05.335474,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99641955, 'precision': 0.9964199, 'recall': 0.9964194, 'specificity': 0.9964194, 'f1': 0.99641967, 'auroc': 0.99990654, 'binary_precision': 0.99618816, 'binary_recall': 0.99665815, 'binary_specificity': 0.99618065, 'binary_f1_score': 0.9964231}
confusion matrix:
       0      1
0  25300     97
1     85  25350
---- Validation: 
scalar performance:
{'acc': 0.97944283, 'precision': 0.779135, 'recall': 0.9013052, 'specificity': 0.9013052, 'f1': 0.82834524, 'auroc': 0.9700765, 'binary_precision': 0.5629984, 'binary_recall': 0.8190255, 'binary_specificity': 0.98358494, 'binary_f1_score': 0.66729677}
confusion matrix:
       0    1
0  16418  274
1     78  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91804576, 'precision': 0.7225678, 'recall': 0.82338786, 'specificity': 0.82338786, 'f1': 0.7603156, 'auroc': 0.92120075, 'binary_precision': 0.4695122, 'binary_recall': 0.7120211, 'binary_specificity': 0.93475467, 'binary_f1_score': 0.5658793}
confusion matrix:
      0    1
0  8725  609
1   218  539
early stop counter: 1
val acc:0.979442834854126, best validation acc: 0.9820125102996826, corresponding to test acc:                         0.9217123985290527 / 0.9290456771850586
after epoch: 15,now: 2024-08-07 09:23:15.629889,epoch time: 0:18:15.612279,used: 4:35:20.947753,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9971278, 'precision': 0.99712807, 'recall': 0.99712765, 'specificity': 0.99712765, 'f1': 0.9971278, 'auroc': 0.9999059, 'binary_precision': 0.9968955, 'binary_recall': 0.99736583, 'binary_specificity': 0.9968894, 'binary_f1_score': 0.99713063}
confusion matrix:
       0      1
0  25318     79
1     67  25368
---- Validation: 
scalar performance:
{'acc': 0.96612746, 'precision': 0.70659286, 'recall': 0.9170784, 'specificity': 0.9170784, 'f1': 0.7724879, 'auroc': 0.965101, 'binary_precision': 0.4167598, 'binary_recall': 0.8654292, 'binary_specificity': 0.9687275, 'binary_f1_score': 0.5625943}
confusion matrix:
       0    1
0  16170  522
1     58  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9077396, 'precision': 0.7098408, 'recall': 0.8578745, 'specificity': 0.8578745, 'f1': 0.756776, 'auroc': 0.9275999, 'binary_precision': 0.43713874, 'binary_recall': 0.7992074, 'binary_specificity': 0.9165417, 'binary_f1_score': 0.5651565}
confusion matrix:
      0    1
0  8555  779
1   152  605
early stop counter: 2
val acc:0.9661274552345276, best validation acc: 0.9820125102996826, corresponding to test acc:                         0.9217123985290527 / 0.9290456771850586
after epoch: 16,now: 2024-08-07 09:41:34.556997,epoch time: 0:18:18.927108,used: 4:53:39.874861,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99724585, 'precision': 0.9972469, 'recall': 0.9972453, 'specificity': 0.9972453, 'f1': 0.99724585, 'auroc': 0.9999422, 'binary_precision': 0.9967016, 'binary_recall': 0.9977987, 'binary_specificity': 0.996692, 'binary_f1_score': 0.99724984}
confusion matrix:
       0      1
0  25309     84
1     56  25383
---- Validation: 
scalar performance:
{'acc': 0.9770484, 'precision': 0.7623129, 'recall': 0.86843324, 'specificity': 0.86843324, 'f1': 0.805683, 'auroc': 0.96439517, 'binary_precision': 0.53104573, 'binary_recall': 0.7540603, 'binary_specificity': 0.98280615, 'binary_f1_score': 0.62320226}
confusion matrix:
       0    1
0  16405  287
1    106  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9074423, 'precision': 0.7096689, 'recall': 0.8595346, 'specificity': 0.8595346, 'f1': 0.7568923, 'auroc': 0.921783, 'binary_precision': 0.43646806, 'binary_recall': 0.8031704, 'binary_specificity': 0.91589886, 'binary_f1_score': 0.5655814}
confusion matrix:
      0    1
0  8549  785
1   149  608
early stop counter: 3
val acc:0.977048397064209, best validation acc: 0.9820125102996826, corresponding to test acc:                         0.9217123985290527 / 0.9290456771850586
after epoch: 17,now: 2024-08-07 09:59:50.353497,epoch time: 0:18:15.796500,used: 5:11:55.671361,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9959671, 'precision': 0.9959881, 'recall': 0.99596965, 'specificity': 0.99596965, 'f1': 0.99596703, 'auroc': 0.9998592, 'binary_precision': 0.99940616, 'binary_recall': 0.99253, 'binary_specificity': 0.9994094, 'binary_f1_score': 0.9959561}
confusion matrix:
       0      1
0  25382     15
1    190  25245
---- Validation: 
scalar performance:
{'acc': 0.96893066, 'precision': 0.70383567, 'recall': 0.78855026, 'specificity': 0.78855026, 'f1': 0.7381707, 'auroc': 0.9438, 'binary_precision': 0.41815236, 'binary_recall': 0.5986079, 'binary_specificity': 0.9784927, 'binary_f1_score': 0.49236646}
confusion matrix:
       0    1
0  16333  359
1    173  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90922606, 'precision': 0.7053434, 'recall': 0.81740654, 'specificity': 0.81740654, 'f1': 0.7446734, 'auroc': 0.90886045, 'binary_precision': 0.43552312, 'binary_recall': 0.70937914, 'binary_specificity': 0.9254339, 'binary_f1_score': 0.53969854}
confusion matrix:
      0    1
0  8638  696
1   220  537
early stop counter: 4
val acc:0.9689306616783142, best validation acc: 0.9820125102996826, corresponding to test acc:                         0.9217123985290527 / 0.9290456771850586
after epoch: 18,now: 2024-08-07 10:18:11.885624,epoch time: 0:18:21.532127,used: 5:30:17.203488,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9959081, 'precision': 0.9959126, 'recall': 0.9959095, 'specificity': 0.9959095, 'f1': 0.9959081, 'auroc': 0.9997532, 'binary_precision': 0.99763304, 'binary_recall': 0.9941817, 'binary_specificity': 0.99763733, 'binary_f1_score': 0.9959044}
confusion matrix:
       0      1
0  25335     60
1    148  25289
---- Validation: 
scalar performance:
{'acc': 0.97932607, 'precision': 0.77988267, 'recall': 0.87638223, 'specificity': 0.87638223, 'f1': 0.8204609, 'auroc': 0.9635586, 'binary_precision': 0.565812, 'binary_recall': 0.7679814, 'binary_specificity': 0.9847831, 'binary_f1_score': 0.6515748}
confusion matrix:
       0    1
0  16438  254
1    100  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90833414, 'precision': 0.70693296, 'recall': 0.8351325, 'specificity': 0.8351325, 'f1': 0.74985635, 'auroc': 0.9059384, 'binary_precision': 0.43548387, 'binary_recall': 0.74900925, 'binary_specificity': 0.92125565, 'binary_f1_score': 0.5507528}
confusion matrix:
      0    1
0  8599  735
1   190  567
early stop counter: 5
val acc:0.979326069355011, best validation acc: 0.9820125102996826, corresponding to test acc:                         0.9217123985290527 / 0.9290456771850586
after epoch: 19,now: 2024-08-07 10:36:31.927563,epoch time: 0:18:20.041939,used: 5:48:37.245427,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9925637, 'precision': 0.99266255, 'recall': 0.99256945, 'specificity': 0.99256945, 'f1': 0.9925634, 'auroc': 0.9997102, 'binary_precision': 0.99984044, 'binary_recall': 0.9852964, 'binary_specificity': 0.9998425, 'binary_f1_score': 0.99251515}
confusion matrix:
       0      1
0  25392      4
1    374  25062
---- Validation: 
scalar performance:
{'acc': 0.97973484, 'precision': 0.8591254, 'recall': 0.6505643, 'specificity': 0.6505643, 'f1': 0.7099487, 'auroc': 0.9677901, 'binary_precision': 0.73595506, 'binary_recall': 0.30394432, 'binary_specificity': 0.9971843, 'binary_f1_score': 0.43021348}
confusion matrix:
       0    1
0  16645   47
1    300  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91041523, 'precision': 0.71042913, 'recall': 0.83565044, 'specificity': 0.83565044, 'f1': 0.753087, 'auroc': 0.91492546, 'binary_precision': 0.44253322, 'binary_recall': 0.74768823, 'binary_specificity': 0.9236126, 'binary_f1_score': 0.5559921}
confusion matrix:
      0    1
0  8621  713
1   191  566
early stop counter: 6
val acc:0.9797348380088806, best validation acc: 0.9820125102996826, corresponding to test acc:                         0.9217123985290527 / 0.9290456771850586
after epoch: 20,now: 2024-08-07 10:55:55.585028,epoch time: 0:19:23.657465,used: 6:08:00.902892,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_47_54_seed_1_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:08:00.902892 at 2024-08-07 10:55:55.585028
persisted model performance metric: 

scalar performance:
{'acc': 0.9217124, 'precision': 0.6602536, 'recall': 0.5340414, 'specificity': 0.5340414, 'f1': 0.544484, 'auroc': 0.92187166, 'binary_precision': 0.39072847, 'binary_recall': 0.077939235, 'binary_specificity': 0.99014354, 'binary_f1_score': 0.12995595}
confusion matrix:
      0   1
0  9242  92
1   698  59
oracle model performance metric: 

scalar performance:
{'acc': 0.9290457, 'precision': 0.7442035, 'recall': 0.73647296, 'specificity': 0.73647296, 'f1': 0.7402581, 'auroc': 0.9292201, 'binary_precision': 0.52804375, 'binary_recall': 0.50990754, 'binary_specificity': 0.9630383, 'binary_f1_score': 0.51881725}
confusion matrix:
      0    1
0  8989  345
1   371  386
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |  40858 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  28102 MiB |  13630 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  28014 MiB |  13608 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool | 455249 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |  10843 KiB |     42 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7359    |  216544 K  |  216539 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112783 K  |  112779 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7359    |  216544 K  |  216539 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112783 K  |  112779 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1212    |     577    |
|       from large pool |     602    |     602    |    1168    |     566    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3239    |  127192 K  |  127192 K  |
|       from large pool |      36    |     605    |   73199 K  |   73199 K  |
|       from small pool |      40    |    3203    |   53993 K  |   53993 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     44 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216544 K  |  216544 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112783 K  |  112783 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216544 K  |  216544 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112783 K  |  112783 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3239    |  127194 K  |  127194 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3203    |   53995 K  |   53995 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     44 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216544 K  |  216544 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112783 K  |  112783 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216544 K  |  216544 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112783 K  |  112783 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3239    |  127194 K  |  127194 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3203    |   53995 K  |   53995 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680

 Experiment start at: 2024-08-07 11:19:37.861564
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9806368, 'precision': 0.98095703, 'recall': 0.9806348, 'specificity': 0.9806348, 'f1': 0.9806335, 'auroc': 0.9987991, 'binary_precision': 0.9685862, 'binary_recall': 0.9935015, 'binary_specificity': 0.96776813, 'binary_f1_score': 0.9808857}
confusion matrix:
       0      1
0  25011    833
1    168  25684
---- Validation: 
scalar performance:
{'acc': 0.87310207, 'precision': 0.56932354, 'recall': 0.85799146, 'specificity': 0.85799146, 'f1': 0.58771574, 'auroc': 0.9251865, 'binary_precision': 0.14314762, 'binary_recall': 0.84210527, 'binary_specificity': 0.87387764, 'binary_f1_score': 0.24469934}
confusion matrix:
       0     1
0  14599  2107
1     66   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7166072, 'precision': 0.59913546, 'recall': 0.81001955, 'specificity': 0.81001955, 'f1': 0.5794066, 'auroc': 0.89900255, 'binary_precision': 0.20787312, 'binary_recall': 0.9209536, 'binary_specificity': 0.69908553, 'binary_f1_score': 0.33918667}
confusion matrix:
      0     1
0  6498  2797
1    63   734
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 11:40:43.737615,epoch time: 0:21:05.876051,used: 0:21:05.876051,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.986556, 'precision': 0.986652, 'recall': 0.9865571, 'specificity': 0.9865571, 'f1': 0.9865554, 'auroc': 0.99911237, 'binary_precision': 0.9935261, 'binary_recall': 0.9794987, 'binary_specificity': 0.99361557, 'binary_f1_score': 0.98646253}
confusion matrix:
       0      1
0  25679    165
1    530  25322
---- Validation: 
scalar performance:
{'acc': 0.9704508, 'precision': 0.70812595, 'recall': 0.7935919, 'specificity': 0.7935919, 'f1': 0.7428804, 'auroc': 0.94126993, 'binary_precision': 0.4261745, 'binary_recall': 0.6076555, 'binary_specificity': 0.9795283, 'binary_f1_score': 0.50098616}
confusion matrix:
       0    1
0  16364  342
1    164  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221165, 'precision': 0.7263242, 'recall': 0.6164509, 'specificity': 0.6164509, 'f1': 0.64905715, 'auroc': 0.9114921, 'binary_precision': 0.51399493, 'binary_recall': 0.25345045, 'binary_specificity': 0.9794513, 'binary_f1_score': 0.33949584}
confusion matrix:
      0    1
0  9104  191
1   595  202
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 12:01:08.965689,epoch time: 0:20:25.228074,used: 0:41:31.104125,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98903203, 'precision': 0.98913336, 'recall': 0.9890337, 'specificity': 0.9890337, 'f1': 0.98903155, 'auroc': 0.99933684, 'binary_precision': 0.9962322, 'binary_recall': 0.9817823, 'binary_specificity': 0.99628514, 'binary_f1_score': 0.98895454}
confusion matrix:
       0      1
0  25746     96
1    471  25383
---- Validation: 
scalar performance:
{'acc': 0.96361834, 'precision': 0.678583, 'recall': 0.8192463, 'specificity': 0.8192463, 'f1': 0.72682023, 'auroc': 0.92740345, 'binary_precision': 0.36566186, 'binary_recall': 0.66746414, 'binary_specificity': 0.9710284, 'binary_f1_score': 0.47248095}
confusion matrix:
       0    1
0  16222  484
1    139  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9257828, 'precision': 0.7446271, 'recall': 0.72110844, 'specificity': 0.72110844, 'f1': 0.73209524, 'auroc': 0.9023297, 'binary_precision': 0.53361344, 'binary_recall': 0.47804266, 'binary_specificity': 0.9641743, 'binary_f1_score': 0.50430185}
confusion matrix:
      0    1
0  8962  333
1   416  381
new oracle model saved
early stop counter: 1
val acc:0.9636183381080627, best validation acc: 0.9704508185386658, corresponding to test acc:                         0.9221165180206299 / 0.9257827997207642
after epoch: 3,now: 2024-08-07 12:20:02.313072,epoch time: 0:18:53.347383,used: 1:00:24.451508,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99158543, 'precision': 0.99161637, 'recall': 0.991586, 'specificity': 0.991586, 'f1': 0.99158525, 'auroc': 0.9996737, 'binary_precision': 0.9955547, 'binary_recall': 0.98758316, 'binary_specificity': 0.9955889, 'binary_f1_score': 0.9915529}
confusion matrix:
       0      1
0  25730    114
1    321  25531
---- Validation: 
scalar performance:
{'acc': 0.9750642, 'precision': 0.7414371, 'recall': 0.8146162, 'specificity': 0.8146162, 'f1': 0.772799, 'auroc': 0.9384064, 'binary_precision': 0.4918033, 'binary_recall': 0.64593303, 'binary_specificity': 0.98329943, 'binary_f1_score': 0.5584281}
confusion matrix:
       0    1
0  16427  279
1    148  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87831944, 'precision': 0.6776587, 'recall': 0.843894, 'specificity': 0.843894, 'f1': 0.72044706, 'auroc': 0.8944551, 'binary_precision': 0.37405026, 'binary_recall': 0.8030113, 'binary_specificity': 0.8847768, 'binary_f1_score': 0.5103668}
confusion matrix:
      0     1
0  8224  1071
1   157   640
better model found
persisted
after epoch: 4,now: 2024-08-07 12:38:51.215257,epoch time: 0:18:48.902185,used: 1:19:13.353693,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9922431, 'precision': 0.99224377, 'recall': 0.9922433, 'specificity': 0.9922433, 'f1': 0.9922432, 'auroc': 0.9996247, 'binary_precision': 0.9928737, 'binary_recall': 0.9916064, 'binary_specificity': 0.9928801, 'binary_f1_score': 0.9922397}
confusion matrix:
       0      1
0  25659    184
1    217  25636
---- Validation: 
scalar performance:
{'acc': 0.97290355, 'precision': 0.73103106, 'recall': 0.8834834, 'specificity': 0.8834834, 'f1': 0.78659034, 'auroc': 0.9619913, 'binary_precision': 0.4674221, 'binary_recall': 0.7894737, 'binary_specificity': 0.9774931, 'binary_f1_score': 0.5871886}
confusion matrix:
       0    1
0  16330  376
1     88  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91508126, 'precision': 0.73133904, 'recall': 0.87589574, 'specificity': 0.87589574, 'f1': 0.7795512, 'auroc': 0.9126867, 'binary_precision': 0.47829232, 'binary_recall': 0.8293601, 'binary_specificity': 0.9224314, 'binary_f1_score': 0.6067003}
confusion matrix:
      0    1
0  8574  721
1   136  661
early stop counter: 1
val acc:0.9729035496711731, best validation acc: 0.975064218044281, corresponding to test acc:                         0.8783194422721863 / 0.9257827997207642
after epoch: 5,now: 2024-08-07 12:57:39.948428,epoch time: 0:18:48.733171,used: 1:38:02.086864,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9918562, 'precision': 0.99196684, 'recall': 0.9918571, 'specificity': 0.9918571, 'f1': 0.99185574, 'auroc': 0.99968266, 'binary_precision': 0.9993716, 'binary_recall': 0.9843333, 'binary_specificity': 0.99938095, 'binary_f1_score': 0.9917954}
confusion matrix:
       0      1
0  25829     16
1    405  25446
---- Validation: 
scalar performance:
{'acc': 0.9711516, 'precision': 0.66725755, 'recall': 0.6050197, 'specificity': 0.6050197, 'f1': 0.6283355, 'auroc': 0.90692145, 'binary_precision': 0.35384616, 'binary_recall': 0.2200957, 'binary_specificity': 0.98994374, 'binary_f1_score': 0.27138644}
confusion matrix:
       0    1
0  16538  168
1    326   92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75227904, 'precision': 0.59818083, 'recall': 0.78235286, 'specificity': 0.78235286, 'f1': 0.595086, 'auroc': 0.8627279, 'binary_precision': 0.21682741, 'binary_recall': 0.8180677, 'binary_specificity': 0.746638, 'binary_f1_score': 0.34279704}
confusion matrix:
      0     1
0  6940  2355
1   145   652
early stop counter: 2
val acc:0.97115159034729, best validation acc: 0.975064218044281, corresponding to test acc:                         0.8783194422721863 / 0.9257827997207642
after epoch: 6,now: 2024-08-07 13:16:28.170602,epoch time: 0:18:48.222174,used: 1:56:50.309038,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99353915, 'precision': 0.99353945, 'recall': 0.9935392, 'specificity': 0.9935392, 'f1': 0.99353915, 'auroc': 0.9997461, 'binary_precision': 0.99392205, 'binary_recall': 0.9931531, 'binary_specificity': 0.99392533, 'binary_f1_score': 0.9935374}
confusion matrix:
       0      1
0  25688    157
1    177  25674
---- Validation: 
scalar performance:
{'acc': 0.9641439, 'precision': 0.6580415, 'recall': 0.71572, 'specificity': 0.71572, 'f1': 0.6819149, 'auroc': 0.9133918, 'binary_precision': 0.3298611, 'binary_recall': 0.45454547, 'binary_specificity': 0.97689456, 'binary_f1_score': 0.3822938}
confusion matrix:
       0    1
0  16320  386
1    228  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86662704, 'precision': 0.6530766, 'recall': 0.78936744, 'specificity': 0.78936744, 'f1': 0.6882334, 'auroc': 0.86963934, 'binary_precision': 0.3347381, 'binary_recall': 0.69761604, 'binary_specificity': 0.8811189, 'binary_f1_score': 0.45240033}
confusion matrix:
      0     1
0  8190  1105
1   241   556
early stop counter: 3
val acc:0.9641438722610474, best validation acc: 0.975064218044281, corresponding to test acc:                         0.8783194422721863 / 0.9257827997207642
after epoch: 7,now: 2024-08-07 13:35:18.146705,epoch time: 0:18:49.976103,used: 2:15:40.285141,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98657537, 'precision': 0.98657656, 'recall': 0.9865755, 'specificity': 0.9865755, 'f1': 0.98657537, 'auroc': 0.99911034, 'binary_precision': 0.98736876, 'binary_recall': 0.98576456, 'binary_specificity': 0.98738635, 'binary_f1_score': 0.986566}
confusion matrix:
       0      1
0  25519    326
1    368  25483
---- Validation: 
scalar performance:
{'acc': 0.94352955, 'precision': 0.635014, 'recall': 0.8754264, 'specificity': 0.8754264, 'f1': 0.69017583, 'auroc': 0.9506608, 'binary_precision': 0.27518427, 'binary_recall': 0.80382776, 'binary_specificity': 0.947025, 'binary_f1_score': 0.4100061}
confusion matrix:
       0    1
0  15821  885
1     82  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91072136, 'precision': 0.7231854, 'recall': 0.86836684, 'specificity': 0.86836684, 'f1': 0.77063465, 'auroc': 0.91680324, 'binary_precision': 0.4630682, 'binary_recall': 0.8180677, 'binary_specificity': 0.91866595, 'binary_f1_score': 0.5913832}
confusion matrix:
      0    1
0  8539  756
1   145  652
early stop counter: 4
val acc:0.9435295462608337, best validation acc: 0.975064218044281, corresponding to test acc:                         0.8783194422721863 / 0.9257827997207642
after epoch: 8,now: 2024-08-07 13:54:21.872866,epoch time: 0:19:03.726161,used: 2:34:44.011302,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99377126, 'precision': 0.9938414, 'recall': 0.9937722, 'specificity': 0.9937722, 'f1': 0.9937711, 'auroc': 0.999871, 'binary_precision': 0.9997651, 'binary_recall': 0.9877766, 'binary_specificity': 0.99976784, 'binary_f1_score': 0.99373466}
confusion matrix:
       0      1
0  25838      6
1    316  25536
---- Validation: 
scalar performance:
{'acc': 0.97722495, 'precision': 0.8012036, 'recall': 0.5836413, 'specificity': 0.5836413, 'f1': 0.62767506, 'auroc': 0.92715997, 'binary_precision': 0.622807, 'binary_recall': 0.16985646, 'binary_specificity': 0.9974261, 'binary_f1_score': 0.26691732}
confusion matrix:
       0   1
0  16663  43
1    347  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89199364, 'precision': 0.6900871, 'recall': 0.8312428, 'specificity': 0.8312428, 'f1': 0.73256934, 'auroc': 0.88359135, 'binary_precision': 0.4025283, 'binary_recall': 0.7590966, 'binary_specificity': 0.9033889, 'binary_f1_score': 0.526087}
confusion matrix:
      0    1
0  8397  898
1   192  605
better model found
persisted
after epoch: 9,now: 2024-08-07 14:13:24.274817,epoch time: 0:19:02.401951,used: 2:53:46.413253,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99330705, 'precision': 0.9933577, 'recall': 0.9933078, 'specificity': 0.9933078, 'f1': 0.9933069, 'auroc': 0.99959624, 'binary_precision': 0.9983977, 'binary_recall': 0.9882021, 'binary_specificity': 0.99841356, 'binary_f1_score': 0.99327374}
confusion matrix:
       0      1
0  25803     41
1    305  25547
---- Validation: 
scalar performance:
{'acc': 0.97471386, 'precision': 0.73322004, 'recall': 0.71413976, 'specificity': 0.71413976, 'f1': 0.7232399, 'auroc': 0.927361, 'binary_precision': 0.48041776, 'binary_recall': 0.4401914, 'binary_specificity': 0.98808813, 'binary_f1_score': 0.45942575}
confusion matrix:
       0    1
0  16507  199
1    234  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91676575, 'precision': 0.7218435, 'recall': 0.7729958, 'specificity': 0.7729958, 'f1': 0.7438207, 'auroc': 0.8923521, 'binary_precision': 0.4785643, 'binary_recall': 0.60225844, 'binary_specificity': 0.9437332, 'binary_f1_score': 0.53333336}
confusion matrix:
      0    1
0  8772  523
1   317  480
early stop counter: 1
val acc:0.9747138619422913, best validation acc: 0.9772249460220337, corresponding to test acc:                         0.8919936418533325 / 0.9257827997207642
after epoch: 10,now: 2024-08-07 14:32:19.457989,epoch time: 0:18:55.183172,used: 3:12:41.596425,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9940227, 'precision': 0.99402535, 'recall': 0.99402237, 'specificity': 0.99402237, 'f1': 0.9940227, 'auroc': 0.999699, 'binary_precision': 0.99297625, 'binary_recall': 0.9950884, 'binary_specificity': 0.9929564, 'binary_f1_score': 0.9940312}
confusion matrix:
       0      1
0  25657    182
1    127  25730
---- Validation: 
scalar performance:
{'acc': 0.97231954, 'precision': 0.7235035, 'recall': 0.8295369, 'specificity': 0.8295369, 'f1': 0.76541555, 'auroc': 0.94832397, 'binary_precision': 0.4551282, 'binary_recall': 0.67942584, 'binary_specificity': 0.97964805, 'binary_f1_score': 0.5451056}
confusion matrix:
       0    1
0  16366  340
1    134  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.71857, 'recall': 0.6066822, 'specificity': 0.6066822, 'f1': 0.6381532, 'auroc': 0.9196639, 'binary_precision': 0.5, 'binary_recall': 0.23337516, 'binary_specificity': 0.97998923, 'binary_f1_score': 0.3182207}
confusion matrix:
      0    1
0  9109  186
1   611  186
early stop counter: 2
val acc:0.9723195433616638, best validation acc: 0.9772249460220337, corresponding to test acc:                         0.8919936418533325 / 0.9257827997207642
after epoch: 11,now: 2024-08-07 14:51:15.190281,epoch time: 0:18:55.732292,used: 3:31:37.328717,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99292016, 'precision': 0.99292207, 'recall': 0.9929204, 'specificity': 0.9929204, 'f1': 0.99292016, 'auroc': 0.9994924, 'binary_precision': 0.99395347, 'binary_recall': 0.99187744, 'binary_specificity': 0.9939633, 'binary_f1_score': 0.9929144}
confusion matrix:
       0      1
0  25686    156
1    210  25644
---- Validation: 
scalar performance:
{'acc': 0.9684069, 'precision': 0.6973839, 'recall': 0.79954183, 'specificity': 0.79954183, 'f1': 0.73690104, 'auroc': 0.93330514, 'binary_precision': 0.4043546, 'binary_recall': 0.6220096, 'binary_specificity': 0.9770741, 'binary_f1_score': 0.4901037}
confusion matrix:
       0    1
0  16323  383
1    158  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9071542, 'precision': 0.7139269, 'recall': 0.844635, 'specificity': 0.844635, 'f1': 0.75760245, 'auroc': 0.9113037, 'binary_precision': 0.4488304, 'binary_recall': 0.77038896, 'binary_specificity': 0.9188811, 'binary_f1_score': 0.56720555}
confusion matrix:
      0    1
0  8541  754
1   183  614
early stop counter: 3
val acc:0.9684069156646729, best validation acc: 0.9772249460220337, corresponding to test acc:                         0.8919936418533325 / 0.9257827997207642
after epoch: 12,now: 2024-08-07 15:10:09.345776,epoch time: 0:18:54.155495,used: 3:50:31.484212,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99023134, 'precision': 0.99041235, 'recall': 0.9902332, 'specificity': 0.9902332, 'f1': 0.9902305, 'auroc': 0.9998691, 'binary_precision': 0.9998817, 'binary_recall': 0.98058254, 'binary_specificity': 0.9998839, 'binary_f1_score': 0.9901381}
confusion matrix:
       0      1
0  25840      3
1    502  25351
---- Validation: 
scalar performance:
{'acc': 0.97903526, 'precision': 0.8063016, 'recall': 0.6697048, 'specificity': 0.6697048, 'f1': 0.7172236, 'auroc': 0.96066046, 'binary_precision': 0.62882096, 'binary_recall': 0.34449762, 'binary_specificity': 0.994912, 'binary_f1_score': 0.4451314}
confusion matrix:
       0    1
0  16621   85
1    274  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9203329, 'precision': 0.7346186, 'recall': 0.81450796, 'specificity': 0.81450796, 'f1': 0.76665473, 'auroc': 0.91204107, 'binary_precision': 0.49683258, 'binary_recall': 0.6888331, 'binary_specificity': 0.94018286, 'binary_f1_score': 0.577287}
confusion matrix:
      0    1
0  8739  556
1   248  549
better model found
persisted
after epoch: 13,now: 2024-08-07 15:29:16.115992,epoch time: 0:19:06.770216,used: 4:09:38.254428,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9935198, 'precision': 0.9935962, 'recall': 0.9935205, 'specificity': 0.9935205, 'f1': 0.99351954, 'auroc': 0.9998871, 'binary_precision': 0.999765, 'binary_recall': 0.9872732, 'binary_specificity': 0.99976784, 'binary_f1_score': 0.99347985}
confusion matrix:
       0      1
0  25839      6
1    329  25522
---- Validation: 
scalar performance:
{'acc': 0.97728336, 'precision': 0.7970848, 'recall': 0.5918349, 'specificity': 0.5918349, 'f1': 0.63734823, 'auroc': 0.94329196, 'binary_precision': 0.61417323, 'binary_recall': 0.18660288, 'binary_specificity': 0.9970669, 'binary_f1_score': 0.28623852}
confusion matrix:
       0   1
0  16657  49
1    340  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91309947, 'precision': 0.70092523, 'recall': 0.6993105, 'specificity': 0.6993105, 'f1': 0.7001134, 'auroc': 0.8956899, 'binary_precision': 0.44936708, 'binary_recall': 0.44542032, 'binary_specificity': 0.95320064, 'binary_f1_score': 0.44738498}
confusion matrix:
      0    1
0  8860  435
1   442  355
early stop counter: 1
val acc:0.9772833585739136, best validation acc: 0.9790352582931519, corresponding to test acc:                         0.9203329086303711 / 0.9257827997207642
after epoch: 14,now: 2024-08-07 15:48:23.672964,epoch time: 0:19:07.556972,used: 4:28:45.811400,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9958604, 'precision': 0.9958861, 'recall': 0.995861, 'specificity': 0.995861, 'f1': 0.99586034, 'auroc': 0.99990535, 'binary_precision': 0.9994935, 'binary_recall': 0.992225, 'binary_specificity': 0.999497, 'binary_f1_score': 0.9958459}
confusion matrix:
       0      1
0  25831     13
1    201  25651
---- Validation: 
scalar performance:
{'acc': 0.9807872, 'precision': 0.83710194, 'recall': 0.6915951, 'specificity': 0.6915951, 'f1': 0.7431892, 'auroc': 0.9568511, 'binary_precision': 0.6893617, 'binary_recall': 0.3875598, 'binary_specificity': 0.9956303, 'binary_f1_score': 0.49617153}
confusion matrix:
       0    1
0  16633   73
1    256  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8754459, 'precision': 0.6549957, 'recall': 0.76547694, 'specificity': 0.76547694, 'f1': 0.68792343, 'auroc': 0.86605203, 'binary_precision': 0.34375, 'binary_recall': 0.6348808, 'binary_specificity': 0.89607316, 'binary_f1_score': 0.44601142}
confusion matrix:
      0    1
0  8329  966
1   291  506
better model found
persisted
after epoch: 15,now: 2024-08-07 16:08:03.340919,epoch time: 0:19:39.667955,used: 4:48:25.479355,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.992688, 'precision': 0.99269104, 'recall': 0.9926878, 'specificity': 0.9926878, 'f1': 0.99268806, 'auroc': 0.99969935, 'binary_precision': 0.9915104, 'binary_recall': 0.99388826, 'binary_specificity': 0.9914874, 'binary_f1_score': 0.99269795}
confusion matrix:
       0      1
0  25624    220
1    158  25694
---- Validation: 
scalar performance:
{'acc': 0.9371642, 'precision': 0.6262887, 'recall': 0.886159, 'specificity': 0.886159, 'f1': 0.6798222, 'auroc': 0.94990146, 'binary_precision': 0.25701624, 'binary_recall': 0.83253586, 'binary_specificity': 0.93978214, 'binary_f1_score': 0.3927765}
confusion matrix:
       0     1
0  15700  1006
1     70   348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91656756, 'precision': 0.72914386, 'recall': 0.8359799, 'specificity': 0.8359799, 'f1': 0.76861, 'auroc': 0.9231446, 'binary_precision': 0.48163265, 'binary_recall': 0.74027604, 'binary_specificity': 0.9316837, 'binary_f1_score': 0.5835806}
confusion matrix:
      0    1
0  8660  635
1   207  590
early stop counter: 1
val acc:0.9371641874313354, best validation acc: 0.9807872176170349, corresponding to test acc:                         0.8754459023475647 / 0.9257827997207642
after epoch: 16,now: 2024-08-07 16:28:42.627096,epoch time: 0:20:39.286177,used: 5:09:04.765532,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.996402, 'precision': 0.9964022, 'recall': 0.996402, 'specificity': 0.996402, 'f1': 0.996402, 'auroc': 0.99986327, 'binary_precision': 0.9961723, 'binary_recall': 0.99663466, 'binary_specificity': 0.9961693, 'binary_f1_score': 0.99640346}
confusion matrix:
       0      1
0  25745     99
1     87  25765
---- Validation: 
scalar performance:
{'acc': 0.97080123, 'precision': 0.7203071, 'recall': 0.8894034, 'specificity': 0.8894034, 'f1': 0.77913105, 'auroc': 0.9557632, 'binary_precision': 0.44562334, 'binary_recall': 0.80382776, 'binary_specificity': 0.97497904, 'binary_f1_score': 0.57337886}
confusion matrix:
       0    1
0  16288  418
1     82  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6601268, 'precision': 0.58327216, 'recall': 0.7759166, 'specificity': 0.7759166, 'f1': 0.536891, 'auroc': 0.8817581, 'binary_precision': 0.17803864, 'binary_recall': 0.9134253, 'binary_specificity': 0.63840777, 'binary_f1_score': 0.2979943}
confusion matrix:
      0     1
0  5934  3361
1    69   728
early stop counter: 2
val acc:0.9708012342453003, best validation acc: 0.9807872176170349, corresponding to test acc:                         0.8754459023475647 / 0.9257827997207642
after epoch: 17,now: 2024-08-07 16:48:37.595251,epoch time: 0:19:54.968155,used: 5:28:59.733687,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99771744, 'precision': 0.99771774, 'recall': 0.9977175, 'specificity': 0.9977175, 'f1': 0.9977175, 'auroc': 0.9999441, 'binary_precision': 0.9981803, 'binary_recall': 0.9972537, 'binary_specificity': 0.99818134, 'binary_f1_score': 0.99771684}
confusion matrix:
       0      1
0  25796     47
1     71  25782
---- Validation: 
scalar performance:
{'acc': 0.981488, 'precision': 0.8194169, 'recall': 0.7572638, 'specificity': 0.7572638, 'f1': 0.78477657, 'auroc': 0.95780694, 'binary_precision': 0.6507463, 'binary_recall': 0.5215311, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.5790173}
confusion matrix:
       0    1
0  16589  117
1    200  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.782501, 'precision': 0.61260265, 'recall': 0.8050687, 'specificity': 0.8050687, 'f1': 0.6224343, 'auroc': 0.8582448, 'binary_precision': 0.24339207, 'binary_recall': 0.8318695, 'binary_specificity': 0.77826786, 'binary_f1_score': 0.37659755}
confusion matrix:
      0     1
0  7234  2061
1   134   663
better model found
persisted
after epoch: 18,now: 2024-08-07 17:07:38.746226,epoch time: 0:19:01.150975,used: 5:48:00.884662,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9970404, 'precision': 0.9970484, 'recall': 0.9970409, 'specificity': 0.9970409, 'f1': 0.9970404, 'auroc': 0.9999167, 'binary_precision': 0.9991067, 'binary_recall': 0.99497193, 'binary_specificity': 0.9991099, 'binary_f1_score': 0.997035}
confusion matrix:
       0      1
0  25818     23
1    130  25725
---- Validation: 
scalar performance:
{'acc': 0.9791521, 'precision': 0.7788357, 'recall': 0.8015501, 'specificity': 0.8015501, 'f1': 0.7897152, 'auroc': 0.9502877, 'binary_precision': 0.56732893, 'binary_recall': 0.6148325, 'binary_specificity': 0.98826766, 'binary_f1_score': 0.5901263}
confusion matrix:
       0    1
0  16510  196
1    161  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9131986, 'precision': 0.7027534, 'recall': 0.7073941, 'specificity': 0.7073941, 'f1': 0.7050381, 'auroc': 0.89279616, 'binary_precision': 0.45165238, 'binary_recall': 0.4629862, 'binary_specificity': 0.951802, 'binary_f1_score': 0.45724905}
confusion matrix:
      0    1
0  8847  448
1   428  369
early stop counter: 1
val acc:0.9791520833969116, best validation acc: 0.9814879894256592, corresponding to test acc:                         0.7825009822845459 / 0.9257827997207642
after epoch: 19,now: 2024-08-07 17:26:35.455962,epoch time: 0:18:56.709736,used: 6:06:57.594398,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9968276, 'precision': 0.99683297, 'recall': 0.9968277, 'specificity': 0.9968277, 'f1': 0.9968276, 'auroc': 0.99984384, 'binary_precision': 0.9984863, 'binary_recall': 0.9951644, 'binary_specificity': 0.99849105, 'binary_f1_score': 0.9968226}
confusion matrix:
       0      1
0  25807     39
1    125  25725
---- Validation: 
scalar performance:
{'acc': 0.97961926, 'precision': 0.7781327, 'recall': 0.86243415, 'specificity': 0.86243415, 'f1': 0.8143017, 'auroc': 0.9642755, 'binary_precision': 0.56284153, 'binary_recall': 0.73923445, 'binary_specificity': 0.9856339, 'binary_f1_score': 0.63909}
confusion matrix:
       0    1
0  16466  240
1    109  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5655965, 'precision': 0.56601375, 'recall': 0.7268928, 'specificity': 0.7268928, 'f1': 0.4722692, 'auroc': 0.8779501, 'binary_precision': 0.1449218, 'binary_recall': 0.91844416, 'binary_specificity': 0.53534156, 'binary_f1_score': 0.250342}
confusion matrix:
      0     1
0  4976  4319
1    65   732
early stop counter: 2
val acc:0.9796192646026611, best validation acc: 0.9814879894256592, corresponding to test acc:                         0.7825009822845459 / 0.9257827997207642
after epoch: 20,now: 2024-08-07 17:45:28.417489,epoch time: 0:18:52.961527,used: 6:25:50.555925,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076680
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:25:50.555925 at 2024-08-07 17:45:28.417489
persisted model performance metric: 

scalar performance:
{'acc': 0.782501, 'precision': 0.61260265, 'recall': 0.8050687, 'specificity': 0.8050687, 'f1': 0.6224343, 'auroc': 0.8582448, 'binary_precision': 0.24339207, 'binary_recall': 0.8318695, 'binary_specificity': 0.77826786, 'binary_f1_score': 0.37659755}
confusion matrix:
      0     1
0  7234  2061
1   134   663
oracle model performance metric: 

scalar performance:
{'acc': 0.9257828, 'precision': 0.7446271, 'recall': 0.72110844, 'specificity': 0.72110844, 'f1': 0.73209524, 'auroc': 0.9023297, 'binary_precision': 0.53361344, 'binary_recall': 0.47804266, 'binary_specificity': 0.9641743, 'binary_f1_score': 0.50430185}
confusion matrix:
      0    1
0  8962  333
1   416  381
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |  40858 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  41672 MiB |  27200 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  41570 MiB |  27164 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool | 455249 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |  10843 KiB |     44 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7467    |  329277 K  |  329272 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158241 K  |
|       from small pool |    4735    |    7278    |  171035 K  |  171030 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7467    |  329277 K  |  329272 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158241 K  |
|       from small pool |    4735    |    7278    |  171035 K  |  171030 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1783    |    1148    |
|       from large pool |     602    |     602    |    1732    |    1130    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3293    |  192653 K  |  192653 K  |
|       from large pool |      36    |     605    |  110448 K  |  110448 K  |
|       from small pool |      38    |    3257    |   82205 K  |   82205 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |      0 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  41672 MiB |  40770 MiB |
|       from large pool |    850 MiB |  14412 MiB |  41570 MiB |  40720 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool |  24320 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |      0 KiB |     46 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7467    |  329277 K  |  329277 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171035 K  |  171035 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7467    |  329277 K  |  329277 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171035 K  |  171035 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1783    |    1719    |
|       from large pool |      38    |     602    |    1732    |    1694    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3293    |  192655 K  |  192655 K  |
|       from large pool |       3    |     605    |  110448 K  |  110448 K  |
|       from small pool |       0    |    3257    |   82207 K  |   82207 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 18:03:00 2024]
Finished job 0.
1 of 1 steps (100%) done
