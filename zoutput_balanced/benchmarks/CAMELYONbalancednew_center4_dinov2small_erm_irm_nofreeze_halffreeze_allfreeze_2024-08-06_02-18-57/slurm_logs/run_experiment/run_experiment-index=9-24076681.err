Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 22:13:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681

 Experiment start at: 2024-08-06 22:23:08.438582
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8643201, 'precision': 0.8721859, 'recall': 0.8643632, 'specificity': 0.8643632, 'f1': 0.8636093, 'auroc': 0.9199759, 'binary_precision': 0.9264407, 'binary_recall': 0.79165846, 'binary_specificity': 0.9370679, 'binary_f1_score': 0.85376287}
confusion matrix:
       0      1
0  23720   1593
1   5280  20063
---- Validation: 
scalar performance:
{'acc': 0.8877289, 'precision': 0.5271829, 'recall': 0.6064408, 'specificity': 0.6064408, 'f1': 0.5291169, 'auroc': 0.7491039, 'binary_precision': 0.072963804, 'binary_recall': 0.31084338, 'binary_specificity': 0.90203816, 'binary_f1_score': 0.11818599}
confusion matrix:
       0     1
0  15092  1639
1    286   129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79127944, 'precision': 0.5230819, 'recall': 0.5465696, 'specificity': 0.5465696, 'f1': 0.51974565, 'auroc': 0.6642615, 'binary_precision': 0.11456534, 'binary_recall': 0.25777203, 'binary_specificity': 0.83536714, 'binary_f1_score': 0.15862894}
confusion matrix:
      0     1
0  7804  1538
1   573   199
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 22:42:23.537390,epoch time: 0:19:15.098808,used: 0:19:15.098808,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90806615, 'precision': 0.91466296, 'recall': 0.908106, 'specificity': 0.908106, 'f1': 0.90770495, 'auroc': 0.9605367, 'binary_precision': 0.9671228, 'binary_recall': 0.84497315, 'binary_specificity': 0.9712389, 'binary_f1_score': 0.90193105}
confusion matrix:
       0      1
0  24584    728
1   3929  21415
---- Validation: 
scalar performance:
{'acc': 0.84987754, 'precision': 0.53348124, 'recall': 0.6810404, 'specificity': 0.6810404, 'f1': 0.52873474, 'auroc': 0.7882143, 'binary_precision': 0.08110206, 'binary_recall': 0.5036145, 'binary_specificity': 0.8584663, 'binary_f1_score': 0.13970588}
confusion matrix:
       0     1
0  14363  2368
1    206   209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7463911, 'precision': 0.55394036, 'recall': 0.64644736, 'specificity': 0.64644736, 'f1': 0.54454803, 'auroc': 0.724702, 'binary_precision': 0.15638176, 'binary_recall': 0.5284974, 'binary_specificity': 0.7643973, 'binary_f1_score': 0.24134871}
confusion matrix:
      0     1
0  7141  2201
1   364   408
early stop counter: 1
val acc:0.8498775362968445, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.7912794351577759
after epoch: 2,now: 2024-08-06 23:00:27.784011,epoch time: 0:18:04.246621,used: 0:37:19.345429,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.921115, 'precision': 0.926341, 'recall': 0.9211456, 'specificity': 0.9211456, 'f1': 0.9208763, 'auroc': 0.9721715, 'binary_precision': 0.97368187, 'binary_recall': 0.865717, 'binary_specificity': 0.97657424, 'binary_f1_score': 0.9165309}
confusion matrix:
       0      1
0  24721    593
1   3403  21939
---- Validation: 
scalar performance:
{'acc': 0.83733815, 'precision': 0.54140806, 'recall': 0.74746114, 'specificity': 0.74746114, 'f1': 0.53631645, 'auroc': 0.83223367, 'binary_precision': 0.092935525, 'binary_recall': 0.65301204, 'binary_specificity': 0.84191024, 'binary_f1_score': 0.1627139}
confusion matrix:
       0     1
0  14086  2645
1    144   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343286, 'precision': 0.57316536, 'recall': 0.7159685, 'specificity': 0.7159685, 'f1': 0.5610136, 'auroc': 0.7764812, 'binary_precision': 0.17944425, 'binary_recall': 0.69430053, 'binary_specificity': 0.7376365, 'binary_f1_score': 0.28518224}
confusion matrix:
      0     1
0  6891  2451
1   236   536
early stop counter: 2
val acc:0.8373381495475769, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.7912794351577759
after epoch: 3,now: 2024-08-06 23:18:43.844452,epoch time: 0:18:16.060441,used: 0:55:35.405870,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9310447, 'precision': 0.93489075, 'recall': 0.931067, 'specificity': 0.931067, 'f1': 0.93089426, 'auroc': 0.97856486, 'binary_precision': 0.97590727, 'binary_recall': 0.8839779, 'binary_specificity': 0.9781561, 'binary_f1_score': 0.9276706}
confusion matrix:
       0      1
0  24763    553
1   2940  22400
---- Validation: 
scalar performance:
{'acc': 0.83273065, 'precision': 0.5465438, 'recall': 0.7897478, 'specificity': 0.7897478, 'f1': 0.5420909, 'auroc': 0.8578379, 'binary_precision': 0.10061869, 'binary_recall': 0.7445783, 'binary_specificity': 0.83491725, 'binary_f1_score': 0.17728056}
confusion matrix:
       0     1
0  13969  2762
1    106   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73264784, 'precision': 0.5811275, 'recall': 0.744766, 'specificity': 0.744766, 'f1': 0.56850576, 'auroc': 0.8080838, 'binary_precision': 0.18878865, 'binary_recall': 0.75906736, 'binary_specificity': 0.7304646, 'binary_f1_score': 0.3023736}
confusion matrix:
      0     1
0  6824  2518
1   186   586
early stop counter: 3
val acc:0.8327306509017944, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.7912794351577759
after epoch: 4,now: 2024-08-06 23:36:59.332743,epoch time: 0:18:15.488291,used: 1:13:50.894161,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9372236, 'precision': 0.94097024, 'recall': 0.93725467, 'specificity': 0.93725467, 'f1': 0.9370931, 'auroc': 0.98194593, 'binary_precision': 0.981785, 'binary_recall': 0.89106333, 'binary_specificity': 0.98344594, 'binary_f1_score': 0.93422693}
confusion matrix:
       0      1
0  24892    419
1   2761  22584
---- Validation: 
scalar performance:
{'acc': 0.85710955, 'precision': 0.5542215, 'recall': 0.7998897, 'specificity': 0.7998897, 'f1': 0.5609682, 'auroc': 0.87098086, 'binary_precision': 0.11589279, 'binary_recall': 0.739759, 'binary_specificity': 0.86002034, 'binary_f1_score': 0.20039165}
confusion matrix:
       0     1
0  14389  2342
1    108   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76616573, 'precision': 0.5900847, 'recall': 0.751621, 'specificity': 0.751621, 'f1': 0.5913606, 'auroc': 0.8231371, 'binary_precision': 0.20792079, 'binary_recall': 0.73445594, 'binary_specificity': 0.76878613, 'binary_f1_score': 0.3240926}
confusion matrix:
      0     1
0  7182  2160
1   205   567
early stop counter: 4
val acc:0.857109546661377, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.7912794351577759
after epoch: 5,now: 2024-08-06 23:55:07.085557,epoch time: 0:18:07.752814,used: 1:31:58.646975,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94354075, 'precision': 0.94624966, 'recall': 0.9435639, 'specificity': 0.9435639, 'f1': 0.94345695, 'auroc': 0.9842769, 'binary_precision': 0.9811668, 'binary_recall': 0.90451014, 'binary_specificity': 0.9826176, 'binary_f1_score': 0.94128036}
confusion matrix:
       0      1
0  24873    440
1   2420  22923
---- Validation: 
scalar performance:
{'acc': 0.84433687, 'precision': 0.5529658, 'recall': 0.8156687, 'specificity': 0.8156687, 'f1': 0.5550745, 'auroc': 0.8818243, 'binary_precision': 0.11218169, 'binary_recall': 0.7855422, 'binary_specificity': 0.8457952, 'binary_f1_score': 0.1963264}
confusion matrix:
       0     1
0  14151  2580
1     89   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7585525, 'precision': 0.59299177, 'recall': 0.768295, 'specificity': 0.768295, 'f1': 0.59147835, 'auroc': 0.8348158, 'binary_precision': 0.20946416, 'binary_recall': 0.7797927, 'binary_specificity': 0.75679725, 'binary_f1_score': 0.3302249}
confusion matrix:
      0     1
0  7070  2272
1   170   602
early stop counter: 5
val acc:0.8443368673324585, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.7912794351577759
after epoch: 6,now: 2024-08-07 00:13:14.002913,epoch time: 0:18:06.917356,used: 1:50:05.564331,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95009476, 'precision': 0.9514961, 'recall': 0.95010686, 'specificity': 0.95010686, 'f1': 0.9500569, 'auroc': 0.9857387, 'binary_precision': 0.9767588, 'binary_recall': 0.9221753, 'binary_specificity': 0.9780385, 'binary_f1_score': 0.94868255}
confusion matrix:
       0      1
0  24761    556
1   1972  23367
---- Validation: 
scalar performance:
{'acc': 0.8251487, 'precision': 0.549084, 'recall': 0.81993586, 'specificity': 0.81993586, 'f1': 0.5430397, 'auroc': 0.89124715, 'binary_precision': 0.1037128, 'binary_recall': 0.81445783, 'binary_specificity': 0.8254139, 'binary_f1_score': 0.18399565}
confusion matrix:
       0     1
0  13810  2921
1     77   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74223846, 'precision': 0.5931355, 'recall': 0.78144735, 'specificity': 0.78144735, 'f1': 0.58471984, 'auroc': 0.8494601, 'binary_precision': 0.20526823, 'binary_recall': 0.8277202, 'binary_specificity': 0.7351745, 'binary_f1_score': 0.32895753}
confusion matrix:
      0     1
0  6868  2474
1   133   639
early stop counter: 6
val acc:0.8251487016677856, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.7912794351577759
after epoch: 7,now: 2024-08-07 00:31:23.169147,epoch time: 0:18:09.166234,used: 2:08:14.730565,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9508844, 'precision': 0.9528477, 'recall': 0.95090264, 'specificity': 0.95090264, 'f1': 0.9508325, 'auroc': 0.9870126, 'binary_precision': 0.98280376, 'binary_recall': 0.91788334, 'binary_specificity': 0.98392195, 'binary_f1_score': 0.94923484}
confusion matrix:
       0      1
0  24907    407
1   2081  23261
---- Validation: 
scalar performance:
{'acc': 0.85868424, 'precision': 0.55820626, 'recall': 0.82302034, 'specificity': 0.82302034, 'f1': 0.5672073, 'auroc': 0.8950139, 'binary_precision': 0.12255639, 'binary_recall': 0.7855422, 'binary_specificity': 0.8604985, 'binary_f1_score': 0.21203251}
confusion matrix:
       0     1
0  14397  2334
1     89   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906862, 'precision': 0.60534465, 'recall': 0.7803422, 'specificity': 0.7803422, 'f1': 0.6169931, 'auroc': 0.85234076, 'binary_precision': 0.23429474, 'binary_recall': 0.7681347, 'binary_specificity': 0.7925498, 'binary_f1_score': 0.3590675}
confusion matrix:
      0     1
0  7404  1938
1   179   593
early stop counter: 7
val acc:0.858684241771698, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.7912794351577759
after epoch: 8,now: 2024-08-07 00:49:29.585670,epoch time: 0:18:06.416523,used: 2:26:21.147088,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95514846, 'precision': 0.9565227, 'recall': 0.95516366, 'specificity': 0.95516366, 'f1': 0.9551157, 'auroc': 0.9885602, 'binary_precision': 0.9817088, 'binary_recall': 0.92763, 'binary_specificity': 0.9826973, 'binary_f1_score': 0.9539036}
confusion matrix:
       0      1
0  24876    438
1   1834  23508
---- Validation: 
scalar performance:
{'acc': 0.856118, 'precision': 0.55772245, 'recall': 0.82523024, 'specificity': 0.82523024, 'f1': 0.5657029, 'auroc': 0.89793473, 'binary_precision': 0.12140221, 'binary_recall': 0.7927711, 'binary_specificity': 0.8576893, 'binary_f1_score': 0.21056}
confusion matrix:
       0     1
0  14350  2381
1     86   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7989915, 'precision': 0.60899234, 'recall': 0.78305566, 'specificity': 0.78305566, 'f1': 0.6238876, 'auroc': 0.85561514, 'binary_precision': 0.24170423, 'binary_recall': 0.7642487, 'binary_specificity': 0.80186254, 'binary_f1_score': 0.367258}
confusion matrix:
      0     1
0  7491  1851
1   182   590
new oracle model saved
early stop counter: 8
val acc:0.8561180233955383, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.7989915013313293
after epoch: 9,now: 2024-08-07 01:07:31.718140,epoch time: 0:18:02.132470,used: 2:44:23.279558,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95822805, 'precision': 0.95913017, 'recall': 0.9582421, 'specificity': 0.9582421, 'f1': 0.95820844, 'auroc': 0.98943305, 'binary_precision': 0.9796399, 'binary_recall': 0.9359612, 'binary_specificity': 0.98052305, 'binary_f1_score': 0.95730263}
confusion matrix:
       0      1
0  24819    493
1   1623  23721
---- Validation: 
scalar performance:
{'acc': 0.8642832, 'precision': 0.5615927, 'recall': 0.83293885, 'specificity': 0.83293885, 'f1': 0.57382834, 'auroc': 0.90094256, 'binary_precision': 0.12888199, 'binary_recall': 0.8, 'binary_specificity': 0.8658777, 'binary_f1_score': 0.22199935}
confusion matrix:
       0     1
0  14487  2244
1     83   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81491005, 'precision': 0.61693466, 'recall': 0.7887019, 'specificity': 0.7887019, 'f1': 0.6378448, 'auroc': 0.8613762, 'binary_precision': 0.25770926, 'binary_recall': 0.757772, 'binary_specificity': 0.81963176, 'binary_f1_score': 0.38461542}
confusion matrix:
      0     1
0  7657  1685
1   187   585
new oracle model saved
early stop counter: 9
val acc:0.8642832040786743, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8149100542068481
after epoch: 10,now: 2024-08-07 01:25:33.364512,epoch time: 0:18:01.646372,used: 3:02:24.925930,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9595902, 'precision': 0.9603934, 'recall': 0.95959926, 'specificity': 0.95959926, 'f1': 0.9595731, 'auroc': 0.9897548, 'binary_precision': 0.97973305, 'binary_recall': 0.93863213, 'binary_specificity': 0.98056644, 'binary_f1_score': 0.95874226}
confusion matrix:
       0      1
0  24825    492
1   1555  23784
---- Validation: 
scalar performance:
{'acc': 0.8577511, 'precision': 0.5588856, 'recall': 0.82959175, 'specificity': 0.82959175, 'f1': 0.5678929, 'auroc': 0.9029943, 'binary_precision': 0.1235119, 'binary_recall': 0.8, 'binary_specificity': 0.85918355, 'binary_f1_score': 0.21398647}
confusion matrix:
       0     1
0  14375  2356
1     83   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8109551, 'precision': 0.616977, 'recall': 0.7948791, 'specificity': 0.7948791, 'f1': 0.63675684, 'auroc': 0.86865187, 'binary_precision': 0.2562019, 'binary_recall': 0.77590674, 'binary_specificity': 0.8138514, 'binary_f1_score': 0.385209}
confusion matrix:
      0     1
0  7603  1739
1   173   599
early stop counter: 10
val acc:0.8577510714530945, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8149100542068481
after epoch: 11,now: 2024-08-07 01:43:34.960284,epoch time: 0:18:01.595772,used: 3:20:26.521702,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9608141, 'precision': 0.96166205, 'recall': 0.9608243, 'specificity': 0.9608243, 'f1': 0.9607967, 'auroc': 0.99090743, 'binary_precision': 0.98156625, 'binary_recall': 0.9393054, 'binary_specificity': 0.9823432, 'binary_f1_score': 0.95997095}
confusion matrix:
       0      1
0  24869    447
1   1538  23802
---- Validation: 
scalar performance:
{'acc': 0.8651581, 'precision': 0.5616156, 'recall': 0.8310373, 'specificity': 0.8310373, 'f1': 0.57412696, 'auroc': 0.90453064, 'binary_precision': 0.12905748, 'binary_recall': 0.79518074, 'binary_specificity': 0.86689377, 'binary_f1_score': 0.22207266}
confusion matrix:
       0     1
0  14504  2227
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8339925, 'precision': 0.62587017, 'recall': 0.78714865, 'specificity': 0.78714865, 'f1': 0.6529447, 'auroc': 0.8659893, 'binary_precision': 0.27736866, 'binary_recall': 0.7318653, 'binary_specificity': 0.842432, 'binary_f1_score': 0.40227836}
confusion matrix:
      0     1
0  7870  1472
1   207   565
new oracle model saved
early stop counter: 11
val acc:0.8651580810546875, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8339924812316895
after epoch: 12,now: 2024-08-07 02:01:41.796165,epoch time: 0:18:06.835881,used: 3:38:33.357583,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96213675, 'precision': 0.9631618, 'recall': 0.96214986, 'specificity': 0.96214986, 'f1': 0.9621166, 'auroc': 0.99175483, 'binary_precision': 0.9850895, 'binary_recall': 0.938521, 'binary_specificity': 0.9857786, 'binary_f1_score': 0.9612416}
confusion matrix:
       0      1
0  24954    360
1   1558  23784
---- Validation: 
scalar performance:
{'acc': 0.876181, 'precision': 0.5666173, 'recall': 0.8355105, 'specificity': 0.8355105, 'f1': 0.5846161, 'auroc': 0.9067691, 'binary_precision': 0.13905326, 'binary_recall': 0.7927711, 'binary_specificity': 0.87824994, 'binary_f1_score': 0.23660555}
confusion matrix:
       0     1
0  14694  2037
1     86   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8443741, 'precision': 0.63240886, 'recall': 0.7886094, 'specificity': 0.7886094, 'f1': 0.66256094, 'auroc': 0.8711391, 'binary_precision': 0.29092804, 'binary_recall': 0.72279793, 'binary_specificity': 0.8544209, 'binary_f1_score': 0.41486984}
confusion matrix:
      0     1
0  7982  1360
1   214   558
new oracle model saved
early stop counter: 12
val acc:0.8761810064315796, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8443741202354431
after epoch: 13,now: 2024-08-07 02:19:40.850222,epoch time: 0:17:59.054057,used: 3:56:32.411640,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96310407, 'precision': 0.9637333, 'recall': 0.96311355, 'specificity': 0.96311355, 'f1': 0.9630921, 'auroc': 0.99163544, 'binary_precision': 0.98094416, 'binary_recall': 0.9445957, 'binary_specificity': 0.98163146, 'binary_f1_score': 0.96242684}
confusion matrix:
       0      1
0  24850    465
1   1404  23937
---- Validation: 
scalar performance:
{'acc': 0.8688324, 'precision': 0.56362, 'recall': 0.83526987, 'specificity': 0.83526987, 'f1': 0.5781358, 'auroc': 0.90889335, 'binary_precision': 0.13290632, 'binary_recall': 0.8, 'binary_specificity': 0.8705397, 'binary_f1_score': 0.22794369}
confusion matrix:
       0     1
0  14565  2166
1     83   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84368205, 'precision': 0.6358218, 'recall': 0.8024943, 'specificity': 0.8024943, 'f1': 0.6668065, 'auroc': 0.8788456, 'binary_precision': 0.29498225, 'binary_recall': 0.753886, 'binary_specificity': 0.85110253, 'binary_f1_score': 0.42404374}
confusion matrix:
      0     1
0  7951  1391
1   190   582
early stop counter: 13
val acc:0.8688324093818665, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8443741202354431
after epoch: 14,now: 2024-08-07 02:37:41.879911,epoch time: 0:18:01.029689,used: 4:14:33.441329,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9645057, 'precision': 0.96532774, 'recall': 0.964519, 'specificity': 0.964519, 'f1': 0.9644907, 'auroc': 0.992391, 'binary_precision': 0.9850445, 'binary_recall': 0.9433791, 'binary_specificity': 0.985659, 'binary_f1_score': 0.9637617}
confusion matrix:
       0      1
0  24949    363
1   1435  23909
---- Validation: 
scalar performance:
{'acc': 0.8658579, 'precision': 0.5626379, 'recall': 0.8360956, 'specificity': 0.8360956, 'f1': 0.5758206, 'auroc': 0.9090693, 'binary_precision': 0.13082647, 'binary_recall': 0.8048193, 'binary_specificity': 0.8673719, 'binary_f1_score': 0.22506739}
confusion matrix:
       0     1
0  14512  2219
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8454617, 'precision': 0.63639367, 'recall': 0.8004869, 'specificity': 0.8004869, 'f1': 0.66773754, 'auroc': 0.8772625, 'binary_precision': 0.2966581, 'binary_recall': 0.74740934, 'binary_specificity': 0.85356456, 'binary_f1_score': 0.4247332}
confusion matrix:
      0     1
0  7974  1368
1   195   577
new oracle model saved
early stop counter: 14
val acc:0.8658578991889954, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8454617261886597
after epoch: 15,now: 2024-08-07 02:55:41.606536,epoch time: 0:17:59.726625,used: 4:32:33.167954,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96505845, 'precision': 0.96572566, 'recall': 0.96507347, 'specificity': 0.96507347, 'f1': 0.9650467, 'auroc': 0.9925528, 'binary_precision': 0.9835521, 'binary_recall': 0.9459918, 'binary_specificity': 0.9841552, 'binary_f1_score': 0.9644064}
confusion matrix:
       0      1
0  24907    401
1   1369  23979
---- Validation: 
scalar performance:
{'acc': 0.8603756, 'precision': 0.56047225, 'recall': 0.8344614, 'specificity': 0.8344614, 'f1': 0.5710032, 'auroc': 0.9095776, 'binary_precision': 0.12646282, 'binary_recall': 0.8072289, 'binary_specificity': 0.86169386, 'binary_f1_score': 0.2186684}
confusion matrix:
       0     1
0  14417  2314
1     80   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84635156, 'precision': 0.6380683, 'recall': 0.8045335, 'specificity': 0.8045335, 'f1': 0.66995853, 'auroc': 0.87923586, 'binary_precision': 0.29928133, 'binary_recall': 0.7551814, 'binary_specificity': 0.85388565, 'binary_f1_score': 0.4286765}
confusion matrix:
      0     1
0  7977  1365
1   189   583
new oracle model saved
early stop counter: 15
val acc:0.8603755831718445, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8463515639305115
after epoch: 16,now: 2024-08-07 03:13:36.834850,epoch time: 0:17:55.228314,used: 4:50:28.396268,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96711147, 'precision': 0.96761966, 'recall': 0.96712136, 'specificity': 0.96712136, 'f1': 0.96710306, 'auroc': 0.9933044, 'binary_precision': 0.98318434, 'binary_recall': 0.9505189, 'binary_specificity': 0.98372376, 'binary_f1_score': 0.9665758}
confusion matrix:
       0      1
0  24901    412
1   1254  24089
---- Validation: 
scalar performance:
{'acc': 0.87075704, 'precision': 0.5641518, 'recall': 0.8339062, 'specificity': 0.8339062, 'f1': 0.5794741, 'auroc': 0.91069525, 'binary_precision': 0.13409184, 'binary_recall': 0.79518074, 'binary_specificity': 0.87263167, 'binary_f1_score': 0.22948541}
confusion matrix:
       0     1
0  14600  2131
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86207235, 'precision': 0.6463769, 'recall': 0.79343665, 'specificity': 0.79343665, 'f1': 0.68110746, 'auroc': 0.87886906, 'binary_precision': 0.31921068, 'binary_recall': 0.71243525, 'binary_specificity': 0.87443805, 'binary_f1_score': 0.44088176}
confusion matrix:
      0     1
0  8169  1173
1   222   550
new oracle model saved
early stop counter: 16
val acc:0.8707570433616638, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8620723485946655
after epoch: 17,now: 2024-08-07 03:31:29.345223,epoch time: 0:17:52.510373,used: 5:08:20.906641,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96890795, 'precision': 0.9693502, 'recall': 0.9689177, 'specificity': 0.9689177, 'f1': 0.96890104, 'auroc': 0.9939846, 'binary_precision': 0.9839163, 'binary_recall': 0.95344067, 'binary_specificity': 0.9843947, 'binary_f1_score': 0.9684388}
confusion matrix:
       0      1
0  24917    395
1   1180  24164
---- Validation: 
scalar performance:
{'acc': 0.87804735, 'precision': 0.56795067, 'recall': 0.8388167, 'specificity': 0.8388167, 'f1': 0.58708304, 'auroc': 0.91146874, 'binary_precision': 0.141574, 'binary_recall': 0.7975904, 'binary_specificity': 0.880043, 'binary_f1_score': 0.24046494}
confusion matrix:
       0     1
0  14724  2007
1     84   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8633577, 'precision': 0.64983904, 'recall': 0.8024505, 'specificity': 0.8024505, 'f1': 0.6857013, 'auroc': 0.88423944, 'binary_precision': 0.32451093, 'binary_recall': 0.73056996, 'binary_specificity': 0.874331, 'binary_f1_score': 0.4494024}
confusion matrix:
      0     1
0  8168  1174
1   208   564
new oracle model saved
early stop counter: 17
val acc:0.8780473470687866, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8633577227592468
after epoch: 18,now: 2024-08-07 03:49:23.215566,epoch time: 0:17:53.870343,used: 5:26:14.776984,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97030956, 'precision': 0.9706607, 'recall': 0.97031665, 'specificity': 0.97031665, 'f1': 0.9703043, 'auroc': 0.99419355, 'binary_precision': 0.98364645, 'binary_recall': 0.9565526, 'binary_specificity': 0.9840806, 'binary_f1_score': 0.9699104}
confusion matrix:
       0      1
0  24912    403
1   1101  24240
---- Validation: 
scalar performance:
{'acc': 0.88265485, 'precision': 0.5700614, 'recall': 0.8388277, 'specificity': 0.8388277, 'f1': 0.59140766, 'auroc': 0.9140401, 'binary_precision': 0.145898, 'binary_recall': 0.7927711, 'binary_specificity': 0.88488436, 'binary_f1_score': 0.24644195}
confusion matrix:
       0     1
0  14805  1926
1     86   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8682025, 'precision': 0.6535302, 'recall': 0.80091405, 'specificity': 0.80091405, 'f1': 0.69014186, 'auroc': 0.8857739, 'binary_precision': 0.33253732, 'binary_recall': 0.7215026, 'binary_specificity': 0.88032544, 'binary_f1_score': 0.45525134}
confusion matrix:
      0     1
0  8224  1118
1   215   557
new oracle model saved
early stop counter: 18
val acc:0.8826548457145691, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8682025074958801
after epoch: 19,now: 2024-08-07 04:07:16.522909,epoch time: 0:17:53.307343,used: 5:44:08.084327,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9695989, 'precision': 0.97002697, 'recall': 0.96960604, 'specificity': 0.96960604, 'f1': 0.9695923, 'auroc': 0.994575, 'binary_precision': 0.9843305, 'binary_recall': 0.9544199, 'binary_specificity': 0.98479223, 'binary_f1_score': 0.96914446}
confusion matrix:
       0      1
0  24931    385
1   1155  24185
---- Validation: 
scalar performance:
{'acc': 0.8652747, 'precision': 0.56326884, 'recall': 0.84167147, 'specificity': 0.84167147, 'f1': 0.5765576, 'auroc': 0.9127994, 'binary_precision': 0.13175282, 'binary_recall': 0.8168675, 'binary_specificity': 0.8664754, 'binary_f1_score': 0.22690763}
confusion matrix:
       0     1
0  14497  2234
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8562389, 'precision': 0.6464632, 'recall': 0.8104799, 'specificity': 0.8104799, 'f1': 0.681438, 'auroc': 0.8857038, 'binary_precision': 0.31567568, 'binary_recall': 0.7564767, 'binary_specificity': 0.864483, 'binary_f1_score': 0.44546148}
confusion matrix:
      0     1
0  8076  1266
1   188   584
early stop counter: 19
val acc:0.8652747273445129, best validation acc: 0.8877289295196533, corresponding to test acc:                         0.7912794351577759 / 0.8682025074958801
after epoch: 20,now: 2024-08-07 04:25:13.124106,epoch time: 0:17:56.601197,used: 6:02:04.685524,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:02:04.685524 at 2024-08-07 04:25:13.124106
persisted model performance metric: 

scalar performance:
{'acc': 0.79127944, 'precision': 0.5230819, 'recall': 0.5465696, 'specificity': 0.5465696, 'f1': 0.51974565, 'auroc': 0.6642615, 'binary_precision': 0.11456534, 'binary_recall': 0.25777203, 'binary_specificity': 0.83536714, 'binary_f1_score': 0.15862894}
confusion matrix:
      0     1
0  7804  1538
1   573   199
oracle model performance metric: 

scalar performance:
{'acc': 0.8682025, 'precision': 0.6535302, 'recall': 0.80091405, 'specificity': 0.80091405, 'f1': 0.69014186, 'auroc': 0.8857739, 'binary_precision': 0.33253732, 'binary_recall': 0.7215026, 'binary_specificity': 0.88032544, 'binary_f1_score': 0.45525134}
confusion matrix:
      0     1
0  8224  1118
1   215   557
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   7828 MiB | 490155 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   7828 MiB | 490155 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |  16663 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61220 KiB | 732464 KiB | 276936 GiB | 276936 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |  10458 KiB |  13009 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6827    |   92214 K  |   92210 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46589 K  |   46585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6827    |   92214 K  |   92210 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46589 K  |   46585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3189    |   54235 K  |   54235 K  |
|       from large pool |      10    |     350    |   34657 K  |   34657 K  |
|       from small pool |      25    |    3179    |   19577 K  |   19577 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 260096 KiB |   8530 MiB |   8530 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  28672 KiB |     44 MiB |     44 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276936 GiB | 276936 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |      0 KiB |  24597 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92214 K  |   92214 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92214 K  |   92214 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     371    |     371    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      14    |      22    |      22    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3189    |   54237 K  |   54237 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3179    |   19579 K  |   19579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 260096 KiB |   8530 MiB |   8530 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  28672 KiB |     44 MiB |     44 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276936 GiB | 276936 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |      0 KiB |  24597 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92214 K  |   92214 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92214 K  |   92214 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46589 K  |   46589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     371    |     371    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      14    |      22    |      22    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3189    |   54237 K  |   54237 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3179    |   19579 K  |   19579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681

 Experiment start at: 2024-08-07 04:49:43.119095
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.82562166, 'precision': 0.8265918, 'recall': 0.82564306, 'specificity': 0.82564306, 'f1': 0.8254986, 'auroc': 0.89697635, 'binary_precision': 0.84458953, 'binary_recall': 0.7984353, 'binary_specificity': 0.85285085, 'binary_f1_score': 0.82086414}
confusion matrix:
       0      1
0  21659   3737
1   5127  20309
---- Validation: 
scalar performance:
{'acc': 0.87297785, 'precision': 0.50506204, 'recall': 0.52008826, 'specificity': 0.52008826, 'f1': 0.4937448, 'auroc': 0.7282208, 'binary_precision': 0.034188036, 'binary_recall': 0.14849187, 'binary_specificity': 0.89168465, 'binary_f1_score': 0.05557968}
confusion matrix:
       0     1
0  14884  1808
1    367    64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7849569, 'precision': 0.49353114, 'recall': 0.48743016, 'specificity': 0.48743016, 'f1': 0.48279285, 'auroc': 0.63787663, 'binary_precision': 0.064157926, 'binary_recall': 0.13738441, 'binary_specificity': 0.8374759, 'binary_f1_score': 0.08746846}
confusion matrix:
      0     1
0  7817  1517
1   653   104
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 05:08:34.679910,epoch time: 0:18:51.560815,used: 0:18:51.560815,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88461995, 'precision': 0.8886388, 'recall': 0.88465595, 'specificity': 0.88465595, 'f1': 0.88432765, 'auroc': 0.9422829, 'binary_precision': 0.9283369, 'binary_recall': 0.8337658, 'binary_specificity': 0.9355461, 'binary_f1_score': 0.8785136}
confusion matrix:
       0      1
0  23761   1637
1   4228  21206
---- Validation: 
scalar performance:
{'acc': 0.8991999, 'precision': 0.51629025, 'recall': 0.55162, 'specificity': 0.55162, 'f1': 0.51574904, 'auroc': 0.7800214, 'binary_precision': 0.05498282, 'binary_recall': 0.18561485, 'binary_specificity': 0.9176252, 'binary_f1_score': 0.08483563}
confusion matrix:
       0     1
0  15317  1375
1    351    80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82122684, 'precision': 0.51824063, 'recall': 0.5300994, 'specificity': 0.5300994, 'f1': 0.5181569, 'auroc': 0.7154076, 'binary_precision': 0.106686704, 'binary_recall': 0.18758257, 'binary_specificity': 0.87261623, 'binary_f1_score': 0.13601533}
confusion matrix:
      0     1
0  8145  1189
1   615   142
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 05:26:22.399689,epoch time: 0:17:47.719779,used: 0:36:39.280594,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90675163, 'precision': 0.91182333, 'recall': 0.9067932, 'specificity': 0.9067932, 'f1': 0.90646994, 'auroc': 0.9614892, 'binary_precision': 0.95771223, 'binary_recall': 0.8512286, 'binary_specificity': 0.96235776, 'binary_f1_score': 0.9013363}
confusion matrix:
       0      1
0  24441    956
1   3784  21651
---- Validation: 
scalar performance:
{'acc': 0.91368335, 'precision': 0.5385205, 'recall': 0.609905, 'specificity': 0.609905, 'f1': 0.5496121, 'auroc': 0.8085131, 'binary_precision': 0.096376255, 'binary_recall': 0.2900232, 'binary_specificity': 0.92978674, 'binary_f1_score': 0.14467594}
confusion matrix:
       0     1
0  15520  1172
1    306   125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84292936, 'precision': 0.5590528, 'recall': 0.594634, 'specificity': 0.594634, 'f1': 0.56839967, 'auroc': 0.7687669, 'binary_precision': 0.17807154, 'binary_recall': 0.3025099, 'binary_specificity': 0.8867581, 'binary_f1_score': 0.22418012}
confusion matrix:
      0     1
0  8277  1057
1   528   229
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 05:44:16.517496,epoch time: 0:17:54.117807,used: 0:54:33.398401,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9179847, 'precision': 0.9220054, 'recall': 0.9180232, 'specificity': 0.9180232, 'f1': 0.9177939, 'auroc': 0.97016287, 'binary_precision': 0.9633939, 'binary_recall': 0.8691225, 'binary_specificity': 0.96692395, 'binary_f1_score': 0.9138334}
confusion matrix:
       0      1
0  24556    840
1   3329  22107
---- Validation: 
scalar performance:
{'acc': 0.9175962, 'precision': 0.5555107, 'recall': 0.66050786, 'specificity': 0.66050786, 'f1': 0.57445645, 'auroc': 0.83118033, 'binary_precision': 0.12765957, 'binary_recall': 0.3897912, 'binary_specificity': 0.9312245, 'binary_f1_score': 0.1923297}
confusion matrix:
       0     1
0  15544  1148
1    263   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8462987, 'precision': 0.58658105, 'recall': 0.65229326, 'specificity': 0.65229326, 'f1': 0.60326517, 'auroc': 0.8023429, 'binary_precision': 0.22353761, 'binary_recall': 0.42404228, 'binary_specificity': 0.88054425, 'binary_f1_score': 0.29274967}
confusion matrix:
      0     1
0  8219  1115
1   436   321
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 06:02:24.136885,epoch time: 0:18:07.619389,used: 1:12:41.017790,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93069327, 'precision': 0.9352877, 'recall': 0.9307399, 'specificity': 0.9307399, 'f1': 0.93051493, 'auroc': 0.97875476, 'binary_precision': 0.9802349, 'binary_recall': 0.8792405, 'binary_specificity': 0.9822392, 'binary_f1_score': 0.92699504}
confusion matrix:
       0      1
0  24942    451
1   3072  22367
---- Validation: 
scalar performance:
{'acc': 0.92512995, 'precision': 0.56990147, 'recall': 0.69036514, 'specificity': 0.69036514, 'f1': 0.59511024, 'auroc': 0.84222597, 'binary_precision': 0.15490673, 'binary_recall': 0.44315544, 'binary_specificity': 0.93757486, 'binary_f1_score': 0.22956732}
confusion matrix:
       0     1
0  15650  1042
1    240   191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8509563, 'precision': 0.6100562, 'recall': 0.70761424, 'specificity': 0.70761424, 'f1': 0.6337615, 'auroc': 0.8312845, 'binary_precision': 0.26103646, 'binary_recall': 0.53896964, 'binary_specificity': 0.87625885, 'binary_f1_score': 0.35172415}
confusion matrix:
      0     1
0  8179  1155
1   349   408
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 06:20:38.855825,epoch time: 0:18:14.718940,used: 1:30:55.736730,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93932956, 'precision': 0.94234157, 'recall': 0.93936217, 'specificity': 0.93936217, 'f1': 0.93922913, 'auroc': 0.98227394, 'binary_precision': 0.97903985, 'binary_recall': 0.89797926, 'binary_specificity': 0.980745, 'binary_f1_score': 0.9367592}
confusion matrix:
       0      1
0  24907    489
1   2595  22841
---- Validation: 
scalar performance:
{'acc': 0.93172926, 'precision': 0.58939433, 'recall': 0.7366953, 'specificity': 0.7366953, 'f1': 0.62283087, 'auroc': 0.8583474, 'binary_precision': 0.19147158, 'binary_recall': 0.5313225, 'binary_specificity': 0.94206804, 'binary_f1_score': 0.2814997}
confusion matrix:
       0    1
0  15725  967
1    202  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.850659, 'precision': 0.6215979, 'recall': 0.7438696, 'specificity': 0.7438696, 'f1': 0.64909077, 'auroc': 0.8454615, 'binary_precision': 0.27758008, 'binary_recall': 0.61822987, 'binary_specificity': 0.86950934, 'binary_f1_score': 0.3831355}
confusion matrix:
      0     1
0  8116  1218
1   289   468
better model found
persisted
after epoch: 6,now: 2024-08-07 06:38:50.580155,epoch time: 0:18:11.724330,used: 1:49:07.461060,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94351983, 'precision': 0.9456818, 'recall': 0.94354737, 'specificity': 0.94354737, 'f1': 0.94345367, 'auroc': 0.98497295, 'binary_precision': 0.9769201, 'binary_recall': 0.90859413, 'binary_specificity': 0.97850055, 'binary_f1_score': 0.94151914}
confusion matrix:
       0      1
0  24850    546
1   2325  23111
---- Validation: 
scalar performance:
{'acc': 0.9381534, 'precision': 0.5991348, 'recall': 0.73999023, 'specificity': 0.73999023, 'f1': 0.63477755, 'auroc': 0.86369187, 'binary_precision': 0.21086556, 'binary_recall': 0.5313225, 'binary_specificity': 0.94865805, 'binary_f1_score': 0.30191168}
confusion matrix:
       0    1
0  15835  857
1    202  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604697, 'precision': 0.6330037, 'recall': 0.75766987, 'specificity': 0.75766987, 'f1': 0.6636757, 'auroc': 0.8605881, 'binary_precision': 0.29845202, 'binary_recall': 0.63672394, 'binary_specificity': 0.8786158, 'binary_f1_score': 0.4064081}
confusion matrix:
      0     1
0  8201  1133
1   275   482
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-07 06:57:00.573726,epoch time: 0:18:09.993571,used: 2:07:17.454631,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9483593, 'precision': 0.9498298, 'recall': 0.94838417, 'specificity': 0.94838417, 'f1': 0.948319, 'auroc': 0.9868438, 'binary_precision': 0.9757664, 'binary_recall': 0.91964775, 'binary_specificity': 0.9771206, 'binary_f1_score': 0.94687635}
confusion matrix:
       0      1
0  24813    581
1   2044  23394
---- Validation: 
scalar performance:
{'acc': 0.9375694, 'precision': 0.6005064, 'recall': 0.74873185, 'specificity': 0.74873185, 'f1': 0.6372528, 'auroc': 0.8690356, 'binary_precision': 0.21312949, 'binary_recall': 0.54988396, 'binary_specificity': 0.9475797, 'binary_f1_score': 0.30719376}
confusion matrix:
       0    1
0  15817  875
1    194  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549202, 'precision': 0.634969, 'recall': 0.7789475, 'specificity': 0.7789475, 'f1': 0.6667172, 'auroc': 0.8663837, 'binary_precision': 0.29811537, 'binary_recall': 0.68956405, 'binary_specificity': 0.86833084, 'binary_f1_score': 0.41626793}
confusion matrix:
      0     1
0  8105  1229
1   235   522
early stop counter: 1
val acc:0.9375693798065186, best validation acc: 0.9381533861160278, corresponding to test acc:                         0.8604696989059448 / 0.8604696989059448
after epoch: 8,now: 2024-08-07 07:15:14.421343,epoch time: 0:18:13.847617,used: 2:25:31.302248,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95142823, 'precision': 0.9529879, 'recall': 0.95144796, 'specificity': 0.95144796, 'f1': 0.9513879, 'auroc': 0.98832405, 'binary_precision': 0.9797359, 'binary_recall': 0.9219911, 'binary_specificity': 0.98090476, 'binary_f1_score': 0.9499868}
confusion matrix:
       0      1
0  24914    485
1   1984  23449
---- Validation: 
scalar performance:
{'acc': 0.9400222, 'precision': 0.60557294, 'recall': 0.7533803, 'specificity': 0.7533803, 'f1': 0.64357215, 'auroc': 0.87115616, 'binary_precision': 0.22304833, 'binary_recall': 0.55684453, 'binary_specificity': 0.9499161, 'binary_f1_score': 0.3185136}
confusion matrix:
       0    1
0  15856  836
1    191  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8570013, 'precision': 0.6428241, 'recall': 0.80192196, 'specificity': 0.80192196, 'f1': 0.6771131, 'auroc': 0.8761908, 'binary_precision': 0.30965593, 'binary_recall': 0.7371202, 'binary_specificity': 0.8667238, 'binary_f1_score': 0.43610784}
confusion matrix:
      0     1
0  8090  1244
1   199   558
better model found
persisted
after epoch: 9,now: 2024-08-07 07:33:29.552290,epoch time: 0:18:15.130947,used: 2:43:46.433195,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.952884, 'precision': 0.95426315, 'recall': 0.9529047, 'specificity': 0.9529047, 'f1': 0.9528497, 'auroc': 0.9884316, 'binary_precision': 0.97948056, 'binary_recall': 0.92522115, 'binary_specificity': 0.98058826, 'binary_f1_score': 0.95157796}
confusion matrix:
       0      1
0  24904    493
1   1902  23533
---- Validation: 
scalar performance:
{'acc': 0.93342286, 'precision': 0.6022377, 'recall': 0.78050923, 'specificity': 0.78050923, 'f1': 0.6419985, 'auroc': 0.87848014, 'binary_precision': 0.21480289, 'binary_recall': 0.61948955, 'binary_specificity': 0.94152886, 'binary_f1_score': 0.31899643}
confusion matrix:
       0    1
0  15716  976
1    164  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85174906, 'precision': 0.6417478, 'recall': 0.81182855, 'specificity': 0.81182855, 'f1': 0.6754867, 'auroc': 0.8807026, 'binary_precision': 0.30521876, 'binary_recall': 0.7648613, 'binary_specificity': 0.8587958, 'binary_f1_score': 0.4363225}
confusion matrix:
      0     1
0  8016  1318
1   178   579
early stop counter: 1
val acc:0.933422863483429, best validation acc: 0.9400221705436707, corresponding to test acc:                         0.8570013046264648 / 0.8604696989059448
after epoch: 10,now: 2024-08-07 07:51:42.299385,epoch time: 0:18:12.747095,used: 3:01:59.180290,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95516604, 'precision': 0.95633304, 'recall': 0.955183, 'specificity': 0.955183, 'f1': 0.95513856, 'auroc': 0.98987913, 'binary_precision': 0.9795775, 'binary_recall': 0.92977625, 'binary_specificity': 0.9805898, 'binary_f1_score': 0.9540274}
confusion matrix:
       0      1
0  24906    493
1   1786  23647
---- Validation: 
scalar performance:
{'acc': 0.9329557, 'precision': 0.60283893, 'recall': 0.78592026, 'specificity': 0.78592026, 'f1': 0.6431242, 'auroc': 0.8785645, 'binary_precision': 0.21570182, 'binary_recall': 0.63109046, 'binary_specificity': 0.94075006, 'binary_f1_score': 0.321513}
confusion matrix:
       0    1
0  15703  989
1    159  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8452086, 'precision': 0.64023656, 'recall': 0.8222526, 'specificity': 0.8222526, 'f1': 0.672799, 'auroc': 0.886039, 'binary_precision': 0.29965156, 'binary_recall': 0.7952444, 'binary_specificity': 0.84926075, 'binary_f1_score': 0.4352856}
confusion matrix:
      0     1
0  7927  1407
1   155   602
early stop counter: 2
val acc:0.9329556822776794, best validation acc: 0.9400221705436707, corresponding to test acc:                         0.8570013046264648 / 0.8604696989059448
after epoch: 11,now: 2024-08-07 08:09:54.973103,epoch time: 0:18:12.673718,used: 3:20:11.854008,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9573497, 'precision': 0.9583936, 'recall': 0.9573686, 'specificity': 0.9573686, 'f1': 0.95732665, 'auroc': 0.99017036, 'binary_precision': 0.9804658, 'binary_recall': 0.9333622, 'binary_specificity': 0.98137504, 'binary_f1_score': 0.95633435}
confusion matrix:
       0      1
0  24923    473
1   1695  23741
---- Validation: 
scalar performance:
{'acc': 0.941015, 'precision': 0.61429405, 'recall': 0.782143, 'specificity': 0.782143, 'f1': 0.6566373, 'auroc': 0.8812138, 'binary_precision': 0.23895401, 'binary_recall': 0.6148492, 'binary_specificity': 0.94943684, 'binary_f1_score': 0.34415585}
confusion matrix:
       0    1
0  15848  844
1    166  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8569022, 'precision': 0.65003294, 'recall': 0.8297874, 'specificity': 0.8297874, 'f1': 0.6865661, 'auroc': 0.8911879, 'binary_precision': 0.3187335, 'binary_recall': 0.7978864, 'binary_specificity': 0.86168844, 'binary_f1_score': 0.45550534}
confusion matrix:
      0     1
0  8043  1291
1   153   604
better model found
persisted
after epoch: 12,now: 2024-08-07 08:28:15.483064,epoch time: 0:18:20.509961,used: 3:38:32.363969,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95910054, 'precision': 0.9599237, 'recall': 0.9591148, 'specificity': 0.9591148, 'f1': 0.9590832, 'auroc': 0.9913736, 'binary_precision': 0.9795483, 'binary_recall': 0.93783665, 'binary_specificity': 0.98039293, 'binary_f1_score': 0.9582388}
confusion matrix:
       0      1
0  24901    498
1   1581  23852
---- Validation: 
scalar performance:
{'acc': 0.93161243, 'precision': 0.60416216, 'recall': 0.7999231, 'specificity': 0.7999231, 'f1': 0.6456864, 'auroc': 0.88285255, 'binary_precision': 0.21755725, 'binary_recall': 0.6612529, 'binary_specificity': 0.9385933, 'binary_f1_score': 0.32739806}
confusion matrix:
       0     1
0  15667  1025
1    146   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8381726, 'precision': 0.64073956, 'recall': 0.8402989, 'specificity': 0.8402989, 'f1': 0.67204905, 'auroc': 0.89425826, 'binary_precision': 0.2964684, 'binary_recall': 0.84280056, 'binary_specificity': 0.8377973, 'binary_f1_score': 0.43863872}
confusion matrix:
      0     1
0  7820  1514
1   119   638
early stop counter: 1
val acc:0.9316124320030212, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.8569021821022034 / 0.8604696989059448
after epoch: 13,now: 2024-08-07 08:46:45.299803,epoch time: 0:18:29.816739,used: 3:57:02.180708,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96061534, 'precision': 0.9613214, 'recall': 0.9606316, 'specificity': 0.9606316, 'f1': 0.9606012, 'auroc': 0.99178755, 'binary_precision': 0.9795768, 'binary_recall': 0.94091284, 'binary_specificity': 0.98035043, 'binary_f1_score': 0.9598556}
confusion matrix:
       0      1
0  24896    499
1   1503  23934
---- Validation: 
scalar performance:
{'acc': 0.9331893, 'precision': 0.60571355, 'recall': 0.79734147, 'specificity': 0.79734147, 'f1': 0.64752597, 'auroc': 0.8853027, 'binary_precision': 0.22083007, 'binary_recall': 0.65429235, 'binary_specificity': 0.9403906, 'binary_f1_score': 0.33021078}
confusion matrix:
       0    1
0  15697  995
1    149  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8457041, 'precision': 0.6439202, 'recall': 0.835266, 'specificity': 0.835266, 'f1': 0.6774664, 'auroc': 0.894441, 'binary_precision': 0.3044966, 'binary_recall': 0.8229855, 'binary_specificity': 0.8475466, 'binary_f1_score': 0.44452372}
confusion matrix:
      0     1
0  7911  1423
1   134   623
early stop counter: 2
val acc:0.9331892728805542, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.8569021821022034 / 0.8604696989059448
after epoch: 14,now: 2024-08-07 09:04:59.817263,epoch time: 0:18:14.517460,used: 4:15:16.698168,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9641761, 'precision': 0.9646343, 'recall': 0.964188, 'specificity': 0.964188, 'f1': 0.96416795, 'auroc': 0.99289274, 'binary_precision': 0.9794137, 'binary_recall': 0.9483389, 'binary_specificity': 0.98003703, 'binary_f1_score': 0.96362585}
confusion matrix:
       0      1
0  24890    507
1   1314  24121
---- Validation: 
scalar performance:
{'acc': 0.92477953, 'precision': 0.59877026, 'recall': 0.8133705, 'specificity': 0.8133705, 'f1': 0.63899595, 'auroc': 0.88593876, 'binary_precision': 0.20590255, 'binary_recall': 0.6960557, 'binary_specificity': 0.93068534, 'binary_f1_score': 0.31779662}
confusion matrix:
       0     1
0  15535  1157
1    131   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83202857, 'precision': 0.6377829, 'recall': 0.84183323, 'specificity': 0.84183323, 'f1': 0.6669829, 'auroc': 0.8971349, 'binary_precision': 0.28968608, 'binary_recall': 0.8533686, 'binary_specificity': 0.8302978, 'binary_f1_score': 0.43254095}
confusion matrix:
      0     1
0  7750  1584
1   111   646
early stop counter: 3
val acc:0.9247795343399048, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.8569021821022034 / 0.8604696989059448
after epoch: 15,now: 2024-08-07 09:23:15.629898,epoch time: 0:18:15.812635,used: 4:33:32.510803,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96476626, 'precision': 0.96513987, 'recall': 0.96477926, 'specificity': 0.96477926, 'f1': 0.9647599, 'auroc': 0.99279994, 'binary_precision': 0.9785495, 'binary_recall': 0.95043045, 'binary_specificity': 0.9791281, 'binary_f1_score': 0.964285}
confusion matrix:
       0      1
0  24863    530
1   1261  24178
---- Validation: 
scalar performance:
{'acc': 0.9278164, 'precision': 0.60235894, 'recall': 0.813798, 'specificity': 0.813798, 'f1': 0.6439646, 'auroc': 0.88637614, 'binary_precision': 0.21311475, 'binary_recall': 0.6937355, 'binary_specificity': 0.93386054, 'binary_f1_score': 0.32606325}
confusion matrix:
       0     1
0  15588  1104
1    132   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8393618, 'precision': 0.6412711, 'recall': 0.8397279, 'specificity': 0.8397279, 'f1': 0.6729615, 'auroc': 0.8966739, 'binary_precision': 0.2977528, 'binary_recall': 0.8401585, 'binary_specificity': 0.8392972, 'binary_f1_score': 0.439682}
confusion matrix:
      0     1
0  7834  1500
1   121   636
early stop counter: 4
val acc:0.9278163909912109, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.8569021821022034 / 0.8604696989059448
after epoch: 16,now: 2024-08-07 09:41:34.557002,epoch time: 0:18:18.927104,used: 4:51:51.437907,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96429414, 'precision': 0.96479833, 'recall': 0.9643053, 'specificity': 0.9643053, 'f1': 0.964285, 'auroc': 0.9932668, 'binary_precision': 0.9802749, 'binary_recall': 0.94770575, 'binary_specificity': 0.98090476, 'binary_f1_score': 0.96371526}
confusion matrix:
       0      1
0  24914    485
1   1330  24103
---- Validation: 
scalar performance:
{'acc': 0.927466, 'precision': 0.60000074, 'recall': 0.8045772, 'specificity': 0.8045772, 'f1': 0.6403858, 'auroc': 0.8858996, 'binary_precision': 0.20890164, 'binary_recall': 0.675174, 'binary_specificity': 0.93398035, 'binary_f1_score': 0.31907895}
confusion matrix:
       0     1
0  15590  1102
1    140   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8437221, 'precision': 0.6453673, 'recall': 0.8457265, 'specificity': 0.8457265, 'f1': 0.6788743, 'auroc': 0.89947927, 'binary_precision': 0.30513307, 'binary_recall': 0.84808457, 'binary_specificity': 0.84336835, 'binary_f1_score': 0.44879413}
confusion matrix:
      0     1
0  7872  1462
1   115   642
early stop counter: 5
val acc:0.9274659752845764, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.8569021821022034 / 0.8604696989059448
after epoch: 17,now: 2024-08-07 09:59:50.609253,epoch time: 0:18:16.052251,used: 5:10:07.490158,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96637946, 'precision': 0.9667176, 'recall': 0.96638966, 'specificity': 0.96638966, 'f1': 0.9663738, 'auroc': 0.99367535, 'binary_precision': 0.9794681, 'binary_recall': 0.9527816, 'binary_specificity': 0.97999763, 'binary_f1_score': 0.96594054}
confusion matrix:
       0      1
0  24889    508
1   1201  24234
---- Validation: 
scalar performance:
{'acc': 0.9121649, 'precision': 0.5882878, 'recall': 0.82159215, 'specificity': 0.82159215, 'f1': 0.62353325, 'auroc': 0.8860421, 'binary_precision': 0.18422602, 'binary_recall': 0.7262181, 'binary_specificity': 0.9169662, 'binary_f1_score': 0.2938967}
confusion matrix:
       0     1
0  15306  1386
1    118   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8291547, 'precision': 0.63667953, 'recall': 0.8433144, 'specificity': 0.8433144, 'f1': 0.66489065, 'auroc': 0.9002148, 'binary_precision': 0.28691053, 'binary_recall': 0.8599736, 'binary_specificity': 0.82665527, 'binary_f1_score': 0.43027097}
confusion matrix:
      0     1
0  7716  1618
1   106   651
early stop counter: 6
val acc:0.9121649265289307, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.8569021821022034 / 0.8604696989059448
after epoch: 18,now: 2024-08-07 10:18:11.885615,epoch time: 0:18:21.276362,used: 5:28:28.766520,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9667336, 'precision': 0.96724164, 'recall': 0.966746, 'specificity': 0.966746, 'f1': 0.9667251, 'auroc': 0.9934732, 'binary_precision': 0.98283714, 'binary_recall': 0.9501081, 'binary_specificity': 0.9833839, 'binary_f1_score': 0.9661955}
confusion matrix:
       0      1
0  24975    422
1   1269  24166
---- Validation: 
scalar performance:
{'acc': 0.9129241, 'precision': 0.5883443, 'recall': 0.8185911, 'specificity': 0.8185911, 'f1': 0.62365085, 'auroc': 0.88595974, 'binary_precision': 0.1845238, 'binary_recall': 0.71925753, 'binary_specificity': 0.91792476, 'binary_f1_score': 0.29369968}
confusion matrix:
       0     1
0  15322  1370
1    121   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8355961, 'precision': 0.64158314, 'recall': 0.8492241, 'specificity': 0.8492241, 'f1': 0.67242265, 'auroc': 0.90221, 'binary_precision': 0.29611212, 'binary_recall': 0.8652576, 'binary_specificity': 0.8331905, 'binary_f1_score': 0.441226}
confusion matrix:
      0     1
0  7777  1557
1   102   655
early stop counter: 7
val acc:0.9129241108894348, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.8569021821022034 / 0.8604696989059448
after epoch: 19,now: 2024-08-07 10:36:23.392199,epoch time: 0:18:11.506584,used: 5:46:40.273104,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9681106, 'precision': 0.9686688, 'recall': 0.968125, 'specificity': 0.968125, 'f1': 0.96810186, 'auroc': 0.994251, 'binary_precision': 0.9850509, 'binary_recall': 0.9507017, 'binary_specificity': 0.9855483, 'binary_f1_score': 0.96757156}
confusion matrix:
       0      1
0  25028    367
1   1254  24183
---- Validation: 
scalar performance:
{'acc': 0.92080826, 'precision': 0.59485024, 'recall': 0.814724, 'specificity': 0.814724, 'f1': 0.63343316, 'auroc': 0.8853679, 'binary_precision': 0.19790986, 'binary_recall': 0.7030162, 'binary_specificity': 0.92643183, 'binary_f1_score': 0.3088685}
confusion matrix:
       0     1
0  15464  1228
1    128   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8451095, 'precision': 0.64624894, 'recall': 0.8458694, 'specificity': 0.8458694, 'f1': 0.68023056, 'auroc': 0.9017285, 'binary_precision': 0.30699235, 'binary_recall': 0.84676355, 'binary_specificity': 0.84497535, 'binary_f1_score': 0.4506151}
confusion matrix:
      0     1
0  7887  1447
1   116   641
early stop counter: 8
val acc:0.9208082556724548, best validation acc: 0.9410150051116943, corresponding to test acc:                         0.8569021821022034 / 0.8604696989059448
after epoch: 20,now: 2024-08-07 10:55:55.585032,epoch time: 0:19:32.192833,used: 6:06:12.465937,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_49_42_seed_1_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:06:12.465937 at 2024-08-07 10:55:55.585032
persisted model performance metric: 

scalar performance:
{'acc': 0.8569022, 'precision': 0.65003294, 'recall': 0.8297874, 'specificity': 0.8297874, 'f1': 0.6865661, 'auroc': 0.8911879, 'binary_precision': 0.3187335, 'binary_recall': 0.7978864, 'binary_specificity': 0.86168844, 'binary_f1_score': 0.45550534}
confusion matrix:
      0     1
0  8043  1291
1   153   604
oracle model performance metric: 

scalar performance:
{'acc': 0.8604697, 'precision': 0.6330037, 'recall': 0.75766987, 'specificity': 0.75766987, 'f1': 0.6636757, 'auroc': 0.8605881, 'binary_precision': 0.29845202, 'binary_recall': 0.63672394, 'binary_specificity': 0.8786158, 'binary_f1_score': 0.4064081}
confusion matrix:
      0     1
0  8201  1133
1   275   482
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |  16662 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16788 MiB |   8276 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     54 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38101 KiB | 732464 KiB | 548716 GiB | 548716 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 533711 GiB | 533711 GiB |
|       from small pool |   6368 KiB |  24597 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6849    |  185258 K  |  185254 K  |
|       from large pool |      79    |     762    |   91848 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93409 K  |   93405 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6849    |  185258 K  |  185254 K  |
|       from large pool |      79    |     762    |   91848 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93409 K  |   93405 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     714    |     346    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      22    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3199    |  103702 K  |  103702 K  |
|       from large pool |      11    |     352    |   63923 K  |   63923 K  |
|       from small pool |      19    |    3189    |   39778 K  |   39778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548717 GiB | 548717 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533712 GiB | 533711 GiB |
|       from small pool |      0 KiB |  24597 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185258 K  |  185258 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185258 K  |  185258 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     714    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  103704 K  |  103704 K  |
|       from large pool |       3    |     352    |   63923 K  |   63923 K  |
|       from small pool |       0    |    3189    |   39780 K  |   39780 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548717 GiB | 548717 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533712 GiB | 533711 GiB |
|       from small pool |      0 KiB |  24597 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185258 K  |  185258 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185258 K  |  185258 K  |
|       from large pool |       2    |     762    |   91848 K  |   91848 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     714    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  103704 K  |  103704 K  |
|       from large pool |       3    |     352    |   63923 K  |   63923 K  |
|       from small pool |       0    |    3189    |   39780 K  |   39780 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681

 Experiment start at: 2024-08-07 11:19:37.798396
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8623104, 'precision': 0.8666376, 'recall': 0.86232305, 'specificity': 0.86232305, 'f1': 0.86190593, 'auroc': 0.9281963, 'binary_precision': 0.9065266, 'binary_recall': 0.8079988, 'binary_specificity': 0.9166473, 'binary_f1_score': 0.8544317}
confusion matrix:
       0      1
0  23688   2154
1   4964  20890
---- Validation: 
scalar performance:
{'acc': 0.83035505, 'precision': 0.5198724, 'recall': 0.614497, 'specificity': 0.614497, 'f1': 0.5033442, 'auroc': 0.6849328, 'binary_precision': 0.057630736, 'binary_recall': 0.3875598, 'binary_specificity': 0.84143424, 'binary_f1_score': 0.10034066}
confusion matrix:
       0     1
0  14057  2649
1    256   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7715022, 'precision': 0.5845252, 'recall': 0.71994644, 'specificity': 0.71994644, 'f1': 0.5879195, 'auroc': 0.7751733, 'binary_precision': 0.20515826, 'binary_recall': 0.6587202, 'binary_specificity': 0.7811727, 'binary_f1_score': 0.31287247}
confusion matrix:
      0     1
0  7261  2034
1   272   525
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 11:40:43.737603,epoch time: 0:21:05.939207,used: 0:21:05.939207,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90761375, 'precision': 0.9110614, 'recall': 0.90761733, 'specificity': 0.90761733, 'f1': 0.90742016, 'auroc': 0.9618055, 'binary_precision': 0.9487267, 'binary_recall': 0.8618182, 'binary_specificity': 0.9534164, 'binary_f1_score': 0.90318656}
confusion matrix:
       0      1
0  24642   1204
1   3572  22278
---- Validation: 
scalar performance:
{'acc': 0.88612473, 'precision': 0.53217614, 'recall': 0.62908465, 'specificity': 0.62908465, 'f1': 0.53619605, 'auroc': 0.739174, 'binary_precision': 0.08187773, 'binary_recall': 0.35885167, 'binary_specificity': 0.8993176, 'binary_f1_score': 0.13333334}
confusion matrix:
       0     1
0  15024  1682
1    268   150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83154976, 'precision': 0.6013124, 'recall': 0.7020713, 'specificity': 0.7020713, 'f1': 0.62150663, 'auroc': 0.79592544, 'binary_precision': 0.24592009, 'binary_recall': 0.54830617, 'binary_specificity': 0.85583645, 'binary_f1_score': 0.33954933}
confusion matrix:
      0     1
0  7955  1340
1   360   437
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 12:01:08.972392,epoch time: 0:20:25.234789,used: 0:41:31.173996,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92310816, 'precision': 0.92703855, 'recall': 0.9231137, 'specificity': 0.9231137, 'f1': 0.9229315, 'auroc': 0.97158396, 'binary_precision': 0.96803594, 'binary_recall': 0.87513053, 'binary_specificity': 0.97109693, 'binary_f1_score': 0.9192417}
confusion matrix:
       0      1
0  25098    747
1   3228  22623
---- Validation: 
scalar performance:
{'acc': 0.91363, 'precision': 0.54109234, 'recall': 0.62335527, 'specificity': 0.62335527, 'f1': 0.553466, 'auroc': 0.7649439, 'binary_precision': 0.100226074, 'binary_recall': 0.3181818, 'binary_specificity': 0.92852867, 'binary_f1_score': 0.15243553}
confusion matrix:
       0     1
0  15512  1194
1    285   133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86315894, 'precision': 0.61515987, 'recall': 0.680229, 'specificity': 0.680229, 'f1': 0.63591564, 'auroc': 0.8099736, 'binary_precision': 0.27912253, 'binary_recall': 0.4629862, 'binary_specificity': 0.8974718, 'binary_f1_score': 0.34827748}
confusion matrix:
      0    1
0  8342  953
1   428  369
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 12:20:02.457021,epoch time: 0:18:53.484629,used: 1:00:24.658625,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9319677, 'precision': 0.9344684, 'recall': 0.9319676, 'specificity': 0.9319676, 'f1': 0.9318696, 'auroc': 0.9774933, 'binary_precision': 0.96743, 'binary_recall': 0.8940343, 'binary_specificity': 0.96990097, 'binary_f1_score': 0.9292852}
confusion matrix:
       0      1
0  25070    778
1   2739  23109
---- Validation: 
scalar performance:
{'acc': 0.91059333, 'precision': 0.5523411, 'recall': 0.67194736, 'specificity': 0.67194736, 'f1': 0.5698158, 'auroc': 0.7856997, 'binary_precision': 0.12013652, 'binary_recall': 0.42105263, 'binary_specificity': 0.9228421, 'binary_f1_score': 0.18693575}
confusion matrix:
       0     1
0  15417  1289
1    242   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8670234, 'precision': 0.6186391, 'recall': 0.6800326, 'specificity': 0.6800326, 'f1': 0.63911104, 'auroc': 0.82160425, 'binary_precision': 0.28627452, 'binary_recall': 0.45796737, 'binary_specificity': 0.9020979, 'binary_f1_score': 0.35231662}
confusion matrix:
      0    1
0  8385  910
1   432  365
new oracle model saved
early stop counter: 1
val acc:0.9105933308601379, best validation acc: 0.9136300086975098, corresponding to test acc:                         0.8631589412689209 / 0.8670234084129333
after epoch: 4,now: 2024-08-07 12:38:51.215249,epoch time: 0:18:48.758228,used: 1:19:13.416853,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9378869, 'precision': 0.9398944, 'recall': 0.93788946, 'specificity': 0.93788946, 'f1': 0.9378162, 'auroc': 0.9806087, 'binary_precision': 0.96963036, 'binary_recall': 0.9041006, 'binary_specificity': 0.9716784, 'binary_f1_score': 0.9357196}
confusion matrix:
       0      1
0  25114    732
1   2479  23371
---- Validation: 
scalar performance:
{'acc': 0.91065174, 'precision': 0.5577761, 'recall': 0.6941359, 'specificity': 0.6941359, 'f1': 0.5778988, 'auroc': 0.8011317, 'binary_precision': 0.1298269, 'binary_recall': 0.46650717, 'binary_specificity': 0.9217646, 'binary_f1_score': 0.203125}
confusion matrix:
       0     1
0  15399  1307
1    223   195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8734641, 'precision': 0.63664794, 'recall': 0.7122072, 'specificity': 0.7122072, 'f1': 0.6616414, 'auroc': 0.8379369, 'binary_precision': 0.3167939, 'binary_recall': 0.52070266, 'binary_specificity': 0.9037117, 'binary_f1_score': 0.39392504}
confusion matrix:
      0    1
0  8400  895
1   382  415
new oracle model saved
early stop counter: 2
val acc:0.9106517434120178, best validation acc: 0.9136300086975098, corresponding to test acc:                         0.8631589412689209 / 0.8734641075134277
after epoch: 5,now: 2024-08-07 12:57:40.075671,epoch time: 0:18:48.860422,used: 1:38:02.277275,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9408078, 'precision': 0.9439652, 'recall': 0.9408159, 'specificity': 0.9408159, 'f1': 0.94070315, 'auroc': 0.9834007, 'binary_precision': 0.9814541, 'binary_recall': 0.8986191, 'binary_specificity': 0.9830128, 'binary_f1_score': 0.9382118}
confusion matrix:
       0      1
0  25404    439
1   2621  23232
---- Validation: 
scalar performance:
{'acc': 0.9183018, 'precision': 0.5663485, 'recall': 0.7073866, 'specificity': 0.7073866, 'f1': 0.5909045, 'auroc': 0.8135293, 'binary_precision': 0.14635904, 'binary_recall': 0.48564592, 'binary_specificity': 0.9291273, 'binary_f1_score': 0.22493073}
confusion matrix:
       0     1
0  15522  1184
1    215   203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8874356, 'precision': 0.6536026, 'recall': 0.7117621, 'specificity': 0.7117621, 'f1': 0.67578423, 'auroc': 0.84606004, 'binary_precision': 0.3514461, 'binary_recall': 0.50313675, 'binary_specificity': 0.9203873, 'binary_f1_score': 0.4138287}
confusion matrix:
      0    1
0  8555  740
1   396  401
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 13:16:28.450922,epoch time: 0:18:48.375251,used: 1:56:50.652526,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9468624, 'precision': 0.9497341, 'recall': 0.9468748, 'specificity': 0.9468748, 'f1': 0.94677854, 'auroc': 0.98640823, 'binary_precision': 0.9857485, 'binary_recall': 0.9068688, 'binary_specificity': 0.9868808, 'binary_f1_score': 0.94466496}
confusion matrix:
       0      1
0  25501    339
1   2408  23448
---- Validation: 
scalar performance:
{'acc': 0.9305653, 'precision': 0.5785645, 'recall': 0.710173, 'specificity': 0.710173, 'f1': 0.6076621, 'auroc': 0.8205757, 'binary_precision': 0.17079419, 'binary_recall': 0.4784689, 'binary_specificity': 0.9418772, 'binary_f1_score': 0.25173062}
confusion matrix:
       0    1
0  15735  971
1    218  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8967499, 'precision': 0.6648996, 'recall': 0.7007588, 'specificity': 0.7007588, 'f1': 0.6802916, 'auroc': 0.8512579, 'binary_precision': 0.37638748, 'binary_recall': 0.46800503, 'binary_specificity': 0.9335126, 'binary_f1_score': 0.41722593}
confusion matrix:
      0    1
0  8677  618
1   424  373
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-07 13:35:18.414347,epoch time: 0:18:49.963425,used: 2:15:40.615951,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9519692, 'precision': 0.95298517, 'recall': 0.95197105, 'specificity': 0.95197105, 'f1': 0.9519424, 'auroc': 0.9871843, 'binary_precision': 0.97445685, 'binary_recall': 0.9282785, 'binary_specificity': 0.97566354, 'binary_f1_score': 0.95080733}
confusion matrix:
       0      1
0  25217    629
1   1854  23996
---- Validation: 
scalar performance:
{'acc': 0.9184186, 'precision': 0.57392365, 'recall': 0.738935, 'specificity': 0.738935, 'f1': 0.60229105, 'auroc': 0.8292252, 'binary_precision': 0.15983322, 'binary_recall': 0.5502392, 'binary_specificity': 0.9276308, 'binary_f1_score': 0.24771138}
confusion matrix:
       0     1
0  15497  1209
1    188   230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89110184, 'precision': 0.66265935, 'recall': 0.7240764, 'specificity': 0.7240764, 'f1': 0.68619937, 'auroc': 0.8565079, 'binary_precision': 0.36754385, 'binary_recall': 0.52572143, 'binary_specificity': 0.9224314, 'binary_f1_score': 0.4326278}
confusion matrix:
      0    1
0  8574  721
1   378  419
early stop counter: 1
val acc:0.9184185862541199, best validation acc: 0.9305652976036072, corresponding to test acc:                         0.8967499136924744 / 0.8967499136924744
after epoch: 8,now: 2024-08-07 13:54:21.872860,epoch time: 0:19:03.458513,used: 2:34:44.074464,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9534007, 'precision': 0.95460725, 'recall': 0.95340365, 'specificity': 0.95340365, 'f1': 0.95337, 'auroc': 0.9886179, 'binary_precision': 0.97805697, 'binary_recall': 0.9276237, 'binary_specificity': 0.9791836, 'binary_f1_score': 0.952173}
confusion matrix:
       0      1
0  25307    538
1   1871  23980
---- Validation: 
scalar performance:
{'acc': 0.9229152, 'precision': 0.58037245, 'recall': 0.7494033, 'specificity': 0.7494033, 'f1': 0.6117706, 'auroc': 0.83445656, 'binary_precision': 0.17223836, 'binary_recall': 0.56698567, 'binary_specificity': 0.9318209, 'binary_f1_score': 0.26421404}
confusion matrix:
       0     1
0  15567  1139
1    181   237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89526355, 'precision': 0.6675277, 'recall': 0.7183059, 'specificity': 0.7183059, 'f1': 0.68807256, 'auroc': 0.8598546, 'binary_precision': 0.37850466, 'binary_recall': 0.5081556, 'binary_specificity': 0.9284562, 'binary_f1_score': 0.4338511}
confusion matrix:
      0    1
0  8630  665
1   392  405
early stop counter: 2
val acc:0.9229152202606201, best validation acc: 0.9305652976036072, corresponding to test acc:                         0.8967499136924744 / 0.8967499136924744
after epoch: 9,now: 2024-08-07 14:13:24.097481,epoch time: 0:19:02.224621,used: 2:53:46.299085,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9579465, 'precision': 0.9591164, 'recall': 0.95795333, 'specificity': 0.95795333, 'f1': 0.9579201, 'auroc': 0.9900781, 'binary_precision': 0.98236036, 'binary_recall': 0.9326629, 'binary_specificity': 0.9832437, 'binary_f1_score': 0.95686674}
confusion matrix:
       0      1
0  25408    433
1   1741  24114
---- Validation: 
scalar performance:
{'acc': 0.9208129, 'precision': 0.579487, 'recall': 0.75415707, 'specificity': 0.75415707, 'f1': 0.610601, 'auroc': 0.83640295, 'binary_precision': 0.17018284, 'binary_recall': 0.57894737, 'binary_specificity': 0.9293667, 'binary_f1_score': 0.2630435}
confusion matrix:
       0     1
0  15526  1180
1    176   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8943718, 'precision': 0.6644151, 'recall': 0.7126597, 'specificity': 0.7126597, 'f1': 0.68404806, 'auroc': 0.85996974, 'binary_precision': 0.3732328, 'binary_recall': 0.49686325, 'binary_specificity': 0.9284562, 'binary_f1_score': 0.4262648}
confusion matrix:
      0    1
0  8630  665
1   401  396
early stop counter: 3
val acc:0.9208129048347473, best validation acc: 0.9305652976036072, corresponding to test acc:                         0.8967499136924744 / 0.8967499136924744
after epoch: 10,now: 2024-08-07 14:32:19.457979,epoch time: 0:18:55.360498,used: 3:12:41.659583,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95904905, 'precision': 0.96005917, 'recall': 0.9590527, 'specificity': 0.9590527, 'f1': 0.95902675, 'auroc': 0.9906702, 'binary_precision': 0.9816551, 'binary_recall': 0.9355949, 'binary_specificity': 0.98251045, 'binary_f1_score': 0.9580717}
confusion matrix:
       0      1
0  25392    452
1   1665  24187
---- Validation: 
scalar performance:
{'acc': 0.92116326, 'precision': 0.5803755, 'recall': 0.7566691, 'specificity': 0.7566691, 'f1': 0.61192614, 'auroc': 0.83996534, 'binary_precision': 0.17183098, 'binary_recall': 0.58373207, 'binary_specificity': 0.92960614, 'binary_f1_score': 0.265506}
confusion matrix:
       0     1
0  15530  1176
1    174   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89744353, 'precision': 0.6681276, 'recall': 0.70744455, 'specificity': 0.70744455, 'f1': 0.6848243, 'auroc': 0.8617594, 'binary_precision': 0.38170975, 'binary_recall': 0.48180678, 'binary_specificity': 0.9330823, 'binary_f1_score': 0.42595676}
confusion matrix:
      0    1
0  8673  622
1   413  384
new oracle model saved
early stop counter: 4
val acc:0.9211632609367371, best validation acc: 0.9305652976036072, corresponding to test acc:                         0.8967499136924744 / 0.8974435329437256
after epoch: 11,now: 2024-08-07 14:51:15.356295,epoch time: 0:18:55.898316,used: 3:31:37.557899,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.962028, 'precision': 0.96248746, 'recall': 0.96203107, 'specificity': 0.96203107, 'f1': 0.9620187, 'auroc': 0.9915942, 'binary_precision': 0.97711295, 'binary_recall': 0.94623446, 'binary_specificity': 0.97782767, 'binary_f1_score': 0.9614258}
confusion matrix:
       0      1
0  25270    573
1   1390  24463
---- Validation: 
scalar performance:
{'acc': 0.91246206, 'precision': 0.57415384, 'recall': 0.7615396, 'specificity': 0.7615396, 'f1': 0.6025674, 'auroc': 0.84211326, 'binary_precision': 0.15899053, 'binary_recall': 0.6028708, 'binary_specificity': 0.92020833, 'binary_f1_score': 0.25162256}
confusion matrix:
       0     1
0  15373  1333
1    166   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89556086, 'precision': 0.6714148, 'recall': 0.730512, 'specificity': 0.730512, 'f1': 0.6946722, 'auroc': 0.86380506, 'binary_precision': 0.38412985, 'binary_recall': 0.5345044, 'binary_specificity': 0.92651963, 'binary_f1_score': 0.44700944}
confusion matrix:
      0    1
0  8612  683
1   371  426
early stop counter: 5
val acc:0.912462055683136, best validation acc: 0.9305652976036072, corresponding to test acc:                         0.8967499136924744 / 0.8974435329437256
after epoch: 12,now: 2024-08-07 15:10:09.345769,epoch time: 0:18:53.989474,used: 3:50:31.547373,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96222144, 'precision': 0.96312654, 'recall': 0.96222574, 'specificity': 0.96222574, 'f1': 0.96220326, 'auroc': 0.9921762, 'binary_precision': 0.983649, 'binary_recall': 0.94008434, 'binary_specificity': 0.98436713, 'binary_f1_score': 0.9613734}
confusion matrix:
       0      1
0  25439    404
1   1549  24304
---- Validation: 
scalar performance:
{'acc': 0.923324, 'precision': 0.5826871, 'recall': 0.7577765, 'specificity': 0.7577765, 'f1': 0.61524725, 'auroc': 0.84459406, 'binary_precision': 0.17642805, 'binary_recall': 0.58373207, 'binary_specificity': 0.9318209, 'binary_f1_score': 0.27096057}
confusion matrix:
       0     1
0  15567  1139
1    174   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89873165, 'precision': 0.6738558, 'recall': 0.7196151, 'specificity': 0.7196151, 'f1': 0.69292367, 'auroc': 0.8635006, 'binary_precision': 0.3910939, 'binary_recall': 0.5069009, 'binary_specificity': 0.93232924, 'binary_f1_score': 0.44153005}
confusion matrix:
      0    1
0  8666  629
1   393  404
new oracle model saved
early stop counter: 6
val acc:0.9233239889144897, best validation acc: 0.9305652976036072, corresponding to test acc:                         0.8967499136924744 / 0.8987316489219666
after epoch: 13,now: 2024-08-07 15:29:16.109175,epoch time: 0:19:06.763406,used: 4:09:38.310779,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96336275, 'precision': 0.9645109, 'recall': 0.96336466, 'specificity': 0.96336466, 'f1': 0.96334016, 'auroc': 0.99290615, 'binary_precision': 0.98762417, 'binary_recall': 0.9384913, 'binary_specificity': 0.98823804, 'binary_f1_score': 0.962431}
confusion matrix:
       0      1
0  25542    304
1   1590  24260
---- Validation: 
scalar performance:
{'acc': 0.93605465, 'precision': 0.5955555, 'recall': 0.7491399, 'specificity': 0.7491399, 'f1': 0.6316145, 'auroc': 0.84528005, 'binary_precision': 0.20280948, 'binary_recall': 0.55263156, 'binary_specificity': 0.94564825, 'binary_f1_score': 0.29672447}
confusion matrix:
       0    1
0  15798  908
1    187  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90378517, 'precision': 0.6785271, 'recall': 0.7005632, 'specificity': 0.7005632, 'f1': 0.68864465, 'auroc': 0.86651266, 'binary_precision': 0.40397352, 'binary_recall': 0.45922208, 'binary_specificity': 0.94190425, 'binary_f1_score': 0.42982972}
confusion matrix:
      0    1
0  8755  540
1   431  366
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-07 15:48:24.002204,epoch time: 0:19:07.893029,used: 4:28:46.203808,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9633047, 'precision': 0.96421194, 'recall': 0.963309, 'specificity': 0.963309, 'f1': 0.96328706, 'auroc': 0.9926808, 'binary_precision': 0.9847823, 'binary_recall': 0.94116735, 'binary_specificity': 0.9854506, 'binary_f1_score': 0.962481}
confusion matrix:
       0      1
0  25467    376
1   1521  24332
---- Validation: 
scalar performance:
{'acc': 0.9295141, 'precision': 0.59113157, 'recall': 0.7656139, 'specificity': 0.7656139, 'f1': 0.6270818, 'auroc': 0.8493979, 'binary_precision': 0.19299611, 'binary_recall': 0.5933014, 'binary_specificity': 0.9379265, 'binary_f1_score': 0.29125074}
confusion matrix:
       0     1
0  15669  1037
1    170   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90140706, 'precision': 0.6782733, 'recall': 0.7176261, 'specificity': 0.7176261, 'f1': 0.69517386, 'auroc': 0.86826396, 'binary_precision': 0.40040243, 'binary_recall': 0.49937266, 'binary_specificity': 0.9358795, 'binary_f1_score': 0.44444445}
confusion matrix:
      0    1
0  8699  596
1   399  398
early stop counter: 1
val acc:0.9295141100883484, best validation acc: 0.9360546469688416, corresponding to test acc:                         0.9037851691246033 / 0.9037851691246033
after epoch: 15,now: 2024-08-07 16:08:03.180530,epoch time: 0:19:39.178326,used: 4:48:25.382134,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96580005, 'precision': 0.96666133, 'recall': 0.9657992, 'specificity': 0.9657992, 'f1': 0.96578425, 'auroc': 0.9932912, 'binary_precision': 0.98670006, 'binary_recall': 0.9443262, 'binary_specificity': 0.98727226, 'binary_f1_score': 0.96504825}
confusion matrix:
       0      1
0  25520    329
1   1439  24408
---- Validation: 
scalar performance:
{'acc': 0.93114924, 'precision': 0.59329057, 'recall': 0.76645195, 'specificity': 0.76645195, 'f1': 0.6299619, 'auroc': 0.8495903, 'binary_precision': 0.19729514, 'binary_recall': 0.5933014, 'binary_specificity': 0.93960255, 'binary_f1_score': 0.29611942}
confusion matrix:
       0     1
0  15697  1009
1    170   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90289336, 'precision': 0.68267196, 'recall': 0.723595, 'specificity': 0.723595, 'f1': 0.7002224, 'auroc': 0.87118495, 'binary_precision': 0.40822467, 'binary_recall': 0.510665, 'binary_specificity': 0.936525, 'binary_f1_score': 0.4537347}
confusion matrix:
      0    1
0  8705  590
1   390  407
early stop counter: 2
val acc:0.9311492443084717, best validation acc: 0.9360546469688416, corresponding to test acc:                         0.9037851691246033 / 0.9037851691246033
after epoch: 16,now: 2024-08-07 16:28:42.627100,epoch time: 0:20:39.446570,used: 5:09:04.828704,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.966245, 'precision': 0.9669751, 'recall': 0.9662465, 'specificity': 0.9662465, 'f1': 0.9662318, 'auroc': 0.99339783, 'binary_precision': 0.9854594, 'binary_recall': 0.94646037, 'binary_specificity': 0.98603266, 'binary_f1_score': 0.9655662}
confusion matrix:
       0      1
0  25485    361
1   1384  24466
---- Validation: 
scalar performance:
{'acc': 0.93377715, 'precision': 0.5950274, 'recall': 0.7596351, 'specificity': 0.7596351, 'f1': 0.6317581, 'auroc': 0.8534628, 'binary_precision': 0.20116861, 'binary_recall': 0.576555, 'binary_specificity': 0.94271517, 'binary_f1_score': 0.29826733}
confusion matrix:
       0    1
0  15749  957
1    177  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9043797, 'precision': 0.68372697, 'recall': 0.7157985, 'specificity': 0.7157985, 'f1': 0.697955, 'auroc': 0.8734801, 'binary_precision': 0.4117647, 'binary_recall': 0.49184442, 'binary_specificity': 0.9397526, 'binary_f1_score': 0.44825613}
confusion matrix:
      0    1
0  8735  560
1   405  392
new oracle model saved
early stop counter: 3
val acc:0.9337771534919739, best validation acc: 0.9360546469688416, corresponding to test acc:                         0.9037851691246033 / 0.9043797254562378
after epoch: 17,now: 2024-08-07 16:48:37.744147,epoch time: 0:19:55.117047,used: 5:28:59.945751,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96790856, 'precision': 0.9683552, 'recall': 0.96791214, 'specificity': 0.96791214, 'f1': 0.96790105, 'auroc': 0.99391174, 'binary_precision': 0.9828763, 'binary_recall': 0.9524252, 'binary_specificity': 0.9833991, 'binary_f1_score': 0.96741116}
confusion matrix:
       0      1
0  25413    429
1   1230  24624
---- Validation: 
scalar performance:
{'acc': 0.9235576, 'precision': 0.58582294, 'recall': 0.7707249, 'specificity': 0.7707249, 'f1': 0.62000436, 'auroc': 0.8574851, 'binary_precision': 0.18201284, 'binary_recall': 0.6100478, 'binary_specificity': 0.9314019, 'binary_f1_score': 0.2803738}
confusion matrix:
       0     1
0  15560  1146
1    163   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9012089, 'precision': 0.6808121, 'recall': 0.7289897, 'specificity': 0.7289897, 'f1': 0.7008767, 'auroc': 0.87320375, 'binary_precision': 0.4034749, 'binary_recall': 0.52446675, 'binary_specificity': 0.9335126, 'binary_f1_score': 0.4560829}
confusion matrix:
      0    1
0  8677  618
1   379  418
early stop counter: 4
val acc:0.9235575795173645, best validation acc: 0.9360546469688416, corresponding to test acc:                         0.9037851691246033 / 0.9043797254562378
after epoch: 18,now: 2024-08-07 17:07:38.615372,epoch time: 0:19:00.871225,used: 5:48:00.816976,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96659315, 'precision': 0.9674353, 'recall': 0.9665965, 'specificity': 0.9665965, 'f1': 0.96657825, 'auroc': 0.9935498, 'binary_precision': 0.98731464, 'binary_recall': 0.9453427, 'binary_specificity': 0.9878502, 'binary_f1_score': 0.9658729}
confusion matrix:
       0      1
0  25530    314
1   1413  24439
---- Validation: 
scalar performance:
{'acc': 0.91246206, 'precision': 0.5775553, 'recall': 0.77786696, 'specificity': 0.77786696, 'f1': 0.60770583, 'auroc': 0.8584738, 'binary_precision': 0.16491011, 'binary_recall': 0.6363636, 'binary_specificity': 0.9193703, 'binary_f1_score': 0.26193994}
confusion matrix:
       0     1
0  15359  1347
1    152   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9025961, 'precision': 0.68498755, 'recall': 0.7354784, 'specificity': 0.7354784, 'f1': 0.7059431, 'auroc': 0.8737465, 'binary_precision': 0.41074857, 'binary_recall': 0.5370138, 'binary_specificity': 0.933943, 'binary_f1_score': 0.46547037}
confusion matrix:
      0    1
0  8681  614
1   369  428
early stop counter: 5
val acc:0.912462055683136, best validation acc: 0.9360546469688416, corresponding to test acc:                         0.9037851691246033 / 0.9043797254562378
after epoch: 19,now: 2024-08-07 17:26:35.455965,epoch time: 0:18:56.840593,used: 6:06:57.657569,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97034585, 'precision': 0.97081745, 'recall': 0.97034705, 'specificity': 0.97034705, 'f1': 0.97033846, 'auroc': 0.9946861, 'binary_precision': 0.9857377, 'binary_recall': 0.95450675, 'binary_specificity': 0.9861874, 'binary_f1_score': 0.96987087}
confusion matrix:
       0      1
0  25489    357
1   1176  24674
---- Validation: 
scalar performance:
{'acc': 0.8947676, 'precision': 0.5659538, 'recall': 0.77696204, 'specificity': 0.77696204, 'f1': 0.5880246, 'auroc': 0.8562896, 'binary_precision': 0.14145078, 'binary_recall': 0.65311, 'binary_specificity': 0.90081406, 'binary_f1_score': 0.23253834}
confusion matrix:
       0     1
0  15049  1657
1    145   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8999207, 'precision': 0.68102306, 'recall': 0.7391881, 'specificity': 0.7391881, 'f1': 0.7043576, 'auroc': 0.87361413, 'binary_precision': 0.4020239, 'binary_recall': 0.54830617, 'binary_specificity': 0.9300699, 'binary_f1_score': 0.4639066}
confusion matrix:
      0    1
0  8645  650
1   360  437
early stop counter: 6
val acc:0.8947675824165344, best validation acc: 0.9360546469688416, corresponding to test acc:                         0.9037851691246033 / 0.9043797254562378
after epoch: 20,now: 2024-08-07 17:45:28.417482,epoch time: 0:18:52.961517,used: 6:25:50.619086,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_19_37_seed_2_24076681
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:25:50.619086 at 2024-08-07 17:45:28.417482
persisted model performance metric: 

scalar performance:
{'acc': 0.90378517, 'precision': 0.6785271, 'recall': 0.7005632, 'specificity': 0.7005632, 'f1': 0.68864465, 'auroc': 0.86651266, 'binary_precision': 0.40397352, 'binary_recall': 0.45922208, 'binary_specificity': 0.94190425, 'binary_f1_score': 0.42982972}
confusion matrix:
      0    1
0  8755  540
1   431  366
oracle model performance metric: 

scalar performance:
{'acc': 0.9043797, 'precision': 0.68372697, 'recall': 0.7157985, 'specificity': 0.7157985, 'f1': 0.697955, 'auroc': 0.8734801, 'binary_precision': 0.4117647, 'binary_recall': 0.49184442, 'binary_specificity': 0.9397526, 'binary_f1_score': 0.44825613}
confusion matrix:
      0    1
0  8735  560
1   405  392
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  16662 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8530 MiB |  25072 MiB |  16558 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     40 MiB |     44 MiB |     70 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40149 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |   8416 KiB |  24597 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6957    |  280988 K  |  280983 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141131 K  |  141127 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6957    |  280988 K  |  280983 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141131 K  |  141127 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     371    |    1061    |     692    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      20    |      22    |      35    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3255    |  154298 K  |  154298 K  |
|       from large pool |      11    |     352    |   94473 K  |   94473 K  |
|       from small pool |      24    |    3245    |   59825 K  |   59825 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25072 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  26624 KiB |     44 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |  24597 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  280988 K  |  280988 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141131 K  |  141131 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  280988 K  |  280988 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141131 K  |  141131 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1061    |    1038    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      13    |      22    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3255    |  154300 K  |  154300 K  |
|       from large pool |       3    |     352    |   94473 K  |   94473 K  |
|       from small pool |       0    |    3245    |   59827 K  |   59827 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 18:03:22 2024]
Finished job 0.
1 of 1 steps (100%) done
