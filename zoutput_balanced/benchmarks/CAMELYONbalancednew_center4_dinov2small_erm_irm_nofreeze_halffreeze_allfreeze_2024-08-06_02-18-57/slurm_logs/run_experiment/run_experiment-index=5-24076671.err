Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:57 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671

 Experiment start at: 2024-08-06 02:34:45.526717
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98847127, 'precision': 0.988481, 'recall': 0.98847, 'specificity': 0.98847, 'f1': 0.98847115, 'auroc': 0.9990909, 'binary_precision': 0.98644346, 'binary_recall': 0.9905694, 'binary_specificity': 0.9863706, 'binary_f1_score': 0.98850214}
confusion matrix:
       0      1
0  24968    345
1    239  25104
---- Validation: 
scalar performance:
{'acc': 0.9553248, 'precision': 0.6650553, 'recall': 0.9042624, 'specificity': 0.9042624, 'f1': 0.72814, 'auroc': 0.9488832, 'binary_precision': 0.33396405, 'binary_recall': 0.8506024, 'binary_specificity': 0.9579224, 'binary_f1_score': 0.47961953}
confusion matrix:
       0    1
0  16027  704
1     62  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.839826, 'precision': 0.6511173, 'recall': 0.87051624, 'specificity': 0.87051624, 'f1': 0.684717, 'auroc': 0.9254421, 'binary_precision': 0.3113879, 'binary_recall': 0.9067358, 'binary_specificity': 0.8342967, 'binary_f1_score': 0.46357617}
confusion matrix:
      0     1
0  7794  1548
1    72   700
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 02:56:07.440331,epoch time: 0:21:21.913614,used: 0:21:21.913614,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98920166, 'precision': 0.9892122, 'recall': 0.9892005, 'specificity': 0.9892005, 'f1': 0.98920155, 'auroc': 0.999352, 'binary_precision': 0.9870742, 'binary_recall': 0.9913977, 'binary_specificity': 0.98700327, 'binary_f1_score': 0.98923117}
confusion matrix:
       0      1
0  24985    329
1    218  25124
---- Validation: 
scalar performance:
{'acc': 0.94132745, 'precision': 0.6367736, 'recall': 0.91236424, 'specificity': 0.91236424, 'f1': 0.69513565, 'auroc': 0.95407, 'binary_precision': 0.276644, 'binary_recall': 0.8819277, 'binary_specificity': 0.94280076, 'binary_f1_score': 0.42117375}
confusion matrix:
       0    1
0  15774  957
1     49  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82835674, 'precision': 0.6437079, 'recall': 0.86549604, 'specificity': 0.86549604, 'f1': 0.67277104, 'auroc': 0.92840767, 'binary_precision': 0.2964527, 'binary_recall': 0.90932643, 'binary_specificity': 0.8216656, 'binary_f1_score': 0.4471338}
confusion matrix:
      0     1
0  7676  1666
1    70   702
early stop counter: 1
val acc:0.9413274526596069, best validation acc: 0.9553248286247253, corresponding to test acc:                         0.8398259878158569 / 0.8398259878158569
after epoch: 2,now: 2024-08-06 03:14:58.528307,epoch time: 0:18:51.087976,used: 0:40:13.001590,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9888858, 'precision': 0.98903596, 'recall': 0.98888105, 'specificity': 0.98888105, 'f1': 0.9888848, 'auroc': 0.99972963, 'binary_precision': 0.98060435, 'binary_recall': 0.997514, 'binary_specificity': 0.9802481, 'binary_f1_score': 0.98898685}
confusion matrix:
       0      1
0  24814    500
1     63  25279
---- Validation: 
scalar performance:
{'acc': 0.4322291, 'precision': 0.519161, 'recall': 0.6961487, 'specificity': 0.6961487, 'f1': 0.33336326, 'auroc': 0.94166744, 'binary_precision': 0.039889414, 'binary_recall': 0.973494, 'binary_specificity': 0.41880342, 'binary_f1_score': 0.07663853}
confusion matrix:
      0     1
0  7007  9724
1    11   404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49021158, 'precision': 0.56203395, 'recall': 0.71394145, 'specificity': 0.71394145, 'f1': 0.4231714, 'auroc': 0.928004, 'binary_precision': 0.12809637, 'binary_recall': 0.9779793, 'binary_specificity': 0.44990367, 'binary_f1_score': 0.22652265}
confusion matrix:
      0     1
0  4203  5139
1    17   755
early stop counter: 2
val acc:0.43222910165786743, best validation acc: 0.9553248286247253, corresponding to test acc:                         0.8398259878158569 / 0.8398259878158569
after epoch: 3,now: 2024-08-06 03:32:53.537918,epoch time: 0:17:55.009611,used: 0:58:08.011201,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98780006, 'precision': 0.98807454, 'recall': 0.98780715, 'specificity': 0.98780715, 'f1': 0.98779845, 'auroc': 0.9996516, 'binary_precision': 0.9997979, 'binary_recall': 0.97581184, 'binary_specificity': 0.9998025, 'binary_f1_score': 0.9876592}
confusion matrix:
       0      1
0  25308      5
1    613  24730
---- Validation: 
scalar performance:
{'acc': 0.9786539, 'precision': 0.77278674, 'recall': 0.7881484, 'specificity': 0.7881484, 'f1': 0.78024143, 'auroc': 0.94756895, 'binary_precision': 0.55580866, 'binary_recall': 0.5879518, 'binary_specificity': 0.98834497, 'binary_f1_score': 0.57142854}
confusion matrix:
       0    1
0  16536  195
1    171  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9219893, 'precision': 0.7319478, 'recall': 0.80685806, 'specificity': 0.80685806, 'f1': 0.76239884, 'auroc': 0.924681, 'binary_precision': 0.49192783, 'binary_recall': 0.67098445, 'binary_specificity': 0.94273174, 'binary_f1_score': 0.56767124}
confusion matrix:
      0    1
0  8807  535
1   254  518
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 03:50:47.819138,epoch time: 0:17:54.281220,used: 1:16:02.292421,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99358416, 'precision': 0.9935914, 'recall': 0.99358296, 'specificity': 0.99358296, 'f1': 0.99358416, 'auroc': 0.99969995, 'binary_precision': 0.9918616, 'binary_recall': 0.99534446, 'binary_specificity': 0.9918214, 'binary_f1_score': 0.9936}
confusion matrix:
       0      1
0  25103    207
1    118  25228
---- Validation: 
scalar performance:
{'acc': 0.9543917, 'precision': 0.6640669, 'recall': 0.91318375, 'specificity': 0.91318375, 'f1': 0.7281015, 'auroc': 0.9575733, 'binary_precision': 0.33149678, 'binary_recall': 0.86987954, 'binary_specificity': 0.95648795, 'binary_f1_score': 0.4800532}
confusion matrix:
       0    1
0  16003  728
1     54  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7894008, 'precision': 0.62402856, 'recall': 0.85094404, 'specificity': 0.85094404, 'f1': 0.6366266, 'auroc': 0.92533165, 'binary_precision': 0.25610632, 'binary_recall': 0.9235751, 'binary_specificity': 0.778313, 'binary_f1_score': 0.40101236}
confusion matrix:
      0     1
0  7271  2071
1    59   713
early stop counter: 1
val acc:0.9543917179107666, best validation acc: 0.9786539077758789, corresponding to test acc:                         0.9219893217086792 / 0.9219893217086792
after epoch: 5,now: 2024-08-06 04:08:40.390449,epoch time: 0:17:52.571311,used: 1:33:54.863732,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9927353, 'precision': 0.9927397, 'recall': 0.99273455, 'specificity': 0.99273455, 'f1': 0.99273527, 'auroc': 0.9997238, 'binary_precision': 0.99142104, 'binary_recall': 0.9940812, 'binary_specificity': 0.99138784, 'binary_f1_score': 0.99274933}
confusion matrix:
       0      1
0  25095    218
1    150  25193
---- Validation: 
scalar performance:
{'acc': 0.95445, 'precision': 0.66550446, 'recall': 0.92143816, 'specificity': 0.92143816, 'f1': 0.7306695, 'auroc': 0.9637866, 'binary_precision': 0.3339383, 'binary_recall': 0.886747, 'binary_specificity': 0.9561293, 'binary_f1_score': 0.48516813}
confusion matrix:
       0    1
0  15997  734
1     47  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8074946, 'precision': 0.63130075, 'recall': 0.8536088, 'specificity': 0.8536088, 'f1': 0.651641, 'auroc': 0.92331517, 'binary_precision': 0.27202174, 'binary_recall': 0.9080311, 'binary_specificity': 0.79918647, 'binary_f1_score': 0.41863242}
confusion matrix:
      0     1
0  7466  1876
1    71   701
early stop counter: 2
val acc:0.9544500112533569, best validation acc: 0.9786539077758789, corresponding to test acc:                         0.9219893217086792 / 0.9219893217086792
after epoch: 6,now: 2024-08-06 04:26:28.927569,epoch time: 0:17:48.537120,used: 1:51:43.400852,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98797774, 'precision': 0.9880173, 'recall': 0.9879751, 'specificity': 0.9879751, 'f1': 0.9879775, 'auroc': 0.99926424, 'binary_precision': 0.98376626, 'binary_recall': 0.99234504, 'binary_specificity': 0.98360527, 'binary_f1_score': 0.98803705}
confusion matrix:
       0      1
0  24898    415
1    194  25149
---- Validation: 
scalar performance:
{'acc': 0.9646565, 'precision': 0.69349456, 'recall': 0.89846957, 'specificity': 0.89846957, 'f1': 0.75666, 'auroc': 0.9559604, 'binary_precision': 0.39135382, 'binary_recall': 0.82891566, 'binary_specificity': 0.9680234, 'binary_f1_score': 0.5316847}
confusion matrix:
       0    1
0  16196  535
1     71  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8970734, 'precision': 0.70011103, 'recall': 0.8723921, 'specificity': 0.8723921, 'f1': 0.74874634, 'auroc': 0.92330366, 'binary_precision': 0.41438574, 'binary_recall': 0.8432642, 'binary_specificity': 0.90152, 'binary_f1_score': 0.55569786}
confusion matrix:
      0    1
0  8422  920
1   121  651
early stop counter: 3
val acc:0.9646564722061157, best validation acc: 0.9786539077758789, corresponding to test acc:                         0.9219893217086792 / 0.9219893217086792
after epoch: 7,now: 2024-08-06 04:44:20.190479,epoch time: 0:17:51.262910,used: 2:09:34.663762,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9931104, 'precision': 0.99319065, 'recall': 0.99311346, 'specificity': 0.99311346, 'f1': 0.9931102, 'auroc': 0.999823, 'binary_precision': 0.9996002, 'binary_recall': 0.9866219, 'binary_specificity': 0.999605, 'binary_f1_score': 0.9930687}
confusion matrix:
       0      1
0  25306     10
1    339  25001
---- Validation: 
scalar performance:
{'acc': 0.97853726, 'precision': 0.7761128, 'recall': 0.7422662, 'specificity': 0.7422662, 'f1': 0.7580059, 'auroc': 0.9626937, 'binary_precision': 0.5647383, 'binary_recall': 0.4939759, 'binary_specificity': 0.9905565, 'binary_f1_score': 0.5269923}
confusion matrix:
       0    1
0  16573  158
1    210  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88570297, 'precision': 0.68663067, 'recall': 0.869802, 'specificity': 0.869802, 'f1': 0.7334432, 'auroc': 0.92698205, 'binary_precision': 0.3869258, 'binary_recall': 0.85103625, 'binary_specificity': 0.88856775, 'binary_f1_score': 0.5319838}
confusion matrix:
      0     1
0  8301  1041
1   115   657
early stop counter: 4
val acc:0.9785372614860535, best validation acc: 0.9786539077758789, corresponding to test acc:                         0.9219893217086792 / 0.9219893217086792
after epoch: 8,now: 2024-08-06 05:02:23.584042,epoch time: 0:18:03.393563,used: 2:27:38.057325,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9930709, 'precision': 0.99310195, 'recall': 0.9930735, 'specificity': 0.9930735, 'f1': 0.99307084, 'auroc': 0.99948657, 'binary_precision': 0.9971753, 'binary_recall': 0.98895204, 'binary_specificity': 0.997195, 'binary_f1_score': 0.99304664}
confusion matrix:
       0      1
0  25241     71
1    280  25064
---- Validation: 
scalar performance:
{'acc': 0.98011196, 'precision': 0.784142, 'recall': 0.8300182, 'specificity': 0.8300182, 'f1': 0.80523896, 'auroc': 0.95927596, 'binary_precision': 0.5764463, 'binary_recall': 0.67228913, 'binary_specificity': 0.9877473, 'binary_f1_score': 0.62068963}
confusion matrix:
       0    1
0  16526  205
1    136  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63674116, 'precision': 0.5767857, 'recall': 0.7665241, 'specificity': 0.7665241, 'f1': 0.5179973, 'auroc': 0.90239143, 'binary_precision': 0.1642758, 'binary_recall': 0.9196891, 'binary_specificity': 0.61335903, 'binary_f1_score': 0.27875933}
confusion matrix:
      0     1
0  5730  3612
1    62   710
better model found
persisted
after epoch: 9,now: 2024-08-06 05:20:25.118980,epoch time: 0:18:01.534938,used: 2:45:39.592263,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99482787, 'precision': 0.99484694, 'recall': 0.9948301, 'specificity': 0.9948301, 'f1': 0.9948278, 'auroc': 0.99975955, 'binary_precision': 0.99809366, 'binary_recall': 0.9915565, 'binary_specificity': 0.9981036, 'binary_f1_score': 0.99481434}
confusion matrix:
       0      1
0  25263     48
1    214  25131
---- Validation: 
scalar performance:
{'acc': 0.9650064, 'precision': 0.6942285, 'recall': 0.89394915, 'specificity': 0.89394915, 'f1': 0.7565373, 'auroc': 0.96173656, 'binary_precision': 0.39306358, 'binary_recall': 0.8192771, 'binary_specificity': 0.96862113, 'binary_f1_score': 0.53124994}
confusion matrix:
       0    1
0  16206  525
1     75  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8635555, 'precision': 0.6676702, 'recall': 0.8738551, 'specificity': 0.8738551, 'f1': 0.7094346, 'auroc': 0.9261588, 'binary_precision': 0.34615386, 'binary_recall': 0.88601035, 'binary_specificity': 0.8616999, 'binary_f1_score': 0.49781665}
confusion matrix:
      0     1
0  8050  1292
1    88   684
early stop counter: 1
val acc:0.965006411075592, best validation acc: 0.9801119565963745, corresponding to test acc:                         0.6367411613464355 / 0.9219893217086792
after epoch: 10,now: 2024-08-06 05:38:23.668942,epoch time: 0:17:58.549962,used: 3:03:38.142225,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9971178, 'precision': 0.99711955, 'recall': 0.9971186, 'specificity': 0.9971186, 'f1': 0.9971179, 'auroc': 0.9999145, 'binary_precision': 0.99822056, 'binary_recall': 0.996015, 'binary_specificity': 0.9982221, 'binary_f1_score': 0.9971166}
confusion matrix:
       0      1
0  25266     45
1    101  25244
---- Validation: 
scalar performance:
{'acc': 0.97107196, 'precision': 0.7127332, 'recall': 0.81246185, 'specificity': 0.81246185, 'f1': 0.7522335, 'auroc': 0.95187706, 'binary_precision': 0.43435982, 'binary_recall': 0.6457831, 'binary_specificity': 0.9791405, 'binary_f1_score': 0.5193798}
confusion matrix:
       0    1
0  16382  349
1    147  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8684991, 'precision': 0.6728696, 'recall': 0.87950194, 'specificity': 0.87950194, 'f1': 0.7164748, 'auroc': 0.92725945, 'binary_precision': 0.35588843, 'binary_recall': 0.89248705, 'binary_specificity': 0.8665168, 'binary_f1_score': 0.5088627}
confusion matrix:
      0     1
0  8095  1247
1    83   689
early stop counter: 2
val acc:0.9710719585418701, best validation acc: 0.9801119565963745, corresponding to test acc:                         0.6367411613464355 / 0.9219893217086792
after epoch: 11,now: 2024-08-06 05:56:23.737149,epoch time: 0:18:00.068207,used: 3:21:38.210432,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99496603, 'precision': 0.9949744, 'recall': 0.9949672, 'specificity': 0.9949672, 'f1': 0.99496603, 'auroc': 0.9997766, 'binary_precision': 0.99714637, 'binary_recall': 0.9927788, 'binary_specificity': 0.9971557, 'binary_f1_score': 0.9949578}
confusion matrix:
       0      1
0  25242     72
1    183  25159
---- Validation: 
scalar performance:
{'acc': 0.96798086, 'precision': 0.68930835, 'recall': 0.77328, 'specificity': 0.77328, 'f1': 0.7228955, 'auroc': 0.94054615, 'binary_precision': 0.38943896, 'binary_recall': 0.5686747, 'binary_specificity': 0.97788537, 'binary_f1_score': 0.46229187}
confusion matrix:
       0    1
0  16361  370
1    179  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6699624, 'precision': 0.58335996, 'recall': 0.7821308, 'specificity': 0.7821308, 'f1': 0.5408011, 'auroc': 0.90066886, 'binary_precision': 0.17747612, 'binary_recall': 0.91450775, 'binary_specificity': 0.6497538, 'binary_f1_score': 0.29726315}
confusion matrix:
      0     1
0  6070  3272
1    66   706
early stop counter: 3
val acc:0.9679808616638184, best validation acc: 0.9801119565963745, corresponding to test acc:                         0.6367411613464355 / 0.9219893217086792
after epoch: 12,now: 2024-08-06 06:14:33.646228,epoch time: 0:18:09.909079,used: 3:39:48.119511,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9963282, 'precision': 0.99632907, 'recall': 0.9963286, 'specificity': 0.9963286, 'f1': 0.9963282, 'auroc': 0.99988997, 'binary_precision': 0.9971542, 'binary_recall': 0.9955015, 'binary_specificity': 0.9971557, 'binary_f1_score': 0.99632716}
confusion matrix:
       0      1
0  25242     72
1    114  25228
---- Validation: 
scalar performance:
{'acc': 0.970722, 'precision': 0.7177461, 'recall': 0.8792538, 'specificity': 0.8792538, 'f1': 0.7745441, 'auroc': 0.96284974, 'binary_precision': 0.44097695, 'binary_recall': 0.78313255, 'binary_specificity': 0.97537506, 'binary_f1_score': 0.5642361}
confusion matrix:
       0    1
0  16319  412
1     90  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64910024, 'precision': 0.58515, 'recall': 0.7946036, 'specificity': 0.7946036, 'f1': 0.5311432, 'auroc': 0.930127, 'binary_precision': 0.17474818, 'binary_recall': 0.96632123, 'binary_specificity': 0.6228859, 'binary_f1_score': 0.29597303}
confusion matrix:
      0     1
0  5819  3523
1    26   746
early stop counter: 4
val acc:0.9707220196723938, best validation acc: 0.9801119565963745, corresponding to test acc:                         0.6367411613464355 / 0.9219893217086792
after epoch: 13,now: 2024-08-06 06:32:52.830004,epoch time: 0:18:19.183776,used: 3:58:07.303287,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9960715, 'precision': 0.9960753, 'recall': 0.9960724, 'specificity': 0.9960724, 'f1': 0.9960716, 'auroc': 0.9998914, 'binary_precision': 0.9975856, 'binary_recall': 0.9945545, 'binary_specificity': 0.99759024, 'binary_f1_score': 0.9960678}
confusion matrix:
       0      1
0  25253     61
1    138  25204
---- Validation: 
scalar performance:
{'acc': 0.9751546, 'precision': 0.74361616, 'recall': 0.8956243, 'specificity': 0.8956243, 'f1': 0.7999464, 'auroc': 0.9653015, 'binary_precision': 0.4919708, 'binary_recall': 0.8120482, 'binary_specificity': 0.9792003, 'binary_f1_score': 0.6127273}
confusion matrix:
       0    1
0  16383  348
1     78  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8897568, 'precision': 0.69476366, 'recall': 0.88863254, 'specificity': 0.88863254, 'f1': 0.74423313, 'auroc': 0.9302526, 'binary_precision': 0.39988324, 'binary_recall': 0.8873057, 'binary_specificity': 0.88995934, 'binary_f1_score': 0.55130786}
confusion matrix:
      0     1
0  8314  1028
1    87   685
early stop counter: 5
val acc:0.9751545786857605, best validation acc: 0.9801119565963745, corresponding to test acc:                         0.6367411613464355 / 0.9219893217086792
after epoch: 14,now: 2024-08-06 06:51:10.046257,epoch time: 0:18:17.216253,used: 4:16:24.519540,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9953806, 'precision': 0.99538213, 'recall': 0.99538004, 'specificity': 0.99538004, 'f1': 0.99538064, 'auroc': 0.9998032, 'binary_precision': 0.9946815, 'binary_recall': 0.9960942, 'binary_specificity': 0.9946659, 'binary_f1_score': 0.9953874}
confusion matrix:
       0      1
0  25174    135
1     99  25248
---- Validation: 
scalar performance:
{'acc': 0.9703721, 'precision': 0.71816754, 'recall': 0.90257317, 'specificity': 0.90257317, 'f1': 0.78030485, 'auroc': 0.9634149, 'binary_precision': 0.44061303, 'binary_recall': 0.8313253, 'binary_specificity': 0.97382104, 'binary_f1_score': 0.5759599}
confusion matrix:
       0    1
0  16293  438
1     70  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8448685, 'precision': 0.65447164, 'recall': 0.87205756, 'specificity': 0.87205756, 'f1': 0.6899692, 'auroc': 0.9249722, 'binary_precision': 0.31828547, 'binary_recall': 0.90414506, 'binary_specificity': 0.83997005, 'binary_f1_score': 0.47082633}
confusion matrix:
      0     1
0  7847  1495
1    74   698
early stop counter: 6
val acc:0.9703720808029175, best validation acc: 0.9801119565963745, corresponding to test acc:                         0.6367411613464355 / 0.9219893217086792
after epoch: 15,now: 2024-08-06 07:09:25.377087,epoch time: 0:18:15.330830,used: 4:34:39.850370,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99376184, 'precision': 0.9937679, 'recall': 0.9937612, 'specificity': 0.9937612, 'f1': 0.9937618, 'auroc': 0.99973536, 'binary_precision': 0.9921328, 'binary_recall': 0.9954219, 'binary_specificity': 0.9921005, 'binary_f1_score': 0.9937746}
confusion matrix:
       0      1
0  25118    200
1    116  25222
---- Validation: 
scalar performance:
{'acc': 0.9734049, 'precision': 0.7341186, 'recall': 0.90882695, 'specificity': 0.90882695, 'f1': 0.79554605, 'auroc': 0.9614237, 'binary_precision': 0.47225982, 'binary_recall': 0.84096384, 'binary_specificity': 0.97669, 'binary_f1_score': 0.60485274}
confusion matrix:
       0    1
0  16341  390
1     66  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86533517, 'precision': 0.6706362, 'recall': 0.88075995, 'specificity': 0.88075995, 'f1': 0.71340036, 'auroc': 0.92142695, 'binary_precision': 0.35085946, 'binary_recall': 0.89896375, 'binary_specificity': 0.8625562, 'binary_f1_score': 0.50472724}
confusion matrix:
      0     1
0  8058  1284
1    78   694
early stop counter: 7
val acc:0.9734048843383789, best validation acc: 0.9801119565963745, corresponding to test acc:                         0.6367411613464355 / 0.9219893217086792
after epoch: 16,now: 2024-08-06 07:27:45.740049,epoch time: 0:18:20.362962,used: 4:53:00.213332,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99601233, 'precision': 0.9960337, 'recall': 0.99601436, 'specificity': 0.99601436, 'f1': 0.9960122, 'auroc': 0.9998207, 'binary_precision': 0.99944377, 'binary_recall': 0.9925818, 'binary_specificity': 0.9994469, 'binary_f1_score': 0.9960009}
confusion matrix:
       0      1
0  25299     14
1    188  25155
---- Validation: 
scalar performance:
{'acc': 0.981745, 'precision': 0.8320166, 'recall': 0.73216045, 'specificity': 0.73216045, 'f1': 0.7727233, 'auroc': 0.95984584, 'binary_precision': 0.6770833, 'binary_recall': 0.4698795, 'binary_specificity': 0.99444145, 'binary_f1_score': 0.5547652}
confusion matrix:
       0    1
0  16638   93
1    220  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86147916, 'precision': 0.66174555, 'recall': 0.85550094, 'specificity': 0.85550094, 'f1': 0.70161855, 'auroc': 0.9107965, 'binary_precision': 0.33780298, 'binary_recall': 0.8484456, 'binary_specificity': 0.8625562, 'binary_f1_score': 0.48321652}
confusion matrix:
      0     1
0  8058  1284
1   117   655
better model found
persisted
after epoch: 17,now: 2024-08-06 07:46:03.587653,epoch time: 0:18:17.847604,used: 5:11:18.060936,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9871881, 'precision': 0.98743474, 'recall': 0.98718196, 'specificity': 0.98718196, 'f1': 0.98718643, 'auroc': 0.9998065, 'binary_precision': 0.97660685, 'binary_recall': 0.99830323, 'binary_specificity': 0.9760607, 'binary_f1_score': 0.9873359}
confusion matrix:
       0      1
0  24708    606
1     43  25299
---- Validation: 
scalar performance:
{'acc': 0.84631985, 'precision': 0.56459135, 'recall': 0.8954054, 'specificity': 0.8954054, 'f1': 0.5722011, 'auroc': 0.964247, 'binary_precision': 0.13073853, 'binary_recall': 0.9469879, 'binary_specificity': 0.84382284, 'binary_f1_score': 0.22975737}
confusion matrix:
       0     1
0  14118  2613
1     22   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.15532924, 'precision': 0.53944075, 'recall': 0.5409814, 'specificity': 0.5409814, 'f1': 0.15532026, 'auroc': 0.910426, 'binary_precision': 0.08260823, 'binary_recall': 0.996114, 'binary_specificity': 0.08584885, 'binary_f1_score': 0.15256423}
confusion matrix:
     0     1
0  802  8540
1    3   769
early stop counter: 1
val acc:0.846319854259491, best validation acc: 0.9817450046539307, corresponding to test acc:                         0.8614791631698608 / 0.9219893217086792
after epoch: 18,now: 2024-08-06 08:04:21.559595,epoch time: 0:18:17.971942,used: 5:29:36.032878,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99656504, 'precision': 0.99658453, 'recall': 0.996567, 'specificity': 0.996567, 'f1': 0.9965651, 'auroc': 0.9999378, 'binary_precision': 0.99984115, 'binary_recall': 0.99329203, 'binary_specificity': 0.999842, 'binary_f1_score': 0.99655586}
confusion matrix:
       0      1
0  25309      4
1    170  25173
---- Validation: 
scalar performance:
{'acc': 0.97742915, 'precision': 0.7848265, 'recall': 0.6101057, 'specificity': 0.6101057, 'f1': 0.656565, 'auroc': 0.9601968, 'binary_precision': 0.5886076, 'binary_recall': 0.22409639, 'binary_specificity': 0.99611497, 'binary_f1_score': 0.32460734}
confusion matrix:
       0   1
0  16666  65
1    322  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8634566, 'precision': 0.6642313, 'recall': 0.8595421, 'specificity': 0.8595421, 'f1': 0.7049576, 'auroc': 0.92388266, 'binary_precision': 0.3421462, 'binary_recall': 0.8549223, 'binary_specificity': 0.86416185, 'binary_f1_score': 0.48870787}
confusion matrix:
      0     1
0  8073  1269
1   112   660
early stop counter: 2
val acc:0.9774291515350342, best validation acc: 0.9817450046539307, corresponding to test acc:                         0.8614791631698608 / 0.9219893217086792
after epoch: 19,now: 2024-08-06 08:22:37.199130,epoch time: 0:18:15.639535,used: 5:47:51.672413,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99545956, 'precision': 0.995474, 'recall': 0.99545777, 'specificity': 0.99545777, 'f1': 0.9954595, 'auroc': 0.9999251, 'binary_precision': 0.9929732, 'binary_recall': 0.99798787, 'binary_specificity': 0.9929277, 'binary_f1_score': 0.9954742}
confusion matrix:
       0      1
0  25131    179
1     51  25295
---- Validation: 
scalar performance:
{'acc': 0.9485011, 'precision': 0.6489998, 'recall': 0.9042907, 'specificity': 0.9042907, 'f1': 0.70969474, 'auroc': 0.9580504, 'binary_precision': 0.30169493, 'binary_recall': 0.8578313, 'binary_specificity': 0.9507501, 'binary_f1_score': 0.446395}
confusion matrix:
       0    1
0  15907  824
1     59  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.466581, 'precision': 0.5553458, 'recall': 0.6880785, 'specificity': 0.6880785, 'f1': 0.4050328, 'auroc': 0.9013239, 'binary_precision': 0.12038101, 'binary_recall': 0.94948184, 'binary_specificity': 0.42667523, 'binary_f1_score': 0.21367148}
confusion matrix:
      0     1
0  3986  5356
1    39   733
early stop counter: 3
val acc:0.9485011100769043, best validation acc: 0.9817450046539307, corresponding to test acc:                         0.8614791631698608 / 0.9219893217086792
after epoch: 20,now: 2024-08-06 08:40:39.233233,epoch time: 0:18:02.034103,used: 6:05:53.706516,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:05:53.706516 at 2024-08-06 08:40:39.233233
persisted model performance metric: 

scalar performance:
{'acc': 0.86147916, 'precision': 0.66174555, 'recall': 0.85550094, 'specificity': 0.85550094, 'f1': 0.70161855, 'auroc': 0.9107965, 'binary_precision': 0.33780298, 'binary_recall': 0.8484456, 'binary_specificity': 0.8625562, 'binary_f1_score': 0.48321652}
confusion matrix:
      0     1
0  8058  1284
1   117   655
oracle model performance metric: 

scalar performance:
{'acc': 0.9219893, 'precision': 0.7319478, 'recall': 0.80685806, 'specificity': 0.80685806, 'f1': 0.76239884, 'auroc': 0.924681, 'binary_precision': 0.49192783, 'binary_recall': 0.67098445, 'binary_specificity': 0.94273174, 'binary_f1_score': 0.56767124}
confusion matrix:
      0    1
0  8807  535
1   254  518
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459204 KiB |  13220 MiB | 562909 GiB | 562908 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 459204 KiB |  13220 MiB | 562909 GiB | 562908 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447934 KiB |  13213 MiB | 562426 GiB | 562426 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |  40859 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14412 MiB |  14412 MiB |  14412 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 415291 KiB |   1235 MiB | 450794 GiB | 450794 GiB |
|       from large pool | 406502 KiB |   1232 MiB | 442915 GiB | 442915 GiB |
|       from small pool |   8789 KiB |     17 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4934    |    7337    |  107645 K  |  107640 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56145 K  |   56141 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4934    |    7337    |  107645 K  |  107640 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56145 K  |   56141 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3222    |   64519 K  |   64519 K  |
|       from large pool |      30    |     604    |   37573 K  |   37573 K  |
|       from small pool |      38    |    3191    |   26945 K  |   26945 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562426 GiB | 562426 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450795 GiB | 450795 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     42 MiB |   7879 GiB |   7879 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107645 K  |  107645 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56145 K  |   56145 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107645 K  |  107645 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56145 K  |   56145 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64521 K  |   64521 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   26947 K  |   26947 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562426 GiB | 562426 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450795 GiB | 450795 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     42 MiB |   7879 GiB |   7879 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107645 K  |  107645 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56145 K  |   56145 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107645 K  |  107645 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56145 K  |   56145 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64521 K  |   64521 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   26947 K  |   26947 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671

 Experiment start at: 2024-08-06 09:03:13.643124
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98548156, 'precision': 0.9855429, 'recall': 0.9854773, 'specificity': 0.9854773, 'f1': 0.985481, 'auroc': 0.99884593, 'binary_precision': 0.9802816, 'binary_recall': 0.9909184, 'binary_specificity': 0.9800362, 'binary_f1_score': 0.98557127}
confusion matrix:
       0      1
0  24889    507
1    231  25205
---- Validation: 
scalar performance:
{'acc': 0.8728027, 'precision': 0.5757621, 'recall': 0.8884235, 'specificity': 0.8884235, 'f1': 0.5970401, 'auroc': 0.9397868, 'binary_precision': 0.1543332, 'binary_recall': 0.9048724, 'binary_specificity': 0.8719746, 'binary_f1_score': 0.2636917}
confusion matrix:
       0     1
0  14555  2137
1     41   390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87642455, 'precision': 0.6787181, 'recall': 0.8846464, 'specificity': 0.8846464, 'f1': 0.72482014, 'auroc': 0.92740047, 'binary_precision': 0.36713666, 'binary_recall': 0.89431965, 'binary_specificity': 0.87497324, 'binary_f1_score': 0.520569}
confusion matrix:
      0     1
0  8167  1167
1    80   677
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 09:22:39.708671,epoch time: 0:19:26.065547,used: 0:19:26.065547,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9794432, 'recall': 0.97917724, 'specificity': 0.97917724, 'f1': 0.979164, 'auroc': 0.9978074, 'binary_precision': 0.9911754, 'binary_recall': 0.96697855, 'binary_specificity': 0.9913759, 'binary_f1_score': 0.9789275}
confusion matrix:
       0      1
0  25175    219
1    840  24598
---- Validation: 
scalar performance:
{'acc': 0.88278925, 'precision': 0.57600296, 'recall': 0.85964155, 'specificity': 0.85964155, 'f1': 0.60017526, 'auroc': 0.92086244, 'binary_precision': 0.15679443, 'binary_recall': 0.8352668, 'binary_specificity': 0.8840163, 'binary_f1_score': 0.2640264}
confusion matrix:
       0     1
0  14756  1936
1     71   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91021705, 'precision': 0.7062017, 'recall': 0.8124798, 'specificity': 0.8124798, 'f1': 0.7442504, 'auroc': 0.88646686, 'binary_precision': 0.43817428, 'binary_recall': 0.6974901, 'binary_specificity': 0.9274695, 'binary_f1_score': 0.5382263}
confusion matrix:
      0    1
0  8657  677
1   229  528
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 09:41:07.633370,epoch time: 0:18:27.924699,used: 0:37:53.990246,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99338996, 'precision': 0.9933947, 'recall': 0.9933915, 'specificity': 0.9933915, 'f1': 0.99338996, 'auroc': 0.99964905, 'binary_precision': 0.9951475, 'binary_recall': 0.9916267, 'binary_specificity': 0.99515635, 'binary_f1_score': 0.993384}
confusion matrix:
       0      1
0  25271    123
1    213  25225
---- Validation: 
scalar performance:
{'acc': 0.9692811, 'precision': 0.7129728, 'recall': 0.84636706, 'specificity': 0.84636706, 'f1': 0.76215976, 'auroc': 0.94711995, 'binary_precision': 0.4333801, 'binary_recall': 0.71693736, 'binary_specificity': 0.97579676, 'binary_f1_score': 0.54020983}
confusion matrix:
       0    1
0  16288  404
1    122  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9114062, 'precision': 0.7145715, 'recall': 0.8513595, 'specificity': 0.8513595, 'f1': 0.75999415, 'auroc': 0.92362726, 'binary_precision': 0.4480667, 'binary_recall': 0.7807133, 'binary_specificity': 0.9220056, 'binary_f1_score': 0.56936413}
confusion matrix:
      0    1
0  8606  728
1   166  591
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 09:59:36.255674,epoch time: 0:18:28.622304,used: 0:56:22.612550,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9891997, 'precision': 0.9892776, 'recall': 0.98919487, 'specificity': 0.98919487, 'f1': 0.9891992, 'auroc': 0.99960446, 'binary_precision': 0.983299, 'binary_recall': 0.9953216, 'binary_specificity': 0.9830682, 'binary_f1_score': 0.9892738}
confusion matrix:
       0      1
0  24966    430
1    119  25317
---- Validation: 
scalar performance:
{'acc': 0.79588854, 'precision': 0.5515695, 'recall': 0.8681858, 'specificity': 0.8681858, 'f1': 0.5360809, 'auroc': 0.9512794, 'binary_precision': 0.10495101, 'binary_recall': 0.94431555, 'binary_specificity': 0.7920561, 'binary_f1_score': 0.18890694}
confusion matrix:
       0     1
0  13221  3471
1     24   407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.894064, 'precision': 0.69923186, 'recall': 0.89843, 'specificity': 0.89843, 'f1': 0.7505518, 'auroc': 0.9309255, 'binary_precision': 0.40714285, 'binary_recall': 0.9035667, 'binary_specificity': 0.8932933, 'binary_f1_score': 0.5613459}
confusion matrix:
      0    1
0  8338  996
1    73  684
early stop counter: 1
val acc:0.7958885431289673, best validation acc: 0.9692810773849487, corresponding to test acc:                         0.9114062190055847 / 0.9114062190055847
after epoch: 4,now: 2024-08-06 10:17:59.406807,epoch time: 0:18:23.151133,used: 1:14:45.763683,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98548156, 'precision': 0.9858745, 'recall': 0.98549235, 'specificity': 0.98549235, 'f1': 0.98547894, 'auroc': 0.9995269, 'binary_precision': 0.9998786, 'binary_recall': 0.97110283, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9852807}
confusion matrix:
       0      1
0  25394      3
1    735  24700
---- Validation: 
scalar performance:
{'acc': 0.9788588, 'precision': 0.84654164, 'recall': 0.6331629, 'specificity': 0.6331629, 'f1': 0.68990755, 'auroc': 0.94421065, 'binary_precision': 0.71165645, 'binary_recall': 0.26914153, 'binary_specificity': 0.9971843, 'binary_f1_score': 0.39057237}
confusion matrix:
       0    1
0  16645   47
1    315  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9225052, 'precision': 0.7277342, 'recall': 0.78331304, 'specificity': 0.78331304, 'f1': 0.7514957, 'auroc': 0.927084, 'binary_precision': 0.48701972, 'binary_recall': 0.6195509, 'binary_specificity': 0.9470752, 'binary_f1_score': 0.5453488}
confusion matrix:
      0    1
0  8840  494
1   288  469
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 10:36:05.872598,epoch time: 0:18:06.465791,used: 1:32:52.229474,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9941375, 'precision': 0.99413824, 'recall': 0.99413717, 'specificity': 0.99413717, 'f1': 0.9941375, 'auroc': 0.99972034, 'binary_precision': 0.99371517, 'binary_recall': 0.9945746, 'binary_specificity': 0.9936998, 'binary_f1_score': 0.9941447}
confusion matrix:
       0      1
0  25236    160
1    138  25298
---- Validation: 
scalar performance:
{'acc': 0.9539216, 'precision': 0.6634549, 'recall': 0.8882151, 'specificity': 0.8882151, 'f1': 0.72407496, 'auroc': 0.95093834, 'binary_precision': 0.3317669, 'binary_recall': 0.8190255, 'binary_specificity': 0.95740473, 'binary_f1_score': 0.47224084}
confusion matrix:
       0    1
0  15981  711
1     78  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91556835, 'precision': 0.7196987, 'recall': 0.8372221, 'specificity': 0.8372221, 'f1': 0.76144445, 'auroc': 0.9245726, 'binary_precision': 0.46116108, 'binary_recall': 0.74504626, 'binary_specificity': 0.9293979, 'binary_f1_score': 0.56969696}
confusion matrix:
      0    1
0  8675  659
1   193  564
early stop counter: 1
val acc:0.9539216160774231, best validation acc: 0.9788588285446167, corresponding to test acc:                         0.9225051999092102 / 0.9225051999092102
after epoch: 6,now: 2024-08-06 10:54:13.913645,epoch time: 0:18:08.041047,used: 1:51:00.270521,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9902817, 'precision': 0.99044806, 'recall': 0.9902891, 'specificity': 0.9902891, 'f1': 0.9902809, 'auroc': 0.99970424, 'binary_precision': 0.99967945, 'binary_recall': 0.9808932, 'binary_specificity': 0.999685, 'binary_f1_score': 0.9901972}
confusion matrix:
       0      1
0  25388      8
1    486  24950
---- Validation: 
scalar performance:
{'acc': 0.9747708, 'precision': 0.73864156, 'recall': 0.60394275, 'specificity': 0.60394275, 'f1': 0.64292777, 'auroc': 0.94394875, 'binary_precision': 0.4972973, 'binary_recall': 0.21345708, 'binary_specificity': 0.99442846, 'binary_f1_score': 0.2987013}
confusion matrix:
       0   1
0  16599  93
1    339  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92518085, 'precision': 0.83762515, 'recall': 0.501928, 'specificity': 0.501928, 'f1': 0.48450446, 'auroc': 0.91015255, 'binary_precision': 0.75, 'binary_recall': 0.003963012, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.007884363}
confusion matrix:
      0  1
0  9333  1
1   754  3
new oracle model saved
early stop counter: 2
val acc:0.9747707843780518, best validation acc: 0.9788588285446167, corresponding to test acc:                         0.9225051999092102 / 0.9251808524131775
after epoch: 7,now: 2024-08-06 11:12:23.759418,epoch time: 0:18:09.845773,used: 2:09:10.116294,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99459004, 'precision': 0.9946352, 'recall': 0.9945939, 'specificity': 0.9945939, 'f1': 0.9945899, 'auroc': 0.99985075, 'binary_precision': 0.9995632, 'binary_recall': 0.989621, 'binary_specificity': 0.99956685, 'binary_f1_score': 0.9945673}
confusion matrix:
       0      1
0  25385     11
1    264  25172
---- Validation: 
scalar performance:
{'acc': 0.97185075, 'precision': 0.72714734, 'recall': 0.84655493, 'specificity': 0.84655493, 'f1': 0.7732396, 'auroc': 0.94797325, 'binary_precision': 0.4617691, 'binary_recall': 0.7146172, 'binary_specificity': 0.9784927, 'binary_f1_score': 0.56102}
confusion matrix:
       0    1
0  16333  359
1    123  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91655934, 'precision': 0.71632314, 'recall': 0.8001278, 'specificity': 0.8001278, 'f1': 0.74897903, 'auroc': 0.922721, 'binary_precision': 0.46097338, 'binary_recall': 0.663144, 'binary_specificity': 0.9371116, 'binary_f1_score': 0.5438787}
confusion matrix:
      0    1
0  8747  587
1   255  502
early stop counter: 3
val acc:0.9718507528305054, best validation acc: 0.9788588285446167, corresponding to test acc:                         0.9225051999092102 / 0.9251808524131775
after epoch: 8,now: 2024-08-06 11:30:32.987370,epoch time: 0:18:09.227952,used: 2:27:19.344246,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99053746, 'precision': 0.99062407, 'recall': 0.9905329, 'specificity': 0.9905329, 'f1': 0.990537, 'auroc': 0.9996834, 'binary_precision': 0.98427975, 'binary_recall': 0.9970119, 'binary_specificity': 0.98405385, 'binary_f1_score': 0.99060494}
confusion matrix:
       0      1
0  24993    405
1     76  25358
---- Validation: 
scalar performance:
{'acc': 0.9232027, 'precision': 0.61624426, 'recall': 0.9165345, 'specificity': 0.9165345, 'f1': 0.6663027, 'auroc': 0.9599873, 'binary_precision': 0.235012, 'binary_recall': 0.90951276, 'binary_specificity': 0.9235562, 'binary_f1_score': 0.3735112}
confusion matrix:
       0     1
0  15416  1276
1     39   392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8685958, 'precision': 0.6712668, 'recall': 0.8810215, 'specificity': 0.8810215, 'f1': 0.71491075, 'auroc': 0.9193008, 'binary_precision': 0.35220778, 'binary_recall': 0.8956407, 'binary_specificity': 0.8664024, 'binary_f1_score': 0.5055928}
confusion matrix:
      0     1
0  8087  1247
1    79   678
early stop counter: 4
val acc:0.9232026934623718, best validation acc: 0.9788588285446167, corresponding to test acc:                         0.9225051999092102 / 0.9251808524131775
after epoch: 9,now: 2024-08-06 11:48:44.117277,epoch time: 0:18:11.129907,used: 2:45:30.474153,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9954556, 'precision': 0.9954699, 'recall': 0.9954579, 'specificity': 0.9954579, 'f1': 0.9954556, 'auroc': 0.9997686, 'binary_precision': 0.9983392, 'binary_recall': 0.99256957, 'binary_specificity': 0.9983462, 'binary_f1_score': 0.995446}
confusion matrix:
       0      1
0  25354     42
1    189  25247
---- Validation: 
scalar performance:
{'acc': 0.98008525, 'precision': 0.84594524, 'recall': 0.6756071, 'specificity': 0.6756071, 'f1': 0.7314015, 'auroc': 0.95662034, 'binary_precision': 0.7083333, 'binary_recall': 0.3549884, 'binary_specificity': 0.9962257, 'binary_f1_score': 0.4729521}
confusion matrix:
       0    1
0  16629   63
1    278  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221088, 'precision': 0.6049794, 'recall': 0.5099783, 'specificity': 0.5099783, 'f1': 0.5027566, 'auroc': 0.89937913, 'binary_precision': 0.2835821, 'binary_recall': 0.025099074, 'binary_specificity': 0.9948575, 'binary_f1_score': 0.046116505}
confusion matrix:
      0   1
0  9286  48
1   738  19
better model found
persisted
after epoch: 10,now: 2024-08-06 12:07:00.467402,epoch time: 0:18:16.350125,used: 3:03:46.824278,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98988825, 'precision': 0.9900247, 'recall': 0.9898815, 'specificity': 0.9898815, 'f1': 0.9898875, 'auroc': 0.9998102, 'binary_precision': 0.98205096, 'binary_recall': 0.99803436, 'binary_specificity': 0.9817287, 'binary_f1_score': 0.98997813}
confusion matrix:
       0      1
0  24931    464
1     50  25387
---- Validation: 
scalar performance:
{'acc': 0.94171584, 'precision': 0.6415658, 'recall': 0.9124684, 'specificity': 0.9124684, 'f1': 0.7007952, 'auroc': 0.95675564, 'binary_precision': 0.2863602, 'binary_recall': 0.88167053, 'binary_specificity': 0.9432662, 'binary_f1_score': 0.43230942}
confusion matrix:
       0    1
0  15745  947
1     51  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85918146, 'precision': 0.6541467, 'recall': 0.8395165, 'specificity': 0.8395165, 'f1': 0.69205105, 'auroc': 0.8910594, 'binary_precision': 0.32526317, 'binary_recall': 0.81638044, 'binary_specificity': 0.86265266, 'binary_f1_score': 0.4651863}
confusion matrix:
      0     1
0  8052  1282
1   139   618
early stop counter: 1
val acc:0.9417158365249634, best validation acc: 0.9800852537155151, corresponding to test acc:                         0.9221088290214539 / 0.9251808524131775
after epoch: 11,now: 2024-08-06 12:25:27.024139,epoch time: 0:18:26.556737,used: 3:22:13.381015,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9953966, 'precision': 0.995415, 'recall': 0.9953989, 'specificity': 0.9953989, 'f1': 0.99539655, 'auroc': 0.9997608, 'binary_precision': 0.99861497, 'binary_recall': 0.9921758, 'binary_specificity': 0.99862194, 'binary_f1_score': 0.99538493}
confusion matrix:
       0      1
0  25363     35
1    199  25235
---- Validation: 
scalar performance:
{'acc': 0.9684635, 'precision': 0.7129118, 'recall': 0.88324225, 'specificity': 0.88324225, 'f1': 0.77123547, 'auroc': 0.9552017, 'binary_precision': 0.43127364, 'binary_recall': 0.79350346, 'binary_specificity': 0.9729811, 'binary_f1_score': 0.5588235}
confusion matrix:
       0    1
0  16241  451
1     89  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90337926, 'precision': 0.69984174, 'recall': 0.8379165, 'specificity': 0.8379165, 'f1': 0.74380314, 'auroc': 0.9162179, 'binary_precision': 0.42043796, 'binary_recall': 0.7608983, 'binary_specificity': 0.91493464, 'binary_f1_score': 0.5416079}
confusion matrix:
      0    1
0  8540  794
1   181  576
early stop counter: 2
val acc:0.9684634804725647, best validation acc: 0.9800852537155151, corresponding to test acc:                         0.9221088290214539 / 0.9251808524131775
after epoch: 12,now: 2024-08-06 12:43:46.489221,epoch time: 0:18:19.465082,used: 3:40:32.846097,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9943736, 'precision': 0.9943828, 'recall': 0.9943721, 'specificity': 0.9943721, 'f1': 0.99437356, 'auroc': 0.9997128, 'binary_precision': 0.9924421, 'binary_recall': 0.9963438, 'binary_specificity': 0.9924004, 'binary_f1_score': 0.9943891}
confusion matrix:
       0      1
0  25203    193
1     93  25343
---- Validation: 
scalar performance:
{'acc': 0.96092975, 'precision': 0.68984, 'recall': 0.9302344, 'specificity': 0.9302344, 'f1': 0.75799406, 'auroc': 0.9662446, 'binary_precision': 0.38241106, 'binary_recall': 0.89791185, 'binary_specificity': 0.9625569, 'binary_f1_score': 0.53638256}
confusion matrix:
       0    1
0  16067  625
1     44  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8898028, 'precision': 0.6880547, 'recall': 0.8657799, 'specificity': 0.8657799, 'f1': 0.7351541, 'auroc': 0.9183078, 'binary_precision': 0.39063463, 'binary_recall': 0.8375165, 'binary_specificity': 0.89404327, 'binary_f1_score': 0.53277314}
confusion matrix:
      0    1
0  8345  989
1   123  634
early stop counter: 3
val acc:0.9609297513961792, best validation acc: 0.9800852537155151, corresponding to test acc:                         0.9221088290214539 / 0.9251808524131775
after epoch: 13,now: 2024-08-06 13:02:14.793616,epoch time: 0:18:28.304395,used: 3:59:01.150492,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9955343, 'precision': 0.9955524, 'recall': 0.9955371, 'specificity': 0.9955371, 'f1': 0.9955343, 'auroc': 0.99983895, 'binary_precision': 0.9987734, 'binary_recall': 0.99229497, 'binary_specificity': 0.99877924, 'binary_f1_score': 0.9955237}
confusion matrix:
       0      1
0  25363     31
1    196  25242
---- Validation: 
scalar performance:
{'acc': 0.94924957, 'precision': 0.64228284, 'recall': 0.8349626, 'specificity': 0.8349626, 'f1': 0.69414467, 'auroc': 0.91755897, 'binary_precision': 0.29222012, 'binary_recall': 0.7146172, 'binary_specificity': 0.95530796, 'binary_f1_score': 0.4148148}
confusion matrix:
       0    1
0  15946  746
1    123  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8621544, 'precision': 0.6540698, 'recall': 0.83019876, 'specificity': 0.83019876, 'f1': 0.6920336, 'auroc': 0.89614433, 'binary_precision': 0.32715377, 'binary_recall': 0.79260236, 'binary_specificity': 0.86779517, 'binary_f1_score': 0.46314168}
confusion matrix:
      0     1
0  8100  1234
1   157   600
early stop counter: 4
val acc:0.9492495656013489, best validation acc: 0.9800852537155151, corresponding to test acc:                         0.9221088290214539 / 0.9251808524131775
after epoch: 14,now: 2024-08-06 13:20:42.513257,epoch time: 0:18:27.719641,used: 4:17:28.870133,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99449164, 'precision': 0.9945454, 'recall': 0.99449545, 'specificity': 0.99449545, 'f1': 0.9944915, 'auroc': 0.99986446, 'binary_precision': 0.9998808, 'binary_recall': 0.98910904, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99446577}
confusion matrix:
       0      1
0  25395      3
1    277  25157
---- Validation: 
scalar performance:
{'acc': 0.98090285, 'precision': 0.84044766, 'recall': 0.71219087, 'specificity': 0.71219087, 'f1': 0.7605498, 'auroc': 0.95299315, 'binary_precision': 0.69548875, 'binary_recall': 0.42923433, 'binary_specificity': 0.99514735, 'binary_f1_score': 0.53084654}
confusion matrix:
       0    1
0  16611   81
1    246  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9080369, 'precision': 0.70473725, 'recall': 0.82526076, 'specificity': 0.82526076, 'f1': 0.74586666, 'auroc': 0.91303945, 'binary_precision': 0.43283582, 'binary_recall': 0.7278732, 'binary_specificity': 0.9226484, 'binary_f1_score': 0.5428571}
confusion matrix:
      0    1
0  8612  722
1   206  551
better model found
persisted
after epoch: 15,now: 2024-08-06 13:39:11.314753,epoch time: 0:18:28.801496,used: 4:35:57.671629,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9954753, 'precision': 0.9954778, 'recall': 0.9954746, 'specificity': 0.9954746, 'f1': 0.9954753, 'auroc': 0.9998156, 'binary_precision': 0.9945456, 'binary_recall': 0.9964224, 'binary_specificity': 0.9945267, 'binary_f1_score': 0.9954831}
confusion matrix:
       0      1
0  25257    139
1     91  25345
---- Validation: 
scalar performance:
{'acc': 0.96116334, 'precision': 0.6877406, 'recall': 0.90888155, 'specificity': 0.90888155, 'f1': 0.7525462, 'auroc': 0.9606464, 'binary_precision': 0.37938145, 'binary_recall': 0.8538283, 'binary_specificity': 0.96393484, 'binary_f1_score': 0.52533907}
confusion matrix:
       0    1
0  16090  602
1     63  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89010006, 'precision': 0.69459504, 'recall': 0.8968943, 'specificity': 0.8968943, 'f1': 0.7449987, 'auroc': 0.9166201, 'binary_precision': 0.39779326, 'binary_recall': 0.90488774, 'binary_specificity': 0.8889008, 'binary_f1_score': 0.55264217}
confusion matrix:
      0     1
0  8297  1037
1    72   685
early stop counter: 1
val acc:0.961163341999054, best validation acc: 0.9809028506278992, corresponding to test acc:                         0.9080368876457214 / 0.9251808524131775
after epoch: 16,now: 2024-08-06 13:57:40.075638,epoch time: 0:18:28.760885,used: 4:54:26.432514,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99616385, 'precision': 0.9961672, 'recall': 0.99616504, 'specificity': 0.99616504, 'f1': 0.99616385, 'auroc': 0.9998977, 'binary_precision': 0.9976734, 'binary_recall': 0.9946532, 'binary_specificity': 0.9976768, 'binary_f1_score': 0.99616104}
confusion matrix:
       0      1
0  25337     59
1    136  25300
---- Validation: 
scalar performance:
{'acc': 0.97313553, 'precision': 0.7310833, 'recall': 0.78505635, 'specificity': 0.78505635, 'f1': 0.7549937, 'auroc': 0.93584764, 'binary_precision': 0.4728972, 'binary_recall': 0.587007, 'binary_specificity': 0.98310566, 'binary_f1_score': 0.52380955}
confusion matrix:
       0    1
0  16410  282
1    178  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6456248, 'precision': 0.5584029, 'recall': 0.7010149, 'specificity': 0.7010149, 'f1': 0.5067081, 'auroc': 0.74214625, 'binary_precision': 0.14576527, 'binary_recall': 0.7661823, 'binary_specificity': 0.63584745, 'binary_f1_score': 0.24493243}
confusion matrix:
      0     1
0  5935  3399
1   177   580
early stop counter: 2
val acc:0.9731355309486389, best validation acc: 0.9809028506278992, corresponding to test acc:                         0.9080368876457214 / 0.9251808524131775
after epoch: 17,now: 2024-08-06 14:16:16.170982,epoch time: 0:18:36.095344,used: 5:13:02.527858,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99714744, 'precision': 0.9971477, 'recall': 0.997148, 'specificity': 0.997148, 'f1': 0.99714744, 'auroc': 0.99991614, 'binary_precision': 0.9977564, 'binary_recall': 0.9965405, 'binary_specificity': 0.99775547, 'binary_f1_score': 0.9971481}
confusion matrix:
       0      1
0  25338     57
1     88  25349
---- Validation: 
scalar performance:
{'acc': 0.98008525, 'precision': 0.7909093, 'recall': 0.8360867, 'specificity': 0.8360867, 'f1': 0.81174576, 'auroc': 0.9593884, 'binary_precision': 0.59, 'binary_recall': 0.68445474, 'binary_specificity': 0.98771864, 'binary_f1_score': 0.63372713}
confusion matrix:
       0    1
0  16487  205
1    136  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.906154, 'precision': 0.65959346, 'recall': 0.65551525, 'specificity': 0.65551525, 'f1': 0.65751755, 'auroc': 0.8917273, 'binary_precision': 0.3709239, 'binary_recall': 0.3606341, 'binary_specificity': 0.9503964, 'binary_f1_score': 0.36570662}
confusion matrix:
      0    1
0  8871  463
1   484  273
early stop counter: 3
val acc:0.9800852537155151, best validation acc: 0.9809028506278992, corresponding to test acc:                         0.9080368876457214 / 0.9251808524131775
after epoch: 18,now: 2024-08-06 14:34:47.490693,epoch time: 0:18:31.319711,used: 5:31:33.847569,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9958294, 'precision': 0.9958551, 'recall': 0.9958321, 'specificity': 0.9958321, 'f1': 0.99582934, 'auroc': 0.9998236, 'binary_precision': 0.9996038, 'binary_recall': 0.99205786, 'binary_specificity': 0.99960625, 'binary_f1_score': 0.9958165}
confusion matrix:
       0      1
0  25388     10
1    202  25232
---- Validation: 
scalar performance:
{'acc': 0.9814285, 'precision': 0.8343228, 'recall': 0.74297416, 'specificity': 0.74297416, 'f1': 0.7809686, 'auroc': 0.9511956, 'binary_precision': 0.68167204, 'binary_recall': 0.49187934, 'binary_specificity': 0.99406904, 'binary_f1_score': 0.5714286}
confusion matrix:
       0    1
0  16593   99
1    219  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91041523, 'precision': 0.7037012, 'recall': 0.7961997, 'specificity': 0.7961997, 'f1': 0.7381222, 'auroc': 0.904211, 'binary_precision': 0.43603134, 'binary_recall': 0.661823, 'binary_specificity': 0.9305764, 'binary_f1_score': 0.52570826}
confusion matrix:
      0    1
0  8686  648
1   256  501
better model found
persisted
after epoch: 19,now: 2024-08-06 14:53:16.273329,epoch time: 0:18:28.782636,used: 5:50:02.630205,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9961442, 'precision': 0.9961554, 'recall': 0.99614596, 'specificity': 0.99614596, 'f1': 0.9961441, 'auroc': 0.99989057, 'binary_precision': 0.99869585, 'binary_recall': 0.99359125, 'binary_specificity': 0.9987007, 'binary_f1_score': 0.99613696}
confusion matrix:
       0      1
0  25365     33
1    163  25271
---- Validation: 
scalar performance:
{'acc': 0.90848565, 'precision': 0.5946575, 'recall': 0.87282157, 'specificity': 0.87282157, 'f1': 0.6328957, 'auroc': 0.93573534, 'binary_precision': 0.19396552, 'binary_recall': 0.8352668, 'binary_specificity': 0.91037625, 'binary_f1_score': 0.3148229}
confusion matrix:
       0     1
0  15196  1496
1     71   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8757309, 'precision': 0.6749481, 'recall': 0.870312, 'specificity': 0.870312, 'f1': 0.7196847, 'auroc': 0.91275084, 'binary_precision': 0.36232686, 'binary_recall': 0.8639366, 'binary_specificity': 0.8766874, 'binary_f1_score': 0.51053864}
confusion matrix:
      0     1
0  8183  1151
1   103   654
early stop counter: 1
val acc:0.9084856510162354, best validation acc: 0.9814285039901733, corresponding to test acc:                         0.9104152321815491 / 0.9251808524131775
after epoch: 20,now: 2024-08-06 15:11:36.579760,epoch time: 0:18:20.306431,used: 6:08:22.936636,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_03_13_seed_1_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:08:22.936636 at 2024-08-06 15:11:36.579760
persisted model performance metric: 

scalar performance:
{'acc': 0.91041523, 'precision': 0.7037012, 'recall': 0.7961997, 'specificity': 0.7961997, 'f1': 0.7381222, 'auroc': 0.904211, 'binary_precision': 0.43603134, 'binary_recall': 0.661823, 'binary_specificity': 0.9305764, 'binary_f1_score': 0.52570826}
confusion matrix:
      0    1
0  8686  648
1   256  501
oracle model performance metric: 

scalar performance:
{'acc': 0.92518085, 'precision': 0.83762515, 'recall': 0.501928, 'specificity': 0.501928, 'f1': 0.48450446, 'auroc': 0.91015255, 'binary_precision': 0.75, 'binary_recall': 0.003963012, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.007884363}
confusion matrix:
      0  1
0  9333  1
1   754  3
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |  40858 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  28102 MiB |  13630 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  28014 MiB |  13608 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool | 455249 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |  10843 KiB |     42 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7359    |  216545 K  |  216540 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112784 K  |  112780 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7359    |  216545 K  |  216540 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112784 K  |  112780 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1212    |     577    |
|       from large pool |     602    |     602    |    1168    |     566    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3240    |  127759 K  |  127759 K  |
|       from large pool |      36    |     605    |   73199 K  |   73199 K  |
|       from small pool |      38    |    3204    |   54560 K  |   54560 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     42 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216545 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112784 K  |  112784 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216545 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112784 K  |  112784 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3240    |  127761 K  |  127761 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3204    |   54562 K  |   54562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     42 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216545 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112784 K  |  112784 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216545 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112784 K  |  112784 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3240    |  127761 K  |  127761 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3204    |   54562 K  |   54562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671

 Experiment start at: 2024-08-06 15:34:20.396292
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97317004, 'precision': 0.974414, 'recall': 0.973173, 'specificity': 0.973173, 'f1': 0.9731525, 'auroc': 0.9974427, 'binary_precision': 0.998736, 'binary_recall': 0.9475455, 'binary_specificity': 0.9988005, 'binary_f1_score': 0.97246754}
confusion matrix:
       0      1
0  25814     31
1   1356  24495
---- Validation: 
scalar performance:
{'acc': 0.96548706, 'precision': 0.65412873, 'recall': 0.6802548, 'specificity': 0.6802548, 'f1': 0.66605395, 'auroc': 0.8778784, 'binary_precision': 0.3238289, 'binary_recall': 0.38038278, 'binary_specificity': 0.9801269, 'binary_f1_score': 0.34983495}
confusion matrix:
       0    1
0  16374  332
1    259  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90378517, 'precision': 0.7009884, 'recall': 0.80150974, 'specificity': 0.80150974, 'f1': 0.73696667, 'auroc': 0.8979646, 'binary_precision': 0.4308426, 'binary_recall': 0.6800502, 'binary_specificity': 0.92296934, 'binary_f1_score': 0.5274939}
confusion matrix:
      0    1
0  8579  716
1   255  542
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 15:54:30.598351,epoch time: 0:20:10.202059,used: 0:20:10.202059,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99054086, 'precision': 0.99057704, 'recall': 0.9905419, 'specificity': 0.9905419, 'f1': 0.9905407, 'auroc': 0.9991367, 'binary_precision': 0.99484956, 'binary_recall': 0.9861917, 'binary_specificity': 0.99489206, 'binary_f1_score': 0.9905017}
confusion matrix:
       0      1
0  25710    132
1    357  25497
---- Validation: 
scalar performance:
{'acc': 0.9542163, 'precision': 0.6536355, 'recall': 0.84941494, 'specificity': 0.84941494, 'f1': 0.708465, 'auroc': 0.9293801, 'binary_precision': 0.3140244, 'binary_recall': 0.73923445, 'binary_specificity': 0.9595954, 'binary_f1_score': 0.44079885}
confusion matrix:
       0    1
0  16031  675
1    109  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9273682, 'precision': 0.75680304, 'recall': 0.65486264, 'specificity': 0.65486264, 'f1': 0.6899897, 'auroc': 0.88719904, 'binary_precision': 0.5689655, 'binary_recall': 0.33124214, 'binary_specificity': 0.9784831, 'binary_f1_score': 0.4187153}
confusion matrix:
      0    1
0  9095  200
1   533  264
new oracle model saved
early stop counter: 1
val acc:0.9542163014411926, best validation acc: 0.9654870629310608, corresponding to test acc:                         0.9037851691246033 / 0.9273682236671448
after epoch: 2,now: 2024-08-06 16:13:46.025140,epoch time: 0:19:15.426789,used: 0:39:25.628848,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99297816, 'precision': 0.9929877, 'recall': 0.9929788, 'specificity': 0.9929788, 'f1': 0.99297816, 'auroc': 0.99952877, 'binary_precision': 0.9952211, 'binary_recall': 0.9907175, 'binary_specificity': 0.99524015, 'binary_f1_score': 0.99296415}
confusion matrix:
       0      1
0  25718    123
1    240  25615
---- Validation: 
scalar performance:
{'acc': 0.9494277, 'precision': 0.64950216, 'recall': 0.8901117, 'specificity': 0.8901117, 'f1': 0.70883393, 'auroc': 0.9461396, 'binary_precision': 0.30350876, 'binary_recall': 0.8277512, 'binary_specificity': 0.95247215, 'binary_f1_score': 0.44415918}
confusion matrix:
       0    1
0  15912  794
1     72  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89209276, 'precision': 0.68046373, 'recall': 0.7871324, 'specificity': 0.7871324, 'f1': 0.71596926, 'auroc': 0.8664539, 'binary_precision': 0.3916914, 'binary_recall': 0.6624843, 'binary_specificity': 0.91178054, 'binary_f1_score': 0.4923077}
confusion matrix:
      0    1
0  8475  820
1   269  528
early stop counter: 2
val acc:0.9494277238845825, best validation acc: 0.9654870629310608, corresponding to test acc:                         0.9037851691246033 / 0.9273682236671448
after epoch: 3,now: 2024-08-06 16:32:43.773471,epoch time: 0:18:57.748331,used: 0:58:23.377179,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99456435, 'precision': 0.99459416, 'recall': 0.99456453, 'specificity': 0.99456453, 'f1': 0.9945643, 'auroc': 0.9998082, 'binary_precision': 0.99844044, 'binary_recall': 0.99067664, 'binary_specificity': 0.9984524, 'binary_f1_score': 0.9945434}
confusion matrix:
       0      1
0  25807     40
1    241  25608
---- Validation: 
scalar performance:
{'acc': 0.97780895, 'precision': 0.76534593, 'recall': 0.79619676, 'specificity': 0.79619676, 'f1': 0.779858, 'auroc': 0.94299924, 'binary_precision': 0.5405983, 'binary_recall': 0.6052632, 'binary_specificity': 0.98713034, 'binary_f1_score': 0.57110614}
confusion matrix:
       0    1
0  16491  215
1    165  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9177566, 'precision': 0.68530625, 'recall': 0.56705207, 'specificity': 0.56705207, 'f1': 0.5904377, 'auroc': 0.8845886, 'binary_precision': 0.43956044, 'binary_recall': 0.15056461, 'binary_specificity': 0.9835395, 'binary_f1_score': 0.22429906}
confusion matrix:
      0    1
0  9142  153
1   677  120
better model found
persisted
after epoch: 4,now: 2024-08-06 16:51:47.967988,epoch time: 0:19:04.194517,used: 1:17:27.571696,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99233985, 'precision': 0.9924278, 'recall': 0.9923422, 'specificity': 0.9923422, 'f1': 0.9923395, 'auroc': 0.9995458, 'binary_precision': 0.9990983, 'binary_recall': 0.9855745, 'binary_specificity': 0.99910986, 'binary_f1_score': 0.9922903}
confusion matrix:
       0      1
0  25816     23
1    373  25484
---- Validation: 
scalar performance:
{'acc': 0.97226113, 'precision': 0.7214327, 'recall': 0.81084716, 'specificity': 0.81084716, 'f1': 0.75793844, 'auroc': 0.9420433, 'binary_precision': 0.45193928, 'binary_recall': 0.6411483, 'binary_specificity': 0.98054594, 'binary_f1_score': 0.5301681}
confusion matrix:
       0    1
0  16381  325
1    150  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91309947, 'precision': 0.6528602, 'recall': 0.5645238, 'specificity': 0.5645238, 'f1': 0.5844328, 'auroc': 0.8925506, 'binary_precision': 0.375, 'binary_recall': 0.15056461, 'binary_specificity': 0.9784831, 'binary_f1_score': 0.21486123}
confusion matrix:
      0    1
0  9095  200
1   677  120
early stop counter: 1
val acc:0.9722611308097839, best validation acc: 0.977808952331543, corresponding to test acc:                         0.9177566170692444 / 0.9273682236671448
after epoch: 5,now: 2024-08-06 17:10:54.881352,epoch time: 0:19:06.913364,used: 1:36:34.485060,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99471915, 'precision': 0.994724, 'recall': 0.99471915, 'specificity': 0.99471915, 'f1': 0.9947191, 'auroc': 0.99968123, 'binary_precision': 0.9962743, 'binary_recall': 0.99315226, 'binary_specificity': 0.996286, 'binary_f1_score': 0.9947108}
confusion matrix:
       0      1
0  25752     96
1    177  25671
---- Validation: 
scalar performance:
{'acc': 0.9609904, 'precision': 0.6728452, 'recall': 0.84239054, 'specificity': 0.84239054, 'f1': 0.7264657, 'auroc': 0.9385623, 'binary_precision': 0.3529412, 'binary_recall': 0.71770334, 'binary_specificity': 0.9670777, 'binary_f1_score': 0.47318617}
confusion matrix:
       0    1
0  16156  550
1    118  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.921522, 'precision': 0.7299957, 'recall': 0.72682524, 'specificity': 0.72682524, 'f1': 0.72839594, 'auroc': 0.8964639, 'binary_precision': 0.50318474, 'binary_recall': 0.49560854, 'binary_specificity': 0.95804197, 'binary_f1_score': 0.4993679}
confusion matrix:
      0    1
0  8905  390
1   402  395
early stop counter: 2
val acc:0.9609904289245605, best validation acc: 0.977808952331543, corresponding to test acc:                         0.9177566170692444 / 0.9273682236671448
after epoch: 6,now: 2024-08-06 17:30:14.787634,epoch time: 0:19:19.906282,used: 1:55:54.391342,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9944677, 'precision': 0.9945084, 'recall': 0.9944682, 'specificity': 0.9944682, 'f1': 0.99446756, 'auroc': 0.9998523, 'binary_precision': 0.99902403, 'binary_recall': 0.9899037, 'binary_specificity': 0.9990327, 'binary_f1_score': 0.99444294}
confusion matrix:
       0      1
0  25820     25
1    261  25590
---- Validation: 
scalar performance:
{'acc': 0.9784513, 'precision': 0.77823305, 'recall': 0.7358813, 'specificity': 0.7358813, 'f1': 0.7551892, 'auroc': 0.935417, 'binary_precision': 0.5694051, 'binary_recall': 0.48086125, 'binary_specificity': 0.99090147, 'binary_f1_score': 0.5214008}
confusion matrix:
       0    1
0  16554  152
1    217  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9144867, 'precision': 0.7110871, 'recall': 0.7361978, 'specificity': 0.7361978, 'f1': 0.72268385, 'auroc': 0.8862392, 'binary_precision': 0.46341464, 'binary_recall': 0.52446675, 'binary_specificity': 0.94792897, 'binary_f1_score': 0.49205413}
confusion matrix:
      0    1
0  8811  484
1   379  418
better model found
persisted
after epoch: 7,now: 2024-08-06 17:49:27.742528,epoch time: 0:19:12.954894,used: 2:15:07.346236,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99514467, 'precision': 0.9951449, 'recall': 0.9951447, 'specificity': 0.9951447, 'f1': 0.9951447, 'auroc': 0.999761, 'binary_precision': 0.99547076, 'binary_recall': 0.99481606, 'binary_specificity': 0.9954734, 'binary_f1_score': 0.9951433}
confusion matrix:
       0      1
0  25730    117
1    134  25715
---- Validation: 
scalar performance:
{'acc': 0.9699252, 'precision': 0.70699126, 'recall': 0.8084837, 'specificity': 0.8084837, 'f1': 0.7467719, 'auroc': 0.94488776, 'binary_precision': 0.42313787, 'binary_recall': 0.638756, 'binary_specificity': 0.9782114, 'binary_f1_score': 0.50905627}
confusion matrix:
       0    1
0  16342  364
1    151  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90745145, 'precision': 0.7145153, 'recall': 0.84536994, 'specificity': 0.84536994, 'f1': 0.7582803, 'auroc': 0.90146995, 'binary_precision': 0.44989026, 'binary_recall': 0.77164364, 'binary_specificity': 0.9190963, 'binary_f1_score': 0.56839186}
confusion matrix:
      0    1
0  8543  752
1   182  615
early stop counter: 1
val acc:0.9699252247810364, best validation acc: 0.9784513115882874, corresponding to test acc:                         0.9144867062568665 / 0.9273682236671448
after epoch: 8,now: 2024-08-06 18:08:28.130589,epoch time: 0:19:00.388061,used: 2:34:07.734297,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9928815, 'precision': 0.99291337, 'recall': 0.9928808, 'specificity': 0.9928808, 'f1': 0.99288136, 'auroc': 0.99977434, 'binary_precision': 0.98898613, 'binary_recall': 0.99686676, 'binary_specificity': 0.9888949, 'binary_f1_score': 0.9929108}
confusion matrix:
       0      1
0  25557    287
1     81  25771
---- Validation: 
scalar performance:
{'acc': 0.93710583, 'precision': 0.6259826, 'recall': 0.8849628, 'specificity': 0.8849628, 'f1': 0.67935354, 'auroc': 0.9482106, 'binary_precision': 0.2564671, 'binary_recall': 0.8301435, 'binary_specificity': 0.93978214, 'binary_f1_score': 0.391869}
confusion matrix:
       0     1
0  15700  1006
1     71   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91607213, 'precision': 0.6827646, 'recall': 0.5873593, 'specificity': 0.5873593, 'f1': 0.61296576, 'auroc': 0.90292597, 'binary_precision': 0.43131867, 'binary_recall': 0.1969887, 'binary_specificity': 0.97773, 'binary_f1_score': 0.27045652}
confusion matrix:
      0    1
0  9088  207
1   640  157
early stop counter: 2
val acc:0.9371058344841003, best validation acc: 0.9784513115882874, corresponding to test acc:                         0.9144867062568665 / 0.9273682236671448
after epoch: 9,now: 2024-08-06 18:27:36.809152,epoch time: 0:19:08.678563,used: 2:53:16.412860,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99468046, 'precision': 0.9946817, 'recall': 0.9946805, 'specificity': 0.9946805, 'f1': 0.9946804, 'auroc': 0.99971914, 'binary_precision': 0.9955051, 'binary_recall': 0.99384916, 'binary_specificity': 0.9955119, 'binary_f1_score': 0.9946765}
confusion matrix:
       0      1
0  25730    116
1    159  25691
---- Validation: 
scalar performance:
{'acc': 0.97389627, 'precision': 0.7354868, 'recall': 0.8595011, 'specificity': 0.8595011, 'f1': 0.7834054, 'auroc': 0.9586412, 'binary_precision': 0.47758886, 'binary_recall': 0.73923445, 'binary_specificity': 0.97976774, 'binary_f1_score': 0.5802817}
confusion matrix:
       0    1
0  16368  338
1    109  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9112168, 'precision': 0.67758805, 'recall': 0.6311819, 'specificity': 0.6311819, 'f1': 0.6496548, 'auroc': 0.8874674, 'binary_precision': 0.41391304, 'binary_recall': 0.29861984, 'binary_specificity': 0.9637439, 'binary_f1_score': 0.3469388}
confusion matrix:
      0    1
0  8958  337
1   559  238
early stop counter: 3
val acc:0.9738962650299072, best validation acc: 0.9784513115882874, corresponding to test acc:                         0.9144867062568665 / 0.9273682236671448
after epoch: 10,now: 2024-08-06 18:46:47.088849,epoch time: 0:19:10.279697,used: 3:12:26.692557,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9948352, 'precision': 0.9948667, 'recall': 0.994836, 'specificity': 0.994836, 'f1': 0.9948351, 'auroc': 0.99985206, 'binary_precision': 0.9988691, 'binary_recall': 0.9907941, 'binary_specificity': 0.9988778, 'binary_f1_score': 0.99481523}
confusion matrix:
       0      1
0  25814     29
1    238  25615
---- Validation: 
scalar performance:
{'acc': 0.9811376, 'precision': 0.83455384, 'recall': 0.7092683, 'specificity': 0.7092683, 'f1': 0.75663686, 'auroc': 0.9626448, 'binary_precision': 0.6833977, 'binary_recall': 0.423445, 'binary_specificity': 0.99509156, 'binary_f1_score': 0.5228951}
confusion matrix:
       0    1
0  16624   82
1    241  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9112168, 'precision': 0.7189049, 'recall': 0.83307505, 'specificity': 0.83307505, 'f1': 0.75946, 'auroc': 0.9097177, 'binary_precision': 0.4612979, 'binary_recall': 0.74027604, 'binary_specificity': 0.9258741, 'binary_f1_score': 0.5684008}
confusion matrix:
      0    1
0  8606  689
1   207  590
better model found
persisted
after epoch: 11,now: 2024-08-06 19:05:39.302340,epoch time: 0:18:52.213491,used: 3:31:18.906048,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9981817, 'precision': 0.9981827, 'recall': 0.99818176, 'specificity': 0.99818176, 'f1': 0.9981817, 'auroc': 0.99996006, 'binary_precision': 0.99891526, 'binary_recall': 0.99744684, 'binary_specificity': 0.9989167, 'binary_f1_score': 0.99818045}
confusion matrix:
       0      1
0  25818     28
1     66  25784
---- Validation: 
scalar performance:
{'acc': 0.97956085, 'precision': 0.78109074, 'recall': 0.8215858, 'specificity': 0.8215858, 'f1': 0.79987514, 'auroc': 0.96139354, 'binary_precision': 0.5708333, 'binary_recall': 0.6555024, 'binary_specificity': 0.9876691, 'binary_f1_score': 0.610245}
confusion matrix:
       0    1
0  16500  206
1    144  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90814507, 'precision': 0.71459556, 'recall': 0.8388638, 'specificity': 0.8388638, 'f1': 0.75702316, 'auroc': 0.9081255, 'binary_precision': 0.4513473, 'binary_recall': 0.7565872, 'binary_specificity': 0.9211404, 'binary_f1_score': 0.56540084}
confusion matrix:
      0    1
0  8562  733
1   194  603
early stop counter: 1
val acc:0.9795608520507812, best validation acc: 0.9811375737190247, corresponding to test acc:                         0.9112167954444885 / 0.9273682236671448
after epoch: 12,now: 2024-08-06 19:24:26.470134,epoch time: 0:18:47.167794,used: 3:50:06.073842,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9875039, 'precision': 0.98780483, 'recall': 0.9875058, 'specificity': 0.9875058, 'f1': 0.987502, 'auroc': 0.99973136, 'binary_precision': 0.9999603, 'binary_recall': 0.9750503, 'binary_specificity': 0.9999613, 'binary_f1_score': 0.9873482}
confusion matrix:
       0      1
0  25843      1
1    645  25207
---- Validation: 
scalar performance:
{'acc': 0.97500587, 'precision': 0.7075144, 'recall': 0.5405192, 'specificity': 0.5405192, 'f1': 0.5639404, 'auroc': 0.9394192, 'binary_precision': 0.4375, 'binary_recall': 0.08373206, 'binary_specificity': 0.99730635, 'binary_f1_score': 0.14056225}
confusion matrix:
       0   1
0  16661  45
1    383  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9268728, 'precision': 0.7522122, 'recall': 0.66606486, 'specificity': 0.66606486, 'f1': 0.6979113, 'auroc': 0.8869543, 'binary_precision': 0.55795676, 'binary_recall': 0.35633627, 'binary_specificity': 0.9757934, 'binary_f1_score': 0.43491578}
confusion matrix:
      0    1
0  9070  225
1   513  284
early stop counter: 2
val acc:0.9750058650970459, best validation acc: 0.9811375737190247, corresponding to test acc:                         0.9112167954444885 / 0.9273682236671448
after epoch: 13,now: 2024-08-06 19:43:13.273820,epoch time: 0:18:46.803686,used: 4:08:52.877528,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99263, 'precision': 0.9926757, 'recall': 0.99263, 'specificity': 0.99263, 'f1': 0.99262977, 'auroc': 0.9996307, 'binary_precision': 0.9974218, 'binary_recall': 0.98781335, 'binary_specificity': 0.9974466, 'binary_f1_score': 0.9925943}
confusion matrix:
       0      1
0  25782     66
1    315  25533
---- Validation: 
scalar performance:
{'acc': 0.9785681, 'precision': 0.77162516, 'recall': 0.816412, 'specificity': 0.816412, 'f1': 0.7921809, 'auroc': 0.92987823, 'binary_precision': 0.5521472, 'binary_recall': 0.64593303, 'binary_specificity': 0.9868909, 'binary_f1_score': 0.5953693}
confusion matrix:
       0    1
0  16487  219
1    148  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9171621, 'precision': 0.50308084, 'recall': 0.50019634, 'specificity': 0.50019634, 'f1': 0.4831261, 'auroc': 0.79211515, 'binary_precision': 0.08510638, 'binary_recall': 0.0050188205, 'binary_specificity': 0.99537385, 'binary_f1_score': 0.009478672}
confusion matrix:
      0   1
0  9252  43
1   793   4
early stop counter: 3
val acc:0.9785680770874023, best validation acc: 0.9811375737190247, corresponding to test acc:                         0.9112167954444885 / 0.9273682236671448
after epoch: 14,now: 2024-08-06 20:01:57.801289,epoch time: 0:18:44.527469,used: 4:27:37.404997,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.996963, 'precision': 0.99696565, 'recall': 0.9969628, 'specificity': 0.9969628, 'f1': 0.996963, 'auroc': 0.99992687, 'binary_precision': 0.9958705, 'binary_recall': 0.99806607, 'binary_specificity': 0.99585944, 'binary_f1_score': 0.9969671}
confusion matrix:
       0      1
0  25735    107
1     50  25804
---- Validation: 
scalar performance:
{'acc': 0.95690256, 'precision': 0.6719846, 'recall': 0.914935, 'specificity': 0.914935, 'f1': 0.7370385, 'auroc': 0.9651598, 'binary_precision': 0.34732825, 'binary_recall': 0.87081337, 'binary_specificity': 0.9590566, 'binary_f1_score': 0.49658936}
confusion matrix:
       0    1
0  16022  684
1     54  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85860085, 'precision': 0.65619254, 'recall': 0.8263066, 'specificity': 0.8263066, 'f1': 0.6932972, 'auroc': 0.8742161, 'binary_precision': 0.33297986, 'binary_recall': 0.7879548, 'binary_specificity': 0.8646584, 'binary_f1_score': 0.46813267}
confusion matrix:
      0     1
0  8037  1258
1   169   628
early stop counter: 4
val acc:0.9569025635719299, best validation acc: 0.9811375737190247, corresponding to test acc:                         0.9112167954444885 / 0.9273682236671448
after epoch: 15,now: 2024-08-06 20:20:43.750785,epoch time: 0:18:45.949496,used: 4:46:23.354493,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9944677, 'precision': 0.9945073, 'recall': 0.99446714, 'specificity': 0.99446714, 'f1': 0.99446756, 'auroc': 0.99994266, 'binary_precision': 0.9901077, 'binary_recall': 0.99891686, 'binary_specificity': 0.9900174, 'binary_f1_score': 0.99449277}
confusion matrix:
       0      1
0  25587    258
1     28  25823
---- Validation: 
scalar performance:
{'acc': 0.9351203, 'precision': 0.626156, 'recall': 0.9026051, 'specificity': 0.9026051, 'f1': 0.6804655, 'auroc': 0.9575819, 'binary_precision': 0.25581396, 'binary_recall': 0.8684211, 'binary_specificity': 0.93678916, 'binary_f1_score': 0.39520958}
confusion matrix:
       0     1
0  15650  1056
1     55   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60701543, 'precision': 0.57337147, 'recall': 0.75052524, 'specificity': 0.75052524, 'f1': 0.5006348, 'auroc': 0.89178157, 'binary_precision': 0.158292, 'binary_recall': 0.9209536, 'binary_specificity': 0.58009684, 'binary_f1_score': 0.2701509}
confusion matrix:
      0     1
0  5392  3903
1    63   734
early stop counter: 5
val acc:0.9351202845573425, best validation acc: 0.9811375737190247, corresponding to test acc:                         0.9112167954444885 / 0.9273682236671448
after epoch: 16,now: 2024-08-06 20:39:27.647308,epoch time: 0:18:43.896523,used: 5:05:07.251016,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9928621, 'precision': 0.99286747, 'recall': 0.9928618, 'specificity': 0.9928618, 'f1': 0.9928621, 'auroc': 0.99969614, 'binary_precision': 0.9912862, 'binary_recall': 0.99446875, 'binary_specificity': 0.99125487, 'binary_f1_score': 0.992875}
confusion matrix:
       0      1
0  25617    226
1    143  25710
---- Validation: 
scalar performance:
{'acc': 0.9710348, 'precision': 0.6978792, 'recall': 0.70525676, 'specificity': 0.70525676, 'f1': 0.70149416, 'auroc': 0.9277539, 'binary_precision': 0.41013825, 'binary_recall': 0.4258373, 'binary_specificity': 0.9846762, 'binary_f1_score': 0.4178404}
confusion matrix:
       0    1
0  16450  256
1    240  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4430242, 'precision': 0.5543915, 'recall': 0.6746907, 'specificity': 0.6746907, 'f1': 0.3907162, 'auroc': 0.8768006, 'binary_precision': 0.119438305, 'binary_recall': 0.9498118, 'binary_specificity': 0.39956966, 'binary_f1_score': 0.2121934}
confusion matrix:
      0     1
0  3714  5581
1    40   757
early stop counter: 6
val acc:0.971034824848175, best validation acc: 0.9811375737190247, corresponding to test acc:                         0.9112167954444885 / 0.9273682236671448
after epoch: 17,now: 2024-08-06 20:58:14.767006,epoch time: 0:18:47.119698,used: 5:23:54.370714,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98181677, 'precision': 0.9824542, 'recall': 0.9818175, 'specificity': 0.9818175, 'f1': 0.9818108, 'auroc': 0.9993442, 'binary_precision': 1.0, 'binary_recall': 0.96363497, 'binary_specificity': 1.0, 'binary_f1_score': 0.9814808}
confusion matrix:
       0      1
0  25847      0
1    940  24909
---- Validation: 
scalar performance:
{'acc': 0.9820135, 'precision': 0.83592266, 'recall': 0.74120575, 'specificity': 0.74120575, 'f1': 0.7803235, 'auroc': 0.94565415, 'binary_precision': 0.68456376, 'binary_recall': 0.48803827, 'binary_specificity': 0.99437326, 'binary_f1_score': 0.5698324}
confusion matrix:
       0    1
0  16612   94
1    214  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9133968, 'precision': 0.7192247, 'recall': 0.80730116, 'specificity': 0.80730116, 'f1': 0.7530614, 'auroc': 0.9069487, 'binary_precision': 0.46689597, 'binary_recall': 0.6813049, 'binary_specificity': 0.93329746, 'binary_f1_score': 0.5540816}
confusion matrix:
      0    1
0  8675  620
1   254  543
better model found
persisted
after epoch: 18,now: 2024-08-06 21:17:02.529873,epoch time: 0:18:47.762867,used: 5:42:42.133581,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9974079, 'precision': 0.9974085, 'recall': 0.99740803, 'specificity': 0.99740803, 'f1': 0.9974079, 'auroc': 0.99987787, 'binary_precision': 0.9979863, 'binary_recall': 0.9968282, 'binary_specificity': 0.99798787, 'binary_f1_score': 0.9974069}
confusion matrix:
       0      1
0  25791     52
1     82  25771
---- Validation: 
scalar performance:
{'acc': 0.970918, 'precision': 0.7182522, 'recall': 0.8603072, 'specificity': 0.8603072, 'f1': 0.7701622, 'auroc': 0.9489176, 'binary_precision': 0.44301996, 'binary_recall': 0.74401915, 'binary_specificity': 0.9765952, 'binary_f1_score': 0.55535716}
confusion matrix:
       0    1
0  16315  391
1    107  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8428458, 'precision': 0.64533514, 'recall': 0.826357, 'specificity': 0.826357, 'f1': 0.67807937, 'auroc': 0.8864004, 'binary_precision': 0.3098795, 'binary_recall': 0.8067754, 'binary_specificity': 0.8459387, 'binary_f1_score': 0.44777158}
confusion matrix:
      0     1
0  7863  1432
1   154   643
early stop counter: 1
val acc:0.9709179997444153, best validation acc: 0.9820135235786438, corresponding to test acc:                         0.9133967757225037 / 0.9273682236671448
after epoch: 19,now: 2024-08-06 21:37:08.779486,epoch time: 0:20:06.249613,used: 6:02:48.383194,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99317163, 'precision': 0.9932363, 'recall': 0.99317116, 'specificity': 0.99317116, 'f1': 0.99317133, 'auroc': 0.99987507, 'binary_precision': 0.9876076, 'binary_recall': 0.9988781, 'binary_specificity': 0.9874642, 'binary_f1_score': 0.99321085}
confusion matrix:
       0      1
0  25522    324
1     29  25821
---- Validation: 
scalar performance:
{'acc': 0.96233356, 'precision': 0.68079925, 'recall': 0.8617388, 'specificity': 0.8617388, 'f1': 0.7376737, 'auroc': 0.95417607, 'binary_precision': 0.36786962, 'binary_recall': 0.75598085, 'binary_specificity': 0.9674967, 'binary_f1_score': 0.49490997}
confusion matrix:
       0    1
0  16163  543
1    102  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8723742, 'precision': 0.6777562, 'recall': 0.86877096, 'specificity': 0.86877096, 'f1': 0.7216774, 'auroc': 0.91556513, 'binary_precision': 0.36864632, 'binary_recall': 0.8644918, 'binary_specificity': 0.87305003, 'binary_f1_score': 0.5168792}
confusion matrix:
      0     1
0  8115  1180
1   108   689
early stop counter: 2
val acc:0.9623335599899292, best validation acc: 0.9820135235786438, corresponding to test acc:                         0.9133967757225037 / 0.9273682236671448
after epoch: 20,now: 2024-08-06 21:57:44.275021,epoch time: 0:20:35.495535,used: 6:23:23.878729,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_34_20_seed_2_24076671
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:23:23.878729 at 2024-08-06 21:57:44.275021
persisted model performance metric: 

scalar performance:
{'acc': 0.9133968, 'precision': 0.7192247, 'recall': 0.80730116, 'specificity': 0.80730116, 'f1': 0.7530614, 'auroc': 0.9069487, 'binary_precision': 0.46689597, 'binary_recall': 0.6813049, 'binary_specificity': 0.93329746, 'binary_f1_score': 0.5540816}
confusion matrix:
      0    1
0  8675  620
1   254  543
oracle model performance metric: 

scalar performance:
{'acc': 0.9273682, 'precision': 0.75680304, 'recall': 0.65486264, 'specificity': 0.65486264, 'f1': 0.6899897, 'auroc': 0.88719904, 'binary_precision': 0.5689655, 'binary_recall': 0.33124214, 'binary_specificity': 0.9784831, 'binary_f1_score': 0.4187153}
confusion matrix:
      0    1
0  9095  200
1   533  264
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |  40858 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  41672 MiB |  27200 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  41570 MiB |  27164 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool | 455249 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |  10843 KiB |     42 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7467    |  329277 K  |  329272 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158241 K  |
|       from small pool |    4735    |    7278    |  171035 K  |  171030 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7467    |  329277 K  |  329272 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158241 K  |
|       from small pool |    4735    |    7278    |  171035 K  |  171030 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1783    |    1148    |
|       from large pool |     602    |     602    |    1732    |    1130    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3293    |  193384 K  |  193384 K  |
|       from large pool |      36    |     605    |  110448 K  |  110448 K  |
|       from small pool |      39    |    3257    |   82935 K  |   82935 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |      0 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  41672 MiB |  40770 MiB |
|       from large pool |    850 MiB |  14412 MiB |  41570 MiB |  40720 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool |  24320 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |      0 KiB |     46 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7467    |  329277 K  |  329277 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171035 K  |  171035 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7467    |  329277 K  |  329277 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171035 K  |  171035 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1783    |    1719    |
|       from large pool |      38    |     602    |    1732    |    1694    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3293    |  193386 K  |  193386 K  |
|       from large pool |       3    |     605    |  110448 K  |  110448 K  |
|       from small pool |       0    |    3257    |   82937 K  |   82937 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug  6 22:15:06 2024]
Finished job 0.
1 of 1 steps (100%) done
