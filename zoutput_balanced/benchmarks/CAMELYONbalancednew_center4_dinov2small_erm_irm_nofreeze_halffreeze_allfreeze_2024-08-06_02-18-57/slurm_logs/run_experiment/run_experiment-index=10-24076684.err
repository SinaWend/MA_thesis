Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Aug  7 00:44:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684

 Experiment start at: 2024-08-07 00:56:08.697726
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8641227, 'precision': 0.8708545, 'recall': 0.86415994, 'specificity': 0.86415994, 'f1': 0.8635118, 'auroc': 0.91950166, 'binary_precision': 0.9209578, 'binary_recall': 0.79678005, 'binary_specificity': 0.93153983, 'binary_f1_score': 0.8543804}
confusion matrix:
       0      1
0  23581   1733
1   5150  20192
---- Validation: 
scalar performance:
{'acc': 0.8789222, 'precision': 0.5262624, 'recall': 0.61132765, 'specificity': 0.61132765, 'f1': 0.5258015, 'auroc': 0.7435504, 'binary_precision': 0.070801035, 'binary_recall': 0.33012047, 'binary_specificity': 0.8925348, 'binary_f1_score': 0.116595745}
confusion matrix:
       0     1
0  14933  1798
1    278   137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77832705, 'precision': 0.52035093, 'recall': 0.54371727, 'specificity': 0.54371727, 'f1': 0.51383126, 'auroc': 0.65733135, 'binary_precision': 0.10945802, 'binary_recall': 0.26683939, 'binary_specificity': 0.82059515, 'binary_f1_score': 0.15523738}
confusion matrix:
      0     1
0  7666  1676
1   566   206
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 01:16:03.692170,epoch time: 0:19:54.994444,used: 0:19:54.994444,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90703964, 'precision': 0.9141742, 'recall': 0.90708375, 'specificity': 0.90708375, 'f1': 0.9066441, 'auroc': 0.9617797, 'binary_precision': 0.9687017, 'binary_recall': 0.8413888, 'binary_specificity': 0.9727786, 'binary_f1_score': 0.90056795}
confusion matrix:
       0      1
0  24622    689
1   4020  21325
---- Validation: 
scalar performance:
{'acc': 0.865333, 'precision': 0.5361411, 'recall': 0.6772105, 'specificity': 0.6772105, 'f1': 0.53696096, 'auroc': 0.79519105, 'binary_precision': 0.08682373, 'binary_recall': 0.4795181, 'binary_specificity': 0.8749029, 'binary_f1_score': 0.14702623}
confusion matrix:
       0     1
0  14638  2093
1    216   199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7646826, 'precision': 0.555737, 'recall': 0.64208937, 'specificity': 0.64208937, 'f1': 0.55231005, 'auroc': 0.7335465, 'binary_precision': 0.16161616, 'binary_recall': 0.4974093, 'binary_specificity': 0.78676945, 'binary_f1_score': 0.2439644}
confusion matrix:
      0     1
0  7350  1992
1   388   384
early stop counter: 1
val acc:0.8653330206871033, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.7783270478248596
after epoch: 2,now: 2024-08-07 01:34:23.141943,epoch time: 0:18:19.449773,used: 0:38:14.444217,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9215098, 'precision': 0.92643726, 'recall': 0.9215374, 'specificity': 0.9215374, 'f1': 0.92128587, 'auroc': 0.9724287, 'binary_precision': 0.97240525, 'binary_recall': 0.86772424, 'binary_specificity': 0.97535056, 'binary_f1_score': 0.9170872}
confusion matrix:
       0      1
0  24691    624
1   3352  21989
---- Validation: 
scalar performance:
{'acc': 0.8492943, 'precision': 0.5428004, 'recall': 0.73948824, 'specificity': 0.73948824, 'f1': 0.542071, 'auroc': 0.82945, 'binary_precision': 0.096390024, 'binary_recall': 0.6240964, 'binary_specificity': 0.85488015, 'binary_f1_score': 0.16698904}
confusion matrix:
       0     1
0  14303  2428
1    156   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74569905, 'precision': 0.5740517, 'recall': 0.712023, 'specificity': 0.712023, 'f1': 0.56638134, 'auroc': 0.7743721, 'binary_precision': 0.18287526, 'binary_recall': 0.6722798, 'binary_specificity': 0.7517662, 'binary_f1_score': 0.28753462}
confusion matrix:
      0     1
0  7023  2319
1   253   519
early stop counter: 2
val acc:0.8492943048477173, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.7783270478248596
after epoch: 3,now: 2024-08-07 01:53:00.316899,epoch time: 0:18:37.174956,used: 0:56:51.619173,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9330188, 'precision': 0.9370078, 'recall': 0.93304145, 'specificity': 0.93304145, 'f1': 0.932868, 'auroc': 0.9791125, 'binary_precision': 0.97887844, 'binary_recall': 0.8852013, 'binary_specificity': 0.98088163, 'binary_f1_score': 0.929686}
confusion matrix:
       0      1
0  24832    484
1   2909  22431
---- Validation: 
scalar performance:
{'acc': 0.86043394, 'precision': 0.5524006, 'recall': 0.7816192, 'specificity': 0.7816192, 'f1': 0.55934095, 'auroc': 0.8554439, 'binary_precision': 0.11336982, 'binary_recall': 0.6987952, 'binary_specificity': 0.86444324, 'binary_f1_score': 0.19508913}
confusion matrix:
       0     1
0  14463  2268
1    125   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7631006, 'precision': 0.5850675, 'recall': 0.7368907, 'specificity': 0.7368907, 'f1': 0.5847831, 'auroc': 0.8062526, 'binary_precision': 0.20081061, 'binary_recall': 0.70595855, 'binary_specificity': 0.76782274, 'binary_f1_score': 0.3126793}
confusion matrix:
      0     1
0  7173  2169
1   227   545
early stop counter: 3
val acc:0.8604339361190796, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.7783270478248596
after epoch: 4,now: 2024-08-07 02:11:22.534569,epoch time: 0:18:22.217670,used: 1:15:13.836843,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93896085, 'precision': 0.94157445, 'recall': 0.9389867, 'specificity': 0.9389867, 'f1': 0.9388728, 'auroc': 0.98195446, 'binary_precision': 0.9757151, 'binary_recall': 0.9004143, 'binary_specificity': 0.97755915, 'binary_f1_score': 0.9365536}
confusion matrix:
       0      1
0  24743    568
1   2524  22821
---- Validation: 
scalar performance:
{'acc': 0.84352034, 'precision': 0.5503289, 'recall': 0.7988012, 'specificity': 0.7988012, 'f1': 0.5510502, 'auroc': 0.8729007, 'binary_precision': 0.10788382, 'binary_recall': 0.7518072, 'binary_specificity': 0.8457952, 'binary_f1_score': 0.18869066}
confusion matrix:
       0     1
0  14151  2580
1    103   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7567728, 'precision': 0.5904686, 'recall': 0.760796, 'specificity': 0.760796, 'f1': 0.58811456, 'auroc': 0.827132, 'binary_precision': 0.20592335, 'binary_recall': 0.76554406, 'binary_specificity': 0.75604796, 'binary_f1_score': 0.32454696}
confusion matrix:
      0     1
0  7063  2279
1   181   591
early stop counter: 4
val acc:0.8435203433036804, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.7783270478248596
after epoch: 5,now: 2024-08-07 02:29:41.995197,epoch time: 0:18:19.460628,used: 1:33:33.297471,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9431065, 'precision': 0.9458583, 'recall': 0.9431282, 'specificity': 0.9431282, 'f1': 0.94302046, 'auroc': 0.9847982, 'binary_precision': 0.98102456, 'binary_recall': 0.9037566, 'binary_specificity': 0.9824998, 'binary_f1_score': 0.9408068}
confusion matrix:
       0      1
0  24871    443
1   2439  22903
---- Validation: 
scalar performance:
{'acc': 0.8516855, 'precision': 0.5539794, 'recall': 0.8088597, 'specificity': 0.8088597, 'f1': 0.55891514, 'auroc': 0.87932765, 'binary_precision': 0.1147719, 'binary_recall': 0.7638554, 'binary_specificity': 0.8538641, 'binary_f1_score': 0.19955932}
confusion matrix:
       0     1
0  14286  2445
1     98   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7716037, 'precision': 0.5969043, 'recall': 0.7706067, 'specificity': 0.7706067, 'f1': 0.6007737, 'auroc': 0.838227, 'binary_precision': 0.21790169, 'binary_recall': 0.76943004, 'binary_specificity': 0.77178335, 'binary_f1_score': 0.33962262}
confusion matrix:
      0     1
0  7210  2132
1   178   594
early stop counter: 5
val acc:0.8516855239868164, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.7783270478248596
after epoch: 6,now: 2024-08-07 02:48:13.202806,epoch time: 0:18:31.207609,used: 1:52:04.505080,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9513187, 'precision': 0.95271933, 'recall': 0.9513363, 'specificity': 0.9513363, 'f1': 0.9512823, 'auroc': 0.98674965, 'binary_precision': 0.9780592, 'binary_recall': 0.9234138, 'binary_specificity': 0.97925884, 'binary_f1_score': 0.9499513}
confusion matrix:
       0      1
0  24787    525
1   1941  23403
---- Validation: 
scalar performance:
{'acc': 0.83605504, 'precision': 0.55146515, 'recall': 0.81964964, 'specificity': 0.81964964, 'f1': 0.55016136, 'auroc': 0.88741916, 'binary_precision': 0.10875245, 'binary_recall': 0.80240965, 'binary_specificity': 0.8368896, 'binary_f1_score': 0.19154444}
confusion matrix:
       0     1
0  14002  2729
1     82   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76596797, 'precision': 0.5985762, 'recall': 0.7818155, 'specificity': 0.7818155, 'f1': 0.6003358, 'auroc': 0.851031, 'binary_precision': 0.21829742, 'binary_recall': 0.80051816, 'binary_specificity': 0.76311284, 'binary_f1_score': 0.34304747}
confusion matrix:
      0     1
0  7129  2213
1   154   618
early stop counter: 6
val acc:0.8360550403594971, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.7783270478248596
after epoch: 7,now: 2024-08-07 03:06:31.292721,epoch time: 0:18:18.089915,used: 2:10:22.594995,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95230573, 'precision': 0.9535964, 'recall': 0.95231736, 'specificity': 0.95231736, 'f1': 0.95227265, 'auroc': 0.9870753, 'binary_precision': 0.97790104, 'binary_recall': 0.9255693, 'binary_specificity': 0.9790655, 'binary_f1_score': 0.95101583}
confusion matrix:
       0      1
0  24787    530
1   1886  23453
---- Validation: 
scalar performance:
{'acc': 0.84812784, 'precision': 0.5554498, 'recall': 0.8258357, 'specificity': 0.8258357, 'f1': 0.55986464, 'auroc': 0.89351, 'binary_precision': 0.116637476, 'binary_recall': 0.80240965, 'binary_specificity': 0.8492618, 'binary_f1_score': 0.20366973}
confusion matrix:
       0     1
0  14209  2522
1     82   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78633577, 'precision': 0.6051133, 'recall': 0.7845229, 'specificity': 0.7845229, 'f1': 0.61519134, 'auroc': 0.8572904, 'binary_precision': 0.23257604, 'binary_recall': 0.78238344, 'binary_specificity': 0.7866624, 'binary_f1_score': 0.35856336}
confusion matrix:
      0     1
0  7349  1993
1   168   604
new oracle model saved
early stop counter: 7
val acc:0.8481278419494629, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.7863357663154602
after epoch: 8,now: 2024-08-07 03:24:53.989920,epoch time: 0:18:22.697199,used: 2:28:45.292194,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9548129, 'precision': 0.9559725, 'recall': 0.9548299, 'specificity': 0.9548299, 'f1': 0.9547853, 'auroc': 0.9883933, 'binary_precision': 0.9791355, 'binary_recall': 0.929493, 'binary_specificity': 0.98016673, 'binary_f1_score': 0.9536687}
confusion matrix:
       0      1
0  24809    502
1   1787  23558
---- Validation: 
scalar performance:
{'acc': 0.859909, 'precision': 0.55905133, 'recall': 0.82599777, 'specificity': 0.82599777, 'f1': 0.56880796, 'auroc': 0.89726055, 'binary_precision': 0.1241014, 'binary_recall': 0.79036146, 'binary_specificity': 0.8616341, 'binary_f1_score': 0.21451929}
confusion matrix:
       0     1
0  14416  2315
1     87   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8072968, 'precision': 0.6144293, 'recall': 0.79111636, 'specificity': 0.79111636, 'f1': 0.63271683, 'auroc': 0.8648393, 'binary_precision': 0.25158295, 'binary_recall': 0.7720207, 'binary_specificity': 0.81021196, 'binary_f1_score': 0.37949696}
confusion matrix:
      0     1
0  7569  1773
1   176   596
new oracle model saved
early stop counter: 8
val acc:0.8599089980125427, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.8072968125343323
after epoch: 9,now: 2024-08-07 03:43:14.567671,epoch time: 0:18:20.577751,used: 2:47:05.869945,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9579912, 'precision': 0.9586178, 'recall': 0.95800364, 'specificity': 0.95800364, 'f1': 0.95797765, 'auroc': 0.9896752, 'binary_precision': 0.9757387, 'binary_recall': 0.9393963, 'binary_specificity': 0.97661096, 'binary_f1_score': 0.9572227}
confusion matrix:
       0      1
0  24719    592
1   1536  23809
---- Validation: 
scalar performance:
{'acc': 0.85145223, 'precision': 0.55664927, 'recall': 0.8275392, 'specificity': 0.8275392, 'f1': 0.5626653, 'auroc': 0.9003581, 'binary_precision': 0.11901358, 'binary_recall': 0.80240965, 'binary_specificity': 0.8526687, 'binary_f1_score': 0.20728292}
confusion matrix:
       0     1
0  14266  2465
1     82   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80442953, 'precision': 0.61386305, 'recall': 0.7931291, 'specificity': 0.7931291, 'f1': 0.6311697, 'auroc': 0.86853456, 'binary_precision': 0.24979253, 'binary_recall': 0.7797927, 'binary_specificity': 0.80646545, 'binary_f1_score': 0.3783784}
confusion matrix:
      0     1
0  7534  1808
1   170   602
early stop counter: 9
val acc:0.8514522314071655, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.8072968125343323
after epoch: 10,now: 2024-08-07 04:01:35.037282,epoch time: 0:18:20.469611,used: 3:05:26.339556,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.957774, 'precision': 0.9592177, 'recall': 0.9577907, 'specificity': 0.9577907, 'f1': 0.95774186, 'auroc': 0.99011385, 'binary_precision': 0.9851146, 'binary_recall': 0.92964524, 'binary_specificity': 0.9859361, 'binary_f1_score': 0.9565764}
confusion matrix:
       0      1
0  24957    356
1   1783  23560
---- Validation: 
scalar performance:
{'acc': 0.8772308, 'precision': 0.5664052, 'recall': 0.8313487, 'specificity': 0.8313487, 'f1': 0.58459383, 'auroc': 0.900879, 'binary_precision': 0.1388889, 'binary_recall': 0.78313255, 'binary_specificity': 0.8795649, 'binary_f1_score': 0.23593467}
confusion matrix:
       0     1
0  14716  2015
1     90   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8315207, 'precision': 0.6233041, 'recall': 0.7828399, 'specificity': 0.7828399, 'f1': 0.64934605, 'auroc': 0.86712396, 'binary_precision': 0.2729045, 'binary_recall': 0.7253886, 'binary_specificity': 0.84029114, 'binary_f1_score': 0.39660057}
confusion matrix:
      0     1
0  7850  1492
1   212   560
new oracle model saved
early stop counter: 10
val acc:0.8772308230400085, best validation acc: 0.8789222240447998, corresponding to test acc:                         0.7783270478248596 / 0.831520676612854
after epoch: 11,now: 2024-08-07 04:20:26.191134,epoch time: 0:18:51.153852,used: 3:24:17.493408,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9590769, 'precision': 0.96031606, 'recall': 0.9590924, 'specificity': 0.9590924, 'f1': 0.9590503, 'auroc': 0.9899759, 'binary_precision': 0.9843477, 'binary_recall': 0.9330387, 'binary_specificity': 0.985146, 'binary_f1_score': 0.9580067}
confusion matrix:
       0      1
0  24937    376
1   1697  23646
---- Validation: 
scalar performance:
{'acc': 0.88883704, 'precision': 0.5725084, 'recall': 0.8349459, 'specificity': 0.8349459, 'f1': 0.5965422, 'auroc': 0.903628, 'binary_precision': 0.15114647, 'binary_recall': 0.7783133, 'binary_specificity': 0.8915785, 'binary_f1_score': 0.2531348}
confusion matrix:
       0     1
0  14917  1814
1     92   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8504054, 'precision': 0.6303442, 'recall': 0.7675142, 'specificity': 0.7675142, 'f1': 0.66019785, 'auroc': 0.8655729, 'binary_precision': 0.2912676, 'binary_recall': 0.6696891, 'binary_specificity': 0.86533934, 'binary_f1_score': 0.40596783}
confusion matrix:
      0     1
0  8084  1258
1   255   517
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-07 04:38:43.404000,epoch time: 0:18:17.212866,used: 3:42:34.706274,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9617222, 'precision': 0.96237826, 'recall': 0.9617334, 'specificity': 0.9617334, 'f1': 0.96170926, 'auroc': 0.99128056, 'binary_precision': 0.9799442, 'binary_recall': 0.94278497, 'binary_specificity': 0.98068184, 'binary_f1_score': 0.9610055}
confusion matrix:
       0      1
0  24824    489
1   1450  23893
---- Validation: 
scalar performance:
{'acc': 0.8684241, 'precision': 0.5637934, 'recall': 0.83741057, 'specificity': 0.83741057, 'f1': 0.57826686, 'auroc': 0.9076833, 'binary_precision': 0.13312076, 'binary_recall': 0.8048193, 'binary_specificity': 0.8700018, 'binary_f1_score': 0.22845417}
confusion matrix:
       0     1
0  14556  2175
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8360688, 'precision': 0.6263391, 'recall': 0.7847077, 'specificity': 0.7847077, 'f1': 0.6538671, 'auroc': 0.8686403, 'binary_precision': 0.2789421, 'binary_recall': 0.72409326, 'binary_specificity': 0.8453222, 'binary_f1_score': 0.40273777}
confusion matrix:
      0     1
0  7897  1445
1   213   559
early stop counter: 1
val acc:0.868424117565155, best validation acc: 0.8888370394706726, corresponding to test acc:                         0.8504053950309753 / 0.8504053950309753
after epoch: 13,now: 2024-08-07 04:57:02.905970,epoch time: 0:18:19.501970,used: 4:00:54.208244,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9617419, 'precision': 0.9627861, 'recall': 0.9617561, 'specificity': 0.9617561, 'f1': 0.9617212, 'auroc': 0.99133015, 'binary_precision': 0.9849169, 'binary_recall': 0.93789214, 'binary_specificity': 0.98562, 'binary_f1_score': 0.9608295}
confusion matrix:
       0      1
0  24949    364
1   1574  23769
---- Validation: 
scalar performance:
{'acc': 0.88061357, 'precision': 0.5693168, 'recall': 0.84013164, 'specificity': 0.84013164, 'f1': 0.58977866, 'auroc': 0.9075588, 'binary_precision': 0.14428945, 'binary_recall': 0.7975904, 'binary_specificity': 0.8826729, 'binary_f1_score': 0.24437061}
confusion matrix:
       0     1
0  14768  1963
1     84   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8470437, 'precision': 0.6291093, 'recall': 0.77104175, 'specificity': 0.77104175, 'f1': 0.65850896, 'auroc': 0.86782134, 'binary_precision': 0.28790367, 'binary_recall': 0.68134713, 'binary_specificity': 0.8607364, 'binary_f1_score': 0.40477106}
confusion matrix:
      0     1
0  8041  1301
1   246   526
early stop counter: 2
val acc:0.8806135654449463, best validation acc: 0.8888370394706726, corresponding to test acc:                         0.8504053950309753 / 0.8504053950309753
after epoch: 14,now: 2024-08-07 05:15:17.965983,epoch time: 0:18:15.060013,used: 4:19:09.268257,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9644662, 'precision': 0.96508324, 'recall': 0.9644778, 'specificity': 0.9644778, 'f1': 0.964455, 'auroc': 0.991629, 'binary_precision': 0.9821824, 'binary_recall': 0.9461411, 'binary_specificity': 0.9828145, 'binary_f1_score': 0.9638249}
confusion matrix:
       0      1
0  24877    435
1   1365  23979
---- Validation: 
scalar performance:
{'acc': 0.860084, 'precision': 0.56105036, 'recall': 0.83901167, 'specificity': 0.83901167, 'f1': 0.5717452, 'auroc': 0.90955055, 'binary_precision': 0.12734786, 'binary_recall': 0.8168675, 'binary_specificity': 0.8611559, 'binary_f1_score': 0.2203445}
confusion matrix:
       0     1
0  14408  2323
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83201504, 'precision': 0.6249944, 'recall': 0.78786063, 'specificity': 0.78786063, 'f1': 0.65151125, 'auroc': 0.870216, 'binary_precision': 0.2753272, 'binary_recall': 0.7357513, 'binary_specificity': 0.83997005, 'binary_f1_score': 0.4007055}
confusion matrix:
      0     1
0  7847  1495
1   204   568
early stop counter: 3
val acc:0.8600839972496033, best validation acc: 0.8888370394706726, corresponding to test acc:                         0.8504053950309753 / 0.8504053950309753
after epoch: 15,now: 2024-08-07 05:33:33.849518,epoch time: 0:18:15.883535,used: 4:37:25.151792,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9648413, 'precision': 0.96533084, 'recall': 0.9648516, 'specificity': 0.9648516, 'f1': 0.96483254, 'auroc': 0.9928136, 'binary_precision': 0.9805833, 'binary_recall': 0.9485085, 'binary_specificity': 0.9811947, 'binary_f1_score': 0.9642793}
confusion matrix:
       0      1
0  24836    476
1   1305  24039
---- Validation: 
scalar performance:
{'acc': 0.87752247, 'precision': 0.56860614, 'recall': 0.8444224, 'specificity': 0.8444224, 'f1': 0.5878999, 'auroc': 0.91162324, 'binary_precision': 0.14255409, 'binary_recall': 0.80963856, 'binary_specificity': 0.87920624, 'binary_f1_score': 0.24242423}
confusion matrix:
       0     1
0  14710  2021
1     79   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8597983, 'precision': 0.6384109, 'recall': 0.77141047, 'specificity': 0.77141047, 'f1': 0.67049956, 'auroc': 0.8694355, 'binary_precision': 0.30727923, 'binary_recall': 0.66709846, 'binary_specificity': 0.8757225, 'binary_f1_score': 0.42075163}
confusion matrix:
      0     1
0  8181  1161
1   257   515
new oracle model saved
early stop counter: 4
val acc:0.8775224685668945, best validation acc: 0.8888370394706726, corresponding to test acc:                         0.8504053950309753 / 0.8597983121871948
after epoch: 16,now: 2024-08-07 05:52:01.634122,epoch time: 0:18:27.784604,used: 4:55:52.936396,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9672694, 'precision': 0.9677273, 'recall': 0.96727943, 'specificity': 0.96727943, 'f1': 0.9672619, 'auroc': 0.9938272, 'binary_precision': 0.9825212, 'binary_recall': 0.9515073, 'binary_specificity': 0.98305154, 'binary_f1_score': 0.9667656}
confusion matrix:
       0      1
0  24883    429
1   1229  24115
---- Validation: 
scalar performance:
{'acc': 0.87979704, 'precision': 0.5699988, 'recall': 0.84676284, 'specificity': 0.84676284, 'f1': 0.59056234, 'auroc': 0.9129826, 'binary_precision': 0.14525862, 'binary_recall': 0.8120482, 'binary_specificity': 0.8814775, 'binary_f1_score': 0.2464351}
confusion matrix:
       0     1
0  14748  1983
1     78   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622701, 'precision': 0.641458, 'recall': 0.77512515, 'specificity': 0.77512515, 'f1': 0.6743566, 'auroc': 0.8724211, 'binary_precision': 0.31283906, 'binary_recall': 0.6722798, 'binary_specificity': 0.87797046, 'binary_f1_score': 0.42698476}
confusion matrix:
      0     1
0  8202  1140
1   253   519
new oracle model saved
early stop counter: 5
val acc:0.8797970414161682, best validation acc: 0.8888370394706726, corresponding to test acc:                         0.8504053950309753 / 0.8622701168060303
after epoch: 17,now: 2024-08-07 06:10:19.983749,epoch time: 0:18:18.349627,used: 5:14:11.286023,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.967684, 'precision': 0.9683596, 'recall': 0.9676953, 'specificity': 0.9676953, 'f1': 0.9676729, 'auroc': 0.9940063, 'binary_precision': 0.9862969, 'binary_recall': 0.9485854, 'binary_specificity': 0.9868052, 'binary_f1_score': 0.9670736}
confusion matrix:
       0      1
0  24979    334
1   1303  24040
---- Validation: 
scalar performance:
{'acc': 0.8954275, 'precision': 0.5779499, 'recall': 0.84537244, 'specificity': 0.84537244, 'f1': 0.6060754, 'auroc': 0.9126884, 'binary_precision': 0.16159135, 'binary_recall': 0.7927711, 'binary_specificity': 0.89797384, 'binary_f1_score': 0.26846185}
confusion matrix:
       0     1
0  15024  1707
1     86   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87344277, 'precision': 0.6514638, 'recall': 0.7752316, 'specificity': 0.7752316, 'f1': 0.6858026, 'auroc': 0.8731595, 'binary_precision': 0.33355176, 'binary_recall': 0.65932643, 'binary_specificity': 0.8911368, 'binary_f1_score': 0.4429939}
confusion matrix:
      0     1
0  8325  1017
1   263   509
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-08-07 06:28:52.190495,epoch time: 0:18:32.206746,used: 5:32:43.492769,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.968829, 'precision': 0.96921605, 'recall': 0.9688381, 'specificity': 0.9688381, 'f1': 0.96882296, 'auroc': 0.994136, 'binary_precision': 0.9828518, 'binary_recall': 0.95434815, 'binary_specificity': 0.98332804, 'binary_f1_score': 0.9683903}
confusion matrix:
       0      1
0  24890    422
1   1157  24187
---- Validation: 
scalar performance:
{'acc': 0.8965939, 'precision': 0.5783551, 'recall': 0.8436203, 'specificity': 0.8436203, 'f1': 0.60691375, 'auroc': 0.91340744, 'binary_precision': 0.16252485, 'binary_recall': 0.7879518, 'binary_specificity': 0.8992888, 'binary_f1_score': 0.2694685}
confusion matrix:
       0     1
0  15046  1685
1     88   327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87265176, 'precision': 0.65172386, 'recall': 0.7789625, 'specificity': 0.7789625, 'f1': 0.6864522, 'auroc': 0.8753524, 'binary_precision': 0.33333334, 'binary_recall': 0.6683938, 'binary_specificity': 0.88953114, 'binary_f1_score': 0.4448276}
confusion matrix:
      0     1
0  8310  1032
1   256   516
better model found
persisted
after epoch: 19,now: 2024-08-07 06:47:05.814734,epoch time: 0:18:13.624239,used: 5:50:57.117008,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9701516, 'precision': 0.97040987, 'recall': 0.9701581, 'specificity': 0.9701581, 'f1': 0.97014785, 'auroc': 0.9942082, 'binary_precision': 0.9815698, 'binary_recall': 0.95833004, 'binary_specificity': 0.9819862, 'binary_f1_score': 0.9698107}
confusion matrix:
       0      1
0  24858    456
1   1056  24286
---- Validation: 
scalar performance:
{'acc': 0.88067186, 'precision': 0.56991243, 'recall': 0.84368634, 'specificity': 0.84368634, 'f1': 0.59066963, 'auroc': 0.91532046, 'binary_precision': 0.14528055, 'binary_recall': 0.8048193, 'binary_specificity': 0.88255334, 'binary_f1_score': 0.24613117}
confusion matrix:
       0     1
0  14766  1965
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86800474, 'precision': 0.6477207, 'recall': 0.78001183, 'specificity': 0.78001183, 'f1': 0.68202287, 'auroc': 0.87654734, 'binary_precision': 0.32482886, 'binary_recall': 0.6761658, 'binary_specificity': 0.88385785, 'binary_f1_score': 0.43883982}
confusion matrix:
      0     1
0  8257  1085
1   250   522
early stop counter: 1
val acc:0.8806718587875366, best validation acc: 0.8965939283370972, corresponding to test acc:                         0.8726517558097839 / 0.8734427690505981
after epoch: 20,now: 2024-08-07 07:05:22.097696,epoch time: 0:18:16.282962,used: 6:09:13.399970,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_00_56_08_seed_0_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:09:13.399970 at 2024-08-07 07:05:22.097696
persisted model performance metric: 

scalar performance:
{'acc': 0.87265176, 'precision': 0.65172386, 'recall': 0.7789625, 'specificity': 0.7789625, 'f1': 0.6864522, 'auroc': 0.8753524, 'binary_precision': 0.33333334, 'binary_recall': 0.6683938, 'binary_specificity': 0.88953114, 'binary_f1_score': 0.4448276}
confusion matrix:
      0     1
0  8310  1032
1   256   516
oracle model performance metric: 

scalar performance:
{'acc': 0.87344277, 'precision': 0.6514638, 'recall': 0.7752316, 'specificity': 0.7752316, 'f1': 0.6858026, 'auroc': 0.8731595, 'binary_precision': 0.33355176, 'binary_recall': 0.65932643, 'binary_specificity': 0.8911368, 'binary_f1_score': 0.4429939}
confusion matrix:
      0     1
0  8325  1017
1   263   509
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   7828 MiB | 490155 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   7828 MiB | 490155 GiB | 490154 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |  16663 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8528 MiB |   8528 MiB |   8528 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59172 KiB | 732464 KiB | 276938 GiB | 276938 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |   8410 KiB |  10852 KiB |   7464 GiB |   7464 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6827    |   92215 K  |   92210 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46590 K  |   46585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6827    |   92215 K  |   92210 K  |
|       from large pool |      79    |     762    |   45624 K  |   45624 K  |
|       from small pool |    4345    |    6746    |   46590 K  |   46585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     370    |     370    |     370    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3190    |   54265 K  |   54265 K  |
|       from large pool |      10    |     350    |   34657 K  |   34657 K  |
|       from small pool |      21    |    3180    |   19608 K  |   19608 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8528 MiB |   8528 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     42 MiB |     42 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276938 GiB | 276938 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |      0 KiB |  22549 KiB |   7464 GiB |   7464 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92215 K  |   92215 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46590 K  |   46590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92215 K  |   92215 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46590 K  |   46590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     370    |     370    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   54267 K  |   54267 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3180    |   19610 K  |   19610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482694 GiB | 482694 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490128 GiB | 490128 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8528 MiB |   8528 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     42 MiB |     42 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276938 GiB | 276938 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269473 GiB | 269473 GiB |
|       from small pool |      0 KiB |  22549 KiB |   7464 GiB |   7464 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92215 K  |   92215 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46590 K  |   46590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92215 K  |   92215 K  |
|       from large pool |       2    |     762    |   45624 K  |   45624 K  |
|       from small pool |       0    |    6746    |   46590 K  |   46590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     370    |     370    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   54267 K  |   54267 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3180    |   19610 K  |   19610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684

 Experiment start at: 2024-08-07 07:29:45.489579
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8261725, 'precision': 0.82722795, 'recall': 0.8261937, 'specificity': 0.8261937, 'f1': 0.8260386, 'auroc': 0.89737594, 'binary_precision': 0.8459999, 'binary_recall': 0.7978376, 'binary_specificity': 0.85454977, 'binary_f1_score': 0.82121325}
confusion matrix:
       0      1
0  21703   3694
1   5142  20293
---- Validation: 
scalar performance:
{'acc': 0.8813292, 'precision': 0.50172853, 'recall': 0.50628954, 'specificity': 0.50628954, 'f1': 0.49092308, 'auroc': 0.72588205, 'binary_precision': 0.02828521, 'binary_recall': 0.11136891, 'binary_specificity': 0.9012102, 'binary_f1_score': 0.045112785}
confusion matrix:
       0     1
0  15043  1649
1    383    48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.794173, 'precision': 0.49355936, 'recall': 0.4881634, 'specificity': 0.4881634, 'f1': 0.4847313, 'auroc': 0.64396805, 'binary_precision': 0.06406869, 'binary_recall': 0.12813738, 'binary_specificity': 0.8481894, 'binary_f1_score': 0.08542492}
confusion matrix:
      0     1
0  7917  1417
1   660    97
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 07:49:10.348970,epoch time: 0:19:24.859391,used: 0:19:24.859391,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88288873, 'precision': 0.88645124, 'recall': 0.8829247, 'specificity': 0.8829247, 'f1': 0.8826251, 'auroc': 0.9400816, 'binary_precision': 0.92374283, 'binary_recall': 0.8348732, 'binary_specificity': 0.9309761, 'binary_f1_score': 0.87706256}
confusion matrix:
       0      1
0  23644   1753
1   4200  21235
---- Validation: 
scalar performance:
{'acc': 0.8979735, 'precision': 0.5158841, 'recall': 0.550991, 'specificity': 0.550991, 'f1': 0.51493996, 'auroc': 0.77734435, 'binary_precision': 0.05420054, 'binary_recall': 0.18561485, 'binary_specificity': 0.9163671, 'binary_f1_score': 0.08390142}
confusion matrix:
       0     1
0  15296  1396
1    351    80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171638, 'precision': 0.51166385, 'recall': 0.5194061, 'specificity': 0.5194061, 'f1': 0.509903, 'auroc': 0.7019619, 'binary_precision': 0.0952381, 'binary_recall': 0.16908851, 'binary_specificity': 0.8697236, 'binary_f1_score': 0.12184674}
confusion matrix:
      0     1
0  8118  1216
1   629   128
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 08:07:48.922204,epoch time: 0:18:38.573234,used: 0:38:03.432625,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.902522, 'precision': 0.9079392, 'recall': 0.9025697, 'specificity': 0.9025697, 'f1': 0.9022049, 'auroc': 0.9598732, 'binary_precision': 0.95515555, 'binary_recall': 0.84487164, 'binary_specificity': 0.9602678, 'binary_f1_score': 0.8966352}
confusion matrix:
       0      1
0  24386   1009
1   3946  21491
---- Validation: 
scalar performance:
{'acc': 0.9114641, 'precision': 0.5367903, 'recall': 0.6076366, 'specificity': 0.6076366, 'f1': 0.5469588, 'auroc': 0.8083522, 'binary_precision': 0.093023255, 'binary_recall': 0.287703, 'binary_specificity': 0.9275701, 'binary_f1_score': 0.14058957}
confusion matrix:
       0     1
0  15483  1209
1    307   124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8378753, 'precision': 0.5539924, 'recall': 0.58886737, 'specificity': 0.58886737, 'f1': 0.5622873, 'auroc': 0.7605897, 'binary_precision': 0.16880181, 'binary_recall': 0.29590487, 'binary_specificity': 0.88182986, 'binary_f1_score': 0.21497121}
confusion matrix:
      0     1
0  8231  1103
1   533   224
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 08:26:22.374535,epoch time: 0:18:33.452331,used: 0:56:36.884956,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9193815, 'precision': 0.9234425, 'recall': 0.9194143, 'specificity': 0.9194143, 'f1': 0.91919196, 'auroc': 0.9708737, 'binary_precision': 0.96507823, 'binary_recall': 0.87036526, 'binary_specificity': 0.9684633, 'binary_f1_score': 0.9152781}
confusion matrix:
       0      1
0  24598    801
1   3297  22136
---- Validation: 
scalar performance:
{'acc': 0.91473454, 'precision': 0.5556226, 'recall': 0.66808116, 'specificity': 0.66808116, 'f1': 0.574623, 'auroc': 0.8282281, 'binary_precision': 0.12744388, 'binary_recall': 0.40835267, 'binary_specificity': 0.9278097, 'binary_f1_score': 0.1942605}
confusion matrix:
       0     1
0  15487  1205
1    255   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8393618, 'precision': 0.5847695, 'recall': 0.65764755, 'specificity': 0.65764755, 'f1': 0.60122573, 'auroc': 0.8007778, 'binary_precision': 0.21875, 'binary_recall': 0.44385734, 'binary_specificity': 0.8714377, 'binary_f1_score': 0.29306585}
confusion matrix:
      0     1
0  8134  1200
1   421   336
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 08:46:21.877040,epoch time: 0:19:59.502505,used: 1:16:36.387461,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9285686, 'precision': 0.93185407, 'recall': 0.92860997, 'specificity': 0.92860997, 'f1': 0.9284371, 'auroc': 0.9772974, 'binary_precision': 0.96975833, 'binary_recall': 0.88486636, 'binary_specificity': 0.9723535, 'binary_f1_score': 0.9253694}
confusion matrix:
       0      1
0  24690    702
1   2929  22511
---- Validation: 
scalar performance:
{'acc': 0.9231443, 'precision': 0.5714206, 'recall': 0.7029084, 'specificity': 0.7029084, 'f1': 0.59765494, 'auroc': 0.8443395, 'binary_precision': 0.15724245, 'binary_recall': 0.4709977, 'binary_specificity': 0.9348191, 'binary_f1_score': 0.23577236}
confusion matrix:
       0     1
0  15604  1088
1    228   203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8442176, 'precision': 0.60319936, 'recall': 0.70033, 'specificity': 0.70033, 'f1': 0.6250495, 'auroc': 0.8239603, 'binary_precision': 0.24830142, 'binary_recall': 0.5310436, 'binary_specificity': 0.86961645, 'binary_f1_score': 0.3383838}
confusion matrix:
      0     1
0  8117  1217
1   355   402
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 09:05:19.106320,epoch time: 0:18:57.229280,used: 1:35:33.616741,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9371852, 'precision': 0.9404974, 'recall': 0.93722117, 'specificity': 0.93722117, 'f1': 0.9370705, 'auroc': 0.9812088, 'binary_precision': 0.97890115, 'binary_recall': 0.8937375, 'binary_specificity': 0.98070484, 'binary_f1_score': 0.9343828}
confusion matrix:
       0      1
0  24905    490
1   2703  22734
---- Validation: 
scalar performance:
{'acc': 0.937803, 'precision': 0.5927439, 'recall': 0.7183379, 'specificity': 0.7183379, 'f1': 0.62516004, 'auroc': 0.8552281, 'binary_precision': 0.19924098, 'binary_recall': 0.48723897, 'binary_specificity': 0.94943684, 'binary_f1_score': 0.2828283}
confusion matrix:
       0    1
0  15848  844
1    221  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8539292, 'precision': 0.619293, 'recall': 0.7292501, 'specificity': 0.7292501, 'f1': 0.64583755, 'auroc': 0.84385335, 'binary_precision': 0.27579737, 'binary_recall': 0.58256274, 'binary_specificity': 0.87593746, 'binary_f1_score': 0.3743633}
confusion matrix:
      0     1
0  8176  1158
1   316   441
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 09:24:14.916804,epoch time: 0:18:55.810484,used: 1:54:29.427225,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9439133, 'precision': 0.945729, 'recall': 0.9439385, 'specificity': 0.9439385, 'f1': 0.94385827, 'auroc': 0.98492396, 'binary_precision': 0.9743751, 'binary_recall': 0.9118965, 'binary_specificity': 0.97598046, 'binary_f1_score': 0.94210106}
confusion matrix:
       0      1
0  24786    610
1   2241  23195
---- Validation: 
scalar performance:
{'acc': 0.9369853, 'precision': 0.5972204, 'recall': 0.7393912, 'specificity': 0.7393912, 'f1': 0.63249755, 'auroc': 0.86254954, 'binary_precision': 0.20705244, 'binary_recall': 0.5313225, 'binary_specificity': 0.9474599, 'binary_f1_score': 0.29798305}
confusion matrix:
       0    1
0  15815  877
1    202  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85828954, 'precision': 0.6314974, 'recall': 0.7583122, 'specificity': 0.7583122, 'f1': 0.6618742, 'auroc': 0.85838294, 'binary_precision': 0.29519174, 'binary_recall': 0.6406869, 'binary_specificity': 0.87593746, 'binary_f1_score': 0.4041667}
confusion matrix:
      0     1
0  8176  1158
1   272   485
new oracle model saved
early stop counter: 1
val acc:0.9369853138923645, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.8539292216300964 / 0.8582895398139954
after epoch: 7,now: 2024-08-07 09:43:21.275476,epoch time: 0:19:06.358672,used: 2:13:35.785897,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9467855, 'precision': 0.94839793, 'recall': 0.9468092, 'specificity': 0.9468092, 'f1': 0.94673955, 'auroc': 0.9863347, 'binary_precision': 0.97548425, 'binary_recall': 0.91669285, 'binary_specificity': 0.9769255, 'binary_f1_score': 0.94517523}
confusion matrix:
       0      1
0  24810    586
1   2119  23317
---- Validation: 
scalar performance:
{'acc': 0.9361677, 'precision': 0.5988182, 'recall': 0.7502732, 'specificity': 0.7502732, 'f1': 0.6354071, 'auroc': 0.86858225, 'binary_precision': 0.20964912, 'binary_recall': 0.55452436, 'binary_specificity': 0.94602203, 'binary_f1_score': 0.30426478}
confusion matrix:
       0    1
0  15791  901
1    192  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85293823, 'precision': 0.6339403, 'recall': 0.78030384, 'specificity': 0.78030384, 'f1': 0.6653641, 'auroc': 0.86592674, 'binary_precision': 0.29567173, 'binary_recall': 0.69484806, 'binary_specificity': 0.8657596, 'binary_f1_score': 0.4148265}
confusion matrix:
      0     1
0  8081  1253
1   231   526
early stop counter: 2
val acc:0.9361677169799805, best validation acc: 0.9378029704093933, corresponding to test acc:                         0.8539292216300964 / 0.8582895398139954
after epoch: 8,now: 2024-08-07 10:02:09.521103,epoch time: 0:18:48.245627,used: 2:32:24.031524,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9519397, 'precision': 0.95326054, 'recall': 0.95196104, 'specificity': 0.95196104, 'f1': 0.95190626, 'auroc': 0.98847294, 'binary_precision': 0.9779256, 'binary_recall': 0.924831, 'binary_specificity': 0.97909117, 'binary_f1_score': 0.9506375}
confusion matrix:
       0      1
0  24865    531
1   1912  23524
---- Validation: 
scalar performance:
{'acc': 0.93850374, 'precision': 0.6009032, 'recall': 0.74469054, 'specificity': 0.74469054, 'f1': 0.63730276, 'auroc': 0.86958325, 'binary_precision': 0.2141544, 'binary_recall': 0.5406032, 'binary_specificity': 0.94877785, 'binary_f1_score': 0.30678076}
confusion matrix:
       0    1
0  15837  855
1    198  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85323554, 'precision': 0.6365746, 'recall': 0.78896165, 'specificity': 0.78896165, 'f1': 0.6688314, 'auroc': 0.8705174, 'binary_precision': 0.29933482, 'binary_recall': 0.71334213, 'binary_specificity': 0.8645811, 'binary_f1_score': 0.42171028}
confusion matrix:
      0     1
0  8070  1264
1   217   540
better model found
persisted
after epoch: 9,now: 2024-08-07 10:20:48.170522,epoch time: 0:18:38.649419,used: 2:51:02.680943,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95154625, 'precision': 0.95305544, 'recall': 0.9515668, 'specificity': 0.9515668, 'f1': 0.95150745, 'auroc': 0.9882314, 'binary_precision': 0.97938144, 'binary_recall': 0.92258394, 'binary_specificity': 0.98054963, 'binary_f1_score': 0.95013463}
confusion matrix:
       0      1
0  24904    494
1   1969  23465
---- Validation: 
scalar performance:
{'acc': 0.93628454, 'precision': 0.60181296, 'recall': 0.76163447, 'specificity': 0.76163447, 'f1': 0.6399984, 'auroc': 0.87126416, 'binary_precision': 0.2150259, 'binary_recall': 0.57772624, 'binary_specificity': 0.94554275, 'binary_f1_score': 0.31340465}
confusion matrix:
       0    1
0  15783  909
1    182  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84837973, 'precision': 0.63933957, 'recall': 0.8112211, 'specificity': 0.8112211, 'f1': 0.6720854, 'auroc': 0.8784287, 'binary_precision': 0.3002584, 'binary_recall': 0.7675033, 'binary_specificity': 0.8549389, 'binary_f1_score': 0.43164936}
confusion matrix:
      0     1
0  7980  1354
1   176   581
early stop counter: 1
val acc:0.9362845420837402, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8582895398139954
after epoch: 10,now: 2024-08-07 10:40:04.713666,epoch time: 0:19:16.543144,used: 3:10:19.224087,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9560316, 'precision': 0.9570334, 'recall': 0.95605016, 'specificity': 0.95605016, 'f1': 0.9560088, 'auroc': 0.98993075, 'binary_precision': 0.97862774, 'binary_recall': 0.93249726, 'binary_specificity': 0.9796031, 'binary_f1_score': 0.95500576}
confusion matrix:
       0      1
0  24878    518
1   1717  23719
---- Validation: 
scalar performance:
{'acc': 0.93850374, 'precision': 0.6063057, 'recall': 0.7661632, 'specificity': 0.7661632, 'f1': 0.64574337, 'auroc': 0.8771994, 'binary_precision': 0.22380106, 'binary_recall': 0.58468676, 'binary_specificity': 0.9476396, 'binary_f1_score': 0.3236994}
confusion matrix:
       0    1
0  15818  874
1    179  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85303736, 'precision': 0.6410404, 'recall': 0.80584866, 'specificity': 0.80584866, 'f1': 0.6746572, 'auroc': 0.880328, 'binary_precision': 0.30504835, 'binary_recall': 0.75033027, 'binary_specificity': 0.86136705, 'binary_f1_score': 0.43375334}
confusion matrix:
      0     1
0  8040  1294
1   189   568
early stop counter: 2
val acc:0.9385037422180176, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8582895398139954
after epoch: 11,now: 2024-08-07 10:58:54.471682,epoch time: 0:18:49.758016,used: 3:29:08.982103,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95668083, 'precision': 0.9578103, 'recall': 0.9567015, 'specificity': 0.9567015, 'f1': 0.95665544, 'auroc': 0.99060726, 'binary_precision': 0.9807573, 'binary_recall': 0.93171364, 'binary_specificity': 0.98168933, 'binary_f1_score': 0.9556066}
confusion matrix:
       0      1
0  24930    465
1   1737  23700
---- Validation: 
scalar performance:
{'acc': 0.93663496, 'precision': 0.6051034, 'recall': 0.77311563, 'specificity': 0.77311563, 'f1': 0.6449529, 'auroc': 0.8786775, 'binary_precision': 0.22098976, 'binary_recall': 0.60092807, 'binary_specificity': 0.94530314, 'binary_f1_score': 0.3231441}
confusion matrix:
       0    1
0  15779  913
1    172  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8509563, 'precision': 0.6409348, 'recall': 0.81079304, 'specificity': 0.81079304, 'f1': 0.6743758, 'auroc': 0.8843838, 'binary_precision': 0.30373096, 'binary_recall': 0.76354027, 'binary_specificity': 0.8580459, 'binary_f1_score': 0.4345865}
confusion matrix:
      0     1
0  8009  1325
1   179   578
early stop counter: 3
val acc:0.9366349577903748, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8582895398139954
after epoch: 12,now: 2024-08-07 11:17:38.120731,epoch time: 0:18:43.649049,used: 3:47:52.631152,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96006453, 'precision': 0.96088946, 'recall': 0.96008044, 'specificity': 0.96008044, 'f1': 0.9600476, 'auroc': 0.9916766, 'binary_precision': 0.98057574, 'binary_recall': 0.93878514, 'binary_specificity': 0.98137575, 'binary_f1_score': 0.9592255}
confusion matrix:
       0      1
0  24924    473
1   1557  23878
---- Validation: 
scalar performance:
{'acc': 0.9310284, 'precision': 0.6010922, 'recall': 0.7894523, 'specificity': 0.7894523, 'f1': 0.64109945, 'auroc': 0.8805156, 'binary_precision': 0.21198156, 'binary_recall': 0.6403712, 'binary_specificity': 0.9385334, 'binary_f1_score': 0.3185228}
confusion matrix:
       0     1
0  15666  1026
1    155   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8396591, 'precision': 0.6353003, 'recall': 0.81621814, 'specificity': 0.81621814, 'f1': 0.6657299, 'auroc': 0.88301575, 'binary_precision': 0.29051095, 'binary_recall': 0.78863937, 'binary_specificity': 0.84379685, 'binary_f1_score': 0.42460883}
confusion matrix:
      0     1
0  7876  1458
1   160   597
early stop counter: 4
val acc:0.931028425693512, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8582895398139954
after epoch: 13,now: 2024-08-07 11:37:12.187405,epoch time: 0:19:34.066674,used: 4:07:26.697826,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96033996, 'precision': 0.9611601, 'recall': 0.9603583, 'specificity': 0.9603583, 'f1': 0.96032333, 'auroc': 0.99214804, 'binary_precision': 0.9808261, 'binary_recall': 0.9391068, 'binary_specificity': 0.9816098, 'binary_f1_score': 0.9595132}
confusion matrix:
       0      1
0  24927    467
1   1549  23889
---- Validation: 
scalar performance:
{'acc': 0.93161243, 'precision': 0.60166276, 'recall': 0.7886217, 'specificity': 0.7886217, 'f1': 0.64178926, 'auroc': 0.88167715, 'binary_precision': 0.21317829, 'binary_recall': 0.63805103, 'binary_specificity': 0.9391924, 'binary_f1_score': 0.31958166}
confusion matrix:
       0     1
0  15677  1015
1    156   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8440194, 'precision': 0.6374053, 'recall': 0.8143265, 'specificity': 0.8143265, 'f1': 0.6690766, 'auroc': 0.88488245, 'binary_precision': 0.29544318, 'binary_recall': 0.77939236, 'binary_specificity': 0.84926075, 'binary_f1_score': 0.4284677}
confusion matrix:
      0     1
0  7927  1407
1   167   590
early stop counter: 5
val acc:0.9316124320030212, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8582895398139954
after epoch: 14,now: 2024-08-07 11:58:07.850667,epoch time: 0:20:55.663262,used: 4:28:22.361088,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.961599, 'precision': 0.9625797, 'recall': 0.9616182, 'specificity': 0.9616182, 'f1': 0.96157974, 'auroc': 0.9926801, 'binary_precision': 0.98408705, 'binary_recall': 0.93843615, 'binary_specificity': 0.98480016, 'binary_f1_score': 0.9607196}
confusion matrix:
       0      1
0  25009    386
1   1566  23871
---- Validation: 
scalar performance:
{'acc': 0.9351749, 'precision': 0.6059438, 'recall': 0.78592837, 'specificity': 0.78592837, 'f1': 0.6470159, 'auroc': 0.8839002, 'binary_precision': 0.22194922, 'binary_recall': 0.6287703, 'binary_specificity': 0.9430865, 'binary_f1_score': 0.32808718}
confusion matrix:
       0    1
0  15742  950
1    160  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85462296, 'precision': 0.6460607, 'recall': 0.82066524, 'specificity': 0.82066524, 'f1': 0.6812676, 'auroc': 0.88920355, 'binary_precision': 0.31236786, 'binary_recall': 0.7807133, 'binary_specificity': 0.8606171, 'binary_f1_score': 0.4462061}
confusion matrix:
      0     1
0  8033  1301
1   166   591
early stop counter: 6
val acc:0.9351748824119568, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8582895398139954
after epoch: 15,now: 2024-08-07 12:16:50.727339,epoch time: 0:18:42.876672,used: 4:47:05.237760,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9657499, 'precision': 0.9663316, 'recall': 0.9657639, 'specificity': 0.9657639, 'f1': 0.96573997, 'auroc': 0.993335, 'binary_precision': 0.98299974, 'binary_recall': 0.9479478, 'binary_specificity': 0.9835801, 'binary_f1_score': 0.9651556}
confusion matrix:
       0      1
0  24979    417
1   1324  24112
---- Validation: 
scalar performance:
{'acc': 0.93032765, 'precision': 0.6026046, 'recall': 0.8003943, 'specificity': 0.8003943, 'f1': 0.6436751, 'auroc': 0.8845061, 'binary_precision': 0.2143928, 'binary_recall': 0.6635731, 'binary_specificity': 0.93721545, 'binary_f1_score': 0.3240793}
confusion matrix:
       0     1
0  15644  1048
1    145   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84867704, 'precision': 0.64325017, 'recall': 0.82534134, 'specificity': 0.82534134, 'f1': 0.6770799, 'auroc': 0.89022946, 'binary_precision': 0.30535895, 'binary_recall': 0.7978864, 'binary_specificity': 0.85279626, 'binary_f1_score': 0.44168192}
confusion matrix:
      0     1
0  7960  1374
1   153   604
early stop counter: 7
val acc:0.9303276538848877, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8582895398139954
after epoch: 16,now: 2024-08-07 12:35:20.353413,epoch time: 0:18:29.626074,used: 5:05:34.863834,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.964904, 'precision': 0.96521264, 'recall': 0.9649142, 'specificity': 0.9649142, 'f1': 0.9648987, 'auroc': 0.9932087, 'binary_precision': 0.9773938, 'binary_recall': 0.9518792, 'binary_specificity': 0.97794926, 'binary_f1_score': 0.9644678}
confusion matrix:
       0      1
0  24836    560
1   1224  24212
---- Validation: 
scalar performance:
{'acc': 0.92074984, 'precision': 0.5938661, 'recall': 0.8101735, 'specificity': 0.8101735, 'f1': 0.63192916, 'auroc': 0.884655, 'binary_precision': 0.19619423, 'binary_recall': 0.6937355, 'binary_specificity': 0.92661154, 'binary_f1_score': 0.30588233}
confusion matrix:
       0     1
0  15467  1225
1    132   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8373799, 'precision': 0.6379861, 'recall': 0.83137333, 'specificity': 0.83137333, 'f1': 0.66854477, 'auroc': 0.8931101, 'binary_precision': 0.29268292, 'binary_recall': 0.8243065, 'binary_specificity': 0.8384401, 'binary_f1_score': 0.43198338}
confusion matrix:
      0     1
0  7826  1508
1   133   624
early stop counter: 8
val acc:0.920749843120575, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8582895398139954
after epoch: 17,now: 2024-08-07 12:54:00.056458,epoch time: 0:18:39.703045,used: 5:24:14.566879,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9666155, 'precision': 0.96689343, 'recall': 0.96662474, 'specificity': 0.96662474, 'f1': 0.966611, 'auroc': 0.9934552, 'binary_precision': 0.97847295, 'binary_recall': 0.9542756, 'binary_specificity': 0.97897387, 'binary_f1_score': 0.9662228}
confusion matrix:
       0      1
0  24863    534
1   1163  24272
---- Validation: 
scalar performance:
{'acc': 0.91736263, 'precision': 0.58956695, 'recall': 0.8050457, 'specificity': 0.8050457, 'f1': 0.6255383, 'auroc': 0.88095343, 'binary_precision': 0.18781726, 'binary_recall': 0.68677497, 'binary_specificity': 0.92331654, 'binary_f1_score': 0.29496762}
confusion matrix:
       0     1
0  15412  1280
1    135   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83906454, 'precision': 0.6366402, 'recall': 0.82257295, 'specificity': 0.82257295, 'f1': 0.6672617, 'auroc': 0.8887877, 'binary_precision': 0.2918867, 'binary_recall': 0.8031704, 'binary_specificity': 0.84197557, 'binary_f1_score': 0.428169}
confusion matrix:
      0     1
0  7859  1475
1   149   608
early stop counter: 9
val acc:0.917362630367279, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8582895398139954
after epoch: 18,now: 2024-08-07 13:13:11.410596,epoch time: 0:19:11.354138,used: 5:43:25.921017,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9646876, 'precision': 0.96574426, 'recall': 0.9647046, 'specificity': 0.9647046, 'f1': 0.9646684, 'auroc': 0.9940518, 'binary_precision': 0.98810655, 'binary_recall': 0.94074863, 'binary_specificity': 0.9886605, 'binary_f1_score': 0.9638462}
confusion matrix:
       0      1
0  25110    288
1   1507  23927
---- Validation: 
scalar performance:
{'acc': 0.9352333, 'precision': 0.60731876, 'recall': 0.79160905, 'specificity': 0.79160905, 'f1': 0.6491479, 'auroc': 0.8833287, 'binary_precision': 0.22439024, 'binary_recall': 0.6403712, 'binary_specificity': 0.9428469, 'binary_f1_score': 0.3323299}
confusion matrix:
       0    1
0  15738  954
1    155  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85878503, 'precision': 0.650435, 'recall': 0.8259497, 'specificity': 0.8259497, 'f1': 0.6871781, 'auroc': 0.8928242, 'binary_precision': 0.3204301, 'binary_recall': 0.78731835, 'binary_specificity': 0.8645811, 'binary_f1_score': 0.45548335}
confusion matrix:
      0     1
0  8070  1264
1   161   596
new oracle model saved
early stop counter: 10
val acc:0.9352332949638367, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8587850332260132
after epoch: 19,now: 2024-08-07 13:31:54.686476,epoch time: 0:18:43.275880,used: 6:02:09.196897,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96783525, 'precision': 0.96804273, 'recall': 0.96784407, 'specificity': 0.96784407, 'f1': 0.9678321, 'auroc': 0.994158, 'binary_precision': 0.9781054, 'binary_recall': 0.957149, 'binary_specificity': 0.9785391, 'binary_f1_score': 0.96751374}
confusion matrix:
       0      1
0  24850    545
1   1090  24347
---- Validation: 
scalar performance:
{'acc': 0.9215675, 'precision': 0.5957011, 'recall': 0.8151134, 'specificity': 0.8151134, 'f1': 0.63467294, 'auroc': 0.8886167, 'binary_precision': 0.19960475, 'binary_recall': 0.7030162, 'binary_specificity': 0.9272106, 'binary_f1_score': 0.3109287}
confusion matrix:
       0     1
0  15477  1215
1    128   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8514518, 'precision': 0.6474975, 'recall': 0.83473134, 'specificity': 0.83473134, 'f1': 0.6828055, 'auroc': 0.8959484, 'binary_precision': 0.31224698, 'binary_recall': 0.8150594, 'binary_specificity': 0.85440326, 'binary_f1_score': 0.45151848}
confusion matrix:
      0     1
0  7975  1359
1   140   617
early stop counter: 11
val acc:0.9215674996376038, best validation acc: 0.9385037422180176, corresponding to test acc:                         0.8532355427742004 / 0.8587850332260132
after epoch: 20,now: 2024-08-07 13:51:14.700737,epoch time: 0:19:20.014261,used: 6:21:29.211158,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_29_45_seed_1_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:21:29.211158 at 2024-08-07 13:51:14.700737
persisted model performance metric: 

scalar performance:
{'acc': 0.85323554, 'precision': 0.6365746, 'recall': 0.78896165, 'specificity': 0.78896165, 'f1': 0.6688314, 'auroc': 0.8705174, 'binary_precision': 0.29933482, 'binary_recall': 0.71334213, 'binary_specificity': 0.8645811, 'binary_f1_score': 0.42171028}
confusion matrix:
      0     1
0  8070  1264
1   217   540
oracle model performance metric: 

scalar performance:
{'acc': 0.85878503, 'precision': 0.650435, 'recall': 0.8259497, 'specificity': 0.8259497, 'f1': 0.6871781, 'auroc': 0.8928242, 'binary_precision': 0.3204301, 'binary_recall': 0.78731835, 'binary_specificity': 0.8645811, 'binary_f1_score': 0.45548335}
confusion matrix:
      0     1
0  8070  1264
1   161   596
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |  16662 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8528 MiB |  16788 MiB |   8276 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     42 MiB |     54 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38101 KiB | 732464 KiB | 548717 GiB | 548717 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 533711 GiB | 533711 GiB |
|       from small pool |   6368 KiB |  22549 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6849    |  185258 K  |  185254 K  |
|       from large pool |      79    |     762    |   91849 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93409 K  |   93405 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6849    |  185258 K  |  185254 K  |
|       from large pool |      79    |     762    |   91849 K  |   91848 K  |
|       from small pool |    4333    |    6768    |   93409 K  |   93405 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     370    |     714    |     346    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3199    |  104111 K  |  104111 K  |
|       from large pool |      11    |     352    |   63923 K  |   63923 K  |
|       from small pool |      21    |    3189    |   40187 K  |   40187 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8528 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     42 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548717 GiB | 548717 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533712 GiB | 533712 GiB |
|       from small pool |      0 KiB |  22549 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185258 K  |  185258 K  |
|       from large pool |       2    |     762    |   91849 K  |   91849 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185258 K  |  185258 K  |
|       from large pool |       2    |     762    |   91849 K  |   91849 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     714    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      21    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  104113 K  |  104113 K  |
|       from large pool |       3    |     352    |   63924 K  |   63924 K  |
|       from small pool |       0    |    3189    |   40189 K  |   40189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8528 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     42 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548717 GiB | 548717 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533712 GiB | 533712 GiB |
|       from small pool |      0 KiB |  22549 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185258 K  |  185258 K  |
|       from large pool |       2    |     762    |   91849 K  |   91849 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185258 K  |  185258 K  |
|       from large pool |       2    |     762    |   91849 K  |   91849 K  |
|       from small pool |       0    |    6768    |   93409 K  |   93409 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     714    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      21    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  104113 K  |  104113 K  |
|       from large pool |       3    |     352    |   63924 K  |   63924 K  |
|       from small pool |       0    |    3189    |   40189 K  |   40189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684

 Experiment start at: 2024-08-07 14:18:16.353502
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8634517, 'precision': 0.8661473, 'recall': 0.8634683, 'specificity': 0.8634683, 'f1': 0.86320376, 'auroc': 0.93018734, 'binary_precision': 0.89766043, 'binary_recall': 0.8205584, 'binary_specificity': 0.9063782, 'binary_f1_score': 0.85737956}
confusion matrix:
       0      1
0  23419   2419
1   4640  21218
---- Validation: 
scalar performance:
{'acc': 0.816398, 'precision': 0.51926106, 'recall': 0.61900634, 'specificity': 0.61900634, 'f1': 0.4982066, 'auroc': 0.68613607, 'binary_precision': 0.05602606, 'binary_recall': 0.41148326, 'binary_specificity': 0.8265294, 'binary_f1_score': 0.09862386}
confusion matrix:
       0     1
0  13808  2898
1    246   172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75881886, 'precision': 0.57950246, 'recall': 0.7136346, 'specificity': 0.7136346, 'f1': 0.5780063, 'auroc': 0.7734622, 'binary_precision': 0.19561175, 'binary_recall': 0.65997493, 'binary_specificity': 0.7672942, 'binary_f1_score': 0.30177855}
confusion matrix:
      0     1
0  7132  2163
1   271   526
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 14:38:25.438024,epoch time: 0:20:09.084522,used: 0:20:09.084522,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90544724, 'precision': 0.90917164, 'recall': 0.9054564, 'specificity': 0.9054564, 'f1': 0.90523297, 'auroc': 0.9607935, 'binary_precision': 0.94825745, 'binary_recall': 0.8577341, 'binary_specificity': 0.9531788, 'binary_f1_score': 0.90072703}
confusion matrix:
       0      1
0  24633   1210
1   3678  22175
---- Validation: 
scalar performance:
{'acc': 0.889103, 'precision': 0.5298896, 'recall': 0.6154499, 'specificity': 0.6154499, 'f1': 0.533444, 'auroc': 0.7357201, 'binary_precision': 0.078062676, 'binary_recall': 0.3277512, 'binary_specificity': 0.9031486, 'binary_f1_score': 0.12609296}
confusion matrix:
       0     1
0  15088  1618
1    281   137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82996434, 'precision': 0.6011596, 'recall': 0.70407844, 'specificity': 0.70407844, 'f1': 0.6212056, 'auroc': 0.7991056, 'binary_precision': 0.24514697, 'binary_recall': 0.5545797, 'binary_specificity': 0.8535772, 'binary_f1_score': 0.34}
confusion matrix:
      0     1
0  7934  1361
1   355   442
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 14:58:01.517656,epoch time: 0:19:36.079632,used: 0:39:45.164154,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9235531, 'precision': 0.92720294, 'recall': 0.9235567, 'specificity': 0.9235567, 'f1': 0.9233899, 'auroc': 0.9718044, 'binary_precision': 0.9667093, 'binary_recall': 0.8773308, 'binary_specificity': 0.96978253, 'binary_f1_score': 0.919854}
confusion matrix:
       0      1
0  25065    781
1   3171  22679
---- Validation: 
scalar performance:
{'acc': 0.9138636, 'precision': 0.5412461, 'recall': 0.62347496, 'specificity': 0.62347496, 'f1': 0.5537054, 'auroc': 0.76734805, 'binary_precision': 0.1005291, 'binary_recall': 0.3181818, 'binary_specificity': 0.9287681, 'binary_f1_score': 0.15278575}
confusion matrix:
       0     1
0  15516  1190
1    285   133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.860979, 'precision': 0.619805, 'recall': 0.697973, 'specificity': 0.697973, 'f1': 0.64312565, 'auroc': 0.8165567, 'binary_precision': 0.2851064, 'binary_recall': 0.5043915, 'binary_specificity': 0.8915546, 'binary_f1_score': 0.36429545}
confusion matrix:
      0     1
0  8287  1008
1   395   402
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 15:16:50.702486,epoch time: 0:18:49.184830,used: 0:58:34.348984,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93301225, 'precision': 0.9356226, 'recall': 0.93301976, 'specificity': 0.93301976, 'f1': 0.9329125, 'auroc': 0.9775164, 'binary_precision': 0.96939206, 'binary_recall': 0.89428693, 'binary_specificity': 0.9717525, 'binary_f1_score': 0.93032616}
confusion matrix:
       0      1
0  25113    730
1   2733  23120
---- Validation: 
scalar performance:
{'acc': 0.9211049, 'precision': 0.5576677, 'recall': 0.6656722, 'specificity': 0.6656722, 'f1': 0.5778903, 'auroc': 0.7918999, 'binary_precision': 0.1312253, 'binary_recall': 0.39712918, 'binary_specificity': 0.93421525, 'binary_f1_score': 0.19726679}
confusion matrix:
       0     1
0  15607  1099
1    252   166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87485135, 'precision': 0.63063043, 'recall': 0.6905914, 'specificity': 0.6905914, 'f1': 0.65184355, 'auroc': 0.8283285, 'binary_precision': 0.3087028, 'binary_recall': 0.47176912, 'binary_specificity': 0.90941364, 'binary_f1_score': 0.373201}
confusion matrix:
      0    1
0  8453  842
1   421  376
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 15:36:11.195924,epoch time: 0:19:20.493438,used: 1:17:54.842422,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93632, 'precision': 0.9399824, 'recall': 0.9363271, 'specificity': 0.9363271, 'f1': 0.936188, 'auroc': 0.9811723, 'binary_precision': 0.98016346, 'binary_recall': 0.89068544, 'binary_specificity': 0.98196876, 'binary_f1_score': 0.9332847}
confusion matrix:
       0      1
0  25378    466
1   2826  23026
---- Validation: 
scalar performance:
{'acc': 0.9233824, 'precision': 0.56521237, 'recall': 0.6866656, 'specificity': 0.6866656, 'f1': 0.5889172, 'auroc': 0.7996645, 'binary_precision': 0.1452381, 'binary_recall': 0.43779904, 'binary_specificity': 0.93553215, 'binary_f1_score': 0.21811682}
confusion matrix:
       0     1
0  15629  1077
1    235   183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8813912, 'precision': 0.6428082, 'recall': 0.70331866, 'specificity': 0.70331866, 'f1': 0.6650007, 'auroc': 0.8402282, 'binary_precision': 0.3310811, 'binary_recall': 0.49184442, 'binary_specificity': 0.9147929, 'binary_f1_score': 0.3957597}
confusion matrix:
      0    1
0  8503  792
1   405  392
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 15:55:04.889185,epoch time: 0:18:53.693261,used: 1:36:48.535683,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94374806, 'precision': 0.9461981, 'recall': 0.9437567, 'specificity': 0.9437567, 'f1': 0.94367146, 'auroc': 0.98450613, 'binary_precision': 0.9793199, 'binary_recall': 0.9066682, 'binary_specificity': 0.98084515, 'binary_f1_score': 0.9415947}
confusion matrix:
       0      1
0  25347    495
1   2413  23441
---- Validation: 
scalar performance:
{'acc': 0.91088533, 'precision': 0.5612407, 'recall': 0.7082505, 'specificity': 0.7082505, 'f1': 0.5830846, 'auroc': 0.8106386, 'binary_precision': 0.13600525, 'binary_recall': 0.4952153, 'binary_specificity': 0.92128575, 'binary_f1_score': 0.21340206}
confusion matrix:
       0     1
0  15391  1315
1    211   207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8828775, 'precision': 0.6508863, 'recall': 0.72247946, 'specificity': 0.72247946, 'f1': 0.6763122, 'auroc': 0.84686947, 'binary_precision': 0.34387672, 'binary_recall': 0.531995, 'binary_specificity': 0.912964, 'binary_f1_score': 0.417734}
confusion matrix:
      0    1
0  8486  809
1   373  424
new oracle model saved
early stop counter: 1
val acc:0.9108853340148926, best validation acc: 0.9233824014663696, corresponding to test acc:                         0.8813912272453308 / 0.88287752866745
after epoch: 6,now: 2024-08-07 16:14:08.251123,epoch time: 0:19:03.361938,used: 1:55:51.897621,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9493578, 'precision': 0.95145726, 'recall': 0.94936174, 'specificity': 0.94936174, 'f1': 0.94929916, 'auroc': 0.9868636, 'binary_precision': 0.9822726, 'binary_recall': 0.91524506, 'binary_specificity': 0.9834784, 'binary_f1_score': 0.947575}
confusion matrix:
       0      1
0  25418    427
1   2191  23660
---- Validation: 
scalar performance:
{'acc': 0.9215721, 'precision': 0.57090133, 'recall': 0.7148938, 'specificity': 0.7148938, 'f1': 0.59758043, 'auroc': 0.81878644, 'binary_precision': 0.15510812, 'binary_recall': 0.49760765, 'binary_specificity': 0.93218005, 'binary_f1_score': 0.23649798}
confusion matrix:
       0     1
0  15573  1133
1    210   208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89050734, 'precision': 0.656083, 'recall': 0.70539975, 'specificity': 0.70539975, 'f1': 0.6757776, 'auroc': 0.84877264, 'binary_precision': 0.357671, 'binary_recall': 0.48557088, 'binary_specificity': 0.9252286, 'binary_f1_score': 0.41192123}
confusion matrix:
      0    1
0  8600  695
1   410  387
new oracle model saved
early stop counter: 2
val acc:0.9215720891952515, best validation acc: 0.9233824014663696, corresponding to test acc:                         0.8813912272453308 / 0.8905073404312134
after epoch: 7,now: 2024-08-07 16:33:38.879813,epoch time: 0:19:30.628690,used: 2:15:22.526311,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9515436, 'precision': 0.9533142, 'recall': 0.95155334, 'specificity': 0.95155334, 'f1': 0.95149696, 'auroc': 0.9873879, 'binary_precision': 0.9817222, 'binary_recall': 0.9202506, 'binary_specificity': 0.98285604, 'binary_f1_score': 0.949993}
confusion matrix:
       0      1
0  25397    443
1   2062  23794
---- Validation: 
scalar performance:
{'acc': 0.9134548, 'precision': 0.56680024, 'recall': 0.7247286, 'specificity': 0.7247286, 'f1': 0.59154135, 'auroc': 0.8237033, 'binary_precision': 0.1462766, 'binary_recall': 0.5263158, 'binary_specificity': 0.92314136, 'binary_f1_score': 0.2289282}
confusion matrix:
       0     1
0  15422  1284
1    198   220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8941736, 'precision': 0.6662386, 'recall': 0.7200084, 'specificity': 0.7200084, 'f1': 0.68767756, 'auroc': 0.8552894, 'binary_precision': 0.37557393, 'binary_recall': 0.5131744, 'binary_specificity': 0.9268424, 'binary_f1_score': 0.43372217}
confusion matrix:
      0    1
0  8615  680
1   388  409
new oracle model saved
early stop counter: 3
val acc:0.9134547710418701, best validation acc: 0.9233824014663696, corresponding to test acc:                         0.8813912272453308 / 0.8941736221313477
after epoch: 8,now: 2024-08-07 16:52:32.790083,epoch time: 0:18:53.910270,used: 2:34:16.436581,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9572114, 'precision': 0.95814174, 'recall': 0.9572175, 'specificity': 0.9572175, 'f1': 0.95719004, 'auroc': 0.98945135, 'binary_precision': 0.97885525, 'binary_recall': 0.93463546, 'binary_specificity': 0.97979957, 'binary_f1_score': 0.9562344}
confusion matrix:
       0      1
0  25319    522
1   1690  24165
---- Validation: 
scalar performance:
{'acc': 0.91292924, 'precision': 0.5692465, 'recall': 0.7372879, 'specificity': 0.7372879, 'f1': 0.5951955, 'auroc': 0.83156514, 'binary_precision': 0.1504886, 'binary_recall': 0.55263156, 'binary_specificity': 0.9219442, 'binary_f1_score': 0.23655914}
confusion matrix:
       0     1
0  15402  1304
1    187   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8941736, 'precision': 0.66574174, 'recall': 0.7182877, 'specificity': 0.7182877, 'f1': 0.6867835, 'auroc': 0.8571213, 'binary_precision': 0.37488458, 'binary_recall': 0.50941026, 'binary_specificity': 0.92716515, 'binary_f1_score': 0.43191487}
confusion matrix:
      0    1
0  8618  677
1   391  406
early stop counter: 4
val acc:0.9129292368888855, best validation acc: 0.9233824014663696, corresponding to test acc:                         0.8813912272453308 / 0.8941736221313477
after epoch: 9,now: 2024-08-07 17:11:18.522967,epoch time: 0:18:45.732884,used: 2:53:02.169465,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9569599, 'precision': 0.95810854, 'recall': 0.95696574, 'specificity': 0.95696574, 'f1': 0.95693326, 'auroc': 0.9895973, 'binary_precision': 0.9811052, 'binary_recall': 0.93188673, 'binary_specificity': 0.98204476, 'binary_f1_score': 0.95586276}
confusion matrix:
       0      1
0  25378    464
1   1761  24093
---- Validation: 
scalar performance:
{'acc': 0.9171922, 'precision': 0.5735604, 'recall': 0.7418052, 'specificity': 0.7418052, 'f1': 0.601766, 'auroc': 0.83590543, 'binary_precision': 0.15893587, 'binary_recall': 0.55741626, 'binary_specificity': 0.9261942, 'binary_f1_score': 0.24734607}
confusion matrix:
       0     1
0  15473  1233
1    185   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8984344, 'precision': 0.6734388, 'recall': 0.7200272, 'specificity': 0.7200272, 'f1': 0.69277775, 'auroc': 0.86218005, 'binary_precision': 0.3901734, 'binary_recall': 0.5081556, 'binary_specificity': 0.9318989, 'binary_f1_score': 0.4414169}
confusion matrix:
      0    1
0  8662  633
1   392  405
new oracle model saved
early stop counter: 5
val acc:0.9171922206878662, best validation acc: 0.9233824014663696, corresponding to test acc:                         0.8813912272453308 / 0.8984344005584717
after epoch: 10,now: 2024-08-07 17:30:09.362458,epoch time: 0:18:50.839491,used: 3:11:53.008956,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9591071, 'precision': 0.9602031, 'recall': 0.9591166, 'specificity': 0.9591166, 'f1': 0.9590833, 'auroc': 0.9914272, 'binary_precision': 0.98275864, 'binary_recall': 0.93464303, 'binary_specificity': 0.98359007, 'binary_f1_score': 0.9580971}
confusion matrix:
       0      1
0  25414    424
1   1690  24168
---- Validation: 
scalar performance:
{'acc': 0.9261855, 'precision': 0.58211255, 'recall': 0.74291563, 'specificity': 0.74291563, 'f1': 0.6139789, 'auroc': 0.8406564, 'binary_precision': 0.17611027, 'binary_recall': 0.5502392, 'binary_specificity': 0.935592, 'binary_f1_score': 0.26682135}
confusion matrix:
       0     1
0  15630  1076
1    188   230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90160525, 'precision': 0.6767025, 'recall': 0.7102774, 'specificity': 0.7102774, 'f1': 0.69142485, 'auroc': 0.86386764, 'binary_precision': 0.39855072, 'binary_recall': 0.4830615, 'binary_specificity': 0.93749326, 'binary_f1_score': 0.43675554}
confusion matrix:
      0    1
0  8714  581
1   412  385
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-07 17:48:55.643208,epoch time: 0:18:46.280750,used: 3:30:39.289706,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9617572, 'precision': 0.96266603, 'recall': 0.9617598, 'specificity': 0.9617598, 'f1': 0.9617386, 'auroc': 0.9914534, 'binary_precision': 0.9832011, 'binary_recall': 0.9395768, 'binary_specificity': 0.98394275, 'binary_f1_score': 0.9608941}
confusion matrix:
       0      1
0  25430    415
1   1562  24289
---- Validation: 
scalar performance:
{'acc': 0.9254263, 'precision': 0.58261937, 'recall': 0.7483578, 'specificity': 0.7483578, 'f1': 0.6148707, 'auroc': 0.84261656, 'binary_precision': 0.17682467, 'binary_recall': 0.56220096, 'binary_specificity': 0.9345145, 'binary_f1_score': 0.26903263}
confusion matrix:
       0     1
0  15612  1094
1    183   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90200156, 'precision': 0.6759845, 'recall': 0.704757, 'specificity': 0.704757, 'f1': 0.6888317, 'auroc': 0.86578035, 'binary_precision': 0.39808917, 'binary_recall': 0.47051442, 'binary_specificity': 0.9389995, 'binary_f1_score': 0.4312823}
confusion matrix:
      0    1
0  8728  567
1   422  375
new oracle model saved
early stop counter: 1
val acc:0.9254263043403625, best validation acc: 0.9261854887008667, corresponding to test acc:                         0.9016052484512329 / 0.9020015597343445
after epoch: 12,now: 2024-08-07 18:07:57.390223,epoch time: 0:19:01.747015,used: 3:49:41.036721,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9610608, 'precision': 0.96261287, 'recall': 0.9610653, 'specificity': 0.9610653, 'f1': 0.96102834, 'auroc': 0.99230146, 'binary_precision': 0.9894469, 'binary_recall': 0.9320749, 'binary_specificity': 0.99005574, 'binary_f1_score': 0.9599044}
confusion matrix:
       0      1
0  25587    257
1   1756  24096
---- Validation: 
scalar performance:
{'acc': 0.94201124, 'precision': 0.6037619, 'recall': 0.74519527, 'specificity': 0.74519527, 'f1': 0.6407902, 'auroc': 0.844797, 'binary_precision': 0.2195122, 'binary_recall': 0.5382775, 'binary_specificity': 0.95211303, 'binary_f1_score': 0.31185028}
confusion matrix:
       0    1
0  15906  800
1    193  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9093341, 'precision': 0.6878786, 'recall': 0.68636876, 'specificity': 0.68636876, 'f1': 0.68711954, 'auroc': 0.86622465, 'binary_precision': 0.42531645, 'binary_recall': 0.42158094, 'binary_specificity': 0.95115656, 'binary_f1_score': 0.4234405}
confusion matrix:
      0    1
0  8841  454
1   461  336
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-07 18:26:51.615858,epoch time: 0:18:54.225635,used: 4:08:35.262356,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9635175, 'precision': 0.9643966, 'recall': 0.96352005, 'specificity': 0.96352005, 'f1': 0.9635004, 'auroc': 0.9925704, 'binary_precision': 0.98463094, 'binary_recall': 0.9417431, 'binary_specificity': 0.98529696, 'binary_f1_score': 0.96270967}
confusion matrix:
       0      1
0  25465    380
1   1506  24345
---- Validation: 
scalar performance:
{'acc': 0.91473955, 'precision': 0.5744131, 'recall': 0.7545431, 'specificity': 0.7545431, 'f1': 0.603039, 'auroc': 0.84576124, 'binary_precision': 0.15992168, 'binary_recall': 0.5861244, 'binary_specificity': 0.92296183, 'binary_f1_score': 0.25128207}
confusion matrix:
       0     1
0  15419  1287
1    173   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90130794, 'precision': 0.67791885, 'recall': 0.71699876, 'specificity': 0.71699876, 'f1': 0.6947137, 'auroc': 0.86762345, 'binary_precision': 0.3997986, 'binary_recall': 0.49811795, 'binary_specificity': 0.9358795, 'binary_f1_score': 0.44357544}
confusion matrix:
      0    1
0  8699  596
1   400  397
early stop counter: 1
val acc:0.9147395491600037, best validation acc: 0.9420112371444702, corresponding to test acc:                         0.909334123134613 / 0.909334123134613
after epoch: 14,now: 2024-08-07 18:45:39.344170,epoch time: 0:18:47.728312,used: 4:27:22.990668,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9648522, 'precision': 0.9654952, 'recall': 0.9648558, 'specificity': 0.9648558, 'f1': 0.9648403, 'auroc': 0.9924921, 'binary_precision': 0.98284453, 'binary_recall': 0.94623446, 'binary_specificity': 0.9834772, 'binary_f1_score': 0.9641921}
confusion matrix:
       0      1
0  25416    427
1   1390  24463
---- Validation: 
scalar performance:
{'acc': 0.91468114, 'precision': 0.5756198, 'recall': 0.7603444, 'specificity': 0.7603444, 'f1': 0.6048608, 'auroc': 0.84857655, 'binary_precision': 0.16202204, 'binary_recall': 0.5980861, 'binary_specificity': 0.92260265, 'binary_f1_score': 0.25497195}
confusion matrix:
       0     1
0  15413  1293
1    168   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9033888, 'precision': 0.6806792, 'recall': 0.71181923, 'specificity': 0.71181923, 'f1': 0.69450885, 'auroc': 0.8700203, 'binary_precision': 0.4063158, 'binary_recall': 0.4843162, 'binary_specificity': 0.93932223, 'binary_f1_score': 0.4419004}
confusion matrix:
      0    1
0  8731  564
1   411  386
early stop counter: 2
val acc:0.9146811366081238, best validation acc: 0.9420112371444702, corresponding to test acc:                         0.909334123134613 / 0.909334123134613
after epoch: 15,now: 2024-08-07 19:04:32.101506,epoch time: 0:18:52.757336,used: 4:46:15.748004,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9669027, 'precision': 0.96751475, 'recall': 0.96690834, 'specificity': 0.96690834, 'f1': 0.9668921, 'auroc': 0.9936265, 'binary_precision': 0.9845086, 'binary_recall': 0.94875467, 'binary_specificity': 0.98506194, 'binary_f1_score': 0.96630096}
confusion matrix:
       0      1
0  25454    386
1   1325  24531
---- Validation: 
scalar performance:
{'acc': 0.92402476, 'precision': 0.58185554, 'recall': 0.7511382, 'specificity': 0.7511382, 'f1': 0.6139003, 'auroc': 0.84899247, 'binary_precision': 0.17512877, 'binary_recall': 0.569378, 'binary_specificity': 0.93289834, 'binary_f1_score': 0.2678672}
confusion matrix:
       0     1
0  15585  1121
1    180   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9073524, 'precision': 0.6831852, 'recall': 0.68758714, 'specificity': 0.68758714, 'f1': 0.68534994, 'auroc': 0.86768067, 'binary_precision': 0.41564792, 'binary_recall': 0.42659974, 'binary_specificity': 0.9485745, 'binary_f1_score': 0.42105263}
confusion matrix:
      0    1
0  8817  478
1   457  340
early stop counter: 3
val acc:0.924024760723114, best validation acc: 0.9420112371444702, corresponding to test acc:                         0.909334123134613 / 0.909334123134613
after epoch: 16,now: 2024-08-07 19:23:20.851504,epoch time: 0:18:48.749998,used: 5:05:04.498002,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9667092, 'precision': 0.9676587, 'recall': 0.96671355, 'specificity': 0.96671355, 'f1': 0.96669257, 'auroc': 0.9939365, 'binary_precision': 0.98877907, 'binary_recall': 0.94414574, 'binary_specificity': 0.9892814, 'binary_f1_score': 0.96594715}
confusion matrix:
       0      1
0  25566    277
1   1444  24409
---- Validation: 
scalar performance:
{'acc': 0.9325508, 'precision': 0.59160024, 'recall': 0.75200915, 'specificity': 0.75200915, 'f1': 0.62691313, 'auroc': 0.8497393, 'binary_precision': 0.1946976, 'binary_recall': 0.56220096, 'binary_specificity': 0.9418173, 'binary_f1_score': 0.28923076}
confusion matrix:
       0    1
0  15734  972
1    183  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9088387, 'precision': 0.68753684, 'recall': 0.6901147, 'specificity': 0.6901147, 'f1': 0.6888136, 'auroc': 0.87023056, 'binary_precision': 0.42398024, 'binary_recall': 0.43036386, 'binary_specificity': 0.9498655, 'binary_f1_score': 0.4271482}
confusion matrix:
      0    1
0  8829  466
1   454  343
early stop counter: 4
val acc:0.9325507879257202, best validation acc: 0.9420112371444702, corresponding to test acc:                         0.909334123134613 / 0.909334123134613
after epoch: 17,now: 2024-08-07 19:42:15.408367,epoch time: 0:18:54.556863,used: 5:23:59.054865,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9692046, 'precision': 0.9695859, 'recall': 0.9692062, 'specificity': 0.9692062, 'f1': 0.9691984, 'auroc': 0.99423015, 'binary_precision': 0.9829969, 'binary_recall': 0.95493406, 'binary_specificity': 0.9834784, 'binary_f1_score': 0.9687623}
confusion matrix:
       0      1
0  25418    427
1   1165  24686
---- Validation: 
scalar performance:
{'acc': 0.9091918, 'precision': 0.57310843, 'recall': 0.7680272, 'specificity': 0.7680272, 'f1': 0.60077494, 'auroc': 0.853755, 'binary_precision': 0.15649547, 'binary_recall': 0.6196172, 'binary_specificity': 0.9164372, 'binary_f1_score': 0.2498794}
confusion matrix:
       0     1
0  15310  1396
1    159   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9042806, 'precision': 0.6829339, 'recall': 0.71345043, 'specificity': 0.71345043, 'f1': 0.69654226, 'auroc': 0.8703735, 'binary_precision': 0.410582, 'binary_recall': 0.4868256, 'binary_specificity': 0.94007534, 'binary_f1_score': 0.44546497}
confusion matrix:
      0    1
0  8738  557
1   409  388
early stop counter: 5
val acc:0.9091917872428894, best validation acc: 0.9420112371444702, corresponding to test acc:                         0.909334123134613 / 0.909334123134613
after epoch: 18,now: 2024-08-07 20:01:09.174722,epoch time: 0:18:53.766355,used: 5:42:52.821220,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.969282, 'precision': 0.9697098, 'recall': 0.9692843, 'specificity': 0.9692843, 'f1': 0.969275, 'auroc': 0.9941237, 'binary_precision': 0.983925, 'binary_recall': 0.9541622, 'binary_specificity': 0.9844064, 'binary_f1_score': 0.968815}
confusion matrix:
       0      1
0  25441    403
1   1185  24667
---- Validation: 
scalar performance:
{'acc': 0.9135132, 'precision': 0.57556796, 'recall': 0.7644108, 'specificity': 0.7644108, 'f1': 0.60474753, 'auroc': 0.8526424, 'binary_precision': 0.16168046, 'binary_recall': 0.6076555, 'binary_specificity': 0.92116606, 'binary_f1_score': 0.2554047}
confusion matrix:
       0     1
0  15389  1317
1    164   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90636146, 'precision': 0.6855645, 'recall': 0.7059767, 'specificity': 0.7059767, 'f1': 0.6950293, 'auroc': 0.8707499, 'binary_precision': 0.41722596, 'binary_recall': 0.46800503, 'binary_specificity': 0.9439484, 'binary_f1_score': 0.44115907}
confusion matrix:
      0    1
0  8774  521
1   424  373
early stop counter: 6
val acc:0.91351318359375, best validation acc: 0.9420112371444702, corresponding to test acc:                         0.909334123134613 / 0.909334123134613
after epoch: 19,now: 2024-08-07 20:19:52.217125,epoch time: 0:18:43.042403,used: 6:01:35.863623,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9690885, 'precision': 0.96976477, 'recall': 0.9690937, 'specificity': 0.9690937, 'f1': 0.96907765, 'auroc': 0.99440026, 'binary_precision': 0.9876563, 'binary_recall': 0.9500677, 'binary_specificity': 0.98811966, 'binary_f1_score': 0.96849746}
confusion matrix:
       0      1
0  25534    307
1   1291  24564
---- Validation: 
scalar performance:
{'acc': 0.91059333, 'precision': 0.57281375, 'recall': 0.7617481, 'specificity': 0.7617481, 'f1': 0.60043705, 'auroc': 0.84929776, 'binary_precision': 0.1562693, 'binary_recall': 0.6052632, 'binary_specificity': 0.918233, 'binary_f1_score': 0.2484045}
confusion matrix:
       0     1
0  15340  1366
1    165   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9071542, 'precision': 0.6877444, 'recall': 0.7075541, 'specificity': 0.7075541, 'f1': 0.6969596, 'auroc': 0.870361, 'binary_precision': 0.4213483, 'binary_recall': 0.47051442, 'binary_specificity': 0.94459385, 'binary_f1_score': 0.44457614}
confusion matrix:
      0    1
0  8780  515
1   422  375
early stop counter: 7
val acc:0.9105933308601379, best validation acc: 0.9420112371444702, corresponding to test acc:                         0.909334123134613 / 0.909334123134613
after epoch: 20,now: 2024-08-07 20:38:48.630990,epoch time: 0:18:56.413865,used: 6:20:32.277488,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_14_18_16_seed_2_24076684
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:20:32.277488 at 2024-08-07 20:38:48.630990
persisted model performance metric: 

scalar performance:
{'acc': 0.9093341, 'precision': 0.6878786, 'recall': 0.68636876, 'specificity': 0.68636876, 'f1': 0.68711954, 'auroc': 0.86622465, 'binary_precision': 0.42531645, 'binary_recall': 0.42158094, 'binary_specificity': 0.95115656, 'binary_f1_score': 0.4234405}
confusion matrix:
      0    1
0  8841  454
1   461  336
oracle model performance metric: 

scalar performance:
{'acc': 0.9093341, 'precision': 0.6878786, 'recall': 0.68636876, 'specificity': 0.68636876, 'f1': 0.68711954, 'auroc': 0.86622465, 'binary_precision': 0.42531645, 'binary_recall': 0.42158094, 'binary_specificity': 0.95115656, 'binary_f1_score': 0.4234405}
confusion matrix:
      0    1
0  8841  454
1   461  336
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  16662 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8528 MiB |  25072 MiB |  16558 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     40 MiB |     42 MiB |     70 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40149 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |   8416 KiB |  22549 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6957    |  280989 K  |  280984 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141132 K  |  141128 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6957    |  280989 K  |  280984 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141132 K  |  141128 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     370    |    1061    |     692    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      20    |      21    |      35    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3255    |  154669 K  |  154669 K  |
|       from large pool |      11    |     352    |   94473 K  |   94473 K  |
|       from small pool |      22    |    3245    |   60195 K  |   60195 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8528 MiB |  25072 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  26624 KiB |     42 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |  22555 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  280989 K  |  280989 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141132 K  |  141132 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  280989 K  |  280989 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141132 K  |  141132 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     370    |    1061    |    1038    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      13    |      21    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3255    |  154671 K  |  154671 K  |
|       from large pool |       3    |     352    |   94473 K  |   94473 K  |
|       from small pool |       0    |    3245    |   60197 K  |   60197 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 20:56:52 2024]
Finished job 0.
1 of 1 steps (100%) done
