Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 22:13:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/16.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=16
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679

 Experiment start at: 2024-08-06 22:25:13.609314
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.72834414, 'precision': 0.7284011, 'recall': 0.72834873, 'specificity': 0.72834873, 'f1': 0.7283297, 'auroc': 0.79051745, 'binary_precision': 0.73216003, 'binary_recall': 0.7206329, 'binary_specificity': 0.7360645, 'binary_f1_score': 0.7263507}
confusion matrix:
       0      1
0  18632   6681
1   7080  18263
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.76216024, 'precision': 0.52209115, 'recall': 0.6713419, 'specificity': 0.6713419, 'f1': 0.48388824, 'auroc': 0.75826216, 'binary_precision': 0.057715528, 'binary_recall': 0.5759036, 'binary_specificity': 0.76678026, 'binary_f1_score': 0.10491659}
confusion matrix:
       0     1
0  12829  3902
1    176   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6303144, 'precision': 0.5540689, 'recall': 0.68521196, 'specificity': 0.68521196, 'f1': 0.4962932, 'auroc': 0.7351583, 'binary_precision': 0.14036363, 'binary_recall': 0.75, 'binary_specificity': 0.6204239, 'binary_f1_score': 0.23647131}
confusion matrix:
      0     1
0  5796  3546
1   193   579
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 22:43:21.086718,epoch time: 0:18:07.477404,used: 0:18:07.477404,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.82584494, 'precision': 0.825894, 'recall': 0.82584804, 'specificity': 0.82584804, 'f1': 0.8258393, 'auroc': 0.904014, 'binary_precision': 0.8300236, 'binary_recall': 0.81973875, 'binary_specificity': 0.83195734, 'binary_f1_score': 0.8248491}
confusion matrix:
       0      1
0  21061   4254
1   4568  20773
---- Validation: 
scalar performance:
{'acc': 0.8207745, 'precision': 0.53046, 'recall': 0.69197655, 'specificity': 0.69197655, 'f1': 0.5153904, 'auroc': 0.77870643, 'binary_precision': 0.07403846, 'binary_recall': 0.5566265, 'binary_specificity': 0.82732654, 'binary_f1_score': 0.13069306}
confusion matrix:
       0     1
0  13842  2889
1    184   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69547164, 'precision': 0.5748115, 'recall': 0.74127793, 'specificity': 0.74127793, 'f1': 0.54579186, 'auroc': 0.80628705, 'binary_precision': 0.17364253, 'binary_recall': 0.7953368, 'binary_specificity': 0.687219, 'binary_f1_score': 0.28505108}
confusion matrix:
      0     1
0  6420  2922
1   158   614
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 23:00:15.495499,epoch time: 0:16:54.408781,used: 0:35:01.886185,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8588716, 'precision': 0.85910285, 'recall': 0.8588786, 'specificity': 0.8588786, 'f1': 0.8588505, 'auroc': 0.93307304, 'binary_precision': 0.8683539, 'binary_recall': 0.8461842, 'binary_specificity': 0.87157303, 'binary_f1_score': 0.8571257}
confusion matrix:
       0      1
0  22063   3251
1   3898  21444
---- Validation: 
scalar performance:
{'acc': 0.8440453, 'precision': 0.53644204, 'recall': 0.7062503, 'specificity': 0.7062503, 'f1': 0.53128517, 'auroc': 0.7893301, 'binary_precision': 0.085504584, 'binary_recall': 0.5614458, 'binary_specificity': 0.8510549, 'binary_f1_score': 0.14840764}
confusion matrix:
       0     1
0  14239  2492
1    182   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72701204, 'precision': 0.5862824, 'recall': 0.7666694, 'specificity': 0.7666694, 'f1': 0.57117736, 'auroc': 0.8374721, 'binary_precision': 0.1935285, 'binary_recall': 0.8134715, 'binary_specificity': 0.7198673, 'binary_f1_score': 0.31267115}
confusion matrix:
      0     1
0  6725  2617
1   144   628
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 23:17:35.686717,epoch time: 0:17:20.191218,used: 0:52:22.077403,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87454593, 'precision': 0.8756061, 'recall': 0.87456274, 'specificity': 0.87456274, 'f1': 0.8744608, 'auroc': 0.94719076, 'binary_precision': 0.8957196, 'binary_recall': 0.8479719, 'binary_specificity': 0.9011536, 'binary_f1_score': 0.87119204}
confusion matrix:
       0      1
0  22810   2502
1   3853  21491
---- Validation: 
scalar performance:
{'acc': 0.8730899, 'precision': 0.54366755, 'recall': 0.7070337, 'specificity': 0.7070337, 'f1': 0.55006564, 'auroc': 0.79545957, 'binary_precision': 0.10031775, 'binary_recall': 0.5325301, 'binary_specificity': 0.88153726, 'binary_f1_score': 0.16883117}
confusion matrix:
       0     1
0  14749  1982
1    194   221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7717026, 'precision': 0.60061204, 'recall': 0.78373146, 'specificity': 0.78373146, 'f1': 0.60477656, 'auroc': 0.852, 'binary_precision': 0.22246298, 'binary_recall': 0.79792744, 'binary_specificity': 0.7695354, 'binary_f1_score': 0.34792432}
confusion matrix:
      0     1
0  7189  2153
1   156   616
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 23:34:58.527947,epoch time: 0:17:22.841230,used: 1:09:44.918633,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88712096, 'precision': 0.8878803, 'recall': 0.8871341, 'specificity': 0.8871341, 'f1': 0.88706815, 'auroc': 0.95505106, 'binary_precision': 0.9051906, 'binary_recall': 0.8649726, 'binary_specificity': 0.9092956, 'binary_f1_score': 0.8846247}
confusion matrix:
       0      1
0  23017   2296
1   3422  21921
---- Validation: 
scalar performance:
{'acc': 0.86311674, 'precision': 0.54421043, 'recall': 0.7265971, 'specificity': 0.7265971, 'f1': 0.548182, 'auroc': 0.8022071, 'binary_precision': 0.10016556, 'binary_recall': 0.5831325, 'binary_specificity': 0.8700616, 'binary_f1_score': 0.17096433}
confusion matrix:
       0     1
0  14557  2174
1    173   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77091163, 'precision': 0.6024214, 'recall': 0.7910272, 'specificity': 0.7910272, 'f1': 0.606377, 'auroc': 0.8630684, 'binary_precision': 0.22440243, 'binary_recall': 0.8147668, 'binary_specificity': 0.7672875, 'binary_f1_score': 0.3518881}
confusion matrix:
      0     1
0  7168  2174
1   143   629
early stop counter: 1
val acc:0.8631167411804199, best validation acc: 0.8730899095535278, corresponding to test acc:                         0.7717025876045227 / 0.7717025876045227
after epoch: 5,now: 2024-08-06 23:52:03.711735,epoch time: 0:17:05.183788,used: 1:26:50.102421,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.89519507, 'precision': 0.8954567, 'recall': 0.89520264, 'specificity': 0.89520264, 'f1': 0.895179, 'auroc': 0.9603021, 'binary_precision': 0.90577656, 'binary_recall': 0.8822949, 'binary_specificity': 0.90811044, 'binary_f1_score': 0.89388156}
confusion matrix:
       0      1
0  22987   2326
1   2983  22360
---- Validation: 
scalar performance:
{'acc': 0.86871576, 'precision': 0.54632086, 'recall': 0.72946596, 'specificity': 0.72946596, 'f1': 0.552817, 'auroc': 0.8082934, 'binary_precision': 0.10431034, 'binary_recall': 0.5831325, 'binary_specificity': 0.8757994, 'binary_f1_score': 0.17696527}
confusion matrix:
       0     1
0  14653  2078
1    173   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7859403, 'precision': 0.60921735, 'recall': 0.79975665, 'specificity': 0.79975665, 'f1': 0.6195186, 'auroc': 0.870204, 'binary_precision': 0.23746702, 'binary_recall': 0.81606215, 'binary_specificity': 0.7834511, 'binary_f1_score': 0.3678832}
confusion matrix:
      0     1
0  7319  2023
1   142   630
new oracle model saved
early stop counter: 2
val acc:0.868715763092041, best validation acc: 0.8730899095535278, corresponding to test acc:                         0.7717025876045227 / 0.7859402894973755
after epoch: 6,now: 2024-08-07 00:09:02.729792,epoch time: 0:16:59.018057,used: 1:43:49.120478,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90107787, 'precision': 0.90158725, 'recall': 0.90108705, 'specificity': 0.90108705, 'f1': 0.90104795, 'auroc': 0.96358395, 'binary_precision': 0.91601866, 'binary_recall': 0.8832327, 'binary_specificity': 0.9189413, 'binary_f1_score': 0.899327}
confusion matrix:
       0      1
0  23263   2052
1   2959  22382
---- Validation: 
scalar performance:
{'acc': 0.8605506, 'precision': 0.5448609, 'recall': 0.7346816, 'specificity': 0.7346816, 'f1': 0.5484032, 'auroc': 0.81203234, 'binary_precision': 0.10096931, 'binary_recall': 0.60240966, 'binary_specificity': 0.86695355, 'binary_f1_score': 0.17295054}
confusion matrix:
       0     1
0  14505  2226
1    165   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78673124, 'precision': 0.60975, 'recall': 0.800779, 'specificity': 0.800779, 'f1': 0.6203948, 'auroc': 0.8743428, 'binary_precision': 0.23838307, 'binary_recall': 0.81735754, 'binary_specificity': 0.7842004, 'binary_f1_score': 0.36911377}
confusion matrix:
      0     1
0  7326  2016
1   141   631
new oracle model saved
early stop counter: 3
val acc:0.860550582408905, best validation acc: 0.8730899095535278, corresponding to test acc:                         0.7717025876045227 / 0.7867312431335449
after epoch: 7,now: 2024-08-07 00:25:58.860636,epoch time: 0:16:56.130844,used: 2:00:45.251322,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90506554, 'precision': 0.90673685, 'recall': 0.9050833, 'specificity': 0.9050833, 'f1': 0.90497065, 'auroc': 0.9660504, 'binary_precision': 0.9329482, 'binary_recall': 0.8729777, 'binary_specificity': 0.9371889, 'binary_f1_score': 0.90196717}
confusion matrix:
       0      1
0  23724   1590
1   3219  22123
---- Validation: 
scalar performance:
{'acc': 0.8849878, 'precision': 0.55179274, 'recall': 0.7284043, 'specificity': 0.7284043, 'f1': 0.564946, 'auroc': 0.8151486, 'binary_precision': 0.115555555, 'binary_recall': 0.5638554, 'binary_specificity': 0.8929532, 'binary_f1_score': 0.19180328}
confusion matrix:
       0     1
0  14940  1791
1    181   234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81876606, 'precision': 0.62402385, 'recall': 0.8080195, 'specificity': 0.8080195, 'f1': 0.6472007, 'auroc': 0.87575364, 'binary_precision': 0.2682394, 'binary_recall': 0.7953368, 'binary_specificity': 0.8207022, 'binary_f1_score': 0.4011761}
confusion matrix:
      0     1
0  7667  1675
1   158   614
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-07 00:42:54.764280,epoch time: 0:16:55.903644,used: 2:17:41.154966,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.909606, 'precision': 0.91060144, 'recall': 0.9096206, 'specificity': 0.9096206, 'f1': 0.9095533, 'auroc': 0.9690427, 'binary_precision': 0.9309672, 'binary_recall': 0.88493866, 'binary_specificity': 0.9343025, 'binary_f1_score': 0.9073696}
confusion matrix:
       0      1
0  23650   1663
1   2916  22427
---- Validation: 
scalar performance:
{'acc': 0.8726817, 'precision': 0.5487483, 'recall': 0.7361979, 'specificity': 0.7361979, 'f1': 0.55744004, 'auroc': 0.8190955, 'binary_precision': 0.108849555, 'binary_recall': 0.5927711, 'binary_specificity': 0.87962466, 'binary_f1_score': 0.18392521}
confusion matrix:
       0     1
0  14717  2014
1    169   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81184494, 'precision': 0.6225507, 'recall': 0.81377935, 'specificity': 0.81377935, 'f1': 0.6434206, 'auroc': 0.8790788, 'binary_precision': 0.26348808, 'binary_recall': 0.81606215, 'binary_specificity': 0.8114965, 'binary_f1_score': 0.398356}
confusion matrix:
      0     1
0  7581  1761
1   142   630
early stop counter: 1
val acc:0.8726816773414612, best validation acc: 0.8849877715110779, corresponding to test acc:                         0.8187660574913025 / 0.8187660574913025
after epoch: 9,now: 2024-08-07 00:59:50.301280,epoch time: 0:16:55.537000,used: 2:34:36.691966,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9165351, 'precision': 0.9175651, 'recall': 0.9165498, 'specificity': 0.9165498, 'f1': 0.9164855, 'auroc': 0.97177136, 'binary_precision': 0.9384526, 'binary_recall': 0.8916466, 'binary_specificity': 0.941453, 'binary_f1_score': 0.91445106}
confusion matrix:
       0      1
0  23831   1482
1   2746  22597
---- Validation: 
scalar performance:
{'acc': 0.86947393, 'precision': 0.5478397, 'recall': 0.7369041, 'specificity': 0.7369041, 'f1': 0.55525106, 'auroc': 0.8211144, 'binary_precision': 0.106942646, 'binary_recall': 0.5975904, 'binary_specificity': 0.8762178, 'binary_f1_score': 0.18141916}
confusion matrix:
       0     1
0  14660  2071
1    167   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8136247, 'precision': 0.6237324, 'recall': 0.8153369, 'specificity': 0.8153369, 'f1': 0.64533013, 'auroc': 0.8803007, 'binary_precision': 0.26568422, 'binary_recall': 0.81735754, 'binary_specificity': 0.8133162, 'binary_f1_score': 0.40101686}
confusion matrix:
      0     1
0  7598  1744
1   141   631
early stop counter: 2
val acc:0.869473934173584, best validation acc: 0.8849877715110779, corresponding to test acc:                         0.8187660574913025 / 0.8187660574913025
after epoch: 10,now: 2024-08-07 01:16:43.857166,epoch time: 0:16:53.555886,used: 2:51:30.247852,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9171075, 'precision': 0.91925555, 'recall': 0.9171288, 'specificity': 0.9171288, 'f1': 0.917004, 'auroc': 0.9728617, 'binary_precision': 0.94941336, 'binary_recall': 0.881269, 'binary_specificity': 0.95298856, 'binary_f1_score': 0.9140729}
confusion matrix:
       0      1
0  24123   1190
1   3009  22334
---- Validation: 
scalar performance:
{'acc': 0.8858626, 'precision': 0.55378234, 'recall': 0.7370771, 'specificity': 0.7370771, 'f1': 0.56809175, 'auroc': 0.82417285, 'binary_precision': 0.11907115, 'binary_recall': 0.58072287, 'binary_specificity': 0.89343137, 'binary_f1_score': 0.19762199}
confusion matrix:
       0     1
0  14948  1783
1    174   241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8339925, 'precision': 0.63421196, 'recall': 0.81745017, 'specificity': 0.81745017, 'f1': 0.6631328, 'auroc': 0.8832257, 'binary_precision': 0.28798503, 'binary_recall': 0.79792744, 'binary_specificity': 0.83697283, 'binary_f1_score': 0.42322224}
confusion matrix:
      0     1
0  7819  1523
1   156   616
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-07 01:33:41.206218,epoch time: 0:16:57.349052,used: 3:08:27.596904,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92172694, 'precision': 0.92278796, 'recall': 0.92174184, 'specificity': 0.92174184, 'f1': 0.9216796, 'auroc': 0.97519934, 'binary_precision': 0.94411665, 'binary_recall': 0.89661837, 'binary_specificity': 0.94686526, 'binary_f1_score': 0.9197547}
confusion matrix:
       0      1
0  23968   1345
1   2620  22723
---- Validation: 
scalar performance:
{'acc': 0.8683075, 'precision': 0.54917663, 'recall': 0.74688077, 'specificity': 0.74688077, 'f1': 0.5568943, 'auroc': 0.82747936, 'binary_precision': 0.109036915, 'binary_recall': 0.6192771, 'binary_specificity': 0.8744845, 'binary_f1_score': 0.1854257}
confusion matrix:
       0     1
0  14631  2100
1    158   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8195571, 'precision': 0.62756526, 'recall': 0.8197365, 'specificity': 0.8197365, 'f1': 0.65154076, 'auroc': 0.8847945, 'binary_precision': 0.27296248, 'binary_recall': 0.8199482, 'binary_specificity': 0.8195247, 'binary_f1_score': 0.4095762}
confusion matrix:
      0     1
0  7656  1686
1   139   633
early stop counter: 1
val acc:0.8683074712753296, best validation acc: 0.8858625888824463, corresponding to test acc:                         0.8339924812316895 / 0.8339924812316895
after epoch: 12,now: 2024-08-07 01:50:34.217532,epoch time: 0:16:53.011314,used: 3:25:20.608218,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9238392, 'precision': 0.9253627, 'recall': 0.923857, 'specificity': 0.923857, 'f1': 0.9237731, 'auroc': 0.9759631, 'binary_precision': 0.9509676, 'binary_recall': 0.8938563, 'binary_specificity': 0.9538577, 'binary_f1_score': 0.921528}
confusion matrix:
       0      1
0  24145   1168
1   2690  22653
---- Validation: 
scalar performance:
{'acc': 0.8735565, 'precision': 0.5501474, 'recall': 0.7425208, 'specificity': 0.7425208, 'f1': 0.55972755, 'auroc': 0.82887626, 'binary_precision': 0.1113082, 'binary_recall': 0.6048193, 'binary_specificity': 0.8802223, 'binary_f1_score': 0.18801497}
confusion matrix:
       0     1
0  14727  2004
1    164   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83053195, 'precision': 0.63344467, 'recall': 0.82151836, 'specificity': 0.82151836, 'f1': 0.66141206, 'auroc': 0.8856325, 'binary_precision': 0.28532362, 'binary_recall': 0.81088084, 'binary_specificity': 0.8321559, 'binary_f1_score': 0.42211732}
confusion matrix:
      0     1
0  7774  1568
1   146   626
early stop counter: 2
val acc:0.8735564947128296, best validation acc: 0.8858625888824463, corresponding to test acc:                         0.8339924812316895 / 0.8339924812316895
after epoch: 13,now: 2024-08-07 02:07:26.151141,epoch time: 0:16:51.933609,used: 3:42:12.541827,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9251816, 'precision': 0.9262988, 'recall': 0.9251948, 'specificity': 0.9251948, 'f1': 0.9251341, 'auroc': 0.9766431, 'binary_precision': 0.9482508, 'binary_recall': 0.8995304, 'binary_specificity': 0.9508592, 'binary_f1_score': 0.9232483}
confusion matrix:
       0      1
0  24071   1244
1   2546  22795
---- Validation: 
scalar performance:
{'acc': 0.86416656, 'precision': 0.54911304, 'recall': 0.7541585, 'specificity': 0.7541585, 'f1': 0.5556427, 'auroc': 0.832609, 'binary_precision': 0.108428806, 'binary_recall': 0.6385542, 'binary_specificity': 0.8697627, 'binary_f1_score': 0.1853795}
confusion matrix:
       0     1
0  14552  2179
1    150   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231165, 'precision': 0.62959915, 'recall': 0.8210691, 'specificity': 0.8210691, 'f1': 0.65492797, 'auroc': 0.8872616, 'binary_precision': 0.27707145, 'binary_recall': 0.81865287, 'binary_specificity': 0.8234853, 'binary_f1_score': 0.41401896}
confusion matrix:
      0     1
0  7693  1649
1   140   632
early stop counter: 3
val acc:0.8641665577888489, best validation acc: 0.8858625888824463, corresponding to test acc:                         0.8339924812316895 / 0.8339924812316895
after epoch: 14,now: 2024-08-07 02:24:21.109774,epoch time: 0:16:54.958633,used: 3:59:07.500460,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92818224, 'precision': 0.9286277, 'recall': 0.9281906, 'specificity': 0.9281906, 'f1': 0.9281645, 'auroc': 0.97792536, 'binary_precision': 0.94257516, 'binary_recall': 0.9120003, 'binary_specificity': 0.9443808, 'binary_f1_score': 0.9270357}
confusion matrix:
       0      1
0  23907   1408
1   2230  23111
---- Validation: 
scalar performance:
{'acc': 0.8503441, 'precision': 0.5467849, 'recall': 0.7635249, 'specificity': 0.7635249, 'f1': 0.5481445, 'auroc': 0.83431625, 'binary_precision': 0.10299003, 'binary_recall': 0.67228913, 'binary_specificity': 0.85476065, 'binary_f1_score': 0.17861715}
confusion matrix:
       0     1
0  14301  2430
1    136   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8121416, 'precision': 0.6241656, 'recall': 0.8192872, 'specificity': 0.8192872, 'f1': 0.64535135, 'auroc': 0.88764906, 'binary_precision': 0.26558605, 'binary_recall': 0.8277202, 'binary_specificity': 0.8108542, 'binary_f1_score': 0.40213972}
confusion matrix:
      0     1
0  7575  1767
1   133   639
early stop counter: 4
val acc:0.8503441214561462, best validation acc: 0.8858625888824463, corresponding to test acc:                         0.8339924812316895 / 0.8339924812316895
after epoch: 15,now: 2024-08-07 02:41:11.563046,epoch time: 0:16:50.453272,used: 4:15:57.953732,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9303143, 'precision': 0.9311063, 'recall': 0.930327, 'specificity': 0.930327, 'f1': 0.93028367, 'auroc': 0.9793049, 'binary_precision': 0.94973403, 'binary_recall': 0.9088111, 'binary_specificity': 0.9518429, 'binary_f1_score': 0.9288221}
confusion matrix:
       0      1
0  24094   1219
1   2311  23032
---- Validation: 
scalar performance:
{'acc': 0.8590342, 'precision': 0.5487077, 'recall': 0.7609281, 'specificity': 0.7609281, 'f1': 0.55356187, 'auroc': 0.8368435, 'binary_precision': 0.10714286, 'binary_recall': 0.6578313, 'binary_specificity': 0.8640249, 'binary_f1_score': 0.18427269}
confusion matrix:
       0     1
0  14456  2275
1    142   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8230176, 'precision': 0.62953734, 'recall': 0.8210156, 'specificity': 0.8210156, 'f1': 0.6548281, 'auroc': 0.8877354, 'binary_precision': 0.27695003, 'binary_recall': 0.81865287, 'binary_specificity': 0.82337826, 'binary_f1_score': 0.41388342}
confusion matrix:
      0     1
0  7692  1650
1   140   632
early stop counter: 5
val acc:0.8590341806411743, best validation acc: 0.8858625888824463, corresponding to test acc:                         0.8339924812316895 / 0.8339924812316895
after epoch: 16,now: 2024-08-07 02:58:01.632554,epoch time: 0:16:50.069508,used: 4:32:48.023240,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93185407, 'precision': 0.9332838, 'recall': 0.9318677, 'specificity': 0.9318677, 'f1': 0.93179923, 'auroc': 0.9798895, 'binary_precision': 0.9582915, 'binary_recall': 0.90307814, 'binary_specificity': 0.9606573, 'binary_f1_score': 0.9298659}
confusion matrix:
       0      1
0  24320    996
1   2456  22884
---- Validation: 
scalar performance:
{'acc': 0.8713403, 'precision': 0.5512291, 'recall': 0.75313455, 'specificity': 0.75313455, 'f1': 0.5607296, 'auroc': 0.83673304, 'binary_precision': 0.112840466, 'binary_recall': 0.62891567, 'binary_specificity': 0.8773534, 'binary_f1_score': 0.19134897}
confusion matrix:
       0     1
0  14679  2052
1    154   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83636546, 'precision': 0.63650906, 'recall': 0.8211112, 'specificity': 0.8211112, 'f1': 0.66642106, 'auroc': 0.8880385, 'binary_precision': 0.29203957, 'binary_recall': 0.8031088, 'binary_specificity': 0.83911365, 'binary_f1_score': 0.42832473}
confusion matrix:
      0     1
0  7839  1503
1   152   620
new oracle model saved
early stop counter: 6
val acc:0.871340274810791, best validation acc: 0.8858625888824463, corresponding to test acc:                         0.8339924812316895 / 0.8363654613494873
after epoch: 17,now: 2024-08-07 03:14:52.959603,epoch time: 0:16:51.327049,used: 4:49:39.350289,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9337887, 'precision': 0.9341465, 'recall': 0.93379784, 'specificity': 0.93379784, 'f1': 0.9337759, 'auroc': 0.98170614, 'binary_precision': 0.9467696, 'binary_recall': 0.91934973, 'binary_specificity': 0.9482459, 'binary_f1_score': 0.93285817}
confusion matrix:
       0      1
0  24002   1310
1   2044  23300
---- Validation: 
scalar performance:
{'acc': 0.83558846, 'precision': 0.5450255, 'recall': 0.77476305, 'specificity': 0.77476305, 'f1': 0.5408957, 'auroc': 0.84010327, 'binary_precision': 0.0985304, 'binary_recall': 0.7108434, 'binary_specificity': 0.8386827, 'binary_f1_score': 0.17307128}
confusion matrix:
       0     1
0  14032  2699
1    120   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8096698, 'precision': 0.62405086, 'recall': 0.82270235, 'specificity': 0.82270235, 'f1': 0.64440644, 'auroc': 0.88969207, 'binary_precision': 0.2644054, 'binary_recall': 0.8380829, 'binary_specificity': 0.8073218, 'binary_f1_score': 0.4019882}
confusion matrix:
      0     1
0  7542  1800
1   125   647
early stop counter: 7
val acc:0.8355884552001953, best validation acc: 0.8858625888824463, corresponding to test acc:                         0.8339924812316895 / 0.8363654613494873
after epoch: 18,now: 2024-08-07 03:31:46.519207,epoch time: 0:16:53.559604,used: 5:06:32.909893,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93370974, 'precision': 0.9349483, 'recall': 0.9337256, 'specificity': 0.9337256, 'f1': 0.93366414, 'auroc': 0.9812139, 'binary_precision': 0.95830727, 'binary_recall': 0.90695655, 'binary_specificity': 0.9604946, 'binary_f1_score': 0.93192506}
confusion matrix:
       0      1
0  24313   1000
1   2358  22985
---- Validation: 
scalar performance:
{'acc': 0.8607839, 'precision': 0.5504859, 'recall': 0.7688742, 'specificity': 0.7688742, 'f1': 0.556663, 'auroc': 0.84127617, 'binary_precision': 0.11027668, 'binary_recall': 0.67228913, 'binary_specificity': 0.8654593, 'binary_f1_score': 0.18947367}
confusion matrix:
       0     1
0  14480  2251
1    136   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310263, 'precision': 0.6339348, 'recall': 0.82238007, 'specificity': 0.82238007, 'f1': 0.66211665, 'auroc': 0.8887985, 'binary_precision': 0.2861707, 'binary_recall': 0.81217617, 'binary_specificity': 0.832584, 'binary_f1_score': 0.4232197}
confusion matrix:
      0     1
0  7778  1564
1   145   627
early stop counter: 8
val acc:0.8607838749885559, best validation acc: 0.8858625888824463, corresponding to test acc:                         0.8339924812316895 / 0.8363654613494873
after epoch: 19,now: 2024-08-07 03:48:42.322008,epoch time: 0:16:55.802801,used: 5:23:28.712694,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9356246, 'precision': 0.93632746, 'recall': 0.9356365, 'specificity': 0.9356365, 'f1': 0.9355998, 'auroc': 0.98171234, 'binary_precision': 0.9539885, 'binary_recall': 0.9154796, 'binary_specificity': 0.95579344, 'binary_f1_score': 0.93433744}
confusion matrix:
       0      1
0  24194   1119
1   2142  23201
---- Validation: 
scalar performance:
{'acc': 0.85973406, 'precision': 0.5510221, 'recall': 0.77421105, 'specificity': 0.77421105, 'f1': 0.5571312, 'auroc': 0.8445661, 'binary_precision': 0.11102424, 'binary_recall': 0.6843374, 'binary_specificity': 0.86408466, 'binary_f1_score': 0.1910528}
confusion matrix:
       0     1
0  14457  2274
1    131   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82934546, 'precision': 0.6336055, 'recall': 0.82444096, 'specificity': 0.82444096, 'f1': 0.6613074, 'auroc': 0.88993144, 'binary_precision': 0.28494138, 'binary_recall': 0.81865287, 'binary_specificity': 0.83022904, 'binary_f1_score': 0.42274243}
confusion matrix:
      0     1
0  7756  1586
1   140   632
early stop counter: 9
val acc:0.859734058380127, best validation acc: 0.8858625888824463, corresponding to test acc:                         0.8339924812316895 / 0.8363654613494873
after epoch: 20,now: 2024-08-07 04:05:28.400995,epoch time: 0:16:46.078987,used: 5:40:14.791681,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_25_13_seed_0_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:40:14.791681 at 2024-08-07 04:05:28.400995
persisted model performance metric: 

scalar performance:
{'acc': 0.8339925, 'precision': 0.63421196, 'recall': 0.81745017, 'specificity': 0.81745017, 'f1': 0.6631328, 'auroc': 0.8832257, 'binary_precision': 0.28798503, 'binary_recall': 0.79792744, 'binary_specificity': 0.83697283, 'binary_f1_score': 0.42322224}
confusion matrix:
      0     1
0  7819  1523
1   156   616
oracle model performance metric: 

scalar performance:
{'acc': 0.83636546, 'precision': 0.63650906, 'recall': 0.8211112, 'specificity': 0.8211112, 'f1': 0.66642106, 'auroc': 0.8880385, 'binary_precision': 0.29203957, 'binary_recall': 0.8031088, 'binary_specificity': 0.83911365, 'binary_f1_score': 0.42832473}
confusion matrix:
      0     1
0  7839  1503
1   152   620
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/16.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192600 KiB | 462230 KiB | 361415 GiB | 361415 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 192600 KiB | 462230 KiB | 361415 GiB | 361415 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189463 KiB | 457745 KiB | 361394 GiB | 361394 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |  16649 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44967 KiB |  89169 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |  14567 KiB |  14818 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6815    |   81220 K  |   81216 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46330 K  |   46326 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6815    |   81220 K  |   81216 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46330 K  |   46326 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3184    |   42894 K  |   42894 K  |
|       from large pool |       9    |      18    |   24129 K  |   24129 K  |
|       from small pool |      26    |    3176    |   18765 K  |   18765 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361415 GiB | 361415 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361415 GiB | 361415 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361394 GiB | 361394 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42896 K  |   42896 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18767 K  |   18767 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361415 GiB | 361415 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361415 GiB | 361415 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361394 GiB | 361394 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42896 K  |   42896 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18767 K  |   18767 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679

 Experiment start at: 2024-08-07 04:31:27.701555
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6339117, 'precision': 0.6356893, 'recall': 0.6338639, 'specificity': 0.6338639, 'f1': 0.6326586, 'auroc': 0.6701902, 'binary_precision': 0.62036383, 'binary_recall': 0.69174826, 'binary_specificity': 0.57597953, 'binary_f1_score': 0.65411425}
confusion matrix:
       0      1
0  14627  10768
1   7841  17596
---- Validation: 
scalar performance:
{'acc': 0.8695906, 'precision': 0.50986993, 'recall': 0.5409537, 'specificity': 0.5409537, 'f1': 0.49992496, 'auroc': 0.7371119, 'binary_precision': 0.042639595, 'binary_recall': 0.1948956, 'binary_specificity': 0.88701177, 'binary_f1_score': 0.069970846}
confusion matrix:
       0     1
0  14806  1886
1    347    84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8035874, 'precision': 0.4828442, 'recall': 0.47140267, 'specificity': 0.47140267, 'f1': 0.47417438, 'auroc': 0.59798086, 'binary_precision': 0.04528582, 'binary_recall': 0.08058124, 'binary_specificity': 0.8622241, 'binary_f1_score': 0.057984788}
confusion matrix:
      0     1
0  8048  1286
1   696    61
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 04:49:32.344779,epoch time: 0:18:04.643224,used: 0:18:04.643224,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.76597416, 'precision': 0.7670555, 'recall': 0.7659465, 'specificity': 0.7659465, 'f1': 0.7657243, 'auroc': 0.83548117, 'binary_precision': 0.7502772, 'binary_recall': 0.7979401, 'binary_specificity': 0.7339529, 'binary_f1_score': 0.773375}
confusion matrix:
       0      1
0  18638   6756
1   5140  20298
---- Validation: 
scalar performance:
{'acc': 0.86380893, 'precision': 0.52212554, 'recall': 0.60014576, 'specificity': 0.60014576, 'f1': 0.5164, 'auroc': 0.770449, 'binary_precision': 0.06379073, 'binary_recall': 0.3225058, 'binary_specificity': 0.87778574, 'binary_f1_score': 0.1065134}
confusion matrix:
       0     1
0  14652  2040
1    292   139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.788128, 'precision': 0.531039, 'recall': 0.56683195, 'specificity': 0.56683195, 'f1': 0.52835447, 'auroc': 0.7181519, 'binary_precision': 0.12574525, 'binary_recall': 0.30647293, 'binary_specificity': 0.82719094, 'binary_f1_score': 0.17832436}
confusion matrix:
      0     1
0  7721  1613
1   525   232
early stop counter: 1
val acc:0.8638089299201965, best validation acc: 0.8695905804634094, corresponding to test acc:                         0.8035873770713806 / 0.8035873770713806
after epoch: 2,now: 2024-08-07 05:06:26.500226,epoch time: 0:16:54.155447,used: 0:34:58.798671,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8210773, 'precision': 0.8212917, 'recall': 0.8210869, 'specificity': 0.8210869, 'f1': 0.82105035, 'auroc': 0.8986901, 'binary_precision': 0.82978123, 'binary_recall': 0.80821705, 'binary_specificity': 0.8339568, 'binary_f1_score': 0.81885713}
confusion matrix:
       0      1
0  21180   4217
1   4878  20557
---- Validation: 
scalar performance:
{'acc': 0.89020616, 'precision': 0.52965915, 'recall': 0.60916466, 'specificity': 0.60916466, 'f1': 0.53350353, 'auroc': 0.7883601, 'binary_precision': 0.07853403, 'binary_recall': 0.31322506, 'binary_specificity': 0.9051042, 'binary_f1_score': 0.12558138}
confusion matrix:
       0     1
0  15108  1584
1    296   135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.819344, 'precision': 0.56867117, 'recall': 0.63954365, 'specificity': 0.63954365, 'f1': 0.5796558, 'auroc': 0.78041995, 'binary_precision': 0.18903151, 'binary_recall': 0.42800528, 'binary_specificity': 0.8510821, 'binary_f1_score': 0.26224202}
confusion matrix:
      0     1
0  7944  1390
1   433   324
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 05:23:11.034250,epoch time: 0:16:44.534024,used: 0:51:43.332695,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85099936, 'precision': 0.85101223, 'recall': 0.85100174, 'specificity': 0.85100174, 'f1': 0.8509985, 'auroc': 0.9284835, 'binary_precision': 0.85333914, 'binary_recall': 0.8479714, 'binary_specificity': 0.85403216, 'binary_f1_score': 0.8506468}
confusion matrix:
       0      1
0  21689   3707
1   3867  21569
---- Validation: 
scalar performance:
{'acc': 0.88979733, 'precision': 0.541108, 'recall': 0.65868104, 'specificity': 0.65868104, 'f1': 0.5502493, 'auroc': 0.80387026, 'binary_precision': 0.09867696, 'binary_recall': 0.4153132, 'binary_specificity': 0.9020489, 'binary_f1_score': 0.15946548}
confusion matrix:
       0     1
0  15057  1635
1    252   179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8186503, 'precision': 0.59878683, 'recall': 0.72717416, 'specificity': 0.72717416, 'f1': 0.61689246, 'auroc': 0.8219048, 'binary_precision': 0.2332173, 'binary_recall': 0.6195509, 'binary_specificity': 0.8347975, 'binary_f1_score': 0.33887285}
confusion matrix:
      0     1
0  7792  1542
1   288   469
early stop counter: 1
val acc:0.8897973299026489, best validation acc: 0.8902061581611633, corresponding to test acc:                         0.8193439841270447 / 0.8193439841270447
after epoch: 4,now: 2024-08-07 05:40:05.901473,epoch time: 0:16:54.867223,used: 1:08:38.199918,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8720294, 'precision': 0.87220395, 'recall': 0.872038, 'specificity': 0.872038, 'f1': 0.8720162, 'auroc': 0.9447511, 'binary_precision': 0.88046145, 'binary_recall': 0.861181, 'binary_specificity': 0.88289493, 'binary_f1_score': 0.87071455}
confusion matrix:
       0      1
0  22422   2974
1   3531  21905
---- Validation: 
scalar performance:
{'acc': 0.8972143, 'precision': 0.54931474, 'recall': 0.6816976, 'specificity': 0.6816976, 'f1': 0.5636586, 'auroc': 0.8147807, 'binary_precision': 0.11388727, 'binary_recall': 0.45475638, 'binary_specificity': 0.9086389, 'binary_f1_score': 0.18215615}
confusion matrix:
       0     1
0  15167  1525
1    235   196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8344069, 'precision': 0.6145371, 'recall': 0.75329256, 'specificity': 0.75329256, 'f1': 0.6390247, 'auroc': 0.84685636, 'binary_precision': 0.26073298, 'binary_recall': 0.65786, 'binary_specificity': 0.8487251, 'binary_f1_score': 0.37345332}
confusion matrix:
      0     1
0  7922  1412
1   259   498
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 05:56:56.113861,epoch time: 0:16:50.212388,used: 1:25:28.412306,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88458055, 'precision': 0.8860724, 'recall': 0.88460505, 'specificity': 0.88460505, 'f1': 0.88447356, 'auroc': 0.9541193, 'binary_precision': 0.9102688, 'binary_recall': 0.8534754, 'binary_specificity': 0.91573477, 'binary_f1_score': 0.8809577}
confusion matrix:
       0      1
0  23256   2140
1   3727  21709
---- Validation: 
scalar performance:
{'acc': 0.91537696, 'precision': 0.5597073, 'recall': 0.6819724, 'specificity': 0.6819724, 'f1': 0.5806671, 'auroc': 0.8215884, 'binary_precision': 0.1348637, 'binary_recall': 0.4361949, 'binary_specificity': 0.9277498, 'binary_f1_score': 0.20602739}
confusion matrix:
       0     1
0  15486  1206
1    243   188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8584878, 'precision': 0.6331119, 'recall': 0.7632748, 'specificity': 0.7632748, 'f1': 0.66404074, 'auroc': 0.86185336, 'binary_precision': 0.29752564, 'binary_recall': 0.65125495, 'binary_specificity': 0.8752946, 'binary_f1_score': 0.4084507}
confusion matrix:
      0     1
0  8170  1164
1   264   493
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 06:14:26.009791,epoch time: 0:17:29.895930,used: 1:42:58.308236,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8931185, 'precision': 0.8951492, 'recall': 0.8931453, 'specificity': 0.8931453, 'f1': 0.8929857, 'auroc': 0.9595933, 'binary_precision': 0.9236635, 'binary_recall': 0.85724396, 'binary_specificity': 0.92904675, 'binary_f1_score': 0.88921523}
confusion matrix:
       0      1
0  23595   1802
1   3631  21804
---- Validation: 
scalar performance:
{'acc': 0.9216259, 'precision': 0.56838, 'recall': 0.69647884, 'specificity': 0.69647884, 'f1': 0.59328294, 'auroc': 0.8291471, 'binary_precision': 0.15149197, 'binary_recall': 0.45939675, 'binary_specificity': 0.93356097, 'binary_f1_score': 0.22784811}
confusion matrix:
       0     1
0  15583  1109
1    233   198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86948764, 'precision': 0.6462097, 'recall': 0.77711093, 'specificity': 0.77711093, 'f1': 0.68037605, 'auroc': 0.87335443, 'binary_precision': 0.32188296, 'binary_recall': 0.668428, 'binary_specificity': 0.88579386, 'binary_f1_score': 0.43452126}
confusion matrix:
      0     1
0  8268  1066
1   251   506
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-07 06:33:23.288594,epoch time: 0:18:57.278803,used: 2:01:55.587039,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9026007, 'precision': 0.903841, 'recall': 0.9026248, 'specificity': 0.9026248, 'f1': 0.9025296, 'auroc': 0.96459675, 'binary_precision': 0.92643934, 'binary_recall': 0.8748329, 'binary_specificity': 0.93041664, 'binary_f1_score': 0.89989686}
confusion matrix:
       0      1
0  23627   1767
1   3184  22254
---- Validation: 
scalar performance:
{'acc': 0.9108217, 'precision': 0.5651093, 'recall': 0.71693045, 'specificity': 0.71693045, 'f1': 0.5885851, 'auroc': 0.83487225, 'binary_precision': 0.1436931, 'binary_recall': 0.512761, 'binary_specificity': 0.9210999, 'binary_f1_score': 0.22447944}
confusion matrix:
       0     1
0  15375  1317
1    210   221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8672084, 'precision': 0.64996743, 'recall': 0.79833543, 'specificity': 0.79833543, 'f1': 0.6860915, 'auroc': 0.88069975, 'binary_precision': 0.3253445, 'binary_recall': 0.7173051, 'binary_specificity': 0.87936574, 'binary_f1_score': 0.44765043}
confusion matrix:
      0     1
0  8208  1126
1   214   543
early stop counter: 1
val acc:0.9108216762542725, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8694876432418823
after epoch: 8,now: 2024-08-07 06:50:22.990252,epoch time: 0:16:59.701658,used: 2:18:55.288697,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90553194, 'precision': 0.906842, 'recall': 0.90555435, 'specificity': 0.90555435, 'f1': 0.90545917, 'auroc': 0.96664596, 'binary_precision': 0.9301259, 'binary_recall': 0.8771033, 'binary_specificity': 0.9340054, 'binary_f1_score': 0.90283674}
confusion matrix:
       0      1
0  23720   1676
1   3126  22310
---- Validation: 
scalar performance:
{'acc': 0.9094785, 'precision': 0.56585276, 'recall': 0.72415245, 'specificity': 0.72415245, 'f1': 0.5896206, 'auroc': 0.8380844, 'binary_precision': 0.1447619, 'binary_recall': 0.5290023, 'binary_specificity': 0.91930264, 'binary_f1_score': 0.22731805}
confusion matrix:
       0     1
0  15345  1347
1    203   228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8724606, 'precision': 0.65756536, 'recall': 0.80967164, 'specificity': 0.80967164, 'f1': 0.6957964, 'auroc': 0.88557863, 'binary_precision': 0.3388078, 'binary_recall': 0.7357992, 'binary_specificity': 0.883544, 'binary_f1_score': 0.46397334}
confusion matrix:
      0     1
0  8247  1087
1   200   557
new oracle model saved
early stop counter: 2
val acc:0.909478485584259, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8724606037139893
after epoch: 9,now: 2024-08-07 07:07:17.138811,epoch time: 0:16:54.148559,used: 2:35:49.437256,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91257477, 'precision': 0.91411257, 'recall': 0.9125964, 'specificity': 0.9125964, 'f1': 0.91249657, 'auroc': 0.97052944, 'binary_precision': 0.9395259, 'binary_recall': 0.88204765, 'binary_specificity': 0.94314516, 'binary_f1_score': 0.90988}
confusion matrix:
       0      1
0  23954   1444
1   3000  22434
---- Validation: 
scalar performance:
{'acc': 0.90708405, 'precision': 0.56700265, 'recall': 0.736486, 'specificity': 0.736486, 'f1': 0.59116185, 'auroc': 0.84385395, 'binary_precision': 0.14634146, 'binary_recall': 0.55684453, 'binary_specificity': 0.9161275, 'binary_f1_score': 0.2317721}
confusion matrix:
       0     1
0  15292  1400
1    191   240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8755326, 'precision': 0.6616222, 'recall': 0.8143669, 'specificity': 0.8143669, 'f1': 0.7008575, 'auroc': 0.8902834, 'binary_precision': 0.34627235, 'binary_recall': 0.7424042, 'binary_specificity': 0.88632953, 'binary_f1_score': 0.47226894}
confusion matrix:
      0     1
0  8273  1061
1   195   562
new oracle model saved
early stop counter: 3
val acc:0.907084047794342, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8755326271057129
after epoch: 10,now: 2024-08-07 07:24:11.487412,epoch time: 0:16:54.348601,used: 2:52:43.785857,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9184765, 'precision': 0.9195198, 'recall': 0.9184972, 'specificity': 0.9184972, 'f1': 0.9184284, 'auroc': 0.97291225, 'binary_precision': 0.94064814, 'binary_recall': 0.8934623, 'binary_specificity': 0.94353217, 'binary_f1_score': 0.91644824}
confusion matrix:
       0      1
0  23961   1434
1   2710  22727
---- Validation: 
scalar performance:
{'acc': 0.9034048, 'precision': 0.56547695, 'recall': 0.74024963, 'specificity': 0.74024963, 'f1': 0.58851075, 'auroc': 0.8445072, 'binary_precision': 0.14302394, 'binary_recall': 0.5684455, 'binary_specificity': 0.9120537, 'binary_f1_score': 0.2285448}
confusion matrix:
       0     1
0  15224  1468
1    186   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87741554, 'precision': 0.6642952, 'recall': 0.81781244, 'specificity': 0.81781244, 'f1': 0.7041975, 'auroc': 0.89278233, 'binary_precision': 0.35111663, 'binary_recall': 0.74768823, 'binary_specificity': 0.8879366, 'binary_f1_score': 0.47783875}
confusion matrix:
      0     1
0  8288  1046
1   191   566
new oracle model saved
early stop counter: 4
val acc:0.9034047722816467, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8774155378341675
after epoch: 11,now: 2024-08-07 07:41:06.664459,epoch time: 0:16:55.177047,used: 3:09:38.962904,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92164385, 'precision': 0.92268133, 'recall': 0.92166245, 'specificity': 0.92166245, 'f1': 0.92159796, 'auroc': 0.9749861, 'binary_precision': 0.94381, 'binary_recall': 0.89679575, 'binary_specificity': 0.9465291, 'binary_f1_score': 0.9197024}
confusion matrix:
       0      1
0  24039   1358
1   2625  22810
---- Validation: 
scalar performance:
{'acc': 0.8994335, 'precision': 0.56389076, 'recall': 0.74386334, 'specificity': 0.74386334, 'f1': 0.5856252, 'auroc': 0.84774363, 'binary_precision': 0.13958682, 'binary_recall': 0.5800464, 'binary_specificity': 0.90768033, 'binary_f1_score': 0.22502251}
confusion matrix:
       0     1
0  15151  1541
1    181   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87612724, 'precision': 0.66361964, 'recall': 0.82015073, 'specificity': 0.82015073, 'f1': 0.70358026, 'auroc': 0.8947103, 'binary_precision': 0.34923548, 'binary_recall': 0.75429326, 'binary_specificity': 0.88600814, 'binary_f1_score': 0.47742477}
confusion matrix:
      0     1
0  8270  1064
1   186   571
early stop counter: 5
val acc:0.8994334936141968, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8774155378341675
after epoch: 12,now: 2024-08-07 07:58:08.649939,epoch time: 0:17:01.985480,used: 3:26:40.948384,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9229619, 'precision': 0.9243796, 'recall': 0.92298126, 'specificity': 0.92298126, 'f1': 0.92289984, 'auroc': 0.97613585, 'binary_precision': 0.9490754, 'binary_recall': 0.893996, 'binary_specificity': 0.9519666, 'binary_f1_score': 0.92071265}
confusion matrix:
       0      1
0  24179   1220
1   2696  22737
---- Validation: 
scalar performance:
{'acc': 0.9032296, 'precision': 0.5655903, 'recall': 0.74128985, 'specificity': 0.74128985, 'f1': 0.5886595, 'auroc': 0.8481571, 'binary_precision': 0.14318976, 'binary_recall': 0.5707657, 'binary_specificity': 0.91181403, 'binary_f1_score': 0.2289437}
confusion matrix:
       0     1
0  15220  1472
1    185   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87989295, 'precision': 0.6673864, 'recall': 0.8203655, 'specificity': 0.8203655, 'f1': 0.70792794, 'auroc': 0.8956654, 'binary_precision': 0.35700816, 'binary_recall': 0.75033027, 'binary_specificity': 0.8904007, 'binary_f1_score': 0.48381603}
confusion matrix:
      0     1
0  8311  1023
1   189   568
new oracle model saved
early stop counter: 6
val acc:0.9032295942306519, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8798929452896118
after epoch: 13,now: 2024-08-07 08:15:07.022035,epoch time: 0:16:58.372096,used: 3:43:39.320480,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9282735, 'precision': 0.9294845, 'recall': 0.92829454, 'specificity': 0.92829454, 'f1': 0.9282253, 'auroc': 0.97758275, 'binary_precision': 0.95248777, 'binary_recall': 0.90163547, 'binary_specificity': 0.95495355, 'binary_f1_score': 0.9263643}
confusion matrix:
       0      1
0  24252   1144
1   2502  22934
---- Validation: 
scalar performance:
{'acc': 0.9036968, 'precision': 0.5668843, 'recall': 0.74605006, 'specificity': 0.74605006, 'f1': 0.5906454, 'auroc': 0.8516655, 'binary_precision': 0.14551805, 'binary_recall': 0.5800464, 'binary_specificity': 0.9120537, 'binary_f1_score': 0.23266636}
confusion matrix:
       0     1
0  15224  1468
1    181   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88167673, 'precision': 0.66945255, 'recall': 0.8213297, 'specificity': 0.8213297, 'f1': 0.71033514, 'auroc': 0.8971927, 'binary_precision': 0.36109346, 'binary_recall': 0.75033027, 'binary_specificity': 0.8923291, 'binary_f1_score': 0.48755366}
confusion matrix:
      0     1
0  8329  1005
1   189   568
new oracle model saved
early stop counter: 7
val acc:0.9036967754364014, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8816767334938049
after epoch: 14,now: 2024-08-07 08:32:08.277953,epoch time: 0:17:01.255918,used: 4:00:40.576398,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92955226, 'precision': 0.9308938, 'recall': 0.92957544, 'specificity': 0.92957544, 'f1': 0.92949986, 'auroc': 0.9788021, 'binary_precision': 0.9551437, 'binary_recall': 0.9015607, 'binary_specificity': 0.9575901, 'binary_f1_score': 0.927579}
confusion matrix:
       0      1
0  24318   1077
1   2504  22933
---- Validation: 
scalar performance:
{'acc': 0.90299594, 'precision': 0.5668485, 'recall': 0.74795085, 'specificity': 0.74795085, 'f1': 0.59050965, 'auroc': 0.8530153, 'binary_precision': 0.14532872, 'binary_recall': 0.58468676, 'binary_specificity': 0.91121495, 'binary_f1_score': 0.23279446}
confusion matrix:
       0     1
0  15210  1482
1    179   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8825686, 'precision': 0.67107576, 'recall': 0.82423955, 'specificity': 0.82423955, 'f1': 0.7124113, 'auroc': 0.89813733, 'binary_precision': 0.36386767, 'binary_recall': 0.7556143, 'binary_specificity': 0.8928648, 'binary_f1_score': 0.49119797}
confusion matrix:
      0     1
0  8334  1000
1   185   572
new oracle model saved
early stop counter: 8
val acc:0.9029959440231323, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8825685977935791
after epoch: 15,now: 2024-08-07 08:49:34.840169,epoch time: 0:17:26.562216,used: 4:18:07.138614,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.93126374, 'precision': 0.9326217, 'recall': 0.9312848, 'specificity': 0.9312848, 'f1': 0.931212, 'auroc': 0.9792876, 'binary_precision': 0.95704705, 'binary_recall': 0.9031649, 'binary_specificity': 0.95940465, 'binary_f1_score': 0.9293256}
confusion matrix:
       0      1
0  24366   1031
1   2463  22972
---- Validation: 
scalar performance:
{'acc': 0.89960873, 'precision': 0.56609076, 'recall': 0.75412446, 'specificity': 0.75412446, 'f1': 0.5889282, 'auroc': 0.85619986, 'binary_precision': 0.14341085, 'binary_recall': 0.60092807, 'binary_specificity': 0.90732086, 'binary_f1_score': 0.23156013}
confusion matrix:
       0     1
0  15145  1547
1    172   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88227135, 'precision': 0.67143816, 'recall': 0.8271135, 'specificity': 0.8271135, 'f1': 0.7130747, 'auroc': 0.89911115, 'binary_precision': 0.36403784, 'binary_recall': 0.7622193, 'binary_specificity': 0.8920077, 'binary_f1_score': 0.49274123}
confusion matrix:
      0     1
0  8326  1008
1   180   577
early stop counter: 9
val acc:0.8996087312698364, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8825685977935791
after epoch: 16,now: 2024-08-07 09:07:11.983928,epoch time: 0:17:37.143759,used: 4:35:44.282373,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9328376, 'precision': 0.9337265, 'recall': 0.9328573, 'specificity': 0.9328573, 'f1': 0.9328052, 'auroc': 0.9794786, 'binary_precision': 0.95357937, 'binary_recall': 0.91009516, 'binary_specificity': 0.95561945, 'binary_f1_score': 0.93132997}
confusion matrix:
       0      1
0  24267   1127
1   2287  23151
---- Validation: 
scalar performance:
{'acc': 0.89096534, 'precision': 0.56278884, 'recall': 0.76099265, 'specificity': 0.76099265, 'f1': 0.58253276, 'auroc': 0.8572755, 'binary_precision': 0.13627154, 'binary_recall': 0.62412995, 'binary_specificity': 0.8978553, 'binary_f1_score': 0.22370064}
confusion matrix:
       0     1
0  14987  1705
1    162   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8780101, 'precision': 0.66831493, 'recall': 0.8320933, 'specificity': 0.8320933, 'f1': 0.70986867, 'auroc': 0.89971733, 'binary_precision': 0.35653752, 'binary_recall': 0.77807134, 'binary_specificity': 0.88611525, 'binary_f1_score': 0.4889996}
confusion matrix:
      0     1
0  8271  1063
1   168   589
early stop counter: 10
val acc:0.8909653425216675, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8825685977935791
after epoch: 17,now: 2024-08-07 09:24:38.334142,epoch time: 0:17:26.350214,used: 4:53:10.632587,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93468684, 'precision': 0.9354383, 'recall': 0.9347024, 'specificity': 0.9347024, 'f1': 0.9346602, 'auroc': 0.98098993, 'binary_precision': 0.9537155, 'binary_recall': 0.91381955, 'binary_specificity': 0.9555853, 'binary_f1_score': 0.9333413}
confusion matrix:
       0      1
0  24269   1128
1   2192  23243
---- Validation: 
scalar performance:
{'acc': 0.88191324, 'precision': 0.5588097, 'recall': 0.7620003, 'specificity': 0.7620003, 'f1': 0.57469785, 'auroc': 0.8567164, 'binary_precision': 0.12809724, 'binary_recall': 0.63573086, 'binary_specificity': 0.88826984, 'binary_f1_score': 0.21322957}
confusion matrix:
       0     1
0  14827  1865
1    157   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8747399, 'precision': 0.6656596, 'recall': 0.8339672, 'specificity': 0.8339672, 'f1': 0.7068115, 'auroc': 0.89975953, 'binary_precision': 0.35061875, 'binary_recall': 0.78599733, 'binary_specificity': 0.881937, 'binary_f1_score': 0.4849226}
confusion matrix:
      0     1
0  8232  1102
1   162   595
early stop counter: 11
val acc:0.8819132447242737, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8825685977935791
after epoch: 18,now: 2024-08-07 09:42:07.907359,epoch time: 0:17:29.573217,used: 5:10:40.205804,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9334081, 'precision': 0.9344497, 'recall': 0.93342745, 'specificity': 0.93342745, 'f1': 0.9333701, 'auroc': 0.9809597, 'binary_precision': 0.95591944, 'binary_recall': 0.90883, 'binary_specificity': 0.95802486, 'binary_f1_score': 0.93178016}
confusion matrix:
       0      1
0  24330   1066
1   2319  23117
---- Validation: 
scalar performance:
{'acc': 0.88968056, 'precision': 0.5626745, 'recall': 0.76372397, 'specificity': 0.76372397, 'f1': 0.58210707, 'auroc': 0.85766244, 'binary_precision': 0.13586414, 'binary_recall': 0.63109046, 'binary_specificity': 0.89635754, 'binary_f1_score': 0.22359228}
confusion matrix:
       0     1
0  14962  1730
1    159   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8782083, 'precision': 0.66853344, 'recall': 0.8322004, 'specificity': 0.8322004, 'f1': 0.7101319, 'auroc': 0.8999286, 'binary_precision': 0.35696968, 'binary_recall': 0.77807134, 'binary_specificity': 0.88632953, 'binary_f1_score': 0.48940587}
confusion matrix:
      0     1
0  8273  1061
1   168   589
early stop counter: 12
val acc:0.8896805644035339, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8825685977935791
after epoch: 19,now: 2024-08-07 09:59:36.240060,epoch time: 0:17:28.332701,used: 5:28:08.538505,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.936536, 'precision': 0.93745714, 'recall': 0.9365524, 'specificity': 0.9365524, 'f1': 0.93650424, 'auroc': 0.9811022, 'binary_precision': 0.9577082, 'binary_recall': 0.9135016, 'binary_specificity': 0.95960313, 'binary_f1_score': 0.9350827}
confusion matrix:
       0      1
0  24372   1026
1   2200  23234
---- Validation: 
scalar performance:
{'acc': 0.88243884, 'precision': 0.56093365, 'recall': 0.77244115, 'specificity': 0.77244115, 'f1': 0.5779486, 'auroc': 0.86090386, 'binary_precision': 0.13175046, 'binary_recall': 0.6566125, 'binary_specificity': 0.88826984, 'binary_f1_score': 0.21946491}
confusion matrix:
       0     1
0  14827  1865
1    148   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87414527, 'precision': 0.6654715, 'recall': 0.8354666, 'specificity': 0.8354666, 'f1': 0.7066547, 'auroc': 0.900542, 'binary_precision': 0.34991223, 'binary_recall': 0.7899604, 'binary_specificity': 0.8809728, 'binary_f1_score': 0.484996}
confusion matrix:
      0     1
0  8223  1111
1   159   598
early stop counter: 13
val acc:0.8824388384819031, best validation acc: 0.9216259121894836, corresponding to test acc:                         0.8694876432418823 / 0.8825685977935791
after epoch: 20,now: 2024-08-07 10:16:56.479050,epoch time: 0:17:20.238990,used: 5:45:28.777495,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_31_27_seed_1_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:45:28.777495 at 2024-08-07 10:16:56.479050
persisted model performance metric: 

scalar performance:
{'acc': 0.86948764, 'precision': 0.6462097, 'recall': 0.77711093, 'specificity': 0.77711093, 'f1': 0.68037605, 'auroc': 0.87335443, 'binary_precision': 0.32188296, 'binary_recall': 0.668428, 'binary_specificity': 0.88579386, 'binary_f1_score': 0.43452126}
confusion matrix:
      0     1
0  8268  1066
1   251   506
oracle model performance metric: 

scalar performance:
{'acc': 0.8825686, 'precision': 0.67107576, 'recall': 0.82423955, 'specificity': 0.82423955, 'f1': 0.7124113, 'auroc': 0.89813733, 'binary_precision': 0.36386767, 'binary_recall': 0.7556143, 'binary_specificity': 0.8928648, 'binary_f1_score': 0.49119797}
confusion matrix:
      0     1
0  8334  1000
1   185   572
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB | 725950 GiB | 725950 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB | 725950 GiB | 725950 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB | 725908 GiB | 725908 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 711022 GiB | 711022 GiB |
|       from small pool |  16648 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    780 MiB | 272384 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     48 MiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  89169 KiB | 399285 GiB | 399285 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 384170 GiB | 384170 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6837    |  162967 K  |  162962 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92883 K  |   92879 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6837    |  162967 K  |  162962 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92883 K  |   92879 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      57    |      16    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      24    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3196    |   87542 K  |   87542 K  |
|       from large pool |      10    |      23    |   44071 K  |   44071 K  |
|       from small pool |      20    |    3186    |   43470 K  |   43470 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725950 GiB | 725950 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725950 GiB | 725950 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725908 GiB | 725908 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711022 GiB | 711022 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 399285 GiB | 399285 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384171 GiB | 384171 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162967 K  |  162967 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92883 K  |   92883 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162967 K  |  162967 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92883 K  |   92883 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87544 K  |   87544 K  |
|       from large pool |       3    |      23    |   44071 K  |   44071 K  |
|       from small pool |       0    |    3186    |   43472 K  |   43472 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725950 GiB | 725950 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725950 GiB | 725950 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725908 GiB | 725908 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711022 GiB | 711022 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 399285 GiB | 399285 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384171 GiB | 384171 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162967 K  |  162967 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92883 K  |   92883 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162967 K  |  162967 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92883 K  |   92883 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87544 K  |   87544 K  |
|       from large pool |       3    |      23    |   44071 K  |   44071 K  |
|       from small pool |       0    |    3186    |   43472 K  |   43472 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679

 Experiment start at: 2024-08-07 10:46:05.018462
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.73404133, 'precision': 0.735024, 'recall': 0.7340488, 'specificity': 0.7340488, 'f1': 0.73376715, 'auroc': 0.80936646, 'binary_precision': 0.7502791, 'binary_recall': 0.70178694, 'binary_specificity': 0.76631063, 'binary_f1_score': 0.72522336}
confusion matrix:
       0      1
0  19803   6039
1   7710  18144
---- Validation: 
scalar performance:
{'acc': 0.5689675, 'precision': 0.513103, 'recall': 0.6356435, 'specificity': 0.6356435, 'f1': 0.3965631, 'auroc': 0.68078464, 'binary_precision': 0.03905733, 'binary_recall': 0.70574164, 'binary_specificity': 0.5655453, 'binary_f1_score': 0.07401832}
confusion matrix:
      0     1
0  9448  7258
1   123   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5333928, 'precision': 0.55557245, 'recall': 0.69048285, 'specificity': 0.69048285, 'f1': 0.44720018, 'auroc': 0.79444194, 'binary_precision': 0.13163842, 'binary_recall': 0.8770389, 'binary_specificity': 0.5039268, 'binary_f1_score': 0.22891763}
confusion matrix:
      0     1
0  4684  4611
1    98   699
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 11:05:03.699527,epoch time: 0:18:58.681065,used: 0:18:58.681065,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8226362, 'precision': 0.82360375, 'recall': 0.8226436, 'specificity': 0.8226436, 'f1': 0.82250583, 'auroc': 0.8999691, 'binary_precision': 0.8413666, 'binary_recall': 0.79532003, 'binary_specificity': 0.8499671, 'binary_f1_score': 0.8176956}
confusion matrix:
       0      1
0  21964   3877
1   5292  20563
---- Validation: 
scalar performance:
{'acc': 0.68202525, 'precision': 0.5194457, 'recall': 0.6795918, 'specificity': 0.6795918, 'f1': 0.45066428, 'auroc': 0.73192537, 'binary_precision': 0.050598964, 'binary_recall': 0.6770335, 'binary_specificity': 0.6821501, 'binary_f1_score': 0.094160706}
confusion matrix:
       0     1
0  11396  5310
1    135   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6128617, 'precision': 0.5664723, 'recall': 0.7255945, 'specificity': 0.7255945, 'f1': 0.49876282, 'auroc': 0.81361616, 'binary_precision': 0.15290178, 'binary_recall': 0.85947305, 'binary_specificity': 0.591716, 'binary_f1_score': 0.2596172}
confusion matrix:
      0     1
0  5500  3795
1   112   685
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 11:23:37.416702,epoch time: 0:18:33.717175,used: 0:37:32.398240,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.85169065, 'precision': 0.8517258, 'recall': 0.851691, 'specificity': 0.851691, 'f1': 0.851687, 'auroc': 0.928874, 'binary_precision': 0.8552616, 'binary_recall': 0.84669244, 'binary_specificity': 0.85668963, 'binary_f1_score': 0.8509554}
confusion matrix:
       0      1
0  22142   3704
1   3963  21887
---- Validation: 
scalar performance:
{'acc': 0.71753097, 'precision': 0.5238562, 'recall': 0.7071188, 'specificity': 0.7071188, 'f1': 0.46980876, 'auroc': 0.76105666, 'binary_precision': 0.058188364, 'binary_recall': 0.69617224, 'binary_specificity': 0.7180654, 'binary_f1_score': 0.10739989}
confusion matrix:
       0     1
0  11996  4710
1    127   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6410028, 'precision': 0.5727746, 'recall': 0.74316573, 'specificity': 0.74316573, 'f1': 0.5184614, 'auroc': 0.8271555, 'binary_precision': 0.16389154, 'binary_recall': 0.8644918, 'binary_specificity': 0.6218397, 'binary_f1_score': 0.27554488}
confusion matrix:
      0     1
0  5780  3515
1   108   689
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 11:42:12.028987,epoch time: 0:18:34.612285,used: 0:56:07.010525,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.871402, 'precision': 0.87235653, 'recall': 0.87140596, 'specificity': 0.87140596, 'f1': 0.8713204, 'auroc': 0.9434422, 'binary_precision': 0.89124763, 'binary_recall': 0.8460854, 'binary_specificity': 0.8967265, 'binary_f1_score': 0.86807954}
confusion matrix:
       0      1
0  23175   2669
1   3979  21873
---- Validation: 
scalar performance:
{'acc': 0.768512, 'precision': 0.52779454, 'recall': 0.71225476, 'specificity': 0.71225476, 'f1': 0.49388343, 'auroc': 0.77952456, 'binary_precision': 0.066715546, 'binary_recall': 0.65311, 'binary_specificity': 0.7713995, 'binary_f1_score': 0.12106431}
confusion matrix:
       0     1
0  12887  3819
1    145   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69262785, 'precision': 0.58092725, 'recall': 0.756279, 'specificity': 0.756279, 'f1': 0.5512903, 'auroc': 0.83788455, 'binary_precision': 0.18259433, 'binary_recall': 0.8318695, 'binary_specificity': 0.68068856, 'binary_f1_score': 0.299458}
confusion matrix:
      0     1
0  6327  2968
1   134   663
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 12:01:08.972634,epoch time: 0:18:56.943647,used: 1:15:03.954172,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88107395, 'precision': 0.88337517, 'recall': 0.8810799, 'specificity': 0.8810799, 'f1': 0.8808964, 'auroc': 0.95205605, 'binary_precision': 0.9131164, 'binary_recall': 0.84233326, 'binary_specificity': 0.9198266, 'binary_f1_score': 0.8762978}
confusion matrix:
       0      1
0  23772   2072
1   4076  21776
---- Validation: 
scalar performance:
{'acc': 0.817274, 'precision': 0.53421855, 'recall': 0.71975213, 'specificity': 0.71975213, 'f1': 0.51965946, 'auroc': 0.7925105, 'binary_precision': 0.07995042, 'binary_recall': 0.6172249, 'binary_specificity': 0.8222794, 'binary_f1_score': 0.1415638}
confusion matrix:
       0     1
0  13737  2969
1    160   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.744352, 'precision': 0.59363055, 'recall': 0.7723139, 'specificity': 0.7723139, 'f1': 0.587105, 'auroc': 0.84627485, 'binary_precision': 0.20932508, 'binary_recall': 0.8055207, 'binary_specificity': 0.7391071, 'binary_f1_score': 0.33229813}
confusion matrix:
      0     1
0  6870  2425
1   155   642
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 12:19:10.969390,epoch time: 0:18:01.996756,used: 1:33:05.950928,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8914229, 'precision': 0.89164305, 'recall': 0.8914257, 'specificity': 0.8914257, 'f1': 0.8914082, 'auroc': 0.95812213, 'binary_precision': 0.90098655, 'binary_recall': 0.87955445, 'binary_specificity': 0.90329695, 'binary_f1_score': 0.89014155}
confusion matrix:
       0      1
0  23343   2499
1   3114  22740
---- Validation: 
scalar performance:
{'acc': 0.7978276, 'precision': 0.5334351, 'recall': 0.73311055, 'specificity': 0.73311055, 'f1': 0.51192766, 'auroc': 0.80720866, 'binary_precision': 0.07722222, 'binary_recall': 0.6650718, 'binary_specificity': 0.8011493, 'binary_f1_score': 0.1383773}
confusion matrix:
       0     1
0  13384  3322
1    140   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7322632, 'precision': 0.59186554, 'recall': 0.7743546, 'specificity': 0.7743546, 'f1': 0.58003545, 'auroc': 0.8543246, 'binary_precision': 0.20410065, 'binary_recall': 0.8243413, 'binary_specificity': 0.7243679, 'binary_f1_score': 0.32719123}
confusion matrix:
      0     1
0  6733  2562
1   140   657
early stop counter: 1
val acc:0.7978276014328003, best validation acc: 0.8172739744186401, corresponding to test acc:                         0.7443519830703735 / 0.7443519830703735
after epoch: 6,now: 2024-08-07 12:36:54.011718,epoch time: 0:17:43.042328,used: 1:50:48.993256,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89927655, 'precision': 0.9006516, 'recall': 0.89927876, 'specificity': 0.89927876, 'f1': 0.8991904, 'auroc': 0.96206796, 'binary_precision': 0.9241422, 'binary_recall': 0.86998063, 'binary_specificity': 0.92857695, 'binary_f1_score': 0.8962439}
confusion matrix:
       0      1
0  24000   1846
1   3361  22489
---- Validation: 
scalar performance:
{'acc': 0.83578604, 'precision': 0.539578, 'recall': 0.73507094, 'specificity': 0.73507094, 'f1': 0.5333028, 'auroc': 0.8135679, 'binary_precision': 0.0900685, 'binary_recall': 0.62918663, 'binary_specificity': 0.8409553, 'binary_f1_score': 0.15757939}
confusion matrix:
       0     1
0  14049  2657
1    155   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77744746, 'precision': 0.60529584, 'recall': 0.78454494, 'specificity': 0.78454494, 'f1': 0.6127066, 'auroc': 0.85909045, 'binary_precision': 0.23295245, 'binary_recall': 0.79297364, 'binary_specificity': 0.7761162, 'binary_f1_score': 0.36011395}
confusion matrix:
      0     1
0  7214  2081
1   165   632
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-07 12:54:22.662037,epoch time: 0:17:28.650319,used: 2:08:17.643575,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9037063, 'precision': 0.9049723, 'recall': 0.90370846, 'specificity': 0.90370846, 'f1': 0.9036313, 'auroc': 0.96533, 'binary_precision': 0.92763484, 'binary_recall': 0.8757447, 'binary_specificity': 0.9316722, 'binary_f1_score': 0.9009433}
confusion matrix:
       0      1
0  24080   1766
1   3212  22638
---- Validation: 
scalar performance:
{'acc': 0.8335669, 'precision': 0.54019505, 'recall': 0.7420974, 'specificity': 0.7420974, 'f1': 0.53346676, 'auroc': 0.8224656, 'binary_precision': 0.09084792, 'binary_recall': 0.64593303, 'binary_specificity': 0.8382617, 'binary_f1_score': 0.15929204}
confusion matrix:
       0     1
0  14004  2702
1    148   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7817083, 'precision': 0.60723644, 'recall': 0.78685796, 'specificity': 0.78685796, 'f1': 0.61639917, 'auroc': 0.8627293, 'binary_precision': 0.23670413, 'binary_recall': 0.79297364, 'binary_specificity': 0.78074235, 'binary_f1_score': 0.36458036}
confusion matrix:
      0     1
0  7257  2038
1   165   632
new oracle model saved
early stop counter: 1
val acc:0.8335669040679932, best validation acc: 0.8357860445976257, corresponding to test acc:                         0.7774474620819092 / 0.781708300113678
after epoch: 8,now: 2024-08-07 13:12:15.038042,epoch time: 0:17:52.376005,used: 2:26:10.019580,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90761375, 'precision': 0.90866286, 'recall': 0.9076196, 'specificity': 0.9076196, 'f1': 0.90755534, 'auroc': 0.9680916, 'binary_precision': 0.9294271, 'binary_recall': 0.88226193, 'binary_specificity': 0.9329773, 'binary_f1_score': 0.9052306}
confusion matrix:
       0      1
0  24110   1732
1   3044  22810
---- Validation: 
scalar performance:
{'acc': 0.82784396, 'precision': 0.5397199, 'recall': 0.7461617, 'specificity': 0.7461617, 'f1': 0.5309191, 'auroc': 0.8291924, 'binary_precision': 0.08955224, 'binary_recall': 0.6602871, 'binary_specificity': 0.8320364, 'binary_f1_score': 0.15771429}
confusion matrix:
       0     1
0  13900  2806
1    142   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824019, 'precision': 0.60902005, 'recall': 0.79239655, 'specificity': 0.79239655, 'f1': 0.6185764, 'auroc': 0.8671892, 'binary_precision': 0.23908989, 'binary_recall': 0.804266, 'binary_specificity': 0.7805272, 'binary_f1_score': 0.36860266}
confusion matrix:
      0     1
0  7255  2040
1   156   641
new oracle model saved
early stop counter: 2
val acc:0.827843964099884, best validation acc: 0.8357860445976257, corresponding to test acc:                         0.7774474620819092 / 0.7824019193649292
after epoch: 9,now: 2024-08-07 13:30:22.694845,epoch time: 0:18:07.656803,used: 2:44:17.676383,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91301066, 'precision': 0.9139168, 'recall': 0.9130143, 'specificity': 0.9130143, 'f1': 0.9129635, 'auroc': 0.97042847, 'binary_precision': 0.9333225, 'binary_recall': 0.88960236, 'binary_specificity': 0.9364262, 'binary_f1_score': 0.91093814}
confusion matrix:
       0      1
0  24201   1643
1   2854  22998
---- Validation: 
scalar performance:
{'acc': 0.8322238, 'precision': 0.541544, 'recall': 0.7530714, 'specificity': 0.7530714, 'f1': 0.5349444, 'auroc': 0.8349248, 'binary_precision': 0.09286899, 'binary_recall': 0.6698565, 'binary_specificity': 0.83628637, 'binary_f1_score': 0.16312264}
confusion matrix:
       0     1
0  13971  2735
1    138   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.790329, 'precision': 0.61297077, 'recall': 0.7972735, 'specificity': 0.7972735, 'f1': 0.6257873, 'auroc': 0.8699944, 'binary_precision': 0.24663849, 'binary_recall': 0.8055207, 'binary_specificity': 0.7890264, 'binary_f1_score': 0.37764707}
confusion matrix:
      0     1
0  7334  1961
1   155   642
new oracle model saved
early stop counter: 3
val acc:0.8322237730026245, best validation acc: 0.8357860445976257, corresponding to test acc:                         0.7774474620819092 / 0.7903289794921875
after epoch: 10,now: 2024-08-07 13:48:24.556472,epoch time: 0:18:01.861627,used: 3:02:19.538010,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91550606, 'precision': 0.9162257, 'recall': 0.91551244, 'specificity': 0.91551244, 'f1': 0.9154703, 'auroc': 0.9723481, 'binary_precision': 0.93361044, 'binary_recall': 0.8946859, 'binary_specificity': 0.936339, 'binary_f1_score': 0.9137338}
confusion matrix:
       0      1
0  24195   1645
1   2723  23133
---- Validation: 
scalar performance:
{'acc': 0.83269095, 'precision': 0.5430252, 'recall': 0.76264083, 'specificity': 0.76264083, 'f1': 0.5371974, 'auroc': 0.8398225, 'binary_precision': 0.0952696, 'binary_recall': 0.68899524, 'binary_specificity': 0.83628637, 'binary_f1_score': 0.1673932}
confusion matrix:
       0     1
0  13971  2735
1    130   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7937971, 'precision': 0.6150215, 'recall': 0.8003034, 'specificity': 0.8003034, 'f1': 0.6292754, 'auroc': 0.8718616, 'binary_precision': 0.2503888, 'binary_recall': 0.8080301, 'binary_specificity': 0.7925767, 'binary_f1_score': 0.38230926}
confusion matrix:
      0     1
0  7367  1928
1   153   644
new oracle model saved
early stop counter: 4
val acc:0.832690954208374, best validation acc: 0.8357860445976257, corresponding to test acc:                         0.7774474620819092 / 0.7937970757484436
after epoch: 11,now: 2024-08-07 14:07:41.532411,epoch time: 0:19:16.975939,used: 3:21:36.513949,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9205161, 'precision': 0.92200196, 'recall': 0.92051953, 'specificity': 0.92051953, 'f1': 0.9204465, 'auroc': 0.9749373, 'binary_precision': 0.9470719, 'binary_recall': 0.89083594, 'binary_specificity': 0.9502031, 'binary_f1_score': 0.9180936}
confusion matrix:
       0      1
0  24558   1287
1   2822  23029
---- Validation: 
scalar performance:
{'acc': 0.85459006, 'precision': 0.5478791, 'recall': 0.7610356, 'specificity': 0.7610356, 'f1': 0.55109996, 'auroc': 0.8419033, 'binary_precision': 0.10548363, 'binary_recall': 0.66267943, 'binary_specificity': 0.8593918, 'binary_f1_score': 0.18199737}
confusion matrix:
       0     1
0  14357  2349
1    141   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165874, 'precision': 0.6241085, 'recall': 0.8000573, 'specificity': 0.8000573, 'f1': 0.6468117, 'auroc': 0.87362134, 'binary_precision': 0.27067015, 'binary_recall': 0.7804266, 'binary_specificity': 0.819688, 'binary_f1_score': 0.40193862}
confusion matrix:
      0     1
0  7619  1676
1   175   622
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-07 14:25:33.516302,epoch time: 0:17:51.983891,used: 3:39:28.497840,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92328227, 'precision': 0.9246737, 'recall': 0.92328894, 'specificity': 0.92328894, 'f1': 0.92322016, 'auroc': 0.9756111, 'binary_precision': 0.9490399, 'binary_recall': 0.89463913, 'binary_specificity': 0.9519387, 'binary_f1_score': 0.9210369}
confusion matrix:
       0      1
0  24600   1242
1   2724  23130
---- Validation: 
scalar performance:
{'acc': 0.8511446, 'precision': 0.5479674, 'recall': 0.7674335, 'specificity': 0.7674335, 'f1': 0.55017334, 'auroc': 0.8462223, 'binary_precision': 0.105224155, 'binary_recall': 0.67942584, 'binary_specificity': 0.85544115, 'binary_f1_score': 0.1822265}
confusion matrix:
       0     1
0  14291  2415
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81807375, 'precision': 0.62693906, 'recall': 0.8077469, 'specificity': 0.8077469, 'f1': 0.65050554, 'auroc': 0.87598383, 'binary_precision': 0.27481577, 'binary_recall': 0.79548305, 'binary_specificity': 0.8200108, 'binary_f1_score': 0.40850514}
confusion matrix:
      0     1
0  7622  1673
1   163   634
new oracle model saved
early stop counter: 1
val acc:0.8511446118354797, best validation acc: 0.8545900583267212, corresponding to test acc:                         0.8165873885154724 / 0.8180737495422363
after epoch: 13,now: 2024-08-07 14:43:40.630700,epoch time: 0:18:07.114398,used: 3:57:35.612238,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9254488, 'precision': 0.9273082, 'recall': 0.9254577, 'specificity': 0.9254577, 'f1': 0.92536867, 'auroc': 0.97672546, 'binary_precision': 0.95556384, 'binary_recall': 0.8924386, 'binary_specificity': 0.95847684, 'binary_f1_score': 0.9229231}
confusion matrix:
       0      1
0  24768   1073
1   2781  23074
---- Validation: 
scalar performance:
{'acc': 0.86095536, 'precision': 0.5515131, 'recall': 0.77246165, 'specificity': 0.77246165, 'f1': 0.5582675, 'auroc': 0.8503145, 'binary_precision': 0.11220861, 'binary_recall': 0.67942584, 'binary_specificity': 0.8654974, 'binary_f1_score': 0.19260767}
confusion matrix:
       0     1
0  14459  2247
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8274871, 'precision': 0.63122755, 'recall': 0.806548, 'specificity': 0.806548, 'f1': 0.6579512, 'auroc': 0.8772923, 'binary_precision': 0.28447488, 'binary_recall': 0.7816813, 'binary_specificity': 0.83141476, 'binary_f1_score': 0.41714093}
confusion matrix:
      0     1
0  7728  1567
1   174   623
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-07 15:01:55.239830,epoch time: 0:18:14.609130,used: 4:15:50.221368,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92773134, 'precision': 0.92923903, 'recall': 0.9277371, 'specificity': 0.9277371, 'f1': 0.92766845, 'auroc': 0.9782392, 'binary_precision': 0.95472676, 'binary_recall': 0.8980776, 'binary_specificity': 0.95739657, 'binary_f1_score': 0.92553616}
confusion matrix:
       0      1
0  24742   1101
1   2635  23218
---- Validation: 
scalar performance:
{'acc': 0.8673791, 'precision': 0.5540966, 'recall': 0.77575386, 'specificity': 0.77575386, 'f1': 0.5638832, 'auroc': 0.8523046, 'binary_precision': 0.117306896, 'binary_recall': 0.67942584, 'binary_specificity': 0.8720819, 'binary_f1_score': 0.20007044}
confusion matrix:
       0     1
0  14569  2137
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8342251, 'precision': 0.63540703, 'recall': 0.80848527, 'specificity': 0.80848527, 'f1': 0.6644052, 'auroc': 0.8781081, 'binary_precision': 0.29300568, 'binary_recall': 0.7779172, 'binary_specificity': 0.8390533, 'binary_f1_score': 0.425678}
confusion matrix:
      0     1
0  7799  1496
1   177   620
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-07 15:19:36.821992,epoch time: 0:17:41.582162,used: 4:33:31.803530,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9288533, 'precision': 0.929963, 'recall': 0.92885524, 'specificity': 0.92885524, 'f1': 0.92880756, 'auroc': 0.978569, 'binary_precision': 0.9518259, 'binary_recall': 0.9034429, 'binary_specificity': 0.95426756, 'binary_f1_score': 0.9270035}
confusion matrix:
       0      1
0  24664   1182
1   2496  23354
---- Validation: 
scalar performance:
{'acc': 0.8507358, 'precision': 0.54926264, 'recall': 0.7765539, 'specificity': 0.7765539, 'f1': 0.55191094, 'auroc': 0.8546572, 'binary_precision': 0.10727406, 'binary_recall': 0.6985646, 'binary_specificity': 0.85454327, 'binary_f1_score': 0.18598726}
confusion matrix:
       0     1
0  14276  2430
1    126   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8207491, 'precision': 0.6289195, 'recall': 0.8103464, 'specificity': 0.8103464, 'f1': 0.653541, 'auroc': 0.87936366, 'binary_precision': 0.27845883, 'binary_recall': 0.79799247, 'binary_specificity': 0.8227004, 'binary_f1_score': 0.41285297}
confusion matrix:
      0     1
0  7647  1648
1   161   636
early stop counter: 1
val acc:0.8507357835769653, best validation acc: 0.8673791289329529, corresponding to test acc:                         0.8342251181602478 / 0.8342251181602478
after epoch: 16,now: 2024-08-07 15:40:01.749416,epoch time: 0:20:24.927424,used: 4:53:56.730954,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9310972, 'precision': 0.93195844, 'recall': 0.931105, 'specificity': 0.931105, 'f1': 0.93106365, 'auroc': 0.97917175, 'binary_precision': 0.95133406, 'binary_recall': 0.9087288, 'binary_specificity': 0.9534812, 'binary_f1_score': 0.9295435}
confusion matrix:
       0      1
0  24637   1202
1   2360  23497
---- Validation: 
scalar performance:
{'acc': 0.8534221, 'precision': 0.55073786, 'recall': 0.7814294, 'specificity': 0.7814294, 'f1': 0.5548698, 'auroc': 0.8567612, 'binary_precision': 0.10999254, 'binary_recall': 0.70574164, 'binary_specificity': 0.8571172, 'binary_f1_score': 0.19032258}
confusion matrix:
       0     1
0  14319  2387
1    123   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.824019, 'precision': 0.6311617, 'recall': 0.81269515, 'specificity': 0.81269515, 'f1': 0.6570257, 'auroc': 0.88014925, 'binary_precision': 0.28273413, 'binary_recall': 0.7992472, 'binary_specificity': 0.8261431, 'binary_f1_score': 0.4177049}
confusion matrix:
      0     1
0  7679  1616
1   160   637
early stop counter: 2
val acc:0.8534221053123474, best validation acc: 0.8673791289329529, corresponding to test acc:                         0.8342251181602478 / 0.8342251181602478
after epoch: 17,now: 2024-08-07 15:57:49.320799,epoch time: 0:17:47.571383,used: 5:11:44.302337,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93307024, 'precision': 0.93385744, 'recall': 0.933076, 'specificity': 0.933076, 'f1': 0.93304044, 'auroc': 0.98019016, 'binary_precision': 0.952406, 'binary_recall': 0.9117385, 'binary_specificity': 0.95441353, 'binary_f1_score': 0.9316286}
confusion matrix:
       0      1
0  24663   1178
1   2282  23573
---- Validation: 
scalar performance:
{'acc': 0.85149497, 'precision': 0.5502378, 'recall': 0.781608, 'specificity': 0.781608, 'f1': 0.5535507, 'auroc': 0.85750043, 'binary_precision': 0.108943686, 'binary_recall': 0.708134, 'binary_specificity': 0.85508204, 'binary_f1_score': 0.18883571}
confusion matrix:
       0     1
0  14285  2421
1    122   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82481176, 'precision': 0.63199043, 'recall': 0.8142726, 'specificity': 0.8142726, 'f1': 0.65820205, 'auroc': 0.88101554, 'binary_precision': 0.28412628, 'binary_recall': 0.80175656, 'binary_specificity': 0.8267886, 'binary_f1_score': 0.41956663}
confusion matrix:
      0     1
0  7685  1610
1   158   639
early stop counter: 3
val acc:0.8514949679374695, best validation acc: 0.8673791289329529, corresponding to test acc:                         0.8342251181602478 / 0.8342251181602478
after epoch: 18,now: 2024-08-07 16:15:53.278378,epoch time: 0:18:03.957579,used: 5:29:48.259916,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93303156, 'precision': 0.93437415, 'recall': 0.93303907, 'specificity': 0.93303907, 'f1': 0.93298054, 'auroc': 0.98073936, 'binary_precision': 0.95859104, 'binary_recall': 0.9052021, 'binary_specificity': 0.9608761, 'binary_f1_score': 0.9311319}
confusion matrix:
       0      1
0  24830   1011
1   2451  23404
---- Validation: 
scalar performance:
{'acc': 0.8690727, 'precision': 0.5559683, 'recall': 0.7836193, 'specificity': 0.7836193, 'f1': 0.5670929, 'auroc': 0.8594533, 'binary_precision': 0.120632276, 'binary_recall': 0.6937799, 'binary_specificity': 0.8734586, 'binary_f1_score': 0.20552798}
confusion matrix:
       0     1
0  14592  2114
1    128   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84086406, 'precision': 0.6406012, 'recall': 0.8132365, 'specificity': 0.8132365, 'f1': 0.6719205, 'auroc': 0.8805953, 'binary_precision': 0.30297127, 'binary_recall': 0.7804266, 'binary_specificity': 0.84604627, 'binary_f1_score': 0.43649125}
confusion matrix:
      0     1
0  7864  1431
1   175   622
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-08-07 16:33:45.493267,epoch time: 0:17:52.214889,used: 5:47:40.474805,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9347725, 'precision': 0.9353187, 'recall': 0.9347732, 'specificity': 0.9347732, 'f1': 0.9347521, 'auroc': 0.98169243, 'binary_precision': 0.950748, 'binary_recall': 0.91705674, 'binary_specificity': 0.9524897, 'binary_f1_score': 0.9335985}
confusion matrix:
       0      1
0  24619   1228
1   2144  23705
---- Validation: 
scalar performance:
{'acc': 0.8467064, 'precision': 0.5496653, 'recall': 0.78615123, 'specificity': 0.78615123, 'f1': 0.55121464, 'auroc': 0.8610443, 'binary_precision': 0.10743508, 'binary_recall': 0.72248805, 'binary_specificity': 0.8498144, 'binary_f1_score': 0.18705481}
confusion matrix:
       0     1
0  14197  2509
1    116   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8250099, 'precision': 0.63259023, 'recall': 0.81610084, 'specificity': 0.81610084, 'f1': 0.6589568, 'auroc': 0.88084924, 'binary_precision': 0.2849534, 'binary_recall': 0.8055207, 'binary_specificity': 0.826681, 'binary_f1_score': 0.42098358}
confusion matrix:
      0     1
0  7684  1611
1   155   642
early stop counter: 1
val acc:0.8467063903808594, best validation acc: 0.869072675704956, corresponding to test acc:                         0.8408640623092651 / 0.8408640623092651
after epoch: 20,now: 2024-08-07 16:51:17.533497,epoch time: 0:17:32.040230,used: 6:05:12.515035,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_46_04_seed_2_24076679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:05:12.515035 at 2024-08-07 16:51:17.533497
persisted model performance metric: 

scalar performance:
{'acc': 0.84086406, 'precision': 0.6406012, 'recall': 0.8132365, 'specificity': 0.8132365, 'f1': 0.6719205, 'auroc': 0.8805953, 'binary_precision': 0.30297127, 'binary_recall': 0.7804266, 'binary_specificity': 0.84604627, 'binary_f1_score': 0.43649125}
confusion matrix:
      0     1
0  7864  1431
1   175   622
oracle model performance metric: 

scalar performance:
{'acc': 0.84086406, 'precision': 0.6406012, 'recall': 0.8132365, 'specificity': 0.8132365, 'f1': 0.6719205, 'auroc': 0.8805953, 'binary_precision': 0.30297127, 'binary_recall': 0.7804266, 'binary_specificity': 0.84604627, 'binary_f1_score': 0.43649125}
confusion matrix:
      0     1
0  7864  1431
1   175   622
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/16.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/16.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  16648 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1066 MiB | 565248 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     58 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  89169 KiB | 611400 GiB | 611400 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 588391 GiB | 588391 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6945    |  246582 K  |  246578 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140321 K  |  140317 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6945    |  246582 K  |  246578 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140321 K  |  140317 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      74    |      33    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3250    |  133386 K  |  133386 K  |
|       from large pool |      10    |      23    |   64620 K  |   64620 K  |
|       from small pool |      21    |    3240    |   68765 K  |   68765 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |   1066 MiB |    838 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  28672 KiB |  43008 KiB |     58 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 611400 GiB | 611400 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 588391 GiB | 588391 GiB |
|       from small pool |      0 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6945    |  246582 K  |  246582 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140321 K  |  140321 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6945    |  246582 K  |  246582 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140321 K  |  140321 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      74    |      50    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      14    |      21    |      29    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3250    |  133388 K  |  133388 K  |
|       from large pool |       3    |      23    |   64620 K  |   64620 K  |
|       from small pool |       0    |    3240    |   68767 K  |   68767 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 17:09:14 2024]
Finished job 0.
1 of 1 steps (100%) done
