Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/14.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=14
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076674

 Experiment start at: 2024-08-06 02:34:45.412626
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90818465, 'precision': 0.90894747, 'recall': 0.9082, 'specificity': 0.9082, 'f1': 0.908144, 'auroc': 0.9667816, 'binary_precision': 0.92678905, 'binary_recall': 0.8865304, 'binary_specificity': 0.9298696, 'binary_f1_score': 0.9062128}
confusion matrix:
       0      1
0  23535   1775
1   2876  22470
---- Validation: 
scalar performance:
{'acc': 0.8843462, 'precision': 0.5547574, 'recall': 0.74569964, 'specificity': 0.74569964, 'f1': 0.5691943, 'auroc': 0.82976955, 'binary_precision': 0.12052275, 'binary_recall': 0.6, 'binary_specificity': 0.8913992, 'binary_f1_score': 0.20072551}
confusion matrix:
       0     1
0  14914  1817
1    166   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8016611, 'precision': 0.61924654, 'recall': 0.8165846, 'specificity': 0.8165846, 'f1': 0.63627696, 'auroc': 0.8820087, 'binary_precision': 0.25535288, 'binary_recall': 0.83419687, 'binary_specificity': 0.79897237, 'binary_f1_score': 0.39101392}
confusion matrix:
      0     1
0  7464  1878
1   128   644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 02:56:07.573004,epoch time: 0:21:22.160378,used: 0:21:22.160378,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92968255, 'precision': 0.9306003, 'recall': 0.9296972, 'specificity': 0.9296972, 'f1': 0.92964673, 'auroc': 0.9786879, 'binary_precision': 0.9506372, 'binary_recall': 0.9065262, 'binary_specificity': 0.9528682, 'binary_f1_score': 0.92805785}
confusion matrix:
       0      1
0  24119   1193
1   2369  22975
---- Validation: 
scalar performance:
{'acc': 0.8869707, 'precision': 0.55850047, 'recall': 0.7599687, 'specificity': 0.7599687, 'f1': 0.5753379, 'auroc': 0.84673667, 'binary_precision': 0.12726383, 'binary_recall': 0.62650603, 'binary_specificity': 0.89343137, 'binary_f1_score': 0.2115541}
confusion matrix:
       0     1
0  14948  1783
1    155   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83053195, 'precision': 0.6332859, 'recall': 0.82092416, 'specificity': 0.82092416, 'f1': 0.6612228, 'auroc': 0.88610816, 'binary_precision': 0.28512773, 'binary_recall': 0.8095855, 'binary_specificity': 0.8322629, 'binary_f1_score': 0.4217274}
confusion matrix:
      0     1
0  7775  1567
1   147   625
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 03:15:29.844687,epoch time: 0:19:22.271683,used: 0:40:44.432061,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9379343, 'precision': 0.9387343, 'recall': 0.937947, 'specificity': 0.937947, 'f1': 0.93790716, 'auroc': 0.98252356, 'binary_precision': 0.957617, 'binary_recall': 0.9165055, 'binary_specificity': 0.95938843, 'binary_f1_score': 0.9366103}
confusion matrix:
       0      1
0  24285   1028
1   2116  23227
---- Validation: 
scalar performance:
{'acc': 0.86988217, 'precision': 0.5560886, 'recall': 0.7852856, 'specificity': 0.7852856, 'f1': 0.5674518, 'auroc': 0.8553746, 'binary_precision': 0.120718464, 'binary_recall': 0.69638556, 'binary_specificity': 0.8741856, 'binary_f1_score': 0.20576717}
confusion matrix:
       0     1
0  14626  2105
1    126   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.822721, 'precision': 0.62998843, 'recall': 0.8232316, 'specificity': 0.8232316, 'f1': 0.6552696, 'auroc': 0.88687825, 'binary_precision': 0.2773659, 'binary_recall': 0.8238342, 'binary_specificity': 0.822629, 'binary_f1_score': 0.41500816}
confusion matrix:
      0     1
0  7685  1657
1   136   636
early stop counter: 1
val acc:0.8698821663856506, best validation acc: 0.8869706988334656, corresponding to test acc:                         0.8305319547653198 / 0.8305319547653198
after epoch: 3,now: 2024-08-06 03:34:49.030236,epoch time: 0:19:19.185549,used: 1:00:03.617610,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94363946, 'precision': 0.9439113, 'recall': 0.9436463, 'specificity': 0.9436463, 'f1': 0.9436314, 'auroc': 0.9853368, 'binary_precision': 0.95503664, 'binary_recall': 0.93118143, 'binary_specificity': 0.95611125, 'binary_f1_score': 0.9429582}
confusion matrix:
       0      1
0  24203   1111
1   1744  23598
---- Validation: 
scalar performance:
{'acc': 0.8485944, 'precision': 0.549408, 'recall': 0.7837772, 'specificity': 0.7837772, 'f1': 0.5513698, 'auroc': 0.8559227, 'binary_precision': 0.107027024, 'binary_recall': 0.71566266, 'binary_specificity': 0.8518917, 'binary_f1_score': 0.1862069}
confusion matrix:
       0     1
0  14253  2478
1    118   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8181728, 'precision': 0.6283233, 'recall': 0.82492864, 'specificity': 0.82492864, 'f1': 0.65199745, 'auroc': 0.8887489, 'binary_precision': 0.27326816, 'binary_recall': 0.83290154, 'binary_specificity': 0.8169557, 'binary_f1_score': 0.41152}
confusion matrix:
      0     1
0  7632  1710
1   129   643
early stop counter: 2
val acc:0.8485944271087646, best validation acc: 0.8869706988334656, corresponding to test acc:                         0.8305319547653198 / 0.8305319547653198
after epoch: 4,now: 2024-08-06 03:54:16.851434,epoch time: 0:19:27.821198,used: 1:19:31.438808,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94865364, 'precision': 0.9487295, 'recall': 0.9486581, 'specificity': 0.9486581, 'f1': 0.9486519, 'auroc': 0.9871613, 'binary_precision': 0.9547345, 'binary_recall': 0.94203985, 'binary_specificity': 0.95527637, 'binary_f1_score': 0.94834477}
confusion matrix:
       0      1
0  24179   1132
1   1469  23876
---- Validation: 
scalar performance:
{'acc': 0.82526535, 'precision': 0.54481876, 'recall': 0.7882724, 'specificity': 0.7882724, 'f1': 0.5371229, 'auroc': 0.85917723, 'binary_precision': 0.09709647, 'binary_recall': 0.7493976, 'binary_specificity': 0.8271472, 'binary_f1_score': 0.17191818}
confusion matrix:
       0     1
0  13839  2892
1    104   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80937314, 'precision': 0.6257898, 'recall': 0.8296715, 'specificity': 0.8296715, 'f1': 0.6462531, 'auroc': 0.8896234, 'binary_precision': 0.26637024, 'binary_recall': 0.85362697, 'binary_specificity': 0.8057161, 'binary_f1_score': 0.40603817}
confusion matrix:
      0     1
0  7527  1815
1   113   659
early stop counter: 3
val acc:0.8252653479576111, best validation acc: 0.8869706988334656, corresponding to test acc:                         0.8305319547653198 / 0.8305319547653198
after epoch: 5,now: 2024-08-06 04:13:38.836476,epoch time: 0:19:21.985042,used: 1:38:53.423850,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9486142, 'precision': 0.9492606, 'recall': 0.94862473, 'specificity': 0.94862473, 'f1': 0.94859654, 'auroc': 0.98842543, 'binary_precision': 0.96644104, 'binary_recall': 0.9295636, 'binary_specificity': 0.9676859, 'binary_f1_score': 0.9476437}
confusion matrix:
       0      1
0  24496    818
1   1785  23557
---- Validation: 
scalar performance:
{'acc': 0.86311674, 'precision': 0.55382496, 'recall': 0.78534377, 'specificity': 0.78534377, 'f1': 0.5622057, 'auroc': 0.86169326, 'binary_precision': 0.11605723, 'binary_recall': 0.7036145, 'binary_specificity': 0.8670731, 'binary_f1_score': 0.1992494}
confusion matrix:
       0     1
0  14507  2224
1    123   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8411113, 'precision': 0.64134866, 'recall': 0.8290276, 'specificity': 0.8290276, 'f1': 0.6732697, 'auroc': 0.8905935, 'binary_precision': 0.30052558, 'binary_recall': 0.8147668, 'binary_specificity': 0.84328836, 'binary_f1_score': 0.4390925}
confusion matrix:
      0     1
0  7878  1464
1   143   629
new oracle model saved
early stop counter: 4
val acc:0.8631167411804199, best validation acc: 0.8869706988334656, corresponding to test acc:                         0.8305319547653198 / 0.8411113023757935
after epoch: 6,now: 2024-08-06 04:32:59.423718,epoch time: 0:19:20.587242,used: 1:58:14.011092,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95187145, 'precision': 0.9521127, 'recall': 0.9518765, 'specificity': 0.9518765, 'f1': 0.95186543, 'auroc': 0.98878574, 'binary_precision': 0.96266514, 'binary_recall': 0.9402502, 'binary_specificity': 0.96350276, 'binary_f1_score': 0.95132565}
confusion matrix:
       0      1
0  24393    924
1   1514  23825
---- Validation: 
scalar performance:
{'acc': 0.84894437, 'precision': 0.5504035, 'recall': 0.78983116, 'specificity': 0.78983116, 'f1': 0.55290973, 'auroc': 0.8653474, 'binary_precision': 0.10867219, 'binary_recall': 0.72771084, 'binary_specificity': 0.8519515, 'binary_f1_score': 0.18910457}
confusion matrix:
       0     1
0  14254  2477
1    113   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83695865, 'precision': 0.6400596, 'recall': 0.8333153, 'specificity': 0.8333153, 'f1': 0.67084295, 'auroc': 0.8934127, 'binary_precision': 0.2967084, 'binary_recall': 0.82901555, 'binary_specificity': 0.8376151, 'binary_f1_score': 0.43700925}
confusion matrix:
      0     1
0  7825  1517
1   132   640
early stop counter: 5
val acc:0.848944365978241, best validation acc: 0.8869706988334656, corresponding to test acc:                         0.8305319547653198 / 0.8411113023757935
after epoch: 7,now: 2024-08-06 04:52:22.107814,epoch time: 0:19:22.684096,used: 2:17:36.695188,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 2:17:36.695188 at 2024-08-06 04:52:22.107814
persisted model performance metric: 

scalar performance:
{'acc': 0.83053195, 'precision': 0.6332859, 'recall': 0.82092416, 'specificity': 0.82092416, 'f1': 0.6612228, 'auroc': 0.88610816, 'binary_precision': 0.28512773, 'binary_recall': 0.8095855, 'binary_specificity': 0.8322629, 'binary_f1_score': 0.4217274}
confusion matrix:
      0     1
0  7775  1567
1   147   625
oracle model performance metric: 

scalar performance:
{'acc': 0.8411113, 'precision': 0.64134866, 'recall': 0.8290276, 'specificity': 0.8290276, 'f1': 0.6732697, 'auroc': 0.8905935, 'binary_precision': 0.30052558, 'binary_recall': 0.8147668, 'binary_specificity': 0.84328836, 'binary_f1_score': 0.4390925}
confusion matrix:
      0     1
0  7878  1464
1   143   629
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/14.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192600 KiB | 462230 KiB | 163810 GiB | 163810 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 160446 GiB | 160446 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   3364 GiB |   3364 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 192600 KiB | 462230 KiB | 163810 GiB | 163810 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 160446 GiB | 160446 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   3364 GiB |   3364 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189463 KiB | 457745 KiB | 163801 GiB | 163801 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 160443 GiB | 160442 GiB |
|       from small pool |  16649 KiB |  37683 KiB |   3358 GiB |   3358 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  49063 KiB |  91541 KiB |  99696 GiB |  99696 GiB |
|       from large pool |  30400 KiB |  79704 KiB |  96322 GiB |  96322 GiB |
|       from small pool |  18663 KiB |  18663 KiB |   3374 GiB |   3373 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6795    |   33904 K  |   33900 K  |
|       from large pool |      76    |     158    |   15814 K  |   15814 K  |
|       from small pool |    4336    |    6718    |   18090 K  |   18085 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6795    |   33904 K  |   33900 K  |
|       from large pool |      76    |     158    |   15814 K  |   15814 K  |
|       from small pool |    4336    |    6718    |   18090 K  |   18085 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3183    |   20386 K  |   20386 K  |
|       from large pool |       9    |      18    |   12752 K  |   12752 K  |
|       from small pool |      28    |    3174    |    7634 K  |    7634 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 163810 GiB | 163810 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 160446 GiB | 160446 GiB |
|       from small pool |      0 KiB |  39230 KiB |   3364 GiB |   3364 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 163810 GiB | 163810 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 160446 GiB | 160446 GiB |
|       from small pool |      0 KiB |  39230 KiB |   3364 GiB |   3364 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 163801 GiB | 163801 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 160443 GiB | 160443 GiB |
|       from small pool |      0 KiB |  37683 KiB |   3358 GiB |   3358 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 241664 KiB | 509952 KiB | 509952 KiB | 268288 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  36864 KiB |  43008 KiB |  43008 KiB |   6144 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  91541 KiB |  99696 GiB |  99696 GiB |
|       from large pool |  23872 KiB |  79704 KiB |  96322 GiB |  96322 GiB |
|       from small pool |      0 KiB |  28227 KiB |   3374 GiB |   3374 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6795    |   33904 K  |   33904 K  |
|       from large pool |       2    |     158    |   15814 K  |   15814 K  |
|       from small pool |       0    |    6718    |   18090 K  |   18090 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6795    |   33904 K  |   33904 K  |
|       from large pool |       2    |     158    |   15814 K  |   15814 K  |
|       from small pool |       0    |    6718    |   18090 K  |   18090 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      42    |      42    |      14    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      18    |      21    |      21    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3183    |   20388 K  |   20388 K  |
|       from large pool |       3    |      18    |   12752 K  |   12752 K  |
|       from small pool |       0    |    3174    |    7636 K  |    7636 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 163810 GiB | 163810 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 160446 GiB | 160446 GiB |
|       from small pool |      0 KiB |  39230 KiB |   3364 GiB |   3364 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 163810 GiB | 163810 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 160446 GiB | 160446 GiB |
|       from small pool |      0 KiB |  39230 KiB |   3364 GiB |   3364 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 163801 GiB | 163801 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 160443 GiB | 160443 GiB |
|       from small pool |      0 KiB |  37683 KiB |   3358 GiB |   3358 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 241664 KiB | 509952 KiB | 509952 KiB | 268288 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  36864 KiB |  43008 KiB |  43008 KiB |   6144 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  91541 KiB |  99696 GiB |  99696 GiB |
|       from large pool |  23872 KiB |  79704 KiB |  96322 GiB |  96322 GiB |
|       from small pool |      0 KiB |  28227 KiB |   3374 GiB |   3374 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6795    |   33904 K  |   33904 K  |
|       from large pool |       2    |     158    |   15814 K  |   15814 K  |
|       from small pool |       0    |    6718    |   18090 K  |   18090 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6795    |   33904 K  |   33904 K  |
|       from large pool |       2    |     158    |   15814 K  |   15814 K  |
|       from small pool |       0    |    6718    |   18090 K  |   18090 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      42    |      42    |      14    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      18    |      21    |      21    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3183    |   20388 K  |   20388 K  |
|       from large pool |       3    |      18    |   12752 K  |   12752 K  |
|       from small pool |       0    |    3174    |    7636 K  |    7636 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_05_17_34_seed_1_24076674

 Experiment start at: 2024-08-06 05:17:35.100684
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90220726, 'precision': 0.9039599, 'recall': 0.9022306, 'specificity': 0.9022306, 'f1': 0.90210474, 'auroc': 0.96438754, 'binary_precision': 0.9307456, 'binary_recall': 0.86923015, 'binary_specificity': 0.93523115, 'binary_f1_score': 0.8989367}
confusion matrix:
       0      1
0  23753   1645
1   3326  22108
---- Validation: 
scalar performance:
{'acc': 0.91596097, 'precision': 0.5740182, 'recall': 0.7387788, 'specificity': 0.7387788, 'f1': 0.6020278, 'auroc': 0.8506228, 'binary_precision': 0.16037735, 'binary_recall': 0.5522042, 'binary_specificity': 0.92535347, 'binary_f1_score': 0.24856396}
confusion matrix:
       0     1
0  15446  1246
1    193   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618571, 'precision': 0.6470616, 'recall': 0.8039399, 'specificity': 0.8039399, 'f1': 0.6826529, 'auroc': 0.88119334, 'binary_precision': 0.31810394, 'binary_recall': 0.7357992, 'binary_specificity': 0.87208056, 'binary_f1_score': 0.4441786}
confusion matrix:
      0     1
0  8140  1194
1   200   557
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 05:41:09.782347,epoch time: 0:23:34.681663,used: 0:23:34.681663,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_05_17_34_seed_1_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93033916, 'precision': 0.93039006, 'recall': 0.9303435, 'specificity': 0.9303435, 'f1': 0.93033755, 'auroc': 0.97858226, 'binary_precision': 0.93527097, 'binary_recall': 0.92479163, 'binary_specificity': 0.93589544, 'binary_f1_score': 0.93000174}
confusion matrix:
       0      1
0  23768   1628
1   1913  23523
---- Validation: 
scalar performance:
{'acc': 0.86059684, 'precision': 0.55510324, 'recall': 0.7861012, 'specificity': 0.7861012, 'f1': 0.5635752, 'auroc': 0.8660958, 'binary_precision': 0.11886204, 'binary_recall': 0.7076566, 'binary_specificity': 0.8645459, 'binary_f1_score': 0.20353687}
confusion matrix:
       0     1
0  14431  2261
1    126   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8462987, 'precision': 0.6456126, 'recall': 0.8404429, 'specificity': 0.8404429, 'f1': 0.6796671, 'auroc': 0.89800036, 'binary_precision': 0.3069066, 'binary_recall': 0.8335535, 'binary_specificity': 0.84733236, 'binary_f1_score': 0.44863135}
confusion matrix:
      0     1
0  7909  1425
1   126   631
early stop counter: 1
val acc:0.8605968356132507, best validation acc: 0.915960967540741, corresponding to test acc:                         0.8618571162223816 / 0.8618571162223816
after epoch: 2,now: 2024-08-06 06:02:57.551360,epoch time: 0:21:47.769013,used: 0:45:22.450676,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_05_17_34_seed_1_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9421624, 'precision': 0.94263357, 'recall': 0.9421754, 'specificity': 0.9421754, 'f1': 0.94214815, 'auroc': 0.98342806, 'binary_precision': 0.95727295, 'binary_recall': 0.9257352, 'binary_specificity': 0.95861554, 'binary_f1_score': 0.94123995}
confusion matrix:
       0      1
0  24345   1051
1   1889  23547
---- Validation: 
scalar performance:
{'acc': 0.8865853, 'precision': 0.5658816, 'recall': 0.7892598, 'specificity': 0.7892598, 'f1': 0.586192, 'auroc': 0.8682612, 'binary_precision': 0.1407513, 'binary_recall': 0.68677497, 'binary_specificity': 0.89174455, 'binary_f1_score': 0.23362273}
confusion matrix:
       0     1
0  14885  1807
1    135   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8723615, 'precision': 0.6646489, 'recall': 0.8387509, 'specificity': 0.8387509, 'f1': 0.7057767, 'auroc': 0.89950764, 'binary_precision': 0.34750143, 'binary_recall': 0.7992074, 'binary_specificity': 0.8782944, 'binary_f1_score': 0.48438746}
confusion matrix:
      0     1
0  8198  1136
1   152   605
new oracle model saved
early stop counter: 2
val acc:0.8865852952003479, best validation acc: 0.915960967540741, corresponding to test acc:                         0.8618571162223816 / 0.8723614811897278
after epoch: 3,now: 2024-08-06 06:23:12.726638,epoch time: 0:20:15.175278,used: 1:05:37.625954,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_05_17_34_seed_1_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9449166, 'precision': 0.9458698, 'recall': 0.9449349, 'specificity': 0.9449349, 'f1': 0.9448887, 'auroc': 0.98586607, 'binary_precision': 0.96668315, 'binary_recall': 0.9216858, 'binary_specificity': 0.968184, 'binary_f1_score': 0.9436484}
confusion matrix:
       0      1
0  24588    808
1   1992  23444
---- Validation: 
scalar performance:
{'acc': 0.8920166, 'precision': 0.5672797, 'recall': 0.7818743, 'specificity': 0.7818743, 'f1': 0.5893969, 'auroc': 0.8690852, 'binary_precision': 0.1440763, 'binary_recall': 0.66589326, 'binary_specificity': 0.8978553, 'binary_f1_score': 0.2368964}
confusion matrix:
       0     1
0  14987  1705
1    144   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87999207, 'precision': 0.67123085, 'recall': 0.83619934, 'specificity': 0.83619934, 'f1': 0.7135538, 'auroc': 0.898999, 'binary_precision': 0.36175397, 'binary_recall': 0.7846764, 'binary_specificity': 0.8877223, 'binary_f1_score': 0.49520633}
confusion matrix:
      0     1
0  8286  1048
1   163   594
new oracle model saved
early stop counter: 3
val acc:0.892016589641571, best validation acc: 0.915960967540741, corresponding to test acc:                         0.8618571162223816 / 0.8799920678138733
after epoch: 4,now: 2024-08-06 06:43:44.159287,epoch time: 0:20:31.432649,used: 1:26:09.058603,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_05_17_34_seed_1_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9481429, 'precision': 0.94846344, 'recall': 0.948153, 'specificity': 0.948153, 'f1': 0.9481344, 'auroc': 0.9870168, 'binary_precision': 0.9606417, 'binary_recall': 0.934657, 'binary_specificity': 0.961649, 'binary_f1_score': 0.9474712}
confusion matrix:
       0      1
0  24423    974
1   1662  23773
---- Validation: 
scalar performance:
{'acc': 0.85866964, 'precision': 0.55524135, 'recall': 0.79076344, 'specificity': 0.79076344, 'f1': 0.56319904, 'auroc': 0.86990756, 'binary_precision': 0.11881947, 'binary_recall': 0.71925753, 'binary_specificity': 0.86226934, 'binary_f1_score': 0.20394735}
confusion matrix:
       0     1
0  14393  2299
1    121   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86453277, 'precision': 0.66013914, 'recall': 0.84726465, 'specificity': 0.84726465, 'f1': 0.7001055, 'auroc': 0.90009505, 'binary_precision': 0.33619764, 'binary_recall': 0.82694846, 'binary_specificity': 0.8675809, 'binary_f1_score': 0.47804505}
confusion matrix:
      0     1
0  8098  1236
1   131   626
early stop counter: 4
val acc:0.858669638633728, best validation acc: 0.915960967540741, corresponding to test acc:                         0.8618571162223816 / 0.8799920678138733
after epoch: 5,now: 2024-08-06 07:04:07.843052,epoch time: 0:20:23.683765,used: 1:46:32.742368,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_05_17_34_seed_1_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9514479, 'precision': 0.95161164, 'recall': 0.95145476, 'specificity': 0.95145476, 'f1': 0.95144403, 'auroc': 0.98783994, 'binary_precision': 0.9603881, 'binary_recall': 0.9418102, 'binary_specificity': 0.9610993, 'binary_f1_score': 0.95100844}
confusion matrix:
       0      1
0  24410    988
1   1480  23954
---- Validation: 
scalar performance:
{'acc': 0.8459966, 'precision': 0.55164784, 'recall': 0.7910442, 'specificity': 0.7910442, 'f1': 0.5541018, 'auroc': 0.87051785, 'binary_precision': 0.11134602, 'binary_recall': 0.7331787, 'binary_specificity': 0.8489097, 'binary_f1_score': 0.1933313}
confusion matrix:
       0     1
0  14170  2522
1    115   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85918146, 'precision': 0.65609515, 'recall': 0.84740674, 'specificity': 0.84740674, 'f1': 0.69458216, 'auroc': 0.9006262, 'binary_precision': 0.32762203, 'binary_recall': 0.8335535, 'binary_specificity': 0.86125994, 'binary_f1_score': 0.470369}
confusion matrix:
      0     1
0  8039  1295
1   126   631
early stop counter: 5
val acc:0.845996618270874, best validation acc: 0.915960967540741, corresponding to test acc:                         0.8618571162223816 / 0.8799920678138733
after epoch: 6,now: 2024-08-06 07:23:49.804156,epoch time: 0:19:41.961104,used: 2:06:14.703472,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_05_17_34_seed_1_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 2:06:14.703472 at 2024-08-06 07:23:49.804156
persisted model performance metric: 

scalar performance:
{'acc': 0.8618571, 'precision': 0.6470616, 'recall': 0.8039399, 'specificity': 0.8039399, 'f1': 0.6826529, 'auroc': 0.88119334, 'binary_precision': 0.31810394, 'binary_recall': 0.7357992, 'binary_specificity': 0.87208056, 'binary_f1_score': 0.4441786}
confusion matrix:
      0     1
0  8140  1194
1   200   557
oracle model performance metric: 

scalar performance:
{'acc': 0.87999207, 'precision': 0.67123085, 'recall': 0.83619934, 'specificity': 0.83619934, 'f1': 0.7135538, 'auroc': 0.898999, 'binary_precision': 0.36175397, 'binary_recall': 0.7846764, 'binary_specificity': 0.8877223, 'binary_f1_score': 0.49520633}
confusion matrix:
      0     1
0  8286  1048
1   163   594
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB | 308532 GiB | 308532 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 302197 GiB | 302197 GiB |
|       from small pool |  18194 KiB |  39230 KiB |   6335 GiB |   6335 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB | 308532 GiB | 308532 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 302197 GiB | 302197 GiB |
|       from small pool |  18194 KiB |  39230 KiB |   6335 GiB |   6335 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB | 308514 GiB | 308514 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 302189 GiB | 302189 GiB |
|       from small pool |  16648 KiB |  37683 KiB |   6324 GiB |   6324 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    776 MiB | 268288 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     44 MiB |   6144 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  91541 KiB | 191093 GiB | 191093 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 184673 GiB | 184673 GiB |
|       from small pool |  10477 KiB |  28227 KiB |   6420 GiB |   6420 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6817    |   63637 K  |   63633 K  |
|       from large pool |      76    |     158    |   29787 K  |   29787 K  |
|       from small pool |    4324    |    6740    |   33850 K  |   33846 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6817    |   63637 K  |   63633 K  |
|       from large pool |      76    |     158    |   29787 K  |   29787 K  |
|       from small pool |    4324    |    6740    |   33850 K  |   33846 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      55    |      14    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      22    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3194    |   38477 K  |   38477 K  |
|       from large pool |      10    |      23    |   21858 K  |   21858 K  |
|       from small pool |      21    |    3184    |   16618 K  |   16618 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 308532 GiB | 308532 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 302197 GiB | 302197 GiB |
|       from small pool |      0 KiB |  39230 KiB |   6335 GiB |   6335 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 308532 GiB | 308532 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 302197 GiB | 302197 GiB |
|       from small pool |      0 KiB |  39230 KiB |   6335 GiB |   6335 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 308514 GiB | 308514 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 302189 GiB | 302189 GiB |
|       from small pool |      0 KiB |  37683 KiB |   6324 GiB |   6324 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    776 MiB | 561152 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     44 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB | 113923 KiB | 191094 GiB | 191094 GiB |
|       from large pool |  23872 KiB |  92928 KiB | 184673 GiB | 184673 GiB |
|       from small pool |      0 KiB |  28227 KiB |   6420 GiB |   6420 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6817    |   63637 K  |   63637 K  |
|       from large pool |       2    |     158    |   29787 K  |   29787 K  |
|       from small pool |       0    |    6740    |   33850 K  |   33850 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6817    |   63637 K  |   63637 K  |
|       from large pool |       2    |     158    |   29787 K  |   29787 K  |
|       from small pool |       0    |    6740    |   33850 K  |   33850 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      55    |      31    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      22    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3194    |   38479 K  |   38479 K  |
|       from large pool |       3    |      23    |   21858 K  |   21858 K  |
|       from small pool |       0    |    3184    |   16620 K  |   16620 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 308532 GiB | 308532 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 302197 GiB | 302197 GiB |
|       from small pool |      0 KiB |  39230 KiB |   6335 GiB |   6335 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 308532 GiB | 308532 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 302197 GiB | 302197 GiB |
|       from small pool |      0 KiB |  39230 KiB |   6335 GiB |   6335 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 308514 GiB | 308514 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 302189 GiB | 302189 GiB |
|       from small pool |      0 KiB |  37683 KiB |   6324 GiB |   6324 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    776 MiB | 561152 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     44 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB | 113923 KiB | 191094 GiB | 191094 GiB |
|       from large pool |  23872 KiB |  92928 KiB | 184673 GiB | 184673 GiB |
|       from small pool |      0 KiB |  28227 KiB |   6420 GiB |   6420 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6817    |   63637 K  |   63637 K  |
|       from large pool |       2    |     158    |   29787 K  |   29787 K  |
|       from small pool |       0    |    6740    |   33850 K  |   33850 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6817    |   63637 K  |   63637 K  |
|       from large pool |       2    |     158    |   29787 K  |   29787 K  |
|       from small pool |       0    |    6740    |   33850 K  |   33850 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      55    |      31    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      22    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3194    |   38479 K  |   38479 K  |
|       from large pool |       3    |      23    |   21858 K  |   21858 K  |
|       from small pool |       0    |    3184    |   16620 K  |   16620 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674

 Experiment start at: 2024-08-06 07:49:39.934992
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9023909, 'precision': 0.9034496, 'recall': 0.90239584, 'specificity': 0.90239584, 'f1': 0.9023276, 'auroc': 0.9628365, 'binary_precision': 0.9241652, 'binary_recall': 0.8767648, 'binary_specificity': 0.9280269, 'binary_f1_score': 0.8998412}
confusion matrix:
       0      1
0  23983   1860
1   3186  22667
---- Validation: 
scalar performance:
{'acc': 0.8333333, 'precision': 0.5406481, 'recall': 0.74547637, 'specificity': 0.74547637, 'f1': 0.5340351, 'auroc': 0.82632256, 'binary_precision': 0.09154929, 'binary_recall': 0.65311, 'binary_specificity': 0.8378427, 'binary_f1_score': 0.16058823}
confusion matrix:
       0     1
0  13997  2709
1    145   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7697186, 'precision': 0.6043607, 'recall': 0.7889525, 'specificity': 0.7889525, 'f1': 0.6086844, 'auroc': 0.86231434, 'binary_precision': 0.2293513, 'binary_recall': 0.8117942, 'binary_specificity': 0.76611084, 'binary_f1_score': 0.35765615}
confusion matrix:
      0     1
0  7121  2174
1   150   647
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 08:12:59.924458,epoch time: 0:23:19.989466,used: 0:23:19.989466,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92821497, 'precision': 0.92900455, 'recall': 0.9282191, 'specificity': 0.9282191, 'f1': 0.92818236, 'auroc': 0.9772428, 'binary_precision': 0.9474578, 'binary_recall': 0.906742, 'binary_specificity': 0.94969624, 'binary_f1_score': 0.92665285}
confusion matrix:
       0      1
0  24543   1300
1   2411  23442
---- Validation: 
scalar performance:
{'acc': 0.8606634, 'precision': 0.5514009, 'recall': 0.772312, 'specificity': 0.772312, 'f1': 0.5580185, 'auroc': 0.84873974, 'binary_precision': 0.11198738, 'binary_recall': 0.67942584, 'binary_specificity': 0.86519814, 'binary_f1_score': 0.19228165}
confusion matrix:
       0     1
0  14454  2252
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.822929, 'precision': 0.62871575, 'recall': 0.80579424, 'specificity': 0.80579424, 'f1': 0.6538745, 'auroc': 0.87358826, 'binary_precision': 0.27921498, 'binary_recall': 0.7854454, 'binary_specificity': 0.8261431, 'binary_f1_score': 0.41197765}
confusion matrix:
      0     1
0  7679  1616
1   171   626
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 08:33:38.493687,epoch time: 0:20:38.569229,used: 0:43:58.558695,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93838984, 'precision': 0.9387506, 'recall': 0.93839204, 'specificity': 0.93839204, 'f1': 0.9383774, 'auroc': 0.9819381, 'binary_precision': 0.951372, 'binary_recall': 0.9240291, 'binary_specificity': 0.952755, 'binary_f1_score': 0.93750125}
confusion matrix:
       0      1
0  24623   1221
1   1964  23888
---- Validation: 
scalar performance:
{'acc': 0.83245736, 'precision': 0.54662955, 'recall': 0.78817844, 'specificity': 0.78817844, 'f1': 0.5422139, 'auroc': 0.8606842, 'binary_precision': 0.10094432, 'binary_recall': 0.7416268, 'binary_specificity': 0.83473, 'binary_f1_score': 0.17770134}
confusion matrix:
       0     1
0  13945  2761
1    108   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8140111, 'precision': 0.62718165, 'recall': 0.81529194, 'specificity': 0.81529194, 'f1': 0.6495917, 'auroc': 0.880465, 'binary_precision': 0.27329975, 'binary_recall': 0.81681305, 'binary_specificity': 0.81377083, 'binary_f1_score': 0.40956277}
confusion matrix:
      0     1
0  7564  1731
1   146   651
early stop counter: 1
val acc:0.8324573636054993, best validation acc: 0.8606634140014648, corresponding to test acc:                         0.8229290246963501 / 0.8229290246963501
after epoch: 3,now: 2024-08-06 08:53:42.164017,epoch time: 0:20:03.670330,used: 1:04:02.229025,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9417363, 'precision': 0.94211674, 'recall': 0.9417386, 'specificity': 0.9417386, 'f1': 0.94172394, 'auroc': 0.9843377, 'binary_precision': 0.95512515, 'binary_recall': 0.92704624, 'binary_specificity': 0.9564309, 'binary_f1_score': 0.94087625}
confusion matrix:
       0      1
0  24718   1126
1   1886  23966
---- Validation: 
scalar performance:
{'acc': 0.8482831, 'precision': 0.5512401, 'recall': 0.79395676, 'specificity': 0.79395676, 'f1': 0.55397344, 'auroc': 0.8641187, 'binary_precision': 0.11015737, 'binary_recall': 0.7368421, 'binary_specificity': 0.8510715, 'binary_f1_score': 0.19166148}
confusion matrix:
       0     1
0  14218  2488
1    110   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8300634, 'precision': 0.6348617, 'recall': 0.81482935, 'specificity': 0.81482935, 'f1': 0.6628728, 'auroc': 0.87956464, 'binary_precision': 0.29021937, 'binary_recall': 0.7967378, 'binary_specificity': 0.8329209, 'binary_f1_score': 0.4254606}
confusion matrix:
      0     1
0  7742  1553
1   162   635
new oracle model saved
early stop counter: 2
val acc:0.8482831120491028, best validation acc: 0.8606634140014648, corresponding to test acc:                         0.8229290246963501 / 0.8300634026527405
after epoch: 4,now: 2024-08-06 09:13:48.596803,epoch time: 0:20:06.432786,used: 1:24:08.661811,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94750077, 'precision': 0.9476763, 'recall': 0.94750273, 'specificity': 0.94750273, 'f1': 0.9474958, 'auroc': 0.9867319, 'binary_precision': 0.9565887, 'binary_recall': 0.9375701, 'binary_specificity': 0.9574353, 'binary_f1_score': 0.9469839}
confusion matrix:
       0      1
0  24743   1100
1   1614  24239
---- Validation: 
scalar performance:
{'acc': 0.83637, 'precision': 0.5481071, 'recall': 0.7925162, 'specificity': 0.7925162, 'f1': 0.54561377, 'auroc': 0.8693054, 'binary_precision': 0.10372341, 'binary_recall': 0.7464115, 'binary_specificity': 0.83862084, 'binary_f1_score': 0.18213661}
confusion matrix:
       0     1
0  14010  2696
1    106   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.826199, 'precision': 0.6349259, 'recall': 0.822482, 'specificity': 0.822482, 'f1': 0.66200256, 'auroc': 0.88296795, 'binary_precision': 0.288368, 'binary_recall': 0.8180677, 'binary_specificity': 0.8268962, 'binary_f1_score': 0.42642248}
confusion matrix:
      0     1
0  7686  1609
1   145   652
early stop counter: 3
val acc:0.8363699913024902, best validation acc: 0.8606634140014648, corresponding to test acc:                         0.8229290246963501 / 0.8300634026527405
after epoch: 5,now: 2024-08-06 09:34:32.588155,epoch time: 0:20:43.991352,used: 1:44:52.653163,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9514276, 'precision': 0.9516607, 'recall': 0.95142937, 'specificity': 0.95142937, 'f1': 0.95142144, 'auroc': 0.98776984, 'binary_precision': 0.9619602, 'binary_recall': 0.94004333, 'binary_specificity': 0.96281534, 'binary_f1_score': 0.95087546}
confusion matrix:
       0      1
0  24883    961
1   1550  24302
---- Validation: 
scalar performance:
{'acc': 0.84320253, 'precision': 0.55006653, 'recall': 0.79485166, 'specificity': 0.79485166, 'f1': 0.55065393, 'auroc': 0.8718504, 'binary_precision': 0.10764971, 'binary_recall': 0.74401915, 'binary_specificity': 0.8456842, 'binary_f1_score': 0.18808588}
confusion matrix:
       0     1
0  14128  2578
1    107   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83432424, 'precision': 0.63906497, 'recall': 0.82173085, 'specificity': 0.82173085, 'f1': 0.66884536, 'auroc': 0.8835061, 'binary_precision': 0.29754743, 'binary_recall': 0.8067754, 'binary_specificity': 0.8366864, 'binary_f1_score': 0.4347532}
confusion matrix:
      0     1
0  7777  1518
1   154   643
new oracle model saved
early stop counter: 4
val acc:0.843202531337738, best validation acc: 0.8606634140014648, corresponding to test acc:                         0.8229290246963501 / 0.8343242406845093
after epoch: 6,now: 2024-08-06 09:56:41.384239,epoch time: 0:22:08.796084,used: 2:07:01.449247,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9515243, 'precision': 0.95201284, 'recall': 0.9515275, 'specificity': 0.9515275, 'f1': 0.95151144, 'auroc': 0.9883306, 'binary_precision': 0.9669213, 'binary_recall': 0.9350559, 'binary_specificity': 0.9679991, 'binary_f1_score': 0.9507217}
confusion matrix:
       0      1
0  25016    827
1   1679  24174
---- Validation: 
scalar performance:
{'acc': 0.8644592, 'precision': 0.5564483, 'recall': 0.79641604, 'specificity': 0.79641604, 'f1': 0.5664671, 'auroc': 0.87219036, 'binary_precision': 0.12076525, 'binary_recall': 0.7248804, 'binary_specificity': 0.86795163, 'binary_f1_score': 0.20703791}
confusion matrix:
       0     1
0  14500  2206
1    115   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8482957, 'precision': 0.6475111, 'recall': 0.8212858, 'specificity': 0.8212858, 'f1': 0.68152195, 'auroc': 0.8831823, 'binary_precision': 0.31576306, 'binary_recall': 0.78920954, 'binary_specificity': 0.853362, 'binary_f1_score': 0.45105773}
confusion matrix:
      0     1
0  7932  1363
1   168   629
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-06 10:18:51.964401,epoch time: 0:22:10.580162,used: 2:29:12.029409,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95202726, 'precision': 0.9524752, 'recall': 0.9520309, 'specificity': 0.9520309, 'f1': 0.95201564, 'auroc': 0.9891982, 'binary_precision': 0.9667705, 'binary_recall': 0.9362574, 'binary_specificity': 0.9678044, 'binary_f1_score': 0.9512693}
confusion matrix:
       0      1
0  25010    832
1   1648  24206
---- Validation: 
scalar performance:
{'acc': 0.86019623, 'precision': 0.55544776, 'recall': 0.79889613, 'specificity': 0.79889613, 'f1': 0.5637449, 'auroc': 0.87350476, 'binary_precision': 0.11853282, 'binary_recall': 0.73444974, 'binary_specificity': 0.8633425, 'binary_f1_score': 0.20412233}
confusion matrix:
       0     1
0  14423  2283
1    111   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8461157, 'precision': 0.64606297, 'recall': 0.8212495, 'specificity': 0.8212495, 'f1': 0.6794502, 'auroc': 0.8839178, 'binary_precision': 0.31268582, 'binary_recall': 0.79171896, 'binary_specificity': 0.85078, 'binary_f1_score': 0.4483126}
confusion matrix:
      0     1
0  7908  1387
1   166   631
early stop counter: 1
val acc:0.8601962327957153, best validation acc: 0.864459216594696, corresponding to test acc:                         0.8482956886291504 / 0.8482956886291504
after epoch: 8,now: 2024-08-06 10:41:06.872771,epoch time: 0:22:14.908370,used: 2:51:26.937779,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95547044, 'precision': 0.95560217, 'recall': 0.9554708, 'specificity': 0.9554708, 'f1': 0.9554672, 'auroc': 0.9898937, 'binary_precision': 0.9633594, 'binary_recall': 0.9469612, 'binary_specificity': 0.9639803, 'binary_f1_score': 0.9550899}
confusion matrix:
       0      1
0  24916    931
1   1371  24478
---- Validation: 
scalar performance:
{'acc': 0.8438449, 'precision': 0.5509567, 'recall': 0.7998458, 'specificity': 0.7998458, 'f1': 0.5521319, 'auroc': 0.87441653, 'binary_precision': 0.10914761, 'binary_recall': 0.7535885, 'binary_specificity': 0.8461032, 'binary_f1_score': 0.19067797}
confusion matrix:
       0     1
0  14135  2571
1    103   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83729684, 'precision': 0.6413493, 'recall': 0.8239182, 'specificity': 0.8239182, 'f1': 0.672212, 'auroc': 0.88580894, 'binary_precision': 0.30192217, 'binary_recall': 0.8080301, 'binary_specificity': 0.8398063, 'binary_f1_score': 0.43959042}
confusion matrix:
      0     1
0  7806  1489
1   153   644
early stop counter: 2
val acc:0.8438448905944824, best validation acc: 0.864459216594696, corresponding to test acc:                         0.8482956886291504 / 0.8482956886291504
after epoch: 9,now: 2024-08-06 11:03:24.429431,epoch time: 0:22:17.556660,used: 3:13:44.494439,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95643765, 'precision': 0.95656407, 'recall': 0.9564389, 'specificity': 0.9564389, 'f1': 0.95643467, 'auroc': 0.9899504, 'binary_precision': 0.9642014, 'binary_recall': 0.9480891, 'binary_specificity': 0.96478873, 'binary_f1_score': 0.95607734}
confusion matrix:
       0      1
0  24934    910
1   1342  24510
---- Validation: 
scalar performance:
{'acc': 0.8443121, 'precision': 0.5512807, 'recall': 0.80125153, 'specificity': 0.80125153, 'f1': 0.5527462, 'auroc': 0.8756907, 'binary_precision': 0.10972222, 'binary_recall': 0.75598085, 'binary_specificity': 0.8465222, 'binary_f1_score': 0.19163129}
confusion matrix:
       0     1
0  14142  2564
1    102   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8391796, 'precision': 0.6430341, 'recall': 0.8260874, 'specificity': 0.8260874, 'f1': 0.6746206, 'auroc': 0.8861352, 'binary_precision': 0.30500472, 'binary_recall': 0.81053954, 'binary_specificity': 0.8416353, 'binary_f1_score': 0.44322467}
confusion matrix:
      0     1
0  7823  1472
1   151   646
early stop counter: 3
val acc:0.8443120718002319, best validation acc: 0.864459216594696, corresponding to test acc:                         0.8482956886291504 / 0.8482956886291504
after epoch: 10,now: 2024-08-06 11:26:11.518096,epoch time: 0:22:47.088665,used: 3:36:31.583104,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95585734, 'precision': 0.95607203, 'recall': 0.95586026, 'specificity': 0.95586026, 'f1': 0.95585227, 'auroc': 0.9901252, 'binary_precision': 0.96603537, 'binary_recall': 0.94496226, 'binary_specificity': 0.96675825, 'binary_f1_score': 0.9553826}
confusion matrix:
       0      1
0  24982    859
1   1423  24432
---- Validation: 
scalar performance:
{'acc': 0.8558748, 'precision': 0.55502623, 'recall': 0.8048451, 'specificity': 0.8048451, 'f1': 0.561809, 'auroc': 0.87668717, 'binary_precision': 0.11725168, 'binary_recall': 0.75119615, 'binary_specificity': 0.858494, 'binary_f1_score': 0.20284238}
confusion matrix:
       0     1
0  14342  2364
1    104   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8463139, 'precision': 0.6475836, 'recall': 0.82651913, 'specificity': 0.82651913, 'f1': 0.68137884, 'auroc': 0.88738716, 'binary_precision': 0.31465092, 'binary_recall': 0.8030113, 'binary_specificity': 0.8500269, 'binary_f1_score': 0.45213702}
confusion matrix:
      0     1
0  7901  1394
1   157   640
early stop counter: 4
val acc:0.85587477684021, best validation acc: 0.864459216594696, corresponding to test acc:                         0.8482956886291504 / 0.8482956886291504
after epoch: 11,now: 2024-08-06 11:49:09.343476,epoch time: 0:22:57.825380,used: 3:59:29.408484,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9569019, 'precision': 0.9571434, 'recall': 0.9569037, 'specificity': 0.9569037, 'f1': 0.9568963, 'auroc': 0.99041843, 'binary_precision': 0.9676908, 'binary_recall': 0.9453814, 'binary_specificity': 0.9684259, 'binary_f1_score': 0.956406}
confusion matrix:
       0      1
0  25028    816
1   1412  24440
---- Validation: 
scalar performance:
{'acc': 0.86142254, 'precision': 0.5564826, 'recall': 0.8030234, 'specificity': 0.8030234, 'f1': 0.5656131, 'auroc': 0.875563, 'binary_precision': 0.12038835, 'binary_recall': 0.7416268, 'binary_specificity': 0.86442, 'binary_f1_score': 0.20715003}
confusion matrix:
       0     1
0  14441  2265
1    108   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85186285, 'precision': 0.65136087, 'recall': 0.8266637, 'specificity': 0.8266637, 'f1': 0.6867435, 'auroc': 0.8856796, 'binary_precision': 0.3226626, 'binary_recall': 0.7967378, 'binary_specificity': 0.85658956, 'binary_f1_score': 0.45931286}
confusion matrix:
      0     1
0  7962  1333
1   162   635
new oracle model saved
early stop counter: 5
val acc:0.8614225387573242, best validation acc: 0.864459216594696, corresponding to test acc:                         0.8482956886291504 / 0.8518628478050232
after epoch: 12,now: 2024-08-06 12:12:00.408404,epoch time: 0:22:51.064928,used: 4:22:20.473412,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_07_49_39_seed_2_24076674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 4:22:20.473412 at 2024-08-06 12:12:00.408404
persisted model performance metric: 

scalar performance:
{'acc': 0.8482957, 'precision': 0.6475111, 'recall': 0.8212858, 'specificity': 0.8212858, 'f1': 0.68152195, 'auroc': 0.8831823, 'binary_precision': 0.31576306, 'binary_recall': 0.78920954, 'binary_specificity': 0.853362, 'binary_f1_score': 0.45105773}
confusion matrix:
      0     1
0  7932  1363
1   168   629
oracle model performance metric: 

scalar performance:
{'acc': 0.85186285, 'precision': 0.65136087, 'recall': 0.8266637, 'specificity': 0.8266637, 'f1': 0.6867435, 'auroc': 0.8856796, 'binary_precision': 0.3226626, 'binary_recall': 0.7967378, 'binary_specificity': 0.85658956, 'binary_f1_score': 0.45931286}
confusion matrix:
      0     1
0  7962  1333
1   162   635
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB | 573296 GiB | 573295 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 561525 GiB | 561525 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  11770 GiB |  11770 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB | 573296 GiB | 573295 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 561525 GiB | 561525 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  11770 GiB |  11770 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB | 573263 GiB | 573263 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 561514 GiB | 561514 GiB |
|       from small pool |  16648 KiB |  37683 KiB |  11749 GiB |  11749 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1062 MiB | 561152 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB | 113923 KiB | 358242 GiB | 358242 GiB |
|       from large pool |  31306 KiB |  92928 KiB | 346246 GiB | 346246 GiB |
|       from small pool |  10477 KiB |  28227 KiB |  11995 GiB |  11995 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6925    |  119473 K  |  119469 K  |
|       from large pool |      76    |     158    |   55349 K  |   55349 K  |
|       from small pool |    4324    |    6848    |   64124 K  |   64120 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6925    |  119473 K  |  119469 K  |
|       from large pool |      76    |     158    |   55349 K  |   55349 K  |
|       from small pool |    4324    |    6848    |   64124 K  |   64120 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      72    |      31    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3248    |   72264 K  |   72264 K  |
|       from large pool |      10    |      23    |   38525 K  |   38525 K  |
|       from small pool |      21    |    3238    |   33739 K  |   33739 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 573296 GiB | 573296 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 561525 GiB | 561525 GiB |
|       from small pool |      0 KiB |  39230 KiB |  11770 GiB |  11770 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 573296 GiB | 573296 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 561525 GiB | 561525 GiB |
|       from small pool |      0 KiB |  39230 KiB |  11770 GiB |  11770 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 573263 GiB | 573263 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 561514 GiB | 561514 GiB |
|       from small pool |      0 KiB |  37683 KiB |  11749 GiB |  11749 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |   1062 MiB |    834 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  28672 KiB |  43008 KiB |     54 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB | 113923 KiB | 358242 GiB | 358242 GiB |
|       from large pool |  23872 KiB |  92928 KiB | 346246 GiB | 346246 GiB |
|       from small pool |      0 KiB |  28227 KiB |  11995 GiB |  11995 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6925    |  119473 K  |  119473 K  |
|       from large pool |       2    |     158    |   55349 K  |   55349 K  |
|       from small pool |       0    |    6848    |   64124 K  |   64124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6925    |  119473 K  |  119473 K  |
|       from large pool |       2    |     158    |   55349 K  |   55349 K  |
|       from small pool |       0    |    6848    |   64124 K  |   64124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      72    |      48    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      14    |      21    |      27    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3248    |   72266 K  |   72266 K  |
|       from large pool |       3    |      23    |   38525 K  |   38525 K  |
|       from small pool |       0    |    3238    |   33741 K  |   33741 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug  6 12:31:21 2024]
Finished job 0.
1 of 1 steps (100%) done
