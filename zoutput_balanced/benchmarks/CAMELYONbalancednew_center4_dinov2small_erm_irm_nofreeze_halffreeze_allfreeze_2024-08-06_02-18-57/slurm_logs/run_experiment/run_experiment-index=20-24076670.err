Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/20.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=20
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670

 Experiment start at: 2024-08-06 02:34:45.368837
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.72656745, 'precision': 0.7268578, 'recall': 0.72657514, 'specificity': 0.72657514, 'f1': 0.7264843, 'auroc': 0.78773737, 'binary_precision': 0.73508227, 'binary_recall': 0.7088283, 'binary_specificity': 0.744322, 'binary_f1_score': 0.7217166}
confusion matrix:
       0      1
0  18844   6473
1   7378  17961
---- Validation: 
scalar performance:
{'acc': 0.7664178, 'precision': 0.5223552, 'recall': 0.67117363, 'specificity': 0.67117363, 'f1': 0.48574492, 'auroc': 0.75696325, 'binary_precision': 0.058316927, 'binary_recall': 0.5710843, 'binary_specificity': 0.77126294, 'binary_f1_score': 0.10582719}
confusion matrix:
       0     1
0  12904  3827
1    178   237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6336761, 'precision': 0.5535851, 'recall': 0.68287265, 'specificity': 0.68287265, 'f1': 0.49750602, 'auroc': 0.7320254, 'binary_precision': 0.14029925, 'binary_recall': 0.74093264, 'binary_specificity': 0.62481266, 'binary_f1_score': 0.23592493}
confusion matrix:
      0     1
0  5837  3505
1   200   572
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 02:56:07.440088,epoch time: 0:21:22.071251,used: 0:21:22.071251,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8238116, 'precision': 0.8238399, 'recall': 0.8238147, 'specificity': 0.8238147, 'f1': 0.82380867, 'auroc': 0.90198135, 'binary_precision': 0.82703954, 'binary_recall': 0.81917536, 'binary_specificity': 0.828454, 'binary_f1_score': 0.82308865}
confusion matrix:
       0      1
0  20969   4342
1   4583  20762
---- Validation: 
scalar performance:
{'acc': 0.8088184, 'precision': 0.52972007, 'recall': 0.69759953, 'specificity': 0.69759953, 'f1': 0.51041436, 'auroc': 0.7782291, 'binary_precision': 0.07204783, 'binary_recall': 0.58072287, 'binary_specificity': 0.81447613, 'binary_f1_score': 0.12819149}
confusion matrix:
       0     1
0  13627  3104
1    174   241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67777336, 'precision': 0.5711135, 'recall': 0.73466825, 'specificity': 0.73466825, 'f1': 0.534062, 'auroc': 0.80290496, 'binary_precision': 0.1661745, 'binary_recall': 0.8018135, 'binary_specificity': 0.667523, 'binary_f1_score': 0.27529463}
confusion matrix:
      0     1
0  6236  3106
1   153   619
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 03:14:58.819522,epoch time: 0:18:51.379434,used: 0:40:13.450685,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8559302, 'precision': 0.85604143, 'recall': 0.8559351, 'specificity': 0.8559351, 'f1': 0.8559201, 'auroc': 0.93174374, 'binary_precision': 0.8624749, 'binary_recall': 0.8470918, 'binary_specificity': 0.8647784, 'binary_f1_score': 0.85471416}
confusion matrix:
       0      1
0  21891   3423
1   3875  21467
---- Validation: 
scalar performance:
{'acc': 0.83185583, 'precision': 0.5338359, 'recall': 0.70352924, 'specificity': 0.70352924, 'f1': 0.5237481, 'auroc': 0.78697455, 'binary_precision': 0.08027211, 'binary_recall': 0.5686747, 'binary_specificity': 0.83838385, 'binary_f1_score': 0.14068556}
confusion matrix:
       0     1
0  14027  2704
1    179   236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7137631, 'precision': 0.5830558, 'recall': 0.7624682, 'specificity': 0.7624682, 'f1': 0.56203544, 'auroc': 0.833269, 'binary_precision': 0.18678077, 'binary_recall': 0.8199482, 'binary_specificity': 0.70498824, 'binary_f1_score': 0.3042538}
confusion matrix:
      0     1
0  6586  2756
1   139   633
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 03:31:14.725427,epoch time: 0:16:15.905905,used: 0:56:29.356590,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87186116, 'precision': 0.87208945, 'recall': 0.8718695, 'specificity': 0.8718695, 'f1': 0.8718433, 'auroc': 0.9448428, 'binary_precision': 0.8814746, 'binary_recall': 0.85945946, 'binary_specificity': 0.88427955, 'binary_f1_score': 0.87032783}
confusion matrix:
       0      1
0  22382   2929
1   3562  21783
---- Validation: 
scalar performance:
{'acc': 0.8536685, 'precision': 0.54042375, 'recall': 0.71823096, 'specificity': 0.71823096, 'f1': 0.53993994, 'auroc': 0.7937211, 'binary_precision': 0.0929238, 'binary_recall': 0.5759036, 'binary_specificity': 0.8605583, 'binary_f1_score': 0.16002677}
confusion matrix:
       0     1
0  14398  2333
1    176   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7439193, 'precision': 0.5917554, 'recall': 0.7752274, 'specificity': 0.7752274, 'f1': 0.5840708, 'auroc': 0.85097766, 'binary_precision': 0.20410156, 'binary_recall': 0.81217617, 'binary_specificity': 0.73827875, 'binary_f1_score': 0.32622266}
confusion matrix:
      0     1
0  6897  2445
1   145   627
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 03:47:17.903455,epoch time: 0:16:03.178028,used: 1:12:32.534618,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88619316, 'precision': 0.88764286, 'recall': 0.8862137, 'specificity': 0.8862137, 'f1': 0.88609046, 'auroc': 0.9546126, 'binary_precision': 0.91151744, 'binary_recall': 0.85559285, 'binary_specificity': 0.9168346, 'binary_f1_score': 0.88267016}
confusion matrix:
       0      1
0  23206   2105
1   3660  21685
---- Validation: 
scalar performance:
{'acc': 0.8832964, 'precision': 0.5476202, 'recall': 0.7099136, 'specificity': 0.7099136, 'f1': 0.55838096, 'auroc': 0.8000247, 'binary_precision': 0.10820158, 'binary_recall': 0.52771086, 'binary_specificity': 0.8921164, 'binary_f1_score': 0.1795818}
confusion matrix:
       0     1
0  14926  1805
1    196   219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7918727, 'precision': 0.60908526, 'recall': 0.7922733, 'specificity': 0.7922733, 'f1': 0.6215572, 'auroc': 0.8611543, 'binary_precision': 0.23934297, 'binary_recall': 0.7927461, 'binary_specificity': 0.7918005, 'binary_f1_score': 0.36767796}
confusion matrix:
      0     1
0  7397  1945
1   160   612
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 04:03:22.719710,epoch time: 0:16:04.816255,used: 1:28:37.350873,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8947607, 'precision': 0.895651, 'recall': 0.8947748, 'specificity': 0.8947748, 'f1': 0.89470387, 'auroc': 0.959286, 'binary_precision': 0.9145675, 'binary_recall': 0.87100977, 'binary_specificity': 0.9185399, 'binary_f1_score': 0.8922573}
confusion matrix:
       0      1
0  23251   2062
1   3269  22074
---- Validation: 
scalar performance:
{'acc': 0.8771142, 'precision': 0.5485548, 'recall': 0.72671974, 'specificity': 0.72671974, 'f1': 0.5582885, 'auroc': 0.806741, 'binary_precision': 0.1090573, 'binary_recall': 0.5686747, 'binary_specificity': 0.8847648, 'binary_f1_score': 0.18301667}
confusion matrix:
       0     1
0  14803  1928
1    179   236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7946411, 'precision': 0.6119306, 'recall': 0.79911923, 'specificity': 0.79911923, 'f1': 0.62568754, 'auroc': 0.8693595, 'binary_precision': 0.24381626, 'binary_recall': 0.80440414, 'binary_specificity': 0.79383427, 'binary_f1_score': 0.3742091}
confusion matrix:
      0     1
0  7416  1926
1   151   621
new oracle model saved
early stop counter: 1
val acc:0.8771141767501831, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.7946410775184631
after epoch: 6,now: 2024-08-06 04:18:59.324083,epoch time: 0:15:36.604373,used: 1:44:13.955246,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9021636, 'precision': 0.9026054, 'recall': 0.9021721, 'specificity': 0.9021721, 'f1': 0.902138, 'auroc': 0.9632581, 'binary_precision': 0.91607136, 'binary_recall': 0.8855609, 'binary_specificity': 0.9187833, 'binary_f1_score': 0.90055776}
confusion matrix:
       0      1
0  23259   2056
1   2900  22441
---- Validation: 
scalar performance:
{'acc': 0.8667328, 'precision': 0.5469596, 'recall': 0.7366744, 'specificity': 0.7366744, 'f1': 0.55321234, 'auroc': 0.81273776, 'binary_precision': 0.105152026, 'binary_recall': 0.6, 'binary_specificity': 0.8733489, 'binary_f1_score': 0.17894359}
confusion matrix:
       0     1
0  14612  2119
1    166   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7929602, 'precision': 0.612735, 'recall': 0.8041508, 'specificity': 0.8041508, 'f1': 0.625966, 'auroc': 0.87472224, 'binary_precision': 0.24419504, 'binary_recall': 0.81735754, 'binary_specificity': 0.7909441, 'binary_f1_score': 0.37604293}
confusion matrix:
      0     1
0  7389  1953
1   141   631
early stop counter: 2
val acc:0.8667327761650085, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.7946410775184631
after epoch: 7,now: 2024-08-06 04:33:55.503635,epoch time: 0:14:56.179552,used: 1:59:10.134798,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90650666, 'precision': 0.90740013, 'recall': 0.9065205, 'specificity': 0.9065205, 'f1': 0.9064574, 'auroc': 0.9661975, 'binary_precision': 0.9266283, 'binary_recall': 0.8830446, 'binary_specificity': 0.92999643, 'binary_f1_score': 0.90431166}
confusion matrix:
       0      1
0  23541   1772
1   2964  22379
---- Validation: 
scalar performance:
{'acc': 0.86766595, 'precision': 0.54772395, 'recall': 0.73950243, 'specificity': 0.73950243, 'f1': 0.55458915, 'auroc': 0.8165149, 'binary_precision': 0.1065365, 'binary_recall': 0.6048193, 'binary_specificity': 0.8741856, 'binary_f1_score': 0.18116203}
confusion matrix:
       0     1
0  14626  2105
1    164   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80215544, 'precision': 0.6174077, 'recall': 0.80912834, 'specificity': 0.80912834, 'f1': 0.634406, 'auroc': 0.8784784, 'binary_precision': 0.25331193, 'binary_recall': 0.81735754, 'binary_specificity': 0.80089915, 'binary_f1_score': 0.38676068}
confusion matrix:
      0     1
0  7482  1860
1   141   631
new oracle model saved
early stop counter: 3
val acc:0.8676659464836121, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8021554350852966
after epoch: 8,now: 2024-08-06 04:48:51.783915,epoch time: 0:14:56.280280,used: 2:14:06.415078,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91276455, 'precision': 0.913455, 'recall': 0.9127767, 'specificity': 0.9127767, 'f1': 0.91272974, 'auroc': 0.9697422, 'binary_precision': 0.93049955, 'binary_recall': 0.89227796, 'binary_specificity': 0.9332754, 'binary_f1_score': 0.910988}
confusion matrix:
       0      1
0  23624   1689
1   2730  22613
---- Validation: 
scalar performance:
{'acc': 0.86544967, 'precision': 0.54765487, 'recall': 0.74306655, 'specificity': 0.74306655, 'f1': 0.5538737, 'auroc': 0.8195731, 'binary_precision': 0.106161535, 'binary_recall': 0.61445785, 'binary_specificity': 0.8716753, 'binary_f1_score': 0.18104365}
confusion matrix:
       0     1
0  14584  2147
1    160   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8052205, 'precision': 0.61952627, 'recall': 0.81257, 'specificity': 0.81257, 'f1': 0.63782454, 'auroc': 0.880118, 'binary_precision': 0.2570965, 'binary_recall': 0.8212435, 'binary_specificity': 0.80389637, 'binary_f1_score': 0.3915997}
confusion matrix:
      0     1
0  7510  1832
1   138   634
new oracle model saved
early stop counter: 4
val acc:0.8654496669769287, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8052204847335815
after epoch: 9,now: 2024-08-06 05:04:37.803936,epoch time: 0:15:46.020021,used: 2:29:52.435099,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9153111, 'precision': 0.916589, 'recall': 0.91532534, 'specificity': 0.91532534, 'f1': 0.91524804, 'auroc': 0.9712227, 'binary_precision': 0.93979025, 'binary_recall': 0.8875735, 'binary_specificity': 0.9430772, 'binary_f1_score': 0.91293585}
confusion matrix:
       0      1
0  23874   1441
1   2849  22492
---- Validation: 
scalar performance:
{'acc': 0.87828064, 'precision': 0.5507761, 'recall': 0.73671687, 'specificity': 0.73671687, 'f1': 0.5618569, 'auroc': 0.82166386, 'binary_precision': 0.11296296, 'binary_recall': 0.5879518, 'binary_specificity': 0.885482, 'binary_f1_score': 0.18951456}
confusion matrix:
       0     1
0  14815  1916
1    171   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.824303, 'precision': 0.6297081, 'recall': 0.81933475, 'specificity': 0.81933475, 'f1': 0.6553837, 'auroc': 0.88222444, 'binary_precision': 0.2777532, 'binary_recall': 0.8134715, 'binary_specificity': 0.82519805, 'binary_f1_score': 0.41411144}
confusion matrix:
      0     1
0  7709  1633
1   144   628
new oracle model saved
early stop counter: 5
val acc:0.8782806396484375, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8243029713630676
after epoch: 10,now: 2024-08-06 05:20:18.569702,epoch time: 0:15:40.765766,used: 2:45:33.200865,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91801566, 'precision': 0.91899365, 'recall': 0.9180329, 'specificity': 0.9180329, 'f1': 0.91796994, 'auroc': 0.9729748, 'binary_precision': 0.9394153, 'binary_recall': 0.89378995, 'binary_specificity': 0.94227576, 'binary_f1_score': 0.9160348}
confusion matrix:
       0      1
0  23849   1461
1   2692  22654
---- Validation: 
scalar performance:
{'acc': 0.86591625, 'precision': 0.5480325, 'recall': 0.7444806, 'specificity': 0.7444806, 'f1': 0.55455667, 'auroc': 0.8256551, 'binary_precision': 0.10684474, 'binary_recall': 0.6168675, 'binary_specificity': 0.87209374, 'binary_f1_score': 0.18214159}
confusion matrix:
       0     1
0  14591  2140
1    159   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81550324, 'precision': 0.6253073, 'recall': 0.8181362, 'specificity': 0.8181362, 'f1': 0.6477168, 'auroc': 0.88404083, 'binary_precision': 0.26841658, 'binary_recall': 0.8212435, 'binary_specificity': 0.8150289, 'binary_f1_score': 0.40459472}
confusion matrix:
      0     1
0  7614  1728
1   138   634
early stop counter: 6
val acc:0.8659162521362305, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8243029713630676
after epoch: 11,now: 2024-08-06 05:35:42.768198,epoch time: 0:15:24.198496,used: 3:00:57.399361,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92257583, 'precision': 0.9233476, 'recall': 0.92258936, 'specificity': 0.92258936, 'f1': 0.92254215, 'auroc': 0.9748995, 'binary_precision': 0.9415815, 'binary_recall': 0.90116006, 'binary_specificity': 0.94401866, 'binary_f1_score': 0.92092746}
confusion matrix:
       0      1
0  23895   1417
1   2505  22839
---- Validation: 
scalar performance:
{'acc': 0.8645165, 'precision': 0.5492486, 'recall': 0.7543378, 'specificity': 0.7543378, 'f1': 0.5559401, 'auroc': 0.8305953, 'binary_precision': 0.10869565, 'binary_recall': 0.6385542, 'binary_specificity': 0.87012136, 'binary_f1_score': 0.18576936}
confusion matrix:
       0     1
0  14558  2173
1    150   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81856835, 'precision': 0.6269678, 'recall': 0.81920123, 'specificity': 0.81920123, 'f1': 0.6505573, 'auroc': 0.88586617, 'binary_precision': 0.27179047, 'binary_recall': 0.8199482, 'binary_specificity': 0.81845427, 'binary_f1_score': 0.4082554}
confusion matrix:
      0     1
0  7646  1696
1   139   633
early stop counter: 7
val acc:0.8645164966583252, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8243029713630676
after epoch: 12,now: 2024-08-06 05:50:44.887491,epoch time: 0:15:02.119293,used: 3:15:59.518654,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92399716, 'precision': 0.92492163, 'recall': 0.92401195, 'specificity': 0.92401195, 'f1': 0.9239576, 'auroc': 0.97546375, 'binary_precision': 0.9448998, 'binary_recall': 0.90060765, 'binary_specificity': 0.94741625, 'binary_f1_score': 0.92222226}
confusion matrix:
       0      1
0  23981   1331
1   2519  22825
---- Validation: 
scalar performance:
{'acc': 0.86661613, 'precision': 0.54987997, 'recall': 0.7542387, 'specificity': 0.7542387, 'f1': 0.5574552, 'auroc': 0.83202165, 'binary_precision': 0.11, 'binary_recall': 0.6361446, 'binary_specificity': 0.8723328, 'binary_f1_score': 0.18756661}
confusion matrix:
       0     1
0  14595  2136
1    151   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82193, 'precision': 0.6282214, 'recall': 0.81805027, 'specificity': 0.81805027, 'f1': 0.65298706, 'auroc': 0.88626397, 'binary_precision': 0.27483588, 'binary_recall': 0.8134715, 'binary_specificity': 0.822629, 'binary_f1_score': 0.4108603}
confusion matrix:
      0     1
0  7685  1657
1   144   628
early stop counter: 8
val acc:0.8666161298751831, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8243029713630676
after epoch: 13,now: 2024-08-06 06:06:15.345115,epoch time: 0:15:30.457624,used: 3:31:29.976278,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92480654, 'precision': 0.9257534, 'recall': 0.92481685, 'specificity': 0.92481685, 'f1': 0.92476594, 'auroc': 0.97726274, 'binary_precision': 0.9459404, 'binary_recall': 0.90118, 'binary_specificity': 0.9484536, 'binary_f1_score': 0.9230179}
confusion matrix:
       0      1
0  24012   1305
1   2504  22835
---- Validation: 
scalar performance:
{'acc': 0.8637583, 'precision': 0.5489558, 'recall': 0.7539493, 'specificity': 0.7539493, 'f1': 0.55529666, 'auroc': 0.8328072, 'binary_precision': 0.10811914, 'binary_recall': 0.6385542, 'binary_specificity': 0.86934435, 'binary_f1_score': 0.18492673}
confusion matrix:
       0     1
0  14545  2186
1    150   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82193, 'precision': 0.6288605, 'recall': 0.8204268, 'specificity': 0.8204268, 'f1': 0.6537315, 'auroc': 0.8872422, 'binary_precision': 0.27562144, 'binary_recall': 0.81865287, 'binary_specificity': 0.82220083, 'binary_f1_score': 0.41239804}
confusion matrix:
      0     1
0  7681  1661
1   140   632
early stop counter: 9
val acc:0.8637583255767822, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8243029713630676
after epoch: 14,now: 2024-08-06 06:21:58.434388,epoch time: 0:15:43.089273,used: 3:47:13.065551,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9284981, 'precision': 0.92909634, 'recall': 0.92850924, 'specificity': 0.92850924, 'f1': 0.9284744, 'auroc': 0.97755146, 'binary_precision': 0.9452667, 'binary_recall': 0.9097581, 'binary_specificity': 0.9472603, 'binary_f1_score': 0.9271726}
confusion matrix:
       0      1
0  23978   1335
1   2287  23056
---- Validation: 
scalar performance:
{'acc': 0.8546017, 'precision': 0.54805124, 'recall': 0.7645315, 'specificity': 0.7645315, 'f1': 0.5512805, 'auroc': 0.83521926, 'binary_precision': 0.1055429, 'binary_recall': 0.6698795, 'binary_specificity': 0.85918355, 'binary_f1_score': 0.18235487}
confusion matrix:
       0     1
0  14375  2356
1    137   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8150089, 'precision': 0.62597764, 'recall': 0.8214335, 'specificity': 0.8214335, 'f1': 0.64832884, 'auroc': 0.8884915, 'binary_precision': 0.2690206, 'binary_recall': 0.82901555, 'binary_specificity': 0.8138514, 'binary_f1_score': 0.40622023}
confusion matrix:
      0     1
0  7603  1739
1   132   640
early stop counter: 10
val acc:0.8546016812324524, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8243029713630676
after epoch: 15,now: 2024-08-06 06:37:55.140130,epoch time: 0:15:56.705742,used: 4:03:09.771293,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9296036, 'precision': 0.93020695, 'recall': 0.92961323, 'specificity': 0.92961323, 'f1': 0.92958, 'auroc': 0.97891474, 'binary_precision': 0.9464469, 'binary_recall': 0.9108165, 'binary_specificity': 0.94841003, 'binary_f1_score': 0.92828995}
confusion matrix:
       0      1
0  24009   1306
1   2260  23081
---- Validation: 
scalar performance:
{'acc': 0.8549516, 'precision': 0.54835737, 'recall': 0.7658858, 'specificity': 0.7658858, 'f1': 0.5518298, 'auroc': 0.83813936, 'binary_precision': 0.106083654, 'binary_recall': 0.67228913, 'binary_specificity': 0.8594824, 'binary_f1_score': 0.18325125}
confusion matrix:
       0     1
0  14380  2351
1    136   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8183706, 'precision': 0.6278062, 'recall': 0.8226591, 'specificity': 0.8226591, 'f1': 0.65146375, 'auroc': 0.88861895, 'binary_precision': 0.27272728, 'binary_recall': 0.8277202, 'binary_specificity': 0.8175979, 'binary_f1_score': 0.4102729}
confusion matrix:
      0     1
0  7638  1704
1   133   639
early stop counter: 11
val acc:0.8549516201019287, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8243029713630676
after epoch: 16,now: 2024-08-06 06:53:00.963788,epoch time: 0:15:05.823658,used: 4:18:15.594951,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93072885, 'precision': 0.9322838, 'recall': 0.9307455, 'specificity': 0.9307455, 'f1': 0.93066823, 'auroc': 0.9789566, 'binary_precision': 0.95834905, 'binary_recall': 0.9006787, 'binary_specificity': 0.9608122, 'binary_f1_score': 0.9286193}
confusion matrix:
       0      1
0  24322    992
1   2517  22825
---- Validation: 
scalar performance:
{'acc': 0.86696607, 'precision': 0.55060667, 'recall': 0.7579428, 'specificity': 0.7579428, 'f1': 0.5586162, 'auroc': 0.8387822, 'binary_precision': 0.11125, 'binary_recall': 0.6433735, 'binary_specificity': 0.8725121, 'binary_f1_score': 0.18969804}
confusion matrix:
       0     1
0  14598  2133
1    148   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8304331, 'precision': 0.63369554, 'recall': 0.8226531, 'specificity': 0.8226531, 'f1': 0.66168666, 'auroc': 0.8883343, 'binary_precision': 0.28558436, 'binary_recall': 0.8134715, 'binary_specificity': 0.83183473, 'binary_f1_score': 0.42275327}
confusion matrix:
      0     1
0  7771  1571
1   144   628
new oracle model saved
early stop counter: 12
val acc:0.8669660687446594, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8304330706596375
after epoch: 17,now: 2024-08-06 07:07:56.688089,epoch time: 0:14:55.724301,used: 4:33:11.319252,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9343217, 'precision': 0.93483305, 'recall': 0.9343319, 'specificity': 0.9343319, 'f1': 0.9343034, 'auroc': 0.9806154, 'binary_precision': 0.9498937, 'binary_recall': 0.91709745, 'binary_specificity': 0.9515664, 'binary_f1_score': 0.9332076}
confusion matrix:
       0      1
0  24087   1226
1   2101  23242
---- Validation: 
scalar performance:
{'acc': 0.8483028, 'precision': 0.548076, 'recall': 0.77540326, 'specificity': 0.77540326, 'f1': 0.5493643, 'auroc': 0.8407661, 'binary_precision': 0.10484454, 'binary_recall': 0.6987952, 'binary_specificity': 0.85201126, 'binary_f1_score': 0.18233259}
confusion matrix:
       0     1
0  14255  2476
1    125   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81629425, 'precision': 0.62704945, 'recall': 0.8233175, 'specificity': 0.8233175, 'f1': 0.64995646, 'auroc': 0.8893931, 'binary_precision': 0.27088606, 'binary_recall': 0.8316062, 'binary_specificity': 0.8150289, 'binary_f1_score': 0.4086569}
confusion matrix:
      0     1
0  7614  1728
1   130   642
early stop counter: 13
val acc:0.8483027815818787, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8304330706596375
after epoch: 18,now: 2024-08-06 07:23:17.386198,epoch time: 0:15:20.698109,used: 4:48:32.017361,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93444014, 'precision': 0.93539506, 'recall': 0.93445504, 'specificity': 0.93445504, 'f1': 0.93440574, 'auroc': 0.9816612, 'binary_precision': 0.9559439, 'binary_recall': 0.9109454, 'binary_specificity': 0.9579646, 'binary_f1_score': 0.9329024}
confusion matrix:
       0      1
0  24248   1064
1   2257  23087
---- Validation: 
scalar performance:
{'acc': 0.8594424, 'precision': 0.55091226, 'recall': 0.77406156, 'specificity': 0.77406156, 'f1': 0.5568848, 'auroc': 0.84254026, 'binary_precision': 0.11080765, 'binary_recall': 0.6843374, 'binary_specificity': 0.8637858, 'binary_f1_score': 0.19073205}
confusion matrix:
       0     1
0  14452  2279
1    131   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82687366, 'precision': 0.63214785, 'recall': 0.8236971, 'specificity': 0.8236971, 'f1': 0.65894246, 'auroc': 0.8888792, 'binary_precision': 0.28195992, 'binary_recall': 0.8199482, 'binary_specificity': 0.8274459, 'binary_f1_score': 0.41962215}
confusion matrix:
      0     1
0  7730  1612
1   139   633
early stop counter: 14
val acc:0.859442412853241, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8304330706596375
after epoch: 19,now: 2024-08-06 07:39:24.794407,epoch time: 0:16:07.408209,used: 5:04:39.425570,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.93578255, 'precision': 0.93668437, 'recall': 0.9357951, 'specificity': 0.9357951, 'f1': 0.9357506, 'auroc': 0.9812956, 'binary_precision': 0.95666736, 'binary_recall': 0.9129903, 'binary_specificity': 0.9586, 'binary_f1_score': 0.93431866}
confusion matrix:
       0      1
0  24266   1048
1   2205  23137
---- Validation: 
scalar performance:
{'acc': 0.8649831, 'precision': 0.55231434, 'recall': 0.7722008, 'specificity': 0.7722008, 'f1': 0.5605482, 'auroc': 0.8435276, 'binary_precision': 0.11382114, 'binary_recall': 0.67469877, 'binary_specificity': 0.86970294, 'binary_f1_score': 0.1947826}
confusion matrix:
       0     1
0  14551  2180
1    135   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83191615, 'precision': 0.6345353, 'recall': 0.8228618, 'specificity': 0.8228618, 'f1': 0.6630477, 'auroc': 0.88938, 'binary_precision': 0.28735104, 'binary_recall': 0.81217617, 'binary_specificity': 0.8335474, 'binary_f1_score': 0.4245091}
confusion matrix:
      0     1
0  7787  1555
1   145   627
new oracle model saved
early stop counter: 15
val acc:0.864983081817627, best validation acc: 0.8832963705062866, corresponding to test acc:                         0.7918726801872253 / 0.8319161534309387
after epoch: 20,now: 2024-08-06 07:54:41.118340,epoch time: 0:15:16.323933,used: 5:19:55.749503,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:19:55.749503 at 2024-08-06 07:54:41.118340
persisted model performance metric: 

scalar performance:
{'acc': 0.7918727, 'precision': 0.60908526, 'recall': 0.7922733, 'specificity': 0.7922733, 'f1': 0.6215572, 'auroc': 0.8611543, 'binary_precision': 0.23934297, 'binary_recall': 0.7927461, 'binary_specificity': 0.7918005, 'binary_f1_score': 0.36767796}
confusion matrix:
      0     1
0  7397  1945
1   160   612
oracle model performance metric: 

scalar performance:
{'acc': 0.83191615, 'precision': 0.6345353, 'recall': 0.8228618, 'specificity': 0.8228618, 'f1': 0.6630477, 'auroc': 0.88938, 'binary_precision': 0.28735104, 'binary_recall': 0.81217617, 'binary_specificity': 0.8335474, 'binary_f1_score': 0.4245091}
confusion matrix:
      0     1
0  7787  1555
1   145   627
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/20.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192600 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 192600 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189463 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |  16649 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44967 KiB |  89169 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |  14567 KiB |  14818 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6815    |   81220 K  |   81216 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46331 K  |   46326 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6815    |   81220 K  |   81216 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46331 K  |   46326 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    3184    |   42903 K  |   42903 K  |
|       from large pool |       9    |      18    |   24129 K  |   24129 K  |
|       from small pool |      29    |    3176    |   18773 K  |   18773 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46331 K  |   46331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46331 K  |   46331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42905 K  |   42905 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18775 K  |   18775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46331 K  |   46331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46331 K  |   46331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42905 K  |   42905 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18775 K  |   18775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670

 Experiment start at: 2024-08-06 08:18:22.168857
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6211442, 'precision': 0.6228019, 'recall': 0.6210979, 'specificity': 0.6210979, 'f1': 0.6198075, 'auroc': 0.65409374, 'binary_precision': 0.6087293, 'binary_recall': 0.6799025, 'binary_specificity': 0.5622933, 'binary_f1_score': 0.6423504}
confusion matrix:
       0      1
0  14280  11116
1   8142  17294
---- Validation: 
scalar performance:
{'acc': 0.87210184, 'precision': 0.5076711, 'recall': 0.5309403, 'specificity': 0.5309403, 'f1': 0.49733362, 'auroc': 0.73216814, 'binary_precision': 0.038804404, 'binary_recall': 0.17169374, 'binary_specificity': 0.8901869, 'binary_f1_score': 0.063301966}
confusion matrix:
       0     1
0  14859  1833
1    357    74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80923593, 'precision': 0.479239, 'recall': 0.46717283, 'specificity': 0.46717283, 'f1': 0.47121745, 'auroc': 0.58378553, 'binary_precision': 0.03870458, 'binary_recall': 0.06472919, 'binary_specificity': 0.86961645, 'binary_f1_score': 0.048442904}
confusion matrix:
      0     1
0  8117  1217
1   708    49
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 08:36:16.128960,epoch time: 0:17:53.960103,used: 0:17:53.960103,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7550362, 'precision': 0.7562544, 'recall': 0.75500894, 'specificity': 0.75500894, 'f1': 0.7547314, 'auroc': 0.8226392, 'binary_precision': 0.7387818, 'binary_recall': 0.7896682, 'binary_specificity': 0.72034967, 'binary_f1_score': 0.7633779}
confusion matrix:
       0      1
0  18294   7102
1   5350  20086
---- Validation: 
scalar performance:
{'acc': 0.8590784, 'precision': 0.52070266, 'recall': 0.5965893, 'specificity': 0.5965893, 'f1': 0.51308775, 'auroc': 0.7655735, 'binary_precision': 0.061116032, 'binary_recall': 0.3201856, 'binary_specificity': 0.87299305, 'binary_f1_score': 0.10264038}
confusion matrix:
       0     1
0  14572  2120
1    293   138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7833713, 'precision': 0.5254246, 'recall': 0.55515665, 'specificity': 0.55515665, 'f1': 0.5205878, 'auroc': 0.70391846, 'binary_precision': 0.1164788, 'binary_recall': 0.28665787, 'binary_specificity': 0.8236554, 'binary_f1_score': 0.16564886}
confusion matrix:
      0     1
0  7688  1646
1   540   217
early stop counter: 1
val acc:0.8590784072875977, best validation acc: 0.8721018433570862, corresponding to test acc:                         0.8092359304428101 / 0.8092359304428101
after epoch: 2,now: 2024-08-06 08:51:50.174984,epoch time: 0:15:34.046024,used: 0:33:28.006127,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8197592, 'precision': 0.819893, 'recall': 0.819752, 'specificity': 0.819752, 'f1': 0.819738, 'auroc': 0.8947195, 'binary_precision': 0.81352603, 'binary_recall': 0.8300307, 'binary_specificity': 0.8094732, 'binary_f1_score': 0.82169545}
confusion matrix:
       0      1
0  20559   4839
1   4323  21111
---- Validation: 
scalar performance:
{'acc': 0.87157625, 'precision': 0.5293019, 'recall': 0.62786263, 'specificity': 0.62786263, 'f1': 0.52886224, 'auroc': 0.78891647, 'binary_precision': 0.07662835, 'binary_recall': 0.3712297, 'binary_specificity': 0.88449556, 'binary_f1_score': 0.12703453}
confusion matrix:
       0     1
0  14764  1928
1    271   160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79843426, 'precision': 0.56690055, 'recall': 0.6537322, 'specificity': 0.6537322, 'f1': 0.57392645, 'auroc': 0.7731081, 'binary_precision': 0.1821802, 'binary_recall': 0.48348746, 'binary_specificity': 0.8239769, 'binary_f1_score': 0.2646421}
confusion matrix:
      0     1
0  7691  1643
1   391   366
early stop counter: 2
val acc:0.8715762495994568, best validation acc: 0.8721018433570862, corresponding to test acc:                         0.8092359304428101 / 0.8092359304428101
after epoch: 3,now: 2024-08-06 09:07:10.840436,epoch time: 0:15:20.665452,used: 0:48:48.671579,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8501731, 'precision': 0.8501731, 'recall': 0.8501733, 'specificity': 0.8501733, 'f1': 0.8501731, 'auroc': 0.92547417, 'binary_precision': 0.85053897, 'binary_recall': 0.8499371, 'binary_specificity': 0.8504095, 'binary_f1_score': 0.8502379}
confusion matrix:
       0      1
0  21597   3799
1   3817  21619
---- Validation: 
scalar performance:
{'acc': 0.8874029, 'precision': 0.5394961, 'recall': 0.6551926, 'specificity': 0.6551926, 'f1': 0.54740465, 'auroc': 0.80214655, 'binary_precision': 0.095623985, 'binary_recall': 0.41067284, 'binary_specificity': 0.89971244, 'binary_f1_score': 0.15512708}
confusion matrix:
       0     1
0  15018  1674
1    254   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81696564, 'precision': 0.59411705, 'recall': 0.7147318, 'specificity': 0.7147318, 'f1': 0.6108469, 'auroc': 0.8153547, 'binary_precision': 0.22613065, 'binary_recall': 0.5944518, 'binary_specificity': 0.8350118, 'binary_f1_score': 0.32763013}
confusion matrix:
      0     1
0  7794  1540
1   307   450
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 09:22:50.262455,epoch time: 0:15:39.422019,used: 1:04:28.093598,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86783916, 'precision': 0.8684296, 'recall': 0.86785495, 'specificity': 0.86785495, 'f1': 0.8677896, 'auroc': 0.9415766, 'binary_precision': 0.883377, 'binary_recall': 0.84781414, 'binary_specificity': 0.8878957, 'binary_f1_score': 0.86523026}
confusion matrix:
       0      1
0  22549   2847
1   3871  21565
---- Validation: 
scalar performance:
{'acc': 0.90422237, 'precision': 0.54790163, 'recall': 0.6615592, 'specificity': 0.6615592, 'f1': 0.56251806, 'auroc': 0.8098222, 'binary_precision': 0.112251446, 'binary_recall': 0.40603247, 'binary_specificity': 0.917086, 'binary_f1_score': 0.1758794}
confusion matrix:
       0     1
0  15308  1384
1    256   175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389654, 'precision': 0.6132189, 'recall': 0.7405833, 'specificity': 0.7405833, 'f1': 0.6378392, 'auroc': 0.83920145, 'binary_precision': 0.26074973, 'binary_recall': 0.6248349, 'binary_specificity': 0.8563317, 'binary_f1_score': 0.36795023}
confusion matrix:
      0     1
0  7993  1341
1   284   473
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 09:38:26.133033,epoch time: 0:15:35.870578,used: 1:20:03.964176,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88306576, 'precision': 0.88366556, 'recall': 0.8830814, 'specificity': 0.8830814, 'f1': 0.883023, 'auroc': 0.9525627, 'binary_precision': 0.8990337, 'binary_recall': 0.8632647, 'binary_specificity': 0.9028981, 'binary_f1_score': 0.8807862}
confusion matrix:
       0      1
0  22930   2466
1   3478  21958
---- Validation: 
scalar performance:
{'acc': 0.9043976, 'precision': 0.5540253, 'recall': 0.6865122, 'specificity': 0.6865122, 'f1': 0.5715891, 'auroc': 0.81938064, 'binary_precision': 0.123125, 'binary_recall': 0.45707658, 'binary_specificity': 0.91594774, 'binary_f1_score': 0.19399312}
confusion matrix:
       0     1
0  15289  1403
1    234   197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8467942, 'precision': 0.62551695, 'recall': 0.7654509, 'specificity': 0.7654509, 'f1': 0.65418124, 'auroc': 0.85774875, 'binary_precision': 0.281198, 'binary_recall': 0.669749, 'binary_specificity': 0.86115277, 'binary_f1_score': 0.39609373}
confusion matrix:
      0     1
0  8038  1296
1   250   507
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-06 09:53:41.423363,epoch time: 0:15:15.290330,used: 1:35:19.254506,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8945546, 'precision': 0.8950707, 'recall': 0.8945689, 'specificity': 0.8945689, 'f1': 0.89452255, 'auroc': 0.95893633, 'binary_precision': 0.90954715, 'binary_recall': 0.876435, 'binary_specificity': 0.9127028, 'binary_f1_score': 0.89268416}
confusion matrix:
       0      1
0  23179   2217
1   3143  22293
---- Validation: 
scalar performance:
{'acc': 0.9049232, 'precision': 0.5588453, 'recall': 0.7059941, 'specificity': 0.7059941, 'f1': 0.57879823, 'auroc': 0.82523143, 'binary_precision': 0.1316923, 'binary_recall': 0.4965197, 'binary_specificity': 0.9154685, 'binary_f1_score': 0.20817119}
confusion matrix:
       0     1
0  15281  1411
1    217   214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85402834, 'precision': 0.6359019, 'recall': 0.7845347, 'specificity': 0.7845347, 'f1': 0.6679566, 'auroc': 0.8691188, 'binary_precision': 0.2988764, 'binary_recall': 0.7027741, 'binary_specificity': 0.8662953, 'binary_f1_score': 0.41939294}
confusion matrix:
      0     1
0  8086  1248
1   225   532
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-06 10:08:54.964901,epoch time: 0:15:13.541538,used: 1:50:32.796044,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9008302, 'precision': 0.9018389, 'recall': 0.90084994, 'specificity': 0.90084994, 'f1': 0.900771, 'auroc': 0.9632255, 'binary_precision': 0.9221693, 'binary_recall': 0.8757273, 'binary_specificity': 0.9259726, 'binary_f1_score': 0.89834845}
confusion matrix:
       0      1
0  23516   1880
1   3161  22275
---- Validation: 
scalar performance:
{'acc': 0.9109385, 'precision': 0.5625429, 'recall': 0.705689, 'specificity': 0.705689, 'f1': 0.58476436, 'auroc': 0.8309468, 'binary_precision': 0.13918206, 'binary_recall': 0.48955917, 'binary_specificity': 0.92181885, 'binary_f1_score': 0.21674371}
confusion matrix:
       0     1
0  15387  1305
1    220   211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86423546, 'precision': 0.6447493, 'recall': 0.7882314, 'specificity': 0.7882314, 'f1': 0.67929196, 'auroc': 0.87681234, 'binary_precision': 0.3165769, 'binary_recall': 0.6988111, 'binary_specificity': 0.8776516, 'binary_f1_score': 0.4357496}
confusion matrix:
      0     1
0  8192  1142
1   228   529
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-06 10:24:22.340862,epoch time: 0:15:27.375961,used: 2:06:00.172005,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90732217, 'precision': 0.90814847, 'recall': 0.90733904, 'specificity': 0.90733904, 'f1': 0.9072777, 'auroc': 0.9669019, 'binary_precision': 0.9267007, 'binary_recall': 0.8847651, 'binary_specificity': 0.929913, 'binary_f1_score': 0.9052475}
confusion matrix:
       0      1
0  23617   1780
1   2931  22504
---- Validation: 
scalar performance:
{'acc': 0.90270394, 'precision': 0.5620697, 'recall': 0.7263285, 'specificity': 0.7263285, 'f1': 0.5833482, 'auroc': 0.8371533, 'binary_precision': 0.13697825, 'binary_recall': 0.5406032, 'binary_specificity': 0.9120537, 'binary_f1_score': 0.21857412}
confusion matrix:
       0     1
0  15224  1468
1    198   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8676048, 'precision': 0.65322244, 'recall': 0.8094745, 'specificity': 0.8094745, 'f1': 0.6905453, 'auroc': 0.8837006, 'binary_precision': 0.329806, 'binary_recall': 0.7410832, 'binary_specificity': 0.87786585, 'binary_f1_score': 0.45646867}
confusion matrix:
      0     1
0  8194  1140
1   196   561
new oracle model saved
early stop counter: 1
val acc:0.9027039408683777, best validation acc: 0.9109385013580322, corresponding to test acc:                         0.8642354607582092 / 0.8676047921180725
after epoch: 9,now: 2024-08-06 10:39:37.922903,epoch time: 0:15:15.582041,used: 2:21:15.754046,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9124764, 'precision': 0.9139472, 'recall': 0.9124999, 'specificity': 0.9124999, 'f1': 0.9124019, 'auroc': 0.96977663, 'binary_precision': 0.9388199, 'binary_recall': 0.88260734, 'binary_specificity': 0.9423925, 'binary_f1_score': 0.90984625}
confusion matrix:
       0      1
0  23933   1463
1   2986  22450
---- Validation: 
scalar performance:
{'acc': 0.91333294, 'precision': 0.5687834, 'recall': 0.7249993, 'specificity': 0.7249993, 'f1': 0.5941646, 'auroc': 0.84006953, 'binary_precision': 0.15063038, 'binary_recall': 0.52668214, 'binary_specificity': 0.92331654, 'binary_f1_score': 0.23426212}
confusion matrix:
       0     1
0  15412  1280
1    204   227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87711823, 'precision': 0.66216314, 'recall': 0.81036854, 'specificity': 0.81036854, 'f1': 0.70118046, 'auroc': 0.88760567, 'binary_precision': 0.34820867, 'binary_recall': 0.7318362, 'binary_specificity': 0.8889008, 'binary_f1_score': 0.47189096}
confusion matrix:
      0     1
0  8297  1037
1   203   554
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-06 10:54:58.785078,epoch time: 0:15:20.862175,used: 2:36:36.616221,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91694206, 'precision': 0.91841483, 'recall': 0.9169655, 'specificity': 0.9169655, 'f1': 0.916872, 'auroc': 0.973109, 'binary_precision': 0.94343644, 'binary_recall': 0.8872071, 'binary_specificity': 0.9467239, 'binary_f1_score': 0.9144582}
confusion matrix:
       0      1
0  24043   1353
1   2869  22567
---- Validation: 
scalar performance:
{'acc': 0.9110553, 'precision': 0.5681584, 'recall': 0.7294818, 'specificity': 0.7294818, 'f1': 0.5931531, 'auroc': 0.8436943, 'binary_precision': 0.14910026, 'binary_recall': 0.53828305, 'binary_specificity': 0.9206806, 'binary_f1_score': 0.23351786}
confusion matrix:
       0     1
0  15368  1324
1    199   232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87989295, 'precision': 0.66635895, 'recall': 0.8161169, 'specificity': 0.8161169, 'f1': 0.70640653, 'auroc': 0.8909838, 'binary_precision': 0.35573876, 'binary_recall': 0.7410832, 'binary_specificity': 0.89115065, 'binary_f1_score': 0.4807198}
confusion matrix:
      0     1
0  8318  1016
1   196   561
new oracle model saved
early stop counter: 1
val acc:0.911055326461792, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8798929452896118
after epoch: 11,now: 2024-08-06 11:10:21.436029,epoch time: 0:15:22.650951,used: 2:51:59.267172,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91977495, 'precision': 0.92110693, 'recall': 0.91979825, 'specificity': 0.91979825, 'f1': 0.9197144, 'auroc': 0.9733914, 'binary_precision': 0.9449977, 'binary_recall': 0.8915753, 'binary_specificity': 0.9480213, 'binary_f1_score': 0.91750956}
confusion matrix:
       0      1
0  24075   1320
1   2758  22679
---- Validation: 
scalar performance:
{'acc': 0.9066752, 'precision': 0.566442, 'recall': 0.73514616, 'specificity': 0.73514616, 'f1': 0.5902884, 'auroc': 0.84610415, 'binary_precision': 0.14528875, 'binary_recall': 0.55452436, 'binary_specificity': 0.915768, 'binary_f1_score': 0.23025048}
confusion matrix:
       0     1
0  15286  1406
1    192   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8791002, 'precision': 0.6661889, 'recall': 0.8187231, 'specificity': 0.8187231, 'f1': 0.70643425, 'auroc': 0.89316034, 'binary_precision': 0.35485893, 'binary_recall': 0.74768823, 'binary_specificity': 0.8897579, 'binary_f1_score': 0.48129252}
confusion matrix:
      0     1
0  8305  1029
1   191   566
early stop counter: 2
val acc:0.9066752195358276, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8798929452896118
after epoch: 12,now: 2024-08-06 11:25:38.019459,epoch time: 0:15:16.583430,used: 3:07:15.850602,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9226472, 'precision': 0.9236696, 'recall': 0.92266464, 'specificity': 0.92266464, 'f1': 0.92260253, 'auroc': 0.9756857, 'binary_precision': 0.9446604, 'binary_recall': 0.89801055, 'binary_specificity': 0.9473187, 'binary_f1_score': 0.92074496}
confusion matrix:
       0      1
0  24060   1338
1   2594  22840
---- Validation: 
scalar performance:
{'acc': 0.8997839, 'precision': 0.56436086, 'recall': 0.7451732, 'specificity': 0.7451732, 'f1': 0.58637595, 'auroc': 0.84846556, 'binary_precision': 0.14045887, 'binary_recall': 0.5823666, 'binary_specificity': 0.90797985, 'binary_f1_score': 0.22633003}
confusion matrix:
       0     1
0  15156  1536
1    180   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8772173, 'precision': 0.6645206, 'recall': 0.8195261, 'specificity': 0.8195261, 'f1': 0.70458376, 'auroc': 0.8953444, 'binary_precision': 0.35123456, 'binary_recall': 0.7516512, 'binary_specificity': 0.8874009, 'binary_f1_score': 0.47875476}
confusion matrix:
      0     1
0  8283  1051
1   188   569
early stop counter: 3
val acc:0.8997839093208313, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8798929452896118
after epoch: 13,now: 2024-08-06 11:43:07.235956,epoch time: 0:17:29.216497,used: 3:24:45.067099,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92677844, 'precision': 0.9283916, 'recall': 0.92680264, 'specificity': 0.92680264, 'f1': 0.92671216, 'auroc': 0.9775505, 'binary_precision': 0.95487684, 'binary_recall': 0.8960135, 'binary_specificity': 0.9575918, 'binary_f1_score': 0.9245091}
confusion matrix:
       0      1
0  24319   1077
1   2645  22791
---- Validation: 
scalar performance:
{'acc': 0.90568244, 'precision': 0.5671582, 'recall': 0.7414178, 'specificity': 0.7414178, 'f1': 0.59126586, 'auroc': 0.848768, 'binary_precision': 0.14635603, 'binary_recall': 0.5684455, 'binary_specificity': 0.91439015, 'binary_f1_score': 0.23277909}
confusion matrix:
       0     1
0  15263  1429
1    186   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8826677, 'precision': 0.6704772, 'recall': 0.8212584, 'specificity': 0.8212584, 'f1': 0.7114682, 'auroc': 0.89651537, 'binary_precision': 0.3632287, 'binary_recall': 0.74900925, 'binary_specificity': 0.8935076, 'binary_f1_score': 0.4892149}
confusion matrix:
      0    1
0  8340  994
1   190  567
new oracle model saved
early stop counter: 4
val acc:0.9056824445724487, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8826677203178406
after epoch: 14,now: 2024-08-06 11:58:52.916419,epoch time: 0:15:45.680463,used: 3:40:30.747562,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9303195, 'precision': 0.93132496, 'recall': 0.9303395, 'specificity': 0.9303395, 'f1': 0.93028104, 'auroc': 0.9782442, 'binary_precision': 0.95235735, 'binary_recall': 0.9060817, 'binary_specificity': 0.95459735, 'binary_f1_score': 0.9286434}
confusion matrix:
       0      1
0  24242   1153
1   2389  23048
---- Validation: 
scalar performance:
{'acc': 0.89131576, 'precision': 0.5614714, 'recall': 0.7532613, 'specificity': 0.7532613, 'f1': 0.5806483, 'auroc': 0.8516387, 'binary_precision': 0.13408393, 'binary_recall': 0.60788864, 'binary_specificity': 0.8986341, 'binary_f1_score': 0.21970649}
confusion matrix:
       0     1
0  15000  1692
1    169   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8765236, 'precision': 0.66538084, 'recall': 0.82582736, 'specificity': 0.82582736, 'f1': 0.7060167, 'auroc': 0.8981023, 'binary_precision': 0.35172832, 'binary_recall': 0.7661823, 'binary_specificity': 0.8854725, 'binary_f1_score': 0.482128}
confusion matrix:
      0     1
0  8265  1069
1   177   580
early stop counter: 5
val acc:0.891315758228302, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8826677203178406
after epoch: 15,now: 2024-08-06 12:14:02.108381,epoch time: 0:15:09.191962,used: 3:55:39.939524,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92925715, 'precision': 0.93043005, 'recall': 0.92927986, 'specificity': 0.92927986, 'f1': 0.92921144, 'auroc': 0.97896075, 'binary_precision': 0.95311594, 'binary_recall': 0.9030584, 'binary_specificity': 0.9555013, 'binary_f1_score': 0.9274122}
confusion matrix:
       0      1
0  24264   1130
1   2466  22972
---- Validation: 
scalar performance:
{'acc': 0.89423585, 'precision': 0.5628045, 'recall': 0.75249875, 'specificity': 0.75249875, 'f1': 0.58316785, 'auroc': 0.8518466, 'binary_precision': 0.1368421, 'binary_recall': 0.60324824, 'binary_specificity': 0.9017493, 'binary_f1_score': 0.22308022}
confusion matrix:
       0     1
0  15052  1640
1    171   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87919927, 'precision': 0.667472, 'recall': 0.8236321, 'specificity': 0.8236321, 'f1': 0.7082883, 'auroc': 0.8985149, 'binary_precision': 0.35652173, 'binary_recall': 0.75825626, 'binary_specificity': 0.8890079, 'binary_f1_score': 0.4850021}
confusion matrix:
      0     1
0  8298  1036
1   183   574
early stop counter: 6
val acc:0.8942358493804932, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8826677203178406
after epoch: 16,now: 2024-08-06 12:29:15.904919,epoch time: 0:15:13.796538,used: 4:10:53.736062,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9314015, 'precision': 0.93257475, 'recall': 0.93142414, 'specificity': 0.93142414, 'f1': 0.9313574, 'auroc': 0.9796555, 'binary_precision': 0.9553205, 'binary_recall': 0.90525985, 'binary_specificity': 0.95758843, 'binary_f1_score': 0.9296167}
confusion matrix:
       0      1
0  24317   1077
1   2410  23028
---- Validation: 
scalar performance:
{'acc': 0.89703906, 'precision': 0.56436914, 'recall': 0.7528065, 'specificity': 0.7528065, 'f1': 0.5859697, 'auroc': 0.85380185, 'binary_precision': 0.14, 'binary_recall': 0.60092807, 'binary_specificity': 0.9046849, 'binary_f1_score': 0.22709338}
confusion matrix:
       0     1
0  15101  1591
1    172   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88207316, 'precision': 0.6709214, 'recall': 0.8257925, 'specificity': 0.8257925, 'f1': 0.7123782, 'auroc': 0.8990092, 'binary_precision': 0.36323437, 'binary_recall': 0.7595773, 'binary_specificity': 0.8920077, 'binary_f1_score': 0.49145296}
confusion matrix:
      0     1
0  8326  1008
1   182   575
early stop counter: 7
val acc:0.8970390558242798, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8826677203178406
after epoch: 17,now: 2024-08-06 12:44:32.498620,epoch time: 0:15:16.593701,used: 4:26:10.329763,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93209004, 'precision': 0.93339497, 'recall': 0.9321139, 'specificity': 0.9321139, 'f1': 0.9320414, 'auroc': 0.9802624, 'binary_precision': 0.9573937, 'binary_recall': 0.9045522, 'binary_specificity': 0.9596755, 'binary_f1_score': 0.9302232}
confusion matrix:
       0      1
0  24370   1024
1   2428  23010
---- Validation: 
scalar performance:
{'acc': 0.89622146, 'precision': 0.5649618, 'recall': 0.7580378, 'specificity': 0.7580378, 'f1': 0.5867167, 'auroc': 0.8566787, 'binary_precision': 0.14087513, 'binary_recall': 0.612529, 'binary_specificity': 0.90354663, 'binary_f1_score': 0.22906722}
confusion matrix:
       0     1
0  15082  1610
1    167   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8826677, 'precision': 0.6724689, 'recall': 0.82975554, 'specificity': 0.82975554, 'f1': 0.7144643, 'auroc': 0.8997823, 'binary_precision': 0.36563876, 'binary_recall': 0.7675033, 'binary_specificity': 0.8920077, 'binary_f1_score': 0.49531117}
confusion matrix:
      0     1
0  8326  1008
1   176   581
early stop counter: 8
val acc:0.8962214589118958, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8826677203178406
after epoch: 18,now: 2024-08-06 12:59:46.242243,epoch time: 0:15:13.743623,used: 4:41:24.073386,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93474585, 'precision': 0.93577635, 'recall': 0.93476605, 'specificity': 0.93476605, 'f1': 0.9347092, 'auroc': 0.9807323, 'binary_precision': 0.9571759, 'binary_recall': 0.9103275, 'binary_specificity': 0.95920455, 'binary_f1_score': 0.93316406}
confusion matrix:
       0      1
0  24359   1036
1   2281  23156
---- Validation: 
scalar performance:
{'acc': 0.89709747, 'precision': 0.5657599, 'recall': 0.75961727, 'specificity': 0.75961727, 'f1': 0.58804864, 'auroc': 0.85851884, 'binary_precision': 0.14239655, 'binary_recall': 0.6148492, 'binary_specificity': 0.9043853, 'binary_f1_score': 0.23123907}
confusion matrix:
       0     1
0  15096  1596
1    166   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8821722, 'precision': 0.6718893, 'recall': 0.8294877, 'specificity': 0.8294877, 'f1': 0.7137881, 'auroc': 0.8999798, 'binary_precision': 0.36449185, 'binary_recall': 0.7675033, 'binary_specificity': 0.89147204, 'binary_f1_score': 0.49425778}
confusion matrix:
      0     1
0  8321  1013
1   176   581
early stop counter: 9
val acc:0.8970974683761597, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8826677203178406
after epoch: 19,now: 2024-08-06 13:14:56.321796,epoch time: 0:15:10.079553,used: 4:56:34.152939,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.935277, 'precision': 0.93685055, 'recall': 0.9353007, 'specificity': 0.9353007, 'f1': 0.9352211, 'auroc': 0.9827546, 'binary_precision': 0.9632667, 'binary_recall': 0.9051738, 'binary_specificity': 0.96542764, 'binary_f1_score': 0.9333172}
confusion matrix:
       0      1
0  24518    878
1   2412  23024
---- Validation: 
scalar performance:
{'acc': 0.9043976, 'precision': 0.5695312, 'recall': 0.7565807, 'specificity': 0.7565807, 'f1': 0.59468, 'auroc': 0.8600235, 'binary_precision': 0.15023202, 'binary_recall': 0.60092807, 'binary_specificity': 0.9122334, 'binary_f1_score': 0.24037121}
confusion matrix:
       0     1
0  15227  1465
1    172   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88653255, 'precision': 0.6761535, 'recall': 0.82759607, 'specificity': 0.82759607, 'f1': 0.7183242, 'auroc': 0.9003061, 'binary_precision': 0.3736979, 'binary_recall': 0.75825626, 'binary_specificity': 0.89693594, 'binary_f1_score': 0.50065416}
confusion matrix:
      0    1
0  8372  962
1   183  574
new oracle model saved
early stop counter: 10
val acc:0.9043976068496704, best validation acc: 0.9133329391479492, corresponding to test acc:                         0.8771182298660278 / 0.8865325450897217
after epoch: 20,now: 2024-08-06 13:30:07.936794,epoch time: 0:15:11.614998,used: 5:11:45.767937,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_18_21_seed_1_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:11:45.767937 at 2024-08-06 13:30:07.936794
persisted model performance metric: 

scalar performance:
{'acc': 0.87711823, 'precision': 0.66216314, 'recall': 0.81036854, 'specificity': 0.81036854, 'f1': 0.70118046, 'auroc': 0.88760567, 'binary_precision': 0.34820867, 'binary_recall': 0.7318362, 'binary_specificity': 0.8889008, 'binary_f1_score': 0.47189096}
confusion matrix:
      0     1
0  8297  1037
1   203   554
oracle model performance metric: 

scalar performance:
{'acc': 0.88653255, 'precision': 0.6761535, 'recall': 0.82759607, 'specificity': 0.82759607, 'f1': 0.7183242, 'auroc': 0.9003061, 'binary_precision': 0.3736979, 'binary_recall': 0.75825626, 'binary_specificity': 0.89693594, 'binary_f1_score': 0.50065416}
confusion matrix:
      0    1
0  8372  962
1   183  574
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |  16648 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    780 MiB | 272384 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     48 MiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  89169 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 384172 GiB | 384172 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6837    |  162968 K  |  162963 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92884 K  |   92880 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6837    |  162968 K  |  162963 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92884 K  |   92880 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      57    |      16    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      24    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3196    |   87550 K  |   87550 K  |
|       from large pool |      10    |      23    |   44070 K  |   44070 K  |
|       from small pool |      20    |    3186    |   43479 K  |   43479 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 399287 GiB | 399287 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384172 GiB | 384172 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162968 K  |  162968 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162968 K  |  162968 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87552 K  |   87552 K  |
|       from large pool |       3    |      23    |   44070 K  |   44070 K  |
|       from small pool |       0    |    3186    |   43481 K  |   43481 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 399287 GiB | 399287 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384172 GiB | 384172 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162968 K  |  162968 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162968 K  |  162968 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87552 K  |   87552 K  |
|       from large pool |       3    |      23    |   44070 K  |   44070 K  |
|       from small pool |       0    |    3186    |   43481 K  |   43481 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670

 Experiment start at: 2024-08-06 13:55:20.454976
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.73562753, 'precision': 0.7361512, 'recall': 0.7356303, 'specificity': 0.7356303, 'f1': 0.7354824, 'auroc': 0.8105302, 'binary_precision': 0.7473005, 'binary_recall': 0.71211946, 'binary_specificity': 0.759141, 'binary_f1_score': 0.72928596}
confusion matrix:
       0      1
0  19620   6225
1   7442  18409
---- Validation: 
scalar performance:
{'acc': 0.55594486, 'precision': 0.5138385, 'recall': 0.64413035, 'specificity': 0.64413035, 'f1': 0.39139616, 'auroc': 0.68464255, 'binary_precision': 0.039477058, 'binary_recall': 0.7368421, 'binary_specificity': 0.55141866, 'binary_f1_score': 0.07493918}
confusion matrix:
      0     1
0  9212  7494
1   110   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5258621, 'precision': 0.5560147, 'recall': 0.6915567, 'specificity': 0.6915567, 'f1': 0.44307452, 'auroc': 0.7958853, 'binary_precision': 0.13101406, 'binary_recall': 0.88833123, 'binary_specificity': 0.49478215, 'binary_f1_score': 0.22835028}
confusion matrix:
      0     1
0  4599  4696
1    89   708
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 14:14:45.727477,epoch time: 0:19:25.272501,used: 0:19:25.272501,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8213788, 'precision': 0.82233405, 'recall': 0.82138306, 'specificity': 0.82138306, 'f1': 0.8212477, 'auroc': 0.89976084, 'binary_precision': 0.8399198, 'binary_recall': 0.79417455, 'binary_specificity': 0.84859157, 'binary_f1_score': 0.81640685}
confusion matrix:
       0      1
0  21931   3913
1   5321  20531
---- Validation: 
scalar performance:
{'acc': 0.6634548, 'precision': 0.51971465, 'recall': 0.6875679, 'specificity': 0.6875679, 'f1': 0.4435424, 'auroc': 0.73640966, 'binary_precision': 0.050159905, 'binary_recall': 0.71291864, 'binary_specificity': 0.66221714, 'binary_f1_score': 0.09372542}
confusion matrix:
       0     1
0  11063  5643
1    120   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59750295, 'precision': 0.56592613, 'recall': 0.7252865, 'specificity': 0.7252865, 'f1': 0.49008393, 'auroc': 0.8152939, 'binary_precision': 0.14990349, 'binary_recall': 0.8770389, 'binary_specificity': 0.57353413, 'binary_f1_score': 0.25604394}
confusion matrix:
      0     1
0  5331  3964
1    98   699
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 14:32:25.324639,epoch time: 0:17:39.597162,used: 0:37:04.869663,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8555594, 'precision': 0.8560158, 'recall': 0.8555629, 'specificity': 0.8555629, 'f1': 0.85551393, 'auroc': 0.9297465, 'binary_precision': 0.86881167, 'binary_recall': 0.83765906, 'binary_specificity': 0.87346673, 'binary_f1_score': 0.852951}
confusion matrix:
       0      1
0  22573   3270
1   4197  21656
---- Validation: 
scalar performance:
{'acc': 0.72675776, 'precision': 0.52448034, 'recall': 0.70834893, 'specificity': 0.70834893, 'f1': 0.47411305, 'auroc': 0.7638668, 'binary_precision': 0.05954104, 'binary_recall': 0.68899524, 'binary_specificity': 0.7277026, 'binary_f1_score': 0.109609894}
confusion matrix:
       0     1
0  12157  4549
1    130   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64635354, 'precision': 0.5737626, 'recall': 0.745497, 'specificity': 0.745497, 'f1': 0.5220296, 'auroc': 0.8280008, 'binary_precision': 0.16586307, 'binary_recall': 0.86323714, 'binary_specificity': 0.62775683, 'binary_f1_score': 0.2782609}
confusion matrix:
      0     1
0  5835  3460
1   109   688
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 14:50:01.731978,epoch time: 0:17:36.407339,used: 0:54:41.277002,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8696224, 'precision': 0.86988986, 'recall': 0.86962396, 'specificity': 0.86962396, 'f1': 0.8695992, 'auroc': 0.94318855, 'binary_precision': 0.8798648, 'binary_recall': 0.8561758, 'binary_specificity': 0.88307214, 'binary_f1_score': 0.8678587}
confusion matrix:
       0      1
0  22823   3022
1   3718  22133
---- Validation: 
scalar performance:
{'acc': 0.7519855, 'precision': 0.52744246, 'recall': 0.7201122, 'specificity': 0.7201122, 'f1': 0.48736957, 'auroc': 0.78290147, 'binary_precision': 0.06518283, 'binary_recall': 0.6866029, 'binary_specificity': 0.75362146, 'binary_f1_score': 0.11906243}
confusion matrix:
       0     1
0  12590  4116
1    131   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67172015, 'precision': 0.57911336, 'recall': 0.75754714, 'specificity': 0.75754714, 'f1': 0.53940976, 'auroc': 0.8379886, 'binary_precision': 0.17627381, 'binary_recall': 0.85947305, 'binary_specificity': 0.6556213, 'binary_f1_score': 0.29254755}
confusion matrix:
      0     1
0  6094  3201
1   112   685
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 15:09:02.117754,epoch time: 0:19:00.385776,used: 1:13:41.662778,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8830857, 'precision': 0.883361, 'recall': 0.88308775, 'specificity': 0.88308775, 'f1': 0.8830651, 'auroc': 0.95241725, 'binary_precision': 0.893672, 'binary_recall': 0.86968124, 'binary_specificity': 0.8964943, 'binary_f1_score': 0.8815134}
confusion matrix:
       0      1
0  23169   2675
1   3369  22483
---- Validation: 
scalar performance:
{'acc': 0.7741766, 'precision': 0.5299493, 'recall': 0.7256541, 'specificity': 0.7256541, 'f1': 0.498797, 'auroc': 0.7993218, 'binary_precision': 0.07027162, 'binary_recall': 0.67464113, 'binary_specificity': 0.77666706, 'binary_f1_score': 0.12728503}
confusion matrix:
       0     1
0  12975  3731
1    136   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70233846, 'precision': 0.5857098, 'recall': 0.76900697, 'specificity': 0.76900697, 'f1': 0.5602931, 'auroc': 0.84769285, 'binary_precision': 0.18994099, 'binary_recall': 0.84818065, 'binary_specificity': 0.6898332, 'binary_f1_score': 0.31037647}
confusion matrix:
      0     1
0  6412  2883
1   121   676
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 15:26:59.886708,epoch time: 0:17:57.768954,used: 1:31:39.431732,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8914423, 'precision': 0.8925133, 'recall': 0.8914473, 'specificity': 0.8914473, 'f1': 0.8913691, 'auroc': 0.95700216, 'binary_precision': 0.9130648, 'binary_recall': 0.86531544, 'binary_specificity': 0.91757923, 'binary_f1_score': 0.88854915}
confusion matrix:
       0      1
0  23713   2130
1   3482  22371
---- Validation: 
scalar performance:
{'acc': 0.81628126, 'precision': 0.53580594, 'recall': 0.732072, 'specificity': 0.732072, 'f1': 0.5215527, 'auroc': 0.80739, 'binary_precision': 0.08236375, 'binary_recall': 0.6435407, 'binary_specificity': 0.8206034, 'binary_f1_score': 0.14603692}
confusion matrix:
       0     1
0  13709  2997
1    149   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7452437, 'precision': 0.5946032, 'recall': 0.77509224, 'specificity': 0.77509224, 'f1': 0.58846396, 'auroc': 0.8535725, 'binary_precision': 0.21069798, 'binary_recall': 0.81053954, 'binary_specificity': 0.73964494, 'binary_f1_score': 0.3344551}
confusion matrix:
      0     1
0  6875  2420
1   151   646
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-06 15:44:16.645086,epoch time: 0:17:16.758378,used: 1:48:56.190110,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89890903, 'precision': 0.8996277, 'recall': 0.89891315, 'specificity': 0.89891315, 'f1': 0.89886415, 'auroc': 0.96161807, 'binary_precision': 0.9166229, 'binary_recall': 0.8776931, 'binary_specificity': 0.9201331, 'binary_f1_score': 0.8967356}
confusion matrix:
       0      1
0  23779   2064
1   3162  22691
---- Validation: 
scalar performance:
{'acc': 0.8220626, 'precision': 0.5374633, 'recall': 0.7373675, 'specificity': 0.7373675, 'f1': 0.52581674, 'auroc': 0.81549, 'binary_precision': 0.085462, 'binary_recall': 0.6483254, 'binary_specificity': 0.8264097, 'binary_f1_score': 0.151017}
confusion matrix:
       0     1
0  13806  2900
1    147   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75832343, 'precision': 0.5992162, 'recall': 0.78104573, 'specificity': 0.78104573, 'f1': 0.5986909, 'auroc': 0.85842013, 'binary_precision': 0.21979523, 'binary_recall': 0.8080301, 'binary_specificity': 0.75406134, 'binary_f1_score': 0.34558627}
confusion matrix:
      0     1
0  7009  2286
1   153   644
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-06 16:00:10.389758,epoch time: 0:15:53.744672,used: 2:04:49.934782,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90449935, 'precision': 0.90545595, 'recall': 0.9045031, 'specificity': 0.9045031, 'f1': 0.9044436, 'auroc': 0.96569204, 'binary_precision': 0.92518806, 'binary_recall': 0.8802027, 'binary_specificity': 0.92880356, 'binary_f1_score': 0.9021349}
confusion matrix:
       0      1
0  24004   1840
1   3097  22755
---- Validation: 
scalar performance:
{'acc': 0.83502686, 'precision': 0.5405896, 'recall': 0.7428456, 'specificity': 0.7428456, 'f1': 0.5345006, 'auroc': 0.8230083, 'binary_precision': 0.0916186, 'binary_recall': 0.64593303, 'binary_specificity': 0.83975816, 'binary_f1_score': 0.16047548}
confusion matrix:
       0     1
0  14029  2677
1    148   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78002375, 'precision': 0.60808724, 'recall': 0.79167914, 'specificity': 0.79167914, 'f1': 0.61667246, 'auroc': 0.86348724, 'binary_precision': 0.23716292, 'binary_recall': 0.8055207, 'binary_specificity': 0.7778376, 'binary_f1_score': 0.36643836}
confusion matrix:
      0     1
0  7230  2065
1   155   642
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-06 16:15:50.867492,epoch time: 0:15:40.477734,used: 2:20:30.412516,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90943205, 'precision': 0.91089904, 'recall': 0.9094367, 'specificity': 0.9094367, 'f1': 0.9093518, 'auroc': 0.968192, 'binary_precision': 0.9354892, 'binary_recall': 0.8795451, 'binary_specificity': 0.93932825, 'binary_f1_score': 0.90665495}
confusion matrix:
       0      1
0  24276   1568
1   3114  22738
---- Validation: 
scalar performance:
{'acc': 0.84220976, 'precision': 0.5426297, 'recall': 0.74652696, 'specificity': 0.74652696, 'f1': 0.5397097, 'auroc': 0.8287267, 'binary_precision': 0.09560907, 'binary_recall': 0.64593303, 'binary_specificity': 0.8471208, 'binary_f1_score': 0.16656385}
confusion matrix:
       0     1
0  14152  2554
1    148   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7925089, 'precision': 0.6124346, 'recall': 0.7927214, 'specificity': 0.7927214, 'f1': 0.62598217, 'auroc': 0.86689544, 'binary_precision': 0.2467786, 'binary_recall': 0.79297364, 'binary_specificity': 0.7924691, 'binary_f1_score': 0.37641454}
confusion matrix:
      0     1
0  7366  1929
1   165   632
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-06 16:31:48.205204,epoch time: 0:15:57.337712,used: 2:36:27.750228,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9143261, 'precision': 0.9149791, 'recall': 0.9143291, 'specificity': 0.9143291, 'f1': 0.9142927, 'auroc': 0.9712491, 'binary_precision': 0.93148035, 'binary_recall': 0.89447623, 'binary_specificity': 0.934182, 'binary_f1_score': 0.9126033}
confusion matrix:
       0      1
0  24143   1701
1   2728  23124
---- Validation: 
scalar performance:
{'acc': 0.82988787, 'precision': 0.5409221, 'recall': 0.7518742, 'specificity': 0.7518742, 'f1': 0.53329456, 'auroc': 0.83447516, 'binary_precision': 0.09165303, 'binary_recall': 0.6698565, 'binary_specificity': 0.833892, 'binary_f1_score': 0.16124387}
confusion matrix:
       0     1
0  13931  2775
1    138   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78765357, 'precision': 0.61263436, 'recall': 0.7992625, 'specificity': 0.7992625, 'f1': 0.62443763, 'auroc': 0.8721079, 'binary_precision': 0.24526873, 'binary_recall': 0.81304896, 'binary_specificity': 0.7854761, 'binary_f1_score': 0.37685376}
confusion matrix:
      0     1
0  7301  1994
1   149   648
early stop counter: 1
val acc:0.829887866973877, best validation acc: 0.8422097563743591, corresponding to test acc:                         0.7925089001655579 / 0.7925089001655579
after epoch: 10,now: 2024-08-06 16:47:33.424438,epoch time: 0:15:45.219234,used: 2:52:12.969462,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91715026, 'precision': 0.9193098, 'recall': 0.9171572, 'specificity': 0.9171572, 'f1': 0.91704434, 'auroc': 0.9723811, 'binary_precision': 0.9494499, 'binary_recall': 0.8812517, 'binary_specificity': 0.9530627, 'binary_f1_score': 0.9140805}
confusion matrix:
       0      1
0  24630   1213
1   3070  22783
---- Validation: 
scalar performance:
{'acc': 0.8686055, 'precision': 0.5493268, 'recall': 0.7448938, 'specificity': 0.7448938, 'f1': 0.5572488, 'auroc': 0.8364092, 'binary_precision': 0.10954817, 'binary_recall': 0.6148325, 'binary_specificity': 0.8749551, 'binary_f1_score': 0.18596238}
confusion matrix:
       0     1
0  14617  2089
1    161   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82282996, 'precision': 0.62640595, 'recall': 0.79771066, 'specificity': 0.79771066, 'f1': 0.6511257, 'auroc': 0.87215495, 'binary_precision': 0.27629796, 'binary_recall': 0.76787955, 'binary_specificity': 0.8275417, 'binary_f1_score': 0.40637448}
confusion matrix:
      0     1
0  7692  1603
1   185   612
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-06 17:04:02.246556,epoch time: 0:16:28.822118,used: 3:08:41.791580,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9200518, 'precision': 0.9210254, 'recall': 0.9200565, 'specificity': 0.9200565, 'f1': 0.9200062, 'auroc': 0.97414315, 'binary_precision': 0.9413199, 'binary_recall': 0.8959889, 'binary_specificity': 0.94412416, 'binary_f1_score': 0.9180952}
confusion matrix:
       0      1
0  24399   1444
1   2689  23164
---- Validation: 
scalar performance:
{'acc': 0.846648, 'precision': 0.5464831, 'recall': 0.76512897, 'specificity': 0.76512897, 'f1': 0.5466355, 'auroc': 0.8422183, 'binary_precision': 0.10230547, 'binary_recall': 0.67942584, 'binary_specificity': 0.85083205, 'binary_f1_score': 0.17783342}
confusion matrix:
       0     1
0  14214  2492
1    134   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8061831, 'precision': 0.6206235, 'recall': 0.80358607, 'specificity': 0.80358607, 'f1': 0.6397087, 'auroc': 0.87427866, 'binary_precision': 0.26201233, 'binary_recall': 0.8005019, 'binary_specificity': 0.80667025, 'binary_f1_score': 0.394802}
confusion matrix:
      0     1
0  7498  1797
1   159   638
early stop counter: 1
val acc:0.8466479778289795, best validation acc: 0.8686054944992065, corresponding to test acc:                         0.8228299617767334 / 0.8228299617767334
after epoch: 12,now: 2024-08-06 17:20:15.058047,epoch time: 0:16:12.811491,used: 3:24:54.603071,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92231506, 'precision': 0.9233946, 'recall': 0.922317, 'specificity': 0.922317, 'f1': 0.92226577, 'auroc': 0.9745034, 'binary_precision': 0.94479305, 'binary_recall': 0.89706, 'binary_specificity': 0.9475741, 'binary_f1_score': 0.920308}
confusion matrix:
       0      1
0  24491   1355
1   2661  23189
---- Validation: 
scalar performance:
{'acc': 0.84553844, 'precision': 0.5471864, 'recall': 0.7715577, 'specificity': 0.7715577, 'f1': 0.54729277, 'auroc': 0.84617984, 'binary_precision': 0.10331315, 'binary_recall': 0.6937799, 'binary_specificity': 0.84933555, 'binary_f1_score': 0.17984496}
confusion matrix:
       0     1
0  14189  2517
1    128   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8120293, 'precision': 0.62427485, 'recall': 0.8079069, 'specificity': 0.8079069, 'f1': 0.64567673, 'auroc': 0.8764796, 'binary_precision': 0.26890758, 'binary_recall': 0.8030113, 'binary_specificity': 0.81280255, 'binary_f1_score': 0.40289584}
confusion matrix:
      0     1
0  7555  1740
1   157   640
early stop counter: 2
val acc:0.8455384373664856, best validation acc: 0.8686054944992065, corresponding to test acc:                         0.8228299617767334 / 0.8228299617767334
after epoch: 13,now: 2024-08-06 17:36:26.552579,epoch time: 0:16:11.494532,used: 3:41:06.097603,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9255842, 'precision': 0.92684734, 'recall': 0.9255916, 'specificity': 0.9255916, 'f1': 0.92552996, 'auroc': 0.9769796, 'binary_precision': 0.950135, 'binary_recall': 0.8983562, 'binary_specificity': 0.9528269, 'binary_f1_score': 0.9235204}
confusion matrix:
       0      1
0  24622   1219
1   2628  23227
---- Validation: 
scalar performance:
{'acc': 0.85937864, 'precision': 0.5505404, 'recall': 0.7693211, 'specificity': 0.7693211, 'f1': 0.55638963, 'auroc': 0.8485527, 'binary_precision': 0.110415034, 'binary_recall': 0.67464113, 'binary_specificity': 0.864001, 'binary_f1_score': 0.18977119}
confusion matrix:
       0     1
0  14434  2272
1    136   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263971, 'precision': 0.632243, 'recall': 0.81226546, 'specificity': 0.81226546, 'f1': 0.6588967, 'auroc': 0.878029, 'binary_precision': 0.28520018, 'binary_recall': 0.79548305, 'binary_specificity': 0.82904786, 'binary_f1_score': 0.41986755}
confusion matrix:
      0     1
0  7706  1589
1   163   634
new oracle model saved
early stop counter: 3
val acc:0.8593786358833313, best validation acc: 0.8686054944992065, corresponding to test acc:                         0.8228299617767334 / 0.8263971209526062
after epoch: 14,now: 2024-08-06 17:52:01.499910,epoch time: 0:15:34.947331,used: 3:56:41.044934,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92927885, 'precision': 0.92987084, 'recall': 0.9292803, 'specificity': 0.9292803, 'f1': 0.92925465, 'auroc': 0.9774432, 'binary_precision': 0.9458417, 'binary_recall': 0.91071564, 'binary_specificity': 0.9478449, 'binary_f1_score': 0.9279464}
confusion matrix:
       0      1
0  24498   1348
1   2308  23542
---- Validation: 
scalar performance:
{'acc': 0.8428521, 'precision': 0.54720694, 'recall': 0.7760122, 'specificity': 0.7760122, 'f1': 0.5464621, 'auroc': 0.85212314, 'binary_precision': 0.10303877, 'binary_recall': 0.70574164, 'binary_specificity': 0.8462828, 'binary_f1_score': 0.17982323}
confusion matrix:
       0     1
0  14138  2568
1    123   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8147047, 'precision': 0.6269622, 'recall': 0.8133743, 'specificity': 0.8133743, 'f1': 0.64955264, 'auroc': 0.8787596, 'binary_precision': 0.27334177, 'binary_recall': 0.8117942, 'binary_specificity': 0.8149543, 'binary_f1_score': 0.408976}
confusion matrix:
      0     1
0  7575  1720
1   150   647
early stop counter: 4
val acc:0.8428521156311035, best validation acc: 0.8686054944992065, corresponding to test acc:                         0.8228299617767334 / 0.8263971209526062
after epoch: 15,now: 2024-08-06 18:07:34.244258,epoch time: 0:15:32.744348,used: 4:12:13.789282,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92945296, 'precision': 0.93051416, 'recall': 0.92945683, 'specificity': 0.92945683, 'f1': 0.92940986, 'auroc': 0.97869885, 'binary_precision': 0.95192736, 'binary_recall': 0.9046109, 'binary_specificity': 0.9543027, 'binary_f1_score': 0.9276661}
confusion matrix:
       0      1
0  24663   1181
1   2466  23386
---- Validation: 
scalar performance:
{'acc': 0.8492175, 'precision': 0.5492787, 'recall': 0.7792745, 'specificity': 0.7792745, 'f1': 0.551458, 'auroc': 0.85494363, 'binary_precision': 0.10711692, 'binary_recall': 0.70574164, 'binary_specificity': 0.8528074, 'binary_f1_score': 0.18600254}
confusion matrix:
       0     1
0  14247  2459
1    123   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8199564, 'precision': 0.6293717, 'recall': 0.8133575, 'specificity': 0.8133575, 'f1': 0.6538485, 'auroc': 0.88005304, 'binary_precision': 0.27864584, 'binary_recall': 0.8055207, 'binary_specificity': 0.8211942, 'binary_f1_score': 0.41406}
confusion matrix:
      0     1
0  7633  1662
1   155   642
early stop counter: 5
val acc:0.8492174744606018, best validation acc: 0.8686054944992065, corresponding to test acc:                         0.8228299617767334 / 0.8263971209526062
after epoch: 16,now: 2024-08-06 18:23:58.610605,epoch time: 0:16:24.366347,used: 4:28:38.155629,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9316775, 'precision': 0.93263483, 'recall': 0.93168205, 'specificity': 0.93168205, 'f1': 0.93164015, 'auroc': 0.97943926, 'binary_precision': 0.9530343, 'binary_recall': 0.90813446, 'binary_specificity': 0.95522964, 'binary_f1_score': 0.9300428}
confusion matrix:
       0      1
0  24686   1157
1   2375  23478
---- Validation: 
scalar performance:
{'acc': 0.8556996, 'precision': 0.5517416, 'recall': 0.78376293, 'specificity': 0.78376293, 'f1': 0.5570189, 'auroc': 0.858094, 'binary_precision': 0.11190926, 'binary_recall': 0.708134, 'binary_specificity': 0.8593918, 'binary_f1_score': 0.19327456}
confusion matrix:
       0     1
0  14357  2349
1    122   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82629806, 'precision': 0.63296354, 'recall': 0.81507945, 'specificity': 0.81507945, 'f1': 0.6597225, 'auroc': 0.8812822, 'binary_precision': 0.28603402, 'binary_recall': 0.80175656, 'binary_specificity': 0.82840234, 'binary_f1_score': 0.421643}
confusion matrix:
      0     1
0  7700  1595
1   158   639
early stop counter: 6
val acc:0.8556995987892151, best validation acc: 0.8686054944992065, corresponding to test acc:                         0.8228299617767334 / 0.8263971209526062
after epoch: 17,now: 2024-08-06 18:39:46.639935,epoch time: 0:15:48.029330,used: 4:44:26.184959,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9319483, 'precision': 0.93330634, 'recall': 0.93195593, 'specificity': 0.93195593, 'f1': 0.93189573, 'auroc': 0.98054564, 'binary_precision': 0.95763165, 'binary_recall': 0.9039257, 'binary_specificity': 0.9599861, 'binary_f1_score': 0.930004}
confusion matrix:
       0      1
0  24807   1034
1   2484  23371
---- Validation: 
scalar performance:
{'acc': 0.8679631, 'precision': 0.55568, 'recall': 0.7842169, 'specificity': 0.7842169, 'f1': 0.56635916, 'auroc': 0.8585982, 'binary_precision': 0.12, 'binary_recall': 0.69617224, 'binary_specificity': 0.87226146, 'binary_f1_score': 0.20471331}
confusion matrix:
       0     1
0  14572  2134
1    127   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83818865, 'precision': 0.639222, 'recall': 0.8140783, 'specificity': 0.8140783, 'f1': 0.6697852, 'auroc': 0.8809382, 'binary_precision': 0.29980844, 'binary_recall': 0.7854454, 'binary_specificity': 0.84271115, 'binary_f1_score': 0.4339688}
confusion matrix:
      0     1
0  7833  1462
1   171   626
new oracle model saved
early stop counter: 7
val acc:0.8679630756378174, best validation acc: 0.8686054944992065, corresponding to test acc:                         0.8228299617767334 / 0.838188648223877
after epoch: 18,now: 2024-08-06 18:55:39.340537,epoch time: 0:15:52.700602,used: 5:00:18.885561,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9332637, 'precision': 0.93394953, 'recall': 0.9332645, 'specificity': 0.9332645, 'f1': 0.9332374, 'auroc': 0.9803544, 'binary_precision': 0.9512107, 'binary_recall': 0.9133816, 'binary_specificity': 0.95314735, 'binary_f1_score': 0.9319123}
confusion matrix:
       0      1
0  24636   1211
1   2239  23610
---- Validation: 
scalar performance:
{'acc': 0.85406446, 'precision': 0.5515062, 'recall': 0.78525734, 'specificity': 0.78525734, 'f1': 0.5561758, 'auroc': 0.8612473, 'binary_precision': 0.11131864, 'binary_recall': 0.71291864, 'binary_specificity': 0.8575961, 'binary_f1_score': 0.19256866}
confusion matrix:
       0     1
0  14327  2379
1    120   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82827985, 'precision': 0.6344373, 'recall': 0.8167289, 'specificity': 0.8167289, 'f1': 0.6619499, 'auroc': 0.8824029, 'binary_precision': 0.28880867, 'binary_recall': 0.8030113, 'binary_specificity': 0.8304465, 'binary_f1_score': 0.42482573}
confusion matrix:
      0     1
0  7719  1576
1   157   640
early stop counter: 8
val acc:0.8540644645690918, best validation acc: 0.8686054944992065, corresponding to test acc:                         0.8228299617767334 / 0.838188648223877
after epoch: 19,now: 2024-08-06 19:11:23.691352,epoch time: 0:15:44.350815,used: 5:16:03.236376,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9364748, 'precision': 0.93703705, 'recall': 0.9364762, 'specificity': 0.9364762, 'f1': 0.9364545, 'auroc': 0.98180854, 'binary_precision': 0.9527325, 'binary_recall': 0.91853, 'binary_specificity': 0.95442235, 'binary_f1_score': 0.93531865}
confusion matrix:
       0      1
0  24668   1178
1   2106  23744
---- Validation: 
scalar performance:
{'acc': 0.8485751, 'precision': 0.5506427, 'recall': 0.78944147, 'specificity': 0.78944147, 'f1': 0.55321103, 'auroc': 0.86259216, 'binary_precision': 0.10923464, 'binary_recall': 0.72727275, 'binary_specificity': 0.8516102, 'binary_f1_score': 0.18994063}
confusion matrix:
       0     1
0  14227  2479
1    114   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8238208, 'precision': 0.63182026, 'recall': 0.8154553, 'specificity': 0.8154553, 'f1': 0.65774536, 'auroc': 0.8826887, 'binary_precision': 0.28344372, 'binary_recall': 0.8055207, 'binary_specificity': 0.82539, 'binary_f1_score': 0.4193338}
confusion matrix:
      0     1
0  7672  1623
1   155   642
early stop counter: 9
val acc:0.8485751152038574, best validation acc: 0.8686054944992065, corresponding to test acc:                         0.8228299617767334 / 0.838188648223877
after epoch: 20,now: 2024-08-06 19:27:02.460758,epoch time: 0:15:38.769406,used: 5:31:42.005782,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_13_55_20_seed_2_24076670
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:31:42.005782 at 2024-08-06 19:27:02.460758
persisted model performance metric: 

scalar performance:
{'acc': 0.82282996, 'precision': 0.62640595, 'recall': 0.79771066, 'specificity': 0.79771066, 'f1': 0.6511257, 'auroc': 0.87215495, 'binary_precision': 0.27629796, 'binary_recall': 0.76787955, 'binary_specificity': 0.8275417, 'binary_f1_score': 0.40637448}
confusion matrix:
      0     1
0  7692  1603
1   185   612
oracle model performance metric: 

scalar performance:
{'acc': 0.83818865, 'precision': 0.639222, 'recall': 0.8140783, 'specificity': 0.8140783, 'f1': 0.6697852, 'auroc': 0.8809382, 'binary_precision': 0.29980844, 'binary_recall': 0.7854454, 'binary_specificity': 0.84271115, 'binary_f1_score': 0.4339688}
confusion matrix:
      0     1
0  7833  1462
1   171   626
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  16648 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1066 MiB | 565248 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     58 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  89169 KiB | 611401 GiB | 611401 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 588392 GiB | 588392 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6945    |  246582 K  |  246578 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140321 K  |  140317 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6945    |  246582 K  |  246578 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140321 K  |  140317 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      74    |      33    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3250    |  133393 K  |  133393 K  |
|       from large pool |      10    |      23    |   64619 K  |   64619 K  |
|       from small pool |      21    |    3240    |   68773 K  |   68773 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |   1066 MiB |    838 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  28672 KiB |  43008 KiB |     58 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 611401 GiB | 611401 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 588392 GiB | 588392 GiB |
|       from small pool |      0 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6945    |  246582 K  |  246582 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140321 K  |  140321 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6945    |  246582 K  |  246582 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140321 K  |  140321 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      74    |      50    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      14    |      21    |      29    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3250    |  133395 K  |  133395 K  |
|       from large pool |       3    |      23    |   64619 K  |   64619 K  |
|       from small pool |       0    |    3240    |   68775 K  |   68775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug  6 19:44:30 2024]
Finished job 0.
1 of 1 steps (100%) done
