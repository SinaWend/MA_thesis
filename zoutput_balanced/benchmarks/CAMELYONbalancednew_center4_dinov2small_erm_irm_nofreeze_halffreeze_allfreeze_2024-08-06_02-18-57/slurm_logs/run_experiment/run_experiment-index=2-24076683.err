Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 22:15:17 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683

 Experiment start at: 2024-08-06 22:23:08.467284
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9728364, 'precision': 0.97413766, 'recall': 0.972852, 'specificity': 0.972852, 'f1': 0.9728184, 'auroc': 0.99874425, 'binary_precision': 0.9991253, 'binary_recall': 0.94653356, 'binary_specificity': 0.99917036, 'binary_f1_score': 0.9721186}
confusion matrix:
       0      1
0  25292     21
1   1355  23988
---- Validation: 
scalar performance:
{'acc': 0.9753879, 'precision': 0.73267615, 'recall': 0.621984, 'specificity': 0.621984, 'f1': 0.6588112, 'auroc': 0.94228196, 'binary_precision': 0.48372093, 'binary_recall': 0.25060242, 'binary_specificity': 0.9933656, 'binary_f1_score': 0.33015874}
confusion matrix:
       0    1
0  16620  111
1    311  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231758, 'precision': 0.73328567, 'recall': 0.7908642, 'specificity': 0.7908642, 'f1': 0.7578515, 'auroc': 0.91800964, 'binary_precision': 0.49746192, 'binary_recall': 0.634715, 'binary_specificity': 0.9470135, 'binary_f1_score': 0.55776894}
confusion matrix:
      0    1
0  8847  495
1   282  490
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 22:42:40.549604,epoch time: 0:19:32.082320,used: 0:19:32.082320,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97862047, 'precision': 0.9794687, 'recall': 0.9786339, 'specificity': 0.9786339, 'f1': 0.97861147, 'auroc': 0.99892616, 'binary_precision': 0.999794, 'binary_recall': 0.9574653, 'binary_specificity': 0.9998025, 'binary_f1_score': 0.97817194}
confusion matrix:
       0      1
0  25307      5
1   1078  24266
---- Validation: 
scalar performance:
{'acc': 0.97439635, 'precision': 0.725976, 'recall': 0.6966718, 'specificity': 0.6966718, 'f1': 0.7102252, 'auroc': 0.9154661, 'binary_precision': 0.46666667, 'binary_recall': 0.40481928, 'binary_specificity': 0.9885243, 'binary_f1_score': 0.4335484}
confusion matrix:
       0    1
0  16539  192
1    247  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90874034, 'precision': 0.7121475, 'recall': 0.84781206, 'specificity': 0.84781206, 'f1': 0.7569266, 'auroc': 0.90584385, 'binary_precision': 0.4440326, 'binary_recall': 0.77590674, 'binary_specificity': 0.91971743, 'binary_f1_score': 0.5648279}
confusion matrix:
      0    1
0  8592  750
1   173  599
early stop counter: 1
val acc:0.9743963479995728, best validation acc: 0.9753878712654114, corresponding to test acc:                         0.9231758117675781 / 0.9231758117675781
after epoch: 2,now: 2024-08-06 23:01:03.889287,epoch time: 0:18:23.339683,used: 0:37:55.422003,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9932683, 'precision': 0.9932697, 'recall': 0.9932679, 'specificity': 0.9932679, 'f1': 0.9932683, 'auroc': 0.99961364, 'binary_precision': 0.99259174, 'binary_recall': 0.9939626, 'binary_specificity': 0.99257326, 'binary_f1_score': 0.99327666}
confusion matrix:
       0      1
0  25126    188
1    153  25189
---- Validation: 
scalar performance:
{'acc': 0.9693806, 'precision': 0.7072079, 'recall': 0.8444934, 'specificity': 0.8444934, 'f1': 0.75708294, 'auroc': 0.9494386, 'binary_precision': 0.42165244, 'binary_recall': 0.713253, 'binary_specificity': 0.9757337, 'binary_f1_score': 0.52999103}
confusion matrix:
       0    1
0  16325  406
1    119  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85228395, 'precision': 0.658583, 'recall': 0.86953604, 'specificity': 0.86953604, 'f1': 0.6965097, 'auroc': 0.9195757, 'binary_precision': 0.32776716, 'binary_recall': 0.8898964, 'binary_specificity': 0.84917575, 'binary_f1_score': 0.47907948}
confusion matrix:
      0     1
0  7933  1409
1    85   687
early stop counter: 2
val acc:0.9693806171417236, best validation acc: 0.9753878712654114, corresponding to test acc:                         0.9231758117675781 / 0.9231758117675781
after epoch: 3,now: 2024-08-06 23:19:28.108157,epoch time: 0:18:24.218870,used: 0:56:19.640873,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9926958, 'precision': 0.9927304, 'recall': 0.99269783, 'specificity': 0.99269783, 'f1': 0.9926957, 'auroc': 0.99971294, 'binary_precision': 0.99697477, 'binary_recall': 0.9883978, 'binary_specificity': 0.99699795, 'binary_f1_score': 0.99266773}
confusion matrix:
       0      1
0  25240     76
1    294  25046
---- Validation: 
scalar performance:
{'acc': 0.9612738, 'precision': 0.6837309, 'recall': 0.9131853, 'specificity': 0.9131853, 'f1': 0.7493328, 'auroc': 0.9592401, 'binary_precision': 0.37098446, 'binary_recall': 0.8626506, 'binary_specificity': 0.96372, 'binary_f1_score': 0.5188406}
confusion matrix:
       0    1
0  16124  607
1     57  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.902808, 'precision': 0.7110381, 'recall': 0.89272666, 'specificity': 0.89272666, 'f1': 0.7627451, 'auroc': 0.9299151, 'binary_precision': 0.43284532, 'binary_recall': 0.88082904, 'binary_specificity': 0.9046243, 'binary_f1_score': 0.58045244}
confusion matrix:
      0    1
0  8451  891
1    92  680
early stop counter: 3
val acc:0.9612737894058228, best validation acc: 0.9753878712654114, corresponding to test acc:                         0.9231758117675781 / 0.9231758117675781
after epoch: 4,now: 2024-08-06 23:38:01.829498,epoch time: 0:18:33.721341,used: 1:14:53.362214,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99151134, 'precision': 0.9915157, 'recall': 0.9915125, 'specificity': 0.9915125, 'f1': 0.99151134, 'auroc': 0.99952185, 'binary_precision': 0.9931515, 'binary_recall': 0.98985994, 'binary_specificity': 0.993165, 'binary_f1_score': 0.99150294}
confusion matrix:
       0      1
0  25138    173
1    257  25088
---- Validation: 
scalar performance:
{'acc': 0.93876123, 'precision': 0.6271234, 'recall': 0.88167596, 'specificity': 0.88167596, 'f1': 0.6807581, 'auroc': 0.93499136, 'binary_precision': 0.2589218, 'binary_recall': 0.82168674, 'binary_specificity': 0.9416652, 'binary_f1_score': 0.3937644}
confusion matrix:
       0    1
0  15755  976
1     74  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9161558, 'precision': 0.70391387, 'recall': 0.709231, 'specificity': 0.709231, 'f1': 0.7065265, 'auroc': 0.9084462, 'binary_precision': 0.45214105, 'binary_recall': 0.4650259, 'binary_specificity': 0.9534361, 'binary_f1_score': 0.45849296}
confusion matrix:
      0    1
0  8907  435
1   413  359
early stop counter: 4
val acc:0.9387612342834473, best validation acc: 0.9753878712654114, corresponding to test acc:                         0.9231758117675781 / 0.9231758117675781
after epoch: 5,now: 2024-08-06 23:56:30.150035,epoch time: 0:18:28.320537,used: 1:33:21.682751,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9819567, 'precision': 0.9822159, 'recall': 0.9819499, 'specificity': 0.9819499, 'f1': 0.9819541, 'auroc': 0.99895775, 'binary_precision': 0.9711839, 'binary_recall': 0.9934104, 'binary_specificity': 0.97048944, 'binary_f1_score': 0.9821714}
confusion matrix:
       0      1
0  24566    747
1    167  25176
---- Validation: 
scalar performance:
{'acc': 0.92003965, 'precision': 0.6035782, 'recall': 0.8826574, 'specificity': 0.8826574, 'f1': 0.64772546, 'auroc': 0.9339814, 'binary_precision': 0.21135266, 'binary_recall': 0.8433735, 'binary_specificity': 0.9219413, 'binary_f1_score': 0.33800095}
confusion matrix:
       0     1
0  15425  1306
1     65   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82479733, 'precision': 0.6181321, 'recall': 0.7768238, 'specificity': 0.7768238, 'f1': 0.64170384, 'auroc': 0.85633606, 'binary_precision': 0.26325756, 'binary_recall': 0.7202073, 'binary_specificity': 0.83344036, 'binary_f1_score': 0.38557556}
confusion matrix:
      0     1
0  7786  1556
1   216   556
early stop counter: 5
val acc:0.9200396537780762, best validation acc: 0.9753878712654114, corresponding to test acc:                         0.9231758117675781 / 0.9231758117675781
after epoch: 6,now: 2024-08-07 00:14:54.697829,epoch time: 0:18:24.547794,used: 1:51:46.230545,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9859839, 'precision': 0.98635817, 'recall': 0.9859899, 'specificity': 0.9859899, 'f1': 0.9859813, 'auroc': 0.9996443, 'binary_precision': 0.9999594, 'binary_recall': 0.97201943, 'binary_specificity': 0.9999605, 'binary_f1_score': 0.98579144}
confusion matrix:
       0      1
0  25316      1
1    709  24630
---- Validation: 
scalar performance:
{'acc': 0.9766126, 'precision': 0.78771734, 'recall': 0.5509406, 'specificity': 0.5509406, 'f1': 0.5823646, 'auroc': 0.95899105, 'binary_precision': 0.5972222, 'binary_recall': 0.10361446, 'binary_specificity': 0.9982667, 'binary_f1_score': 0.17659137}
confusion matrix:
       0   1
0  16702  29
1    372  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92653745, 'precision': 0.74630386, 'recall': 0.58651507, 'specificity': 0.58651507, 'f1': 0.61961985, 'auroc': 0.9285776, 'binary_precision': 0.5564202, 'binary_recall': 0.18523316, 'binary_specificity': 0.987797, 'binary_f1_score': 0.27793974}
confusion matrix:
      0    1
0  9228  114
1   629  143
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-07 00:33:14.089763,epoch time: 0:18:19.391934,used: 2:10:05.622479,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9967427, 'precision': 0.99674845, 'recall': 0.99674374, 'specificity': 0.99674374, 'f1': 0.9967427, 'auroc': 0.9998518, 'binary_precision': 0.9985742, 'binary_recall': 0.99490964, 'binary_specificity': 0.99857783, 'binary_f1_score': 0.9967386}
confusion matrix:
       0      1
0  25278     36
1    129  25213
---- Validation: 
scalar performance:
{'acc': 0.97258836, 'precision': 0.7217459, 'recall': 0.80736417, 'specificity': 0.80736417, 'f1': 0.7569983, 'auroc': 0.9550539, 'binary_precision': 0.4526678, 'binary_recall': 0.63373494, 'binary_specificity': 0.9809934, 'binary_f1_score': 0.5281124}
confusion matrix:
       0    1
0  16413  318
1    152  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87245405, 'precision': 0.6726409, 'recall': 0.8638184, 'specificity': 0.8638184, 'f1': 0.7160779, 'auroc': 0.91805434, 'binary_precision': 0.35893247, 'binary_recall': 0.85362697, 'binary_specificity': 0.87400985, 'binary_f1_score': 0.5053681}
confusion matrix:
      0     1
0  8165  1177
1   113   659
early stop counter: 1
val acc:0.9725883603096008, best validation acc: 0.9766126275062561, corresponding to test acc:                         0.9265374541282654 / 0.9265374541282654
after epoch: 8,now: 2024-08-07 00:51:39.883583,epoch time: 0:18:25.793820,used: 2:28:31.416299,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9932683, 'precision': 0.99330026, 'recall': 0.99326617, 'specificity': 0.99326617, 'f1': 0.9932682, 'auroc': 0.9997174, 'binary_precision': 0.9894671, 'binary_recall': 0.9971589, 'binary_specificity': 0.98937345, 'binary_f1_score': 0.9932981}
confusion matrix:
       0      1
0  25045    269
1     72  25270
---- Validation: 
scalar performance:
{'acc': 0.90050155, 'precision': 0.5890301, 'recall': 0.89261997, 'specificity': 0.89261997, 'f1': 0.62362975, 'auroc': 0.9456713, 'binary_precision': 0.18123457, 'binary_recall': 0.88433737, 'binary_specificity': 0.9009025, 'binary_f1_score': 0.30081967}
confusion matrix:
       0     1
0  15073  1658
1     48   367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8041329, 'precision': 0.6285822, 'recall': 0.84822416, 'specificity': 0.84822416, 'f1': 0.6474113, 'auroc': 0.9180104, 'binary_precision': 0.26741055, 'binary_recall': 0.9002591, 'binary_specificity': 0.79618925, 'binary_f1_score': 0.41234055}
confusion matrix:
      0     1
0  7438  1904
1    77   695
early stop counter: 2
val acc:0.900501549243927, best validation acc: 0.9766126275062561, corresponding to test acc:                         0.9265374541282654 / 0.9265374541282654
after epoch: 9,now: 2024-08-07 01:10:03.847696,epoch time: 0:18:23.964113,used: 2:46:55.380412,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99172854, 'precision': 0.99179435, 'recall': 0.99173224, 'specificity': 0.99173224, 'f1': 0.9917283, 'auroc': 0.9994517, 'binary_precision': 0.99764407, 'binary_recall': 0.98579544, 'binary_specificity': 0.9976691, 'binary_f1_score': 0.9916844}
confusion matrix:
       0      1
0  25253     59
1    360  24984
---- Validation: 
scalar performance:
{'acc': 0.96179867, 'precision': 0.65437835, 'recall': 0.74543864, 'specificity': 0.74543864, 'f1': 0.6882943, 'auroc': 0.93236357, 'binary_precision': 0.32089552, 'binary_recall': 0.5180723, 'binary_specificity': 0.97280496, 'binary_f1_score': 0.3963134}
confusion matrix:
       0    1
0  16276  455
1    200  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8346846, 'precision': 0.63955617, 'recall': 0.83624333, 'specificity': 0.83624333, 'f1': 0.66970885, 'auroc': 0.90544593, 'binary_precision': 0.29489517, 'binary_recall': 0.8380829, 'binary_specificity': 0.83440375, 'binary_f1_score': 0.43627784}
confusion matrix:
      0     1
0  7795  1547
1   125   647
early stop counter: 3
val acc:0.9617986679077148, best validation acc: 0.9766126275062561, corresponding to test acc:                         0.9265374541282654 / 0.9265374541282654
after epoch: 10,now: 2024-08-07 01:28:26.792753,epoch time: 0:18:22.945057,used: 3:05:18.325469,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9959136, 'precision': 0.9959165, 'recall': 0.9959142, 'specificity': 0.9959142, 'f1': 0.99591357, 'auroc': 0.99984884, 'binary_precision': 0.9972301, 'binary_recall': 0.9945933, 'binary_specificity': 0.99723506, 'binary_f1_score': 0.9959099}
confusion matrix:
       0      1
0  25247     70
1    137  25202
---- Validation: 
scalar performance:
{'acc': 0.9740464, 'precision': 0.73020774, 'recall': 0.7834376, 'specificity': 0.7834376, 'f1': 0.7538261, 'auroc': 0.94982135, 'binary_precision': 0.47081712, 'binary_recall': 0.5831325, 'binary_specificity': 0.9837428, 'binary_f1_score': 0.5209903}
confusion matrix:
       0    1
0  16459  272
1    173  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8814514, 'precision': 0.6796128, 'recall': 0.85740006, 'specificity': 0.85740006, 'f1': 0.72439206, 'auroc': 0.9217582, 'binary_precision': 0.37492678, 'binary_recall': 0.82901555, 'binary_specificity': 0.8857846, 'binary_f1_score': 0.5163373}
confusion matrix:
      0     1
0  8275  1067
1   132   640
early stop counter: 4
val acc:0.9740464091300964, best validation acc: 0.9766126275062561, corresponding to test acc:                         0.9265374541282654 / 0.9265374541282654
after epoch: 11,now: 2024-08-07 01:46:43.319976,epoch time: 0:18:16.527223,used: 3:23:34.852692,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.995045, 'precision': 0.995067, 'recall': 0.9950466, 'specificity': 0.9950466, 'f1': 0.99504495, 'auroc': 0.9998864, 'binary_precision': 0.99849, 'binary_recall': 0.9915943, 'binary_specificity': 0.998499, 'binary_f1_score': 0.9950302}
confusion matrix:
       0      1
0  25278     38
1    213  25127
---- Validation: 
scalar performance:
{'acc': 0.97462964, 'precision': 0.7358811, 'recall': 0.8013605, 'specificity': 0.8013605, 'f1': 0.7642883, 'auroc': 0.95581746, 'binary_precision': 0.4812734, 'binary_recall': 0.6192771, 'binary_specificity': 0.9834439, 'binary_f1_score': 0.54162276}
confusion matrix:
       0    1
0  16454  277
1    158  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8707732, 'precision': 0.67328584, 'recall': 0.873009, 'specificity': 0.873009, 'f1': 0.7170347, 'auroc': 0.9216491, 'binary_precision': 0.3582406, 'binary_recall': 0.87564766, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.50846183}
confusion matrix:
      0     1
0  8131  1211
1    96   676
early stop counter: 5
val acc:0.9746296405792236, best validation acc: 0.9766126275062561, corresponding to test acc:                         0.9265374541282654 / 0.9265374541282654
after epoch: 12,now: 2024-08-07 02:05:06.767393,epoch time: 0:18:23.447417,used: 3:41:58.300109,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9942948, 'precision': 0.99435526, 'recall': 0.994298, 'specificity': 0.994298, 'f1': 0.9942947, 'auroc': 0.9999428, 'binary_precision': 0.99996006, 'binary_recall': 0.9886355, 'binary_specificity': 0.9999605, 'binary_f1_score': 0.99426556}
confusion matrix:
       0      1
0  25313      1
1    288  25054
---- Validation: 
scalar performance:
{'acc': 0.9801703, 'precision': 0.8577166, 'recall': 0.6408836, 'specificity': 0.6408836, 'f1': 0.69981897, 'auroc': 0.9582646, 'binary_precision': 0.7329193, 'binary_recall': 0.28433734, 'binary_specificity': 0.9974299, 'binary_f1_score': 0.4097222}
confusion matrix:
       0    1
0  16688   43
1    297  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9174412, 'precision': 0.7289198, 'recall': 0.86202836, 'specificity': 0.86202836, 'f1': 0.7748345, 'auroc': 0.92822134, 'binary_precision': 0.47563806, 'binary_recall': 0.7966321, 'binary_specificity': 0.92742455, 'binary_f1_score': 0.5956416}
confusion matrix:
      0    1
0  8664  678
1   157  615
better model found
persisted
after epoch: 13,now: 2024-08-07 02:23:29.756823,epoch time: 0:18:22.989430,used: 4:00:21.289539,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9949463, 'precision': 0.99495286, 'recall': 0.9949454, 'specificity': 0.9949454, 'f1': 0.99494624, 'auroc': 0.9998548, 'binary_precision': 0.99327487, 'binary_recall': 0.99664575, 'binary_specificity': 0.9932451, 'binary_f1_score': 0.99495745}
confusion matrix:
       0      1
0  25144    171
1     85  25256
---- Validation: 
scalar performance:
{'acc': 0.96360666, 'precision': 0.6934059, 'recall': 0.927305, 'specificity': 0.927305, 'f1': 0.76145047, 'auroc': 0.96529114, 'binary_precision': 0.38965154, 'binary_recall': 0.88915664, 'binary_specificity': 0.9654533, 'binary_f1_score': 0.5418502}
confusion matrix:
       0    1
0  16153  578
1     46  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288511, 'precision': 0.6461026, 'recall': 0.8740817, 'specificity': 0.8740817, 'f1': 0.6756495, 'auroc': 0.92652726, 'binary_precision': 0.2994563, 'binary_recall': 0.92746115, 'binary_specificity': 0.8207022, 'binary_f1_score': 0.4527347}
confusion matrix:
      0     1
0  7667  1675
1    56   716
early stop counter: 1
val acc:0.9636066555976868, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.917441189289093 / 0.9265374541282654
after epoch: 14,now: 2024-08-07 02:41:51.922716,epoch time: 0:18:22.165893,used: 4:18:43.455432,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99488705, 'precision': 0.9948946, 'recall': 0.9948859, 'specificity': 0.9948859, 'f1': 0.9948871, 'auroc': 0.99989474, 'binary_precision': 0.9931197, 'binary_recall': 0.9966856, 'binary_specificity': 0.9930863, 'binary_f1_score': 0.9948995}
confusion matrix:
       0      1
0  25137    175
1     84  25260
---- Validation: 
scalar performance:
{'acc': 0.97311324, 'precision': 0.7337899, 'recall': 0.9298263, 'specificity': 0.9298263, 'f1': 0.8001486, 'auroc': 0.96940565, 'binary_precision': 0.4705128, 'binary_recall': 0.88433737, 'binary_specificity': 0.9753153, 'binary_f1_score': 0.6142259}
confusion matrix:
       0    1
0  16318  413
1     48  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9053787, 'precision': 0.7160314, 'recall': 0.90243626, 'specificity': 0.90243626, 'f1': 0.76919156, 'auroc': 0.932325, 'binary_precision': 0.44119516, 'binary_recall': 0.89896375, 'binary_specificity': 0.9059088, 'binary_f1_score': 0.59189767}
confusion matrix:
      0    1
0  8463  879
1    78  694
early stop counter: 2
val acc:0.9731132388114929, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.917441189289093 / 0.9265374541282654
after epoch: 15,now: 2024-08-07 02:59:55.058961,epoch time: 0:18:03.136245,used: 4:36:46.591677,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99613076, 'precision': 0.9961442, 'recall': 0.99613297, 'specificity': 0.99613297, 'f1': 0.9961307, 'auroc': 0.9998946, 'binary_precision': 0.99892884, 'binary_recall': 0.9933328, 'binary_specificity': 0.99893314, 'binary_f1_score': 0.99612296}
confusion matrix:
       0      1
0  25281     27
1    169  25179
---- Validation: 
scalar performance:
{'acc': 0.9608072, 'precision': 0.6803401, 'recall': 0.900022, 'specificity': 0.900022, 'f1': 0.7438216, 'auroc': 0.95939916, 'binary_precision': 0.36487907, 'binary_recall': 0.83614457, 'binary_specificity': 0.9638994, 'binary_f1_score': 0.5080527}
confusion matrix:
       0    1
0  16127  604
1     68  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90132487, 'precision': 0.7059772, 'recall': 0.8746935, 'specificity': 0.8746935, 'f1': 0.7552099, 'auroc': 0.918385, 'binary_precision': 0.42604712, 'binary_recall': 0.8432642, 'binary_specificity': 0.90612286, 'binary_f1_score': 0.566087}
confusion matrix:
      0    1
0  8465  877
1   121  651
early stop counter: 3
val acc:0.960807204246521, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.917441189289093 / 0.9265374541282654
after epoch: 16,now: 2024-08-07 03:17:49.665021,epoch time: 0:17:54.606060,used: 4:54:41.197737,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99619, 'precision': 0.99618995, 'recall': 0.99619013, 'specificity': 0.99619013, 'f1': 0.99619, 'auroc': 0.99986494, 'binary_precision': 0.9964469, 'binary_recall': 0.99593574, 'binary_specificity': 0.9964445, 'binary_f1_score': 0.99619126}
confusion matrix:
       0      1
0  25223     90
1    103  25240
---- Validation: 
scalar performance:
{'acc': 0.9355535, 'precision': 0.6225672, 'recall': 0.8835571, 'specificity': 0.8835571, 'f1': 0.6748567, 'auroc': 0.94936967, 'binary_precision': 0.24963716, 'binary_recall': 0.82891566, 'binary_specificity': 0.93819857, 'binary_f1_score': 0.38371444}
confusion matrix:
       0     1
0  15697  1034
1     71   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7069409, 'precision': 0.59875304, 'recall': 0.82413137, 'specificity': 0.82413137, 'f1': 0.57303804, 'auroc': 0.9261842, 'binary_precision': 0.20201196, 'binary_recall': 0.96243525, 'binary_specificity': 0.68582743, 'binary_f1_score': 0.33393258}
confusion matrix:
      0     1
0  6407  2935
1    29   743
early stop counter: 4
val acc:0.9355534911155701, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.917441189289093 / 0.9265374541282654
after epoch: 17,now: 2024-08-07 03:36:00.736891,epoch time: 0:18:11.071870,used: 5:12:52.269607,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9954201, 'precision': 0.99543834, 'recall': 0.9954221, 'specificity': 0.9954221, 'f1': 0.99542004, 'auroc': 0.9998869, 'binary_precision': 0.99861014, 'binary_recall': 0.99222696, 'binary_specificity': 0.99861723, 'binary_f1_score': 0.9954083}
confusion matrix:
       0      1
0  25277     35
1    197  25147
---- Validation: 
scalar performance:
{'acc': 0.9795871, 'precision': 0.78361154, 'recall': 0.7862767, 'specificity': 0.7862767, 'f1': 0.7849374, 'auroc': 0.9535083, 'binary_precision': 0.5775656, 'binary_recall': 0.5831325, 'binary_specificity': 0.98942083, 'binary_f1_score': 0.5803357}
confusion matrix:
       0    1
0  16554  177
1    173  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8743326, 'precision': 0.6761337, 'recall': 0.87196505, 'specificity': 0.87196505, 'f1': 0.72071576, 'auroc': 0.91671336, 'binary_precision': 0.36447582, 'binary_recall': 0.86917096, 'binary_specificity': 0.87475914, 'binary_f1_score': 0.5135859}
confusion matrix:
      0     1
0  8172  1170
1   101   671
early stop counter: 5
val acc:0.9795870780944824, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.917441189289093 / 0.9265374541282654
after epoch: 18,now: 2024-08-07 03:54:15.958377,epoch time: 0:18:15.221486,used: 5:31:07.491093,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99245894, 'precision': 0.9924648, 'recall': 0.9924599, 'specificity': 0.9924599, 'f1': 0.99245894, 'auroc': 0.99939144, 'binary_precision': 0.9942964, 'binary_recall': 0.9906081, 'binary_specificity': 0.9943117, 'binary_f1_score': 0.9924488}
confusion matrix:
       0      1
0  25171    144
1    238  25103
---- Validation: 
scalar performance:
{'acc': 0.94313544, 'precision': 0.6220477, 'recall': 0.81812096, 'specificity': 0.81812096, 'f1': 0.66957915, 'auroc': 0.9102144, 'binary_precision': 0.25221238, 'binary_recall': 0.686747, 'binary_specificity': 0.94949496, 'binary_f1_score': 0.36893204}
confusion matrix:
       0    1
0  15886  845
1    130  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92070395, 'precision': 0.7249471, 'recall': 0.77051353, 'specificity': 0.77051353, 'f1': 0.74492514, 'auroc': 0.90576065, 'binary_precision': 0.48414376, 'binary_recall': 0.5932642, 'binary_specificity': 0.9477628, 'binary_f1_score': 0.53317815}
confusion matrix:
      0    1
0  8854  488
1   314  458
early stop counter: 6
val acc:0.9431354403495789, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.917441189289093 / 0.9265374541282654
after epoch: 19,now: 2024-08-07 04:12:28.493353,epoch time: 0:18:12.534976,used: 5:49:20.026069,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99526215, 'precision': 0.9952668, 'recall': 0.9952615, 'specificity': 0.9952615, 'f1': 0.99526215, 'auroc': 0.99981177, 'binary_precision': 0.99386114, 'binary_recall': 0.9966851, 'binary_specificity': 0.9938379, 'binary_f1_score': 0.9952711}
confusion matrix:
       0      1
0  25160    156
1     84  25256
---- Validation: 
scalar performance:
{'acc': 0.9736382, 'precision': 0.7300978, 'recall': 0.8231762, 'specificity': 0.8231762, 'f1': 0.76811117, 'auroc': 0.94245523, 'binary_precision': 0.46859083, 'binary_recall': 0.6650602, 'binary_specificity': 0.9812922, 'binary_f1_score': 0.5498008}
confusion matrix:
       0    1
0  16418  313
1    139  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87304723, 'precision': 0.6661477, 'recall': 0.83383805, 'specificity': 0.83383805, 'f1': 0.7069861, 'auroc': 0.8929231, 'binary_precision': 0.35185185, 'binary_recall': 0.78756475, 'binary_specificity': 0.88011134, 'binary_f1_score': 0.48639998}
confusion matrix:
      0     1
0  8222  1120
1   164   608
early stop counter: 7
val acc:0.9736381769180298, best validation acc: 0.9801703095436096, corresponding to test acc:                         0.917441189289093 / 0.9265374541282654
after epoch: 20,now: 2024-08-07 04:30:32.667236,epoch time: 0:18:04.173883,used: 6:07:24.199952,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:07:24.199952 at 2024-08-07 04:30:32.667236
persisted model performance metric: 

scalar performance:
{'acc': 0.9174412, 'precision': 0.7289198, 'recall': 0.86202836, 'specificity': 0.86202836, 'f1': 0.7748345, 'auroc': 0.92822134, 'binary_precision': 0.47563806, 'binary_recall': 0.7966321, 'binary_specificity': 0.92742455, 'binary_f1_score': 0.5956416}
confusion matrix:
      0    1
0  8664  678
1   157  615
oracle model performance metric: 

scalar performance:
{'acc': 0.92653745, 'precision': 0.74630386, 'recall': 0.58651507, 'specificity': 0.58651507, 'f1': 0.61961985, 'auroc': 0.9285776, 'binary_precision': 0.5564202, 'binary_recall': 0.18523316, 'binary_specificity': 0.987797, 'binary_f1_score': 0.27793974}
confusion matrix:
      0    1
0  9228  114
1   629  143
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459204 KiB |  13220 MiB | 562909 GiB | 562908 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 459204 KiB |  13220 MiB | 562909 GiB | 562908 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447934 KiB |  13213 MiB | 562426 GiB | 562426 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |  40859 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14412 MiB |  14412 MiB |  14412 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 415291 KiB |   1235 MiB | 450794 GiB | 450794 GiB |
|       from large pool | 406502 KiB |   1232 MiB | 442915 GiB | 442915 GiB |
|       from small pool |   8789 KiB |     17 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4934    |    7337    |  107645 K  |  107640 K  |
|       from large pool |     187    |    1413    |   51499 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56145 K  |   56140 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4934    |    7337    |  107645 K  |  107640 K  |
|       from large pool |     187    |    1413    |   51499 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56145 K  |   56140 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3223    |   64617 K  |   64617 K  |
|       from large pool |      30    |     604    |   37573 K  |   37573 K  |
|       from small pool |      38    |    3192    |   27043 K  |   27043 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562426 GiB | 562426 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450794 GiB | 450794 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     44 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107645 K  |  107645 K  |
|       from large pool |       2    |    1413    |   51499 K  |   51499 K  |
|       from small pool |       0    |    7148    |   56145 K  |   56145 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107645 K  |  107645 K  |
|       from large pool |       2    |    1413    |   51499 K  |   51499 K  |
|       from small pool |       0    |    7148    |   56145 K  |   56145 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3223    |   64619 K  |   64619 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3192    |   27045 K  |   27045 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555059 GiB | 555059 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562426 GiB | 562426 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450794 GiB | 450794 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     44 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107645 K  |  107645 K  |
|       from large pool |       2    |    1413    |   51499 K  |   51499 K  |
|       from small pool |       0    |    7148    |   56145 K  |   56145 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107645 K  |  107645 K  |
|       from large pool |       2    |    1413    |   51499 K  |   51499 K  |
|       from small pool |       0    |    7148    |   56145 K  |   56145 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3223    |   64619 K  |   64619 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3192    |   27045 K  |   27045 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683

 Experiment start at: 2024-08-07 04:52:51.537136
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.985816, 'precision': 0.98596376, 'recall': 0.98582304, 'specificity': 0.98582304, 'f1': 0.98581505, 'auroc': 0.99881136, 'binary_precision': 0.99463636, 'binary_recall': 0.97692245, 'binary_specificity': 0.99472356, 'binary_f1_score': 0.98569983}
confusion matrix:
       0      1
0  25262    134
1    587  24849
---- Validation: 
scalar performance:
{'acc': 0.86012965, 'precision': 0.5558233, 'recall': 0.7915123, 'specificity': 0.7915123, 'f1': 0.5644759, 'auroc': 0.886017, 'binary_precision': 0.11996904, 'binary_recall': 0.71925753, 'binary_specificity': 0.8637671, 'binary_f1_score': 0.20563847}
confusion matrix:
       0     1
0  14418  2274
1    121   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9281538, 'precision': 0.7410966, 'recall': 0.7396324, 'specificity': 0.7396324, 'f1': 0.74036163, 'auroc': 0.92135274, 'binary_precision': 0.5212766, 'binary_recall': 0.51783353, 'binary_specificity': 0.9614313, 'binary_f1_score': 0.51954937}
confusion matrix:
      0    1
0  8974  360
1   365  392
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 05:12:13.756734,epoch time: 0:19:22.219598,used: 0:19:22.219598,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.990144, 'precision': 0.99015415, 'recall': 0.99014574, 'specificity': 0.99014574, 'f1': 0.990144, 'auroc': 0.9994068, 'binary_precision': 0.99257183, 'binary_recall': 0.98769367, 'binary_specificity': 0.9925978, 'binary_f1_score': 0.9901268}
confusion matrix:
       0      1
0  25210    188
1    313  25121
---- Validation: 
scalar performance:
{'acc': 0.96717864, 'precision': 0.70785236, 'recall': 0.8893641, 'specificity': 0.8893641, 'f1': 0.76811135, 'auroc': 0.9535983, 'binary_precision': 0.42079806, 'binary_recall': 0.8074246, 'binary_specificity': 0.97130364, 'binary_f1_score': 0.5532592}
confusion matrix:
       0    1
0  16213  479
1     83  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9218115, 'precision': 0.7305901, 'recall': 0.8248166, 'specificity': 0.8248166, 'f1': 0.7669345, 'auroc': 0.9224441, 'binary_precision': 0.48555955, 'binary_recall': 0.71070015, 'binary_specificity': 0.93893296, 'binary_f1_score': 0.5769437}
confusion matrix:
      0    1
0  8764  570
1   219  538
better model found
persisted
after epoch: 2,now: 2024-08-07 05:30:32.965889,epoch time: 0:18:19.209155,used: 0:37:41.428753,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98451763, 'precision': 0.98496246, 'recall': 0.9845291, 'specificity': 0.9845291, 'f1': 0.98451436, 'auroc': 0.9994136, 'binary_precision': 0.99983776, 'binary_recall': 0.96921563, 'binary_specificity': 0.9998425, 'binary_f1_score': 0.9842886}
confusion matrix:
       0      1
0  25393      4
1    783  24652
---- Validation: 
scalar performance:
{'acc': 0.976114, 'precision': 0.77560765, 'recall': 0.6001112, 'specificity': 0.6001112, 'f1': 0.6443521, 'auroc': 0.9420804, 'binary_precision': 0.5714286, 'binary_recall': 0.20417634, 'binary_specificity': 0.996046, 'binary_f1_score': 0.30085468}
confusion matrix:
       0   1
0  16626  66
1    343  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92676646, 'precision': 0.74615026, 'recall': 0.5519467, 'specificity': 0.5519467, 'f1': 0.5734431, 'auroc': 0.9270829, 'binary_precision': 0.56, 'binary_recall': 0.110964336, 'binary_specificity': 0.9929291, 'binary_f1_score': 0.18522602}
confusion matrix:
      0   1
0  9268  66
1   673  84
better model found
persisted
after epoch: 3,now: 2024-08-07 05:48:58.447620,epoch time: 0:18:25.481731,used: 0:56:06.910484,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99333096, 'precision': 0.9933407, 'recall': 0.99333286, 'specificity': 0.99333286, 'f1': 0.99333096, 'auroc': 0.99962884, 'binary_precision': 0.99573344, 'binary_recall': 0.9909184, 'binary_specificity': 0.9957474, 'binary_f1_score': 0.99332005}
confusion matrix:
       0      1
0  25288    108
1    231  25205
---- Validation: 
scalar performance:
{'acc': 0.90504, 'precision': 0.59282756, 'recall': 0.87783504, 'specificity': 0.87783504, 'f1': 0.6297208, 'auroc': 0.9311025, 'binary_precision': 0.18993254, 'binary_recall': 0.8491879, 'binary_specificity': 0.90648216, 'binary_f1_score': 0.31043255}
confusion matrix:
       0     1
0  15131  1561
1     65   366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8938658, 'precision': 0.69610685, 'recall': 0.8831495, 'specificity': 0.8831495, 'f1': 0.7457515, 'auroc': 0.93175465, 'binary_precision': 0.40379903, 'binary_recall': 0.87054163, 'binary_specificity': 0.89575744, 'binary_f1_score': 0.5516953}
confusion matrix:
      0    1
0  8361  973
1    98  659
early stop counter: 1
val acc:0.9050400257110596, best validation acc: 0.9761139750480652, corresponding to test acc:                         0.9267664551734924 / 0.9281538128852844
after epoch: 4,now: 2024-08-07 06:07:27.731767,epoch time: 0:18:29.284147,used: 1:14:36.194631,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9905768, 'precision': 0.9907005, 'recall': 0.9905842, 'specificity': 0.9905842, 'f1': 0.9905763, 'auroc': 0.9995142, 'binary_precision': 0.99872124, 'binary_recall': 0.98242855, 'binary_specificity': 0.99873984, 'binary_f1_score': 0.9905079}
confusion matrix:
       0      1
0  25361     32
1    447  24992
---- Validation: 
scalar performance:
{'acc': 0.97973484, 'precision': 0.7892736, 'recall': 0.82121515, 'specificity': 0.82121515, 'f1': 0.80434513, 'auroc': 0.9618796, 'binary_precision': 0.5875, 'binary_recall': 0.65429235, 'binary_specificity': 0.988138, 'binary_f1_score': 0.61909986}
confusion matrix:
       0    1
0  16494  198
1    149  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9130909, 'precision': 0.7151415, 'recall': 0.8364898, 'specificity': 0.8364898, 'f1': 0.7573881, 'auroc': 0.91856396, 'binary_precision': 0.452, 'binary_recall': 0.7463672, 'binary_specificity': 0.9266124, 'binary_f1_score': 0.56302935}
confusion matrix:
      0    1
0  8649  685
1   192  565
better model found
persisted
after epoch: 5,now: 2024-08-07 06:25:55.707898,epoch time: 0:18:27.976131,used: 1:33:04.170762,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99370474, 'precision': 0.993706, 'recall': 0.9937055, 'specificity': 0.9937055, 'f1': 0.99370474, 'auroc': 0.9997258, 'binary_precision': 0.99472106, 'binary_recall': 0.9926875, 'binary_specificity': 0.99472356, 'binary_f1_score': 0.99370325}
confusion matrix:
       0      1
0  25262    134
1    186  25250
---- Validation: 
scalar performance:
{'acc': 0.9724931, 'precision': 0.7311736, 'recall': 0.8491447, 'specificity': 0.8491447, 'f1': 0.77704, 'auroc': 0.95492166, 'binary_precision': 0.46969697, 'binary_recall': 0.71925753, 'binary_specificity': 0.97903186, 'binary_f1_score': 0.568286}
confusion matrix:
       0    1
0  16342  350
1    121  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9082351, 'precision': 0.71416914, 'recall': 0.879992, 'specificity': 0.879992, 'f1': 0.76454854, 'auroc': 0.92397106, 'binary_precision': 0.4417643, 'binary_recall': 0.84676355, 'binary_specificity': 0.91322047, 'binary_f1_score': 0.58061594}
confusion matrix:
      0    1
0  8524  810
1   116  641
early stop counter: 1
val acc:0.9724931120872498, best validation acc: 0.9797348380088806, corresponding to test acc:                         0.9130908846855164 / 0.9281538128852844
after epoch: 6,now: 2024-08-07 06:44:26.180644,epoch time: 0:18:30.472746,used: 1:51:34.643508,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9940982, 'precision': 0.99410105, 'recall': 0.9940993, 'specificity': 0.9940993, 'f1': 0.9940982, 'auroc': 0.9997326, 'binary_precision': 0.99550545, 'binary_recall': 0.9926875, 'binary_specificity': 0.9955111, 'binary_f1_score': 0.99409443}
confusion matrix:
       0      1
0  25282    114
1    186  25250
---- Validation: 
scalar performance:
{'acc': 0.9777492, 'precision': 0.769899, 'recall': 0.81906664, 'specificity': 0.81906664, 'f1': 0.79226494, 'auroc': 0.9609276, 'binary_precision': 0.5488281, 'binary_recall': 0.6519722, 'binary_specificity': 0.98616105, 'binary_f1_score': 0.59597033}
confusion matrix:
       0    1
0  16461  231
1    150  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9146764, 'precision': 0.7217242, 'recall': 0.86283815, 'specificity': 0.86283815, 'f1': 0.76875484, 'auroc': 0.93288994, 'binary_precision': 0.46054628, 'binary_recall': 0.8018494, 'binary_specificity': 0.9238269, 'binary_f1_score': 0.58506024}
confusion matrix:
      0    1
0  8623  711
1   150  607
early stop counter: 2
val acc:0.977749228477478, best validation acc: 0.9797348380088806, corresponding to test acc:                         0.9130908846855164 / 0.9281538128852844
after epoch: 7,now: 2024-08-07 07:02:47.881264,epoch time: 0:18:21.700620,used: 2:09:56.344128,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99484575, 'precision': 0.9948766, 'recall': 0.9948494, 'specificity': 0.9948494, 'f1': 0.99484575, 'auroc': 0.9998212, 'binary_precision': 0.99900895, 'binary_recall': 0.99068326, 'binary_specificity': 0.9990155, 'binary_f1_score': 0.9948287}
confusion matrix:
       0      1
0  25369     25
1    237  25201
---- Validation: 
scalar performance:
{'acc': 0.9819541, 'precision': 0.8491906, 'recall': 0.7353328, 'specificity': 0.7353328, 'f1': 0.78051007, 'auroc': 0.96531796, 'binary_precision': 0.7118056, 'binary_recall': 0.47563806, 'binary_specificity': 0.99502754, 'binary_f1_score': 0.5702365}
confusion matrix:
       0    1
0  16609   83
1    226  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9171539, 'precision': 0.72130674, 'recall': 0.82715434, 'specificity': 0.82715434, 'f1': 0.760296, 'auroc': 0.92996466, 'binary_precision': 0.46626815, 'binary_recall': 0.7212682, 'binary_specificity': 0.9330405, 'binary_f1_score': 0.56639004}
confusion matrix:
      0    1
0  8709  625
1   211  546
better model found
persisted
after epoch: 8,now: 2024-08-07 07:21:14.409471,epoch time: 0:18:26.528207,used: 2:28:22.872335,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9942556, 'precision': 0.99426734, 'recall': 0.9942541, 'specificity': 0.9942541, 'f1': 0.99425554, 'auroc': 0.99985063, 'binary_precision': 0.99201536, 'binary_recall': 0.99653995, 'binary_specificity': 0.9919682, 'binary_f1_score': 0.99427253}
confusion matrix:
       0      1
0  25195    204
1     88  25345
---- Validation: 
scalar performance:
{'acc': 0.94510305, 'precision': 0.6484935, 'recall': 0.916466, 'specificity': 0.916466, 'f1': 0.7097356, 'auroc': 0.9575485, 'binary_precision': 0.30007854, 'binary_recall': 0.8863109, 'binary_specificity': 0.9466211, 'binary_f1_score': 0.44835678}
confusion matrix:
       0    1
0  15801  891
1     49  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91606385, 'precision': 0.7246165, 'recall': 0.8666228, 'specificity': 0.8666228, 'f1': 0.7721259, 'auroc': 0.9259987, 'binary_precision': 0.46575344, 'binary_recall': 0.80845445, 'binary_specificity': 0.9247911, 'binary_f1_score': 0.5910189}
confusion matrix:
      0    1
0  8632  702
1   145  612
early stop counter: 1
val acc:0.9451030492782593, best validation acc: 0.9819540977478027, corresponding to test acc:                         0.9171538949012756 / 0.9281538128852844
after epoch: 9,now: 2024-08-07 07:39:44.075229,epoch time: 0:18:29.665758,used: 2:46:52.538093,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.995554, 'precision': 0.9955597, 'recall': 0.9955554, 'specificity': 0.9955554, 'f1': 0.995554, 'auroc': 0.999812, 'binary_precision': 0.9974348, 'binary_recall': 0.99367017, 'binary_specificity': 0.99744064, 'binary_f1_score': 0.9955489}
confusion matrix:
       0      1
0  25332     65
1    161  25274
---- Validation: 
scalar performance:
{'acc': 0.97728205, 'precision': 0.76395583, 'recall': 0.8730736, 'specificity': 0.8730736, 'f1': 0.80837256, 'auroc': 0.95814395, 'binary_precision': 0.53409094, 'binary_recall': 0.76334107, 'binary_specificity': 0.98280615, 'binary_f1_score': 0.6284623}
confusion matrix:
       0    1
0  16405  287
1    102  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9101179, 'precision': 0.7150544, 'recall': 0.86765724, 'specificity': 0.86765724, 'f1': 0.76343524, 'auroc': 0.9248246, 'binary_precision': 0.4459654, 'binary_recall': 0.81770146, 'binary_specificity': 0.917613, 'binary_f1_score': 0.5771561}
confusion matrix:
      0    1
0  8565  769
1   138  619
early stop counter: 2
val acc:0.9772820472717285, best validation acc: 0.9819540977478027, corresponding to test acc:                         0.9171538949012756 / 0.9281538128852844
after epoch: 10,now: 2024-08-07 07:58:12.318263,epoch time: 0:18:28.243034,used: 3:05:20.781127,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9927998, 'precision': 0.9928807, 'recall': 0.99280417, 'specificity': 0.99280417, 'f1': 0.9927995, 'auroc': 0.9996918, 'binary_precision': 0.9993625, 'binary_recall': 0.98623836, 'binary_specificity': 0.99937004, 'binary_f1_score': 0.992757}
confusion matrix:
       0      1
0  25383     16
1    350  25083
---- Validation: 
scalar performance:
{'acc': 0.9837645, 'precision': 0.8648312, 'recall': 0.77016556, 'specificity': 0.77016556, 'f1': 0.81002164, 'auroc': 0.96893656, 'binary_precision': 0.7413249, 'binary_recall': 0.5452436, 'binary_specificity': 0.99508744, 'binary_f1_score': 0.6283422}
confusion matrix:
       0    1
0  16610   82
1    196  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92062235, 'precision': 0.7128185, 'recall': 0.7058215, 'specificity': 0.7058215, 'f1': 0.70924294, 'auroc': 0.92076933, 'binary_precision': 0.46986303, 'binary_recall': 0.45310435, 'binary_specificity': 0.95853865, 'binary_f1_score': 0.46133152}
confusion matrix:
      0    1
0  8947  387
1   414  343
better model found
persisted
after epoch: 11,now: 2024-08-07 08:16:38.525889,epoch time: 0:18:26.207626,used: 3:23:46.988753,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9946097, 'precision': 0.9946356, 'recall': 0.9946127, 'specificity': 0.9946127, 'f1': 0.9946097, 'auroc': 0.99986863, 'binary_precision': 0.99841535, 'binary_recall': 0.99080044, 'binary_specificity': 0.99842495, 'binary_f1_score': 0.9945933}
confusion matrix:
       0      1
0  25356     40
1    234  25202
---- Validation: 
scalar performance:
{'acc': 0.97920924, 'precision': 0.7803755, 'recall': 0.85711, 'specificity': 0.85711, 'f1': 0.81375426, 'auroc': 0.9696971, 'binary_precision': 0.5678119, 'binary_recall': 0.7285383, 'binary_specificity': 0.9856818, 'binary_f1_score': 0.63821137}
confusion matrix:
       0    1
0  16453  239
1    117  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9159647, 'precision': 0.7133119, 'recall': 0.78827465, 'specificity': 0.78827465, 'f1': 0.7431788, 'auroc': 0.9242967, 'binary_precision': 0.45695364, 'binary_recall': 0.6380449, 'binary_specificity': 0.9385044, 'binary_f1_score': 0.5325248}
confusion matrix:
      0    1
0  8760  574
1   274  483
early stop counter: 1
val acc:0.9792092442512512, best validation acc: 0.9837645292282104, corresponding to test acc:                         0.9206223487854004 / 0.9281538128852844
after epoch: 12,now: 2024-08-07 08:35:11.604277,epoch time: 0:18:33.078388,used: 3:42:20.067141,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99120635, 'precision': 0.991346, 'recall': 0.99121207, 'specificity': 0.99121207, 'f1': 0.9912058, 'auroc': 0.99966633, 'binary_precision': 0.99979997, 'binary_recall': 0.982621, 'binary_specificity': 0.9998031, 'binary_f1_score': 0.9911361}
confusion matrix:
       0      1
0  25394      5
1    442  24991
---- Validation: 
scalar performance:
{'acc': 0.9779244, 'precision': 0.88506544, 'recall': 0.58295757, 'specificity': 0.58295757, 'f1': 0.6323267, 'auroc': 0.9344015, 'binary_precision': 0.7912088, 'binary_recall': 0.16705337, 'binary_specificity': 0.99886173, 'binary_f1_score': 0.2758621}
confusion matrix:
       0   1
0  16673  19
1    359  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.71656907, 'recall': 0.5576588, 'specificity': 0.5576588, 'f1': 0.58063906, 'auroc': 0.9067142, 'binary_precision': 0.5, 'binary_recall': 0.12549537, 'binary_specificity': 0.98982215, 'binary_f1_score': 0.20063357}
confusion matrix:
      0   1
0  9239  95
1   662  95
early stop counter: 2
val acc:0.9779244065284729, best validation acc: 0.9837645292282104, corresponding to test acc:                         0.9206223487854004 / 0.9281538128852844
after epoch: 13,now: 2024-08-07 08:53:44.494347,epoch time: 0:18:32.890070,used: 4:00:52.957211,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9951015, 'precision': 0.99512815, 'recall': 0.9951047, 'specificity': 0.9951047, 'f1': 0.99510145, 'auroc': 0.99986017, 'binary_precision': 0.9989699, 'binary_recall': 0.9912332, 'binary_specificity': 0.9989762, 'binary_f1_score': 0.99508655}
confusion matrix:
       0      1
0  25369     26
1    223  25214
---- Validation: 
scalar performance:
{'acc': 0.9805525, 'precision': 0.7900525, 'recall': 0.88040173, 'specificity': 0.88040173, 'f1': 0.8286581, 'auroc': 0.9674034, 'binary_precision': 0.5859649, 'binary_recall': 0.774942, 'binary_specificity': 0.9858615, 'binary_f1_score': 0.6673327}
confusion matrix:
       0    1
0  16456  236
1     97  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9115053, 'precision': 0.7136078, 'recall': 0.8441298, 'specificity': 0.8441298, 'f1': 0.75767493, 'auroc': 0.9153187, 'binary_precision': 0.44744977, 'binary_recall': 0.7648613, 'binary_specificity': 0.9233983, 'binary_f1_score': 0.5646026}
confusion matrix:
      0    1
0  8619  715
1   178  579
early stop counter: 3
val acc:0.9805524945259094, best validation acc: 0.9837645292282104, corresponding to test acc:                         0.9206223487854004 / 0.9281538128852844
after epoch: 14,now: 2024-08-07 09:11:55.459783,epoch time: 0:18:10.965436,used: 4:19:03.922647,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9959474, 'precision': 0.9959475, 'recall': 0.99594736, 'specificity': 0.99594736, 'f1': 0.9959474, 'auroc': 0.99983084, 'binary_precision': 0.9958725, 'binary_recall': 0.9960291, 'binary_specificity': 0.99586564, 'binary_f1_score': 0.99595076}
confusion matrix:
       0      1
0  25292    105
1    101  25334
---- Validation: 
scalar performance:
{'acc': 0.97728205, 'precision': 0.7642, 'recall': 0.8629024, 'specificity': 0.8629024, 'f1': 0.8051261, 'auroc': 0.94889486, 'binary_precision': 0.53511703, 'binary_recall': 0.7424594, 'binary_specificity': 0.9833453, 'binary_f1_score': 0.6219631}
confusion matrix:
       0    1
0  16414  278
1    111  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91120803, 'precision': 0.70916307, 'recall': 0.8196917, 'specificity': 0.8196917, 'f1': 0.7484451, 'auroc': 0.9137891, 'binary_precision': 0.44289237, 'binary_recall': 0.7120211, 'binary_specificity': 0.9273623, 'binary_f1_score': 0.5460993}
confusion matrix:
      0    1
0  8656  678
1   218  539
early stop counter: 4
val acc:0.9772820472717285, best validation acc: 0.9837645292282104, corresponding to test acc:                         0.9206223487854004 / 0.9281538128852844
after epoch: 15,now: 2024-08-07 09:30:07.549015,epoch time: 0:18:12.089232,used: 4:37:16.011879,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99636054, 'precision': 0.9963697, 'recall': 0.9963627, 'specificity': 0.9963627, 'f1': 0.99636054, 'auroc': 0.9998274, 'binary_precision': 0.9987361, 'binary_recall': 0.9939856, 'binary_specificity': 0.99873984, 'binary_f1_score': 0.9963552}
confusion matrix:
       0      1
0  25361     32
1    153  25286
---- Validation: 
scalar performance:
{'acc': 0.98440695, 'precision': 0.86195594, 'recall': 0.79535806, 'specificity': 0.79535806, 'f1': 0.8250761, 'auroc': 0.97101575, 'binary_precision': 0.7342857, 'binary_recall': 0.5962877, 'binary_specificity': 0.99442846, 'binary_f1_score': 0.6581306}
confusion matrix:
       0    1
0  16599   93
1    174  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91318995, 'precision': 0.7160585, 'recall': 0.84139884, 'specificity': 0.84139884, 'f1': 0.7592639, 'auroc': 0.9248594, 'binary_precision': 0.45296443, 'binary_recall': 0.7569353, 'binary_specificity': 0.92586243, 'binary_f1_score': 0.5667656}
confusion matrix:
      0    1
0  8642  692
1   184  573
better model found
persisted
after epoch: 16,now: 2024-08-07 09:48:37.977665,epoch time: 0:18:30.428650,used: 4:55:46.440529,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9881177, 'precision': 0.9882792, 'recall': 0.98811173, 'specificity': 0.98811173, 'f1': 0.9881166, 'auroc': 0.9997264, 'binary_precision': 0.979565, 'binary_recall': 0.99705106, 'binary_specificity': 0.9791724, 'binary_f1_score': 0.98823065}
confusion matrix:
       0      1
0  24870    529
1     75  25358
---- Validation: 
scalar performance:
{'acc': 0.82286984, 'precision': 0.5569143, 'recall': 0.86846316, 'specificity': 0.86846316, 'f1': 0.5534749, 'auroc': 0.9376327, 'binary_precision': 0.11645047, 'binary_recall': 0.9164733, 'binary_specificity': 0.8204529, 'binary_f1_score': 0.206644}
confusion matrix:
       0     1
0  13695  2997
1     36   395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.44723022, 'precision': 0.5509667, 'recall': 0.67328095, 'specificity': 0.67328095, 'f1': 0.38999504, 'auroc': 0.85923094, 'binary_precision': 0.113887556, 'binary_recall': 0.93923384, 'binary_specificity': 0.40732804, 'binary_f1_score': 0.20314285}
confusion matrix:
      0     1
0  3802  5532
1    46   711
early stop counter: 1
val acc:0.8228698372840881, best validation acc: 0.9844069480895996, corresponding to test acc:                         0.9131899476051331 / 0.9281538128852844
after epoch: 17,now: 2024-08-07 10:07:02.266856,epoch time: 0:18:24.289191,used: 5:14:10.729720,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9972065, 'precision': 0.9972094, 'recall': 0.9972075, 'specificity': 0.9972075, 'f1': 0.99720645, 'auroc': 0.9999082, 'binary_precision': 0.99862003, 'binary_recall': 0.9957932, 'binary_specificity': 0.9986219, 'binary_f1_score': 0.9972046}
confusion matrix:
       0      1
0  25362     35
1    107  25328
---- Validation: 
scalar performance:
{'acc': 0.9330141, 'precision': 0.6290358, 'recall': 0.9193066, 'specificity': 0.9193066, 'f1': 0.6846422, 'auroc': 0.96256423, 'binary_precision': 0.2606952, 'binary_recall': 0.9048724, 'binary_specificity': 0.93374074, 'binary_f1_score': 0.40477425}
confusion matrix:
       0     1
0  15586  1106
1     41   390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85759586, 'precision': 0.6610266, 'recall': 0.87264776, 'specificity': 0.87264776, 'f1': 0.70071054, 'auroc': 0.9226373, 'binary_precision': 0.33234715, 'binary_recall': 0.89035666, 'binary_specificity': 0.8549389, 'binary_f1_score': 0.48402154}
confusion matrix:
      0     1
0  7980  1354
1    83   674
early stop counter: 2
val acc:0.9330140948295593, best validation acc: 0.9844069480895996, corresponding to test acc:                         0.9131899476051331 / 0.9281538128852844
after epoch: 18,now: 2024-08-07 10:25:11.168577,epoch time: 0:18:08.901721,used: 5:32:19.631441,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9966163, 'precision': 0.9966163, 'recall': 0.9966166, 'specificity': 0.9966166, 'f1': 0.9966163, 'auroc': 0.99988437, 'binary_precision': 0.99697053, 'binary_recall': 0.996265, 'binary_specificity': 0.99696815, 'binary_f1_score': 0.9966176}
confusion matrix:
       0      1
0  25320     77
1     95  25340
---- Validation: 
scalar performance:
{'acc': 0.9708579, 'precision': 0.72035724, 'recall': 0.83474433, 'specificity': 0.83474433, 'f1': 0.76461995, 'auroc': 0.9506161, 'binary_precision': 0.44879517, 'binary_recall': 0.6914153, 'binary_specificity': 0.9780733, 'binary_f1_score': 0.5442922}
confusion matrix:
       0    1
0  16326  366
1    133  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9005054, 'precision': 0.7012938, 'recall': 0.86731666, 'specificity': 0.86731666, 'f1': 0.74967223, 'auroc': 0.9288447, 'binary_precision': 0.4177215, 'binary_recall': 0.8282695, 'binary_specificity': 0.90636384, 'binary_f1_score': 0.5553587}
confusion matrix:
      0    1
0  8460  874
1   130  627
early stop counter: 3
val acc:0.9708579182624817, best validation acc: 0.9844069480895996, corresponding to test acc:                         0.9131899476051331 / 0.9281538128852844
after epoch: 19,now: 2024-08-07 10:43:18.058108,epoch time: 0:18:06.889531,used: 5:50:26.520972,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9968524, 'precision': 0.9968531, 'recall': 0.9968531, 'specificity': 0.9968531, 'f1': 0.9968524, 'auroc': 0.9998852, 'binary_precision': 0.9977159, 'binary_recall': 0.9959901, 'binary_specificity': 0.99771607, 'binary_f1_score': 0.9968523}
confusion matrix:
       0      1
0  25337     58
1    102  25335
---- Validation: 
scalar performance:
{'acc': 0.975822, 'precision': 0.75351775, 'recall': 0.87006444, 'specificity': 0.87006444, 'f1': 0.7999407, 'auroc': 0.96499133, 'binary_precision': 0.5133438, 'binary_recall': 0.75870067, 'binary_specificity': 0.9814282, 'binary_f1_score': 0.6123596}
confusion matrix:
       0    1
0  16382  310
1    104  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8186503, 'precision': 0.63097286, 'recall': 0.84067094, 'specificity': 0.84067094, 'f1': 0.65508705, 'auroc': 0.9052443, 'binary_precision': 0.2750524, 'binary_recall': 0.8665786, 'binary_specificity': 0.81476325, 'binary_f1_score': 0.41756842}
confusion matrix:
      0     1
0  7605  1729
1   101   656
early stop counter: 4
val acc:0.9758219718933105, best validation acc: 0.9844069480895996, corresponding to test acc:                         0.9131899476051331 / 0.9281538128852844
after epoch: 20,now: 2024-08-07 11:01:26.721271,epoch time: 0:18:08.663163,used: 6:08:35.184135,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_04_52_51_seed_1_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:08:35.184135 at 2024-08-07 11:01:26.721271
persisted model performance metric: 

scalar performance:
{'acc': 0.91318995, 'precision': 0.7160585, 'recall': 0.84139884, 'specificity': 0.84139884, 'f1': 0.7592639, 'auroc': 0.9248594, 'binary_precision': 0.45296443, 'binary_recall': 0.7569353, 'binary_specificity': 0.92586243, 'binary_f1_score': 0.5667656}
confusion matrix:
      0    1
0  8642  692
1   184  573
oracle model performance metric: 

scalar performance:
{'acc': 0.9281538, 'precision': 0.7410966, 'recall': 0.7396324, 'specificity': 0.7396324, 'f1': 0.74036163, 'auroc': 0.92135274, 'binary_precision': 0.5212766, 'binary_recall': 0.51783353, 'binary_specificity': 0.9614313, 'binary_f1_score': 0.51954937}
confusion matrix:
      0    1
0  8974  360
1   365  392
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |  40858 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  28102 MiB |  13630 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  28014 MiB |  13608 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool | 455249 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |  10843 KiB |     44 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7359    |  216543 K  |  216538 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112783 K  |  112778 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7359    |  216543 K  |  216538 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112783 K  |  112778 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1212    |     577    |
|       from large pool |     602    |     602    |    1168    |     566    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3240    |  127857 K  |  127857 K  |
|       from large pool |      36    |     605    |   73199 K  |   73199 K  |
|       from small pool |      38    |    3204    |   54658 K  |   54658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     44 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216543 K  |  216543 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112783 K  |  112783 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216543 K  |  216543 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112783 K  |  112783 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3240    |  127859 K  |  127859 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3204    |   54660 K  |   54660 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     44 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216543 K  |  216543 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112783 K  |  112783 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216543 K  |  216543 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112783 K  |  112783 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3240    |  127859 K  |  127859 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3204    |   54660 K  |   54660 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683

 Experiment start at: 2024-08-07 11:23:56.153375
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9645234, 'precision': 0.9660654, 'recall': 0.9645167, 'specificity': 0.9645167, 'f1': 0.96449363, 'auroc': 0.9981437, 'binary_precision': 0.93931526, 'binary_recall': 0.99323124, 'binary_specificity': 0.93580216, 'binary_f1_score': 0.9655211}
confusion matrix:
       0      1
0  24183   1659
1    175  25679
---- Validation: 
scalar performance:
{'acc': 0.8224714, 'precision': 0.5535867, 'recall': 0.85536754, 'specificity': 0.85536754, 'f1': 0.5484137, 'auroc': 0.9311882, 'binary_precision': 0.110516936, 'binary_recall': 0.8899522, 'binary_specificity': 0.82078296, 'binary_f1_score': 0.19661734}
confusion matrix:
       0     1
0  13712  2994
1     46   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8132184, 'precision': 0.6359621, 'recall': 0.84927523, 'specificity': 0.84927523, 'f1': 0.6591533, 'auroc': 0.9081773, 'binary_precision': 0.28326693, 'binary_recall': 0.8920954, 'binary_specificity': 0.8064551, 'binary_f1_score': 0.429997}
confusion matrix:
      0     1
0  7496  1799
1    86   711
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 11:44:01.778395,epoch time: 0:20:05.625020,used: 0:20:05.625020,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98777467, 'precision': 0.9877795, 'recall': 0.98777455, 'specificity': 0.98777455, 'f1': 0.9877746, 'auroc': 0.9991064, 'binary_precision': 0.9862707, 'binary_recall': 0.989323, 'binary_specificity': 0.9862261, 'binary_f1_score': 0.98779446}
confusion matrix:
       0      1
0  25490    356
1    276  25574
---- Validation: 
scalar performance:
{'acc': 0.96338475, 'precision': 0.6889863, 'recall': 0.8914336, 'specificity': 0.8914336, 'f1': 0.7509866, 'auroc': 0.9501338, 'binary_precision': 0.38271606, 'binary_recall': 0.81578946, 'binary_specificity': 0.9670777, 'binary_f1_score': 0.5210084}
confusion matrix:
       0    1
0  16156  550
1     77  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91161317, 'precision': 0.72492296, 'recall': 0.8705717, 'specificity': 0.8705717, 'f1': 0.77265424, 'auroc': 0.9214785, 'binary_precision': 0.46619216, 'binary_recall': 0.8218319, 'binary_specificity': 0.91931146, 'binary_f1_score': 0.59491366}
confusion matrix:
      0    1
0  8545  750
1   142  655
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 12:03:06.998465,epoch time: 0:19:05.220070,used: 0:39:10.845090,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9928428, 'precision': 0.9928428, 'recall': 0.9928428, 'specificity': 0.9928428, 'f1': 0.9928428, 'auroc': 0.9995404, 'binary_precision': 0.99272925, 'binary_recall': 0.9929597, 'binary_specificity': 0.99272585, 'binary_f1_score': 0.99284446}
confusion matrix:
       0      1
0  25657    188
1    182  25669
---- Validation: 
scalar performance:
{'acc': 0.94323754, 'precision': 0.635309, 'recall': 0.8799417, 'specificity': 0.8799417, 'f1': 0.69090134, 'auroc': 0.9417655, 'binary_precision': 0.27552673, 'binary_recall': 0.8133971, 'binary_specificity': 0.9464863, 'binary_f1_score': 0.41162226}
confusion matrix:
       0    1
0  15812  894
1     78  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9203329, 'precision': 0.73797035, 'recall': 0.84892166, 'specificity': 0.84892166, 'f1': 0.77905273, 'auroc': 0.92234993, 'binary_precision': 0.49714285, 'binary_recall': 0.76411545, 'binary_specificity': 0.9337278, 'binary_f1_score': 0.60237384}
confusion matrix:
      0    1
0  8679  616
1   188  609
new oracle model saved
early stop counter: 1
val acc:0.9432375431060791, best validation acc: 0.963384747505188, corresponding to test acc:                         0.9116131663322449 / 0.9203329086303711
after epoch: 3,now: 2024-08-07 12:22:13.078472,epoch time: 0:19:06.080007,used: 0:58:16.925097,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.990831, 'precision': 0.99086785, 'recall': 0.990831, 'specificity': 0.990831, 'f1': 0.99083084, 'auroc': 0.99929285, 'binary_precision': 0.9951218, 'binary_recall': 0.986498, 'binary_specificity': 0.99516404, 'binary_f1_score': 0.9907911}
confusion matrix:
       0      1
0  25723    125
1    349  25499
---- Validation: 
scalar performance:
{'acc': 0.942712, 'precision': 0.6345232, 'recall': 0.8808386, 'specificity': 0.8808386, 'f1': 0.68999815, 'auroc': 0.9324641, 'binary_precision': 0.2738956, 'binary_recall': 0.81578946, 'binary_specificity': 0.9458877, 'binary_f1_score': 0.41010222}
confusion matrix:
       0    1
0  15802  904
1     77  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8661316, 'precision': 0.66497606, 'recall': 0.83727753, 'specificity': 0.83727753, 'f1': 0.7047701, 'auroc': 0.88095295, 'binary_precision': 0.348964, 'binary_recall': 0.8030113, 'binary_specificity': 0.8715438, 'binary_f1_score': 0.48650703}
confusion matrix:
      0     1
0  8101  1194
1   157   640
early stop counter: 2
val acc:0.9427120089530945, best validation acc: 0.963384747505188, corresponding to test acc:                         0.9116131663322449 / 0.9203329086303711
after epoch: 4,now: 2024-08-07 12:41:17.218345,epoch time: 0:19:04.139873,used: 1:17:21.064970,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99301684, 'precision': 0.99303216, 'recall': 0.9930171, 'specificity': 0.9930171, 'f1': 0.9930167, 'auroc': 0.99963045, 'binary_precision': 0.99579847, 'binary_recall': 0.99021274, 'binary_specificity': 0.9958214, 'binary_f1_score': 0.9929977}
confusion matrix:
       0      1
0  25738    108
1    253  25597
---- Validation: 
scalar performance:
{'acc': 0.9682901, 'precision': 0.702849, 'recall': 0.84263295, 'specificity': 0.84263295, 'f1': 0.753014, 'auroc': 0.94286007, 'binary_precision': 0.41307372, 'binary_recall': 0.7105263, 'binary_specificity': 0.9747396, 'binary_f1_score': 0.52242744}
confusion matrix:
       0    1
0  16284  422
1    121  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8977408, 'precision': 0.7072085, 'recall': 0.8825418, 'specificity': 0.8825418, 'f1': 0.756861, 'auroc': 0.9317038, 'binary_precision': 0.42715436, 'binary_recall': 0.8644918, 'binary_specificity': 0.90059173, 'binary_f1_score': 0.5717842}
confusion matrix:
      0    1
0  8371  924
1   108  689
better model found
persisted
after epoch: 5,now: 2024-08-07 13:00:15.493140,epoch time: 0:18:58.274795,used: 1:36:19.339765,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99435157, 'precision': 0.9943992, 'recall': 0.9943526, 'specificity': 0.9943526, 'f1': 0.99435145, 'auroc': 0.9996568, 'binary_precision': 0.9992968, 'binary_recall': 0.98940164, 'binary_specificity': 0.99930346, 'binary_f1_score': 0.99432456}
confusion matrix:
       0      1
0  25825     18
1    274  25579
---- Validation: 
scalar performance:
{'acc': 0.976349, 'precision': 0.75317335, 'recall': 0.6799905, 'specificity': 0.6799905, 'f1': 0.70995027, 'auroc': 0.94921577, 'binary_precision': 0.5220339, 'binary_recall': 0.36842105, 'binary_specificity': 0.9915599, 'binary_f1_score': 0.43197754}
confusion matrix:
       0    1
0  16565  141
1    264  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9095323, 'precision': 0.7158568, 'recall': 0.8321606, 'specificity': 0.8321606, 'f1': 0.7566585, 'auroc': 0.9192594, 'binary_precision': 0.45524693, 'binary_recall': 0.74027604, 'binary_specificity': 0.9240452, 'binary_f1_score': 0.563784}
confusion matrix:
      0    1
0  8589  706
1   207  590
better model found
persisted
after epoch: 6,now: 2024-08-07 13:19:11.862748,epoch time: 0:18:56.369608,used: 1:55:15.709373,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99317163, 'precision': 0.99320203, 'recall': 0.9931729, 'specificity': 0.9931729, 'f1': 0.9931715, 'auroc': 0.9996332, 'binary_precision': 0.9971539, 'binary_recall': 0.9891708, 'binary_specificity': 0.9971749, 'binary_f1_score': 0.9931463}
confusion matrix:
       0      1
0  25767     73
1    280  25576
---- Validation: 
scalar performance:
{'acc': 0.98137116, 'precision': 0.8237337, 'recall': 0.74087656, 'specificity': 0.74087656, 'f1': 0.775847, 'auroc': 0.9543406, 'binary_precision': 0.66019416, 'binary_recall': 0.48803827, 'binary_specificity': 0.9937148, 'binary_f1_score': 0.56121045}
confusion matrix:
       0    1
0  16601  105
1    214  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91181135, 'precision': 0.7217235, 'recall': 0.84544265, 'specificity': 0.84544265, 'f1': 0.7646755, 'auroc': 0.9219141, 'binary_precision': 0.46463877, 'binary_recall': 0.76662487, 'binary_specificity': 0.9242604, 'binary_f1_score': 0.5785985}
confusion matrix:
      0    1
0  8591  704
1   186  611
better model found
persisted
after epoch: 7,now: 2024-08-07 13:38:26.035721,epoch time: 0:19:14.172973,used: 2:14:29.882346,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9926687, 'precision': 0.99272084, 'recall': 0.9926691, 'specificity': 0.9926691, 'f1': 0.9926685, 'auroc': 0.9997333, 'binary_precision': 0.997811, 'binary_recall': 0.98750484, 'binary_specificity': 0.9978333, 'binary_f1_score': 0.9926312}
confusion matrix:
       0      1
0  25790     56
1    323  25527
---- Validation: 
scalar performance:
{'acc': 0.97185236, 'precision': 0.7242886, 'recall': 0.8712822, 'specificity': 0.8712822, 'f1': 0.7779298, 'auroc': 0.95384663, 'binary_precision': 0.45454547, 'binary_recall': 0.76555026, 'binary_specificity': 0.97701424, 'binary_f1_score': 0.57041}
confusion matrix:
       0    1
0  16322  384
1     98  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9179548, 'precision': 0.7275417, 'recall': 0.79773086, 'specificity': 0.79773086, 'f1': 0.756238, 'auroc': 0.9065391, 'binary_precision': 0.4855814, 'binary_recall': 0.6549561, 'binary_specificity': 0.9405056, 'binary_f1_score': 0.5576923}
confusion matrix:
      0    1
0  8742  553
1   275  522
early stop counter: 1
val acc:0.9718523621559143, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9203329086303711
after epoch: 8,now: 2024-08-07 13:57:10.810627,epoch time: 0:18:44.774906,used: 2:33:14.657252,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9929008, 'precision': 0.992938, 'recall': 0.9929003, 'specificity': 0.9929003, 'f1': 0.99290067, 'auroc': 0.9997084, 'binary_precision': 0.988686, 'binary_recall': 0.9972148, 'binary_specificity': 0.9885858, 'binary_f1_score': 0.9929321}
confusion matrix:
       0      1
0  25550    295
1     72  25779
---- Validation: 
scalar performance:
{'acc': 0.96928287, 'precision': 0.7092202, 'recall': 0.85480416, 'specificity': 0.85480416, 'f1': 0.76135457, 'auroc': 0.9540261, 'binary_precision': 0.42520776, 'binary_recall': 0.73444974, 'binary_specificity': 0.97515863, 'binary_f1_score': 0.5385965}
confusion matrix:
       0    1
0  16291  415
1    111  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9130004, 'precision': 0.72029763, 'recall': 0.8202779, 'specificity': 0.8202779, 'f1': 0.75743663, 'auroc': 0.8990456, 'binary_precision': 0.4666117, 'binary_recall': 0.7101631, 'binary_specificity': 0.9303927, 'binary_f1_score': 0.5631841}
confusion matrix:
      0    1
0  8648  647
1   231  566
early stop counter: 2
val acc:0.969282865524292, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9203329086303711
after epoch: 9,now: 2024-08-07 14:16:21.372506,epoch time: 0:19:10.561879,used: 2:52:25.219131,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9928621, 'precision': 0.9929564, 'recall': 0.992864, 'specificity': 0.992864, 'f1': 0.9928618, 'auroc': 0.99982023, 'binary_precision': 0.9998431, 'binary_recall': 0.9858828, 'binary_specificity': 0.9998452, 'binary_f1_score': 0.99281394}
confusion matrix:
       0      1
0  25837      4
1    365  25490
---- Validation: 
scalar performance:
{'acc': 0.97547305, 'precision': 0.7443832, 'recall': 0.806662, 'specificity': 0.806662, 'f1': 0.7717068, 'auroc': 0.9270406, 'binary_precision': 0.49810606, 'binary_recall': 0.62918663, 'binary_specificity': 0.9841374, 'binary_f1_score': 0.5560254}
confusion matrix:
       0    1
0  16441  265
1    155  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8727705, 'precision': 0.6760719, 'recall': 0.85980916, 'specificity': 0.85980916, 'f1': 0.71932065, 'auroc': 0.9168775, 'binary_precision': 0.36715767, 'binary_recall': 0.84441656, 'binary_specificity': 0.8752017, 'binary_f1_score': 0.51178706}
confusion matrix:
      0     1
0  8135  1160
1   124   673
early stop counter: 3
val acc:0.9754730463027954, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9203329086303711
after epoch: 10,now: 2024-08-07 14:35:27.893642,epoch time: 0:19:06.521136,used: 3:11:31.740267,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9944483, 'precision': 0.99446565, 'recall': 0.9944478, 'specificity': 0.9944478, 'f1': 0.9944483, 'auroc': 0.999779, 'binary_precision': 0.9915779, 'binary_recall': 0.99736965, 'binary_specificity': 0.99152607, 'binary_f1_score': 0.99446535}
confusion matrix:
       0      1
0  25625    219
1     68  25784
---- Validation: 
scalar performance:
{'acc': 0.9675893, 'precision': 0.7060835, 'recall': 0.895921, 'specificity': 0.895921, 'f1': 0.76798266, 'auroc': 0.95272565, 'binary_precision': 0.41676793, 'binary_recall': 0.82057416, 'binary_specificity': 0.9712678, 'binary_f1_score': 0.55278}
confusion matrix:
       0    1
0  16226  480
1     75  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87643677, 'precision': 0.6761131, 'recall': 0.8451662, 'specificity': 0.8451662, 'f1': 0.7187156, 'auroc': 0.8964357, 'binary_precision': 0.37054086, 'binary_recall': 0.8080301, 'binary_specificity': 0.8823023, 'binary_f1_score': 0.5080868}
confusion matrix:
      0     1
0  8201  1094
1   153   644
early stop counter: 4
val acc:0.9675893187522888, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9203329086303711
after epoch: 11,now: 2024-08-07 14:54:39.762254,epoch time: 0:19:11.868612,used: 3:30:43.608879,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99595714, 'precision': 0.99596375, 'recall': 0.9959575, 'specificity': 0.9959575, 'f1': 0.99595714, 'auroc': 0.99983656, 'binary_precision': 0.99782574, 'binary_recall': 0.9940819, 'binary_specificity': 0.9978331, 'binary_f1_score': 0.99595034}
confusion matrix:
       0      1
0  25787     56
1    153  25700
---- Validation: 
scalar performance:
{'acc': 0.97471386, 'precision': 0.7406735, 'recall': 0.8575876, 'specificity': 0.8575876, 'f1': 0.7866978, 'auroc': 0.9491531, 'binary_precision': 0.4880763, 'binary_recall': 0.73444974, 'binary_specificity': 0.98072547, 'binary_f1_score': 0.5864374}
confusion matrix:
       0    1
0  16384  322
1    111  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9240983, 'precision': 0.7441131, 'recall': 0.8251555, 'specificity': 0.8251555, 'f1': 0.7768421, 'auroc': 0.9214478, 'binary_precision': 0.51412946, 'binary_recall': 0.7076537, 'binary_specificity': 0.94265735, 'binary_f1_score': 0.59556496}
confusion matrix:
      0    1
0  8762  533
1   233  564
new oracle model saved
early stop counter: 5
val acc:0.9747138619422913, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9240983128547668
after epoch: 12,now: 2024-08-07 15:13:27.536903,epoch time: 0:18:47.774649,used: 3:49:31.383528,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99435157, 'precision': 0.9943634, 'recall': 0.99435115, 'specificity': 0.99435115, 'f1': 0.9943515, 'auroc': 0.999843, 'binary_precision': 0.9919929, 'binary_recall': 0.99675083, 'binary_specificity': 0.9919514, 'binary_f1_score': 0.9943661}
confusion matrix:
       0      1
0  25635    208
1     84  25769
---- Validation: 
scalar performance:
{'acc': 0.961516, 'precision': 0.6823473, 'recall': 0.89047587, 'specificity': 0.89047587, 'f1': 0.74427474, 'auroc': 0.96076584, 'binary_precision': 0.36944744, 'binary_recall': 0.81578946, 'binary_specificity': 0.9651622, 'binary_f1_score': 0.5085757}
confusion matrix:
       0    1
0  16124  582
1     77  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81064206, 'precision': 0.6343392, 'recall': 0.84730303, 'specificity': 0.84730303, 'f1': 0.65645313, 'auroc': 0.91030324, 'binary_precision': 0.28018942, 'binary_recall': 0.89084065, 'binary_specificity': 0.8037655, 'binary_f1_score': 0.42629844}
confusion matrix:
      0     1
0  7471  1824
1    87   710
early stop counter: 6
val acc:0.9615160226821899, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9240983128547668
after epoch: 13,now: 2024-08-07 15:32:11.933782,epoch time: 0:18:44.396879,used: 4:08:15.780407,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9970017, 'precision': 0.99700534, 'recall': 0.9970018, 'specificity': 0.9970018, 'f1': 0.99700165, 'auroc': 0.9999194, 'binary_precision': 0.99837077, 'binary_recall': 0.99562865, 'binary_specificity': 0.998375, 'binary_f1_score': 0.9969978}
confusion matrix:
       0      1
0  25804     42
1    113  25737
---- Validation: 
scalar performance:
{'acc': 0.9686405, 'precision': 0.7093737, 'recall': 0.883631, 'specificity': 0.883631, 'f1': 0.7683115, 'auroc': 0.966524, 'binary_precision': 0.42401022, 'binary_recall': 0.79425836, 'binary_specificity': 0.9730037, 'binary_f1_score': 0.5528726}
confusion matrix:
       0    1
0  16255  451
1     86  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9102259, 'precision': 0.7190821, 'recall': 0.84572905, 'specificity': 0.84572905, 'f1': 0.76242924, 'auroc': 0.92754537, 'binary_precision': 0.45917603, 'binary_recall': 0.7691343, 'binary_specificity': 0.9223238, 'binary_f1_score': 0.5750469}
confusion matrix:
      0    1
0  8573  722
1   184  613
early stop counter: 7
val acc:0.9686405062675476, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9240983128547668
after epoch: 14,now: 2024-08-07 15:51:10.865137,epoch time: 0:18:58.931355,used: 4:27:14.711762,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99733055, 'precision': 0.99733734, 'recall': 0.9973309, 'specificity': 0.9973309, 'f1': 0.99733055, 'auroc': 0.99992704, 'binary_precision': 0.9992235, 'binary_recall': 0.9954357, 'binary_specificity': 0.9992261, 'binary_f1_score': 0.99732596}
confusion matrix:
       0      1
0  25823     20
1    118  25735
---- Validation: 
scalar performance:
{'acc': 0.97926885, 'precision': 0.781421, 'recall': 0.7899475, 'specificity': 0.7899475, 'f1': 0.785616, 'auroc': 0.95181036, 'binary_precision': 0.57308584, 'binary_recall': 0.59090906, 'binary_specificity': 0.988986, 'binary_f1_score': 0.58186096}
confusion matrix:
       0    1
0  16522  184
1    171  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88030124, 'precision': 0.68395627, 'recall': 0.8633238, 'specificity': 0.8633238, 'f1': 0.72906697, 'auroc': 0.9126736, 'binary_precision': 0.382906, 'binary_recall': 0.8431619, 'binary_specificity': 0.88348573, 'binary_f1_score': 0.5266458}
confusion matrix:
      0     1
0  8212  1083
1   125   672
early stop counter: 8
val acc:0.9792688488960266, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9240983128547668
after epoch: 15,now: 2024-08-07 16:10:18.479122,epoch time: 0:19:07.613985,used: 4:46:22.325747,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9962086, 'precision': 0.99622285, 'recall': 0.99620855, 'specificity': 0.99620855, 'f1': 0.99620855, 'auroc': 0.99985003, 'binary_precision': 0.998872, 'binary_recall': 0.9935389, 'binary_specificity': 0.9988781, 'binary_f1_score': 0.9961983}
confusion matrix:
       0      1
0  25820     29
1    167  25680
---- Validation: 
scalar performance:
{'acc': 0.9748306, 'precision': 0.73323613, 'recall': 0.6955397, 'specificity': 0.6955397, 'f1': 0.71259874, 'auroc': 0.9387827, 'binary_precision': 0.48137537, 'binary_recall': 0.40191388, 'binary_specificity': 0.98916554, 'binary_f1_score': 0.43807045}
confusion matrix:
       0    1
0  16525  181
1    250  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197384, 'precision': 0.7259631, 'recall': 0.74191666, 'specificity': 0.74191666, 'f1': 0.73357594, 'auroc': 0.8926741, 'binary_precision': 0.49243307, 'binary_recall': 0.53074026, 'binary_specificity': 0.95309305, 'binary_f1_score': 0.51086956}
confusion matrix:
      0    1
0  8859  436
1   374  423
early stop counter: 9
val acc:0.9748306274414062, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9240983128547668
after epoch: 16,now: 2024-08-07 16:29:25.433005,epoch time: 0:19:06.953883,used: 5:05:29.279630,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99676955, 'precision': 0.99676967, 'recall': 0.99676955, 'specificity': 0.99676955, 'f1': 0.99676955, 'auroc': 0.99986285, 'binary_precision': 0.9965201, 'binary_recall': 0.99702126, 'binary_specificity': 0.99651784, 'binary_f1_score': 0.9967706}
confusion matrix:
       0      1
0  25756     90
1     77  25773
---- Validation: 
scalar performance:
{'acc': 0.97926885, 'precision': 0.7946829, 'recall': 0.71647424, 'specificity': 0.71647424, 'f1': 0.7492006, 'auroc': 0.9548889, 'binary_precision': 0.6032787, 'binary_recall': 0.4401914, 'binary_specificity': 0.9927571, 'binary_f1_score': 0.5089903}
confusion matrix:
       0    1
0  16585  121
1    234  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9101268, 'precision': 0.71822274, 'recall': 0.84108675, 'specificity': 0.84108675, 'f1': 0.76068074, 'auroc': 0.92790323, 'binary_precision': 0.45833334, 'binary_recall': 0.7590966, 'binary_specificity': 0.9230769, 'binary_f1_score': 0.57156354}
confusion matrix:
      0    1
0  8580  715
1   192  605
early stop counter: 10
val acc:0.9792688488960266, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9240983128547668
after epoch: 17,now: 2024-08-07 16:48:25.249356,epoch time: 0:18:59.816351,used: 5:24:29.095981,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99634403, 'precision': 0.99634945, 'recall': 0.9963436, 'specificity': 0.9963436, 'f1': 0.996344, 'auroc': 0.99988544, 'binary_precision': 0.9947565, 'binary_recall': 0.99795, 'binary_specificity': 0.99473727, 'binary_f1_score': 0.9963507}
confusion matrix:
       0      1
0  25706    136
1     53  25801
---- Validation: 
scalar performance:
{'acc': 0.9448727, 'precision': 0.64363253, 'recall': 0.90993583, 'specificity': 0.90993583, 'f1': 0.7035506, 'auroc': 0.9578307, 'binary_precision': 0.2906051, 'binary_recall': 0.8732057, 'binary_specificity': 0.9466659, 'binary_f1_score': 0.43608126}
confusion matrix:
       0    1
0  15815  891
1     53  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7831946, 'precision': 0.6141979, 'recall': 0.8100337, 'specificity': 0.8100337, 'f1': 0.6243951, 'auroc': 0.8707324, 'binary_precision': 0.24551775, 'binary_recall': 0.84190714, 'binary_specificity': 0.7781603, 'binary_f1_score': 0.38016996}
confusion matrix:
      0     1
0  7233  2062
1   126   671
early stop counter: 11
val acc:0.9448726773262024, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9240983128547668
after epoch: 18,now: 2024-08-07 17:07:04.780914,epoch time: 0:18:39.531558,used: 5:43:08.627539,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9936746, 'precision': 0.9937397, 'recall': 0.9936755, 'specificity': 0.9936755, 'f1': 0.9936744, 'auroc': 0.9998784, 'binary_precision': 0.9994521, 'binary_recall': 0.9878926, 'binary_specificity': 0.9994583, 'binary_f1_score': 0.99363875}
confusion matrix:
       0      1
0  25830     14
1    313  25539
---- Validation: 
scalar performance:
{'acc': 0.97780895, 'precision': 0.7725761, 'recall': 0.7098948, 'specificity': 0.7098948, 'f1': 0.7368775, 'auroc': 0.9600204, 'binary_precision': 0.559375, 'binary_recall': 0.42822966, 'binary_specificity': 0.9915599, 'binary_f1_score': 0.48509488}
confusion matrix:
       0    1
0  16565  141
1    239  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9113159, 'precision': 0.7172197, 'recall': 0.82051057, 'specificity': 0.82051057, 'f1': 0.7550136, 'auroc': 0.9039941, 'binary_precision': 0.46029174, 'binary_recall': 0.71267253, 'binary_specificity': 0.9283486, 'binary_f1_score': 0.5593304}
confusion matrix:
      0    1
0  8629  666
1   229  568
early stop counter: 12
val acc:0.977808952331543, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9240983128547668
after epoch: 19,now: 2024-08-07 17:26:16.864148,epoch time: 0:19:12.083234,used: 6:02:20.710773,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99595714, 'precision': 0.9959574, 'recall': 0.99595714, 'specificity': 0.99595714, 'f1': 0.9959572, 'auroc': 0.9998901, 'binary_precision': 0.99566984, 'binary_recall': 0.9962476, 'binary_specificity': 0.9956666, 'binary_f1_score': 0.9959587}
confusion matrix:
       0      1
0  25734    112
1     97  25753
---- Validation: 
scalar performance:
{'acc': 0.94872695, 'precision': 0.63067055, 'recall': 0.80228436, 'specificity': 0.80228436, 'f1': 0.67747235, 'auroc': 0.9305684, 'binary_precision': 0.2704591, 'binary_recall': 0.6483254, 'binary_specificity': 0.9562433, 'binary_f1_score': 0.38169014}
confusion matrix:
       0    1
0  15975  731
1    147  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87158144, 'precision': 0.6701596, 'recall': 0.83908904, 'specificity': 0.83908904, 'f1': 0.71126294, 'auroc': 0.89415956, 'binary_precision': 0.35943663, 'binary_recall': 0.8005019, 'binary_specificity': 0.8776762, 'binary_f1_score': 0.496112}
confusion matrix:
      0     1
0  8158  1137
1   159   638
early stop counter: 13
val acc:0.9487269520759583, best validation acc: 0.9813711643218994, corresponding to test acc:                         0.911811351776123 / 0.9240983128547668
after epoch: 20,now: 2024-08-07 17:45:24.284135,epoch time: 0:19:07.419987,used: 6:21:28.130760,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_11_23_55_seed_2_24076683
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:21:28.130760 at 2024-08-07 17:45:24.284135
persisted model performance metric: 

scalar performance:
{'acc': 0.91181135, 'precision': 0.7217235, 'recall': 0.84544265, 'specificity': 0.84544265, 'f1': 0.7646755, 'auroc': 0.9219141, 'binary_precision': 0.46463877, 'binary_recall': 0.76662487, 'binary_specificity': 0.9242604, 'binary_f1_score': 0.5785985}
confusion matrix:
      0    1
0  8591  704
1   186  611
oracle model performance metric: 

scalar performance:
{'acc': 0.9240983, 'precision': 0.7441131, 'recall': 0.8251555, 'specificity': 0.8251555, 'f1': 0.7768421, 'auroc': 0.9214478, 'binary_precision': 0.51412946, 'binary_recall': 0.7076537, 'binary_specificity': 0.94265735, 'binary_f1_score': 0.59556496}
confusion matrix:
      0    1
0  8762  533
1   233  564
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |  40858 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  41672 MiB |  27200 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  41570 MiB |  27164 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool | 455249 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |  10843 KiB |     44 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7467    |  329276 K  |  329271 K  |
|       from large pool |     187    |    1413    |  158241 K  |  158241 K  |
|       from small pool |    4735    |    7278    |  171034 K  |  171029 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7467    |  329276 K  |  329271 K  |
|       from large pool |     187    |    1413    |  158241 K  |  158241 K  |
|       from small pool |    4735    |    7278    |  171034 K  |  171029 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1783    |    1148    |
|       from large pool |     602    |     602    |    1732    |    1130    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3292    |  193542 K  |  193542 K  |
|       from large pool |      36    |     605    |  110448 K  |  110448 K  |
|       from small pool |      41    |    3256    |   83093 K  |   83093 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |      0 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  41672 MiB |  40770 MiB |
|       from large pool |    850 MiB |  14412 MiB |  41570 MiB |  40720 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool |  24320 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |      0 KiB |     46 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7467    |  329276 K  |  329276 K  |
|       from large pool |       2    |    1413    |  158241 K  |  158241 K  |
|       from small pool |       0    |    7278    |  171034 K  |  171034 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7467    |  329276 K  |  329276 K  |
|       from large pool |       2    |    1413    |  158241 K  |  158241 K  |
|       from small pool |       0    |    7278    |  171034 K  |  171034 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1783    |    1719    |
|       from large pool |      38    |     602    |    1732    |    1694    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3292    |  193544 K  |  193544 K  |
|       from large pool |       3    |     605    |  110448 K  |  110448 K  |
|       from small pool |       0    |    3256    |   83095 K  |   83095 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 18:03:00 2024]
Finished job 0.
1 of 1 steps (100%) done
