Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:57 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/13.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=13
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672

 Experiment start at: 2024-08-06 02:34:45.519661
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86360943, 'precision': 0.86935693, 'recall': 0.8636513, 'specificity': 0.8636513, 'f1': 0.86308634, 'auroc': 0.9186873, 'binary_precision': 0.91559964, 'binary_recall': 0.80126256, 'binary_specificity': 0.92604005, 'binary_f1_score': 0.8546239}
confusion matrix:
       0      1
0  23439   1872
1   5037  20308
---- Validation: 
scalar performance:
{'acc': 0.8684825, 'precision': 0.5264498, 'recall': 0.62242734, 'specificity': 0.62242734, 'f1': 0.523525, 'auroc': 0.74579537, 'binary_precision': 0.07049487, 'binary_recall': 0.36385542, 'binary_specificity': 0.8809993, 'binary_f1_score': 0.11810717}
confusion matrix:
       0     1
0  14740  1991
1    264   151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76962626, 'precision': 0.52690667, 'recall': 0.56158495, 'specificity': 0.56158495, 'f1': 0.51967067, 'auroc': 0.66340137, 'binary_precision': 0.119257085, 'binary_recall': 0.31606218, 'binary_specificity': 0.8071077, 'binary_f1_score': 0.17317246}
confusion matrix:
      0     1
0  7540  1802
1   528   244
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 02:56:07.440313,epoch time: 0:21:21.920652,used: 0:21:21.920652,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9022228, 'precision': 0.9119065, 'recall': 0.9022652, 'specificity': 0.9022652, 'f1': 0.90165144, 'auroc': 0.9607103, 'binary_precision': 0.9752016, 'binary_recall': 0.8255465, 'binary_specificity': 0.97898394, 'binary_f1_score': 0.8941553}
confusion matrix:
       0      1
0  24782    532
1   4421  20921
---- Validation: 
scalar performance:
{'acc': 0.85687625, 'precision': 0.5334864, 'recall': 0.6728772, 'specificity': 0.6728772, 'f1': 0.5307489, 'auroc': 0.7881936, 'binary_precision': 0.081657775, 'binary_recall': 0.4795181, 'binary_specificity': 0.8662363, 'binary_f1_score': 0.13955119}
confusion matrix:
       0     1
0  14493  2238
1    216   199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75430095, 'precision': 0.5531567, 'recall': 0.6400345, 'specificity': 0.6400345, 'f1': 0.5462011, 'auroc': 0.72769856, 'binary_precision': 0.15643802, 'binary_recall': 0.5051814, 'binary_specificity': 0.7748876, 'binary_f1_score': 0.23889738}
confusion matrix:
      0     1
0  7239  2103
1   382   390
early stop counter: 1
val acc:0.8568762540817261, best validation acc: 0.8684824705123901, corresponding to test acc:                         0.769626259803772 / 0.769626259803772
after epoch: 2,now: 2024-08-06 03:14:58.528301,epoch time: 0:18:51.087988,used: 0:40:13.008640,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9205622, 'precision': 0.9257033, 'recall': 0.92059696, 'specificity': 0.92059696, 'f1': 0.92032605, 'auroc': 0.97202265, 'binary_precision': 0.97264344, 'binary_recall': 0.8655698, 'binary_specificity': 0.9756242, 'binary_f1_score': 0.91598815}
confusion matrix:
       0      1
0  24695    617
1   3407  21937
---- Validation: 
scalar performance:
{'acc': 0.8547766, 'precision': 0.5430717, 'recall': 0.732898, 'specificity': 0.732898, 'f1': 0.54411405, 'auroc': 0.8238716, 'binary_precision': 0.09740008, 'binary_recall': 0.6048193, 'binary_specificity': 0.86097664, 'binary_f1_score': 0.16778076}
confusion matrix:
       0     1
0  14405  2326
1    164   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74708325, 'precision': 0.5697455, 'recall': 0.6967304, 'specificity': 0.6967304, 'f1': 0.5622535, 'auroc': 0.77159655, 'binary_precision': 0.17761733, 'binary_recall': 0.6373057, 'binary_specificity': 0.756155, 'binary_f1_score': 0.27780914}
confusion matrix:
      0     1
0  7064  2278
1   280   492
early stop counter: 2
val acc:0.8547766208648682, best validation acc: 0.8684824705123901, corresponding to test acc:                         0.769626259803772 / 0.769626259803772
after epoch: 3,now: 2024-08-06 03:32:15.076643,epoch time: 0:17:16.548342,used: 0:57:29.556982,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9316961, 'precision': 0.93499136, 'recall': 0.9317185, 'specificity': 0.9317185, 'f1': 0.931569, 'auroc': 0.9777564, 'binary_precision': 0.97297996, 'binary_recall': 0.88812596, 'binary_specificity': 0.9753111, 'binary_f1_score': 0.9286186}
confusion matrix:
       0      1
0  24690    625
1   2835  22506
---- Validation: 
scalar performance:
{'acc': 0.83844626, 'precision': 0.54653996, 'recall': 0.7809271, 'specificity': 0.7809271, 'f1': 0.5439895, 'auroc': 0.8481836, 'binary_precision': 0.101252966, 'binary_recall': 0.72048193, 'binary_specificity': 0.8413723, 'binary_f1_score': 0.17755345}
confusion matrix:
       0     1
0  14077  2654
1    116   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7304726, 'precision': 0.58125895, 'recall': 0.74655926, 'specificity': 0.74655926, 'f1': 0.5677111, 'auroc': 0.80287445, 'binary_precision': 0.18845664, 'binary_recall': 0.76554406, 'binary_specificity': 0.7275744, 'binary_f1_score': 0.30245653}
confusion matrix:
      0     1
0  6797  2545
1   181   591
early stop counter: 3
val acc:0.8384462594985962, best validation acc: 0.8684824705123901, corresponding to test acc:                         0.769626259803772 / 0.769626259803772
after epoch: 4,now: 2024-08-06 03:49:31.289143,epoch time: 0:17:16.212500,used: 1:14:45.769482,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93821067, 'precision': 0.94017386, 'recall': 0.9382305, 'specificity': 0.9382305, 'f1': 0.9381436, 'auroc': 0.9811878, 'binary_precision': 0.96971875, 'binary_recall': 0.9047469, 'binary_specificity': 0.97171414, 'binary_f1_score': 0.9361068}
confusion matrix:
       0      1
0  24597    716
1   2414  22929
---- Validation: 
scalar performance:
{'acc': 0.839846, 'precision': 0.5486575, 'recall': 0.79339373, 'specificity': 0.79339373, 'f1': 0.5474615, 'auroc': 0.86770475, 'binary_precision': 0.104781285, 'binary_recall': 0.7445783, 'binary_specificity': 0.8422091, 'binary_f1_score': 0.18370987}
confusion matrix:
       0     1
0  14091  2640
1    106   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7451058, 'precision': 0.58953124, 'recall': 0.7663634, 'specificity': 0.7663634, 'f1': 0.5823259, 'auroc': 0.82467365, 'binary_precision': 0.20178336, 'binary_recall': 0.7914508, 'binary_specificity': 0.74127597, 'binary_f1_score': 0.32157895}
confusion matrix:
      0     1
0  6925  2417
1   161   611
early stop counter: 4
val acc:0.8398460149765015, best validation acc: 0.8684824705123901, corresponding to test acc:                         0.769626259803772 / 0.769626259803772
after epoch: 5,now: 2024-08-06 04:06:45.957051,epoch time: 0:17:14.667908,used: 1:32:00.437390,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94213915, 'precision': 0.9445676, 'recall': 0.9421625, 'specificity': 0.9421625, 'f1': 0.9420621, 'auroc': 0.9830917, 'binary_precision': 0.97758365, 'binary_recall': 0.90510577, 'binary_specificity': 0.9792193, 'binary_f1_score': 0.9399496}
confusion matrix:
       0      1
0  24786    526
1   2405  22939
---- Validation: 
scalar performance:
{'acc': 0.85798436, 'precision': 0.55491394, 'recall': 0.8026878, 'specificity': 0.8026878, 'f1': 0.56223816, 'auroc': 0.8796561, 'binary_precision': 0.11713419, 'binary_recall': 0.7445783, 'binary_specificity': 0.86079735, 'binary_f1_score': 0.20242384}
confusion matrix:
       0     1
0  14402  2329
1    106   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78495157, 'precision': 0.60094345, 'recall': 0.7712965, 'specificity': 0.7712965, 'f1': 0.61010003, 'auroc': 0.83954644, 'binary_precision': 0.22693655, 'binary_recall': 0.7551814, 'binary_specificity': 0.7874117, 'binary_f1_score': 0.34899732}
confusion matrix:
      0     1
0  7356  1986
1   189   583
new oracle model saved
early stop counter: 5
val acc:0.8579843640327454, best validation acc: 0.8684824705123901, corresponding to test acc:                         0.769626259803772 / 0.7849515676498413
after epoch: 6,now: 2024-08-06 04:24:00.033073,epoch time: 0:17:14.076022,used: 1:49:14.513412,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94541615, 'precision': 0.94779176, 'recall': 0.94543636, 'specificity': 0.94543636, 'f1': 0.9453454, 'auroc': 0.9841419, 'binary_precision': 0.98054576, 'binary_recall': 0.9089259, 'binary_specificity': 0.98194677, 'binary_f1_score': 0.94337845}
confusion matrix:
       0      1
0  24857    457
1   2308  23034
---- Validation: 
scalar performance:
{'acc': 0.8579261, 'precision': 0.55613977, 'recall': 0.81088245, 'specificity': 0.81088245, 'f1': 0.56399024, 'auroc': 0.8847667, 'binary_precision': 0.11911044, 'binary_recall': 0.76144576, 'binary_specificity': 0.8603192, 'binary_f1_score': 0.20599739}
confusion matrix:
       0     1
0  14394  2337
1     99   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.788511, 'precision': 0.6039648, 'recall': 0.7779765, 'specificity': 0.7779765, 'f1': 0.6147006, 'auroc': 0.8493507, 'binary_precision': 0.23185563, 'binary_recall': 0.76554406, 'binary_specificity': 0.7904089, 'binary_f1_score': 0.3559169}
confusion matrix:
      0     1
0  7384  1958
1   181   591
new oracle model saved
early stop counter: 6
val acc:0.857926070690155, best validation acc: 0.8684824705123901, corresponding to test acc:                         0.769626259803772 / 0.7885109782218933
after epoch: 7,now: 2024-08-06 04:41:32.980624,epoch time: 0:17:32.947551,used: 2:06:47.460963,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95202935, 'precision': 0.95360506, 'recall': 0.95204806, 'specificity': 0.95204806, 'f1': 0.95198905, 'auroc': 0.9878323, 'binary_precision': 0.98049825, 'binary_recall': 0.9224669, 'binary_specificity': 0.98162925, 'binary_f1_score': 0.95059776}
confusion matrix:
       0      1
0  24847    465
1   1965  23379
---- Validation: 
scalar performance:
{'acc': 0.851044, 'precision': 0.55513024, 'recall': 0.8179305, 'specificity': 0.8179305, 'f1': 0.56035876, 'auroc': 0.88575983, 'binary_precision': 0.11652922, 'binary_recall': 0.78313255, 'binary_specificity': 0.8527285, 'binary_f1_score': 0.20287141}
confusion matrix:
       0     1
0  14267  2464
1     90   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78900534, 'precision': 0.60352707, 'recall': 0.77586746, 'specificity': 0.77586746, 'f1': 0.61438715, 'auroc': 0.85131985, 'binary_precision': 0.23146687, 'binary_recall': 0.7603627, 'binary_specificity': 0.7913723, 'binary_f1_score': 0.3548972}
confusion matrix:
      0     1
0  7393  1949
1   185   587
new oracle model saved
early stop counter: 7
val acc:0.8510439991950989, best validation acc: 0.8684824705123901, corresponding to test acc:                         0.769626259803772 / 0.7890053391456604
after epoch: 8,now: 2024-08-06 04:58:55.857902,epoch time: 0:17:22.877278,used: 2:24:10.338241,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95317435, 'precision': 0.95483774, 'recall': 0.9531911, 'specificity': 0.9531911, 'f1': 0.95313275, 'auroc': 0.9882692, 'binary_precision': 0.98248196, 'binary_recall': 0.9228553, 'binary_specificity': 0.9835269, 'binary_f1_score': 0.9517356}
confusion matrix:
       0      1
0  24897    417
1   1955  23387
---- Validation: 
scalar performance:
{'acc': 0.8651581, 'precision': 0.560538, 'recall': 0.82398766, 'specificity': 0.82398766, 'f1': 0.57256424, 'auroc': 0.8920771, 'binary_precision': 0.12730844, 'binary_recall': 0.7807229, 'binary_specificity': 0.8672524, 'binary_f1_score': 0.21891892}
confusion matrix:
       0     1
0  14510  2221
1     91   324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81846946, 'precision': 0.615351, 'recall': 0.7775575, 'specificity': 0.7775575, 'f1': 0.6369062, 'auroc': 0.85599256, 'binary_precision': 0.25707763, 'binary_recall': 0.72927463, 'binary_specificity': 0.8258403, 'binary_f1_score': 0.38014856}
confusion matrix:
      0     1
0  7715  1627
1   209   563
new oracle model saved
early stop counter: 8
val acc:0.8651580810546875, best validation acc: 0.8684824705123901, corresponding to test acc:                         0.769626259803772 / 0.8184694647789001
after epoch: 9,now: 2024-08-06 05:16:23.162865,epoch time: 0:17:27.304963,used: 2:41:37.643204,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95708305, 'precision': 0.9583789, 'recall': 0.9570999, 'specificity': 0.9570999, 'f1': 0.9570538, 'auroc': 0.98955417, 'binary_precision': 0.98290956, 'binary_recall': 0.93039775, 'binary_specificity': 0.98380214, 'binary_f1_score': 0.95593303}
confusion matrix:
       0      1
0  24902    410
1   1764  23580
---- Validation: 
scalar performance:
{'acc': 0.8730899, 'precision': 0.5645303, 'recall': 0.83040184, 'specificity': 0.83040184, 'f1': 0.5806966, 'auroc': 0.895789, 'binary_precision': 0.13510153, 'binary_recall': 0.7855422, 'binary_specificity': 0.8752615, 'binary_f1_score': 0.23055162}
confusion matrix:
       0     1
0  14644  2087
1     89   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83567333, 'precision': 0.6228123, 'recall': 0.77320486, 'specificity': 0.77320486, 'f1': 0.6494129, 'auroc': 0.8607227, 'binary_precision': 0.2741117, 'binary_recall': 0.69948184, 'binary_specificity': 0.8469279, 'binary_f1_score': 0.3938731}
confusion matrix:
      0     1
0  7912  1430
1   232   540
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-06 05:34:26.311468,epoch time: 0:18:03.148603,used: 2:59:40.791807,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95880055, 'precision': 0.95988965, 'recall': 0.958814, 'specificity': 0.958814, 'f1': 0.958777, 'auroc': 0.9893209, 'binary_precision': 0.9824088, 'binary_recall': 0.93437773, 'binary_specificity': 0.9832504, 'binary_f1_score': 0.9577915}
confusion matrix:
       0      1
0  24890    424
1   1663  23679
---- Validation: 
scalar performance:
{'acc': 0.86463314, 'precision': 0.56174433, 'recall': 0.8331182, 'specificity': 0.8331182, 'f1': 0.57415444, 'auroc': 0.89800173, 'binary_precision': 0.12918288, 'binary_recall': 0.8, 'binary_specificity': 0.8662363, 'binary_f1_score': 0.22244556}
confusion matrix:
       0     1
0  14493  2238
1     83   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8326083, 'precision': 0.62218446, 'recall': 0.776893, 'specificity': 0.776893, 'f1': 0.6481575, 'auroc': 0.86337304, 'binary_precision': 0.27191678, 'binary_recall': 0.7111399, 'binary_specificity': 0.8426461, 'binary_f1_score': 0.3934074}
confusion matrix:
      0     1
0  7872  1470
1   223   549
early stop counter: 1
val acc:0.8646331429481506, best validation acc: 0.8730899095535278, corresponding to test acc:                         0.8356733322143555 / 0.8356733322143555
after epoch: 11,now: 2024-08-06 05:51:49.382867,epoch time: 0:17:23.071399,used: 3:17:03.863206,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.958386, 'precision': 0.9596345, 'recall': 0.9583994, 'specificity': 0.9583994, 'f1': 0.9583585, 'auroc': 0.9901738, 'binary_precision': 0.9837185, 'binary_recall': 0.9322442, 'binary_specificity': 0.9845546, 'binary_f1_score': 0.9572899}
confusion matrix:
       0      1
0  24924    391
1   1717  23624
---- Validation: 
scalar performance:
{'acc': 0.86906564, 'precision': 0.5640886, 'recall': 0.8377392, 'specificity': 0.8377392, 'f1': 0.5788861, 'auroc': 0.9026766, 'binary_precision': 0.13370697, 'binary_recall': 0.8048193, 'binary_specificity': 0.87065923, 'binary_f1_score': 0.22931686}
confusion matrix:
       0     1
0  14567  2164
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445719, 'precision': 0.6317276, 'recall': 0.78574574, 'specificity': 0.78574574, 'f1': 0.66171104, 'auroc': 0.8689482, 'binary_precision': 0.2901364, 'binary_recall': 0.71632123, 'binary_specificity': 0.8551702, 'binary_f1_score': 0.41299477}
confusion matrix:
      0     1
0  7989  1353
1   219   553
new oracle model saved
early stop counter: 2
val acc:0.8690656423568726, best validation acc: 0.8730899095535278, corresponding to test acc:                         0.8356733322143555 / 0.8445718884468079
after epoch: 12,now: 2024-08-06 06:09:08.297540,epoch time: 0:17:18.914673,used: 3:34:22.777879,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96213675, 'precision': 0.9627586, 'recall': 0.9621455, 'specificity': 0.9621455, 'f1': 0.9621245, 'auroc': 0.991276, 'binary_precision': 0.979841, 'binary_recall': 0.94372535, 'binary_specificity': 0.98056567, 'binary_f1_score': 0.96144414}
confusion matrix:
       0      1
0  24824    492
1   1426  23914
---- Validation: 
scalar performance:
{'acc': 0.8725067, 'precision': 0.56571686, 'recall': 0.83950245, 'specificity': 0.83950245, 'f1': 0.58226186, 'auroc': 0.90350306, 'binary_precision': 0.13694137, 'binary_recall': 0.8048193, 'binary_specificity': 0.8741856, 'binary_f1_score': 0.23405747}
confusion matrix:
       0     1
0  14626  2105
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85238284, 'precision': 0.6352892, 'recall': 0.7798735, 'specificity': 0.7798735, 'f1': 0.66670334, 'auroc': 0.8665569, 'binary_precision': 0.29894033, 'binary_recall': 0.69430053, 'binary_specificity': 0.8654464, 'binary_f1_score': 0.41793373}
confusion matrix:
      0     1
0  8085  1257
1   236   536
new oracle model saved
early stop counter: 3
val acc:0.8725066781044006, best validation acc: 0.8730899095535278, corresponding to test acc:                         0.8356733322143555 / 0.8523828387260437
after epoch: 13,now: 2024-08-06 06:26:23.799897,epoch time: 0:17:15.502357,used: 3:51:38.280236,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96243286, 'precision': 0.9631463, 'recall': 0.96244454, 'specificity': 0.96244454, 'f1': 0.96241903, 'auroc': 0.99195594, 'binary_precision': 0.9814724, 'binary_recall': 0.94270605, 'binary_specificity': 0.98218304, 'binary_f1_score': 0.9616987}
confusion matrix:
       0      1
0  24862    451
1   1452  23891
---- Validation: 
scalar performance:
{'acc': 0.8688324, 'precision': 0.564341, 'recall': 0.83996964, 'specificity': 0.83996964, 'f1': 0.57918394, 'auroc': 0.90573585, 'binary_precision': 0.13407822, 'binary_recall': 0.80963856, 'binary_specificity': 0.87030065, 'binary_f1_score': 0.23005822}
confusion matrix:
       0     1
0  14561  2170
1     79   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85455805, 'precision': 0.63718337, 'recall': 0.7810509, 'specificity': 0.7810509, 'f1': 0.66918576, 'auroc': 0.8687191, 'binary_precision': 0.30265388, 'binary_recall': 0.69430053, 'binary_specificity': 0.8678013, 'binary_f1_score': 0.42154935}
confusion matrix:
      0     1
0  8107  1235
1   236   536
new oracle model saved
early stop counter: 4
val acc:0.8688324093818665, best validation acc: 0.8730899095535278, corresponding to test acc:                         0.8356733322143555 / 0.8545580506324768
after epoch: 14,now: 2024-08-06 06:43:39.739380,epoch time: 0:17:15.939483,used: 4:08:54.219719,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9651902, 'recall': 0.9645344, 'specificity': 0.9645344, 'f1': 0.96451324, 'auroc': 0.9925474, 'binary_precision': 0.9828937, 'binary_recall': 0.94554067, 'binary_specificity': 0.9835282, 'binary_f1_score': 0.96385545}
confusion matrix:
       0      1
0  24899    417
1   1380  23960
---- Validation: 
scalar performance:
{'acc': 0.8900035, 'precision': 0.57420754, 'recall': 0.84141827, 'specificity': 0.84141827, 'f1': 0.5993315, 'auroc': 0.9053236, 'binary_precision': 0.15420781, 'binary_recall': 0.79036146, 'binary_specificity': 0.89247507, 'binary_f1_score': 0.25806454}
confusion matrix:
       0     1
0  14932  1799
1     87   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86553293, 'precision': 0.64368665, 'recall': 0.77332646, 'specificity': 0.77332646, 'f1': 0.67689186, 'auroc': 0.8699819, 'binary_precision': 0.31784385, 'binary_recall': 0.66450775, 'binary_specificity': 0.88214517, 'binary_f1_score': 0.43000835}
confusion matrix:
      0     1
0  8241  1101
1   259   513
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-06 07:00:55.490142,epoch time: 0:17:15.750762,used: 4:26:09.970481,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96525586, 'precision': 0.96585125, 'recall': 0.96526575, 'specificity': 0.96526575, 'f1': 0.96524525, 'auroc': 0.99244463, 'binary_precision': 0.9826443, 'binary_recall': 0.9472812, 'binary_specificity': 0.9832504, 'binary_f1_score': 0.9646388}
confusion matrix:
       0      1
0  24890    424
1   1336  24006
---- Validation: 
scalar performance:
{'acc': 0.8787472, 'precision': 0.5698072, 'recall': 0.84857476, 'specificity': 0.84857476, 'f1': 0.5899964, 'auroc': 0.9085344, 'binary_precision': 0.14474808, 'binary_recall': 0.8168675, 'binary_specificity': 0.8802821, 'binary_f1_score': 0.24591948}
confusion matrix:
       0     1
0  14728  2003
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8667194, 'precision': 0.64355123, 'recall': 0.7692156, 'specificity': 0.7692156, 'f1': 0.6764477, 'auroc': 0.8686828, 'binary_precision': 0.3184111, 'binary_recall': 0.65414506, 'binary_specificity': 0.88428605, 'binary_f1_score': 0.4283291}
confusion matrix:
      0     1
0  8261  1081
1   267   505
new oracle model saved
early stop counter: 1
val acc:0.8787472248077393, best validation acc: 0.890003502368927, corresponding to test acc:                         0.8655329346656799 / 0.8667194247245789
after epoch: 16,now: 2024-08-06 07:18:04.613796,epoch time: 0:17:09.123654,used: 4:43:19.094135,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9651374, 'precision': 0.96542525, 'recall': 0.9651438, 'specificity': 0.9651438, 'f1': 0.9651323, 'auroc': 0.9927883, 'binary_precision': 0.9771301, 'binary_recall': 0.95260644, 'binary_specificity': 0.9776812, 'binary_f1_score': 0.96471244}
confusion matrix:
       0      1
0  24750    565
1   1201  24140
---- Validation: 
scalar performance:
{'acc': 0.87029046, 'precision': 0.5655621, 'recall': 0.8442415, 'specificity': 0.8442415, 'f1': 0.58139074, 'auroc': 0.90595627, 'binary_precision': 0.1363088, 'binary_recall': 0.8168675, 'binary_specificity': 0.8716156, 'binary_f1_score': 0.23363198}
confusion matrix:
       0     1
0  14583  2148
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8583152, 'precision': 0.6380444, 'recall': 0.77417254, 'specificity': 0.77417254, 'f1': 0.6701457, 'auroc': 0.8672197, 'binary_precision': 0.3059307, 'binary_recall': 0.6748705, 'binary_specificity': 0.87347466, 'binary_f1_score': 0.42101008}
confusion matrix:
      0     1
0  8160  1182
1   251   521
early stop counter: 2
val acc:0.8702904582023621, best validation acc: 0.890003502368927, corresponding to test acc:                         0.8655329346656799 / 0.8667194247245789
after epoch: 17,now: 2024-08-06 07:35:11.126866,epoch time: 0:17:06.513070,used: 5:00:25.607205,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9664008, 'precision': 0.96734416, 'recall': 0.9664124, 'specificity': 0.9664124, 'f1': 0.9663844, 'auroc': 0.9933659, 'binary_precision': 0.98846966, 'binary_recall': 0.9438459, 'binary_specificity': 0.98897886, 'binary_f1_score': 0.9656426}
confusion matrix:
       0      1
0  25036    279
1   1423  23918
---- Validation: 
scalar performance:
{'acc': 0.8856293, 'precision': 0.57195127, 'recall': 0.84152675, 'specificity': 0.84152675, 'f1': 0.5949472, 'auroc': 0.9085744, 'binary_precision': 0.14959203, 'binary_recall': 0.79518074, 'binary_specificity': 0.8878728, 'binary_f1_score': 0.25181228}
confusion matrix:
       0     1
0  14855  1876
1     85   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87848526, 'precision': 0.6490009, 'recall': 0.74825394, 'specificity': 0.74825394, 'f1': 0.67980075, 'auroc': 0.8672576, 'binary_precision': 0.33381817, 'binary_recall': 0.5945596, 'binary_specificity': 0.9019482, 'binary_f1_score': 0.42757335}
confusion matrix:
      0    1
0  8426  916
1   313  459
new oracle model saved
early stop counter: 3
val acc:0.8856292963027954, best validation acc: 0.890003502368927, corresponding to test acc:                         0.8655329346656799 / 0.8784852623939514
after epoch: 18,now: 2024-08-06 07:52:14.655776,epoch time: 0:17:03.528910,used: 5:17:29.136115,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96815777, 'precision': 0.96850437, 'recall': 0.9681648, 'specificity': 0.9681648, 'f1': 0.96815217, 'auroc': 0.9933834, 'binary_precision': 0.9813763, 'binary_recall': 0.95446116, 'binary_specificity': 0.98186845, 'binary_f1_score': 0.9677316}
confusion matrix:
       0      1
0  24856    459
1   1154  24187
---- Validation: 
scalar performance:
{'acc': 0.86638284, 'precision': 0.5639399, 'recall': 0.8434142, 'specificity': 0.8434142, 'f1': 0.5778667, 'auroc': 0.9091549, 'binary_precision': 0.13302034, 'binary_recall': 0.8192771, 'binary_specificity': 0.86755127, 'binary_f1_score': 0.22887917}
confusion matrix:
       0     1
0  14515  2216
1     75   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86424756, 'precision': 0.64273065, 'recall': 0.77381897, 'specificity': 0.77381897, 'f1': 0.6758021, 'auroc': 0.8715663, 'binary_precision': 0.31575722, 'binary_recall': 0.66709846, 'binary_specificity': 0.8805395, 'binary_f1_score': 0.4286309}
confusion matrix:
      0     1
0  8226  1116
1   257   515
early stop counter: 4
val acc:0.8663828372955322, best validation acc: 0.890003502368927, corresponding to test acc:                         0.8655329346656799 / 0.8784852623939514
after epoch: 19,now: 2024-08-06 08:09:12.869097,epoch time: 0:16:58.213321,used: 5:34:27.349436,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9686513, 'precision': 0.96904886, 'recall': 0.9686594, 'specificity': 0.9686594, 'f1': 0.968645, 'auroc': 0.99414253, 'binary_precision': 0.9828441, 'binary_recall': 0.95398945, 'binary_specificity': 0.98332936, 'binary_f1_score': 0.9682018}
confusion matrix:
       0      1
0  24892    422
1   1166  24176
---- Validation: 
scalar performance:
{'acc': 0.8888954, 'precision': 0.5737158, 'recall': 0.8420254, 'specificity': 0.8420254, 'f1': 0.59834534, 'auroc': 0.910519, 'binary_precision': 0.15316574, 'binary_recall': 0.7927711, 'binary_specificity': 0.89127964, 'binary_f1_score': 0.2567304}
confusion matrix:
       0     1
0  14912  1819
1     86   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87996835, 'precision': 0.6525816, 'recall': 0.7549982, 'specificity': 0.7549982, 'f1': 0.6843564, 'auroc': 0.87074876, 'binary_precision': 0.33985507, 'binary_recall': 0.60751295, 'binary_specificity': 0.9024834, 'binary_f1_score': 0.4358736}
confusion matrix:
      0    1
0  8431  911
1   303  469
new oracle model saved
early stop counter: 5
val acc:0.8888953924179077, best validation acc: 0.890003502368927, corresponding to test acc:                         0.8655329346656799 / 0.8799683451652527
after epoch: 20,now: 2024-08-06 08:26:02.146890,epoch time: 0:16:49.277793,used: 5:51:16.627229,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:51:16.627229 at 2024-08-06 08:26:02.146890
persisted model performance metric: 

scalar performance:
{'acc': 0.86553293, 'precision': 0.64368665, 'recall': 0.77332646, 'specificity': 0.77332646, 'f1': 0.67689186, 'auroc': 0.8699819, 'binary_precision': 0.31784385, 'binary_recall': 0.66450775, 'binary_specificity': 0.88214517, 'binary_f1_score': 0.43000835}
confusion matrix:
      0     1
0  8241  1101
1   259   513
oracle model performance metric: 

scalar performance:
{'acc': 0.87996835, 'precision': 0.6525816, 'recall': 0.7549982, 'specificity': 0.7549982, 'f1': 0.6843564, 'auroc': 0.87074876, 'binary_precision': 0.33985507, 'binary_recall': 0.60751295, 'binary_specificity': 0.9024834, 'binary_f1_score': 0.4358736}
confusion matrix:
      0    1
0  8431  911
1   303  469
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/13.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482695 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 482695 GiB | 482694 GiB |
|       from small pool |  18214 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   7827 MiB | 490129 GiB | 490128 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |  16663 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61220 KiB | 732464 KiB | 276937 GiB | 276937 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 269474 GiB | 269474 GiB |
|       from small pool |  10458 KiB |  13009 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6827    |   92216 K  |   92212 K  |
|       from large pool |      79    |     762    |   45625 K  |   45625 K  |
|       from small pool |    4345    |    6746    |   46591 K  |   46587 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6827    |   92216 K  |   92212 K  |
|       from large pool |      79    |     762    |   45625 K  |   45625 K  |
|       from small pool |    4345    |    6746    |   46591 K  |   46587 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3189    |   54236 K  |   54236 K  |
|       from large pool |      10    |     350    |   34657 K  |   34657 K  |
|       from small pool |      25    |    3179    |   19578 K  |   19578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482695 GiB | 482695 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482695 GiB | 482695 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490129 GiB | 490129 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 260096 KiB |   8530 MiB |   8530 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  28672 KiB |     44 MiB |     44 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276937 GiB | 276937 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269474 GiB | 269474 GiB |
|       from small pool |      0 KiB |  24597 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92216 K  |   92216 K  |
|       from large pool |       2    |     762    |   45625 K  |   45625 K  |
|       from small pool |       0    |    6746    |   46591 K  |   46591 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92216 K  |   92216 K  |
|       from large pool |       2    |     762    |   45625 K  |   45625 K  |
|       from small pool |       0    |    6746    |   46591 K  |   46591 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     371    |     371    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      14    |      22    |      22    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3189    |   54238 K  |   54238 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3179    |   19580 K  |   19580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482695 GiB | 482695 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 490155 GiB | 490155 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 482695 GiB | 482695 GiB |
|       from small pool |      0 KiB |     38 MiB |   7460 GiB |   7460 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 490129 GiB | 490129 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 482684 GiB | 482684 GiB |
|       from small pool |      0 KiB |     36 MiB |   7444 GiB |   7444 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 260096 KiB |   8530 MiB |   8530 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  28672 KiB |     44 MiB |     44 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 276937 GiB | 276937 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 269474 GiB | 269474 GiB |
|       from small pool |      0 KiB |  24597 KiB |   7463 GiB |   7463 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   92216 K  |   92216 K  |
|       from large pool |       2    |     762    |   45625 K  |   45625 K  |
|       from small pool |       0    |    6746    |   46591 K  |   46591 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   92216 K  |   92216 K  |
|       from large pool |       2    |     762    |   45625 K  |   45625 K  |
|       from small pool |       0    |    6746    |   46591 K  |   46591 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     371    |     371    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      14    |      22    |      22    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3189    |   54238 K  |   54238 K  |
|       from large pool |       3    |     350    |   34657 K  |   34657 K  |
|       from small pool |       0    |    3179    |   19580 K  |   19580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672

 Experiment start at: 2024-08-06 08:48:55.144169
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.81936574, 'precision': 0.8198832, 'recall': 0.8193792, 'specificity': 0.8193792, 'f1': 0.81929696, 'auroc': 0.8926026, 'binary_precision': 0.8329168, 'binary_recall': 0.79931587, 'binary_specificity': 0.8394425, 'binary_f1_score': 0.8157705}
confusion matrix:
       0      1
0  21321   4078
1   5104  20329
---- Validation: 
scalar performance:
{'acc': 0.8731531, 'precision': 0.5025467, 'recall': 0.5100069, 'specificity': 0.5100069, 'f1': 0.49012595, 'auroc': 0.7268895, 'binary_precision': 0.029713668, 'binary_recall': 0.1276102, 'binary_specificity': 0.89240354, 'binary_f1_score': 0.048203334}
confusion matrix:
       0     1
0  14896  1796
1    376    55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.789119, 'precision': 0.49228528, 'recall': 0.48543143, 'specificity': 0.48543143, 'f1': 0.48219985, 'auroc': 0.6321876, 'binary_precision': 0.061980832, 'binary_recall': 0.12813738, 'binary_specificity': 0.8427255, 'binary_f1_score': 0.08354867}
confusion matrix:
      0     1
0  7866  1468
1   660    97
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 09:08:04.499292,epoch time: 0:19:09.355123,used: 0:19:09.355123,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8811575, 'precision': 0.8856261, 'recall': 0.88119996, 'specificity': 0.88119996, 'f1': 0.8808205, 'auroc': 0.9419547, 'binary_precision': 0.9273344, 'binary_recall': 0.82733136, 'binary_specificity': 0.9350685, 'binary_f1_score': 0.87448317}
confusion matrix:
       0      1
0  23747   1649
1   4392  21044
---- Validation: 
scalar performance:
{'acc': 0.8986743, 'precision': 0.5123825, 'recall': 0.5389189, 'specificity': 0.5389189, 'f1': 0.5100423, 'auroc': 0.7749068, 'binary_precision': 0.047850206, 'binary_recall': 0.1600928, 'binary_specificity': 0.91774505, 'binary_f1_score': 0.07367859}
confusion matrix:
       0     1
0  15319  1373
1    362    69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8283619, 'precision': 0.51349944, 'recall': 0.5206037, 'specificity': 0.5206037, 'f1': 0.51329565, 'auroc': 0.7072848, 'binary_precision': 0.09876543, 'binary_recall': 0.15852048, 'binary_specificity': 0.882687, 'binary_f1_score': 0.121703856}
confusion matrix:
      0     1
0  8239  1095
1   637   120
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 09:25:48.816674,epoch time: 0:17:44.317382,used: 0:36:53.672505,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9028368, 'precision': 0.9076765, 'recall': 0.9028797, 'specificity': 0.9028797, 'f1': 0.9025543, 'auroc': 0.9585538, 'binary_precision': 0.9522927, 'binary_recall': 0.8483252, 'binary_specificity': 0.95743424, 'binary_f1_score': 0.8973074}
confusion matrix:
       0      1
0  24315   1081
1   3858  21578
---- Validation: 
scalar performance:
{'acc': 0.90784323, 'precision': 0.5340326, 'recall': 0.6035191, 'specificity': 0.6035191, 'f1': 0.54262555, 'auroc': 0.80584586, 'binary_precision': 0.087706685, 'binary_recall': 0.28306264, 'binary_specificity': 0.9239756, 'binary_f1_score': 0.13391876}
confusion matrix:
       0     1
0  15423  1269
1    309   122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8352988, 'precision': 0.54957414, 'recall': 0.58201224, 'specificity': 0.58201224, 'f1': 0.55683553, 'auroc': 0.75987744, 'binary_precision': 0.1610487, 'binary_recall': 0.28401586, 'binary_specificity': 0.8800086, 'binary_f1_score': 0.20554495}
confusion matrix:
      0     1
0  8214  1120
1   542   215
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 09:43:41.857986,epoch time: 0:17:53.041312,used: 0:54:46.713817,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9188503, 'precision': 0.9228517, 'recall': 0.9188906, 'specificity': 0.9188906, 'f1': 0.9186631, 'auroc': 0.9703008, 'binary_precision': 0.9641924, 'binary_recall': 0.8701498, 'binary_specificity': 0.9676314, 'binary_f1_score': 0.9147604}
confusion matrix:
       0      1
0  24573    822
1   3303  22134
---- Validation: 
scalar performance:
{'acc': 0.9138002, 'precision': 0.5536845, 'recall': 0.6630814, 'specificity': 0.6630814, 'f1': 0.571746, 'auroc': 0.827918, 'binary_precision': 0.123830095, 'binary_recall': 0.39907193, 'binary_specificity': 0.9270908, 'binary_f1_score': 0.189011}
confusion matrix:
       0     1
0  15475  1217
1    259   172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8412447, 'precision': 0.5873691, 'recall': 0.6617, 'specificity': 0.6617, 'f1': 0.60454583, 'auroc': 0.8050468, 'binary_precision': 0.22331369, 'binary_recall': 0.45046234, 'binary_specificity': 0.8729376, 'binary_f1_score': 0.29859895}
confusion matrix:
      0     1
0  8148  1186
1   416   341
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 10:00:53.398409,epoch time: 0:17:11.540423,used: 1:11:58.254240,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92833257, 'precision': 0.93203545, 'recall': 0.92836726, 'specificity': 0.92836726, 'f1': 0.9281826, 'auroc': 0.97795343, 'binary_precision': 0.9722198, 'binary_recall': 0.8819737, 'binary_specificity': 0.9747608, 'binary_f1_score': 0.9249006}
confusion matrix:
       0      1
0  24756    641
1   3002  22433
---- Validation: 
scalar performance:
{'acc': 0.9241371, 'precision': 0.57307184, 'recall': 0.70567787, 'specificity': 0.70567787, 'f1': 0.5999913, 'auroc': 0.8458952, 'binary_precision': 0.16040689, 'binary_recall': 0.47563806, 'binary_specificity': 0.9357177, 'binary_f1_score': 0.23990637}
confusion matrix:
       0     1
0  15619  1073
1    226   205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84976715, 'precision': 0.61249876, 'recall': 0.7172893, 'specificity': 0.7172893, 'f1': 0.63708204, 'auroc': 0.8334254, 'binary_precision': 0.2641392, 'binary_recall': 0.5614267, 'binary_specificity': 0.8731519, 'binary_f1_score': 0.35925612}
confusion matrix:
      0     1
0  8150  1184
1   332   425
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 10:17:59.662481,epoch time: 0:17:06.264072,used: 1:29:04.518312,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9368508, 'precision': 0.93921375, 'recall': 0.9368769, 'specificity': 0.9368769, 'f1': 0.9367683, 'auroc': 0.9822672, 'binary_precision': 0.97160685, 'binary_recall': 0.9000944, 'binary_specificity': 0.97365934, 'binary_f1_score': 0.9344845}
confusion matrix:
       0      1
0  24729    669
1   2541  22893
---- Validation: 
scalar performance:
{'acc': 0.9275244, 'precision': 0.5847738, 'recall': 0.737929, 'specificity': 0.737929, 'f1': 0.6170021, 'auroc': 0.8575635, 'binary_precision': 0.1821036, 'binary_recall': 0.53828305, 'binary_specificity': 0.93757486, 'binary_f1_score': 0.27214077}
confusion matrix:
       0     1
0  15650  1042
1    199   232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84798336, 'precision': 0.6202912, 'recall': 0.74545795, 'specificity': 0.74545795, 'f1': 0.6473974, 'auroc': 0.8475112, 'binary_precision': 0.27452117, 'binary_recall': 0.6248349, 'binary_specificity': 0.866081, 'binary_f1_score': 0.3814516}
confusion matrix:
      0     1
0  8084  1250
1   284   473
better model found
persisted
after epoch: 6,now: 2024-08-06 10:35:26.086896,epoch time: 0:17:26.424415,used: 1:46:30.942727,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9418477, 'precision': 0.94429326, 'recall': 0.94187546, 'specificity': 0.94187546, 'f1': 0.94177, 'auroc': 0.9841695, 'binary_precision': 0.97744364, 'binary_recall': 0.9046589, 'binary_specificity': 0.979092, 'binary_f1_score': 0.9396439}
confusion matrix:
       0      1
0  24866    531
1   2425  23010
---- Validation: 
scalar performance:
{'acc': 0.9288092, 'precision': 0.58806074, 'recall': 0.74536884, 'specificity': 0.74536884, 'f1': 0.62168854, 'auroc': 0.8607957, 'binary_precision': 0.18829113, 'binary_recall': 0.5522042, 'binary_specificity': 0.9385334, 'binary_f1_score': 0.28082597}
confusion matrix:
       0     1
0  15666  1026
1    193   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8495689, 'precision': 0.62937135, 'recall': 0.7724132, 'specificity': 0.7724132, 'f1': 0.65930617, 'auroc': 0.8608887, 'binary_precision': 0.28778583, 'binary_recall': 0.68163806, 'binary_specificity': 0.8631883, 'binary_f1_score': 0.40470588}
confusion matrix:
      0     1
0  8057  1277
1   241   516
better model found
persisted
after epoch: 7,now: 2024-08-06 10:52:57.576771,epoch time: 0:17:31.489875,used: 2:04:02.432602,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9467068, 'precision': 0.9486079, 'recall': 0.9467312, 'specificity': 0.9467312, 'f1': 0.9466523, 'auroc': 0.98676264, 'binary_precision': 0.9779993, 'binary_recall': 0.9140554, 'binary_specificity': 0.979407, 'binary_f1_score': 0.9449468}
confusion matrix:
       0      1
0  24874    523
1   2186  23249
---- Validation: 
scalar performance:
{'acc': 0.9342989, 'precision': 0.5979059, 'recall': 0.75722563, 'specificity': 0.75722563, 'f1': 0.6348943, 'auroc': 0.8677808, 'binary_precision': 0.2074199, 'binary_recall': 0.5707657, 'binary_specificity': 0.9436856, 'binary_f1_score': 0.30426717}
confusion matrix:
       0    1
0  15752  940
1    185  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515509, 'precision': 0.63682985, 'recall': 0.7941203, 'specificity': 0.7941203, 'f1': 0.66910577, 'auroc': 0.8710861, 'binary_precision': 0.29875067, 'binary_recall': 0.7265522, 'binary_specificity': 0.86168844, 'binary_f1_score': 0.4234026}
confusion matrix:
      0     1
0  8043  1291
1   207   550
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-06 11:10:29.115054,epoch time: 0:17:31.538283,used: 2:21:33.970885,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95129055, 'precision': 0.9524591, 'recall': 0.9513137, 'specificity': 0.9513137, 'f1': 0.9512608, 'auroc': 0.98824775, 'binary_precision': 0.9756805, 'binary_recall': 0.92574394, 'binary_specificity': 0.9768834, 'binary_f1_score': 0.9500565}
confusion matrix:
       0      1
0  24806    587
1   1889  23550
---- Validation: 
scalar performance:
{'acc': 0.9343573, 'precision': 0.60072714, 'recall': 0.76855695, 'specificity': 0.76855695, 'f1': 0.6392453, 'auroc': 0.8712225, 'binary_precision': 0.21244814, 'binary_recall': 0.5939675, 'binary_specificity': 0.9431464, 'binary_f1_score': 0.31295842}
confusion matrix:
       0    1
0  15743  949
1    175  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84828067, 'precision': 0.63877416, 'recall': 0.80934674, 'specificity': 0.80934674, 'f1': 0.6713544, 'auroc': 0.87803936, 'binary_precision': 0.29948187, 'binary_recall': 0.76354027, 'binary_specificity': 0.8551532, 'binary_f1_score': 0.4302196}
confusion matrix:
      0     1
0  7982  1352
1   179   578
better model found
persisted
after epoch: 9,now: 2024-08-06 11:27:59.173223,epoch time: 0:17:30.058169,used: 2:39:04.029054,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9530807, 'precision': 0.95484185, 'recall': 0.9531066, 'specificity': 0.9531066, 'f1': 0.95303714, 'auroc': 0.9890071, 'binary_precision': 0.9833515, 'binary_recall': 0.92184615, 'binary_specificity': 0.984367, 'binary_f1_score': 0.9516061}
confusion matrix:
       0      1
0  24998    397
1   1988  23449
---- Validation: 
scalar performance:
{'acc': 0.9389126, 'precision': 0.60673165, 'recall': 0.7652427, 'specificity': 0.7652427, 'f1': 0.6461499, 'auroc': 0.87261915, 'binary_precision': 0.22470905, 'binary_recall': 0.5823666, 'binary_specificity': 0.94811887, 'binary_f1_score': 0.3242894}
confusion matrix:
       0    1
0  15826  866
1    180  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85165, 'precision': 0.64198786, 'recall': 0.8129889, 'specificity': 0.8129889, 'f1': 0.6757879, 'auroc': 0.8824977, 'binary_precision': 0.30546793, 'binary_recall': 0.7675033, 'binary_specificity': 0.8584744, 'binary_f1_score': 0.4370064}
confusion matrix:
      0     1
0  8013  1321
1   176   581
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-06 11:45:30.958581,epoch time: 0:17:31.785358,used: 2:56:35.814412,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95402503, 'precision': 0.95475006, 'recall': 0.9540392, 'specificity': 0.9540392, 'f1': 0.95400774, 'auroc': 0.98946273, 'binary_precision': 0.9730859, 'binary_recall': 0.93394667, 'binary_specificity': 0.9741318, 'binary_f1_score': 0.9531147}
confusion matrix:
       0      1
0  24741    657
1   1680  23754
---- Validation: 
scalar performance:
{'acc': 0.9344741, 'precision': 0.6053747, 'recall': 0.7878293, 'specificity': 0.7878293, 'f1': 0.64644885, 'auroc': 0.8762289, 'binary_precision': 0.22069523, 'binary_recall': 0.6334107, 'binary_specificity': 0.9422478, 'binary_f1_score': 0.3273381}
confusion matrix:
       0    1
0  15728  964
1    158  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84917253, 'precision': 0.6417401, 'recall': 0.81832594, 'specificity': 0.81832594, 'f1': 0.67522764, 'auroc': 0.8867532, 'binary_precision': 0.3037455, 'binary_recall': 0.78203434, 'binary_specificity': 0.85461754, 'binary_f1_score': 0.43754616}
confusion matrix:
      0     1
0  7977  1357
1   165   592
early stop counter: 1
val acc:0.9344741106033325, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 11,now: 2024-08-06 12:02:58.472940,epoch time: 0:17:27.514359,used: 3:14:03.328771,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9585891, 'precision': 0.95942, 'recall': 0.9586076, 'specificity': 0.9586076, 'f1': 0.9585715, 'auroc': 0.9910016, 'binary_precision': 0.9791761, 'binary_recall': 0.9371806, 'binary_specificity': 0.98003465, 'binary_f1_score': 0.9577182}
confusion matrix:
       0      1
0  24887    507
1   1598  23840
---- Validation: 
scalar performance:
{'acc': 0.9292764, 'precision': 0.60214514, 'recall': 0.80437565, 'specificity': 0.80437565, 'f1': 0.6432641, 'auroc': 0.8819463, 'binary_precision': 0.21323529, 'binary_recall': 0.6728538, 'binary_specificity': 0.9358974, 'binary_f1_score': 0.32384142}
confusion matrix:
       0     1
0  15622  1070
1    141   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84213656, 'precision': 0.6387216, 'recall': 0.82362664, 'specificity': 0.82362664, 'f1': 0.67040336, 'auroc': 0.88982975, 'binary_precision': 0.29609755, 'binary_recall': 0.8018494, 'binary_specificity': 0.8454039, 'binary_f1_score': 0.43249017}
confusion matrix:
      0     1
0  7891  1443
1   150   607
early stop counter: 2
val acc:0.9292764067649841, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 12,now: 2024-08-06 12:20:25.255918,epoch time: 0:17:26.782978,used: 3:31:30.111749,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96053666, 'precision': 0.9611478, 'recall': 0.96055037, 'specificity': 0.96055037, 'f1': 0.96052444, 'auroc': 0.99142396, 'binary_precision': 0.97812337, 'binary_recall': 0.9422056, 'binary_specificity': 0.9788951, 'binary_f1_score': 0.95982856}
confusion matrix:
       0      1
0  24861    536
1   1470  23965
---- Validation: 
scalar performance:
{'acc': 0.9167202, 'precision': 0.5918513, 'recall': 0.81940806, 'specificity': 0.81940806, 'f1': 0.6290327, 'auroc': 0.88475823, 'binary_precision': 0.19156851, 'binary_recall': 0.71693736, 'binary_specificity': 0.92187876, 'binary_f1_score': 0.30234835}
confusion matrix:
       0     1
0  15388  1304
1    122   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8269745, 'precision': 0.63276035, 'recall': 0.832425, 'specificity': 0.832425, 'f1': 0.6596874, 'auroc': 0.8922483, 'binary_precision': 0.28109783, 'binary_recall': 0.8388375, 'binary_specificity': 0.82601243, 'binary_f1_score': 0.42108756}
confusion matrix:
      0     1
0  7710  1624
1   122   635
early stop counter: 3
val acc:0.9167202115058899, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 13,now: 2024-08-06 12:38:01.810275,epoch time: 0:17:36.554357,used: 3:49:06.666106,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9596514, 'precision': 0.9604911, 'recall': 0.9596692, 'specificity': 0.9596692, 'f1': 0.95963407, 'auroc': 0.9916607, 'binary_precision': 0.98036313, 'binary_recall': 0.93816096, 'binary_specificity': 0.9811774, 'binary_f1_score': 0.95879793}
confusion matrix:
       0      1
0  24917    478
1   1573  23864
---- Validation: 
scalar performance:
{'acc': 0.9272908, 'precision': 0.6014416, 'recall': 0.8123983, 'specificity': 0.8123983, 'f1': 0.6426585, 'auroc': 0.8843316, 'binary_precision': 0.21134752, 'binary_recall': 0.6914153, 'binary_specificity': 0.93338126, 'binary_f1_score': 0.32373708}
confusion matrix:
       0     1
0  15580  1112
1    133   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83292043, 'precision': 0.63633925, 'recall': 0.8344252, 'specificity': 0.8344252, 'f1': 0.66550463, 'auroc': 0.89238995, 'binary_precision': 0.28838268, 'binary_recall': 0.8361955, 'binary_specificity': 0.83265483, 'binary_f1_score': 0.42886177}
confusion matrix:
      0     1
0  7772  1562
1   124   633
early stop counter: 4
val acc:0.9272907972335815, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 14,now: 2024-08-06 12:55:38.851146,epoch time: 0:17:37.040871,used: 4:06:43.706977,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9635859, 'precision': 0.9639956, 'recall': 0.9635984, 'specificity': 0.9635984, 'f1': 0.9635786, 'auroc': 0.9926238, 'binary_precision': 0.9779912, 'binary_recall': 0.94857883, 'binary_specificity': 0.97861785, 'binary_f1_score': 0.9630605}
confusion matrix:
       0      1
0  24852    543
1   1308  24129
---- Validation: 
scalar performance:
{'acc': 0.9105881, 'precision': 0.5859704, 'recall': 0.81626284, 'specificity': 0.81626284, 'f1': 0.61993825, 'auroc': 0.8846458, 'binary_precision': 0.17986031, 'binary_recall': 0.71693736, 'binary_specificity': 0.9155883, 'binary_f1_score': 0.2875756}
confusion matrix:
       0     1
0  15283  1409
1    122   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.822416, 'precision': 0.6322884, 'recall': 0.8390649, 'specificity': 0.8390649, 'f1': 0.6577916, 'auroc': 0.89618313, 'binary_precision': 0.2783726, 'binary_recall': 0.8586526, 'binary_specificity': 0.8194772, 'binary_f1_score': 0.42043987}
confusion matrix:
      0     1
0  7649  1685
1   107   650
early stop counter: 5
val acc:0.9105880856513977, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 15,now: 2024-08-06 13:13:17.309409,epoch time: 0:17:38.458263,used: 4:24:22.165240,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96299577, 'precision': 0.9633555, 'recall': 0.96300626, 'specificity': 0.96300626, 'f1': 0.96298915, 'auroc': 0.9923414, 'binary_precision': 0.9764544, 'binary_recall': 0.94892865, 'binary_specificity': 0.9770839, 'binary_f1_score': 0.96249473}
confusion matrix:
       0      1
0  24815    582
1   1299  24136
---- Validation: 
scalar performance:
{'acc': 0.9094785, 'precision': 0.58649355, 'recall': 0.8236047, 'specificity': 0.8236047, 'f1': 0.6206509, 'auroc': 0.88631356, 'binary_precision': 0.1804683, 'binary_recall': 0.7331787, 'binary_specificity': 0.9140307, 'binary_f1_score': 0.28964254}
confusion matrix:
       0     1
0  15257  1435
1    115   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8182539, 'precision': 0.63026595, 'recall': 0.8386358, 'specificity': 0.8386358, 'f1': 0.6541535, 'auroc': 0.89698774, 'binary_precision': 0.27402434, 'binary_recall': 0.8626156, 'binary_specificity': 0.8146561, 'binary_f1_score': 0.41592357}
confusion matrix:
      0     1
0  7604  1730
1   104   653
early stop counter: 6
val acc:0.909478485584259, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 16,now: 2024-08-06 13:30:47.266220,epoch time: 0:17:29.956811,used: 4:41:52.122051,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9640384, 'precision': 0.96463156, 'recall': 0.9640504, 'specificity': 0.9640504, 'f1': 0.9640275, 'auroc': 0.9931444, 'binary_precision': 0.98140067, 'binary_recall': 0.94605434, 'binary_specificity': 0.98204654, 'binary_f1_score': 0.9634034}
confusion matrix:
       0      1
0  24943    456
1   1372  24061
---- Validation: 
scalar performance:
{'acc': 0.9123401, 'precision': 0.5873565, 'recall': 0.81603134, 'specificity': 0.81603134, 'f1': 0.6221299, 'auroc': 0.88507926, 'binary_precision': 0.1826809, 'binary_recall': 0.7146172, 'binary_specificity': 0.9174455, 'binary_f1_score': 0.2909778}
confusion matrix:
       0     1
0  15314  1378
1    123   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81944305, 'precision': 0.63112754, 'recall': 0.8398856, 'specificity': 0.8398856, 'f1': 0.65552086, 'auroc': 0.8986727, 'binary_precision': 0.2756005, 'binary_recall': 0.8639366, 'binary_specificity': 0.8158346, 'binary_f1_score': 0.41789135}
confusion matrix:
      0     1
0  7615  1719
1   103   654
early stop counter: 7
val acc:0.9123401045799255, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 17,now: 2024-08-06 13:48:44.313525,epoch time: 0:17:57.047305,used: 4:59:49.169356,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9669696, 'precision': 0.9674896, 'recall': 0.96698284, 'specificity': 0.96698284, 'f1': 0.9669611, 'auroc': 0.99381614, 'binary_precision': 0.9832784, 'binary_recall': 0.9501494, 'binary_specificity': 0.9838163, 'binary_f1_score': 0.96643007}
confusion matrix:
       0      1
0  24985    411
1   1268  24168
---- Validation: 
scalar performance:
{'acc': 0.9172458, 'precision': 0.59149396, 'recall': 0.81515706, 'specificity': 0.81515706, 'f1': 0.6284785, 'auroc': 0.8869055, 'binary_precision': 0.19110276, 'binary_recall': 0.7076566, 'binary_specificity': 0.92265755, 'binary_f1_score': 0.30093735}
confusion matrix:
       0     1
0  15401  1291
1    126   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8292538, 'precision': 0.6358047, 'recall': 0.8397264, 'specificity': 0.8397264, 'f1': 0.6638948, 'auroc': 0.90035355, 'binary_precision': 0.28590426, 'binary_recall': 0.85204756, 'binary_specificity': 0.8274052, 'binary_f1_score': 0.4281447}
confusion matrix:
      0     1
0  7723  1611
1   112   645
early stop counter: 8
val acc:0.9172458052635193, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 18,now: 2024-08-06 14:07:25.742075,epoch time: 0:18:41.428550,used: 5:18:30.597906,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9678549, 'precision': 0.96829385, 'recall': 0.9678677, 'specificity': 0.9678677, 'f1': 0.96784794, 'auroc': 0.9941072, 'binary_precision': 0.98283905, 'binary_recall': 0.95239216, 'binary_specificity': 0.9833432, 'binary_f1_score': 0.9673761}
confusion matrix:
       0      1
0  24972    423
1   1211  24226
---- Validation: 
scalar performance:
{'acc': 0.9104713, 'precision': 0.5875974, 'recall': 0.82524407, 'specificity': 0.82524407, 'f1': 0.62239105, 'auroc': 0.88846207, 'binary_precision': 0.18260369, 'binary_recall': 0.73549885, 'binary_specificity': 0.91498923, 'binary_f1_score': 0.29257038}
confusion matrix:
       0     1
0  15273  1419
1    114   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8172629, 'precision': 0.63015836, 'recall': 0.839921, 'specificity': 0.839921, 'f1': 0.6537056, 'auroc': 0.9000497, 'binary_precision': 0.27344728, 'binary_recall': 0.8665786, 'binary_specificity': 0.81326336, 'binary_f1_score': 0.4157161}
confusion matrix:
      0     1
0  7591  1743
1   101   656
early stop counter: 9
val acc:0.9104713201522827, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 19,now: 2024-08-06 14:24:58.257740,epoch time: 0:17:32.515665,used: 5:36:03.113571,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96669424, 'precision': 0.96711916, 'recall': 0.96670496, 'specificity': 0.96670496, 'f1': 0.96668714, 'auroc': 0.9939754, 'binary_precision': 0.9813861, 'binary_recall': 0.9514823, 'binary_specificity': 0.9819277, 'binary_f1_score': 0.96620286}
confusion matrix:
       0      1
0  24939    459
1   1234  24200
---- Validation: 
scalar performance:
{'acc': 0.9192898, 'precision': 0.5945486, 'recall': 0.82072604, 'specificity': 0.82072604, 'f1': 0.633071, 'auroc': 0.88703394, 'binary_precision': 0.19694072, 'binary_recall': 0.71693736, 'binary_specificity': 0.9245147, 'binary_f1_score': 0.30900002}
confusion matrix:
       0     1
0  15432  1260
1    122   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8376771, 'precision': 0.6416331, 'recall': 0.84488654, 'specificity': 0.84488654, 'f1': 0.6730051, 'auroc': 0.90090686, 'binary_precision': 0.29728487, 'binary_recall': 0.8533686, 'binary_specificity': 0.83640456, 'binary_f1_score': 0.44095567}
confusion matrix:
      0     1
0  7807  1527
1   111   646
early stop counter: 10
val acc:0.9192898273468018, best validation acc: 0.938912570476532, corresponding to test acc:                         0.8516499996185303 / 0.8516499996185303
after epoch: 20,now: 2024-08-06 14:44:10.658616,epoch time: 0:19:12.400876,used: 5:55:15.514447,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_08_48_54_seed_1_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:55:15.514447 at 2024-08-06 14:44:10.658616
persisted model performance metric: 

scalar performance:
{'acc': 0.85165, 'precision': 0.64198786, 'recall': 0.8129889, 'specificity': 0.8129889, 'f1': 0.6757879, 'auroc': 0.8824977, 'binary_precision': 0.30546793, 'binary_recall': 0.7675033, 'binary_specificity': 0.8584744, 'binary_f1_score': 0.4370064}
confusion matrix:
      0     1
0  8013  1321
1   176   581
oracle model performance metric: 

scalar performance:
{'acc': 0.85165, 'precision': 0.64198786, 'recall': 0.8129889, 'specificity': 0.8129889, 'f1': 0.6757879, 'auroc': 0.8824977, 'binary_precision': 0.30546793, 'binary_recall': 0.7675033, 'binary_specificity': 0.8584744, 'binary_f1_score': 0.4370064}
confusion matrix:
      0     1
0  8013  1321
1   176   581
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |  18208 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |  16662 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16788 MiB |   8276 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     54 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38101 KiB | 732464 KiB | 548717 GiB | 548717 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 533712 GiB | 533712 GiB |
|       from small pool |   6368 KiB |  24597 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6849    |  185261 K  |  185256 K  |
|       from large pool |      79    |     762    |   91849 K  |   91849 K  |
|       from small pool |    4333    |    6768    |   93411 K  |   93407 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6849    |  185261 K  |  185256 K  |
|       from large pool |      79    |     762    |   91849 K  |   91849 K  |
|       from small pool |    4333    |    6768    |   93411 K  |   93407 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     714    |     346    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      22    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3199    |  103703 K  |  103703 K  |
|       from large pool |      11    |     352    |   63924 K  |   63924 K  |
|       from small pool |      19    |    3189    |   39779 K  |   39779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548718 GiB | 548718 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533712 GiB | 533712 GiB |
|       from small pool |      0 KiB |  24597 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185261 K  |  185261 K  |
|       from large pool |       2    |     762    |   91849 K  |   91849 K  |
|       from small pool |       0    |    6768    |   93411 K  |   93411 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185261 K  |  185261 K  |
|       from large pool |       2    |     762    |   91849 K  |   91849 K  |
|       from small pool |       0    |    6768    |   93411 K  |   93411 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     714    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  103705 K  |  103705 K  |
|       from large pool |       3    |     352    |   63924 K  |   63924 K  |
|       from small pool |       0    |    3189    |   39781 K  |   39781 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     38 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    963 TiB |    963 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    949 TiB |    949 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 548718 GiB | 548718 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 533712 GiB | 533712 GiB |
|       from small pool |      0 KiB |  24597 KiB |  15005 GiB |  15005 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  185261 K  |  185261 K  |
|       from large pool |       2    |     762    |   91849 K  |   91849 K  |
|       from small pool |       0    |    6768    |   93411 K  |   93411 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  185261 K  |  185261 K  |
|       from large pool |       2    |     762    |   91849 K  |   91849 K  |
|       from small pool |       0    |    6768    |   93411 K  |   93411 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     714    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |  103705 K  |  103705 K  |
|       from large pool |       3    |     352    |   63924 K  |   63924 K  |
|       from small pool |       0    |    3189    |   39781 K  |   39781 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672

 Experiment start at: 2024-08-06 15:09:05.073133
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86337435, 'precision': 0.8676331, 'recall': 0.86338055, 'specificity': 0.86338055, 'f1': 0.86297894, 'auroc': 0.93071026, 'binary_precision': 0.9072308, 'binary_recall': 0.8095625, 'binary_specificity': 0.91719866, 'binary_f1_score': 0.8556185}
confusion matrix:
       0      1
0  23705   2140
1   4923  20928
---- Validation: 
scalar performance:
{'acc': 0.82375616, 'precision': 0.51998484, 'recall': 0.61927867, 'specificity': 0.61927867, 'f1': 0.50150996, 'auroc': 0.6877219, 'binary_precision': 0.057522126, 'binary_recall': 0.40430623, 'binary_specificity': 0.83425117, 'binary_f1_score': 0.10071514}
confusion matrix:
       0     1
0  13937  2769
1    249   169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76634955, 'precision': 0.5830615, 'recall': 0.71944344, 'specificity': 0.71944344, 'f1': 0.584547, 'auroc': 0.7786443, 'binary_precision': 0.2019855, 'binary_recall': 0.663739, 'binary_specificity': 0.7751479, 'binary_f1_score': 0.309719}
confusion matrix:
      0     1
0  7205  2090
1   268   529
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 15:28:25.209182,epoch time: 0:19:20.136049,used: 0:19:20.136049,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9053892, 'precision': 0.910019, 'recall': 0.9054015, 'specificity': 0.9054015, 'f1': 0.90512323, 'auroc': 0.9601405, 'binary_precision': 0.9536464, 'binary_recall': 0.85224724, 'binary_specificity': 0.9585558, 'binary_f1_score': 0.9001001}
confusion matrix:
       0      1
0  24771   1071
1   3820  22034
---- Validation: 
scalar performance:
{'acc': 0.90755665, 'precision': 0.53289956, 'recall': 0.6039152, 'specificity': 0.6039152, 'f1': 0.54094005, 'auroc': 0.73180175, 'binary_precision': 0.084818244, 'binary_recall': 0.284689, 'binary_specificity': 0.92314136, 'binary_f1_score': 0.13069741}
confusion matrix:
       0     1
0  15422  1284
1    299   119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493857, 'precision': 0.6071061, 'recall': 0.6876644, 'specificity': 0.6876644, 'f1': 0.6284758, 'auroc': 0.7976996, 'binary_precision': 0.26107073, 'binary_recall': 0.49560854, 'binary_specificity': 0.8797203, 'binary_f1_score': 0.34199134}
confusion matrix:
      0     1
0  8177  1118
1   402   395
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 15:46:50.895108,epoch time: 0:18:25.685926,used: 0:37:45.821975,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92208296, 'precision': 0.924937, 'recall': 0.9220893, 'specificity': 0.9220893, 'f1': 0.92195266, 'auroc': 0.97175825, 'binary_precision': 0.95980114, 'binary_recall': 0.88109237, 'binary_specificity': 0.9630862, 'binary_f1_score': 0.9187641}
confusion matrix:
       0      1
0  24890    954
1   3074  22778
---- Validation: 
scalar performance:
{'acc': 0.90527916, 'precision': 0.54009444, 'recall': 0.6342365, 'specificity': 0.6342365, 'f1': 0.55119807, 'auroc': 0.76625943, 'binary_precision': 0.09759358, 'binary_recall': 0.3492823, 'binary_specificity': 0.9191907, 'binary_f1_score': 0.15256009}
confusion matrix:
       0     1
0  15356  1350
1    272   146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85453826, 'precision': 0.6149942, 'recall': 0.69906497, 'specificity': 0.69906497, 'f1': 0.6381811, 'auroc': 0.81668127, 'binary_precision': 0.27498323, 'binary_recall': 0.5144291, 'binary_specificity': 0.8837009, 'binary_f1_score': 0.3583916}
confusion matrix:
      0     1
0  8214  1081
1   387   410
new oracle model saved
early stop counter: 1
val acc:0.9052791595458984, best validation acc: 0.9075566530227661, corresponding to test acc:                         0.849385678768158 / 0.8545382618904114
after epoch: 3,now: 2024-08-06 16:05:07.748583,epoch time: 0:18:16.853475,used: 0:56:02.675450,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93368924, 'precision': 0.93532205, 'recall': 0.9336976, 'specificity': 0.9336976, 'f1': 0.9336279, 'auroc': 0.97784185, 'binary_precision': 0.9620504, 'binary_recall': 0.9030362, 'binary_specificity': 0.964359, 'binary_f1_score': 0.93160963}
confusion matrix:
       0      1
0  24920    921
1   2507  23348
---- Validation: 
scalar performance:
{'acc': 0.904228, 'precision': 0.5503298, 'recall': 0.678015, 'specificity': 0.678015, 'f1': 0.5661992, 'auroc': 0.7913411, 'binary_precision': 0.11572327, 'binary_recall': 0.4401914, 'binary_specificity': 0.9158386, 'binary_f1_score': 0.18326694}
confusion matrix:
       0     1
0  15300  1406
1    234   184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86494255, 'precision': 0.62940454, 'recall': 0.71561086, 'specificity': 0.71561086, 'f1': 0.6552172, 'auroc': 0.8328415, 'binary_precision': 0.30126405, 'binary_recall': 0.5382685, 'binary_specificity': 0.8929532, 'binary_f1_score': 0.38631248}
confusion matrix:
      0    1
0  8300  995
1   368  429
new oracle model saved
early stop counter: 2
val acc:0.9042279720306396, best validation acc: 0.9075566530227661, corresponding to test acc:                         0.849385678768158 / 0.8649425506591797
after epoch: 4,now: 2024-08-06 16:23:17.538969,epoch time: 0:18:09.790386,used: 1:14:12.465836,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9385639, 'precision': 0.9405252, 'recall': 0.93856776, 'specificity': 0.93856776, 'f1': 0.93849576, 'auroc': 0.9807955, 'binary_precision': 0.9699482, 'binary_recall': 0.9051874, 'binary_specificity': 0.97194815, 'binary_f1_score': 0.93644947}
confusion matrix:
       0      1
0  25120    725
1   2451  23400
---- Validation: 
scalar performance:
{'acc': 0.9176594, 'precision': 0.5622988, 'recall': 0.6930624, 'specificity': 0.6930624, 'f1': 0.58486307, 'auroc': 0.807088, 'binary_precision': 0.13901019, 'binary_recall': 0.4569378, 'binary_specificity': 0.9291871, 'binary_f1_score': 0.21316963}
confusion matrix:
       0     1
0  15523  1183
1    227   191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8816885, 'precision': 0.6422639, 'recall': 0.70061225, 'specificity': 0.70061225, 'f1': 0.66387296, 'auroc': 0.84068465, 'binary_precision': 0.33048677, 'binary_recall': 0.48557088, 'binary_specificity': 0.9156536, 'binary_f1_score': 0.39329267}
confusion matrix:
      0    1
0  8511  784
1   410  387
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 16:41:22.818898,epoch time: 0:18:05.279929,used: 1:32:17.745765,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9444638, 'precision': 0.94611835, 'recall': 0.9444661, 'specificity': 0.9444661, 'f1': 0.94441247, 'auroc': 0.9840803, 'binary_precision': 0.9733059, 'binary_recall': 0.91400385, 'binary_specificity': 0.97492844, 'binary_f1_score': 0.94272316}
confusion matrix:
       0      1
0  25198    648
1   2223  23627
---- Validation: 
scalar performance:
{'acc': 0.9104765, 'precision': 0.5625333, 'recall': 0.71503854, 'specificity': 0.71503854, 'f1': 0.58499026, 'auroc': 0.8186384, 'binary_precision': 0.13822193, 'binary_recall': 0.5095694, 'binary_specificity': 0.9205076, 'binary_f1_score': 0.21745789}
confusion matrix:
       0     1
0  15378  1328
1    205   213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8804003, 'precision': 0.6490266, 'recall': 0.72629666, 'specificity': 0.72629666, 'f1': 0.67555374, 'auroc': 0.85020626, 'binary_precision': 0.3393417, 'binary_recall': 0.54328734, 'binary_specificity': 0.90930605, 'binary_f1_score': 0.41775206}
confusion matrix:
      0    1
0  8452  843
1   364  433
early stop counter: 1
val acc:0.9104765057563782, best validation acc: 0.9176594018936157, corresponding to test acc:                         0.8816884756088257 / 0.8816884756088257
after epoch: 6,now: 2024-08-06 16:59:39.822344,epoch time: 0:18:17.003446,used: 1:50:34.749211,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9509633, 'precision': 0.9523163, 'recall': 0.9509665, 'specificity': 0.9509665, 'f1': 0.95092684, 'auroc': 0.9876095, 'binary_precision': 0.97708297, 'binary_recall': 0.9236006, 'binary_specificity': 0.97833234, 'binary_f1_score': 0.9495893}
confusion matrix:
       0      1
0  25285    560
1   1975  23876
---- Validation: 
scalar performance:
{'acc': 0.9135716, 'precision': 0.5687494, 'recall': 0.7329521, 'specificity': 0.7329521, 'f1': 0.59447306, 'auroc': 0.82726955, 'binary_precision': 0.14973615, 'binary_recall': 0.5430622, 'binary_specificity': 0.9228421, 'binary_f1_score': 0.23474665}
confusion matrix:
       0     1
0  15417  1289
1    191   227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8866429, 'precision': 0.66032493, 'recall': 0.7377155, 'specificity': 0.7377155, 'f1': 0.68781054, 'auroc': 0.85536504, 'binary_precision': 0.3601934, 'binary_recall': 0.5608532, 'binary_specificity': 0.9145777, 'binary_f1_score': 0.43866533}
confusion matrix:
      0    1
0  8501  794
1   350  447
new oracle model saved
early stop counter: 2
val acc:0.9135715961456299, best validation acc: 0.9176594018936157, corresponding to test acc:                         0.8816884756088257 / 0.8866428732872009
after epoch: 7,now: 2024-08-06 17:17:59.643159,epoch time: 0:18:19.820815,used: 2:08:54.570026,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9527236, 'precision': 0.9542788, 'recall': 0.9527327, 'specificity': 0.9527327, 'f1': 0.9526838, 'auroc': 0.98820543, 'binary_precision': 0.9809367, 'binary_recall': 0.92342204, 'binary_specificity': 0.9820433, 'binary_f1_score': 0.9513109}
confusion matrix:
       0      1
0  25376    464
1   1980  23876
---- Validation: 
scalar performance:
{'acc': 0.92215604, 'precision': 0.57601726, 'recall': 0.73385304, 'specificity': 0.73385304, 'f1': 0.60524356, 'auroc': 0.8337823, 'binary_precision': 0.16434336, 'binary_recall': 0.53588516, 'binary_specificity': 0.9318209, 'binary_f1_score': 0.25154406}
confusion matrix:
       0     1
0  15567  1139
1    194   224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8956599, 'precision': 0.663511, 'recall': 0.70246136, 'specificity': 0.70246136, 'f1': 0.67998314, 'auroc': 0.85424495, 'binary_precision': 0.37326732, 'binary_recall': 0.47302383, 'binary_specificity': 0.9318989, 'binary_f1_score': 0.41726616}
confusion matrix:
      0    1
0  8662  633
1   420  377
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-06 17:36:24.745635,epoch time: 0:18:25.102476,used: 2:27:19.672502,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95666975, 'precision': 0.95824325, 'recall': 0.95667315, 'specificity': 0.95667315, 'f1': 0.95663273, 'auroc': 0.9901204, 'binary_precision': 0.9851243, 'binary_recall': 0.9273529, 'binary_specificity': 0.98599344, 'binary_f1_score': 0.955366}
confusion matrix:
       0      1
0  25483    362
1   1878  23973
---- Validation: 
scalar performance:
{'acc': 0.92373276, 'precision': 0.58099204, 'recall': 0.74865603, 'specificity': 0.74865603, 'f1': 0.61262256, 'auroc': 0.83577776, 'binary_precision': 0.17352942, 'binary_recall': 0.5645933, 'binary_specificity': 0.9327188, 'binary_f1_score': 0.26546684}
confusion matrix:
       0     1
0  15582  1124
1    182   236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8976417, 'precision': 0.6717691, 'recall': 0.71902335, 'specificity': 0.71902335, 'f1': 0.69128805, 'auroc': 0.858683, 'binary_precision': 0.38697317, 'binary_recall': 0.5069009, 'binary_specificity': 0.9311458, 'binary_f1_score': 0.43889192}
confusion matrix:
      0    1
0  8655  640
1   393  404
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-06 17:54:21.208281,epoch time: 0:17:56.462646,used: 2:45:16.135148,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95902973, 'precision': 0.96004665, 'recall': 0.95903516, 'specificity': 0.95903516, 'f1': 0.9590074, 'auroc': 0.9904523, 'binary_precision': 0.98173404, 'binary_recall': 0.9354839, 'binary_specificity': 0.9825865, 'binary_f1_score': 0.9580511}
confusion matrix:
       0      1
0  25392    450
1   1668  24186
---- Validation: 
scalar performance:
{'acc': 0.9251927, 'precision': 0.5806969, 'recall': 0.7412406, 'specificity': 0.7412406, 'f1': 0.61198264, 'auroc': 0.8342676, 'binary_precision': 0.17335352, 'binary_recall': 0.5478469, 'binary_specificity': 0.93463427, 'binary_f1_score': 0.26336977}
confusion matrix:
       0     1
0  15614  1092
1    189   229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8988308, 'precision': 0.66766226, 'recall': 0.69729996, 'specificity': 0.69729996, 'f1': 0.6807574, 'auroc': 0.85772955, 'binary_precision': 0.3825996, 'binary_recall': 0.45796737, 'binary_specificity': 0.9366326, 'binary_f1_score': 0.41690463}
confusion matrix:
      0    1
0  8706  589
1   432  365
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-06 18:12:06.271344,epoch time: 0:17:45.063063,used: 3:03:01.198211,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9598615, 'precision': 0.9602901, 'recall': 0.9598645, 'specificity': 0.9598645, 'f1': 0.95985234, 'auroc': 0.9906782, 'binary_precision': 0.97438353, 'binary_recall': 0.94457126, 'binary_specificity': 0.9751577, 'binary_f1_score': 0.9592458}
confusion matrix:
       0      1
0  25201    642
1   1433  24420
---- Validation: 
scalar performance:
{'acc': 0.9051039, 'precision': 0.5675403, 'recall': 0.7542697, 'specificity': 0.7542697, 'f1': 0.591995, 'auroc': 0.8404039, 'binary_precision': 0.14604105, 'binary_recall': 0.59569377, 'binary_specificity': 0.9128457, 'binary_f1_score': 0.2345737}
confusion matrix:
       0     1
0  15250  1456
1    169   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8931827, 'precision': 0.66729105, 'recall': 0.729221, 'specificity': 0.729221, 'f1': 0.69119763, 'auroc': 0.86005664, 'binary_precision': 0.37599295, 'binary_recall': 0.5345044, 'binary_specificity': 0.9239376, 'binary_f1_score': 0.44145077}
confusion matrix:
      0    1
0  8588  707
1   371  426
early stop counter: 1
val acc:0.9051039218902588, best validation acc: 0.9251927137374878, corresponding to test acc:                         0.898830771446228 / 0.898830771446228
after epoch: 11,now: 2024-08-06 18:29:53.715993,epoch time: 0:17:47.444649,used: 3:20:48.642860,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96235687, 'precision': 0.9630542, 'recall': 0.96235836, 'specificity': 0.96235836, 'f1': 0.96234274, 'auroc': 0.99176896, 'binary_precision': 0.9810432, 'binary_recall': 0.94294006, 'binary_specificity': 0.98177665, 'binary_f1_score': 0.96161425}
confusion matrix:
       0      1
0  25375    471
1   1475  24375
---- Validation: 
scalar performance:
{'acc': 0.9074398, 'precision': 0.57003284, 'recall': 0.7589656, 'specificity': 0.7589656, 'f1': 0.5959887, 'auroc': 0.84432685, 'binary_precision': 0.1508079, 'binary_recall': 0.6028708, 'binary_specificity': 0.91506046, 'binary_f1_score': 0.24126376}
confusion matrix:
       0     1
0  15287  1419
1    166   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8956599, 'precision': 0.6720548, 'recall': 0.73228645, 'specificity': 0.73228645, 'f1': 0.6956768, 'auroc': 0.86269397, 'binary_precision': 0.38509876, 'binary_recall': 0.5382685, 'binary_specificity': 0.92630446, 'binary_f1_score': 0.44897962}
confusion matrix:
      0    1
0  8610  685
1   368  429
early stop counter: 2
val acc:0.9074398279190063, best validation acc: 0.9251927137374878, corresponding to test acc:                         0.898830771446228 / 0.898830771446228
after epoch: 12,now: 2024-08-06 18:47:39.757773,epoch time: 0:17:46.041780,used: 3:38:34.684640,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9633047, 'precision': 0.96398294, 'recall': 0.96330917, 'specificity': 0.96330917, 'f1': 0.9632915, 'auroc': 0.9925368, 'binary_precision': 0.9817802, 'binary_recall': 0.9441479, 'binary_specificity': 0.9824704, 'binary_f1_score': 0.96259636}
confusion matrix:
       0      1
0  25389    453
1   1444  24410
---- Validation: 
scalar performance:
{'acc': 0.9232072, 'precision': 0.582559, 'recall': 0.75771666, 'specificity': 0.75771666, 'f1': 0.6150649, 'auroc': 0.8469043, 'binary_precision': 0.17617328, 'binary_recall': 0.58373207, 'binary_specificity': 0.9317012, 'binary_f1_score': 0.27066}
confusion matrix:
       0     1
0  15565  1141
1    174   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9010107, 'precision': 0.6746684, 'recall': 0.7070868, 'specificity': 0.7070868, 'f1': 0.6889219, 'auroc': 0.86399436, 'binary_precision': 0.39501038, 'binary_recall': 0.47678795, 'binary_specificity': 0.9373857, 'binary_f1_score': 0.43206367}
confusion matrix:
      0    1
0  8713  582
1   417  380
new oracle model saved
early stop counter: 3
val acc:0.9232072234153748, best validation acc: 0.9251927137374878, corresponding to test acc:                         0.898830771446228 / 0.9010106921195984
after epoch: 13,now: 2024-08-06 19:05:36.426450,epoch time: 0:17:56.668677,used: 3:56:31.353317,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9654712, 'precision': 0.96607727, 'recall': 0.9654726, 'specificity': 0.9654726, 'f1': 0.96546006, 'auroc': 0.9932606, 'binary_precision': 0.98290324, 'binary_recall': 0.94742745, 'binary_specificity': 0.98351777, 'binary_f1_score': 0.96483934}
confusion matrix:
       0      1
0  25420    426
1   1359  24491
---- Validation: 
scalar performance:
{'acc': 0.9279958, 'precision': 0.58813107, 'recall': 0.7601708, 'specificity': 0.7601708, 'f1': 0.62282455, 'auroc': 0.85118914, 'binary_precision': 0.18726017, 'binary_recall': 0.58373207, 'binary_specificity': 0.9366096, 'binary_f1_score': 0.28355607}
confusion matrix:
       0     1
0  15647  1059
1    174   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9036861, 'precision': 0.6755878, 'recall': 0.6907589, 'specificity': 0.6907589, 'f1': 0.6827316, 'auroc': 0.86407024, 'binary_precision': 0.39977092, 'binary_recall': 0.4378921, 'binary_specificity': 0.9436256, 'binary_f1_score': 0.41796407}
confusion matrix:
      0    1
0  8771  524
1   448  349
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-06 19:23:45.555293,epoch time: 0:18:09.128843,used: 4:14:40.482160,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96318865, 'precision': 0.9638167, 'recall': 0.9631915, 'specificity': 0.9631915, 'f1': 0.96317637, 'auroc': 0.9929222, 'binary_precision': 0.98092294, 'binary_recall': 0.94476247, 'binary_specificity': 0.9816205, 'binary_f1_score': 0.9625032}
confusion matrix:
       0      1
0  25369    475
1   1428  24424
---- Validation: 
scalar performance:
{'acc': 0.9275286, 'precision': 0.5878269, 'recall': 0.76109767, 'specificity': 0.76109767, 'f1': 0.62245435, 'auroc': 0.85271215, 'binary_precision': 0.18659559, 'binary_recall': 0.5861244, 'binary_specificity': 0.93607086, 'binary_f1_score': 0.2830734}
confusion matrix:
       0     1
0  15638  1068
1    173   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.904677, 'precision': 0.6796579, 'recall': 0.69760597, 'specificity': 0.69760597, 'f1': 0.6880337, 'auroc': 0.866933, 'binary_precision': 0.40677965, 'binary_recall': 0.45169386, 'binary_specificity': 0.94351804, 'binary_f1_score': 0.4280618}
confusion matrix:
      0    1
0  8770  525
1   437  360
new oracle model saved
early stop counter: 1
val acc:0.9275286197662354, best validation acc: 0.9279958009719849, corresponding to test acc:                         0.9036861062049866 / 0.9046769738197327
after epoch: 15,now: 2024-08-06 19:41:55.949755,epoch time: 0:18:10.394462,used: 4:32:50.876622,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9660515, 'precision': 0.96684515, 'recall': 0.9660571, 'specificity': 0.9660571, 'f1': 0.96603733, 'auroc': 0.993364, 'binary_precision': 0.98616153, 'binary_recall': 0.9453877, 'binary_specificity': 0.9867265, 'binary_f1_score': 0.9653442}
confusion matrix:
       0      1
0  25498    343
1   1412  24443
---- Validation: 
scalar performance:
{'acc': 0.9160827, 'precision': 0.5781618, 'recall': 0.76689386, 'specificity': 0.76689386, 'f1': 0.60872686, 'auroc': 0.8535608, 'binary_precision': 0.16677567, 'binary_recall': 0.6100478, 'binary_specificity': 0.92373997, 'binary_f1_score': 0.26194143}
confusion matrix:
       0     1
0  15432  1274
1    163   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9019025, 'precision': 0.6786994, 'recall': 0.7156008, 'specificity': 0.7156008, 'f1': 0.6947039, 'auroc': 0.8695258, 'binary_precision': 0.401631, 'binary_recall': 0.49435383, 'binary_specificity': 0.93684775, 'binary_f1_score': 0.44319463}
confusion matrix:
      0    1
0  8708  587
1   403  394
early stop counter: 2
val acc:0.9160826802253723, best validation acc: 0.9279958009719849, corresponding to test acc:                         0.9036861062049866 / 0.9046769738197327
after epoch: 16,now: 2024-08-06 20:00:02.674260,epoch time: 0:18:06.724505,used: 4:50:57.601127,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9660709, 'precision': 0.96675026, 'recall': 0.9660739, 'specificity': 0.9660739, 'f1': 0.9660586, 'auroc': 0.9937451, 'binary_precision': 0.9845962, 'binary_recall': 0.94696736, 'binary_specificity': 0.9851803, 'binary_f1_score': 0.9654152}
confusion matrix:
       0      1
0  25461    383
1   1371  24481
---- Validation: 
scalar performance:
{'acc': 0.9259519, 'precision': 0.5867376, 'recall': 0.7637882, 'specificity': 0.7637882, 'f1': 0.6210723, 'auroc': 0.8516716, 'binary_precision': 0.18424962, 'binary_recall': 0.5933014, 'binary_specificity': 0.9342751, 'binary_f1_score': 0.28117913}
confusion matrix:
       0     1
0  15608  1098
1    170   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9084423, 'precision': 0.6859009, 'recall': 0.68760526, 'specificity': 0.68760526, 'f1': 0.6867477, 'auroc': 0.86820126, 'binary_precision': 0.42111802, 'binary_recall': 0.42534503, 'binary_specificity': 0.9498655, 'binary_f1_score': 0.42322096}
confusion matrix:
      0    1
0  8829  466
1   458  339
new oracle model saved
early stop counter: 3
val acc:0.9259518980979919, best validation acc: 0.9279958009719849, corresponding to test acc:                         0.9036861062049866 / 0.9084423184394836
after epoch: 17,now: 2024-08-06 20:18:07.297254,epoch time: 0:18:04.622994,used: 5:09:02.224121,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9688177, 'precision': 0.9692124, 'recall': 0.9688205, 'specificity': 0.9688205, 'f1': 0.9688113, 'auroc': 0.9939457, 'binary_precision': 0.9828692, 'binary_recall': 0.95427996, 'binary_specificity': 0.98336107, 'binary_f1_score': 0.9683636}
confusion matrix:
       0      1
0  25413    430
1   1182  24671
---- Validation: 
scalar performance:
{'acc': 0.9040528, 'precision': 0.5712113, 'recall': 0.77588964, 'specificity': 0.77588964, 'f1': 0.5973755, 'auroc': 0.8554775, 'binary_precision': 0.15218626, 'binary_recall': 0.6411483, 'binary_specificity': 0.9106309, 'binary_f1_score': 0.24598439}
confusion matrix:
       0     1
0  15213  1493
1    150   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9012089, 'precision': 0.6799434, 'recall': 0.7255483, 'specificity': 0.7255483, 'f1': 0.6991023, 'auroc': 0.87280166, 'binary_precision': 0.40234375, 'binary_recall': 0.5169385, 'binary_specificity': 0.93415815, 'binary_f1_score': 0.4524986}
confusion matrix:
      0    1
0  8683  612
1   385  412
early stop counter: 4
val acc:0.9040527939796448, best validation acc: 0.9279958009719849, corresponding to test acc:                         0.9036861062049866 / 0.9084423184394836
after epoch: 18,now: 2024-08-06 20:36:15.266031,epoch time: 0:18:07.968777,used: 5:27:10.192898,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9684889, 'precision': 0.9688827, 'recall': 0.9684911, 'specificity': 0.9684911, 'f1': 0.9684824, 'auroc': 0.99436176, 'binary_precision': 0.9825107, 'binary_recall': 0.95396876, 'binary_specificity': 0.98301345, 'binary_f1_score': 0.96802944}
confusion matrix:
       0      1
0  25405    439
1   1190  24662
---- Validation: 
scalar performance:
{'acc': 0.90504557, 'precision': 0.5719584, 'recall': 0.7763984, 'specificity': 0.7763984, 'f1': 0.59862113, 'auroc': 0.855977, 'binary_precision': 0.15366973, 'binary_recall': 0.6411483, 'binary_specificity': 0.9116485, 'binary_f1_score': 0.2479186}
confusion matrix:
       0     1
0  15230  1476
1    150   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90378517, 'precision': 0.68469167, 'recall': 0.72465265, 'specificity': 0.72465265, 'f1': 0.7019254, 'auroc': 0.87252116, 'binary_precision': 0.4121212, 'binary_recall': 0.5119197, 'binary_specificity': 0.9373857, 'binary_f1_score': 0.45663118}
confusion matrix:
      0    1
0  8713  582
1   389  408
early stop counter: 5
val acc:0.9050455689430237, best validation acc: 0.9279958009719849, corresponding to test acc:                         0.9036861062049866 / 0.9084423184394836
after epoch: 19,now: 2024-08-06 20:54:25.270406,epoch time: 0:18:10.004375,used: 5:45:20.197273,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9686823, 'precision': 0.96937436, 'recall': 0.96868306, 'specificity': 0.96868306, 'f1': 0.9686708, 'auroc': 0.9943918, 'binary_precision': 0.98740745, 'binary_recall': 0.9494758, 'binary_specificity': 0.9878903, 'binary_f1_score': 0.9680702}
confusion matrix:
       0      1
0  25534    313
1   1306  24543
---- Validation: 
scalar performance:
{'acc': 0.9161995, 'precision': 0.5785209, 'recall': 0.76812, 'specificity': 0.76812, 'f1': 0.6092714, 'auroc': 0.8586277, 'binary_precision': 0.16742969, 'binary_recall': 0.61244017, 'binary_specificity': 0.9237998, 'binary_f1_score': 0.26296866}
confusion matrix:
       0     1
0  15433  1273
1    162   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.906956, 'precision': 0.6893048, 'recall': 0.71604997, 'specificity': 0.71604997, 'f1': 0.70144963, 'auroc': 0.8729141, 'binary_precision': 0.42299348, 'binary_recall': 0.489335, 'binary_specificity': 0.94276494, 'binary_f1_score': 0.4537522}
confusion matrix:
      0    1
0  8763  532
1   407  390
early stop counter: 6
val acc:0.9161995053291321, best validation acc: 0.9279958009719849, corresponding to test acc:                         0.9036861062049866 / 0.9084423184394836
after epoch: 20,now: 2024-08-06 21:12:30.090393,epoch time: 0:18:04.819987,used: 6:03:25.017260,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_09_04_seed_2_24076672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:03:25.017260 at 2024-08-06 21:12:30.090393
persisted model performance metric: 

scalar performance:
{'acc': 0.9036861, 'precision': 0.6755878, 'recall': 0.6907589, 'specificity': 0.6907589, 'f1': 0.6827316, 'auroc': 0.86407024, 'binary_precision': 0.39977092, 'binary_recall': 0.4378921, 'binary_specificity': 0.9436256, 'binary_f1_score': 0.41796407}
confusion matrix:
      0    1
0  8771  524
1   448  349
oracle model performance metric: 

scalar performance:
{'acc': 0.9084423, 'precision': 0.6859009, 'recall': 0.68760526, 'specificity': 0.68760526, 'f1': 0.6867477, 'auroc': 0.86820126, 'binary_precision': 0.42111802, 'binary_recall': 0.42534503, 'binary_specificity': 0.9498655, 'binary_f1_score': 0.42322096}
confusion matrix:
      0    1
0  8829  466
1   458  339
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  18208 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  16662 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8530 MiB |  25072 MiB |  16558 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     40 MiB |     44 MiB |     70 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40149 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |   8416 KiB |  24597 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6957    |  280991 K  |  280987 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141134 K  |  141130 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6957    |  280991 K  |  280987 K  |
|       from large pool |      79    |     762    |  139856 K  |  139856 K  |
|       from small pool |    4333    |    6876    |  141134 K  |  141130 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     371    |    1061    |     692    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      20    |      22    |      35    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3255    |  154300 K  |  154300 K  |
|       from large pool |      11    |     352    |   94473 K  |   94473 K  |
|       from small pool |      24    |    3245    |   59826 K  |   59826 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     38 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     36 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25072 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  26624 KiB |     44 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |    811 TiB |    811 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |  24597 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  280991 K  |  280991 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141134 K  |  141134 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  280991 K  |  280991 K  |
|       from large pool |       2    |     762    |  139856 K  |  139856 K  |
|       from small pool |       0    |    6876    |  141134 K  |  141134 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1061    |    1038    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      13    |      22    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3255    |  154302 K  |  154302 K  |
|       from large pool |       3    |     352    |   94473 K  |   94473 K  |
|       from small pool |       0    |    3245    |   59828 K  |   59828 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug  6 21:30:51 2024]
Finished job 0.
1 of 1 steps (100%) done
