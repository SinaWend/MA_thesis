Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 02:22:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/19.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=19
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667

 Experiment start at: 2024-08-06 02:34:45.296430
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7261726, 'precision': 0.72794396, 'recall': 0.72620547, 'specificity': 0.72620547, 'f1': 0.7256584, 'auroc': 0.7884762, 'binary_precision': 0.74822634, 'binary_recall': 0.6823687, 'binary_specificity': 0.7700423, 'binary_f1_score': 0.71378165}
confusion matrix:
       0      1
0  19489   5820
1   8051  17296
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.78187335, 'precision': 0.5220835, 'recall': 0.6602941, 'specificity': 0.6602941, 'f1': 0.4907399, 'auroc': 0.75519735, 'binary_precision': 0.058667373, 'binary_recall': 0.5325301, 'binary_specificity': 0.7880581, 'binary_f1_score': 0.10569105}
confusion matrix:
       0     1
0  13185  3546
1    194   221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6518687, 'precision': 0.5535627, 'recall': 0.67905533, 'specificity': 0.67905533, 'f1': 0.5060694, 'auroc': 0.731017, 'binary_precision': 0.1427086, 'binary_recall': 0.7111399, 'binary_specificity': 0.6469707, 'binary_f1_score': 0.23771378}
confusion matrix:
      0     1
0  6044  3298
1   223   549
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 02:56:07.445079,epoch time: 0:21:22.148649,used: 0:21:22.148649,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8241867, 'precision': 0.82441366, 'recall': 0.8241955, 'specificity': 0.8241955, 'f1': 0.82415855, 'auroc': 0.9028501, 'binary_precision': 0.83316445, 'binary_recall': 0.8110081, 'binary_specificity': 0.837383, 'binary_f1_score': 0.82193696}
confusion matrix:
       0      1
0  21195   4116
1   4790  20555
---- Validation: 
scalar performance:
{'acc': 0.8026362, 'precision': 0.52952373, 'recall': 0.70148134, 'specificity': 0.70148134, 'f1': 0.50806034, 'auroc': 0.7767415, 'binary_precision': 0.07132544, 'binary_recall': 0.59518075, 'binary_specificity': 0.80778193, 'binary_f1_score': 0.12738526}
confusion matrix:
       0     1
0  13515  3216
1    168   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67203873, 'precision': 0.5708774, 'recall': 0.735723, 'specificity': 0.735723, 'f1': 0.53109676, 'auroc': 0.8036649, 'binary_precision': 0.164867, 'binary_recall': 0.81088084, 'binary_specificity': 0.6605652, 'binary_f1_score': 0.27402058}
confusion matrix:
      0     1
0  6171  3171
1   146   626
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 03:14:58.766384,epoch time: 0:18:51.321305,used: 0:40:13.469954,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8575687, 'precision': 0.85819817, 'recall': 0.8575828, 'specificity': 0.8575828, 'f1': 0.8575094, 'auroc': 0.93376946, 'binary_precision': 0.8733833, 'binary_recall': 0.8366147, 'binary_specificity': 0.8785508, 'binary_f1_score': 0.85460365}
confusion matrix:
       0      1
0  22237   3074
1   4141  21204
---- Validation: 
scalar performance:
{'acc': 0.848886, 'precision': 0.53744185, 'recall': 0.7063809, 'specificity': 0.7063809, 'f1': 0.5341927, 'auroc': 0.7894174, 'binary_precision': 0.08756634, 'binary_recall': 0.5566265, 'binary_specificity': 0.8561353, 'binary_f1_score': 0.15132657}
confusion matrix:
       0     1
0  14324  2407
1    184   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73254895, 'precision': 0.58773774, 'recall': 0.7684783, 'specificity': 0.7684783, 'f1': 0.5750773, 'auroc': 0.835513, 'binary_precision': 0.19654632, 'binary_recall': 0.81088084, 'binary_specificity': 0.72607577, 'binary_f1_score': 0.3164013}
confusion matrix:
      0     1
0  6783  2559
1   146   626
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 03:32:27.991819,epoch time: 0:17:29.225435,used: 0:57:42.695389,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8727298, 'precision': 0.8735843, 'recall': 0.8727459, 'specificity': 0.8727459, 'f1': 0.87266034, 'auroc': 0.9455315, 'binary_precision': 0.8916197, 'binary_recall': 0.8488065, 'binary_specificity': 0.89668524, 'binary_f1_score': 0.8696865}
confusion matrix:
       0      1
0  22696   2615
1   3832  21513
---- Validation: 
scalar performance:
{'acc': 0.86894906, 'precision': 0.5431161, 'recall': 0.7107866, 'specificity': 0.7107866, 'f1': 0.54817307, 'auroc': 0.7945338, 'binary_precision': 0.09894921, 'binary_recall': 0.5445783, 'binary_specificity': 0.8769948, 'binary_f1_score': 0.16746944}
confusion matrix:
       0     1
0  14673  2058
1    189   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.764386, 'precision': 0.59810466, 'recall': 0.78155327, 'specificity': 0.78155327, 'f1': 0.5992004, 'auroc': 0.8512175, 'binary_precision': 0.21726921, 'binary_recall': 0.8018135, 'binary_specificity': 0.7612931, 'binary_f1_score': 0.3418945}
confusion matrix:
      0     1
0  7112  2230
1   153   619
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 03:51:04.183408,epoch time: 0:18:36.191589,used: 1:16:18.886978,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8854627, 'precision': 0.88593996, 'recall': 0.88547313, 'specificity': 0.88547313, 'f1': 0.88542926, 'auroc': 0.95413715, 'binary_precision': 0.89966047, 'binary_recall': 0.86785305, 'binary_specificity': 0.9030933, 'binary_f1_score': 0.8834706}
confusion matrix:
       0      1
0  22860   2453
1   3349  21994
---- Validation: 
scalar performance:
{'acc': 0.8669077, 'precision': 0.54541886, 'recall': 0.7273646, 'specificity': 0.7273646, 'f1': 0.5510024, 'auroc': 0.80279076, 'binary_precision': 0.10259685, 'binary_recall': 0.58072287, 'binary_specificity': 0.87400633, 'binary_f1_score': 0.17438495}
confusion matrix:
       0     1
0  14623  2108
1    174   241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77368003, 'precision': 0.6034269, 'recall': 0.7919316, 'specificity': 0.7919316, 'f1': 0.60854816, 'auroc': 0.86300135, 'binary_precision': 0.22646953, 'binary_recall': 0.8134715, 'binary_specificity': 0.77039176, 'binary_f1_score': 0.35430184}
confusion matrix:
      0     1
0  7197  2145
1   144   628
new oracle model saved
early stop counter: 1
val acc:0.8669077157974243, best validation acc: 0.8689490556716919, corresponding to test acc:                         0.764385998249054 / 0.7736800312995911
after epoch: 5,now: 2024-08-06 04:09:31.801951,epoch time: 0:18:27.618543,used: 1:34:46.505521,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.89458305, 'precision': 0.89552146, 'recall': 0.89459944, 'specificity': 0.89459944, 'f1': 0.89452326, 'auroc': 0.9592823, 'binary_precision': 0.9149554, 'binary_recall': 0.87019134, 'binary_specificity': 0.91900754, 'binary_f1_score': 0.8920121}
confusion matrix:
       0      1
0  23261   2050
1   3290  22055
---- Validation: 
scalar performance:
{'acc': 0.8746063, 'precision': 0.5472643, 'recall': 0.72425973, 'specificity': 0.72425973, 'f1': 0.555753, 'auroc': 0.8064797, 'binary_precision': 0.106575966, 'binary_recall': 0.56626505, 'binary_specificity': 0.8822545, 'binary_f1_score': 0.17938931}
confusion matrix:
       0     1
0  14761  1970
1    180   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79345465, 'precision': 0.6118348, 'recall': 0.8002594, 'specificity': 0.8002594, 'f1': 0.62515664, 'auroc': 0.86900556, 'binary_precision': 0.24327485, 'binary_recall': 0.8082902, 'binary_specificity': 0.79222864, 'binary_f1_score': 0.3739886}
confusion matrix:
      0     1
0  7401  1941
1   148   624
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-06 04:26:58.651962,epoch time: 0:17:26.850011,used: 1:52:13.355532,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9025387, 'precision': 0.90320295, 'recall': 0.90254915, 'specificity': 0.90254915, 'f1': 0.90250015, 'auroc': 0.9645822, 'binary_precision': 0.9196972, 'binary_recall': 0.8822067, 'binary_specificity': 0.92289156, 'binary_f1_score': 0.9005619}
confusion matrix:
       0      1
0  23363   1952
1   2985  22356
---- Validation: 
scalar performance:
{'acc': 0.87099034, 'precision': 0.54722786, 'recall': 0.7306315, 'specificity': 0.7306315, 'f1': 0.5547582, 'auroc': 0.81204605, 'binary_precision': 0.10609382, 'binary_recall': 0.5831325, 'binary_specificity': 0.87813044, 'binary_f1_score': 0.17952521}
confusion matrix:
       0     1
0  14692  2039
1    173   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7975084, 'precision': 0.6148421, 'recall': 0.80601865, 'specificity': 0.80601865, 'f1': 0.6299273, 'auroc': 0.87337816, 'binary_precision': 0.24842271, 'binary_recall': 0.81606215, 'binary_specificity': 0.79597515, 'binary_f1_score': 0.3808948}
confusion matrix:
      0     1
0  7436  1906
1   142   630
new oracle model saved
early stop counter: 1
val acc:0.8709903359413147, best validation acc: 0.8746063113212585, corresponding to test acc:                         0.793454647064209 / 0.7975084185600281
after epoch: 7,now: 2024-08-06 04:44:09.074265,epoch time: 0:17:10.422303,used: 2:09:23.777835,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90611184, 'precision': 0.90697825, 'recall': 0.9061291, 'specificity': 0.9061291, 'f1': 0.9060644, 'auroc': 0.9666026, 'binary_precision': 0.9259443, 'binary_recall': 0.88298416, 'binary_specificity': 0.92927414, 'binary_f1_score': 0.9039541}
confusion matrix:
       0      1
0  23519   1790
1   2966  22381
---- Validation: 
scalar performance:
{'acc': 0.86597455, 'precision': 0.5468666, 'recall': 0.73746085, 'specificity': 0.73746085, 'f1': 0.55286646, 'auroc': 0.8158186, 'binary_precision': 0.10490978, 'binary_recall': 0.60240966, 'binary_specificity': 0.8725121, 'binary_f1_score': 0.17869908}
confusion matrix:
       0     1
0  14598  2133
1    165   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79740953, 'precision': 0.615604, 'recall': 0.8089359, 'specificity': 0.8089359, 'f1': 0.63073367, 'auroc': 0.87743855, 'binary_precision': 0.24931292, 'binary_recall': 0.82253885, 'binary_specificity': 0.7953329, 'binary_f1_score': 0.3826454}
confusion matrix:
      0     1
0  7430  1912
1   137   635
early stop counter: 2
val acc:0.8659745454788208, best validation acc: 0.8746063113212585, corresponding to test acc:                         0.793454647064209 / 0.7975084185600281
after epoch: 8,now: 2024-08-06 05:02:03.719033,epoch time: 0:17:54.644768,used: 2:27:18.422603,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9113234, 'precision': 0.91266036, 'recall': 0.9113414, 'specificity': 0.9113414, 'f1': 0.9112541, 'auroc': 0.96960855, 'binary_precision': 0.9363073, 'binary_recall': 0.8828125, 'binary_specificity': 0.9398704, 'binary_f1_score': 0.90877336}
confusion matrix:
       0      1
0  23790   1522
1   2970  22374
---- Validation: 
scalar performance:
{'acc': 0.8748396, 'precision': 0.54925185, 'recall': 0.7349537, 'specificity': 0.7349537, 'f1': 0.5587413, 'auroc': 0.8201123, 'binary_precision': 0.10995944, 'binary_recall': 0.5879518, 'binary_specificity': 0.8819556, 'binary_f1_score': 0.18526955}
confusion matrix:
       0     1
0  14756  1975
1    171   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81293255, 'precision': 0.6238162, 'recall': 0.8167447, 'specificity': 0.8167447, 'f1': 0.6452075, 'auroc': 0.8799498, 'binary_precision': 0.26549414, 'binary_recall': 0.8212435, 'binary_specificity': 0.8122458, 'binary_f1_score': 0.40126583}
confusion matrix:
      0     1
0  7588  1754
1   138   634
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-06 05:19:56.636983,epoch time: 0:17:52.917950,used: 2:45:11.340553,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91564673, 'precision': 0.9168688, 'recall': 0.9156617, 'specificity': 0.9156617, 'f1': 0.9155868, 'auroc': 0.9721997, 'binary_precision': 0.93957853, 'binary_recall': 0.88852495, 'binary_specificity': 0.94279844, 'binary_f1_score': 0.91333884}
confusion matrix:
       0      1
0  23866   1448
1   2825  22517
---- Validation: 
scalar performance:
{'acc': 0.86002564, 'precision': 0.5467943, 'recall': 0.7473369, 'specificity': 0.7473369, 'f1': 0.55106926, 'auroc': 0.82423407, 'binary_precision': 0.1041085, 'binary_recall': 0.62891567, 'binary_specificity': 0.8657582, 'binary_f1_score': 0.17864476}
confusion matrix:
       0     1
0  14485  2246
1    154   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80205655, 'precision': 0.61848795, 'recall': 0.81323385, 'specificity': 0.81323385, 'f1': 0.6355748, 'auroc': 0.8828099, 'binary_precision': 0.254589, 'binary_recall': 0.8264249, 'binary_specificity': 0.8000428, 'binary_f1_score': 0.38926172}
confusion matrix:
      0     1
0  7474  1868
1   134   638
early stop counter: 1
val acc:0.8600256443023682, best validation acc: 0.8748396039009094, corresponding to test acc:                         0.812932550907135 / 0.812932550907135
after epoch: 10,now: 2024-08-06 05:37:23.014378,epoch time: 0:17:26.377395,used: 3:02:37.717948,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9184302, 'precision': 0.91966355, 'recall': 0.91844845, 'specificity': 0.91844845, 'f1': 0.9183726, 'auroc': 0.97271854, 'binary_precision': 0.9425829, 'binary_recall': 0.8912606, 'binary_specificity': 0.9456363, 'binary_f1_score': 0.9162037}
confusion matrix:
       0      1
0  23935   1376
1   2756  22589
---- Validation: 
scalar performance:
{'acc': 0.87180686, 'precision': 0.5487934, 'recall': 0.73809946, 'specificity': 0.73809946, 'f1': 0.5572758, 'auroc': 0.82532173, 'binary_precision': 0.108819656, 'binary_recall': 0.5975904, 'binary_specificity': 0.8786086, 'binary_f1_score': 0.18411285}
confusion matrix:
       0     1
0  14700  2031
1    167   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8179751, 'precision': 0.6269315, 'recall': 0.82006836, 'specificity': 0.82006836, 'f1': 0.65033746, 'auroc': 0.8835602, 'binary_precision': 0.27148354, 'binary_recall': 0.82253885, 'binary_specificity': 0.8175979, 'binary_f1_score': 0.40822887}
confusion matrix:
      0     1
0  7638  1704
1   137   635
new oracle model saved
early stop counter: 2
val acc:0.8718068599700928, best validation acc: 0.8748396039009094, corresponding to test acc:                         0.812932550907135 / 0.8179751038551331
after epoch: 11,now: 2024-08-06 05:54:31.413100,epoch time: 0:17:08.398722,used: 3:19:46.116670,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9226153, 'precision': 0.9235437, 'recall': 0.92262924, 'specificity': 0.92262924, 'f1': 0.9225746, 'auroc': 0.97547567, 'binary_precision': 0.94352204, 'binary_recall': 0.89914376, 'binary_specificity': 0.94611466, 'binary_f1_score': 0.92079854}
confusion matrix:
       0      1
0  23949   1364
1   2556  22787
---- Validation: 
scalar performance:
{'acc': 0.87623936, 'precision': 0.5509074, 'recall': 0.7415457, 'specificity': 0.7415457, 'f1': 0.5615385, 'auroc': 0.82810605, 'binary_precision': 0.11292517, 'binary_recall': 0.6, 'binary_specificity': 0.8830913, 'binary_f1_score': 0.19007634}
confusion matrix:
       0     1
0  14775  1956
1    166   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82459956, 'precision': 0.6303742, 'recall': 0.8212778, 'specificity': 0.8212778, 'f1': 0.6562455, 'auroc': 0.88503385, 'binary_precision': 0.27871025, 'binary_recall': 0.81735754, 'binary_specificity': 0.82519805, 'binary_f1_score': 0.41567853}
confusion matrix:
      0     1
0  7709  1633
1   141   631
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-06 06:12:09.637944,epoch time: 0:17:38.224844,used: 3:37:24.341514,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92316806, 'precision': 0.92434484, 'recall': 0.9231837, 'specificity': 0.9231837, 'f1': 0.9231166, 'auroc': 0.9759711, 'binary_precision': 0.94684, 'binary_recall': 0.89677626, 'binary_specificity': 0.9495911, 'binary_f1_score': 0.9211284}
confusion matrix:
       0      1
0  24037   1276
1   2616  22727
---- Validation: 
scalar performance:
{'acc': 0.8730899, 'precision': 0.55035675, 'recall': 0.74463165, 'specificity': 0.74463165, 'f1': 0.5599131, 'auroc': 0.8288393, 'binary_precision': 0.11160123, 'binary_recall': 0.6096386, 'binary_specificity': 0.87962466, 'binary_f1_score': 0.18866517}
confusion matrix:
       0     1
0  14717  2014
1    162   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8251928, 'precision': 0.63027364, 'recall': 0.81981647, 'specificity': 0.81981647, 'f1': 0.6562885, 'auroc': 0.88499236, 'binary_precision': 0.27886322, 'binary_recall': 0.8134715, 'binary_specificity': 0.82616144, 'binary_f1_score': 0.41534388}
confusion matrix:
      0     1
0  7718  1624
1   144   628
new oracle model saved
early stop counter: 1
val acc:0.8730899095535278, best validation acc: 0.8762393593788147, corresponding to test acc:                         0.82459956407547 / 0.8251928091049194
after epoch: 13,now: 2024-08-06 06:30:23.031534,epoch time: 0:18:13.393590,used: 3:55:37.735104,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9270965, 'precision': 0.92770016, 'recall': 0.92710614, 'specificity': 0.92710614, 'f1': 0.92707187, 'auroc': 0.9776978, 'binary_precision': 0.94389766, 'binary_recall': 0.90825146, 'binary_specificity': 0.9459609, 'binary_f1_score': 0.92573154}
confusion matrix:
       0      1
0  23947   1368
1   2325  23016
---- Validation: 
scalar performance:
{'acc': 0.8521521, 'precision': 0.54702723, 'recall': 0.7621014, 'specificity': 0.7621014, 'f1': 0.54905194, 'auroc': 0.832519, 'binary_precision': 0.10359013, 'binary_recall': 0.66746986, 'binary_specificity': 0.856733, 'binary_f1_score': 0.17934607}
confusion matrix:
       0     1
0  14334  2397
1    138   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80789006, 'precision': 0.622587, 'recall': 0.8199565, 'specificity': 0.8199565, 'f1': 0.64216197, 'auroc': 0.88687074, 'binary_precision': 0.2618951, 'binary_recall': 0.83419687, 'binary_specificity': 0.8057161, 'binary_f1_score': 0.3986382}
confusion matrix:
      0     1
0  7527  1815
1   128   644
early stop counter: 2
val acc:0.8521521091461182, best validation acc: 0.8762393593788147, corresponding to test acc:                         0.82459956407547 / 0.8251928091049194
after epoch: 14,now: 2024-08-06 06:48:09.690449,epoch time: 0:17:46.658915,used: 4:13:24.394019,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9285376, 'precision': 0.9294479, 'recall': 0.92855036, 'specificity': 0.92855036, 'f1': 0.9285011, 'auroc': 0.9784391, 'binary_precision': 0.9493587, 'binary_recall': 0.9054534, 'binary_specificity': 0.9516473, 'binary_f1_score': 0.9268864}
confusion matrix:
       0      1
0  24090   1224
1   2396  22946
---- Validation: 
scalar performance:
{'acc': 0.86171705, 'precision': 0.54894716, 'recall': 0.75760305, 'specificity': 0.75760305, 'f1': 0.55469644, 'auroc': 0.8356997, 'binary_precision': 0.10785886, 'binary_recall': 0.64819276, 'binary_specificity': 0.86701334, 'binary_f1_score': 0.18494329}
confusion matrix:
       0     1
0  14506  2225
1    146   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8189638, 'precision': 0.6280038, 'recall': 0.8223861, 'specificity': 0.8223861, 'f1': 0.6518704, 'auroc': 0.8872191, 'binary_precision': 0.2732334, 'binary_recall': 0.8264249, 'binary_specificity': 0.8183473, 'binary_f1_score': 0.41068557}
confusion matrix:
      0     1
0  7645  1697
1   134   638
early stop counter: 3
val acc:0.8617170453071594, best validation acc: 0.8762393593788147, corresponding to test acc:                         0.82459956407547 / 0.8251928091049194
after epoch: 15,now: 2024-08-06 07:05:26.677641,epoch time: 0:17:16.987192,used: 4:30:41.381211,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.93092626, 'precision': 0.9318255, 'recall': 0.93094164, 'specificity': 0.93094164, 'f1': 0.930892, 'auroc': 0.97940576, 'binary_precision': 0.9516996, 'binary_recall': 0.9080292, 'binary_specificity': 0.9538541, 'binary_f1_score': 0.9293517}
confusion matrix:
       0      1
0  24143   1168
1   2331  23014
---- Validation: 
scalar performance:
{'acc': 0.8530853, 'precision': 0.5480736, 'recall': 0.7672793, 'specificity': 0.7672793, 'f1': 0.5508498, 'auroc': 0.83758867, 'binary_precision': 0.10540135, 'binary_recall': 0.6771084, 'binary_specificity': 0.85745025, 'binary_f1_score': 0.18240832}
confusion matrix:
       0     1
0  14346  2385
1    134   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81372356, 'precision': 0.6255514, 'recall': 0.821926, 'specificity': 0.821926, 'f1': 0.64743465, 'auroc': 0.8877458, 'binary_precision': 0.26794657, 'binary_recall': 0.8316062, 'binary_specificity': 0.8122458, 'binary_f1_score': 0.40530303}
confusion matrix:
      0     1
0  7588  1754
1   130   642
early stop counter: 4
val acc:0.8530852794647217, best validation acc: 0.8762393593788147, corresponding to test acc:                         0.82459956407547 / 0.8251928091049194
after epoch: 16,now: 2024-08-06 07:23:06.139179,epoch time: 0:17:39.461538,used: 4:48:20.842749,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93290037, 'precision': 0.9335402, 'recall': 0.93291104, 'specificity': 0.93291104, 'f1': 0.9328767, 'auroc': 0.9800439, 'binary_precision': 0.95033455, 'binary_recall': 0.91362166, 'binary_specificity': 0.95220035, 'binary_f1_score': 0.9316166}
confusion matrix:
       0      1
0  24104   1210
1   2189  23153
---- Validation: 
scalar performance:
{'acc': 0.85559314, 'precision': 0.549501, 'recall': 0.7720892, 'specificity': 0.7720892, 'f1': 0.55367976, 'auroc': 0.8398615, 'binary_precision': 0.108025864, 'binary_recall': 0.6843374, 'binary_specificity': 0.859841, 'binary_f1_score': 0.18659659}
confusion matrix:
       0     1
0  14386  2345
1    131   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81846946, 'precision': 0.6278655, 'recall': 0.8227126, 'specificity': 0.8227126, 'f1': 0.65156204, 'auroc': 0.8884102, 'binary_precision': 0.27284372, 'binary_recall': 0.8277202, 'binary_specificity': 0.817705, 'binary_f1_score': 0.4104046}
confusion matrix:
      0     1
0  7639  1703
1   133   639
early stop counter: 5
val acc:0.8555931448936462, best validation acc: 0.8762393593788147, corresponding to test acc:                         0.82459956407547 / 0.8251928091049194
after epoch: 17,now: 2024-08-06 07:41:20.648125,epoch time: 0:18:14.508946,used: 5:06:35.351695,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9321699, 'precision': 0.933223, 'recall': 0.93218654, 'specificity': 0.93218654, 'f1': 0.93213046, 'auroc': 0.9798714, 'binary_precision': 0.95475113, 'binary_recall': 0.9074374, 'binary_specificity': 0.9569357, 'binary_f1_score': 0.9304932}
confusion matrix:
       0      1
0  24221   1090
1   2346  22999
---- Validation: 
scalar performance:
{'acc': 0.8609588, 'precision': 0.55036443, 'recall': 0.76778895, 'specificity': 0.76778895, 'f1': 0.5565379, 'auroc': 0.84077895, 'binary_precision': 0.11009901, 'binary_recall': 0.6698795, 'binary_specificity': 0.8656984, 'binary_f1_score': 0.18911563}
confusion matrix:
       0     1
0  14484  2247
1    137   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8276646, 'precision': 0.6325027, 'recall': 0.8235311, 'specificity': 0.8235311, 'f1': 0.65956944, 'auroc': 0.88937604, 'binary_precision': 0.28277406, 'binary_recall': 0.81865287, 'binary_specificity': 0.8284093, 'binary_f1_score': 0.42035252}
confusion matrix:
      0     1
0  7739  1603
1   140   632
new oracle model saved
early stop counter: 6
val acc:0.8609588146209717, best validation acc: 0.8762393593788147, corresponding to test acc:                         0.82459956407547 / 0.8276646137237549
after epoch: 18,now: 2024-08-06 07:58:51.229653,epoch time: 0:17:30.581528,used: 5:24:05.933223,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93538773, 'precision': 0.936278, 'recall': 0.93540204, 'specificity': 0.93540204, 'f1': 0.93535614, 'auroc': 0.98244643, 'binary_precision': 0.95614433, 'binary_recall': 0.912721, 'binary_specificity': 0.9580831, 'binary_f1_score': 0.93392825}
confusion matrix:
       0      1
0  24251   1061
1   2212  23132
---- Validation: 
scalar performance:
{'acc': 0.8588009, 'precision': 0.5501159, 'recall': 0.770208, 'specificity': 0.770208, 'f1': 0.55553746, 'auroc': 0.84223914, 'binary_precision': 0.109423675, 'binary_recall': 0.6771084, 'binary_specificity': 0.86330765, 'binary_f1_score': 0.18840092}
confusion matrix:
       0     1
0  14444  2287
1    134   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8269725, 'precision': 0.6328442, 'recall': 0.8261272, 'specificity': 0.8261272, 'f1': 0.6597879, 'auroc': 0.8904526, 'binary_precision': 0.28285968, 'binary_recall': 0.8251295, 'binary_specificity': 0.82712483, 'binary_f1_score': 0.4212963}
confusion matrix:
      0     1
0  7727  1615
1   135   637
early stop counter: 7
val acc:0.8588008880615234, best validation acc: 0.8762393593788147, corresponding to test acc:                         0.82459956407547 / 0.8276646137237549
after epoch: 19,now: 2024-08-06 08:16:10.808887,epoch time: 0:17:19.579234,used: 5:41:25.512457,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9362761, 'precision': 0.9369713, 'recall': 0.9362903, 'specificity': 0.9362903, 'f1': 0.9362521, 'auroc': 0.9818884, 'binary_precision': 0.9545791, 'binary_recall': 0.91623926, 'binary_specificity': 0.9563414, 'binary_f1_score': 0.93501633}
confusion matrix:
       0      1
0  24205   1105
1   2123  23223
---- Validation: 
scalar performance:
{'acc': 0.84941095, 'precision': 0.5484443, 'recall': 0.77597106, 'specificity': 0.77597106, 'f1': 0.55024284, 'auroc': 0.8437848, 'binary_precision': 0.10556971, 'binary_recall': 0.6987952, 'binary_specificity': 0.85314685, 'binary_f1_score': 0.18342821}
confusion matrix:
       0     1
0  14274  2457
1    125   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.822721, 'precision': 0.63093877, 'recall': 0.8267965, 'specificity': 0.8267965, 'f1': 0.65637374, 'auroc': 0.89060235, 'binary_precision': 0.27852494, 'binary_recall': 0.8316062, 'binary_specificity': 0.82198673, 'binary_f1_score': 0.41728956}
confusion matrix:
      0     1
0  7679  1663
1   130   642
early stop counter: 8
val acc:0.8494109511375427, best validation acc: 0.8762393593788147, corresponding to test acc:                         0.82459956407547 / 0.8276646137237549
after epoch: 20,now: 2024-08-06 08:34:08.431771,epoch time: 0:17:57.622884,used: 5:59:23.135341,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_02_34_45_seed_0_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:59:23.135341 at 2024-08-06 08:34:08.431771
persisted model performance metric: 

scalar performance:
{'acc': 0.82459956, 'precision': 0.6303742, 'recall': 0.8212778, 'specificity': 0.8212778, 'f1': 0.6562455, 'auroc': 0.88503385, 'binary_precision': 0.27871025, 'binary_recall': 0.81735754, 'binary_specificity': 0.82519805, 'binary_f1_score': 0.41567853}
confusion matrix:
      0     1
0  7709  1633
1   141   631
oracle model performance metric: 

scalar performance:
{'acc': 0.8276646, 'precision': 0.6325027, 'recall': 0.8235311, 'specificity': 0.8235311, 'f1': 0.65956944, 'auroc': 0.88937604, 'binary_precision': 0.28277406, 'binary_recall': 0.81865287, 'binary_specificity': 0.8284093, 'binary_f1_score': 0.42035252}
confusion matrix:
      0     1
0  7739  1603
1   140   632
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/19.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192600 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 192600 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189463 KiB | 457745 KiB | 361395 GiB | 361394 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |  16649 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47015 KiB |  91217 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |  16615 KiB |  16866 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6815    |   81221 K  |   81217 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46332 K  |   46327 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6815    |   81221 K  |   81217 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46332 K  |   46327 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3184    |   42905 K  |   42905 K  |
|       from large pool |       9    |      18    |   24129 K  |   24129 K  |
|       from small pool |      28    |    3176    |   18775 K  |   18775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB | 509952 KiB | 509952 KiB | 270336 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  34816 KiB |  43008 KiB |  43008 KiB |   8192 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  91217 KiB | 193335 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81221 K  |   81221 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46332 K  |   46332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81221 K  |   81221 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46332 K  |   46332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |      42    |      42    |      15    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      17    |      21    |      21    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42907 K  |   42907 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18777 K  |   18777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB | 509952 KiB | 509952 KiB | 270336 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  34816 KiB |  43008 KiB |  43008 KiB |   8192 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  91217 KiB | 193335 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81221 K  |   81221 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46332 K  |   46332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81221 K  |   81221 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46332 K  |   46332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |      42    |      42    |      15    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      17    |      21    |      21    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42907 K  |   42907 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18777 K  |   18777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667

 Experiment start at: 2024-08-06 09:00:29.753135
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6289936, 'precision': 0.63097304, 'recall': 0.62894464, 'specificity': 0.62894464, 'f1': 0.6275331, 'auroc': 0.6647164, 'binary_precision': 0.615067, 'binary_recall': 0.69106776, 'binary_specificity': 0.5668216, 'binary_f1_score': 0.65085626}
confusion matrix:
       0      1
0  14395  11001
1   7858  17578
---- Validation: 
scalar performance:
{'acc': 0.87210184, 'precision': 0.50794405, 'recall': 0.53207046, 'specificity': 0.53207046, 'f1': 0.49773175, 'auroc': 0.73429036, 'binary_precision': 0.039287586, 'binary_recall': 0.17401393, 'binary_specificity': 0.890127, 'binary_f1_score': 0.06410257}
confusion matrix:
       0     1
0  14858  1834
1    356    75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8084432, 'precision': 0.4807117, 'recall': 0.46917203, 'specificity': 0.46917203, 'f1': 0.4727219, 'auroc': 0.590266, 'binary_precision': 0.041341655, 'binary_recall': 0.07001321, 'binary_specificity': 0.86833084, 'binary_f1_score': 0.05198627}
confusion matrix:
      0     1
0  8105  1229
1   704    53
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 09:19:10.487643,epoch time: 0:18:40.734508,used: 0:18:40.734508,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7600331, 'precision': 0.76026124, 'recall': 0.76002, 'specificity': 0.76002, 'f1': 0.7599741, 'auroc': 0.82876647, 'binary_precision': 0.7527682, 'binary_recall': 0.7750216, 'binary_specificity': 0.7450185, 'binary_f1_score': 0.76373285}
confusion matrix:
       0      1
0  18919   6475
1   5723  19715
---- Validation: 
scalar performance:
{'acc': 0.8749051, 'precision': 0.5176567, 'recall': 0.57193303, 'specificity': 0.57193303, 'f1': 0.51259804, 'auroc': 0.7656424, 'binary_precision': 0.056505963, 'binary_recall': 0.25290024, 'binary_specificity': 0.89096576, 'binary_f1_score': 0.09237288}
confusion matrix:
       0     1
0  14872  1820
1    322   109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80368644, 'precision': 0.5220181, 'recall': 0.54186064, 'specificity': 0.54186064, 'f1': 0.5203035, 'auroc': 0.7060927, 'binary_precision': 0.1121673, 'binary_recall': 0.2338177, 'binary_specificity': 0.8499036, 'binary_f1_score': 0.151606}
confusion matrix:
      0     1
0  7933  1401
1   580   177
better model found
persisted
after epoch: 2,now: 2024-08-06 09:37:02.336102,epoch time: 0:17:51.848459,used: 0:36:32.582967,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.81922805, 'precision': 0.81946516, 'recall': 0.8192387, 'specificity': 0.8192387, 'f1': 0.8191979, 'auroc': 0.8970034, 'binary_precision': 0.8283682, 'binary_recall': 0.8056691, 'binary_specificity': 0.8328083, 'binary_f1_score': 0.81686103}
confusion matrix:
       0      1
0  21150   4246
1   4943  20493
---- Validation: 
scalar performance:
{'acc': 0.88302284, 'precision': 0.52930784, 'recall': 0.6156515, 'specificity': 0.6156515, 'f1': 0.5315137, 'auroc': 0.78706205, 'binary_precision': 0.077419356, 'binary_recall': 0.33410674, 'binary_specificity': 0.89719623, 'binary_f1_score': 0.12570931}
confusion matrix:
       0     1
0  14976  1716
1    287   144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8112179, 'precision': 0.56594414, 'recall': 0.6400066, 'specificity': 0.6400066, 'f1': 0.57515377, 'auroc': 0.7756376, 'binary_precision': 0.18322296, 'binary_recall': 0.4385733, 'binary_specificity': 0.8414399, 'binary_f1_score': 0.25846633}
confusion matrix:
      0     1
0  7854  1480
1   425   332
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 09:54:39.997227,epoch time: 0:17:37.661125,used: 0:54:10.244092,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85221905, 'precision': 0.8523444, 'recall': 0.8522272, 'specificity': 0.8522272, 'f1': 0.8522079, 'auroc': 0.92840385, 'binary_precision': 0.85920966, 'binary_recall': 0.84279424, 'binary_specificity': 0.86166024, 'binary_f1_score': 0.85092276}
confusion matrix:
       0      1
0  21881   3513
1   3999  21439
---- Validation: 
scalar performance:
{'acc': 0.88938856, 'precision': 0.53964764, 'recall': 0.6528207, 'specificity': 0.6528207, 'f1': 0.54801923, 'auroc': 0.8022457, 'binary_precision': 0.09607951, 'binary_recall': 0.4037123, 'binary_specificity': 0.9019291, 'binary_f1_score': 0.15521856}
confusion matrix:
       0     1
0  15055  1637
1    257   174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8206322, 'precision': 0.5955638, 'recall': 0.7142861, 'specificity': 0.7142861, 'f1': 0.6132895, 'auroc': 0.8171271, 'binary_precision': 0.22930591, 'binary_recall': 0.5891678, 'binary_specificity': 0.83940434, 'binary_f1_score': 0.3301258}
confusion matrix:
      0     1
0  7835  1499
1   311   446
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 10:12:15.601708,epoch time: 0:17:35.604481,used: 1:11:45.848573,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8687441, 'precision': 0.8689647, 'recall': 0.86875373, 'specificity': 0.86875373, 'f1': 0.8687265, 'auroc': 0.9420997, 'binary_precision': 0.87818444, 'binary_recall': 0.8565026, 'binary_specificity': 0.88100487, 'binary_f1_score': 0.86720794}
confusion matrix:
       0      1
0  22374   3022
1   3650  21786
---- Validation: 
scalar performance:
{'acc': 0.8987327, 'precision': 0.5499426, 'recall': 0.6813463, 'specificity': 0.6813463, 'f1': 0.5648171, 'auroc': 0.8146888, 'binary_precision': 0.11518016, 'binary_recall': 0.4524362, 'binary_specificity': 0.9102564, 'binary_f1_score': 0.18361583}
confusion matrix:
       0     1
0  15194  1498
1    236   195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83628976, 'precision': 0.6144179, 'recall': 0.74945486, 'specificity': 0.74945486, 'f1': 0.6391047, 'auroc': 0.8436047, 'binary_precision': 0.26133335, 'binary_recall': 0.64729196, 'binary_specificity': 0.85161775, 'binary_f1_score': 0.37234047}
confusion matrix:
      0     1
0  7949  1385
1   267   490
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 10:29:54.345524,epoch time: 0:17:38.743816,used: 1:29:24.592389,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8852691, 'precision': 0.886263, 'recall': 0.8852881, 'specificity': 0.8852881, 'f1': 0.88519883, 'auroc': 0.9540967, 'binary_precision': 0.9060442, 'binary_recall': 0.8598781, 'binary_specificity': 0.9106981, 'binary_f1_score': 0.88235766}
confusion matrix:
       0      1
0  23129   2268
1   3564  21871
---- Validation: 
scalar performance:
{'acc': 0.9055072, 'precision': 0.55664045, 'recall': 0.6949923, 'specificity': 0.6949923, 'f1': 0.5755824, 'auroc': 0.8226862, 'binary_precision': 0.12789969, 'binary_recall': 0.47331786, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.20138203}
confusion matrix:
       0     1
0  15301  1391
1    227   204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84976715, 'precision': 0.6283043, 'recall': 0.7682718, 'specificity': 0.7682718, 'f1': 0.65791714, 'auroc': 0.86061645, 'binary_precision': 0.2864378, 'binary_recall': 0.672391, 'binary_specificity': 0.86415255, 'binary_f1_score': 0.40173638}
confusion matrix:
      0     1
0  8066  1268
1   248   509
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-06 10:47:23.638479,epoch time: 0:17:29.292955,used: 1:46:53.885344,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89561695, 'precision': 0.8970441, 'recall': 0.895643, 'specificity': 0.895643, 'f1': 0.8955274, 'auroc': 0.96113825, 'binary_precision': 0.92106587, 'binary_recall': 0.8655948, 'binary_specificity': 0.9256911, 'binary_f1_score': 0.8924692}
confusion matrix:
       0      1
0  23507   1887
1   3419  22019
---- Validation: 
scalar performance:
{'acc': 0.9169538, 'precision': 0.564549, 'recall': 0.6963428, 'specificity': 0.6963428, 'f1': 0.5878413, 'auroc': 0.8289621, 'binary_precision': 0.14378145, 'binary_recall': 0.46403712, 'binary_specificity': 0.9286485, 'binary_f1_score': 0.21953897}
confusion matrix:
       0     1
0  15501  1191
1    231   200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86393815, 'precision': 0.64211184, 'recall': 0.77957356, 'specificity': 0.77957356, 'f1': 0.67570245, 'auroc': 0.8718627, 'binary_precision': 0.3128797, 'binary_recall': 0.68031704, 'binary_specificity': 0.8788301, 'binary_f1_score': 0.4286309}
confusion matrix:
      0     1
0  8203  1131
1   242   515
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-06 11:04:58.759759,epoch time: 0:17:35.121280,used: 2:04:29.006624,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9032106, 'precision': 0.9040017, 'recall': 0.9032272, 'specificity': 0.9032272, 'f1': 0.9031658, 'auroc': 0.96464854, 'binary_precision': 0.9220672, 'binary_recall': 0.8810301, 'binary_specificity': 0.9254243, 'binary_f1_score': 0.90108174}
confusion matrix:
       0      1
0  23503   1894
1   3026  22409
---- Validation: 
scalar performance:
{'acc': 0.9042808, 'precision': 0.56094116, 'recall': 0.716966, 'specificity': 0.716966, 'f1': 0.5818483, 'auroc': 0.8334342, 'binary_precision': 0.1352657, 'binary_recall': 0.51972157, 'binary_specificity': 0.9142104, 'binary_f1_score': 0.21466218}
confusion matrix:
       0     1
0  15260  1432
1    207   224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8620553, 'precision': 0.6466012, 'recall': 0.8016193, 'specificity': 0.8016193, 'f1': 0.6820195, 'auroc': 0.87961715, 'binary_precision': 0.31763354, 'binary_recall': 0.7305152, 'binary_specificity': 0.8727234, 'binary_f1_score': 0.4427542}
confusion matrix:
      0     1
0  8146  1188
1   204   553
early stop counter: 1
val acc:0.9042807817459106, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.8639381527900696
after epoch: 8,now: 2024-08-06 11:23:16.613336,epoch time: 0:18:17.853577,used: 2:22:46.860201,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90775496, 'precision': 0.9083725, 'recall': 0.9077718, 'specificity': 0.9077718, 'f1': 0.90772253, 'auroc': 0.9681078, 'binary_precision': 0.9244712, 'binary_recall': 0.8882381, 'binary_specificity': 0.92730564, 'binary_f1_score': 0.9059925}
confusion matrix:
       0      1
0  23548   1846
1   2843  22595
---- Validation: 
scalar performance:
{'acc': 0.9003095, 'precision': 0.5621225, 'recall': 0.7330113, 'specificity': 0.7330113, 'f1': 0.5831166, 'auroc': 0.8396586, 'binary_precision': 0.13667426, 'binary_recall': 0.55684453, 'binary_specificity': 0.9091781, 'binary_f1_score': 0.21947874}
confusion matrix:
       0     1
0  15176  1516
1    191   240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8643346, 'precision': 0.6513018, 'recall': 0.8125623, 'specificity': 0.8125623, 'f1': 0.6882375, 'auroc': 0.88583505, 'binary_precision': 0.32514286, 'binary_recall': 0.7516512, 'binary_specificity': 0.87347335, 'binary_f1_score': 0.45392898}
confusion matrix:
      0     1
0  8153  1181
1   188   569
new oracle model saved
early stop counter: 2
val acc:0.9003095030784607, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.8643345832824707
after epoch: 9,now: 2024-08-06 11:43:07.390911,epoch time: 0:19:50.777575,used: 2:42:37.637776,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91226, 'precision': 0.9134418, 'recall': 0.912279, 'specificity': 0.912279, 'f1': 0.91219985, 'auroc': 0.9700426, 'binary_precision': 0.9357238, 'binary_recall': 0.88546824, 'binary_specificity': 0.9390897, 'binary_f1_score': 0.9099026}
confusion matrix:
       0      1
0  23851   1547
1   2913  22521
---- Validation: 
scalar performance:
{'acc': 0.90620804, 'precision': 0.5658405, 'recall': 0.73377645, 'specificity': 0.73377645, 'f1': 0.58934736, 'auroc': 0.8429512, 'binary_precision': 0.14415506, 'binary_recall': 0.5522042, 'binary_specificity': 0.91534865, 'binary_f1_score': 0.22862631}
confusion matrix:
       0     1
0  15279  1413
1    193   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8730552, 'precision': 0.65941966, 'recall': 0.8148485, 'specificity': 0.8148485, 'f1': 0.6983007, 'auroc': 0.889248, 'binary_precision': 0.34159613, 'binary_recall': 0.7463672, 'binary_specificity': 0.88332975, 'binary_f1_score': 0.4686852}
confusion matrix:
      0     1
0  8245  1089
1   192   565
new oracle model saved
early stop counter: 3
val acc:0.9062080383300781, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.8730552196502686
after epoch: 10,now: 2024-08-06 12:02:01.629387,epoch time: 0:18:54.238476,used: 3:01:31.876252,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9171585, 'precision': 0.91887224, 'recall': 0.9171812, 'specificity': 0.9171812, 'f1': 0.91707665, 'auroc': 0.9728496, 'binary_precision': 0.9458426, 'binary_recall': 0.88511443, 'binary_specificity': 0.94924796, 'binary_f1_score': 0.9144714}
confusion matrix:
       0      1
0  24109   1289
1   2922  22512
---- Validation: 
scalar performance:
{'acc': 0.91385853, 'precision': 0.57028997, 'recall': 0.7297895, 'specificity': 0.7297895, 'f1': 0.5964301, 'auroc': 0.8453796, 'binary_precision': 0.15338646, 'binary_recall': 0.5359629, 'binary_specificity': 0.9236161, 'binary_f1_score': 0.23851316}
confusion matrix:
       0     1
0  15417  1275
1    200   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88078487, 'precision': 0.6670983, 'recall': 0.81538516, 'specificity': 0.81538516, 'f1': 0.70716774, 'auroc': 0.8913554, 'binary_precision': 0.35741687, 'binary_recall': 0.7384412, 'binary_specificity': 0.8923291, 'binary_f1_score': 0.48168895}
confusion matrix:
      0     1
0  8329  1005
1   198   559
new oracle model saved
early stop counter: 4
val acc:0.9138585329055786, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.8807848691940308
after epoch: 11,now: 2024-08-06 12:20:59.340119,epoch time: 0:18:57.710732,used: 3:20:29.586984,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9229029, 'precision': 0.92413294, 'recall': 0.92292416, 'specificity': 0.92292416, 'f1': 0.92284954, 'auroc': 0.97503316, 'binary_precision': 0.9471715, 'binary_recall': 0.8958956, 'binary_specificity': 0.9499527, 'binary_f1_score': 0.92082024}
confusion matrix:
       0      1
0  24125   1271
1   2648  22788
---- Validation: 
scalar performance:
{'acc': 0.90673363, 'precision': 0.5674713, 'recall': 0.73969674, 'specificity': 0.73969674, 'f1': 0.591832, 'auroc': 0.84891284, 'binary_precision': 0.14709443, 'binary_recall': 0.5638051, 'binary_specificity': 0.9155883, 'binary_f1_score': 0.23331733}
confusion matrix:
       0     1
0  15283  1409
1    188   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87919927, 'precision': 0.6663015, 'recall': 0.8187766, 'specificity': 0.8187766, 'f1': 0.7065666, 'auroc': 0.8939259, 'binary_precision': 0.35508156, 'binary_recall': 0.74768823, 'binary_specificity': 0.889865, 'binary_f1_score': 0.4814972}
confusion matrix:
      0     1
0  8306  1028
1   191   566
early stop counter: 5
val acc:0.9067336320877075, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.8807848691940308
after epoch: 12,now: 2024-08-06 12:40:03.863789,epoch time: 0:19:04.523670,used: 3:39:34.110654,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9242013, 'precision': 0.9249782, 'recall': 0.9242182, 'specificity': 0.9242182, 'f1': 0.9241686, 'auroc': 0.9763856, 'binary_precision': 0.9433466, 'binary_recall': 0.9027363, 'binary_specificity': 0.9457001, 'binary_f1_score': 0.9225948}
confusion matrix:
       0      1
0  24017   1379
1   2474  22962
---- Validation: 
scalar performance:
{'acc': 0.8924838, 'precision': 0.56195116, 'recall': 0.7527303, 'specificity': 0.7527303, 'f1': 0.5815816, 'auroc': 0.8515829, 'binary_precision': 0.13509317, 'binary_recall': 0.60556847, 'binary_specificity': 0.89989215, 'binary_f1_score': 0.22090565}
confusion matrix:
       0     1
0  15021  1671
1    170   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8730552, 'precision': 0.6628709, 'recall': 0.82880795, 'specificity': 0.82880795, 'f1': 0.70318085, 'auroc': 0.8964846, 'binary_precision': 0.34588236, 'binary_recall': 0.7767503, 'binary_specificity': 0.88086563, 'binary_f1_score': 0.47863248}
confusion matrix:
      0     1
0  8222  1112
1   169   588
early stop counter: 6
val acc:0.8924837708473206, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.8807848691940308
after epoch: 13,now: 2024-08-06 12:59:36.470909,epoch time: 0:19:32.607120,used: 3:59:06.717774,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9262079, 'precision': 0.9271016, 'recall': 0.926226, 'specificity': 0.926226, 'f1': 0.9261713, 'auroc': 0.97644603, 'binary_precision': 0.946837, 'binary_recall': 0.90324736, 'binary_specificity': 0.9492046, 'binary_f1_score': 0.92452866}
confusion matrix:
       0      1
0  24106   1290
1   2461  22975
---- Validation: 
scalar performance:
{'acc': 0.8954622, 'precision': 0.5640252, 'recall': 0.75538814, 'specificity': 0.75538814, 'f1': 0.58519554, 'auroc': 0.85295165, 'binary_precision': 0.13913967, 'binary_recall': 0.60788864, 'binary_specificity': 0.9028876, 'binary_f1_score': 0.2264477}
confusion matrix:
       0     1
0  15071  1621
1    169   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87592906, 'precision': 0.6651764, 'recall': 0.8273268, 'specificity': 0.8273268, 'f1': 0.70586854, 'auroc': 0.89738834, 'binary_precision': 0.35099337, 'binary_recall': 0.7701453, 'binary_specificity': 0.88450825, 'binary_f1_score': 0.4822167}
confusion matrix:
      0     1
0  8256  1078
1   174   583
early stop counter: 7
val acc:0.8954622149467468, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.8807848691940308
after epoch: 14,now: 2024-08-06 13:18:29.216125,epoch time: 0:18:52.745216,used: 4:17:59.462990,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92776203, 'precision': 0.92906606, 'recall': 0.9277849, 'specificity': 0.9277849, 'f1': 0.9277097, 'auroc': 0.9787959, 'binary_precision': 0.95292795, 'binary_recall': 0.90010613, 'binary_specificity': 0.95546365, 'binary_f1_score': 0.9257642}
confusion matrix:
       0      1
0  24264   1131
1   2541  22896
---- Validation: 
scalar performance:
{'acc': 0.90626645, 'precision': 0.57001275, 'recall': 0.75301874, 'specificity': 0.75301874, 'f1': 0.5955915, 'auroc': 0.85439324, 'binary_precision': 0.15142518, 'binary_recall': 0.5916473, 'binary_specificity': 0.91439015, 'binary_f1_score': 0.24113475}
confusion matrix:
       0     1
0  15263  1429
1    176   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8825686, 'precision': 0.67093295, 'recall': 0.8236326, 'specificity': 0.8236326, 'f1': 0.71219635, 'auroc': 0.89838135, 'binary_precision': 0.36369428, 'binary_recall': 0.75429326, 'binary_specificity': 0.89297193, 'binary_f1_score': 0.49076065}
confusion matrix:
      0    1
0  8335  999
1   186  571
new oracle model saved
early stop counter: 8
val acc:0.906266450881958, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.8825685977935791
after epoch: 15,now: 2024-08-06 13:38:03.397708,epoch time: 0:19:34.181583,used: 4:37:33.644573,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.93130314, 'precision': 0.93198943, 'recall': 0.9313197, 'specificity': 0.9313197, 'f1': 0.9312776, 'auroc': 0.9793948, 'binary_precision': 0.94941634, 'binary_recall': 0.911271, 'binary_specificity': 0.9513684, 'binary_f1_score': 0.9299527}
confusion matrix:
       0      1
0  24160   1235
1   2257  23180
---- Validation: 
scalar performance:
{'acc': 0.88933015, 'precision': 0.56139535, 'recall': 0.75789356, 'specificity': 0.75789356, 'f1': 0.5801421, 'auroc': 0.8558761, 'binary_precision': 0.13363363, 'binary_recall': 0.61948955, 'binary_specificity': 0.89629763, 'binary_f1_score': 0.21984355}
confusion matrix:
       0     1
0  14961  1731
1    164   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87582994, 'precision': 0.6665268, 'recall': 0.83334255, 'specificity': 0.83334255, 'f1': 0.7078227, 'auroc': 0.89934695, 'binary_precision': 0.35255647, 'binary_recall': 0.78335536, 'binary_specificity': 0.88332975, 'binary_f1_score': 0.48626482}
confusion matrix:
      0     1
0  8245  1089
1   164   593
early stop counter: 9
val acc:0.8893301486968994, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.8825685977935791
after epoch: 16,now: 2024-08-06 13:56:41.282689,epoch time: 0:18:37.884981,used: 4:56:11.529554,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9321097, 'precision': 0.933576, 'recall': 0.9321338, 'specificity': 0.9321338, 'f1': 0.93205476, 'auroc': 0.9797121, 'binary_precision': 0.9589979, 'binary_recall': 0.90293664, 'binary_specificity': 0.96133095, 'binary_f1_score': 0.93012327}
confusion matrix:
       0      1
0  24413    982
1   2469  22968
---- Validation: 
scalar performance:
{'acc': 0.90112716, 'precision': 0.5678387, 'recall': 0.75829375, 'specificity': 0.75829375, 'f1': 0.59174854, 'auroc': 0.8573469, 'binary_precision': 0.14669652, 'binary_recall': 0.60788864, 'binary_specificity': 0.9086988, 'binary_f1_score': 0.23635544}
confusion matrix:
       0     1
0  15168  1524
1    169   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88276684, 'precision': 0.67244434, 'recall': 0.8292022, 'specificity': 0.8292022, 'f1': 0.71438825, 'auroc': 0.8999004, 'binary_precision': 0.3656999, 'binary_recall': 0.7661823, 'binary_specificity': 0.892222, 'binary_f1_score': 0.4950918}
confusion matrix:
      0     1
0  8328  1006
1   177   580
new oracle model saved
early stop counter: 10
val acc:0.9011271595954895, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.882766842842102
after epoch: 17,now: 2024-08-06 14:14:53.778025,epoch time: 0:18:12.495336,used: 5:14:24.024890,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93330973, 'precision': 0.93399763, 'recall': 0.9333247, 'specificity': 0.9333247, 'f1': 0.9332848, 'auroc': 0.9802768, 'binary_precision': 0.95146424, 'binary_recall': 0.91330844, 'binary_specificity': 0.95334095, 'binary_f1_score': 0.931996}
confusion matrix:
       0      1
0  24212   1185
1   2205  23230
---- Validation: 
scalar performance:
{'acc': 0.883198, 'precision': 0.5596905, 'recall': 0.7637895, 'specificity': 0.7637895, 'f1': 0.5762934, 'auroc': 0.8578638, 'binary_precision': 0.12977819, 'binary_recall': 0.63805103, 'binary_specificity': 0.8895279, 'binary_f1_score': 0.21568628}
confusion matrix:
       0     1
0  14848  1844
1    156   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8739471, 'precision': 0.66468185, 'recall': 0.83293176, 'specificity': 0.83293176, 'f1': 0.7055758, 'auroc': 0.9005542, 'binary_precision': 0.34879625, 'binary_recall': 0.7846764, 'binary_specificity': 0.8811871, 'binary_f1_score': 0.4829268}
confusion matrix:
      0     1
0  8225  1109
1   163   594
early stop counter: 11
val acc:0.8831980228424072, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.882766842842102
after epoch: 18,now: 2024-08-06 14:32:57.340315,epoch time: 0:18:03.562290,used: 5:32:27.587180,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9339786, 'precision': 0.9351777, 'recall': 0.93400246, 'specificity': 0.93400246, 'f1': 0.9339355, 'auroc': 0.9810251, 'binary_precision': 0.9582486, 'binary_recall': 0.90762216, 'binary_specificity': 0.96038276, 'binary_f1_score': 0.9322486}
confusion matrix:
       0      1
0  24387   1006
1   2350  23089
---- Validation: 
scalar performance:
{'acc': 0.89365184, 'precision': 0.5646497, 'recall': 0.76350063, 'specificity': 0.76350063, 'f1': 0.5858026, 'auroc': 0.85850745, 'binary_precision': 0.13989638, 'binary_recall': 0.6264501, 'binary_specificity': 0.90055114, 'binary_f1_score': 0.22871664}
confusion matrix:
       0     1
0  15032  1660
1    161   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88038844, 'precision': 0.67082953, 'recall': 0.832772, 'specificity': 0.832772, 'f1': 0.7128414, 'auroc': 0.90064764, 'binary_precision': 0.36162362, 'binary_recall': 0.7767503, 'binary_specificity': 0.88879365, 'binary_f1_score': 0.49349558}
confusion matrix:
      0     1
0  8296  1038
1   169   588
early stop counter: 12
val acc:0.8936518430709839, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.882766842842102
after epoch: 19,now: 2024-08-06 14:51:11.484460,epoch time: 0:18:14.144145,used: 5:50:41.731325,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9357688, 'precision': 0.93694174, 'recall': 0.9357883, 'specificity': 0.9357883, 'f1': 0.93572766, 'auroc': 0.9821979, 'binary_precision': 0.95976776, 'binary_recall': 0.90977, 'binary_specificity': 0.96180654, 'binary_f1_score': 0.93410033}
confusion matrix:
       0      1
0  24427    970
1   2295  23140
---- Validation: 
scalar performance:
{'acc': 0.89038134, 'precision': 0.56330305, 'recall': 0.7652136, 'specificity': 0.7652136, 'f1': 0.583179, 'auroc': 0.8597978, 'binary_precision': 0.1370482, 'binary_recall': 0.6334107, 'binary_specificity': 0.8970165, 'binary_f1_score': 0.2253405}
confusion matrix:
       0     1
0  14973  1719
1    158   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87999207, 'precision': 0.67080677, 'recall': 0.8343785, 'specificity': 0.8343785, 'f1': 0.71293247, 'auroc': 0.90081996, 'binary_precision': 0.36124694, 'binary_recall': 0.7807133, 'binary_specificity': 0.8880437, 'binary_f1_score': 0.49394068}
confusion matrix:
      0     1
0  8289  1045
1   166   591
early stop counter: 13
val acc:0.8903813362121582, best validation acc: 0.9169538021087646, corresponding to test acc:                         0.8639381527900696 / 0.882766842842102
after epoch: 20,now: 2024-08-06 15:09:50.729511,epoch time: 0:18:39.245051,used: 6:09:20.976376,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_09_00_29_seed_1_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:09:20.976376 at 2024-08-06 15:09:50.729511
persisted model performance metric: 

scalar performance:
{'acc': 0.86393815, 'precision': 0.64211184, 'recall': 0.77957356, 'specificity': 0.77957356, 'f1': 0.67570245, 'auroc': 0.8718627, 'binary_precision': 0.3128797, 'binary_recall': 0.68031704, 'binary_specificity': 0.8788301, 'binary_f1_score': 0.4286309}
confusion matrix:
      0     1
0  8203  1131
1   242   515
oracle model performance metric: 

scalar performance:
{'acc': 0.88276684, 'precision': 0.67244434, 'recall': 0.8292022, 'specificity': 0.8292022, 'f1': 0.71438825, 'auroc': 0.8999004, 'binary_precision': 0.3656999, 'binary_recall': 0.7661823, 'binary_specificity': 0.892222, 'binary_f1_score': 0.4950918}
confusion matrix:
      0     1
0  8328  1006
1   177   580
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB | 725951 GiB | 725950 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB | 725951 GiB | 725950 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB | 725909 GiB | 725908 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |  16648 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    778 MiB | 270336 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     46 MiB |   8192 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  91217 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 384171 GiB | 384171 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6837    |  162969 K  |  162965 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92885 K  |   92881 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6837    |  162969 K  |  162965 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92885 K  |   92881 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      56    |      15    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      23    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3196    |   87553 K  |   87553 K  |
|       from large pool |      10    |      23    |   44071 K  |   44071 K  |
|       from small pool |      21    |    3186    |   43481 K  |   43481 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    778 MiB | 563200 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     46 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  91217 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384171 GiB | 384171 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162969 K  |  162969 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92885 K  |   92885 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162969 K  |  162969 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92885 K  |   92885 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      56    |      32    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      23    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87555 K  |   87555 K  |
|       from large pool |       3    |      23    |   44071 K  |   44071 K  |
|       from small pool |       0    |    3186    |   43483 K  |   43483 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711033 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    778 MiB | 563200 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     46 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  91217 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384171 GiB | 384171 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162969 K  |  162969 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92885 K  |   92885 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162969 K  |  162969 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92885 K  |   92885 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      56    |      32    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      23    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87555 K  |   87555 K  |
|       from large pool |       3    |      23    |   44071 K  |   44071 K  |
|       from small pool |       0    |    3186    |   43483 K  |   43483 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667

 Experiment start at: 2024-08-06 15:37:21.247227
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7352793, 'precision': 0.73557204, 'recall': 0.7352807, 'specificity': 0.7352807, 'f1': 0.7351979, 'auroc': 0.8117447, 'binary_precision': 0.7438951, 'binary_recall': 0.7176789, 'binary_specificity': 0.7528825, 'binary_f1_score': 0.7305519}
confusion matrix:
       0      1
0  19459   6387
1   7298  18552
---- Validation: 
scalar performance:
{'acc': 0.56085026, 'precision': 0.5139945, 'recall': 0.6454782, 'specificity': 0.6454782, 'f1': 0.3937587, 'auroc': 0.6856487, 'binary_precision': 0.039787456, 'binary_recall': 0.73444974, 'binary_specificity': 0.55650663, 'binary_f1_score': 0.07548562}
confusion matrix:
      0     1
0  9297  7409
1   111   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5279429, 'precision': 0.55597144, 'recall': 0.69153917, 'specificity': 0.69153917, 'f1': 0.44426778, 'auroc': 0.7955192, 'binary_precision': 0.13125116, 'binary_recall': 0.8858218, 'binary_specificity': 0.49725658, 'binary_f1_score': 0.22862695}
confusion matrix:
      0     1
0  4622  4673
1    91   706
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 15:57:03.669301,epoch time: 0:19:42.422074,used: 0:19:42.422074,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8239902, 'precision': 0.82403815, 'recall': 0.8239891, 'specificity': 0.8239891, 'f1': 0.8239834, 'auroc': 0.90167844, 'binary_precision': 0.8201483, 'binary_recall': 0.83007777, 'binary_specificity': 0.8179004, 'binary_f1_score': 0.82508314}
confusion matrix:
       0      1
0  21137   4706
1   4393  21460
---- Validation: 
scalar performance:
{'acc': 0.63285446, 'precision': 0.5193874, 'recall': 0.69171107, 'specificity': 0.69171107, 'f1': 0.43052405, 'auroc': 0.73861897, 'binary_precision': 0.048468996, 'binary_recall': 0.7535885, 'binary_specificity': 0.6298336, 'binary_f1_score': 0.09107995}
confusion matrix:
       0     1
0  10522  6184
1    103   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5765953, 'precision': 0.5641363, 'recall': 0.7202455, 'specificity': 0.7202455, 'f1': 0.47727823, 'auroc': 0.81588674, 'binary_precision': 0.14501634, 'binary_recall': 0.89084065, 'binary_specificity': 0.5496504, 'binary_f1_score': 0.24942914}
confusion matrix:
      0     1
0  5109  4186
1    87   710
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 16:15:27.847841,epoch time: 0:18:24.178540,used: 0:38:06.600614,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8526385, 'precision': 0.8527789, 'recall': 0.8526416, 'specificity': 0.8526416, 'f1': 0.8526246, 'auroc': 0.92943597, 'binary_precision': 0.8598942, 'binary_recall': 0.8426671, 'binary_specificity': 0.8626161, 'binary_f1_score': 0.8511934}
confusion matrix:
       0      1
0  22290   3550
1   4068  21788
---- Validation: 
scalar performance:
{'acc': 0.71770614, 'precision': 0.5241324, 'recall': 0.7095411, 'specificity': 0.7095411, 'f1': 0.4702169, 'auroc': 0.7627127, 'binary_precision': 0.05857657, 'binary_recall': 0.70095694, 'binary_specificity': 0.7181252, 'binary_f1_score': 0.10811808}
confusion matrix:
       0     1
0  11997  4709
1    125   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6414982, 'precision': 0.5728799, 'recall': 0.7434347, 'specificity': 0.7434347, 'f1': 0.5188031, 'auroc': 0.82746994, 'binary_precision': 0.16408668, 'binary_recall': 0.8644918, 'binary_specificity': 0.62237763, 'binary_f1_score': 0.27582067}
confusion matrix:
      0     1
0  5785  3510
1   108   689
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 16:33:51.997764,epoch time: 0:18:24.149923,used: 0:56:30.750537,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87173086, 'precision': 0.8720948, 'recall': 0.8717321, 'specificity': 0.8717321, 'f1': 0.8716998, 'auroc': 0.9441489, 'binary_precision': 0.8837507, 'binary_recall': 0.8560929, 'binary_specificity': 0.88737136, 'binary_f1_score': 0.8697019}
confusion matrix:
       0      1
0  22935   2911
1   3720  22130
---- Validation: 
scalar performance:
{'acc': 0.7672273, 'precision': 0.52789253, 'recall': 0.7139288, 'specificity': 0.7139288, 'f1': 0.49354887, 'auroc': 0.78224826, 'binary_precision': 0.06677999, 'binary_recall': 0.65789473, 'binary_specificity': 0.7699629, 'binary_f1_score': 0.12125222}
confusion matrix:
       0     1
0  12863  3843
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.690547, 'precision': 0.5810145, 'recall': 0.7574436, 'specificity': 0.7574436, 'f1': 0.5503644, 'auroc': 0.83757246, 'binary_precision': 0.18224044, 'binary_recall': 0.8368883, 'binary_specificity': 0.6779989, 'binary_f1_score': 0.29930446}
confusion matrix:
      0     1
0  6302  2993
1   130   667
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 16:51:49.896903,epoch time: 0:17:57.899139,used: 1:14:28.649676,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8830664, 'precision': 0.88396907, 'recall': 0.88307106, 'specificity': 0.88307106, 'f1': 0.8829986, 'auroc': 0.9519112, 'binary_precision': 0.9026344, 'binary_recall': 0.85881716, 'binary_specificity': 0.907325, 'binary_f1_score': 0.88018084}
confusion matrix:
       0      1
0  23448   2395
1   3650  22203
---- Validation: 
scalar performance:
{'acc': 0.79665965, 'precision': 0.5324468, 'recall': 0.72668076, 'specificity': 0.72668076, 'f1': 0.5101647, 'auroc': 0.79553574, 'binary_precision': 0.07562327, 'binary_recall': 0.65311, 'binary_specificity': 0.8002514, 'binary_f1_score': 0.13555114}
confusion matrix:
       0     1
0  13369  3337
1    145   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72671425, 'precision': 0.5897133, 'recall': 0.7701951, 'specificity': 0.7701951, 'f1': 0.57544565, 'auroc': 0.8459703, 'binary_precision': 0.20024458, 'binary_recall': 0.8218319, 'binary_specificity': 0.7185584, 'binary_f1_score': 0.32202557}
confusion matrix:
      0     1
0  6679  2616
1   142   655
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 17:10:02.741489,epoch time: 0:18:12.844586,used: 1:32:41.494262,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8902236, 'precision': 0.8910911, 'recall': 0.89022267, 'specificity': 0.89022267, 'f1': 0.8901625, 'auroc': 0.9570744, 'binary_precision': 0.9095006, 'binary_recall': 0.866677, 'binary_specificity': 0.9137684, 'binary_f1_score': 0.8875725}
confusion matrix:
       0      1
0  23620   2229
1   3446  22401
---- Validation: 
scalar performance:
{'acc': 0.81085026, 'precision': 0.5352705, 'recall': 0.7339536, 'specificity': 0.7339536, 'f1': 0.518964, 'auroc': 0.8060702, 'binary_precision': 0.08108108, 'binary_recall': 0.65311, 'binary_specificity': 0.8147971, 'binary_f1_score': 0.14425363}
confusion matrix:
       0     1
0  13612  3094
1    145   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74336106, 'precision': 0.5936001, 'recall': 0.7729231, 'specificity': 0.7729231, 'f1': 0.5866464, 'auroc': 0.8534571, 'binary_precision': 0.20902304, 'binary_recall': 0.8080301, 'binary_specificity': 0.73781604, 'binary_f1_score': 0.33212999}
confusion matrix:
      0     1
0  6858  2437
1   153   644
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-06 17:28:35.663600,epoch time: 0:18:32.922111,used: 1:51:14.416373,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8984641, 'precision': 0.89932406, 'recall': 0.89846766, 'specificity': 0.89846766, 'f1': 0.89841, 'auroc': 0.96100247, 'binary_precision': 0.9178938, 'binary_recall': 0.8752514, 'binary_specificity': 0.92168397, 'binary_f1_score': 0.89606565}
confusion matrix:
       0      1
0  23820   2024
1   3225  22627
---- Validation: 
scalar performance:
{'acc': 0.8199019, 'precision': 0.5369565, 'recall': 0.7362602, 'specificity': 0.7362602, 'f1': 0.52438205, 'auroc': 0.81562495, 'binary_precision': 0.08447631, 'binary_recall': 0.6483254, 'binary_specificity': 0.8241949, 'binary_f1_score': 0.149476}
confusion matrix:
       0     1
0  13769  2937
1    147   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7614943, 'precision': 0.6004773, 'recall': 0.78276706, 'specificity': 0.78276706, 'f1': 0.60130155, 'auroc': 0.8594181, 'binary_precision': 0.22222222, 'binary_recall': 0.8080301, 'binary_specificity': 0.75750405, 'binary_f1_score': 0.34857917}
confusion matrix:
      0     1
0  7041  2254
1   153   644
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-06 17:47:08.331341,epoch time: 0:18:32.667741,used: 2:09:47.084114,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9034935, 'precision': 0.90486395, 'recall': 0.90349686, 'specificity': 0.90349686, 'f1': 0.90341234, 'auroc': 0.9658878, 'binary_precision': 0.9284482, 'binary_recall': 0.87439555, 'binary_specificity': 0.9325982, 'binary_f1_score': 0.9006116}
confusion matrix:
       0      1
0  24103   1742
1   3247  22604
---- Validation: 
scalar performance:
{'acc': 0.8264424, 'precision': 0.53852665, 'recall': 0.7396122, 'specificity': 0.7396122, 'f1': 0.52876973, 'auroc': 0.8229177, 'binary_precision': 0.0875323, 'binary_recall': 0.6483254, 'binary_specificity': 0.83089906, 'binary_f1_score': 0.15424019}
confusion matrix:
       0     1
0  13881  2825
1    147   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7745739, 'precision': 0.6049975, 'recall': 0.7864263, 'specificity': 0.7864263, 'f1': 0.61127955, 'auroc': 0.863474, 'binary_precision': 0.23166303, 'binary_recall': 0.8005019, 'binary_specificity': 0.7723507, 'binary_f1_score': 0.3593354}
confusion matrix:
      0     1
0  7179  2116
1   159   638
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-06 18:05:16.547449,epoch time: 0:18:08.216108,used: 2:27:55.300222,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9090065, 'precision': 0.9093952, 'recall': 0.90900886, 'specificity': 0.90900886, 'f1': 0.90898526, 'auroc': 0.9679246, 'binary_precision': 0.9220484, 'binary_recall': 0.8935866, 'binary_specificity': 0.9244312, 'binary_f1_score': 0.90759444}
confusion matrix:
       0      1
0  23891   1953
1   2751  23101
---- Validation: 
scalar performance:
{'acc': 0.81055826, 'precision': 0.5379065, 'recall': 0.75363004, 'specificity': 0.75363004, 'f1': 0.52252364, 'auroc': 0.82979333, 'binary_precision': 0.085143864, 'binary_recall': 0.6937799, 'binary_specificity': 0.8134802, 'binary_f1_score': 0.15167364}
confusion matrix:
       0     1
0  13590  3116
1    128   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7667459, 'precision': 0.60504794, 'recall': 0.7942215, 'specificity': 0.7942215, 'f1': 0.6081848, 'auroc': 0.86847615, 'binary_precision': 0.2292174, 'binary_recall': 0.8268507, 'binary_specificity': 0.76159227, 'binary_f1_score': 0.3589325}
confusion matrix:
      0     1
0  7079  2216
1   138   659
early stop counter: 1
val acc:0.8105582594871521, best validation acc: 0.8264424204826355, corresponding to test acc:                         0.7745739221572876 / 0.7745739221572876
after epoch: 9,now: 2024-08-06 18:23:58.610408,epoch time: 0:18:42.062959,used: 2:46:37.363181,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9130687, 'precision': 0.9138073, 'recall': 0.9130728, 'specificity': 0.9130728, 'f1': 0.91303045, 'auroc': 0.97059405, 'binary_precision': 0.9313381, 'binary_recall': 0.8919274, 'binary_specificity': 0.93421817, 'binary_f1_score': 0.9112068}
confusion matrix:
       0      1
0  24143   1700
1   2794  23059
---- Validation: 
scalar performance:
{'acc': 0.8272016, 'precision': 0.5412258, 'recall': 0.7574949, 'specificity': 0.7574949, 'f1': 0.5328314, 'auroc': 0.83510256, 'binary_precision': 0.09187279, 'binary_recall': 0.68421054, 'binary_specificity': 0.8307794, 'binary_f1_score': 0.16199377}
confusion matrix:
       0     1
0  13879  2827
1    132   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7864645, 'precision': 0.6119028, 'recall': 0.79804343, 'specificity': 0.79804343, 'f1': 0.6232046, 'auroc': 0.8709446, 'binary_precision': 0.24396682, 'binary_recall': 0.8117942, 'binary_specificity': 0.78429264, 'binary_f1_score': 0.3751812}
confusion matrix:
      0     1
0  7290  2005
1   150   647
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-06 18:42:38.244966,epoch time: 0:18:39.634558,used: 3:05:16.997739,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91701484, 'precision': 0.91769785, 'recall': 0.91701645, 'specificity': 0.91701645, 'f1': 0.91698116, 'auroc': 0.9723158, 'binary_precision': 0.9346073, 'binary_recall': 0.8967892, 'binary_specificity': 0.9372437, 'binary_f1_score': 0.91530776}
confusion matrix:
       0      1
0  24224   1622
1   2668  23182
---- Validation: 
scalar performance:
{'acc': 0.8346765, 'precision': 0.54357815, 'recall': 0.7636584, 'specificity': 0.7636584, 'f1': 0.53863513, 'auroc': 0.84037066, 'binary_precision': 0.09635329, 'binary_recall': 0.68899524, 'binary_specificity': 0.83832157, 'binary_f1_score': 0.16906369}
confusion matrix:
       0     1
0  14005  2701
1    130   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7955807, 'precision': 0.61640966, 'recall': 0.80299234, 'specificity': 0.80299234, 'f1': 0.63143134, 'auroc': 0.8733867, 'binary_precision': 0.25273436, 'binary_recall': 0.8117942, 'binary_specificity': 0.7941904, 'binary_f1_score': 0.38546318}
confusion matrix:
      0     1
0  7382  1913
1   150   647
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-06 19:01:26.916914,epoch time: 0:18:48.671948,used: 3:24:05.669687,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9185817, 'precision': 0.91933703, 'recall': 0.91858584, 'specificity': 0.91858584, 'f1': 0.9185456, 'auroc': 0.97400784, 'binary_precision': 0.9371819, 'binary_recall': 0.8973427, 'binary_specificity': 0.939829, 'binary_f1_score': 0.9168297}
confusion matrix:
       0      1
0  24288   1555
1   2654  23199
---- Validation: 
scalar performance:
{'acc': 0.8410418, 'precision': 0.5454367, 'recall': 0.7669207, 'specificity': 0.7669207, 'f1': 0.5433515, 'auroc': 0.84488285, 'binary_precision': 0.1, 'binary_recall': 0.68899524, 'binary_specificity': 0.8448462, 'binary_f1_score': 0.17465131}
confusion matrix:
       0     1
0  14114  2592
1    130   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80152595, 'precision': 0.61856055, 'recall': 0.8027785, 'specificity': 0.8027785, 'f1': 0.6358655, 'auroc': 0.874722, 'binary_precision': 0.25763667, 'binary_recall': 0.804266, 'binary_specificity': 0.801291, 'binary_f1_score': 0.39025876}
confusion matrix:
      0     1
0  7448  1847
1   156   641
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-06 19:20:01.797432,epoch time: 0:18:34.880518,used: 3:42:40.550205,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92173475, 'precision': 0.92260647, 'recall': 0.9217391, 'specificity': 0.9217391, 'f1': 0.9216949, 'auroc': 0.97567797, 'binary_precision': 0.9418487, 'binary_recall': 0.8990059, 'binary_specificity': 0.9444724, 'binary_f1_score': 0.9199287}
confusion matrix:
       0      1
0  24408   1435
1   2611  23242
---- Validation: 
scalar performance:
{'acc': 0.8443705, 'precision': 0.546289, 'recall': 0.76746047, 'specificity': 0.76746047, 'f1': 0.54563624, 'auroc': 0.84718513, 'binary_precision': 0.10173697, 'binary_recall': 0.6866029, 'binary_specificity': 0.848318, 'binary_f1_score': 0.17721519}
confusion matrix:
       0     1
0  14172  2534
1    131   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80826396, 'precision': 0.62211144, 'recall': 0.80586284, 'specificity': 0.80586284, 'f1': 0.64205116, 'auroc': 0.87596846, 'binary_precision': 0.26468155, 'binary_recall': 0.8030113, 'binary_specificity': 0.8087144, 'binary_f1_score': 0.39813375}
confusion matrix:
      0     1
0  7517  1778
1   157   640
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-06 19:38:25.400512,epoch time: 0:18:23.603080,used: 4:01:04.153285,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92689955, 'precision': 0.927807, 'recall': 0.9269094, 'specificity': 0.9269094, 'f1': 0.9268619, 'auroc': 0.97792894, 'binary_precision': 0.947616, 'binary_recall': 0.90382457, 'binary_specificity': 0.9499942, 'binary_f1_score': 0.9252024}
confusion matrix:
       0      1
0  24545   1292
1   2487  23372
---- Validation: 
scalar performance:
{'acc': 0.84425366, 'precision': 0.5467778, 'recall': 0.7708993, 'specificity': 0.7708993, 'f1': 0.5462985, 'auroc': 0.84987247, 'binary_precision': 0.10250972, 'binary_recall': 0.6937799, 'binary_specificity': 0.84801865, 'binary_f1_score': 0.17862642}
confusion matrix:
       0     1
0  14167  2539
1    128   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8118312, 'precision': 0.6244777, 'recall': 0.8089465, 'specificity': 0.8089465, 'f1': 0.6458469, 'auroc': 0.87628555, 'binary_precision': 0.26906958, 'binary_recall': 0.8055207, 'binary_specificity': 0.81237227, 'binary_f1_score': 0.403393}
confusion matrix:
      0     1
0  7551  1744
1   155   642
new oracle model saved
early stop counter: 1
val acc:0.844253659248352, best validation acc: 0.8443704843521118, corresponding to test acc:                         0.8082639575004578 / 0.8118311762809753
after epoch: 14,now: 2024-08-06 19:56:33.104934,epoch time: 0:18:07.704422,used: 4:19:11.857707,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9286405, 'precision': 0.92933524, 'recall': 0.92864287, 'specificity': 0.92864287, 'f1': 0.928612, 'auroc': 0.9784287, 'binary_precision': 0.9466344, 'binary_recall': 0.9085142, 'binary_specificity': 0.94877154, 'binary_f1_score': 0.92718273}
confusion matrix:
       0      1
0  24521   1324
1   2365  23486
---- Validation: 
scalar performance:
{'acc': 0.84250176, 'precision': 0.5472702, 'recall': 0.7769989, 'specificity': 0.7769989, 'f1': 0.5464394, 'auroc': 0.8526372, 'binary_precision': 0.103099965, 'binary_recall': 0.708134, 'binary_specificity': 0.84586376, 'binary_f1_score': 0.17999393}
confusion matrix:
       0     1
0  14131  2575
1    122   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8132184, 'precision': 0.6257659, 'recall': 0.8114202, 'specificity': 0.8114202, 'f1': 0.64773774, 'auroc': 0.8782269, 'binary_precision': 0.27123633, 'binary_recall': 0.8092848, 'binary_specificity': 0.81355566, 'binary_f1_score': 0.40629923}
confusion matrix:
      0     1
0  7562  1733
1   152   645
new oracle model saved
early stop counter: 2
val acc:0.8425017595291138, best validation acc: 0.8443704843521118, corresponding to test acc:                         0.8082639575004578 / 0.8132184147834778
after epoch: 15,now: 2024-08-06 20:15:37.440290,epoch time: 0:19:04.335356,used: 4:38:16.193063,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.92705435, 'precision': 0.9281129, 'recall': 0.9270582, 'specificity': 0.9270582, 'f1': 0.9270096, 'auroc': 0.9772134, 'binary_precision': 0.94944024, 'binary_recall': 0.90217394, 'binary_specificity': 0.95194244, 'binary_f1_score': 0.92520374}
confusion matrix:
       0      1
0  24602   1242
1   2529  23323
---- Validation: 
scalar performance:
{'acc': 0.84296894, 'precision': 0.54758954, 'recall': 0.77840453, 'specificity': 0.77840453, 'f1': 0.54704607, 'auroc': 0.8555749, 'binary_precision': 0.10366492, 'binary_recall': 0.7105263, 'binary_specificity': 0.8462828, 'binary_f1_score': 0.18093206}
confusion matrix:
       0     1
0  14138  2568
1    121   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8152993, 'precision': 0.6268428, 'recall': 0.8119763, 'specificity': 0.8119763, 'f1': 0.6495942, 'auroc': 0.879032, 'binary_precision': 0.27346072, 'binary_recall': 0.8080301, 'binary_specificity': 0.81592256, 'binary_f1_score': 0.40862942}
confusion matrix:
      0     1
0  7584  1711
1   153   644
new oracle model saved
early stop counter: 3
val acc:0.8429689407348633, best validation acc: 0.8443704843521118, corresponding to test acc:                         0.8082639575004578 / 0.8152992725372314
after epoch: 16,now: 2024-08-06 20:33:47.376392,epoch time: 0:18:09.936102,used: 4:56:26.129165,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9303428, 'precision': 0.9312294, 'recall': 0.9303489, 'specificity': 0.9303489, 'f1': 0.9303076, 'auroc': 0.97912437, 'binary_precision': 0.9508509, 'binary_recall': 0.9076387, 'binary_specificity': 0.9530591, 'binary_f1_score': 0.92874247}
confusion matrix:
       0      1
0  24628   1213
1   2388  23467
---- Validation: 
scalar performance:
{'acc': 0.84495443, 'precision': 0.548396, 'recall': 0.7805884, 'specificity': 0.7805884, 'f1': 0.5488374, 'auroc': 0.85834515, 'binary_precision': 0.10518885, 'binary_recall': 0.71291864, 'binary_specificity': 0.84825814, 'binary_f1_score': 0.18332821}
confusion matrix:
       0     1
0  14171  2535
1    120   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8167856, 'precision': 0.6274221, 'recall': 0.8116361, 'specificity': 0.8116361, 'f1': 0.65069574, 'auroc': 0.8794561, 'binary_precision': 0.27482876, 'binary_recall': 0.8055207, 'binary_specificity': 0.81775147, 'binary_f1_score': 0.40983084}
confusion matrix:
      0     1
0  7601  1694
1   155   642
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-08-06 20:52:02.206806,epoch time: 0:18:14.830414,used: 5:14:40.959579,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93262535, 'precision': 0.933128, 'recall': 0.932626, 'specificity': 0.932626, 'f1': 0.93260586, 'auroc': 0.98016286, 'binary_precision': 0.9478933, 'binary_recall': 0.91558665, 'binary_specificity': 0.94966537, 'binary_f1_score': 0.93145996}
confusion matrix:
       0      1
0  24546   1301
1   2182  23667
---- Validation: 
scalar performance:
{'acc': 0.8371876, 'precision': 0.54701155, 'recall': 0.7836052, 'specificity': 0.7836052, 'f1': 0.54433364, 'auroc': 0.86055505, 'binary_precision': 0.10208193, 'binary_recall': 0.72727275, 'binary_specificity': 0.83993775, 'binary_f1_score': 0.17903414}
confusion matrix:
       0     1
0  14032  2674
1    114   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8112366, 'precision': 0.62445045, 'recall': 0.8097708, 'specificity': 0.8097708, 'f1': 0.64563215, 'auroc': 0.8797549, 'binary_precision': 0.2687813, 'binary_recall': 0.8080301, 'binary_specificity': 0.8115116, 'binary_f1_score': 0.40338242}
confusion matrix:
      0     1
0  7543  1752
1   153   644
early stop counter: 1
val acc:0.8371875882148743, best validation acc: 0.8449544310569763, corresponding to test acc:                         0.8167855739593506 / 0.8167855739593506
after epoch: 18,now: 2024-08-06 21:11:19.890992,epoch time: 0:19:17.684186,used: 5:33:58.643765,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93399876, 'precision': 0.93496954, 'recall': 0.9340006, 'specificity': 0.9340006, 'f1': 0.9339621, 'auroc': 0.9811795, 'binary_precision': 0.9555384, 'binary_recall': 0.9103675, 'binary_specificity': 0.9576337, 'binary_f1_score': 0.9324062}
confusion matrix:
       0      1
0  24751   1095
1   2317  23533
---- Validation: 
scalar performance:
{'acc': 0.85680914, 'precision': 0.5523333, 'recall': 0.7854978, 'specificity': 0.7854978, 'f1': 0.5582126, 'auroc': 0.8621808, 'binary_precision': 0.1130137, 'binary_recall': 0.7105263, 'binary_specificity': 0.8604693, 'binary_f1_score': 0.19500986}
confusion matrix:
       0     1
0  14375  2331
1    121   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82907254, 'precision': 0.63434523, 'recall': 0.814865, 'specificity': 0.814865, 'f1': 0.6620289, 'auroc': 0.88050497, 'binary_precision': 0.2890909, 'binary_recall': 0.79799247, 'binary_specificity': 0.8317375, 'binary_f1_score': 0.4244244}
confusion matrix:
      0     1
0  7731  1564
1   161   636
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-08-06 21:31:38.740292,epoch time: 0:20:18.849300,used: 5:54:17.493065,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.93606853, 'precision': 0.9365618, 'recall': 0.9360718, 'specificity': 0.9360718, 'f1': 0.9360509, 'auroc': 0.98227763, 'binary_precision': 0.95128495, 'binary_recall': 0.9192357, 'binary_specificity': 0.9529079, 'binary_f1_score': 0.9349858}
confusion matrix:
       0      1
0  24626   1217
1   2088  23765
---- Validation: 
scalar performance:
{'acc': 0.8457136, 'precision': 0.5502025, 'recall': 0.7914736, 'specificity': 0.7914736, 'f1': 0.5516636, 'auroc': 0.86317873, 'binary_precision': 0.10817477, 'binary_recall': 0.73444974, 'binary_specificity': 0.84849757, 'binary_f1_score': 0.18857493}
confusion matrix:
       0     1
0  14175  2531
1    111   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8216409, 'precision': 0.630429, 'recall': 0.8142719, 'specificity': 0.8142719, 'f1': 0.65553963, 'auroc': 0.8814762, 'binary_precision': 0.2807171, 'binary_recall': 0.8055207, 'binary_specificity': 0.82302314, 'binary_f1_score': 0.41634244}
confusion matrix:
      0     1
0  7650  1645
1   155   642
early stop counter: 1
val acc:0.8457136154174805, best validation acc: 0.856809139251709, corresponding to test acc:                         0.8290725350379944 / 0.8290725350379944
after epoch: 20,now: 2024-08-06 21:52:18.497831,epoch time: 0:20:39.757539,used: 6:14:57.250604,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_15_37_21_seed_2_24076667
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:14:57.250604 at 2024-08-06 21:52:18.497831
persisted model performance metric: 

scalar performance:
{'acc': 0.82907254, 'precision': 0.63434523, 'recall': 0.814865, 'specificity': 0.814865, 'f1': 0.6620289, 'auroc': 0.88050497, 'binary_precision': 0.2890909, 'binary_recall': 0.79799247, 'binary_specificity': 0.8317375, 'binary_f1_score': 0.4244244}
confusion matrix:
      0     1
0  7731  1564
1   161   636
oracle model performance metric: 

scalar performance:
{'acc': 0.82907254, 'precision': 0.63434523, 'recall': 0.814865, 'specificity': 0.814865, 'f1': 0.6620289, 'auroc': 0.88050497, 'binary_precision': 0.2890909, 'binary_recall': 0.79799247, 'binary_specificity': 0.8317375, 'binary_f1_score': 0.4244244}
confusion matrix:
      0     1
0  7731  1564
1   161   636
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  16648 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1064 MiB | 563200 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     56 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  91217 KiB | 611402 GiB | 611402 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 588393 GiB | 588393 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6945    |  246587 K  |  246582 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140325 K  |  140321 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6945    |  246587 K  |  246582 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140325 K  |  140321 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      73    |      32    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3250    |  133398 K  |  133398 K  |
|       from large pool |      10    |      23    |   64621 K  |   64621 K  |
|       from small pool |      21    |    3240    |   68777 K  |   68777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |   1064 MiB |    836 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  28672 KiB |  43008 KiB |     56 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  91217 KiB | 611402 GiB | 611402 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 588393 GiB | 588393 GiB |
|       from small pool |      0 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6945    |  246587 K  |  246587 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140325 K  |  140325 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6945    |  246587 K  |  246587 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140325 K  |  140325 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      73    |      49    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3250    |  133400 K  |  133400 K  |
|       from large pool |       3    |      23    |   64621 K  |   64621 K  |
|       from small pool |       0    |    3240    |   68779 K  |   68779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug  6 22:12:18 2024]
Finished job 0.
1 of 1 steps (100%) done
