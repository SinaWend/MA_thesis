Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Aug  7 03:17:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373

 Experiment start at: 2024-08-07 03:25:31.739782
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9888661, 'precision': 0.9888663, 'recall': 0.9888663, 'specificity': 0.9888663, 'f1': 0.9888661, 'auroc': 0.99913067, 'binary_precision': 0.98937476, 'binary_recall': 0.9883597, 'binary_specificity': 0.989373, 'binary_f1_score': 0.988867}
confusion matrix:
       0      1
0  25044    269
1    295  25048
---- Validation: 
scalar performance:
{'acc': 0.91589874, 'precision': 0.6028399, 'recall': 0.9016844, 'specificity': 0.9016844, 'f1': 0.6465111, 'auroc': 0.94711816, 'binary_precision': 0.20873511, 'binary_recall': 0.886747, 'binary_specificity': 0.91662186, 'binary_f1_score': 0.33792472}
confusion matrix:
       0     1
0  15336  1395
1     47   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8004746, 'precision': 0.63052803, 'recall': 0.8610975, 'specificity': 0.8610975, 'f1': 0.6480459, 'auroc': 0.9311692, 'binary_precision': 0.2680566, 'binary_recall': 0.93264246, 'binary_specificity': 0.78955257, 'binary_f1_score': 0.41642565}
confusion matrix:
      0     1
0  7376  1966
1    52   720
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 03:45:28.970188,epoch time: 0:19:57.230406,used: 0:19:57.230406,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9889845, 'precision': 0.98899674, 'recall': 0.9889832, 'specificity': 0.9889832, 'f1': 0.9889844, 'auroc': 0.9992677, 'binary_precision': 0.98668605, 'binary_recall': 0.9913582, 'binary_specificity': 0.9866082, 'binary_f1_score': 0.9890166}
confusion matrix:
       0      1
0  24975    339
1    219  25123
---- Validation: 
scalar performance:
{'acc': 0.9507757, 'precision': 0.6523749, 'recall': 0.8948818, 'specificity': 0.8948818, 'f1': 0.71273375, 'auroc': 0.94336843, 'binary_precision': 0.30899376, 'binary_recall': 0.83614457, 'binary_specificity': 0.953619, 'binary_f1_score': 0.45123538}
confusion matrix:
       0    1
0  15955  776
1     68  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8876805, 'precision': 0.6916135, 'recall': 0.8839437, 'specificity': 0.8839437, 'f1': 0.74022454, 'auroc': 0.9265512, 'binary_precision': 0.39430895, 'binary_recall': 0.8795337, 'binary_specificity': 0.88835365, 'binary_f1_score': 0.54450685}
confusion matrix:
      0     1
0  8299  1043
1    93   679
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 04:03:37.869352,epoch time: 0:18:08.899164,used: 0:38:06.129570,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.988412, 'precision': 0.9885411, 'recall': 0.9884076, 'specificity': 0.9884076, 'f1': 0.9884112, 'auroc': 0.99962276, 'binary_precision': 0.9807356, 'binary_recall': 0.9964091, 'binary_specificity': 0.9804061, 'binary_f1_score': 0.98851025}
confusion matrix:
       0      1
0  24818    496
1     91  25251
---- Validation: 
scalar performance:
{'acc': 0.78519773, 'precision': 0.54694194, 'recall': 0.85821164, 'specificity': 0.85821164, 'f1': 0.52528805, 'auroc': 0.9548439, 'binary_precision': 0.095944606, 'binary_recall': 0.93493974, 'binary_specificity': 0.7814835, 'binary_f1_score': 0.17403005}
confusion matrix:
       0     1
0  13075  3656
1     27   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6450465, 'precision': 0.58301294, 'recall': 0.787656, 'specificity': 0.787656, 'f1': 0.52728903, 'auroc': 0.9225745, 'binary_precision': 0.17186773, 'binary_recall': 0.95595855, 'binary_specificity': 0.6193535, 'binary_f1_score': 0.29135415}
confusion matrix:
      0     1
0  5786  3556
1    34   738
early stop counter: 1
val acc:0.7851977348327637, best validation acc: 0.950775682926178, corresponding to test acc:                         0.8876804709434509 / 0.8876804709434509
after epoch: 3,now: 2024-08-07 04:22:07.905605,epoch time: 0:18:30.036253,used: 0:56:36.165823,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98010105, 'precision': 0.9808488, 'recall': 0.9801128, 'specificity': 0.9801128, 'f1': 0.9800936, 'auroc': 0.9994385, 'binary_precision': 0.99995893, 'binary_recall': 0.96026516, 'binary_specificity': 0.9999605, 'binary_f1_score': 0.9797101}
confusion matrix:
       0      1
0  25312      1
1   1007  24336
---- Validation: 
scalar performance:
{'acc': 0.97742915, 'precision': 0.77002954, 'recall': 0.66297776, 'specificity': 0.66297776, 'f1': 0.70239085, 'auroc': 0.9296752, 'binary_precision': 0.5564516, 'binary_recall': 0.3325301, 'binary_specificity': 0.99342537, 'binary_f1_score': 0.4162896}
confusion matrix:
       0    1
0  16621  110
1    277  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233735, 'precision': 0.7326871, 'recall': 0.77849424, 'specificity': 0.77849424, 'f1': 0.7528597, 'auroc': 0.9217002, 'binary_precision': 0.49840596, 'binary_recall': 0.60751295, 'binary_specificity': 0.94947547, 'binary_f1_score': 0.5475774}
confusion matrix:
      0    1
0  8870  472
1   303  469
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 04:40:42.350220,epoch time: 0:18:34.444615,used: 1:15:10.610438,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9926761, 'precision': 0.99268365, 'recall': 0.9926748, 'specificity': 0.9926748, 'f1': 0.992676, 'auroc': 0.99968815, 'binary_precision': 0.99091876, 'binary_recall': 0.99447644, 'binary_specificity': 0.99087316, 'binary_f1_score': 0.99269444}
confusion matrix:
       0      1
0  25079    231
1    140  25206
---- Validation: 
scalar performance:
{'acc': 0.9445935, 'precision': 0.6414944, 'recall': 0.9058133, 'specificity': 0.9058133, 'f1': 0.700668, 'auroc': 0.9550886, 'binary_precision': 0.28651237, 'binary_recall': 0.86506027, 'binary_specificity': 0.9465663, 'binary_f1_score': 0.43045563}
confusion matrix:
       0    1
0  15837  894
1     56  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7904884, 'precision': 0.6271581, 'recall': 0.8616333, 'specificity': 0.8616333, 'f1': 0.64033014, 'auroc': 0.93188894, 'binary_precision': 0.26006413, 'binary_recall': 0.94559586, 'binary_specificity': 0.77767074, 'binary_f1_score': 0.40793517}
confusion matrix:
      0     1
0  7265  2077
1    42   730
early stop counter: 1
val acc:0.9445934891700745, best validation acc: 0.9774291515350342, corresponding to test acc:                         0.9233735203742981 / 0.9233735203742981
after epoch: 5,now: 2024-08-07 04:59:11.066100,epoch time: 0:18:28.715880,used: 1:33:39.326318,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9947489, 'precision': 0.99474883, 'recall': 0.99474895, 'specificity': 0.99474895, 'f1': 0.9947489, 'auroc': 0.9997935, 'binary_precision': 0.9948692, 'binary_recall': 0.9946336, 'binary_specificity': 0.9948643, 'binary_f1_score': 0.9947514}
confusion matrix:
       0      1
0  25183    130
1    136  25207
---- Validation: 
scalar performance:
{'acc': 0.95479995, 'precision': 0.6546974, 'recall': 0.85229635, 'specificity': 0.85229635, 'f1': 0.7100449, 'auroc': 0.94033986, 'binary_precision': 0.31595093, 'binary_recall': 0.7445783, 'binary_specificity': 0.96001434, 'binary_f1_score': 0.44364682}
confusion matrix:
       0    1
0  16062  669
1    106  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.817283, 'precision': 0.6354244, 'recall': 0.8535601, 'specificity': 0.8535601, 'f1': 0.6597432, 'auroc': 0.9239729, 'binary_precision': 0.2813008, 'binary_recall': 0.89637303, 'binary_specificity': 0.81074715, 'binary_f1_score': 0.42821786}
confusion matrix:
      0     1
0  7574  1768
1    80   692
early stop counter: 2
val acc:0.9547999501228333, best validation acc: 0.9774291515350342, corresponding to test acc:                         0.9233735203742981 / 0.9233735203742981
after epoch: 6,now: 2024-08-07 05:17:16.450576,epoch time: 0:18:05.384476,used: 1:51:44.710794,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9928932, 'precision': 0.9929295, 'recall': 0.99289083, 'specificity': 0.99289083, 'f1': 0.9928931, 'auroc': 0.9998346, 'binary_precision': 0.9888467, 'binary_recall': 0.9970406, 'binary_specificity': 0.988741, 'binary_f1_score': 0.99292684}
confusion matrix:
       0      1
0  25028    285
1     75  25268
---- Validation: 
scalar performance:
{'acc': 0.95742446, 'precision': 0.6692865, 'recall': 0.8947638, 'specificity': 0.8947638, 'f1': 0.7314922, 'auroc': 0.9535985, 'binary_precision': 0.3429711, 'binary_recall': 0.82891566, 'binary_specificity': 0.96061206, 'binary_f1_score': 0.48519042}
confusion matrix:
       0    1
0  16072  659
1     71  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8166897, 'precision': 0.63991845, 'recall': 0.87225163, 'specificity': 0.87225163, 'f1': 0.66449326, 'auroc': 0.9247321, 'binary_precision': 0.286166, 'binary_recall': 0.93782383, 'binary_specificity': 0.8066795, 'binary_f1_score': 0.43852213}
confusion matrix:
      0     1
0  7536  1806
1    48   724
early stop counter: 3
val acc:0.9574244618415833, best validation acc: 0.9774291515350342, corresponding to test acc:                         0.9233735203742981 / 0.9233735203742981
after epoch: 7,now: 2024-08-07 05:35:41.246971,epoch time: 0:18:24.796395,used: 2:10:09.507189,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9880172, 'precision': 0.9882672, 'recall': 0.9880226, 'specificity': 0.9880226, 'f1': 0.9880158, 'auroc': 0.9997089, 'binary_precision': 0.9994346, 'binary_recall': 0.97659826, 'binary_specificity': 0.999447, 'binary_f1_score': 0.98788446}
confusion matrix:
       0      1
0  25302     14
1    593  24747
---- Validation: 
scalar performance:
{'acc': 0.97900385, 'precision': 0.8105984, 'recall': 0.65086037, 'specificity': 0.65086037, 'f1': 0.70149565, 'auroc': 0.92919254, 'binary_precision': 0.6381909, 'binary_recall': 0.3060241, 'binary_specificity': 0.9956966, 'binary_f1_score': 0.41368076}
confusion matrix:
       0    1
0  16659   72
1    288  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9224837, 'precision': 0.7034175, 'recall': 0.5641197, 'specificity': 0.5641197, 'f1': 0.5883934, 'auroc': 0.8934797, 'binary_precision': 0.47391304, 'binary_recall': 0.1411917, 'binary_specificity': 0.98704773, 'binary_f1_score': 0.21756487}
confusion matrix:
      0    1
0  9221  121
1   663  109
better model found
persisted
after epoch: 8,now: 2024-08-07 05:54:18.934337,epoch time: 0:18:37.687366,used: 2:28:47.194555,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9939198, 'precision': 0.99395907, 'recall': 0.9939227, 'specificity': 0.9939227, 'f1': 0.9939197, 'auroc': 0.99976236, 'binary_precision': 0.99852645, 'binary_recall': 0.9893071, 'binary_specificity': 0.99853826, 'binary_f1_score': 0.9938954}
confusion matrix:
       0      1
0  25275     37
1    271  25073
---- Validation: 
scalar performance:
{'acc': 0.9693806, 'precision': 0.7131331, 'recall': 0.8985403, 'specificity': 0.8985403, 'f1': 0.7749438, 'auroc': 0.9526435, 'binary_precision': 0.4307305, 'binary_recall': 0.8240964, 'binary_specificity': 0.97298425, 'binary_f1_score': 0.56575686}
confusion matrix:
       0    1
0  16279  452
1     73  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7730868, 'precision': 0.61708343, 'recall': 0.8433013, 'specificity': 0.8433013, 'f1': 0.6224135, 'auroc': 0.9178597, 'binary_precision': 0.24212664, 'binary_recall': 0.9261658, 'binary_specificity': 0.7604367, 'binary_f1_score': 0.3838926}
confusion matrix:
      0     1
0  7104  2238
1    57   715
early stop counter: 1
val acc:0.9693806171417236, best validation acc: 0.9790038466453552, corresponding to test acc:                         0.9224836826324463 / 0.9233735203742981
after epoch: 9,now: 2024-08-07 06:12:47.199594,epoch time: 0:18:28.265257,used: 2:47:15.459812,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99283403, 'precision': 0.9928553, 'recall': 0.99283636, 'specificity': 0.99283636, 'f1': 0.992834, 'auroc': 0.999737, 'binary_precision': 0.9962654, 'binary_recall': 0.98938644, 'binary_specificity': 0.9962862, 'binary_f1_score': 0.992814}
confusion matrix:
       0      1
0  25217     94
1    269  25076
---- Validation: 
scalar performance:
{'acc': 0.97019714, 'precision': 0.6935464, 'recall': 0.72389346, 'specificity': 0.72389346, 'f1': 0.7075108, 'auroc': 0.94700146, 'binary_precision': 0.40041494, 'binary_recall': 0.46506023, 'binary_specificity': 0.9827267, 'binary_f1_score': 0.4303233}
confusion matrix:
       0    1
0  16442  289
1    222  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8759146, 'precision': 0.6750892, 'recall': 0.86093843, 'specificity': 0.86093843, 'f1': 0.71908504, 'auroc': 0.9201884, 'binary_precision': 0.3647059, 'binary_recall': 0.8432642, 'binary_specificity': 0.8786127, 'binary_f1_score': 0.50919044}
confusion matrix:
      0     1
0  8208  1134
1   121   651
early stop counter: 2
val acc:0.9701971411705017, best validation acc: 0.9790038466453552, corresponding to test acc:                         0.9224836826324463 / 0.9233735203742981
after epoch: 10,now: 2024-08-07 06:31:02.182309,epoch time: 0:18:14.982715,used: 3:05:30.442527,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99603206, 'precision': 0.9960383, 'recall': 0.9960334, 'specificity': 0.9960334, 'f1': 0.99603206, 'auroc': 0.9998673, 'binary_precision': 0.9979799, 'binary_recall': 0.9940817, 'binary_specificity': 0.99798506, 'binary_f1_score': 0.99602693}
confusion matrix:
       0      1
0  25260     51
1    150  25195
---- Validation: 
scalar performance:
{'acc': 0.9672227, 'precision': 0.69697195, 'recall': 0.84573746, 'specificity': 0.84573746, 'f1': 0.7488595, 'auroc': 0.95380795, 'binary_precision': 0.4010767, 'binary_recall': 0.7180723, 'binary_specificity': 0.9734027, 'binary_f1_score': 0.5146805}
confusion matrix:
       0    1
0  16286  445
1    117  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8754202, 'precision': 0.67537975, 'recall': 0.86423576, 'specificity': 0.86423576, 'f1': 0.71955884, 'auroc': 0.92256176, 'binary_precision': 0.3645949, 'binary_recall': 0.85103625, 'binary_specificity': 0.87743527, 'binary_f1_score': 0.5104895}
confusion matrix:
      0     1
0  8197  1145
1   115   657
early stop counter: 3
val acc:0.9672226905822754, best validation acc: 0.9790038466453552, corresponding to test acc:                         0.9224836826324463 / 0.9233735203742981
after epoch: 11,now: 2024-08-07 06:49:10.428674,epoch time: 0:18:08.246365,used: 3:23:38.688892,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99540037, 'precision': 0.9954344, 'recall': 0.9954027, 'specificity': 0.9954027, 'f1': 0.9954003, 'auroc': 0.9998997, 'binary_precision': 0.9996816, 'binary_recall': 0.9911215, 'binary_specificity': 0.999684, 'binary_f1_score': 0.99538314}
confusion matrix:
       0      1
0  25306      8
1    225  25117
---- Validation: 
scalar performance:
{'acc': 0.9714219, 'precision': 0.7142085, 'recall': 0.80676645, 'specificity': 0.80676645, 'f1': 0.75149566, 'auroc': 0.94943345, 'binary_precision': 0.43760398, 'binary_recall': 0.63373494, 'binary_specificity': 0.97979796, 'binary_f1_score': 0.5177166}
confusion matrix:
       0    1
0  16393  338
1    152  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7965197, 'precision': 0.62217903, 'recall': 0.83459663, 'specificity': 0.83459663, 'f1': 0.6375642, 'auroc': 0.9101921, 'binary_precision': 0.25680786, 'binary_recall': 0.8795337, 'binary_specificity': 0.7896596, 'binary_f1_score': 0.397541}
confusion matrix:
      0     1
0  7377  1965
1    93   679
early stop counter: 4
val acc:0.9714218974113464, best validation acc: 0.9790038466453552, corresponding to test acc:                         0.9224836826324463 / 0.9233735203742981
after epoch: 12,now: 2024-08-07 07:07:39.631682,epoch time: 0:18:29.203008,used: 3:42:07.891900,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99530166, 'precision': 0.99530184, 'recall': 0.9953015, 'specificity': 0.9953015, 'f1': 0.9953016, 'auroc': 0.99977934, 'binary_precision': 0.99510884, 'binary_recall': 0.9955015, 'binary_specificity': 0.9951015, 'binary_f1_score': 0.9953051}
confusion matrix:
       0      1
0  25190    124
1    114  25228
---- Validation: 
scalar performance:
{'acc': 0.9554415, 'precision': 0.6649956, 'recall': 0.9019723, 'specificity': 0.9019723, 'f1': 0.7277899, 'auroc': 0.9560187, 'binary_precision': 0.33396766, 'binary_recall': 0.8457831, 'binary_specificity': 0.9581615, 'binary_f1_score': 0.47885403}
confusion matrix:
       0    1
0  16031  700
1     64  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8663239, 'precision': 0.66770136, 'recall': 0.8646591, 'specificity': 0.8646591, 'f1': 0.70960546, 'auroc': 0.9120312, 'binary_precision': 0.34832636, 'binary_recall': 0.8626943, 'binary_specificity': 0.8666239, 'binary_f1_score': 0.4962742}
confusion matrix:
      0     1
0  8096  1246
1   106   666
early stop counter: 5
val acc:0.9554414749145508, best validation acc: 0.9790038466453552, corresponding to test acc:                         0.9224836826324463 / 0.9233735203742981
after epoch: 13,now: 2024-08-07 07:26:05.804572,epoch time: 0:18:26.172890,used: 4:00:34.064790,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9963282, 'precision': 0.99633574, 'recall': 0.9963293, 'specificity': 0.9963293, 'f1': 0.9963281, 'auroc': 0.99985325, 'binary_precision': 0.99841493, 'binary_recall': 0.9942388, 'binary_specificity': 0.9984198, 'binary_f1_score': 0.99632245}
confusion matrix:
       0      1
0  25274     40
1    146  25196
---- Validation: 
scalar performance:
{'acc': 0.98157007, 'precision': 0.83324283, 'recall': 0.7226714, 'specificity': 0.7226714, 'f1': 0.7663124, 'auroc': 0.95725995, 'binary_precision': 0.68, 'binary_recall': 0.4506024, 'binary_specificity': 0.9947403, 'binary_f1_score': 0.542029}
confusion matrix:
       0    1
0  16643   88
1    228  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.73313385, 'recall': 0.7744957, 'specificity': 0.7744957, 'f1': 0.75157684, 'auroc': 0.9130068, 'binary_precision': 0.5, 'binary_recall': 0.5984456, 'binary_specificity': 0.9505459, 'binary_f1_score': 0.5448113}
confusion matrix:
      0    1
0  8880  462
1   310  462
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-07 07:44:30.187734,epoch time: 0:18:24.383162,used: 4:18:58.447952,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99236023, 'precision': 0.99246967, 'recall': 0.99236596, 'specificity': 0.99236596, 'f1': 0.9923599, 'auroc': 0.9998255, 'binary_precision': 1.0, 'binary_recall': 0.9847319, 'binary_specificity': 1.0, 'binary_f1_score': 0.99230725}
confusion matrix:
       0      1
0  25309      0
1    387  24960
---- Validation: 
scalar performance:
{'acc': 0.978129, 'precision': 0.8746501, 'recall': 0.5681667, 'specificity': 0.5681667, 'f1': 0.6110175, 'auroc': 0.9493886, 'binary_precision': 0.7702703, 'binary_recall': 0.1373494, 'binary_specificity': 0.9989839, 'binary_f1_score': 0.23312883}
confusion matrix:
       0   1
0  16714  17
1    358  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234724, 'precision': 0.7122276, 'recall': 0.5480188, 'specificity': 0.5480188, 'f1': 0.5664783, 'auroc': 0.8916518, 'binary_precision': 0.49390244, 'binary_recall': 0.10492228, 'binary_specificity': 0.9911154, 'binary_f1_score': 0.17307691}
confusion matrix:
      0   1
0  9259  83
1   691  81
early stop counter: 1
val acc:0.9781290292739868, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 15,now: 2024-08-07 08:02:40.594380,epoch time: 0:18:10.406646,used: 4:37:08.854598,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99611104, 'precision': 0.9961157, 'recall': 0.99611044, 'specificity': 0.99611044, 'f1': 0.99611104, 'auroc': 0.9998943, 'binary_precision': 0.9946873, 'binary_recall': 0.9975531, 'binary_specificity': 0.9946678, 'binary_f1_score': 0.9961181}
confusion matrix:
       0      1
0  25183    135
1     62  25276
---- Validation: 
scalar performance:
{'acc': 0.978129, 'precision': 0.76460314, 'recall': 0.84662616, 'specificity': 0.84662616, 'f1': 0.7996702, 'auroc': 0.96223485, 'binary_precision': 0.53649634, 'binary_recall': 0.70843375, 'binary_specificity': 0.9848186, 'binary_f1_score': 0.61059195}
confusion matrix:
       0    1
0  16477  254
1    121  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.793949, 'precision': 0.62481344, 'recall': 0.8480587, 'specificity': 0.8480587, 'f1': 0.6393427, 'auroc': 0.9232641, 'binary_precision': 0.25882354, 'binary_recall': 0.9119171, 'binary_specificity': 0.7842004, 'binary_f1_score': 0.40320736}
confusion matrix:
      0     1
0  7326  2016
1    68   704
early stop counter: 2
val acc:0.9781290292739868, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 16,now: 2024-08-07 08:21:47.008440,epoch time: 0:19:06.414060,used: 4:56:15.268658,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9943738, 'precision': 0.9943939, 'recall': 0.9943758, 'specificity': 0.9943758, 'f1': 0.99437374, 'auroc': 0.99962604, 'binary_precision': 0.99769604, 'binary_recall': 0.9910429, 'binary_specificity': 0.9977087, 'binary_f1_score': 0.9943583}
confusion matrix:
       0      1
0  25255     58
1    227  25116
---- Validation: 
scalar performance:
{'acc': 0.9791205, 'precision': 0.7820671, 'recall': 0.75548935, 'specificity': 0.75548935, 'f1': 0.76807475, 'auroc': 0.9470308, 'binary_precision': 0.576, 'binary_recall': 0.52048194, 'binary_specificity': 0.9904967, 'binary_f1_score': 0.5468355}
confusion matrix:
       0    1
0  16572  159
1    199  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8827368, 'precision': 0.6794972, 'recall': 0.8509661, 'specificity': 0.8509661, 'f1': 0.72382545, 'auroc': 0.8998074, 'binary_precision': 0.3760479, 'binary_recall': 0.8134715, 'binary_specificity': 0.8884607, 'binary_f1_score': 0.51433253}
confusion matrix:
      0     1
0  8300  1042
1   144   628
early stop counter: 3
val acc:0.9791204929351807, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 17,now: 2024-08-07 08:41:30.319870,epoch time: 0:19:43.311430,used: 5:15:58.580088,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9930117, 'precision': 0.9930533, 'recall': 0.9930092, 'specificity': 0.9930092, 'f1': 0.9930115, 'auroc': 0.9998186, 'binary_precision': 0.9886577, 'binary_recall': 0.99747455, 'binary_specificity': 0.98854387, 'binary_f1_score': 0.9930466}
confusion matrix:
       0      1
0  25024    290
1     64  25278
---- Validation: 
scalar performance:
{'acc': 0.8495276, 'precision': 0.5650136, 'recall': 0.8911744, 'specificity': 0.8911744, 'f1': 0.5739148, 'auroc': 0.9570117, 'binary_precision': 0.13192792, 'binary_recall': 0.93493974, 'binary_specificity': 0.847409, 'binary_f1_score': 0.23122765}
confusion matrix:
       0     1
0  14178  2553
1     27   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8805616, 'precision': 0.6754171, 'recall': 0.8426589, 'specificity': 0.8426589, 'f1': 0.7185036, 'auroc': 0.91227484, 'binary_precision': 0.36930457, 'binary_recall': 0.79792744, 'binary_specificity': 0.88739026, 'binary_f1_score': 0.50491804}
confusion matrix:
      0     1
0  8290  1052
1   156   616
early stop counter: 4
val acc:0.8495275974273682, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 18,now: 2024-08-07 09:01:01.827176,epoch time: 0:19:31.507306,used: 5:35:30.087394,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9957952, 'precision': 0.9958217, 'recall': 0.9957974, 'specificity': 0.9957974, 'f1': 0.99579513, 'auroc': 0.99992305, 'binary_precision': 0.9996024, 'binary_recall': 0.9919899, 'binary_specificity': 0.99960494, 'binary_f1_score': 0.99578154}
confusion matrix:
       0      1
0  25303     10
1    203  25140
---- Validation: 
scalar performance:
{'acc': 0.9737548, 'precision': 0.71618265, 'recall': 0.6763692, 'specificity': 0.6763692, 'f1': 0.6940895, 'auroc': 0.9520177, 'binary_precision': 0.4480712, 'binary_recall': 0.36385542, 'binary_specificity': 0.9888829, 'binary_f1_score': 0.40159577}
confusion matrix:
       0    1
0  16545  186
1    264  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89746886, 'precision': 0.6954193, 'recall': 0.8452755, 'specificity': 0.8452755, 'f1': 0.7404119, 'auroc': 0.9102258, 'binary_precision': 0.41016948, 'binary_recall': 0.78367877, 'binary_specificity': 0.9068722, 'binary_f1_score': 0.5384958}
confusion matrix:
      0    1
0  8472  870
1   167  605
early stop counter: 5
val acc:0.9737548232078552, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 19,now: 2024-08-07 09:19:53.815698,epoch time: 0:18:51.988522,used: 5:54:22.075916,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9926169, 'precision': 0.9926472, 'recall': 0.9926142, 'specificity': 0.9926142, 'f1': 0.9926168, 'auroc': 0.9997854, 'binary_precision': 0.98895675, 'binary_recall': 0.99637026, 'binary_specificity': 0.98885816, 'binary_f1_score': 0.9926497}
confusion matrix:
       0      1
0  25028    282
1     92  25254
---- Validation: 
scalar performance:
{'acc': 0.96862245, 'precision': 0.6990513, 'recall': 0.8123816, 'specificity': 0.8123816, 'f1': 0.7419015, 'auroc': 0.94386345, 'binary_precision': 0.40695915, 'binary_recall': 0.64819276, 'binary_specificity': 0.9765704, 'binary_f1_score': 0.5}
confusion matrix:
       0    1
0  16339  392
1    146  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79988134, 'precision': 0.62528753, 'recall': 0.84176373, 'specificity': 0.84176373, 'f1': 0.6422151, 'auroc': 0.9122824, 'binary_precision': 0.26179606, 'binary_recall': 0.8911917, 'binary_specificity': 0.7923357, 'binary_f1_score': 0.4047059}
confusion matrix:
      0     1
0  7402  1940
1    84   688
early stop counter: 6
val acc:0.9686224460601807, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 20,now: 2024-08-07 09:38:53.070352,epoch time: 0:18:59.254654,used: 6:13:21.330570,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_03_25_31_seed_0_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:13:21.330570 at 2024-08-07 09:38:53.070352
persisted model performance metric: 

scalar performance:
{'acc': 0.9236702, 'precision': 0.73313385, 'recall': 0.7744957, 'specificity': 0.7744957, 'f1': 0.75157684, 'auroc': 0.9130068, 'binary_precision': 0.5, 'binary_recall': 0.5984456, 'binary_specificity': 0.9505459, 'binary_f1_score': 0.5448113}
confusion matrix:
      0    1
0  8880  462
1   310  462
oracle model performance metric: 

scalar performance:
{'acc': 0.9236702, 'precision': 0.73313385, 'recall': 0.7744957, 'specificity': 0.7744957, 'f1': 0.75157684, 'auroc': 0.9130068, 'binary_precision': 0.5, 'binary_recall': 0.5984456, 'binary_specificity': 0.9505459, 'binary_f1_score': 0.5448113}
confusion matrix:
      0    1
0  8880  462
1   310  462
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459204 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555060 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 459204 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool | 416794 KiB |  13181 MiB | 555060 GiB | 555059 GiB |
|       from small pool |  42410 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447934 KiB |  13213 MiB | 562427 GiB | 562426 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |  40859 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14412 MiB |  14412 MiB |  14412 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 415291 KiB |   1235 MiB | 450794 GiB | 450794 GiB |
|       from large pool | 406502 KiB |   1232 MiB | 442916 GiB | 442915 GiB |
|       from small pool |   8789 KiB |     17 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4934    |    7337    |  107646 K  |  107642 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56146 K  |   56142 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4934    |    7337    |  107646 K  |  107642 K  |
|       from large pool |     187    |    1413    |   51500 K  |   51499 K  |
|       from small pool |    4747    |    7148    |   56146 K  |   56142 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3222    |   64567 K  |   64567 K  |
|       from large pool |      30    |     604    |   37573 K  |   37573 K  |
|       from small pool |      40    |    3191    |   26993 K  |   26993 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562427 GiB | 562427 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450795 GiB | 450794 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     40 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64569 K  |   64569 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   26995 K  |   26995 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB | 562909 GiB | 562909 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 555060 GiB | 555060 GiB |
|       from small pool |      0 KiB |     61 MiB |   7849 GiB |   7849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 562427 GiB | 562427 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 554594 GiB | 554594 GiB |
|       from small pool |      0 KiB |     60 MiB |   7832 GiB |   7832 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14484 MiB |  14484 MiB |  13630 MiB |
|       from large pool |    804 MiB |  14412 MiB |  14412 MiB |  13608 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB | 450795 GiB | 450794 GiB |
|       from large pool |  24320 KiB |   1232 MiB | 442916 GiB | 442916 GiB |
|       from small pool |      0 KiB |     40 MiB |   7878 GiB |   7878 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7337    |  107646 K  |  107646 K  |
|       from large pool |       2    |    1413    |   51500 K  |   51500 K  |
|       from small pool |       0    |    7148    |   56146 K  |   56146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     638    |     638    |     577    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3222    |   64569 K  |   64569 K  |
|       from large pool |       3    |     604    |   37573 K  |   37573 K  |
|       from small pool |       0    |    3191    |   26995 K  |   26995 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373

 Experiment start at: 2024-08-07 10:02:32.007101
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9863472, 'precision': 0.9863591, 'recall': 0.9863493, 'specificity': 0.9863493, 'f1': 0.98634714, 'auroc': 0.9987767, 'binary_precision': 0.9889723, 'binary_recall': 0.98368454, 'binary_specificity': 0.989014, 'binary_f1_score': 0.9863214}
confusion matrix:
       0      1
0  25117    279
1    415  25021
---- Validation: 
scalar performance:
{'acc': 0.84786546, 'precision': 0.5650436, 'recall': 0.8790233, 'specificity': 0.8790233, 'f1': 0.5736815, 'auroc': 0.9404061, 'binary_precision': 0.13277027, 'binary_recall': 0.9118329, 'binary_specificity': 0.84621376, 'binary_f1_score': 0.23179002}
confusion matrix:
       0     1
0  14125  2567
1     38   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9008027, 'precision': 0.7033636, 'recall': 0.87658143, 'specificity': 0.87658143, 'f1': 0.7529972, 'auroc': 0.92512333, 'binary_precision': 0.42015707, 'binary_recall': 0.84808457, 'binary_specificity': 0.90507823, 'binary_f1_score': 0.5619256}
confusion matrix:
      0    1
0  8448  886
1   115  642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 10:22:31.882419,epoch time: 0:19:59.875318,used: 0:19:59.875318,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98916036, 'precision': 0.989172, 'recall': 0.9891627, 'specificity': 0.9891627, 'f1': 0.98916036, 'auroc': 0.99902236, 'binary_precision': 0.9917796, 'binary_recall': 0.98651624, 'binary_specificity': 0.99180907, 'binary_f1_score': 0.989141}
confusion matrix:
       0      1
0  25186    208
1    343  25095
---- Validation: 
scalar performance:
{'acc': 0.9224435, 'precision': 0.60943395, 'recall': 0.8822409, 'specificity': 0.8822409, 'f1': 0.6557883, 'auroc': 0.93902755, 'binary_precision': 0.22331893, 'binary_recall': 0.83990717, 'binary_specificity': 0.9245747, 'binary_f1_score': 0.3528265}
confusion matrix:
       0     1
0  15433  1259
1     69   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9179467, 'precision': 0.7267506, 'recall': 0.85732263, 'specificity': 0.85732263, 'f1': 0.772054, 'auroc': 0.9316034, 'binary_precision': 0.47184774, 'binary_recall': 0.78599733, 'binary_specificity': 0.92864794, 'binary_f1_score': 0.5896928}
confusion matrix:
      0    1
0  8668  666
1   162  595
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 10:41:16.213554,epoch time: 0:18:44.331135,used: 0:38:44.206453,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98977023, 'precision': 0.9898008, 'recall': 0.98977387, 'specificity': 0.98977387, 'f1': 0.9897702, 'auroc': 0.999177, 'binary_precision': 0.9938952, 'binary_recall': 0.9856121, 'binary_specificity': 0.9939356, 'binary_f1_score': 0.9897364}
confusion matrix:
       0      1
0  25240    154
1    366  25072
---- Validation: 
scalar performance:
{'acc': 0.96116334, 'precision': 0.6801982, 'recall': 0.8580253, 'specificity': 0.8580253, 'f1': 0.73628116, 'auroc': 0.94928795, 'binary_precision': 0.36704546, 'binary_recall': 0.7494199, 'binary_specificity': 0.9666307, 'binary_f1_score': 0.49275362}
confusion matrix:
       0    1
0  16135  557
1    108  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9187395, 'precision': 0.7272173, 'recall': 0.84925413, 'specificity': 0.84925413, 'f1': 0.7706108, 'auroc': 0.93098205, 'binary_precision': 0.47428572, 'binary_recall': 0.7675033, 'binary_specificity': 0.93100494, 'binary_f1_score': 0.5862765}
confusion matrix:
      0    1
0  8690  644
1   176  581
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 10:59:44.309298,epoch time: 0:18:28.095744,used: 0:57:12.302197,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99266213, 'precision': 0.9926645, 'recall': 0.99266136, 'specificity': 0.99266136, 'f1': 0.9926621, 'auroc': 0.9996315, 'binary_precision': 0.99175924, 'binary_recall': 0.9935918, 'binary_specificity': 0.991731, 'binary_f1_score': 0.99267465}
confusion matrix:
       0      1
0  25186    210
1    163  25273
---- Validation: 
scalar performance:
{'acc': 0.9281668, 'precision': 0.6208216, 'recall': 0.9089094, 'specificity': 0.9089094, 'f1': 0.672814, 'auroc': 0.9526632, 'binary_precision': 0.24472843, 'binary_recall': 0.8886311, 'binary_specificity': 0.92918766, 'binary_f1_score': 0.38376755}
confusion matrix:
       0     1
0  15510  1182
1     48   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9109107, 'precision': 0.7198278, 'recall': 0.8911493, 'specificity': 0.8911493, 'f1': 0.7718668, 'auroc': 0.9380144, 'binary_precision': 0.45123628, 'binary_recall': 0.8678996, 'binary_specificity': 0.91439897, 'binary_f1_score': 0.5937641}
confusion matrix:
      0    1
0  8535  799
1   100  657
early stop counter: 1
val acc:0.9281668066978455, best validation acc: 0.961163341999054, corresponding to test acc:                         0.9187394976615906 / 0.9187394976615906
after epoch: 4,now: 2024-08-07 11:18:17.562150,epoch time: 0:18:33.252852,used: 1:15:45.555049,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98969156, 'precision': 0.98987406, 'recall': 0.9896989, 'specificity': 0.9896989, 'f1': 0.9896907, 'auroc': 0.99952537, 'binary_precision': 0.99951875, 'binary_recall': 0.97987026, 'binary_specificity': 0.9995275, 'binary_f1_score': 0.989597}
confusion matrix:
       0      1
0  25385     12
1    512  24923
---- Validation: 
scalar performance:
{'acc': 0.97979325, 'precision': 0.8187735, 'recall': 0.70823133, 'specificity': 0.70823133, 'f1': 0.7511794, 'auroc': 0.93343556, 'binary_precision': 0.65232974, 'binary_recall': 0.42227378, 'binary_specificity': 0.99418885, 'binary_f1_score': 0.51267606}
confusion matrix:
       0    1
0  16595   97
1    249  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9260727, 'precision': 0.7389874, 'recall': 0.80830497, 'specificity': 0.80830497, 'f1': 0.76782066, 'auroc': 0.91955805, 'binary_precision': 0.50548357, 'binary_recall': 0.669749, 'binary_specificity': 0.9468609, 'binary_f1_score': 0.57613635}
confusion matrix:
      0    1
0  8838  496
1   250  507
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 11:37:13.154215,epoch time: 0:18:55.592065,used: 1:34:41.147114,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9945507, 'precision': 0.9945854, 'recall': 0.99455416, 'specificity': 0.99455416, 'f1': 0.99455065, 'auroc': 0.99978894, 'binary_precision': 0.99892914, 'binary_recall': 0.99017143, 'binary_specificity': 0.99893683, 'binary_f1_score': 0.99453104}
confusion matrix:
       0      1
0  25369     27
1    250  25186
---- Validation: 
scalar performance:
{'acc': 0.9733692, 'precision': 0.7337291, 'recall': 0.79873776, 'specificity': 0.79873776, 'f1': 0.7619076, 'auroc': 0.9483035, 'binary_precision': 0.4774775, 'binary_recall': 0.6148492, 'binary_specificity': 0.9826264, 'binary_f1_score': 0.5375254}
confusion matrix:
       0    1
0  16402  290
1    166  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9295412, 'precision': 0.74673724, 'recall': 0.771943, 'specificity': 0.771943, 'f1': 0.75854313, 'auroc': 0.92431045, 'binary_precision': 0.5273159, 'binary_recall': 0.58652574, 'binary_specificity': 0.9573602, 'binary_f1_score': 0.5553471}
confusion matrix:
      0    1
0  8936  398
1   313  444
new oracle model saved
early stop counter: 1
val acc:0.9733691811561584, best validation acc: 0.9797932505607605, corresponding to test acc:                         0.9260727167129517 / 0.9295411705970764
after epoch: 6,now: 2024-08-07 11:58:07.931206,epoch time: 0:20:54.776991,used: 1:55:35.924105,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99441296, 'precision': 0.9944271, 'recall': 0.9944152, 'specificity': 0.9944152, 'f1': 0.9944129, 'auroc': 0.9998081, 'binary_precision': 0.99727166, 'binary_recall': 0.9915474, 'binary_specificity': 0.99728304, 'binary_f1_score': 0.9944013}
confusion matrix:
       0      1
0  25327     69
1    215  25221
---- Validation: 
scalar performance:
{'acc': 0.9759388, 'precision': 0.7545413, 'recall': 0.899508, 'specificity': 0.899508, 'f1': 0.80952406, 'auroc': 0.96317935, 'binary_precision': 0.5138282, 'binary_recall': 0.8190255, 'binary_specificity': 0.9799904, 'binary_f1_score': 0.63148475}
confusion matrix:
       0    1
0  16358  334
1     78  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91913587, 'precision': 0.72309136, 'recall': 0.81001765, 'specificity': 0.81001765, 'f1': 0.756967, 'auroc': 0.9335259, 'binary_precision': 0.4729606, 'binary_recall': 0.68163806, 'binary_specificity': 0.9383972, 'binary_f1_score': 0.5584415}
confusion matrix:
      0    1
0  8759  575
1   241  516
early stop counter: 2
val acc:0.9759387969970703, best validation acc: 0.9797932505607605, corresponding to test acc:                         0.9260727167129517 / 0.9295411705970764
after epoch: 7,now: 2024-08-07 12:16:32.783967,epoch time: 0:18:24.852761,used: 2:14:00.776866,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9934884, 'precision': 0.9935585, 'recall': 0.9934932, 'specificity': 0.9934932, 'f1': 0.9934881, 'auroc': 0.9998082, 'binary_precision': 0.9996418, 'binary_recall': 0.98734075, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.99345315}
confusion matrix:
       0      1
0  25387      9
1    322  25114
---- Validation: 
scalar performance:
{'acc': 0.9693395, 'precision': 0.7159726, 'recall': 0.8723902, 'specificity': 0.8723902, 'f1': 0.7712854, 'auroc': 0.9591001, 'binary_precision': 0.43799472, 'binary_recall': 0.77030164, 'binary_specificity': 0.9744788, 'binary_f1_score': 0.5584525}
confusion matrix:
       0    1
0  16266  426
1     99  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92567635, 'precision': 0.7355035, 'recall': 0.77653015, 'specificity': 0.77653015, 'f1': 0.7538502, 'auroc': 0.9276605, 'binary_precision': 0.503876, 'binary_recall': 0.6010568, 'binary_specificity': 0.9520034, 'binary_f1_score': 0.5481928}
confusion matrix:
      0    1
0  8886  448
1   302  455
early stop counter: 3
val acc:0.9693394899368286, best validation acc: 0.9797932505607605, corresponding to test acc:                         0.9260727167129517 / 0.9295411705970764
after epoch: 8,now: 2024-08-07 12:35:17.540392,epoch time: 0:18:44.756425,used: 2:32:45.533291,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9899079, 'precision': 0.989908, 'recall': 0.9899079, 'specificity': 0.9899079, 'f1': 0.989908, 'auroc': 0.9990593, 'binary_precision': 0.9898958, 'binary_recall': 0.98993474, 'binary_specificity': 0.9898811, 'binary_f1_score': 0.9899153}
confusion matrix:
       0      1
0  25141    257
1    256  25178
---- Validation: 
scalar performance:
{'acc': 0.97266835, 'precision': 0.7226516, 'recall': 0.7317002, 'specificity': 0.7317002, 'f1': 0.7270778, 'auroc': 0.9419349, 'binary_precision': 0.45879734, 'binary_recall': 0.47795823, 'binary_specificity': 0.9854421, 'binary_f1_score': 0.46818185}
confusion matrix:
       0    1
0  16449  243
1    225  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71033597, 'precision': 0.5929785, 'recall': 0.805792, 'specificity': 0.805792, 'f1': 0.56904286, 'auroc': 0.9087576, 'binary_precision': 0.19544432, 'binary_recall': 0.91809773, 'binary_specificity': 0.69348615, 'binary_f1_score': 0.32228145}
confusion matrix:
      0     1
0  6473  2861
1    62   695
early stop counter: 4
val acc:0.9726683497428894, best validation acc: 0.9797932505607605, corresponding to test acc:                         0.9260727167129517 / 0.9295411705970764
after epoch: 9,now: 2024-08-07 12:54:11.258822,epoch time: 0:18:53.718430,used: 2:51:39.251721,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9918555, 'precision': 0.99186915, 'recall': 0.99185777, 'specificity': 0.99185777, 'f1': 0.9918555, 'auroc': 0.9994235, 'binary_precision': 0.99466234, 'binary_recall': 0.9890313, 'binary_specificity': 0.9946842, 'binary_f1_score': 0.9918389}
confusion matrix:
       0      1
0  25261    135
1    279  25157
---- Validation: 
scalar performance:
{'acc': 0.97693163, 'precision': 0.7616856, 'recall': 0.85481167, 'specificity': 0.85481167, 'f1': 0.8006179, 'auroc': 0.9553647, 'binary_precision': 0.53050846, 'binary_recall': 0.7262181, 'binary_specificity': 0.98340523, 'binary_f1_score': 0.61312443}
confusion matrix:
       0    1
0  16415  277
1    118  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91626203, 'precision': 0.7216184, 'recall': 0.8418456, 'specificity': 0.8418456, 'f1': 0.7641473, 'auroc': 0.9183635, 'binary_precision': 0.46422765, 'binary_recall': 0.75429326, 'binary_specificity': 0.9293979, 'binary_f1_score': 0.5747358}
confusion matrix:
      0    1
0  8675  659
1   186  571
early stop counter: 5
val acc:0.976931631565094, best validation acc: 0.9797932505607605, corresponding to test acc:                         0.9260727167129517 / 0.9295411705970764
after epoch: 10,now: 2024-08-07 13:13:14.656956,epoch time: 0:19:03.398134,used: 3:10:42.649855,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9905965, 'precision': 0.99060434, 'recall': 0.990595, 'specificity': 0.990595, 'f1': 0.9905964, 'auroc': 0.99944896, 'binary_precision': 0.9888362, 'binary_recall': 0.9924126, 'binary_specificity': 0.98877734, 'binary_f1_score': 0.9906212}
confusion matrix:
       0      1
0  25110    285
1    193  25244
---- Validation: 
scalar performance:
{'acc': 0.93260527, 'precision': 0.62410283, 'recall': 0.8942338, 'specificity': 0.8942338, 'f1': 0.6768761, 'auroc': 0.9424709, 'binary_precision': 0.25222754, 'binary_recall': 0.8538283, 'binary_specificity': 0.93463933, 'binary_f1_score': 0.38941798}
confusion matrix:
       0     1
0  15601  1091
1     63   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86651474, 'precision': 0.6599288, 'recall': 0.839839, 'specificity': 0.839839, 'f1': 0.69979656, 'auroc': 0.89924896, 'binary_precision': 0.33737597, 'binary_recall': 0.80845445, 'binary_specificity': 0.8712235, 'binary_f1_score': 0.47607934}
confusion matrix:
      0     1
0  8132  1202
1   145   612
early stop counter: 6
val acc:0.9326052665710449, best validation acc: 0.9797932505607605, corresponding to test acc:                         0.9260727167129517 / 0.9295411705970764
after epoch: 11,now: 2024-08-07 13:31:41.569252,epoch time: 0:18:26.912296,used: 3:29:09.562151,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9946294, 'precision': 0.9946772, 'recall': 0.99463296, 'specificity': 0.99463296, 'f1': 0.99462926, 'auroc': 0.9997909, 'binary_precision': 0.99972194, 'binary_recall': 0.98954153, 'binary_specificity': 0.9997244, 'binary_f1_score': 0.99460566}
confusion matrix:
       0      1
0  25391      7
1    266  25168
---- Validation: 
scalar performance:
{'acc': 0.98002684, 'precision': 0.79588115, 'recall': 0.7998923, 'specificity': 0.7998923, 'f1': 0.7978723, 'auroc': 0.9637915, 'binary_precision': 0.60183066, 'binary_recall': 0.6102088, 'binary_specificity': 0.98957586, 'binary_f1_score': 0.60599077}
confusion matrix:
       0    1
0  16518  174
1    168  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.917253, 'precision': 0.68878675, 'recall': 0.64452064, 'specificity': 0.64452064, 'f1': 0.6627654, 'auroc': 0.9131264, 'binary_precision': 0.43133804, 'binary_recall': 0.32364598, 'binary_specificity': 0.96539533, 'binary_f1_score': 0.36981136}
confusion matrix:
      0    1
0  9011  323
1   512  245
better model found
persisted
after epoch: 12,now: 2024-08-07 13:51:14.856583,epoch time: 0:19:33.287331,used: 3:48:42.849482,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9946294, 'precision': 0.9946313, 'recall': 0.9946287, 'specificity': 0.9946287, 'f1': 0.9946294, 'auroc': 0.9996656, 'binary_precision': 0.9938376, 'binary_recall': 0.9954395, 'binary_specificity': 0.9938179, 'binary_f1_score': 0.9946379}
confusion matrix:
       0      1
0  25239    157
1    116  25320
---- Validation: 
scalar performance:
{'acc': 0.96320736, 'precision': 0.6932268, 'recall': 0.8974985, 'specificity': 0.8974985, 'f1': 0.7560512, 'auroc': 0.9603055, 'binary_precision': 0.39101863, 'binary_recall': 0.82830626, 'binary_specificity': 0.96669066, 'binary_f1_score': 0.53125006}
confusion matrix:
       0    1
0  16136  556
1     74  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89951444, 'precision': 0.69692683, 'recall': 0.85100067, 'specificity': 0.85100067, 'f1': 0.7429894, 'auroc': 0.9179615, 'binary_precision': 0.41192597, 'binary_recall': 0.7939234, 'binary_specificity': 0.908078, 'binary_f1_score': 0.5424187}
confusion matrix:
      0    1
0  8476  858
1   156  601
early stop counter: 1
val acc:0.9632073640823364, best validation acc: 0.9800268411636353, corresponding to test acc:                         0.9172530174255371 / 0.9295411705970764
after epoch: 13,now: 2024-08-07 14:10:16.829581,epoch time: 0:19:01.972998,used: 4:07:44.822480,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9940195, 'precision': 0.9940351, 'recall': 0.99402213, 'specificity': 0.99402213, 'f1': 0.9940195, 'auroc': 0.9997653, 'binary_precision': 0.9970337, 'binary_recall': 0.99099773, 'binary_specificity': 0.99704653, 'binary_f1_score': 0.9940066}
confusion matrix:
       0      1
0  25319     75
1    229  25209
---- Validation: 
scalar performance:
{'acc': 0.95976174, 'precision': 0.673598, 'recall': 0.8471352, 'specificity': 0.8471352, 'f1': 0.72795874, 'auroc': 0.9407076, 'binary_precision': 0.3544018, 'binary_recall': 0.7285383, 'binary_specificity': 0.9657321, 'binary_f1_score': 0.4768413}
confusion matrix:
       0    1
0  16120  572
1    117  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8570013, 'precision': 0.6540743, 'recall': 0.8456213, 'specificity': 0.8456213, 'f1': 0.6917963, 'auroc': 0.901922, 'binary_precision': 0.32374102, 'binary_recall': 0.8322325, 'binary_specificity': 0.8590101, 'binary_f1_score': 0.46614873}
confusion matrix:
      0     1
0  8018  1316
1   127   630
early stop counter: 2
val acc:0.9597617387771606, best validation acc: 0.9800268411636353, corresponding to test acc:                         0.9172530174255371 / 0.9295411705970764
after epoch: 14,now: 2024-08-07 14:29:15.673080,epoch time: 0:18:58.843499,used: 4:26:43.665979,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9941572, 'precision': 0.99421465, 'recall': 0.9941611, 'specificity': 0.9941611, 'f1': 0.9941571, 'auroc': 0.99985695, 'binary_precision': 0.9997217, 'binary_recall': 0.9885979, 'binary_specificity': 0.9997244, 'binary_f1_score': 0.9941287}
confusion matrix:
       0      1
0  25391      7
1    290  25144
---- Validation: 
scalar performance:
{'acc': 0.9826549, 'precision': 0.8433037, 'recall': 0.77072656, 'specificity': 0.77072656, 'f1': 0.8024562, 'auroc': 0.9617369, 'binary_precision': 0.69822484, 'binary_recall': 0.5475638, 'binary_specificity': 0.9938893, 'binary_f1_score': 0.61378413}
confusion matrix:
       0    1
0  16590  102
1    195  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91834307, 'precision': 0.72135806, 'recall': 0.80958915, 'specificity': 0.80958915, 'f1': 0.7555355, 'auroc': 0.92747927, 'binary_precision': 0.46951774, 'binary_recall': 0.68163806, 'binary_specificity': 0.9375402, 'binary_f1_score': 0.55603445}
confusion matrix:
      0    1
0  8751  583
1   241  516
better model found
persisted
after epoch: 15,now: 2024-08-07 14:48:27.784931,epoch time: 0:19:12.111851,used: 4:45:55.777830,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9975212, 'precision': 0.99752396, 'recall': 0.99752235, 'specificity': 0.99752235, 'f1': 0.9975213, 'auroc': 0.9998952, 'binary_precision': 0.9988962, 'binary_recall': 0.9961472, 'binary_specificity': 0.9988975, 'binary_f1_score': 0.9975198}
confusion matrix:
       0      1
0  25368     28
1     98  25338
---- Validation: 
scalar performance:
{'acc': 0.98066926, 'precision': 0.7912102, 'recall': 0.87933147, 'specificity': 0.87933147, 'f1': 0.82902443, 'auroc': 0.9692266, 'binary_precision': 0.5883392, 'binary_recall': 0.7726218, 'binary_specificity': 0.9860412, 'binary_f1_score': 0.66800404}
confusion matrix:
       0    1
0  16459  233
1     98  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9108116, 'precision': 0.69781345, 'recall': 0.76060486, 'specificity': 0.76060486, 'f1': 0.72329867, 'auroc': 0.898191, 'binary_precision': 0.43037975, 'binary_recall': 0.58388376, 'binary_specificity': 0.9373259, 'binary_f1_score': 0.4955157}
confusion matrix:
      0    1
0  8749  585
1   315  442
early stop counter: 1
val acc:0.9806692600250244, best validation acc: 0.9826549291610718, corresponding to test acc:                         0.9183430671691895 / 0.9295411705970764
after epoch: 16,now: 2024-08-07 15:07:25.125618,epoch time: 0:18:57.340687,used: 5:04:53.118517,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99549496, 'precision': 0.99552166, 'recall': 0.9954922, 'specificity': 0.9954922, 'f1': 0.99549484, 'auroc': 0.99994874, 'binary_precision': 0.9920743, 'binary_recall': 0.99897784, 'binary_specificity': 0.9920066, 'binary_f1_score': 0.9955141}
confusion matrix:
       0      1
0  25193    203
1     26  25410
---- Validation: 
scalar performance:
{'acc': 0.9507096, 'precision': 0.656458, 'recall': 0.89334846, 'specificity': 0.89334846, 'f1': 0.71692204, 'auroc': 0.9544039, 'binary_precision': 0.31741822, 'binary_recall': 0.83294666, 'binary_specificity': 0.9537503, 'binary_f1_score': 0.4596671}
confusion matrix:
       0    1
0  15920  772
1     72  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8404519, 'precision': 0.6484517, 'recall': 0.86580837, 'specificity': 0.86580837, 'f1': 0.68183184, 'auroc': 0.913939, 'binary_precision': 0.30692622, 'binary_recall': 0.8956407, 'binary_specificity': 0.835976, 'binary_f1_score': 0.45718142}
confusion matrix:
      0     1
0  7803  1531
1    79   678
early stop counter: 2
val acc:0.9507095813751221, best validation acc: 0.9826549291610718, corresponding to test acc:                         0.9183430671691895 / 0.9295411705970764
after epoch: 17,now: 2024-08-07 15:28:00.325565,epoch time: 0:20:35.199947,used: 5:25:28.318464,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99714744, 'precision': 0.99715424, 'recall': 0.99714917, 'specificity': 0.99714917, 'f1': 0.99714744, 'auroc': 0.99994063, 'binary_precision': 0.9992105, 'binary_recall': 0.9950859, 'binary_specificity': 0.99921244, 'binary_f1_score': 0.9971439}
confusion matrix:
       0      1
0  25375     20
1    125  25312
---- Validation: 
scalar performance:
{'acc': 0.97932607, 'precision': 0.78366613, 'recall': 0.833437, 'specificity': 0.833437, 'f1': 0.8063878, 'auroc': 0.956563, 'binary_precision': 0.57563853, 'binary_recall': 0.6798144, 'binary_specificity': 0.98705965, 'binary_f1_score': 0.62340426}
confusion matrix:
       0    1
0  16476  216
1    138  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91299176, 'precision': 0.61684257, 'recall': 0.5493563, 'specificity': 0.5493563, 'f1': 0.5636687, 'auroc': 0.8936603, 'binary_precision': 0.30163935, 'binary_recall': 0.121532366, 'binary_specificity': 0.9771802, 'binary_f1_score': 0.173258}
confusion matrix:
      0    1
0  9121  213
1   665   92
early stop counter: 3
val acc:0.979326069355011, best validation acc: 0.9826549291610718, corresponding to test acc:                         0.9183430671691895 / 0.9295411705970764
after epoch: 18,now: 2024-08-07 15:46:58.957427,epoch time: 0:18:58.631862,used: 5:44:26.950326,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99441296, 'precision': 0.99446833, 'recall': 0.99441683, 'specificity': 0.99441683, 'f1': 0.99441284, 'auroc': 0.99980605, 'binary_precision': 0.99988073, 'binary_recall': 0.9889518, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99438626}
confusion matrix:
       0      1
0  25395      3
1    281  25153
---- Validation: 
scalar performance:
{'acc': 0.9755884, 'precision': 0.75439936, 'recall': 0.6450471, 'specificity': 0.6450471, 'f1': 0.68368554, 'auroc': 0.9242455, 'binary_precision': 0.52674896, 'binary_recall': 0.29698375, 'binary_specificity': 0.9931105, 'binary_f1_score': 0.37982193}
confusion matrix:
       0    1
0  16577  115
1    303  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91348726, 'precision': 0.71421003, 'recall': 0.8257793, 'specificity': 0.8257793, 'f1': 0.75412476, 'auroc': 0.9141129, 'binary_precision': 0.45206612, 'binary_recall': 0.7225892, 'binary_specificity': 0.9289694, 'binary_f1_score': 0.55617696}
confusion matrix:
      0    1
0  8671  663
1   210  547
early stop counter: 4
val acc:0.9755883812904358, best validation acc: 0.9826549291610718, corresponding to test acc:                         0.9183430671691895 / 0.9295411705970764
after epoch: 19,now: 2024-08-07 16:06:57.300182,epoch time: 0:19:58.342755,used: 6:04:25.293081,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9976983, 'precision': 0.99770224, 'recall': 0.99769944, 'specificity': 0.99769944, 'f1': 0.9976983, 'auroc': 0.9999653, 'binary_precision': 0.99929005, 'binary_recall': 0.9961076, 'binary_specificity': 0.9992913, 'binary_f1_score': 0.9976963}
confusion matrix:
       0      1
0  25380     18
1     99  25335
---- Validation: 
scalar performance:
{'acc': 0.98090285, 'precision': 0.7921376, 'recall': 0.88962257, 'specificity': 0.88962257, 'f1': 0.8333594, 'auroc': 0.961387, 'binary_precision': 0.58965516, 'binary_recall': 0.79350346, 'binary_specificity': 0.9857417, 'binary_f1_score': 0.67655784}
confusion matrix:
       0    1
0  16454  238
1     89  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8978298, 'precision': 0.7017633, 'recall': 0.8883269, 'specificity': 0.8883269, 'f1': 0.7525519, 'auroc': 0.9260744, 'binary_precision': 0.4144819, 'binary_recall': 0.8771466, 'binary_specificity': 0.89950716, 'binary_f1_score': 0.56295043}
confusion matrix:
      0    1
0  8396  938
1    93  664
early stop counter: 5
val acc:0.9809028506278992, best validation acc: 0.9826549291610718, corresponding to test acc:                         0.9183430671691895 / 0.9295411705970764
after epoch: 20,now: 2024-08-07 16:27:13.069542,epoch time: 0:20:15.769360,used: 6:24:41.062441,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_10_02_31_seed_1_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:24:41.062441 at 2024-08-07 16:27:13.069542
persisted model performance metric: 

scalar performance:
{'acc': 0.91834307, 'precision': 0.72135806, 'recall': 0.80958915, 'specificity': 0.80958915, 'f1': 0.7555355, 'auroc': 0.92747927, 'binary_precision': 0.46951774, 'binary_recall': 0.68163806, 'binary_specificity': 0.9375402, 'binary_f1_score': 0.55603445}
confusion matrix:
      0    1
0  8751  583
1   241  516
oracle model performance metric: 

scalar performance:
{'acc': 0.9295412, 'precision': 0.74673724, 'recall': 0.771943, 'specificity': 0.771943, 'f1': 0.75854313, 'auroc': 0.92431045, 'binary_precision': 0.5273159, 'binary_recall': 0.58652574, 'binary_specificity': 0.9573602, 'binary_f1_score': 0.5553471}
confusion matrix:
      0    1
0  8936  398
1   313  444
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |  42404 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |  40858 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  28102 MiB |  13630 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  28014 MiB |  13608 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool | 455249 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |  10843 KiB |     40 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7359    |  216546 K  |  216541 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112785 K  |  112780 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7359    |  216546 K  |  216541 K  |
|       from large pool |     187    |    1413    |  103760 K  |  103760 K  |
|       from small pool |    4735    |    7170    |  112785 K  |  112780 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1212    |     577    |
|       from large pool |     602    |     602    |    1168    |     566    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    3239    |  127872 K  |  127872 K  |
|       from large pool |      36    |     605    |   73199 K  |   73199 K  |
|       from small pool |      42    |    3203    |   54673 K  |   54673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     46 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3239    |  127874 K  |  127874 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3203    |   54675 K  |   54675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1107 TiB |   1107 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1092 TiB |   1092 TiB |
|       from small pool |      0 KiB |     61 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1106 TiB |   1106 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1091 TiB |   1091 TiB |
|       from small pool |      0 KiB |     60 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  28102 MiB |  27200 MiB |
|       from large pool |    850 MiB |  14412 MiB |  28014 MiB |  27164 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |    862 TiB |    862 TiB |
|       from large pool |  24320 KiB |   1232 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     46 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7359    |  216546 K  |  216545 K  |
|       from large pool |       2    |    1413    |  103760 K  |  103760 K  |
|       from small pool |       0    |    7170    |  112785 K  |  112785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1212    |    1148    |
|       from large pool |      38    |     602    |    1168    |    1130    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3239    |  127874 K  |  127874 K  |
|       from large pool |       3    |     605    |   73199 K  |   73199 K  |
|       from small pool |       0    |    3203    |   54675 K  |   54675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373

 Experiment start at: 2024-08-07 16:51:05.990469
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9785477, 'precision': 0.97926724, 'recall': 0.9785499, 'specificity': 0.9785499, 'f1': 0.9785397, 'auroc': 0.9984318, 'binary_precision': 0.99786705, 'binary_recall': 0.9591505, 'binary_specificity': 0.9979493, 'binary_f1_score': 0.9781258}
confusion matrix:
       0      1
0  25792     53
1   1056  24795
---- Validation: 
scalar performance:
{'acc': 0.9761738, 'precision': 0.75157154, 'recall': 0.6495784, 'specificity': 0.6495784, 'f1': 0.68669677, 'auroc': 0.9199375, 'binary_precision': 0.5203252, 'binary_recall': 0.30622008, 'binary_specificity': 0.9929367, 'binary_f1_score': 0.38554215}
confusion matrix:
       0    1
0  16588  118
1    290  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92459375, 'precision': 0.7985548, 'recall': 0.5426593, 'specificity': 0.5426593, 'f1': 0.55889237, 'auroc': 0.9075356, 'binary_precision': 0.6698113, 'binary_recall': 0.08908407, 'binary_specificity': 0.99623454, 'binary_f1_score': 0.1572536}
confusion matrix:
      0   1
0  9260  35
1   726  71
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 17:11:05.284944,epoch time: 0:19:59.294475,used: 0:19:59.294475,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9908697, 'precision': 0.99091166, 'recall': 0.9908686, 'specificity': 0.9908686, 'f1': 0.9908695, 'auroc': 0.99952924, 'binary_precision': 0.9864316, 'binary_recall': 0.9954359, 'binary_specificity': 0.98630136, 'binary_f1_score': 0.9909133}
confusion matrix:
       0      1
0  25488    354
1    118  25736
---- Validation: 
scalar performance:
{'acc': 0.94761735, 'precision': 0.6378963, 'recall': 0.84836537, 'specificity': 0.84836537, 'f1': 0.6910365, 'auroc': 0.94016266, 'binary_precision': 0.2824705, 'binary_recall': 0.74401915, 'binary_specificity': 0.9527116, 'binary_f1_score': 0.40947995}
confusion matrix:
       0    1
0  15916  790
1    107  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91785574, 'precision': 0.6931339, 'recall': 0.58545977, 'specificity': 0.58545977, 'f1': 0.6123997, 'auroc': 0.8788192, 'binary_precision': 0.45238096, 'binary_recall': 0.19071518, 'binary_specificity': 0.9802044, 'binary_f1_score': 0.26831418}
confusion matrix:
      0    1
0  9111  184
1   645  152
early stop counter: 1
val acc:0.9476173520088196, best validation acc: 0.9761738181114197, corresponding to test acc:                         0.9245937466621399 / 0.9245937466621399
after epoch: 2,now: 2024-08-07 17:30:06.095294,epoch time: 0:19:00.810350,used: 0:39:00.104825,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99098575, 'precision': 0.99101496, 'recall': 0.99098474, 'specificity': 0.99098474, 'f1': 0.99098563, 'auroc': 0.9994994, 'binary_precision': 0.98729414, 'binary_recall': 0.9947786, 'binary_specificity': 0.9871909, 'binary_f1_score': 0.9910222}
confusion matrix:
       0      1
0  25510    331
1    135  25720
---- Validation: 
scalar performance:
{'acc': 0.9295725, 'precision': 0.61647546, 'recall': 0.8904319, 'specificity': 0.8904319, 'f1': 0.6666316, 'auroc': 0.941624, 'binary_precision': 0.23698264, 'binary_recall': 0.8492823, 'binary_specificity': 0.9315815, 'binary_f1_score': 0.3705637}
confusion matrix:
       0     1
0  15563  1143
1     63   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8376932, 'precision': 0.64794916, 'recall': 0.848223, 'specificity': 0.848223, 'f1': 0.68021864, 'auroc': 0.9050673, 'binary_precision': 0.30998644, 'binary_recall': 0.8607277, 'binary_specificity': 0.83571815, 'binary_f1_score': 0.45581397}
confusion matrix:
      0     1
0  7768  1527
1   111   686
early stop counter: 2
val acc:0.9295725226402283, best validation acc: 0.9761738181114197, corresponding to test acc:                         0.9245937466621399 / 0.9245937466621399
after epoch: 3,now: 2024-08-07 17:49:05.378747,epoch time: 0:18:59.283453,used: 0:57:59.388278,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99278474, 'precision': 0.99283874, 'recall': 0.992785, 'specificity': 0.992785, 'f1': 0.9927845, 'auroc': 0.9996841, 'binary_precision': 0.9980061, 'binary_recall': 0.98754305, 'binary_specificity': 0.99802685, 'binary_f1_score': 0.992747}
confusion matrix:
       0      1
0  25796     51
1    322  25527
---- Validation: 
scalar performance:
{'acc': 0.9742467, 'precision': 0.7343696, 'recall': 0.7978698, 'specificity': 0.7978698, 'f1': 0.7620028, 'auroc': 0.9407929, 'binary_precision': 0.4785047, 'binary_recall': 0.61244017, 'binary_specificity': 0.98329943, 'binary_f1_score': 0.5372508}
confusion matrix:
       0    1
0  16427  279
1    162  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.913694, 'precision': 0.62039936, 'recall': 0.53215367, 'specificity': 0.53215367, 'f1': 0.54049194, 'auroc': 0.907127, 'binary_precision': 0.315, 'binary_recall': 0.07904642, 'binary_specificity': 0.9852609, 'binary_f1_score': 0.12637913}
confusion matrix:
      0    1
0  9158  137
1   734   63
early stop counter: 3
val acc:0.9742466807365417, best validation acc: 0.9761738181114197, corresponding to test acc:                         0.9245937466621399 / 0.9245937466621399
after epoch: 4,now: 2024-08-07 18:08:11.458383,epoch time: 0:19:06.079636,used: 1:17:05.467914,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9922238, 'precision': 0.992299, 'recall': 0.99222594, 'specificity': 0.99222594, 'f1': 0.9922235, 'auroc': 0.99952304, 'binary_precision': 0.9984726, 'binary_recall': 0.98596126, 'binary_specificity': 0.99849063, 'binary_f1_score': 0.9921775}
confusion matrix:
       0      1
0  25800     39
1    363  25494
---- Validation: 
scalar performance:
{'acc': 0.97716653, 'precision': 0.7588654, 'recall': 0.80753, 'specificity': 0.80753, 'f1': 0.7809394, 'auroc': 0.945495, 'binary_precision': 0.52705413, 'binary_recall': 0.62918663, 'binary_specificity': 0.98587334, 'binary_f1_score': 0.57360965}
confusion matrix:
       0    1
0  16470  236
1    155  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9199366, 'precision': 0.71593744, 'recall': 0.6416512, 'specificity': 0.6416512, 'f1': 0.6687857, 'auroc': 0.8980875, 'binary_precision': 0.48915187, 'binary_recall': 0.31116688, 'binary_specificity': 0.97213554, 'binary_f1_score': 0.3803681}
confusion matrix:
      0    1
0  9036  259
1   549  248
better model found
persisted
after epoch: 5,now: 2024-08-07 18:27:30.615002,epoch time: 0:19:19.156619,used: 1:36:24.624533,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99394536, 'precision': 0.9939529, 'recall': 0.99394536, 'specificity': 0.99394536, 'f1': 0.99394536, 'auroc': 0.99974346, 'binary_precision': 0.9920228, 'binary_recall': 0.9958991, 'binary_specificity': 0.99199164, 'binary_f1_score': 0.99395716}
confusion matrix:
       0      1
0  25641    207
1    106  25742
---- Validation: 
scalar performance:
{'acc': 0.9011913, 'precision': 0.58562094, 'recall': 0.86539006, 'specificity': 0.86539006, 'f1': 0.61858386, 'auroc': 0.9291712, 'binary_precision': 0.17599186, 'binary_recall': 0.8277512, 'binary_specificity': 0.90302885, 'binary_f1_score': 0.29026845}
confusion matrix:
       0     1
0  15086  1620
1     72   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90893775, 'precision': 0.6885065, 'recall': 0.6930363, 'specificity': 0.6930363, 'f1': 0.69073427, 'auroc': 0.8904439, 'binary_precision': 0.42542788, 'binary_recall': 0.4366374, 'binary_specificity': 0.9494352, 'binary_f1_score': 0.43095976}
confusion matrix:
      0    1
0  8825  470
1   449  348
early stop counter: 1
val acc:0.9011912941932678, best validation acc: 0.9771665334701538, corresponding to test acc:                         0.9199365973472595 / 0.9245937466621399
after epoch: 6,now: 2024-08-07 18:46:53.393016,epoch time: 0:19:22.778014,used: 1:55:47.402547,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99330705, 'precision': 0.99335116, 'recall': 0.9933076, 'specificity': 0.9933076, 'f1': 0.9933069, 'auroc': 0.9997216, 'binary_precision': 0.99804723, 'binary_recall': 0.98854977, 'binary_specificity': 0.9980654, 'binary_f1_score': 0.99327576}
confusion matrix:
       0      1
0  25795     50
1    296  25555
---- Validation: 
scalar performance:
{'acc': 0.97745854, 'precision': 0.7646409, 'recall': 0.74237, 'specificity': 0.74237, 'f1': 0.7529799, 'auroc': 0.94492745, 'binary_precision': 0.54188484, 'binary_recall': 0.4952153, 'binary_specificity': 0.9895247, 'binary_f1_score': 0.5175}
confusion matrix:
       0    1
0  16531  175
1    211  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90328974, 'precision': 0.7044959, 'recall': 0.82475674, 'specificity': 0.82475674, 'f1': 0.74512756, 'auroc': 0.8883922, 'binary_precision': 0.43345726, 'binary_recall': 0.7314931, 'binary_specificity': 0.9180204, 'binary_f1_score': 0.54435104}
confusion matrix:
      0    1
0  8533  762
1   214  583
better model found
persisted
after epoch: 7,now: 2024-08-07 19:06:16.552214,epoch time: 0:19:23.159198,used: 2:15:10.561745,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.996286, 'precision': 0.9962925, 'recall': 0.99628603, 'specificity': 0.99628603, 'f1': 0.996286, 'auroc': 0.9998388, 'binary_precision': 0.9980975, 'binary_recall': 0.99446785, 'binary_specificity': 0.9981042, 'binary_f1_score': 0.99627936}
confusion matrix:
       0      1
0  25798     49
1    143  25706
---- Validation: 
scalar performance:
{'acc': 0.9758818, 'precision': 0.74899685, 'recall': 0.8733474, 'specificity': 0.8733474, 'f1': 0.7976728, 'auroc': 0.95971775, 'binary_precision': 0.503937, 'binary_recall': 0.76555026, 'binary_specificity': 0.9811445, 'binary_f1_score': 0.60778725}
confusion matrix:
       0    1
0  16391  315
1     98  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90834326, 'precision': 0.7198028, 'recall': 0.8705172, 'specificity': 0.8705172, 'f1': 0.7678428, 'auroc': 0.92030156, 'binary_precision': 0.45567867, 'binary_recall': 0.825596, 'binary_specificity': 0.9154384, 'binary_f1_score': 0.58723783}
confusion matrix:
      0    1
0  8509  786
1   139  658
early stop counter: 1
val acc:0.975881814956665, best validation acc: 0.9774585366249084, corresponding to test acc:                         0.9032897353172302 / 0.9245937466621399
after epoch: 8,now: 2024-08-07 19:25:57.991370,epoch time: 0:19:41.439156,used: 2:34:52.000901,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99454504, 'precision': 0.99458694, 'recall': 0.9945457, 'specificity': 0.9945457, 'f1': 0.99454486, 'auroc': 0.99986106, 'binary_precision': 0.9991801, 'binary_recall': 0.98990405, 'binary_specificity': 0.9991874, 'binary_f1_score': 0.9945204}
confusion matrix:
       0      1
0  25823     21
1    261  25591
---- Validation: 
scalar performance:
{'acc': 0.9734875, 'precision': 0.7311226, 'recall': 0.8313018, 'specificity': 0.8313018, 'f1': 0.77148795, 'auroc': 0.9499658, 'binary_precision': 0.47029704, 'binary_recall': 0.6818182, 'binary_specificity': 0.98078537, 'binary_f1_score': 0.5566406}
confusion matrix:
       0    1
0  16385  321
1    133  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90804595, 'precision': 0.6791601, 'recall': 0.66674197, 'specificity': 0.66674197, 'f1': 0.6726435, 'auroc': 0.88994896, 'binary_precision': 0.4111262, 'binary_recall': 0.38017565, 'binary_specificity': 0.9533082, 'binary_f1_score': 0.39504564}
confusion matrix:
      0    1
0  8861  434
1   494  303
early stop counter: 2
val acc:0.9734874963760376, best validation acc: 0.9774585366249084, corresponding to test acc:                         0.9032897353172302 / 0.9245937466621399
after epoch: 9,now: 2024-08-07 19:46:15.218811,epoch time: 0:20:17.227441,used: 2:55:09.228342,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9924752, 'precision': 0.9924781, 'recall': 0.99247515, 'specificity': 0.99247515, 'f1': 0.9924752, 'auroc': 0.99950784, 'binary_precision': 0.99131644, 'binary_recall': 0.9936557, 'binary_specificity': 0.99129456, 'binary_f1_score': 0.9924847}
confusion matrix:
       0      1
0  25621    225
1    164  25686
---- Validation: 
scalar performance:
{'acc': 0.9778673, 'precision': 0.7700366, 'recall': 0.7390808, 'specificity': 0.7390808, 'f1': 0.75354886, 'auroc': 0.9398705, 'binary_precision': 0.55284554, 'binary_recall': 0.48803827, 'binary_specificity': 0.99012333, 'binary_f1_score': 0.5184244}
confusion matrix:
       0    1
0  16541  165
1    214  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9106223, 'precision': 0.7004019, 'recall': 0.7289379, 'specificity': 0.7289379, 'f1': 0.7133647, 'auroc': 0.8967344, 'binary_precision': 0.44312027, 'binary_recall': 0.5131744, 'binary_specificity': 0.94470143, 'binary_f1_score': 0.4755814}
confusion matrix:
      0    1
0  8781  514
1   388  409
better model found
persisted
after epoch: 10,now: 2024-08-07 20:05:55.983328,epoch time: 0:19:40.764517,used: 3:14:49.992859,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99317163, 'precision': 0.9932151, 'recall': 0.9931725, 'specificity': 0.9931725, 'f1': 0.99317145, 'auroc': 0.9997066, 'binary_precision': 0.9978913, 'binary_recall': 0.9884346, 'binary_specificity': 0.99791044, 'binary_f1_score': 0.9931404}
confusion matrix:
       0      1
0  25789     54
1    299  25554
---- Validation: 
scalar performance:
{'acc': 0.9802616, 'precision': 0.7865472, 'recall': 0.8371061, 'specificity': 0.8371061, 'f1': 0.80962336, 'auroc': 0.96150196, 'binary_precision': 0.58097166, 'binary_recall': 0.6866029, 'binary_specificity': 0.98760927, 'binary_f1_score': 0.62938595}
confusion matrix:
       0    1
0  16499  207
1    131  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9130004, 'precision': 0.712232, 'recall': 0.7657896, 'specificity': 0.7657896, 'f1': 0.7348857, 'auroc': 0.90818775, 'binary_precision': 0.46041057, 'binary_recall': 0.5909661, 'binary_specificity': 0.9406132, 'binary_f1_score': 0.5175824}
confusion matrix:
      0    1
0  8743  552
1   326  471
better model found
persisted
after epoch: 11,now: 2024-08-07 20:25:11.516876,epoch time: 0:19:15.533548,used: 3:34:05.526407,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99435157, 'precision': 0.9943659, 'recall': 0.9943514, 'specificity': 0.9943514, 'f1': 0.9943515, 'auroc': 0.9998924, 'binary_precision': 0.99172693, 'binary_recall': 0.99702126, 'binary_specificity': 0.9916815, 'binary_f1_score': 0.994367}
confusion matrix:
       0      1
0  25631    215
1     77  25773
---- Validation: 
scalar performance:
{'acc': 0.96618783, 'precision': 0.70292866, 'recall': 0.91852754, 'specificity': 0.91852754, 'f1': 0.76937306, 'auroc': 0.97227114, 'binary_precision': 0.40924466, 'binary_recall': 0.8684211, 'binary_specificity': 0.968634, 'binary_f1_score': 0.55632186}
confusion matrix:
       0    1
0  16182  524
1     55  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89011097, 'precision': 0.6953754, 'recall': 0.86807567, 'specificity': 0.86807567, 'f1': 0.7424964, 'auroc': 0.90134305, 'binary_precision': 0.4056832, 'binary_recall': 0.84190714, 'binary_specificity': 0.8942442, 'binary_f1_score': 0.5475316}
confusion matrix:
      0    1
0  8312  983
1   126  671
early stop counter: 1
val acc:0.9661878347396851, best validation acc: 0.9802616238594055, corresponding to test acc:                         0.9130004048347473 / 0.9245937466621399
after epoch: 12,now: 2024-08-07 20:44:25.352636,epoch time: 0:19:13.835760,used: 3:53:19.362167,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9906569, 'precision': 0.9908241, 'recall': 0.9906584, 'specificity': 0.9906584, 'f1': 0.99065614, 'auroc': 0.9998435, 'binary_precision': 0.9999212, 'binary_recall': 0.9813941, 'binary_specificity': 0.99992263, 'binary_f1_score': 0.990571}
confusion matrix:
       0      1
0  25842      2
1    481  25371
---- Validation: 
scalar performance:
{'acc': 0.9762322, 'precision': 0.767117, 'recall': 0.56447256, 'specificity': 0.56447256, 'f1': 0.6003499, 'auroc': 0.9222468, 'binary_precision': 0.5555556, 'binary_recall': 0.13157895, 'binary_specificity': 0.9973662, 'binary_f1_score': 0.21276598}
confusion matrix:
       0   1
0  16662  44
1    363  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918153, 'precision': 0.727933, 'recall': 0.7972649, 'specificity': 0.7972649, 'f1': 0.75635934, 'auroc': 0.89717925, 'binary_precision': 0.48646125, 'binary_recall': 0.65370136, 'binary_specificity': 0.9408284, 'binary_f1_score': 0.55781585}
confusion matrix:
      0    1
0  8745  550
1   276  521
early stop counter: 2
val acc:0.9762321710586548, best validation acc: 0.9802616238594055, corresponding to test acc:                         0.9130004048347473 / 0.9245937466621399
after epoch: 13,now: 2024-08-07 21:03:34.707956,epoch time: 0:19:09.355320,used: 4:12:28.717487,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9953768, 'precision': 0.9954157, 'recall': 0.9953768, 'specificity': 0.9953768, 'f1': 0.9953767, 'auroc': 0.9999294, 'binary_precision': 0.99980485, 'binary_recall': 0.99094707, 'binary_specificity': 0.9998066, 'binary_f1_score': 0.99535626}
confusion matrix:
       0      1
0  25843      5
1    234  25614
---- Validation: 
scalar performance:
{'acc': 0.9814296, 'precision': 0.83634245, 'recall': 0.7175816, 'specificity': 0.7175816, 'f1': 0.7634841, 'auroc': 0.955341, 'binary_precision': 0.6865672, 'binary_recall': 0.4401914, 'binary_specificity': 0.9949719, 'binary_f1_score': 0.5364432}
confusion matrix:
       0    1
0  16622   84
1    234  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9055688, 'precision': 0.7076038, 'recall': 0.82197905, 'specificity': 0.82197905, 'f1': 0.7472777, 'auroc': 0.8902736, 'binary_precision': 0.44036698, 'binary_recall': 0.7227102, 'binary_specificity': 0.92124796, 'binary_f1_score': 0.54726845}
confusion matrix:
      0    1
0  8563  732
1   221  576
better model found
persisted
after epoch: 14,now: 2024-08-07 21:23:11.512052,epoch time: 0:19:36.804096,used: 4:32:05.521583,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99377126, 'precision': 0.9937881, 'recall': 0.9937706, 'specificity': 0.9937706, 'f1': 0.9937712, 'auroc': 0.9998568, 'binary_precision': 0.9909622, 'binary_recall': 0.99663496, 'binary_specificity': 0.9909063, 'binary_f1_score': 0.99379045}
confusion matrix:
       0      1
0  25607    235
1     87  25767
---- Validation: 
scalar performance:
{'acc': 0.9467414, 'precision': 0.6436097, 'recall': 0.88873494, 'specificity': 0.88873494, 'f1': 0.7017418, 'auroc': 0.94840306, 'binary_precision': 0.29173693, 'binary_recall': 0.8277512, 'binary_specificity': 0.94971865, 'binary_f1_score': 0.43142146}
confusion matrix:
       0    1
0  15866  840
1     72  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90546966, 'precision': 0.70862454, 'recall': 0.828808, 'specificity': 0.828808, 'f1': 0.7496356, 'auroc': 0.89786434, 'binary_precision': 0.44111028, 'binary_recall': 0.7377666, 'binary_specificity': 0.9198494, 'binary_f1_score': 0.5521127}
confusion matrix:
      0    1
0  8550  745
1   209  588
early stop counter: 1
val acc:0.9467414021492004, best validation acc: 0.9814295768737793, corresponding to test acc:                         0.9055687785148621 / 0.9245937466621399
after epoch: 15,now: 2024-08-07 21:44:24.314337,epoch time: 0:21:12.802285,used: 4:53:18.323868,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9970791, 'precision': 0.99708617, 'recall': 0.99707925, 'specificity': 0.99707925, 'f1': 0.9970791, 'auroc': 0.9999069, 'binary_precision': 0.99899036, 'binary_recall': 0.9951646, 'binary_specificity': 0.998994, 'binary_f1_score': 0.9970738}
confusion matrix:
       0      1
0  25819     26
1    125  25726
---- Validation: 
scalar performance:
{'acc': 0.9807872, 'precision': 0.79864705, 'recall': 0.79655695, 'specificity': 0.79655695, 'f1': 0.79759806, 'auroc': 0.9580174, 'binary_precision': 0.60722893, 'binary_recall': 0.6028708, 'binary_specificity': 0.990243, 'binary_f1_score': 0.60504204}
confusion matrix:
       0    1
0  16543  163
1    166  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8812921, 'precision': 0.6840668, 'recall': 0.85927325, 'specificity': 0.85927325, 'f1': 0.72894394, 'auroc': 0.9050093, 'binary_precision': 0.38403702, 'binary_recall': 0.8331242, 'binary_specificity': 0.8854223, 'binary_f1_score': 0.52573246}
confusion matrix:
      0     1
0  8230  1065
1   133   664
early stop counter: 2
val acc:0.9807872176170349, best validation acc: 0.9814295768737793, corresponding to test acc:                         0.9055687785148621 / 0.9245937466621399
after epoch: 16,now: 2024-08-07 22:05:44.738438,epoch time: 0:21:20.424101,used: 5:14:38.747969,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9948545, 'precision': 0.99489355, 'recall': 0.9948554, 'specificity': 0.9948554, 'f1': 0.99485445, 'auroc': 0.9998491, 'binary_precision': 0.9993365, 'binary_recall': 0.9903686, 'binary_specificity': 0.9993422, 'binary_f1_score': 0.99483234}
confusion matrix:
       0      1
0  25826     17
1    249  25604
---- Validation: 
scalar performance:
{'acc': 0.97231954, 'precision': 0.72400653, 'recall': 0.83536816, 'specificity': 0.83536816, 'f1': 0.7675754, 'auroc': 0.95478386, 'binary_precision': 0.45583597, 'binary_recall': 0.69138753, 'binary_specificity': 0.9793487, 'binary_f1_score': 0.5494297}
confusion matrix:
       0    1
0  16361  345
1    129  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79716605, 'precision': 0.62786394, 'recall': 0.8428551, 'specificity': 0.8428551, 'f1': 0.6443753, 'auroc': 0.9094322, 'binary_precision': 0.26679105, 'binary_recall': 0.89711416, 'binary_specificity': 0.78859603, 'binary_f1_score': 0.4112741}
confusion matrix:
      0     1
0  7330  1965
1    82   715
early stop counter: 3
val acc:0.9723195433616638, best validation acc: 0.9814295768737793, corresponding to test acc:                         0.9055687785148621 / 0.9245937466621399
after epoch: 17,now: 2024-08-07 22:26:52.118752,epoch time: 0:21:07.380314,used: 5:35:46.128283,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9936359, 'precision': 0.9937127, 'recall': 0.99363613, 'specificity': 0.99363613, 'f1': 0.9936356, 'auroc': 0.9998733, 'binary_precision': 0.99988246, 'binary_recall': 0.9873883, 'binary_specificity': 0.99988395, 'binary_f1_score': 0.9935961}
confusion matrix:
       0      1
0  25844      3
1    326  25523
---- Validation: 
scalar performance:
{'acc': 0.9727283, 'precision': 0.72589785, 'recall': 0.8274139, 'specificity': 0.8274139, 'f1': 0.7664913, 'auroc': 0.94674826, 'binary_precision': 0.4600326, 'binary_recall': 0.67464113, 'binary_specificity': 0.98018676, 'binary_f1_score': 0.5470417}
confusion matrix:
       0    1
0  16375  331
1    136  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8796076, 'precision': 0.6762131, 'recall': 0.831975, 'specificity': 0.831975, 'f1': 0.7178838, 'auroc': 0.8847407, 'binary_precision': 0.37363967, 'binary_recall': 0.7754078, 'binary_specificity': 0.88854223, 'binary_f1_score': 0.50428396}
confusion matrix:
      0     1
0  8259  1036
1   179   618
early stop counter: 4
val acc:0.9727283120155334, best validation acc: 0.9814295768737793, corresponding to test acc:                         0.9055687785148621 / 0.9245937466621399
after epoch: 18,now: 2024-08-07 22:47:02.912418,epoch time: 0:20:10.793666,used: 5:55:56.921949,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9946998, 'precision': 0.99475276, 'recall': 0.9947008, 'specificity': 0.9947008, 'f1': 0.99469966, 'auroc': 0.9998994, 'binary_precision': 0.9999218, 'binary_recall': 0.989479, 'binary_specificity': 0.99992263, 'binary_f1_score': 0.99467295}
confusion matrix:
       0      1
0  25841      2
1    272  25581
---- Validation: 
scalar performance:
{'acc': 0.97728336, 'precision': 0.77779275, 'recall': 0.6326534, 'specificity': 0.6326534, 'f1': 0.6779568, 'auroc': 0.9261608, 'binary_precision': 0.57360405, 'binary_recall': 0.27033493, 'binary_specificity': 0.9949719, 'binary_f1_score': 0.36747968}
confusion matrix:
       0    1
0  16622   84
1    305  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.889021, 'precision': 0.5814672, 'recall': 0.5629235, 'specificity': 0.5629235, 'f1': 0.5701874, 'auroc': 0.8251926, 'binary_precision': 0.23217247, 'binary_recall': 0.17565872, 'binary_specificity': 0.9501883, 'binary_f1_score': 0.2}
confusion matrix:
      0    1
0  8832  463
1   657  140
early stop counter: 5
val acc:0.9772833585739136, best validation acc: 0.9814295768737793, corresponding to test acc:                         0.9055687785148621 / 0.9245937466621399
after epoch: 19,now: 2024-08-07 23:06:48.936511,epoch time: 0:19:46.024093,used: 6:15:42.946042,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99551225, 'precision': 0.9955292, 'recall': 0.995512, 'specificity': 0.995512, 'f1': 0.99551225, 'auroc': 0.9999249, 'binary_precision': 0.99265385, 'binary_recall': 0.9984139, 'binary_specificity': 0.9926101, 'binary_f1_score': 0.99552554}
confusion matrix:
       0      1
0  25655    191
1     41  25809
---- Validation: 
scalar performance:
{'acc': 0.9402593, 'precision': 0.6331945, 'recall': 0.8970752, 'specificity': 0.8970752, 'f1': 0.68945515, 'auroc': 0.94832444, 'binary_precision': 0.27031133, 'binary_recall': 0.8516746, 'binary_specificity': 0.94247574, 'binary_f1_score': 0.41037467}
confusion matrix:
       0    1
0  15745  961
1     62  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8097503, 'precision': 0.6313987, 'recall': 0.83764195, 'specificity': 0.83764195, 'f1': 0.6529089, 'auroc': 0.8855065, 'binary_precision': 0.2763839, 'binary_recall': 0.8707654, 'binary_specificity': 0.8045186, 'binary_f1_score': 0.41958886}
confusion matrix:
      0     1
0  7478  1817
1   103   694
early stop counter: 6
val acc:0.9402592778205872, best validation acc: 0.9814295768737793, corresponding to test acc:                         0.9055687785148621 / 0.9245937466621399
after epoch: 20,now: 2024-08-07 23:26:44.724323,epoch time: 0:19:55.787812,used: 6:35:38.733854,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_16_51_05_seed_2_24078373
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:35:38.733854 at 2024-08-07 23:26:44.724323
persisted model performance metric: 

scalar performance:
{'acc': 0.9055688, 'precision': 0.7076038, 'recall': 0.82197905, 'specificity': 0.82197905, 'f1': 0.7472777, 'auroc': 0.8902736, 'binary_precision': 0.44036698, 'binary_recall': 0.7227102, 'binary_specificity': 0.92124796, 'binary_f1_score': 0.54726845}
confusion matrix:
      0    1
0  8563  732
1   221  576
oracle model performance metric: 

scalar performance:
{'acc': 0.92459375, 'precision': 0.7985548, 'recall': 0.5426593, 'specificity': 0.5426593, 'f1': 0.55889237, 'auroc': 0.9075356, 'binary_precision': 0.6698113, 'binary_recall': 0.08908407, 'binary_specificity': 0.99623454, 'binary_f1_score': 0.1572536}
confusion matrix:
      0   1
0  9260  35
1   726  71
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457555 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool | 415151 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |  42404 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447933 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |  40858 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14484 MiB |  41672 MiB |  27200 MiB |
|       from large pool |  14406 MiB |  14412 MiB |  41570 MiB |  27164 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 466092 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool | 455249 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |  10843 KiB |     46 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4922    |    7467    |  329278 K  |  329273 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158241 K  |
|       from small pool |    4735    |    7278    |  171036 K  |  171031 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4922    |    7467    |  329278 K  |  329273 K  |
|       from large pool |     187    |    1413    |  158242 K  |  158241 K  |
|       from small pool |    4735    |    7278    |  171036 K  |  171031 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     638    |    1783    |    1148    |
|       from large pool |     602    |     602    |    1732    |    1130    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3293    |  193623 K  |  193623 K  |
|       from large pool |      36    |     605    |  110448 K  |  110448 K  |
|       from small pool |      38    |    3257    |   83174 K  |   83174 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13220 MiB |   1690 TiB |   1690 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1667 TiB |   1667 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1689 TiB |   1689 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1665 TiB |   1665 TiB |
|       from small pool |      0 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14484 MiB |  41672 MiB |  40770 MiB |
|       from large pool |    850 MiB |  14412 MiB |  41570 MiB |  40720 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1235 MiB |   1301 TiB |   1301 TiB |
|       from large pool |  24320 KiB |   1232 MiB |   1277 TiB |   1277 TiB |
|       from small pool |      0 KiB |     46 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7467    |  329278 K  |  329278 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171036 K  |  171036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7467    |  329278 K  |  329278 K  |
|       from large pool |       2    |    1413    |  158242 K  |  158242 K  |
|       from small pool |       0    |    7278    |  171036 K  |  171036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     638    |    1783    |    1719    |
|       from large pool |      38    |     602    |    1732    |    1694    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3293    |  193625 K  |  193625 K  |
|       from large pool |       3    |     605    |  110448 K  |  110448 K  |
|       from small pool |       0    |    3257    |   83176 K  |   83176 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 23:44:42 2024]
Finished job 0.
1 of 1 steps (100%) done
