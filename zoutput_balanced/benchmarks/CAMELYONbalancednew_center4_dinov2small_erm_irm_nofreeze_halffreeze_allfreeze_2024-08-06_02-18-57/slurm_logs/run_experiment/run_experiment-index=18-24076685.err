Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Aug  7 02:34:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/18.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=18
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685

 Experiment start at: 2024-08-07 02:44:41.256106
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.72964704, 'precision': 0.73036516, 'recall': 0.7296635, 'specificity': 0.7296635, 'f1': 0.72944534, 'auroc': 0.7922307, 'binary_precision': 0.7433765, 'binary_recall': 0.7019295, 'binary_specificity': 0.7573974, 'binary_f1_score': 0.72205865}
confusion matrix:
       0      1
0  19172   6141
1   7554  17789
---- Validation: 
scalar performance:
{'acc': 0.7837396, 'precision': 0.5226604, 'recall': 0.6636003, 'specificity': 0.6636003, 'f1': 0.49216616, 'auroc': 0.7574518, 'binary_precision': 0.059641615, 'binary_recall': 0.5373494, 'binary_specificity': 0.7898512, 'binary_f1_score': 0.10736639}
confusion matrix:
       0     1
0  13215  3516
1    192   223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65572476, 'precision': 0.55406916, 'recall': 0.6799543, 'specificity': 0.6799543, 'f1': 0.50830495, 'auroc': 0.73168695, 'binary_precision': 0.143796, 'binary_recall': 0.7085492, 'binary_specificity': 0.65135944, 'binary_f1_score': 0.23907341}
confusion matrix:
      0     1
0  6085  3257
1   225   547
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 03:00:47.225079,epoch time: 0:16:05.968973,used: 0:16:05.968973,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8275624, 'precision': 0.82827926, 'recall': 0.82757527, 'specificity': 0.82757527, 'f1': 0.8274721, 'auroc': 0.9053058, 'binary_precision': 0.84375906, 'binary_recall': 0.804238, 'binary_specificity': 0.8509125, 'binary_f1_score': 0.82352465}
confusion matrix:
       0      1
0  21540   3774
1   4961  20381
---- Validation: 
scalar performance:
{'acc': 0.8253237, 'precision': 0.53057367, 'recall': 0.6884328, 'specificity': 0.6884328, 'f1': 0.51701504, 'auroc': 0.77651715, 'binary_precision': 0.07453826, 'binary_recall': 0.5445783, 'binary_specificity': 0.8322874, 'binary_f1_score': 0.13112853}
confusion matrix:
       0     1
0  13925  2806
1    189   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7010085, 'precision': 0.5749899, 'recall': 0.739522, 'specificity': 0.739522, 'f1': 0.5485122, 'auroc': 0.80348027, 'binary_precision': 0.17494227, 'binary_recall': 0.7849741, 'binary_specificity': 0.6940698, 'binary_f1_score': 0.28611898}
confusion matrix:
      0     1
0  6484  2858
1   166   606
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 03:15:51.182183,epoch time: 0:15:03.957104,used: 0:31:09.926077,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.86062855, 'precision': 0.860775, 'recall': 0.8606334, 'specificity': 0.8606334, 'f1': 0.8606155, 'auroc': 0.9346409, 'binary_precision': 0.8681624, 'binary_recall': 0.8505525, 'binary_specificity': 0.8707142, 'binary_f1_score': 0.8592672}
confusion matrix:
       0      1
0  22043   3273
1   3787  21553
---- Validation: 
scalar performance:
{'acc': 0.8424705, 'precision': 0.53601074, 'recall': 0.7054435, 'specificity': 0.7054435, 'f1': 0.53018165, 'auroc': 0.7886926, 'binary_precision': 0.0846657, 'binary_recall': 0.5614458, 'binary_specificity': 0.8494412, 'binary_f1_score': 0.14714241}
confusion matrix:
       0     1
0  14212  2519
1    182   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72414476, 'precision': 0.5853808, 'recall': 0.7651173, 'specificity': 0.7651173, 'f1': 0.5690081, 'auroc': 0.83727145, 'binary_precision': 0.19181429, 'binary_recall': 0.8134715, 'binary_specificity': 0.716763, 'binary_f1_score': 0.31043005}
confusion matrix:
      0     1
0  6696  2646
1   144   628
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 03:30:51.980815,epoch time: 0:15:00.798632,used: 0:46:10.724709,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8753948, 'precision': 0.8756447, 'recall': 0.875402, 'specificity': 0.875402, 'f1': 0.8753755, 'auroc': 0.947448, 'binary_precision': 0.88547236, 'binary_recall': 0.86248124, 'binary_specificity': 0.88832265, 'binary_f1_score': 0.87382555}
confusion matrix:
       0      1
0  22487   2827
1   3485  21857
---- Validation: 
scalar performance:
{'acc': 0.84013766, 'precision': 0.5391883, 'recall': 0.7289217, 'specificity': 0.7289217, 'f1': 0.5340295, 'auroc': 0.7993442, 'binary_precision': 0.08962597, 'binary_recall': 0.6120482, 'binary_specificity': 0.8457952, 'binary_f1_score': 0.1563558}
confusion matrix:
       0     1
0  14151  2580
1    161   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73383427, 'precision': 0.59012735, 'recall': 0.7763039, 'specificity': 0.7763039, 'f1': 0.57800645, 'auroc': 0.8532796, 'binary_precision': 0.19962452, 'binary_recall': 0.8264249, 'binary_specificity': 0.7261828, 'binary_f1_score': 0.32157257}
confusion matrix:
      0     1
0  6784  2558
1   134   638
new oracle model saved
early stop counter: 1
val acc:0.8401376605033875, best validation acc: 0.8424705266952515, corresponding to test acc:                         0.7241447567939758 / 0.7338342666625977
after epoch: 4,now: 2024-08-07 03:45:42.784816,epoch time: 0:14:50.804001,used: 1:01:01.528710,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88686436, 'precision': 0.8874508, 'recall': 0.88687205, 'specificity': 0.88687205, 'f1': 0.88682294, 'auroc': 0.9541805, 'binary_precision': 0.9026243, 'binary_recall': 0.86739284, 'binary_specificity': 0.9063512, 'binary_f1_score': 0.8846579}
confusion matrix:
       0      1
0  22947   2371
1   3360  21978
---- Validation: 
scalar performance:
{'acc': 0.8698239, 'precision': 0.54593873, 'recall': 0.72533405, 'specificity': 0.72533405, 'f1': 0.5525534, 'auroc': 0.8039272, 'binary_precision': 0.10379416, 'binary_recall': 0.57349396, 'binary_specificity': 0.8771741, 'binary_f1_score': 0.17577548}
confusion matrix:
       0     1
0  14676  2055
1    177   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77803046, 'precision': 0.60432523, 'recall': 0.7907217, 'specificity': 0.7907217, 'f1': 0.6112156, 'auroc': 0.8619827, 'binary_precision': 0.22892897, 'binary_recall': 0.80569947, 'binary_specificity': 0.77574396, 'binary_f1_score': 0.35654917}
confusion matrix:
      0     1
0  7247  2095
1   150   622
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 04:00:49.538245,epoch time: 0:15:06.753429,used: 1:16:08.282139,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.89495814, 'precision': 0.89662546, 'recall': 0.8949748, 'specificity': 0.8949748, 'f1': 0.8948505, 'auroc': 0.96017075, 'binary_precision': 0.9224698, 'binary_recall': 0.8625153, 'binary_specificity': 0.9274343, 'binary_f1_score': 0.89148563}
confusion matrix:
       0      1
0  23478   1837
1   3484  21857
---- Validation: 
scalar performance:
{'acc': 0.8912866, 'precision': 0.55018616, 'recall': 0.70695823, 'specificity': 0.70695823, 'f1': 0.5638899, 'auroc': 0.8065227, 'binary_precision': 0.1136, 'binary_recall': 0.51325303, 'binary_specificity': 0.90066344, 'binary_f1_score': 0.1860262}
confusion matrix:
       0     1
0  15069  1662
1    202   213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81273484, 'precision': 0.6196445, 'recall': 0.8017839, 'specificity': 0.8017839, 'f1': 0.6403657, 'auroc': 0.86673605, 'binary_precision': 0.2602564, 'binary_recall': 0.7888601, 'binary_specificity': 0.81470776, 'binary_f1_score': 0.39138818}
confusion matrix:
      0     1
0  7611  1731
1   163   609
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 04:15:31.698427,epoch time: 0:14:42.160182,used: 1:30:50.442321,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9011766, 'precision': 0.90178585, 'recall': 0.90118814, 'specificity': 0.90118814, 'f1': 0.9011409, 'auroc': 0.96335804, 'binary_precision': 0.91758037, 'binary_recall': 0.88166356, 'binary_specificity': 0.92071265, 'binary_f1_score': 0.89926344}
confusion matrix:
       0      1
0  23306   2007
1   2999  22344
---- Validation: 
scalar performance:
{'acc': 0.867316, 'precision': 0.5467852, 'recall': 0.73462343, 'specificity': 0.73462343, 'f1': 0.55311716, 'auroc': 0.81297636, 'binary_precision': 0.104927786, 'binary_recall': 0.59518075, 'binary_specificity': 0.8740661, 'binary_f1_score': 0.17840376}
confusion matrix:
       0     1
0  14624  2107
1    168   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7932569, 'precision': 0.6125546, 'recall': 0.8031231, 'specificity': 0.8031231, 'f1': 0.6258764, 'auroc': 0.8732718, 'binary_precision': 0.24408227, 'binary_recall': 0.8147668, 'binary_specificity': 0.79147935, 'binary_f1_score': 0.37563452}
confusion matrix:
      0     1
0  7394  1948
1   143   629
early stop counter: 1
val acc:0.8673160076141357, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.812734842300415
after epoch: 7,now: 2024-08-07 04:30:32.664236,epoch time: 0:15:00.965809,used: 1:45:51.408130,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9050458, 'precision': 0.905105, 'recall': 0.90504944, 'specificity': 0.90504944, 'f1': 0.9050429, 'auroc': 0.96635437, 'binary_precision': 0.9101514, 'binary_recall': 0.89894646, 'binary_specificity': 0.91115236, 'binary_f1_score': 0.90451425}
confusion matrix:
       0      1
0  23064   2249
1   2561  22782
---- Validation: 
scalar performance:
{'acc': 0.85139394, 'precision': 0.5440239, 'recall': 0.7440889, 'specificity': 0.7440889, 'f1': 0.54447925, 'auroc': 0.8163887, 'binary_precision': 0.09860745, 'binary_recall': 0.6313253, 'binary_specificity': 0.85685253, 'binary_f1_score': 0.1705729}
confusion matrix:
       0     1
0  14336  2395
1    153   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78158987, 'precision': 0.60966563, 'recall': 0.8063139, 'specificity': 0.8063139, 'f1': 0.61831534, 'auroc': 0.87670124, 'binary_precision': 0.23652366, 'binary_recall': 0.83549225, 'binary_specificity': 0.7771355, 'binary_f1_score': 0.36867678}
confusion matrix:
      0     1
0  7260  2082
1   127   645
early stop counter: 2
val acc:0.8513939380645752, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.812734842300415
after epoch: 8,now: 2024-08-07 04:45:17.189428,epoch time: 0:14:44.525192,used: 2:00:35.933322,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91246843, 'precision': 0.9136611, 'recall': 0.91248435, 'specificity': 0.91248435, 'f1': 0.91240746, 'auroc': 0.969497, 'binary_precision': 0.93602204, 'binary_recall': 0.88557, 'binary_specificity': 0.9393987, 'binary_f1_score': 0.9100973}
confusion matrix:
       0      1
0  23779   1534
1   2900  22443
---- Validation: 
scalar performance:
{'acc': 0.8853377, 'precision': 0.5528539, 'recall': 0.73328334, 'specificity': 0.73328334, 'f1': 0.5665977, 'auroc': 0.8180071, 'binary_precision': 0.1174149, 'binary_recall': 0.57349396, 'binary_specificity': 0.8930727, 'binary_f1_score': 0.19492221}
confusion matrix:
       0     1
0  14942  1789
1    177   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82479733, 'precision': 0.62841916, 'recall': 0.8136609, 'specificity': 0.8136609, 'f1': 0.65400034, 'auroc': 0.8782617, 'binary_precision': 0.2763864, 'binary_recall': 0.80051816, 'binary_specificity': 0.8268037, 'binary_f1_score': 0.41090426}
confusion matrix:
      0     1
0  7724  1618
1   154   618
new oracle model saved
early stop counter: 3
val acc:0.8853377103805542, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8247973322868347
after epoch: 9,now: 2024-08-07 05:00:01.409713,epoch time: 0:14:44.220285,used: 2:15:20.153607,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91556776, 'precision': 0.91603255, 'recall': 0.91557837, 'specificity': 0.91557837, 'f1': 0.9155456, 'auroc': 0.97198594, 'binary_precision': 0.93009675, 'binary_recall': 0.8987926, 'binary_specificity': 0.9323641, 'binary_f1_score': 0.91417676}
confusion matrix:
       0      1
0  23600   1712
1   2565  22779
---- Validation: 
scalar performance:
{'acc': 0.8697072, 'precision': 0.5477308, 'recall': 0.73584867, 'specificity': 0.73584867, 'f1': 0.5551541, 'auroc': 0.8230225, 'binary_precision': 0.10678772, 'binary_recall': 0.59518075, 'binary_specificity': 0.87651664, 'binary_f1_score': 0.18108505}
confusion matrix:
       0     1
0  14665  2066
1    168   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8135258, 'precision': 0.6244783, 'recall': 0.81825405, 'specificity': 0.81825405, 'f1': 0.6461502, 'auroc': 0.8816104, 'binary_precision': 0.2665549, 'binary_recall': 0.8238342, 'binary_specificity': 0.8126739, 'binary_f1_score': 0.40278658}
confusion matrix:
      0     1
0  7592  1750
1   136   636
early stop counter: 4
val acc:0.8697072267532349, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8247973322868347
after epoch: 10,now: 2024-08-07 05:15:11.193388,epoch time: 0:15:09.783675,used: 2:30:29.937282,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9201279, 'precision': 0.92107224, 'recall': 0.9201429, 'specificity': 0.9201429, 'f1': 0.920085, 'auroc': 0.9735297, 'binary_precision': 0.9411716, 'binary_recall': 0.8963857, 'binary_specificity': 0.9439001, 'binary_f1_score': 0.9182329}
confusion matrix:
       0      1
0  23892   1420
1   2626  22718
---- Validation: 
scalar performance:
{'acc': 0.86854076, 'precision': 0.54827154, 'recall': 0.7411257, 'specificity': 0.7411257, 'f1': 0.55563134, 'auroc': 0.8240875, 'binary_precision': 0.10755442, 'binary_recall': 0.60722893, 'binary_specificity': 0.8750224, 'binary_f1_score': 0.18274112}
confusion matrix:
       0     1
0  14640  2091
1    163   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81659085, 'precision': 0.6257878, 'recall': 0.81813085, 'specificity': 0.81813085, 'f1': 0.64860207, 'auroc': 0.88335246, 'binary_precision': 0.26947638, 'binary_recall': 0.8199482, 'binary_specificity': 0.81631345, 'binary_f1_score': 0.4056392}
confusion matrix:
      0     1
0  7626  1716
1   139   633
early stop counter: 5
val acc:0.8685407638549805, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8247973322868347
after epoch: 11,now: 2024-08-07 05:30:15.836074,epoch time: 0:15:04.642686,used: 2:45:34.579968,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9224771, 'precision': 0.92323256, 'recall': 0.92248714, 'specificity': 0.92248714, 'f1': 0.92244375, 'auroc': 0.9745914, 'binary_precision': 0.9412322, 'binary_recall': 0.9013023, 'binary_specificity': 0.943672, 'binary_f1_score': 0.92083454}
confusion matrix:
       0      1
0  23890   1426
1   2501  22839
---- Validation: 
scalar performance:
{'acc': 0.8627668, 'precision': 0.547999, 'recall': 0.74991643, 'specificity': 0.74991643, 'f1': 0.5536168, 'auroc': 0.82755935, 'binary_precision': 0.106417544, 'binary_recall': 0.6313253, 'binary_specificity': 0.86850756, 'binary_f1_score': 0.18213417}
confusion matrix:
       0     1
0  14531  2200
1    153   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81441563, 'precision': 0.6246726, 'recall': 0.81754744, 'specificity': 0.81754744, 'f1': 0.64665216, 'auroc': 0.8852823, 'binary_precision': 0.26717237, 'binary_recall': 0.8212435, 'binary_specificity': 0.8138514, 'binary_f1_score': 0.40317968}
confusion matrix:
      0     1
0  7603  1739
1   138   634
early stop counter: 6
val acc:0.8627668023109436, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8247973322868347
after epoch: 12,now: 2024-08-07 05:45:29.665778,epoch time: 0:15:13.829704,used: 3:00:48.409672,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9264253, 'precision': 0.9272083, 'recall': 0.9264389, 'specificity': 0.9264389, 'f1': 0.92639315, 'auroc': 0.97675544, 'binary_precision': 0.9456562, 'binary_recall': 0.90494794, 'binary_specificity': 0.94792986, 'binary_f1_score': 0.9248544}
confusion matrix:
       0      1
0  23994   1318
1   2409  22935
---- Validation: 
scalar performance:
{'acc': 0.8646915, 'precision': 0.5491225, 'recall': 0.7532525, 'specificity': 0.7532525, 'f1': 0.5558056, 'auroc': 0.83095074, 'binary_precision': 0.10850801, 'binary_recall': 0.6361446, 'binary_specificity': 0.87036043, 'binary_f1_score': 0.18539326}
confusion matrix:
       0     1
0  14562  2169
1    151   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8196559, 'precision': 0.6271454, 'recall': 0.8180075, 'specificity': 0.8180075, 'f1': 0.6510837, 'auroc': 0.8867241, 'binary_precision': 0.27249134, 'binary_recall': 0.81606215, 'binary_specificity': 0.8199529, 'binary_f1_score': 0.4085603}
confusion matrix:
      0     1
0  7660  1682
1   142   630
early stop counter: 7
val acc:0.8646914958953857, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8247973322868347
after epoch: 13,now: 2024-08-07 06:00:39.314631,epoch time: 0:15:09.648853,used: 3:15:58.058525,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9278269, 'precision': 0.9285203, 'recall': 0.9278405, 'specificity': 0.9278405, 'f1': 0.9277992, 'auroc': 0.97789955, 'binary_precision': 0.945927, 'binary_recall': 0.9076346, 'binary_specificity': 0.9480463, 'binary_f1_score': 0.9263853}
confusion matrix:
       0      1
0  23996   1315
1   2341  23004
---- Validation: 
scalar performance:
{'acc': 0.86305845, 'precision': 0.54926515, 'recall': 0.7571155, 'specificity': 0.7571155, 'f1': 0.5555475, 'auroc': 0.83265, 'binary_precision': 0.10854597, 'binary_recall': 0.6457831, 'binary_specificity': 0.8684478, 'binary_f1_score': 0.18585299}
confusion matrix:
       0     1
0  14530  2201
1    147   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8186672, 'precision': 0.6273469, 'recall': 0.82044303, 'specificity': 0.82044303, 'f1': 0.65102416, 'auroc': 0.88652265, 'binary_precision': 0.27229846, 'binary_recall': 0.82253885, 'binary_specificity': 0.8183473, 'binary_f1_score': 0.4091495}
confusion matrix:
      0     1
0  7645  1697
1   137   635
early stop counter: 8
val acc:0.8630584478378296, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8247973322868347
after epoch: 14,now: 2024-08-07 06:15:22.767012,epoch time: 0:14:43.452381,used: 3:30:41.510906,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92875475, 'precision': 0.929531, 'recall': 0.9287674, 'specificity': 0.9287674, 'f1': 0.92872393, 'auroc': 0.9782696, 'binary_precision': 0.947939, 'binary_recall': 0.90743005, 'binary_specificity': 0.9501047, 'binary_f1_score': 0.9272423}
confusion matrix:
       0      1
0  24050   1263
1   2346  22997
---- Validation: 
scalar performance:
{'acc': 0.8658579, 'precision': 0.5505515, 'recall': 0.75972486, 'specificity': 0.75972486, 'f1': 0.5582237, 'auroc': 0.8367821, 'binary_precision': 0.111019395, 'binary_recall': 0.64819276, 'binary_specificity': 0.87125695, 'binary_f1_score': 0.18957013}
confusion matrix:
       0     1
0  14577  2154
1    146   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82232547, 'precision': 0.62894636, 'recall': 0.8200468, 'specificity': 0.8200468, 'f1': 0.6539439, 'auroc': 0.8877688, 'binary_precision': 0.2759073, 'binary_recall': 0.81735754, 'binary_specificity': 0.822736, 'binary_f1_score': 0.41255313}
confusion matrix:
      0     1
0  7686  1656
1   141   631
early stop counter: 9
val acc:0.8658578991889954, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8247973322868347
after epoch: 15,now: 2024-08-07 06:30:25.775233,epoch time: 0:15:03.008221,used: 3:45:44.519127,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9313211, 'precision': 0.93238205, 'recall': 0.9313358, 'specificity': 0.9313358, 'f1': 0.9312805, 'auroc': 0.97962487, 'binary_precision': 0.95394903, 'binary_recall': 0.90648305, 'binary_specificity': 0.9561885, 'binary_f1_score': 0.9296105}
confusion matrix:
       0      1
0  24204   1109
1   2370  22973
---- Validation: 
scalar performance:
{'acc': 0.8653914, 'precision': 0.5499787, 'recall': 0.75713587, 'specificity': 0.75713587, 'f1': 0.5572548, 'auroc': 0.83858645, 'binary_precision': 0.11001236, 'binary_recall': 0.6433735, 'binary_specificity': 0.8708983, 'binary_f1_score': 0.18789583}
confusion matrix:
       0     1
0  14571  2160
1    148   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82796127, 'precision': 0.6323791, 'recall': 0.8225033, 'specificity': 0.8225033, 'f1': 0.65950084, 'auroc': 0.88836133, 'binary_precision': 0.28276482, 'binary_recall': 0.81606215, 'binary_specificity': 0.82894456, 'binary_f1_score': 0.42000002}
confusion matrix:
      0     1
0  7744  1598
1   142   630
new oracle model saved
early stop counter: 10
val acc:0.8653913736343384, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.827961266040802
after epoch: 16,now: 2024-08-07 06:45:29.538330,epoch time: 0:15:03.763097,used: 4:00:48.282224,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9329991, 'precision': 0.93340087, 'recall': 0.93300873, 'specificity': 0.93300873, 'f1': 0.9329845, 'auroc': 0.9803132, 'binary_precision': 0.9467557, 'binary_recall': 0.91769254, 'binary_specificity': 0.9483249, 'binary_f1_score': 0.9319976}
confusion matrix:
       0      1
0  24004   1308
1   2086  23258
---- Validation: 
scalar performance:
{'acc': 0.8502275, 'precision': 0.5481833, 'recall': 0.7728646, 'specificity': 0.7728646, 'f1': 0.5501232, 'auroc': 0.8410747, 'binary_precision': 0.105243854, 'binary_recall': 0.6915663, 'binary_specificity': 0.85416293, 'binary_f1_score': 0.1826862}
confusion matrix:
       0     1
0  14291  2440
1    128   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81411904, 'precision': 0.62609833, 'recall': 0.8233284, 'specificity': 0.8233284, 'f1': 0.64818317, 'auroc': 0.8887876, 'binary_precision': 0.2687813, 'binary_recall': 0.83419687, 'binary_specificity': 0.8124599, 'binary_f1_score': 0.40656564}
confusion matrix:
      0     1
0  7590  1752
1   128   644
early stop counter: 11
val acc:0.8502274751663208, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.827961266040802
after epoch: 17,now: 2024-08-07 07:00:38.446766,epoch time: 0:15:08.908436,used: 4:15:57.190660,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93120265, 'precision': 0.9322364, 'recall': 0.9312172, 'specificity': 0.9312172, 'f1': 0.931163, 'auroc': 0.98031735, 'binary_precision': 0.9535231, 'binary_recall': 0.90668035, 'binary_specificity': 0.955754, 'binary_f1_score': 0.9295119}
confusion matrix:
       0      1
0  24193   1120
1   2365  22978
---- Validation: 
scalar performance:
{'acc': 0.865333, 'precision': 0.55207354, 'recall': 0.77003026, 'specificity': 0.77003026, 'f1': 0.56029725, 'auroc': 0.84324473, 'binary_precision': 0.113469385, 'binary_recall': 0.6698795, 'binary_specificity': 0.8701811, 'binary_f1_score': 0.19406632}
confusion matrix:
       0     1
0  14559  2172
1    137   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8292466, 'precision': 0.6332237, 'recall': 0.82319915, 'specificity': 0.82319915, 'f1': 0.66082984, 'auroc': 0.8890153, 'binary_precision': 0.28442436, 'binary_recall': 0.81606215, 'binary_specificity': 0.8303361, 'binary_f1_score': 0.42182788}
confusion matrix:
      0     1
0  7757  1585
1   142   630
new oracle model saved
early stop counter: 12
val acc:0.8653330206871033, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8292465806007385
after epoch: 18,now: 2024-08-07 07:15:44.948178,epoch time: 0:15:06.501412,used: 4:31:03.692072,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93380845, 'precision': 0.93459135, 'recall': 0.93382025, 'specificity': 0.93382025, 'f1': 0.93377984, 'auroc': 0.9814874, 'binary_precision': 0.9531759, 'binary_recall': 0.9125168, 'binary_specificity': 0.95512366, 'binary_f1_score': 0.9324033}
confusion matrix:
       0      1
0  24178   1136
1   2217  23125
---- Validation: 
scalar performance:
{'acc': 0.8578677, 'precision': 0.55051076, 'recall': 0.7744296, 'specificity': 0.7744296, 'f1': 0.5558305, 'auroc': 0.8442837, 'binary_precision': 0.1099537, 'binary_recall': 0.686747, 'binary_specificity': 0.8621122, 'binary_f1_score': 0.18955769}
confusion matrix:
       0     1
0  14424  2307
1    130   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82618153, 'precision': 0.63201857, 'recall': 0.8245107, 'specificity': 0.8245107, 'f1': 0.65860474, 'auroc': 0.8900795, 'binary_precision': 0.28147164, 'binary_recall': 0.82253885, 'binary_specificity': 0.82648253, 'binary_f1_score': 0.41941875}
confusion matrix:
      0     1
0  7721  1621
1   137   635
early stop counter: 13
val acc:0.8578677177429199, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8292465806007385
after epoch: 19,now: 2024-08-07 07:30:32.451021,epoch time: 0:14:47.502843,used: 4:45:51.194915,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.93558514, 'precision': 0.93651634, 'recall': 0.9355961, 'specificity': 0.9355961, 'f1': 0.9355519, 'auroc': 0.9815255, 'binary_precision': 0.956797, 'binary_recall': 0.91243094, 'binary_specificity': 0.9587613, 'binary_f1_score': 0.93408746}
confusion matrix:
       0      1
0  24272   1044
1   2219  23121
---- Validation: 
scalar performance:
{'acc': 0.8569929, 'precision': 0.5509226, 'recall': 0.7786811, 'specificity': 0.7786811, 'f1': 0.5561626, 'auroc': 0.84625316, 'binary_precision': 0.11051625, 'binary_recall': 0.69638556, 'binary_specificity': 0.86097664, 'binary_f1_score': 0.19075906}
confusion matrix:
       0     1
0  14405  2326
1    126   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82618153, 'precision': 0.6323349, 'recall': 0.825699, 'specificity': 0.825699, 'f1': 0.6589758, 'auroc': 0.8909994, 'binary_precision': 0.2818584, 'binary_recall': 0.8251295, 'binary_specificity': 0.8262685, 'binary_f1_score': 0.4201847}
confusion matrix:
      0     1
0  7719  1623
1   135   637
early stop counter: 14
val acc:0.8569929003715515, best validation acc: 0.8912866115570068, corresponding to test acc:                         0.812734842300415 / 0.8292465806007385
after epoch: 20,now: 2024-08-07 07:45:16.979830,epoch time: 0:14:44.528809,used: 5:00:35.723724,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_44_41_seed_0_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:00:35.723724 at 2024-08-07 07:45:16.979830
persisted model performance metric: 

scalar performance:
{'acc': 0.81273484, 'precision': 0.6196445, 'recall': 0.8017839, 'specificity': 0.8017839, 'f1': 0.6403657, 'auroc': 0.86673605, 'binary_precision': 0.2602564, 'binary_recall': 0.7888601, 'binary_specificity': 0.81470776, 'binary_f1_score': 0.39138818}
confusion matrix:
      0     1
0  7611  1731
1   163   609
oracle model performance metric: 

scalar performance:
{'acc': 0.8292466, 'precision': 0.6332237, 'recall': 0.82319915, 'specificity': 0.82319915, 'f1': 0.66082984, 'auroc': 0.8890153, 'binary_precision': 0.28442436, 'binary_recall': 0.81606215, 'binary_specificity': 0.8303361, 'binary_f1_score': 0.42182788}
confusion matrix:
      0     1
0  7757  1585
1   142   630
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/18.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192600 KiB | 462230 KiB | 361416 GiB | 361415 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 192600 KiB | 462230 KiB | 361416 GiB | 361415 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189463 KiB | 457745 KiB | 361395 GiB | 361394 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |  16649 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44967 KiB |  89169 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |  14567 KiB |  14818 KiB |   7437 GiB |   7436 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6815    |   81220 K  |   81215 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46330 K  |   46326 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6815    |   81220 K  |   81215 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46330 K  |   46326 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3184    |   42906 K  |   42906 K  |
|       from large pool |       9    |      18    |   24129 K  |   24129 K  |
|       from small pool |      26    |    3176    |   18776 K  |   18776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  23714 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42908 K  |   42908 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18778 K  |   18778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353987 GiB | 353987 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353982 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 193334 GiB | 193334 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185897 GiB | 185897 GiB |
|       from small pool |      0 KiB |  23714 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81220 K  |   81220 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46330 K  |   46330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42908 K  |   42908 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18778 K  |   18778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685

 Experiment start at: 2024-08-07 08:09:06.763493
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6275181, 'precision': 0.6293347, 'recall': 0.6274686, 'specificity': 0.6274686, 'f1': 0.62615097, 'auroc': 0.66200244, 'binary_precision': 0.614212, 'binary_recall': 0.6874238, 'binary_specificity': 0.5675133, 'binary_f1_score': 0.648759}
confusion matrix:
       0      1
0  14412  10983
1   7951  17486
---- Validation: 
scalar performance:
{'acc': 0.87134266, 'precision': 0.50807214, 'recall': 0.5328112, 'specificity': 0.5328112, 'f1': 0.49773225, 'auroc': 0.7354928, 'binary_precision': 0.03950104, 'binary_recall': 0.17633411, 'binary_specificity': 0.8892883, 'binary_f1_score': 0.06454353}
confusion matrix:
       0     1
0  14844  1848
1    355    76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8094342, 'precision': 0.4809195, 'recall': 0.4697077, 'specificity': 0.4697077, 'f1': 0.47315478, 'auroc': 0.5918226, 'binary_precision': 0.041666668, 'binary_recall': 0.07001321, 'binary_specificity': 0.86940217, 'binary_f1_score': 0.05224248}
confusion matrix:
      0     1
0  8115  1219
1   704    53
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 08:25:13.509772,epoch time: 0:16:06.746279,used: 0:16:06.746279,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.76223636, 'precision': 0.7625223, 'recall': 0.7622226, 'specificity': 0.7622226, 'f1': 0.76216507, 'auroc': 0.82956433, 'binary_precision': 0.7540628, 'binary_recall': 0.77890474, 'binary_specificity': 0.74554044, 'binary_f1_score': 0.7662824}
confusion matrix:
       0      1
0  18933   6462
1   5624  19813
---- Validation: 
scalar performance:
{'acc': 0.87239385, 'precision': 0.5182906, 'recall': 0.5762956, 'specificity': 0.5762956, 'f1': 0.5129243, 'auroc': 0.7658467, 'binary_precision': 0.05751766, 'binary_recall': 0.26450115, 'binary_specificity': 0.8880901, 'binary_f1_score': 0.09448819}
confusion matrix:
       0     1
0  14824  1868
1    317   114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8005153, 'precision': 0.52310187, 'recall': 0.545002, 'specificity': 0.545002, 'f1': 0.52108514, 'auroc': 0.7085304, 'binary_precision': 0.11377614, 'binary_recall': 0.24438573, 'binary_specificity': 0.8456182, 'binary_f1_score': 0.15526648}
confusion matrix:
      0     1
0  7893  1441
1   572   185
better model found
persisted
after epoch: 2,now: 2024-08-07 08:40:21.778705,epoch time: 0:15:08.268933,used: 0:31:15.015212,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8210576, 'precision': 0.82132185, 'recall': 0.82106996, 'specificity': 0.82106996, 'f1': 0.8210246, 'auroc': 0.8976016, 'binary_precision': 0.8307561, 'binary_recall': 0.8067851, 'binary_specificity': 0.8353548, 'binary_f1_score': 0.8185951}
confusion matrix:
       0      1
0  21213   4181
1   4915  20523
---- Validation: 
scalar performance:
{'acc': 0.88851255, 'precision': 0.52871615, 'recall': 0.6071658, 'specificity': 0.6071658, 'f1': 0.53178865, 'auroc': 0.7867303, 'binary_precision': 0.07674685, 'binary_recall': 0.31090486, 'binary_specificity': 0.90342677, 'binary_f1_score': 0.12310519}
confusion matrix:
       0     1
0  15080  1612
1    297   134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8190467, 'precision': 0.5642039, 'recall': 0.62845814, 'specificity': 0.62845814, 'f1': 0.5740587, 'auroc': 0.774871, 'binary_precision': 0.1820345, 'binary_recall': 0.40422723, 'binary_specificity': 0.8526891, 'binary_f1_score': 0.25102544}
confusion matrix:
      0     1
0  7959  1375
1   451   306
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 08:55:15.381002,epoch time: 0:14:53.602297,used: 0:46:08.617509,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8527109, 'precision': 0.8531492, 'recall': 0.8527241, 'specificity': 0.8527241, 'f1': 0.8526684, 'auroc': 0.9290077, 'binary_precision': 0.8657781, 'binary_recall': 0.8351091, 'binary_specificity': 0.87033904, 'binary_f1_score': 0.8501671}
confusion matrix:
       0      1
0  22104   3293
1   4194  21241
---- Validation: 
scalar performance:
{'acc': 0.89668864, 'precision': 0.5408548, 'recall': 0.6463938, 'specificity': 0.6463938, 'f1': 0.55109465, 'auroc': 0.80242205, 'binary_precision': 0.09892087, 'binary_recall': 0.38283062, 'binary_specificity': 0.9099569, 'binary_f1_score': 0.15721773}
confusion matrix:
       0     1
0  15189  1503
1    266   165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.829452, 'precision': 0.59729075, 'recall': 0.7069149, 'specificity': 0.7069149, 'f1': 0.61669844, 'auroc': 0.81742847, 'binary_precision': 0.2345815, 'binary_recall': 0.5627477, 'binary_specificity': 0.8510821, 'binary_f1_score': 0.331131}
confusion matrix:
      0     1
0  7944  1390
1   331   426
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 09:10:37.767348,epoch time: 0:15:22.386346,used: 1:01:31.003855,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8708884, 'precision': 0.87096715, 'recall': 0.8708942, 'specificity': 0.8708942, 'f1': 0.87088275, 'auroc': 0.9436339, 'binary_precision': 0.8765713, 'binary_recall': 0.86357915, 'binary_specificity': 0.8782092, 'binary_f1_score': 0.8700267}
confusion matrix:
       0      1
0  22303   3093
1   3470  21966
---- Validation: 
scalar performance:
{'acc': 0.8876949, 'precision': 0.5474157, 'recall': 0.69150686, 'specificity': 0.69150686, 'f1': 0.55914176, 'auroc': 0.8152098, 'binary_precision': 0.109424084, 'binary_recall': 0.4849188, 'binary_specificity': 0.8980949, 'binary_f1_score': 0.17855617}
confusion matrix:
       0     1
0  14991  1701
1    222   209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82538897, 'precision': 0.61169535, 'recall': 0.7593427, 'specificity': 0.7593427, 'f1': 0.63401425, 'auroc': 0.8441581, 'binary_precision': 0.2533137, 'binary_recall': 0.68163806, 'binary_specificity': 0.83704734, 'binary_f1_score': 0.3693629}
confusion matrix:
      0     1
0  7813  1521
1   241   516
early stop counter: 1
val acc:0.8876948952674866, best validation acc: 0.8966886401176453, corresponding to test acc:                         0.8294519782066345 / 0.8294519782066345
after epoch: 5,now: 2024-08-07 09:25:55.226163,epoch time: 0:15:17.458815,used: 1:16:48.462670,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88347894, 'precision': 0.8841424, 'recall': 0.8834945, 'specificity': 0.8834945, 'f1': 0.88343155, 'auroc': 0.95346653, 'binary_precision': 0.90029544, 'binary_recall': 0.8626695, 'binary_specificity': 0.9043194, 'binary_f1_score': 0.881081}
confusion matrix:
       0      1
0  22967   2430
1   3493  21942
---- Validation: 
scalar performance:
{'acc': 0.9045728, 'precision': 0.5559978, 'recall': 0.69451296, 'specificity': 0.69451296, 'f1': 0.5745325, 'auroc': 0.8210298, 'binary_precision': 0.12662943, 'binary_recall': 0.47331786, 'binary_specificity': 0.9157081, 'binary_f1_score': 0.19980411}
confusion matrix:
       0     1
0  15285  1407
1    227   204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84788424, 'precision': 0.62693214, 'recall': 0.76786095, 'specificity': 0.76786095, 'f1': 0.65606743, 'auroc': 0.85906875, 'binary_precision': 0.2836485, 'binary_recall': 0.673712, 'binary_specificity': 0.8620099, 'binary_f1_score': 0.39921722}
confusion matrix:
      0     1
0  8046  1288
1   247   510
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 09:41:03.987970,epoch time: 0:15:08.761807,used: 1:31:57.224477,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8939054, 'precision': 0.8948902, 'recall': 0.89392614, 'specificity': 0.89392614, 'f1': 0.89384276, 'auroc': 0.95910656, 'binary_precision': 0.91481787, 'binary_recall': 0.8688918, 'binary_specificity': 0.91896045, 'binary_f1_score': 0.89126354}
confusion matrix:
       0      1
0  23337   2058
1   3335  22102
---- Validation: 
scalar performance:
{'acc': 0.91198975, 'precision': 0.56119996, 'recall': 0.69718707, 'specificity': 0.69718707, 'f1': 0.58281165, 'auroc': 0.8253226, 'binary_precision': 0.13697706, 'binary_recall': 0.4709977, 'binary_specificity': 0.92337644, 'binary_f1_score': 0.2122321}
confusion matrix:
       0     1
0  15413  1279
1    228   203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.861758, 'precision': 0.64052176, 'recall': 0.78021586, 'specificity': 0.78021586, 'f1': 0.6737875, 'auroc': 0.8702254, 'binary_precision': 0.30943847, 'binary_recall': 0.68428004, 'binary_specificity': 0.8761517, 'binary_f1_score': 0.42616206}
confusion matrix:
      0     1
0  8178  1156
1   239   518
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-07 09:56:14.801570,epoch time: 0:15:10.813600,used: 1:47:08.038077,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89949244, 'precision': 0.90059775, 'recall': 0.8995142, 'specificity': 0.8995142, 'f1': 0.8994266, 'auroc': 0.96358633, 'binary_precision': 0.92184776, 'binary_recall': 0.8731769, 'binary_specificity': 0.9258515, 'binary_f1_score': 0.8968525}
confusion matrix:
       0      1
0  23512   1883
1   3226  22211
---- Validation: 
scalar performance:
{'acc': 0.9121649, 'precision': 0.5627136, 'recall': 0.7029276, 'specificity': 0.7029276, 'f1': 0.5850703, 'auroc': 0.8297272, 'binary_precision': 0.13969107, 'binary_recall': 0.4825986, 'binary_specificity': 0.92325664, 'binary_f1_score': 0.21666668}
confusion matrix:
       0     1
0  15411  1281
1    223   208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86542463, 'precision': 0.64525044, 'recall': 0.78644645, 'specificity': 0.78644645, 'f1': 0.6798214, 'auroc': 0.8769376, 'binary_precision': 0.3179891, 'binary_recall': 0.6935271, 'binary_specificity': 0.87936574, 'binary_f1_score': 0.43604654}
confusion matrix:
      0     1
0  8208  1126
1   232   525
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-07 10:11:05.685805,epoch time: 0:14:50.884235,used: 2:01:58.922312,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9076173, 'precision': 0.90837467, 'recall': 0.9076334, 'specificity': 0.9076334, 'f1': 0.9075768, 'auroc': 0.9680643, 'binary_precision': 0.92614967, 'binary_recall': 0.8860232, 'binary_specificity': 0.9292436, 'binary_f1_score': 0.9056422}
confusion matrix:
       0      1
0  23600   1797
1   2899  22536
---- Validation: 
scalar performance:
{'acc': 0.90025115, 'precision': 0.5608846, 'recall': 0.7273307, 'specificity': 0.7273307, 'f1': 0.5812662, 'auroc': 0.8369153, 'binary_precision': 0.13451631, 'binary_recall': 0.5452436, 'binary_specificity': 0.9094177, 'binary_f1_score': 0.21579431}
confusion matrix:
       0     1
0  15180  1512
1    196   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8643346, 'precision': 0.6503552, 'recall': 0.8089207, 'specificity': 0.8089207, 'f1': 0.68695056, 'auroc': 0.8838829, 'binary_precision': 0.32393557, 'binary_recall': 0.74372524, 'binary_specificity': 0.8741161, 'binary_f1_score': 0.45130262}
confusion matrix:
      0     1
0  8159  1175
1   194   563
early stop counter: 1
val acc:0.9002511501312256, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.865424633026123
after epoch: 9,now: 2024-08-07 10:25:57.815567,epoch time: 0:14:52.129762,used: 2:16:51.052074,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9131846, 'precision': 0.91404265, 'recall': 0.9132026, 'specificity': 0.9132026, 'f1': 0.9131421, 'auroc': 0.97009206, 'binary_precision': 0.9330889, 'binary_recall': 0.89035225, 'binary_specificity': 0.9360529, 'binary_f1_score': 0.9112198}
confusion matrix:
       0      1
0  23772   1624
1   2789  22647
---- Validation: 
scalar performance:
{'acc': 0.89727265, 'precision': 0.56153786, 'recall': 0.7382345, 'specificity': 0.7382345, 'f1': 0.5817961, 'auroc': 0.8402549, 'binary_precision': 0.13516484, 'binary_recall': 0.5707657, 'binary_specificity': 0.9057033, 'binary_f1_score': 0.21856953}
confusion matrix:
       0     1
0  15118  1574
1    185   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86750567, 'precision': 0.6548379, 'recall': 0.81609726, 'specificity': 0.81609726, 'f1': 0.692786, 'auroc': 0.88891196, 'binary_precision': 0.33178654, 'binary_recall': 0.7556143, 'binary_specificity': 0.87658024, 'binary_f1_score': 0.4611044}
confusion matrix:
      0     1
0  8182  1152
1   185   572
new oracle model saved
early stop counter: 2
val acc:0.8972726464271545, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.867505669593811
after epoch: 10,now: 2024-08-07 10:41:16.080601,epoch time: 0:15:18.265034,used: 2:32:09.317108,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9173552, 'precision': 0.9186226, 'recall': 0.917378, 'specificity': 0.917378, 'f1': 0.9172956, 'auroc': 0.9724394, 'binary_precision': 0.9418643, 'binary_recall': 0.8897669, 'binary_specificity': 0.94498914, 'binary_f1_score': 0.91507465}
confusion matrix:
       0      1
0  23998   1397
1   2804  22633
---- Validation: 
scalar performance:
{'acc': 0.90328795, 'precision': 0.5661103, 'recall': 0.7435801, 'specificity': 0.7435801, 'f1': 0.58944243, 'auroc': 0.845461, 'binary_precision': 0.14410226, 'binary_recall': 0.575406, 'binary_specificity': 0.91175413, 'binary_f1_score': 0.23048326}
confusion matrix:
       0     1
0  15219  1473
1    183   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87483895, 'precision': 0.661172, 'recall': 0.8152058, 'specificity': 0.8152058, 'f1': 0.7003891, 'auroc': 0.8913524, 'binary_precision': 0.34516525, 'binary_recall': 0.74504626, 'binary_specificity': 0.8853653, 'binary_f1_score': 0.47176918}
confusion matrix:
      0     1
0  8264  1070
1   193   564
new oracle model saved
early stop counter: 3
val acc:0.903287947177887, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8748389482498169
after epoch: 11,now: 2024-08-07 10:56:38.624167,epoch time: 0:15:22.543566,used: 2:47:31.860674,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9229029, 'precision': 0.9239143, 'recall': 0.9229251, 'specificity': 0.9229251, 'f1': 0.9228595, 'auroc': 0.9750613, 'binary_precision': 0.94484866, 'binary_recall': 0.8983844, 'binary_specificity': 0.94746584, 'binary_f1_score': 0.9210308}
confusion matrix:
       0      1
0  24059   1334
1   2585  22854
---- Validation: 
scalar performance:
{'acc': 0.90217835, 'precision': 0.5655532, 'recall': 0.7441411, 'specificity': 0.7441411, 'f1': 0.5884758, 'auroc': 0.8491678, 'binary_precision': 0.14293915, 'binary_recall': 0.57772624, 'binary_specificity': 0.91055596, 'binary_f1_score': 0.22917627}
confusion matrix:
       0     1
0  15199  1493
1    182   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87711823, 'precision': 0.66441095, 'recall': 0.8194725, 'specificity': 0.8194725, 'f1': 0.70445305, 'auroc': 0.89388055, 'binary_precision': 0.3510179, 'binary_recall': 0.7516512, 'binary_specificity': 0.88729376, 'binary_f1_score': 0.4785534}
confusion matrix:
      0     1
0  8282  1052
1   188   569
new oracle model saved
early stop counter: 4
val acc:0.9021783471107483, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8771182298660278
after epoch: 12,now: 2024-08-07 11:12:00.069807,epoch time: 0:15:21.445640,used: 3:02:53.306314,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92435867, 'precision': 0.9261484, 'recall': 0.924383, 'specificity': 0.924383, 'f1': 0.924282, 'auroc': 0.9763931, 'binary_precision': 0.9539529, 'binary_recall': 0.8918813, 'binary_specificity': 0.9568847, 'binary_f1_score': 0.9218734}
confusion matrix:
       0      1
0  24302   1095
1   2750  22685
---- Validation: 
scalar performance:
{'acc': 0.90772647, 'precision': 0.5682427, 'recall': 0.74020594, 'specificity': 0.74020594, 'f1': 0.5930692, 'auroc': 0.8502889, 'binary_precision': 0.14862385, 'binary_recall': 0.5638051, 'binary_specificity': 0.9166068, 'binary_f1_score': 0.23523718}
confusion matrix:
       0     1
0  15300  1392
1    188   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88227135, 'precision': 0.66986364, 'recall': 0.8204372, 'specificity': 0.8204372, 'f1': 0.7107105, 'auroc': 0.8956287, 'binary_precision': 0.36212412, 'binary_recall': 0.74768823, 'binary_specificity': 0.8931862, 'binary_f1_score': 0.487931}
confusion matrix:
      0    1
0  8337  997
1   191  566
new oracle model saved
early stop counter: 5
val acc:0.9077264666557312, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8822713494300842
after epoch: 13,now: 2024-08-07 11:27:39.371601,epoch time: 0:15:39.301794,used: 3:18:32.608108,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9265817, 'precision': 0.9280324, 'recall': 0.9266046, 'specificity': 0.9266046, 'f1': 0.9265221, 'auroc': 0.97736454, 'binary_precision': 0.9531485, 'binary_recall': 0.89738953, 'binary_specificity': 0.9558198, 'binary_f1_score': 0.924429}
confusion matrix:
       0      1
0  24274   1122
1   2610  22826
---- Validation: 
scalar performance:
{'acc': 0.90071833, 'precision': 0.5663981, 'recall': 0.7524333, 'specificity': 0.7524333, 'f1': 0.5895435, 'auroc': 0.85285294, 'binary_precision': 0.1441391, 'binary_recall': 0.5962877, 'binary_specificity': 0.90857893, 'binary_f1_score': 0.23215899}
confusion matrix:
       0     1
0  15166  1526
1    174   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8800912, 'precision': 0.6684856, 'recall': 0.8241142, 'specificity': 0.8241142, 'f1': 0.7094836, 'auroc': 0.89701414, 'binary_precision': 0.35852593, 'binary_recall': 0.75825626, 'binary_specificity': 0.88997215, 'binary_f1_score': 0.48685324}
confusion matrix:
      0     1
0  8307  1027
1   183   574
early stop counter: 6
val acc:0.9007183313369751, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8822713494300842
after epoch: 14,now: 2024-08-07 11:43:14.440159,epoch time: 0:15:35.068558,used: 3:34:07.676666,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.927703, 'precision': 0.92900956, 'recall': 0.92772484, 'specificity': 0.92772484, 'f1': 0.92765033, 'auroc': 0.9778286, 'binary_precision': 0.9528824, 'binary_recall': 0.9000236, 'binary_specificity': 0.95542604, 'binary_f1_score': 0.92569906}
confusion matrix:
       0      1
0  24264   1132
1   2543  22893
---- Validation: 
scalar performance:
{'acc': 0.8951702, 'precision': 0.56383914, 'recall': 0.75523835, 'specificity': 0.75523835, 'f1': 0.58486867, 'auroc': 0.85450506, 'binary_precision': 0.13877119, 'binary_recall': 0.60788864, 'binary_specificity': 0.90258807, 'binary_f1_score': 0.22595948}
confusion matrix:
       0     1
0  15066  1626
1    169   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786047, 'precision': 0.6675304, 'recall': 0.8263453, 'specificity': 0.8263453, 'f1': 0.708559, 'auroc': 0.89860654, 'binary_precision': 0.35608855, 'binary_recall': 0.7648613, 'binary_specificity': 0.8878294, 'binary_f1_score': 0.4859421}
confusion matrix:
      0     1
0  8287  1047
1   178   579
early stop counter: 7
val acc:0.8951702117919922, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8822713494300842
after epoch: 15,now: 2024-08-07 11:58:11.994464,epoch time: 0:14:57.554305,used: 3:49:05.230971,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9310474, 'precision': 0.9317981, 'recall': 0.9310614, 'specificity': 0.9310614, 'f1': 0.9310189, 'auroc': 0.9792973, 'binary_precision': 0.94997126, 'binary_recall': 0.9101168, 'binary_specificity': 0.952006, 'binary_f1_score': 0.92961705}
confusion matrix:
       0      1
0  24180   1219
1   2286  23147
---- Validation: 
scalar performance:
{'acc': 0.88880455, 'precision': 0.56216407, 'recall': 0.76327467, 'specificity': 0.76327467, 'f1': 0.5811721, 'auroc': 0.8579712, 'binary_precision': 0.13485375, 'binary_recall': 0.63109046, 'binary_specificity': 0.8954589, 'binary_f1_score': 0.22222221}
confusion matrix:
       0     1
0  14947  1745
1    159   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8763254, 'precision': 0.6664791, 'recall': 0.83118266, 'specificity': 0.83118266, 'f1': 0.7076434, 'auroc': 0.8991548, 'binary_precision': 0.35290593, 'binary_recall': 0.77807134, 'binary_specificity': 0.884294, 'binary_f1_score': 0.48557296}
confusion matrix:
      0     1
0  8254  1080
1   168   589
early stop counter: 8
val acc:0.88880455493927, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8822713494300842
after epoch: 16,now: 2024-08-07 12:14:11.154345,epoch time: 0:15:59.159881,used: 4:05:04.390852,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9336835, 'precision': 0.9346179, 'recall': 0.9337019, 'specificity': 0.9337019, 'f1': 0.9336497, 'auroc': 0.97974366, 'binary_precision': 0.9549672, 'binary_recall': 0.9104026, 'binary_specificity': 0.9570011, 'binary_f1_score': 0.93215257}
confusion matrix:
       0      1
0  24304   1092
1   2279  23157
---- Validation: 
scalar performance:
{'acc': 0.8937686, 'precision': 0.5642844, 'recall': 0.76130027, 'specificity': 0.76130027, 'f1': 0.58528143, 'auroc': 0.85765064, 'binary_precision': 0.13929313, 'binary_recall': 0.6218097, 'binary_specificity': 0.9007908, 'binary_f1_score': 0.22760084}
confusion matrix:
       0     1
0  15036  1656
1    163   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8805867, 'precision': 0.6703441, 'recall': 0.8298445, 'specificity': 0.8298445, 'f1': 0.7120604, 'auroc': 0.8995954, 'binary_precision': 0.36121437, 'binary_recall': 0.7701453, 'binary_specificity': 0.8895436, 'binary_f1_score': 0.4917756}
confusion matrix:
      0     1
0  8303  1031
1   174   583
early stop counter: 9
val acc:0.8937686085700989, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8822713494300842
after epoch: 17,now: 2024-08-07 12:29:41.300562,epoch time: 0:15:30.146217,used: 4:20:34.537069,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9334081, 'precision': 0.9345075, 'recall': 0.93342793, 'specificity': 0.93342793, 'f1': 0.93336797, 'auroc': 0.98038805, 'binary_precision': 0.9565613, 'binary_recall': 0.90816164, 'binary_specificity': 0.9586943, 'binary_f1_score': 0.93173337}
confusion matrix:
       0      1
0  24347   1049
1   2336  23100
---- Validation: 
scalar performance:
{'acc': 0.8951702, 'precision': 0.56517255, 'recall': 0.76201916, 'specificity': 0.76201916, 'f1': 0.5868505, 'auroc': 0.8587822, 'binary_precision': 0.14105263, 'binary_recall': 0.6218097, 'binary_specificity': 0.9022286, 'binary_f1_score': 0.22994424}
confusion matrix:
       0     1
0  15060  1632
1    163   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8821722, 'precision': 0.6721718, 'recall': 0.83070153, 'specificity': 0.83070153, 'f1': 0.7142101, 'auroc': 0.89966834, 'binary_precision': 0.36483103, 'binary_recall': 0.7701453, 'binary_specificity': 0.89125776, 'binary_f1_score': 0.49511674}
confusion matrix:
      0     1
0  8319  1015
1   174   583
early stop counter: 10
val acc:0.8951702117919922, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8822713494300842
after epoch: 18,now: 2024-08-07 12:44:51.662685,epoch time: 0:15:10.362123,used: 4:35:44.899192,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9355524, 'precision': 0.93620014, 'recall': 0.9355677, 'specificity': 0.9355677, 'f1': 0.93552995, 'auroc': 0.98086977, 'binary_precision': 0.9532068, 'binary_recall': 0.9161818, 'binary_specificity': 0.95495355, 'binary_f1_score': 0.9343276}
confusion matrix:
       0      1
0  24252   1144
1   2132  23304
---- Validation: 
scalar performance:
{'acc': 0.871109, 'precision': 0.5571567, 'recall': 0.7768012, 'specificity': 0.7768012, 'f1': 0.56954014, 'auroc': 0.8610941, 'binary_precision': 0.12372881, 'binary_recall': 0.6774942, 'binary_specificity': 0.8761083, 'binary_f1_score': 0.209244}
confusion matrix:
       0     1
0  14624  2068
1    139   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8706768, 'precision': 0.66295016, 'recall': 0.83784026, 'specificity': 0.83784026, 'f1': 0.7036234, 'auroc': 0.90084195, 'binary_precision': 0.34414107, 'binary_recall': 0.7992074, 'binary_specificity': 0.8764731, 'binary_f1_score': 0.4811133}
confusion matrix:
      0     1
0  8181  1153
1   152   605
early stop counter: 11
val acc:0.8711090087890625, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8822713494300842
after epoch: 19,now: 2024-08-07 13:00:09.355562,epoch time: 0:15:17.692877,used: 4:51:02.592069,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9351983, 'precision': 0.9364335, 'recall': 0.9352225, 'specificity': 0.9352225, 'f1': 0.9351548, 'auroc': 0.9822129, 'binary_precision': 0.95987874, 'binary_recall': 0.90848696, 'binary_specificity': 0.961958, 'binary_f1_score': 0.93347603}
confusion matrix:
       0      1
0  24427    966
1   2328  23111
---- Validation: 
scalar performance:
{'acc': 0.8963383, 'precision': 0.5661519, 'recall': 0.7637484, 'specificity': 0.7637484, 'f1': 0.5885066, 'auroc': 0.8599473, 'binary_precision': 0.14293306, 'binary_recall': 0.62412995, 'binary_specificity': 0.90336686, 'binary_f1_score': 0.23259836}
confusion matrix:
       0     1
0  15079  1613
1    162   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88326234, 'precision': 0.67316914, 'recall': 0.83007693, 'specificity': 0.83007693, 'f1': 0.7152786, 'auroc': 0.90077454, 'binary_precision': 0.36702463, 'binary_recall': 0.7675033, 'binary_specificity': 0.89265054, 'binary_f1_score': 0.4965812}
confusion matrix:
      0     1
0  8332  1002
1   176   581
new oracle model saved
early stop counter: 12
val acc:0.8963382840156555, best validation acc: 0.9121649265289307, corresponding to test acc:                         0.865424633026123 / 0.8832623362541199
after epoch: 20,now: 2024-08-07 13:15:02.820816,epoch time: 0:14:53.465254,used: 5:05:56.057323,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_08_09_06_seed_1_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:05:56.057323 at 2024-08-07 13:15:02.820816
persisted model performance metric: 

scalar performance:
{'acc': 0.86542463, 'precision': 0.64525044, 'recall': 0.78644645, 'specificity': 0.78644645, 'f1': 0.6798214, 'auroc': 0.8769376, 'binary_precision': 0.3179891, 'binary_recall': 0.6935271, 'binary_specificity': 0.87936574, 'binary_f1_score': 0.43604654}
confusion matrix:
      0     1
0  8208  1126
1   232   525
oracle model performance metric: 

scalar performance:
{'acc': 0.88326234, 'precision': 0.67316914, 'recall': 0.83007693, 'specificity': 0.83007693, 'f1': 0.7152786, 'auroc': 0.90077454, 'binary_precision': 0.36702463, 'binary_recall': 0.7675033, 'binary_specificity': 0.89265054, 'binary_f1_score': 0.4965812}
confusion matrix:
      0     1
0  8332  1002
1   176   581
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |  16648 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    780 MiB | 272384 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     48 MiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  89169 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 384171 GiB | 384171 GiB |
|       from small pool |  10477 KiB |  23714 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6837    |  162967 K  |  162963 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92884 K  |   92879 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6837    |  162967 K  |  162963 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92884 K  |   92879 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      57    |      16    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      24    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3196    |   87553 K  |   87553 K  |
|       from large pool |      10    |      23    |   44070 K  |   44070 K  |
|       from small pool |      20    |    3186    |   43482 K  |   43482 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384171 GiB | 384171 GiB |
|       from small pool |      0 KiB |  24603 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162967 K  |  162967 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162967 K  |  162967 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87555 K  |   87555 K  |
|       from large pool |       3    |      23    |   44070 K  |   44070 K  |
|       from small pool |       0    |    3186    |   43484 K  |   43484 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711033 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711023 GiB | 711023 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 399286 GiB | 399286 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384171 GiB | 384171 GiB |
|       from small pool |      0 KiB |  24603 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162967 K  |  162967 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162967 K  |  162967 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92884 K  |   92884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87555 K  |   87555 K  |
|       from large pool |       3    |      23    |   44070 K  |   44070 K  |
|       from small pool |       0    |    3186    |   43484 K  |   43484 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685

 Experiment start at: 2024-08-07 13:38:37.801038
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.73603374, 'precision': 0.73653185, 'recall': 0.73603725, 'specificity': 0.73603725, 'f1': 0.7358966, 'auroc': 0.8113433, 'binary_precision': 0.7474256, 'binary_recall': 0.7131363, 'binary_specificity': 0.75893825, 'binary_f1_score': 0.7298784}
confusion matrix:
       0      1
0  19614   6230
1   7416  18436
---- Validation: 
scalar performance:
{'acc': 0.5672156, 'precision': 0.5134529, 'recall': 0.63941056, 'specificity': 0.63941056, 'f1': 0.3961119, 'auroc': 0.6835908, 'binary_precision': 0.03938875, 'binary_recall': 0.715311, 'binary_specificity': 0.5635101, 'binary_f1_score': 0.07466599}
confusion matrix:
      0     1
0  9414  7292
1   119   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324019, 'precision': 0.55610657, 'recall': 0.69223917, 'specificity': 0.69223917, 'f1': 0.44694704, 'auroc': 0.7960833, 'binary_precision': 0.13194445, 'binary_recall': 0.8820577, 'binary_specificity': 0.50242066, 'binary_f1_score': 0.22955102}
confusion matrix:
      0     1
0  4670  4625
1    94   703
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 13:55:09.996940,epoch time: 0:16:32.195902,used: 0:16:32.195902,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.82528627, 'precision': 0.8253016, 'recall': 0.8252867, 'specificity': 0.8252867, 'f1': 0.82528436, 'auroc': 0.90340555, 'binary_precision': 0.82756203, 'binary_recall': 0.8218638, 'binary_specificity': 0.8287096, 'binary_f1_score': 0.8247031}
confusion matrix:
       0      1
0  21418   4427
1   4605  21246
---- Validation: 
scalar performance:
{'acc': 0.6440668, 'precision': 0.5193936, 'recall': 0.6892938, 'specificity': 0.6892938, 'f1': 0.43522555, 'auroc': 0.7376106, 'binary_precision': 0.04894327, 'binary_recall': 0.7368421, 'binary_specificity': 0.6417455, 'binary_f1_score': 0.091789596}
confusion matrix:
       0     1
0  10721  5985
1    110   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5855133, 'precision': 0.56481296, 'recall': 0.722219, 'specificity': 0.722219, 'f1': 0.48270863, 'auroc': 0.8164904, 'binary_precision': 0.1469975, 'binary_recall': 0.88456714, 'binary_specificity': 0.5598709, 'binary_f1_score': 0.25210086}
confusion matrix:
      0     1
0  5204  4091
1    92   705
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 14:10:52.926149,epoch time: 0:15:42.929209,used: 0:32:15.125111,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.85542405, 'precision': 0.85566473, 'recall': 0.85542655, 'specificity': 0.85542655, 'f1': 0.85540015, 'auroc': 0.93011713, 'binary_precision': 0.8649668, 'binary_recall': 0.84241676, 'binary_specificity': 0.86843634, 'binary_f1_score': 0.85354286}
confusion matrix:
       0      1
0  22443   3400
1   4074  21779
---- Validation: 
scalar performance:
{'acc': 0.7328311, 'precision': 0.5249142, 'recall': 0.7091291, 'specificity': 0.7091291, 'f1': 0.47696078, 'auroc': 0.76466465, 'binary_precision': 0.0604779, 'binary_recall': 0.68421054, 'binary_specificity': 0.73404765, 'binary_f1_score': 0.11113269}
confusion matrix:
       0     1
0  12263  4443
1    132   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65328974, 'precision': 0.5746472, 'recall': 0.7469682, 'specificity': 0.7469682, 'f1': 0.5263188, 'auroc': 0.8286743, 'binary_precision': 0.16805896, 'binary_recall': 0.8582183, 'binary_specificity': 0.6357181, 'binary_f1_score': 0.2810766}
confusion matrix:
      0     1
0  5909  3386
1   113   684
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 14:26:33.610842,epoch time: 0:15:40.684693,used: 0:47:55.809804,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87273675, 'precision': 0.87355447, 'recall': 0.8727413, 'specificity': 0.8727413, 'f1': 0.872668, 'auroc': 0.9451605, 'binary_precision': 0.89108026, 'binary_recall': 0.8493405, 'binary_specificity': 0.89614207, 'binary_f1_score': 0.86970985}
confusion matrix:
       0      1
0  23159   2684
1   3895  21958
---- Validation: 
scalar performance:
{'acc': 0.7697968, 'precision': 0.52841526, 'recall': 0.71641195, 'specificity': 0.71641195, 'f1': 0.49517202, 'auroc': 0.7839048, 'binary_precision': 0.06771345, 'binary_recall': 0.6602871, 'binary_specificity': 0.7725368, 'binary_f1_score': 0.12283045}
confusion matrix:
       0     1
0  12906  3800
1    142   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69242966, 'precision': 0.5815198, 'recall': 0.75846565, 'specificity': 0.75846565, 'f1': 0.55172825, 'auroc': 0.8393018, 'binary_precision': 0.18319143, 'binary_recall': 0.8368883, 'binary_specificity': 0.68004304, 'binary_f1_score': 0.30058587}
confusion matrix:
      0     1
0  6321  2974
1   130   667
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 14:42:11.142850,epoch time: 0:15:37.532008,used: 1:03:33.341812,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88405293, 'precision': 0.88449514, 'recall': 0.88405555, 'specificity': 0.88405555, 'f1': 0.8840201, 'auroc': 0.9532674, 'binary_precision': 0.8975735, 'binary_recall': 0.86708957, 'binary_specificity': 0.90102154, 'binary_f1_score': 0.8820683}
confusion matrix:
       0      1
0  23286   2558
1   3436  22416
---- Validation: 
scalar performance:
{'acc': 0.7841626, 'precision': 0.53098744, 'recall': 0.72610706, 'specificity': 0.72610706, 'f1': 0.5037728, 'auroc': 0.7981322, 'binary_precision': 0.07250913, 'binary_recall': 0.6650718, 'binary_specificity': 0.78714234, 'binary_f1_score': 0.13076201}
confusion matrix:
       0     1
0  13150  3556
1    140   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71541816, 'precision': 0.5881031, 'recall': 0.7709455, 'specificity': 0.7709455, 'f1': 0.5687094, 'auroc': 0.8488459, 'binary_precision': 0.19565855, 'binary_recall': 0.8368883, 'binary_specificity': 0.70500267, 'binary_f1_score': 0.31716597}
confusion matrix:
      0     1
0  6553  2742
1   130   667
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 14:57:27.154669,epoch time: 0:15:16.011819,used: 1:18:49.353631,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.895195, 'precision': 0.8957833, 'recall': 0.895198, 'specificity': 0.895198, 'f1': 0.8951566, 'auroc': 0.959028, 'binary_precision': 0.9110807, 'binary_recall': 0.87590903, 'binary_specificity': 0.91448694, 'binary_f1_score': 0.8931488}
confusion matrix:
       0      1
0  23634   2210
1   3208  22644
---- Validation: 
scalar performance:
{'acc': 0.8074048, 'precision': 0.53454965, 'recall': 0.73218775, 'specificity': 0.73218775, 'f1': 0.5167835, 'auroc': 0.808733, 'binary_precision': 0.079684764, 'binary_recall': 0.65311, 'binary_specificity': 0.8112654, 'binary_f1_score': 0.14203955}
confusion matrix:
       0     1
0  13553  3153
1    145   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7424693, 'precision': 0.5936068, 'recall': 0.77358603, 'specificity': 0.77358603, 'f1': 0.586266, 'auroc': 0.8553133, 'binary_precision': 0.20879121, 'binary_recall': 0.81053954, 'binary_specificity': 0.7366326, 'binary_f1_score': 0.33204833}
confusion matrix:
      0     1
0  6847  2448
1   151   646
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 15:13:04.305737,epoch time: 0:15:37.151068,used: 1:34:26.504699,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8998762, 'precision': 0.9004724, 'recall': 0.8998814, 'specificity': 0.8998814, 'f1': 0.89983976, 'auroc': 0.9621283, 'binary_precision': 0.91599274, 'binary_recall': 0.8805647, 'binary_specificity': 0.91919816, 'binary_f1_score': 0.8979294}
confusion matrix:
       0      1
0  23753   2088
1   3088  22767
---- Validation: 
scalar performance:
{'acc': 0.8079304, 'precision': 0.5352916, 'recall': 0.73712206, 'specificity': 0.73712206, 'f1': 0.5179926, 'auroc': 0.8174997, 'binary_precision': 0.08087591, 'binary_recall': 0.66267943, 'binary_specificity': 0.8115647, 'binary_f1_score': 0.1441582}
confusion matrix:
       0     1
0  13558  3148
1    141   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75099087, 'precision': 0.5975334, 'recall': 0.78108, 'specificity': 0.78108, 'f1': 0.59388125, 'auroc': 0.8618809, 'binary_precision': 0.21570577, 'binary_recall': 0.81681305, 'binary_specificity': 0.74534696, 'binary_f1_score': 0.3412844}
confusion matrix:
      0     1
0  6928  2367
1   146   651
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-07 15:28:46.733723,epoch time: 0:15:42.427986,used: 1:50:08.932685,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90550524, 'precision': 0.90696913, 'recall': 0.90550756, 'specificity': 0.90550756, 'f1': 0.90542054, 'auroc': 0.9664705, 'binary_precision': 0.93139637, 'binary_recall': 0.8755126, 'binary_specificity': 0.9355026, 'binary_f1_score': 0.9025903}
confusion matrix:
       0      1
0  24179   1667
1   3218  22632
---- Validation: 
scalar performance:
{'acc': 0.8361364, 'precision': 0.54072, 'recall': 0.742248, 'specificity': 0.742248, 'f1': 0.53504395, 'auroc': 0.8235303, 'binary_precision': 0.09193438, 'binary_recall': 0.6435407, 'binary_specificity': 0.8409553, 'binary_f1_score': 0.16088517}
confusion matrix:
       0     1
0  14049  2657
1    149   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7849782, 'precision': 0.60957944, 'recall': 0.7915009, 'specificity': 0.7915009, 'f1': 0.62014455, 'auroc': 0.8650979, 'binary_precision': 0.24064979, 'binary_recall': 0.7992472, 'binary_specificity': 0.7837547, 'binary_f1_score': 0.3699187}
confusion matrix:
      0     1
0  7285  2010
1   160   637
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-07 15:44:35.130280,epoch time: 0:15:48.396557,used: 2:05:57.329242,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9099737, 'precision': 0.9103712, 'recall': 0.9099761, 'specificity': 0.9099761, 'f1': 0.9099522, 'auroc': 0.96879554, 'binary_precision': 0.92318135, 'binary_recall': 0.89439887, 'binary_specificity': 0.9255533, 'binary_f1_score': 0.90856224}
confusion matrix:
       0      1
0  23920   1924
1   2730  23122
---- Validation: 
scalar performance:
{'acc': 0.8243401, 'precision': 0.53950673, 'recall': 0.74903095, 'specificity': 0.74903095, 'f1': 0.52945316, 'auroc': 0.83154, 'binary_precision': 0.08888889, 'binary_recall': 0.6698565, 'binary_specificity': 0.8282054, 'binary_f1_score': 0.15695068}
confusion matrix:
       0     1
0  13836  2870
1    138   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7819065, 'precision': 0.61024374, 'recall': 0.7972896, 'specificity': 0.7972896, 'f1': 0.6196959, 'auroc': 0.8698237, 'binary_precision': 0.24038461, 'binary_recall': 0.8155583, 'binary_specificity': 0.77902097, 'binary_f1_score': 0.37132248}
confusion matrix:
      0     1
0  7241  2054
1   147   650
early stop counter: 1
val acc:0.8243401050567627, best validation acc: 0.8361364006996155, corresponding to test acc:                         0.7849782109260559 / 0.7849782109260559
after epoch: 9,now: 2024-08-07 16:00:23.751038,epoch time: 0:15:48.620758,used: 2:21:45.950000,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9131074, 'precision': 0.91448545, 'recall': 0.91311187, 'specificity': 0.91311187, 'f1': 0.91303575, 'auroc': 0.97010064, 'binary_precision': 0.93842363, 'binary_recall': 0.8842643, 'binary_specificity': 0.94195944, 'binary_f1_score': 0.9105393}
confusion matrix:
       0      1
0  24344   1500
1   2992  22860
---- Validation: 
scalar performance:
{'acc': 0.8471736, 'precision': 0.54504424, 'recall': 0.7549021, 'specificity': 0.7549021, 'f1': 0.5447333, 'auroc': 0.835947, 'binary_precision': 0.100036375, 'binary_recall': 0.65789473, 'binary_specificity': 0.8519095, 'binary_f1_score': 0.17366594}
confusion matrix:
       0     1
0  14232  2474
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8003369, 'precision': 0.61566556, 'recall': 0.79410315, 'specificity': 0.79410315, 'f1': 0.6322392, 'auroc': 0.8715074, 'binary_precision': 0.25364077, 'binary_recall': 0.7867001, 'binary_specificity': 0.80150616, 'binary_f1_score': 0.38360354}
confusion matrix:
      0     1
0  7450  1845
1   170   627
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-07 16:16:04.134465,epoch time: 0:15:40.383427,used: 2:37:26.333427,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91997445, 'precision': 0.92064834, 'recall': 0.9199791, 'specificity': 0.9199791, 'f1': 0.919943, 'auroc': 0.9742392, 'binary_precision': 0.9375428, 'binary_recall': 0.8999381, 'binary_specificity': 0.94002014, 'binary_f1_score': 0.9183557}
confusion matrix:
       0      1
0  24292   1550
1   2587  23267
---- Validation: 
scalar performance:
{'acc': 0.84273535, 'precision': 0.5450805, 'recall': 0.7619574, 'specificity': 0.7619574, 'f1': 0.54338557, 'auroc': 0.83897066, 'binary_precision': 0.09961281, 'binary_recall': 0.6770335, 'binary_specificity': 0.8468814, 'binary_f1_score': 0.1736729}
confusion matrix:
       0     1
0  14148  2558
1    135   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8005351, 'precision': 0.6175491, 'recall': 0.80051994, 'specificity': 0.80051994, 'f1': 0.63440615, 'auroc': 0.8726219, 'binary_precision': 0.25601926, 'binary_recall': 0.8005019, 'binary_specificity': 0.80053794, 'binary_f1_score': 0.38795987}
confusion matrix:
      0     1
0  7441  1854
1   159   638
new oracle model saved
early stop counter: 1
val acc:0.8427353501319885, best validation acc: 0.8471735715866089, corresponding to test acc:                         0.8003368973731995 / 0.8005350828170776
after epoch: 11,now: 2024-08-07 16:31:21.390346,epoch time: 0:15:17.255881,used: 2:52:43.589308,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9210964, 'precision': 0.9223664, 'recall': 0.9211006, 'specificity': 0.9211006, 'f1': 0.92103755, 'auroc': 0.97492504, 'binary_precision': 0.9455654, 'binary_recall': 0.89366394, 'binary_specificity': 0.94853735, 'binary_f1_score': 0.91888237}
confusion matrix:
       0      1
0  24514   1330
1   2749  23103
---- Validation: 
scalar performance:
{'acc': 0.8549404, 'precision': 0.54818606, 'recall': 0.76238143, 'specificity': 0.76238143, 'f1': 0.55164987, 'auroc': 0.8429917, 'binary_precision': 0.106025934, 'binary_recall': 0.6650718, 'binary_specificity': 0.85969114, 'binary_f1_score': 0.18289474}
confusion matrix:
       0     1
0  14362  2344
1    140   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81629014, 'precision': 0.6242497, 'recall': 0.80104303, 'specificity': 0.80104303, 'f1': 0.6468929, 'auroc': 0.8742236, 'binary_precision': 0.27071583, 'binary_recall': 0.78293604, 'binary_specificity': 0.8191501, 'binary_f1_score': 0.4023211}
confusion matrix:
      0     1
0  7614  1681
1   173   624
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-07 16:48:25.505335,epoch time: 0:17:04.114989,used: 3:09:47.704297,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92463636, 'precision': 0.9254259, 'recall': 0.9246414, 'specificity': 0.9246414, 'f1': 0.9246019, 'auroc': 0.975646, 'binary_precision': 0.9438111, 'binary_recall': 0.9030711, 'binary_specificity': 0.9462116, 'binary_f1_score': 0.92299175}
confusion matrix:
       0      1
0  24452   1390
1   2506  23348
---- Validation: 
scalar performance:
{'acc': 0.845772, 'precision': 0.54708546, 'recall': 0.7705112, 'specificity': 0.7705112, 'f1': 0.5472225, 'auroc': 0.8471967, 'binary_precision': 0.103177436, 'binary_recall': 0.69138753, 'binary_specificity': 0.8496349, 'binary_f1_score': 0.17955886}
confusion matrix:
       0     1
0  14194  2512
1    129   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8136147, 'precision': 0.6253649, 'recall': 0.8093412, 'specificity': 0.8093412, 'f1': 0.64740044, 'auroc': 0.8768772, 'binary_precision': 0.27092138, 'binary_recall': 0.804266, 'binary_specificity': 0.81441635, 'binary_f1_score': 0.4053114}
confusion matrix:
      0     1
0  7570  1725
1   156   641
early stop counter: 1
val acc:0.8457720279693604, best validation acc: 0.8549404144287109, corresponding to test acc:                         0.8162901401519775 / 0.8162901401519775
after epoch: 13,now: 2024-08-07 17:04:05.504769,epoch time: 0:15:39.999434,used: 3:25:27.703731,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92676413, 'precision': 0.9275005, 'recall': 0.9267666, 'specificity': 0.9267666, 'f1': 0.9267329, 'auroc': 0.97678214, 'binary_precision': 0.94527185, 'binary_recall': 0.9059998, 'binary_specificity': 0.94753337, 'binary_f1_score': 0.9252193}
confusion matrix:
       0      1
0  24489   1356
1   2430  23421
---- Validation: 
scalar performance:
{'acc': 0.8502686, 'precision': 0.54856783, 'recall': 0.77281576, 'specificity': 0.77281576, 'f1': 0.55076575, 'auroc': 0.84982646, 'binary_precision': 0.10609398, 'binary_recall': 0.69138753, 'binary_specificity': 0.854244, 'binary_f1_score': 0.18395925}
confusion matrix:
       0     1
0  14271  2435
1    129   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81886643, 'precision': 0.6282213, 'recall': 0.81104505, 'specificity': 0.81104505, 'f1': 0.65221167, 'auroc': 0.87789893, 'binary_precision': 0.27674317, 'binary_recall': 0.80175656, 'binary_specificity': 0.82033354, 'binary_f1_score': 0.41146165}
confusion matrix:
      0     1
0  7625  1670
1   158   639
new oracle model saved
early stop counter: 2
val acc:0.8502686023712158, best validation acc: 0.8549404144287109, corresponding to test acc:                         0.8162901401519775 / 0.8188664317131042
after epoch: 14,now: 2024-08-07 17:19:50.207685,epoch time: 0:15:44.702916,used: 3:41:12.406647,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92910475, 'precision': 0.92985207, 'recall': 0.9291072, 'specificity': 0.9291072, 'f1': 0.92907417, 'auroc': 0.97871715, 'binary_precision': 0.947804, 'binary_recall': 0.9082434, 'binary_specificity': 0.94997096, 'binary_f1_score': 0.9276021}
confusion matrix:
       0      1
0  24552   1293
1   2372  23479
---- Validation: 
scalar performance:
{'acc': 0.8482247, 'precision': 0.54859215, 'recall': 0.7764332, 'specificity': 0.7764332, 'f1': 0.5501594, 'auroc': 0.8517128, 'binary_precision': 0.105890855, 'binary_recall': 0.70095694, 'binary_specificity': 0.8519095, 'binary_f1_score': 0.18398742}
confusion matrix:
       0     1
0  14232  2474
1    125   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81975824, 'precision': 0.62893254, 'recall': 0.81210274, 'specificity': 0.81210274, 'f1': 0.6532844, 'auroc': 0.8790099, 'binary_precision': 0.2780191, 'binary_recall': 0.8030113, 'binary_specificity': 0.8211942, 'binary_f1_score': 0.41303647}
confusion matrix:
      0     1
0  7633  1662
1   157   640
new oracle model saved
early stop counter: 3
val acc:0.8482246994972229, best validation acc: 0.8549404144287109, corresponding to test acc:                         0.8162901401519775 / 0.8197582364082336
after epoch: 15,now: 2024-08-07 17:35:21.337969,epoch time: 0:15:31.130284,used: 3:56:43.536931,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.927596, 'precision': 0.9285805, 'recall': 0.9276006, 'specificity': 0.9276006, 'f1': 0.92755485, 'auroc': 0.9784, 'binary_precision': 0.9491711, 'binary_recall': 0.90360886, 'binary_specificity': 0.9515923, 'binary_f1_score': 0.92582977}
confusion matrix:
       0      1
0  24592   1251
1   2492  23361
---- Validation: 
scalar performance:
{'acc': 0.852079, 'precision': 0.54990584, 'recall': 0.7784085, 'specificity': 0.7784085, 'f1': 0.55325484, 'auroc': 0.85385346, 'binary_precision': 0.108478345, 'binary_recall': 0.70095694, 'binary_specificity': 0.8558602, 'binary_f1_score': 0.18788074}
confusion matrix:
       0     1
0  14298  2408
1    125   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82540625, 'precision': 0.6320638, 'recall': 0.81344825, 'specificity': 0.81344825, 'f1': 0.65843934, 'auroc': 0.87997204, 'binary_precision': 0.284502, 'binary_recall': 0.7992472, 'binary_specificity': 0.8276493, 'binary_f1_score': 0.4196311}
confusion matrix:
      0     1
0  7693  1602
1   160   637
new oracle model saved
early stop counter: 4
val acc:0.8520789742469788, best validation acc: 0.8549404144287109, corresponding to test acc:                         0.8162901401519775 / 0.8254062533378601
after epoch: 16,now: 2024-08-07 17:50:33.157970,epoch time: 0:15:11.820001,used: 4:11:55.356932,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9303815, 'precision': 0.9315643, 'recall': 0.9303906, 'specificity': 0.9303906, 'f1': 0.9303347, 'auroc': 0.98003244, 'binary_precision': 0.9542449, 'binary_recall': 0.9041652, 'binary_specificity': 0.956616, 'binary_f1_score': 0.9285303}
confusion matrix:
       0      1
0  24718   1121
1   2478  23379
---- Validation: 
scalar performance:
{'acc': 0.8585611, 'precision': 0.55208015, 'recall': 0.7805644, 'specificity': 0.7805644, 'f1': 0.55837715, 'auroc': 0.856043, 'binary_precision': 0.11282844, 'binary_recall': 0.6985646, 'binary_specificity': 0.8625643, 'binary_f1_score': 0.19427812}
confusion matrix:
       0     1
0  14410  2296
1    126   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8324415, 'precision': 0.63587713, 'recall': 0.8138261, 'specificity': 0.8138261, 'f1': 0.6646125, 'auroc': 0.8807996, 'binary_precision': 0.29267162, 'binary_recall': 0.79171896, 'binary_specificity': 0.83593327, 'binary_f1_score': 0.427362}
confusion matrix:
      0     1
0  7770  1525
1   166   631
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-08-07 18:06:09.931916,epoch time: 0:15:36.773946,used: 4:27:32.130878,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93206435, 'precision': 0.9332216, 'recall': 0.9320694, 'specificity': 0.9320694, 'f1': 0.93201953, 'auroc': 0.980447, 'binary_precision': 0.9556598, 'binary_recall': 0.90620047, 'binary_specificity': 0.9579383, 'binary_f1_score': 0.93027323}
confusion matrix:
       0      1
0  24756   1087
1   2425  23428
---- Validation: 
scalar performance:
{'acc': 0.8601378, 'precision': 0.5524984, 'recall': 0.7802063, 'specificity': 0.7802063, 'f1': 0.55945516, 'auroc': 0.8576404, 'binary_precision': 0.1137163, 'binary_recall': 0.69617224, 'binary_specificity': 0.8642404, 'binary_f1_score': 0.19549882}
confusion matrix:
       0     1
0  14438  2268
1    127   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83452237, 'precision': 0.6373441, 'recall': 0.8149558, 'specificity': 0.8149558, 'f1': 0.6668113, 'auroc': 0.8810024, 'binary_precision': 0.29555035, 'binary_recall': 0.79171896, 'binary_specificity': 0.8381926, 'binary_f1_score': 0.43042293}
confusion matrix:
      0     1
0  7791  1504
1   166   631
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-08-07 18:21:49.571888,epoch time: 0:15:39.639972,used: 4:43:11.770850,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9349853, 'precision': 0.935667, 'recall': 0.9349899, 'specificity': 0.9349899, 'f1': 0.93496037, 'auroc': 0.9806708, 'binary_precision': 0.9529582, 'binary_recall': 0.9151775, 'binary_specificity': 0.9548023, 'binary_f1_score': 0.93368584}
confusion matrix:
       0      1
0  24674   1168
1   2193  23661
---- Validation: 
scalar performance:
{'acc': 0.84939265, 'precision': 0.54986805, 'recall': 0.782863, 'specificity': 0.782863, 'f1': 0.5523592, 'auroc': 0.8604396, 'binary_precision': 0.1080885, 'binary_recall': 0.71291864, 'binary_specificity': 0.8528074, 'binary_f1_score': 0.18771654}
confusion matrix:
       0     1
0  14247  2459
1    120   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82718986, 'precision': 0.63355356, 'recall': 0.81556356, 'specificity': 0.81556356, 'f1': 0.66063946, 'auroc': 0.88245547, 'binary_precision': 0.287191, 'binary_recall': 0.80175656, 'binary_specificity': 0.8293706, 'binary_f1_score': 0.42289874}
confusion matrix:
      0     1
0  7709  1586
1   158   639
early stop counter: 1
val acc:0.8493926525115967, best validation acc: 0.8601378202438354, corresponding to test acc:                         0.8345223665237427 / 0.8345223665237427
after epoch: 19,now: 2024-08-07 18:37:28.911182,epoch time: 0:15:39.339294,used: 4:58:51.110144,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.93455976, 'precision': 0.93543565, 'recall': 0.93456316, 'specificity': 0.93456316, 'f1': 0.93452716, 'auroc': 0.9817611, 'binary_precision': 0.95500386, 'binary_recall': 0.9121151, 'binary_specificity': 0.9570113, 'binary_f1_score': 0.9330669}
confusion matrix:
       0      1
0  24733   1111
1   2272  23580
---- Validation: 
scalar performance:
{'acc': 0.8613058, 'precision': 0.5535076, 'recall': 0.78430367, 'specificity': 0.78430367, 'f1': 0.56126624, 'auroc': 0.8617956, 'binary_precision': 0.11552063, 'binary_recall': 0.7033493, 'binary_specificity': 0.865258, 'binary_f1_score': 0.19844751}
confusion matrix:
       0     1
0  14455  2251
1    124   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8351169, 'precision': 0.63776845, 'recall': 0.81527853, 'specificity': 0.81527853, 'f1': 0.6674433, 'auroc': 0.88131434, 'binary_precision': 0.2963833, 'binary_recall': 0.79171896, 'binary_specificity': 0.8388381, 'binary_f1_score': 0.43130556}
confusion matrix:
      0     1
0  7797  1498
1   166   631
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-08-07 18:52:57.112823,epoch time: 0:15:28.201641,used: 5:14:19.311785,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_13_38_37_seed_2_24076685
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 5:14:19.311785 at 2024-08-07 18:52:57.112823
persisted model performance metric: 

scalar performance:
{'acc': 0.8351169, 'precision': 0.63776845, 'recall': 0.81527853, 'specificity': 0.81527853, 'f1': 0.6674433, 'auroc': 0.88131434, 'binary_precision': 0.2963833, 'binary_recall': 0.79171896, 'binary_specificity': 0.8388381, 'binary_f1_score': 0.43130556}
confusion matrix:
      0     1
0  7797  1498
1   166   631
oracle model performance metric: 

scalar performance:
{'acc': 0.8351169, 'precision': 0.63776845, 'recall': 0.81527853, 'specificity': 0.81527853, 'f1': 0.6674433, 'auroc': 0.88131434, 'binary_precision': 0.2963833, 'binary_recall': 0.79171896, 'binary_specificity': 0.8388381, 'binary_f1_score': 0.43130556}
confusion matrix:
      0     1
0  7797  1498
1   166   631
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  16648 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1066 MiB | 565248 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     58 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  89169 KiB | 611402 GiB | 611402 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 588393 GiB | 588393 GiB |
|       from small pool |  10477 KiB |  24603 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6945    |  246584 K  |  246580 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140323 K  |  140319 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6945    |  246584 K  |  246580 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140323 K  |  140319 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      74    |      33    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3250    |  133398 K  |  133397 K  |
|       from large pool |      10    |      23    |   64619 K  |   64619 K  |
|       from small pool |      21    |    3240    |   68778 K  |   68778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |   1066 MiB |    838 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  28672 KiB |  43008 KiB |     58 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 611402 GiB | 611402 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 588393 GiB | 588393 GiB |
|       from small pool |      0 KiB |  24603 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6945    |  246584 K  |  246584 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140323 K  |  140323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6945    |  246584 K  |  246584 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140323 K  |  140323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      74    |      50    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      14    |      21    |      29    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3250    |  133399 K  |  133399 K  |
|       from large pool |       3    |      23    |   64619 K  |   64619 K  |
|       from small pool |       0    |    3240    |   68780 K  |   68780 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 19:10:06 2024]
Finished job 0.
1 of 1 steps (100%) done
