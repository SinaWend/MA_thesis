Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug  6 22:13:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/17.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=17
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682

 Experiment start at: 2024-08-06 22:23:08.416519
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7283046, 'precision': 0.72878003, 'recall': 0.7283207, 'specificity': 0.7283207, 'f1': 0.7281724, 'auroc': 0.7918371, 'binary_precision': 0.73938745, 'binary_recall': 0.7057524, 'binary_specificity': 0.750889, 'binary_f1_score': 0.7221784}
confusion matrix:
       0      1
0  19005   6305
1   7458  17888
---- Validation: 
scalar performance:
{'acc': 0.76694274, 'precision': 0.52198607, 'recall': 0.6679178, 'specificity': 0.6679178, 'f1': 0.48543534, 'auroc': 0.7560791, 'binary_precision': 0.05779205, 'binary_recall': 0.5638554, 'binary_specificity': 0.77198017, 'binary_f1_score': 0.10483871}
confusion matrix:
       0     1
0  12916  3815
1    181   234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6325885, 'precision': 0.55353165, 'recall': 0.682878, 'specificity': 0.682878, 'f1': 0.49693638, 'auroc': 0.73137003, 'binary_precision': 0.1400978, 'binary_recall': 0.742228, 'binary_specificity': 0.6235281, 'binary_f1_score': 0.23570547}
confusion matrix:
      0     1
0  5825  3517
1   199   573
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-06 22:36:10.737017,epoch time: 0:13:02.320498,used: 0:13:02.320498,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.82385105, 'precision': 0.82387686, 'recall': 0.82384837, 'specificity': 0.82384837, 'f1': 0.8238467, 'auroc': 0.9010904, 'binary_precision': 0.8211296, 'binary_recall': 0.82835495, 'binary_specificity': 0.81934184, 'binary_f1_score': 0.82472646}
confusion matrix:
       0      1
0  20740   4573
1   4350  20993
---- Validation: 
scalar performance:
{'acc': 0.80432755, 'precision': 0.5293566, 'recall': 0.6988232, 'specificity': 0.6988232, 'f1': 0.50839996, 'auroc': 0.7764126, 'binary_precision': 0.07117853, 'binary_recall': 0.5879518, 'binary_specificity': 0.8096946, 'binary_f1_score': 0.12698413}
confusion matrix:
       0     1
0  13547  3184
1    171   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.668776, 'precision': 0.56977886, 'recall': 0.73276854, 'specificity': 0.73276854, 'f1': 0.5285455, 'auroc': 0.8031175, 'binary_precision': 0.16309461, 'binary_recall': 0.8082902, 'binary_specificity': 0.6572468, 'binary_f1_score': 0.27142236}
confusion matrix:
      0     1
0  6140  3202
1   148   624
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-06 22:48:15.638184,epoch time: 0:12:04.901167,used: 0:25:07.221665,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.85561436, 'precision': 0.85563105, 'recall': 0.8556162, 'specificity': 0.8556162, 'f1': 0.8556131, 'auroc': 0.9310633, 'binary_precision': 0.85821015, 'binary_recall': 0.85218215, 'binary_specificity': 0.85905033, 'binary_f1_score': 0.85518557}
confusion matrix:
       0      1
0  21746   3568
1   3746  21596
---- Validation: 
scalar performance:
{'acc': 0.84171236, 'precision': 0.535806, 'recall': 0.705055, 'specificity': 0.705055, 'f1': 0.52965385, 'auroc': 0.7856734, 'binary_precision': 0.08426763, 'binary_recall': 0.5614458, 'binary_specificity': 0.84866416, 'binary_f1_score': 0.14654088}
confusion matrix:
       0     1
0  14199  2532
1    182   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71831125, 'precision': 0.5839195, 'recall': 0.7631477, 'specificity': 0.7631477, 'f1': 0.564948, 'auroc': 0.8330718, 'binary_precision': 0.18879233, 'binary_recall': 0.81606215, 'binary_specificity': 0.71023333, 'binary_f1_score': 0.30664396}
confusion matrix:
      0     1
0  6635  2707
1   142   630
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-06 23:00:19.340847,epoch time: 0:12:03.702663,used: 0:37:10.924328,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87353915, 'precision': 0.8738661, 'recall': 0.8735479, 'specificity': 0.8735479, 'f1': 0.87351334, 'auroc': 0.94609094, 'binary_precision': 0.88507056, 'binary_recall': 0.8587381, 'binary_specificity': 0.88835776, 'binary_f1_score': 0.87170553}
confusion matrix:
       0      1
0  22487   2826
1   3580  21763
---- Validation: 
scalar performance:
{'acc': 0.85734284, 'precision': 0.5414216, 'recall': 0.7189387, 'specificity': 0.7189387, 'f1': 0.54246473, 'auroc': 0.7943163, 'binary_precision': 0.09493419, 'binary_recall': 0.57349396, 'binary_specificity': 0.86438346, 'binary_f1_score': 0.16290213}
confusion matrix:
       0     1
0  14462  2269
1    177   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7498517, 'precision': 0.5933816, 'recall': 0.7766563, 'specificity': 0.7766563, 'f1': 0.588267, 'auroc': 0.8493676, 'binary_precision': 0.20758483, 'binary_recall': 0.8082902, 'binary_specificity': 0.7450225, 'binary_f1_score': 0.3303335}
confusion matrix:
      0     1
0  6960  2382
1   148   624
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-06 23:12:28.064280,epoch time: 0:12:08.723433,used: 0:49:19.647761,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8852851, 'precision': 0.8862078, 'recall': 0.8852986, 'specificity': 0.8852986, 'f1': 0.88521904, 'auroc': 0.95465446, 'binary_precision': 0.90522426, 'binary_recall': 0.8608239, 'binary_specificity': 0.90977323, 'binary_f1_score': 0.88246596}
confusion matrix:
       0      1
0  23030   2284
1   3527  21815
---- Validation: 
scalar performance:
{'acc': 0.8666744, 'precision': 0.5441132, 'recall': 0.7201955, 'specificity': 0.7201955, 'f1': 0.5490242, 'auroc': 0.8001203, 'binary_precision': 0.10038445, 'binary_recall': 0.56626505, 'binary_specificity': 0.8741259, 'binary_f1_score': 0.170537}
confusion matrix:
       0     1
0  14625  2106
1    180   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77407557, 'precision': 0.6022797, 'recall': 0.78739256, 'specificity': 0.78739256, 'f1': 0.60748565, 'auroc': 0.85910046, 'binary_precision': 0.22520886, 'binary_recall': 0.8031088, 'binary_specificity': 0.7716763, 'binary_f1_score': 0.35177305}
confusion matrix:
      0     1
0  7209  2133
1   152   620
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-06 23:25:18.531314,epoch time: 0:12:50.467034,used: 1:02:10.114795,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.89478046, 'precision': 0.895434, 'recall': 0.8947941, 'specificity': 0.8947941, 'f1': 0.8947393, 'auroc': 0.9594859, 'binary_precision': 0.9116788, 'binary_recall': 0.8744131, 'binary_specificity': 0.9151752, 'binary_f1_score': 0.8926572}
confusion matrix:
       0      1
0  23164   2147
1   3183  22162
---- Validation: 
scalar performance:
{'acc': 0.8591508, 'precision': 0.5439798, 'recall': 0.7316145, 'specificity': 0.7316145, 'f1': 0.5467154, 'auroc': 0.8082286, 'binary_precision': 0.099358976, 'binary_recall': 0.5975904, 'binary_specificity': 0.8656386, 'binary_f1_score': 0.17038818}
confusion matrix:
       0     1
0  14483  2248
1    167   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775262, 'precision': 0.60426927, 'recall': 0.79338217, 'specificity': 0.79338217, 'f1': 0.6100704, 'auroc': 0.8681358, 'binary_precision': 0.22798115, 'binary_recall': 0.8147668, 'binary_specificity': 0.77199745, 'binary_f1_score': 0.35627303}
confusion matrix:
      0     1
0  7212  2130
1   143   629
new oracle model saved
early stop counter: 1
val acc:0.8591508269309998, best validation acc: 0.8666744232177734, corresponding to test acc:                         0.7740755677223206 / 0.7752619981765747
after epoch: 6,now: 2024-08-06 23:37:30.651454,epoch time: 0:12:12.120140,used: 1:14:22.234935,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90103835, 'precision': 0.9014381, 'recall': 0.90104777, 'specificity': 0.90104777, 'f1': 0.9010152, 'auroc': 0.9631349, 'binary_precision': 0.91425544, 'binary_recall': 0.88521487, 'binary_specificity': 0.91688067, 'binary_f1_score': 0.89950085}
confusion matrix:
       0      1
0  23209   2104
1   2909  22434
---- Validation: 
scalar performance:
{'acc': 0.85640967, 'precision': 0.5451379, 'recall': 0.7431342, 'specificity': 0.7431342, 'f1': 0.5475988, 'auroc': 0.8137673, 'binary_precision': 0.10097466, 'binary_recall': 0.6240964, 'binary_specificity': 0.862172, 'binary_f1_score': 0.1738255}
confusion matrix:
       0     1
0  14425  2306
1    156   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78158987, 'precision': 0.60852915, 'recall': 0.8021549, 'specificity': 0.8021549, 'f1': 0.61710244, 'auroc': 0.87497246, 'binary_precision': 0.23516403, 'binary_recall': 0.8264249, 'binary_specificity': 0.77788484, 'binary_f1_score': 0.36614063}
confusion matrix:
      0     1
0  7267  2075
1   134   638
new oracle model saved
early stop counter: 2
val acc:0.8564096689224243, best validation acc: 0.8666744232177734, corresponding to test acc:                         0.7740755677223206 / 0.7815898656845093
after epoch: 7,now: 2024-08-06 23:50:22.377635,epoch time: 0:12:51.726181,used: 1:27:13.961116,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.908994, 'precision': 0.90957034, 'recall': 0.90900517, 'specificity': 0.90900517, 'f1': 0.90896356, 'auroc': 0.96691525, 'binary_precision': 0.92508304, 'binary_recall': 0.89018667, 'binary_specificity': 0.92782366, 'binary_f1_score': 0.9072994}
confusion matrix:
       0      1
0  23486   1827
1   2783  22560
---- Validation: 
scalar performance:
{'acc': 0.86480814, 'precision': 0.5474088, 'recall': 0.7427379, 'specificity': 0.7427379, 'f1': 0.553334, 'auroc': 0.8175971, 'binary_precision': 0.10567758, 'binary_recall': 0.61445785, 'binary_specificity': 0.8710179, 'binary_f1_score': 0.18033946}
confusion matrix:
       0     1
0  14573  2158
1    160   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976073, 'precision': 0.61570436, 'recall': 0.80904293, 'specificity': 0.80904293, 'f1': 0.6309153, 'auroc': 0.87771094, 'binary_precision': 0.24950884, 'binary_recall': 0.82253885, 'binary_specificity': 0.795547, 'binary_f1_score': 0.38287607}
confusion matrix:
      0     1
0  7432  1910
1   137   635
new oracle model saved
early stop counter: 3
val acc:0.8648081421852112, best validation acc: 0.8666744232177734, corresponding to test acc:                         0.7740755677223206 / 0.7976073026657104
after epoch: 8,now: 2024-08-07 00:02:47.534735,epoch time: 0:12:25.157100,used: 1:39:39.118216,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9126263, 'precision': 0.9137029, 'recall': 0.9126415, 'specificity': 0.9126415, 'f1': 0.91257155, 'auroc': 0.97005343, 'binary_precision': 0.9349553, 'binary_recall': 0.8870694, 'binary_specificity': 0.9382136, 'binary_f1_score': 0.9103831}
confusion matrix:
       0      1
0  23749   1564
1   2862  22481
---- Validation: 
scalar performance:
{'acc': 0.8719818, 'precision': 0.549886, 'recall': 0.7440638, 'specificity': 0.7440638, 'f1': 0.5589281, 'auroc': 0.82093906, 'binary_precision': 0.110673666, 'binary_recall': 0.6096386, 'binary_specificity': 0.878489, 'binary_f1_score': 0.18733802}
confusion matrix:
       0     1
0  14698  2033
1    162   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81263596, 'precision': 0.62332463, 'recall': 0.81539583, 'specificity': 0.81539583, 'f1': 0.64455336, 'auroc': 0.8800988, 'binary_precision': 0.2647675, 'binary_recall': 0.81865287, 'binary_specificity': 0.81213874, 'binary_f1_score': 0.40012664}
confusion matrix:
      0     1
0  7587  1755
1   140   632
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-07 00:14:54.177667,epoch time: 0:12:06.642932,used: 1:51:45.761148,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.917226, 'precision': 0.91812575, 'recall': 0.9172398, 'specificity': 0.9172398, 'f1': 0.9171833, 'auroc': 0.9720825, 'binary_precision': 0.9376707, 'binary_recall': 0.89397466, 'binary_specificity': 0.9405049, 'binary_f1_score': 0.9153015}
confusion matrix:
       0      1
0  23807   1506
1   2687  22656
---- Validation: 
scalar performance:
{'acc': 0.8684241, 'precision': 0.54942256, 'recall': 0.74811554, 'specificity': 0.74811554, 'f1': 0.5572868, 'auroc': 0.8245207, 'binary_precision': 0.10946118, 'binary_recall': 0.62168676, 'binary_specificity': 0.87454426, 'binary_f1_score': 0.18614718}
confusion matrix:
       0     1
0  14632  2099
1    157   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8154044, 'precision': 0.6254096, 'recall': 0.8186768, 'specificity': 0.8186768, 'f1': 0.6478033, 'auroc': 0.88284427, 'binary_precision': 0.26849896, 'binary_recall': 0.82253885, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.40484545}
confusion matrix:
      0     1
0  7612  1730
1   137   635
new oracle model saved
early stop counter: 1
val acc:0.868424117565155, best validation acc: 0.8719817996025085, corresponding to test acc:                         0.8126359581947327 / 0.8154044151306152
after epoch: 10,now: 2024-08-07 00:27:00.425424,epoch time: 0:12:06.247757,used: 2:03:52.008905,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9190816, 'precision': 0.91975087, 'recall': 0.9190927, 'specificity': 0.9190927, 'f1': 0.9190508, 'auroc': 0.9735813, 'binary_precision': 0.93664956, 'binary_recall': 0.89906085, 'binary_specificity': 0.9391246, 'binary_f1_score': 0.9174704}
confusion matrix:
       0      1
0  23773   1541
1   2558  22784
---- Validation: 
scalar performance:
{'acc': 0.852677, 'precision': 0.54555404, 'recall': 0.751796, 'specificity': 0.751796, 'f1': 0.5470826, 'auroc': 0.827899, 'binary_precision': 0.10124669, 'binary_recall': 0.6457831, 'binary_specificity': 0.8578088, 'binary_f1_score': 0.17504898}
confusion matrix:
       0     1
0  14352  2379
1    147   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8025509, 'precision': 0.61874825, 'recall': 0.8135015, 'specificity': 0.8135015, 'f1': 0.636037, 'auroc': 0.88345504, 'binary_precision': 0.25509796, 'binary_recall': 0.8264249, 'binary_specificity': 0.80057806, 'binary_f1_score': 0.3898564}
confusion matrix:
      0     1
0  7479  1863
1   134   638
early stop counter: 2
val acc:0.8526769876480103, best validation acc: 0.8719817996025085, corresponding to test acc:                         0.8126359581947327 / 0.8154044151306152
after epoch: 11,now: 2024-08-07 00:39:01.882300,epoch time: 0:12:01.456876,used: 2:15:53.465781,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9217072, 'precision': 0.92261124, 'recall': 0.9217219, 'specificity': 0.9217219, 'f1': 0.9216671, 'auroc': 0.9750556, 'binary_precision': 0.94231564, 'binary_recall': 0.8985164, 'binary_specificity': 0.94492733, 'binary_f1_score': 0.919895}
confusion matrix:
       0      1
0  23918   1394
1   2572  22772
---- Validation: 
scalar performance:
{'acc': 0.8604922, 'precision': 0.54791933, 'recall': 0.75345063, 'specificity': 0.75345063, 'f1': 0.5528433, 'auroc': 0.82929957, 'binary_precision': 0.106018335, 'binary_recall': 0.64096385, 'binary_specificity': 0.8659375, 'binary_f1_score': 0.18194254}
confusion matrix:
       0     1
0  14488  2243
1    149   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8134269, 'precision': 0.6241005, 'recall': 0.81701225, 'specificity': 0.81701225, 'f1': 0.6456882, 'auroc': 0.8850587, 'binary_precision': 0.2660512, 'binary_recall': 0.8212435, 'binary_specificity': 0.812781, 'binary_f1_score': 0.40190175}
confusion matrix:
      0     1
0  7593  1749
1   138   634
early stop counter: 3
val acc:0.8604922294616699, best validation acc: 0.8719817996025085, corresponding to test acc:                         0.8126359581947327 / 0.8154044151306152
after epoch: 12,now: 2024-08-07 00:51:03.792232,epoch time: 0:12:01.909932,used: 2:27:55.375713,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9255962, 'precision': 0.9268093, 'recall': 0.92561305, 'specificity': 0.92561305, 'f1': 0.9255452, 'auroc': 0.9759431, 'binary_precision': 0.94972277, 'binary_recall': 0.89887154, 'binary_specificity': 0.9523546, 'binary_f1_score': 0.92359775}
confusion matrix:
       0      1
0  24106   1206
1   2563  22781
---- Validation: 
scalar performance:
{'acc': 0.87472296, 'precision': 0.5520893, 'recall': 0.751343, 'specificity': 0.751343, 'f1': 0.5628896, 'auroc': 0.8333841, 'binary_precision': 0.114717655, 'binary_recall': 0.62168676, 'binary_specificity': 0.8809993, 'binary_f1_score': 0.1936937}
confusion matrix:
       0     1
0  14740  1991
1    157   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8311252, 'precision': 0.63320756, 'recall': 0.8194629, 'specificity': 0.8194629, 'f1': 0.6612718, 'auroc': 0.88535744, 'binary_precision': 0.2853211, 'binary_recall': 0.80569947, 'binary_specificity': 0.83322626, 'binary_f1_score': 0.4214092}
confusion matrix:
      0     1
0  7784  1558
1   150   622
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-07 01:03:05.117555,epoch time: 0:12:01.325323,used: 2:39:56.701036,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92650425, 'precision': 0.92802304, 'recall': 0.9265219, 'specificity': 0.9265219, 'f1': 0.926441, 'auroc': 0.9772793, 'binary_precision': 0.95366794, 'binary_recall': 0.8966578, 'binary_specificity': 0.956386, 'binary_f1_score': 0.9242846}
confusion matrix:
       0      1
0  24209   1104
1   2619  22724
---- Validation: 
scalar performance:
{'acc': 0.8869124, 'precision': 0.55542696, 'recall': 0.74348974, 'specificity': 0.74348974, 'f1': 0.5707638, 'auroc': 0.83436596, 'binary_precision': 0.122023806, 'binary_recall': 0.5927711, 'binary_specificity': 0.8942084, 'binary_f1_score': 0.20238584}
confusion matrix:
       0     1
0  14961  1770
1    169   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445719, 'precision': 0.6416107, 'recall': 0.8219887, 'specificity': 0.8219887, 'f1': 0.6741859, 'auroc': 0.88675535, 'binary_precision': 0.30276135, 'binary_recall': 0.7953368, 'binary_specificity': 0.84864056, 'binary_f1_score': 0.43857142}
confusion matrix:
      0     1
0  7928  1414
1   158   614
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-07 01:15:07.106282,epoch time: 0:12:01.988727,used: 2:51:58.689763,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9305512, 'precision': 0.93158984, 'recall': 0.9305638, 'specificity': 0.9305638, 'f1': 0.9305107, 'auroc': 0.9784895, 'binary_precision': 0.9528909, 'binary_recall': 0.90596265, 'binary_specificity': 0.9551649, 'binary_f1_score': 0.9288343}
confusion matrix:
       0      1
0  24180   1135
1   2383  22958
---- Validation: 
scalar performance:
{'acc': 0.8757145, 'precision': 0.55273706, 'recall': 0.753026, 'specificity': 0.753026, 'f1': 0.56410015, 'auroc': 0.8372179, 'binary_precision': 0.11593554, 'binary_recall': 0.6240964, 'binary_specificity': 0.8819556, 'binary_f1_score': 0.19554548}
confusion matrix:
       0     1
0  14756  1975
1    156   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83656317, 'precision': 0.6372803, 'recall': 0.8235949, 'specificity': 0.8235949, 'f1': 0.6673981, 'auroc': 0.8877308, 'binary_precision': 0.29309535, 'binary_recall': 0.8082902, 'binary_specificity': 0.8388996, 'binary_f1_score': 0.43019646}
confusion matrix:
      0     1
0  7837  1505
1   148   624
early stop counter: 1
val acc:0.8757144808769226, best validation acc: 0.8869124054908752, corresponding to test acc:                         0.8445718884468079 / 0.8445718884468079
after epoch: 15,now: 2024-08-07 01:27:08.865503,epoch time: 0:12:01.759221,used: 3:04:00.448984,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9301169, 'precision': 0.93081117, 'recall': 0.9301304, 'specificity': 0.9301304, 'f1': 0.9300901, 'auroc': 0.9789176, 'binary_precision': 0.94827515, 'binary_recall': 0.90996253, 'binary_specificity': 0.9502983, 'binary_f1_score': 0.9287238}
confusion matrix:
       0      1
0  24053   1258
1   2282  23063
---- Validation: 
scalar performance:
{'acc': 0.85757613, 'precision': 0.54892397, 'recall': 0.7648807, 'specificity': 0.7648807, 'f1': 0.553442, 'auroc': 0.83855724, 'binary_precision': 0.107322745, 'binary_recall': 0.66746986, 'binary_specificity': 0.8622916, 'binary_f1_score': 0.18491322}
confusion matrix:
       0     1
0  14427  2304
1    138   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82123786, 'precision': 0.6290704, 'recall': 0.82242876, 'specificity': 0.82242876, 'f1': 0.65377605, 'auroc': 0.88930696, 'binary_precision': 0.27556327, 'binary_recall': 0.8238342, 'binary_specificity': 0.82102334, 'binary_f1_score': 0.41298705}
confusion matrix:
      0     1
0  7670  1672
1   136   636
early stop counter: 2
val acc:0.8575761318206787, best validation acc: 0.8869124054908752, corresponding to test acc:                         0.8445718884468079 / 0.8445718884468079
after epoch: 16,now: 2024-08-07 01:39:10.212464,epoch time: 0:12:01.346961,used: 3:16:01.795945,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9334926, 'precision': 0.93426496, 'recall': 0.93350595, 'specificity': 0.93350595, 'f1': 0.9334644, 'auroc': 0.98099947, 'binary_precision': 0.95273805, 'binary_recall': 0.9123264, 'binary_specificity': 0.9546855, 'binary_f1_score': 0.93209445}
confusion matrix:
       0      1
0  24165   1147
1   2222  23122
---- Validation: 
scalar performance:
{'acc': 0.8629418, 'precision': 0.55055743, 'recall': 0.76528025, 'specificity': 0.76528025, 'f1': 0.55739766, 'auroc': 0.8406762, 'binary_precision': 0.11066398, 'binary_recall': 0.6626506, 'binary_specificity': 0.86790985, 'binary_f1_score': 0.18965515}
confusion matrix:
       0     1
0  14521  2210
1    140   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287522, 'precision': 0.63321435, 'recall': 0.8241198, 'specificity': 0.8241198, 'f1': 0.6606926, 'auroc': 0.88989854, 'binary_precision': 0.28417265, 'binary_recall': 0.81865287, 'binary_specificity': 0.8295868, 'binary_f1_score': 0.42189586}
confusion matrix:
      0     1
0  7750  1592
1   140   632
early stop counter: 3
val acc:0.8629418015480042, best validation acc: 0.8869124054908752, corresponding to test acc:                         0.8445718884468079 / 0.8445718884468079
after epoch: 17,now: 2024-08-07 01:51:09.163525,epoch time: 0:11:58.951061,used: 3:28:00.747006,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93260425, 'precision': 0.9330915, 'recall': 0.9326142, 'specificity': 0.9326142, 'f1': 0.9325863, 'auroc': 0.97972804, 'binary_precision': 0.9477682, 'binary_recall': 0.9157558, 'binary_specificity': 0.9494726, 'binary_f1_score': 0.9314871}
confusion matrix:
       0      1
0  24034   1279
1   2135  23208
---- Validation: 
scalar performance:
{'acc': 0.84964424, 'precision': 0.5485225, 'recall': 0.77609056, 'specificity': 0.77609056, 'f1': 0.55042857, 'auroc': 0.84362054, 'binary_precision': 0.10572366, 'binary_recall': 0.6987952, 'binary_specificity': 0.8533859, 'binary_f1_score': 0.18366054}
confusion matrix:
       0     1
0  14278  2453
1    125   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81767845, 'precision': 0.6281869, 'recall': 0.82525516, 'specificity': 0.82525516, 'f1': 0.65168864, 'auroc': 0.89125204, 'binary_precision': 0.27288136, 'binary_recall': 0.83419687, 'binary_specificity': 0.81631345, 'binary_f1_score': 0.41123882}
confusion matrix:
      0     1
0  7626  1716
1   128   644
early stop counter: 4
val acc:0.8496442437171936, best validation acc: 0.8869124054908752, corresponding to test acc:                         0.8445718884468079 / 0.8445718884468079
after epoch: 18,now: 2024-08-07 02:03:09.771644,epoch time: 0:12:00.608119,used: 3:40:01.355125,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9346178, 'precision': 0.9355793, 'recall': 0.9346309, 'specificity': 0.9346309, 'f1': 0.934583, 'auroc': 0.9815316, 'binary_precision': 0.9561832, 'binary_recall': 0.91105676, 'binary_specificity': 0.9582049, 'binary_f1_score': 0.93307465}
confusion matrix:
       0      1
0  24256   1058
1   2254  23088
---- Validation: 
scalar performance:
{'acc': 0.85361016, 'precision': 0.54934466, 'recall': 0.7745979, 'specificity': 0.7745979, 'f1': 0.5528469, 'auroc': 0.84287906, 'binary_precision': 0.10753091, 'binary_recall': 0.6915663, 'binary_specificity': 0.85762954, 'binary_f1_score': 0.18612193}
confusion matrix:
       0     1
0  14349  2382
1    128   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8238086, 'precision': 0.63098603, 'recall': 0.82500863, 'specificity': 0.82500863, 'f1': 0.65674025, 'auroc': 0.889537, 'binary_precision': 0.2790901, 'binary_recall': 0.8264249, 'binary_specificity': 0.82359236, 'binary_f1_score': 0.4172662}
confusion matrix:
      0     1
0  7694  1648
1   134   638
early stop counter: 5
val acc:0.8536101579666138, best validation acc: 0.8869124054908752, corresponding to test acc:                         0.8445718884468079 / 0.8445718884468079
after epoch: 19,now: 2024-08-07 02:15:12.441448,epoch time: 0:12:02.669804,used: 3:52:04.024929,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9345586, 'precision': 0.93563205, 'recall': 0.9345763, 'specificity': 0.9345763, 'f1': 0.93452007, 'auroc': 0.9817444, 'binary_precision': 0.9574353, 'binary_recall': 0.90965044, 'binary_specificity': 0.95950216, 'binary_f1_score': 0.9329314}
confusion matrix:
       0      1
0  24285   1025
1   2290  23056
---- Validation: 
scalar performance:
{'acc': 0.8609588, 'precision': 0.55111444, 'recall': 0.7724887, 'specificity': 0.7724887, 'f1': 0.55762845, 'auroc': 0.8442159, 'binary_precision': 0.111330435, 'binary_recall': 0.67951804, 'binary_specificity': 0.8654593, 'binary_f1_score': 0.19131614}
confusion matrix:
       0     1
0  14480  2251
1    133   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83161956, 'precision': 0.6351241, 'recall': 0.825672, 'specificity': 0.825672, 'f1': 0.6636789, 'auroc': 0.88966393, 'binary_precision': 0.28792712, 'binary_recall': 0.81865287, 'binary_specificity': 0.8326911, 'binary_f1_score': 0.42601955}
confusion matrix:
      0     1
0  7779  1563
1   140   632
early stop counter: 6
val acc:0.8609588146209717, best validation acc: 0.8869124054908752, corresponding to test acc:                         0.8445718884468079 / 0.8445718884468079
after epoch: 20,now: 2024-08-07 02:27:13.902676,epoch time: 0:12:01.461228,used: 4:04:05.486157,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_06_22_23_08_seed_0_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 4:04:05.486157 at 2024-08-07 02:27:13.902676
persisted model performance metric: 

scalar performance:
{'acc': 0.8445719, 'precision': 0.6416107, 'recall': 0.8219887, 'specificity': 0.8219887, 'f1': 0.6741859, 'auroc': 0.88675535, 'binary_precision': 0.30276135, 'binary_recall': 0.7953368, 'binary_specificity': 0.84864056, 'binary_f1_score': 0.43857142}
confusion matrix:
      0     1
0  7928  1414
1   158   614
oracle model performance metric: 

scalar performance:
{'acc': 0.8445719, 'precision': 0.6416107, 'recall': 0.8219887, 'specificity': 0.8219887, 'f1': 0.6741859, 'auroc': 0.88675535, 'binary_precision': 0.30276135, 'binary_recall': 0.7953368, 'binary_specificity': 0.84864056, 'binary_f1_score': 0.43857142}
confusion matrix:
      0     1
0  7928  1414
1   158   614
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/17.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192600 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353988 GiB | 353988 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 192600 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool | 174400 KiB | 427880 KiB | 353988 GiB | 353988 GiB |
|       from small pool |  18200 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189463 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 353983 GiB | 353982 GiB |
|       from small pool |  16649 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB | 509952 KiB | 509952 KiB |      0 B   |
|       from large pool | 466944 KiB | 466944 KiB | 466944 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44967 KiB |  89169 KiB | 193335 GiB | 193335 GiB |
|       from large pool |  30400 KiB |  79704 KiB | 185898 GiB | 185898 GiB |
|       from small pool |  14567 KiB |  14818 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6815    |   81222 K  |   81217 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46332 K  |   46328 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6815    |   81222 K  |   81217 K  |
|       from large pool |      76    |     158    |   34889 K  |   34889 K  |
|       from small pool |    4336    |    6737    |   46332 K  |   46328 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3184    |   42637 K  |   42637 K  |
|       from large pool |       9    |      18    |   24129 K  |   24129 K  |
|       from small pool |      27    |    3176    |   18507 K  |   18507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353988 GiB | 353988 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353988 GiB | 353988 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353983 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 193335 GiB | 193335 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185898 GiB | 185898 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81222 K  |   81222 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46332 K  |   46332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81222 K  |   81222 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46332 K  |   46332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42639 K  |   42639 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18509 K  |   18509 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353988 GiB | 353988 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 361416 GiB | 361416 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 353988 GiB | 353988 GiB |
|       from small pool |      0 KiB |  39230 KiB |   7428 GiB |   7428 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 361395 GiB | 361395 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 353983 GiB | 353982 GiB |
|       from small pool |      0 KiB |  37683 KiB |   7412 GiB |   7412 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB | 509952 KiB | 509952 KiB | 272384 KiB |
|       from large pool | 204800 KiB | 466944 KiB | 466944 KiB | 262144 KiB |
|       from small pool |  32768 KiB |  43008 KiB |  43008 KiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 193335 GiB | 193335 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 185898 GiB | 185898 GiB |
|       from small pool |      0 KiB |  25762 KiB |   7437 GiB |   7437 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6815    |   81222 K  |   81222 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46332 K  |   46332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6815    |   81222 K  |   81222 K  |
|       from large pool |       2    |     158    |   34889 K  |   34889 K  |
|       from small pool |       0    |    6737    |   46332 K  |   46332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      42    |      42    |      16    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      16    |      21    |      21    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3184    |   42639 K  |   42639 K  |
|       from large pool |       3    |      18    |   24129 K  |   24129 K  |
|       from small pool |       0    |    3176    |   18509 K  |   18509 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682

 Experiment start at: 2024-08-07 02:45:27.519768
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.63239694, 'precision': 0.63724375, 'recall': 0.63232625, 'specificity': 0.63232625, 'f1': 0.62904775, 'auroc': 0.66584337, 'binary_precision': 0.6116386, 'binary_recall': 0.72687244, 'binary_specificity': 0.53778005, 'binary_f1_score': 0.66429526}
confusion matrix:
       0      1
0  13658  11739
1   6947  18488
---- Validation: 
scalar performance:
{'acc': 0.86129767, 'precision': 0.51129556, 'recall': 0.5502618, 'specificity': 0.5502618, 'f1': 0.49991235, 'auroc': 0.7374579, 'binary_precision': 0.04494382, 'binary_recall': 0.22273782, 'binary_specificity': 0.87778574, 'binary_f1_score': 0.074795485}
confusion matrix:
       0     1
0  14652  2040
1    335    96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7903082, 'precision': 0.48372072, 'recall': 0.47029397, 'specificity': 0.47029397, 'f1': 0.47241676, 'auroc': 0.59694326, 'binary_precision': 0.0473018, 'binary_recall': 0.09379128, 'binary_specificity': 0.84679663, 'binary_f1_score': 0.06288752}
confusion matrix:
      0     1
0  7904  1430
1   686    71
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 02:58:08.681948,epoch time: 0:12:41.162180,used: 0:12:41.162180,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.76390857, 'precision': 0.76478475, 'recall': 0.76388466, 'specificity': 0.76388466, 'f1': 0.7637019, 'auroc': 0.83273023, 'binary_precision': 0.74975836, 'binary_recall': 0.79282147, 'binary_specificity': 0.7349478, 'binary_f1_score': 0.77068883}
confusion matrix:
       0      1
0  18664   6731
1   5270  20167
---- Validation: 
scalar performance:
{'acc': 0.86532736, 'precision': 0.521115, 'recall': 0.59414375, 'specificity': 0.59414375, 'f1': 0.5153087, 'auroc': 0.76766205, 'binary_precision': 0.062120505, 'binary_recall': 0.3085847, 'binary_specificity': 0.87970287, 'binary_f1_score': 0.103421465}
confusion matrix:
       0     1
0  14684  2008
1    298   133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79129916, 'precision': 0.5294082, 'recall': 0.5618698, 'specificity': 0.5618698, 'f1': 0.5270205, 'auroc': 0.71290374, 'binary_precision': 0.12339475, 'binary_recall': 0.29194188, 'binary_specificity': 0.8317977, 'binary_f1_score': 0.17346938}
confusion matrix:
      0     1
0  7764  1570
1   536   221
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 03:10:22.023515,epoch time: 0:12:13.341567,used: 0:24:54.503747,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.82066417, 'precision': 0.8207064, 'recall': 0.8206598, 'specificity': 0.8206598, 'f1': 0.8206568, 'auroc': 0.8973808, 'binary_precision': 0.8172064, 'binary_recall': 0.8264596, 'binary_specificity': 0.81486005, 'binary_f1_score': 0.8218069}
confusion matrix:
       0      1
0  20695   4702
1   4414  21021
---- Validation: 
scalar performance:
{'acc': 0.8753723, 'precision': 0.52936673, 'recall': 0.624159, 'specificity': 0.624159, 'f1': 0.5298693, 'auroc': 0.7883846, 'binary_precision': 0.0769995, 'binary_recall': 0.35962877, 'binary_specificity': 0.8886892, 'binary_f1_score': 0.12684123}
confusion matrix:
       0     1
0  14834  1858
1    276   155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8027946, 'precision': 0.57099676, 'recall': 0.66155154, 'specificity': 0.66155154, 'f1': 0.57981515, 'auroc': 0.78000516, 'binary_precision': 0.18910742, 'binary_recall': 0.4953765, 'binary_specificity': 0.8277266, 'binary_f1_score': 0.27372265}
confusion matrix:
      0     1
0  7726  1608
1   382   375
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 03:22:24.106098,epoch time: 0:12:02.082583,used: 0:36:56.586330,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85088134, 'precision': 0.85109186, 'recall': 0.8508905, 'specificity': 0.8508905, 'f1': 0.85086125, 'auroc': 0.92766035, 'binary_precision': 0.85987824, 'binary_recall': 0.83864754, 'binary_specificity': 0.86313343, 'binary_f1_score': 0.8491302}
confusion matrix:
       0      1
0  21921   3476
1   4104  21331
---- Validation: 
scalar performance:
{'acc': 0.89108217, 'precision': 0.5401878, 'recall': 0.6525592, 'specificity': 0.6525592, 'f1': 0.54913634, 'auroc': 0.80289495, 'binary_precision': 0.09719101, 'binary_recall': 0.4013921, 'binary_specificity': 0.90372634, 'binary_f1_score': 0.15649028}
confusion matrix:
       0     1
0  15085  1607
1    258   173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82152414, 'precision': 0.59689945, 'recall': 0.71719587, 'specificity': 0.71719587, 'f1': 0.61509186, 'auroc': 0.81892174, 'binary_precision': 0.23148148, 'binary_recall': 0.5944518, 'binary_specificity': 0.83994, 'binary_f1_score': 0.3332099}
confusion matrix:
      0     1
0  7840  1494
1   307   450
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 03:34:30.685598,epoch time: 0:12:06.579500,used: 0:49:03.165830,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8713212, 'precision': 0.87186325, 'recall': 0.8713362, 'specificity': 0.8713362, 'f1': 0.87127745, 'auroc': 0.94463265, 'binary_precision': 0.88625866, 'binary_recall': 0.8522173, 'binary_specificity': 0.8904552, 'binary_f1_score': 0.86890465}
confusion matrix:
       0      1
0  22614   2782
1   3759  21677
---- Validation: 
scalar performance:
{'acc': 0.9008935, 'precision': 0.55019456, 'recall': 0.67793405, 'specificity': 0.67793405, 'f1': 0.56549317, 'auroc': 0.8153267, 'binary_precision': 0.11589806, 'binary_recall': 0.44315544, 'binary_specificity': 0.9127127, 'binary_f1_score': 0.18374218}
confusion matrix:
       0     1
0  15235  1457
1    240   191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83856905, 'precision': 0.61571777, 'recall': 0.74947304, 'specificity': 0.74947304, 'f1': 0.64099306, 'auroc': 0.84502697, 'binary_precision': 0.26406926, 'binary_recall': 0.6446499, 'binary_specificity': 0.85429615, 'binary_f1_score': 0.3746641}
confusion matrix:
      0     1
0  7974  1360
1   269   488
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 03:46:34.824991,epoch time: 0:12:04.139393,used: 1:01:07.305223,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8880233, 'precision': 0.88848233, 'recall': 0.8880389, 'specificity': 0.8880389, 'f1': 0.887993, 'auroc': 0.9555898, 'binary_precision': 0.90206456, 'binary_recall': 0.87078893, 'binary_specificity': 0.9052889, 'binary_f1_score': 0.8861509}
confusion matrix:
       0      1
0  22988   2405
1   3287  22152
---- Validation: 
scalar performance:
{'acc': 0.8985575, 'precision': 0.55465657, 'recall': 0.70272905, 'specificity': 0.70272905, 'f1': 0.5717732, 'auroc': 0.825657, 'binary_precision': 0.12341407, 'binary_recall': 0.4965197, 'binary_specificity': 0.9089384, 'binary_f1_score': 0.19769053}
confusion matrix:
       0     1
0  15172  1520
1    217   214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84332573, 'precision': 0.6264808, 'recall': 0.77632165, 'specificity': 0.77632165, 'f1': 0.65517193, 'auroc': 0.8625488, 'binary_precision': 0.28085107, 'binary_recall': 0.6974901, 'binary_specificity': 0.8551532, 'binary_f1_score': 0.4004551}
confusion matrix:
      0     1
0  7982  1352
1   229   528
new oracle model saved
early stop counter: 1
val acc:0.8985574841499329, best validation acc: 0.90089350938797, corresponding to test acc:                         0.8385690450668335 / 0.8433257341384888
after epoch: 6,now: 2024-08-07 03:58:35.484211,epoch time: 0:12:00.659220,used: 1:13:07.964443,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8946136, 'precision': 0.8950365, 'recall': 0.89462656, 'specificity': 0.89462656, 'f1': 0.8945876, 'auroc': 0.9607458, 'binary_precision': 0.90815955, 'binary_recall': 0.8782041, 'binary_specificity': 0.911049, 'binary_f1_score': 0.8929307}
confusion matrix:
       0      1
0  23137   2259
1   3098  22338
---- Validation: 
scalar performance:
{'acc': 0.8994335, 'precision': 0.55865353, 'recall': 0.71900034, 'specificity': 0.71900034, 'f1': 0.577834, 'auroc': 0.8299942, 'binary_precision': 0.13050945, 'binary_recall': 0.5290023, 'binary_specificity': 0.9089983, 'binary_f1_score': 0.2093664}
confusion matrix:
       0     1
0  15173  1519
1    203   228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84927166, 'precision': 0.63444775, 'recall': 0.7910675, 'specificity': 0.7910675, 'f1': 0.6658864, 'auroc': 0.8717687, 'binary_precision': 0.29440257, 'binary_recall': 0.7225892, 'binary_specificity': 0.85954577, 'binary_f1_score': 0.41835564}
confusion matrix:
      0     1
0  8023  1311
1   210   547
new oracle model saved
early stop counter: 2
val acc:0.8994334936141968, best validation acc: 0.90089350938797, corresponding to test acc:                         0.8385690450668335 / 0.8492716550827026
after epoch: 7,now: 2024-08-07 04:10:37.456606,epoch time: 0:12:01.972395,used: 1:25:09.936838,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90401715, 'precision': 0.9048883, 'recall': 0.9040364, 'specificity': 0.9040364, 'f1': 0.90396845, 'auroc': 0.9660921, 'binary_precision': 0.9238763, 'binary_recall': 0.88076425, 'binary_specificity': 0.9273085, 'binary_f1_score': 0.9018053}
confusion matrix:
       0      1
0  23549   1846
1   3033  22404
---- Validation: 
scalar performance:
{'acc': 0.9080769, 'precision': 0.5637323, 'recall': 0.718913, 'specificity': 0.718913, 'f1': 0.5863586, 'auroc': 0.8338179, 'binary_precision': 0.14079195, 'binary_recall': 0.51972157, 'binary_specificity': 0.91810447, 'binary_f1_score': 0.2215628}
confusion matrix:
       0     1
0  15325  1367
1    207   224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8643346, 'precision': 0.6481173, 'recall': 0.8004236, 'specificity': 0.8004236, 'f1': 0.683898, 'auroc': 0.880136, 'binary_precision': 0.32105264, 'binary_recall': 0.7252312, 'binary_specificity': 0.875616, 'binary_f1_score': 0.44507498}
confusion matrix:
      0     1
0  8173  1161
1   208   549
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-07 04:22:46.600431,epoch time: 0:12:09.143825,used: 1:37:19.080663,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90921074, 'precision': 0.909696, 'recall': 0.909225, 'specificity': 0.909225, 'f1': 0.9091859, 'auroc': 0.9682834, 'binary_precision': 0.92400426, 'binary_recall': 0.8919291, 'binary_specificity': 0.92652094, 'binary_f1_score': 0.9076834}
confusion matrix:
       0      1
0  23529   1866
1   2749  22688
---- Validation: 
scalar performance:
{'acc': 0.89470303, 'precision': 0.55946547, 'recall': 0.7346562, 'specificity': 0.7346562, 'f1': 0.57829213, 'auroc': 0.83951163, 'binary_precision': 0.13118279, 'binary_recall': 0.5661253, 'binary_specificity': 0.90318716, 'binary_f1_score': 0.2130074}
confusion matrix:
       0     1
0  15076  1616
1    187   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622535, 'precision': 0.65013456, 'recall': 0.814472, 'specificity': 0.814472, 'f1': 0.68677217, 'auroc': 0.88551813, 'binary_precision': 0.32229084, 'binary_recall': 0.75825626, 'binary_specificity': 0.8706878, 'binary_f1_score': 0.45232466}
confusion matrix:
      0     1
0  8127  1207
1   183   574
early stop counter: 1
val acc:0.8947030305862427, best validation acc: 0.9080768823623657, corresponding to test acc:                         0.8643345832824707 / 0.8643345832824707
after epoch: 9,now: 2024-08-07 04:34:51.845806,epoch time: 0:12:05.245375,used: 1:49:24.326038,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9112567, 'precision': 0.91333044, 'recall': 0.9112874, 'specificity': 0.9112874, 'f1': 0.91114956, 'auroc': 0.9705616, 'binary_precision': 0.9428245, 'binary_recall': 0.8757764, 'binary_specificity': 0.94679844, 'binary_f1_score': 0.9080645}
confusion matrix:
       0      1
0  24043   1351
1   3160  22278
---- Validation: 
scalar performance:
{'acc': 0.9184138, 'precision': 0.57234645, 'recall': 0.7230848, 'specificity': 0.7230848, 'f1': 0.5994417, 'auroc': 0.8416665, 'binary_precision': 0.15793201, 'binary_recall': 0.5174014, 'binary_specificity': 0.9287683, 'binary_f1_score': 0.24199675}
confusion matrix:
       0     1
0  15503  1189
1    208   223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88038844, 'precision': 0.66500217, 'recall': 0.80849457, 'specificity': 0.80849457, 'f1': 0.7041958, 'auroc': 0.88848865, 'binary_precision': 0.35446313, 'binary_recall': 0.72391015, 'binary_specificity': 0.89307904, 'binary_f1_score': 0.47590098}
confusion matrix:
      0    1
0  8336  998
1   209  548
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-07 04:46:56.864660,epoch time: 0:12:05.018854,used: 2:01:29.344892,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9158404, 'precision': 0.916785, 'recall': 0.9158592, 'specificity': 0.9158592, 'f1': 0.9157952, 'auroc': 0.9719503, 'binary_precision': 0.93682384, 'binary_recall': 0.89196414, 'binary_specificity': 0.9397543, 'binary_f1_score': 0.91384375}
confusion matrix:
       0      1
0  23866   1530
1   2748  22688
---- Validation: 
scalar performance:
{'acc': 0.90165275, 'precision': 0.56494606, 'recall': 0.74274135, 'specificity': 0.74274135, 'f1': 0.5875031, 'auroc': 0.8456197, 'binary_precision': 0.1417953, 'binary_recall': 0.575406, 'binary_specificity': 0.9100767, 'binary_f1_score': 0.22752291}
confusion matrix:
       0     1
0  15191  1501
1    183   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87483895, 'precision': 0.66177505, 'recall': 0.8176335, 'specificity': 0.8176335, 'f1': 0.7012539, 'auroc': 0.8917471, 'binary_precision': 0.3459196, 'binary_recall': 0.75033027, 'binary_specificity': 0.8849368, 'binary_f1_score': 0.47353065}
confusion matrix:
      0     1
0  8260  1074
1   189   568
early stop counter: 1
val acc:0.9016527533531189, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8803884387016296
after epoch: 11,now: 2024-08-07 04:58:58.975613,epoch time: 0:12:02.110953,used: 2:13:31.455845,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92262745, 'precision': 0.9235139, 'recall': 0.92264557, 'specificity': 0.92264557, 'f1': 0.9225892, 'auroc': 0.97608113, 'binary_precision': 0.94308674, 'binary_recall': 0.89966977, 'binary_specificity': 0.9456214, 'binary_f1_score': 0.9208668}
confusion matrix:
       0      1
0  24015   1381
1   2552  22884
---- Validation: 
scalar performance:
{'acc': 0.8990247, 'precision': 0.5636163, 'recall': 0.74365366, 'specificity': 0.74365366, 'f1': 0.5851566, 'auroc': 0.8468899, 'binary_precision': 0.13904338, 'binary_recall': 0.5800464, 'binary_specificity': 0.90726095, 'binary_f1_score': 0.22431582}
confusion matrix:
       0     1
0  15144  1548
1    181   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87642455, 'precision': 0.66379595, 'recall': 0.8197045, 'specificity': 0.8197045, 'f1': 0.7037555, 'auroc': 0.8939755, 'binary_precision': 0.34969324, 'binary_recall': 0.75297225, 'binary_specificity': 0.8864367, 'binary_f1_score': 0.47758693}
confusion matrix:
      0     1
0  8274  1060
1   187   570
early stop counter: 2
val acc:0.8990247249603271, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8803884387016296
after epoch: 12,now: 2024-08-07 05:10:59.212960,epoch time: 0:12:00.237347,used: 2:25:31.693192,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92546034, 'precision': 0.9264878, 'recall': 0.9254778, 'specificity': 0.9254778, 'f1': 0.9254174, 'auroc': 0.97685623, 'binary_precision': 0.9475992, 'binary_recall': 0.9008414, 'binary_specificity': 0.9501142, 'binary_f1_score': 0.92362887}
confusion matrix:
       0      1
0  24131   1267
1   2522  22912
---- Validation: 
scalar performance:
{'acc': 0.9023536, 'precision': 0.5663863, 'recall': 0.74762136, 'specificity': 0.74762136, 'f1': 0.5897408, 'auroc': 0.84957224, 'binary_precision': 0.1444126, 'binary_recall': 0.58468676, 'binary_specificity': 0.91055596, 'binary_f1_score': 0.23161764}
confusion matrix:
       0     1
0  15199  1493
1    179   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8793975, 'precision': 0.6671133, 'recall': 0.8213115, 'specificity': 0.8213115, 'f1': 0.7076954, 'auroc': 0.8953333, 'binary_precision': 0.35625, 'binary_recall': 0.75297225, 'binary_specificity': 0.88965076, 'binary_f1_score': 0.48366567}
confusion matrix:
      0     1
0  8304  1030
1   187   570
early stop counter: 3
val acc:0.9023535847663879, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8803884387016296
after epoch: 13,now: 2024-08-07 05:23:00.982389,epoch time: 0:12:01.769429,used: 2:37:33.462621,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92567676, 'precision': 0.92664254, 'recall': 0.9256965, 'specificity': 0.9256965, 'f1': 0.92563695, 'auroc': 0.9767706, 'binary_precision': 0.9471489, 'binary_recall': 0.9017966, 'binary_specificity': 0.9495964, 'binary_f1_score': 0.9239165}
confusion matrix:
       0      1
0  24115   1280
1   2498  22939
---- Validation: 
scalar performance:
{'acc': 0.89452785, 'precision': 0.56321025, 'recall': 0.7537787, 'specificity': 0.7537787, 'f1': 0.58382213, 'auroc': 0.852212, 'binary_precision': 0.13758565, 'binary_recall': 0.60556847, 'binary_specificity': 0.901989, 'binary_f1_score': 0.2242268}
confusion matrix:
       0     1
0  15056  1636
1    170   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87711823, 'precision': 0.6657378, 'recall': 0.8249349, 'specificity': 0.8249349, 'f1': 0.7063765, 'auroc': 0.89703286, 'binary_precision': 0.35265407, 'binary_recall': 0.76354027, 'binary_specificity': 0.88632953, 'binary_f1_score': 0.48247078}
confusion matrix:
      0     1
0  8273  1061
1   179   578
early stop counter: 4
val acc:0.8945278525352478, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8803884387016296
after epoch: 14,now: 2024-08-07 05:35:01.738959,epoch time: 0:12:00.756570,used: 2:49:34.219191,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9281948, 'precision': 0.9296422, 'recall': 0.92821896, 'specificity': 0.92821896, 'f1': 0.92813706, 'auroc': 0.9777075, 'binary_precision': 0.9547865, 'binary_recall': 0.89908403, 'binary_specificity': 0.95735383, 'binary_f1_score': 0.92609847}
confusion matrix:
       0      1
0  24312   1083
1   2567  22870
---- Validation: 
scalar performance:
{'acc': 0.90211993, 'precision': 0.5669234, 'recall': 0.7508919, 'specificity': 0.7508919, 'f1': 0.59051293, 'auroc': 0.85445404, 'binary_precision': 0.14529915, 'binary_recall': 0.5916473, 'binary_specificity': 0.9101366, 'binary_f1_score': 0.23330286}
confusion matrix:
       0     1
0  15192  1500
1    176   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88118124, 'precision': 0.6695959, 'recall': 0.82409656, 'specificity': 0.82409656, 'f1': 0.71073973, 'auroc': 0.897874, 'binary_precision': 0.36083123, 'binary_recall': 0.7569353, 'binary_specificity': 0.89125776, 'binary_f1_score': 0.48869935}
confusion matrix:
      0     1
0  8319  1015
1   184   573
new oracle model saved
early stop counter: 5
val acc:0.9021199345588684, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8811812400817871
after epoch: 15,now: 2024-08-07 05:47:03.856187,epoch time: 0:12:02.117228,used: 3:01:36.336419,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9294146, 'precision': 0.9309074, 'recall': 0.9294366, 'specificity': 0.9294366, 'f1': 0.9293558, 'auroc': 0.97908735, 'binary_precision': 0.95645815, 'binary_recall': 0.8999017, 'binary_specificity': 0.95897156, 'binary_f1_score': 0.9273184}
confusion matrix:
       0      1
0  24355   1042
1   2546  22889
---- Validation: 
scalar performance:
{'acc': 0.9011855, 'precision': 0.5681097, 'recall': 0.7594538, 'specificity': 0.7594538, 'f1': 0.5921609, 'auroc': 0.8581275, 'binary_precision': 0.14717403, 'binary_recall': 0.6102088, 'binary_specificity': 0.9086988, 'binary_f1_score': 0.23715058}
confusion matrix:
       0     1
0  15168  1524
1    168   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.882965, 'precision': 0.67253673, 'recall': 0.82870233, 'specificity': 0.82870233, 'f1': 0.7144475, 'auroc': 0.8993904, 'binary_precision': 0.36599243, 'binary_recall': 0.7648613, 'binary_specificity': 0.8925434, 'binary_f1_score': 0.49508342}
confusion matrix:
      0     1
0  8331  1003
1   178   579
new oracle model saved
early stop counter: 6
val acc:0.9011855125427246, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8829650282859802
after epoch: 16,now: 2024-08-07 05:59:04.106659,epoch time: 0:12:00.250472,used: 3:13:36.586891,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93199164, 'precision': 0.9329836, 'recall': 0.93201053, 'specificity': 0.93201053, 'f1': 0.9319546, 'auroc': 0.98017406, 'binary_precision': 0.9539052, 'binary_recall': 0.90796506, 'binary_specificity': 0.95605606, 'binary_f1_score': 0.93036836}
confusion matrix:
       0      1
0  24280   1116
1   2341  23095
---- Validation: 
scalar performance:
{'acc': 0.8914326, 'precision': 0.5637183, 'recall': 0.7646226, 'specificity': 0.7646226, 'f1': 0.5840017, 'auroc': 0.85914993, 'binary_precision': 0.13793103, 'binary_recall': 0.63109046, 'binary_specificity': 0.8981548, 'binary_f1_score': 0.22638367}
confusion matrix:
       0     1
0  14992  1700
1    159   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8788029, 'precision': 0.66947764, 'recall': 0.8337357, 'specificity': 0.8337357, 'f1': 0.7113396, 'auroc': 0.89965665, 'binary_precision': 0.3586165, 'binary_recall': 0.7807133, 'binary_specificity': 0.8867581, 'binary_f1_score': 0.49147606}
confusion matrix:
      0     1
0  8277  1057
1   166   591
early stop counter: 7
val acc:0.8914325833320618, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8829650282859802
after epoch: 17,now: 2024-08-07 06:11:04.996646,epoch time: 0:12:00.889987,used: 3:25:37.476878,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93395895, 'precision': 0.93496114, 'recall': 0.93397886, 'specificity': 0.93397886, 'f1': 0.9339229, 'auroc': 0.9812646, 'binary_precision': 0.9560476, 'binary_recall': 0.9098557, 'binary_specificity': 0.958102, 'binary_f1_score': 0.93237984}
confusion matrix:
       0      1
0  24331   1064
1   2293  23144
---- Validation: 
scalar performance:
{'acc': 0.890323, 'precision': 0.5632683, 'recall': 0.7651837, 'specificity': 0.7651837, 'f1': 0.5831159, 'auroc': 0.86048335, 'binary_precision': 0.13697943, 'binary_recall': 0.6334107, 'binary_specificity': 0.8969566, 'binary_f1_score': 0.22524753}
confusion matrix:
       0     1
0  14972  1720
1    158   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8782083, 'precision': 0.66882014, 'recall': 0.8334143, 'specificity': 0.8334143, 'f1': 0.7105477, 'auroc': 0.9003576, 'binary_precision': 0.3573156, 'binary_recall': 0.7807133, 'binary_specificity': 0.88611525, 'binary_f1_score': 0.49025306}
confusion matrix:
      0     1
0  8271  1063
1   166   591
early stop counter: 8
val acc:0.8903229832649231, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8829650282859802
after epoch: 18,now: 2024-08-07 06:23:08.141184,epoch time: 0:12:03.144538,used: 3:37:40.621416,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9361032, 'precision': 0.93714875, 'recall': 0.93612355, 'specificity': 0.93612355, 'f1': 0.936067, 'auroc': 0.9813893, 'binary_precision': 0.95873475, 'binary_recall': 0.9115462, 'binary_specificity': 0.9607009, 'binary_f1_score': 0.9345451}
confusion matrix:
       0      1
0  24397    998
1   2250  23187
---- Validation: 
scalar performance:
{'acc': 0.8857093, 'precision': 0.5614679, 'recall': 0.7673378, 'specificity': 0.7673378, 'f1': 0.5794812, 'auroc': 0.8611753, 'binary_precision': 0.13317308, 'binary_recall': 0.64269143, 'binary_specificity': 0.89198416, 'binary_f1_score': 0.22062925}
confusion matrix:
       0     1
0  14889  1803
1    154   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8760281, 'precision': 0.6668835, 'recall': 0.8340566, 'specificity': 0.8340566, 'f1': 0.7082891, 'auroc': 0.9005736, 'binary_precision': 0.35315102, 'binary_recall': 0.7846764, 'binary_specificity': 0.8834369, 'binary_f1_score': 0.4870849}
confusion matrix:
      0     1
0  8246  1088
1   163   594
early stop counter: 9
val acc:0.885709285736084, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8829650282859802
after epoch: 19,now: 2024-08-07 06:35:12.675381,epoch time: 0:12:04.534197,used: 3:49:45.155613,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.93626064, 'precision': 0.9368837, 'recall': 0.9362748, 'specificity': 0.9362748, 'f1': 0.93623924, 'auroc': 0.98142123, 'binary_precision': 0.9535701, 'binary_recall': 0.91727936, 'binary_specificity': 0.9552703, 'binary_f1_score': 0.9350727}
confusion matrix:
       0      1
0  24261   1136
1   2104  23331
---- Validation: 
scalar performance:
{'acc': 0.87788355, 'precision': 0.5597967, 'recall': 0.77688557, 'specificity': 0.77688557, 'f1': 0.5751707, 'auroc': 0.86161363, 'binary_precision': 0.12913315, 'binary_recall': 0.67053366, 'binary_specificity': 0.8832375, 'binary_f1_score': 0.2165605}
confusion matrix:
       0     1
0  14743  1949
1    142   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8726588, 'precision': 0.6643704, 'recall': 0.83648384, 'specificity': 0.83648384, 'f1': 0.70534694, 'auroc': 0.9004078, 'binary_precision': 0.34739885, 'binary_recall': 0.7939234, 'binary_specificity': 0.87904435, 'binary_f1_score': 0.48331323}
confusion matrix:
      0     1
0  8205  1129
1   156   601
early stop counter: 10
val acc:0.8778835535049438, best validation acc: 0.9184138178825378, corresponding to test acc:                         0.8803884387016296 / 0.8829650282859802
after epoch: 20,now: 2024-08-07 06:47:13.821724,epoch time: 0:12:01.146343,used: 4:01:46.301956,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_02_45_27_seed_1_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 4:01:46.301956 at 2024-08-07 06:47:13.821724
persisted model performance metric: 

scalar performance:
{'acc': 0.88038844, 'precision': 0.66500217, 'recall': 0.80849457, 'specificity': 0.80849457, 'f1': 0.7041958, 'auroc': 0.88848865, 'binary_precision': 0.35446313, 'binary_recall': 0.72391015, 'binary_specificity': 0.89307904, 'binary_f1_score': 0.47590098}
confusion matrix:
      0    1
0  8336  998
1   209  548
oracle model performance metric: 

scalar performance:
{'acc': 0.882965, 'precision': 0.67253673, 'recall': 0.82870233, 'specificity': 0.82870233, 'f1': 0.7144475, 'auroc': 0.8993904, 'binary_precision': 0.36599243, 'binary_recall': 0.7648613, 'binary_specificity': 0.8925434, 'binary_f1_score': 0.49508342}
confusion matrix:
      0     1
0  8331  1003
1   178   579
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool | 173494 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |  18194 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 711024 GiB | 711023 GiB |
|       from small pool |  16648 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    780 MiB | 272384 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    732 MiB | 262144 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     48 MiB |  10240 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  89169 KiB | 399287 GiB | 399287 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 384172 GiB | 384172 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6837    |  162969 K  |  162965 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92886 K  |   92881 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6837    |  162969 K  |  162965 K  |
|       from large pool |      76    |     158    |   70083 K  |   70083 K  |
|       from small pool |    4324    |    6759    |   92886 K  |   92881 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      57    |      16    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      24    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3196    |   87285 K  |   87285 K  |
|       from large pool |      10    |      23    |   44071 K  |   44071 K  |
|       from small pool |      20    |    3186    |   43213 K  |   43213 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711024 GiB | 711024 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 399287 GiB | 399287 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384172 GiB | 384172 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162969 K  |  162969 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92886 K  |   92886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162969 K  |  162969 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92886 K  |   92886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87287 K  |   87287 K  |
|       from large pool |       3    |      23    |   44071 K  |   44071 K  |
|       from small pool |       0    |    3186    |   43215 K  |   43215 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB | 725951 GiB | 725951 GiB |
|       from large pool |  17088 KiB | 427880 KiB | 711034 GiB | 711034 GiB |
|       from small pool |      0 KiB |  39230 KiB |  14917 GiB |  14917 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB | 725909 GiB | 725909 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 711024 GiB | 711024 GiB |
|       from small pool |      0 KiB |  37683 KiB |  14885 GiB |  14885 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |    780 MiB | 565248 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    732 MiB | 544768 KiB |
|       from small pool |  28672 KiB |  43008 KiB |     48 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 399287 GiB | 399287 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 384172 GiB | 384172 GiB |
|       from small pool |      0 KiB |  25762 KiB |  15114 GiB |  15114 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6837    |  162969 K  |  162969 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92886 K  |   92886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6837    |  162969 K  |  162969 K  |
|       from large pool |       2    |     158    |   70083 K  |   70083 K  |
|       from small pool |       0    |    6759    |   92886 K  |   92886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      57    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      14    |      21    |      24    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3196    |   87287 K  |   87287 K  |
|       from large pool |       3    |      23    |   44071 K  |   44071 K  |
|       from small pool |       0    |    3186    |   43215 K  |   43215 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682

 Experiment start at: 2024-08-07 07:05:26.232913
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.734138, 'precision': 0.73428714, 'recall': 0.7341395, 'specificity': 0.7341395, 'f1': 0.7340965, 'auroc': 0.8090098, 'binary_precision': 0.74022776, 'binary_recall': 0.72155815, 'binary_specificity': 0.74672085, 'binary_f1_score': 0.73077375}
confusion matrix:
       0      1
0  19299   6546
1   7198  18653
---- Validation: 
scalar performance:
{'acc': 0.54899555, 'precision': 0.51413304, 'recall': 0.6475662, 'specificity': 0.6475662, 'f1': 0.38849035, 'auroc': 0.6858443, 'binary_precision': 0.039581496, 'binary_recall': 0.75119615, 'binary_specificity': 0.5439363, 'binary_f1_score': 0.07520058}
confusion matrix:
      0     1
0  9087  7619
1   104   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5180341, 'precision': 0.5550801, 'recall': 0.68788064, 'specificity': 0.68788064, 'f1': 0.4379233, 'auroc': 0.79715025, 'binary_precision': 0.12926163, 'binary_recall': 0.889586, 'binary_specificity': 0.48617536, 'binary_f1_score': 0.22572431}
confusion matrix:
      0     1
0  4519  4776
1    88   709
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-07 07:18:26.388063,epoch time: 0:13:00.155150,used: 0:13:00.155150,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.82505417, 'precision': 0.8251957, 'recall': 0.82505536, 'specificity': 0.82505536, 'f1': 0.82503545, 'auroc': 0.90242374, 'binary_precision': 0.8320098, 'binary_recall': 0.81463, 'binary_specificity': 0.83548075, 'binary_f1_score': 0.8232281}
confusion matrix:
       0      1
0  21593   4252
1   4792  21059
---- Validation: 
scalar performance:
{'acc': 0.6512497, 'precision': 0.5198208, 'recall': 0.6918088, 'specificity': 0.6918088, 'f1': 0.4386681, 'auroc': 0.74030435, 'binary_precision': 0.049773023, 'binary_recall': 0.73444974, 'binary_specificity': 0.64916795, 'binary_f1_score': 0.09322806}
confusion matrix:
       0     1
0  10845  5861
1    111   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59076494, 'precision': 0.5657203, 'recall': 0.72507, 'specificity': 0.72507, 'f1': 0.48624295, 'auroc': 0.817995, 'binary_precision': 0.1486401, 'binary_recall': 0.88456714, 'binary_specificity': 0.5655729, 'binary_f1_score': 0.25451264}
confusion matrix:
      0     1
0  5257  4038
1    92   705
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-07 07:30:50.119934,epoch time: 0:12:23.731871,used: 0:25:23.887021,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8537798, 'precision': 0.8538374, 'recall': 0.85378075, 'specificity': 0.85378075, 'f1': 0.8537741, 'auroc': 0.9288815, 'binary_precision': 0.8583911, 'binary_recall': 0.8474006, 'binary_specificity': 0.86016095, 'binary_f1_score': 0.85286045}
confusion matrix:
       0      1
0  22230   3614
1   3945  21907
---- Validation: 
scalar performance:
{'acc': 0.7040411, 'precision': 0.52347696, 'recall': 0.70953506, 'specificity': 0.70953506, 'f1': 0.4641137, 'auroc': 0.7652223, 'binary_precision': 0.056974087, 'binary_recall': 0.715311, 'binary_specificity': 0.70375913, 'binary_f1_score': 0.10554183}
confusion matrix:
       0     1
0  11757  4949
1    119   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.628914, 'precision': 0.5720532, 'recall': 0.7429123, 'specificity': 0.7429123, 'f1': 0.5115448, 'auroc': 0.828835, 'binary_precision': 0.16099356, 'binary_recall': 0.8782936, 'binary_specificity': 0.60753095, 'binary_f1_score': 0.27210885}
confusion matrix:
      0     1
0  5647  3648
1    97   700
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-07 07:43:15.979955,epoch time: 0:12:25.860021,used: 0:37:49.747042,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.86973846, 'precision': 0.8705225, 'recall': 0.86974114, 'specificity': 0.86974114, 'f1': 0.86967015, 'auroc': 0.94179565, 'binary_precision': 0.8875958, 'binary_recall': 0.8467371, 'binary_specificity': 0.8927452, 'binary_f1_score': 0.8666852}
confusion matrix:
       0      1
0  23073   2772
1   3962  21889
---- Validation: 
scalar performance:
{'acc': 0.7763373, 'precision': 0.52839553, 'recall': 0.7116003, 'specificity': 0.7116003, 'f1': 0.49749452, 'auroc': 0.7801664, 'binary_precision': 0.068101265, 'binary_recall': 0.6435407, 'binary_specificity': 0.77966, 'binary_f1_score': 0.1231685}
confusion matrix:
       0     1
0  13025  3681
1    149   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6985731, 'precision': 0.5822334, 'recall': 0.75835943, 'specificity': 0.75835943, 'f1': 0.5553224, 'auroc': 0.8378663, 'binary_precision': 0.18530978, 'binary_recall': 0.8293601, 'binary_specificity': 0.6873588, 'binary_f1_score': 0.3029331}
confusion matrix:
      0     1
0  6389  2906
1   136   661
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-07 07:55:36.336967,epoch time: 0:12:20.357012,used: 0:50:10.104054,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8830664, 'precision': 0.8836389, 'recall': 0.88307166, 'specificity': 0.88307166, 'f1': 0.88302374, 'auroc': 0.952662, 'binary_precision': 0.8985274, 'binary_recall': 0.8637401, 'binary_specificity': 0.9024032, 'binary_f1_score': 0.8807904}
confusion matrix:
       0      1
0  23319   2522
1   3523  22332
---- Validation: 
scalar performance:
{'acc': 0.79385656, 'precision': 0.5317789, 'recall': 0.7240778, 'specificity': 0.7240778, 'f1': 0.5082708, 'auroc': 0.79557717, 'binary_precision': 0.07439825, 'binary_recall': 0.6507177, 'binary_specificity': 0.797438, 'binary_f1_score': 0.13352971}
confusion matrix:
       0     1
0  13322  3384
1    146   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.721958, 'precision': 0.58948463, 'recall': 0.77220154, 'specificity': 0.77220154, 'f1': 0.5730515, 'auroc': 0.84752035, 'binary_precision': 0.1988006, 'binary_recall': 0.8318695, 'binary_specificity': 0.7125336, 'binary_f1_score': 0.32090995}
confusion matrix:
      0     1
0  6623  2672
1   134   663
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-07 08:08:03.942006,epoch time: 0:12:27.605039,used: 1:02:37.709093,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8920226, 'precision': 0.89318895, 'recall': 0.8920289, 'specificity': 0.8920289, 'f1': 0.8919436, 'auroc': 0.95837474, 'binary_precision': 0.91466206, 'binary_recall': 0.8647791, 'binary_specificity': 0.9192787, 'binary_f1_score': 0.8890214}
confusion matrix:
       0      1
0  23756   2086
1   3496  22358
---- Validation: 
scalar performance:
{'acc': 0.8207195, 'precision': 0.53631943, 'recall': 0.73084795, 'specificity': 0.73084795, 'f1': 0.5237597, 'auroc': 0.80635345, 'binary_precision': 0.08354271, 'binary_recall': 0.6363636, 'binary_specificity': 0.8253322, 'binary_f1_score': 0.14769572}
confusion matrix:
       0     1
0  13788  2918
1    152   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7517836, 'precision': 0.5963706, 'recall': 0.7763483, 'specificity': 0.7763483, 'f1': 0.5930426, 'auroc': 0.85439944, 'binary_precision': 0.21457219, 'binary_recall': 0.8055207, 'binary_specificity': 0.7471759, 'binary_f1_score': 0.33887565}
confusion matrix:
      0     1
0  6945  2350
1   155   642
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-07 08:20:36.123602,epoch time: 0:12:32.181596,used: 1:15:09.890689,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89829, 'precision': 0.8990202, 'recall': 0.898295, 'specificity': 0.898295, 'f1': 0.89824426, 'auroc': 0.9617754, 'binary_precision': 0.91614807, 'binary_recall': 0.8768856, 'binary_specificity': 0.9197044, 'binary_f1_score': 0.896087}
confusion matrix:
       0      1
0  23767   2075
1   3183  22671
---- Validation: 
scalar performance:
{'acc': 0.8192011, 'precision': 0.53695875, 'recall': 0.7370672, 'specificity': 0.7370672, 'f1': 0.52415025, 'auroc': 0.8165108, 'binary_precision': 0.084419616, 'binary_recall': 0.6507177, 'binary_specificity': 0.8234167, 'binary_f1_score': 0.14945056}
confusion matrix:
       0     1
0  13756  2950
1    146   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7575307, 'precision': 0.5992298, 'recall': 0.7817625, 'specificity': 0.7817625, 'f1': 0.59837395, 'auroc': 0.86025155, 'binary_precision': 0.21957852, 'binary_recall': 0.81053954, 'binary_specificity': 0.7529855, 'binary_f1_score': 0.34554693}
confusion matrix:
      0     1
0  6999  2296
1   151   646
new oracle model saved
early stop counter: 1
val acc:0.8192011117935181, best validation acc: 0.8207194805145264, corresponding to test acc:                         0.7517836093902588 / 0.757530689239502
after epoch: 7,now: 2024-08-07 08:34:03.093152,epoch time: 0:13:26.969550,used: 1:28:36.860239,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9035709, 'precision': 0.90472233, 'recall': 0.9035771, 'specificity': 0.9035771, 'f1': 0.9035032, 'auroc': 0.9652657, 'binary_precision': 0.9263678, 'binary_recall': 0.8768856, 'binary_specificity': 0.9302685, 'binary_f1_score': 0.9009478}
confusion matrix:
       0      1
0  24040   1802
1   3183  22671
---- Validation: 
scalar performance:
{'acc': 0.82620883, 'precision': 0.53863657, 'recall': 0.74065876, 'specificity': 0.74065876, 'f1': 0.5288478, 'auroc': 0.82319117, 'binary_precision': 0.08768536, 'binary_recall': 0.6507177, 'binary_specificity': 0.8305998, 'binary_f1_score': 0.15454546}
confusion matrix:
       0     1
0  13876  2830
1    146   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.776952, 'precision': 0.6071862, 'recall': 0.7917322, 'specificity': 0.7917322, 'f1': 0.61452585, 'auroc': 0.86550355, 'binary_precision': 0.23505831, 'binary_recall': 0.8092848, 'binary_specificity': 0.77417964, 'binary_f1_score': 0.36430386}
confusion matrix:
      0     1
0  7196  2099
1   152   645
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-07 08:46:58.691937,epoch time: 0:12:55.598785,used: 1:41:32.459024,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9079232, 'precision': 0.9090705, 'recall': 0.9079263, 'specificity': 0.9079263, 'f1': 0.9078591, 'auroc': 0.9684745, 'binary_precision': 0.93076265, 'binary_recall': 0.88143593, 'binary_specificity': 0.9344167, 'binary_f1_score': 0.90542793}
confusion matrix:
       0      1
0  24150   1695
1   3065  22786
---- Validation: 
scalar performance:
{'acc': 0.83088064, 'precision': 0.54033715, 'recall': 0.7465518, 'specificity': 0.7465518, 'f1': 0.53279275, 'auroc': 0.82896614, 'binary_precision': 0.09081902, 'binary_recall': 0.65789473, 'binary_specificity': 0.8352089, 'binary_f1_score': 0.15960535}
confusion matrix:
       0     1
0  13953  2753
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78438365, 'precision': 0.6101087, 'recall': 0.794046, 'specificity': 0.794046, 'f1': 0.6204929, 'auroc': 0.86841834, 'binary_precision': 0.24108149, 'binary_recall': 0.8055207, 'binary_specificity': 0.78257126, 'binary_f1_score': 0.37109825}
confusion matrix:
      0     1
0  7274  2021
1   155   642
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-07 08:59:27.978346,epoch time: 0:12:29.286409,used: 1:54:01.745433,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9153126, 'precision': 0.91648054, 'recall': 0.91531056, 'specificity': 0.91531056, 'f1': 0.9152529, 'auroc': 0.9715691, 'binary_precision': 0.9385162, 'binary_recall': 0.8888416, 'binary_specificity': 0.9417795, 'binary_f1_score': 0.9130038}
confusion matrix:
       0      1
0  24345   1505
1   2873  22973
---- Validation: 
scalar performance:
{'acc': 0.83812195, 'precision': 0.5423204, 'recall': 0.7502631, 'specificity': 0.7502631, 'f1': 0.5379648, 'auroc': 0.83517677, 'binary_precision': 0.09469697, 'binary_recall': 0.65789473, 'binary_specificity': 0.8426314, 'binary_f1_score': 0.16556291}
confusion matrix:
       0     1
0  14077  2629
1    143   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7949861, 'precision': 0.61465806, 'recall': 0.7975075, 'specificity': 0.7975075, 'f1': 0.6292977, 'auroc': 0.871137, 'binary_precision': 0.25039247, 'binary_recall': 0.8005019, 'binary_specificity': 0.79451317, 'binary_f1_score': 0.38146487}
confusion matrix:
      0     1
0  7385  1910
1   159   638
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-07 09:11:57.896037,epoch time: 0:12:29.917691,used: 2:06:31.663124,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91771126, 'precision': 0.91859305, 'recall': 0.9177148, 'specificity': 0.9177148, 'f1': 0.91766834, 'auroc': 0.9730247, 'binary_precision': 0.93784463, 'binary_recall': 0.894747, 'binary_specificity': 0.94068253, 'binary_f1_score': 0.91578907}
confusion matrix:
       0      1
0  24311   1533
1   2721  23131
---- Validation: 
scalar performance:
{'acc': 0.8481663, 'precision': 0.54625994, 'recall': 0.76124215, 'specificity': 0.76124215, 'f1': 0.5467908, 'auroc': 0.84047544, 'binary_precision': 0.10211524, 'binary_recall': 0.6698565, 'binary_specificity': 0.8526278, 'binary_f1_score': 0.1772152}
confusion matrix:
       0     1
0  14244  2462
1    138   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80390406, 'precision': 0.61904496, 'recall': 0.8012017, 'specificity': 0.8012017, 'f1': 0.63719594, 'auroc': 0.87382936, 'binary_precision': 0.2591687, 'binary_recall': 0.79799247, 'binary_specificity': 0.804411, 'binary_f1_score': 0.39126423}
confusion matrix:
      0     1
0  7477  1818
1   161   636
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-07 09:24:30.621888,epoch time: 0:12:32.725851,used: 2:19:04.388975,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9202453, 'precision': 0.92199117, 'recall': 0.9202465, 'specificity': 0.9202465, 'f1': 0.9201628, 'auroc': 0.9741856, 'binary_precision': 0.9491441, 'binary_recall': 0.8880808, 'binary_specificity': 0.95241225, 'binary_f1_score': 0.91759765}
confusion matrix:
       0      1
0  24617   1230
1   2893  22956
---- Validation: 
scalar performance:
{'acc': 0.85488206, 'precision': 0.54853314, 'recall': 0.764684, 'specificity': 0.764684, 'f1': 0.55213416, 'auroc': 0.84416497, 'binary_precision': 0.10658546, 'binary_recall': 0.6698565, 'binary_specificity': 0.85951155, 'binary_f1_score': 0.18390805}
confusion matrix:
       0     1
0  14359  2347
1    138   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8156956, 'precision': 0.6246925, 'recall': 0.8035881, 'specificity': 0.8035881, 'f1': 0.64723754, 'auroc': 0.8748399, 'binary_precision': 0.27100387, 'binary_recall': 0.78920954, 'binary_specificity': 0.81796664, 'binary_f1_score': 0.40346375}
confusion matrix:
      0     1
0  7603  1692
1   168   629
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-07 09:36:59.387217,epoch time: 0:12:28.765329,used: 2:31:33.154304,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.922199, 'precision': 0.92364466, 'recall': 0.9222047, 'specificity': 0.9222047, 'f1': 0.9221332, 'auroc': 0.9755788, 'binary_precision': 0.9484409, 'binary_recall': 0.8929718, 'binary_specificity': 0.95143753, 'binary_f1_score': 0.91987085}
confusion matrix:
       0      1
0  24588   1255
1   2767  23086
---- Validation: 
scalar performance:
{'acc': 0.85710114, 'precision': 0.54914254, 'recall': 0.7646551, 'specificity': 0.7646551, 'f1': 0.5536845, 'auroc': 0.8472978, 'binary_precision': 0.10784693, 'binary_recall': 0.66746414, 'binary_specificity': 0.861846, 'binary_f1_score': 0.18569052}
confusion matrix:
       0     1
0  14398  2308
1    139   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8201546, 'precision': 0.6267948, 'recall': 0.8037145, 'specificity': 0.8037145, 'f1': 0.65090394, 'auroc': 0.8759344, 'binary_precision': 0.2755732, 'binary_recall': 0.7841907, 'binary_specificity': 0.8232383, 'binary_f1_score': 0.40783036}
confusion matrix:
      0     1
0  7652  1643
1   172   625
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-07 09:49:36.705508,epoch time: 0:12:37.318291,used: 2:44:10.472595,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92463636, 'precision': 0.92604506, 'recall': 0.9246408, 'specificity': 0.9246408, 'f1': 0.9245745, 'auroc': 0.976609, 'binary_precision': 0.9505828, 'binary_recall': 0.8958688, 'binary_specificity': 0.9534128, 'binary_f1_score': 0.92241514}
confusion matrix:
       0      1
0  24640   1204
1   2692  23160
---- Validation: 
scalar performance:
{'acc': 0.86229855, 'precision': 0.55147034, 'recall': 0.7696513, 'specificity': 0.7696513, 'f1': 0.5585988, 'auroc': 0.8488679, 'binary_precision': 0.11231015, 'binary_recall': 0.6722488, 'binary_specificity': 0.86705375, 'binary_f1_score': 0.19246575}
confusion matrix:
       0     1
0  14485  2221
1    137   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82709074, 'precision': 0.63159746, 'recall': 0.8086271, 'specificity': 0.8086271, 'f1': 0.6582987, 'auroc': 0.8775755, 'binary_precision': 0.28474113, 'binary_recall': 0.7867001, 'binary_specificity': 0.83055407, 'binary_f1_score': 0.41813937}
confusion matrix:
      0     1
0  7720  1575
1   170   627
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-07 10:02:12.467258,epoch time: 0:12:35.761750,used: 2:56:46.234345,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92614514, 'precision': 0.92699385, 'recall': 0.9261486, 'specificity': 0.9261486, 'f1': 0.92610884, 'auroc': 0.97780764, 'binary_precision': 0.9460685, 'binary_recall': 0.9038372, 'binary_specificity': 0.94846, 'binary_f1_score': 0.92447084}
confusion matrix:
       0      1
0  24512   1332
1   2486  23366
---- Validation: 
scalar performance:
{'acc': 0.8433193, 'precision': 0.5473537, 'recall': 0.7762517, 'specificity': 0.7762517, 'f1': 0.54682225, 'auroc': 0.85262215, 'binary_precision': 0.1033275, 'binary_recall': 0.70574164, 'binary_specificity': 0.84676164, 'binary_f1_score': 0.18026276}
confusion matrix:
       0     1
0  14146  2560
1    123   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148038, 'precision': 0.62654674, 'recall': 0.8117074, 'specificity': 0.8117074, 'f1': 0.6491077, 'auroc': 0.8787136, 'binary_precision': 0.27288136, 'binary_recall': 0.8080301, 'binary_specificity': 0.8153846, 'binary_f1_score': 0.40798226}
confusion matrix:
      0     1
0  7579  1716
1   153   644
early stop counter: 1
val acc:0.843319296836853, best validation acc: 0.8622985482215881, corresponding to test acc:                         0.8270907402038574 / 0.8270907402038574
after epoch: 15,now: 2024-08-07 10:14:54.329357,epoch time: 0:12:41.862099,used: 3:09:28.096444,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9303815, 'precision': 0.9313841, 'recall': 0.9303833, 'specificity': 0.9303833, 'f1': 0.93034124, 'auroc': 0.97846603, 'binary_precision': 0.95220095, 'binary_recall': 0.9062669, 'binary_specificity': 0.9544997, 'binary_f1_score': 0.92866635}
confusion matrix:
       0      1
0  24670   1176
1   2423  23427
---- Validation: 
scalar performance:
{'acc': 0.8462392, 'precision': 0.54846466, 'recall': 0.77891433, 'specificity': 0.77891433, 'f1': 0.5493467, 'auroc': 0.85571754, 'binary_precision': 0.10545066, 'binary_recall': 0.708134, 'binary_specificity': 0.8496947, 'binary_f1_score': 0.18356588}
confusion matrix:
       0     1
0  14195  2511
1    122   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81866825, 'precision': 0.62825716, 'recall': 0.81151104, 'specificity': 0.81151104, 'f1': 0.65219754, 'auroc': 0.87950635, 'binary_precision': 0.27669692, 'binary_recall': 0.8030113, 'binary_specificity': 0.8200108, 'binary_f1_score': 0.41157556}
confusion matrix:
      0     1
0  7622  1673
1   157   640
early stop counter: 2
val acc:0.8462392091751099, best validation acc: 0.8622985482215881, corresponding to test acc:                         0.8270907402038574 / 0.8270907402038574
after epoch: 16,now: 2024-08-07 10:28:17.122036,epoch time: 0:13:22.792679,used: 3:22:50.889123,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93090373, 'precision': 0.93196166, 'recall': 0.9309057, 'specificity': 0.9309057, 'f1': 0.9308616, 'auroc': 0.9798846, 'binary_precision': 0.95335776, 'binary_recall': 0.9061509, 'binary_specificity': 0.95566046, 'binary_f1_score': 0.92915505}
confusion matrix:
       0      1
0  24700   1146
1   2426  23424
---- Validation: 
scalar performance:
{'acc': 0.8530717, 'precision': 0.55025446, 'recall': 0.7789173, 'specificity': 0.7789173, 'f1': 0.55406475, 'auroc': 0.85731184, 'binary_precision': 0.10916542, 'binary_recall': 0.70095694, 'binary_specificity': 0.85687774, 'binary_f1_score': 0.18891038}
confusion matrix:
       0     1
0  14315  2391
1    125   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8258026, 'precision': 0.63216627, 'recall': 0.81308985, 'specificity': 0.81308985, 'f1': 0.6586593, 'auroc': 0.8793273, 'binary_precision': 0.28481862, 'binary_recall': 0.79799247, 'binary_specificity': 0.82818717, 'binary_f1_score': 0.41980198}
confusion matrix:
      0     1
0  7698  1597
1   161   636
early stop counter: 3
val acc:0.8530716896057129, best validation acc: 0.8622985482215881, corresponding to test acc:                         0.8270907402038574 / 0.8270907402038574
after epoch: 17,now: 2024-08-07 10:41:59.838443,epoch time: 0:13:42.716407,used: 3:36:33.605530,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9339407, 'precision': 0.93444705, 'recall': 0.9339447, 'specificity': 0.9339447, 'f1': 0.9339218, 'auroc': 0.9800781, 'binary_precision': 0.9493372, 'binary_recall': 0.91684073, 'binary_specificity': 0.9510487, 'binary_f1_score': 0.932806}
confusion matrix:
       0      1
0  24577   1265
1   2150  23704
---- Validation: 
scalar performance:
{'acc': 0.84863347, 'precision': 0.5494346, 'recall': 0.7813077, 'specificity': 0.7813077, 'f1': 0.55149734, 'auroc': 0.85861254, 'binary_precision': 0.10729769, 'binary_recall': 0.7105263, 'binary_specificity': 0.85208905, 'binary_f1_score': 0.18644068}
confusion matrix:
       0     1
0  14235  2471
1    121   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8234245, 'precision': 0.6314082, 'recall': 0.8146666, 'specificity': 0.8146666, 'f1': 0.6571592, 'auroc': 0.88032126, 'binary_precision': 0.28275254, 'binary_recall': 0.804266, 'binary_specificity': 0.8250672, 'binary_f1_score': 0.41840732}
confusion matrix:
      0     1
0  7669  1626
1   156   641
early stop counter: 4
val acc:0.8486334681510925, best validation acc: 0.8622985482215881, corresponding to test acc:                         0.8270907402038574 / 0.8270907402038574
after epoch: 18,now: 2024-08-07 10:55:52.654904,epoch time: 0:13:52.816461,used: 3:50:26.421991,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9340568, 'precision': 0.9356326, 'recall': 0.93405795, 'specificity': 0.93405795, 'f1': 0.9339972, 'auroc': 0.9807783, 'binary_precision': 0.9618424, 'binary_recall': 0.9039808, 'binary_specificity': 0.9641351, 'binary_f1_score': 0.93201435}
confusion matrix:
       0      1
0  24920    927
1   2482  23367
---- Validation: 
scalar performance:
{'acc': 0.87175894, 'precision': 0.5571585, 'recall': 0.78499603, 'specificity': 0.78499603, 'f1': 0.5695787, 'auroc': 0.8592564, 'binary_precision': 0.12298558, 'binary_recall': 0.6937799, 'binary_specificity': 0.8762121, 'binary_f1_score': 0.20893371}
confusion matrix:
       0     1
0  14638  2068
1    128   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84324217, 'precision': 0.6413389, 'recall': 0.81051254, 'specificity': 0.81051254, 'f1': 0.6731725, 'auroc': 0.87988067, 'binary_precision': 0.30521092, 'binary_recall': 0.77164364, 'binary_specificity': 0.8493814, 'binary_f1_score': 0.43741107}
confusion matrix:
      0     1
0  7895  1400
1   182   615
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-08-07 11:08:56.422020,epoch time: 0:13:03.767116,used: 4:03:30.189107,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.93399876, 'precision': 0.9352479, 'recall': 0.9340019, 'specificity': 0.9340019, 'f1': 0.93395174, 'auroc': 0.9812846, 'binary_precision': 0.9585939, 'binary_recall': 0.90719897, 'binary_specificity': 0.9608048, 'binary_f1_score': 0.9321886}
confusion matrix:
       0      1
0  24832   1013
1   2399  23452
---- Validation: 
scalar performance:
{'acc': 0.8621817, 'precision': 0.553669, 'recall': 0.7835863, 'specificity': 0.7835863, 'f1': 0.5617596, 'auroc': 0.85981405, 'binary_precision': 0.1159019, 'binary_recall': 0.70095694, 'binary_specificity': 0.8662157, 'binary_f1_score': 0.19891378}
confusion matrix:
       0     1
0  14471  2235
1    125   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395759, 'precision': 0.64009726, 'recall': 0.8142578, 'specificity': 0.8142578, 'f1': 0.67109454, 'auroc': 0.88044953, 'binary_precision': 0.30164093, 'binary_recall': 0.7841907, 'binary_specificity': 0.8443249, 'binary_f1_score': 0.43569186}
confusion matrix:
      0     1
0  7848  1447
1   172   625
early stop counter: 1
val acc:0.8621817231178284, best validation acc: 0.8717589378356934, corresponding to test acc:                         0.8432421684265137 / 0.8432421684265137
after epoch: 20,now: 2024-08-07 11:21:50.239515,epoch time: 0:12:53.817495,used: 4:16:24.006602,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_07_07_05_26_seed_2_24076682
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 4:16:24.006602 at 2024-08-07 11:21:50.239515
persisted model performance metric: 

scalar performance:
{'acc': 0.84324217, 'precision': 0.6413389, 'recall': 0.81051254, 'specificity': 0.81051254, 'f1': 0.6731725, 'auroc': 0.87988067, 'binary_precision': 0.30521092, 'binary_recall': 0.77164364, 'binary_specificity': 0.8493814, 'binary_f1_score': 0.43741107}
confusion matrix:
      0     1
0  7895  1400
1   182   615
oracle model performance metric: 

scalar performance:
{'acc': 0.84324217, 'precision': 0.6413389, 'recall': 0.81051254, 'specificity': 0.81051254, 'f1': 0.6731725, 'auroc': 0.87988067, 'binary_precision': 0.30521092, 'binary_recall': 0.77164364, 'binary_specificity': 0.8493814, 'binary_f1_score': 0.43741107}
confusion matrix:
      0     1
0  7895  1400
1   182   615
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-06_02-18-57/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191688 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 173494 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  18194 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189462 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |  16648 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1066 MiB | 565248 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1008 MiB | 544768 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     58 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  41783 KiB |  89169 KiB | 611402 GiB | 611402 GiB |
|       from large pool |  31306 KiB |  79704 KiB | 588394 GiB | 588394 GiB |
|       from small pool |  10477 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4400    |    6945    |  246586 K  |  246582 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140325 K  |  140320 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4400    |    6945    |  246586 K  |  246582 K  |
|       from large pool |      76    |     158    |  106261 K  |  106261 K  |
|       from small pool |    4324    |    6867    |  140325 K  |  140320 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      74    |      33    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3250    |  133130 K  |  133130 K  |
|       from large pool |      10    |      23    |   64621 K  |   64621 K  |
|       from small pool |      21    |    3240    |   68509 K  |   68509 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 462230 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  17088 KiB | 427880 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  39230 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457745 KiB |   1074 TiB |   1074 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1052 TiB |   1052 TiB |
|       from small pool |      0 KiB |  37683 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |   1066 MiB |    838 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1008 MiB |    808 MiB |
|       from small pool |  28672 KiB |  43008 KiB |     58 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89169 KiB | 611403 GiB | 611403 GiB |
|       from large pool |  23872 KiB |  79704 KiB | 588394 GiB | 588394 GiB |
|       from small pool |      0 KiB |  25762 KiB |  23008 GiB |  23008 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6945    |  246586 K  |  246586 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140325 K  |  140325 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6945    |  246586 K  |  246586 K  |
|       from large pool |       2    |     158    |  106261 K  |  106261 K  |
|       from small pool |       0    |    6867    |  140325 K  |  140325 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      74    |      50    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      14    |      21    |      29    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3250    |  133132 K  |  133132 K  |
|       from large pool |       3    |      23    |   64621 K  |   64621 K  |
|       from small pool |       0    |    3240    |   68511 K  |   68511 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Aug  7 11:35:32 2024]
Finished job 0.
1 of 1 steps (100%) done
