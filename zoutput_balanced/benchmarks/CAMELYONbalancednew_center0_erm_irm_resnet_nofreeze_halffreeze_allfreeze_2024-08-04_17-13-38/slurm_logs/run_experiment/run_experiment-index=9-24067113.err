Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 17:16:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113

 Experiment start at: 2024-08-04 17:30:20.507489
before training, model accuracy: 0.31048259139060974
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94454324, 'precision': 0.94696397, 'recall': 0.9445151, 'specificity': 0.9445151, 'f1': 0.9444656, 'auroc': 0.99265456, 'binary_precision': 0.9142616, 'binary_recall': 0.981186, 'binary_specificity': 0.90784425, 'binary_f1_score': 0.9465423}
confusion matrix:
       0      1
0  26017   2641
1    540  28162
---- Validation: 
scalar performance:
{'acc': 0.803427, 'precision': 0.54768395, 'recall': 0.7377195, 'specificity': 0.7377195, 'f1': 0.5383288, 'auroc': 0.77744997, 'binary_precision': 0.10974674, 'binary_recall': 0.66718507, 'binary_specificity': 0.8082539, 'binary_f1_score': 0.18848857}
confusion matrix:
       0     1
0  14669  3480
1    214   429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813998, 'precision': 0.5690905, 'recall': 0.8236436, 'specificity': 0.8236436, 'f1': 0.5606272, 'auroc': 0.9071183, 'binary_precision': 0.1454196, 'binary_recall': 0.8697318, 'binary_specificity': 0.77755547, 'binary_f1_score': 0.24917673}
confusion matrix:
      0     1
0  4663  1334
1    34   227
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 17:44:18.717370,epoch time: 0:13:58.209881,used: 0:13:58.209881,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9710774, 'precision': 0.9711306, 'recall': 0.9710728, 'specificity': 0.9710728, 'f1': 0.97107637, 'auroc': 0.9958315, 'binary_precision': 0.96634364, 'binary_recall': 0.9762071, 'binary_specificity': 0.96593845, 'binary_f1_score': 0.97125036}
confusion matrix:
       0      1
0  27678    976
1    683  28023
---- Validation: 
scalar performance:
{'acc': 0.9302363, 'precision': 0.61014026, 'recall': 0.71186376, 'specificity': 0.71186376, 'f1': 0.641098, 'auroc': 0.8020204, 'binary_precision': 0.23946957, 'binary_recall': 0.47744945, 'binary_specificity': 0.94627804, 'binary_f1_score': 0.31896102}
confusion matrix:
       0    1
0  17174  975
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9201023, 'precision': 0.65182245, 'recall': 0.8502048, 'specificity': 0.8502048, 'f1': 0.7019219, 'auroc': 0.91139627, 'binary_precision': 0.31415242, 'binary_recall': 0.77394634, 'binary_specificity': 0.92646325, 'binary_f1_score': 0.44690266}
confusion matrix:
      0    1
0  5556  441
1    59  202
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 17:54:32.114548,epoch time: 0:10:13.397178,used: 0:24:11.607059,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9752964, 'precision': 0.97535807, 'recall': 0.9752923, 'specificity': 0.9752923, 'f1': 0.97529536, 'auroc': 0.9965126, 'binary_precision': 0.970122, 'binary_recall': 0.9808369, 'binary_specificity': 0.9697477, 'binary_f1_score': 0.97545}
confusion matrix:
       0      1
0  27792    867
1    550  28151
---- Validation: 
scalar performance:
{'acc': 0.90565133, 'precision': 0.56643325, 'recall': 0.6601329, 'specificity': 0.6601329, 'f1': 0.58658254, 'auroc': 0.72489524, 'binary_precision': 0.1554878, 'binary_recall': 0.39657855, 'binary_specificity': 0.9236873, 'binary_f1_score': 0.2233903}
confusion matrix:
       0     1
0  16764  1385
1    388   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85666347, 'precision': 0.5964144, 'recall': 0.8409252, 'specificity': 0.8409252, 'f1': 0.62193555, 'auroc': 0.91561615, 'binary_precision': 0.20168856, 'binary_recall': 0.8237548, 'binary_specificity': 0.8580957, 'binary_f1_score': 0.3240392}
confusion matrix:
      0    1
0  5146  851
1    46  215
early stop counter: 1
val acc:0.905651330947876, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 3,now: 2024-08-04 18:04:40.797438,epoch time: 0:10:08.682890,used: 0:34:20.289949,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9458682, 'precision': 0.9480442, 'recall': 0.94584155, 'specificity': 0.94584155, 'f1': 0.94580007, 'auroc': 0.9939754, 'binary_precision': 0.9170115, 'binary_recall': 0.9805589, 'binary_specificity': 0.9111243, 'binary_f1_score': 0.9477211}
confusion matrix:
       0      1
0  26111   2547
1    558  28144
---- Validation: 
scalar performance:
{'acc': 0.7458493, 'precision': 0.5142659, 'recall': 0.5804013, 'specificity': 0.5804013, 'f1': 0.47496852, 'auroc': 0.58996797, 'binary_precision': 0.05568695, 'binary_recall': 0.40279937, 'binary_specificity': 0.7580032, 'binary_f1_score': 0.09784662}
confusion matrix:
       0     1
0  13757  4392
1    384   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57350594, 'precision': 0.5390172, 'recall': 0.7426577, 'specificity': 0.7426577, 'f1': 0.4342232, 'auroc': 0.89809597, 'binary_precision': 0.08367912, 'binary_recall': 0.92720306, 'binary_specificity': 0.5581124, 'binary_f1_score': 0.1535046}
confusion matrix:
      0     1
0  3347  2650
1    19   242
early stop counter: 2
val acc:0.7458493113517761, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 4,now: 2024-08-04 18:14:46.041812,epoch time: 0:10:05.244374,used: 0:44:25.534323,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9553522, 'precision': 0.9570254, 'recall': 0.955328, 'specificity': 0.955328, 'f1': 0.9553095, 'auroc': 0.995859, 'binary_precision': 0.92957145, 'binary_recall': 0.98543704, 'binary_specificity': 0.92521894, 'binary_f1_score': 0.95668936}
confusion matrix:
       0      1
0  26514   2143
1    418  28285
---- Validation: 
scalar performance:
{'acc': 0.8173691, 'precision': 0.5280212, 'recall': 0.6234286, 'specificity': 0.6234286, 'f1': 0.51627815, 'auroc': 0.63164026, 'binary_precision': 0.08034908, 'binary_recall': 0.41524106, 'binary_specificity': 0.83161604, 'binary_f1_score': 0.13464446}
confusion matrix:
       0     1
0  15093  3056
1    376   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6724193, 'precision': 0.5496586, 'recall': 0.78693753, 'specificity': 0.78693753, 'f1': 0.4916175, 'auroc': 0.92038167, 'binary_precision': 0.10507726, 'binary_recall': 0.9118774, 'binary_specificity': 0.6619977, 'binary_f1_score': 0.18844022}
confusion matrix:
      0     1
0  3970  2027
1    23   238
early stop counter: 3
val acc:0.8173691034317017, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 5,now: 2024-08-04 18:24:35.405120,epoch time: 0:09:49.363308,used: 0:54:14.897631,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92156553, 'precision': 0.92917675, 'recall': 0.92151916, 'specificity': 0.92151916, 'f1': 0.9212104, 'auroc': 0.9943464, 'binary_precision': 0.8721971, 'binary_recall': 0.9880139, 'binary_specificity': 0.8550244, 'binary_f1_score': 0.9265001}
confusion matrix:
       0      1
0  24505   4155
1    344  28356
---- Validation: 
scalar performance:
{'acc': 0.4799915, 'precision': 0.49500677, 'recall': 0.4622643, 'specificity': 0.4622643, 'f1': 0.3482021, 'auroc': 0.54442686, 'binary_precision': 0.029384473, 'binary_recall': 0.44323483, 'binary_specificity': 0.48129374, 'binary_f1_score': 0.055115066}
confusion matrix:
      0     1
0  8735  9414
1   358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.18791947, 'precision': 0.5237948, 'recall': 0.5744558, 'specificity': 0.5744558, 'f1': 0.17889681, 'auroc': 0.8840568, 'binary_precision': 0.048680022, 'binary_recall': 0.99616855, 'binary_specificity': 0.15274304, 'binary_f1_score': 0.092824}
confusion matrix:
     0     1
0  916  5081
1    1   260
early stop counter: 4
val acc:0.47999149560928345, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 6,now: 2024-08-04 18:34:28.647850,epoch time: 0:09:53.242730,used: 1:04:08.140361,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9, 'precision': 0.91354823, 'recall': 0.8999275, 'specificity': 0.8999275, 'f1': 0.8991623, 'auroc': 0.9926001, 'binary_precision': 0.8388963, 'binary_recall': 0.9903494, 'binary_specificity': 0.8095055, 'binary_f1_score': 0.90835303}
confusion matrix:
       0      1
0  23198   5459
1    277  28426
---- Validation: 
scalar performance:
{'acc': 0.37526608, 'precision': 0.4883393, 'recall': 0.41704708, 'specificity': 0.41704708, 'f1': 0.29160452, 'auroc': 0.49718982, 'binary_precision': 0.025404157, 'binary_recall': 0.46189734, 'binary_specificity': 0.37219682, 'binary_f1_score': 0.048159562}
confusion matrix:
      0      1
0  6755  11394
1   346    297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.11393417, 'precision': 0.52129704, 'recall': 0.53585315, 'specificity': 0.53585315, 'f1': 0.11309059, 'auroc': 0.8773798, 'binary_precision': 0.04479669, 'binary_recall': 0.99616855, 'binary_specificity': 0.07553777, 'binary_f1_score': 0.08573784}
confusion matrix:
     0     1
0  453  5544
1    1   260
early stop counter: 5
val acc:0.37526607513427734, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 7,now: 2024-08-04 18:44:25.664333,epoch time: 0:09:57.016483,used: 1:14:05.156844,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9356869, 'precision': 0.94044495, 'recall': 0.93564534, 'specificity': 0.93564534, 'f1': 0.9355085, 'auroc': 0.99522734, 'binary_precision': 0.89486647, 'binary_recall': 0.9874926, 'binary_specificity': 0.883798, 'binary_f1_score': 0.9389006}
confusion matrix:
       0      1
0  25327   3330
1    359  28344
---- Validation: 
scalar performance:
{'acc': 0.6219668, 'precision': 0.5052581, 'recall': 0.5372671, 'specificity': 0.5372671, 'f1': 0.41860738, 'auroc': 0.56172556, 'binary_precision': 0.04079602, 'binary_recall': 0.44634527, 'binary_specificity': 0.6281889, 'binary_f1_score': 0.07475906}
confusion matrix:
       0     1
0  11401  6748
1    356   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3135187, 'precision': 0.52824646, 'recall': 0.63998854, 'specificity': 0.63998854, 'f1': 0.27502567, 'auroc': 0.8999468, 'binary_precision': 0.05708013, 'binary_recall': 0.99616855, 'binary_specificity': 0.28380856, 'binary_f1_score': 0.10797342}
confusion matrix:
      0     1
0  1702  4295
1     1   260
early stop counter: 6
val acc:0.6219667792320251, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 8,now: 2024-08-04 18:54:22.464076,epoch time: 0:09:56.799743,used: 1:24:01.956587,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96239537, 'precision': 0.96342385, 'recall': 0.9623774, 'specificity': 0.9623774, 'f1': 0.9623735, 'auroc': 0.9964365, 'binary_precision': 0.9417834, 'binary_recall': 0.98578495, 'binary_specificity': 0.9389699, 'binary_f1_score': 0.9632819}
confusion matrix:
       0      1
0  26909   1749
1    408  28294
---- Validation: 
scalar performance:
{'acc': 0.81566626, 'precision': 0.5280806, 'recall': 0.6247971, 'specificity': 0.6247971, 'f1': 0.51585424, 'auroc': 0.59864897, 'binary_precision': 0.08033323, 'binary_recall': 0.41990668, 'binary_specificity': 0.8296876, 'binary_f1_score': 0.13486512}
confusion matrix:
       0     1
0  15058  3091
1    373   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67929053, 'precision': 0.55070597, 'recall': 0.7905227, 'specificity': 0.7905227, 'f1': 0.49583188, 'auroc': 0.91968775, 'binary_precision': 0.10711071, 'binary_recall': 0.9118774, 'binary_specificity': 0.66916794, 'binary_f1_score': 0.19170357}
confusion matrix:
      0     1
0  4013  1984
1    23   238
early stop counter: 7
val acc:0.8156662583351135, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 9,now: 2024-08-04 19:04:24.850207,epoch time: 0:10:02.386131,used: 1:34:04.342718,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9208159, 'precision': 0.9289256, 'recall': 0.92076087, 'specificity': 0.92076087, 'f1': 0.92043287, 'auroc': 0.994411, 'binary_precision': 0.8701474, 'binary_recall': 0.9894088, 'binary_specificity': 0.85211295, 'binary_f1_score': 0.92595375}
confusion matrix:
       0      1
0  24419   4238
1    304  28399
---- Validation: 
scalar performance:
{'acc': 0.50399107, 'precision': 0.49724862, 'recall': 0.47918954, 'specificity': 0.47918954, 'f1': 0.36102048, 'auroc': 0.54770625, 'binary_precision': 0.031425487, 'binary_recall': 0.4525661, 'binary_specificity': 0.505813, 'binary_f1_score': 0.05877007}
confusion matrix:
      0     1
0  9180  8969
1   352   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.27356982, 'precision': 0.52671105, 'recall': 0.6191448, 'specificity': 0.6191448, 'f1': 0.24622187, 'auroc': 0.84730196, 'binary_precision': 0.054110304, 'binary_recall': 0.99616855, 'binary_specificity': 0.24212106, 'binary_f1_score': 0.102645084}
confusion matrix:
      0     1
0  1452  4545
1     1   260
early stop counter: 8
val acc:0.5039910674095154, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 10,now: 2024-08-04 19:14:20.236511,epoch time: 0:09:55.386304,used: 1:43:59.729022,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9499651, 'precision': 0.95312726, 'recall': 0.9499332, 'specificity': 0.9499332, 'f1': 0.94987524, 'auroc': 0.99697256, 'binary_precision': 0.9154658, 'binary_recall': 0.9915685, 'binary_specificity': 0.90829784, 'binary_f1_score': 0.95199865}
confusion matrix:
       0      1
0  26030   2628
1    242  28460
---- Validation: 
scalar performance:
{'acc': 0.7221158, 'precision': 0.5140702, 'recall': 0.58461535, 'specificity': 0.58461535, 'f1': 0.46647534, 'auroc': 0.6173457, 'binary_precision': 0.054658625, 'binary_recall': 0.43701398, 'binary_specificity': 0.73221666, 'binary_f1_score': 0.09716459}
confusion matrix:
       0     1
0  13289  4860
1    362   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58325344, 'precision': 0.541422, 'recall': 0.7569053, 'specificity': 0.7569053, 'f1': 0.44110894, 'auroc': 0.9300691, 'binary_precision': 0.08694122, 'binary_recall': 0.9463602, 'binary_specificity': 0.5674504, 'binary_f1_score': 0.1592521}
confusion matrix:
      0     1
0  3403  2594
1    14   247
early stop counter: 9
val acc:0.7221158146858215, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 11,now: 2024-08-04 19:24:22.101320,epoch time: 0:10:01.864809,used: 1:54:01.593831,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9669456, 'precision': 0.96783745, 'recall': 0.96692896, 'specificity': 0.96692896, 'f1': 0.96692896, 'auroc': 0.99753976, 'binary_precision': 0.9476022, 'binary_recall': 0.98860705, 'binary_specificity': 0.94525087, 'binary_f1_score': 0.96767044}
confusion matrix:
       0      1
0  27089   1569
1    327  28375
---- Validation: 
scalar performance:
{'acc': 0.79097486, 'precision': 0.5231212, 'recall': 0.6135142, 'specificity': 0.6135142, 'f1': 0.501509, 'auroc': 0.6125557, 'binary_precision': 0.07103682, 'binary_recall': 0.4230171, 'binary_specificity': 0.8040112, 'binary_f1_score': 0.12164579}
confusion matrix:
       0     1
0  14592  3557
1    371   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6935123, 'precision': 0.553907, 'recall': 0.80344003, 'specificity': 0.80344003, 'f1': 0.50561637, 'auroc': 0.926232, 'binary_precision': 0.112669475, 'binary_recall': 0.9233717, 'binary_specificity': 0.6835084, 'binary_f1_score': 0.20083334}
confusion matrix:
      0     1
0  4099  1898
1    20   241
early stop counter: 10
val acc:0.7909748554229736, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 12,now: 2024-08-04 19:34:15.916986,epoch time: 0:09:53.815666,used: 2:03:55.409497,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9577755, 'precision': 0.9595332, 'recall': 0.9577476, 'specificity': 0.9577476, 'f1': 0.95773315, 'auroc': 0.9969073, 'binary_precision': 0.9313378, 'binary_recall': 0.9885042, 'binary_specificity': 0.926991, 'binary_f1_score': 0.95906985}
confusion matrix:
       0      1
0  26562   2092
1    330  28376
---- Validation: 
scalar performance:
{'acc': 0.7739996, 'precision': 0.52107733, 'recall': 0.6099762, 'specificity': 0.6099762, 'f1': 0.49328217, 'auroc': 0.59441143, 'binary_precision': 0.06703508, 'binary_recall': 0.43390357, 'binary_specificity': 0.7860488, 'binary_f1_score': 0.11612903}
confusion matrix:
       0     1
0  14266  3883
1    364   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59316075, 'precision': 0.5427188, 'recall': 0.76390684, 'specificity': 0.76390684, 'f1': 0.44715756, 'auroc': 0.88694096, 'binary_precision': 0.08917656, 'binary_recall': 0.95019156, 'binary_specificity': 0.5776221, 'binary_f1_score': 0.16305062}
confusion matrix:
      0     1
0  3464  2533
1    13   248
early stop counter: 11
val acc:0.7739995718002319, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 13,now: 2024-08-04 19:44:09.037824,epoch time: 0:09:53.120838,used: 2:13:48.530335,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95381796, 'precision': 0.95563453, 'recall': 0.9537939, 'specificity': 0.9537939, 'f1': 0.95377016, 'auroc': 0.9957459, 'binary_precision': 0.9270564, 'binary_recall': 0.9852275, 'binary_specificity': 0.92236024, 'binary_f1_score': 0.9552571}
confusion matrix:
       0      1
0  26433   2225
1    424  28278
---- Validation: 
scalar performance:
{'acc': 0.74228394, 'precision': 0.5159706, 'recall': 0.5913064, 'specificity': 0.5913064, 'f1': 0.4759309, 'auroc': 0.57672656, 'binary_precision': 0.058080807, 'binary_recall': 0.42923796, 'binary_specificity': 0.7533748, 'binary_f1_score': 0.10231696}
confusion matrix:
       0     1
0  13673  4476
1    367   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6660275, 'precision': 0.5513851, 'recall': 0.80009353, 'specificity': 0.80009353, 'f1': 0.49037278, 'auroc': 0.92199546, 'binary_precision': 0.106328025, 'binary_recall': 0.9463602, 'binary_specificity': 0.6538269, 'binary_f1_score': 0.19117646}
confusion matrix:
      0     1
0  3921  2076
1    14   247
early stop counter: 12
val acc:0.7422839403152466, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 14,now: 2024-08-04 19:54:07.067503,epoch time: 0:09:58.029679,used: 2:23:46.560014,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93195605, 'precision': 0.93797344, 'recall': 0.9319051, 'specificity': 0.9319051, 'f1': 0.931716, 'auroc': 0.994611, 'binary_precision': 0.88685423, 'binary_recall': 0.99038494, 'binary_specificity': 0.87342525, 'binary_f1_score': 0.9357647}
confusion matrix:
       0      1
0  25028   3627
1    276  28429
---- Validation: 
scalar performance:
{'acc': 0.5086207, 'precision': 0.49766386, 'recall': 0.48233643, 'specificity': 0.48233643, 'f1': 0.3634588, 'auroc': 0.53564024, 'binary_precision': 0.031825613, 'binary_recall': 0.4541213, 'binary_specificity': 0.5105516, 'binary_f1_score': 0.059482582}
confusion matrix:
      0     1
0  9266  8883
1   351   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.27404922, 'precision': 0.52672863, 'recall': 0.61939496, 'specificity': 0.61939496, 'f1': 0.24657634, 'auroc': 0.9038267, 'binary_precision': 0.054144107, 'binary_recall': 0.99616855, 'binary_specificity': 0.24262132, 'binary_f1_score': 0.10270591}
confusion matrix:
      0     1
0  1455  4542
1     1   260
early stop counter: 13
val acc:0.5086206793785095, best validation acc: 0.930236279964447, corresponding to test acc:                         0.9201022982597351 / 0.9201022982597351
after epoch: 15,now: 2024-08-04 20:04:06.540409,epoch time: 0:09:59.472906,used: 2:33:46.032920,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:46.032920 at 2024-08-04 20:04:06.540409
persisted model performance metric: 

scalar performance:
{'acc': 0.9201023, 'precision': 0.65182245, 'recall': 0.8502048, 'specificity': 0.8502048, 'f1': 0.7019219, 'auroc': 0.91139627, 'binary_precision': 0.31415242, 'binary_recall': 0.77394634, 'binary_specificity': 0.92646325, 'binary_f1_score': 0.44690266}
confusion matrix:
      0    1
0  5556  441
1    59  202
oracle model performance metric: 

scalar performance:
{'acc': 0.9201023, 'precision': 0.65182245, 'recall': 0.8502048, 'specificity': 0.8502048, 'f1': 0.7019219, 'auroc': 0.91139627, 'binary_precision': 0.31415242, 'binary_recall': 0.77394634, 'binary_specificity': 0.92646325, 'binary_f1_score': 0.44690266}
confusion matrix:
      0    1
0  5556  441
1    59  202
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 533599 KiB |   6391 MiB | 441184 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440491 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 533599 KiB |   6391 MiB | 441184 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440491 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522828 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool | 436736 KiB |   6277 MiB | 439103 GiB | 439102 GiB |
|       from small pool |  86092 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6564 MiB |   6564 MiB |   6564 MiB |      0 B   |
|       from large pool |   6440 MiB |   6440 MiB |   6440 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    932 MiB |   1266 MiB | 238382 GiB | 238382 GiB |
|       from large pool |    928 MiB |   1263 MiB | 237669 GiB | 237668 GiB |
|       from small pool |      4 MiB |     10 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3630    |    8317    |   53655 K  |   53651 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31489 K  |   31486 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3630    |    8317    |   53655 K  |   53651 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31489 K  |   31486 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     133    |     133    |       0    |
|       from large pool |      71    |      71    |      71    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3612    |   25028 K  |   25028 K  |
|       from large pool |      19    |      36    |    8794 K  |    8794 K  |
|       from small pool |      51    |    3594    |   16233 K  |   16233 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441184 GiB | 441184 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441184 GiB | 441184 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439103 GiB | 439103 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238383 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     27 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53655 K  |   53655 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31489 K  |   31489 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53655 K  |   53655 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31489 K  |   31489 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441184 GiB | 441184 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441184 GiB | 441184 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439103 GiB | 439103 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238383 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     27 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53655 K  |   53655 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31489 K  |   31489 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53655 K  |   53655 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31489 K  |   31489 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113

 Experiment start at: 2024-08-04 20:10:18.993641
before training, model accuracy: 0.14582662284374237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96775204, 'precision': 0.9677541, 'recall': 0.96775293, 'specificity': 0.96775293, 'f1': 0.967752, 'auroc': 0.9943098, 'binary_precision': 0.9689467, 'binary_recall': 0.96652675, 'binary_specificity': 0.96897906, 'binary_f1_score': 0.9677352}
confusion matrix:
       0      1
0  27894    893
1    965  27864
---- Validation: 
scalar performance:
{'acc': 0.92171824, 'precision': 0.60652757, 'recall': 0.7240782, 'specificity': 0.7240782, 'f1': 0.6388644, 'auroc': 0.8078816, 'binary_precision': 0.23211876, 'binary_recall': 0.5111441, 'binary_specificity': 0.93701226, 'binary_f1_score': 0.3192575}
confusion matrix:
       0     1
0  16929  1138
1    329   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94489205, 'precision': 0.69548845, 'recall': 0.81676626, 'specificity': 0.81676626, 'f1': 0.7390094, 'auroc': 0.85909986, 'binary_precision': 0.40552995, 'binary_recall': 0.6769231, 'binary_specificity': 0.9566095, 'binary_f1_score': 0.50720465}
confusion matrix:
      0    1
0  5688  258
1    84  176
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 20:21:44.216327,epoch time: 0:11:25.222686,used: 0:11:25.222686,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9733928, 'precision': 0.97339416, 'recall': 0.9733923, 'specificity': 0.9733923, 'f1': 0.9733927, 'auroc': 0.9955791, 'binary_precision': 0.9727389, 'binary_recall': 0.9741224, 'binary_specificity': 0.9726622, 'binary_f1_score': 0.9734302}
confusion matrix:
       0      1
0  28001    787
1    746  28082
---- Validation: 
scalar performance:
{'acc': 0.88708645, 'precision': 0.56602097, 'recall': 0.6882356, 'specificity': 0.6882356, 'f1': 0.5853644, 'auroc': 0.7631532, 'binary_precision': 0.15329169, 'binary_recall': 0.47399703, 'binary_specificity': 0.9024741, 'binary_f1_score': 0.23166305}
confusion matrix:
       0     1
0  16305  1762
1    354   319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88172734, 'precision': 0.61390436, 'recall': 0.8518455, 'specificity': 0.8518455, 'f1': 0.65100425, 'auroc': 0.91631025, 'binary_precision': 0.23666666, 'binary_recall': 0.8192308, 'binary_specificity': 0.88446015, 'binary_f1_score': 0.36724138}
confusion matrix:
      0    1
0  5259  687
1    47  213
early stop counter: 1
val acc:0.8870864510536194, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 2,now: 2024-08-04 20:31:44.356362,epoch time: 0:10:00.140035,used: 0:21:25.362721,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9688281, 'precision': 0.96890426, 'recall': 0.9688238, 'specificity': 0.9688238, 'f1': 0.96882665, 'auroc': 0.99439895, 'binary_precision': 0.96309876, 'binary_recall': 0.975059, 'binary_specificity': 0.9625886, 'binary_f1_score': 0.96904194}
confusion matrix:
       0      1
0  27711   1077
1    719  28109
---- Validation: 
scalar performance:
{'acc': 0.83516544, 'precision': 0.5315515, 'recall': 0.6205378, 'specificity': 0.6205378, 'f1': 0.5269111, 'auroc': 0.6135017, 'binary_precision': 0.08911565, 'binary_recall': 0.38930163, 'binary_specificity': 0.851774, 'binary_f1_score': 0.14503184}
confusion matrix:
       0     1
0  15389  2678
1    411   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71382535, 'precision': 0.55620205, 'recall': 0.80468124, 'specificity': 0.80468124, 'f1': 0.51728046, 'auroc': 0.91678244, 'binary_precision': 0.118328296, 'binary_recall': 0.90384614, 'binary_specificity': 0.70551634, 'binary_f1_score': 0.2092609}
confusion matrix:
      0     1
0  4195  1751
1    25   235
early stop counter: 2
val acc:0.8351654410362244, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 3,now: 2024-08-04 20:41:46.177877,epoch time: 0:10:01.821515,used: 0:31:27.184236,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9765343, 'precision': 0.97654617, 'recall': 0.9765326, 'specificity': 0.9765326, 'f1': 0.9765341, 'auroc': 0.9963546, 'binary_precision': 0.9743466, 'binary_recall': 0.97887546, 'binary_specificity': 0.97418976, 'binary_f1_score': 0.9766058}
confusion matrix:
       0      1
0  28044    743
1    609  28220
---- Validation: 
scalar performance:
{'acc': 0.85058695, 'precision': 0.53408927, 'recall': 0.61852205, 'specificity': 0.61852205, 'f1': 0.53428787, 'auroc': 0.6231541, 'binary_precision': 0.094548225, 'binary_recall': 0.36849925, 'binary_specificity': 0.8685449, 'binary_f1_score': 0.15048543}
confusion matrix:
       0     1
0  15692  2375
1    425   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.768611, 'precision': 0.56668323, 'recall': 0.82223797, 'specificity': 0.82223797, 'f1': 0.5526442, 'auroc': 0.92382854, 'binary_precision': 0.14014688, 'binary_recall': 0.88076925, 'binary_specificity': 0.7637067, 'binary_f1_score': 0.24181627}
confusion matrix:
      0     1
0  4541  1405
1    31   229
early stop counter: 3
val acc:0.8505869507789612, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 4,now: 2024-08-04 20:51:42.669865,epoch time: 0:09:56.491988,used: 0:41:23.676224,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96948767, 'precision': 0.9695933, 'recall': 0.96948206, 'specificity': 0.96948206, 'f1': 0.96948564, 'auroc': 0.9948243, 'binary_precision': 0.9627376, 'binary_recall': 0.9768297, 'binary_specificity': 0.96213436, 'binary_f1_score': 0.96973246}
confusion matrix:
       0      1
0  27696   1090
1    668  28162
---- Validation: 
scalar performance:
{'acc': 0.84268945, 'precision': 0.5354776, 'recall': 0.6308773, 'specificity': 0.6308773, 'f1': 0.5342847, 'auroc': 0.5859932, 'binary_precision': 0.096201636, 'binary_recall': 0.4026746, 'binary_specificity': 0.8590801, 'binary_f1_score': 0.15530086}
confusion matrix:
       0     1
0  15521  2546
1    402   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75153077, 'precision': 0.5632986, 'recall': 0.81884134, 'specificity': 0.81884134, 'f1': 0.5415612, 'auroc': 0.9176583, 'binary_precision': 0.13287514, 'binary_recall': 0.8923077, 'binary_specificity': 0.74537504, 'binary_f1_score': 0.23130609}
confusion matrix:
      0     1
0  4432  1514
1    28   232
early stop counter: 4
val acc:0.8426894545555115, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 5,now: 2024-08-04 21:01:32.896929,epoch time: 0:09:50.227064,used: 0:51:13.903288,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96822065, 'precision': 0.96842265, 'recall': 0.96821356, 'specificity': 0.96821356, 'f1': 0.9682169, 'auroc': 0.99553347, 'binary_precision': 0.9588673, 'binary_recall': 0.97845846, 'binary_specificity': 0.9579686, 'binary_f1_score': 0.96856385}
confusion matrix:
       0      1
0  27578   1210
1    621  28207
---- Validation: 
scalar performance:
{'acc': 0.87251866, 'precision': 0.5474189, 'recall': 0.644917, 'specificity': 0.644917, 'f1': 0.5573329, 'auroc': 0.6368569, 'binary_precision': 0.11934339, 'binary_recall': 0.39970282, 'binary_specificity': 0.8901312, 'binary_f1_score': 0.18380596}
confusion matrix:
       0     1
0  16082  1985
1    404   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85723495, 'precision': 0.59515584, 'recall': 0.83170784, 'specificity': 0.83170784, 'f1': 0.6203949, 'auroc': 0.9072305, 'binary_precision': 0.20019157, 'binary_recall': 0.8038462, 'binary_specificity': 0.85956943, 'binary_f1_score': 0.32055214}
confusion matrix:
      0    1
0  5111  835
1    51  209
early stop counter: 5
val acc:0.8725186586380005, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 6,now: 2024-08-04 21:11:24.391906,epoch time: 0:09:51.494977,used: 1:01:05.398265,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96678007, 'precision': 0.96709466, 'recall': 0.9667707, 'specificity': 0.9667707, 'f1': 0.966774, 'auroc': 0.99513716, 'binary_precision': 0.9551527, 'binary_recall': 0.9796039, 'binary_specificity': 0.95393753, 'binary_f1_score': 0.9672238}
confusion matrix:
       0      1
0  27461   1326
1    588  28241
---- Validation: 
scalar performance:
{'acc': 0.8115795, 'precision': 0.5284412, 'recall': 0.62261087, 'specificity': 0.62261087, 'f1': 0.51598144, 'auroc': 0.60517466, 'binary_precision': 0.08240795, 'binary_recall': 0.4190193, 'binary_specificity': 0.82620245, 'binary_f1_score': 0.13772894}
confusion matrix:
       0     1
0  14927  3140
1    391   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7044795, 'precision': 0.55570817, 'recall': 0.80715996, 'specificity': 0.80715996, 'f1': 0.51258165, 'auroc': 0.92076313, 'binary_precision': 0.11647174, 'binary_recall': 0.91923076, 'binary_specificity': 0.69508916, 'binary_f1_score': 0.20674741}
confusion matrix:
      0     1
0  4133  1813
1    21   239
early stop counter: 6
val acc:0.8115795254707336, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 7,now: 2024-08-04 21:21:21.642824,epoch time: 0:09:57.250918,used: 1:11:02.649183,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9261316, 'precision': 0.9321773, 'recall': 0.92608654, 'specificity': 0.92608654, 'f1': 0.9258671, 'auroc': 0.9937495, 'binary_precision': 0.88125235, 'binary_recall': 0.98511964, 'binary_specificity': 0.86705345, 'binary_f1_score': 0.93029577}
confusion matrix:
       0      1
0  24959   3827
1    429  28401
---- Validation: 
scalar performance:
{'acc': 0.62630737, 'precision': 0.5051137, 'recall': 0.53439206, 'specificity': 0.53439206, 'f1': 0.42146623, 'auroc': 0.57303166, 'binary_precision': 0.04236553, 'binary_recall': 0.43536404, 'binary_specificity': 0.63342005, 'binary_f1_score': 0.07721703}
confusion matrix:
       0     1
0  11444  6623
1    380   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38865614, 'precision': 0.53138804, 'recall': 0.677284, 'specificity': 0.677284, 'f1': 0.32572109, 'auroc': 0.9215791, 'binary_precision': 0.0637037, 'binary_recall': 0.99230766, 'binary_specificity': 0.36226034, 'binary_f1_score': 0.11972158}
confusion matrix:
      0     1
0  2154  3792
1     2   258
early stop counter: 7
val acc:0.6263073682785034, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 8,now: 2024-08-04 21:31:28.186075,epoch time: 0:10:06.543251,used: 1:21:09.192434,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94911134, 'precision': 0.95168686, 'recall': 0.9490839, 'specificity': 0.9490839, 'f1': 0.9490365, 'auroc': 0.99557054, 'binary_precision': 0.9177609, 'binary_recall': 0.9867148, 'binary_specificity': 0.91145307, 'binary_f1_score': 0.95098954}
confusion matrix:
       0      1
0  26238   2549
1    383  28446
---- Validation: 
scalar performance:
{'acc': 0.72454643, 'precision': 0.5138652, 'recall': 0.57890385, 'specificity': 0.57890385, 'f1': 0.46827236, 'auroc': 0.5728001, 'binary_precision': 0.05615978, 'binary_recall': 0.42199108, 'binary_specificity': 0.73581666, 'binary_f1_score': 0.099127404}
confusion matrix:
       0     1
0  13294  4773
1    389   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4779246, 'precision': 0.53561246, 'recall': 0.718353, 'specificity': 0.718353, 'f1': 0.3809762, 'auroc': 0.93642867, 'binary_precision': 0.0730659, 'binary_recall': 0.9807692, 'binary_specificity': 0.45593676, 'binary_f1_score': 0.13599999}
confusion matrix:
      0     1
0  2711  3235
1     5   255
early stop counter: 8
val acc:0.7245464324951172, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 9,now: 2024-08-04 21:41:30.189037,epoch time: 0:10:02.002962,used: 1:31:11.195396,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9045751, 'precision': 0.9165578, 'recall': 0.9045163, 'specificity': 0.9045163, 'f1': 0.90387475, 'auroc': 0.99382025, 'binary_precision': 0.84608084, 'binary_recall': 0.98924655, 'binary_specificity': 0.819786, 'binary_f1_score': 0.9120798}
confusion matrix:
       0      1
0  23600   5188
1    310  28518
---- Validation: 
scalar performance:
{'acc': 0.49466383, 'precision': 0.49669445, 'recall': 0.47613215, 'specificity': 0.47613215, 'f1': 0.35760882, 'auroc': 0.5696929, 'binary_precision': 0.032621402, 'binary_recall': 0.45616642, 'binary_specificity': 0.49609786, 'binary_f1_score': 0.06088854}
confusion matrix:
      0     1
0  8963  9104
1   366   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.19803417, 'precision': 0.52482337, 'recall': 0.58148336, 'specificity': 0.58148336, 'f1': 0.18742867, 'auroc': 0.916759, 'binary_precision': 0.049646743, 'binary_recall': 1.0, 'binary_specificity': 0.1629667, 'binary_f1_score': 0.09459705}
confusion matrix:
     0     1
0  969  4977
1    0   260
early stop counter: 9
val acc:0.4946638345718384, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 10,now: 2024-08-04 21:51:30.521906,epoch time: 0:10:00.332869,used: 1:41:11.528265,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9079769, 'precision': 0.9180622, 'recall': 0.90792036, 'specificity': 0.90792036, 'f1': 0.90741014, 'auroc': 0.9924618, 'binary_precision': 0.8533113, 'binary_recall': 0.9855007, 'binary_specificity': 0.8303401, 'binary_f1_score': 0.91465455}
confusion matrix:
       0      1
0  23903   4884
1    418  28411
---- Validation: 
scalar performance:
{'acc': 0.5313234, 'precision': 0.4990257, 'recall': 0.4929989, 'specificity': 0.4929989, 'f1': 0.3760291, 'auroc': 0.5406053, 'binary_precision': 0.034870382, 'binary_recall': 0.45170876, 'binary_specificity': 0.53428906, 'binary_f1_score': 0.06474284}
confusion matrix:
      0     1
0  9653  8414
1   369   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.27586207, 'precision': 0.5273454, 'recall': 0.6220989, 'specificity': 0.6220989, 'f1': 0.24812406, 'auroc': 0.9209507, 'binary_precision': 0.054690786, 'binary_recall': 1.0, 'binary_specificity': 0.24419779, 'binary_f1_score': 0.10370961}
confusion matrix:
      0     1
0  1452  4494
1     0   260
early stop counter: 10
val acc:0.5313233733177185, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 11,now: 2024-08-04 22:01:12.067811,epoch time: 0:09:41.545905,used: 1:50:53.074170,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.89947236, 'precision': 0.9112334, 'recall': 0.8994137, 'specificity': 0.8994137, 'f1': 0.89873874, 'auroc': 0.9910072, 'binary_precision': 0.84186155, 'binary_recall': 0.98390454, 'binary_specificity': 0.81492287, 'binary_f1_score': 0.90735763}
confusion matrix:
       0      1
0  23460   5328
1    464  28364
---- Validation: 
scalar performance:
{'acc': 0.5477588, 'precision': 0.49981266, 'recall': 0.49866164, 'specificity': 0.49866164, 'f1': 0.38387632, 'auroc': 0.54939294, 'binary_precision': 0.035705786, 'binary_recall': 0.44576523, 'binary_specificity': 0.5515581, 'binary_f1_score': 0.06611571}
confusion matrix:
      0     1
0  9965  8102
1   373   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.30744442, 'precision': 0.5277214, 'recall': 0.6349026, 'specificity': 0.6349026, 'f1': 0.2707561, 'auroc': 0.89996684, 'binary_precision': 0.056653492, 'binary_recall': 0.99230766, 'binary_specificity': 0.27749747, 'binary_f1_score': 0.10718737}
confusion matrix:
      0     1
0  1650  4296
1     2   258
early stop counter: 11
val acc:0.5477588176727295, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 12,now: 2024-08-04 22:11:05.496340,epoch time: 0:09:53.428529,used: 2:00:46.502699,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9237538, 'precision': 0.9307299, 'recall': 0.92370534, 'specificity': 0.92370534, 'f1': 0.9234379, 'auroc': 0.9942201, 'binary_precision': 0.8761043, 'binary_recall': 0.98723555, 'binary_specificity': 0.8601751, 'binary_f1_score': 0.92835593}
confusion matrix:
       0      1
0  24761   4025
1    368  28462
---- Validation: 
scalar performance:
{'acc': 0.6379936, 'precision': 0.50631267, 'recall': 0.54188335, 'specificity': 0.54188335, 'f1': 0.42733684, 'auroc': 0.5775534, 'binary_precision': 0.04402328, 'binary_recall': 0.4383358, 'binary_specificity': 0.6454309, 'binary_f1_score': 0.080010846}
confusion matrix:
       0     1
0  11661  6406
1    378   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37786013, 'precision': 0.5305098, 'recall': 0.669811, 'specificity': 0.669811, 'f1': 0.31854126, 'auroc': 0.9332258, 'binary_precision': 0.062454436, 'binary_recall': 0.98846155, 'binary_specificity': 0.35116044, 'binary_f1_score': 0.11748572}
confusion matrix:
      0     1
0  2088  3858
1     3   257
early stop counter: 12
val acc:0.637993574142456, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 13,now: 2024-08-04 22:21:03.538917,epoch time: 0:09:58.042577,used: 2:10:44.545276,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92835325, 'precision': 0.933822, 'recall': 0.9283143, 'specificity': 0.9283143, 'f1': 0.9281223, 'auroc': 0.9936668, 'binary_precision': 0.88528734, 'binary_recall': 0.9843555, 'binary_specificity': 0.87227315, 'binary_f1_score': 0.93219674}
confusion matrix:
       0      1
0  25111   3677
1    451  28377
---- Validation: 
scalar performance:
{'acc': 0.6582711, 'precision': 0.50800675, 'recall': 0.5516845, 'specificity': 0.5516845, 'f1': 0.43702313, 'auroc': 0.56981736, 'binary_precision': 0.04652635, 'binary_recall': 0.43684992, 'binary_specificity': 0.66651905, 'binary_f1_score': 0.08409612}
confusion matrix:
       0     1
0  12042  6025
1    379   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45165968, 'precision': 0.53329825, 'recall': 0.7009683, 'specificity': 0.7009683, 'f1': 0.3646166, 'auroc': 0.9204148, 'binary_precision': 0.06933407, 'binary_recall': 0.97307694, 'binary_specificity': 0.42885974, 'binary_f1_score': 0.12944488}
confusion matrix:
      0     1
0  2550  3396
1     7   253
early stop counter: 13
val acc:0.658271074295044, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 14,now: 2024-08-04 22:31:10.548577,epoch time: 0:10:07.009660,used: 2:20:51.554936,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.876996, 'precision': 0.89755523, 'recall': 0.87690914, 'specificity': 0.87690914, 'f1': 0.8753669, 'auroc': 0.99062973, 'binary_precision': 0.80733895, 'binary_recall': 0.99056536, 'binary_specificity': 0.763253, 'binary_f1_score': 0.8896158}
confusion matrix:
       0      1
0  21971   6815
1    272  28558
---- Validation: 
scalar performance:
{'acc': 0.38367128, 'precision': 0.48842308, 'recall': 0.42071444, 'specificity': 0.42071444, 'f1': 0.29730177, 'auroc': 0.5024797, 'binary_precision': 0.026963556, 'binary_recall': 0.46062407, 'binary_specificity': 0.38080478, 'binary_f1_score': 0.050944947}
confusion matrix:
      0      1
0  6880  11187
1   363    310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.14840476, 'precision': 0.52344453, 'recall': 0.5555836, 'specificity': 0.5555836, 'f1': 0.14483438, 'auroc': 0.89330137, 'binary_precision': 0.04688909, 'binary_recall': 1.0, 'binary_specificity': 0.11116717, 'binary_f1_score': 0.08957795}
confusion matrix:
     0     1
0  661  5285
1    0   260
early stop counter: 14
val acc:0.38367128372192383, best validation acc: 0.9217182397842407, corresponding to test acc:                         0.9448920488357544 / 0.9448920488357544
after epoch: 15,now: 2024-08-04 22:41:18.900661,epoch time: 0:10:08.352084,used: 2:30:59.907020,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:30:59.907020 at 2024-08-04 22:41:18.900661
persisted model performance metric: 

scalar performance:
{'acc': 0.94489205, 'precision': 0.69548845, 'recall': 0.81676626, 'specificity': 0.81676626, 'f1': 0.7390094, 'auroc': 0.85909986, 'binary_precision': 0.40552995, 'binary_recall': 0.6769231, 'binary_specificity': 0.9566095, 'binary_f1_score': 0.50720465}
confusion matrix:
      0    1
0  5688  258
1    84  176
oracle model performance metric: 

scalar performance:
{'acc': 0.94489205, 'precision': 0.69548845, 'recall': 0.81676626, 'specificity': 0.81676626, 'f1': 0.7390094, 'auroc': 0.85909986, 'binary_precision': 0.40552995, 'binary_recall': 0.6769231, 'binary_specificity': 0.9566095, 'binary_f1_score': 0.50720465}
confusion matrix:
      0    1
0  5688  258
1    84  176
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522826 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool | 436736 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |  86090 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  11654 MiB |   5110 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  11498 MiB |   5076 MiB |
|       from small pool |    122 MiB |    124 MiB |    156 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1063 MiB |   1463 MiB | 479146 GiB | 479145 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 477677 GiB | 477676 GiB |
|       from small pool |      8 MiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3606    |    8349    |  107889 K  |  107886 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63243 K  |   63240 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3606    |    8349    |  107889 K  |  107886 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63243 K  |   63240 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     195    |      65    |
|       from large pool |      69    |      71    |     117    |      48    |
|       from small pool |      61    |      62    |      78    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3630    |   50634 K  |   50634 K  |
|       from large pool |      21    |      36    |   17923 K  |   17922 K  |
|       from small pool |      54    |    3610    |   32711 K  |   32711 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1586 MiB |   6564 MiB |  11654 MiB |  10068 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     94 MiB |    124 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107889 K  |  107889 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63243 K  |   63243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107889 K  |  107889 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63243 K  |   63243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     133    |     195    |     124    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      47    |      62    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50636 K  |   50636 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32713 K  |   32713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1586 MiB |   6564 MiB |  11654 MiB |  10068 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     94 MiB |    124 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107889 K  |  107889 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63243 K  |   63243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107889 K  |  107889 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63243 K  |   63243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     133    |     195    |     124    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      47    |      62    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50636 K  |   50636 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32713 K  |   32713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113

 Experiment start at: 2024-08-04 22:47:49.360497
before training, model accuracy: 0.054656196385622025
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96869856, 'precision': 0.96869856, 'recall': 0.9686986, 'specificity': 0.9686986, 'f1': 0.96869856, 'auroc': 0.99438775, 'binary_precision': 0.9688829, 'binary_recall': 0.9685174, 'binary_specificity': 0.96887976, 'binary_f1_score': 0.9687002}
confusion matrix:
       0      1
0  28238    907
1    918  28241
---- Validation: 
scalar performance:
{'acc': 0.91738135, 'precision': 0.59713066, 'recall': 0.74852955, 'specificity': 0.74852955, 'f1': 0.63105816, 'auroc': 0.8169514, 'binary_precision': 0.2094305, 'binary_recall': 0.5681063, 'binary_specificity': 0.92895275, 'binary_f1_score': 0.30604026}
confusion matrix:
       0     1
0  16880  1291
1    260   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94614524, 'precision': 0.69064164, 'recall': 0.8351769, 'specificity': 0.8351769, 'f1': 0.73942363, 'auroc': 0.906194, 'binary_precision': 0.39318183, 'binary_recall': 0.71487606, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.50733143}
confusion matrix:
      0    1
0  5730  267
1    69  173
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 22:59:22.900518,epoch time: 0:11:33.540021,used: 0:11:33.540021,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9568297, 'precision': 0.9579836, 'recall': 0.95682544, 'specificity': 0.95682544, 'f1': 0.95680225, 'auroc': 0.9947531, 'binary_precision': 0.9350382, 'binary_recall': 0.98189116, 'binary_specificity': 0.9317597, 'binary_f1_score': 0.95789206}
confusion matrix:
       0      1
0  27158   1989
1    528  28629
---- Validation: 
scalar performance:
{'acc': 0.8512225, 'precision': 0.5425789, 'recall': 0.6725957, 'specificity': 0.6725957, 'f1': 0.5451113, 'auroc': 0.7241324, 'binary_precision': 0.10465536, 'binary_recall': 0.48172757, 'binary_specificity': 0.86346376, 'binary_f1_score': 0.17195375}
confusion matrix:
       0     1
0  15690  2481
1    312   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84132075, 'precision': 0.583742, 'recall': 0.8381491, 'specificity': 0.8381491, 'f1': 0.6002478, 'auroc': 0.9092542, 'binary_precision': 0.17534722, 'binary_recall': 0.8347107, 'binary_specificity': 0.8415875, 'binary_f1_score': 0.2898135}
confusion matrix:
      0    1
0  5047  950
1    40  202
early stop counter: 1
val acc:0.8512225151062012, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 2,now: 2024-08-04 23:09:36.286565,epoch time: 0:10:13.386047,used: 0:21:46.926068,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9678238, 'precision': 0.967994, 'recall': 0.96782255, 'specificity': 0.96782255, 'f1': 0.96782076, 'auroc': 0.9948105, 'binary_precision': 0.95910466, 'binary_recall': 0.97732884, 'binary_specificity': 0.9583162, 'binary_f1_score': 0.96813095}
confusion matrix:
       0      1
0  27933   1215
1    661  28495
---- Validation: 
scalar performance:
{'acc': 0.851915, 'precision': 0.53501356, 'recall': 0.63761926, 'specificity': 0.63761926, 'f1': 0.53462785, 'auroc': 0.60879505, 'binary_precision': 0.09213483, 'binary_recall': 0.40863788, 'binary_specificity': 0.86660063, 'binary_f1_score': 0.15036675}
confusion matrix:
       0     1
0  15747  2424
1    356   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82705563, 'precision': 0.57995635, 'recall': 0.84460795, 'specificity': 0.84460795, 'f1': 0.59048223, 'auroc': 0.92069864, 'binary_precision': 0.16653386, 'binary_recall': 0.8636364, 'binary_specificity': 0.82557946, 'binary_f1_score': 0.2792251}
confusion matrix:
      0     1
0  4951  1046
1    33   209
early stop counter: 2
val acc:0.8519150018692017, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 3,now: 2024-08-04 23:19:48.394893,epoch time: 0:10:12.108328,used: 0:31:59.034396,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96826977, 'precision': 0.9686185, 'recall': 0.9682665, 'specificity': 0.9682665, 'f1': 0.9682637, 'auroc': 0.9955931, 'binary_precision': 0.95589465, 'binary_recall': 0.9818581, 'binary_specificity': 0.9546749, 'binary_f1_score': 0.9687024}
confusion matrix:
       0      1
0  27824   1321
1    529  28630
---- Validation: 
scalar performance:
{'acc': 0.8523411, 'precision': 0.5353402, 'recall': 0.63864243, 'specificity': 0.63864243, 'f1': 0.53519595, 'auroc': 0.6414088, 'binary_precision': 0.092717715, 'binary_recall': 0.410299, 'binary_specificity': 0.86698586, 'binary_f1_score': 0.15125535}
confusion matrix:
       0     1
0  15754  2417
1    355   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79211414, 'precision': 0.5692074, 'recall': 0.8363459, 'specificity': 0.8363459, 'f1': 0.5637492, 'auroc': 0.92838705, 'binary_precision': 0.14430209, 'binary_recall': 0.88429755, 'binary_specificity': 0.7883942, 'binary_f1_score': 0.24811593}
confusion matrix:
      0     1
0  4728  1269
1    28   214
early stop counter: 3
val acc:0.8523411154747009, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 4,now: 2024-08-04 23:30:05.171126,epoch time: 0:10:16.776233,used: 0:42:15.810629,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9468647, 'precision': 0.9499581, 'recall': 0.9468547, 'specificity': 0.9468547, 'f1': 0.94677246, 'auroc': 0.99579465, 'binary_precision': 0.91271025, 'binary_recall': 0.9882712, 'binary_specificity': 0.9054383, 'binary_f1_score': 0.94898903}
confusion matrix:
       0      1
0  26389   2756
1    342  28817
---- Validation: 
scalar performance:
{'acc': 0.7478293, 'precision': 0.5163514, 'recall': 0.59830713, 'specificity': 0.59830713, 'f1': 0.47685298, 'auroc': 0.60529655, 'binary_precision': 0.05665236, 'binary_recall': 0.4385382, 'binary_specificity': 0.7580761, 'binary_f1_score': 0.10034207}
confusion matrix:
       0     1
0  13775  4396
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61211735, 'precision': 0.54163295, 'recall': 0.7724568, 'specificity': 0.7724568, 'f1': 0.45352745, 'auroc': 0.92700624, 'binary_precision': 0.08687405, 'binary_recall': 0.946281, 'binary_specificity': 0.59863263, 'binary_f1_score': 0.15913829}
confusion matrix:
      0     1
0  3590  2407
1    13   229
early stop counter: 4
val acc:0.7478293180465698, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 5,now: 2024-08-04 23:40:10.964182,epoch time: 0:10:05.793056,used: 0:52:21.603685,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97115123, 'precision': 0.97122085, 'recall': 0.97115016, 'specificity': 0.97115016, 'f1': 0.97115016, 'auroc': 0.99486274, 'binary_precision': 0.96553594, 'binary_recall': 0.97719246, 'binary_specificity': 0.9651079, 'binary_f1_score': 0.9713293}
confusion matrix:
       0      1
0  28130   1017
1    665  28492
---- Validation: 
scalar performance:
{'acc': 0.9022, 'precision': 0.5591631, 'recall': 0.6579734, 'specificity': 0.6579734, 'f1': 0.5772285, 'auroc': 0.6018177, 'binary_precision': 0.13960281, 'binary_recall': 0.39700997, 'binary_specificity': 0.9189368, 'binary_f1_score': 0.20656873}
confusion matrix:
       0     1
0  16698  1473
1    363   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86327934, 'precision': 0.59684634, 'recall': 0.85551965, 'specificity': 0.85551965, 'f1': 0.62428254, 'auroc': 0.9222903, 'binary_precision': 0.20078355, 'binary_recall': 0.8471074, 'binary_specificity': 0.86393195, 'binary_f1_score': 0.32462394}
confusion matrix:
      0    1
0  5181  816
1    37  205
early stop counter: 5
val acc:0.9021999835968018, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 6,now: 2024-08-04 23:50:11.869528,epoch time: 0:10:00.905346,used: 1:02:22.509031,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92475647, 'precision': 0.9314802, 'recall': 0.92474574, 'specificity': 0.92474574, 'f1': 0.9244609, 'auroc': 0.9941039, 'binary_precision': 0.8776606, 'binary_recall': 0.98713857, 'binary_specificity': 0.8623529, 'binary_f1_score': 0.9291859}
confusion matrix:
       0      1
0  25135   4012
1    375  28782
---- Validation: 
scalar performance:
{'acc': 0.7174666, 'precision': 0.51239693, 'recall': 0.58021367, 'specificity': 0.58021367, 'f1': 0.4611926, 'auroc': 0.5806477, 'binary_precision': 0.049961716, 'binary_recall': 0.43355483, 'binary_specificity': 0.7268725, 'binary_f1_score': 0.08959836}
confusion matrix:
       0     1
0  13208  4963
1    341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3724956, 'precision': 0.52669126, 'recall': 0.6597076, 'specificity': 0.6597076, 'f1': 0.31171608, 'auroc': 0.8931346, 'binary_precision': 0.056722183, 'binary_recall': 0.9710744, 'binary_specificity': 0.34834084, 'binary_f1_score': 0.10718358}
confusion matrix:
      0     1
0  2089  3908
1     7   235
early stop counter: 6
val acc:0.7174665927886963, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 7,now: 2024-08-05 00:00:22.096179,epoch time: 0:10:10.226651,used: 1:12:32.735682,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.917347, 'precision': 0.9256563, 'recall': 0.91733503, 'specificity': 0.91733503, 'f1': 0.9169401, 'auroc': 0.9937512, 'binary_precision': 0.86622727, 'binary_recall': 0.9871729, 'binary_specificity': 0.84749717, 'binary_f1_score': 0.9227538}
confusion matrix:
       0      1
0  24702   4445
1    374  28783
---- Validation: 
scalar performance:
{'acc': 0.6686731, 'precision': 0.508317, 'recall': 0.5590239, 'specificity': 0.5590239, 'f1': 0.43840206, 'auroc': 0.5818229, 'binary_precision': 0.043252032, 'binary_recall': 0.44186047, 'binary_specificity': 0.67618734, 'binary_f1_score': 0.07879147}
confusion matrix:
       0     1
0  12287  5884
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37842602, 'precision': 0.52731663, 'recall': 0.66477525, 'specificity': 0.66477525, 'f1': 0.3156948, 'auroc': 0.90596473, 'binary_precision': 0.05744888, 'binary_recall': 0.9752066, 'binary_specificity': 0.35434383, 'binary_f1_score': 0.10850574}
confusion matrix:
      0     1
0  2125  3872
1     6   236
early stop counter: 7
val acc:0.6686730980873108, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 8,now: 2024-08-05 00:10:30.930944,epoch time: 0:10:08.834765,used: 1:22:41.570447,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8935922, 'precision': 0.9084496, 'recall': 0.89357585, 'specificity': 0.89357585, 'f1': 0.8926128, 'auroc': 0.99149096, 'binary_precision': 0.830592, 'binary_recall': 0.98892206, 'binary_specificity': 0.79822963, 'binary_f1_score': 0.9028683}
confusion matrix:
       0      1
0  23266   5881
1    323  28834
---- Validation: 
scalar performance:
{'acc': 0.435306, 'precision': 0.4929518, 'recall': 0.44409603, 'specificity': 0.44409603, 'f1': 0.32370678, 'auroc': 0.5281656, 'binary_precision': 0.025889046, 'binary_recall': 0.45348838, 'binary_specificity': 0.43470365, 'binary_f1_score': 0.04898179}
confusion matrix:
      0      1
0  7899  10272
1   329    273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.23737778, 'precision': 0.5227239, 'recall': 0.59735346, 'specificity': 0.59735346, 'f1': 0.21714513, 'auroc': 0.8280192, 'binary_precision': 0.04785743, 'binary_recall': 0.9876033, 'binary_specificity': 0.20710355, 'binary_f1_score': 0.09129106}
confusion matrix:
      0     1
0  1242  4755
1     3   239
early stop counter: 8
val acc:0.43530601263046265, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 9,now: 2024-08-05 00:20:41.540852,epoch time: 0:10:10.609908,used: 1:32:52.180355,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9131277, 'precision': 0.92188066, 'recall': 0.9131154, 'specificity': 0.9131154, 'f1': 0.9126731, 'auroc': 0.99225783, 'binary_precision': 0.8611561, 'binary_recall': 0.98511505, 'binary_specificity': 0.8411157, 'binary_f1_score': 0.9189743}
confusion matrix:
       0      1
0  24516   4631
1    434  28723
---- Validation: 
scalar performance:
{'acc': 0.58019495, 'precision': 0.5020089, 'recall': 0.51572835, 'specificity': 0.51572835, 'f1': 0.39666468, 'auroc': 0.53736424, 'binary_precision': 0.03441218, 'binary_recall': 0.44684386, 'binary_specificity': 0.58461285, 'binary_f1_score': 0.06390308}
confusion matrix:
       0     1
0  10623  7548
1    333   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37794518, 'precision': 0.5255914, 'recall': 0.6546114, 'specificity': 0.6546114, 'f1': 0.31465185, 'auroc': 0.8299707, 'binary_precision': 0.056327727, 'binary_recall': 0.95454544, 'binary_specificity': 0.35467735, 'binary_f1_score': 0.10637808}
confusion matrix:
      0     1
0  2127  3870
1    11   231
early stop counter: 9
val acc:0.5801949501037598, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 10,now: 2024-08-05 00:30:54.357067,epoch time: 0:10:12.816215,used: 1:43:04.996570,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8889613, 'precision': 0.9055332, 'recall': 0.88893354, 'specificity': 0.88893354, 'f1': 0.8878101, 'auroc': 0.9916191, 'binary_precision': 0.8236234, 'binary_recall': 0.9899863, 'binary_specificity': 0.78788084, 'binary_f1_score': 0.89917463}
confusion matrix:
       0      1
0  22962   6182
1    292  28868
---- Validation: 
scalar performance:
{'acc': 0.4468119, 'precision': 0.49363348, 'recall': 0.4492365, 'specificity': 0.4492365, 'f1': 0.32980582, 'auroc': 0.54446334, 'binary_precision': 0.026338724, 'binary_recall': 0.45182723, 'binary_specificity': 0.44664577, 'binary_f1_score': 0.049775824}
confusion matrix:
      0      1
0  8116  10055
1   330    272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.19089597, 'precision': 0.5222617, 'recall': 0.57714015, 'specificity': 0.57714015, 'f1': 0.18031047, 'auroc': 0.7840617, 'binary_precision': 0.045574885, 'binary_recall': 0.9958678, 'binary_specificity': 0.15841255, 'binary_f1_score': 0.087160945}
confusion matrix:
     0     1
0  950  5047
1    1   241
early stop counter: 10
val acc:0.4468119144439697, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 11,now: 2024-08-05 00:41:01.693965,epoch time: 0:10:07.336898,used: 1:53:12.333468,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8711238, 'precision': 0.89472914, 'recall': 0.8710902, 'specificity': 0.8710902, 'f1': 0.8691604, 'auroc': 0.9890869, 'binary_precision': 0.79826933, 'binary_recall': 0.99334705, 'binary_specificity': 0.74883336, 'binary_f1_score': 0.8851878}
confusion matrix:
       0      1
0  21824   7320
1    194  28966
---- Validation: 
scalar performance:
{'acc': 0.39705962, 'precision': 0.49083343, 'recall': 0.42915756, 'specificity': 0.42915756, 'f1': 0.30301082, 'auroc': 0.5195377, 'binary_precision': 0.024745012, 'binary_recall': 0.46345514, 'binary_specificity': 0.39485994, 'binary_f1_score': 0.046981562}
confusion matrix:
      0      1
0  7175  10996
1   323    279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.11668537, 'precision': 0.5210325, 'recall': 0.54052025, 'specificity': 0.54052025, 'f1': 0.11533227, 'auroc': 0.72489655, 'binary_precision': 0.04206501, 'binary_recall': 1.0, 'binary_specificity': 0.081040524, 'binary_f1_score': 0.08073394}
confusion matrix:
     0     1
0  486  5511
1    0   242
early stop counter: 11
val acc:0.3970596194267273, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 12,now: 2024-08-05 00:51:14.515319,epoch time: 0:10:12.821354,used: 2:03:25.154822,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9301935, 'precision': 0.9362688, 'recall': 0.93018335, 'specificity': 0.93018335, 'f1': 0.92994845, 'auroc': 0.99510634, 'binary_precision': 0.884829, 'binary_recall': 0.98916215, 'binary_specificity': 0.87120456, 'binary_f1_score': 0.9340912}
confusion matrix:
       0      1
0  25393   3754
1    316  28841
---- Validation: 
scalar performance:
{'acc': 0.64576787, 'precision': 0.5059998, 'recall': 0.54397964, 'specificity': 0.54397964, 'f1': 0.42704493, 'auroc': 0.56725466, 'binary_precision': 0.039866097, 'binary_recall': 0.43521595, 'binary_specificity': 0.6527434, 'binary_f1_score': 0.073041536}
confusion matrix:
       0     1
0  11861  6310
1    340   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38708127, 'precision': 0.52773404, 'recall': 0.6692775, 'specificity': 0.6692775, 'f1': 0.32125112, 'auroc': 0.86622804, 'binary_precision': 0.05821411, 'binary_recall': 0.9752066, 'binary_specificity': 0.36334834, 'binary_f1_score': 0.109869644}
confusion matrix:
      0     1
0  2179  3818
1     6   236
early stop counter: 12
val acc:0.645767867565155, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 13,now: 2024-08-05 01:01:24.756892,epoch time: 0:10:10.241573,used: 2:13:35.396395,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.94840837, 'precision': 0.95066106, 'recall': 0.9483999, 'specificity': 0.9483999, 'f1': 0.9483431, 'auroc': 0.9940704, 'binary_precision': 0.9188583, 'binary_recall': 0.98371, 'binary_specificity': 0.91308975, 'binary_f1_score': 0.9501788}
confusion matrix:
       0      1
0  26612   2533
1    475  28684
---- Validation: 
scalar performance:
{'acc': 0.7788313, 'precision': 0.5201711, 'recall': 0.61030644, 'specificity': 0.61030644, 'f1': 0.49231404, 'auroc': 0.56923914, 'binary_precision': 0.06366765, 'binary_recall': 0.43023255, 'binary_specificity': 0.7903803, 'binary_f1_score': 0.110920765}
confusion matrix:
       0     1
0  14362  3809
1    343   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6228562, 'precision': 0.5410257, 'recall': 0.76614654, 'specificity': 0.76614654, 'f1': 0.4581195, 'auroc': 0.89555746, 'binary_precision': 0.08721158, 'binary_recall': 0.9214876, 'binary_specificity': 0.6108054, 'binary_f1_score': 0.15934263}
confusion matrix:
      0     1
0  3663  2334
1    19   223
early stop counter: 13
val acc:0.7788313031196594, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 14,now: 2024-08-05 01:11:35.891811,epoch time: 0:10:11.134919,used: 2:23:46.531314,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9195767, 'precision': 0.9277292, 'recall': 0.9195672, 'specificity': 0.9195672, 'f1': 0.91919047, 'auroc': 0.99319077, 'binary_precision': 0.8687121, 'binary_recall': 0.9885787, 'binary_specificity': 0.8505558, 'binary_f1_score': 0.92477745}
confusion matrix:
       0      1
0  24792   4356
1    333  28823
---- Validation: 
scalar performance:
{'acc': 0.6063495, 'precision': 0.5037096, 'recall': 0.5284358, 'specificity': 0.5284358, 'f1': 0.409066, 'auroc': 0.57797563, 'binary_precision': 0.036592025, 'binary_recall': 0.4451827, 'binary_specificity': 0.611689, 'binary_f1_score': 0.06762554}
confusion matrix:
       0     1
0  11115  7056
1    334   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36640486, 'precision': 0.52675027, 'recall': 0.6585221, 'specificity': 0.6585221, 'f1': 0.30789685, 'auroc': 0.8427409, 'binary_precision': 0.05641884, 'binary_recall': 0.9752066, 'binary_specificity': 0.34183758, 'binary_f1_score': 0.10666667}
confusion matrix:
      0     1
0  2050  3947
1     6   236
early stop counter: 14
val acc:0.606349527835846, best validation acc: 0.9173813462257385, corresponding to test acc:                         0.946145236492157 / 0.946145236492157
after epoch: 15,now: 2024-08-05 01:21:46.146575,epoch time: 0:10:10.254764,used: 2:33:56.786078,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067113
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:56.786078 at 2024-08-05 01:21:46.146575
persisted model performance metric: 

scalar performance:
{'acc': 0.94614524, 'precision': 0.69064164, 'recall': 0.8351769, 'specificity': 0.8351769, 'f1': 0.73942363, 'auroc': 0.906194, 'binary_precision': 0.39318183, 'binary_recall': 0.71487606, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.50733143}
confusion matrix:
      0    1
0  5730  267
1    69  173
oracle model performance metric: 

scalar performance:
{'acc': 0.94614524, 'precision': 0.69064164, 'recall': 0.8351769, 'specificity': 0.8351769, 'f1': 0.73942363, 'auroc': 0.906194, 'binary_precision': 0.39318183, 'binary_recall': 0.71487606, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.50733143}
confusion matrix:
      0    1
0  5730  267
1    69  173
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522827 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool | 436736 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |  86091 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  16612 MiB |  10068 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  16428 MiB |  10006 MiB |
|       from small pool |    122 MiB |    124 MiB |    184 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1061 MiB |   1463 MiB | 730675 GiB | 730674 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 728433 GiB | 728432 GiB |
|       from small pool |      6 MiB |     27 MiB |   2242 GiB |   2242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3618    |    8435    |  163863 K  |  163859 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95829 K  |   95825 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3618    |    8435    |  163863 K  |  163859 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95829 K  |   95825 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     254    |     124    |
|       from large pool |      69    |      71    |     162    |      93    |
|       from small pool |      61    |      62    |      92    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3673    |   76905 K  |   76905 K  |
|       from large pool |      21    |      36    |   27378 K  |   27378 K  |
|       from small pool |      55    |    3653    |   49526 K  |   49526 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool |  65536 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |      0 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1584 MiB |   6564 MiB |  16612 MiB |  15028 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  16428 MiB |  14936 MiB |
|       from small pool |     92 MiB |    124 MiB |    184 MiB |     92 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 730676 GiB | 730676 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 728433 GiB | 728433 GiB |
|       from small pool |      0 KiB |     27 MiB |   2242 GiB |   2242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8435    |  163863 K  |  163862 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95829 K  |   95829 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8435    |  163863 K  |  163862 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95829 K  |   95829 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |     133    |     254    |     184    |
|       from large pool |      24    |      71    |     162    |     138    |
|       from small pool |      46    |      62    |      92    |      46    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3673    |   76907 K  |   76907 K  |
|       from large pool |       3    |      36    |   27378 K  |   27378 K  |
|       from small pool |       0    |    3653    |   49528 K  |   49528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 01:22:30 2024]
Finished job 0.
1 of 1 steps (100%) done
