Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 07:44:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368

 Experiment start at: 2024-07-31 07:56:23.053908
before training, model accuracy: 0.31128156185150146
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96354604, 'precision': 0.9635459, 'recall': 0.96354604, 'specificity': 0.96354604, 'f1': 0.96354604, 'auroc': 0.9939835, 'binary_precision': 0.96365345, 'binary_recall': 0.9634856, 'binary_specificity': 0.96360654, 'binary_f1_score': 0.9635695}
confusion matrix:
       0      1
0  27616   1043
1   1048  27653
---- Validation: 
scalar performance:
{'acc': 0.9393891, 'precision': 0.62924266, 'recall': 0.71810246, 'specificity': 0.71810246, 'f1': 0.65997213, 'auroc': 0.81485724, 'binary_precision': 0.27737883, 'binary_recall': 0.4805599, 'binary_specificity': 0.95564497, 'binary_f1_score': 0.3517359}
confusion matrix:
       0    1
0  17344  805
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.70584154, 'recall': 0.8281487, 'specificity': 0.8281487, 'f1': 0.7504112, 'auroc': 0.889561, 'binary_precision': 0.42523363, 'binary_recall': 0.697318, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.52830184}
confusion matrix:
      0    1
0  5751  246
1    79  182
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 08:16:40.602610,epoch time: 0:20:17.548702,used: 0:20:17.548702,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94796026, 'precision': 0.95029867, 'recall': 0.9479327, 'specificity': 0.9479327, 'f1': 0.94789034, 'auroc': 0.9940762, 'binary_precision': 0.9180403, 'binary_recall': 0.98383385, 'binary_specificity': 0.91203153, 'binary_f1_score': 0.94979906}
confusion matrix:
       0      1
0  26137   2521
1    464  28238
---- Validation: 
scalar performance:
{'acc': 0.836473, 'precision': 0.54531384, 'recall': 0.68957305, 'specificity': 0.68957305, 'f1': 0.5456078, 'auroc': 0.7415836, 'binary_precision': 0.10982659, 'binary_recall': 0.5318818, 'binary_specificity': 0.8472643, 'binary_f1_score': 0.18206017}
confusion matrix:
       0     1
0  15377  2772
1    301   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7166827, 'precision': 0.557166, 'recall': 0.81003237, 'specificity': 0.81003237, 'f1': 0.5194802, 'auroc': 0.9235499, 'binary_precision': 0.11971831, 'binary_recall': 0.9118774, 'binary_specificity': 0.7081874, 'binary_f1_score': 0.21164963}
confusion matrix:
      0     1
0  4247  1750
1    23   238
early stop counter: 1
val acc:0.8364729881286621, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 2,now: 2024-07-31 08:35:52.412404,epoch time: 0:19:11.809794,used: 0:39:29.358496,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9513773, 'precision': 0.95317364, 'recall': 0.95135105, 'specificity': 0.95135105, 'f1': 0.951327, 'auroc': 0.99470794, 'binary_precision': 0.92485, 'binary_recall': 0.9826853, 'binary_specificity': 0.92001677, 'binary_f1_score': 0.9528909}
confusion matrix:
       0      1
0  26364   2292
1    497  28207
---- Validation: 
scalar performance:
{'acc': 0.8340783, 'precision': 0.5349387, 'recall': 0.64333004, 'specificity': 0.64333004, 'f1': 0.53060335, 'auroc': 0.6960338, 'binary_precision': 0.09279368, 'binary_recall': 0.43856922, 'binary_specificity': 0.8480908, 'binary_f1_score': 0.15317763}
confusion matrix:
       0     1
0  15392  2757
1    361   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74001276, 'precision': 0.56199956, 'recall': 0.8222052, 'specificity': 0.8222052, 'f1': 0.5350482, 'auroc': 0.9286789, 'binary_precision': 0.12920739, 'binary_recall': 0.9118774, 'binary_specificity': 0.7325329, 'binary_f1_score': 0.22634333}
confusion matrix:
      0     1
0  4393  1604
1    23   238
early stop counter: 2
val acc:0.834078311920166, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 3,now: 2024-07-31 08:55:18.928683,epoch time: 0:19:26.516279,used: 0:58:55.874775,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9766388, 'precision': 0.97673905, 'recall': 0.97663355, 'specificity': 0.97663355, 'f1': 0.97663736, 'auroc': 0.9972985, 'binary_precision': 0.97000724, 'binary_recall': 0.98372877, 'binary_specificity': 0.9695384, 'binary_f1_score': 0.9768198}
confusion matrix:
       0      1
0  27786    873
1    467  28234
---- Validation: 
scalar performance:
{'acc': 0.90836525, 'precision': 0.5694438, 'recall': 0.663038, 'specificity': 0.663038, 'f1': 0.59057957, 'auroc': 0.75024927, 'binary_precision': 0.16133082, 'binary_recall': 0.39968896, 'binary_specificity': 0.92638713, 'binary_f1_score': 0.22987476}
confusion matrix:
       0     1
0  16813  1336
1    386   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89709175, 'precision': 0.6298855, 'recall': 0.8711808, 'specificity': 0.8711808, 'f1': 0.6747855, 'auroc': 0.92945254, 'binary_precision': 0.2673147, 'binary_recall': 0.8429119, 'binary_specificity': 0.8994497, 'binary_f1_score': 0.40590405}
confusion matrix:
      0    1
0  5394  603
1    41  220
early stop counter: 3
val acc:0.9083652496337891, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 4,now: 2024-07-31 09:14:34.392005,epoch time: 0:19:15.463322,used: 1:18:11.338097,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9479428, 'precision': 0.950619, 'recall': 0.947912, 'specificity': 0.947912, 'f1': 0.94786286, 'auroc': 0.9958175, 'binary_precision': 0.9160923, 'binary_recall': 0.98630804, 'binary_specificity': 0.909516, 'binary_f1_score': 0.9499044}
confusion matrix:
       0      1
0  26064   2593
1    393  28310
---- Validation: 
scalar performance:
{'acc': 0.8464772, 'precision': 0.5368773, 'recall': 0.6407484, 'specificity': 0.6407484, 'f1': 0.5366031, 'auroc': 0.6796434, 'binary_precision': 0.09705248, 'binary_recall': 0.41990668, 'binary_specificity': 0.86159015, 'binary_f1_score': 0.15766424}
confusion matrix:
       0     1
0  15637  2512
1    373   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82949823, 'precision': 0.5877323, 'recall': 0.8542365, 'specificity': 0.8542365, 'f1': 0.60207355, 'auroc': 0.93063706, 'binary_precision': 0.18167457, 'binary_recall': 0.88122606, 'binary_specificity': 0.82724696, 'binary_f1_score': 0.30124426}
confusion matrix:
      0     1
0  4961  1036
1    31   230
early stop counter: 4
val acc:0.846477210521698, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 5,now: 2024-07-31 09:34:28.786935,epoch time: 0:19:54.394930,used: 1:38:05.733027,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9487099, 'precision': 0.9519419, 'recall': 0.94867903, 'specificity': 0.94867903, 'f1': 0.94861555, 'auroc': 0.996747, 'binary_precision': 0.91390556, 'binary_recall': 0.99083656, 'binary_specificity': 0.9065215, 'binary_f1_score': 0.95081747}
confusion matrix:
       0      1
0  25980   2679
1    263  28438
---- Validation: 
scalar performance:
{'acc': 0.7728289, 'precision': 0.52074623, 'recall': 0.60862005, 'specificity': 0.60862005, 'f1': 0.4924589, 'auroc': 0.6756947, 'binary_precision': 0.06647537, 'binary_recall': 0.43234837, 'binary_specificity': 0.7848917, 'binary_f1_score': 0.11523316}
confusion matrix:
       0     1
0  14245  3904
1    365   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60754234, 'precision': 0.54309386, 'recall': 0.76408124, 'specificity': 0.76408124, 'f1': 0.4545896, 'auroc': 0.9278841, 'binary_precision': 0.09094297, 'binary_recall': 0.9348659, 'binary_specificity': 0.59329665, 'binary_f1_score': 0.16576087}
confusion matrix:
      0     1
0  3558  2439
1    17   244
early stop counter: 5
val acc:0.7728288769721985, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 6,now: 2024-07-31 09:57:12.231139,epoch time: 0:22:43.444204,used: 2:00:49.177231,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94464785, 'precision': 0.9484368, 'recall': 0.9446143, 'specificity': 0.9446143, 'f1': 0.94452775, 'auroc': 0.99640703, 'binary_precision': 0.9073991, 'binary_recall': 0.9904533, 'binary_specificity': 0.8987753, 'binary_f1_score': 0.9471089}
confusion matrix:
       0      1
0  25758   2901
1    274  28427
---- Validation: 
scalar performance:
{'acc': 0.7540443, 'precision': 0.5181096, 'recall': 0.6003951, 'specificity': 0.6003951, 'f1': 0.48271042, 'auroc': 0.6470841, 'binary_precision': 0.061687596, 'binary_recall': 0.43545878, 'binary_specificity': 0.76533145, 'binary_f1_score': 0.10806639}
confusion matrix:
       0     1
0  13890  4259
1    363   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60434645, 'precision': 0.54390705, 'recall': 0.7697431, 'specificity': 0.7697431, 'f1': 0.4537305, 'auroc': 0.9389887, 'binary_precision': 0.09147916, 'binary_recall': 0.95019156, 'binary_specificity': 0.5892947, 'binary_f1_score': 0.166891}
confusion matrix:
      0     1
0  3534  2463
1    13   248
early stop counter: 6
val acc:0.7540442943572998, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 7,now: 2024-07-31 10:20:42.026003,epoch time: 0:23:29.794864,used: 2:24:18.972095,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9417887, 'precision': 0.9461071, 'recall': 0.94175446, 'specificity': 0.94175446, 'f1': 0.9416443, 'auroc': 0.9962284, 'binary_precision': 0.90238947, 'binary_recall': 0.99083626, 'binary_specificity': 0.8926727, 'binary_f1_score': 0.9445469}
confusion matrix:
       0      1
0  25584   3076
1    263  28437
---- Validation: 
scalar performance:
{'acc': 0.72498935, 'precision': 0.5149, 'recall': 0.5891032, 'specificity': 0.5891032, 'f1': 0.4685284, 'auroc': 0.6439047, 'binary_precision': 0.055937193, 'binary_recall': 0.44323483, 'binary_specificity': 0.73497164, 'binary_f1_score': 0.09933774}
confusion matrix:
       0     1
0  13339  4810
1    358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46692234, 'precision': 0.53352565, 'recall': 0.70536995, 'specificity': 0.70536995, 'f1': 0.37337053, 'auroc': 0.9220562, 'binary_precision': 0.07041073, 'binary_recall': 0.9655172, 'binary_specificity': 0.44522262, 'binary_f1_score': 0.13125}
confusion matrix:
      0     1
0  2670  3327
1     9   252
early stop counter: 7
val acc:0.7249893546104431, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 8,now: 2024-07-31 10:44:22.461859,epoch time: 0:23:40.435856,used: 2:47:59.407951,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93709904, 'precision': 0.941997, 'recall': 0.9370606, 'specificity': 0.9370606, 'f1': 0.9369204, 'auroc': 0.99588263, 'binary_precision': 0.89565134, 'binary_recall': 0.98958224, 'binary_specificity': 0.8845389, 'binary_f1_score': 0.94027674}
confusion matrix:
       0      1
0  25350   3309
1    299  28402
---- Validation: 
scalar performance:
{'acc': 0.7297254, 'precision': 0.51535875, 'recall': 0.5908051, 'specificity': 0.5908051, 'f1': 0.47077626, 'auroc': 0.62611634, 'binary_precision': 0.056754597, 'binary_recall': 0.44167963, 'binary_specificity': 0.73993057, 'binary_f1_score': 0.10058439}
confusion matrix:
       0     1
0  13429  4720
1    359   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5650368, 'precision': 0.5408383, 'recall': 0.75472987, 'specificity': 0.75472987, 'f1': 0.43138352, 'auroc': 0.92215776, 'binary_precision': 0.08471144, 'binary_recall': 0.96168584, 'binary_specificity': 0.5477739, 'binary_f1_score': 0.1557072}
confusion matrix:
      0     1
0  3285  2712
1    10   251
early stop counter: 8
val acc:0.7297254204750061, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 9,now: 2024-07-31 11:08:32.237368,epoch time: 0:24:09.775509,used: 3:12:09.183460,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95235354, 'precision': 0.95435035, 'recall': 0.95232713, 'specificity': 0.95232713, 'f1': 0.9522992, 'auroc': 0.99560297, 'binary_precision': 0.92442966, 'binary_recall': 0.98533255, 'binary_specificity': 0.91932166, 'binary_f1_score': 0.95391}
confusion matrix:
       0      1
0  26345   2312
1    421  28282
---- Validation: 
scalar performance:
{'acc': 0.7873031, 'precision': 0.5227193, 'recall': 0.61311334, 'specificity': 0.61311334, 'f1': 0.49979693, 'auroc': 0.59344804, 'binary_precision': 0.0702204, 'binary_recall': 0.42612752, 'binary_specificity': 0.8000992, 'binary_f1_score': 0.12057206}
confusion matrix:
       0     1
0  14521  3628
1    369   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57941836, 'precision': 0.5407528, 'recall': 0.7530719, 'specificity': 0.7530719, 'f1': 0.4386259, 'auroc': 0.89307743, 'binary_precision': 0.08592386, 'binary_recall': 0.9425287, 'binary_specificity': 0.56361514, 'binary_f1_score': 0.15749039}
confusion matrix:
      0     1
0  3380  2617
1    15   246
early stop counter: 9
val acc:0.78730309009552, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 10,now: 2024-07-31 11:32:03.970544,epoch time: 0:23:31.733176,used: 3:35:40.916636,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.93551254, 'precision': 0.9404263, 'recall': 0.93546844, 'specificity': 0.93546844, 'f1': 0.93532765, 'auroc': 0.9951772, 'binary_precision': 0.8941147, 'binary_recall': 0.98815495, 'binary_specificity': 0.882782, 'binary_f1_score': 0.9387856}
confusion matrix:
       0      1
0  25297   3359
1    340  28364
---- Validation: 
scalar performance:
{'acc': 0.77022135, 'precision': 0.520184, 'recall': 0.60652006, 'specificity': 0.60652006, 'f1': 0.49085525, 'auroc': 0.59210014, 'binary_precision': 0.06550012, 'binary_recall': 0.43079317, 'binary_specificity': 0.78224695, 'binary_f1_score': 0.113711}
confusion matrix:
       0     1
0  14197  3952
1    366   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6364653, 'precision': 0.54649794, 'recall': 0.7791722, 'specificity': 0.7791722, 'f1': 0.47167903, 'auroc': 0.8932602, 'binary_precision': 0.09752198, 'binary_recall': 0.9348659, 'binary_specificity': 0.6234784, 'binary_f1_score': 0.17661962}
confusion matrix:
      0     1
0  3739  2258
1    17   244
early stop counter: 10
val acc:0.7702213525772095, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 11,now: 2024-07-31 11:55:57.744739,epoch time: 0:23:53.774195,used: 3:59:34.690831,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.93685496, 'precision': 0.9413787, 'recall': 0.9368162, 'specificity': 0.9368162, 'f1': 0.93668884, 'auroc': 0.9949001, 'binary_precision': 0.8968857, 'binary_recall': 0.987318, 'binary_specificity': 0.88631445, 'binary_f1_score': 0.9399317}
confusion matrix:
       0      1
0  25400   3258
1    364  28338
---- Validation: 
scalar performance:
{'acc': 0.73962325, 'precision': 0.516502, 'recall': 0.5951793, 'specificity': 0.5951793, 'f1': 0.47568536, 'auroc': 0.5888331, 'binary_precision': 0.058762457, 'binary_recall': 0.44012442, 'binary_specificity': 0.7502342, 'binary_f1_score': 0.10368199}
confusion matrix:
       0     1
0  13616  4533
1    360   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6225631, 'precision': 0.54451394, 'recall': 0.77008617, 'specificity': 0.77008617, 'f1': 0.46316746, 'auroc': 0.9119681, 'binary_precision': 0.0939312, 'binary_recall': 0.9310345, 'binary_specificity': 0.6091379, 'binary_f1_score': 0.17064606}
confusion matrix:
      0     1
0  3653  2344
1    18   243
early stop counter: 11
val acc:0.7396232485771179, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 12,now: 2024-07-31 12:18:03.868760,epoch time: 0:22:06.124021,used: 4:21:40.814852,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91283125, 'precision': 0.9229038, 'recall': 0.91277754, 'specificity': 0.91277754, 'f1': 0.91230154, 'auroc': 0.9940059, 'binary_precision': 0.85781145, 'binary_recall': 0.98986065, 'binary_specificity': 0.8356944, 'binary_f1_score': 0.91911745}
confusion matrix:
       0      1
0  23951   4709
1    291  28409
---- Validation: 
scalar performance:
{'acc': 0.6079715, 'precision': 0.5045921, 'recall': 0.5330217, 'specificity': 0.5330217, 'f1': 0.41231278, 'auroc': 0.57168627, 'binary_precision': 0.039830275, 'binary_recall': 0.4525661, 'binary_specificity': 0.61347735, 'binary_f1_score': 0.07321676}
confusion matrix:
       0     1
0  11134  7015
1    352   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34372005, 'precision': 0.5291466, 'recall': 0.6539141, 'specificity': 0.6539141, 'f1': 0.29576683, 'auroc': 0.8953123, 'binary_precision': 0.05934922, 'binary_recall': 0.99233717, 'binary_specificity': 0.31549108, 'binary_f1_score': 0.111999996}
confusion matrix:
      0     1
0  1892  4105
1     2   259
early stop counter: 12
val acc:0.6079714894294739, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 13,now: 2024-07-31 12:40:35.232839,epoch time: 0:22:31.364079,used: 4:44:12.178931,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.947106, 'precision': 0.9503412, 'recall': 0.94707656, 'specificity': 0.94707656, 'f1': 0.9470084, 'auroc': 0.99587506, 'binary_precision': 0.912345, 'binary_recall': 0.989338, 'binary_specificity': 0.9048151, 'binary_f1_score': 0.9492829}
confusion matrix:
       0      1
0  25932   2728
1    306  28394
---- Validation: 
scalar performance:
{'acc': 0.76638997, 'precision': 0.519975, 'recall': 0.6067866, 'specificity': 0.6067866, 'f1': 0.4893045, 'auroc': 0.5943493, 'binary_precision': 0.06501045, 'binary_recall': 0.43545878, 'binary_specificity': 0.7781145, 'binary_f1_score': 0.11313132}
confusion matrix:
       0     1
0  14122  4027
1    363   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6369447, 'precision': 0.5456793, 'recall': 0.7739253, 'specificity': 0.7739253, 'f1': 0.47113946, 'auroc': 0.8973363, 'binary_precision': 0.09667068, 'binary_recall': 0.9233717, 'binary_specificity': 0.6244789, 'binary_f1_score': 0.17501818}
confusion matrix:
      0     1
0  3745  2252
1    20   241
early stop counter: 13
val acc:0.7663899660110474, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 14,now: 2024-07-31 13:09:13.639942,epoch time: 0:28:38.407103,used: 5:12:50.586034,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9334031, 'precision': 0.9394835, 'recall': 0.9333581, 'specificity': 0.9333581, 'f1': 0.93316716, 'auroc': 0.9960187, 'binary_precision': 0.88798106, 'binary_recall': 0.9920563, 'binary_specificity': 0.8746598, 'binary_f1_score': 0.937138}
confusion matrix:
       0      1
0  25066   3592
1    228  28474
---- Validation: 
scalar performance:
{'acc': 0.68656874, 'precision': 0.511498, 'recall': 0.5744627, 'specificity': 0.5744627, 'f1': 0.45043936, 'auroc': 0.62758976, 'binary_precision': 0.050077174, 'binary_recall': 0.4541213, 'binary_specificity': 0.69480413, 'binary_f1_score': 0.09020698}
confusion matrix:
       0     1
0  12610  5539
1    351   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5596037, 'precision': 0.5394681, 'recall': 0.7463981, 'specificity': 0.7463981, 'f1': 0.4275129, 'auroc': 0.9238342, 'binary_precision': 0.08291541, 'binary_recall': 0.95019156, 'binary_specificity': 0.5426046, 'binary_f1_score': 0.15252154}
confusion matrix:
      0     1
0  3254  2743
1    13   248
early stop counter: 14
val acc:0.6865687370300293, best validation acc: 0.9393891096115112, corresponding to test acc:                         0.9480664730072021 / 0.9480664730072021
after epoch: 15,now: 2024-07-31 13:44:29.562831,epoch time: 0:35:15.922889,used: 5:48:06.508923,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_56_22_seed_0_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:48:06.508923 at 2024-07-31 13:44:29.562831
persisted model performance metric: 

scalar performance:
{'acc': 0.9480665, 'precision': 0.70584154, 'recall': 0.8281487, 'specificity': 0.8281487, 'f1': 0.7504112, 'auroc': 0.889561, 'binary_precision': 0.42523363, 'binary_recall': 0.697318, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.52830184}
confusion matrix:
      0    1
0  5751  246
1    79  182
oracle model performance metric: 

scalar performance:
{'acc': 0.9480665, 'precision': 0.70584154, 'recall': 0.8281487, 'specificity': 0.8281487, 'f1': 0.7504112, 'auroc': 0.889561, 'binary_precision': 0.42523363, 'binary_recall': 0.697318, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.52830184}
confusion matrix:
      0    1
0  5751  246
1    79  182
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool | 403328 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |  89819 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool | 403328 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |  89819 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB | 329615 GiB | 329615 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |  88733 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11486 MiB |  11486 MiB |  11486 MiB |      0 B   |
|       from large pool |  11360 MiB |  11360 MiB |  11360 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 752036 KiB |   1278 MiB | 126734 GiB | 126733 GiB |
|       from large pool | 741504 KiB |   1275 MiB | 125764 GiB | 125763 GiB |
|       from small pool |  10532 KiB |     11 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    8416    |   57546 K  |   57542 K  |
|       from large pool |      87    |     908    |   20828 K  |   20828 K  |
|       from small pool |    3642    |    8327    |   36718 K  |   36714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    8416    |   57546 K  |   57542 K  |
|       from large pool |      87    |     908    |   20828 K  |   20828 K  |
|       from small pool |    3642    |    8327    |   36718 K  |   36714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     406    |     406    |     406    |       0    |
|       from large pool |     343    |     343    |     343    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3617    |   31097 K  |   31097 K  |
|       from large pool |      19    |     188    |   13602 K  |   13602 K  |
|       from small pool |      54    |    3596    |   17494 K  |   17494 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 329615 GiB | 329615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |      0 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11486 MiB |  11486 MiB |  10270 MiB |
|       from large pool |   1118 MiB |  11360 MiB |  11360 MiB |  10242 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 126734 GiB | 126734 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 125764 GiB | 125764 GiB |
|       from small pool |      0 KiB |     22 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     406    |     406    |     327    |
|       from large pool |      30    |     343    |     343    |     313    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3617    |   31098 K  |   31098 K  |
|       from large pool |       4    |     188    |   13602 K  |   13602 K  |
|       from small pool |       0    |    3596    |   17496 K  |   17496 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 329615 GiB | 329615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |      0 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11486 MiB |  11486 MiB |  10270 MiB |
|       from large pool |   1118 MiB |  11360 MiB |  11360 MiB |  10242 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 126734 GiB | 126734 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 125764 GiB | 125764 GiB |
|       from small pool |      0 KiB |     22 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     406    |     406    |     327    |
|       from large pool |      30    |     343    |     343    |     313    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3617    |   31098 K  |   31098 K  |
|       from large pool |       4    |     188    |   13602 K  |   13602 K  |
|       from small pool |       0    |    3596    |   17496 K  |   17496 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368

 Experiment start at: 2024-07-31 14:07:25.637155
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9607401, 'precision': 0.96074, 'recall': 0.9607402, 'specificity': 0.9607402, 'f1': 0.9607401, 'auroc': 0.9927782, 'binary_precision': 0.9609925, 'binary_recall': 0.9605259, 'binary_specificity': 0.9609546, 'binary_f1_score': 0.96075916}
confusion matrix:
       0      1
0  27663   1124
1   1138  27691
---- Validation: 
scalar performance:
{'acc': 0.9151014, 'precision': 0.59604466, 'recall': 0.7156396, 'specificity': 0.7156396, 'f1': 0.6261961, 'auroc': 0.8022604, 'binary_precision': 0.21168342, 'binary_recall': 0.5007429, 'binary_specificity': 0.9305363, 'binary_f1_score': 0.29757175}
confusion matrix:
       0     1
0  16812  1255
1    336   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9468256, 'precision': 0.6977657, 'recall': 0.7957075, 'specificity': 0.7957075, 'f1': 0.7352024, 'auroc': 0.8698698, 'binary_precision': 0.4120603, 'binary_recall': 0.63076925, 'binary_specificity': 0.9606458, 'binary_f1_score': 0.49848026}
confusion matrix:
      0    1
0  5712  234
1    96  164
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 14:45:22.431979,epoch time: 0:37:56.794824,used: 0:37:56.794824,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9323799, 'precision': 0.93677366, 'recall': 0.9323417, 'specificity': 0.9323417, 'f1': 0.93220526, 'auroc': 0.9916825, 'binary_precision': 0.8931567, 'binary_recall': 0.98237944, 'binary_specificity': 0.8823039, 'binary_f1_score': 0.93564576}
confusion matrix:
       0      1
0  25398   3388
1    508  28322
---- Validation: 
scalar performance:
{'acc': 0.7646745, 'precision': 0.52866226, 'recall': 0.64978397, 'specificity': 0.64978397, 'f1': 0.5010321, 'auroc': 0.7036872, 'binary_precision': 0.079640046, 'binary_recall': 0.52600294, 'binary_specificity': 0.77356505, 'binary_f1_score': 0.13833529}
confusion matrix:
       0     1
0  13976  4091
1    319   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78988075, 'precision': 0.57293665, 'recall': 0.8333379, 'specificity': 0.8333379, 'f1': 0.56874526, 'auroc': 0.9235077, 'binary_precision': 0.15246338, 'binary_recall': 0.88076925, 'binary_specificity': 0.7859065, 'binary_f1_score': 0.25993186}
confusion matrix:
      0     1
0  4673  1273
1    31   229
early stop counter: 1
val acc:0.7646744847297668, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 2,now: 2024-07-31 15:14:57.166909,epoch time: 0:29:34.734930,used: 1:07:31.529754,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9418738, 'precision': 0.9439875, 'recall': 0.94184995, 'specificity': 0.94184995, 'f1': 0.94180226, 'auroc': 0.99159825, 'binary_precision': 0.9135261, 'binary_recall': 0.97623837, 'binary_specificity': 0.90746146, 'binary_f1_score': 0.94384164}
confusion matrix:
       0      1
0  26124   2664
1    685  28143
---- Validation: 
scalar performance:
{'acc': 0.829349, 'precision': 0.53250265, 'recall': 0.6289655, 'specificity': 0.6289655, 'f1': 0.52664286, 'auroc': 0.6343812, 'binary_precision': 0.09023044, 'binary_recall': 0.41307577, 'binary_specificity': 0.84485525, 'binary_f1_score': 0.14810868}
confusion matrix:
       0     1
0  15264  2803
1    395   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86255234, 'precision': 0.60149616, 'recall': 0.84919465, 'specificity': 0.84919465, 'f1': 0.63027215, 'auroc': 0.924965, 'binary_precision': 0.21129504, 'binary_recall': 0.8346154, 'binary_specificity': 0.86377394, 'binary_f1_score': 0.33721834}
confusion matrix:
      0    1
0  5136  810
1    43  217
early stop counter: 2
val acc:0.8293489813804626, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 3,now: 2024-07-31 15:37:09.599638,epoch time: 0:22:12.432729,used: 1:29:43.962483,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.960445, 'precision': 0.9610517, 'recall': 0.9604313, 'specificity': 0.9604313, 'f1': 0.96043116, 'auroc': 0.9941267, 'binary_precision': 0.944517, 'binary_recall': 0.97842526, 'binary_specificity': 0.9424373, 'binary_f1_score': 0.96117216}
confusion matrix:
       0      1
0  27129   1657
1    622  28208
---- Validation: 
scalar performance:
{'acc': 0.8691569, 'precision': 0.546332, 'recall': 0.6453193, 'specificity': 0.6453193, 'f1': 0.55523497, 'auroc': 0.60064447, 'binary_precision': 0.11708997, 'binary_recall': 0.40416047, 'binary_specificity': 0.8864781, 'binary_f1_score': 0.18157543}
confusion matrix:
       0     1
0  16016  2051
1    401   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85787946, 'precision': 0.6019016, 'recall': 0.86330694, 'specificity': 0.86330694, 'f1': 0.62960666, 'auroc': 0.9259392, 'binary_precision': 0.21042831, 'binary_recall': 0.86923075, 'binary_specificity': 0.85738313, 'binary_f1_score': 0.33883056}
confusion matrix:
      0    1
0  5098  848
1    34  226
early stop counter: 3
val acc:0.8691568970680237, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 4,now: 2024-07-31 16:02:06.872725,epoch time: 0:24:57.273087,used: 1:54:41.235570,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94380033, 'precision': 0.94643533, 'recall': 0.94377244, 'specificity': 0.94377244, 'f1': 0.94371486, 'auroc': 0.99335414, 'binary_precision': 0.9123191, 'binary_recall': 0.9820667, 'binary_specificity': 0.9054782, 'binary_f1_score': 0.94590896}
confusion matrix:
       0      1
0  26066   2721
1    517  28312
---- Validation: 
scalar performance:
{'acc': 0.8125934, 'precision': 0.5283798, 'recall': 0.6217062, 'specificity': 0.6217062, 'f1': 0.5162, 'auroc': 0.574905, 'binary_precision': 0.08237717, 'binary_recall': 0.41604754, 'binary_specificity': 0.8273648, 'binary_f1_score': 0.13752456}
confusion matrix:
       0     1
0  14948  3119
1    393   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.736223, 'precision': 0.56011796, 'recall': 0.8126918, 'specificity': 0.8126918, 'f1': 0.53139746, 'auroc': 0.92984295, 'binary_precision': 0.12642431, 'binary_recall': 0.89615387, 'binary_specificity': 0.72922975, 'binary_f1_score': 0.22158821}
confusion matrix:
      0     1
0  4336  1610
1    27   233
early stop counter: 4
val acc:0.812593400478363, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 5,now: 2024-07-31 16:26:25.035670,epoch time: 0:24:18.162945,used: 2:18:59.398515,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9267391, 'precision': 0.932913, 'recall': 0.92669356, 'specificity': 0.92669356, 'f1': 0.9264716, 'auroc': 0.993917, 'binary_precision': 0.8814048, 'binary_recall': 0.986299, 'binary_specificity': 0.86708814, 'binary_f1_score': 0.93090636}
confusion matrix:
       0      1
0  24960   3826
1    395  28435
---- Validation: 
scalar performance:
{'acc': 0.63746, 'precision': 0.50626683, 'recall': 0.5416066, 'specificity': 0.5416066, 'f1': 0.42707905, 'auroc': 0.55908227, 'binary_precision': 0.04395768, 'binary_recall': 0.4383358, 'binary_specificity': 0.6448774, 'binary_f1_score': 0.07990249}
confusion matrix:
       0     1
0  11651  6416
1    378   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39606833, 'precision': 0.5304243, 'recall': 0.6737962, 'specificity': 0.6737962, 'f1': 0.32991096, 'auroc': 0.91815186, 'binary_precision': 0.06356356, 'binary_recall': 0.97692305, 'binary_specificity': 0.37066936, 'binary_f1_score': 0.11936091}
confusion matrix:
      0     1
0  2204  3742
1     6   254
early stop counter: 5
val acc:0.6374599933624268, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 6,now: 2024-07-31 16:50:32.608416,epoch time: 0:24:07.572746,used: 2:43:06.971261,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93519163, 'precision': 0.9393992, 'recall': 0.935156, 'specificity': 0.935156, 'f1': 0.9350324, 'auroc': 0.9938624, 'binary_precision': 0.8965833, 'binary_recall': 0.98397446, 'binary_specificity': 0.8863376, 'binary_f1_score': 0.93824834}
confusion matrix:
       0      1
0  25515   3272
1    462  28367
---- Validation: 
scalar performance:
{'acc': 0.7322839, 'precision': 0.5157106, 'recall': 0.5879236, 'specificity': 0.5879236, 'f1': 0.47329032, 'auroc': 0.5732124, 'binary_precision': 0.0590743, 'binary_recall': 0.43239227, 'binary_specificity': 0.74345493, 'binary_f1_score': 0.10394713}
confusion matrix:
       0     1
0  13432  4635
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5412504, 'precision': 0.5377095, 'recall': 0.7348496, 'specificity': 0.7348496, 'f1': 0.41678065, 'auroc': 0.9038656, 'binary_precision': 0.07989607, 'binary_recall': 0.9461538, 'binary_specificity': 0.52354527, 'binary_f1_score': 0.1473495}
confusion matrix:
      0     1
0  3113  2833
1    14   246
early stop counter: 6
val acc:0.732283890247345, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 7,now: 2024-07-31 17:14:35.615976,epoch time: 0:24:03.007560,used: 3:07:09.978821,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9315815, 'precision': 0.9365933, 'recall': 0.93154436, 'specificity': 0.93154436, 'f1': 0.9313805, 'auroc': 0.99307674, 'binary_precision': 0.8899893, 'binary_recall': 0.98501456, 'binary_specificity': 0.87807417, 'binary_f1_score': 0.935094}
confusion matrix:
       0      1
0  25278   3510
1    432  28396
---- Validation: 
scalar performance:
{'acc': 0.7555496, 'precision': 0.5187414, 'recall': 0.59855926, 'specificity': 0.59855926, 'f1': 0.48515135, 'auroc': 0.57231265, 'binary_precision': 0.064422645, 'binary_recall': 0.4294205, 'binary_specificity': 0.767698, 'binary_f1_score': 0.11203721}
confusion matrix:
       0     1
0  13870  4197
1    384   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6583951, 'precision': 0.54780114, 'recall': 0.7794322, 'specificity': 0.7794322, 'f1': 0.48339975, 'auroc': 0.9189539, 'binary_precision': 0.10154241, 'binary_recall': 0.9115385, 'binary_specificity': 0.64732593, 'binary_f1_score': 0.18272938}
confusion matrix:
      0     1
0  3849  2097
1    23   237
early stop counter: 7
val acc:0.7555496096611023, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 8,now: 2024-07-31 17:37:43.297182,epoch time: 0:23:07.681206,used: 3:30:17.660027,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9207338, 'precision': 0.9281034, 'recall': 0.92068607, 'specificity': 0.92068607, 'f1': 0.9203851, 'auroc': 0.9931441, 'binary_precision': 0.87211657, 'binary_recall': 0.98619443, 'binary_specificity': 0.8551777, 'binary_f1_score': 0.925654}
confusion matrix:
       0      1
0  24618   4169
1    398  28431
---- Validation: 
scalar performance:
{'acc': 0.688794, 'precision': 0.5108794, 'recall': 0.5667992, 'specificity': 0.5667992, 'f1': 0.4517761, 'auroc': 0.5597667, 'binary_precision': 0.05100087, 'binary_recall': 0.43536404, 'binary_specificity': 0.6982344, 'binary_f1_score': 0.0913057}
confusion matrix:
       0     1
0  12615  5452
1    380   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.44988722, 'precision': 0.53350127, 'recall': 0.7018823, 'specificity': 0.7018823, 'f1': 0.36370283, 'auroc': 0.9172553, 'binary_precision': 0.069361, 'binary_recall': 0.97692305, 'binary_specificity': 0.4268416, 'binary_f1_score': 0.12952575}
confusion matrix:
      0     1
0  2538  3408
1     6   254
early stop counter: 8
val acc:0.6887940168380737, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 9,now: 2024-07-31 18:01:25.176821,epoch time: 0:23:41.879639,used: 3:53:59.539666,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9012774, 'precision': 0.91390765, 'recall': 0.9012138, 'specificity': 0.9012138, 'f1': 0.9005083, 'auroc': 0.99296105, 'binary_precision': 0.84178656, 'binary_recall': 0.98848385, 'binary_specificity': 0.8139438, 'binary_f1_score': 0.9092563}
confusion matrix:
       0      1
0  23431   5356
1    332  28497
---- Validation: 
scalar performance:
{'acc': 0.6276414, 'precision': 0.5058593, 'recall': 0.53937554, 'specificity': 0.53937554, 'f1': 0.4227934, 'auroc': 0.5589716, 'binary_precision': 0.0433145, 'binary_recall': 0.44427934, 'binary_specificity': 0.6344717, 'binary_f1_score': 0.07893348}
confusion matrix:
       0     1
0  11463  6604
1    374   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38398325, 'precision': 0.53013164, 'recall': 0.66932845, 'specificity': 0.66932845, 'f1': 0.32224962, 'auroc': 0.9225711, 'binary_precision': 0.062607415, 'binary_recall': 0.9807692, 'binary_specificity': 0.35788766, 'binary_f1_score': 0.11770135}
confusion matrix:
      0     1
0  2128  3818
1     5   255
early stop counter: 9
val acc:0.6276413798332214, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 10,now: 2024-07-31 18:25:29.107977,epoch time: 0:24:03.931156,used: 4:18:03.470822,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.88098794, 'precision': 0.9006982, 'recall': 0.88090324, 'specificity': 0.88090324, 'f1': 0.8794893, 'auroc': 0.9933989, 'binary_precision': 0.812019, 'binary_recall': 0.9917447, 'binary_specificity': 0.77006185, 'binary_f1_score': 0.892928}
confusion matrix:
       0      1
0  22167   6619
1    238  28592
---- Validation: 
scalar performance:
{'acc': 0.4789221, 'precision': 0.49545902, 'recall': 0.46725282, 'specificity': 0.46725282, 'f1': 0.3493422, 'auroc': 0.5554049, 'binary_precision': 0.031533387, 'binary_recall': 0.45468053, 'binary_specificity': 0.4798251, 'binary_f1_score': 0.05897658}
confusion matrix:
      0     1
0  8669  9398
1   367   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.20866904, 'precision': 0.524571, 'recall': 0.5851943, 'specificity': 0.5851943, 'f1': 0.19606707, 'auroc': 0.9311025, 'binary_precision': 0.050106402, 'binary_recall': 0.99615383, 'binary_specificity': 0.17423478, 'binary_f1_score': 0.09541352}
confusion matrix:
      0     1
0  1036  4910
1     1   259
early stop counter: 10
val acc:0.4789220988750458, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 11,now: 2024-07-31 18:50:09.084469,epoch time: 0:24:39.976492,used: 4:42:43.447314,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.89863926, 'precision': 0.9126063, 'recall': 0.89857227, 'specificity': 0.89857227, 'f1': 0.897763, 'auroc': 0.9934617, 'binary_precision': 0.83687466, 'binary_recall': 0.9904957, 'binary_specificity': 0.80664885, 'binary_f1_score': 0.90722793}
confusion matrix:
       0      1
0  23221   5566
1    274  28555
---- Validation: 
scalar performance:
{'acc': 0.59263605, 'precision': 0.50336075, 'recall': 0.5233667, 'specificity': 0.5233667, 'f1': 0.406128, 'auroc': 0.5694111, 'binary_precision': 0.039920688, 'binary_recall': 0.448737, 'binary_specificity': 0.59799635, 'binary_f1_score': 0.073318765}
confusion matrix:
       0     1
0  10804  7263
1    371   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34933934, 'precision': 0.5295189, 'recall': 0.656766, 'specificity': 0.656766, 'f1': 0.2997179, 'auroc': 0.93023264, 'binary_precision': 0.060083836, 'binary_recall': 0.99230766, 'binary_specificity': 0.32122436, 'binary_f1_score': 0.11330698}
confusion matrix:
      0     1
0  1910  4036
1     2   258
early stop counter: 11
val acc:0.5926360487937927, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 12,now: 2024-07-31 19:14:43.613637,epoch time: 0:24:34.529168,used: 5:07:17.976482,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8572966, 'precision': 0.88486123, 'recall': 0.8571944, 'specificity': 0.8571944, 'f1': 0.8546698, 'auroc': 0.99082977, 'binary_precision': 0.78205407, 'binary_recall': 0.99098164, 'binary_specificity': 0.7234072, 'binary_f1_score': 0.8742082}
confusion matrix:
       0      1
0  20824   7962
1    260  28570
---- Validation: 
scalar performance:
{'acc': 0.40720385, 'precision': 0.49019584, 'recall': 0.43148845, 'specificity': 0.43148845, 'f1': 0.3106018, 'auroc': 0.53852284, 'binary_precision': 0.02786826, 'binary_recall': 0.4576523, 'binary_specificity': 0.40532464, 'binary_f1_score': 0.05253731}
confusion matrix:
      0      1
0  7323  10744
1   365    308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.12391234, 'precision': 0.52281904, 'recall': 0.54280186, 'specificity': 0.54280186, 'f1': 0.122499734, 'auroc': 0.89948046, 'binary_precision': 0.045638055, 'binary_recall': 1.0, 'binary_specificity': 0.085603766, 'binary_f1_score': 0.08729226}
confusion matrix:
     0     1
0  509  5437
1    0   260
early stop counter: 12
val acc:0.4072038531303406, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 13,now: 2024-07-31 19:40:42.056867,epoch time: 0:25:58.443230,used: 5:33:16.419712,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.87824565, 'precision': 0.89884675, 'recall': 0.87815887, 'specificity': 0.87815887, 'f1': 0.8766351, 'auroc': 0.9933578, 'binary_precision': 0.8083915, 'binary_recall': 0.9917447, 'binary_specificity': 0.76457304, 'binary_f1_score': 0.8907304}
confusion matrix:
       0      1
0  22009   6777
1    238  28592
---- Validation: 
scalar performance:
{'acc': 0.51296693, 'precision': 0.4978087, 'recall': 0.48419404, 'specificity': 0.48419404, 'f1': 0.3668319, 'auroc': 0.55943155, 'binary_precision': 0.0336496, 'binary_recall': 0.45319465, 'binary_specificity': 0.51519346, 'binary_f1_score': 0.06264763}
confusion matrix:
      0     1
0  9308  8759
1   368   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.19755076, 'precision': 0.5248092, 'recall': 0.58123106, 'specificity': 0.58123106, 'f1': 0.18702967, 'auroc': 0.92058414, 'binary_precision': 0.049618322, 'binary_recall': 1.0, 'binary_specificity': 0.16246216, 'binary_f1_score': 0.094545454}
confusion matrix:
     0     1
0  966  4980
1    0   260
early stop counter: 13
val acc:0.5129669308662415, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 14,now: 2024-07-31 20:04:44.857737,epoch time: 0:24:02.800870,used: 5:57:19.220582,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8913149, 'precision': 0.9057872, 'recall': 0.89124286, 'specificity': 0.89124286, 'f1': 0.8903242, 'auroc': 0.99103904, 'binary_precision': 0.82934445, 'binary_recall': 0.9856053, 'binary_specificity': 0.7968804, 'binary_f1_score': 0.90074813}
confusion matrix:
       0      1
0  22939   5847
1    415  28415
---- Validation: 
scalar performance:
{'acc': 0.6168623, 'precision': 0.5052832, 'recall': 0.535931, 'specificity': 0.535931, 'f1': 0.4179058, 'auroc': 0.56497467, 'binary_precision': 0.042469412, 'binary_recall': 0.448737, 'binary_specificity': 0.623125, 'binary_f1_score': 0.07759506}
confusion matrix:
       0     1
0  11258  6809
1    371   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37608767, 'precision': 0.53111506, 'recall': 0.67256397, 'specificity': 0.67256397, 'f1': 0.3176614, 'auroc': 0.910074, 'binary_precision': 0.062711865, 'binary_recall': 0.99615383, 'binary_specificity': 0.3489741, 'binary_f1_score': 0.11799545}
confusion matrix:
      0     1
0  2075  3871
1     1   259
early stop counter: 14
val acc:0.6168622970581055, best validation acc: 0.9151014089584351, corresponding to test acc:                         0.9468256235122681 / 0.9468256235122681
after epoch: 15,now: 2024-07-31 20:28:47.875399,epoch time: 0:24:03.017662,used: 6:21:22.238244,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_14_07_25_seed_1_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 6:21:22.238244 at 2024-07-31 20:28:47.875399
persisted model performance metric: 

scalar performance:
{'acc': 0.9468256, 'precision': 0.6977657, 'recall': 0.7957075, 'specificity': 0.7957075, 'f1': 0.7352024, 'auroc': 0.8698698, 'binary_precision': 0.4120603, 'binary_recall': 0.63076925, 'binary_specificity': 0.9606458, 'binary_f1_score': 0.49848026}
confusion matrix:
      0    1
0  5712  234
1    96  164
oracle model performance metric: 

scalar performance:
{'acc': 0.9468256, 'precision': 0.6977657, 'recall': 0.7957075, 'specificity': 0.7957075, 'f1': 0.7352024, 'auroc': 0.8698698, 'binary_precision': 0.4120603, 'binary_recall': 0.63076925, 'binary_specificity': 0.9606458, 'binary_f1_score': 0.49848026}
confusion matrix:
      0    1
0  5712  234
1    96  164
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool | 403840 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |  89807 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool | 403840 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |  89807 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB | 664546 GiB | 664546 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |  88730 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11486 MiB |  21730 MiB |  10270 MiB |
|       from large pool |  11336 MiB |  11360 MiB |  21578 MiB |  10242 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 522160 KiB |   1278 MiB | 302944 GiB | 302944 GiB |
|       from large pool | 511616 KiB |   1275 MiB | 300975 GiB | 300975 GiB |
|       from small pool |  10544 KiB |     22 MiB |   1968 GiB |   1968 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    8448    |  115762 K  |  115758 K  |
|       from large pool |      87    |     908    |   41973 K  |   41973 K  |
|       from small pool |    3618    |    8359    |   73788 K  |   73785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    8448    |  115762 K  |  115758 K  |
|       from large pool |      87    |     908    |   41973 K  |   41973 K  |
|       from small pool |    3618    |    8359    |   73788 K  |   73785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     406    |     726    |     327    |
|       from large pool |     337    |     343    |     650    |     313    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3631    |   61844 K  |   61844 K  |
|       from large pool |      20    |     188    |   26688 K  |   26688 K  |
|       from small pool |      55    |    3610    |   35155 K  |   35155 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 664546 GiB | 664546 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |      0 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11486 MiB |  21730 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11360 MiB |  21578 MiB |  20684 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 302945 GiB | 302944 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 300976 GiB | 300975 GiB |
|       from small pool |      0 KiB |     26 MiB |   1969 GiB |   1969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  115762 K  |  115762 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73788 K  |   73788 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  115762 K  |  115762 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73788 K  |   73788 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     406    |     726    |     644    |
|       from large pool |      33    |     343    |     650    |     617    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   61845 K  |   61845 K  |
|       from large pool |       4    |     188    |   26688 K  |   26688 K  |
|       from small pool |       0    |    3610    |   35157 K  |   35157 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 664546 GiB | 664546 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |      0 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11486 MiB |  21730 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11360 MiB |  21578 MiB |  20684 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 302945 GiB | 302944 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 300976 GiB | 300975 GiB |
|       from small pool |      0 KiB |     26 MiB |   1969 GiB |   1969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  115762 K  |  115762 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73788 K  |   73788 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  115762 K  |  115762 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73788 K  |   73788 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     406    |     726    |     644    |
|       from large pool |      33    |     343    |     650    |     617    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   61845 K  |   61845 K  |
|       from large pool |       4    |     188    |   26688 K  |   26688 K  |
|       from small pool |       0    |    3610    |   35157 K  |   35157 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368

 Experiment start at: 2024-07-31 20:42:25.514062
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9612891, 'precision': 0.96131665, 'recall': 0.96128845, 'specificity': 0.96128845, 'f1': 0.96128845, 'auroc': 0.99358225, 'binary_precision': 0.9577944, 'binary_recall': 0.96511984, 'binary_specificity': 0.957457, 'binary_f1_score': 0.9614432}
confusion matrix:
       0      1
0  27907   1240
1   1017  28140
---- Validation: 
scalar performance:
{'acc': 0.9078464, 'precision': 0.5848878, 'recall': 0.73637664, 'specificity': 0.73637664, 'f1': 0.6143728, 'auroc': 0.80346596, 'binary_precision': 0.18561873, 'binary_recall': 0.55315614, 'binary_specificity': 0.91959715, 'binary_f1_score': 0.27796325}
confusion matrix:
       0     1
0  16710  1461
1    269   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.75124246, 'recall': 0.8240205, 'specificity': 0.8240205, 'f1': 0.78238314, 'auroc': 0.9049835, 'binary_precision': 0.51582277, 'binary_recall': 0.6735537, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.5842294}
confusion matrix:
      0    1
0  5844  153
1    79  163
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 21:07:09.487708,epoch time: 0:24:43.973646,used: 0:24:43.973646,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9594368, 'precision': 0.9609737, 'recall': 0.95943177, 'specificity': 0.95943177, 'f1': 0.95940256, 'auroc': 0.9964596, 'binary_precision': 0.9343991, 'binary_recall': 0.9882704, 'binary_specificity': 0.9305932, 'binary_f1_score': 0.96058005}
confusion matrix:
       0      1
0  27124   2023
1    342  28815
---- Validation: 
scalar performance:
{'acc': 0.8287967, 'precision': 0.53980666, 'recall': 0.6834966, 'specificity': 0.6834966, 'f1': 0.53490627, 'auroc': 0.76599663, 'binary_precision': 0.0979064, 'binary_recall': 0.5282392, 'binary_specificity': 0.83875406, 'binary_f1_score': 0.16519481}
confusion matrix:
       0     1
0  15241  2930
1    284   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80429554, 'precision': 0.5710425, 'recall': 0.8307859, 'specificity': 0.8307859, 'f1': 0.57074773, 'auroc': 0.909135, 'binary_precision': 0.14910394, 'binary_recall': 0.8595041, 'binary_specificity': 0.8020677, 'binary_f1_score': 0.2541234}
confusion matrix:
      0     1
0  4810  1187
1    34   208
early stop counter: 1
val acc:0.8287966847419739, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 2,now: 2024-07-31 21:32:07.341889,epoch time: 0:24:57.854181,used: 0:49:41.827827,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91854763, 'precision': 0.9274155, 'recall': 0.91853523, 'specificity': 0.91853523, 'f1': 0.91812134, 'auroc': 0.9944854, 'binary_precision': 0.8658931, 'binary_recall': 0.990534, 'binary_specificity': 0.8465365, 'binary_f1_score': 0.92402935}
confusion matrix:
       0      1
0  24674   4473
1    276  28881
---- Validation: 
scalar performance:
{'acc': 0.6000639, 'precision': 0.50637543, 'recall': 0.54928035, 'specificity': 0.54928035, 'f1': 0.40926704, 'auroc': 0.6157627, 'binary_precision': 0.03972274, 'binary_recall': 0.4950166, 'binary_specificity': 0.6035441, 'binary_f1_score': 0.07354392}
confusion matrix:
       0     1
0  10967  7204
1    304   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.30854303, 'precision': 0.5241984, 'recall': 0.6284237, 'specificity': 0.6284237, 'f1': 0.2688893, 'auroc': 0.91011834, 'binary_precision': 0.05193662, 'binary_recall': 0.9752066, 'binary_specificity': 0.28164083, 'binary_f1_score': 0.09862098}
confusion matrix:
      0     1
0  1689  4308
1     6   236
early stop counter: 2
val acc:0.6000639200210571, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 3,now: 2024-07-31 21:57:03.614269,epoch time: 0:24:56.272380,used: 1:14:38.100207,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95324504, 'precision': 0.95513535, 'recall': 0.9532384, 'specificity': 0.9532384, 'f1': 0.953196, 'auroc': 0.9951525, 'binary_precision': 0.9258555, 'binary_recall': 0.9854242, 'binary_specificity': 0.92105263, 'binary_f1_score': 0.9547116}
confusion matrix:
       0      1
0  26845   2301
1    425  28733
---- Validation: 
scalar performance:
{'acc': 0.7851702, 'precision': 0.52051187, 'recall': 0.6095656, 'specificity': 0.6095656, 'f1': 0.49483803, 'auroc': 0.58216166, 'binary_precision': 0.064483374, 'binary_recall': 0.42192692, 'binary_specificity': 0.7972043, 'binary_f1_score': 0.11186964}
confusion matrix:
       0     1
0  14486  3685
1    348   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7100497, 'precision': 0.5522089, 'recall': 0.8055543, 'specificity': 0.8055543, 'f1': 0.5093962, 'auroc': 0.9257941, 'binary_precision': 0.10961634, 'binary_recall': 0.90909094, 'binary_specificity': 0.70201766, 'binary_f1_score': 0.1956425}
confusion matrix:
      0     1
0  4210  1787
1    22   220
early stop counter: 3
val acc:0.7851701974868774, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 4,now: 2024-07-31 22:21:58.441672,epoch time: 0:24:54.827403,used: 1:39:32.927610,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9636732, 'precision': 0.9640665, 'recall': 0.96367013, 'specificity': 0.96367013, 'f1': 0.96366525, 'auroc': 0.99356157, 'binary_precision': 0.9506066, 'binary_recall': 0.9781878, 'binary_specificity': 0.9491525, 'binary_f1_score': 0.96419996}
confusion matrix:
       0      1
0  27664   1482
1    636  28522
---- Validation: 
scalar performance:
{'acc': 0.7906568, 'precision': 0.5204408, 'recall': 0.6067785, 'specificity': 0.6067785, 'f1': 0.4965057, 'auroc': 0.54189503, 'binary_precision': 0.06462585, 'binary_recall': 0.410299, 'binary_specificity': 0.80325794, 'binary_f1_score': 0.111663654}
confusion matrix:
       0     1
0  14596  3575
1    355   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5975317, 'precision': 0.53837234, 'recall': 0.75297326, 'specificity': 0.75297326, 'f1': 0.44354787, 'auroc': 0.90602875, 'binary_precision': 0.08213628, 'binary_recall': 0.9214876, 'binary_specificity': 0.5844589, 'binary_f1_score': 0.15082854}
confusion matrix:
      0     1
0  3505  2492
1    19   223
early stop counter: 4
val acc:0.7906568050384521, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 5,now: 2024-07-31 22:47:18.676258,epoch time: 0:25:20.234586,used: 2:04:53.162196,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9272434, 'precision': 0.9330237, 'recall': 0.9272335, 'specificity': 0.9272335, 'f1': 0.9269986, 'auroc': 0.99262697, 'binary_precision': 0.8830366, 'binary_recall': 0.9849779, 'binary_specificity': 0.86948913, 'binary_f1_score': 0.93122566}
confusion matrix:
       0      1
0  25343   3804
1    438  28719
---- Validation: 
scalar performance:
{'acc': 0.63964206, 'precision': 0.5060638, 'recall': 0.5448305, 'specificity': 0.5448305, 'f1': 0.42475107, 'auroc': 0.5403465, 'binary_precision': 0.039868597, 'binary_recall': 0.4435216, 'binary_specificity': 0.64613944, 'binary_f1_score': 0.07316071}
confusion matrix:
       0     1
0  11741  6430
1    335   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4215419, 'precision': 0.5282029, 'recall': 0.6792722, 'specificity': 0.6792722, 'f1': 0.34226683, 'auroc': 0.90366876, 'binary_precision': 0.060558602, 'binary_recall': 0.9586777, 'binary_specificity': 0.3998666, 'binary_f1_score': 0.11392095}
confusion matrix:
      0     1
0  2398  3599
1    10   232
early stop counter: 5
val acc:0.639642059803009, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 6,now: 2024-07-31 23:12:08.371229,epoch time: 0:24:49.694971,used: 2:29:42.857167,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93775725, 'precision': 0.94224936, 'recall': 0.9377452, 'specificity': 0.9377452, 'f1': 0.93759763, 'auroc': 0.99523854, 'binary_precision': 0.8977379, 'binary_recall': 0.98809975, 'binary_specificity': 0.8873906, 'binary_f1_score': 0.94075394}
confusion matrix:
       0      1
0  25863   3282
1    347  28812
---- Validation: 
scalar performance:
{'acc': 0.7197571, 'precision': 0.5125223, 'recall': 0.5805938, 'specificity': 0.5805938, 'f1': 0.46216366, 'auroc': 0.55484116, 'binary_precision': 0.050202742, 'binary_recall': 0.43189368, 'binary_specificity': 0.72929394, 'binary_f1_score': 0.08994984}
confusion matrix:
       0     1
0  13252  4919
1    342   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52668697, 'precision': 0.5331248, 'recall': 0.72206974, 'specificity': 0.72206974, 'f1': 0.40363738, 'auroc': 0.89997685, 'binary_precision': 0.07145116, 'binary_recall': 0.9338843, 'binary_specificity': 0.5102551, 'binary_f1_score': 0.13274598}
confusion matrix:
      0     1
0  3060  2937
1    16   226
early stop counter: 6
val acc:0.719757080078125, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 7,now: 2024-07-31 23:36:31.693346,epoch time: 0:24:23.322117,used: 2:54:06.179284,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96686333, 'precision': 0.9673574, 'recall': 0.9668611, 'specificity': 0.9668611, 'f1': 0.96685445, 'auroc': 0.9956738, 'binary_precision': 0.9521959, 'binary_recall': 0.98309094, 'binary_specificity': 0.95063126, 'binary_f1_score': 0.9673968}
confusion matrix:
       0      1
0  27709   1439
1    493  28663
---- Validation: 
scalar performance:
{'acc': 0.82496136, 'precision': 0.52796876, 'recall': 0.6269082, 'specificity': 0.6269082, 'f1': 0.5173657, 'auroc': 0.5831183, 'binary_precision': 0.078517586, 'binary_recall': 0.4152824, 'binary_specificity': 0.83853394, 'binary_f1_score': 0.1320655}
confusion matrix:
       0     1
0  15237  2934
1    352   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73008496, 'precision': 0.5527355, 'recall': 0.7961488, 'specificity': 0.7961488, 'f1': 0.5186454, 'auroc': 0.89794004, 'binary_precision': 0.11278196, 'binary_recall': 0.8677686, 'binary_specificity': 0.7245289, 'binary_f1_score': 0.19961977}
confusion matrix:
      0     1
0  4345  1652
1    32   210
early stop counter: 7
val acc:0.8249613642692566, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 8,now: 2024-08-01 00:01:11.088222,epoch time: 0:24:39.394876,used: 3:18:45.574160,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92978185, 'precision': 0.93595505, 'recall': 0.92976755, 'specificity': 0.92976755, 'f1': 0.92953074, 'auroc': 0.99460316, 'binary_precision': 0.8841379, 'binary_recall': 0.98923147, 'binary_specificity': 0.87030363, 'binary_f1_score': 0.93373686}
confusion matrix:
       0      1
0  25365   3780
1    314  28845
---- Validation: 
scalar performance:
{'acc': 0.6392692, 'precision': 0.5057115, 'recall': 0.54222876, 'specificity': 0.54222876, 'f1': 0.42421567, 'auroc': 0.5498559, 'binary_precision': 0.039414752, 'binary_recall': 0.4385382, 'binary_specificity': 0.6459193, 'binary_f1_score': 0.07232877}
confusion matrix:
       0     1
0  11737  6434
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34620932, 'precision': 0.5261912, 'recall': 0.64999956, 'specificity': 0.64999956, 'f1': 0.29470345, 'auroc': 0.8513857, 'binary_precision': 0.054975644, 'binary_recall': 0.9793388, 'binary_specificity': 0.32066032, 'binary_f1_score': 0.10410718}
confusion matrix:
      0     1
0  1923  4074
1     5   237
early stop counter: 8
val acc:0.6392691731452942, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 9,now: 2024-08-01 00:26:04.250063,epoch time: 0:24:53.161841,used: 3:43:38.736001,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9133164, 'precision': 0.92298234, 'recall': 0.91329825, 'specificity': 0.91329825, 'f1': 0.9128158, 'auroc': 0.9940531, 'binary_precision': 0.8591008, 'binary_recall': 0.9888542, 'binary_specificity': 0.8377423, 'binary_f1_score': 0.9194222}
confusion matrix:
       0      1
0  24416   4729
1    325  28834
---- Validation: 
scalar performance:
{'acc': 0.5457306, 'precision': 0.5000419, 'recall': 0.5003344, 'specificity': 0.5003344, 'f1': 0.38023168, 'auroc': 0.5477693, 'binary_precision': 0.03211334, 'binary_recall': 0.45182723, 'binary_specificity': 0.54884154, 'binary_f1_score': 0.059964724}
confusion matrix:
      0     1
0  9973  8198
1   330   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.35037667, 'precision': 0.52530205, 'recall': 0.64621913, 'specificity': 0.64621913, 'f1': 0.29707703, 'auroc': 0.83036953, 'binary_precision': 0.054685675, 'binary_recall': 0.96694213, 'binary_specificity': 0.32549608, 'binary_f1_score': 0.10351693}
confusion matrix:
      0     1
0  1952  4045
1     8   234
early stop counter: 9
val acc:0.5457305908203125, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 10,now: 2024-08-01 00:51:18.967142,epoch time: 0:25:14.717079,used: 4:08:53.453080,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8796995, 'precision': 0.9003304, 'recall': 0.87968004, 'specificity': 0.87968004, 'f1': 0.8781255, 'auroc': 0.9928421, 'binary_precision': 0.8094932, 'binary_recall': 0.9931749, 'binary_specificity': 0.7661852, 'binary_f1_score': 0.891976}
confusion matrix:
       0      1
0  22332   6815
1    199  28958
---- Validation: 
scalar performance:
{'acc': 0.4476642, 'precision': 0.49399212, 'recall': 0.4520859, 'specificity': 0.4520859, 'f1': 0.33047706, 'auroc': 0.54201525, 'binary_precision': 0.026655035, 'binary_recall': 0.45681062, 'binary_specificity': 0.44736117, 'binary_f1_score': 0.050370913}
confusion matrix:
      0      1
0  8129  10042
1   327    275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.14521559, 'precision': 0.521704, 'recall': 0.55536103, 'specificity': 0.55536103, 'f1': 0.14128694, 'auroc': 0.8445316, 'binary_precision': 0.043408073, 'binary_recall': 1.0, 'binary_specificity': 0.11072203, 'binary_f1_score': 0.0832044}
confusion matrix:
     0     1
0  664  5333
1    0   242
early stop counter: 10
val acc:0.44766420125961304, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 11,now: 2024-08-01 01:16:12.988759,epoch time: 0:24:54.021617,used: 4:33:47.474697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.93041646, 'precision': 0.93690693, 'recall': 0.930406, 'specificity': 0.930406, 'f1': 0.9301559, 'auroc': 0.9959822, 'binary_precision': 0.88369817, 'binary_recall': 0.9913228, 'binary_specificity': 0.86948913, 'binary_f1_score': 0.9344217}
confusion matrix:
       0      1
0  25343   3804
1    253  28904
---- Validation: 
scalar performance:
{'acc': 0.6771427, 'precision': 0.5090565, 'recall': 0.563399, 'specificity': 0.563399, 'f1': 0.4424393, 'auroc': 0.5755869, 'binary_precision': 0.044399932, 'binary_recall': 0.44186047, 'binary_specificity': 0.68493754, 'binary_f1_score': 0.080691636}
confusion matrix:
       0     1
0  12446  5725
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4529572, 'precision': 0.53030246, 'recall': 0.6975964, 'specificity': 0.6975964, 'f1': 0.36161372, 'auroc': 0.909529, 'binary_precision': 0.06406379, 'binary_recall': 0.9628099, 'binary_specificity': 0.43238285, 'binary_f1_score': 0.12013405}
confusion matrix:
      0     1
0  2593  3404
1     9   233
early stop counter: 11
val acc:0.6771426796913147, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 12,now: 2024-08-01 01:41:18.394825,epoch time: 0:25:05.406066,used: 4:58:52.880763,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9340697, 'precision': 0.93972003, 'recall': 0.93405807, 'specificity': 0.93405807, 'f1': 0.933856, 'auroc': 0.99594617, 'binary_precision': 0.8899261, 'binary_recall': 0.9907058, 'binary_specificity': 0.8774103, 'binary_f1_score': 0.93761563}
confusion matrix:
       0      1
0  25573   3573
1    271  28887
---- Validation: 
scalar performance:
{'acc': 0.7221009, 'precision': 0.51399845, 'recall': 0.58983505, 'specificity': 0.58983505, 'f1': 0.46484277, 'auroc': 0.59190214, 'binary_precision': 0.052376334, 'binary_recall': 0.44850498, 'binary_specificity': 0.73116505, 'binary_f1_score': 0.09379885}
confusion matrix:
       0     1
0  13286  4885
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64657795, 'precision': 0.5423106, 'recall': 0.76857233, 'specificity': 0.76857233, 'f1': 0.47046763, 'auroc': 0.8841149, 'binary_precision': 0.0908712, 'binary_recall': 0.90082645, 'binary_specificity': 0.63631815, 'binary_f1_score': 0.16508898}
confusion matrix:
      0     1
0  3816  2181
1    24   218
early stop counter: 12
val acc:0.7221009135246277, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 13,now: 2024-08-01 02:06:08.727743,epoch time: 0:24:50.332918,used: 5:23:43.213681,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9352189, 'precision': 0.9406525, 'recall': 0.93520933, 'specificity': 0.93520933, 'f1': 0.9350175, 'auroc': 0.99449146, 'binary_precision': 0.8917634, 'binary_recall': 0.9907055, 'binary_specificity': 0.8797132, 'binary_f1_score': 0.9386342}
confusion matrix:
       0      1
0  25641   3506
1    271  28886
---- Validation: 
scalar performance:
{'acc': 0.68603843, 'precision': 0.5090592, 'recall': 0.5623729, 'specificity': 0.5623729, 'f1': 0.44573766, 'auroc': 0.57366896, 'binary_precision': 0.044578314, 'binary_recall': 0.43023255, 'binary_specificity': 0.69451326, 'binary_f1_score': 0.08078603}
confusion matrix:
       0     1
0  12620  5551
1    343   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4422183, 'precision': 0.52967733, 'recall': 0.6920103, 'specificity': 0.6920103, 'f1': 0.355109, 'auroc': 0.8759698, 'binary_precision': 0.06290497, 'binary_recall': 0.9628099, 'binary_specificity': 0.42121062, 'binary_f1_score': 0.11809427}
confusion matrix:
      0     1
0  2526  3471
1     9   233
early stop counter: 13
val acc:0.6860384345054626, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 14,now: 2024-08-01 02:30:16.711762,epoch time: 0:24:07.984019,used: 5:47:51.197700,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95336515, 'precision': 0.9553877, 'recall': 0.95336056, 'specificity': 0.95336056, 'f1': 0.953313, 'auroc': 0.99565053, 'binary_precision': 0.92507315, 'binary_recall': 0.986658, 'binary_specificity': 0.92006314, 'binary_f1_score': 0.9548736}
confusion matrix:
       0      1
0  26818   2330
1    389  28767
---- Validation: 
scalar performance:
{'acc': 0.846162, 'precision': 0.533681, 'recall': 0.63705665, 'specificity': 0.63705665, 'f1': 0.53126645, 'auroc': 0.65132177, 'binary_precision': 0.08943965, 'binary_recall': 0.41362128, 'binary_specificity': 0.860492, 'binary_f1_score': 0.14707619}
confusion matrix:
       0     1
0  15636  2535
1    353   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.7383971, 'recall': 0.8285513, 'specificity': 0.8285513, 'f1': 0.7752495, 'auroc': 0.90805787, 'binary_precision': 0.48967552, 'binary_recall': 0.6859504, 'binary_specificity': 0.97115225, 'binary_f1_score': 0.5714286}
confusion matrix:
      0    1
0  5824  173
1    76  166
early stop counter: 14
val acc:0.8461620211601257, best validation acc: 0.9078463912010193, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 15,now: 2024-08-01 02:55:15.912610,epoch time: 0:24:59.200848,used: 6:12:50.398548,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_20_42_25_seed_2_23775368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 6:12:50.398548 at 2024-08-01 02:55:15.912610
persisted model performance metric: 

scalar performance:
{'acc': 0.96281457, 'precision': 0.75124246, 'recall': 0.8240205, 'specificity': 0.8240205, 'f1': 0.78238314, 'auroc': 0.9049835, 'binary_precision': 0.51582277, 'binary_recall': 0.6735537, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.5842294}
confusion matrix:
      0    1
0  5844  153
1    79  163
oracle model performance metric: 

scalar performance:
{'acc': 0.96281457, 'precision': 0.75124246, 'recall': 0.8240205, 'specificity': 0.8240205, 'f1': 0.78238314, 'auroc': 0.9049835, 'binary_precision': 0.51582277, 'binary_recall': 0.6735537, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.5842294}
confusion matrix:
      0    1
0  5844  153
1    79  163
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491221 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool | 401408 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491221 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool | 401408 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10880 MiB |    990 TiB |    990 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    988 TiB |    988 TiB |
|       from small pool |  88732 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11504 MiB |  11504 MiB |  32242 MiB |  20738 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32064 MiB |  20684 MiB |
|       from small pool |    124 MiB |    126 MiB |    178 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 635178 KiB |   1278 MiB | 460382 GiB | 460382 GiB |
|       from large pool | 626688 KiB |   1275 MiB | 457363 GiB | 457362 GiB |
|       from small pool |   8490 KiB |     26 MiB |   3019 GiB |   3019 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    8534    |  175960 K  |  175956 K  |
|       from large pool |      87    |     908    |   64023 K  |   64023 K  |
|       from small pool |    3630    |    8445    |  111936 K  |  111933 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    8534    |  175960 K  |  175956 K  |
|       from large pool |      87    |     908    |   64023 K  |   64023 K  |
|       from small pool |    3630    |    8445    |  111936 K  |  111933 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     410    |     410    |    1054    |     644    |
|       from large pool |     348    |     348    |     965    |     617    |
|       from small pool |      62    |      63    |      89    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3679    |   92821 K  |   92821 K  |
|       from large pool |      24    |     203    |   39511 K  |   39511 K  |
|       from small pool |      47    |    3653    |   53309 K  |   53309 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool |  16640 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool |  16640 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    990 TiB |    990 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    988 TiB |    988 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1100 MiB |  11504 MiB |  32242 MiB |  31142 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32064 MiB |  31060 MiB |
|       from small pool |     96 MiB |    126 MiB |    178 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 460382 GiB | 460382 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 457363 GiB | 457363 GiB |
|       from small pool |      0 KiB |     26 MiB |   3019 GiB |   3019 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8534    |  175960 K  |  175960 K  |
|       from large pool |       2    |     908    |   64023 K  |   64023 K  |
|       from small pool |       0    |    8445    |  111936 K  |  111936 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8534    |  175960 K  |  175960 K  |
|       from large pool |       2    |     908    |   64023 K  |   64023 K  |
|       from small pool |       0    |    8445    |  111936 K  |  111936 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     410    |    1054    |     972    |
|       from large pool |      34    |     348    |     965    |     931    |
|       from small pool |      48    |      63    |      89    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3679    |   92822 K  |   92822 K  |
|       from large pool |       4    |     203    |   39511 K  |   39511 K  |
|       from small pool |       0    |    3653    |   53311 K  |   53311 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 02:56:54 2024]
Finished job 0.
1 of 1 steps (100%) done
