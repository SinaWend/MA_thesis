Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 17:16:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111

 Experiment start at: 2024-08-04 17:30:20.534731
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7481869, 'precision': 0.77178895, 'recall': 0.74808407, 'specificity': 0.74808407, 'f1': 0.7425467, 'auroc': 0.8469976, 'binary_precision': 0.6918708, 'binary_recall': 0.8955749, 'binary_specificity': 0.60059315, 'binary_f1_score': 0.78065306}
confusion matrix:
       0      1
0  17213  11447
1   2997  25703
---- Validation: 
scalar performance:
{'acc': 0.4861111, 'precision': 0.5102307, 'recall': 0.57719076, 'specificity': 0.57719076, 'f1': 0.36279175, 'auroc': 0.5933391, 'binary_precision': 0.043918233, 'binary_recall': 0.6749611, 'binary_specificity': 0.47942036, 'binary_f1_score': 0.0824703}
confusion matrix:
      0     1
0  8701  9448
1   209   434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41770533, 'precision': 0.52382267, 'recall': 0.6412114, 'specificity': 0.6412114, 'f1': 0.33961228, 'auroc': 0.77270293, 'binary_precision': 0.060078025, 'binary_recall': 0.88505745, 'binary_specificity': 0.39736536, 'binary_f1_score': 0.112518266}
confusion matrix:
      0     1
0  2383  3614
1    30   231
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 17:48:29.265400,epoch time: 0:18:08.730669,used: 0:18:08.730669,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8312413, 'precision': 0.8403318, 'recall': 0.83118427, 'specificity': 0.83118427, 'f1': 0.83008987, 'auroc': 0.9192858, 'binary_precision': 0.7848841, 'binary_recall': 0.91292685, 'binary_specificity': 0.74944174, 'binary_f1_score': 0.8440772}
confusion matrix:
       0      1
0  21479   7181
1   2499  26201
---- Validation: 
scalar performance:
{'acc': 0.6454874, 'precision': 0.51897234, 'recall': 0.6327002, 'specificity': 0.6327002, 'f1': 0.4427966, 'auroc': 0.65165985, 'binary_precision': 0.058400586, 'binary_recall': 0.61897355, 'binary_specificity': 0.6464268, 'binary_f1_score': 0.10673103}
confusion matrix:
       0     1
0  11732  6417
1    245   398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.668744, 'precision': 0.53306943, 'recall': 0.6879062, 'specificity': 0.6879062, 'f1': 0.47282773, 'auroc': 0.76311266, 'binary_precision': 0.084784605, 'binary_recall': 0.70881224, 'binary_specificity': 0.6670002, 'binary_f1_score': 0.15145314}
confusion matrix:
      0     1
0  4000  1997
1    76   185
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 18:05:49.330713,epoch time: 0:17:20.065313,used: 0:35:28.795982,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.833682, 'precision': 0.8459303, 'recall': 0.83360326, 'specificity': 0.83360326, 'f1': 0.8321736, 'auroc': 0.9240319, 'binary_precision': 0.7810465, 'binary_recall': 0.9277104, 'binary_specificity': 0.7394961, 'binary_f1_score': 0.84808433}
confusion matrix:
       0      1
0  21191   7465
1   2075  26629
---- Validation: 
scalar performance:
{'acc': 0.66693276, 'precision': 0.5194233, 'recall': 0.63180184, 'specificity': 0.63180184, 'f1': 0.45199096, 'auroc': 0.6348835, 'binary_precision': 0.05987461, 'binary_recall': 0.5940902, 'binary_specificity': 0.66951346, 'binary_f1_score': 0.10878542}
confusion matrix:
       0     1
0  12151  5998
1    261   382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6912752, 'precision': 0.53282875, 'recall': 0.6795064, 'specificity': 0.6795064, 'f1': 0.48194298, 'auroc': 0.7478797, 'binary_precision': 0.086181276, 'binary_recall': 0.6666667, 'binary_specificity': 0.69234616, 'binary_f1_score': 0.15263157}
confusion matrix:
      0     1
0  4152  1845
1    87   174
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 18:22:51.507154,epoch time: 0:17:02.176441,used: 0:52:30.972423,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.863424, 'precision': 0.87141776, 'recall': 0.8633652, 'specificity': 0.8633652, 'f1': 0.8626715, 'auroc': 0.9484303, 'binary_precision': 0.81712914, 'binary_recall': 0.9366965, 'binary_specificity': 0.7900339, 'binary_f1_score': 0.87283707}
confusion matrix:
       0      1
0  22640   6017
1   1817  26886
---- Validation: 
scalar performance:
{'acc': 0.6944444, 'precision': 0.5241484, 'recall': 0.6572959, 'specificity': 0.6572959, 'f1': 0.46827078, 'auroc': 0.67217135, 'binary_precision': 0.06736806, 'binary_recall': 0.61741835, 'binary_specificity': 0.6971734, 'binary_f1_score': 0.121481024}
confusion matrix:
       0     1
0  12653  5496
1    246   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7532758, 'precision': 0.54462945, 'recall': 0.7155206, 'specificity': 0.7155206, 'f1': 0.520134, 'auroc': 0.7855863, 'binary_precision': 0.10764526, 'binary_recall': 0.6743295, 'binary_specificity': 0.75671166, 'binary_f1_score': 0.185654}
confusion matrix:
      0     1
0  4538  1459
1    85   176
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 18:39:55.318953,epoch time: 0:17:03.811799,used: 1:09:34.784222,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86783475, 'precision': 0.8704771, 'recall': 0.8678024, 'specificity': 0.8678024, 'f1': 0.8675914, 'auroc': 0.9459137, 'binary_precision': 0.8393804, 'binary_recall': 0.9100063, 'binary_specificity': 0.8255984, 'binary_f1_score': 0.8732677}
confusion matrix:
       0      1
0  23660   4998
1   2583  26119
---- Validation: 
scalar performance:
{'acc': 0.72914004, 'precision': 0.5214726, 'recall': 0.62875485, 'specificity': 0.62875485, 'f1': 0.47818863, 'auroc': 0.64889205, 'binary_precision': 0.06546805, 'binary_recall': 0.5209953, 'binary_specificity': 0.7365144, 'binary_f1_score': 0.11631945}
confusion matrix:
       0     1
0  13367  4782
1    308   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7775647, 'precision': 0.5427794, 'recall': 0.6897146, 'specificity': 0.6897146, 'f1': 0.5267083, 'auroc': 0.75888515, 'binary_precision': 0.10756419, 'binary_recall': 0.59386975, 'binary_specificity': 0.7855595, 'binary_f1_score': 0.18213865}
confusion matrix:
      0     1
0  4711  1286
1   106   155
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 18:56:57.580515,epoch time: 0:17:02.261562,used: 1:26:37.045784,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88298464, 'precision': 0.8837465, 'recall': 0.8829668, 'specificity': 0.8829668, 'f1': 0.882923, 'auroc': 0.9564903, 'binary_precision': 0.8668468, 'binary_recall': 0.90520155, 'binary_specificity': 0.8607321, 'binary_f1_score': 0.8856091}
confusion matrix:
       0      1
0  24666   3991
1   2721  25982
---- Validation: 
scalar performance:
{'acc': 0.78975093, 'precision': 0.52784026, 'recall': 0.63913244, 'specificity': 0.63913244, 'f1': 0.5074216, 'auroc': 0.6948631, 'binary_precision': 0.07827639, 'binary_recall': 0.47744945, 'binary_specificity': 0.80081546, 'binary_f1_score': 0.13450164}
confusion matrix:
       0     1
0  14534  3615
1    336   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85059124, 'precision': 0.5619688, 'recall': 0.7003319, 'specificity': 0.7003319, 'f1': 0.5738583, 'auroc': 0.7806221, 'binary_precision': 0.14675052, 'binary_recall': 0.5363985, 'binary_specificity': 0.86426544, 'binary_f1_score': 0.23045267}
confusion matrix:
      0    1
0  5183  814
1   121  140
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-04 19:14:02.266159,epoch time: 0:17:04.685644,used: 1:43:41.731428,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8807183, 'precision': 0.8826187, 'recall': 0.880749, 'specificity': 0.880749, 'f1': 0.88057595, 'auroc': 0.9546739, 'binary_precision': 0.9098032, 'binary_recall': 0.84546244, 'binary_specificity': 0.9160356, 'binary_f1_score': 0.8764536}
confusion matrix:
       0      1
0  26249   2406
1   4436  24269
---- Validation: 
scalar performance:
{'acc': 0.82785225, 'precision': 0.5247299, 'recall': 0.60185385, 'specificity': 0.60185385, 'f1': 0.5147509, 'auroc': 0.6714165, 'binary_precision': 0.07563851, 'binary_recall': 0.3592535, 'binary_specificity': 0.8444542, 'binary_f1_score': 0.1249662}
confusion matrix:
       0     1
0  15326  2823
1    412   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8772771, 'precision': 0.57229847, 'recall': 0.6940999, 'specificity': 0.6940999, 'f1': 0.5923106, 'auroc': 0.77220285, 'binary_precision': 0.16862746, 'binary_recall': 0.49425286, 'binary_specificity': 0.89394695, 'binary_f1_score': 0.25146198}
confusion matrix:
      0    1
0  5361  636
1   132  129
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-04 19:31:09.017385,epoch time: 0:17:06.751226,used: 2:00:48.482654,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89213735, 'precision': 0.8963196, 'recall': 0.8920927, 'specificity': 0.8920927, 'f1': 0.89184415, 'auroc': 0.96758926, 'binary_precision': 0.85582453, 'binary_recall': 0.94338965, 'binary_specificity': 0.8407957, 'binary_f1_score': 0.8974763}
confusion matrix:
       0      1
0  24093   4562
1   1625  27080
---- Validation: 
scalar performance:
{'acc': 0.7601107, 'precision': 0.52803785, 'recall': 0.65603966, 'specificity': 0.65603966, 'f1': 0.49758482, 'auroc': 0.6760295, 'binary_precision': 0.07667032, 'binary_recall': 0.5443235, 'binary_specificity': 0.7677558, 'binary_f1_score': 0.1344086}
confusion matrix:
       0     1
0  13934  4215
1    293   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82054967, 'precision': 0.55853736, 'recall': 0.7249688, 'specificity': 0.7249688, 'f1': 0.5612285, 'auroc': 0.79800737, 'binary_precision': 0.1365936, 'binary_recall': 0.62068963, 'binary_specificity': 0.82924795, 'binary_f1_score': 0.22391155}
confusion matrix:
      0     1
0  4973  1024
1    99   162
early stop counter: 1
val acc:0.7601106762886047, best validation acc: 0.8278522491455078, corresponding to test acc:                         0.8772770762443542 / 0.8772770762443542
after epoch: 8,now: 2024-08-04 19:48:09.891258,epoch time: 0:17:00.873873,used: 2:17:49.356527,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89647835, 'precision': 0.8967607, 'recall': 0.89646685, 'specificity': 0.89646685, 'f1': 0.8964579, 'auroc': 0.96504307, 'binary_precision': 0.8863922, 'binary_recall': 0.909737, 'binary_specificity': 0.88319665, 'binary_f1_score': 0.8979128}
confusion matrix:
       0      1
0  25308   3347
1   2591  26114
---- Validation: 
scalar performance:
{'acc': 0.804917, 'precision': 0.52654254, 'recall': 0.62373245, 'specificity': 0.62373245, 'f1': 0.5104977, 'auroc': 0.66772646, 'binary_precision': 0.0772028, 'binary_recall': 0.42923796, 'binary_specificity': 0.8182269, 'binary_f1_score': 0.13086772}
confusion matrix:
       0     1
0  14850  3299
1    367   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8446788, 'precision': 0.56050056, 'recall': 0.7027441, 'specificity': 0.7027441, 'f1': 0.57050323, 'auroc': 0.7624879, 'binary_precision': 0.1434303, 'binary_recall': 0.54789275, 'binary_specificity': 0.85759544, 'binary_f1_score': 0.227345}
confusion matrix:
      0    1
0  5143  854
1   118  143
early stop counter: 2
val acc:0.8049169778823853, best validation acc: 0.8278522491455078, corresponding to test acc:                         0.8772770762443542 / 0.8772770762443542
after epoch: 9,now: 2024-08-04 20:04:50.443536,epoch time: 0:16:40.552278,used: 2:34:29.908805,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9070258, 'precision': 0.9082142, 'recall': 0.9070052, 'specificity': 0.9070052, 'f1': 0.90695494, 'auroc': 0.9712564, 'binary_precision': 0.8863794, 'binary_recall': 0.93390703, 'binary_specificity': 0.8801033, 'binary_f1_score': 0.9095227}
confusion matrix:
       0      1
0  25222   3436
1   1897  26805
---- Validation: 
scalar performance:
{'acc': 0.78097063, 'precision': 0.52776366, 'recall': 0.64358747, 'specificity': 0.64358747, 'f1': 0.5044148, 'auroc': 0.68973887, 'binary_precision': 0.077596694, 'binary_recall': 0.496112, 'binary_specificity': 0.7910629, 'binary_f1_score': 0.1342028}
confusion matrix:
       0     1
0  14357  3792
1    324   319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240652, 'precision': 0.5578362, 'recall': 0.71764135, 'specificity': 0.71764135, 'f1': 0.56136394, 'auroc': 0.8000897, 'binary_precision': 0.13604853, 'binary_recall': 0.6015326, 'binary_specificity': 0.8337502, 'binary_f1_score': 0.2219081}
confusion matrix:
      0    1
0  5000  997
1   104  157
early stop counter: 3
val acc:0.7809706330299377, best validation acc: 0.8278522491455078, corresponding to test acc:                         0.8772770762443542 / 0.8772770762443542
after epoch: 10,now: 2024-08-04 20:21:16.811260,epoch time: 0:16:26.367724,used: 2:50:56.276529,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90275455, 'precision': 0.9037531, 'recall': 0.9027355, 'specificity': 0.9027355, 'f1': 0.9026913, 'auroc': 0.96846724, 'binary_precision': 0.8838645, 'binary_recall': 0.9275312, 'binary_specificity': 0.8779398, 'binary_f1_score': 0.9051715}
confusion matrix:
       0      1
0  25160   3498
1   2080  26622
---- Validation: 
scalar performance:
{'acc': 0.7797467, 'precision': 0.5318015, 'recall': 0.6669556, 'specificity': 0.6669556, 'f1': 0.50930136, 'auroc': 0.69583845, 'binary_precision': 0.08361124, 'binary_recall': 0.5458787, 'binary_specificity': 0.7880324, 'binary_f1_score': 0.14501137}
confusion matrix:
       0     1
0  14302  3847
1    292   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8200703, 'precision': 0.5575559, 'recall': 0.72105396, 'specificity': 0.72105396, 'f1': 0.55979186, 'auroc': 0.79908085, 'binary_precision': 0.13502109, 'binary_recall': 0.6130268, 'binary_specificity': 0.8290812, 'binary_f1_score': 0.22130013}
confusion matrix:
      0     1
0  4972  1025
1   101   160
early stop counter: 4
val acc:0.7797467112541199, best validation acc: 0.8278522491455078, corresponding to test acc:                         0.8772770762443542 / 0.8772770762443542
after epoch: 11,now: 2024-08-04 20:37:55.410413,epoch time: 0:16:38.599153,used: 3:07:34.875682,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91148883, 'precision': 0.91252935, 'recall': 0.9114679, 'specificity': 0.9114679, 'f1': 0.91142994, 'auroc': 0.97335136, 'binary_precision': 0.8920193, 'binary_recall': 0.9364897, 'binary_specificity': 0.8864461, 'binary_f1_score': 0.9137137}
confusion matrix:
       0      1
0  25402   3254
1   1823  26881
---- Validation: 
scalar performance:
{'acc': 0.79592377, 'precision': 0.5345806, 'recall': 0.6715804, 'specificity': 0.6715804, 'f1': 0.5184244, 'auroc': 0.7269069, 'binary_precision': 0.08908342, 'binary_recall': 0.5381026, 'binary_specificity': 0.8050581, 'binary_f1_score': 0.15286061}
confusion matrix:
       0     1
0  14611  3538
1    297   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8435602, 'precision': 0.56992704, 'recall': 0.7443041, 'specificity': 0.7443041, 'f1': 0.58293504, 'auroc': 0.8296211, 'binary_precision': 0.15809524, 'binary_recall': 0.6360153, 'binary_specificity': 0.85259295, 'binary_f1_score': 0.2532418}
confusion matrix:
      0    1
0  5113  884
1    95  166
early stop counter: 5
val acc:0.7959237694740295, best validation acc: 0.8278522491455078, corresponding to test acc:                         0.8772770762443542 / 0.8772770762443542
after epoch: 12,now: 2024-08-04 20:54:38.747338,epoch time: 0:16:43.336925,used: 3:24:18.212607,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9153417, 'precision': 0.91603065, 'recall': 0.9153254, 'specificity': 0.9153254, 'f1': 0.9153044, 'auroc': 0.97518325, 'binary_precision': 0.8993001, 'binary_recall': 0.9355816, 'binary_specificity': 0.89506924, 'binary_f1_score': 0.9170822}
confusion matrix:
       0      1
0  25650   3007
1   1849  26854
---- Validation: 
scalar performance:
{'acc': 0.7903363, 'precision': 0.53428733, 'recall': 0.67393804, 'specificity': 0.67393804, 'f1': 0.51617, 'auroc': 0.7146976, 'binary_precision': 0.088183865, 'binary_recall': 0.5489891, 'binary_specificity': 0.798887, 'binary_f1_score': 0.15195867}
confusion matrix:
       0     1
0  14499  3650
1    290   353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8279003, 'precision': 0.5665983, 'recall': 0.7526244, 'specificity': 0.7526244, 'f1': 0.57407326, 'auroc': 0.83523756, 'binary_precision': 0.15008576, 'binary_recall': 0.6704981, 'binary_specificity': 0.8347507, 'binary_f1_score': 0.24526979}
confusion matrix:
      0    1
0  5006  991
1    86  175
early stop counter: 6
val acc:0.7903363108634949, best validation acc: 0.8278522491455078, corresponding to test acc:                         0.8772770762443542 / 0.8772770762443542
after epoch: 13,now: 2024-08-04 21:11:22.372580,epoch time: 0:16:43.625242,used: 3:41:01.837849,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9091876, 'precision': 0.9093212, 'recall': 0.90918005, 'specificity': 0.90918005, 'f1': 0.90917903, 'auroc': 0.97142434, 'binary_precision': 0.90213263, 'binary_recall': 0.91812986, 'binary_specificity': 0.9002303, 'binary_f1_score': 0.910061}
confusion matrix:
       0      1
0  25797   2859
1   2350  26354
---- Validation: 
scalar performance:
{'acc': 0.8246594, 'precision': 0.53555715, 'recall': 0.65420485, 'specificity': 0.65420485, 'f1': 0.5287605, 'auroc': 0.72314405, 'binary_precision': 0.09300184, 'binary_recall': 0.47122863, 'binary_specificity': 0.8371811, 'binary_f1_score': 0.1553448}
confusion matrix:
       0     1
0  15194  2955
1    340   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8598594, 'precision': 0.5714884, 'recall': 0.7234911, 'specificity': 0.7234911, 'f1': 0.5887708, 'auroc': 0.7998929, 'binary_precision': 0.16375546, 'binary_recall': 0.57471263, 'binary_specificity': 0.87226945, 'binary_f1_score': 0.2548853}
confusion matrix:
      0    1
0  5231  766
1   111  150
early stop counter: 7
val acc:0.8246594071388245, best validation acc: 0.8278522491455078, corresponding to test acc:                         0.8772770762443542 / 0.8772770762443542
after epoch: 14,now: 2024-08-04 21:28:10.141366,epoch time: 0:16:47.768786,used: 3:57:49.606635,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92566246, 'precision': 0.9260899, 'recall': 0.9256753, 'specificity': 0.9256753, 'f1': 0.92564535, 'auroc': 0.97776234, 'binary_precision': 0.9397876, 'binary_recall': 0.9097307, 'binary_specificity': 0.9416199, 'binary_f1_score': 0.92451495}
confusion matrix:
       0      1
0  26984   1673
1   2591  26112
---- Validation: 
scalar performance:
{'acc': 0.85339504, 'precision': 0.5416675, 'recall': 0.6540806, 'specificity': 0.6540806, 'f1': 0.5450116, 'auroc': 0.7187115, 'binary_precision': 0.105675876, 'binary_recall': 0.44012442, 'binary_specificity': 0.8680368, 'binary_f1_score': 0.17043057}
confusion matrix:
       0     1
0  15754  2395
1    360   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8737616, 'precision': 0.5788198, 'recall': 0.7252477, 'specificity': 0.7252477, 'f1': 0.60105675, 'auroc': 0.8050481, 'binary_precision': 0.17861483, 'binary_recall': 0.5632184, 'binary_specificity': 0.88727695, 'binary_f1_score': 0.27121773}
confusion matrix:
      0    1
0  5321  676
1   114  147
better model found
persisted
after epoch: 15,now: 2024-08-04 21:45:17.636930,epoch time: 0:17:07.495564,used: 4:14:57.102199,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:14:57.102199 at 2024-08-04 21:45:17.636930
persisted model performance metric: 

scalar performance:
{'acc': 0.8737616, 'precision': 0.5788198, 'recall': 0.7252477, 'specificity': 0.7252477, 'f1': 0.60105675, 'auroc': 0.8050481, 'binary_precision': 0.17861483, 'binary_recall': 0.5632184, 'binary_specificity': 0.88727695, 'binary_f1_score': 0.27121773}
confusion matrix:
      0    1
0  5321  676
1   114  147
oracle model performance metric: 

scalar performance:
{'acc': 0.8772771, 'precision': 0.57229847, 'recall': 0.6940999, 'specificity': 0.6940999, 'f1': 0.5923106, 'auroc': 0.77220285, 'binary_precision': 0.16862746, 'binary_recall': 0.49425286, 'binary_specificity': 0.89394695, 'binary_f1_score': 0.25146198}
confusion matrix:
      0    1
0  5361  636
1   132  129
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 563304 KiB | 200520 GiB | 200520 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 200245 GiB | 200245 GiB |
|       from small pool |  35968 KiB |  74337 KiB |    275 GiB |    275 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 737280 KiB | 737280 KiB | 737280 KiB |      0 B   |
|       from large pool | 661504 KiB | 661504 KiB | 661504 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  51020 KiB | 149589 KiB | 137458 GiB | 137458 GiB |
|       from large pool |  36864 KiB | 148352 KiB | 137144 GiB | 137144 GiB |
|       from small pool |  14156 KiB |  14156 KiB |    313 GiB |    313 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7939    |   44492 K  |   44488 K  |
|       from large pool |      36    |      76    |   13725 K  |   13725 K  |
|       from small pool |    3216    |    7901    |   30766 K  |   30763 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7939    |   44492 K  |   44488 K  |
|       from large pool |      36    |      76    |   13725 K  |   13725 K  |
|       from small pool |    3216    |    7901    |   30766 K  |   30763 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      54    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |    3599    |   23252 K  |   23252 K  |
|       from large pool |       7    |      11    |    8595 K  |    8595 K  |
|       from small pool |      49    |    3593    |   14657 K  |   14657 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |      0 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |      0 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 200520 GiB | 200520 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 200245 GiB | 200245 GiB |
|       from small pool |      0 KiB |  74337 KiB |    275 GiB |    275 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB | 737280 KiB | 737280 KiB | 481280 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149589 KiB | 137458 GiB | 137458 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 137145 GiB | 137145 GiB |
|       from small pool |      0 KiB |  21751 KiB |    313 GiB |    313 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   44492 K  |   44492 K  |
|       from large pool |       2    |      76    |   13725 K  |   13725 K  |
|       from small pool |       0    |    7901    |   30766 K  |   30766 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   44492 K  |   44492 K  |
|       from large pool |       2    |      76    |   13725 K  |   13725 K  |
|       from small pool |       0    |    7901    |   30766 K  |   30766 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      54    |      54    |      19    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3599    |   23253 K  |   23253 K  |
|       from large pool |       3    |      13    |    8595 K  |    8595 K  |
|       from small pool |       0    |    3593    |   14658 K  |   14658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |      0 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |      0 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 200520 GiB | 200520 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 200245 GiB | 200245 GiB |
|       from small pool |      0 KiB |  74337 KiB |    275 GiB |    275 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB | 737280 KiB | 737280 KiB | 481280 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149589 KiB | 137458 GiB | 137458 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 137145 GiB | 137145 GiB |
|       from small pool |      0 KiB |  21751 KiB |    313 GiB |    313 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   44492 K  |   44492 K  |
|       from large pool |       2    |      76    |   13725 K  |   13725 K  |
|       from small pool |       0    |    7901    |   30766 K  |   30766 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   44492 K  |   44492 K  |
|       from large pool |       2    |      76    |   13725 K  |   13725 K  |
|       from small pool |       0    |    7901    |   30766 K  |   30766 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      54    |      54    |      19    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3599    |   23253 K  |   23253 K  |
|       from large pool |       3    |      13    |    8595 K  |    8595 K  |
|       from small pool |       0    |    3593    |   14658 K  |   14658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111

 Experiment start at: 2024-08-04 21:55:38.846849
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6555471, 'precision': 0.70194936, 'recall': 0.65537214, 'specificity': 0.65537214, 'f1': 0.6344028, 'auroc': 0.7910389, 'binary_precision': 0.60532796, 'binary_recall': 0.8953831, 'binary_specificity': 0.4153611, 'binary_f1_score': 0.7223248}
confusion matrix:
       0      1
0  11957  16830
1   3016  25813
---- Validation: 
scalar performance:
{'acc': 0.36504802, 'precision': 0.49629998, 'recall': 0.47542998, 'specificity': 0.47542998, 'f1': 0.29141545, 'auroc': 0.46801388, 'binary_precision': 0.033261266, 'binary_recall': 0.5943536, 'binary_specificity': 0.35650635, 'binary_f1_score': 0.06299709}
confusion matrix:
      0      1
0  6441  11626
1   273    400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4985498, 'precision': 0.49190462, 'recall': 0.44959056, 'specificity': 0.44959056, 'f1': 0.35994098, 'auroc': 0.4272161, 'binary_precision': 0.033682145, 'binary_recall': 0.39615384, 'binary_specificity': 0.50302726, 'binary_f1_score': 0.062085595}
confusion matrix:
      0     1
0  2991  2955
1   157   103
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 22:13:24.665744,epoch time: 0:17:45.818895,used: 0:17:45.818895,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7716433, 'precision': 0.80281234, 'recall': 0.7715318, 'specificity': 0.7715318, 'f1': 0.7655628, 'auroc': 0.9025352, 'binary_precision': 0.70583445, 'binary_recall': 0.9320452, 'binary_specificity': 0.6110185, 'binary_f1_score': 0.8033187}
confusion matrix:
       0      1
0  17590  11198
1   1959  26869
---- Validation: 
scalar performance:
{'acc': 0.5370331, 'precision': 0.5078916, 'recall': 0.5567578, 'specificity': 0.5567578, 'f1': 0.38636178, 'auroc': 0.562233, 'binary_precision': 0.044300195, 'binary_recall': 0.5780089, 'binary_specificity': 0.5355067, 'binary_f1_score': 0.082293205}
confusion matrix:
      0     1
0  9675  8392
1   284   389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65726715, 'precision': 0.52539057, 'recall': 0.64459753, 'specificity': 0.64459753, 'f1': 0.45999315, 'auroc': 0.696162, 'binary_precision': 0.074715264, 'binary_recall': 0.63076925, 'binary_specificity': 0.6584258, 'binary_f1_score': 0.1336049}
confusion matrix:
      0     1
0  3915  2031
1    96   164
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 22:30:36.666951,epoch time: 0:17:12.001207,used: 0:34:57.820102,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.83245975, 'precision': 0.8389504, 'recall': 0.83240926, 'specificity': 0.83240926, 'f1': 0.83163893, 'auroc': 0.9262781, 'binary_precision': 0.792228, 'binary_recall': 0.9016268, 'binary_specificity': 0.7631917, 'binary_f1_score': 0.84339464}
confusion matrix:
       0      1
0  21970   6817
1   2836  25993
---- Validation: 
scalar performance:
{'acc': 0.6717716, 'precision': 0.51106125, 'recall': 0.57013047, 'specificity': 0.57013047, 'f1': 0.4456337, 'auroc': 0.582115, 'binary_precision': 0.05083634, 'binary_recall': 0.46062407, 'binary_specificity': 0.6796369, 'binary_f1_score': 0.09156697}
confusion matrix:
       0     1
0  12279  5788
1    363   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79761523, 'precision': 0.54309046, 'recall': 0.6755433, 'specificity': 0.6755433, 'f1': 0.53392506, 'auroc': 0.72980607, 'binary_precision': 0.11032864, 'binary_recall': 0.5423077, 'binary_specificity': 0.808779, 'binary_f1_score': 0.183355}
confusion matrix:
      0     1
0  4809  1137
1   119   141
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 22:47:52.198222,epoch time: 0:17:15.531271,used: 0:52:13.351373,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85130864, 'precision': 0.85575104, 'recall': 0.85126793, 'specificity': 0.85126793, 'f1': 0.8508326, 'auroc': 0.93977785, 'binary_precision': 0.81617874, 'binary_recall': 0.9071421, 'binary_specificity': 0.79539376, 'binary_f1_score': 0.8592598}
confusion matrix:
       0      1
0  22897   5890
1   2677  26152
---- Validation: 
scalar performance:
{'acc': 0.73431164, 'precision': 0.5208967, 'recall': 0.61758596, 'specificity': 0.61758596, 'f1': 0.4804873, 'auroc': 0.6459973, 'binary_precision': 0.06662641, 'binary_recall': 0.49182764, 'binary_specificity': 0.74334425, 'binary_f1_score': 0.11735508}
confusion matrix:
       0     1
0  13430  4637
1    342   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8258137, 'precision': 0.55482125, 'recall': 0.70129305, 'specificity': 0.70129305, 'f1': 0.55793744, 'auroc': 0.7629526, 'binary_precision': 0.13183856, 'binary_recall': 0.5653846, 'binary_specificity': 0.8372015, 'binary_f1_score': 0.21381818}
confusion matrix:
      0    1
0  4978  968
1   113  147
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 23:05:15.101583,epoch time: 0:17:22.903361,used: 1:09:36.254734,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8585115, 'precision': 0.8603952, 'recall': 0.8584839, 'specificity': 0.8584839, 'f1': 0.8583197, 'auroc': 0.94112, 'binary_precision': 0.83453053, 'binary_recall': 0.89462364, 'binary_specificity': 0.8223442, 'binary_f1_score': 0.8635329}
confusion matrix:
       0      1
0  23672   5114
1   3038  25792
---- Validation: 
scalar performance:
{'acc': 0.7776414, 'precision': 0.5196241, 'recall': 0.5957113, 'specificity': 0.5957113, 'f1': 0.49360344, 'auroc': 0.6523351, 'binary_precision': 0.06671627, 'binary_recall': 0.39970282, 'binary_specificity': 0.79171973, 'binary_f1_score': 0.11434644}
confusion matrix:
       0     1
0  14304  3763
1    404   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85417336, 'precision': 0.5638461, 'recall': 0.701381, 'specificity': 0.701381, 'f1': 0.5772004, 'auroc': 0.75813997, 'binary_precision': 0.15059589, 'binary_recall': 0.5346154, 'binary_specificity': 0.86814666, 'binary_f1_score': 0.23499577}
confusion matrix:
      0    1
0  5162  784
1   121  139
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 23:22:28.200176,epoch time: 0:17:13.098593,used: 1:26:49.353327,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8617745, 'precision': 0.8712591, 'recall': 0.861719, 'specificity': 0.861719, 'f1': 0.860873, 'auroc': 0.9544592, 'binary_precision': 0.81209236, 'binary_recall': 0.9416193, 'binary_specificity': 0.7818188, 'binary_f1_score': 0.87207246}
confusion matrix:
       0      1
0  22507   6281
1   1683  27145
---- Validation: 
scalar performance:
{'acc': 0.7225187, 'precision': 0.5234111, 'recall': 0.6365042, 'specificity': 0.6365042, 'f1': 0.47928518, 'auroc': 0.66719997, 'binary_precision': 0.06959498, 'binary_recall': 0.54383355, 'binary_specificity': 0.72917473, 'binary_f1_score': 0.12339851}
confusion matrix:
       0     1
0  13174  4893
1    307   366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8187238, 'precision': 0.5563372, 'recall': 0.7159829, 'specificity': 0.7159829, 'f1': 0.55784136, 'auroc': 0.7848114, 'binary_precision': 0.1331637, 'binary_recall': 0.60384613, 'binary_specificity': 0.82811975, 'binary_f1_score': 0.2182071}
confusion matrix:
      0     1
0  4924  1022
1   103   157
early stop counter: 1
val acc:0.7225186824798584, best validation acc: 0.7776414155960083, corresponding to test acc:                         0.8541733622550964 / 0.8541733622550964
after epoch: 6,now: 2024-08-04 23:39:45.157480,epoch time: 0:17:16.957304,used: 1:44:06.310631,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8790961, 'precision': 0.8792228, 'recall': 0.8790898, 'specificity': 0.8790898, 'f1': 0.87908465, 'auroc': 0.952066, 'binary_precision': 0.8724615, 'binary_recall': 0.888199, 'binary_specificity': 0.8699806, 'binary_f1_score': 0.88025993}
confusion matrix:
       0      1
0  25045   3743
1   3223  25605
---- Validation: 
scalar performance:
{'acc': 0.80442905, 'precision': 0.51725507, 'recall': 0.5745559, 'specificity': 0.5745559, 'f1': 0.4986868, 'auroc': 0.63078606, 'binary_precision': 0.06410257, 'binary_recall': 0.3268945, 'binary_specificity': 0.8222173, 'binary_f1_score': 0.10718637}
confusion matrix:
       0     1
0  14855  3212
1    453   220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85497904, 'precision': 0.5589992, 'recall': 0.6815726, 'specificity': 0.6815726, 'f1': 0.570748, 'auroc': 0.7255485, 'binary_precision': 0.14285715, 'binary_recall': 0.4923077, 'binary_specificity': 0.8708375, 'binary_f1_score': 0.2214533}
confusion matrix:
      0    1
0  5178  768
1   132  128
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-04 23:57:20.084911,epoch time: 0:17:34.927431,used: 2:01:41.238062,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8786795, 'precision': 0.8854489, 'recall': 0.87862897, 'specificity': 0.87862897, 'f1': 0.87813425, 'auroc': 0.9621419, 'binary_precision': 0.83455884, 'binary_recall': 0.94484913, 'binary_specificity': 0.8124088, 'binary_f1_score': 0.886286}
confusion matrix:
       0      1
0  23386   5400
1   1590  27240
---- Validation: 
scalar performance:
{'acc': 0.72422624, 'precision': 0.5271553, 'recall': 0.65884775, 'specificity': 0.65884775, 'f1': 0.48446327, 'auroc': 0.68736595, 'binary_precision': 0.0749007, 'binary_recall': 0.5884101, 'binary_specificity': 0.7292854, 'binary_f1_score': 0.1328859}
confusion matrix:
       0     1
0  13176  4891
1    277   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79342574, 'precision': 0.55199057, 'recall': 0.72117066, 'specificity': 0.72117066, 'f1': 0.5439677, 'auroc': 0.78839946, 'binary_precision': 0.12315634, 'binary_recall': 0.6423077, 'binary_specificity': 0.8000336, 'binary_f1_score': 0.20668316}
confusion matrix:
      0     1
0  4757  1189
1    93   167
early stop counter: 1
val acc:0.7242262363433838, best validation acc: 0.8044290542602539, corresponding to test acc:                         0.8549790382385254 / 0.8549790382385254
after epoch: 8,now: 2024-08-05 00:14:50.711748,epoch time: 0:17:30.626837,used: 2:19:11.864899,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89407456, 'precision': 0.8969152, 'recall': 0.89404225, 'specificity': 0.89404225, 'f1': 0.89387906, 'auroc': 0.9659467, 'binary_precision': 0.8635273, 'binary_recall': 0.9362816, 'binary_specificity': 0.85180295, 'binary_f1_score': 0.898434}
confusion matrix:
       0      1
0  24520   4266
1   1837  26993
---- Validation: 
scalar performance:
{'acc': 0.7657951, 'precision': 0.5324306, 'recall': 0.67039263, 'specificity': 0.67039263, 'f1': 0.50624716, 'auroc': 0.71548605, 'binary_precision': 0.08526786, 'binary_recall': 0.5676077, 'binary_specificity': 0.7731776, 'binary_f1_score': 0.14826316}
confusion matrix:
       0     1
0  13969  4098
1    291   382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83870447, 'precision': 0.56985044, 'recall': 0.750317, 'specificity': 0.750317, 'f1': 0.5815629, 'auroc': 0.8146527, 'binary_precision': 0.15726179, 'binary_recall': 0.65384614, 'binary_specificity': 0.84678775, 'binary_f1_score': 0.25354213}
confusion matrix:
      0    1
0  5035  911
1    90  170
early stop counter: 2
val acc:0.765795111656189, best validation acc: 0.8044290542602539, corresponding to test acc:                         0.8549790382385254 / 0.8549790382385254
after epoch: 9,now: 2024-08-05 00:32:19.256388,epoch time: 0:17:28.544640,used: 2:36:40.409539,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8991426, 'precision': 0.90098524, 'recall': 0.89911795, 'specificity': 0.89911795, 'f1': 0.89902246, 'auroc': 0.9685757, 'binary_precision': 0.8739845, 'binary_recall': 0.9329495, 'binary_specificity': 0.8652864, 'binary_f1_score': 0.90250486}
confusion matrix:
       0      1
0  24909   3878
1   1933  26896
---- Validation: 
scalar performance:
{'acc': 0.7744397, 'precision': 0.53259605, 'recall': 0.6662928, 'specificity': 0.6662928, 'f1': 0.5094869, 'auroc': 0.7221401, 'binary_precision': 0.08616675, 'binary_recall': 0.5497771, 'binary_specificity': 0.7828084, 'binary_f1_score': 0.1489833}
confusion matrix:
       0     1
0  14143  3924
1    303   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8308089, 'precision': 0.56473035, 'recall': 0.7388406, 'specificity': 0.7388406, 'f1': 0.57251835, 'auroc': 0.81170475, 'binary_precision': 0.14795008, 'binary_recall': 0.63846153, 'binary_specificity': 0.8392196, 'binary_f1_score': 0.24023153}
confusion matrix:
      0    1
0  4990  956
1    94  166
early stop counter: 3
val acc:0.7744396924972534, best validation acc: 0.8044290542602539, corresponding to test acc:                         0.8549790382385254 / 0.8549790382385254
after epoch: 10,now: 2024-08-05 00:49:43.539301,epoch time: 0:17:24.282913,used: 2:54:04.692452,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90353376, 'precision': 0.90417105, 'recall': 0.90351933, 'specificity': 0.90351933, 'f1': 0.9034934, 'auroc': 0.968513, 'binary_precision': 0.88830304, 'binary_recall': 0.9233064, 'binary_specificity': 0.88373226, 'binary_f1_score': 0.90546656}
confusion matrix:
       0      1
0  25440   3347
1   2211  26618
---- Validation: 
scalar performance:
{'acc': 0.80202776, 'precision': 0.53634554, 'recall': 0.6677258, 'specificity': 0.6677258, 'f1': 0.52364635, 'auroc': 0.721491, 'binary_precision': 0.09409249, 'binary_recall': 0.5230312, 'binary_specificity': 0.8124204, 'binary_f1_score': 0.15949252}
confusion matrix:
       0     1
0  14678  3389
1    321   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85465676, 'precision': 0.57052124, 'recall': 0.7273791, 'specificity': 0.7273791, 'f1': 0.5864021, 'auroc': 0.7964954, 'binary_precision': 0.1613924, 'binary_recall': 0.5884615, 'binary_specificity': 0.86629665, 'binary_f1_score': 0.25331128}
confusion matrix:
      0    1
0  5151  795
1   107  153
early stop counter: 4
val acc:0.8020277619361877, best validation acc: 0.8044290542602539, corresponding to test acc:                         0.8549790382385254 / 0.8549790382385254
after epoch: 11,now: 2024-08-05 01:06:59.238622,epoch time: 0:17:15.699321,used: 3:11:20.391773,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91155237, 'precision': 0.9117379, 'recall': 0.9115602, 'specificity': 0.9115602, 'f1': 0.9115435, 'auroc': 0.9714792, 'binary_precision': 0.9206636, 'binary_recall': 0.9008637, 'binary_specificity': 0.9222566, 'binary_f1_score': 0.9106561}
confusion matrix:
       0      1
0  26549   2238
1   2858  25971
---- Validation: 
scalar performance:
{'acc': 0.85944504, 'precision': 0.53837204, 'recall': 0.6266924, 'specificity': 0.6266924, 'f1': 0.5422215, 'auroc': 0.7040484, 'binary_precision': 0.10255371, 'binary_recall': 0.37592867, 'binary_specificity': 0.8774561, 'binary_f1_score': 0.1611465}
confusion matrix:
       0     1
0  15853  2214
1    420   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8970351, 'precision': 0.59540486, 'recall': 0.72558796, 'specificity': 0.72558796, 'f1': 0.62454, 'auroc': 0.7943368, 'binary_precision': 0.2124431, 'binary_recall': 0.53846157, 'binary_specificity': 0.9127144, 'binary_f1_score': 0.304679}
confusion matrix:
      0    1
0  5427  519
1   120  140
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-05 01:24:23.232766,epoch time: 0:17:23.994144,used: 3:28:44.385917,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9148327, 'precision': 0.91605794, 'recall': 0.9148129, 'specificity': 0.9148129, 'f1': 0.91476715, 'auroc': 0.9755866, 'binary_precision': 0.89366114, 'binary_recall': 0.9418641, 'binary_specificity': 0.88776183, 'binary_f1_score': 0.9171297}
confusion matrix:
       0      1
0  25556   3231
1   1676  27153
---- Validation: 
scalar performance:
{'acc': 0.8059765, 'precision': 0.5323099, 'recall': 0.6447394, 'specificity': 0.6447394, 'f1': 0.5194963, 'auroc': 0.70813763, 'binary_precision': 0.088129, 'binary_recall': 0.47102526, 'binary_specificity': 0.81845355, 'binary_f1_score': 0.14847775}
confusion matrix:
       0     1
0  14787  3280
1    356   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86803097, 'precision': 0.5838673, 'recall': 0.75642645, 'specificity': 0.75642645, 'f1': 0.60724515, 'auroc': 0.8319303, 'binary_precision': 0.1856018, 'binary_recall': 0.63461536, 'binary_specificity': 0.8782375, 'binary_f1_score': 0.28720626}
confusion matrix:
      0    1
0  5222  724
1    95  165
early stop counter: 1
val acc:0.8059765100479126, best validation acc: 0.8594450354576111, corresponding to test acc:                         0.8970351219177246 / 0.8970351219177246
after epoch: 13,now: 2024-08-05 01:41:49.154496,epoch time: 0:17:25.921730,used: 3:46:10.307647,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9054603, 'precision': 0.9063074, 'recall': 0.9054429, 'specificity': 0.9054429, 'f1': 0.90540826, 'auroc': 0.9700134, 'binary_precision': 0.88794506, 'binary_recall': 0.92819977, 'binary_specificity': 0.882686, 'binary_f1_score': 0.9076263}
confusion matrix:
       0      1
0  25409   3377
1   2070  26760
---- Validation: 
scalar performance:
{'acc': 0.8074173, 'precision': 0.5316349, 'recall': 0.64047974, 'specificity': 0.64047974, 'f1': 0.5190343, 'auroc': 0.6956415, 'binary_precision': 0.087176606, 'binary_recall': 0.46062407, 'binary_specificity': 0.82033545, 'binary_f1_score': 0.14660677}
confusion matrix:
       0     1
0  14821  3246
1    363   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83999354, 'precision': 0.56711555, 'recall': 0.7362778, 'specificity': 0.7362778, 'f1': 0.57825696, 'auroc': 0.79567456, 'binary_precision': 0.15326396, 'binary_recall': 0.6230769, 'binary_specificity': 0.84947866, 'binary_f1_score': 0.24601367}
confusion matrix:
      0    1
0  5051  895
1    98  162
early stop counter: 2
val acc:0.8074172735214233, best validation acc: 0.8594450354576111, corresponding to test acc:                         0.8970351219177246 / 0.8970351219177246
after epoch: 14,now: 2024-08-05 01:59:07.307404,epoch time: 0:17:18.152908,used: 4:03:28.460555,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9046619, 'precision': 0.9070773, 'recall': 0.9046339, 'specificity': 0.9046339, 'f1': 0.90451586, 'auroc': 0.97214735, 'binary_precision': 0.87590206, 'binary_recall': 0.94307816, 'binary_specificity': 0.8661896, 'binary_f1_score': 0.9082497}
confusion matrix:
       0      1
0  24935   3852
1   1641  27188
---- Validation: 
scalar performance:
{'acc': 0.7872999, 'precision': 0.53652763, 'recall': 0.6793998, 'specificity': 0.6793998, 'f1': 0.51900935, 'auroc': 0.72789735, 'binary_precision': 0.093097515, 'binary_recall': 0.56315005, 'binary_specificity': 0.7956495, 'binary_f1_score': 0.15978077}
confusion matrix:
       0     1
0  14375  3692
1    294   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84660006, 'precision': 0.5694249, 'recall': 0.7360475, 'specificity': 0.7360475, 'f1': 0.5830573, 'auroc': 0.8104272, 'binary_precision': 0.15810277, 'binary_recall': 0.61538464, 'binary_specificity': 0.8567104, 'binary_f1_score': 0.2515723}
confusion matrix:
      0    1
0  5094  852
1   100  160
early stop counter: 3
val acc:0.7872998714447021, best validation acc: 0.8594450354576111, corresponding to test acc:                         0.8970351219177246 / 0.8970351219177246
after epoch: 15,now: 2024-08-05 02:16:22.189649,epoch time: 0:17:14.882245,used: 4:20:43.342800,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_55_38_seed_1_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:20:43.342800 at 2024-08-05 02:16:22.189649
persisted model performance metric: 

scalar performance:
{'acc': 0.8970351, 'precision': 0.59540486, 'recall': 0.72558796, 'specificity': 0.72558796, 'f1': 0.62454, 'auroc': 0.7943368, 'binary_precision': 0.2124431, 'binary_recall': 0.53846157, 'binary_specificity': 0.9127144, 'binary_f1_score': 0.304679}
confusion matrix:
      0    1
0  5427  519
1   120  140
oracle model performance metric: 

scalar performance:
{'acc': 0.8970351, 'precision': 0.59540486, 'recall': 0.72558796, 'specificity': 0.72558796, 'f1': 0.62454, 'auroc': 0.7943368, 'binary_precision': 0.2124431, 'binary_recall': 0.53846157, 'binary_specificity': 0.9127144, 'binary_f1_score': 0.304679}
confusion matrix:
      0    1
0  5427  519
1   120  140
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205607 KiB | 574425 KiB | 407096 GiB | 407095 GiB |
|       from large pool | 168576 KiB | 501696 KiB | 406522 GiB | 406521 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205607 KiB | 574425 KiB | 407096 GiB | 407095 GiB |
|       from large pool | 168576 KiB | 501696 KiB | 406522 GiB | 406521 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 563304 KiB | 402812 GiB | 402812 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 402260 GiB | 402260 GiB |
|       from small pool |  35966 KiB |  74337 KiB |    552 GiB |    552 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 757760 KiB | 757760 KiB |   1210 MiB | 481280 KiB |
|       from large pool | 681984 KiB | 681984 KiB |   1112 MiB | 456704 KiB |
|       from small pool |  75776 KiB |  75776 KiB |     98 MiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  27864 KiB | 168117 KiB | 253506 GiB | 253506 GiB |
|       from large pool |  15744 KiB | 166720 KiB | 252881 GiB | 252881 GiB |
|       from small pool |  12120 KiB |  21751 KiB |    624 GiB |    624 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7971    |   89294 K  |   89290 K  |
|       from large pool |      36    |      76    |   27572 K  |   27572 K  |
|       from small pool |    3192    |    7933    |   61721 K  |   61718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7971    |   89294 K  |   89290 K  |
|       from large pool |      36    |      76    |   27572 K  |   27572 K  |
|       from small pool |    3192    |    7933    |   61721 K  |   61718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      74    |      19    |
|       from large pool |      18    |      18    |      25    |       7    |
|       from small pool |      37    |      37    |      49    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      48    |    3615    |   47271 K  |   47271 K  |
|       from large pool |       3    |      13    |   17871 K  |   17871 K  |
|       from small pool |      45    |    3612    |   29399 K  |   29399 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |      0 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |      0 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 402812 GiB | 402812 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 402260 GiB | 402260 GiB |
|       from small pool |      0 KiB |  74337 KiB |    552 GiB |    552 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 757760 KiB |   1210 MiB |    982 MiB |
|       from large pool | 184320 KiB | 681984 KiB |   1112 MiB |    932 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 168117 KiB | 253507 GiB | 253506 GiB |
|       from large pool |  24320 KiB | 166720 KiB | 252882 GiB | 252882 GiB |
|       from small pool |      0 KiB |  21751 KiB |    624 GiB |    624 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   89294 K  |   89294 K  |
|       from large pool |       2    |      76    |   27572 K  |   27572 K  |
|       from small pool |       0    |    7933    |   61721 K  |   61721 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   89294 K  |   89294 K  |
|       from large pool |       2    |      76    |   27572 K  |   27572 K  |
|       from small pool |       0    |    7933    |   61721 K  |   61721 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      55    |      74    |      41    |
|       from large pool |       9    |      18    |      25    |      16    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3615    |   47273 K  |   47273 K  |
|       from large pool |       3    |      13    |   17871 K  |   17871 K  |
|       from small pool |       0    |    3612    |   29401 K  |   29401 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |      0 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |      0 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 402812 GiB | 402812 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 402260 GiB | 402260 GiB |
|       from small pool |      0 KiB |  74337 KiB |    552 GiB |    552 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 757760 KiB |   1210 MiB |    982 MiB |
|       from large pool | 184320 KiB | 681984 KiB |   1112 MiB |    932 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 168117 KiB | 253507 GiB | 253506 GiB |
|       from large pool |  24320 KiB | 166720 KiB | 252882 GiB | 252882 GiB |
|       from small pool |      0 KiB |  21751 KiB |    624 GiB |    624 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   89294 K  |   89294 K  |
|       from large pool |       2    |      76    |   27572 K  |   27572 K  |
|       from small pool |       0    |    7933    |   61721 K  |   61721 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   89294 K  |   89294 K  |
|       from large pool |       2    |      76    |   27572 K  |   27572 K  |
|       from small pool |       0    |    7933    |   61721 K  |   61721 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      55    |      74    |      41    |
|       from large pool |       9    |      18    |      25    |      16    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3615    |   47273 K  |   47273 K  |
|       from large pool |       3    |      13    |   17871 K  |   17871 K  |
|       from small pool |       0    |    3612    |   29401 K  |   29401 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111

 Experiment start at: 2024-08-05 02:27:09.775599
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7301729, 'precision': 0.75746995, 'recall': 0.7301506, 'specificity': 0.7301506, 'f1': 0.72281384, 'auroc': 0.84763294, 'binary_precision': 0.67367005, 'binary_recall': 0.89298946, 'binary_specificity': 0.56731164, 'binary_f1_score': 0.7679783}
confusion matrix:
       0      1
0  16536  12612
1   3120  26036
---- Validation: 
scalar performance:
{'acc': 0.51680607, 'precision': 0.50975424, 'recall': 0.57854664, 'specificity': 0.57854664, 'f1': 0.3756605, 'auroc': 0.6148337, 'binary_precision': 0.041968632, 'binary_recall': 0.64451826, 'binary_specificity': 0.512575, 'binary_f1_score': 0.07880572}
confusion matrix:
      0     1
0  9314  8857
1   214   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51787144, 'precision': 0.5247519, 'recall': 0.66593283, 'specificity': 0.66593283, 'f1': 0.39286408, 'auroc': 0.7735705, 'binary_precision': 0.06317119, 'binary_recall': 0.8264463, 'binary_specificity': 0.5054194, 'binary_f1_score': 0.11737088}
confusion matrix:
      0     1
0  3031  2966
1    42   200
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 02:45:38.523448,epoch time: 0:18:28.747849,used: 0:18:28.747849,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.815896, 'precision': 0.8219178, 'recall': 0.81588423, 'specificity': 0.81588423, 'f1': 0.8150271, 'auroc': 0.9111942, 'binary_precision': 0.777932, 'binary_recall': 0.88428164, 'binary_specificity': 0.7474869, 'binary_f1_score': 0.82770467}
confusion matrix:
       0      1
0  21787   7360
1   3374  25783
---- Validation: 
scalar performance:
{'acc': 0.66553026, 'precision': 0.5177115, 'recall': 0.6280687, 'specificity': 0.6280687, 'f1': 0.44792983, 'auroc': 0.67546403, 'binary_precision': 0.055442445, 'binary_recall': 0.5880399, 'binary_specificity': 0.6680975, 'binary_f1_score': 0.10133105}
confusion matrix:
       0     1
0  12140  6031
1    248   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72399426, 'precision': 0.5408772, 'recall': 0.72755, 'specificity': 0.72755, 'f1': 0.50248754, 'auroc': 0.801829, 'binary_precision': 0.09651036, 'binary_recall': 0.73140496, 'binary_specificity': 0.72369516, 'binary_f1_score': 0.17052023}
confusion matrix:
      0     1
0  4340  1657
1    65   177
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-05 03:03:44.628934,epoch time: 0:18:06.105486,used: 0:36:34.853335,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84419596, 'precision': 0.85221136, 'recall': 0.8441804, 'specificity': 0.8441804, 'f1': 0.8433002, 'auroc': 0.9354741, 'binary_precision': 0.7991298, 'binary_recall': 0.9196104, 'binary_specificity': 0.7687504, 'binary_f1_score': 0.8551473}
confusion matrix:
       0      1
0  22406   6740
1   2344  26814
---- Validation: 
scalar performance:
{'acc': 0.7131519, 'precision': 0.5232451, 'recall': 0.65507746, 'specificity': 0.65507746, 'f1': 0.47291392, 'auroc': 0.7176358, 'binary_precision': 0.06494451, 'binary_recall': 0.59302324, 'binary_specificity': 0.7171317, 'binary_f1_score': 0.117068365}
confusion matrix:
       0     1
0  13031  5140
1    245   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79740345, 'precision': 0.54854417, 'recall': 0.71815, 'specificity': 0.71815, 'f1': 0.5395131, 'auroc': 0.7885051, 'binary_precision': 0.115210846, 'binary_recall': 0.6322314, 'binary_specificity': 0.8040687, 'binary_f1_score': 0.19490446}
confusion matrix:
      0     1
0  4822  1175
1    89   153
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-05 03:21:39.681636,epoch time: 0:17:55.052702,used: 0:54:29.906037,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8610901, 'precision': 0.86490905, 'recall': 0.86108315, 'specificity': 0.86108315, 'f1': 0.8607241, 'auroc': 0.94602406, 'binary_precision': 0.82761306, 'binary_recall': 0.91223073, 'binary_specificity': 0.8099355, 'binary_f1_score': 0.8678642}
confusion matrix:
       0      1
0  23608   5540
1   2559  26597
---- Validation: 
scalar performance:
{'acc': 0.7159218, 'precision': 0.52301097, 'recall': 0.6524931, 'specificity': 0.6524931, 'f1': 0.4736805, 'auroc': 0.6967216, 'binary_precision': 0.06476541, 'binary_recall': 0.58471763, 'binary_specificity': 0.72026855, 'binary_f1_score': 0.116614215}
confusion matrix:
       0     1
0  13088  5083
1    250   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80108994, 'precision': 0.54921025, 'recall': 0.71808493, 'specificity': 0.71808493, 'f1': 0.5416271, 'auroc': 0.7954163, 'binary_precision': 0.116653875, 'binary_recall': 0.6280992, 'binary_specificity': 0.8080707, 'binary_f1_score': 0.19676377}
confusion matrix:
      0     1
0  4846  1151
1    90   152
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-05 03:39:09.178952,epoch time: 0:17:29.497316,used: 1:11:59.403353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.85695666, 'precision': 0.8642312, 'recall': 0.85694206, 'specificity': 0.85694206, 'f1': 0.85623527, 'auroc': 0.9439112, 'binary_precision': 0.81280804, 'binary_recall': 0.92760134, 'binary_specificity': 0.78628284, 'binary_f1_score': 0.8664189}
confusion matrix:
       0      1
0  22917   6229
1   2111  27047
---- Validation: 
scalar performance:
{'acc': 0.6911522, 'precision': 0.51888627, 'recall': 0.63086444, 'specificity': 0.63086444, 'f1': 0.459306, 'auroc': 0.6623739, 'binary_precision': 0.05801293, 'binary_recall': 0.5664452, 'binary_specificity': 0.6952837, 'binary_f1_score': 0.10524692}
confusion matrix:
       0     1
0  12634  5537
1    261   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75605065, 'precision': 0.5436267, 'recall': 0.72439766, 'specificity': 0.72439766, 'f1': 0.5183347, 'auroc': 0.7834351, 'binary_precision': 0.10346964, 'binary_recall': 0.69008267, 'binary_specificity': 0.7587127, 'binary_f1_score': 0.1799569}
confusion matrix:
      0     1
0  4550  1447
1    75   167
early stop counter: 1
val acc:0.6911522150039673, best validation acc: 0.7159218192100525, corresponding to test acc:                         0.8010899424552917 / 0.8010899424552917
after epoch: 5,now: 2024-08-05 03:56:26.293179,epoch time: 0:17:17.114227,used: 1:29:16.517580,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8813289, 'precision': 0.8813648, 'recall': 0.88132787, 'specificity': 0.88132787, 'f1': 0.88132584, 'auroc': 0.9543307, 'binary_precision': 0.87771326, 'binary_recall': 0.8861719, 'binary_specificity': 0.8764839, 'binary_f1_score': 0.88192225}
confusion matrix:
       0      1
0  25546   3600
1   3319  25839
---- Validation: 
scalar performance:
{'acc': 0.799446, 'precision': 0.5263219, 'recall': 0.6346071, 'specificity': 0.6346071, 'f1': 0.50728095, 'auroc': 0.6971122, 'binary_precision': 0.074293405, 'binary_recall': 0.45847178, 'binary_specificity': 0.8107424, 'binary_f1_score': 0.12786658}
confusion matrix:
       0     1
0  14732  3439
1    326   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8603943, 'precision': 0.5660194, 'recall': 0.71919256, 'specificity': 0.71919256, 'f1': 0.5812231, 'auroc': 0.80447865, 'binary_precision': 0.1517165, 'binary_recall': 0.5661157, 'binary_specificity': 0.87226945, 'binary_f1_score': 0.2393013}
confusion matrix:
      0    1
0  5231  766
1   105  137
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-05 04:13:35.227630,epoch time: 0:17:08.934451,used: 1:46:25.452031,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8823065, 'precision': 0.8849765, 'recall': 0.8822994, 'specificity': 0.8822994, 'f1': 0.8821007, 'auroc': 0.95847756, 'binary_precision': 0.85295886, 'binary_recall': 0.9239291, 'binary_specificity': 0.8406697, 'binary_f1_score': 0.88702667}
confusion matrix:
       0      1
0  24503   4644
1   2218  26939
---- Validation: 
scalar performance:
{'acc': 0.7490545, 'precision': 0.5243878, 'recall': 0.64872897, 'specificity': 0.64872897, 'f1': 0.48759606, 'auroc': 0.7029612, 'binary_precision': 0.06847301, 'binary_recall': 0.5415282, 'binary_specificity': 0.75592977, 'binary_f1_score': 0.12157375}
confusion matrix:
       0     1
0  13736  4435
1    276   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8184004, 'precision': 0.55589515, 'recall': 0.7330377, 'specificity': 0.7330377, 'f1': 0.55607843, 'auroc': 0.8122629, 'binary_precision': 0.12905912, 'binary_recall': 0.6404959, 'binary_specificity': 0.82557946, 'binary_f1_score': 0.21483022}
confusion matrix:
      0     1
0  4951  1046
1    87   155
early stop counter: 1
val acc:0.749054491519928, best validation acc: 0.7994459867477417, corresponding to test acc:                         0.860394299030304 / 0.860394299030304
after epoch: 7,now: 2024-08-05 04:30:47.955609,epoch time: 0:17:12.727979,used: 2:03:38.180010,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90170485, 'precision': 0.901791, 'recall': 0.9017036, 'specificity': 0.9017036, 'f1': 0.90169936, 'auroc': 0.9671982, 'binary_precision': 0.89595026, 'binary_recall': 0.9090098, 'binary_specificity': 0.8943974, 'binary_f1_score': 0.9024328}
confusion matrix:
       0      1
0  26069   3078
1   2653  26504
---- Validation: 
scalar performance:
{'acc': 0.814947, 'precision': 0.5340851, 'recall': 0.66590273, 'specificity': 0.66590273, 'f1': 0.5227721, 'auroc': 0.73429865, 'binary_precision': 0.08759334, 'binary_recall': 0.50664455, 'binary_specificity': 0.825161, 'binary_f1_score': 0.14936337}
confusion matrix:
       0     1
0  14994  3177
1    297   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8736977, 'precision': 0.5738484, 'recall': 0.7261127, 'specificity': 0.7261127, 'f1': 0.59448886, 'auroc': 0.80913806, 'binary_precision': 0.16707318, 'binary_recall': 0.5661157, 'binary_specificity': 0.8861097, 'binary_f1_score': 0.25800377}
confusion matrix:
      0    1
0  5314  683
1   105  137
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-05 04:48:02.003600,epoch time: 0:17:14.047991,used: 2:20:52.228001,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9013104, 'precision': 0.90137696, 'recall': 0.9013095, 'specificity': 0.9013095, 'f1': 0.90130615, 'auroc': 0.9662123, 'binary_precision': 0.8962411, 'binary_recall': 0.9077377, 'binary_specificity': 0.8948813, 'binary_f1_score': 0.9019528}
confusion matrix:
       0      1
0  26084   3064
1   2690  26466
---- Validation: 
scalar performance:
{'acc': 0.8086614, 'precision': 0.5199371, 'recall': 0.5960028, 'specificity': 0.5960028, 'f1': 0.501409, 'auroc': 0.66942054, 'binary_precision': 0.064647645, 'binary_recall': 0.36877078, 'binary_specificity': 0.8232348, 'binary_f1_score': 0.110009916}
confusion matrix:
       0     1
0  14959  3212
1    380   222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84933484, 'precision': 0.5591173, 'recall': 0.7074915, 'specificity': 0.7074915, 'f1': 0.5692235, 'auroc': 0.78990805, 'binary_precision': 0.13871635, 'binary_recall': 0.553719, 'binary_specificity': 0.861264, 'binary_f1_score': 0.2218543}
confusion matrix:
      0    1
0  5165  832
1   108  134
early stop counter: 1
val acc:0.8086614012718201, best validation acc: 0.8149470090866089, corresponding to test acc:                         0.8736976981163025 / 0.8736976981163025
after epoch: 9,now: 2024-08-05 05:05:18.345867,epoch time: 0:17:16.342267,used: 2:38:08.570268,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90269965, 'precision': 0.9035896, 'recall': 0.90269566, 'specificity': 0.90269566, 'f1': 0.90264535, 'auroc': 0.9690509, 'binary_precision': 0.8846809, 'binary_recall': 0.92615837, 'binary_specificity': 0.8792329, 'binary_f1_score': 0.90494466}
confusion matrix:
       0      1
0  25627   3520
1   2153  27004
---- Validation: 
scalar performance:
{'acc': 0.7970489, 'precision': 0.524093, 'recall': 0.6237322, 'specificity': 0.6237322, 'f1': 0.5034918, 'auroc': 0.6970314, 'binary_precision': 0.07066381, 'binary_recall': 0.4385382, 'binary_specificity': 0.8089263, 'binary_f1_score': 0.12171507}
confusion matrix:
       0     1
0  14699  3472
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85286105, 'precision': 0.5685498, 'recall': 0.74303234, 'specificity': 0.74303234, 'f1': 0.58299947, 'auroc': 0.82525766, 'binary_precision': 0.15439673, 'binary_recall': 0.62396693, 'binary_specificity': 0.86209774, 'binary_f1_score': 0.24754098}
confusion matrix:
      0    1
0  5170  827
1    91  151
early stop counter: 2
val acc:0.7970489263534546, best validation acc: 0.8149470090866089, corresponding to test acc:                         0.8736976981163025 / 0.8736976981163025
after epoch: 10,now: 2024-08-05 05:22:39.646749,epoch time: 0:17:21.300882,used: 2:55:29.871150,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90679884, 'precision': 0.90680504, 'recall': 0.90679926, 'specificity': 0.90679926, 'f1': 0.9067986, 'auroc': 0.96910024, 'binary_precision': 0.908443, 'binary_recall': 0.90482885, 'binary_specificity': 0.90876967, 'binary_f1_score': 0.90663236}
confusion matrix:
       0      1
0  26487   2659
1   2775  26383
---- Validation: 
scalar performance:
{'acc': 0.82474834, 'precision': 0.5293761, 'recall': 0.6340255, 'specificity': 0.6340255, 'f1': 0.5192566, 'auroc': 0.7017304, 'binary_precision': 0.08078603, 'binary_recall': 0.43023255, 'binary_specificity': 0.8378185, 'binary_f1_score': 0.13602942}
confusion matrix:
       0     1
0  15224  2947
1    343   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549447, 'precision': 0.5659852, 'recall': 0.72825426, 'specificity': 0.72825426, 'f1': 0.5799768, 'auroc': 0.8115256, 'binary_precision': 0.15068494, 'binary_recall': 0.59090906, 'binary_specificity': 0.86559945, 'binary_f1_score': 0.24013436}
confusion matrix:
      0    1
0  5191  806
1    99  143
better model found
persisted
after epoch: 11,now: 2024-08-05 05:39:52.217268,epoch time: 0:17:12.570519,used: 3:12:42.441669,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9137109, 'precision': 0.91394484, 'recall': 0.9137129, 'specificity': 0.9137129, 'f1': 0.913699, 'auroc': 0.9735279, 'binary_precision': 0.92382824, 'binary_recall': 0.9018074, 'binary_specificity': 0.9256184, 'binary_f1_score': 0.91268504}
confusion matrix:
       0      1
0  26979   2168
1   2863  26294
---- Validation: 
scalar performance:
{'acc': 0.8387578, 'precision': 0.5340176, 'recall': 0.64527756, 'specificity': 0.64527756, 'f1': 0.52973515, 'auroc': 0.73552346, 'binary_precision': 0.08940061, 'binary_recall': 0.4385382, 'binary_specificity': 0.8520169, 'binary_f1_score': 0.14852323}
confusion matrix:
       0     1
0  15482  2689
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88780254, 'precision': 0.5830119, 'recall': 0.7294842, 'specificity': 0.7294842, 'f1': 0.6087616, 'auroc': 0.8209573, 'binary_precision': 0.18543956, 'binary_recall': 0.55785125, 'binary_specificity': 0.9011172, 'binary_f1_score': 0.27835053}
confusion matrix:
      0    1
0  5404  593
1   107  135
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-05 05:56:59.647328,epoch time: 0:17:07.430060,used: 3:29:49.871729,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9047235, 'precision': 0.909562, 'recall': 0.904716, 'specificity': 0.904716, 'f1': 0.9044401, 'auroc': 0.9756099, 'binary_precision': 0.8650806, 'binary_recall': 0.95904785, 'binary_specificity': 0.85038424, 'binary_f1_score': 0.90964395}
confusion matrix:
       0      1
0  24787   4361
1   1194  27962
---- Validation: 
scalar performance:
{'acc': 0.75821656, 'precision': 0.53007966, 'recall': 0.6807655, 'specificity': 0.6807655, 'f1': 0.49816266, 'auroc': 0.72600377, 'binary_precision': 0.077302985, 'binary_recall': 0.59800667, 'binary_specificity': 0.7635243, 'binary_f1_score': 0.13690816}
confusion matrix:
       0     1
0  13874  4297
1    242   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81311107, 'precision': 0.5623163, 'recall': 0.77192384, 'specificity': 0.77192384, 'f1': 0.5627486, 'auroc': 0.8318312, 'binary_precision': 0.13793103, 'binary_recall': 0.72727275, 'binary_specificity': 0.81657493, 'binary_f1_score': 0.23188406}
confusion matrix:
      0     1
0  4897  1100
1    66   176
early stop counter: 1
val acc:0.7582165598869324, best validation acc: 0.8387578129768372, corresponding to test acc:                         0.8878025412559509 / 0.8878025412559509
after epoch: 13,now: 2024-08-05 06:14:23.142010,epoch time: 0:17:23.494682,used: 3:47:13.366411,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91165274, 'precision': 0.9126204, 'recall': 0.91164696, 'specificity': 0.91164696, 'f1': 0.91160005, 'auroc': 0.9741777, 'binary_precision': 0.8926982, 'binary_recall': 0.9358346, 'binary_specificity': 0.8874593, 'binary_f1_score': 0.91375756}
confusion matrix:
       0      1
0  25865   3280
1   1871  27288
---- Validation: 
scalar performance:
{'acc': 0.8021094, 'precision': 0.5352301, 'recall': 0.6825597, 'specificity': 0.6825597, 'f1': 0.5201923, 'auroc': 0.7536434, 'binary_precision': 0.088336416, 'binary_recall': 0.55481726, 'binary_specificity': 0.81030214, 'binary_f1_score': 0.15240702}
confusion matrix:
       0     1
0  14724  3447
1    268   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8538227, 'precision': 0.5716889, 'recall': 0.755429, 'specificity': 0.755429, 'f1': 0.5875326, 'auroc': 0.8335352, 'binary_precision': 0.15955284, 'binary_recall': 0.6487603, 'binary_specificity': 0.86209774, 'binary_f1_score': 0.25611746}
confusion matrix:
      0    1
0  5170  827
1    85  157
early stop counter: 2
val acc:0.80210942029953, best validation acc: 0.8387578129768372, corresponding to test acc:                         0.8878025412559509 / 0.8878025412559509
after epoch: 14,now: 2024-08-05 06:31:38.729012,epoch time: 0:17:15.587002,used: 4:04:28.953413,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92218375, 'precision': 0.9227911, 'recall': 0.922187, 'specificity': 0.922187, 'f1': 0.9221562, 'auroc': 0.97716784, 'binary_precision': 0.93885916, 'binary_recall': 0.9032136, 'binary_specificity': 0.9411603, 'binary_f1_score': 0.92069155}
confusion matrix:
       0      1
0  27432   1715
1   2822  26335
---- Validation: 
scalar performance:
{'acc': 0.8707718, 'precision': 0.54426944, 'recall': 0.6553905, 'specificity': 0.6553905, 'f1': 0.5520844, 'auroc': 0.74660695, 'binary_precision': 0.10958904, 'binary_recall': 0.42524916, 'binary_specificity': 0.8855319, 'binary_f1_score': 0.17426822}
confusion matrix:
       0     1
0  16091  2080
1    346   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89854145, 'precision': 0.588725, 'recall': 0.72119117, 'specificity': 0.72119117, 'f1': 0.6166716, 'auroc': 0.8226565, 'binary_precision': 0.19783616, 'binary_recall': 0.5289256, 'binary_specificity': 0.91345674, 'binary_f1_score': 0.287964}
confusion matrix:
      0    1
0  5478  519
1   114  128
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-05 06:48:56.908927,epoch time: 0:17:18.179915,used: 4:21:47.133328,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067111
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:21:47.133328 at 2024-08-05 06:48:56.908927
persisted model performance metric: 

scalar performance:
{'acc': 0.89854145, 'precision': 0.588725, 'recall': 0.72119117, 'specificity': 0.72119117, 'f1': 0.6166716, 'auroc': 0.8226565, 'binary_precision': 0.19783616, 'binary_recall': 0.5289256, 'binary_specificity': 0.91345674, 'binary_f1_score': 0.287964}
confusion matrix:
      0    1
0  5478  519
1   114  128
oracle model performance metric: 

scalar performance:
{'acc': 0.89854145, 'precision': 0.588725, 'recall': 0.72119117, 'specificity': 0.72119117, 'f1': 0.6166716, 'auroc': 0.8226565, 'binary_precision': 0.19783616, 'binary_recall': 0.5289256, 'binary_specificity': 0.91345674, 'binary_f1_score': 0.287964}
confusion matrix:
      0    1
0  5478  519
1   114  128
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205613 KiB | 630912 KiB | 616990 GiB | 616990 GiB |
|       from large pool | 168576 KiB | 558188 KiB | 616120 GiB | 616120 GiB |
|       from small pool |  37037 KiB |  75475 KiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205613 KiB | 630912 KiB | 616990 GiB | 616990 GiB |
|       from large pool | 168576 KiB | 558188 KiB | 616120 GiB | 616120 GiB |
|       from small pool |  37037 KiB |  75475 KiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 625043 KiB | 610611 GiB | 610610 GiB |
|       from large pool | 165120 KiB | 553452 KiB | 609773 GiB | 609772 GiB |
|       from small pool |  35967 KiB |  74337 KiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 757760 KiB | 757760 KiB |   1722 MiB |    982 MiB |
|       from large pool | 681984 KiB | 681984 KiB |   1598 MiB |    932 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    124 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  29906 KiB | 171839 KiB | 372645 GiB | 372645 GiB |
|       from large pool |  15744 KiB | 170836 KiB | 371714 GiB | 371714 GiB |
|       from small pool |  14162 KiB |  21751 KiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    8057    |  135107 K  |  135103 K  |
|       from large pool |      36    |      76    |   41795 K  |   41795 K  |
|       from small pool |    3204    |    8019    |   93311 K  |   93308 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    8057    |  135107 K  |  135103 K  |
|       from large pool |      36    |      76    |   41795 K  |   41795 K  |
|       from small pool |    3204    |    8019    |   93311 K  |   93308 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      96    |      41    |
|       from large pool |      18    |      18    |      34    |      16    |
|       from small pool |      37    |      37    |      62    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3658    |   71835 K  |   71835 K  |
|       from large pool |       3    |      13    |   27408 K  |   27408 K  |
|       from small pool |      49    |    3655    |   44426 K  |   44426 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 630912 KiB | 616990 GiB | 616990 GiB |
|       from large pool |  16640 KiB | 558188 KiB | 616120 GiB | 616120 GiB |
|       from small pool |      0 KiB |  75475 KiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 630912 KiB | 616990 GiB | 616990 GiB |
|       from large pool |  16640 KiB | 558188 KiB | 616120 GiB | 616120 GiB |
|       from small pool |      0 KiB |  75475 KiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 625043 KiB | 610611 GiB | 610611 GiB |
|       from large pool |  16640 KiB | 553452 KiB | 609773 GiB | 609773 GiB |
|       from small pool |      0 KiB |  74337 KiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB | 757760 KiB |   1722 MiB |   1492 MiB |
|       from large pool | 184320 KiB | 681984 KiB |   1598 MiB |   1418 MiB |
|       from small pool |  51200 KiB |  75776 KiB |    124 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 171839 KiB | 372645 GiB | 372645 GiB |
|       from large pool |  24320 KiB | 170836 KiB | 371714 GiB | 371714 GiB |
|       from small pool |      0 KiB |  21757 KiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8057    |  135107 K  |  135107 K  |
|       from large pool |       2    |      76    |   41795 K  |   41795 K  |
|       from small pool |       0    |    8019    |   93311 K  |   93311 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8057    |  135107 K  |  135107 K  |
|       from large pool |       2    |      76    |   41795 K  |   41795 K  |
|       from small pool |       0    |    8019    |   93311 K  |   93311 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      55    |      96    |      62    |
|       from large pool |       9    |      18    |      34    |      25    |
|       from small pool |      25    |      37    |      62    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3658    |   71837 K  |   71837 K  |
|       from large pool |       3    |      13    |   27408 K  |   27408 K  |
|       from small pool |       0    |    3655    |   44428 K  |   44428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 06:50:14 2024]
Finished job 0.
1 of 1 steps (100%) done
