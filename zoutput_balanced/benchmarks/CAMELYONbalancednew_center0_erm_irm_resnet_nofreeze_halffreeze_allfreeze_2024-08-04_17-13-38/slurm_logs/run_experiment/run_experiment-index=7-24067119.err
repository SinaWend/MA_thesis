Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 22:15:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_27_47_seed_0_24067119

 Experiment start at: 2024-08-04 22:27:48.187669
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99262553, 'precision': 0.9926872, 'recall': 0.9926295, 'specificity': 0.9926295, 'f1': 0.9926253, 'auroc': 0.9995899, 'binary_precision': 0.9983785, 'binary_recall': 0.9868641, 'binary_specificity': 0.99839497, 'binary_f1_score': 0.99258786}
confusion matrix:
       0      1
0  28614     46
1    377  28323
---- Validation: 
scalar performance:
{'acc': 0.9638144, 'precision': 0.7177206, 'recall': 0.65499216, 'specificity': 0.65499216, 'f1': 0.68046284, 'auroc': 0.8879317, 'binary_precision': 0.45916116, 'binary_recall': 0.32348368, 'binary_specificity': 0.9865006, 'binary_f1_score': 0.37956202}
confusion matrix:
       0    1
0  17904  245
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.79547447, 'recall': 0.8127512, 'specificity': 0.8127512, 'f1': 0.8038355, 'auroc': 0.8970392, 'binary_precision': 0.6064982, 'binary_recall': 0.6436782, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.6245353}
confusion matrix:
      0    1
0  5888  109
1    93  168
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 22:56:46.955733,epoch time: 0:28:58.768064,used: 0:28:58.768064,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_27_47_seed_0_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9961123, 'precision': 0.9961188, 'recall': 0.9961138, 'specificity': 0.9961138, 'f1': 0.9961123, 'auroc': 0.9998117, 'binary_precision': 0.99811095, 'binary_recall': 0.9941117, 'binary_specificity': 0.9981158, 'binary_f1_score': 0.99610734}
confusion matrix:
       0      1
0  28605     54
1    169  28532
---- Validation: 
scalar performance:
{'acc': 0.9626437, 'precision': 0.7040596, 'recall': 0.64088506, 'specificity': 0.64088506, 'f1': 0.6659848, 'auroc': 0.8779774, 'binary_precision': 0.4328018, 'binary_recall': 0.29548988, 'binary_specificity': 0.98628026, 'binary_f1_score': 0.35120147}
confusion matrix:
       0    1
0  17900  249
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.84536165, 'recall': 0.7841028, 'specificity': 0.7841028, 'f1': 0.8114238, 'auroc': 0.90180016, 'binary_precision': 0.7089202, 'binary_recall': 0.5785441, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.63713086}
confusion matrix:
      0    1
0  5935   62
1   110  151
new oracle model saved
early stop counter: 1
val acc:0.9626436829566956, best validation acc: 0.963814377784729, corresponding to test acc:                         0.9677213430404663 / 0.9725151658058167
after epoch: 2,now: 2024-08-04 23:22:58.846042,epoch time: 0:26:11.890309,used: 0:55:10.658373,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_27_47_seed_0_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.997228, 'precision': 0.99723625, 'recall': 0.9972302, 'specificity': 0.9972302, 'f1': 0.997228, 'auroc': 0.99990606, 'binary_precision': 0.99951005, 'binary_recall': 0.994949, 'binary_specificity': 0.9995114, 'binary_f1_score': 0.99722433}
confusion matrix:
       0      1
0  28639     14
1    145  28562
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.81306255, 'recall': 0.63807416, 'specificity': 0.63807416, 'f1': 0.6889021, 'auroc': 0.9170227, 'binary_precision': 0.6510791, 'binary_recall': 0.281493, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.39305106}
confusion matrix:
       0    1
0  18052   97
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.72748655, 'recall': 0.698974, 'specificity': 0.698974, 'f1': 0.71213686, 'auroc': 0.87602997, 'binary_precision': 0.4801762, 'binary_recall': 0.41762453, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.44672132}
confusion matrix:
      0    1
0  5879  118
1   152  109
better model found
persisted
after epoch: 3,now: 2024-08-04 23:49:16.564843,epoch time: 0:26:17.718801,used: 1:21:28.377174,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_27_47_seed_0_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99745464, 'precision': 0.99746263, 'recall': 0.9974564, 'specificity': 0.9974564, 'f1': 0.9974547, 'auroc': 0.99992055, 'binary_precision': 0.99965006, 'binary_recall': 0.99526167, 'binary_specificity': 0.9996511, 'binary_f1_score': 0.99745107}
confusion matrix:
       0      1
0  28648     10
1    136  28566
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7485737, 'recall': 0.5662528, 'specificity': 0.5662528, 'f1': 0.6000217, 'auroc': 0.85183406, 'binary_precision': 0.5269461, 'binary_recall': 0.13685848, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.21728396}
confusion matrix:
       0   1
0  18070  79
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.82976544, 'recall': 0.5976992, 'specificity': 0.5976992, 'f1': 0.6452381, 'auroc': 0.88519, 'binary_precision': 0.6933333, 'binary_recall': 0.19923371, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.30952382}
confusion matrix:
      0   1
0  5974  23
1   209  52
early stop counter: 1
val acc:0.9662622213363647, best validation acc: 0.9702532887458801, corresponding to test acc:                         0.9568552374839783 / 0.9725151658058167
after epoch: 4,now: 2024-08-05 00:16:24.510815,epoch time: 0:27:07.945972,used: 1:48:36.323146,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_27_47_seed_0_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9969142, 'precision': 0.99692726, 'recall': 0.9969164, 'specificity': 0.9969164, 'f1': 0.9969142, 'auroc': 0.99989593, 'binary_precision': 0.9996847, 'binary_recall': 0.99414694, 'binary_specificity': 0.99968594, 'binary_f1_score': 0.9969081}
confusion matrix:
       0      1
0  28648      9
1    168  28535
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7490326, 'recall': 0.5557245, 'specificity': 0.5557245, 'f1': 0.5858808, 'auroc': 0.88079965, 'binary_precision': 0.5285714, 'binary_recall': 0.115085535, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.1890166}
confusion matrix:
       0   1
0  18083  66
1    569  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8474791, 'recall': 0.5414786, 'specificity': 0.5414786, 'f1': 0.5654991, 'auroc': 0.9015081, 'binary_precision': 0.73333335, 'binary_recall': 0.08429119, 'binary_specificity': 0.998666, 'binary_f1_score': 0.15120275}
confusion matrix:
      0   1
0  5989   8
1   239  22
early stop counter: 2
val acc:0.9662090539932251, best validation acc: 0.9702532887458801, corresponding to test acc:                         0.9568552374839783 / 0.9725151658058167
after epoch: 5,now: 2024-08-05 00:43:33.486949,epoch time: 0:27:08.976134,used: 2:15:45.299280,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_27_47_seed_0_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9978208, 'precision': 0.99782336, 'recall': 0.997822, 'specificity': 0.997822, 'f1': 0.99782073, 'auroc': 0.9999516, 'binary_precision': 0.9991965, 'binary_recall': 0.9964466, 'binary_specificity': 0.99919736, 'binary_f1_score': 0.99781966}
confusion matrix:
       0      1
0  28632     23
1    102  28603
---- Validation: 
scalar performance:
{'acc': 0.9611537, 'precision': 0.6670984, 'recall': 0.5838595, 'specificity': 0.5838595, 'f1': 0.60982555, 'auroc': 0.8253963, 'binary_precision': 0.362776, 'binary_recall': 0.17884915, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.23958334}
confusion matrix:
       0    1
0  17947  202
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9509428, 'precision': 0.6583686, 'recall': 0.5951108, 'specificity': 0.5951108, 'f1': 0.6174356, 'auroc': 0.85781014, 'binary_precision': 0.35064936, 'binary_recall': 0.20689656, 'binary_specificity': 0.983325, 'binary_f1_score': 0.26024097}
confusion matrix:
      0    1
0  5897  100
1   207   54
early stop counter: 3
val acc:0.9611536860466003, best validation acc: 0.9702532887458801, corresponding to test acc:                         0.9568552374839783 / 0.9725151658058167
after epoch: 6,now: 2024-08-05 01:10:33.146251,epoch time: 0:26:59.659302,used: 2:42:44.958582,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_27_47_seed_0_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 2:42:44.958582 at 2024-08-05 01:10:33.146251
persisted model performance metric: 

scalar performance:
{'acc': 0.95685524, 'precision': 0.72748655, 'recall': 0.698974, 'specificity': 0.698974, 'f1': 0.71213686, 'auroc': 0.87602997, 'binary_precision': 0.4801762, 'binary_recall': 0.41762453, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.44672132}
confusion matrix:
      0    1
0  5879  118
1   152  109
oracle model performance metric: 

scalar performance:
{'acc': 0.97251517, 'precision': 0.84536165, 'recall': 0.7841028, 'specificity': 0.7841028, 'f1': 0.8114238, 'auroc': 0.90180016, 'binary_precision': 0.7089202, 'binary_recall': 0.5785441, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.63713086}
confusion matrix:
      0    1
0  5935   62
1   110  151
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 485119 KiB |   1175 MiB | 156102 GiB | 156102 GiB |
|       from large pool | 397952 KiB |   1107 MiB | 155271 GiB | 155270 GiB |
|       from small pool |  87167 KiB |    122 MiB |    831 GiB |    831 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 485119 KiB |   1175 MiB | 156102 GiB | 156102 GiB |
|       from large pool | 397952 KiB |   1107 MiB | 155271 GiB | 155270 GiB |
|       from small pool |  87167 KiB |    122 MiB |    831 GiB |    831 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 473932 KiB |   1162 MiB | 154143 GiB | 154142 GiB |
|       from large pool | 387840 KiB |   1094 MiB | 153316 GiB | 153316 GiB |
|       from small pool |  86092 KiB |    121 MiB |    826 GiB |    826 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1440 MiB |   1440 MiB |   1440 MiB |      0 B   |
|       from large pool |   1316 MiB |   1316 MiB |   1316 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 485632 KiB | 492506 KiB | 112187 GiB | 112187 GiB |
|       from large pool | 476544 KiB | 489472 KiB | 111219 GiB | 111218 GiB |
|       from small pool |   9088 KiB |  11946 KiB |    968 GiB |    968 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3630    |    8297    |   30177 K  |   30174 K  |
|       from large pool |      87    |     155    |   11119 K  |   11119 K  |
|       from small pool |    3543    |    8209    |   19057 K  |   19054 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3630    |    8297    |   30177 K  |   30174 K  |
|       from large pool |      87    |     155    |   11119 K  |   11119 K  |
|       from small pool |    3543    |    8209    |   19057 K  |   19054 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |      95    |      95    |       0    |
|       from large pool |      33    |      33    |      33    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      47    |    3609    |   14062 K  |   14062 K  |
|       from large pool |      15    |      24    |    5868 K  |    5868 K  |
|       from small pool |      32    |    3594    |    8194 K  |    8194 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1175 MiB | 156102 GiB | 156102 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 155271 GiB | 155271 GiB |
|       from small pool |      0 KiB |    122 MiB |    831 GiB |    831 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1175 MiB | 156102 GiB | 156102 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 155271 GiB | 155271 GiB |
|       from small pool |      0 KiB |    122 MiB |    831 GiB |    831 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1162 MiB | 154143 GiB | 154143 GiB |
|       from large pool |  16640 KiB |   1094 MiB | 153316 GiB | 153316 GiB |
|       from small pool |      0 KiB |    121 MiB |    826 GiB |    826 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    948 MiB |   1440 MiB |   1440 MiB | 503808 KiB |
|       from large pool |    854 MiB |   1316 MiB |   1316 MiB | 473088 KiB |
|       from small pool |     94 MiB |    124 MiB |    124 MiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB | 518176 KiB | 112188 GiB | 112188 GiB |
|       from large pool |  50944 KiB | 497408 KiB | 111219 GiB | 111219 GiB |
|       from small pool |      0 KiB |  27728 KiB |    968 GiB |    968 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8297    |   30177 K  |   30177 K  |
|       from large pool |       2    |     155    |   11119 K  |   11119 K  |
|       from small pool |       0    |    8209    |   19057 K  |   19057 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8297    |   30177 K  |   30177 K  |
|       from large pool |       2    |     155    |   11119 K  |   11119 K  |
|       from small pool |       0    |    8209    |   19057 K  |   19057 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      95    |      95    |      25    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      62    |      62    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3609    |   14063 K  |   14063 K  |
|       from large pool |       4    |      24    |    5868 K  |    5868 K  |
|       from small pool |       0    |    3594    |    8195 K  |    8195 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1175 MiB | 156102 GiB | 156102 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 155271 GiB | 155271 GiB |
|       from small pool |      0 KiB |    122 MiB |    831 GiB |    831 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1175 MiB | 156102 GiB | 156102 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 155271 GiB | 155271 GiB |
|       from small pool |      0 KiB |    122 MiB |    831 GiB |    831 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1162 MiB | 154143 GiB | 154143 GiB |
|       from large pool |  16640 KiB |   1094 MiB | 153316 GiB | 153316 GiB |
|       from small pool |      0 KiB |    121 MiB |    826 GiB |    826 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    948 MiB |   1440 MiB |   1440 MiB | 503808 KiB |
|       from large pool |    854 MiB |   1316 MiB |   1316 MiB | 473088 KiB |
|       from small pool |     94 MiB |    124 MiB |    124 MiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB | 518176 KiB | 112188 GiB | 112188 GiB |
|       from large pool |  50944 KiB | 497408 KiB | 111219 GiB | 111219 GiB |
|       from small pool |      0 KiB |  27728 KiB |    968 GiB |    968 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8297    |   30177 K  |   30177 K  |
|       from large pool |       2    |     155    |   11119 K  |   11119 K  |
|       from small pool |       0    |    8209    |   19057 K  |   19057 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8297    |   30177 K  |   30177 K  |
|       from large pool |       2    |     155    |   11119 K  |   11119 K  |
|       from small pool |       0    |    8209    |   19057 K  |   19057 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      95    |      95    |      25    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      62    |      62    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3609    |   14063 K  |   14063 K  |
|       from large pool |       4    |      24    |    5868 K  |    5868 K  |
|       from small pool |       0    |    3594    |    8195 K  |    8195 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119

 Experiment start at: 2024-08-05 01:20:46.712906
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9929186, 'precision': 0.9929637, 'recall': 0.99292225, 'specificity': 0.99292225, 'f1': 0.9929185, 'auroc': 0.99956, 'binary_precision': 0.9978629, 'binary_recall': 0.9879635, 'binary_specificity': 0.997881, 'binary_f1_score': 0.9928885}
confusion matrix:
       0      1
0  28726     61
1    347  28482
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7458612, 'recall': 0.657031, 'specificity': 0.657031, 'f1': 0.69057894, 'auroc': 0.90425456, 'binary_precision': 0.5165094, 'binary_recall': 0.3254086, 'binary_specificity': 0.98865336, 'binary_f1_score': 0.3992707}
confusion matrix:
       0    1
0  17862  205
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9727683, 'precision': 0.8723533, 'recall': 0.7485595, 'specificity': 0.7485595, 'f1': 0.7968915, 'auroc': 0.89170146, 'binary_precision': 0.76608187, 'binary_recall': 0.50384617, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.60788864}
confusion matrix:
      0    1
0  5906   40
1   129  131
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 01:47:28.865146,epoch time: 0:26:42.152240,used: 0:26:42.152240,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9960775, 'precision': 0.99609184, 'recall': 0.99607956, 'specificity': 0.99607956, 'f1': 0.9960775, 'auroc': 0.9997581, 'binary_precision': 0.99895334, 'binary_recall': 0.9932013, 'binary_specificity': 0.9989579, 'binary_f1_score': 0.996069}
confusion matrix:
       0      1
0  28757     30
1    196  28633
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7393693, 'recall': 0.58165115, 'specificity': 0.58165115, 'f1': 0.61794674, 'auroc': 0.8766003, 'binary_precision': 0.5089286, 'binary_recall': 0.16939078, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.2541806}
confusion matrix:
       0    1
0  17957  110
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96825653, 'precision': 0.84867656, 'recall': 0.6928743, 'specificity': 0.6928743, 'f1': 0.7461633, 'auroc': 0.8559866, 'binary_precision': 0.7234042, 'binary_recall': 0.3923077, 'binary_specificity': 0.993441, 'binary_f1_score': 0.5087282}
confusion matrix:
      0    1
0  5907   39
1   158  102
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9648345708847046, corresponding to test acc:                         0.9727683067321777 / 0.9727683067321777
after epoch: 2,now: 2024-08-05 02:13:41.966438,epoch time: 0:26:13.101292,used: 0:52:55.253532,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9971709, 'precision': 0.9971789, 'recall': 0.9971726, 'specificity': 0.9971726, 'f1': 0.9971709, 'auroc': 0.9998661, 'binary_precision': 0.9993729, 'binary_recall': 0.9949705, 'binary_specificity': 0.9993747, 'binary_f1_score': 0.9971669}
confusion matrix:
       0      1
0  28768     18
1    145  28685
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.7098686, 'recall': 0.5624177, 'specificity': 0.5624177, 'f1': 0.591932, 'auroc': 0.89623296, 'binary_precision': 0.45128205, 'binary_recall': 0.1307578, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.20276497}
confusion matrix:
       0    1
0  17960  107
1    585   88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.76687396, 'recall': 0.5520803, 'specificity': 0.5520803, 'f1': 0.58016294, 'auroc': 0.85888994, 'binary_precision': 0.5714286, 'binary_recall': 0.10769231, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.18122979}
confusion matrix:
      0   1
0  5925  21
1   232  28
early stop counter: 2
val acc:0.9630736112594604, best validation acc: 0.9648345708847046, corresponding to test acc:                         0.9727683067321777 / 0.9727683067321777
after epoch: 3,now: 2024-08-05 02:39:52.854436,epoch time: 0:26:10.887998,used: 1:19:06.141530,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.997761, 'precision': 0.99776757, 'recall': 0.99776244, 'specificity': 0.99776244, 'f1': 0.997761, 'auroc': 0.99992895, 'binary_precision': 0.9997562, 'binary_recall': 0.995768, 'binary_specificity': 0.9997569, 'binary_f1_score': 0.99775815}
confusion matrix:
       0      1
0  28781      7
1    122  28706
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.780267, 'recall': 0.5825091, 'specificity': 0.5825091, 'f1': 0.6229272, 'auroc': 0.8974158, 'binary_precision': 0.59067357, 'binary_recall': 0.16939078, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.26327944}
confusion matrix:
       0    1
0  17988   79
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97131807, 'precision': 0.95867825, 'recall': 0.6668872, 'specificity': 0.6668872, 'f1': 0.73977935, 'auroc': 0.8510303, 'binary_precision': 0.9456522, 'binary_recall': 0.33461538, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.49431816}
confusion matrix:
      0   1
0  5941   5
1   173  87
better model found
persisted
after epoch: 4,now: 2024-08-05 03:06:02.945919,epoch time: 0:26:10.091483,used: 1:45:16.233013,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9982297, 'precision': 0.99823165, 'recall': 0.9982306, 'specificity': 0.9982306, 'f1': 0.9982297, 'auroc': 0.99993014, 'binary_precision': 0.99944365, 'binary_recall': 0.997017, 'binary_specificity': 0.9994442, 'binary_f1_score': 0.99822885}
confusion matrix:
       0      1
0  28770     16
1     86  28744
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.8230165, 'recall': 0.5955819, 'specificity': 0.5955819, 'f1': 0.64283365, 'auroc': 0.94454336, 'binary_precision': 0.67525774, 'binary_recall': 0.19465081, 'binary_specificity': 0.996513, 'binary_f1_score': 0.30219144}
confusion matrix:
       0    1
0  18004   63
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.88321847, 'recall': 0.6825131, 'specificity': 0.6825131, 'f1': 0.7441138, 'auroc': 0.88118744, 'binary_precision': 0.7933884, 'binary_recall': 0.36923078, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.503937}
confusion matrix:
      0   1
0  5921  25
1   164  96
better model found
persisted
after epoch: 5,now: 2024-08-05 03:32:15.208708,epoch time: 0:26:12.262789,used: 2:11:28.495802,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9982297, 'precision': 0.9982328, 'recall': 0.9982308, 'specificity': 0.9982308, 'f1': 0.9982296, 'auroc': 0.9999534, 'binary_precision': 0.9996869, 'binary_recall': 0.9967742, 'binary_specificity': 0.9996874, 'binary_f1_score': 0.9982284}
confusion matrix:
       0      1
0  28777      9
1     93  28737
---- Validation: 
scalar performance:
{'acc': 0.97033083, 'precision': 0.8711339, 'recall': 0.6226876, 'specificity': 0.6226876, 'f1': 0.68004274, 'auroc': 0.9396907, 'binary_precision': 0.76958525, 'binary_recall': 0.24814264, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.37528092}
confusion matrix:
       0    1
0  18017   50
1    506  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.9042057, 'recall': 0.5724883, 'specificity': 0.5724883, 'f1': 0.61513287, 'auroc': 0.8799437, 'binary_precision': 0.84444445, 'binary_recall': 0.14615385, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.24918033}
confusion matrix:
      0   1
0  5939   7
1   222  38
better model found
persisted
after epoch: 6,now: 2024-08-05 03:58:47.166214,epoch time: 0:26:31.957506,used: 2:38:00.453308,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99868095, 'precision': 0.9986813, 'recall': 0.9986814, 'specificity': 0.9986814, 'f1': 0.99868095, 'auroc': 0.9999764, 'binary_precision': 0.99934006, 'binary_recall': 0.9980228, 'binary_specificity': 0.99934, 'binary_f1_score': 0.998681}
confusion matrix:
       0      1
0  28768     19
1     57  28772
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.73207, 'recall': 0.5714714, 'specificity': 0.5714714, 'f1': 0.60506564, 'auroc': 0.8442614, 'binary_precision': 0.4950495, 'binary_recall': 0.1485884, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.22857141}
confusion matrix:
       0    1
0  17965  102
1    573  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.9111601, 'recall': 0.61262065, 'specificity': 0.61262065, 'f1': 0.67060006, 'auroc': 0.90283805, 'binary_precision': 0.85507244, 'binary_recall': 0.22692308, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.3586626}
confusion matrix:
      0   1
0  5936  10
1   201  59
early stop counter: 1
val acc:0.9639807939529419, best validation acc: 0.9703308343887329, corresponding to test acc:                         0.963100254535675 / 0.9727683067321777
after epoch: 7,now: 2024-08-05 04:24:12.089322,epoch time: 0:25:24.923108,used: 3:03:25.376416,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9982817, 'precision': 0.9982847, 'recall': 0.9982828, 'specificity': 0.9982828, 'f1': 0.9982817, 'auroc': 0.9999598, 'binary_precision': 0.99968696, 'binary_recall': 0.99687815, 'binary_specificity': 0.9996874, 'binary_f1_score': 0.9982805}
confusion matrix:
       0      1
0  28778      9
1     90  28739
---- Validation: 
scalar performance:
{'acc': 0.9671291, 'precision': 0.84322166, 'recall': 0.56881255, 'specificity': 0.56881255, 'f1': 0.6085175, 'auroc': 0.9375706, 'binary_precision': 0.71755725, 'binary_recall': 0.1396731, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.23383082}
confusion matrix:
       0   1
0  18030  37
1    579  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.88985217, 'recall': 0.5837745, 'specificity': 0.5837745, 'f1': 0.630787, 'auroc': 0.91651106, 'binary_precision': 0.8148148, 'binary_recall': 0.16923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.28025478}
confusion matrix:
      0   1
0  5936  10
1   216  44
early stop counter: 2
val acc:0.967129111289978, best validation acc: 0.9703308343887329, corresponding to test acc:                         0.963100254535675 / 0.9727683067321777
after epoch: 8,now: 2024-08-05 04:49:34.443064,epoch time: 0:25:22.353742,used: 3:28:47.730158,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99887186, 'precision': 0.9988724, 'recall': 0.9988724, 'specificity': 0.9988724, 'f1': 0.9988718, 'auroc': 0.9999374, 'binary_precision': 0.9996179, 'binary_recall': 0.99812686, 'binary_specificity': 0.9996179, 'binary_f1_score': 0.9988718}
confusion matrix:
       0      1
0  28776     11
1     54  28775
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.84183013, 'recall': 0.55709153, 'specificity': 0.55709153, 'f1': 0.59121513, 'auroc': 0.9419148, 'binary_precision': 0.7155963, 'binary_recall': 0.11589896, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.19948849}
confusion matrix:
       0   1
0  18036  31
1    595  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.9037865, 'recall': 0.6010822, 'specificity': 0.6010822, 'f1': 0.6551116, 'auroc': 0.89929795, 'binary_precision': 0.84126985, 'binary_recall': 0.20384616, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.3281734}
confusion matrix:
      0   1
0  5936  10
1   207  53
early stop counter: 3
val acc:0.9665955305099487, best validation acc: 0.9703308343887329, corresponding to test acc:                         0.963100254535675 / 0.9727683067321777
after epoch: 9,now: 2024-08-05 05:14:54.501097,epoch time: 0:25:20.058033,used: 3:54:07.788191,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_20_46_seed_1_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 3:54:07.788191 at 2024-08-05 05:14:54.501097
persisted model performance metric: 

scalar performance:
{'acc': 0.96310025, 'precision': 0.9042057, 'recall': 0.5724883, 'specificity': 0.5724883, 'f1': 0.61513287, 'auroc': 0.8799437, 'binary_precision': 0.84444445, 'binary_recall': 0.14615385, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.24918033}
confusion matrix:
      0   1
0  5939   7
1   222  38
oracle model performance metric: 

scalar performance:
{'acc': 0.9727683, 'precision': 0.8723533, 'recall': 0.7485595, 'specificity': 0.7485595, 'f1': 0.7968915, 'auroc': 0.89170146, 'binary_precision': 0.76608187, 'binary_recall': 0.50384617, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.60788864}
confusion matrix:
      0    1
0  5906   40
1   129  131
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 478835 KiB |   1175 MiB | 388429 GiB | 388429 GiB |
|       from large pool | 391680 KiB |   1107 MiB | 386348 GiB | 386347 GiB |
|       from small pool |  87155 KiB |    122 MiB |   2081 GiB |   2081 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 478835 KiB |   1175 MiB | 388429 GiB | 388429 GiB |
|       from large pool | 391680 KiB |   1107 MiB | 386348 GiB | 386347 GiB |
|       from small pool |  87155 KiB |    122 MiB |   2081 GiB |   2081 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 473930 KiB |   1162 MiB | 385044 GiB | 385043 GiB |
|       from large pool | 387840 KiB |   1094 MiB | 382973 GiB | 382973 GiB |
|       from small pool |  86090 KiB |    121 MiB |   2070 GiB |   2070 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1428 MiB |   1440 MiB |   1920 MiB | 503808 KiB |
|       from large pool |   1306 MiB |   1316 MiB |   1768 MiB | 473088 KiB |
|       from small pool |    122 MiB |    124 MiB |    152 MiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 524684 KiB | 602902 KiB | 306235 GiB | 306234 GiB |
|       from large pool | 515584 KiB | 600704 KiB | 303834 GiB | 303834 GiB |
|       from small pool |   9100 KiB |  27728 KiB |   2400 GiB |   2400 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3606    |    8329    |   75370 K  |   75367 K  |
|       from large pool |      87    |     155    |   27781 K  |   27781 K  |
|       from small pool |    3519    |    8241    |   47589 K  |   47585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3606    |    8329    |   75370 K  |   75367 K  |
|       from large pool |      87    |     155    |   27781 K  |   27781 K  |
|       from small pool |    3519    |    8241    |   47589 K  |   47585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |      95    |     120    |      25    |
|       from large pool |      34    |      34    |      44    |      10    |
|       from small pool |      61    |      62    |      76    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |    3634    |   36057 K  |   36057 K  |
|       from large pool |      24    |      32    |   15352 K  |   15352 K  |
|       from small pool |      32    |    3610    |   20705 K  |   20705 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1175 MiB | 388429 GiB | 388429 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 386348 GiB | 386348 GiB |
|       from small pool |      0 KiB |    122 MiB |   2081 GiB |   2081 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1175 MiB | 388429 GiB | 388429 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 386348 GiB | 386348 GiB |
|       from small pool |      0 KiB |    122 MiB |   2081 GiB |   2081 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1162 MiB | 385044 GiB | 385044 GiB |
|       from large pool |  16640 KiB |   1094 MiB | 382973 GiB | 382973 GiB |
|       from small pool |      0 KiB |    121 MiB |   2070 GiB |   2070 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    980 MiB |   1440 MiB |   1920 MiB |    940 MiB |
|       from large pool |    886 MiB |   1316 MiB |   1768 MiB |    882 MiB |
|       from small pool |     94 MiB |    124 MiB |    152 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB | 602902 KiB | 306235 GiB | 306235 GiB |
|       from large pool |  50944 KiB | 600704 KiB | 303834 GiB | 303834 GiB |
|       from small pool |      0 KiB |  28150 KiB |   2400 GiB |   2400 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8329    |   75370 K  |   75370 K  |
|       from large pool |       2    |     155    |   27781 K  |   27781 K  |
|       from small pool |       0    |    8241    |   47589 K  |   47589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8329    |   75370 K  |   75370 K  |
|       from large pool |       2    |     155    |   27781 K  |   27781 K  |
|       from small pool |       0    |    8241    |   47589 K  |   47589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      95    |     120    |      49    |
|       from large pool |      24    |      34    |      44    |      20    |
|       from small pool |      47    |      62    |      76    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3634    |   36059 K  |   36059 K  |
|       from large pool |       4    |      32    |   15352 K  |   15352 K  |
|       from small pool |       0    |    3610    |   20706 K  |   20706 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1175 MiB | 388429 GiB | 388429 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 386348 GiB | 386348 GiB |
|       from small pool |      0 KiB |    122 MiB |   2081 GiB |   2081 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1175 MiB | 388429 GiB | 388429 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 386348 GiB | 386348 GiB |
|       from small pool |      0 KiB |    122 MiB |   2081 GiB |   2081 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1162 MiB | 385044 GiB | 385044 GiB |
|       from large pool |  16640 KiB |   1094 MiB | 382973 GiB | 382973 GiB |
|       from small pool |      0 KiB |    121 MiB |   2070 GiB |   2070 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    980 MiB |   1440 MiB |   1920 MiB |    940 MiB |
|       from large pool |    886 MiB |   1316 MiB |   1768 MiB |    882 MiB |
|       from small pool |     94 MiB |    124 MiB |    152 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB | 602902 KiB | 306235 GiB | 306235 GiB |
|       from large pool |  50944 KiB | 600704 KiB | 303834 GiB | 303834 GiB |
|       from small pool |      0 KiB |  28150 KiB |   2400 GiB |   2400 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8329    |   75370 K  |   75370 K  |
|       from large pool |       2    |     155    |   27781 K  |   27781 K  |
|       from small pool |       0    |    8241    |   47589 K  |   47589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8329    |   75370 K  |   75370 K  |
|       from large pool |       2    |     155    |   27781 K  |   27781 K  |
|       from small pool |       0    |    8241    |   47589 K  |   47589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      95    |     120    |      49    |
|       from large pool |      24    |      34    |      44    |      20    |
|       from small pool |      47    |      62    |      76    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3634    |   36059 K  |   36059 K  |
|       from large pool |       4    |      32    |   15352 K  |   15352 K  |
|       from small pool |       0    |    3610    |   20706 K  |   20706 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119

 Experiment start at: 2024-08-05 05:24:30.737474
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99358535, 'precision': 0.99359906, 'recall': 0.9935858, 'specificity': 0.9935858, 'f1': 0.9935852, 'auroc': 0.999704, 'binary_precision': 0.9962415, 'binary_recall': 0.99091125, 'binary_specificity': 0.99626034, 'binary_f1_score': 0.9935692}
confusion matrix:
       0      1
0  29038    109
1    265  28892
---- Validation: 
scalar performance:
{'acc': 0.9587706, 'precision': 0.6857406, 'recall': 0.7353786, 'specificity': 0.7353786, 'f1': 0.70723176, 'auroc': 0.9042028, 'binary_precision': 0.38831168, 'binary_recall': 0.49667773, 'binary_specificity': 0.97407955, 'binary_f1_score': 0.43586007}
confusion matrix:
       0    1
0  17700  471
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.75114936, 'recall': 0.81807226, 'specificity': 0.81807226, 'f1': 0.7801284, 'auroc': 0.885221, 'binary_precision': 0.516129, 'binary_recall': 0.661157, 'binary_specificity': 0.9749875, 'binary_f1_score': 0.5797101}
confusion matrix:
      0    1
0  5847  150
1    82  160
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 05:50:44.885146,epoch time: 0:26:14.147672,used: 0:26:14.147672,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9961066, 'precision': 0.99612534, 'recall': 0.996107, 'specificity': 0.996107, 'f1': 0.99610656, 'auroc': 0.9998399, 'binary_precision': 0.9992062, 'binary_recall': 0.99300313, 'binary_specificity': 0.9992109, 'binary_f1_score': 0.996095}
confusion matrix:
       0      1
0  29125     23
1    204  28952
---- Validation: 
scalar performance:
{'acc': 0.96569544, 'precision': 0.69455725, 'recall': 0.58236134, 'specificity': 0.58236134, 'f1': 0.6132904, 'auroc': 0.8868743, 'binary_precision': 0.416, 'binary_recall': 0.17275748, 'binary_specificity': 0.99196523, 'binary_f1_score': 0.24413143}
confusion matrix:
       0    1
0  18025  146
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741946, 'precision': 0.88691217, 'recall': 0.72287214, 'specificity': 0.72287214, 'f1': 0.78094554, 'auroc': 0.88406324, 'binary_precision': 0.79562044, 'binary_recall': 0.45041323, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5751979}
confusion matrix:
      0    1
0  5969   28
1   133  109
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-05 06:16:41.425594,epoch time: 0:25:56.540448,used: 0:52:10.688120,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99761593, 'precision': 0.9976214, 'recall': 0.99761623, 'specificity': 0.99761623, 'f1': 0.99761593, 'auroc': 0.9999255, 'binary_precision': 0.99931175, 'binary_recall': 0.99591863, 'binary_specificity': 0.99931383, 'binary_f1_score': 0.99761224}
confusion matrix:
       0      1
0  29127     20
1    119  29038
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.72652954, 'recall': 0.60647523, 'specificity': 0.60647523, 'f1': 0.6427635, 'auroc': 0.9158548, 'binary_precision': 0.47841728, 'binary_recall': 0.22093023, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.30227274}
confusion matrix:
       0    1
0  18026  145
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97146976, 'precision': 0.8939085, 'recall': 0.6699035, 'specificity': 0.6699035, 'f1': 0.7339443, 'auroc': 0.89035064, 'binary_precision': 0.8137255, 'binary_recall': 0.3429752, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.48255816}
confusion matrix:
      0   1
0  5978  19
1   159  83
better model found
persisted
after epoch: 3,now: 2024-08-05 06:42:20.878615,epoch time: 0:25:39.453021,used: 1:17:50.141141,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9975473, 'precision': 0.9975573, 'recall': 0.99754775, 'specificity': 0.99754775, 'f1': 0.9975474, 'auroc': 0.9998908, 'binary_precision': 0.99982774, 'binary_recall': 0.995267, 'binary_specificity': 0.99982846, 'binary_f1_score': 0.99754214}
confusion matrix:
       0      1
0  29142      5
1    138  29019
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7151431, 'recall': 0.5494863, 'specificity': 0.5494863, 'f1': 0.57579803, 'auroc': 0.88826334, 'binary_precision': 0.45925927, 'binary_recall': 0.10299003, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.16824967}
confusion matrix:
       0   1
0  18098  73
1    540  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.9139231, 'recall': 0.58825934, 'specificity': 0.58825934, 'f1': 0.63880795, 'auroc': 0.8880165, 'binary_precision': 0.86, 'binary_recall': 0.17768595, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.29452053}
confusion matrix:
      0   1
0  5990   7
1   199  43
better model found
persisted
after epoch: 4,now: 2024-08-05 07:08:02.903128,epoch time: 0:25:42.024513,used: 1:43:32.165654,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9979075, 'precision': 0.99791133, 'recall': 0.9979078, 'specificity': 0.9979078, 'f1': 0.9979075, 'auroc': 0.9999312, 'binary_precision': 0.9993465, 'binary_recall': 0.99646753, 'binary_specificity': 0.9993481, 'binary_f1_score': 0.9979049}
confusion matrix:
       0      1
0  29127     19
1    103  29055
---- Validation: 
scalar performance:
{'acc': 0.96532255, 'precision': 0.69258416, 'recall': 0.59019923, 'specificity': 0.59019923, 'f1': 0.6208157, 'auroc': 0.86469424, 'binary_precision': 0.41155234, 'binary_recall': 0.18936877, 'binary_specificity': 0.9910297, 'binary_f1_score': 0.25938568}
confusion matrix:
       0    1
0  18008  163
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9746754, 'precision': 0.8981199, 'recall': 0.7211395, 'specificity': 0.7211395, 'f1': 0.78224325, 'auroc': 0.9084157, 'binary_precision': 0.8181818, 'binary_recall': 0.446281, 'binary_specificity': 0.995998, 'binary_f1_score': 0.5775401}
confusion matrix:
      0    1
0  5973   24
1   134  108
new oracle model saved
early stop counter: 1
val acc:0.9653225541114807, best validation acc: 0.967346727848053, corresponding to test acc:                         0.9669818878173828 / 0.9746754169464111
after epoch: 5,now: 2024-08-05 07:33:52.538347,epoch time: 0:25:49.635219,used: 2:09:21.800873,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99811333, 'precision': 0.99811924, 'recall': 0.99811375, 'specificity': 0.99811375, 'f1': 0.9981133, 'auroc': 0.9999474, 'binary_precision': 0.99989676, 'binary_recall': 0.99633044, 'binary_specificity': 0.99989706, 'binary_f1_score': 0.99811035}
confusion matrix:
       0      1
0  29142      3
1    107  29052
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.74143934, 'recall': 0.5530837, 'specificity': 0.5530837, 'f1': 0.582152, 'auroc': 0.8992808, 'binary_precision': 0.5116279, 'binary_recall': 0.10963455, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.18057455}
confusion matrix:
       0   1
0  18108  63
1    536  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8080552, 'recall': 0.59295696, 'specificity': 0.59295696, 'f1': 0.6378814, 'auroc': 0.8898139, 'binary_precision': 0.64788735, 'binary_recall': 0.19008264, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.2939297}
confusion matrix:
      0   1
0  5972  25
1   196  46
better model found
persisted
after epoch: 6,now: 2024-08-05 07:59:49.024252,epoch time: 0:25:56.485905,used: 2:35:18.286778,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9987651, 'precision': 0.99876654, 'recall': 0.99876523, 'specificity': 0.99876523, 'f1': 0.9987651, 'auroc': 0.99997544, 'binary_precision': 0.99965644, 'binary_recall': 0.9978736, 'binary_specificity': 0.9996569, 'binary_f1_score': 0.9987642}
confusion matrix:
       0      1
0  29137     10
1     62  29095
---- Validation: 
scalar performance:
{'acc': 0.97224736, 'precision': 0.82212657, 'recall': 0.6315196, 'specificity': 0.6315196, 'f1': 0.68388706, 'auroc': 0.9132035, 'binary_precision': 0.6680498, 'binary_recall': 0.26744187, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.38196918}
confusion matrix:
       0    1
0  18091   80
1    441  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.8958107, 'recall': 0.6310642, 'specificity': 0.6310642, 'f1': 0.692104, 'auroc': 0.92332274, 'binary_precision': 0.82051283, 'binary_recall': 0.2644628, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.4}
confusion matrix:
      0   1
0  5983  14
1   178  64
better model found
persisted
after epoch: 7,now: 2024-08-05 08:25:49.474933,epoch time: 0:26:00.450681,used: 3:01:18.737459,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99811333, 'precision': 0.9981195, 'recall': 0.99811375, 'specificity': 0.99811375, 'f1': 0.99811333, 'auroc': 0.99991953, 'binary_precision': 0.99993116, 'binary_recall': 0.99629617, 'binary_specificity': 0.9999314, 'binary_f1_score': 0.99811035}
confusion matrix:
       0      1
0  29143      2
1    108  29051
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.7080717, 'recall': 0.51354176, 'specificity': 0.51354176, 'f1': 0.51835245, 'auroc': 0.84810805, 'binary_precision': 0.4473684, 'binary_recall': 0.028239202, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.053124998}
confusion matrix:
       0   1
0  18150  21
1    585  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.780831, 'recall': 0.50603163, 'specificity': 0.50603163, 'f1': 0.50229377, 'auroc': 0.8815413, 'binary_precision': 0.6, 'binary_recall': 0.012396694, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.024291497}
confusion matrix:
      0  1
0  5995  2
1   239  3
early stop counter: 1
val acc:0.9677196145057678, best validation acc: 0.9722473621368408, corresponding to test acc:                         0.9692258238792419 / 0.9746754169464111
after epoch: 8,now: 2024-08-05 08:51:45.654872,epoch time: 0:25:56.179939,used: 3:27:14.917398,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99861073, 'precision': 0.9986131, 'recall': 0.998611, 'specificity': 0.998611, 'f1': 0.99861073, 'auroc': 0.9999756, 'binary_precision': 0.9997594, 'binary_recall': 0.9974621, 'binary_specificity': 0.99975985, 'binary_f1_score': 0.9986094}
confusion matrix:
       0      1
0  29139      7
1     74  29084
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.6921685, 'recall': 0.5490736, 'specificity': 0.5490736, 'f1': 0.5739128, 'auroc': 0.88381445, 'binary_precision': 0.41333333, 'binary_recall': 0.10299003, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.16489363}
confusion matrix:
       0   1
0  18083  88
1    540  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97627825, 'precision': 0.9076096, 'recall': 0.7398179, 'specificity': 0.7398179, 'f1': 0.80016494, 'auroc': 0.91261315, 'binary_precision': 0.8357143, 'binary_recall': 0.48347107, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.6125654}
confusion matrix:
      0    1
0  5974   23
1   125  117
new oracle model saved
early stop counter: 2
val acc:0.9665477275848389, best validation acc: 0.9722473621368408, corresponding to test acc:                         0.9692258238792419 / 0.9762782454490662
after epoch: 9,now: 2024-08-05 09:17:44.620572,epoch time: 0:25:58.965700,used: 3:53:13.883098,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99825054, 'precision': 0.9982519, 'recall': 0.9982504, 'specificity': 0.9982504, 'f1': 0.9982506, 'auroc': 0.9999862, 'binary_precision': 0.997466, 'binary_recall': 0.9990397, 'binary_specificity': 0.99746114, 'binary_f1_score': 0.9982523}
confusion matrix:
       0      1
0  29073     74
1     28  29129
---- Validation: 
scalar performance:
{'acc': 0.97224736, 'precision': 0.79357547, 'recall': 0.6861269, 'specificity': 0.6861269, 'f1': 0.7267882, 'auroc': 0.8920556, 'binary_precision': 0.60742706, 'binary_recall': 0.38039866, 'binary_specificity': 0.99185514, 'binary_f1_score': 0.46782428}
confusion matrix:
       0    1
0  18023  148
1    373  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97996473, 'precision': 0.90565205, 'recall': 0.8032005, 'specificity': 0.8032005, 'f1': 0.8463602, 'auroc': 0.9101281, 'binary_precision': 0.82681566, 'binary_recall': 0.61157024, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.7030878}
confusion matrix:
      0    1
0  5966   31
1    94  148
new oracle model saved
early stop counter: 3
val acc:0.9722473621368408, best validation acc: 0.9722473621368408, corresponding to test acc:                         0.9692258238792419 / 0.9799647331237793
after epoch: 10,now: 2024-08-05 09:43:46.092834,epoch time: 0:26:01.472262,used: 4:19:15.355360,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_05_24_30_seed_2_24067119
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 4:19:15.355360 at 2024-08-05 09:43:46.092834
persisted model performance metric: 

scalar performance:
{'acc': 0.9692258, 'precision': 0.8958107, 'recall': 0.6310642, 'specificity': 0.6310642, 'f1': 0.692104, 'auroc': 0.92332274, 'binary_precision': 0.82051283, 'binary_recall': 0.2644628, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.4}
confusion matrix:
      0   1
0  5983  14
1   178  64
oracle model performance metric: 

scalar performance:
{'acc': 0.97996473, 'precision': 0.90565205, 'recall': 0.8032005, 'specificity': 0.8032005, 'f1': 0.8463602, 'auroc': 0.9101281, 'binary_precision': 0.82681566, 'binary_recall': 0.61157024, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.7030878}
confusion matrix:
      0    1
0  5966   31
1    94  148
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 481529 KiB |   1175 MiB | 649509 GiB | 649508 GiB |
|       from large pool | 394368 KiB |   1107 MiB | 646022 GiB | 646022 GiB |
|       from small pool |  87161 KiB |    122 MiB |   3486 GiB |   3486 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 481529 KiB |   1175 MiB | 649509 GiB | 649508 GiB |
|       from large pool | 394368 KiB |   1107 MiB | 646022 GiB | 646022 GiB |
|       from small pool |  87161 KiB |    122 MiB |   3486 GiB |   3486 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 473931 KiB |   1162 MiB | 644148 GiB | 644148 GiB |
|       from large pool | 387840 KiB |   1094 MiB | 640680 GiB | 640680 GiB |
|       from small pool |  86091 KiB |    121 MiB |   3467 GiB |   3467 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1446 MiB |   1446 MiB |   2386 MiB |    940 MiB |
|       from large pool |   1324 MiB |   1324 MiB |   2206 MiB |    882 MiB |
|       from small pool |    122 MiB |    124 MiB |    180 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 585478 KiB | 602902 KiB | 556500 GiB | 556499 GiB |
|       from large pool | 576384 KiB | 600704 KiB | 552518 GiB | 552517 GiB |
|       from small pool |   9094 KiB |  28150 KiB |   3982 GiB |   3982 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3618    |    8415    |  126072 K  |  126068 K  |
|       from large pool |      87    |     155    |   46480 K  |   46480 K  |
|       from small pool |    3531    |    8327    |   79592 K  |   79588 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3618    |    8415    |  126072 K  |  126068 K  |
|       from large pool |      87    |     155    |   46480 K  |   46480 K  |
|       from small pool |    3531    |    8327    |   79592 K  |   79588 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |      95    |     141    |      49    |
|       from large pool |      31    |      34    |      51    |      20    |
|       from small pool |      61    |      62    |      90    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      57    |    3678    |   60436 K  |   60436 K  |
|       from large pool |      25    |      32    |   25564 K  |   25564 K  |
|       from small pool |      32    |    3653    |   34871 K  |   34871 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1175 MiB | 649509 GiB | 649509 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 646022 GiB | 646022 GiB |
|       from small pool |      0 KiB |    122 MiB |   3486 GiB |   3486 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1175 MiB | 649509 GiB | 649509 GiB |
|       from large pool |  16640 KiB |   1107 MiB | 646022 GiB | 646022 GiB |
|       from small pool |      0 KiB |    122 MiB |   3486 GiB |   3486 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1162 MiB | 644148 GiB | 644148 GiB |
|       from large pool |  16640 KiB |   1094 MiB | 640680 GiB | 640680 GiB |
|       from small pool |      0 KiB |    121 MiB |   3467 GiB |   3467 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1042 MiB |   1446 MiB |   2386 MiB |   1344 MiB |
|       from large pool |    948 MiB |   1324 MiB |   2206 MiB |   1258 MiB |
|       from small pool |     94 MiB |    124 MiB |    180 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB | 638202 KiB | 556500 GiB | 556500 GiB |
|       from large pool |  50944 KiB | 621440 KiB | 552518 GiB | 552518 GiB |
|       from small pool |      0 KiB |  28150 KiB |   3982 GiB |   3982 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8415    |  126072 K  |  126072 K  |
|       from large pool |       2    |     155    |   46480 K  |   46480 K  |
|       from small pool |       0    |    8327    |   79592 K  |   79592 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8415    |  126072 K  |  126072 K  |
|       from large pool |       2    |     155    |   46480 K  |   46480 K  |
|       from small pool |       0    |    8327    |   79592 K  |   79592 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      73    |      95    |     141    |      68    |
|       from large pool |      26    |      34    |      51    |      25    |
|       from small pool |      47    |      62    |      90    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3678    |   60437 K  |   60437 K  |
|       from large pool |       4    |      32    |   25564 K  |   25564 K  |
|       from small pool |       0    |    3653    |   34873 K  |   34873 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 09:45:01 2024]
Finished job 0.
1 of 1 steps (100%) done
