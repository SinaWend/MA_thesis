Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 17:16:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116

 Experiment start at: 2024-08-04 17:30:20.509623
before training, model accuracy: 0.31048259139060974
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7520746, 'precision': 0.77200305, 'recall': 0.75195646, 'specificity': 0.75195646, 'f1': 0.7473903, 'auroc': 0.8540151, 'binary_precision': 0.69859594, 'binary_recall': 0.887476, 'binary_specificity': 0.6164369, 'binary_f1_score': 0.7817894}
confusion matrix:
       0      1
0  17664  10991
1   3230  25475
---- Validation: 
scalar performance:
{'acc': 0.53065133, 'precision': 0.5127745, 'recall': 0.59649956, 'specificity': 0.59649956, 'f1': 0.3862968, 'auroc': 0.6257798, 'binary_precision': 0.047482014, 'binary_recall': 0.66718507, 'binary_specificity': 0.5258141, 'binary_f1_score': 0.08865468}
confusion matrix:
      0     1
0  9543  8606
1   214   429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37599874, 'precision': 0.5161849, 'recall': 0.59196556, 'specificity': 0.59196556, 'f1': 0.3110829, 'auroc': 0.69100416, 'binary_precision': 0.05299313, 'binary_recall': 0.82758623, 'binary_specificity': 0.35634485, 'binary_f1_score': 0.09960803}
confusion matrix:
      0     1
0  2137  3860
1    45   216
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 17:44:05.674019,epoch time: 0:13:45.164396,used: 0:13:45.164396,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8196304, 'precision': 0.82919663, 'recall': 0.819568, 'specificity': 0.819568, 'f1': 0.81829023, 'auroc': 0.9111033, 'binary_precision': 0.77326185, 'binary_recall': 0.90484655, 'binary_specificity': 0.7342894, 'binary_f1_score': 0.8338952}
confusion matrix:
       0      1
0  21044   7615
1   2731  25970
---- Validation: 
scalar performance:
{'acc': 0.6189336, 'precision': 0.5117943, 'recall': 0.58445036, 'specificity': 0.58445036, 'f1': 0.42427677, 'auroc': 0.5869545, 'binary_precision': 0.048739962, 'binary_recall': 0.5474339, 'binary_specificity': 0.62146676, 'binary_f1_score': 0.089510486}
confusion matrix:
       0     1
0  11279  6870
1    291   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54873765, 'precision': 0.5201091, 'recall': 0.6252916, 'specificity': 0.6252916, 'f1': 0.40645146, 'auroc': 0.6915505, 'binary_precision': 0.06307535, 'binary_recall': 0.70881224, 'binary_specificity': 0.5417709, 'binary_f1_score': 0.1158422}
confusion matrix:
      0     1
0  3249  2748
1    76   185
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 17:54:04.810289,epoch time: 0:09:59.136270,used: 0:23:44.300666,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8484135, 'precision': 0.8555952, 'recall': 0.84835654, 'specificity': 0.84835654, 'f1': 0.84762937, 'auroc': 0.9379313, 'binary_precision': 0.8052606, 'binary_recall': 0.91941607, 'binary_specificity': 0.777297, 'binary_f1_score': 0.85856044}
confusion matrix:
       0      1
0  22275   6382
1   2313  26390
---- Validation: 
scalar performance:
{'acc': 0.6859302, 'precision': 0.52072054, 'recall': 0.6363867, 'specificity': 0.6363867, 'f1': 0.46097118, 'auroc': 0.65512455, 'binary_precision': 0.06240639, 'binary_recall': 0.58320373, 'binary_specificity': 0.68956965, 'binary_f1_score': 0.11274805}
confusion matrix:
       0     1
0  12515  5634
1    268   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6930329, 'precision': 0.5343637, 'recall': 0.6877529, 'specificity': 0.6877529, 'f1': 0.48436505, 'auroc': 0.7529905, 'binary_precision': 0.08829365, 'binary_recall': 0.68199235, 'binary_specificity': 0.69351345, 'binary_f1_score': 0.15634605}
confusion matrix:
      0     1
0  4159  1838
1    83   178
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 18:04:12.795654,epoch time: 0:10:07.985365,used: 0:33:52.286031,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.86715484, 'precision': 0.87325305, 'recall': 0.8671013, 'specificity': 0.8671013, 'f1': 0.8665979, 'auroc': 0.9495208, 'binary_precision': 0.82575244, 'binary_recall': 0.9309852, 'binary_specificity': 0.8032175, 'binary_f1_score': 0.87521696}
confusion matrix:
       0      1
0  23017   5639
1   1981  26723
---- Validation: 
scalar performance:
{'acc': 0.73094934, 'precision': 0.52351665, 'recall': 0.6409424, 'specificity': 0.6409424, 'f1': 0.4813792, 'auroc': 0.66994405, 'binary_precision': 0.06845296, 'binary_recall': 0.5443235, 'binary_specificity': 0.7375613, 'binary_f1_score': 0.12161223}
confusion matrix:
       0     1
0  13386  4763
1    293   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790029, 'precision': 0.54683065, 'recall': 0.7087883, 'specificity': 0.7087883, 'f1': 0.5323123, 'auroc': 0.7776404, 'binary_precision': 0.11363637, 'binary_recall': 0.6321839, 'binary_specificity': 0.7853927, 'binary_f1_score': 0.19264448}
confusion matrix:
      0     1
0  4710  1287
1    96   165
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 18:14:00.822932,epoch time: 0:09:48.027278,used: 0:43:40.313309,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8733961, 'precision': 0.8791182, 'recall': 0.873349, 'specificity': 0.873349, 'f1': 0.8729065, 'auroc': 0.9553137, 'binary_precision': 0.8327333, 'binary_recall': 0.9347432, 'binary_specificity': 0.8119548, 'binary_f1_score': 0.88079447}
confusion matrix:
       0      1
0  23269   5389
1   1873  26829
---- Validation: 
scalar performance:
{'acc': 0.7225415, 'precision': 0.5218946, 'recall': 0.63358927, 'specificity': 0.63358927, 'f1': 0.4762876, 'auroc': 0.6549151, 'binary_precision': 0.06574197, 'binary_recall': 0.5381026, 'binary_specificity': 0.72907597, 'binary_f1_score': 0.11716898}
confusion matrix:
       0     1
0  13232  4917
1    297   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7376158, 'precision': 0.5396999, 'recall': 0.6981882, 'specificity': 0.6981882, 'f1': 0.5082366, 'auroc': 0.76669943, 'binary_precision': 0.0992455, 'binary_recall': 0.6551724, 'binary_specificity': 0.74120396, 'binary_f1_score': 0.17237903}
confusion matrix:
      0     1
0  4445  1552
1    90   171
early stop counter: 1
val acc:0.7225415110588074, best validation acc: 0.730949342250824, corresponding to test acc:                         0.7790029048919678 / 0.7790029048919678
after epoch: 5,now: 2024-08-04 18:23:43.092937,epoch time: 0:09:42.270005,used: 0:53:22.583314,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.87836474, 'precision': 0.8799168, 'recall': 0.878338, 'specificity': 0.878338, 'f1': 0.87823486, 'auroc': 0.9517592, 'binary_precision': 0.855842, 'binary_recall': 0.9102564, 'binary_specificity': 0.8464196, 'binary_f1_score': 0.8822109}
confusion matrix:
       0      1
0  24255   4401
1   2576  26128
---- Validation: 
scalar performance:
{'acc': 0.76750743, 'precision': 0.5224209, 'recall': 0.6201161, 'specificity': 0.6201161, 'f1': 0.49287677, 'auroc': 0.6529139, 'binary_precision': 0.06875, 'binary_recall': 0.46189734, 'binary_specificity': 0.7783349, 'binary_f1_score': 0.11968568}
confusion matrix:
       0     1
0  14126  4023
1    346   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80041546, 'precision': 0.5466685, 'recall': 0.6906432, 'specificity': 0.6906432, 'f1': 0.5393823, 'auroc': 0.7483052, 'binary_precision': 0.115863144, 'binary_recall': 0.57088125, 'binary_specificity': 0.8104052, 'binary_f1_score': 0.1926309}
confusion matrix:
      0     1
0  4860  1137
1   112   149
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-04 18:33:29.386917,epoch time: 0:09:46.293980,used: 1:03:08.877294,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88947004, 'precision': 0.89013964, 'recall': 0.8894534, 'specificity': 0.8894534, 'f1': 0.88941956, 'auroc': 0.9596064, 'binary_precision': 0.87417597, 'binary_recall': 0.91011393, 'binary_specificity': 0.86879295, 'binary_f1_score': 0.89178306}
confusion matrix:
       0      1
0  24897   3760
1   2580  26123
---- Validation: 
scalar performance:
{'acc': 0.76484674, 'precision': 0.52706844, 'recall': 0.6479908, 'specificity': 0.6479908, 'f1': 0.49799958, 'auroc': 0.6935457, 'binary_precision': 0.07553957, 'binary_recall': 0.5225505, 'binary_specificity': 0.77343106, 'binary_f1_score': 0.13199763}
confusion matrix:
       0     1
0  14037  4112
1    307   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8037712, 'precision': 0.5516123, 'recall': 0.71071744, 'specificity': 0.71071744, 'f1': 0.54687524, 'auroc': 0.8035761, 'binary_precision': 0.123735406, 'binary_recall': 0.6091954, 'binary_specificity': 0.81223947, 'binary_f1_score': 0.20569211}
confusion matrix:
      0     1
0  4871  1126
1   102   159
new oracle model saved
early stop counter: 1
val acc:0.7648467421531677, best validation acc: 0.7675074338912964, corresponding to test acc:                         0.8004154562950134 / 0.8037711977958679
after epoch: 7,now: 2024-08-04 18:43:19.213748,epoch time: 0:09:49.826831,used: 1:12:58.704125,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.87724894, 'precision': 0.88599336, 'recall': 0.87719125, 'specificity': 0.87719125, 'f1': 0.8765379, 'auroc': 0.9626013, 'binary_precision': 0.8280876, 'binary_recall': 0.9524075, 'binary_specificity': 0.801975, 'binary_f1_score': 0.88590735}
confusion matrix:
       0      1
0  22983   5675
1   1366  27336
---- Validation: 
scalar performance:
{'acc': 0.7020541, 'precision': 0.52171683, 'recall': 0.63873386, 'specificity': 0.63873386, 'f1': 0.4683693, 'auroc': 0.66177106, 'binary_precision': 0.064499125, 'binary_recall': 0.57076204, 'binary_specificity': 0.70670563, 'binary_f1_score': 0.11590084}
confusion matrix:
       0     1
0  12826  5323
1    276   367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7077341, 'precision': 0.5357126, 'recall': 0.6899264, 'specificity': 0.6899264, 'f1': 0.4918435, 'auroc': 0.7645886, 'binary_precision': 0.091240875, 'binary_recall': 0.6704981, 'binary_specificity': 0.7093547, 'binary_f1_score': 0.16062415}
confusion matrix:
      0     1
0  4254  1743
1    86   175
early stop counter: 2
val acc:0.7020540833473206, best validation acc: 0.7675074338912964, corresponding to test acc:                         0.8004154562950134 / 0.8037711977958679
after epoch: 8,now: 2024-08-04 18:53:10.129995,epoch time: 0:09:50.916247,used: 1:22:49.620372,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8923989, 'precision': 0.89742255, 'recall': 0.8923539, 'specificity': 0.8923539, 'f1': 0.8920498, 'auroc': 0.9671404, 'binary_precision': 0.85294026, 'binary_recall': 0.94850713, 'binary_specificity': 0.8362006, 'binary_f1_score': 0.89818877}
confusion matrix:
       0      1
0  23963   4694
1   1478  27225
---- Validation: 
scalar performance:
{'acc': 0.7464346, 'precision': 0.5243255, 'recall': 0.63995874, 'specificity': 0.63995874, 'f1': 0.48799905, 'auroc': 0.67916906, 'binary_precision': 0.07044602, 'binary_recall': 0.525661, 'binary_specificity': 0.7542564, 'binary_f1_score': 0.12424187}
confusion matrix:
       0     1
0  13689  4460
1    305   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7821988, 'precision': 0.55131453, 'recall': 0.72877914, 'specificity': 0.72877914, 'f1': 0.5390756, 'auroc': 0.79608375, 'binary_precision': 0.120523416, 'binary_recall': 0.6704981, 'binary_specificity': 0.7870602, 'binary_f1_score': 0.20431991}
confusion matrix:
      0     1
0  4720  1277
1    86   175
early stop counter: 3
val acc:0.7464346289634705, best validation acc: 0.7675074338912964, corresponding to test acc:                         0.8004154562950134 / 0.8037711977958679
after epoch: 9,now: 2024-08-04 19:03:05.264256,epoch time: 0:09:55.134261,used: 1:32:44.754633,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9019177, 'precision': 0.904755, 'recall': 0.90189004, 'specificity': 0.90189004, 'f1': 0.9017411, 'auroc': 0.97122025, 'binary_precision': 0.87103206, 'binary_recall': 0.94369143, 'binary_specificity': 0.86008865, 'binary_f1_score': 0.90590715}
confusion matrix:
       0      1
0  24651   4010
1   1616  27083
---- Validation: 
scalar performance:
{'acc': 0.7147722, 'precision': 0.5263015, 'recall': 0.66481966, 'specificity': 0.66481966, 'f1': 0.47869688, 'auroc': 0.6991449, 'binary_precision': 0.07141559, 'binary_recall': 0.61119753, 'binary_specificity': 0.7184418, 'binary_f1_score': 0.12788805}
confusion matrix:
       0     1
0  13039  5110
1    250   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7356983, 'precision': 0.5479631, 'recall': 0.74482834, 'specificity': 0.74482834, 'f1': 0.5171887, 'auroc': 0.82511175, 'binary_precision': 0.11024062, 'binary_recall': 0.7547893, 'binary_specificity': 0.73486745, 'binary_f1_score': 0.1923828}
confusion matrix:
      0     1
0  4407  1590
1    64   197
early stop counter: 4
val acc:0.7147722244262695, best validation acc: 0.7675074338912964, corresponding to test acc:                         0.8004154562950134 / 0.8037711977958679
after epoch: 10,now: 2024-08-04 19:12:54.654099,epoch time: 0:09:49.389843,used: 1:42:34.144476,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8944386, 'precision': 0.89965177, 'recall': 0.8943929, 'specificity': 0.8943929, 'f1': 0.8940853, 'auroc': 0.9708367, 'binary_precision': 0.8542071, 'binary_recall': 0.95143366, 'binary_specificity': 0.83735216, 'binary_f1_score': 0.90020275}
confusion matrix:
       0      1
0  23996   4661
1   1394  27309
---- Validation: 
scalar performance:
{'acc': 0.7249361, 'precision': 0.52280545, 'recall': 0.63857937, 'specificity': 0.63857937, 'f1': 0.47828886, 'auroc': 0.6736994, 'binary_precision': 0.067138486, 'binary_recall': 0.5458787, 'binary_specificity': 0.73127997, 'binary_f1_score': 0.11957077}
confusion matrix:
       0     1
0  13272  4877
1    292   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7619048, 'precision': 0.55344766, 'recall': 0.7566695, 'specificity': 0.7566695, 'f1': 0.5340862, 'auroc': 0.8287362, 'binary_precision': 0.120913014, 'binary_recall': 0.75095785, 'binary_specificity': 0.7623812, 'binary_f1_score': 0.20828904}
confusion matrix:
      0     1
0  4572  1425
1    65   196
early stop counter: 5
val acc:0.7249361276626587, best validation acc: 0.7675074338912964, corresponding to test acc:                         0.8004154562950134 / 0.8037711977958679
after epoch: 11,now: 2024-08-04 19:22:44.401530,epoch time: 0:09:49.747431,used: 1:52:23.891907,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.90758365, 'precision': 0.9086199, 'recall': 0.9075627, 'specificity': 0.9075627, 'f1': 0.9075219, 'auroc': 0.97108066, 'binary_precision': 0.8882511, 'binary_recall': 0.9326575, 'binary_specificity': 0.88246787, 'binary_f1_score': 0.9099129}
confusion matrix:
       0      1
0  25288   3368
1   1933  26771
---- Validation: 
scalar performance:
{'acc': 0.78027886, 'precision': 0.52897775, 'recall': 0.65072984, 'specificity': 0.65072984, 'f1': 0.50578, 'auroc': 0.69137144, 'binary_precision': 0.07939189, 'binary_recall': 0.5116641, 'binary_specificity': 0.7897956, 'binary_f1_score': 0.1374556}
confusion matrix:
       0     1
0  14334  3815
1    314   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81527644, 'precision': 0.5578099, 'recall': 0.7277144, 'specificity': 0.7277144, 'f1': 0.5586338, 'auroc': 0.80655396, 'binary_precision': 0.13469388, 'binary_recall': 0.6321839, 'binary_specificity': 0.8232449, 'binary_f1_score': 0.22207268}
confusion matrix:
      0     1
0  4937  1060
1    96   165
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-04 19:32:30.111684,epoch time: 0:09:45.710154,used: 2:02:09.602061,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91698045, 'precision': 0.9173453, 'recall': 0.9169677, 'specificity': 0.9169677, 'f1': 0.9169606, 'auroc': 0.97475076, 'binary_precision': 0.9052229, 'binary_recall': 0.93164957, 'binary_specificity': 0.9022858, 'binary_f1_score': 0.91824615}
confusion matrix:
       0      1
0  25855   2800
1   1962  26743
---- Validation: 
scalar performance:
{'acc': 0.8197637, 'precision': 0.5351317, 'recall': 0.6561706, 'specificity': 0.6561706, 'f1': 0.5267203, 'auroc': 0.72439647, 'binary_precision': 0.09190958, 'binary_recall': 0.4805599, 'binary_specificity': 0.8317814, 'binary_f1_score': 0.15430713}
confusion matrix:
       0     1
0  15096  3053
1    334   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8552253, 'precision': 0.57976943, 'recall': 0.7668815, 'specificity': 0.7668815, 'f1': 0.5991003, 'auroc': 0.8419625, 'binary_precision': 0.1758794, 'binary_recall': 0.6704981, 'binary_specificity': 0.863265, 'binary_f1_score': 0.2786624}
confusion matrix:
      0    1
0  5177  820
1    86  175
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-08-04 19:42:12.854557,epoch time: 0:09:42.742873,used: 2:11:52.344934,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91912484, 'precision': 0.91916525, 'recall': 0.91912115, 'specificity': 0.91912115, 'f1': 0.91912234, 'auroc': 0.9754809, 'binary_precision': 0.91523725, 'binary_recall': 0.92394257, 'binary_specificity': 0.91429967, 'binary_f1_score': 0.9195693}
confusion matrix:
       0      1
0  26202   2456
1   2183  26519
---- Validation: 
scalar performance:
{'acc': 0.8286505, 'precision': 0.5336792, 'recall': 0.64202005, 'specificity': 0.64202005, 'f1': 0.5273348, 'auroc': 0.71301866, 'binary_precision': 0.090302065, 'binary_recall': 0.44167963, 'binary_specificity': 0.84236044, 'binary_f1_score': 0.1499472}
confusion matrix:
       0     1
0  15288  2861
1    359   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8539469, 'precision': 0.5673345, 'recall': 0.7167415, 'specificity': 0.7167415, 'f1': 0.581893, 'auroc': 0.8024204, 'binary_precision': 0.15595363, 'binary_recall': 0.5670498, 'binary_specificity': 0.8664332, 'binary_f1_score': 0.24462809}
confusion matrix:
      0    1
0  5196  801
1   113  148
better model found
persisted
after epoch: 14,now: 2024-08-04 19:51:59.611998,epoch time: 0:09:46.757441,used: 2:21:39.102375,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9169282, 'precision': 0.9172604, 'recall': 0.9169179, 'specificity': 0.9169179, 'f1': 0.91691023, 'auroc': 0.97504187, 'binary_precision': 0.9056674, 'binary_recall': 0.9309432, 'binary_specificity': 0.90289265, 'binary_f1_score': 0.9181314}
confusion matrix:
       0      1
0  25876   2783
1   1982  26719
---- Validation: 
scalar performance:
{'acc': 0.82503194, 'precision': 0.53011435, 'recall': 0.6281458, 'specificity': 0.6281458, 'f1': 0.52138704, 'auroc': 0.7134467, 'binary_precision': 0.084250234, 'binary_recall': 0.41679627, 'binary_specificity': 0.8394953, 'binary_f1_score': 0.14016737}
confusion matrix:
       0     1
0  15236  2913
1    375   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85650367, 'precision': 0.570515, 'recall': 0.72540486, 'specificity': 0.72540486, 'f1': 0.58677053, 'auroc': 0.8082247, 'binary_precision': 0.16153029, 'binary_recall': 0.58237547, 'binary_specificity': 0.8684342, 'binary_f1_score': 0.2529118}
confusion matrix:
      0    1
0  5208  789
1   109  152
new oracle model saved
early stop counter: 1
val acc:0.8250319361686707, best validation acc: 0.8286504745483398, corresponding to test acc:                         0.8539469242095947 / 0.8565036654472351
after epoch: 15,now: 2024-08-04 20:01:43.763386,epoch time: 0:09:44.151388,used: 2:31:23.253763,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:31:23.253763 at 2024-08-04 20:01:43.763386
persisted model performance metric: 

scalar performance:
{'acc': 0.8539469, 'precision': 0.5673345, 'recall': 0.7167415, 'specificity': 0.7167415, 'f1': 0.581893, 'auroc': 0.8024204, 'binary_precision': 0.15595363, 'binary_recall': 0.5670498, 'binary_specificity': 0.8664332, 'binary_f1_score': 0.24462809}
confusion matrix:
      0    1
0  5196  801
1   113  148
oracle model performance metric: 

scalar performance:
{'acc': 0.85650367, 'precision': 0.570515, 'recall': 0.72540486, 'specificity': 0.72540486, 'f1': 0.58677053, 'auroc': 0.8082247, 'binary_precision': 0.16153029, 'binary_recall': 0.58237547, 'binary_specificity': 0.8684342, 'binary_f1_score': 0.2529118}
confusion matrix:
      0    1
0  5208  789
1   109  152
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 253875 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool | 216832 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 253875 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool | 216832 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 249984 KiB | 656104 KiB | 329570 GiB | 329569 GiB |
|       from large pool | 214016 KiB | 584512 KiB | 329440 GiB | 329440 GiB |
|       from small pool |  35968 KiB |  74336 KiB |    129 GiB |    129 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    808 MiB |    808 MiB |    808 MiB |      0 B   |
|       from large pool |    734 MiB |    734 MiB |    734 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  71756 KiB | 236211 KiB | 193575 GiB | 193574 GiB |
|       from large pool |  59648 KiB | 231040 KiB | 193429 GiB | 193429 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    145 GiB |    145 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7939    |   43511 K  |   43508 K  |
|       from large pool |      36    |      76    |   15797 K  |   15797 K  |
|       from small pool |    3216    |    7901    |   27714 K  |   27711 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7939    |   43511 K  |   43508 K  |
|       from large pool |      36    |      76    |   15797 K  |   15797 K  |
|       from small pool |    3216    |    7901    |   27714 K  |   27711 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      54    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3601    |   21817 K  |   21817 K  |
|       from large pool |       6    |      12    |    7767 K  |    7767 K  |
|       from small pool |      46    |    3595    |   14050 K  |   14050 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |      0 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |      0 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 329570 GiB | 329570 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 329440 GiB | 329440 GiB |
|       from small pool |      0 KiB |  74336 KiB |    129 GiB |    129 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 325632 KiB |    808 MiB |    808 MiB | 501760 KiB |
|       from large pool | 276480 KiB |    734 MiB |    734 MiB | 475136 KiB |
|       from small pool |  49152 KiB |     74 MiB |     74 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 236211 KiB | 193575 GiB | 193575 GiB |
|       from large pool |  47104 KiB | 231040 KiB | 193430 GiB | 193429 GiB |
|       from small pool |      0 KiB |  19703 KiB |    145 GiB |    145 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   43511 K  |   43511 K  |
|       from large pool |       2    |      76    |   15797 K  |   15797 K  |
|       from small pool |       0    |    7901    |   27714 K  |   27714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   43511 K  |   43511 K  |
|       from large pool |       2    |      76    |   15797 K  |   15797 K  |
|       from small pool |       0    |    7901    |   27714 K  |   27714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      54    |      54    |      20    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3601    |   21818 K  |   21818 K  |
|       from large pool |       2    |      12    |    7767 K  |    7767 K  |
|       from small pool |       0    |    3595    |   14051 K  |   14051 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |      0 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |      0 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 329570 GiB | 329570 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 329440 GiB | 329440 GiB |
|       from small pool |      0 KiB |  74336 KiB |    129 GiB |    129 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 325632 KiB |    808 MiB |    808 MiB | 501760 KiB |
|       from large pool | 276480 KiB |    734 MiB |    734 MiB | 475136 KiB |
|       from small pool |  49152 KiB |     74 MiB |     74 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 236211 KiB | 193575 GiB | 193575 GiB |
|       from large pool |  47104 KiB | 231040 KiB | 193430 GiB | 193429 GiB |
|       from small pool |      0 KiB |  19703 KiB |    145 GiB |    145 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   43511 K  |   43511 K  |
|       from large pool |       2    |      76    |   15797 K  |   15797 K  |
|       from small pool |       0    |    7901    |   27714 K  |   27714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   43511 K  |   43511 K  |
|       from large pool |       2    |      76    |   15797 K  |   15797 K  |
|       from small pool |       0    |    7901    |   27714 K  |   27714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      54    |      54    |      20    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3601    |   21818 K  |   21818 K  |
|       from large pool |       2    |      12    |    7767 K  |    7767 K  |
|       from small pool |       0    |    3595    |   14051 K  |   14051 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116

 Experiment start at: 2024-08-04 20:09:38.579024
before training, model accuracy: 0.14582662284374237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6588621, 'precision': 0.6921761, 'recall': 0.65870285, 'specificity': 0.65870285, 'f1': 0.64327145, 'auroc': 0.77420104, 'binary_precision': 0.6123534, 'binary_recall': 0.86725634, 'binary_specificity': 0.4501494, 'binary_f1_score': 0.7178479}
confusion matrix:
       0      1
0  12958  15828
1   3827  25003
---- Validation: 
scalar performance:
{'acc': 0.36702242, 'precision': 0.49030164, 'recall': 0.43496844, 'specificity': 0.43496844, 'f1': 0.28939173, 'auroc': 0.40057892, 'binary_precision': 0.028804852, 'binary_recall': 0.50817233, 'binary_specificity': 0.36176455, 'binary_f1_score': 0.05451937}
confusion matrix:
      0      1
0  6536  11531
1   331    342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3996133, 'precision': 0.48184186, 'recall': 0.39060324, 'specificity': 0.39060324, 'f1': 0.30574304, 'auroc': 0.36547148, 'binary_precision': 0.02701965, 'binary_recall': 0.38076922, 'binary_specificity': 0.40043727, 'binary_f1_score': 0.05045871}
confusion matrix:
      0     1
0  2381  3565
1   161    99
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 20:21:30.230847,epoch time: 0:11:51.651823,used: 0:11:51.651823,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7835844, 'precision': 0.8049348, 'recall': 0.7834879, 'specificity': 0.7834879, 'f1': 0.7796893, 'auroc': 0.8975288, 'binary_precision': 0.7244293, 'binary_recall': 0.9158833, 'binary_specificity': 0.6510925, 'binary_f1_score': 0.8089832}
confusion matrix:
       0      1
0  18743  10044
1   2425  26404
---- Validation: 
scalar performance:
{'acc': 0.5516009, 'precision': 0.50119436, 'recall': 0.50852215, 'specificity': 0.50852215, 'f1': 0.38680562, 'auroc': 0.50723946, 'binary_precision': 0.03723659, 'binary_recall': 0.46210995, 'binary_specificity': 0.5549344, 'binary_f1_score': 0.068919666}
confusion matrix:
       0     1
0  10026  8041
1    362   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6551724, 'precision': 0.5273092, 'recall': 0.65637726, 'specificity': 0.65637726, 'f1': 0.46114177, 'auroc': 0.6953676, 'binary_precision': 0.076957695, 'binary_recall': 0.6576923, 'binary_specificity': 0.6550622, 'binary_f1_score': 0.1377921}
confusion matrix:
      0     1
0  3895  2051
1    89   171
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 20:31:17.457519,epoch time: 0:09:47.226672,used: 0:21:38.878495,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.825604, 'precision': 0.8364469, 'recall': 0.8255354, 'specificity': 0.8255354, 'f1': 0.82416624, 'auroc': 0.92496645, 'binary_precision': 0.7762384, 'binary_recall': 0.91533124, 'binary_specificity': 0.7357396, 'binary_f1_score': 0.84006625}
confusion matrix:
       0      1
0  21179   7607
1   2441  26389
---- Validation: 
scalar performance:
{'acc': 0.6257737, 'precision': 0.50833404, 'recall': 0.5562886, 'specificity': 0.5562886, 'f1': 0.4246993, 'auroc': 0.5578362, 'binary_precision': 0.046365198, 'binary_recall': 0.48142645, 'binary_specificity': 0.6311507, 'binary_f1_score': 0.084584266}
confusion matrix:
       0     1
0  11403  6664
1    349   324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66951334, 'precision': 0.53446484, 'recall': 0.69512403, 'specificity': 0.69512403, 'f1': 0.47475782, 'auroc': 0.7304785, 'binary_precision': 0.08675589, 'binary_recall': 0.72307694, 'binary_specificity': 0.6671712, 'binary_f1_score': 0.1549238}
confusion matrix:
      0     1
0  3967  1979
1    72   188
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 20:41:07.248019,epoch time: 0:09:49.790500,used: 0:31:28.668995,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.84535545, 'precision': 0.8454529, 'recall': 0.8453491, 'specificity': 0.8453491, 'f1': 0.8453428, 'auroc': 0.9268141, 'binary_precision': 0.8398389, 'binary_recall': 0.85376346, 'binary_specificity': 0.8369346, 'binary_f1_score': 0.846744}
confusion matrix:
       0      1
0  24092   4694
1   4216  24614
---- Validation: 
scalar performance:
{'acc': 0.77481323, 'precision': 0.51166254, 'recall': 0.55633533, 'specificity': 0.55633533, 'f1': 0.4821572, 'auroc': 0.59678596, 'binary_precision': 0.054284997, 'binary_recall': 0.32095096, 'binary_specificity': 0.79171973, 'binary_f1_score': 0.092863284}
confusion matrix:
       0     1
0  14304  3763
1    457   216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.810506, 'precision': 0.5461367, 'recall': 0.67859256, 'specificity': 0.67859256, 'f1': 0.5419389, 'auroc': 0.7412383, 'binary_precision': 0.11641541, 'binary_recall': 0.5346154, 'binary_specificity': 0.8225698, 'binary_f1_score': 0.19119671}
confusion matrix:
      0     1
0  4891  1055
1   121   139
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 20:50:57.527296,epoch time: 0:09:50.279277,used: 0:41:18.948272,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8682831, 'precision': 0.87097394, 'recall': 0.8682536, 'specificity': 0.8682536, 'f1': 0.8680373, 'auroc': 0.94653404, 'binary_precision': 0.83955234, 'binary_recall': 0.9108159, 'binary_specificity': 0.8256913, 'binary_f1_score': 0.87373346}
confusion matrix:
       0      1
0  23770   5018
1   2571  26257
---- Validation: 
scalar performance:
{'acc': 0.7364995, 'precision': 0.52059877, 'recall': 0.61514425, 'specificity': 0.61514425, 'f1': 0.48089606, 'auroc': 0.6406917, 'binary_precision': 0.06630059, 'binary_recall': 0.48439822, 'binary_specificity': 0.7458903, 'binary_f1_score': 0.11663685}
confusion matrix:
       0     1
0  13476  4591
1    347   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.810506, 'precision': 0.55267155, 'recall': 0.7080164, 'specificity': 0.7080164, 'f1': 0.55049026, 'auroc': 0.76947963, 'binary_precision': 0.12642741, 'binary_recall': 0.59615386, 'binary_specificity': 0.81987894, 'binary_f1_score': 0.20861375}
confusion matrix:
      0     1
0  4875  1071
1   105   155
early stop counter: 1
val acc:0.7364994883537292, best validation acc: 0.7748132348060608, corresponding to test acc:                         0.8105059862136841 / 0.8105059862136841
after epoch: 5,now: 2024-08-04 21:00:48.111157,epoch time: 0:09:50.583861,used: 0:51:09.532133,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.872952, 'precision': 0.8741243, 'recall': 0.87293255, 'specificity': 0.87293255, 'f1': 0.87284815, 'auroc': 0.94834626, 'binary_precision': 0.8533548, 'binary_recall': 0.90089494, 'binary_specificity': 0.8449701, 'binary_f1_score': 0.8764807}
confusion matrix:
       0      1
0  24325   4463
1   2857  25971
---- Validation: 
scalar performance:
{'acc': 0.7720384, 'precision': 0.5204583, 'recall': 0.6021039, 'specificity': 0.6021039, 'f1': 0.49287948, 'auroc': 0.6439558, 'binary_precision': 0.06773961, 'binary_recall': 0.4190193, 'binary_specificity': 0.78518844, 'binary_f1_score': 0.11662532}
confusion matrix:
       0     1
0  14186  3881
1    391   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8209797, 'precision': 0.5542804, 'recall': 0.7042873, 'specificity': 0.7042873, 'f1': 0.5558122, 'auroc': 0.7630676, 'binary_precision': 0.13032146, 'binary_recall': 0.5769231, 'binary_specificity': 0.8316515, 'binary_f1_score': 0.21261516}
confusion matrix:
      0     1
0  4945  1001
1   110   150
new oracle model saved
early stop counter: 2
val acc:0.7720384001731873, best validation acc: 0.7748132348060608, corresponding to test acc:                         0.8105059862136841 / 0.8209797143936157
after epoch: 6,now: 2024-08-04 21:10:30.541451,epoch time: 0:09:42.430294,used: 1:00:51.962427,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8777423, 'precision': 0.8779793, 'recall': 0.87773275, 'specificity': 0.87773275, 'f1': 0.8777211, 'auroc': 0.95129704, 'binary_precision': 0.8687043, 'binary_recall': 0.8902185, 'binary_specificity': 0.865247, 'binary_f1_score': 0.8793298}
confusion matrix:
       0      1
0  24907   3879
1   3165  25665
---- Validation: 
scalar performance:
{'acc': 0.7864461, 'precision': 0.5095466, 'recall': 0.5437715, 'specificity': 0.5437715, 'f1': 0.48290238, 'auroc': 0.6065395, 'binary_precision': 0.051226746, 'binary_recall': 0.28231797, 'binary_specificity': 0.805225, 'binary_f1_score': 0.086718395}
confusion matrix:
       0     1
0  14548  3519
1    483   190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8222688, 'precision': 0.55138266, 'recall': 0.69024813, 'specificity': 0.69024813, 'f1': 0.55235654, 'auroc': 0.7294755, 'binary_precision': 0.12599823, 'binary_recall': 0.54615384, 'binary_specificity': 0.8343424, 'binary_f1_score': 0.2047585}
confusion matrix:
      0    1
0  4961  985
1   118  142
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-04 21:20:14.361591,epoch time: 0:09:43.820140,used: 1:10:35.782567,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.88815606, 'precision': 0.88816786, 'recall': 0.8881541, 'specificity': 0.8881541, 'f1': 0.8881548, 'auroc': 0.95927614, 'binary_precision': 0.8862013, 'binary_recall': 0.8908738, 'binary_specificity': 0.8854344, 'binary_f1_score': 0.8885314}
confusion matrix:
       0      1
0  25489   3298
1   3146  25683
---- Validation: 
scalar performance:
{'acc': 0.8218783, 'precision': 0.52607834, 'recall': 0.6057788, 'specificity': 0.6057788, 'f1': 0.515751, 'auroc': 0.6829965, 'binary_precision': 0.07925481, 'binary_recall': 0.3729569, 'binary_specificity': 0.83860075, 'binary_f1_score': 0.13072917}
confusion matrix:
       0     1
0  15151  2916
1    422   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.863358, 'precision': 0.5703609, 'recall': 0.71169114, 'specificity': 0.71169114, 'f1': 0.5878531, 'auroc': 0.7865656, 'binary_precision': 0.16284403, 'binary_recall': 0.54615384, 'binary_specificity': 0.8772284, 'binary_f1_score': 0.2508834}
confusion matrix:
      0    1
0  5216  730
1   118  142
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-04 21:30:07.265706,epoch time: 0:09:52.904115,used: 1:20:28.686682,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8930332, 'precision': 0.893876, 'recall': 0.89301634, 'specificity': 0.89301634, 'f1': 0.89297295, 'auroc': 0.96213573, 'binary_precision': 0.8758374, 'binary_recall': 0.91609144, 'binary_specificity': 0.8699413, 'binary_f1_score': 0.8955123}
confusion matrix:
       0      1
0  25043   3744
1   2419  26410
---- Validation: 
scalar performance:
{'acc': 0.7975454, 'precision': 0.5188717, 'recall': 0.58457595, 'specificity': 0.58457595, 'f1': 0.4988209, 'auroc': 0.65532523, 'binary_precision': 0.06640734, 'binary_recall': 0.3551263, 'binary_specificity': 0.8140256, 'binary_f1_score': 0.11189138}
confusion matrix:
       0     1
0  14707  3360
1    434   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8382211, 'precision': 0.5658856, 'recall': 0.73351383, 'specificity': 0.73351383, 'f1': 0.57613546, 'auroc': 0.8024105, 'binary_precision': 0.1510319, 'binary_recall': 0.61923075, 'binary_specificity': 0.84779686, 'binary_f1_score': 0.24283558}
confusion matrix:
      0    1
0  5041  905
1    99  161
early stop counter: 1
val acc:0.7975453734397888, best validation acc: 0.8218783140182495, corresponding to test acc:                         0.8633580207824707 / 0.8633580207824707
after epoch: 9,now: 2024-08-04 21:40:04.570691,epoch time: 0:09:57.304985,used: 1:30:25.991667,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90101707, 'precision': 0.904034, 'recall': 0.90098417, 'specificity': 0.90098417, 'f1': 0.90082663, 'auroc': 0.9716035, 'binary_precision': 0.8693111, 'binary_recall': 0.9441207, 'binary_specificity': 0.8578476, 'binary_f1_score': 0.9051729}
confusion matrix:
       0      1
0  24694   4092
1   1611  27219
---- Validation: 
scalar performance:
{'acc': 0.7428495, 'precision': 0.5243659, 'recall': 0.63488865, 'specificity': 0.63488865, 'f1': 0.48787498, 'auroc': 0.68002725, 'binary_precision': 0.0720479, 'binary_recall': 0.5185735, 'binary_specificity': 0.75120384, 'binary_f1_score': 0.12651804}
confusion matrix:
       0     1
0  13572  4495
1    324   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7885917, 'precision': 0.5582918, 'recall': 0.7572667, 'specificity': 0.7572667, 'f1': 0.5502032, 'auroc': 0.8225459, 'binary_precision': 0.13165267, 'binary_recall': 0.72307694, 'binary_specificity': 0.79145646, 'binary_f1_score': 0.22274883}
confusion matrix:
      0     1
0  4706  1240
1    72   188
early stop counter: 2
val acc:0.7428495287895203, best validation acc: 0.8218783140182495, corresponding to test acc:                         0.8633580207824707 / 0.8633580207824707
after epoch: 10,now: 2024-08-04 21:49:57.650936,epoch time: 0:09:53.080245,used: 1:40:19.071912,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9023882, 'precision': 0.9037541, 'recall': 0.90236807, 'specificity': 0.90236807, 'f1': 0.9023024, 'auroc': 0.9685817, 'binary_precision': 0.88044333, 'binary_recall': 0.9313862, 'binary_specificity': 0.87335, 'binary_f1_score': 0.9051986}
confusion matrix:
       0      1
0  25142   3646
1   1978  26850
---- Validation: 
scalar performance:
{'acc': 0.78820705, 'precision': 0.5295574, 'recall': 0.6419611, 'specificity': 0.6419611, 'f1': 0.5101531, 'auroc': 0.68568456, 'binary_precision': 0.08257346, 'binary_recall': 0.48439822, 'binary_specificity': 0.799524, 'binary_f1_score': 0.141095}
confusion matrix:
       0     1
0  14445  3622
1    347   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83580405, 'precision': 0.5681224, 'recall': 0.74696434, 'specificity': 0.74696434, 'f1': 0.57845163, 'auroc': 0.8192036, 'binary_precision': 0.15405652, 'binary_recall': 0.65, 'binary_specificity': 0.8439287, 'binary_f1_score': 0.24907884}
confusion matrix:
      0    1
0  5018  928
1    91  169
early stop counter: 3
val acc:0.7882070541381836, best validation acc: 0.8218783140182495, corresponding to test acc:                         0.8633580207824707 / 0.8633580207824707
after epoch: 11,now: 2024-08-04 21:59:32.851676,epoch time: 0:09:35.200740,used: 1:49:54.272652,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.90868855, 'precision': 0.9087076, 'recall': 0.90868616, 'specificity': 0.90868616, 'f1': 0.9086871, 'auroc': 0.97040045, 'binary_precision': 0.90609276, 'binary_recall': 0.912033, 'binary_specificity': 0.90533924, 'binary_f1_score': 0.9090532}
confusion matrix:
       0      1
0  26062   2725
1   2536  26293
---- Validation: 
scalar performance:
{'acc': 0.80186766, 'precision': 0.5266515, 'recall': 0.61971986, 'specificity': 0.61971986, 'f1': 0.5106184, 'auroc': 0.68559635, 'binary_precision': 0.078947365, 'binary_recall': 0.42347696, 'binary_specificity': 0.8159628, 'binary_f1_score': 0.13308427}
confusion matrix:
       0     1
0  14742  3325
1    388   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83628744, 'precision': 0.56460285, 'recall': 0.73066574, 'specificity': 0.73066574, 'f1': 0.5738956, 'auroc': 0.7982606, 'binary_precision': 0.14869888, 'binary_recall': 0.61538464, 'binary_specificity': 0.84594685, 'binary_f1_score': 0.23952097}
confusion matrix:
      0    1
0  5030  916
1   100  160
early stop counter: 4
val acc:0.801867663860321, best validation acc: 0.8218783140182495, corresponding to test acc:                         0.8633580207824707 / 0.8633580207824707
after epoch: 12,now: 2024-08-04 22:09:24.950151,epoch time: 0:09:52.098475,used: 1:59:46.371127,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.890638, 'precision': 0.899143, 'recall': 0.8905823, 'specificity': 0.8905823, 'f1': 0.89004225, 'auroc': 0.97331965, 'binary_precision': 0.8410694, 'binary_recall': 0.9635102, 'binary_specificity': 0.81765443, 'binary_f1_score': 0.898136}
confusion matrix:
       0      1
0  23537   5249
1   1052  27778
---- Validation: 
scalar performance:
{'acc': 0.7229456, 'precision': 0.5298473, 'recall': 0.6760652, 'specificity': 0.6760652, 'f1': 0.48721707, 'auroc': 0.70798355, 'binary_precision': 0.078530125, 'binary_recall': 0.6255572, 'binary_specificity': 0.7265733, 'binary_f1_score': 0.13954258}
confusion matrix:
       0     1
0  13127  4940
1    252   421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76345474, 'precision': 0.5566808, 'recall': 0.7717334, 'specificity': 0.7717334, 'f1': 0.53867173, 'auroc': 0.84036386, 'binary_precision': 0.12577447, 'binary_recall': 0.7807692, 'binary_specificity': 0.76269764, 'binary_f1_score': 0.21664886}
confusion matrix:
      0     1
0  4535  1411
1    57   203
early stop counter: 5
val acc:0.7229455709457397, best validation acc: 0.8218783140182495, corresponding to test acc:                         0.8633580207824707 / 0.8633580207824707
after epoch: 13,now: 2024-08-04 22:19:32.250755,epoch time: 0:10:07.300604,used: 2:09:53.671731,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91740143, 'precision': 0.91751695, 'recall': 0.9173954, 'specificity': 0.9173954, 'f1': 0.9173949, 'auroc': 0.9746487, 'binary_precision': 0.91075087, 'binary_recall': 0.92563045, 'binary_specificity': 0.9091604, 'binary_f1_score': 0.91813034}
confusion matrix:
       0      1
0  26172   2615
1   2144  26685
---- Validation: 
scalar performance:
{'acc': 0.81712914, 'precision': 0.53214073, 'recall': 0.6362181, 'specificity': 0.6362181, 'f1': 0.5226503, 'auroc': 0.70014423, 'binary_precision': 0.088709675, 'binary_recall': 0.44130757, 'binary_specificity': 0.8311286, 'binary_f1_score': 0.14772445}
confusion matrix:
       0     1
0  15016  3051
1    376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8499839, 'precision': 0.5732918, 'recall': 0.7470083, 'specificity': 0.7470083, 'f1': 0.5891034, 'auroc': 0.82417715, 'binary_precision': 0.16483517, 'binary_recall': 0.63461536, 'binary_specificity': 0.8594013, 'binary_f1_score': 0.26169708}
confusion matrix:
      0    1
0  5110  836
1    95  165
early stop counter: 6
val acc:0.8171291351318359, best validation acc: 0.8218783140182495, corresponding to test acc:                         0.8633580207824707 / 0.8633580207824707
after epoch: 14,now: 2024-08-04 22:29:24.089363,epoch time: 0:09:51.838608,used: 2:19:45.510339,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.90967786, 'precision': 0.91277623, 'recall': 0.9096478, 'specificity': 0.9096478, 'f1': 0.90950364, 'auroc': 0.97597945, 'binary_precision': 0.8771874, 'binary_recall': 0.952893, 'binary_specificity': 0.8664027, 'binary_f1_score': 0.9134743}
confusion matrix:
       0      1
0  24942   3846
1   1358  27470
---- Validation: 
scalar performance:
{'acc': 0.7350587, 'precision': 0.524754, 'recall': 0.6401466, 'specificity': 0.6401466, 'f1': 0.4855434, 'auroc': 0.68577397, 'binary_precision': 0.07216906, 'binary_recall': 0.53789, 'binary_specificity': 0.74240327, 'binary_f1_score': 0.12726313}
confusion matrix:
       0     1
0  13413  4654
1    311   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7649049, 'precision': 0.5580595, 'recall': 0.77800715, 'specificity': 0.77800715, 'f1': 0.5408956, 'auroc': 0.86131525, 'binary_precision': 0.12787089, 'binary_recall': 0.7923077, 'binary_specificity': 0.7637067, 'binary_f1_score': 0.2202031}
confusion matrix:
      0     1
0  4541  1405
1    54   206
early stop counter: 7
val acc:0.7350587248802185, best validation acc: 0.8218783140182495, corresponding to test acc:                         0.8633580207824707 / 0.8633580207824707
after epoch: 15,now: 2024-08-04 22:40:49.071395,epoch time: 0:11:24.982032,used: 2:31:10.492371,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_09_38_seed_1_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:31:10.492371 at 2024-08-04 22:40:49.071395
persisted model performance metric: 

scalar performance:
{'acc': 0.863358, 'precision': 0.5703609, 'recall': 0.71169114, 'specificity': 0.71169114, 'f1': 0.5878531, 'auroc': 0.7865656, 'binary_precision': 0.16284403, 'binary_recall': 0.54615384, 'binary_specificity': 0.8772284, 'binary_f1_score': 0.2508834}
confusion matrix:
      0    1
0  5216  730
1   118  142
oracle model performance metric: 

scalar performance:
{'acc': 0.863358, 'precision': 0.5703609, 'recall': 0.71169114, 'specificity': 0.71169114, 'f1': 0.5878531, 'auroc': 0.7865656, 'binary_precision': 0.16284403, 'binary_recall': 0.54615384, 'binary_specificity': 0.8772284, 'binary_f1_score': 0.2508834}
confusion matrix:
      0    1
0  5216  730
1   118  142
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 255143 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool | 218112 KiB | 591936 KiB | 663735 GiB | 663735 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 255143 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool | 218112 KiB | 591936 KiB | 663735 GiB | 663735 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 249982 KiB | 656104 KiB | 662038 GiB | 662037 GiB |
|       from large pool | 214016 KiB | 584512 KiB | 661778 GiB | 661777 GiB |
|       from small pool |  35966 KiB |  74336 KiB |    260 GiB |    260 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 768000 KiB |    808 MiB |   1240 MiB | 501760 KiB |
|       from large pool | 692224 KiB |    734 MiB |   1140 MiB | 475136 KiB |
|       from small pool |  75776 KiB |     74 MiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  52056 KiB | 251573 KiB | 366799 GiB | 366799 GiB |
|       from large pool |  37888 KiB | 250176 KiB | 366511 GiB | 366511 GiB |
|       from small pool |  14168 KiB |  19703 KiB |    287 GiB |    287 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7971    |   87323 K  |   87319 K  |
|       from large pool |      36    |      76    |   31734 K  |   31734 K  |
|       from small pool |    3192    |    7933    |   55588 K  |   55585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7971    |   87323 K  |   87319 K  |
|       from large pool |      36    |      76    |   31734 K  |   31734 K  |
|       from small pool |    3192    |    7933    |   55588 K  |   55585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      54    |      73    |      20    |
|       from large pool |      16    |      17    |      23    |       7    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    3615    |   45251 K  |   45251 K  |
|       from large pool |       4    |      12    |   17024 K  |   17024 K  |
|       from small pool |      49    |    3610    |   28227 K  |   28227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 663735 GiB | 663735 GiB |
|       from small pool |      0 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 663735 GiB | 663735 GiB |
|       from small pool |      0 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 662038 GiB | 662038 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 661778 GiB | 661777 GiB |
|       from small pool |      0 KiB |  74336 KiB |    260 GiB |    260 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 307200 KiB |    808 MiB |   1240 MiB |    940 MiB |
|       from large pool | 256000 KiB |    734 MiB |   1140 MiB |    890 MiB |
|       from small pool |  51200 KiB |     74 MiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 251573 KiB | 366799 GiB | 366799 GiB |
|       from large pool |  47104 KiB | 250176 KiB | 366511 GiB | 366511 GiB |
|       from small pool |      0 KiB |  21763 KiB |    287 GiB |    287 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   87323 K  |   87323 K  |
|       from large pool |       2    |      76    |   31734 K  |   31734 K  |
|       from small pool |       0    |    7933    |   55588 K  |   55588 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   87323 K  |   87323 K  |
|       from large pool |       2    |      76    |   31734 K  |   31734 K  |
|       from small pool |       0    |    7933    |   55588 K  |   55588 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      54    |      73    |      39    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      25    |      37    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3615    |   45253 K  |   45253 K  |
|       from large pool |       2    |      12    |   17024 K  |   17024 K  |
|       from small pool |       0    |    3610    |   28228 K  |   28228 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 663735 GiB | 663735 GiB |
|       from small pool |      0 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 663735 GiB | 663735 GiB |
|       from small pool |      0 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 662038 GiB | 662038 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 661778 GiB | 661777 GiB |
|       from small pool |      0 KiB |  74336 KiB |    260 GiB |    260 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 307200 KiB |    808 MiB |   1240 MiB |    940 MiB |
|       from large pool | 256000 KiB |    734 MiB |   1140 MiB |    890 MiB |
|       from small pool |  51200 KiB |     74 MiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 251573 KiB | 366799 GiB | 366799 GiB |
|       from large pool |  47104 KiB | 250176 KiB | 366511 GiB | 366511 GiB |
|       from small pool |      0 KiB |  21763 KiB |    287 GiB |    287 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   87323 K  |   87323 K  |
|       from large pool |       2    |      76    |   31734 K  |   31734 K  |
|       from small pool |       0    |    7933    |   55588 K  |   55588 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   87323 K  |   87323 K  |
|       from large pool |       2    |      76    |   31734 K  |   31734 K  |
|       from small pool |       0    |    7933    |   55588 K  |   55588 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      54    |      73    |      39    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      25    |      37    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3615    |   45253 K  |   45253 K  |
|       from large pool |       2    |      12    |   17024 K  |   17024 K  |
|       from small pool |       0    |    3610    |   28228 K  |   28228 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116

 Experiment start at: 2024-08-04 22:47:49.360370
before training, model accuracy: 0.054656196385622025
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7325398, 'precision': 0.7478163, 'recall': 0.7325185, 'specificity': 0.7325185, 'f1': 0.7283415, 'auroc': 0.83593863, 'binary_precision': 0.68633056, 'binary_recall': 0.8567068, 'binary_specificity': 0.6083302, 'binary_f1_score': 0.76211244}
confusion matrix:
       0      1
0  17731  11416
1   4178  24979
---- Validation: 
scalar performance:
{'acc': 0.5601662, 'precision': 0.5116618, 'recall': 0.59291446, 'specificity': 0.59291446, 'f1': 0.3972473, 'auroc': 0.6219617, 'binary_precision': 0.04494115, 'binary_recall': 0.627907, 'binary_specificity': 0.55792195, 'binary_f1_score': 0.083878845}
confusion matrix:
       0     1
0  10138  8033
1    224   378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5148261, 'precision': 0.5268941, 'recall': 0.6802106, 'specificity': 0.6802106, 'f1': 0.39289725, 'auroc': 0.79334366, 'binary_precision': 0.064979695, 'binary_recall': 0.8595041, 'binary_specificity': 0.50091714, 'binary_f1_score': 0.120824866}
confusion matrix:
      0     1
0  3004  2993
1    34   208
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 22:59:11.285978,epoch time: 0:11:21.925608,used: 0:11:21.925608,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7793119, 'precision': 0.8114491, 'recall': 0.77927333, 'specificity': 0.77927333, 'f1': 0.77345204, 'auroc': 0.9098146, 'binary_precision': 0.7114636, 'binary_recall': 0.93991566, 'binary_specificity': 0.618631, 'binary_f1_score': 0.8098876}
confusion matrix:
       0      1
0  18030  11115
1   1752  27407
---- Validation: 
scalar performance:
{'acc': 0.4817557, 'precision': 0.51385033, 'recall': 0.6110329, 'specificity': 0.6110329, 'f1': 0.36168745, 'auroc': 0.65731454, 'binary_precision': 0.04496959, 'binary_recall': 0.7491694, 'binary_specificity': 0.47289637, 'binary_f1_score': 0.084846206}
confusion matrix:
      0     1
0  8593  9578
1   151   451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47154993, 'precision': 0.52655226, 'recall': 0.675544, 'specificity': 0.675544, 'f1': 0.36969674, 'auroc': 0.8182814, 'binary_precision': 0.062195472, 'binary_recall': 0.89669424, 'binary_specificity': 0.45439386, 'binary_f1_score': 0.1163227}
confusion matrix:
      0     1
0  2725  3272
1    25   217
early stop counter: 1
val acc:0.48175570368766785, best validation acc: 0.5601661801338196, corresponding to test acc:                         0.5148261189460754 / 0.5148261189460754
after epoch: 2,now: 2024-08-04 23:09:14.511745,epoch time: 0:10:03.225767,used: 0:21:25.151375,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8316239, 'precision': 0.84421897, 'recall': 0.83160746, 'specificity': 0.83160746, 'f1': 0.8300646, 'auroc': 0.9317478, 'binary_precision': 0.7784176, 'binary_recall': 0.92725587, 'binary_specificity': 0.7359591, 'binary_f1_score': 0.84634286}
confusion matrix:
       0      1
0  21451   7696
1   2121  27036
---- Validation: 
scalar performance:
{'acc': 0.6547169, 'precision': 0.51946586, 'recall': 0.64336216, 'specificity': 0.64336216, 'f1': 0.44552213, 'auroc': 0.67958426, 'binary_precision': 0.057228915, 'binary_recall': 0.6312292, 'binary_specificity': 0.65549505, 'binary_f1_score': 0.10494339}
confusion matrix:
       0     1
0  11911  6260
1    222   380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68921304, 'precision': 0.5360236, 'recall': 0.7134232, 'specificity': 0.7134232, 'f1': 0.48270133, 'auroc': 0.7877017, 'binary_precision': 0.087104626, 'binary_recall': 0.73966944, 'binary_specificity': 0.68717694, 'binary_f1_score': 0.15585546}
confusion matrix:
      0     1
0  4121  1876
1    63   179
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 23:19:18.106923,epoch time: 0:10:03.595178,used: 0:31:28.746553,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85507, 'precision': 0.85726976, 'recall': 0.85506326, 'specificity': 0.85506326, 'f1': 0.8548449, 'auroc': 0.93988204, 'binary_precision': 0.82927835, 'binary_recall': 0.8942964, 'binary_specificity': 0.8158301, 'binary_f1_score': 0.8605611}
confusion matrix:
       0      1
0  23779   5368
1   3082  26075
---- Validation: 
scalar performance:
{'acc': 0.7007937, 'precision': 0.51914907, 'recall': 0.6302235, 'specificity': 0.6302235, 'f1': 0.46330205, 'auroc': 0.66482747, 'binary_precision': 0.058771774, 'binary_recall': 0.55481726, 'binary_specificity': 0.7056298, 'binary_f1_score': 0.106284805}
confusion matrix:
       0     1
0  12822  5349
1    268   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7411444, 'precision': 0.5396128, 'recall': 0.7106956, 'specificity': 0.7106956, 'f1': 0.50775635, 'auroc': 0.79078174, 'binary_precision': 0.09641387, 'binary_recall': 0.677686, 'binary_specificity': 0.7437052, 'binary_f1_score': 0.16881111}
confusion matrix:
      0     1
0  4460  1537
1    78   164
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 23:29:19.538417,epoch time: 0:10:01.431494,used: 0:41:30.178047,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8555159, 'precision': 0.864359, 'recall': 0.8555026, 'specificity': 0.8555026, 'f1': 0.8546306, 'auroc': 0.9491095, 'binary_precision': 0.80763865, 'binary_recall': 0.9333951, 'binary_specificity': 0.77761006, 'binary_f1_score': 0.8659751}
confusion matrix:
       0      1
0  22665   6482
1   1942  27215
---- Validation: 
scalar performance:
{'acc': 0.6926969, 'precision': 0.51882744, 'recall': 0.6300563, 'specificity': 0.6300563, 'f1': 0.45983043, 'auroc': 0.6535304, 'binary_precision': 0.05799829, 'binary_recall': 0.5631229, 'binary_specificity': 0.6969897, 'binary_f1_score': 0.1051652}
confusion matrix:
       0     1
0  12665  5506
1    263   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73970187, 'precision': 0.5413913, 'recall': 0.7218417, 'specificity': 0.7218417, 'f1': 0.5093277, 'auroc': 0.7902637, 'binary_precision': 0.09872241, 'binary_recall': 0.70247936, 'binary_specificity': 0.74120396, 'binary_f1_score': 0.17311609}
confusion matrix:
      0     1
0  4445  1552
1    72   170
early stop counter: 1
val acc:0.6926969289779663, best validation acc: 0.7007936835289001, corresponding to test acc:                         0.7411444187164307 / 0.7411444187164307
after epoch: 5,now: 2024-08-04 23:39:19.446851,epoch time: 0:09:59.908434,used: 0:51:30.086481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.87215286, 'precision': 0.87522936, 'recall': 0.87214506, 'specificity': 0.87214506, 'f1': 0.8718885, 'auroc': 0.95203793, 'binary_precision': 0.8412958, 'binary_recall': 0.91741264, 'binary_specificity': 0.82687753, 'binary_f1_score': 0.877707}
confusion matrix:
       0      1
0  24101   5046
1   2408  26749
---- Validation: 
scalar performance:
{'acc': 0.73909336, 'precision': 0.51688534, 'recall': 0.6042341, 'specificity': 0.6042341, 'f1': 0.47449994, 'auroc': 0.6528994, 'binary_precision': 0.0571134, 'binary_recall': 0.4601329, 'binary_specificity': 0.74833524, 'binary_f1_score': 0.10161409}
confusion matrix:
       0     1
0  13598  4573
1    325   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78361917, 'precision': 0.54935217, 'recall': 0.7347727, 'specificity': 0.7347727, 'f1': 0.5357027, 'auroc': 0.79989576, 'binary_precision': 0.1147427, 'binary_recall': 0.6818182, 'binary_specificity': 0.7877272, 'binary_f1_score': 0.19642857}
confusion matrix:
      0     1
0  4724  1273
1    77   165
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-04 23:49:14.870640,epoch time: 0:09:55.423789,used: 1:01:25.510270,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88731474, 'precision': 0.8885597, 'recall': 0.88730896, 'specificity': 0.88730896, 'f1': 0.88722336, 'auroc': 0.9595801, 'binary_precision': 0.8666169, 'binary_recall': 0.9155978, 'binary_specificity': 0.8590201, 'binary_f1_score': 0.8904343}
confusion matrix:
       0      1
0  25037   4109
1   2461  26697
---- Validation: 
scalar performance:
{'acc': 0.7476695, 'precision': 0.5261682, 'recall': 0.6608623, 'specificity': 0.6608623, 'f1': 0.48936036, 'auroc': 0.70029396, 'binary_precision': 0.07096908, 'binary_recall': 0.5681063, 'binary_specificity': 0.7536184, 'binary_f1_score': 0.12617598}
confusion matrix:
       0     1
0  13694  4477
1    260   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8001282, 'precision': 0.55470693, 'recall': 0.7473258, 'specificity': 0.7473258, 'f1': 0.5484118, 'auroc': 0.81806266, 'binary_precision': 0.12471994, 'binary_recall': 0.69008267, 'binary_specificity': 0.80456895, 'binary_f1_score': 0.2112587}
confusion matrix:
      0     1
0  4825  1172
1    75   167
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-04 23:59:24.638439,epoch time: 0:10:09.767799,used: 1:11:35.278069,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8916369, 'precision': 0.8935549, 'recall': 0.89163333, 'specificity': 0.89163333, 'f1': 0.89150405, 'auroc': 0.9639667, 'binary_precision': 0.8661066, 'binary_recall': 0.9265306, 'binary_specificity': 0.85673606, 'binary_f1_score': 0.89530027}
confusion matrix:
       0      1
0  24973   4176
1   2142  27013
---- Validation: 
scalar performance:
{'acc': 0.7706813, 'precision': 0.52495575, 'recall': 0.6422336, 'specificity': 0.6422336, 'f1': 0.49591583, 'auroc': 0.7022381, 'binary_precision': 0.07051728, 'binary_recall': 0.50498337, 'binary_specificity': 0.7794838, 'binary_f1_score': 0.1237533}
confusion matrix:
       0     1
0  14164  4007
1    298   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82513225, 'precision': 0.5615615, 'recall': 0.75240135, 'specificity': 0.75240135, 'f1': 0.56571436, 'auroc': 0.8260801, 'binary_precision': 0.1387234, 'binary_recall': 0.6735537, 'binary_specificity': 0.83124894, 'binary_f1_score': 0.23006353}
confusion matrix:
      0     1
0  4985  1012
1    79   163
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-05 00:09:33.025960,epoch time: 0:10:08.387521,used: 1:21:43.665590,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89904636, 'precision': 0.8997738, 'recall': 0.89904344, 'specificity': 0.89904344, 'f1': 0.8989999, 'auroc': 0.9667605, 'binary_precision': 0.88275546, 'binary_recall': 0.92035943, 'binary_specificity': 0.87772745, 'binary_f1_score': 0.9011653}
confusion matrix:
       0      1
0  25584   3564
1   2322  26834
---- Validation: 
scalar performance:
{'acc': 0.7902839, 'precision': 0.5206672, 'recall': 0.60819197, 'specificity': 0.60819197, 'f1': 0.49669278, 'auroc': 0.66750956, 'binary_precision': 0.06496217, 'binary_recall': 0.41362128, 'binary_specificity': 0.8027626, 'binary_f1_score': 0.11228862}
confusion matrix:
       0     1
0  14587  3584
1    353   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83587116, 'precision': 0.5616734, 'recall': 0.7381601, 'specificity': 0.7381601, 'f1': 0.56911004, 'auroc': 0.81182396, 'binary_precision': 0.140625, 'binary_recall': 0.6322314, 'binary_specificity': 0.84408873, 'binary_f1_score': 0.23007518}
confusion matrix:
      0    1
0  5062  935
1    89  153
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-05 00:19:36.617384,epoch time: 0:10:03.591424,used: 1:31:47.257014,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9078108, 'precision': 0.907815, 'recall': 0.90781045, 'specificity': 0.90781045, 'f1': 0.90781045, 'auroc': 0.9691856, 'binary_precision': 0.9065609, 'binary_recall': 0.9093902, 'binary_specificity': 0.9062307, 'binary_f1_score': 0.90797335}
confusion matrix:
       0      1
0  26413   2733
1   2642  26516
---- Validation: 
scalar performance:
{'acc': 0.7960901, 'precision': 0.52853304, 'recall': 0.64893454, 'specificity': 0.64893454, 'f1': 0.5091889, 'auroc': 0.70620334, 'binary_precision': 0.0775275, 'binary_recall': 0.49169436, 'binary_specificity': 0.8061747, 'binary_f1_score': 0.13393664}
confusion matrix:
       0     1
0  14649  3522
1    306   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84388524, 'precision': 0.56384015, 'recall': 0.7363806, 'specificity': 0.7363806, 'f1': 0.57427275, 'auroc': 0.81984377, 'binary_precision': 0.14534883, 'binary_recall': 0.6198347, 'binary_specificity': 0.8529265, 'binary_f1_score': 0.23547879}
confusion matrix:
      0    1
0  5115  882
1    92  150
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-05 00:29:35.303879,epoch time: 0:09:58.686495,used: 1:41:45.943509,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9039689, 'precision': 0.90631783, 'recall': 0.9039637, 'specificity': 0.9039637, 'f1': 0.9038291, 'auroc': 0.9723351, 'binary_precision': 0.87545824, 'binary_recall': 0.94196737, 'binary_specificity': 0.86595994, 'binary_f1_score': 0.90749586}
confusion matrix:
       0      1
0  25241   3907
1   1692  27464
---- Validation: 
scalar performance:
{'acc': 0.7671123, 'precision': 0.5258115, 'recall': 0.64922357, 'specificity': 0.64922357, 'f1': 0.49580422, 'auroc': 0.70190454, 'binary_precision': 0.07159091, 'binary_recall': 0.5232558, 'binary_specificity': 0.77519125, 'binary_f1_score': 0.12594962}
confusion matrix:
       0     1
0  14086  4085
1    287   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82048404, 'precision': 0.5598459, 'recall': 0.74998343, 'specificity': 0.74998343, 'f1': 0.5619633, 'auroc': 0.8181484, 'binary_precision': 0.13538206, 'binary_recall': 0.6735537, 'binary_specificity': 0.8264132, 'binary_f1_score': 0.2254495}
confusion matrix:
      0     1
0  4956  1041
1    79   163
early stop counter: 1
val acc:0.7671123147010803, best validation acc: 0.7960901260375977, corresponding to test acc:                         0.8438852429389954 / 0.8438852429389954
after epoch: 11,now: 2024-08-05 00:39:37.653895,epoch time: 0:10:02.350016,used: 1:51:48.293525,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9073477, 'precision': 0.9096774, 'recall': 0.90733993, 'specificity': 0.90733993, 'f1': 0.9072146, 'auroc': 0.97354746, 'binary_precision': 0.87883526, 'binary_recall': 0.94502366, 'binary_specificity': 0.8696562, 'binary_f1_score': 0.9107284}
confusion matrix:
       0      1
0  25347   3799
1   1603  27555
---- Validation: 
scalar performance:
{'acc': 0.7651414, 'precision': 0.52910185, 'recall': 0.6706908, 'specificity': 0.6706908, 'f1': 0.49938768, 'auroc': 0.71753, 'binary_precision': 0.07634097, 'binary_recall': 0.5697674, 'binary_specificity': 0.77161413, 'binary_f1_score': 0.1346418}
confusion matrix:
       0     1
0  14021  4150
1    259   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7871454, 'precision': 0.5535935, 'recall': 0.75445163, 'specificity': 0.75445163, 'f1': 0.5423485, 'auroc': 0.82393265, 'binary_precision': 0.12133891, 'binary_recall': 0.71900827, 'binary_specificity': 0.78989494, 'binary_f1_score': 0.20763724}
confusion matrix:
      0     1
0  4737  1260
1    68   174
early stop counter: 2
val acc:0.7651414275169373, best validation acc: 0.7960901260375977, corresponding to test acc:                         0.8438852429389954 / 0.8438852429389954
after epoch: 12,now: 2024-08-05 00:49:39.537397,epoch time: 0:10:01.883502,used: 2:01:50.177027,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9187877, 'precision': 0.91961527, 'recall': 0.9187847, 'specificity': 0.9187847, 'f1': 0.91874725, 'auroc': 0.97668266, 'binary_precision': 0.9010148, 'binary_recall': 0.9409727, 'binary_specificity': 0.89659667, 'binary_f1_score': 0.9205603}
confusion matrix:
       0      1
0  26134   3014
1   1721  27435
---- Validation: 
scalar performance:
{'acc': 0.80471957, 'precision': 0.5278553, 'recall': 0.63974035, 'specificity': 0.63974035, 'f1': 0.5110424, 'auroc': 0.7056627, 'binary_precision': 0.077029265, 'binary_recall': 0.46345514, 'binary_specificity': 0.81602556, 'binary_f1_score': 0.13210227}
confusion matrix:
       0     1
0  14828  3343
1    323   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8328258, 'precision': 0.56458896, 'recall': 0.7564033, 'specificity': 0.7564033, 'f1': 0.5721211, 'auroc': 0.82308924, 'binary_precision': 0.14463176, 'binary_recall': 0.6735537, 'binary_specificity': 0.83925295, 'binary_f1_score': 0.23813002}
confusion matrix:
      0    1
0  5033  964
1    79  163
better model found
persisted
after epoch: 13,now: 2024-08-05 00:59:38.370886,epoch time: 0:09:58.833489,used: 2:11:49.010516,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9061642, 'precision': 0.90992355, 'recall': 0.9061527, 'specificity': 0.9061527, 'f1': 0.90594685, 'auroc': 0.97539437, 'binary_precision': 0.8707274, 'binary_recall': 0.9540108, 'binary_specificity': 0.8582947, 'binary_f1_score': 0.9104685}
confusion matrix:
       0      1
0  25015   4130
1   1341  27818
---- Validation: 
scalar performance:
{'acc': 0.7533159, 'precision': 0.52877915, 'recall': 0.67502177, 'specificity': 0.67502177, 'f1': 0.49472597, 'auroc': 0.7288074, 'binary_precision': 0.07508964, 'binary_recall': 0.5913621, 'binary_specificity': 0.7586814, 'binary_f1_score': 0.13325846}
confusion matrix:
       0     1
0  13786  4385
1    246   356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79035103, 'precision': 0.55594474, 'recall': 0.76405007, 'specificity': 0.76405007, 'f1': 0.546494, 'auroc': 0.8308004, 'binary_precision': 0.1251758, 'binary_recall': 0.7355372, 'binary_specificity': 0.79256296, 'binary_f1_score': 0.2139423}
confusion matrix:
      0     1
0  4753  1244
1    64   178
early stop counter: 1
val acc:0.7533159255981445, best validation acc: 0.8047195672988892, corresponding to test acc:                         0.832825779914856 / 0.8438852429389954
after epoch: 14,now: 2024-08-05 01:09:34.537254,epoch time: 0:09:56.166368,used: 2:21:45.176884,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9182903, 'precision': 0.9182917, 'recall': 0.9182906, 'specificity': 0.9182906, 'f1': 0.9182903, 'auroc': 0.97598046, 'binary_precision': 0.9191176, 'binary_recall': 0.91735256, 'binary_specificity': 0.9192287, 'binary_f1_score': 0.9182343}
confusion matrix:
       0      1
0  26790   2354
1   2410  26750
---- Validation: 
scalar performance:
{'acc': 0.81217706, 'precision': 0.5234757, 'recall': 0.61227375, 'specificity': 0.61227375, 'f1': 0.50734603, 'auroc': 0.68964607, 'binary_precision': 0.07050529, 'binary_recall': 0.3986711, 'binary_specificity': 0.8258764, 'binary_f1_score': 0.119820274}
confusion matrix:
       0     1
0  15007  3164
1    362   240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472512, 'precision': 0.5600078, 'recall': 0.71433854, 'specificity': 0.71433854, 'f1': 0.5699271, 'auroc': 0.7927869, 'binary_precision': 0.13981763, 'binary_recall': 0.57024795, 'binary_specificity': 0.8584292, 'binary_f1_score': 0.22457281}
confusion matrix:
      0    1
0  5148  849
1   104  138
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-08-05 01:19:35.048422,epoch time: 0:10:00.511168,used: 2:31:45.688052,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067116
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:31:45.688052 at 2024-08-05 01:19:35.048422
persisted model performance metric: 

scalar performance:
{'acc': 0.8472512, 'precision': 0.5600078, 'recall': 0.71433854, 'specificity': 0.71433854, 'f1': 0.5699271, 'auroc': 0.7927869, 'binary_precision': 0.13981763, 'binary_recall': 0.57024795, 'binary_specificity': 0.8584292, 'binary_f1_score': 0.22457281}
confusion matrix:
      0    1
0  5148  849
1   104  138
oracle model performance metric: 

scalar performance:
{'acc': 0.8472512, 'precision': 0.5600078, 'recall': 0.71433854, 'specificity': 0.71433854, 'f1': 0.5699271, 'auroc': 0.7927869, 'binary_precision': 0.13981763, 'binary_recall': 0.57024795, 'binary_specificity': 0.8584292, 'binary_f1_score': 0.22457281}
confusion matrix:
      0    1
0  5148  849
1   104  138
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 255149 KiB | 664665 KiB |    983 TiB |    983 TiB |
|       from large pool | 218112 KiB | 591936 KiB |    983 TiB |    983 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 255149 KiB | 664665 KiB |    983 TiB |    983 TiB |
|       from large pool | 218112 KiB | 591936 KiB |    983 TiB |    983 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 249983 KiB | 656104 KiB |    980 TiB |    980 TiB |
|       from large pool | 214016 KiB | 584512 KiB |    979 TiB |    979 TiB |
|       from small pool |  35967 KiB |  74336 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 768000 KiB |    808 MiB |   1690 MiB |    940 MiB |
|       from large pool | 692224 KiB |    734 MiB |   1566 MiB |    890 MiB |
|       from small pool |  75776 KiB |     74 MiB |    124 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50002 KiB | 255687 KiB | 544544 GiB | 544544 GiB |
|       from large pool |  37888 KiB | 254684 KiB | 544108 GiB | 544108 GiB |
|       from small pool |  12114 KiB |  21763 KiB |    436 GiB |    436 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    8057    |  132120 K  |  132116 K  |
|       from large pool |      36    |      76    |   48104 K  |   48104 K  |
|       from small pool |    3204    |    8019    |   84015 K  |   84012 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    8057    |  132120 K  |  132116 K  |
|       from large pool |      36    |      76    |   48104 K  |   48104 K  |
|       from small pool |    3204    |    8019    |   84015 K  |   84012 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      54    |      92    |      39    |
|       from large pool |      16    |      17    |      30    |      14    |
|       from small pool |      37    |      37    |      62    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3658    |   69203 K  |   69203 K  |
|       from large pool |       4    |      12    |   26506 K  |   26506 K  |
|       from small pool |      48    |    3653    |   42697 K  |   42697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB |    983 TiB |    983 TiB |
|       from large pool |  65536 KiB | 591936 KiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB |    983 TiB |    983 TiB |
|       from large pool |  65536 KiB | 591936 KiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB |    980 TiB |    980 TiB |
|       from large pool |  65536 KiB | 584512 KiB |    979 TiB |    979 TiB |
|       from small pool |      0 KiB |  74336 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 305152 KiB |    808 MiB |   1690 MiB |   1392 MiB |
|       from large pool | 256000 KiB |    734 MiB |   1566 MiB |   1316 MiB |
|       from small pool |  49152 KiB |     74 MiB |    124 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 255687 KiB | 544545 GiB | 544545 GiB |
|       from large pool |  47104 KiB | 254684 KiB | 544108 GiB | 544108 GiB |
|       from small pool |      0 KiB |  21763 KiB |    436 GiB |    436 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8057    |  132120 K  |  132120 K  |
|       from large pool |       2    |      76    |   48104 K  |   48104 K  |
|       from small pool |       0    |    8019    |   84015 K  |   84015 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8057    |  132120 K  |  132120 K  |
|       from large pool |       2    |      76    |   48104 K  |   48104 K  |
|       from small pool |       0    |    8019    |   84015 K  |   84015 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      54    |      92    |      59    |
|       from large pool |       9    |      17    |      30    |      21    |
|       from small pool |      24    |      37    |      62    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3658    |   69205 K  |   69205 K  |
|       from large pool |       2    |      12    |   26506 K  |   26506 K  |
|       from small pool |       0    |    3653    |   42698 K  |   42698 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 01:20:19 2024]
Finished job 0.
1 of 1 steps (100%) done
