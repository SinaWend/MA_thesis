Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 09:57:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369

 Experiment start at: 2024-07-31 10:06:23.174379
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9662134, 'precision': 0.9662836, 'recall': 0.9662088, 'specificity': 0.9662088, 'f1': 0.96621186, 'auroc': 0.9945468, 'binary_precision': 0.9607492, 'binary_recall': 0.97219706, 'binary_specificity': 0.9602205, 'binary_f1_score': 0.96643925}
confusion matrix:
       0      1
0  27518   1140
1    798  27904
---- Validation: 
scalar performance:
{'acc': 0.9323648, 'precision': 0.6240032, 'recall': 0.74746823, 'specificity': 0.74746823, 'f1': 0.66070575, 'auroc': 0.8372358, 'binary_precision': 0.26461768, 'binary_recall': 0.5489891, 'binary_specificity': 0.9459474, 'binary_f1_score': 0.35710672}
confusion matrix:
       0    1
0  17168  981
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93160754, 'precision': 0.66745853, 'recall': 0.8342198, 'specificity': 0.8342198, 'f1': 0.71687037, 'auroc': 0.8984301, 'binary_precision': 0.34734917, 'binary_recall': 0.72796935, 'binary_specificity': 0.9404702, 'binary_f1_score': 0.47029698}
confusion matrix:
      0    1
0  5640  357
1    71  190
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 10:22:39.966875,epoch time: 0:16:16.792496,used: 0:16:16.792496,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.971583, 'precision': 0.97166264, 'recall': 0.9715779, 'specificity': 0.9715779, 'f1': 0.9715816, 'auroc': 0.99606717, 'binary_precision': 0.965732, 'binary_recall': 0.9779117, 'binary_specificity': 0.9652441, 'binary_f1_score': 0.9717837}
confusion matrix:
       0      1
0  27661    996
1    634  28069
---- Validation: 
scalar performance:
{'acc': 0.91464454, 'precision': 0.5865884, 'recall': 0.7000414, 'specificity': 0.7000414, 'f1': 0.6141046, 'auroc': 0.80125993, 'binary_precision': 0.19297124, 'binary_recall': 0.4696734, 'binary_specificity': 0.9304094, 'binary_f1_score': 0.27355072}
confusion matrix:
       0     1
0  16886  1263
1    341   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89133906, 'precision': 0.6208308, 'recall': 0.85168827, 'specificity': 0.85168827, 'f1': 0.66168207, 'auroc': 0.91345036, 'binary_precision': 0.2508918, 'binary_recall': 0.8084291, 'binary_specificity': 0.89494747, 'binary_f1_score': 0.3829401}
confusion matrix:
      0    1
0  5367  630
1    50  211
early stop counter: 1
val acc:0.9146445393562317, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 2,now: 2024-07-31 10:37:13.394913,epoch time: 0:14:33.428038,used: 0:30:50.220534,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97498256, 'precision': 0.97509027, 'recall': 0.97497666, 'specificity': 0.97497666, 'f1': 0.9749809, 'auroc': 0.9971857, 'binary_precision': 0.96813625, 'binary_recall': 0.98233634, 'binary_specificity': 0.967617, 'binary_f1_score': 0.9751846}
confusion matrix:
       0      1
0  27729    928
1    507  28196
---- Validation: 
scalar performance:
{'acc': 0.9107599, 'precision': 0.57634646, 'recall': 0.67852885, 'specificity': 0.67852885, 'f1': 0.60010576, 'auroc': 0.7851815, 'binary_precision': 0.1740227, 'binary_recall': 0.42923796, 'binary_specificity': 0.9278197, 'binary_f1_score': 0.24764471}
confusion matrix:
       0     1
0  16839  1310
1    367   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89613295, 'precision': 0.62740856, 'recall': 0.8633512, 'specificity': 0.8633512, 'f1': 0.67120636, 'auroc': 0.91632986, 'binary_precision': 0.2630938, 'binary_recall': 0.82758623, 'binary_specificity': 0.8991162, 'binary_f1_score': 0.39926064}
confusion matrix:
      0    1
0  5392  605
1    45  216
early stop counter: 2
val acc:0.9107599258422852, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 3,now: 2024-07-31 10:52:26.780189,epoch time: 0:15:13.385276,used: 0:46:03.605810,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9677127, 'precision': 0.968045, 'recall': 0.96770257, 'specificity': 0.96770257, 'f1': 0.96770644, 'auroc': 0.9956763, 'binary_precision': 0.95576453, 'binary_recall': 0.9808724, 'binary_specificity': 0.95453274, 'binary_f1_score': 0.96815574}
confusion matrix:
       0      1
0  27355   1303
1    549  28153
---- Validation: 
scalar performance:
{'acc': 0.8788846, 'precision': 0.54743016, 'recall': 0.6447753, 'specificity': 0.6447753, 'f1': 0.5582425, 'auroc': 0.659742, 'binary_precision': 0.11827957, 'binary_recall': 0.3934681, 'binary_specificity': 0.8960824, 'binary_f1_score': 0.18188354}
confusion matrix:
       0     1
0  16263  1886
1    390   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74560565, 'precision': 0.561692, 'recall': 0.8159616, 'specificity': 0.8159616, 'f1': 0.5371027, 'auroc': 0.9146681, 'binary_precision': 0.12966055, 'binary_recall': 0.8927203, 'binary_specificity': 0.7392029, 'binary_f1_score': 0.22643344}
confusion matrix:
      0     1
0  4433  1564
1    28   233
early stop counter: 3
val acc:0.8788846135139465, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 4,now: 2024-07-31 11:08:12.327310,epoch time: 0:15:45.547121,used: 1:01:49.152931,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9736053, 'precision': 0.9737488, 'recall': 0.9735981, 'specificity': 0.9735981, 'f1': 0.973603, 'auroc': 0.996866, 'binary_precision': 0.9657098, 'binary_recall': 0.9821279, 'binary_specificity': 0.9650684, 'binary_f1_score': 0.97384965}
confusion matrix:
       0      1
0  27655   1001
1    513  28191
---- Validation: 
scalar performance:
{'acc': 0.83551514, 'precision': 0.5332126, 'recall': 0.6343231, 'specificity': 0.6343231, 'f1': 0.528609, 'auroc': 0.636787, 'binary_precision': 0.09008707, 'binary_recall': 0.41835147, 'binary_specificity': 0.85029477, 'binary_f1_score': 0.1482502}
confusion matrix:
       0     1
0  15432  2717
1    374   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77644616, 'precision': 0.5692952, 'recall': 0.8302207, 'specificity': 0.8302207, 'f1': 0.5588681, 'auroc': 0.92176676, 'binary_precision': 0.14481898, 'binary_recall': 0.8888889, 'binary_specificity': 0.77155244, 'binary_f1_score': 0.24906068}
confusion matrix:
      0     1
0  4627  1370
1    29   232
early stop counter: 4
val acc:0.8355151414871216, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 5,now: 2024-07-31 11:23:21.544638,epoch time: 0:15:09.217328,used: 1:16:58.370259,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96823573, 'precision': 0.96905506, 'recall': 0.96821904, 'specificity': 0.96821904, 'f1': 0.968221, 'auroc': 0.99768317, 'binary_precision': 0.9496504, 'binary_recall': 0.98895586, 'binary_specificity': 0.9474823, 'binary_f1_score': 0.9689047}
confusion matrix:
       0      1
0  27152   1505
1    317  28386
---- Validation: 
scalar performance:
{'acc': 0.84174114, 'precision': 0.534621, 'recall': 0.6352963, 'specificity': 0.6352963, 'f1': 0.5322347, 'auroc': 0.6875008, 'binary_precision': 0.09290954, 'binary_recall': 0.41368586, 'binary_specificity': 0.8569067, 'binary_f1_score': 0.15173988}
confusion matrix:
       0     1
0  15552  2597
1    377   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71284753, 'precision': 0.5549024, 'recall': 0.7988697, 'specificity': 0.7988697, 'f1': 0.5153278, 'auroc': 0.9180082, 'binary_precision': 0.11638362, 'binary_recall': 0.8927203, 'binary_specificity': 0.7050192, 'binary_f1_score': 0.20592135}
confusion matrix:
      0     1
0  4228  1769
1    28   233
early stop counter: 5
val acc:0.841741144657135, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 6,now: 2024-07-31 11:38:04.499043,epoch time: 0:14:42.954405,used: 1:31:41.324664,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94490933, 'precision': 0.94846493, 'recall': 0.94487524, 'specificity': 0.94487524, 'f1': 0.9447969, 'auroc': 0.99634206, 'binary_precision': 0.9087243, 'binary_recall': 0.989269, 'binary_specificity': 0.9004815, 'binary_f1_score': 0.9472876}
confusion matrix:
       0      1
0  25806   2852
1    308  28394
---- Validation: 
scalar performance:
{'acc': 0.625745, 'precision': 0.5050286, 'recall': 0.5354728, 'specificity': 0.5354728, 'f1': 0.41985244, 'auroc': 0.57298565, 'binary_precision': 0.0405522, 'binary_recall': 0.43856922, 'binary_specificity': 0.63237643, 'binary_f1_score': 0.07423983}
confusion matrix:
       0     1
0  11477  6672
1    361   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39197826, 'precision': 0.531091, 'recall': 0.677261, 'specificity': 0.677261, 'f1': 0.32755464, 'auroc': 0.8828675, 'binary_precision': 0.0635468, 'binary_recall': 0.9885057, 'binary_specificity': 0.36601633, 'binary_f1_score': 0.1194168}
confusion matrix:
      0     1
0  2195  3802
1     3   258
early stop counter: 6
val acc:0.6257449984550476, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 7,now: 2024-07-31 11:52:45.704354,epoch time: 0:14:41.205311,used: 1:46:22.529975,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9668236, 'precision': 0.9673743, 'recall': 0.96680874, 'specificity': 0.96680874, 'f1': 0.96681297, 'auroc': 0.99625254, 'binary_precision': 0.9515466, 'binary_recall': 0.9838007, 'binary_specificity': 0.94981676, 'binary_f1_score': 0.9674049}
confusion matrix:
       0      1
0  27217   1438
1    465  28240
---- Validation: 
scalar performance:
{'acc': 0.79278415, 'precision': 0.52216196, 'recall': 0.60770035, 'specificity': 0.60770035, 'f1': 0.500794, 'auroc': 0.5987188, 'binary_precision': 0.06963199, 'binary_recall': 0.40902022, 'binary_specificity': 0.8063805, 'binary_f1_score': 0.119004525}
confusion matrix:
       0     1
0  14635  3514
1    380   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5247683, 'precision': 0.5373927, 'recall': 0.73371935, 'specificity': 0.73371935, 'f1': 0.40771827, 'auroc': 0.8763647, 'binary_precision': 0.07807154, 'binary_recall': 0.96168584, 'binary_specificity': 0.50575286, 'binary_f1_score': 0.14441888}
confusion matrix:
      0     1
0  3033  2964
1    10   251
early stop counter: 7
val acc:0.7927841544151306, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 8,now: 2024-07-31 12:07:41.330997,epoch time: 0:14:55.626643,used: 2:01:18.156618,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9312936, 'precision': 0.93739426, 'recall': 0.9312545, 'specificity': 0.9312545, 'f1': 0.93104887, 'auroc': 0.9954343, 'binary_precision': 0.8859031, 'binary_recall': 0.99020875, 'binary_specificity': 0.8723003, 'binary_f1_score': 0.9351564}
confusion matrix:
       0      1
0  25001   3660
1    281  28418
---- Validation: 
scalar performance:
{'acc': 0.6338335, 'precision': 0.5059947, 'recall': 0.5419105, 'specificity': 0.5419105, 'f1': 0.42407277, 'auroc': 0.57655644, 'binary_precision': 0.041862514, 'binary_recall': 0.44323483, 'binary_specificity': 0.64058626, 'binary_f1_score': 0.0764998}
confusion matrix:
       0     1
0  11626  6523
1    358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36705017, 'precision': 0.52951515, 'recall': 0.6624222, 'specificity': 0.6624222, 'f1': 0.31112996, 'auroc': 0.884287, 'binary_precision': 0.060987186, 'binary_recall': 0.98467433, 'binary_specificity': 0.3401701, 'binary_f1_score': 0.11486033}
confusion matrix:
      0     1
0  2040  3957
1     4   257
early stop counter: 8
val acc:0.6338335275650024, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 9,now: 2024-07-31 12:22:13.949953,epoch time: 0:14:32.618956,used: 2:15:50.775574,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9204323, 'precision': 0.92841256, 'recall': 0.9203848, 'specificity': 0.9203848, 'f1': 0.92005396, 'auroc': 0.9942256, 'binary_precision': 0.87011594, 'binary_recall': 0.9885366, 'binary_specificity': 0.85223305, 'binary_f1_score': 0.9255538}
confusion matrix:
       0      1
0  24425   4235
1    329  28371
---- Validation: 
scalar performance:
{'acc': 0.5032993, 'precision': 0.49690384, 'recall': 0.47658125, 'specificity': 0.47658125, 'f1': 0.3604195, 'auroc': 0.5405923, 'binary_precision': 0.031078018, 'binary_recall': 0.44790047, 'binary_specificity': 0.505262, 'binary_f1_score': 0.058123108}
confusion matrix:
      0     1
0  9170  8979
1   355   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.26637903, 'precision': 0.5255576, 'recall': 0.61172825, 'specificity': 0.61172825, 'f1': 0.240693, 'auroc': 0.83169127, 'binary_precision': 0.053239785, 'binary_recall': 0.9885057, 'binary_specificity': 0.23495081, 'binary_f1_score': 0.101037785}
confusion matrix:
      0     1
0  1409  4588
1     3   258
early stop counter: 9
val acc:0.5032992959022522, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 10,now: 2024-07-31 12:36:47.597515,epoch time: 0:14:33.647562,used: 2:30:24.423136,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95183057, 'precision': 0.9542753, 'recall': 0.95180506, 'specificity': 0.95180506, 'f1': 0.95176375, 'auroc': 0.99620205, 'binary_precision': 0.92112356, 'binary_recall': 0.9883624, 'binary_specificity': 0.91524774, 'binary_f1_score': 0.9535591}
confusion matrix:
       0      1
0  26231   2429
1    334  28366
---- Validation: 
scalar performance:
{'acc': 0.6826841, 'precision': 0.5105462, 'recall': 0.5687013, 'specificity': 0.5687013, 'f1': 0.4478721, 'auroc': 0.57843816, 'binary_precision': 0.048693586, 'binary_recall': 0.44634527, 'binary_specificity': 0.6910574, 'binary_f1_score': 0.087807864}
confusion matrix:
       0     1
0  12542  5607
1    356   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162991, 'precision': 0.53673047, 'recall': 0.7293005, 'specificity': 0.7293005, 'f1': 0.40271503, 'auroc': 0.9081631, 'binary_precision': 0.07680538, 'binary_recall': 0.96168584, 'binary_specificity': 0.49691513, 'binary_f1_score': 0.14224993}
confusion matrix:
      0     1
0  2980  3017
1    10   251
early stop counter: 10
val acc:0.6826841235160828, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 11,now: 2024-07-31 12:51:51.280192,epoch time: 0:15:03.682677,used: 2:45:28.105813,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95188284, 'precision': 0.95452523, 'recall': 0.95185107, 'specificity': 0.95185107, 'f1': 0.95181036, 'auroc': 0.99683595, 'binary_precision': 0.92007774, 'binary_recall': 0.9898272, 'binary_specificity': 0.9138749, 'binary_f1_score': 0.95367885}
confusion matrix:
       0      1
0  26188   2468
1    292  28412
---- Validation: 
scalar performance:
{'acc': 0.800447, 'precision': 0.5254419, 'recall': 0.6206682, 'specificity': 0.6206682, 'f1': 0.5076201, 'auroc': 0.627099, 'binary_precision': 0.07519825, 'binary_recall': 0.42768273, 'binary_specificity': 0.81365365, 'binary_f1_score': 0.12790698}
confusion matrix:
       0     1
0  14767  3382
1    368   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6198466, 'precision': 0.5453619, 'recall': 0.7759982, 'specificity': 0.7759982, 'f1': 0.46261913, 'auroc': 0.9106405, 'binary_precision': 0.09456355, 'binary_recall': 0.9463602, 'binary_specificity': 0.6056362, 'binary_f1_score': 0.1719457}
confusion matrix:
      0     1
0  3632  2365
1    14   247
early stop counter: 11
val acc:0.8004469871520996, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 12,now: 2024-07-31 13:06:27.615761,epoch time: 0:14:36.335569,used: 3:00:04.441382,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8971583, 'precision': 0.9116527, 'recall': 0.8970864, 'specificity': 0.8970864, 'f1': 0.89623284, 'auroc': 0.9934779, 'binary_precision': 0.83460015, 'binary_recall': 0.99083686, 'binary_specificity': 0.8033359, 'binary_f1_score': 0.90603244}
confusion matrix:
       0      1
0  23022   5636
1    263  28439
---- Validation: 
scalar performance:
{'acc': 0.47376543, 'precision': 0.49517053, 'recall': 0.4635413, 'specificity': 0.4635413, 'f1': 0.34542465, 'auroc': 0.5513135, 'binary_precision': 0.02960928, 'binary_recall': 0.4525661, 'binary_specificity': 0.4745165, 'binary_f1_score': 0.055582084}
confusion matrix:
      0     1
0  8612  9537
1   352   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.239853, 'precision': 0.5255145, 'recall': 0.60155267, 'specificity': 0.60155267, 'f1': 0.22070295, 'auroc': 0.8053858, 'binary_precision': 0.051834133, 'binary_recall': 0.99616855, 'binary_specificity': 0.2069368, 'binary_f1_score': 0.09854084}
confusion matrix:
      0     1
0  1241  4756
1     1   260
early stop counter: 12
val acc:0.47376543283462524, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 13,now: 2024-07-31 13:20:59.350141,epoch time: 0:14:31.734380,used: 3:14:36.175762,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9276674, 'precision': 0.93496454, 'recall': 0.9276155, 'specificity': 0.9276155, 'f1': 0.9273567, 'auroc': 0.9957282, 'binary_precision': 0.8788262, 'binary_recall': 0.99226564, 'binary_specificity': 0.8629654, 'binary_f1_score': 0.93210715}
confusion matrix:
       0      1
0  24730   3927
1    222  28481
---- Validation: 
scalar performance:
{'acc': 0.62053, 'precision': 0.50525033, 'recall': 0.5372733, 'specificity': 0.5372733, 'f1': 0.41802934, 'auroc': 0.567944, 'binary_precision': 0.040770102, 'binary_recall': 0.44790047, 'binary_specificity': 0.6266461, 'binary_f1_score': 0.07473725}
confusion matrix:
       0     1
0  11373  6776
1    355   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.31415787, 'precision': 0.52788264, 'recall': 0.6384897, 'specificity': 0.6384897, 'f1': 0.27536187, 'auroc': 0.78652036, 'binary_precision': 0.05693559, 'binary_recall': 0.99233717, 'binary_specificity': 0.2846423, 'binary_f1_score': 0.10769231}
confusion matrix:
      0     1
0  1707  4290
1     2   259
early stop counter: 13
val acc:0.6205300092697144, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 14,now: 2024-07-31 13:35:38.822421,epoch time: 0:14:39.472280,used: 3:29:15.648042,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9077057, 'precision': 0.91920286, 'recall': 0.90765095, 'specificity': 0.90765095, 'f1': 0.90706027, 'auroc': 0.9929776, 'binary_precision': 0.84994465, 'binary_recall': 0.99038297, 'binary_specificity': 0.82491887, 'binary_f1_score': 0.9148053}
confusion matrix:
       0      1
0  23643   5018
1    276  28423
---- Validation: 
scalar performance:
{'acc': 0.46700725, 'precision': 0.49499762, 'recall': 0.46229267, 'specificity': 0.46229267, 'f1': 0.3421064, 'auroc': 0.52733505, 'binary_precision': 0.029515108, 'binary_recall': 0.45723173, 'binary_specificity': 0.46735358, 'binary_f1_score': 0.05545077}
confusion matrix:
      0     1
0  8482  9667
1   349   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.16938318, 'precision': 0.5231984, 'recall': 0.5647843, 'specificity': 0.5647843, 'f1': 0.16315213, 'auroc': 0.70604527, 'binary_precision': 0.047645226, 'binary_recall': 0.99616855, 'binary_specificity': 0.13340004, 'binary_f1_score': 0.090940885}
confusion matrix:
     0     1
0  800  5197
1    1   260
early stop counter: 14
val acc:0.46700724959373474, best validation acc: 0.932364821434021, corresponding to test acc:                         0.9316075444221497 / 0.9316075444221497
after epoch: 15,now: 2024-07-31 13:50:13.136244,epoch time: 0:14:34.313823,used: 3:43:49.961865,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_06_22_seed_0_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:43:49.961865 at 2024-07-31 13:50:13.136244
persisted model performance metric: 

scalar performance:
{'acc': 0.93160754, 'precision': 0.66745853, 'recall': 0.8342198, 'specificity': 0.8342198, 'f1': 0.71687037, 'auroc': 0.8984301, 'binary_precision': 0.34734917, 'binary_recall': 0.72796935, 'binary_specificity': 0.9404702, 'binary_f1_score': 0.47029698}
confusion matrix:
      0    1
0  5640  357
1    71  190
oracle model performance metric: 

scalar performance:
{'acc': 0.93160754, 'precision': 0.66745853, 'recall': 0.8342198, 'specificity': 0.8342198, 'f1': 0.71687037, 'auroc': 0.8984301, 'binary_precision': 0.34734917, 'binary_recall': 0.72796935, 'binary_specificity': 0.9404702, 'binary_f1_score': 0.47029698}
confusion matrix:
      0    1
0  5640  357
1    71  190
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 490523 KiB |  11066 MiB | 645006 GiB | 645005 GiB |
|       from large pool | 400704 KiB |  10993 MiB | 644158 GiB | 644158 GiB |
|       from small pool |  89819 KiB |    124 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 490523 KiB |  11066 MiB | 645006 GiB | 645005 GiB |
|       from large pool | 400704 KiB |  10993 MiB | 644158 GiB | 644158 GiB |
|       from small pool |  89819 KiB |    124 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB | 641994 GiB | 641994 GiB |
|       from large pool | 387840 KiB |  10889 MiB | 641156 GiB | 641156 GiB |
|       from small pool |  88733 KiB |    123 MiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11374 MiB |  11374 MiB |  11374 MiB |      0 B   |
|       from large pool |  11248 MiB |  11248 MiB |  11248 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1362 MiB |   1814 MiB | 211736 GiB | 211735 GiB |
|       from large pool |   1352 MiB |   1811 MiB | 210856 GiB | 210855 GiB |
|       from small pool |     10 MiB |     11 MiB |    880 GiB |    880 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    8416    |   56930 K  |   56926 K  |
|       from large pool |      87    |     909    |   24074 K  |   24074 K  |
|       from small pool |    3642    |    8327    |   32855 K  |   32852 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    8416    |   56930 K  |   56926 K  |
|       from large pool |      87    |     909    |   24074 K  |   24074 K  |
|       from small pool |    3642    |    8327    |   32855 K  |   32852 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     235    |     235    |     235    |       0    |
|       from large pool |     172    |     172    |     172    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3620    |   26763 K  |   26763 K  |
|       from large pool |      23    |      62    |    9891 K  |    9890 K  |
|       from small pool |      54    |    3596    |   16872 K  |   16872 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11066 MiB | 645006 GiB | 645006 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 644158 GiB | 644158 GiB |
|       from small pool |      0 KiB |    124 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11066 MiB | 645006 GiB | 645006 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 644158 GiB | 644158 GiB |
|       from small pool |      0 KiB |    124 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB | 641994 GiB | 641994 GiB |
|       from large pool |  16640 KiB |  10889 MiB | 641156 GiB | 641156 GiB |
|       from small pool |      0 KiB |    123 MiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1842 MiB |  11374 MiB |  11374 MiB |   9532 MiB |
|       from large pool |   1744 MiB |  11248 MiB |  11248 MiB |   9504 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1814 MiB | 211737 GiB | 211737 GiB |
|       from large pool | 134912 KiB |   1811 MiB | 210856 GiB | 210856 GiB |
|       from small pool |      0 KiB |     22 MiB |    880 GiB |    880 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   56930 K  |   56930 K  |
|       from large pool |       2    |     909    |   24074 K  |   24074 K  |
|       from small pool |       0    |    8327    |   32855 K  |   32855 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   56930 K  |   56930 K  |
|       from large pool |       2    |     909    |   24074 K  |   24074 K  |
|       from small pool |       0    |    8327    |   32855 K  |   32855 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     235    |     235    |     156    |
|       from large pool |      30    |     172    |     172    |     142    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3620    |   26764 K  |   26764 K  |
|       from large pool |       4    |      62    |    9891 K  |    9891 K  |
|       from small pool |       0    |    3596    |   16873 K  |   16873 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11066 MiB | 645006 GiB | 645006 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 644158 GiB | 644158 GiB |
|       from small pool |      0 KiB |    124 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11066 MiB | 645006 GiB | 645006 GiB |
|       from large pool |  16640 KiB |  10993 MiB | 644158 GiB | 644158 GiB |
|       from small pool |      0 KiB |    124 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB | 641994 GiB | 641994 GiB |
|       from large pool |  16640 KiB |  10889 MiB | 641156 GiB | 641156 GiB |
|       from small pool |      0 KiB |    123 MiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1842 MiB |  11374 MiB |  11374 MiB |   9532 MiB |
|       from large pool |   1744 MiB |  11248 MiB |  11248 MiB |   9504 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1814 MiB | 211737 GiB | 211737 GiB |
|       from large pool | 134912 KiB |   1811 MiB | 210856 GiB | 210856 GiB |
|       from small pool |      0 KiB |     22 MiB |    880 GiB |    880 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   56930 K  |   56930 K  |
|       from large pool |       2    |     909    |   24074 K  |   24074 K  |
|       from small pool |       0    |    8327    |   32855 K  |   32855 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   56930 K  |   56930 K  |
|       from large pool |       2    |     909    |   24074 K  |   24074 K  |
|       from small pool |       0    |    8327    |   32855 K  |   32855 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     235    |     235    |     156    |
|       from large pool |      30    |     172    |     172    |     142    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3620    |   26764 K  |   26764 K  |
|       from large pool |       4    |      62    |    9891 K  |    9891 K  |
|       from small pool |       0    |    3596    |   16873 K  |   16873 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369

 Experiment start at: 2024-07-31 13:58:14.319029
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9637253, 'precision': 0.96389914, 'recall': 0.9637184, 'specificity': 0.9637184, 'f1': 0.9637216, 'auroc': 0.99404955, 'binary_precision': 0.95510095, 'binary_recall': 0.9732561, 'binary_specificity': 0.9541807, 'binary_f1_score': 0.9640931}
confusion matrix:
       0      1
0  27468   1319
1    771  28058
---- Validation: 
scalar performance:
{'acc': 0.9128068, 'precision': 0.6053489, 'recall': 0.7587962, 'specificity': 0.7587962, 'f1': 0.6407516, 'auroc': 0.8259831, 'binary_precision': 0.22683343, 'binary_recall': 0.59286773, 'binary_specificity': 0.92472464, 'binary_f1_score': 0.32812497}
confusion matrix:
       0     1
0  16707  1360
1    274   399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9395746, 'precision': 0.68076915, 'recall': 0.8121523, 'specificity': 0.8121523, 'f1': 0.72533584, 'auroc': 0.8707567, 'binary_precision': 0.37634408, 'binary_recall': 0.6730769, 'binary_specificity': 0.9512277, 'binary_f1_score': 0.4827586}
confusion matrix:
      0    1
0  5656  290
1    85  175
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 14:14:15.862252,epoch time: 0:16:01.543223,used: 0:16:01.543223,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9667627, 'precision': 0.9668135, 'recall': 0.966759, 'specificity': 0.966759, 'f1': 0.9667616, 'auroc': 0.9939674, 'binary_precision': 0.96212226, 'binary_recall': 0.97183394, 'binary_specificity': 0.9616841, 'binary_f1_score': 0.96695375}
confusion matrix:
       0      1
0  27684   1103
1    812  28017
---- Validation: 
scalar performance:
{'acc': 0.9191035, 'precision': 0.58272845, 'recall': 0.66049385, 'specificity': 0.66049385, 'f1': 0.60521877, 'auroc': 0.7186189, 'binary_precision': 0.18938835, 'binary_recall': 0.3818722, 'binary_specificity': 0.9391155, 'binary_f1_score': 0.25320196}
confusion matrix:
       0     1
0  16967  1100
1    416   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9118595, 'precision': 0.6428324, 'recall': 0.8565364, 'specificity': 0.8565364, 'f1': 0.6915162, 'auroc': 0.91214263, 'binary_precision': 0.29529244, 'binary_recall': 0.79615384, 'binary_specificity': 0.91691893, 'binary_f1_score': 0.43080124}
confusion matrix:
      0    1
0  5452  494
1    53  207
better model found
persisted
after epoch: 2,now: 2024-07-31 14:30:29.596129,epoch time: 0:16:13.733877,used: 0:32:15.277100,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9321369, 'precision': 0.9373964, 'recall': 0.932097, 'specificity': 0.932097, 'f1': 0.931928, 'auroc': 0.99398386, 'binary_precision': 0.88961506, 'binary_recall': 0.98681885, 'binary_specificity': 0.8773752, 'binary_f1_score': 0.9356993}
confusion matrix:
       0      1
0  25257   3530
1    380  28449
---- Validation: 
scalar performance:
{'acc': 0.64348984, 'precision': 0.50678945, 'recall': 0.5447338, 'specificity': 0.5447338, 'f1': 0.42999253, 'auroc': 0.58892655, 'binary_precision': 0.044710517, 'binary_recall': 0.4383358, 'binary_specificity': 0.65113187, 'binary_f1_score': 0.08114427}
confusion matrix:
       0     1
0  11764  6303
1    378   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5164357, 'precision': 0.5362862, 'recall': 0.72557765, 'specificity': 0.72557765, 'f1': 0.4026061, 'auroc': 0.9266721, 'binary_precision': 0.07661415, 'binary_recall': 0.95384616, 'binary_specificity': 0.49730912, 'binary_f1_score': 0.14183585}
confusion matrix:
      0     1
0  2957  2989
1    12   248
early stop counter: 1
val acc:0.6434898376464844, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 3,now: 2024-07-31 14:46:21.861648,epoch time: 0:15:52.265519,used: 0:48:07.542619,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9710844, 'precision': 0.9711089, 'recall': 0.97108185, 'specificity': 0.97108185, 'f1': 0.9710839, 'auroc': 0.9947109, 'binary_precision': 0.967892, 'binary_recall': 0.9745395, 'binary_specificity': 0.96762425, 'binary_f1_score': 0.9712044}
confusion matrix:
       0      1
0  27855    932
1    734  28095
---- Validation: 
scalar performance:
{'acc': 0.87758803, 'precision': 0.548484, 'recall': 0.64182395, 'specificity': 0.64182395, 'f1': 0.5595956, 'auroc': 0.5808008, 'binary_precision': 0.12179188, 'binary_recall': 0.38781574, 'binary_specificity': 0.8958322, 'binary_f1_score': 0.18536931}
confusion matrix:
       0     1
0  16185  1882
1    412   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372543, 'precision': 0.5844076, 'recall': 0.8212806, 'specificity': 0.8212806, 'f1': 0.60038257, 'auroc': 0.9004457, 'binary_precision': 0.17893836, 'binary_recall': 0.8038462, 'binary_specificity': 0.8387151, 'binary_f1_score': 0.2927171}
confusion matrix:
      0    1
0  4987  959
1    51  209
early stop counter: 2
val acc:0.8775880336761475, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 4,now: 2024-07-31 15:02:24.921863,epoch time: 0:16:03.060215,used: 1:04:10.602834,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9529471, 'precision': 0.9549018, 'recall': 0.9529233, 'specificity': 0.9529233, 'f1': 0.9528947, 'auroc': 0.99501145, 'binary_precision': 0.92526376, 'binary_recall': 0.9855701, 'binary_specificity': 0.9202765, 'binary_f1_score': 0.95446527}
confusion matrix:
       0      1
0  26492   2295
1    416  28413
---- Validation: 
scalar performance:
{'acc': 0.71136606, 'precision': 0.5130106, 'recall': 0.5763598, 'specificity': 0.5763598, 'f1': 0.46254042, 'auroc': 0.569363, 'binary_precision': 0.054552294, 'binary_recall': 0.4309064, 'binary_specificity': 0.72181326, 'binary_f1_score': 0.09684421}
confusion matrix:
       0     1
0  13041  5026
1    383   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601031, 'precision': 0.5390746, 'recall': 0.7428491, 'specificity': 0.7428491, 'f1': 0.42758822, 'auroc': 0.90895367, 'binary_precision': 0.08277027, 'binary_recall': 0.9423077, 'binary_specificity': 0.5433905, 'binary_f1_score': 0.15217394}
confusion matrix:
      0     1
0  3231  2715
1    15   245
early stop counter: 3
val acc:0.7113660573959351, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 5,now: 2024-07-31 15:18:16.719467,epoch time: 0:15:51.797604,used: 1:20:02.400438,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9531554, 'precision': 0.95461786, 'recall': 0.9531358, 'specificity': 0.9531358, 'f1': 0.9531162, 'auroc': 0.993736, 'binary_precision': 0.9290053, 'binary_recall': 0.9813723, 'binary_specificity': 0.9248993, 'binary_f1_score': 0.95447105}
confusion matrix:
       0      1
0  26626   2162
1    537  28291
---- Validation: 
scalar performance:
{'acc': 0.72145146, 'precision': 0.51336473, 'recall': 0.5765835, 'specificity': 0.5765835, 'f1': 0.4665612, 'auroc': 0.54654527, 'binary_precision': 0.05534911, 'binary_recall': 0.4205052, 'binary_specificity': 0.7326618, 'binary_f1_score': 0.09782233}
confusion matrix:
       0     1
0  13237  4830
1    390   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5610699, 'precision': 0.5388694, 'recall': 0.7415147, 'specificity': 0.7415147, 'f1': 0.42792165, 'auroc': 0.9061153, 'binary_precision': 0.082655825, 'binary_recall': 0.93846154, 'binary_specificity': 0.54456776, 'binary_f1_score': 0.15193027}
confusion matrix:
      0     1
0  3238  2708
1    16   244
early stop counter: 4
val acc:0.721451461315155, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 6,now: 2024-07-31 15:33:33.332846,epoch time: 0:15:16.613379,used: 1:35:19.013817,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9089836, 'precision': 0.9186004, 'recall': 0.9089284, 'specificity': 0.9089284, 'f1': 0.90844965, 'auroc': 0.9921243, 'binary_precision': 0.85533494, 'binary_recall': 0.9846335, 'binary_specificity': 0.83322334, 'binary_f1_score': 0.9154412}
confusion matrix:
       0      1
0  23986   4801
1    443  28386
---- Validation: 
scalar performance:
{'acc': 0.49861258, 'precision': 0.49658182, 'recall': 0.47531903, 'specificity': 0.47531903, 'f1': 0.35932082, 'auroc': 0.5423722, 'binary_precision': 0.032479364, 'binary_recall': 0.45022288, 'binary_specificity': 0.50041515, 'binary_f1_score': 0.06058788}
confusion matrix:
      0     1
0  9041  9026
1   370   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.19432807, 'precision': 0.5247148, 'recall': 0.57954925, 'specificity': 0.57954925, 'f1': 0.18436205, 'auroc': 0.87765676, 'binary_precision': 0.04942966, 'binary_recall': 1.0, 'binary_specificity': 0.15909855, 'binary_f1_score': 0.0942029}
confusion matrix:
     0     1
0  946  5000
1    0   260
early stop counter: 5
val acc:0.49861258268356323, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 7,now: 2024-07-31 15:49:35.408381,epoch time: 0:16:02.075535,used: 1:51:21.089352,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9037941, 'precision': 0.91430116, 'recall': 0.9037334, 'specificity': 0.9037334, 'f1': 0.9031707, 'auroc': 0.9908648, 'binary_precision': 0.8485139, 'binary_recall': 0.9832813, 'binary_specificity': 0.8241854, 'binary_f1_score': 0.9109401}
confusion matrix:
       0      1
0  23725   5061
1    482  28348
---- Validation: 
scalar performance:
{'acc': 0.515048, 'precision': 0.4969653, 'recall': 0.47812068, 'specificity': 0.47812068, 'f1': 0.36704004, 'auroc': 0.5327802, 'binary_precision': 0.032759577, 'binary_recall': 0.4383358, 'binary_specificity': 0.5179056, 'binary_f1_score': 0.06096301}
confusion matrix:
      0     1
0  9357  8710
1   378   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3312923, 'precision': 0.52721745, 'recall': 0.639992, 'specificity': 0.639992, 'f1': 0.28692603, 'auroc': 0.8313061, 'binary_precision': 0.057753526, 'binary_recall': 0.97692305, 'binary_specificity': 0.3030609, 'binary_f1_score': 0.10905969}
confusion matrix:
      0     1
0  1802  4144
1     6   254
early stop counter: 6
val acc:0.5150480270385742, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 8,now: 2024-07-31 16:04:33.468788,epoch time: 0:14:58.060407,used: 2:06:19.149759,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9023882, 'precision': 0.91430974, 'recall': 0.9023235, 'specificity': 0.9023235, 'f1': 0.90167063, 'auroc': 0.9926085, 'binary_precision': 0.84422094, 'binary_recall': 0.9870621, 'binary_specificity': 0.81758493, 'binary_f1_score': 0.91007066}
confusion matrix:
       0      1
0  23535   5251
1    373  28457
---- Validation: 
scalar performance:
{'acc': 0.48367128, 'precision': 0.4952086, 'recall': 0.46542427, 'specificity': 0.46542427, 'f1': 0.35135275, 'auroc': 0.52243525, 'binary_precision': 0.031240238, 'binary_recall': 0.44576523, 'binary_specificity': 0.4850833, 'binary_f1_score': 0.05838848}
confusion matrix:
      0     1
0  8764  9303
1   373   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.21124718, 'precision': 0.5246562, 'recall': 0.58653975, 'specificity': 0.58653975, 'f1': 0.19815496, 'auroc': 0.8470936, 'binary_precision': 0.05026198, 'binary_recall': 0.99615383, 'binary_specificity': 0.17692566, 'binary_f1_score': 0.09569555}
confusion matrix:
      0     1
0  1052  4894
1     1   259
early stop counter: 7
val acc:0.48367127776145935, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 9,now: 2024-07-31 16:20:11.064745,epoch time: 0:15:37.595957,used: 2:21:56.745716,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8919571, 'precision': 0.9069477, 'recall': 0.8918872, 'specificity': 0.8918872, 'f1': 0.8909404, 'auroc': 0.99227446, 'binary_precision': 0.82902473, 'binary_recall': 0.98779005, 'binary_specificity': 0.7959843, 'binary_f1_score': 0.9014704}
confusion matrix:
       0      1
0  22914   5873
1    352  28477
---- Validation: 
scalar performance:
{'acc': 0.48938102, 'precision': 0.49611613, 'recall': 0.4719618, 'specificity': 0.4719618, 'f1': 0.35471365, 'auroc': 0.5432653, 'binary_precision': 0.032084998, 'binary_recall': 0.45319465, 'binary_specificity': 0.49072894, 'binary_f1_score': 0.0599273}
confusion matrix:
      0     1
0  8866  9201
1   368   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.16951337, 'precision': 0.52401185, 'recall': 0.56659937, 'specificity': 0.56659937, 'f1': 0.16336535, 'auroc': 0.8835808, 'binary_precision': 0.04802364, 'binary_recall': 1.0, 'binary_specificity': 0.13319878, 'binary_f1_score': 0.0916461}
confusion matrix:
     0     1
0  792  5154
1    0   260
early stop counter: 8
val acc:0.48938101530075073, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 10,now: 2024-07-31 16:35:14.005972,epoch time: 0:15:02.941227,used: 2:36:59.686943,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90874064, 'precision': 0.9200398, 'recall': 0.90867805, 'specificity': 0.90867805, 'f1': 0.9081135, 'auroc': 0.99426585, 'binary_precision': 0.85133845, 'binary_recall': 0.99060005, 'binary_specificity': 0.82675606, 'binary_f1_score': 0.9157048}
confusion matrix:
       0      1
0  23799   4987
1    271  28559
---- Validation: 
scalar performance:
{'acc': 0.47785485, 'precision': 0.49528244, 'recall': 0.46598405, 'specificity': 0.46598405, 'f1': 0.348706, 'auroc': 0.55118227, 'binary_precision': 0.031372145, 'binary_recall': 0.45319465, 'binary_specificity': 0.47877344, 'binary_f1_score': 0.058682054}
confusion matrix:
      0     1
0  8650  9417
1   368   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.25136966, 'precision': 0.526023, 'recall': 0.6074782, 'specificity': 0.6074782, 'f1': 0.2296527, 'auroc': 0.89428186, 'binary_precision': 0.05281403, 'binary_recall': 0.99615383, 'binary_specificity': 0.21880256, 'binary_f1_score': 0.100309834}
confusion matrix:
      0     1
0  1301  4645
1     1   259
early stop counter: 9
val acc:0.47785484790802, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 11,now: 2024-07-31 16:50:20.822978,epoch time: 0:15:06.817006,used: 2:52:06.503949,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.923615, 'precision': 0.9297998, 'recall': 0.92357135, 'specificity': 0.92357135, 'f1': 0.9233339, 'auroc': 0.99276066, 'binary_precision': 0.8784236, 'binary_recall': 0.98345417, 'binary_specificity': 0.86368847, 'binary_f1_score': 0.9279765}
confusion matrix:
       0      1
0  24863   3924
1    477  28352
---- Validation: 
scalar performance:
{'acc': 0.6511206, 'precision': 0.5070313, 'recall': 0.54583025, 'specificity': 0.54583025, 'f1': 0.43319622, 'auroc': 0.5388907, 'binary_precision': 0.045137275, 'binary_recall': 0.43239227, 'binary_specificity': 0.65926826, 'binary_f1_score': 0.08174157}
confusion matrix:
       0     1
0  11911  6156
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5505962, 'precision': 0.5370465, 'recall': 0.7305318, 'specificity': 0.7305318, 'f1': 0.42112336, 'auroc': 0.8669909, 'binary_precision': 0.08003985, 'binary_recall': 0.9269231, 'binary_specificity': 0.5341406, 'binary_f1_score': 0.14735556}
confusion matrix:
      0     1
0  3176  2770
1    19   241
early stop counter: 10
val acc:0.6511206030845642, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 12,now: 2024-07-31 17:06:03.294739,epoch time: 0:15:42.471761,used: 3:07:48.975710,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9147806, 'precision': 0.9249601, 'recall': 0.91472423, 'specificity': 0.91472423, 'f1': 0.91425943, 'auroc': 0.99522406, 'binary_precision': 0.85937077, 'binary_recall': 0.9920219, 'binary_specificity': 0.8374266, 'binary_f1_score': 0.9209441}
confusion matrix:
       0      1
0  24107   4680
1    230  28599
---- Validation: 
scalar performance:
{'acc': 0.6247065, 'precision': 0.50582516, 'recall': 0.53928393, 'specificity': 0.53928393, 'f1': 0.4215983, 'auroc': 0.56349003, 'binary_precision': 0.043234702, 'binary_recall': 0.4472511, 'binary_specificity': 0.6313168, 'binary_f1_score': 0.078847416}
confusion matrix:
       0     1
0  11406  6661
1    372   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42620045, 'precision': 0.5308071, 'recall': 0.68216515, 'specificity': 0.68216515, 'f1': 0.3483532, 'auroc': 0.9070408, 'binary_precision': 0.06577217, 'binary_recall': 0.96153843, 'binary_specificity': 0.4027918, 'binary_f1_score': 0.12312239}
confusion matrix:
      0     1
0  2395  3551
1    10   250
early stop counter: 11
val acc:0.624706506729126, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 13,now: 2024-07-31 17:20:57.290946,epoch time: 0:14:53.996207,used: 3:22:42.971917,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90514785, 'precision': 0.9172439, 'recall': 0.90508884, 'specificity': 0.90508884, 'f1': 0.9044463, 'auroc': 0.9936338, 'binary_precision': 0.8463751, 'binary_recall': 0.9901485, 'binary_specificity': 0.8200292, 'binary_f1_score': 0.91263413}
confusion matrix:
       0      1
0  23607   5181
1    284  28544
---- Validation: 
scalar performance:
{'acc': 0.505603, 'precision': 0.497083, 'recall': 0.47894442, 'specificity': 0.47894442, 'f1': 0.36290652, 'auroc': 0.54663074, 'binary_precision': 0.032941945, 'binary_recall': 0.45022288, 'binary_specificity': 0.50766593, 'binary_f1_score': 0.061391957}
confusion matrix:
      0     1
0  9172  8895
1   370   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.27199483, 'precision': 0.52500224, 'recall': 0.6108858, 'specificity': 0.6108858, 'f1': 0.24478424, 'auroc': 0.8719469, 'binary_precision': 0.053481545, 'binary_recall': 0.9807692, 'binary_specificity': 0.24100235, 'binary_f1_score': 0.10143198}
confusion matrix:
      0     1
0  1433  4513
1     5   255
early stop counter: 12
val acc:0.505603015422821, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 14,now: 2024-07-31 17:36:12.808849,epoch time: 0:15:15.517903,used: 3:37:58.489820,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92274714, 'precision': 0.93019044, 'recall': 0.9227016, 'specificity': 0.9227016, 'f1': 0.9224059, 'auroc': 0.99440897, 'binary_precision': 0.87377715, 'binary_recall': 0.98837936, 'binary_specificity': 0.8570238, 'binary_f1_score': 0.9275518}
confusion matrix:
       0      1
0  24672   4116
1    335  28493
---- Validation: 
scalar performance:
{'acc': 0.6745464, 'precision': 0.5092161, 'recall': 0.5579795, 'specificity': 0.5579795, 'f1': 0.44454342, 'auroc': 0.5624888, 'binary_precision': 0.04843542, 'binary_recall': 0.43239227, 'binary_specificity': 0.68356675, 'binary_f1_score': 0.08711271}
confusion matrix:
       0     1
0  12350  5717
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4798582, 'precision': 0.5339131, 'recall': 0.7083282, 'specificity': 0.7083282, 'f1': 0.38101146, 'auroc': 0.88973844, 'binary_precision': 0.07184074, 'binary_recall': 0.9576923, 'binary_specificity': 0.45896402, 'binary_f1_score': 0.13365541}
confusion matrix:
      0     1
0  2729  3217
1    11   249
early stop counter: 13
val acc:0.6745464205741882, best validation acc: 0.9191035032272339, corresponding to test acc:                         0.9118595123291016 / 0.9395745992660522
after epoch: 15,now: 2024-07-31 17:52:26.355975,epoch time: 0:16:13.547126,used: 3:54:12.036946,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_58_13_seed_1_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:54:12.036946 at 2024-07-31 17:52:26.355975
persisted model performance metric: 

scalar performance:
{'acc': 0.9118595, 'precision': 0.6428324, 'recall': 0.8565364, 'specificity': 0.8565364, 'f1': 0.6915162, 'auroc': 0.91214263, 'binary_precision': 0.29529244, 'binary_recall': 0.79615384, 'binary_specificity': 0.91691893, 'binary_f1_score': 0.43080124}
confusion matrix:
      0    1
0  5452  494
1    53  207
oracle model performance metric: 

scalar performance:
{'acc': 0.9395746, 'precision': 0.68076915, 'recall': 0.8121523, 'specificity': 0.8121523, 'f1': 0.72533584, 'auroc': 0.8707567, 'binary_precision': 0.37634408, 'binary_recall': 0.6730769, 'binary_specificity': 0.9512277, 'binary_f1_score': 0.4827586}
confusion matrix:
      0    1
0  5656  290
1    85  175
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 495887 KiB |  11071 MiB |   1268 TiB |   1268 TiB |
|       from large pool | 406080 KiB |  10997 MiB |   1267 TiB |   1267 TiB |
|       from small pool |  89807 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 495887 KiB |  11071 MiB |   1268 TiB |   1268 TiB |
|       from large pool | 406080 KiB |  10997 MiB |   1267 TiB |   1267 TiB |
|       from small pool |  89807 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10961 MiB |   1262 TiB |   1262 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1260 TiB |   1260 TiB |
|       from small pool |  88730 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11366 MiB |  11374 MiB |  20898 MiB |   9532 MiB |
|       from large pool |  11242 MiB |  11248 MiB |  20746 MiB |   9504 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1017 MiB |   2228 MiB | 450791 GiB | 450790 GiB |
|       from large pool |   1007 MiB |   2225 MiB | 449005 GiB | 449004 GiB |
|       from small pool |     10 MiB |     22 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    8448    |  114517 K  |  114513 K  |
|       from large pool |      87    |     909    |   48503 K  |   48503 K  |
|       from small pool |    3618    |    8359    |   66013 K  |   66010 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    8448    |  114517 K  |  114513 K  |
|       from large pool |      87    |     909    |   48503 K  |   48503 K  |
|       from small pool |    3618    |    8359    |   66013 K  |   66010 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     235    |     388    |     156    |
|       from large pool |     170    |     172    |     312    |     142    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3629    |   58259 K  |   58258 K  |
|       from large pool |      18    |      62    |   24346 K  |   24346 K  |
|       from small pool |      55    |    3610    |   33912 K  |   33912 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1268 TiB |   1268 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1267 TiB |   1267 TiB |
|       from small pool |      0 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1268 TiB |   1268 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1267 TiB |   1267 TiB |
|       from small pool |      0 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1262 TiB |   1262 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1260 TiB |   1260 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1502 MiB |  11374 MiB |  20898 MiB |  19396 MiB |
|       from large pool |   1404 MiB |  11248 MiB |  20746 MiB |  19342 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2228 MiB | 450791 GiB | 450791 GiB |
|       from large pool | 134912 KiB |   2225 MiB | 449005 GiB | 449005 GiB |
|       from small pool |      0 KiB |     26 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  114517 K  |  114517 K  |
|       from large pool |       2    |     909    |   48503 K  |   48503 K  |
|       from small pool |       0    |    8359    |   66013 K  |   66013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  114517 K  |  114517 K  |
|       from large pool |       2    |     909    |   48503 K  |   48503 K  |
|       from small pool |       0    |    8359    |   66013 K  |   66013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     235    |     388    |     307    |
|       from large pool |      32    |     172    |     312    |     280    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3629    |   58260 K  |   58260 K  |
|       from large pool |       4    |      62    |   24346 K  |   24346 K  |
|       from small pool |       0    |    3610    |   33913 K  |   33913 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1268 TiB |   1268 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1267 TiB |   1267 TiB |
|       from small pool |      0 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1268 TiB |   1268 TiB |
|       from large pool |  16640 KiB |  10997 MiB |   1267 TiB |   1267 TiB |
|       from small pool |      0 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1262 TiB |   1262 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1260 TiB |   1260 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1502 MiB |  11374 MiB |  20898 MiB |  19396 MiB |
|       from large pool |   1404 MiB |  11248 MiB |  20746 MiB |  19342 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2228 MiB | 450791 GiB | 450791 GiB |
|       from large pool | 134912 KiB |   2225 MiB | 449005 GiB | 449005 GiB |
|       from small pool |      0 KiB |     26 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  114517 K  |  114517 K  |
|       from large pool |       2    |     909    |   48503 K  |   48503 K  |
|       from small pool |       0    |    8359    |   66013 K  |   66013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  114517 K  |  114517 K  |
|       from large pool |       2    |     909    |   48503 K  |   48503 K  |
|       from small pool |       0    |    8359    |   66013 K  |   66013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     235    |     388    |     307    |
|       from large pool |      32    |     172    |     312    |     280    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3629    |   58260 K  |   58260 K  |
|       from large pool |       4    |      62    |   24346 K  |   24346 K  |
|       from small pool |       0    |    3610    |   33913 K  |   33913 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369

 Experiment start at: 2024-07-31 18:00:24.460864
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97015643, 'precision': 0.97018754, 'recall': 0.97015727, 'specificity': 0.97015727, 'f1': 0.97015595, 'auroc': 0.99430025, 'binary_precision': 0.9740646, 'binary_recall': 0.96604705, 'binary_specificity': 0.9742675, 'binary_f1_score': 0.97003925}
confusion matrix:
       0      1
0  28396    750
1    990  28168
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9286209, 'precision': 0.59986967, 'recall': 0.7085617, 'specificity': 0.7085617, 'f1': 0.6304134, 'auroc': 0.8001751, 'binary_precision': 0.2178899, 'binary_recall': 0.47342193, 'binary_specificity': 0.9437015, 'binary_f1_score': 0.2984293}
confusion matrix:
       0     1
0  17148  1023
1    317   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95095366, 'precision': 0.702804, 'recall': 0.8218162, 'specificity': 0.8218162, 'f1': 0.74651384, 'auroc': 0.8898492, 'binary_precision': 0.41878173, 'binary_recall': 0.6818182, 'binary_specificity': 0.9618142, 'binary_f1_score': 0.51886797}
confusion matrix:
      0    1
0  5768  229
1    77  165
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 18:17:35.922830,epoch time: 0:17:11.461966,used: 0:17:11.461966,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9598827, 'precision': 0.9607494, 'recall': 0.9598805, 'specificity': 0.9598805, 'f1': 0.95986366, 'auroc': 0.9948462, 'binary_precision': 0.9407916, 'binary_recall': 0.9815469, 'binary_specificity': 0.938214, 'binary_f1_score': 0.96073717}
confusion matrix:
       0      1
0  27348   1801
1    538  28617
---- Validation: 
scalar performance:
{'acc': 0.78911203, 'precision': 0.5246209, 'recall': 0.630875, 'specificity': 0.630875, 'f1': 0.501644, 'auroc': 0.67758703, 'binary_precision': 0.071045235, 'binary_recall': 0.46179402, 'binary_specificity': 0.79995596, 'binary_f1_score': 0.12314507}
confusion matrix:
       0     1
0  14536  3635
1    324   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74803656, 'precision': 0.55903864, 'recall': 0.82134867, 'specificity': 0.82134867, 'f1': 0.5334941, 'auroc': 0.9169916, 'binary_precision': 0.12344281, 'binary_recall': 0.90082645, 'binary_specificity': 0.74187094, 'binary_f1_score': 0.21713148}
confusion matrix:
      0     1
0  4449  1548
1    24   218
early stop counter: 1
val acc:0.7891120314598083, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 2,now: 2024-07-31 18:33:22.955526,epoch time: 0:15:47.032696,used: 0:32:58.494662,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93890643, 'precision': 0.9431858, 'recall': 0.9388963, 'specificity': 0.9388963, 'f1': 0.9387576, 'auroc': 0.9949019, 'binary_precision': 0.8996877, 'binary_recall': 0.98799646, 'binary_specificity': 0.8897962, 'binary_f1_score': 0.94177645}
confusion matrix:
       0      1
0  25934   3212
1    350  28808
---- Validation: 
scalar performance:
{'acc': 0.69035316, 'precision': 0.5123353, 'recall': 0.58467793, 'specificity': 0.58467793, 'f1': 0.4512455, 'auroc': 0.61416435, 'binary_precision': 0.049143452, 'binary_recall': 0.4717608, 'binary_specificity': 0.69759506, 'binary_f1_score': 0.08901427}
confusion matrix:
       0     1
0  12676  5495
1    318   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5523321, 'precision': 0.53515685, 'recall': 0.73540974, 'specificity': 0.73540974, 'f1': 0.41839468, 'auroc': 0.9201791, 'binary_precision': 0.075258076, 'binary_recall': 0.9338843, 'binary_specificity': 0.53693515, 'binary_f1_score': 0.13929123}
confusion matrix:
      0     1
0  3220  2777
1    16   226
early stop counter: 2
val acc:0.6903531551361084, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 3,now: 2024-07-31 18:50:08.129038,epoch time: 0:16:45.173512,used: 0:49:43.668174,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9557835, 'precision': 0.9573437, 'recall': 0.95577747, 'specificity': 0.95577747, 'f1': 0.95574534, 'auroc': 0.9947609, 'binary_precision': 0.9306825, 'binary_recall': 0.9849441, 'binary_specificity': 0.9266108, 'binary_f1_score': 0.9570448}
confusion matrix:
       0      1
0  27007   2139
1    439  28719
---- Validation: 
scalar performance:
{'acc': 0.82054013, 'precision': 0.52723145, 'recall': 0.6262304, 'specificity': 0.6262304, 'f1': 0.51504064, 'auroc': 0.596521, 'binary_precision': 0.07704066, 'binary_recall': 0.41860464, 'binary_specificity': 0.83385617, 'binary_f1_score': 0.13013168}
confusion matrix:
       0     1
0  15152  3019
1    350   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7876262, 'precision': 0.5685352, 'recall': 0.8379768, 'specificity': 0.8379768, 'f1': 0.5611422, 'auroc': 0.9225763, 'binary_precision': 0.14257425, 'binary_recall': 0.892562, 'binary_specificity': 0.7833917, 'binary_f1_score': 0.24587363}
confusion matrix:
      0     1
0  4698  1299
1    26   216
early stop counter: 3
val acc:0.8205401301383972, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 4,now: 2024-07-31 19:06:27.698094,epoch time: 0:16:19.569056,used: 1:06:03.237230,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9620952, 'precision': 0.96268094, 'recall': 0.96209097, 'specificity': 0.96209097, 'f1': 0.962083, 'auroc': 0.99401855, 'binary_precision': 0.9462789, 'binary_recall': 0.9798347, 'binary_specificity': 0.9443472, 'binary_f1_score': 0.9627645}
confusion matrix:
       0      1
0  27523   1622
1    588  28571
---- Validation: 
scalar performance:
{'acc': 0.79465187, 'precision': 0.5214417, 'recall': 0.6104483, 'specificity': 0.6104483, 'f1': 0.49913245, 'auroc': 0.55311805, 'binary_precision': 0.0663823, 'binary_recall': 0.41362128, 'binary_specificity': 0.80727535, 'binary_f1_score': 0.114403866}
confusion matrix:
       0     1
0  14669  3502
1    353   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59673023, 'precision': 0.53799874, 'recall': 0.75057364, 'specificity': 0.75057364, 'f1': 0.4428294, 'auroc': 0.90891385, 'binary_precision': 0.081677705, 'binary_recall': 0.91735536, 'binary_specificity': 0.5837919, 'binary_f1_score': 0.14999999}
confusion matrix:
      0     1
0  3501  2496
1    20   222
early stop counter: 4
val acc:0.7946518659591675, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 5,now: 2024-07-31 19:25:57.685143,epoch time: 0:19:29.987049,used: 1:25:33.224279,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9626441, 'precision': 0.963627, 'recall': 0.9626401, 'specificity': 0.9626401, 'f1': 0.9626241, 'auroc': 0.9953201, 'binary_precision': 0.9423222, 'binary_recall': 0.9856295, 'binary_specificity': 0.9396507, 'binary_f1_score': 0.9634895}
confusion matrix:
       0      1
0  27388   1759
1    419  28738
---- Validation: 
scalar performance:
{'acc': 0.81265646, 'precision': 0.5249873, 'recall': 0.61974883, 'specificity': 0.61974883, 'f1': 0.50957346, 'auroc': 0.5732813, 'binary_precision': 0.072956346, 'binary_recall': 0.41362128, 'binary_specificity': 0.8258764, 'binary_f1_score': 0.124034874}
confusion matrix:
       0     1
0  15007  3164
1    353   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68071806, 'precision': 0.5481203, 'recall': 0.7942622, 'specificity': 0.7942622, 'f1': 0.4919496, 'auroc': 0.90742826, 'binary_precision': 0.10118505, 'binary_recall': 0.91735536, 'binary_specificity': 0.6711689, 'binary_f1_score': 0.18226601}
confusion matrix:
      0     1
0  4025  1972
1    20   222
early stop counter: 5
val acc:0.8126564621925354, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 6,now: 2024-07-31 19:46:41.771464,epoch time: 0:20:44.086321,used: 1:46:17.310600,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9273978, 'precision': 0.9338516, 'recall': 0.9273852, 'specificity': 0.9273852, 'f1': 0.92712533, 'auroc': 0.99452996, 'binary_precision': 0.88098806, 'binary_recall': 0.98833936, 'binary_specificity': 0.86643106, 'binary_f1_score': 0.93158126}
confusion matrix:
       0      1
0  25253   3893
1    340  28818
---- Validation: 
scalar performance:
{'acc': 0.61668354, 'precision': 0.5046611, 'recall': 0.5353801, 'specificity': 0.5353801, 'f1': 0.414204, 'auroc': 0.5667976, 'binary_precision': 0.03784693, 'binary_recall': 0.44850498, 'binary_specificity': 0.62225527, 'binary_f1_score': 0.06980351}
confusion matrix:
       0     1
0  11307  6864
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.35069722, 'precision': 0.5260315, 'recall': 0.65035135, 'specificity': 0.65035135, 'f1': 0.297558, 'auroc': 0.8915934, 'binary_precision': 0.055127308, 'binary_recall': 0.9752066, 'binary_specificity': 0.32549608, 'binary_f1_score': 0.10435552}
confusion matrix:
      0     1
0  1952  4045
1     6   236
early stop counter: 6
val acc:0.6166835427284241, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 7,now: 2024-07-31 20:02:12.186731,epoch time: 0:15:30.415267,used: 2:01:47.725867,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93338364, 'precision': 0.9386364, 'recall': 0.9333743, 'specificity': 0.9333743, 'f1': 0.9331826, 'auroc': 0.99500847, 'binary_precision': 0.89067864, 'binary_recall': 0.9880646, 'binary_specificity': 0.8786839, 'binary_f1_score': 0.9368476}
confusion matrix:
       0      1
0  25611   3536
1    348  28809
---- Validation: 
scalar performance:
{'acc': 0.68971395, 'precision': 0.5099745, 'recall': 0.5682868, 'specificity': 0.5682868, 'f1': 0.44818485, 'auroc': 0.56707096, 'binary_precision': 0.04590506, 'binary_recall': 0.4385382, 'binary_specificity': 0.69803536, 'binary_f1_score': 0.08311034}
confusion matrix:
       0     1
0  12684  5487
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56595606, 'precision': 0.53514045, 'recall': 0.7345656, 'specificity': 0.7345656, 'f1': 0.42524597, 'auroc': 0.8959149, 'binary_precision': 0.07628866, 'binary_recall': 0.91735536, 'binary_specificity': 0.5517759, 'binary_f1_score': 0.14086294}
confusion matrix:
      0     1
0  3309  2688
1    20   222
early stop counter: 7
val acc:0.6897139549255371, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 8,now: 2024-07-31 20:17:32.886579,epoch time: 0:15:20.699848,used: 2:17:08.425715,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92556256, 'precision': 0.93197024, 'recall': 0.92555004, 'specificity': 0.92555004, 'f1': 0.925284, 'auroc': 0.993896, 'binary_precision': 0.8794105, 'binary_recall': 0.98641884, 'binary_specificity': 0.86468124, 'binary_f1_score': 0.9298461}
confusion matrix:
       0      1
0  25202   3944
1    396  28762
---- Validation: 
scalar performance:
{'acc': 0.644596, 'precision': 0.5071005, 'recall': 0.5522078, 'specificity': 0.5522078, 'f1': 0.42782474, 'auroc': 0.56230736, 'binary_precision': 0.041263603, 'binary_recall': 0.45348838, 'binary_specificity': 0.6509273, 'binary_f1_score': 0.07564422}
confusion matrix:
       0     1
0  11828  6343
1    329   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48934123, 'precision': 0.53166735, 'recall': 0.71057427, 'specificity': 0.71057427, 'f1': 0.38271597, 'auroc': 0.8934674, 'binary_precision': 0.067567565, 'binary_recall': 0.9504132, 'binary_specificity': 0.47073537, 'binary_f1_score': 0.12616564}
confusion matrix:
      0     1
0  2823  3174
1    12   230
early stop counter: 8
val acc:0.6445959806442261, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 9,now: 2024-07-31 20:33:09.452503,epoch time: 0:15:36.565924,used: 2:32:44.991639,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.92226946, 'precision': 0.9298195, 'recall': 0.9222604, 'specificity': 0.9222604, 'f1': 0.92192554, 'auroc': 0.9942206, 'binary_precision': 0.8728875, 'binary_recall': 0.9885101, 'binary_specificity': 0.8560107, 'binary_f1_score': 0.9271078}
confusion matrix:
       0      1
0  24951   4197
1    335  28821
---- Validation: 
scalar performance:
{'acc': 0.70020777, 'precision': 0.5113339, 'recall': 0.5761166, 'specificity': 0.5761166, 'f1': 0.45366654, 'auroc': 0.5835961, 'binary_precision': 0.04802158, 'binary_recall': 0.4435216, 'binary_specificity': 0.7087117, 'binary_f1_score': 0.08666017}
confusion matrix:
       0     1
0  12878  5293
1    335   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4789229, 'precision': 0.53128874, 'recall': 0.70713764, 'specificity': 0.70713764, 'f1': 0.3767603, 'auroc': 0.87995446, 'binary_precision': 0.066551425, 'binary_recall': 0.95454544, 'binary_specificity': 0.45972985, 'binary_f1_score': 0.1244277}
confusion matrix:
      0     1
0  2757  3240
1    11   231
early stop counter: 9
val acc:0.7002077698707581, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 10,now: 2024-07-31 20:48:23.735892,epoch time: 0:15:14.283389,used: 2:47:59.275028,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9330406, 'precision': 0.9388783, 'recall': 0.9330307, 'specificity': 0.9330307, 'f1': 0.93281615, 'auroc': 0.99606836, 'binary_precision': 0.8883046, 'binary_recall': 0.9906712, 'binary_specificity': 0.8753903, 'binary_f1_score': 0.93669945}
confusion matrix:
       0      1
0  25515   3632
1    272  28885
---- Validation: 
scalar performance:
{'acc': 0.65365154, 'precision': 0.5070647, 'recall': 0.5512643, 'specificity': 0.5512643, 'f1': 0.4312681, 'auroc': 0.5678788, 'binary_precision': 0.04135572, 'binary_recall': 0.44186047, 'binary_specificity': 0.6606681, 'binary_f1_score': 0.07563264}
confusion matrix:
       0     1
0  12005  6166
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4689854, 'precision': 0.53065926, 'recall': 0.70196843, 'specificity': 0.70196843, 'f1': 0.3708554, 'auroc': 0.8868069, 'binary_precision': 0.06538352, 'binary_recall': 0.95454544, 'binary_specificity': 0.44939137, 'binary_f1_score': 0.1223841}
confusion matrix:
      0     1
0  2695  3302
1    11   231
early stop counter: 10
val acc:0.6536515355110168, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 11,now: 2024-07-31 21:03:39.131578,epoch time: 0:15:15.395686,used: 3:03:14.670714,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9551489, 'precision': 0.9569807, 'recall': 0.9551424, 'specificity': 0.9551424, 'f1': 0.9551034, 'auroc': 0.9959114, 'binary_precision': 0.9280991, 'binary_recall': 0.9867618, 'binary_specificity': 0.92352295, 'binary_f1_score': 0.9565318}
confusion matrix:
       0      1
0  26917   2229
1    386  28772
---- Validation: 
scalar performance:
{'acc': 0.77600807, 'precision': 0.5199966, 'recall': 0.61045414, 'specificity': 0.61045414, 'f1': 0.49115124, 'auroc': 0.6153596, 'binary_precision': 0.06327273, 'binary_recall': 0.43355483, 'binary_specificity': 0.78735346, 'binary_f1_score': 0.11042946}
confusion matrix:
       0     1
0  14307  3864
1    341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68264145, 'precision': 0.54565614, 'recall': 0.777418, 'specificity': 0.777418, 'f1': 0.4902364, 'auroc': 0.88513935, 'binary_precision': 0.09842884, 'binary_recall': 0.8801653, 'binary_specificity': 0.6746707, 'binary_f1_score': 0.17705736}
confusion matrix:
      0     1
0  4046  1951
1    29   213
early stop counter: 11
val acc:0.7760080695152283, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 12,now: 2024-07-31 21:18:42.527842,epoch time: 0:15:03.396264,used: 3:18:18.066978,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8866116, 'precision': 0.90389776, 'recall': 0.8865938, 'specificity': 0.8865938, 'f1': 0.88538194, 'auroc': 0.99174464, 'binary_precision': 0.82038313, 'binary_recall': 0.99001956, 'binary_specificity': 0.7831681, 'binary_f1_score': 0.8972539}
confusion matrix:
       0      1
0  22827   6320
1    291  28866
---- Validation: 
scalar performance:
{'acc': 0.51680607, 'precision': 0.49808368, 'recall': 0.48458996, 'specificity': 0.48458996, 'f1': 0.36582032, 'auroc': 0.5247388, 'binary_precision': 0.030074354, 'binary_recall': 0.4501661, 'binary_specificity': 0.5190138, 'binary_f1_score': 0.05638198}
confusion matrix:
      0     1
0  9431  8740
1   331   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.171021, 'precision': 0.5202918, 'recall': 0.56283617, 'specificity': 0.56283617, 'f1': 0.16356626, 'auroc': 0.79792464, 'binary_precision': 0.044193786, 'binary_recall': 0.9876033, 'binary_specificity': 0.13806903, 'binary_f1_score': 0.084601775}
confusion matrix:
     0     1
0  828  5169
1    3   239
early stop counter: 12
val acc:0.5168060660362244, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 13,now: 2024-07-31 21:34:02.750768,epoch time: 0:15:20.222926,used: 3:33:38.289904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8917227, 'precision': 0.90788025, 'recall': 0.8917124, 'specificity': 0.8917124, 'f1': 0.8906379, 'auroc': 0.99278665, 'binary_precision': 0.826725, 'binary_recall': 0.99121934, 'binary_specificity': 0.7922056, 'binary_f1_score': 0.90153015}
confusion matrix:
       0      1
0  23092   6057
1    256  28899
---- Validation: 
scalar performance:
{'acc': 0.5142492, 'precision': 0.49792022, 'recall': 0.48326918, 'specificity': 0.48326918, 'f1': 0.3645401, 'auroc': 0.5436695, 'binary_precision': 0.029915001, 'binary_recall': 0.4501661, 'binary_specificity': 0.51637226, 'binary_f1_score': 0.05610185}
confusion matrix:
      0     1
0  9383  8788
1   331   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.19538388, 'precision': 0.5200299, 'recall': 0.5715437, 'specificity': 0.5715437, 'f1': 0.18374507, 'auroc': 0.80392724, 'binary_precision': 0.045125667, 'binary_recall': 0.9793388, 'binary_specificity': 0.16374855, 'binary_f1_score': 0.086275935}
confusion matrix:
     0     1
0  982  5015
1    5   237
early stop counter: 13
val acc:0.5142492055892944, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 14,now: 2024-07-31 21:49:05.850198,epoch time: 0:15:03.099430,used: 3:48:41.389334,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.91401964, 'precision': 0.9238583, 'recall': 0.91400397, 'specificity': 0.91400397, 'f1': 0.91351557, 'auroc': 0.9943886, 'binary_precision': 0.8593327, 'binary_recall': 0.99015707, 'binary_specificity': 0.8378508, 'binary_f1_score': 0.9201179}
confusion matrix:
       0      1
0  24420   4726
1    287  28871
---- Validation: 
scalar performance:
{'acc': 0.5891973, 'precision': 0.50272304, 'recall': 0.5211817, 'specificity': 0.5211817, 'f1': 0.40108827, 'auroc': 0.55815876, 'binary_precision': 0.03529412, 'binary_recall': 0.44850498, 'binary_specificity': 0.59385836, 'binary_f1_score': 0.06543869}
confusion matrix:
       0     1
0  10791  7380
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32713577, 'precision': 0.5242428, 'recall': 0.63412976, 'specificity': 0.63412976, 'f1': 0.28146085, 'auroc': 0.83000314, 'binary_precision': 0.05289331, 'binary_recall': 0.96694213, 'binary_specificity': 0.30131733, 'binary_f1_score': 0.100300044}
confusion matrix:
      0     1
0  1807  4190
1     8   234
early stop counter: 14
val acc:0.5891972780227661, best validation acc: 0.9286208748817444, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 15,now: 2024-07-31 22:04:07.488151,epoch time: 0:15:01.637953,used: 4:03:43.027287,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_18_00_24_seed_2_23775369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:03:43.027287 at 2024-07-31 22:04:07.488151
persisted model performance metric: 

scalar performance:
{'acc': 0.95095366, 'precision': 0.702804, 'recall': 0.8218162, 'specificity': 0.8218162, 'f1': 0.74651384, 'auroc': 0.8898492, 'binary_precision': 0.41878173, 'binary_recall': 0.6818182, 'binary_specificity': 0.9618142, 'binary_f1_score': 0.51886797}
confusion matrix:
      0    1
0  5768  229
1    77  165
oracle model performance metric: 

scalar performance:
{'acc': 0.95095366, 'precision': 0.702804, 'recall': 0.8218162, 'specificity': 0.8218162, 'f1': 0.74651384, 'auroc': 0.8898492, 'binary_precision': 0.41878173, 'binary_recall': 0.6818182, 'binary_specificity': 0.9618142, 'binary_f1_score': 0.51886797}
confusion matrix:
      0    1
0  5768  229
1    77  165
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 497301 KiB |  11072 MiB |   1931 TiB |   1931 TiB |
|       from large pool | 407488 KiB |  10999 MiB |   1929 TiB |   1929 TiB |
|       from small pool |  89813 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 497301 KiB |  11072 MiB |   1931 TiB |   1931 TiB |
|       from large pool | 407488 KiB |  10999 MiB |   1929 TiB |   1929 TiB |
|       from small pool |  89813 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10961 MiB |   1923 TiB |   1923 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1920 TiB |   1920 TiB |
|       from small pool |  88732 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11230 MiB |  11374 MiB |  30626 MiB |  19396 MiB |
|       from large pool |  11106 MiB |  11248 MiB |  30448 MiB |  19342 MiB |
|       from small pool |    124 MiB |    126 MiB |    178 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1104 MiB |   2309 MiB | 664704 GiB | 664703 GiB |
|       from large pool |   1098 MiB |   2306 MiB | 661958 GiB | 661957 GiB |
|       from small pool |      6 MiB |     26 MiB |   2746 GiB |   2746 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    8534    |  174050 K  |  174047 K  |
|       from large pool |      87    |     909    |   73951 K  |   73951 K  |
|       from small pool |    3630    |    8445    |  100099 K  |  100095 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    8534    |  174050 K  |  174047 K  |
|       from large pool |      87    |     909    |   73951 K  |   73951 K  |
|       from small pool |    3630    |    8445    |  100099 K  |  100095 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     236    |     236    |     543    |     307    |
|       from large pool |     174    |     174    |     454    |     280    |
|       from small pool |      62    |      63    |      89    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      67    |    3672    |   90751 K  |   90751 K  |
|       from large pool |      18    |      62    |   39274 K  |   39274 K  |
|       from small pool |      49    |    3653    |   51476 K  |   51476 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11072 MiB |   1931 TiB |   1931 TiB |
|       from large pool |  16640 KiB |  10999 MiB |   1929 TiB |   1929 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11072 MiB |   1931 TiB |   1931 TiB |
|       from large pool |  16640 KiB |  10999 MiB |   1929 TiB |   1929 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1923 TiB |   1923 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1920 TiB |   1920 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1590 MiB |  11374 MiB |  30626 MiB |  29036 MiB |
|       from large pool |   1496 MiB |  11248 MiB |  30448 MiB |  28952 MiB |
|       from small pool |     94 MiB |    126 MiB |    178 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2309 MiB | 664704 GiB | 664704 GiB |
|       from large pool | 134912 KiB |   2306 MiB | 661958 GiB | 661958 GiB |
|       from small pool |      0 KiB |     26 MiB |   2746 GiB |   2746 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8534    |  174050 K  |  174050 K  |
|       from large pool |       2    |     909    |   73951 K  |   73951 K  |
|       from small pool |       0    |    8445    |  100099 K  |  100099 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8534    |  174050 K  |  174050 K  |
|       from large pool |       2    |     909    |   73951 K  |   73951 K  |
|       from small pool |       0    |    8445    |  100099 K  |  100099 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     236    |     543    |     464    |
|       from large pool |      32    |     174    |     454    |     422    |
|       from small pool |      47    |      63    |      89    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3672    |   90752 K  |   90752 K  |
|       from large pool |       4    |      62    |   39275 K  |   39275 K  |
|       from small pool |       0    |    3653    |   51477 K  |   51477 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 31 22:05:08 2024]
Finished job 0.
1 of 1 steps (100%) done
