Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 20:36:43 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/12.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=12
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118

 Experiment start at: 2024-08-04 20:45:48.430425
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.74192816, 'precision': 0.7567716, 'recall': 0.7418232, 'specificity': 0.7418232, 'f1': 0.7380886, 'auroc': 0.83443534, 'binary_precision': 0.69525284, 'binary_recall': 0.86225396, 'binary_specificity': 0.6213924, 'binary_f1_score': 0.7698002}
confusion matrix:
       0      1
0  17806  10849
1   3954  24751
---- Validation: 
scalar performance:
{'acc': 0.49680716, 'precision': 0.51074666, 'recall': 0.58122814, 'specificity': 0.58122814, 'f1': 0.36844498, 'auroc': 0.6061951, 'binary_precision': 0.044641934, 'binary_recall': 0.6718507, 'binary_specificity': 0.49060553, 'binary_f1_score': 0.08372094}
confusion matrix:
      0     1
0  8904  9245
1   211   432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3665708, 'precision': 0.5155203, 'recall': 0.5870464, 'specificity': 0.5870464, 'f1': 0.30504692, 'auroc': 0.67999065, 'binary_precision': 0.052237, 'binary_recall': 0.82758623, 'binary_specificity': 0.3465066, 'binary_f1_score': 0.09827116}
confusion matrix:
      0     1
0  2078  3919
1    45   216
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 20:59:57.986066,epoch time: 0:14:09.555641,used: 0:14:09.555641,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7930439, 'precision': 0.8254627, 'recall': 0.7929338, 'specificity': 0.7929338, 'f1': 0.78771627, 'auroc': 0.91573143, 'binary_precision': 0.7229184, 'binary_recall': 0.9508014, 'binary_specificity': 0.6350663, 'binary_f1_score': 0.82134634}
confusion matrix:
       0      1
0  18201  10459
1   1412  27288
---- Validation: 
scalar performance:
{'acc': 0.50803536, 'precision': 0.5128948, 'recall': 0.5975419, 'specificity': 0.5975419, 'f1': 0.37558174, 'auroc': 0.6130587, 'binary_precision': 0.04697704, 'binary_recall': 0.69362366, 'binary_specificity': 0.50146013, 'binary_f1_score': 0.08799448}
confusion matrix:
      0     1
0  9101  9048
1   197   446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45621604, 'precision': 0.52153224, 'recall': 0.63198745, 'specificity': 0.63198745, 'f1': 0.3601342, 'auroc': 0.7354114, 'binary_precision': 0.06019037, 'binary_recall': 0.8237548, 'binary_specificity': 0.44022012, 'binary_f1_score': 0.11218367}
confusion matrix:
      0     1
0  2640  3357
1    46   215
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 21:13:15.642419,epoch time: 0:13:17.656353,used: 0:27:27.211994,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.85101116, 'precision': 0.8518832, 'recall': 0.85098773, 'specificity': 0.85098773, 'f1': 0.8509127, 'auroc': 0.92871493, 'binary_precision': 0.8346002, 'binary_recall': 0.87588394, 'binary_specificity': 0.8260915, 'binary_f1_score': 0.8547439}
confusion matrix:
       0      1
0  23670   4983
1   3563  25144
---- Validation: 
scalar performance:
{'acc': 0.7232333, 'precision': 0.5185424, 'recall': 0.61219585, 'specificity': 0.61219585, 'f1': 0.47241923, 'auroc': 0.63354295, 'binary_precision': 0.06105547, 'binary_recall': 0.49300155, 'binary_specificity': 0.7313902, 'binary_f1_score': 0.10865467}
confusion matrix:
       0     1
0  13274  4875
1    326   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74400765, 'precision': 0.53368306, 'recall': 0.66304415, 'specificity': 0.66304415, 'f1': 0.503398, 'auroc': 0.7220986, 'binary_precision': 0.09140768, 'binary_recall': 0.57471263, 'binary_specificity': 0.7513757, 'binary_f1_score': 0.15772872}
confusion matrix:
      0     1
0  4506  1491
1   111   150
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 21:26:25.895436,epoch time: 0:13:10.253017,used: 0:40:37.465011,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8621513, 'precision': 0.8643716, 'recall': 0.8621173, 'specificity': 0.8621173, 'f1': 0.861933, 'auroc': 0.94122684, 'binary_precision': 0.8361456, 'binary_recall': 0.9011322, 'binary_specificity': 0.8231024, 'binary_f1_score': 0.8674235}
confusion matrix:
       0      1
0  23586   5069
1   2838  25867
---- Validation: 
scalar performance:
{'acc': 0.75468284, 'precision': 0.52155805, 'recall': 0.62022716, 'specificity': 0.62022716, 'f1': 0.48737276, 'auroc': 0.65110266, 'binary_precision': 0.06682682, 'binary_recall': 0.47589424, 'binary_specificity': 0.76456004, 'binary_f1_score': 0.11719648}
confusion matrix:
       0     1
0  13876  4273
1    337   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78635347, 'precision': 0.5412186, 'recall': 0.6759769, 'specificity': 0.6759769, 'f1': 0.5277289, 'auroc': 0.7349422, 'binary_precision': 0.10614934, 'binary_recall': 0.5555556, 'binary_specificity': 0.7963982, 'binary_f1_score': 0.17824216}
confusion matrix:
      0     1
0  4776  1221
1   116   145
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 21:39:05.242376,epoch time: 0:12:39.346940,used: 0:53:16.811951,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8759937, 'precision': 0.88097024, 'recall': 0.87594193, 'specificity': 0.87594193, 'f1': 0.8755766, 'auroc': 0.95610166, 'binary_precision': 0.8376544, 'binary_recall': 0.9330453, 'binary_specificity': 0.81883854, 'binary_f1_score': 0.88278043}
confusion matrix:
       0      1
0  23463   5191
1   1922  26784
---- Validation: 
scalar performance:
{'acc': 0.7295658, 'precision': 0.52296555, 'recall': 0.63797593, 'specificity': 0.63797593, 'f1': 0.48019063, 'auroc': 0.67348886, 'binary_precision': 0.06760179, 'binary_recall': 0.53965783, 'binary_specificity': 0.73629403, 'binary_f1_score': 0.12015235}
confusion matrix:
       0     1
0  13363  4786
1    296   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76973474, 'precision': 0.54880154, 'recall': 0.7259406, 'specificity': 0.7259406, 'f1': 0.5314027, 'auroc': 0.80973744, 'binary_precision': 0.115384616, 'binary_recall': 0.6781609, 'binary_specificity': 0.7737202, 'binary_f1_score': 0.19721448}
confusion matrix:
      0     1
0  4640  1357
1    84   177
early stop counter: 1
val acc:0.7295657992362976, best validation acc: 0.7546828389167786, corresponding to test acc:                         0.7863534688949585 / 0.7863534688949585
after epoch: 5,now: 2024-08-04 21:51:33.815060,epoch time: 0:12:28.572684,used: 1:05:45.384635,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8725767, 'precision': 0.87758815, 'recall': 0.8725225, 'specificity': 0.8725225, 'f1': 0.8721409, 'auroc': 0.9547063, 'binary_precision': 0.83432287, 'binary_recall': 0.93008673, 'binary_specificity': 0.8149583, 'binary_f1_score': 0.879606}
confusion matrix:
       0      1
0  23351   5302
1   2007  26700
---- Validation: 
scalar performance:
{'acc': 0.7310558, 'precision': 0.52305347, 'recall': 0.63799727, 'specificity': 0.63799727, 'f1': 0.48084524, 'auroc': 0.66667676, 'binary_precision': 0.067803256, 'binary_recall': 0.5381026, 'binary_specificity': 0.7378919, 'binary_f1_score': 0.1204316}
confusion matrix:
       0     1
0  13392  4757
1    297   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.767977, 'precision': 0.5441076, 'recall': 0.7030354, 'specificity': 0.7030354, 'f1': 0.52495706, 'auroc': 0.77929515, 'binary_precision': 0.108481266, 'binary_recall': 0.6321839, 'binary_specificity': 0.7738869, 'binary_f1_score': 0.1851852}
confusion matrix:
      0     1
0  4641  1356
1    96   165
early stop counter: 2
val acc:0.7310557961463928, best validation acc: 0.7546828389167786, corresponding to test acc:                         0.7863534688949585 / 0.7863534688949585
after epoch: 6,now: 2024-08-04 22:03:57.833564,epoch time: 0:12:24.018504,used: 1:18:09.403139,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8894526, 'precision': 0.89283097, 'recall': 0.88941383, 'specificity': 0.88941383, 'f1': 0.8892073, 'auroc': 0.9634515, 'binary_precision': 0.85660976, 'binary_recall': 0.93572325, 'binary_specificity': 0.8431044, 'binary_f1_score': 0.8944205}
confusion matrix:
       0      1
0  24160   4496
1   1845  26859
---- Validation: 
scalar performance:
{'acc': 0.73126864, 'precision': 0.5240389, 'recall': 0.64410794, 'specificity': 0.64410794, 'f1': 0.48214206, 'auroc': 0.6709881, 'binary_precision': 0.06920821, 'binary_recall': 0.5505443, 'binary_specificity': 0.7376715, 'binary_f1_score': 0.12295936}
confusion matrix:
       0     1
0  13388  4761
1    289   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78715247, 'precision': 0.5512216, 'recall': 0.7240344, 'specificity': 0.7240344, 'f1': 0.5407227, 'auroc': 0.8005235, 'binary_precision': 0.12101911, 'binary_recall': 0.6551724, 'binary_specificity': 0.79289645, 'binary_f1_score': 0.20430106}
confusion matrix:
      0     1
0  4755  1242
1    90   171
new oracle model saved
early stop counter: 3
val acc:0.7312686443328857, best validation acc: 0.7546828389167786, corresponding to test acc:                         0.7863534688949585 / 0.7871524691581726
after epoch: 7,now: 2024-08-04 22:16:46.101308,epoch time: 0:12:48.267744,used: 1:30:57.670883,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.87517434, 'precision': 0.88368726, 'recall': 0.8751147, 'specificity': 0.8751147, 'f1': 0.8744656, 'auroc': 0.9609592, 'binary_precision': 0.82673585, 'binary_recall': 0.9495523, 'binary_specificity': 0.800677, 'binary_f1_score': 0.8838982}
confusion matrix:
       0      1
0  22945   5712
1   1448  27255
---- Validation: 
scalar performance:
{'acc': 0.70157516, 'precision': 0.52357376, 'recall': 0.65123683, 'specificity': 0.65123683, 'f1': 0.4703771, 'auroc': 0.67370975, 'binary_precision': 0.06698064, 'binary_recall': 0.59720063, 'binary_specificity': 0.70527303, 'binary_f1_score': 0.12045169}
confusion matrix:
       0     1
0  12800  5349
1    259   384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7291467, 'precision': 0.542085, 'recall': 0.71575725, 'specificity': 0.71575725, 'f1': 0.5077301, 'auroc': 0.80079246, 'binary_precision': 0.10166667, 'binary_recall': 0.7011494, 'binary_specificity': 0.73036516, 'binary_f1_score': 0.17758368}
confusion matrix:
      0     1
0  4380  1617
1    78   183
early stop counter: 4
val acc:0.7015751600265503, best validation acc: 0.7546828389167786, corresponding to test acc:                         0.7863534688949585 / 0.7871524691581726
after epoch: 8,now: 2024-08-04 22:29:41.876744,epoch time: 0:12:55.775436,used: 1:43:53.446319,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90353906, 'precision': 0.9037249, 'recall': 0.9035485, 'specificity': 0.9035485, 'f1': 0.9035294, 'auroc': 0.96629965, 'binary_precision': 0.91260684, 'binary_recall': 0.89273643, 'binary_specificity': 0.9143605, 'binary_f1_score': 0.90256226}
confusion matrix:
       0      1
0  26201   2454
1   3079  25626
---- Validation: 
scalar performance:
{'acc': 0.8554172, 'precision': 0.5260506, 'recall': 0.5898727, 'specificity': 0.5898727, 'f1': 0.5236374, 'auroc': 0.6835904, 'binary_precision': 0.07948094, 'binary_recall': 0.30482116, 'binary_specificity': 0.87492424, 'binary_f1_score': 0.12608555}
confusion matrix:
       0     1
0  15879  2270
1    447   196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88239056, 'precision': 0.57604885, 'recall': 0.6967679, 'specificity': 0.6967679, 'f1': 0.5978398, 'auroc': 0.7792983, 'binary_precision': 0.17598909, 'binary_recall': 0.49425286, 'binary_specificity': 0.899283, 'binary_f1_score': 0.25955737}
confusion matrix:
      0    1
0  5393  604
1   132  129
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 22:44:07.461276,epoch time: 0:14:25.584532,used: 1:58:19.030851,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90777546, 'precision': 0.9089851, 'recall': 0.90775657, 'specificity': 0.90775657, 'f1': 0.90770435, 'auroc': 0.9715862, 'binary_precision': 0.8869166, 'binary_recall': 0.93487805, 'binary_specificity': 0.880635, 'binary_f1_score': 0.910266}
confusion matrix:
       0      1
0  25239   3421
1   1869  26831
---- Validation: 
scalar performance:
{'acc': 0.77905494, 'precision': 0.52820605, 'recall': 0.6470959, 'specificity': 0.6470959, 'f1': 0.5043527, 'auroc': 0.67767376, 'binary_precision': 0.07814378, 'binary_recall': 0.5054432, 'binary_specificity': 0.7887487, 'binary_f1_score': 0.13536027}
confusion matrix:
       0     1
0  14315  3834
1    318   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82518375, 'precision': 0.56070954, 'recall': 0.729219, 'specificity': 0.729219, 'f1': 0.5654917, 'auroc': 0.8096162, 'binary_precision': 0.14063849, 'binary_recall': 0.6245211, 'binary_specificity': 0.83391696, 'binary_f1_score': 0.22957748}
confusion matrix:
      0    1
0  5001  996
1    98  163
early stop counter: 1
val acc:0.7790549397468567, best validation acc: 0.8554171919822693, corresponding to test acc:                         0.882390558719635 / 0.882390558719635
after epoch: 10,now: 2024-08-04 22:56:46.488255,epoch time: 0:12:39.026979,used: 2:10:58.057830,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.907514, 'precision': 0.90775263, 'recall': 0.90750635, 'specificity': 0.90750635, 'f1': 0.9074992, 'auroc': 0.9702866, 'binary_precision': 0.8980432, 'binary_recall': 0.9195414, 'binary_specificity': 0.89547133, 'binary_f1_score': 0.9086652}
confusion matrix:
       0      1
0  25666   2996
1   2309  26389
---- Validation: 
scalar performance:
{'acc': 0.8073648, 'precision': 0.532865, 'recall': 0.6542519, 'specificity': 0.6542519, 'f1': 0.5198187, 'auroc': 0.7144135, 'binary_precision': 0.08733019, 'binary_recall': 0.48989114, 'binary_specificity': 0.8186126, 'binary_f1_score': 0.14823529}
confusion matrix:
       0     1
0  14857  3292
1    328   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84659636, 'precision': 0.56929684, 'recall': 0.73672664, 'specificity': 0.73672664, 'f1': 0.5828576, 'auroc': 0.8097222, 'binary_precision': 0.15768854, 'binary_recall': 0.61685824, 'binary_specificity': 0.856595, 'binary_f1_score': 0.25117004}
confusion matrix:
      0    1
0  5137  860
1   100  161
early stop counter: 2
val acc:0.807364821434021, best validation acc: 0.8554171919822693, corresponding to test acc:                         0.882390558719635 / 0.882390558719635
after epoch: 11,now: 2024-08-04 23:09:11.830299,epoch time: 0:12:25.342044,used: 2:23:23.399874,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91180265, 'precision': 0.9120269, 'recall': 0.9117942, 'specificity': 0.9117942, 'f1': 0.9117894, 'auroc': 0.97225946, 'binary_precision': 0.90259516, 'binary_recall': 0.92338246, 'binary_specificity': 0.90020585, 'binary_f1_score': 0.9128705}
confusion matrix:
       0      1
0  25799   2860
1   2199  26502
---- Validation: 
scalar performance:
{'acc': 0.8209344, 'precision': 0.5340675, 'recall': 0.6500262, 'specificity': 0.6500262, 'f1': 0.52561593, 'auroc': 0.715652, 'binary_precision': 0.09030704, 'binary_recall': 0.466563, 'binary_specificity': 0.8334895, 'binary_f1_score': 0.15132408}
confusion matrix:
       0     1
0  15127  3022
1    343   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8620965, 'precision': 0.56811136, 'recall': 0.70633495, 'specificity': 0.70633495, 'f1': 0.58454394, 'auroc': 0.7805218, 'binary_precision': 0.15873016, 'binary_recall': 0.5363985, 'binary_specificity': 0.8762715, 'binary_f1_score': 0.2449694}
confusion matrix:
      0    1
0  5255  742
1   121  140
early stop counter: 3
val acc:0.8209344148635864, best validation acc: 0.8554171919822693, corresponding to test acc:                         0.882390558719635 / 0.882390558719635
after epoch: 12,now: 2024-08-04 23:21:31.580008,epoch time: 0:12:19.749709,used: 2:35:43.149583,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9059972, 'precision': 0.9073483, 'recall': 0.9059772, 'specificity': 0.9059772, 'f1': 0.90591615, 'auroc': 0.9715717, 'binary_precision': 0.88406277, 'binary_recall': 0.9347038, 'binary_specificity': 0.87725055, 'binary_f1_score': 0.9086783}
confusion matrix:
       0      1
0  25142   3518
1   1874  26826
---- Validation: 
scalar performance:
{'acc': 0.7666028, 'precision': 0.52750456, 'recall': 0.64965, 'specificity': 0.64965, 'f1': 0.49917364, 'auroc': 0.69978905, 'binary_precision': 0.07629613, 'binary_recall': 0.5241057, 'binary_specificity': 0.7751942, 'binary_f1_score': 0.13320157}
confusion matrix:
       0     1
0  14069  4080
1    306   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7935443, 'precision': 0.5585625, 'recall': 0.75485444, 'specificity': 0.75485444, 'f1': 0.5522506, 'auroc': 0.83497113, 'binary_precision': 0.13257305, 'binary_recall': 0.7126437, 'binary_specificity': 0.7970652, 'binary_f1_score': 0.22355768}
confusion matrix:
      0     1
0  4780  1217
1    75   186
early stop counter: 4
val acc:0.7666028141975403, best validation acc: 0.8554171919822693, corresponding to test acc:                         0.882390558719635 / 0.882390558719635
after epoch: 13,now: 2024-08-04 23:34:02.620571,epoch time: 0:12:31.040563,used: 2:48:14.190146,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9211123, 'precision': 0.92111456, 'recall': 0.92111135, 'specificity': 0.92111135, 'f1': 0.92111206, 'auroc': 0.9758762, 'binary_precision': 0.9203143, 'binary_recall': 0.922206, 'binary_specificity': 0.92001677, 'binary_f1_score': 0.9212592}
confusion matrix:
       0      1
0  26364   2292
1   2233  26471
---- Validation: 
scalar performance:
{'acc': 0.82013625, 'precision': 0.5366001, 'recall': 0.66311395, 'specificity': 0.66311395, 'f1': 0.5288377, 'auroc': 0.7108056, 'binary_precision': 0.09427809, 'binary_recall': 0.49455675, 'binary_specificity': 0.8316712, 'binary_f1_score': 0.15836655}
confusion matrix:
       0     1
0  15094  3055
1    325   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85682327, 'precision': 0.5742467, 'recall': 0.74023026, 'specificity': 0.74023026, 'f1': 0.5919329, 'auroc': 0.81986076, 'binary_precision': 0.16753927, 'binary_recall': 0.6130268, 'binary_specificity': 0.8674337, 'binary_f1_score': 0.26315787}
confusion matrix:
      0    1
0  5202  795
1   101  160
early stop counter: 5
val acc:0.8201362490653992, best validation acc: 0.8554171919822693, corresponding to test acc:                         0.882390558719635 / 0.882390558719635
after epoch: 14,now: 2024-08-04 23:47:38.338175,epoch time: 0:13:35.717604,used: 3:01:49.907750,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92105997, 'precision': 0.9214919, 'recall': 0.92107344, 'specificity': 0.92107344, 'f1': 0.92104137, 'auroc': 0.9761092, 'binary_precision': 0.93519586, 'binary_recall': 0.904961, 'binary_specificity': 0.93718594, 'binary_f1_score': 0.9198301}
confusion matrix:
       0      1
0  26856   1800
1   2728  25976
---- Validation: 
scalar performance:
{'acc': 0.85850364, 'precision': 0.5284683, 'recall': 0.59672093, 'specificity': 0.59672093, 'f1': 0.52771664, 'auroc': 0.6837752, 'binary_precision': 0.08381503, 'binary_recall': 0.31570762, 'binary_specificity': 0.8777343, 'binary_f1_score': 0.13246329}
confusion matrix:
       0     1
0  15930  2219
1    440   203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8728028, 'precision': 0.57378954, 'recall': 0.7082564, 'specificity': 0.7082564, 'f1': 0.5939533, 'auroc': 0.7834077, 'binary_precision': 0.1701603, 'binary_recall': 0.52873564, 'binary_specificity': 0.8877772, 'binary_f1_score': 0.25746268}
confusion matrix:
      0    1
0  5324  673
1   123  138
better model found
persisted
after epoch: 15,now: 2024-08-05 00:00:29.807588,epoch time: 0:12:51.469413,used: 3:14:41.377163,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_45_48_seed_0_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:14:41.377163 at 2024-08-05 00:00:29.807588
persisted model performance metric: 

scalar performance:
{'acc': 0.8728028, 'precision': 0.57378954, 'recall': 0.7082564, 'specificity': 0.7082564, 'f1': 0.5939533, 'auroc': 0.7834077, 'binary_precision': 0.1701603, 'binary_recall': 0.52873564, 'binary_specificity': 0.8877772, 'binary_f1_score': 0.25746268}
confusion matrix:
      0    1
0  5324  673
1   123  138
oracle model performance metric: 

scalar performance:
{'acc': 0.88239056, 'precision': 0.57604885, 'recall': 0.6967679, 'specificity': 0.6967679, 'f1': 0.5978398, 'auroc': 0.7792983, 'binary_precision': 0.17598909, 'binary_recall': 0.49425286, 'binary_specificity': 0.899283, 'binary_f1_score': 0.25955737}
confusion matrix:
      0    1
0  5393  604
1   132  129
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/12.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 643417 KiB | 469829 GiB | 469828 GiB |
|       from large pool | 167936 KiB | 570688 KiB | 469681 GiB | 469681 GiB |
|       from small pool |  37043 KiB |  75082 KiB |    147 GiB |    147 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 643417 KiB | 469829 GiB | 469828 GiB |
|       from large pool | 167936 KiB | 570688 KiB | 469681 GiB | 469681 GiB |
|       from small pool |  37043 KiB |  75082 KiB |    147 GiB |    147 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB | 468425 GiB | 468425 GiB |
|       from large pool | 165120 KiB | 560704 KiB | 468288 GiB | 468288 GiB |
|       from small pool |  35968 KiB |  73944 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 686080 KiB | 686080 KiB | 686080 KiB |      0 B   |
|       from large pool | 610304 KiB | 610304 KiB | 610304 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  51020 KiB | 192768 KiB | 217068 GiB | 217068 GiB |
|       from large pool |  36864 KiB | 187968 KiB | 216914 GiB | 216914 GiB |
|       from small pool |  14156 KiB |  14156 KiB |    153 GiB |    153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7939    |   44271 K  |   44268 K  |
|       from large pool |      36    |      76    |   16451 K  |   16451 K  |
|       from small pool |    3216    |    7901    |   27820 K  |   27817 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7939    |   44271 K  |   44268 K  |
|       from large pool |      36    |      76    |   16451 K  |   16451 K  |
|       from small pool |    3216    |    7901    |   27820 K  |   27817 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      53    |       0    |
|       from large pool |      16    |      16    |      16    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |    3599    |   23691 K  |   23691 K  |
|       from large pool |       7    |      11    |    9624 K  |    9624 K  |
|       from small pool |      49    |    3593    |   14066 K  |   14066 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 643417 KiB | 469829 GiB | 469829 GiB |
|       from large pool |  16640 KiB | 570688 KiB | 469681 GiB | 469681 GiB |
|       from small pool |      0 KiB |  75082 KiB |    147 GiB |    147 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 643417 KiB | 469829 GiB | 469829 GiB |
|       from large pool |  16640 KiB | 570688 KiB | 469681 GiB | 469681 GiB |
|       from small pool |      0 KiB |  75082 KiB |    147 GiB |    147 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB | 468425 GiB | 468425 GiB |
|       from large pool |  16640 KiB | 560704 KiB | 468288 GiB | 468288 GiB |
|       from small pool |      0 KiB |  73944 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB | 686080 KiB | 686080 KiB | 430080 KiB |
|       from large pool | 204800 KiB | 610304 KiB | 610304 KiB | 405504 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 192768 KiB | 217068 GiB | 217068 GiB |
|       from large pool |  24320 KiB | 187968 KiB | 216914 GiB | 216914 GiB |
|       from small pool |      0 KiB |  21751 KiB |    153 GiB |    153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   44271 K  |   44271 K  |
|       from large pool |       2    |      76    |   16451 K  |   16451 K  |
|       from small pool |       0    |    7901    |   27820 K  |   27820 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   44271 K  |   44271 K  |
|       from large pool |       2    |      76    |   16451 K  |   16451 K  |
|       from small pool |       0    |    7901    |   27820 K  |   27820 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      53    |      53    |      18    |
|       from large pool |      10    |      16    |      16    |       6    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3599    |   23692 K  |   23692 K  |
|       from large pool |       3    |      13    |    9624 K  |    9624 K  |
|       from small pool |       0    |    3593    |   14067 K  |   14067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 643417 KiB | 469829 GiB | 469829 GiB |
|       from large pool |  16640 KiB | 570688 KiB | 469681 GiB | 469681 GiB |
|       from small pool |      0 KiB |  75082 KiB |    147 GiB |    147 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 643417 KiB | 469829 GiB | 469829 GiB |
|       from large pool |  16640 KiB | 570688 KiB | 469681 GiB | 469681 GiB |
|       from small pool |      0 KiB |  75082 KiB |    147 GiB |    147 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB | 468425 GiB | 468425 GiB |
|       from large pool |  16640 KiB | 560704 KiB | 468288 GiB | 468288 GiB |
|       from small pool |      0 KiB |  73944 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB | 686080 KiB | 686080 KiB | 430080 KiB |
|       from large pool | 204800 KiB | 610304 KiB | 610304 KiB | 405504 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 192768 KiB | 217068 GiB | 217068 GiB |
|       from large pool |  24320 KiB | 187968 KiB | 216914 GiB | 216914 GiB |
|       from small pool |      0 KiB |  21751 KiB |    153 GiB |    153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   44271 K  |   44271 K  |
|       from large pool |       2    |      76    |   16451 K  |   16451 K  |
|       from small pool |       0    |    7901    |   27820 K  |   27820 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   44271 K  |   44271 K  |
|       from large pool |       2    |      76    |   16451 K  |   16451 K  |
|       from small pool |       0    |    7901    |   27820 K  |   27820 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      53    |      53    |      18    |
|       from large pool |      10    |      16    |      16    |       6    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3599    |   23692 K  |   23692 K  |
|       from large pool |       3    |      13    |    9624 K  |    9624 K  |
|       from small pool |       0    |    3593    |   14067 K  |   14067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118

 Experiment start at: 2024-08-05 00:08:00.802740
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6639822, 'precision': 0.7050276, 'recall': 0.6638267, 'specificity': 0.6638267, 'f1': 0.64615035, 'auroc': 0.7956716, 'binary_precision': 0.6134653, 'binary_recall': 0.8878521, 'binary_specificity': 0.4398013, 'binary_f1_score': 0.7255847}
confusion matrix:
       0      1
0  12661  16127
1   3233  25595
---- Validation: 
scalar performance:
{'acc': 0.37187833, 'precision': 0.4942062, 'recall': 0.46109068, 'specificity': 0.46109068, 'f1': 0.29414296, 'auroc': 0.4476026, 'binary_precision': 0.031650912, 'binary_recall': 0.5572065, 'binary_specificity': 0.36497483, 'binary_f1_score': 0.05989937}
confusion matrix:
      0      1
0  6594  11473
1   298    375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4911376, 'precision': 0.4906947, 'recall': 0.44204444, 'specificity': 0.44204444, 'f1': 0.35562292, 'auroc': 0.41876552, 'binary_precision': 0.032580644, 'binary_recall': 0.38846153, 'binary_specificity': 0.4956273, 'binary_f1_score': 0.060119044}
confusion matrix:
      0     1
0  2947  2999
1   159   101
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 00:20:55.685304,epoch time: 0:12:54.882564,used: 0:12:54.882564,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.79422385, 'precision': 0.8027319, 'recall': 0.7941656, 'specificity': 0.7941656, 'f1': 0.7927456, 'auroc': 0.8902421, 'binary_precision': 0.7521543, 'binary_recall': 0.87806994, 'binary_specificity': 0.7102612, 'binary_f1_score': 0.8102494}
confusion matrix:
       0      1
0  20447   8341
1   3515  25313
---- Validation: 
scalar performance:
{'acc': 0.64786553, 'precision': 0.50641733, 'recall': 0.5419963, 'specificity': 0.5419963, 'f1': 0.43126297, 'auroc': 0.547342, 'binary_precision': 0.044294063, 'binary_recall': 0.42793462, 'binary_specificity': 0.656058, 'binary_f1_score': 0.08027875}
confusion matrix:
       0     1
0  11853  6214
1    385   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7312278, 'precision': 0.525002, 'recall': 0.62250835, 'specificity': 0.62250835, 'f1': 0.48831066, 'auroc': 0.66297126, 'binary_precision': 0.07844312, 'binary_recall': 0.50384617, 'binary_specificity': 0.7411705, 'binary_f1_score': 0.13575129}
confusion matrix:
      0     1
0  4407  1539
1   129   131
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-05 00:33:28.485436,epoch time: 0:12:32.800132,used: 0:25:27.682696,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.82943976, 'precision': 0.8396658, 'recall': 0.82937646, 'specificity': 0.82937646, 'f1': 0.8281272, 'auroc': 0.92796075, 'binary_precision': 0.7809118, 'binary_recall': 0.9161608, 'binary_specificity': 0.74259216, 'binary_f1_score': 0.843147}
confusion matrix:
       0      1
0  21377   7410
1   2417  26412
---- Validation: 
scalar performance:
{'acc': 0.66093916, 'precision': 0.5075933, 'recall': 0.5487766, 'specificity': 0.5487766, 'f1': 0.43756497, 'auroc': 0.5617398, 'binary_precision': 0.046028446, 'binary_recall': 0.42793462, 'binary_specificity': 0.66961867, 'binary_f1_score': 0.08311688}
confusion matrix:
       0     1
0  12098  5969
1    385   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7436352, 'precision': 0.53956425, 'recall': 0.6933478, 'specificity': 0.6933478, 'f1': 0.51048213, 'auroc': 0.73883605, 'binary_precision': 0.0998196, 'binary_recall': 0.63846153, 'binary_specificity': 0.7482341, 'binary_f1_score': 0.17264691}
confusion matrix:
      0     1
0  4449  1497
1    94   166
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-05 00:46:01.511460,epoch time: 0:12:33.026024,used: 0:38:00.708720,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.84285617, 'precision': 0.8431145, 'recall': 0.8428657, 'specificity': 0.8428657, 'f1': 0.8428291, 'auroc': 0.9233289, 'binary_precision': 0.85270405, 'binary_recall': 0.82915914, 'binary_specificity': 0.8565722, 'binary_f1_score': 0.8407668}
confusion matrix:
       0      1
0  24659   4129
1   4925  23903
---- Validation: 
scalar performance:
{'acc': 0.8166489, 'precision': 0.5111357, 'recall': 0.54441476, 'specificity': 0.54441476, 'f1': 0.4938099, 'auroc': 0.5738623, 'binary_precision': 0.05449855, 'binary_recall': 0.2511144, 'binary_specificity': 0.83771515, 'binary_f1_score': 0.08956015}
confusion matrix:
       0     1
0  15135  2932
1    504   169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87318724, 'precision': 0.5500162, 'recall': 0.6267103, 'specificity': 0.6267103, 'f1': 0.56118083, 'auroc': 0.70872545, 'binary_precision': 0.13043478, 'binary_recall': 0.3576923, 'binary_specificity': 0.89572823, 'binary_f1_score': 0.19116135}
confusion matrix:
      0    1
0  5326  620
1   167   93
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-05 00:58:27.092330,epoch time: 0:12:25.580870,used: 0:50:26.289590,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.84997225, 'precision': 0.8567911, 'recall': 0.84991944, 'specificity': 0.84991944, 'f1': 0.8492383, 'auroc': 0.94150877, 'binary_precision': 0.8076571, 'binary_recall': 0.91904265, 'binary_specificity': 0.78079623, 'binary_f1_score': 0.85975724}
confusion matrix:
       0      1
0  22476   6310
1   2334  26496
---- Validation: 
scalar performance:
{'acc': 0.71318036, 'precision': 0.5178353, 'recall': 0.6051962, 'specificity': 0.6051962, 'f1': 0.46907216, 'auroc': 0.6330364, 'binary_precision': 0.0613806, 'binary_recall': 0.48885587, 'binary_specificity': 0.7215365, 'binary_f1_score': 0.1090668}
confusion matrix:
       0     1
0  13036  5031
1    344   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7980986, 'precision': 0.5530124, 'recall': 0.7217703, 'specificity': 0.7217703, 'f1': 0.54686725, 'auroc': 0.78849125, 'binary_precision': 0.12528302, 'binary_recall': 0.63846153, 'binary_specificity': 0.80507904, 'binary_f1_score': 0.20946373}
confusion matrix:
      0     1
0  4787  1159
1    94   166
early stop counter: 1
val acc:0.7131803631782532, best validation acc: 0.8166489005088806, corresponding to test acc:                         0.873187243938446 / 0.873187243938446
after epoch: 5,now: 2024-08-05 01:10:54.096780,epoch time: 0:12:27.004450,used: 1:02:53.294040,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.85802555, 'precision': 0.8709877, 'recall': 0.8579574, 'specificity': 0.8579574, 'f1': 0.856758, 'auroc': 0.9548778, 'binary_precision': 0.8018242, 'binary_recall': 0.9514031, 'binary_specificity': 0.76451176, 'binary_f1_score': 0.87023294}
confusion matrix:
       0      1
0  22008   6779
1   1401  27428
---- Validation: 
scalar performance:
{'acc': 0.63708645, 'precision': 0.5209458, 'recall': 0.6415503, 'specificity': 0.6415503, 'f1': 0.44263077, 'auroc': 0.66763914, 'binary_precision': 0.06216062, 'binary_recall': 0.64635956, 'binary_specificity': 0.63674104, 'binary_f1_score': 0.11341415}
confusion matrix:
       0     1
0  11504  6563
1    238   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7360619, 'precision': 0.5484827, 'recall': 0.7464042, 'specificity': 0.7464042, 'f1': 0.5180471, 'auroc': 0.818604, 'binary_precision': 0.111173816, 'binary_recall': 0.75769234, 'binary_specificity': 0.73511606, 'binary_f1_score': 0.19389765}
confusion matrix:
      0     1
0  4371  1575
1    63   197
early stop counter: 2
val acc:0.6370864510536194, best validation acc: 0.8166489005088806, corresponding to test acc:                         0.873187243938446 / 0.873187243938446
after epoch: 6,now: 2024-08-05 01:23:34.356803,epoch time: 0:12:40.260023,used: 1:15:33.554063,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.87418425, 'precision': 0.8777745, 'recall': 0.87414706, 'specificity': 0.87414706, 'f1': 0.8738768, 'auroc': 0.95511544, 'binary_precision': 0.8411369, 'binary_recall': 0.9228581, 'binary_specificity': 0.825436, 'binary_f1_score': 0.8801046}
confusion matrix:
       0      1
0  23761   5025
1   2224  26606
---- Validation: 
scalar performance:
{'acc': 0.73820704, 'precision': 0.5202293, 'recall': 0.6124535, 'specificity': 0.6124535, 'f1': 0.48103917, 'auroc': 0.6547708, 'binary_precision': 0.06584615, 'binary_recall': 0.4769688, 'binary_specificity': 0.7479382, 'binary_f1_score': 0.11571737}
confusion matrix:
       0     1
0  13513  4554
1    352   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066387, 'precision': 0.55611336, 'recall': 0.7280661, 'specificity': 0.7280661, 'f1': 0.55370855, 'auroc': 0.7987665, 'binary_precision': 0.1310832, 'binary_recall': 0.6423077, 'binary_specificity': 0.8138244, 'binary_f1_score': 0.21773143}
confusion matrix:
      0     1
0  4839  1107
1    93   167
early stop counter: 3
val acc:0.7382070422172546, best validation acc: 0.8166489005088806, corresponding to test acc:                         0.873187243938446 / 0.873187243938446
after epoch: 7,now: 2024-08-05 01:36:17.543000,epoch time: 0:12:43.186197,used: 1:28:16.740260,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8854485, 'precision': 0.88552535, 'recall': 0.88544357, 'specificity': 0.88544357, 'f1': 0.8854418, 'auroc': 0.9562584, 'binary_precision': 0.8802518, 'binary_recall': 0.89246565, 'binary_specificity': 0.87842155, 'binary_f1_score': 0.88631666}
confusion matrix:
       0      1
0  25288   3500
1   3100  25728
---- Validation: 
scalar performance:
{'acc': 0.79242265, 'precision': 0.5256591, 'recall': 0.61982834, 'specificity': 0.61982834, 'f1': 0.5063373, 'auroc': 0.6798351, 'binary_precision': 0.076821886, 'binary_recall': 0.43387815, 'binary_specificity': 0.8057785, 'binary_f1_score': 0.13053195}
confusion matrix:
       0     1
0  14558  3509
1    381   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8366097, 'precision': 0.5634785, 'recall': 0.72531694, 'specificity': 0.72531694, 'f1': 0.5724813, 'auroc': 0.79463434, 'binary_precision': 0.14700374, 'binary_recall': 0.60384613, 'binary_specificity': 0.84678775, 'binary_f1_score': 0.23644578}
confusion matrix:
      0    1
0  5035  911
1   103  157
early stop counter: 4
val acc:0.7924226522445679, best validation acc: 0.8166489005088806, corresponding to test acc:                         0.873187243938446 / 0.873187243938446
after epoch: 8,now: 2024-08-05 01:48:49.847029,epoch time: 0:12:32.304029,used: 1:40:49.044289,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8971119, 'precision': 0.89770377, 'recall': 0.89709854, 'specificity': 0.89709854, 'f1': 0.89707136, 'auroc': 0.9645692, 'binary_precision': 0.8825337, 'binary_recall': 0.91633135, 'binary_specificity': 0.8778658, 'binary_f1_score': 0.8991151}
confusion matrix:
       0      1
0  25272   3516
1   2412  26416
---- Validation: 
scalar performance:
{'acc': 0.7989328, 'precision': 0.52703613, 'recall': 0.62320465, 'specificity': 0.62320465, 'f1': 0.5102253, 'auroc': 0.6881714, 'binary_precision': 0.079369396, 'binary_recall': 0.43387815, 'binary_specificity': 0.8125311, 'binary_f1_score': 0.13419119}
confusion matrix:
       0     1
0  14680  3387
1    381   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8548179, 'precision': 0.5715027, 'recall': 0.7311412, 'specificity': 0.7311412, 'f1': 0.58777374, 'auroc': 0.79895854, 'binary_precision': 0.16298632, 'binary_recall': 0.59615386, 'binary_specificity': 0.8661285, 'binary_f1_score': 0.25598678}
confusion matrix:
      0    1
0  5150  796
1   105  155
early stop counter: 5
val acc:0.7989327907562256, best validation acc: 0.8166489005088806, corresponding to test acc:                         0.873187243938446 / 0.873187243938446
after epoch: 9,now: 2024-08-05 02:01:10.121441,epoch time: 0:12:20.274412,used: 1:53:09.318701,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9042974, 'precision': 0.9051579, 'recall': 0.90428144, 'specificity': 0.90428144, 'f1': 0.90424407, 'auroc': 0.9688884, 'binary_precision': 0.88665915, 'binary_recall': 0.9272582, 'binary_specificity': 0.8813047, 'binary_f1_score': 0.90650433}
confusion matrix:
       0      1
0  25371   3417
1   2097  26731
---- Validation: 
scalar performance:
{'acc': 0.79882604, 'precision': 0.5296188, 'recall': 0.6360241, 'specificity': 0.6360241, 'f1': 0.51364917, 'auroc': 0.6952423, 'binary_precision': 0.08340059, 'binary_recall': 0.46062407, 'binary_specificity': 0.81142414, 'binary_f1_score': 0.14123006}
confusion matrix:
       0     1
0  14660  3407
1    363   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.848856, 'precision': 0.5692558, 'recall': 0.7317078, 'specificity': 0.7317078, 'f1': 0.58337426, 'auroc': 0.81385744, 'binary_precision': 0.15826613, 'binary_recall': 0.60384613, 'binary_specificity': 0.85956943, 'binary_f1_score': 0.25079873}
confusion matrix:
      0    1
0  5111  835
1   103  157
early stop counter: 6
val acc:0.7988260388374329, best validation acc: 0.8166489005088806, corresponding to test acc:                         0.873187243938446 / 0.873187243938446
after epoch: 10,now: 2024-08-05 02:13:36.289406,epoch time: 0:12:26.167965,used: 2:05:35.486666,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9011212, 'precision': 0.90250856, 'recall': 0.90109885, 'specificity': 0.90109885, 'f1': 0.90103227, 'auroc': 0.9686448, 'binary_precision': 0.87906796, 'binary_recall': 0.930385, 'binary_specificity': 0.8718127, 'binary_f1_score': 0.90399873}
confusion matrix:
       0      1
0  25096   3690
1   2007  26823
---- Validation: 
scalar performance:
{'acc': 0.78175026, 'precision': 0.523566, 'recall': 0.6142934, 'specificity': 0.6142934, 'f1': 0.5001371, 'auroc': 0.6649866, 'binary_precision': 0.07298175, 'binary_recall': 0.43387815, 'binary_specificity': 0.7947086, 'binary_f1_score': 0.12494651}
confusion matrix:
       0     1
0  14358  3709
1    381   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8219465, 'precision': 0.5615727, 'recall': 0.73605466, 'specificity': 0.73605466, 'f1': 0.56570196, 'auroc': 0.8002542, 'binary_precision': 0.14164546, 'binary_recall': 0.6423077, 'binary_specificity': 0.82980156, 'binary_f1_score': 0.23210563}
confusion matrix:
      0     1
0  4934  1012
1    93   167
early stop counter: 7
val acc:0.7817502617835999, best validation acc: 0.8166489005088806, corresponding to test acc:                         0.873187243938446 / 0.873187243938446
after epoch: 11,now: 2024-08-05 02:26:05.667738,epoch time: 0:12:29.378332,used: 2:18:04.864998,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.90967786, 'precision': 0.91021883, 'recall': 0.9096647, 'specificity': 0.9096647, 'f1': 0.9096461, 'auroc': 0.97118855, 'binary_precision': 0.8955034, 'binary_recall': 0.92774636, 'binary_specificity': 0.891583, 'binary_f1_score': 0.9113397}
confusion matrix:
       0      1
0  25666   3121
1   2083  26746
---- Validation: 
scalar performance:
{'acc': 0.81040555, 'precision': 0.53371036, 'recall': 0.64846694, 'specificity': 0.64846694, 'f1': 0.52274954, 'auroc': 0.70255554, 'binary_precision': 0.090676524, 'binary_recall': 0.47399703, 'binary_specificity': 0.82293683, 'binary_f1_score': 0.15223098}
confusion matrix:
       0     1
0  14868  3199
1    354   319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8532066, 'precision': 0.57457584, 'recall': 0.74685115, 'specificity': 0.74685115, 'f1': 0.5915969, 'auroc': 0.82757807, 'binary_precision': 0.16751787, 'binary_recall': 0.63076925, 'binary_specificity': 0.86293304, 'binary_f1_score': 0.26472962}
confusion matrix:
      0    1
0  5131  815
1    96  164
early stop counter: 8
val acc:0.8104055523872375, best validation acc: 0.8166489005088806, corresponding to test acc:                         0.873187243938446 / 0.873187243938446
after epoch: 12,now: 2024-08-05 02:38:37.868922,epoch time: 0:12:32.201184,used: 2:30:37.066182,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.90198904, 'precision': 0.90421665, 'recall': 0.9019633, 'specificity': 0.9019633, 'f1': 0.9018497, 'auroc': 0.9691628, 'binary_precision': 0.87438226, 'binary_recall': 0.9390176, 'binary_specificity': 0.864909, 'binary_f1_score': 0.90554804}
confusion matrix:
       0      1
0  24899   3889
1   1758  27070
---- Validation: 
scalar performance:
{'acc': 0.76376736, 'precision': 0.5276013, 'recall': 0.64430666, 'specificity': 0.64430666, 'f1': 0.49935573, 'auroc': 0.69953597, 'binary_precision': 0.07801259, 'binary_recall': 0.51560175, 'binary_specificity': 0.77301157, 'binary_f1_score': 0.13552041}
confusion matrix:
       0     1
0  13966  4101
1    326   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8146955, 'precision': 0.5646922, 'recall': 0.7598554, 'specificity': 0.7598554, 'f1': 0.56744933, 'auroc': 0.82848716, 'binary_precision': 0.14513557, 'binary_recall': 0.7, 'binary_specificity': 0.81971073, 'binary_f1_score': 0.24042271}
confusion matrix:
      0     1
0  4874  1072
1    78   182
early stop counter: 9
val acc:0.7637673616409302, best validation acc: 0.8166489005088806, corresponding to test acc:                         0.873187243938446 / 0.873187243938446
after epoch: 13,now: 2024-08-05 02:51:11.286723,epoch time: 0:12:33.417801,used: 2:43:10.483983,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90957373, 'precision': 0.9096577, 'recall': 0.9095683, 'specificity': 0.9095683, 'f1': 0.90956825, 'auroc': 0.97010434, 'binary_precision': 0.9039817, 'binary_recall': 0.91664934, 'binary_specificity': 0.90248734, 'binary_f1_score': 0.9102714}
confusion matrix:
       0      1
0  25979   2807
1   2403  26427
---- Validation: 
scalar performance:
{'acc': 0.82310563, 'precision': 0.52507126, 'recall': 0.6006932, 'specificity': 0.6006932, 'f1': 0.5147159, 'auroc': 0.6826221, 'binary_precision': 0.07768542, 'binary_recall': 0.36106983, 'binary_specificity': 0.8403166, 'binary_f1_score': 0.1278611}
confusion matrix:
       0     1
0  15182  2885
1    430   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8490171, 'precision': 0.5710741, 'recall': 0.73914784, 'specificity': 0.73914784, 'f1': 0.58587265, 'auroc': 0.8056599, 'binary_precision': 0.16116115, 'binary_recall': 0.61923075, 'binary_specificity': 0.85906494, 'binary_f1_score': 0.25575852}
confusion matrix:
      0    1
0  5108  838
1    99  161
better model found
persisted
after epoch: 14,now: 2024-08-05 03:03:48.204599,epoch time: 0:12:36.917876,used: 2:55:47.401859,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.91183007, 'precision': 0.91382515, 'recall': 0.9118048, 'specificity': 0.9118048, 'f1': 0.91172004, 'auroc': 0.9766395, 'binary_precision': 0.88527304, 'binary_recall': 0.94644284, 'binary_specificity': 0.87716675, 'binary_f1_score': 0.9148366}
confusion matrix:
       0      1
0  25251   3536
1   1544  27285
---- Validation: 
scalar performance:
{'acc': 0.7801494, 'precision': 0.53099924, 'recall': 0.65423334, 'specificity': 0.65423334, 'f1': 0.50936645, 'auroc': 0.71164244, 'binary_precision': 0.08419783, 'binary_recall': 0.5185735, 'binary_specificity': 0.78989315, 'binary_f1_score': 0.1448734}
confusion matrix:
       0     1
0  14271  3796
1    324   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8366097, 'precision': 0.57412666, 'recall': 0.77313066, 'specificity': 0.77313066, 'f1': 0.5866515, 'auroc': 0.8468783, 'binary_precision': 0.16339286, 'binary_recall': 0.70384616, 'binary_specificity': 0.8424151, 'binary_f1_score': 0.2652174}
confusion matrix:
      0    1
0  5009  937
1    77  183
early stop counter: 1
val acc:0.7801494002342224, best validation acc: 0.8231056332588196, corresponding to test acc:                         0.8490170836448669 / 0.873187243938446
after epoch: 15,now: 2024-08-05 03:16:12.206891,epoch time: 0:12:24.002292,used: 3:08:11.404151,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_00_08_00_seed_1_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:08:11.404151 at 2024-08-05 03:16:12.206891
persisted model performance metric: 

scalar performance:
{'acc': 0.8490171, 'precision': 0.5710741, 'recall': 0.73914784, 'specificity': 0.73914784, 'f1': 0.58587265, 'auroc': 0.8056599, 'binary_precision': 0.16116115, 'binary_recall': 0.61923075, 'binary_specificity': 0.85906494, 'binary_f1_score': 0.25575852}
confusion matrix:
      0    1
0  5108  838
1    99  161
oracle model performance metric: 

scalar performance:
{'acc': 0.87318724, 'precision': 0.5500162, 'recall': 0.6267103, 'specificity': 0.6267103, 'f1': 0.56118083, 'auroc': 0.70872545, 'binary_precision': 0.13043478, 'binary_recall': 0.3576923, 'binary_specificity': 0.89572823, 'binary_f1_score': 0.19116135}
confusion matrix:
      0    1
0  5326  620
1   167   93
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205607 KiB | 643417 KiB |    921 TiB |    921 TiB |
|       from large pool | 168576 KiB | 570688 KiB |    921 TiB |    921 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 205607 KiB | 643417 KiB |    921 TiB |    921 TiB |
|       from large pool | 168576 KiB | 570688 KiB |    921 TiB |    921 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |    918 TiB |    918 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    918 TiB |    918 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 706560 KiB | 706560 KiB |   1110 MiB | 430080 KiB |
|       from large pool | 630784 KiB | 630784 KiB |   1012 MiB | 405504 KiB |
|       from small pool |  75776 KiB |  75776 KiB |     98 MiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  27864 KiB | 241717 KiB | 397587 GiB | 397587 GiB |
|       from large pool |  15744 KiB | 240320 KiB | 397281 GiB | 397281 GiB |
|       from small pool |  12120 KiB |  21751 KiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7971    |   88850 K  |   88847 K  |
|       from large pool |      36    |      76    |   33048 K  |   33048 K  |
|       from small pool |    3192    |    7933    |   55802 K  |   55798 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7971    |   88850 K  |   88847 K  |
|       from large pool |      36    |      76    |   33048 K  |   33048 K  |
|       from small pool |    3192    |    7933    |   55802 K  |   55798 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      72    |      18    |
|       from large pool |      17    |      17    |      23    |       6    |
|       from small pool |      37    |      37    |      49    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      50    |    3615    |   46948 K  |   46948 K  |
|       from large pool |       3    |      13    |   18728 K  |   18728 K  |
|       from small pool |      47    |    3612    |   28220 K  |   28220 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 643417 KiB |    921 TiB |    921 TiB |
|       from large pool |  16640 KiB | 570688 KiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 643417 KiB |    921 TiB |    921 TiB |
|       from large pool |  16640 KiB | 570688 KiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    918 TiB |    918 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    918 TiB |    918 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 706560 KiB |   1110 MiB |    882 MiB |
|       from large pool | 184320 KiB | 630784 KiB |   1012 MiB |    832 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 241717 KiB | 397587 GiB | 397587 GiB |
|       from large pool |  24320 KiB | 240320 KiB | 397281 GiB | 397281 GiB |
|       from small pool |      0 KiB |  21751 KiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   88850 K  |   88850 K  |
|       from large pool |       2    |      76    |   33048 K  |   33048 K  |
|       from small pool |       0    |    7933    |   55802 K  |   55802 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   88850 K  |   88850 K  |
|       from large pool |       2    |      76    |   33048 K  |   33048 K  |
|       from small pool |       0    |    7933    |   55802 K  |   55802 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      54    |      72    |      39    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3615    |   46949 K  |   46949 K  |
|       from large pool |       3    |      13    |   18728 K  |   18728 K  |
|       from small pool |       0    |    3612    |   28221 K  |   28221 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 643417 KiB |    921 TiB |    921 TiB |
|       from large pool |  16640 KiB | 570688 KiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 643417 KiB |    921 TiB |    921 TiB |
|       from large pool |  16640 KiB | 570688 KiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    918 TiB |    918 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    918 TiB |    918 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 706560 KiB |   1110 MiB |    882 MiB |
|       from large pool | 184320 KiB | 630784 KiB |   1012 MiB |    832 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 241717 KiB | 397587 GiB | 397587 GiB |
|       from large pool |  24320 KiB | 240320 KiB | 397281 GiB | 397281 GiB |
|       from small pool |      0 KiB |  21751 KiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   88850 K  |   88850 K  |
|       from large pool |       2    |      76    |   33048 K  |   33048 K  |
|       from small pool |       0    |    7933    |   55802 K  |   55802 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   88850 K  |   88850 K  |
|       from large pool |       2    |      76    |   33048 K  |   33048 K  |
|       from small pool |       0    |    7933    |   55802 K  |   55802 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      54    |      72    |      39    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3615    |   46949 K  |   46949 K  |
|       from large pool |       3    |      13    |   18728 K  |   18728 K  |
|       from small pool |       0    |    3612    |   28221 K  |   28221 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118

 Experiment start at: 2024-08-05 03:23:32.629456
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.760754, 'precision': 0.7637389, 'recall': 0.760743, 'specificity': 0.760743, 'f1': 0.76006997, 'auroc': 0.84679306, 'binary_precision': 0.7357327, 'binary_recall': 0.813979, 'binary_specificity': 0.707507, 'binary_f1_score': 0.7728805}
confusion matrix:
       0      1
0  20621   8525
1   5424  23734
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.682363, 'precision': 0.5167391, 'recall': 0.6174907, 'specificity': 0.6174907, 'f1': 0.45340943, 'auroc': 0.6684648, 'binary_precision': 0.05480817, 'binary_recall': 0.5481728, 'binary_specificity': 0.68680865, 'binary_f1_score': 0.09965272}
confusion matrix:
       0     1
0  12480  5691
1    272   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68087834, 'precision': 0.5313807, 'recall': 0.68727756, 'specificity': 0.68727756, 'f1': 0.47412682, 'auroc': 0.7592474, 'binary_precision': 0.08057554, 'binary_recall': 0.6942149, 'binary_specificity': 0.6803402, 'binary_f1_score': 0.14439192}
confusion matrix:
      0     1
0  4080  1917
1    74   168
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 03:38:10.838335,epoch time: 0:14:38.208879,used: 0:14:38.208879,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8001681, 'precision': 0.81911016, 'recall': 0.80013883, 'specificity': 0.80013883, 'f1': 0.7971473, 'auroc': 0.9116527, 'binary_precision': 0.7414231, 'binary_recall': 0.9219795, 'binary_specificity': 0.6782982, 'binary_f1_score': 0.8219019}
confusion matrix:
       0      1
0  19769   9376
1   2275  26884
---- Validation: 
scalar performance:
{'acc': 0.5830182, 'precision': 0.51390576, 'recall': 0.6095373, 'specificity': 0.6095373, 'f1': 0.40947336, 'auroc': 0.6434845, 'binary_precision': 0.048036028, 'binary_recall': 0.63787377, 'binary_specificity': 0.58120084, 'binary_f1_score': 0.08934388}
confusion matrix:
       0     1
0  10561  7610
1    218   384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61003363, 'precision': 0.5310541, 'recall': 0.701977, 'specificity': 0.701977, 'f1': 0.44279912, 'auroc': 0.80292284, 'binary_precision': 0.075222954, 'binary_recall': 0.8016529, 'binary_specificity': 0.6023012, 'binary_f1_score': 0.13753988}
confusion matrix:
      0     1
0  3612  2385
1    48   194
early stop counter: 1
val acc:0.5830181837081909, best validation acc: 0.682362973690033, corresponding to test acc:                         0.6808783411979675 / 0.6808783411979675
after epoch: 2,now: 2024-08-05 03:51:51.170625,epoch time: 0:13:40.332290,used: 0:28:18.541169,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84839803, 'precision': 0.85121053, 'recall': 0.8483888, 'specificity': 0.8483888, 'f1': 0.8480915, 'auroc': 0.9334941, 'binary_precision': 0.81983316, 'binary_recall': 0.89313394, 'binary_specificity': 0.8036437, 'binary_f1_score': 0.8549152}
confusion matrix:
       0      1
0  23423   5723
1   3116  26042
---- Validation: 
scalar performance:
{'acc': 0.69786394, 'precision': 0.51470035, 'recall': 0.5998004, 'specificity': 0.5998004, 'f1': 0.4568723, 'auroc': 0.64062905, 'binary_precision': 0.052594423, 'binary_recall': 0.4950166, 'binary_specificity': 0.70458424, 'binary_f1_score': 0.09508616}
confusion matrix:
       0     1
0  12803  5368
1    304   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73906076, 'precision': 0.5402482, 'recall': 0.71555996, 'specificity': 0.71555996, 'f1': 0.50771135, 'auroc': 0.77911925, 'binary_precision': 0.09709302, 'binary_recall': 0.69008267, 'binary_specificity': 0.7410372, 'binary_f1_score': 0.17023446}
confusion matrix:
      0     1
0  4444  1553
1    75   167
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-05 04:05:21.723619,epoch time: 0:13:30.552994,used: 0:41:49.094163,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8587747, 'precision': 0.8647337, 'recall': 0.85875934, 'specificity': 0.85875934, 'f1': 0.8581918, 'auroc': 0.9471085, 'binary_precision': 0.8181735, 'binary_recall': 0.92266536, 'binary_specificity': 0.7948533, 'binary_f1_score': 0.86728346}
confusion matrix:
       0      1
0  23166   5979
1   2255  26904
---- Validation: 
scalar performance:
{'acc': 0.6933362, 'precision': 0.517653, 'recall': 0.62155294, 'specificity': 0.62155294, 'f1': 0.45868793, 'auroc': 0.65723157, 'binary_precision': 0.056444675, 'binary_recall': 0.54485047, 'binary_specificity': 0.6982555, 'binary_f1_score': 0.102292225}
confusion matrix:
       0     1
0  12688  5483
1    274   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7504408, 'precision': 0.5462563, 'recall': 0.7432897, 'specificity': 0.7432897, 'f1': 0.51936084, 'auroc': 0.8057948, 'binary_precision': 0.10652304, 'binary_recall': 0.7355372, 'binary_specificity': 0.7510422, 'binary_f1_score': 0.18609513}
confusion matrix:
      0     1
0  4504  1493
1    64   178
new oracle model saved
early stop counter: 1
val acc:0.6933361887931824, best validation acc: 0.6978639364242554, corresponding to test acc:                         0.7390607595443726 / 0.750440776348114
after epoch: 4,now: 2024-08-05 04:18:54.590008,epoch time: 0:13:32.866389,used: 0:55:21.960552,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8671961, 'precision': 0.8702836, 'recall': 0.8671914, 'specificity': 0.8671914, 'f1': 0.8669176, 'auroc': 0.9491852, 'binary_precision': 0.83649737, 'binary_recall': 0.91284513, 'binary_specificity': 0.8215376, 'binary_f1_score': 0.8730052}
confusion matrix:
       0      1
0  23947   5202
1   2541  26614
---- Validation: 
scalar performance:
{'acc': 0.71474993, 'precision': 0.52041954, 'recall': 0.6350237, 'specificity': 0.6350237, 'f1': 0.47008896, 'auroc': 0.68517137, 'binary_precision': 0.0611265, 'binary_recall': 0.5498339, 'binary_specificity': 0.72021353, 'binary_f1_score': 0.110021606}
confusion matrix:
       0     1
0  13087  5084
1    271   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77945185, 'precision': 0.5482896, 'recall': 0.732605, 'specificity': 0.732605, 'f1': 0.5328482, 'auroc': 0.8052613, 'binary_precision': 0.11270492, 'binary_recall': 0.6818182, 'binary_specificity': 0.7833917, 'binary_f1_score': 0.19343492}
confusion matrix:
      0     1
0  4698  1299
1    77   165
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-05 04:32:31.885340,epoch time: 0:13:37.295332,used: 1:08:59.255884,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8866116, 'precision': 0.88837576, 'recall': 0.88660574, 'specificity': 0.88660574, 'f1': 0.8864815, 'auroc': 0.9599016, 'binary_precision': 0.86224294, 'binary_recall': 0.92029357, 'binary_specificity': 0.85291797, 'binary_f1_score': 0.890323}
confusion matrix:
       0      1
0  24860   4287
1   2324  26833
---- Validation: 
scalar performance:
{'acc': 0.75011986, 'precision': 0.5229131, 'recall': 0.6388397, 'specificity': 0.6388397, 'f1': 0.48609173, 'auroc': 0.6777704, 'binary_precision': 0.06638388, 'binary_recall': 0.5199336, 'binary_specificity': 0.75774586, 'binary_f1_score': 0.117735565}
confusion matrix:
       0     1
0  13769  4402
1    289   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8020516, 'precision': 0.54672205, 'recall': 0.704706, 'specificity': 0.704706, 'f1': 0.53870475, 'auroc': 0.7817883, 'binary_precision': 0.11301637, 'binary_recall': 0.59917355, 'binary_specificity': 0.8102385, 'binary_f1_score': 0.19016394}
confusion matrix:
      0     1
0  4859  1138
1    97   145
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-05 04:46:03.276759,epoch time: 0:13:31.391419,used: 1:22:30.647303,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8916198, 'precision': 0.89162, 'recall': 0.8916197, 'specificity': 0.8916197, 'f1': 0.8916198, 'auroc': 0.9602257, 'binary_precision': 0.89138705, 'binary_recall': 0.8919679, 'binary_specificity': 0.89127153, 'binary_f1_score': 0.8916774}
confusion matrix:
       0      1
0  25977   3169
1   3150  26008
---- Validation: 
scalar performance:
{'acc': 0.8158526, 'precision': 0.52943397, 'recall': 0.640673, 'specificity': 0.640673, 'f1': 0.51666796, 'auroc': 0.705086, 'binary_precision': 0.08027051, 'binary_recall': 0.45348838, 'binary_specificity': 0.82785755, 'binary_f1_score': 0.1363977}
confusion matrix:
       0     1
0  15043  3128
1    329   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8518993, 'precision': 0.5584301, 'recall': 0.70089453, 'specificity': 0.70089453, 'f1': 0.56889063, 'auroc': 0.7810476, 'binary_precision': 0.13800424, 'binary_recall': 0.5371901, 'binary_specificity': 0.864599, 'binary_f1_score': 0.2195946}
confusion matrix:
      0    1
0  5185  812
1   112  130
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-05 04:59:19.447607,epoch time: 0:13:16.170848,used: 1:35:46.818151,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89354074, 'precision': 0.89372087, 'recall': 0.89354223, 'specificity': 0.89354223, 'f1': 0.8935288, 'auroc': 0.9617493, 'binary_precision': 0.90217656, 'binary_recall': 0.8828372, 'binary_specificity': 0.9042473, 'binary_f1_score': 0.8924021}
confusion matrix:
       0      1
0  26357   2791
1   3416  25740
---- Validation: 
scalar performance:
{'acc': 0.81755716, 'precision': 0.51876515, 'recall': 0.58614314, 'specificity': 0.58614314, 'f1': 0.5024256, 'auroc': 0.6577375, 'binary_precision': 0.06313835, 'binary_recall': 0.33887044, 'binary_specificity': 0.83341587, 'binary_f1_score': 0.106444046}
confusion matrix:
       0     1
0  15144  3027
1    398   204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85173905, 'precision': 0.5593007, 'recall': 0.70477664, 'specificity': 0.70477664, 'f1': 0.5700486, 'auroc': 0.7852825, 'binary_precision': 0.13938753, 'binary_recall': 0.54545456, 'binary_specificity': 0.8640987, 'binary_f1_score': 0.22203532}
confusion matrix:
      0    1
0  5182  815
1   110  132
better model found
persisted
after epoch: 8,now: 2024-08-05 05:12:20.016672,epoch time: 0:13:00.569065,used: 1:48:47.387216,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9017392, 'precision': 0.90223014, 'recall': 0.90173674, 'specificity': 0.90173674, 'f1': 0.9017088, 'auroc': 0.9665855, 'binary_precision': 0.8882113, 'binary_recall': 0.9191933, 'binary_specificity': 0.8842802, 'binary_f1_score': 0.9034368}
confusion matrix:
       0      1
0  25775   3373
1   2356  26800
---- Validation: 
scalar performance:
{'acc': 0.7846375, 'precision': 0.530288, 'recall': 0.66630685, 'specificity': 0.66630685, 'f1': 0.50772035, 'auroc': 0.7174106, 'binary_precision': 0.07944268, 'binary_recall': 0.5398671, 'binary_specificity': 0.79274666, 'binary_f1_score': 0.13850415}
confusion matrix:
       0     1
0  14405  3766
1    277   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8430838, 'precision': 0.55906355, 'recall': 0.71613634, 'specificity': 0.71613634, 'f1': 0.567568, 'auroc': 0.79890496, 'binary_precision': 0.13765979, 'binary_recall': 0.5785124, 'binary_specificity': 0.85376024, 'binary_f1_score': 0.22239874}
confusion matrix:
      0    1
0  5120  877
1   102  140
early stop counter: 1
val acc:0.7846375107765198, best validation acc: 0.817557156085968, corresponding to test acc:                         0.8517390489578247 / 0.8518993258476257
after epoch: 9,now: 2024-08-05 05:25:20.419083,epoch time: 0:13:00.402411,used: 2:01:47.789627,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9053924, 'precision': 0.90629226, 'recall': 0.90538836, 'specificity': 0.90538836, 'f1': 0.90533936, 'auroc': 0.97073793, 'binary_precision': 0.8872146, 'binary_recall': 0.92890215, 'binary_specificity': 0.8818746, 'binary_f1_score': 0.9075799}
confusion matrix:
       0      1
0  25704   3443
1   2073  27084
---- Validation: 
scalar performance:
{'acc': 0.7740372, 'precision': 0.5251214, 'recall': 0.641558, 'specificity': 0.641558, 'f1': 0.49728033, 'auroc': 0.6946863, 'binary_precision': 0.070957094, 'binary_recall': 0.5, 'binary_specificity': 0.783116, 'binary_f1_score': 0.12427746}
confusion matrix:
       0     1
0  14230  3941
1    301   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81920177, 'precision': 0.5545441, 'recall': 0.7255236, 'specificity': 0.7255236, 'f1': 0.55454445, 'auroc': 0.807629, 'binary_precision': 0.12710437, 'binary_recall': 0.62396693, 'binary_specificity': 0.8270802, 'binary_f1_score': 0.2111888}
confusion matrix:
      0     1
0  4960  1037
1    91   151
early stop counter: 2
val acc:0.7740371823310852, best validation acc: 0.817557156085968, corresponding to test acc:                         0.8517390489578247 / 0.8518993258476257
after epoch: 10,now: 2024-08-05 05:38:06.411558,epoch time: 0:12:45.992475,used: 2:14:33.782102,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90750206, 'precision': 0.9098066, 'recall': 0.9074918, 'specificity': 0.9074918, 'f1': 0.9073703, 'auroc': 0.9731443, 'binary_precision': 0.87914366, 'binary_recall': 0.94495887, 'binary_specificity': 0.8700247, 'binary_f1_score': 0.91086394}
confusion matrix:
       0      1
0  25356   3788
1   1605  27555
---- Validation: 
scalar performance:
{'acc': 0.7833058, 'precision': 0.5285389, 'recall': 0.6567855, 'specificity': 0.6567855, 'f1': 0.50494766, 'auroc': 0.7259395, 'binary_precision': 0.0766976, 'binary_recall': 0.5215947, 'binary_specificity': 0.7919762, 'binary_f1_score': 0.13373083}
confusion matrix:
       0     1
0  14391  3780
1    288   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83587116, 'precision': 0.5599681, 'recall': 0.7302291, 'specificity': 0.7302291, 'f1': 0.5668134, 'auroc': 0.817567, 'binary_precision': 0.13796297, 'binary_recall': 0.61570245, 'binary_specificity': 0.8447557, 'binary_f1_score': 0.22541603}
confusion matrix:
      0    1
0  5066  931
1    93  149
early stop counter: 3
val acc:0.783305823802948, best validation acc: 0.817557156085968, corresponding to test acc:                         0.8517390489578247 / 0.8518993258476257
after epoch: 11,now: 2024-08-05 05:50:52.440722,epoch time: 0:12:46.029164,used: 2:27:19.811266,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91683245, 'precision': 0.91736466, 'recall': 0.91683555, 'specificity': 0.91683555, 'f1': 0.91680634, 'auroc': 0.9743779, 'binary_precision': 0.9323113, 'binary_recall': 0.89896077, 'binary_specificity': 0.93471026, 'binary_f1_score': 0.9153323}
confusion matrix:
       0      1
0  27244   1903
1   2946  26211
---- Validation: 
scalar performance:
{'acc': 0.86150324, 'precision': 0.53979325, 'recall': 0.64819354, 'specificity': 0.64819354, 'f1': 0.54370844, 'auroc': 0.7236406, 'binary_precision': 0.10103834, 'binary_recall': 0.4202658, 'binary_specificity': 0.8761213, 'binary_f1_score': 0.16291049}
confusion matrix:
       0     1
0  15920  2251
1    349   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.887482, 'precision': 0.5806604, 'recall': 0.72138655, 'specificity': 0.72138655, 'f1': 0.6054075, 'auroc': 0.80915135, 'binary_precision': 0.18144044, 'binary_recall': 0.5413223, 'binary_specificity': 0.90145075, 'binary_f1_score': 0.27178425}
confusion matrix:
      0    1
0  5406  591
1   111  131
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-05 06:03:48.138724,epoch time: 0:12:55.698002,used: 2:40:15.509268,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9200913, 'precision': 0.92020094, 'recall': 0.92008984, 'specificity': 0.92008984, 'f1': 0.9200858, 'auroc': 0.97660005, 'binary_precision': 0.9134544, 'binary_recall': 0.9281476, 'binary_specificity': 0.9120321, 'binary_f1_score': 0.92074233}
confusion matrix:
       0      1
0  26583   2564
1   2095  27062
---- Validation: 
scalar performance:
{'acc': 0.8389176, 'precision': 0.53338605, 'recall': 0.6421479, 'specificity': 0.6421479, 'f1': 0.5288955, 'auroc': 0.7330965, 'binary_precision': 0.088375255, 'binary_recall': 0.43189368, 'binary_specificity': 0.85240215, 'binary_f1_score': 0.14672686}
confusion matrix:
       0     1
0  15489  2682
1    342   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8753005, 'precision': 0.5788125, 'recall': 0.74280834, 'specificity': 0.74280834, 'f1': 0.60167485, 'auroc': 0.83328164, 'binary_precision': 0.1755448, 'binary_recall': 0.59917355, 'binary_specificity': 0.8864432, 'binary_f1_score': 0.27153558}
confusion matrix:
      0    1
0  5316  681
1    97  145
early stop counter: 1
val acc:0.83891761302948, best validation acc: 0.8615032434463501, corresponding to test acc:                         0.8874819874763489 / 0.8874819874763489
after epoch: 13,now: 2024-08-05 06:16:48.449987,epoch time: 0:13:00.311263,used: 2:53:15.820531,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91009194, 'precision': 0.9114642, 'recall': 0.91008794, 'specificity': 0.91008794, 'f1': 0.91001636, 'auroc': 0.9740808, 'binary_precision': 0.8877359, 'binary_recall': 0.9389491, 'binary_specificity': 0.88122684, 'binary_f1_score': 0.9126246}
confusion matrix:
       0      1
0  25686   3462
1   1780  27376
---- Validation: 
scalar performance:
{'acc': 0.795664, 'precision': 0.5305728, 'recall': 0.6607601, 'specificity': 0.6607601, 'f1': 0.5117956, 'auroc': 0.7222185, 'binary_precision': 0.080653526, 'binary_recall': 0.5166113, 'binary_specificity': 0.80490893, 'binary_f1_score': 0.13952444}
confusion matrix:
       0     1
0  14626  3545
1    291   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83010095, 'precision': 0.5601946, 'recall': 0.73912406, 'specificity': 0.73912406, 'f1': 0.5654253, 'auroc': 0.81458426, 'binary_precision': 0.13741134, 'binary_recall': 0.6404959, 'binary_specificity': 0.8377522, 'binary_f1_score': 0.22627735}
confusion matrix:
      0    1
0  5024  973
1    87  155
early stop counter: 2
val acc:0.7956640124320984, best validation acc: 0.8615032434463501, corresponding to test acc:                         0.8874819874763489 / 0.8874819874763489
after epoch: 14,now: 2024-08-05 06:29:39.698985,epoch time: 0:12:51.248998,used: 3:06:07.069529,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92472214, 'precision': 0.9251265, 'recall': 0.9247195, 'specificity': 0.9247195, 'f1': 0.92470396, 'auroc': 0.9794302, 'binary_precision': 0.9120583, 'binary_recall': 0.9401173, 'binary_specificity': 0.9093217, 'binary_f1_score': 0.92587525}
confusion matrix:
       0      1
0  26504   2643
1   1746  27411
---- Validation: 
scalar performance:
{'acc': 0.82405585, 'precision': 0.5356812, 'recall': 0.66659284, 'specificity': 0.66659284, 'f1': 0.527775, 'auroc': 0.7290418, 'binary_precision': 0.09088155, 'binary_recall': 0.49833888, 'binary_specificity': 0.83484674, 'binary_f1_score': 0.1537279}
confusion matrix:
       0     1
0  15170  3001
1    302   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8576695, 'precision': 0.57372004, 'recall': 0.75743, 'specificity': 0.75743, 'f1': 0.59124, 'auroc': 0.8234476, 'binary_precision': 0.16354166, 'binary_recall': 0.6487603, 'binary_specificity': 0.8660997, 'binary_f1_score': 0.26123127}
confusion matrix:
      0    1
0  5194  803
1    85  157
early stop counter: 3
val acc:0.8240558505058289, best validation acc: 0.8615032434463501, corresponding to test acc:                         0.8874819874763489 / 0.8874819874763489
after epoch: 15,now: 2024-08-05 06:42:31.319616,epoch time: 0:12:51.620631,used: 3:18:58.690160,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_03_23_32_seed_2_24067118
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:18:58.690160 at 2024-08-05 06:42:31.319616
persisted model performance metric: 

scalar performance:
{'acc': 0.887482, 'precision': 0.5806604, 'recall': 0.72138655, 'specificity': 0.72138655, 'f1': 0.6054075, 'auroc': 0.80915135, 'binary_precision': 0.18144044, 'binary_recall': 0.5413223, 'binary_specificity': 0.90145075, 'binary_f1_score': 0.27178425}
confusion matrix:
      0    1
0  5406  591
1   111  131
oracle model performance metric: 

scalar performance:
{'acc': 0.887482, 'precision': 0.5806604, 'recall': 0.72138655, 'specificity': 0.72138655, 'f1': 0.6054075, 'auroc': 0.80915135, 'binary_precision': 0.18144044, 'binary_recall': 0.5413223, 'binary_specificity': 0.90145075, 'binary_f1_score': 0.27178425}
confusion matrix:
      0    1
0  5406  591
1   111  131
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205613 KiB | 643417 KiB |   1396 TiB |   1396 TiB |
|       from large pool | 168576 KiB | 570688 KiB |   1396 TiB |   1396 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 205613 KiB | 643417 KiB |   1396 TiB |   1396 TiB |
|       from large pool | 168576 KiB | 570688 KiB |   1396 TiB |   1396 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   1392 TiB |   1392 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1392 TiB |   1392 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 706560 KiB | 706560 KiB |   1572 MiB |    882 MiB |
|       from large pool | 630784 KiB | 630784 KiB |   1448 MiB |    832 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    124 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  27858 KiB | 241717 KiB | 582870 GiB | 582870 GiB |
|       from large pool |  15744 KiB | 240320 KiB | 582406 GiB | 582406 GiB |
|       from small pool |  12114 KiB |  21751 KiB |    464 GiB |    464 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    8057    |  134435 K  |  134431 K  |
|       from large pool |      36    |      76    |   50095 K  |   50095 K  |
|       from small pool |    3204    |    8019    |   84339 K  |   84336 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    8057    |  134435 K  |  134431 K  |
|       from large pool |      36    |      76    |   50095 K  |   50095 K  |
|       from small pool |    3204    |    8019    |   84339 K  |   84336 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      93    |      39    |
|       from large pool |      17    |      17    |      31    |      14    |
|       from small pool |      37    |      37    |      62    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    3656    |   70785 K  |   70785 K  |
|       from large pool |       3    |      13    |   28093 K  |   28093 K  |
|       from small pool |      48    |    3653    |   42692 K  |   42692 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 643417 KiB |   1396 TiB |   1396 TiB |
|       from large pool |  16640 KiB | 570688 KiB |   1396 TiB |   1396 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 643417 KiB |   1396 TiB |   1396 TiB |
|       from large pool |  16640 KiB | 570688 KiB |   1396 TiB |   1396 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1392 TiB |   1392 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1392 TiB |   1392 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 706560 KiB |   1572 MiB |   1344 MiB |
|       from large pool | 184320 KiB | 630784 KiB |   1448 MiB |   1268 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    124 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 241717 KiB | 582871 GiB | 582871 GiB |
|       from large pool |  24320 KiB | 240320 KiB | 582406 GiB | 582406 GiB |
|       from small pool |      0 KiB |  21751 KiB |    464 GiB |    464 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8057    |  134435 K  |  134435 K  |
|       from large pool |       2    |      76    |   50095 K  |   50095 K  |
|       from small pool |       0    |    8019    |   84339 K  |   84339 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8057    |  134435 K  |  134435 K  |
|       from large pool |       2    |      76    |   50095 K  |   50095 K  |
|       from small pool |       0    |    8019    |   84339 K  |   84339 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      54    |      93    |      60    |
|       from large pool |       9    |      17    |      31    |      22    |
|       from small pool |      24    |      37    |      62    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3656    |   70787 K  |   70787 K  |
|       from large pool |       3    |      13    |   28093 K  |   28093 K  |
|       from small pool |       0    |    3653    |   42693 K  |   42693 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 06:43:28 2024]
Finished job 0.
1 of 1 steps (100%) done
