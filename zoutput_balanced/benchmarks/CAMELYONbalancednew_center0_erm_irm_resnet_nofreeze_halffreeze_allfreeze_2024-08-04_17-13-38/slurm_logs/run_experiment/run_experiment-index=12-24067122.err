Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug  5 01:22:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122

 Experiment start at: 2024-08-05 01:30:00.808597
before training, model accuracy: 0.31048259139060974
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94606, 'precision': 0.9485312, 'recall': 0.9460342, 'specificity': 0.9460342, 'f1': 0.9459834, 'auroc': 0.9924649, 'binary_precision': 0.91541207, 'binary_recall': 0.98303133, 'binary_specificity': 0.909037, 'binary_f1_score': 0.9480174}
confusion matrix:
       0      1
0  26053   2607
1    487  28213
---- Validation: 
scalar performance:
{'acc': 0.84509367, 'precision': 0.56193495, 'recall': 0.760041, 'specificity': 0.760041, 'f1': 0.5709826, 'auroc': 0.806779, 'binary_precision': 0.13746803, 'binary_recall': 0.6687403, 'binary_specificity': 0.85134166, 'binary_f1_score': 0.2280562}
confusion matrix:
       0     1
0  15451  2698
1    213   430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85602427, 'precision': 0.5937713, 'recall': 0.8295977, 'specificity': 0.8295977, 'f1': 0.6182194, 'auroc': 0.907402, 'binary_precision': 0.19754253, 'binary_recall': 0.8007663, 'binary_specificity': 0.8584292, 'binary_f1_score': 0.31690675}
confusion matrix:
      0    1
0  5148  849
1    52  209
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 01:40:51.282615,epoch time: 0:10:50.474018,used: 0:10:50.474018,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9722803, 'precision': 0.97228897, 'recall': 0.97227895, 'specificity': 0.97227895, 'f1': 0.97228014, 'auroc': 0.9958329, 'binary_precision': 0.970431, 'binary_recall': 0.9742857, 'binary_specificity': 0.9702722, 'binary_f1_score': 0.97235453}
confusion matrix:
       0      1
0  27808    852
1    738  27962
---- Validation: 
scalar performance:
{'acc': 0.9375266, 'precision': 0.6188158, 'recall': 0.6976367, 'specificity': 0.6976367, 'f1': 0.6462672, 'auroc': 0.8009318, 'binary_precision': 0.2579763, 'binary_recall': 0.44012442, 'binary_specificity': 0.95514905, 'binary_f1_score': 0.32528737}
confusion matrix:
       0    1
0  17335  814
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9237776, 'precision': 0.6605586, 'recall': 0.8667811, 'specificity': 0.8667811, 'f1': 0.713587, 'auroc': 0.9220594, 'binary_precision': 0.3301887, 'binary_recall': 0.8045977, 'binary_specificity': 0.9289645, 'binary_f1_score': 0.46822742}
confusion matrix:
      0    1
0  5571  426
1    51  210
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-05 01:50:54.991792,epoch time: 0:10:03.709177,used: 0:20:54.183195,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9653417, 'precision': 0.9659392, 'recall': 0.9653269, 'specificity': 0.9653269, 'f1': 0.96532977, 'auroc': 0.9964161, 'binary_precision': 0.94946164, 'binary_recall': 0.9830686, 'binary_specificity': 0.94758517, 'binary_f1_score': 0.9659729}
confusion matrix:
       0      1
0  27154   1502
1    486  28218
---- Validation: 
scalar performance:
{'acc': 0.8979353, 'precision': 0.5711136, 'recall': 0.694391, 'specificity': 0.694391, 'f1': 0.5935908, 'auroc': 0.78003263, 'binary_precision': 0.16216215, 'binary_recall': 0.47589424, 'binary_specificity': 0.91288775, 'binary_f1_score': 0.24189721}
confusion matrix:
       0     1
0  16568  1581
1    337   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8700863, 'precision': 0.60435027, 'recall': 0.8442641, 'specificity': 0.8442641, 'f1': 0.635866, 'auroc': 0.91731054, 'binary_precision': 0.21779141, 'binary_recall': 0.81609195, 'binary_specificity': 0.8724362, 'binary_f1_score': 0.34382567}
confusion matrix:
      0    1
0  5232  765
1    48  213
early stop counter: 1
val acc:0.8979352712631226, best validation acc: 0.9375265836715698, corresponding to test acc:                         0.9237775802612305 / 0.9237775802612305
after epoch: 3,now: 2024-08-05 02:00:49.189659,epoch time: 0:09:54.197867,used: 0:30:48.381062,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96284866, 'precision': 0.9637233, 'recall': 0.9628314, 'specificity': 0.9628314, 'f1': 0.96283007, 'auroc': 0.9962766, 'binary_precision': 0.9437838, 'binary_recall': 0.98439187, 'binary_specificity': 0.9412709, 'binary_f1_score': 0.96366024}
confusion matrix:
       0      1
0  26974   1683
1    448  28255
---- Validation: 
scalar performance:
{'acc': 0.8429119, 'precision': 0.54109913, 'recall': 0.6629044, 'specificity': 0.6629044, 'f1': 0.5415509, 'auroc': 0.74936485, 'binary_precision': 0.10367319, 'binary_recall': 0.4696734, 'binary_specificity': 0.8561353, 'binary_f1_score': 0.16985376}
confusion matrix:
       0     1
0  15538  2611
1    341   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82566315, 'precision': 0.5856782, 'recall': 0.8504032, 'specificity': 0.8504032, 'f1': 0.5980972, 'auroc': 0.94151866, 'binary_precision': 0.17779504, 'binary_recall': 0.8773946, 'binary_specificity': 0.8234117, 'binary_f1_score': 0.29567465}
confusion matrix:
      0     1
0  4938  1059
1    32   229
early stop counter: 2
val acc:0.8429118990898132, best validation acc: 0.9375265836715698, corresponding to test acc:                         0.9237775802612305 / 0.9237775802612305
after epoch: 4,now: 2024-08-05 02:10:45.968827,epoch time: 0:09:56.779168,used: 0:40:45.160230,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9718096, 'precision': 0.9718992, 'recall': 0.9718045, 'specificity': 0.9718045, 'f1': 0.9718081, 'auroc': 0.99643, 'binary_precision': 0.965586, 'binary_recall': 0.9785381, 'binary_specificity': 0.96507084, 'binary_f1_score': 0.9720189}
confusion matrix:
       0      1
0  27657   1001
1    616  28086
---- Validation: 
scalar performance:
{'acc': 0.9057578, 'precision': 0.56412345, 'recall': 0.65268743, 'specificity': 0.65268743, 'f1': 0.5832905, 'auroc': 0.684201, 'binary_precision': 0.1514215, 'binary_recall': 0.38102645, 'binary_specificity': 0.9243485, 'binary_f1_score': 0.21671827}
confusion matrix:
       0     1
0  16776  1373
1    398   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8908597, 'precision': 0.6238111, 'recall': 0.8679292, 'specificity': 0.8679292, 'f1': 0.66592926, 'auroc': 0.9232304, 'binary_precision': 0.2552204, 'binary_recall': 0.8429119, 'binary_specificity': 0.8929465, 'binary_f1_score': 0.39180762}
confusion matrix:
      0    1
0  5355  642
1    41  220
early stop counter: 3
val acc:0.9057577848434448, best validation acc: 0.9375265836715698, corresponding to test acc:                         0.9237775802612305 / 0.9237775802612305
after epoch: 5,now: 2024-08-05 02:20:41.491065,epoch time: 0:09:55.522238,used: 0:50:40.682468,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9631451, 'precision': 0.9641897, 'recall': 0.9631262, 'specificity': 0.9631262, 'f1': 0.9631232, 'auroc': 0.99700046, 'binary_precision': 0.9423685, 'binary_recall': 0.9866913, 'binary_specificity': 0.939561, 'binary_f1_score': 0.9640207}
confusion matrix:
       0      1
0  26925   1732
1    382  28321
---- Validation: 
scalar performance:
{'acc': 0.8637718, 'precision': 0.54446465, 'recall': 0.65345234, 'specificity': 0.65345234, 'f1': 0.551295, 'auroc': 0.73826873, 'binary_precision': 0.11147142, 'binary_recall': 0.42768273, 'binary_specificity': 0.879222, 'binary_f1_score': 0.17684887}
confusion matrix:
       0     1
0  15957  2192
1    368   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8678492, 'precision': 0.6058135, 'recall': 0.85775554, 'specificity': 0.85775554, 'f1': 0.6373875, 'auroc': 0.9268223, 'binary_precision': 0.21924603, 'binary_recall': 0.8467433, 'binary_specificity': 0.86876774, 'binary_f1_score': 0.34830576}
confusion matrix:
      0    1
0  5210  787
1    40  221
early stop counter: 4
val acc:0.8637717962265015, best validation acc: 0.9375265836715698, corresponding to test acc:                         0.9237775802612305 / 0.9237775802612305
after epoch: 6,now: 2024-08-05 02:30:30.144017,epoch time: 0:09:48.652952,used: 1:00:29.335420,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98061365, 'precision': 0.98070335, 'recall': 0.9806198, 'specificity': 0.9806198, 'f1': 0.98061293, 'auroc': 0.9969822, 'binary_precision': 0.9874916, 'binary_recall': 0.9735935, 'binary_specificity': 0.98764616, 'binary_f1_score': 0.9804933}
confusion matrix:
       0      1
0  28301    354
1    758  27947
---- Validation: 
scalar performance:
{'acc': 0.9538633, 'precision': 0.6493054, 'recall': 0.6468401, 'specificity': 0.6468401, 'f1': 0.6480608, 'auroc': 0.6996603, 'binary_precision': 0.3227848, 'binary_recall': 0.31726283, 'binary_specificity': 0.9764174, 'binary_f1_score': 0.31999996}
confusion matrix:
       0    1
0  17721  428
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.77369434, 'recall': 0.8459814, 'specificity': 0.8459814, 'f1': 0.80501634, 'auroc': 0.91336346, 'binary_precision': 0.55988026, 'binary_recall': 0.71647507, 'binary_specificity': 0.97548777, 'binary_f1_score': 0.62857145}
confusion matrix:
      0    1
0  5850  147
1    74  187
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-05 02:40:22.287615,epoch time: 0:09:52.143598,used: 1:10:21.479018,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9627092, 'precision': 0.96336436, 'recall': 0.962693, 'specificity': 0.962693, 'f1': 0.9626951, 'auroc': 0.99575794, 'binary_precision': 0.94615746, 'binary_recall': 0.9813273, 'binary_specificity': 0.94405866, 'binary_f1_score': 0.9634215}
confusion matrix:
       0      1
0  27052   1603
1    536  28169
---- Validation: 
scalar performance:
{'acc': 0.7895913, 'precision': 0.5224299, 'recall': 0.6105477, 'specificity': 0.6105477, 'f1': 0.5001417, 'auroc': 0.6054209, 'binary_precision': 0.06988829, 'binary_recall': 0.41835147, 'binary_specificity': 0.802744, 'binary_f1_score': 0.119768485}
confusion matrix:
       0     1
0  14569  3580
1    374   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80105466, 'precision': 0.57403666, 'recall': 0.82656944, 'specificity': 0.82656944, 'f1': 0.57436883, 'auroc': 0.9247395, 'binary_precision': 0.15594405, 'binary_recall': 0.8544061, 'binary_specificity': 0.7987327, 'binary_f1_score': 0.26374924}
confusion matrix:
      0     1
0  4790  1207
1    38   223
early stop counter: 1
val acc:0.7895913124084473, best validation acc: 0.9538633227348328, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 8,now: 2024-08-05 02:50:17.333310,epoch time: 0:09:55.045695,used: 1:20:16.524713,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9604951, 'precision': 0.9616677, 'recall': 0.9604733, 'specificity': 0.9604733, 'f1': 0.96046865, 'auroc': 0.9960382, 'binary_precision': 0.93861777, 'binary_recall': 0.9855077, 'binary_specificity': 0.9354388, 'binary_f1_score': 0.9614914}
confusion matrix:
       0      1
0  26805   1850
1    416  28289
---- Validation: 
scalar performance:
{'acc': 0.79416776, 'precision': 0.5238812, 'recall': 0.6159172, 'specificity': 0.6159172, 'f1': 0.50354296, 'auroc': 0.61262566, 'binary_precision': 0.07239459, 'binary_recall': 0.42457232, 'binary_specificity': 0.8072621, 'binary_f1_score': 0.12369732}
confusion matrix:
       0     1
0  14651  3498
1    370   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6612336, 'precision': 0.5465479, 'recall': 0.77193964, 'specificity': 0.77193964, 'f1': 0.48335332, 'auroc': 0.91169894, 'binary_precision': 0.100215055, 'binary_recall': 0.8927203, 'binary_specificity': 0.6511589, 'binary_f1_score': 0.18020107}
confusion matrix:
      0     1
0  3905  2092
1    28   233
early stop counter: 2
val acc:0.7941677570343018, best validation acc: 0.9538633227348328, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 9,now: 2024-08-05 03:00:11.266531,epoch time: 0:09:53.933221,used: 1:30:10.457934,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9425558, 'precision': 0.94631076, 'recall': 0.94252074, 'specificity': 0.94252074, 'f1': 0.94243157, 'auroc': 0.99540734, 'binary_precision': 0.9055646, 'binary_recall': 0.98825866, 'binary_specificity': 0.89678276, 'binary_f1_score': 0.9451062}
confusion matrix:
       0      1
0  25700   2958
1    337  28365
---- Validation: 
scalar performance:
{'acc': 0.69662625, 'precision': 0.5112587, 'recall': 0.571419, 'specificity': 0.571419, 'f1': 0.45385748, 'auroc': 0.5867277, 'binary_precision': 0.05, 'binary_recall': 0.43701398, 'binary_specificity': 0.705824, 'binary_f1_score': 0.089733355}
confusion matrix:
       0     1
0  12810  5339
1    362   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49568552, 'precision': 0.53549576, 'recall': 0.72037745, 'specificity': 0.72037745, 'f1': 0.39066818, 'auroc': 0.91327786, 'binary_precision': 0.07413945, 'binary_recall': 0.9655172, 'binary_specificity': 0.4752376, 'binary_f1_score': 0.13770492}
confusion matrix:
      0     1
0  2850  3147
1     9   252
early stop counter: 3
val acc:0.6966262459754944, best validation acc: 0.9538633227348328, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 10,now: 2024-08-05 03:09:56.406388,epoch time: 0:09:45.139857,used: 1:39:55.597791,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9553347, 'precision': 0.9572954, 'recall': 0.95530975, 'specificity': 0.95530975, 'f1': 0.9552851, 'auroc': 0.9963, 'binary_precision': 0.92754334, 'binary_recall': 0.9879103, 'binary_specificity': 0.92270917, 'binary_f1_score': 0.95677555}
confusion matrix:
       0      1
0  26443   2215
1    347  28355
---- Validation: 
scalar performance:
{'acc': 0.783312, 'precision': 0.5219945, 'recall': 0.61104715, 'specificity': 0.61104715, 'f1': 0.49754304, 'auroc': 0.60780007, 'binary_precision': 0.06889615, 'binary_recall': 0.42612752, 'binary_specificity': 0.79596674, 'binary_f1_score': 0.11861472}
confusion matrix:
       0     1
0  14446  3703
1    369   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5869287, 'precision': 0.5409189, 'recall': 0.7533259, 'specificity': 0.7533259, 'f1': 0.4425274, 'auroc': 0.9156558, 'binary_precision': 0.08677098, 'binary_recall': 0.9348659, 'binary_specificity': 0.57178587, 'binary_f1_score': 0.15880248}
confusion matrix:
      0     1
0  3429  2568
1    17   244
early stop counter: 4
val acc:0.7833120226860046, best validation acc: 0.9538633227348328, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 11,now: 2024-08-05 03:19:25.955737,epoch time: 0:09:29.549349,used: 1:49:25.147140,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.94443864, 'precision': 0.94739544, 'recall': 0.9444047, 'specificity': 0.9444047, 'f1': 0.9443437, 'auroc': 0.9949782, 'binary_precision': 0.9112329, 'binary_recall': 0.984915, 'binary_specificity': 0.9038945, 'binary_f1_score': 0.94664234}
confusion matrix:
       0      1
0  25902   2754
1    433  28271
---- Validation: 
scalar performance:
{'acc': 0.75335246, 'precision': 0.51813954, 'recall': 0.60078704, 'specificity': 0.60078704, 'f1': 0.4825132, 'auroc': 0.59504706, 'binary_precision': 0.061703995, 'binary_recall': 0.43701398, 'binary_specificity': 0.76456004, 'binary_f1_score': 0.10813931}
confusion matrix:
       0     1
0  13876  4273
1    362   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63390857, 'precision': 0.5470556, 'recall': 0.78333515, 'specificity': 0.78333515, 'f1': 0.47097284, 'auroc': 0.9263598, 'binary_precision': 0.09786054, 'binary_recall': 0.9463602, 'binary_specificity': 0.6203101, 'binary_f1_score': 0.17737882}
confusion matrix:
      0     1
0  3720  2277
1    14   247
early stop counter: 5
val acc:0.7533524632453918, best validation acc: 0.9538633227348328, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 12,now: 2024-08-05 03:29:18.826968,epoch time: 0:09:52.871231,used: 1:59:18.018371,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9208682, 'precision': 0.9291942, 'recall': 0.9208124, 'specificity': 0.9208124, 'f1': 0.9204755, 'auroc': 0.9954082, 'binary_precision': 0.86961573, 'binary_recall': 0.9903494, 'binary_specificity': 0.85127544, 'binary_f1_score': 0.92606413}
confusion matrix:
       0      1
0  24395   4262
1    277  28426
---- Validation: 
scalar performance:
{'acc': 0.5809919, 'precision': 0.5028977, 'recall': 0.5213042, 'specificity': 0.5213042, 'f1': 0.3995537, 'auroc': 0.5903233, 'binary_precision': 0.037600715, 'binary_recall': 0.45723173, 'binary_specificity': 0.5853766, 'binary_f1_score': 0.06948711}
confusion matrix:
       0     1
0  10624  7525
1    349   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37967402, 'precision': 0.5311572, 'recall': 0.67450583, 'specificity': 0.67450583, 'f1': 0.31984788, 'auroc': 0.935513, 'binary_precision': 0.062786765, 'binary_recall': 0.99616855, 'binary_specificity': 0.35284308, 'binary_f1_score': 0.11812812}
confusion matrix:
      0     1
0  2116  3881
1     1   260
early stop counter: 6
val acc:0.5809919238090515, best validation acc: 0.9538633227348328, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 13,now: 2024-08-05 03:39:13.194374,epoch time: 0:09:54.367406,used: 2:09:12.385777,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95394003, 'precision': 0.9558549, 'recall': 0.95391303, 'specificity': 0.95391303, 'f1': 0.95388967, 'auroc': 0.99610966, 'binary_precision': 0.92651874, 'binary_recall': 0.98616916, 'binary_specificity': 0.9216569, 'binary_f1_score': 0.9554138}
confusion matrix:
       0      1
0  26411   2245
1    397  28307
---- Validation: 
scalar performance:
{'acc': 0.84876543, 'precision': 0.53678644, 'recall': 0.63818276, 'specificity': 0.63818276, 'f1': 0.5370533, 'auroc': 0.6354163, 'binary_precision': 0.09710517, 'binary_recall': 0.41213062, 'binary_specificity': 0.8642349, 'binary_f1_score': 0.15717675}
confusion matrix:
       0     1
0  15685  2464
1    378   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8700863, 'precision': 0.60736763, 'recall': 0.8589227, 'specificity': 0.8589227, 'f1': 0.6399976, 'auroc': 0.92493176, 'binary_precision': 0.222334, 'binary_recall': 0.8467433, 'binary_specificity': 0.8711022, 'binary_f1_score': 0.35219124}
confusion matrix:
      0    1
0  5224  773
1    40  221
early stop counter: 7
val acc:0.8487654328346252, best validation acc: 0.9538633227348328, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 14,now: 2024-08-05 03:49:00.561014,epoch time: 0:09:47.366640,used: 2:18:59.752417,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9657427, 'precision': 0.96648955, 'recall': 0.96572673, 'specificity': 0.96572673, 'f1': 0.96572804, 'auroc': 0.99671155, 'binary_precision': 0.9480228, 'binary_recall': 0.9855764, 'binary_specificity': 0.9458771, 'binary_f1_score': 0.9664349}
confusion matrix:
       0      1
0  27106   1551
1    414  28289
---- Validation: 
scalar performance:
{'acc': 0.8166241, 'precision': 0.5294009, 'recall': 0.6305434, 'specificity': 0.6305434, 'f1': 0.5179458, 'auroc': 0.5990206, 'binary_precision': 0.08251415, 'binary_recall': 0.43079317, 'binary_specificity': 0.83029366, 'binary_f1_score': 0.1385}
confusion matrix:
       0     1
0  15069  3080
1    366   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6805689, 'precision': 0.55060554, 'recall': 0.7893573, 'specificity': 0.7893573, 'f1': 0.49631298, 'auroc': 0.92475355, 'binary_precision': 0.10714286, 'binary_recall': 0.90804595, 'binary_specificity': 0.67066866, 'binary_f1_score': 0.19167003}
confusion matrix:
      0     1
0  4022  1975
1    24   237
early stop counter: 8
val acc:0.816624104976654, best validation acc: 0.9538633227348328, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 15,now: 2024-08-05 03:58:56.325960,epoch time: 0:09:55.764946,used: 2:28:55.517363,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:28:55.517363 at 2024-08-05 03:58:56.325960
persisted model performance metric: 

scalar performance:
{'acc': 0.9646852, 'precision': 0.77369434, 'recall': 0.8459814, 'specificity': 0.8459814, 'f1': 0.80501634, 'auroc': 0.91336346, 'binary_precision': 0.55988026, 'binary_recall': 0.71647507, 'binary_specificity': 0.97548777, 'binary_f1_score': 0.62857145}
confusion matrix:
      0    1
0  5850  147
1    74  187
oracle model performance metric: 

scalar performance:
{'acc': 0.9646852, 'precision': 0.77369434, 'recall': 0.8459814, 'specificity': 0.8459814, 'f1': 0.80501634, 'auroc': 0.91336346, 'binary_precision': 0.55988026, 'binary_recall': 0.71647507, 'binary_specificity': 0.97548777, 'binary_f1_score': 0.62857145}
confusion matrix:
      0    1
0  5850  147
1    74  187
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 533599 KiB |   6391 MiB | 441184 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 533599 KiB |   6391 MiB | 441184 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522828 KiB |   6348 MiB | 439785 GiB | 439784 GiB |
|       from large pool | 436736 KiB |   6277 MiB | 439103 GiB | 439102 GiB |
|       from small pool |  86092 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6564 MiB |   6564 MiB |   6564 MiB |      0 B   |
|       from large pool |   6440 MiB |   6440 MiB |   6440 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    932 MiB |   1266 MiB | 238383 GiB | 238382 GiB |
|       from large pool |    928 MiB |   1263 MiB | 237669 GiB | 237668 GiB |
|       from small pool |      4 MiB |     10 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3630    |    8317    |   53656 K  |   53653 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31490 K  |   31487 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3630    |    8317    |   53656 K  |   53653 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31490 K  |   31487 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     133    |     133    |       0    |
|       from large pool |      71    |      71    |      71    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3612    |   25028 K  |   25028 K  |
|       from large pool |      19    |      36    |    8794 K  |    8794 K  |
|       from small pool |      51    |    3594    |   16234 K  |   16233 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441184 GiB | 441184 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441184 GiB | 441184 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439785 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439103 GiB | 439103 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238383 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     27 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53656 K  |   53656 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31490 K  |   31490 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53656 K  |   53656 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31490 K  |   31490 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441184 GiB | 441184 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441184 GiB | 441184 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439785 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439103 GiB | 439103 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238383 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     27 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53656 K  |   53656 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31490 K  |   31490 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53656 K  |   53656 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31490 K  |   31490 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122

 Experiment start at: 2024-08-05 04:05:02.858394
before training, model accuracy: 0.14582662284374237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9626319, 'precision': 0.9635895, 'recall': 0.9626486, 'specificity': 0.9626486, 'f1': 0.9626136, 'auroc': 0.99303806, 'binary_precision': 0.9848419, 'binary_recall': 0.93978286, 'binary_specificity': 0.9855143, 'binary_f1_score': 0.96178496}
confusion matrix:
       0      1
0  28370    417
1   1736  27093
---- Validation: 
scalar performance:
{'acc': 0.9488794, 'precision': 0.63121444, 'recall': 0.63158983, 'specificity': 0.63158983, 'f1': 0.63140184, 'auroc': 0.7924893, 'binary_precision': 0.2888889, 'binary_recall': 0.2897474, 'binary_specificity': 0.97343224, 'binary_f1_score': 0.28931752}
confusion matrix:
       0    1
0  17587  480
1    478  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.82872, 'recall': 0.75047153, 'specificity': 0.75047153, 'f1': 0.78372085, 'auroc': 0.8536359, 'binary_precision': 0.6785714, 'binary_recall': 0.51153845, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.5833333}
confusion matrix:
      0    1
0  5883   63
1   127  133
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 04:15:13.394684,epoch time: 0:10:10.536290,used: 0:10:10.536290,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9502569, 'precision': 0.9523873, 'recall': 0.95023316, 'specificity': 0.95023316, 'f1': 0.9501964, 'auroc': 0.99423385, 'binary_precision': 0.92151576, 'binary_recall': 0.9844249, 'binary_specificity': 0.91604143, 'binary_f1_score': 0.9519321}
confusion matrix:
       0      1
0  26371   2417
1    449  28379
---- Validation: 
scalar performance:
{'acc': 0.78068304, 'precision': 0.53688705, 'recall': 0.68598187, 'specificity': 0.68598187, 'f1': 0.51720184, 'auroc': 0.74466246, 'binary_precision': 0.093061805, 'binary_recall': 0.5839524, 'binary_specificity': 0.7880113, 'binary_f1_score': 0.16053921}
confusion matrix:
       0     1
0  14237  3830
1    280   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78923625, 'precision': 0.57205826, 'recall': 0.82932353, 'specificity': 0.82932353, 'f1': 0.5674224, 'auroc': 0.91775537, 'binary_precision': 0.15113182, 'binary_recall': 0.8730769, 'binary_specificity': 0.78557014, 'binary_f1_score': 0.25766173}
confusion matrix:
      0     1
0  4671  1275
1    33   227
early stop counter: 1
val acc:0.7806830406188965, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 2,now: 2024-08-05 04:25:13.372043,epoch time: 0:09:59.977359,used: 0:20:10.513649,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95693904, 'precision': 0.95828724, 'recall': 0.9569194, 'specificity': 0.9569194, 'f1': 0.956906, 'auroc': 0.9951915, 'binary_precision': 0.933612, 'binary_recall': 0.9839051, 'binary_specificity': 0.92993367, 'binary_f1_score': 0.958099}
confusion matrix:
       0      1
0  26770   2017
1    464  28365
---- Validation: 
scalar performance:
{'acc': 0.8434365, 'precision': 0.5386532, 'recall': 0.64342433, 'specificity': 0.64342433, 'f1': 0.5388661, 'auroc': 0.7203914, 'binary_precision': 0.10151569, 'binary_recall': 0.42793462, 'binary_specificity': 0.858914, 'binary_f1_score': 0.16410257}
confusion matrix:
       0     1
0  15518  2549
1    385   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8980019, 'precision': 0.6258358, 'recall': 0.8456267, 'specificity': 0.8456267, 'f1': 0.6687095, 'auroc': 0.9150754, 'binary_precision': 0.26181355, 'binary_recall': 0.78846157, 'binary_specificity': 0.9027918, 'binary_f1_score': 0.39309686}
confusion matrix:
      0    1
0  5368  578
1    55  205
early stop counter: 2
val acc:0.8434364795684814, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 3,now: 2024-08-05 04:35:11.072353,epoch time: 0:09:57.700310,used: 0:30:08.213959,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95494306, 'precision': 0.95626986, 'recall': 0.9549235, 'specificity': 0.9549235, 'f1': 0.95490885, 'auroc': 0.9940988, 'binary_precision': 0.9318474, 'binary_recall': 0.9817545, 'binary_specificity': 0.92809254, 'binary_f1_score': 0.9561501}
confusion matrix:
       0      1
0  26717   2070
1    526  28303
---- Validation: 
scalar performance:
{'acc': 0.74183565, 'precision': 0.5158627, 'recall': 0.58643997, 'specificity': 0.58643997, 'f1': 0.4767929, 'auroc': 0.5831355, 'binary_precision': 0.05963206, 'binary_recall': 0.4190193, 'binary_specificity': 0.75386065, 'binary_f1_score': 0.104405776}
confusion matrix:
       0     1
0  13620  4447
1    391   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66048986, 'precision': 0.5477968, 'recall': 0.7786864, 'specificity': 0.7786864, 'f1': 0.4843691, 'auroc': 0.91733134, 'binary_precision': 0.101768, 'binary_recall': 0.9076923, 'binary_specificity': 0.64968044, 'binary_f1_score': 0.18301667}
confusion matrix:
      0     1
0  3863  2083
1    24   236
early stop counter: 3
val acc:0.7418356537818909, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 4,now: 2024-08-05 04:45:09.052506,epoch time: 0:09:57.980153,used: 0:40:06.194112,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97386146, 'precision': 0.9738678, 'recall': 0.97386014, 'specificity': 0.97386014, 'f1': 0.9738613, 'auroc': 0.9951831, 'binary_precision': 0.97230864, 'binary_recall': 0.9755463, 'binary_specificity': 0.972174, 'binary_f1_score': 0.97392476}
confusion matrix:
       0      1
0  27985    801
1    705  28125
---- Validation: 
scalar performance:
{'acc': 0.8990395, 'precision': 0.56397825, 'recall': 0.65652555, 'specificity': 0.65652555, 'f1': 0.58275056, 'auroc': 0.59852296, 'binary_precision': 0.1519132, 'binary_recall': 0.39524516, 'binary_specificity': 0.91780597, 'binary_f1_score': 0.21947195}
confusion matrix:
       0     1
0  16582  1485
1    407   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91218174, 'precision': 0.63856846, 'recall': 0.8346367, 'specificity': 0.8346367, 'f1': 0.684813, 'auroc': 0.9040034, 'binary_precision': 0.2888889, 'binary_recall': 0.75, 'binary_specificity': 0.91927344, 'binary_f1_score': 0.4171123}
confusion matrix:
      0    1
0  5466  480
1    65  195
early stop counter: 4
val acc:0.8990395069122314, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 5,now: 2024-08-05 04:54:58.364903,epoch time: 0:09:49.312397,used: 0:49:55.506509,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9518016, 'precision': 0.95372146, 'recall': 0.9517791, 'specificity': 0.9517791, 'f1': 0.95174885, 'auroc': 0.99492717, 'binary_precision': 0.9243801, 'binary_recall': 0.98418206, 'binary_specificity': 0.91937613, 'binary_f1_score': 0.95334417}
confusion matrix:
       0      1
0  26467   2321
1    456  28372
---- Validation: 
scalar performance:
{'acc': 0.6338847, 'precision': 0.5054287, 'recall': 0.5361761, 'specificity': 0.5361761, 'f1': 0.42477173, 'auroc': 0.56696856, 'binary_precision': 0.0428487, 'binary_recall': 0.4309064, 'binary_specificity': 0.64144576, 'binary_f1_score': 0.07794651}
confusion matrix:
       0     1
0  11589  6478
1    383   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4788914, 'precision': 0.5323243, 'recall': 0.69862866, 'specificity': 0.69862866, 'f1': 0.3794802, 'auroc': 0.8892882, 'binary_precision': 0.07047949, 'binary_recall': 0.93846154, 'binary_specificity': 0.45879582, 'binary_f1_score': 0.13111229}
confusion matrix:
      0     1
0  2728  3218
1    16   244
early stop counter: 5
val acc:0.6338847279548645, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 6,now: 2024-08-05 05:04:49.997593,epoch time: 0:09:51.632690,used: 0:59:47.139199,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9694182, 'precision': 0.96942186, 'recall': 0.96941733, 'specificity': 0.96941733, 'f1': 0.9694181, 'auroc': 0.994494, 'binary_precision': 0.9682699, 'binary_recall': 0.9706882, 'binary_specificity': 0.96814644, 'binary_f1_score': 0.96947753}
confusion matrix:
       0      1
0  27871    917
1    845  27983
---- Validation: 
scalar performance:
{'acc': 0.87897545, 'precision': 0.5498695, 'recall': 0.6446893, 'specificity': 0.6446893, 'f1': 0.56172544, 'auroc': 0.5756942, 'binary_precision': 0.12435233, 'binary_recall': 0.3922734, 'binary_specificity': 0.8971052, 'binary_f1_score': 0.18884121}
confusion matrix:
       0     1
0  16208  1859
1    409   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9099259, 'precision': 0.63642186, 'recall': 0.83713746, 'specificity': 0.83713746, 'f1': 0.68232435, 'auroc': 0.8988557, 'binary_precision': 0.28427127, 'binary_recall': 0.75769234, 'binary_specificity': 0.9165826, 'binary_f1_score': 0.41343126}
confusion matrix:
      0    1
0  5450  496
1    63  197
early stop counter: 6
val acc:0.8789754509925842, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 7,now: 2024-08-05 05:14:42.507000,epoch time: 0:09:52.509407,used: 1:09:39.648606,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92942935, 'precision': 0.93461686, 'recall': 0.9293877, 'specificity': 0.9293877, 'f1': 0.9292134, 'auroc': 0.99320287, 'binary_precision': 0.8873248, 'binary_recall': 0.9839057, 'binary_specificity': 0.8748697, 'binary_f1_score': 0.93312275}
confusion matrix:
       0      1
0  25184   3602
1    464  28366
---- Validation: 
scalar performance:
{'acc': 0.6040021, 'precision': 0.5034212, 'recall': 0.52353925, 'specificity': 0.52353925, 'f1': 0.41080528, 'auroc': 0.5451007, 'binary_precision': 0.040076334, 'binary_recall': 0.43684992, 'binary_specificity': 0.6102286, 'binary_f1_score': 0.073417395}
confusion matrix:
       0     1
0  11025  7042
1    379   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4170158, 'precision': 0.53027076, 'recall': 0.677372, 'specificity': 0.677372, 'f1': 0.34259963, 'auroc': 0.8834375, 'binary_precision': 0.06480041, 'binary_recall': 0.96153843, 'binary_specificity': 0.39320552, 'binary_f1_score': 0.12141816}
confusion matrix:
      0     1
0  2338  3608
1    10   250
early stop counter: 7
val acc:0.6040021181106567, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 8,now: 2024-08-05 05:24:40.595935,epoch time: 0:09:58.088935,used: 1:19:37.737541,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95912594, 'precision': 0.9599961, 'recall': 0.9591094, 'specificity': 0.9591094, 'f1': 0.9591055, 'auroc': 0.99524415, 'binary_precision': 0.9401789, 'binary_recall': 0.98071456, 'binary_specificity': 0.93750435, 'binary_f1_score': 0.960019}
confusion matrix:
       0      1
0  26987   1799
1    556  28274
---- Validation: 
scalar performance:
{'acc': 0.8077908, 'precision': 0.52709025, 'recall': 0.6185002, 'specificity': 0.6185002, 'f1': 0.5130157, 'auroc': 0.58952767, 'binary_precision': 0.08001147, 'binary_recall': 0.41456166, 'binary_specificity': 0.8224387, 'binary_f1_score': 0.13413462}
confusion matrix:
       0     1
0  14859  3208
1    394   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7271995, 'precision': 0.5566431, 'recall': 0.79878783, 'specificity': 0.79878783, 'f1': 0.5236151, 'auroc': 0.89815843, 'binary_precision': 0.12069878, 'binary_recall': 0.8769231, 'binary_specificity': 0.7206525, 'binary_f1_score': 0.2121917}
confusion matrix:
      0     1
0  4285  1661
1    32   228
early stop counter: 8
val acc:0.8077908158302307, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 9,now: 2024-08-05 05:34:39.707737,epoch time: 0:09:59.111802,used: 1:29:36.849343,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.93109554, 'precision': 0.93683803, 'recall': 0.9310538, 'specificity': 0.9310538, 'f1': 0.93086374, 'auroc': 0.99462974, 'binary_precision': 0.8869346, 'binary_recall': 0.9882757, 'binary_specificity': 0.8738319, 'binary_f1_score': 0.9348668}
confusion matrix:
       0      1
0  25155   3632
1    338  28491
---- Validation: 
scalar performance:
{'acc': 0.6859125, 'precision': 0.5102391, 'recall': 0.5631589, 'specificity': 0.5631589, 'f1': 0.44995734, 'auroc': 0.58812416, 'binary_precision': 0.050060418, 'binary_recall': 0.4309064, 'binary_specificity': 0.6954115, 'binary_f1_score': 0.08969997}
confusion matrix:
       0     1
0  12564  5503
1    383   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4086368, 'precision': 0.5297916, 'recall': 0.67299926, 'specificity': 0.67299926, 'f1': 0.33731192, 'auroc': 0.90655196, 'binary_precision': 0.06393862, 'binary_recall': 0.96153843, 'binary_specificity': 0.38446015, 'binary_f1_score': 0.11990407}
confusion matrix:
      0     1
0  2286  3660
1    10   250
early stop counter: 9
val acc:0.6859124898910522, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 10,now: 2024-08-05 05:44:34.445526,epoch time: 0:09:54.737789,used: 1:39:31.587132,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92814493, 'precision': 0.93459255, 'recall': 0.92810065, 'specificity': 0.92810065, 'f1': 0.9278723, 'auroc': 0.9949093, 'binary_precision': 0.8818398, 'binary_recall': 0.98890007, 'binary_specificity': 0.8673012, 'binary_f1_score': 0.9323064}
confusion matrix:
       0      1
0  24967   3820
1    320  28509
---- Validation: 
scalar performance:
{'acc': 0.69098186, 'precision': 0.51087904, 'recall': 0.56650335, 'specificity': 0.56650335, 'f1': 0.45257944, 'auroc': 0.5905256, 'binary_precision': 0.05105263, 'binary_recall': 0.43239227, 'binary_specificity': 0.7006144, 'binary_f1_score': 0.091322765}
confusion matrix:
       0     1
0  12658  5409
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48436996, 'precision': 0.5333157, 'recall': 0.70516574, 'specificity': 0.70516574, 'f1': 0.3831443, 'auroc': 0.88736254, 'binary_precision': 0.07167832, 'binary_recall': 0.9461538, 'binary_specificity': 0.4641776, 'binary_f1_score': 0.1332611}
confusion matrix:
      0     1
0  2760  3186
1    14   246
early stop counter: 10
val acc:0.6909818649291992, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 11,now: 2024-08-05 05:54:23.610362,epoch time: 0:09:49.164836,used: 1:49:20.751968,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95456123, 'precision': 0.95587325, 'recall': 0.9545418, 'specificity': 0.9545418, 'f1': 0.95452714, 'auroc': 0.99413985, 'binary_precision': 0.9315989, 'binary_recall': 0.9812342, 'binary_specificity': 0.92784935, 'binary_f1_score': 0.9557725}
confusion matrix:
       0      1
0  26710   2077
1    541  28288
---- Validation: 
scalar performance:
{'acc': 0.8308431, 'precision': 0.5316198, 'recall': 0.62401825, 'specificity': 0.62401825, 'f1': 0.5258411, 'auroc': 0.6087911, 'binary_precision': 0.088903524, 'binary_recall': 0.4011887, 'binary_specificity': 0.84684783, 'binary_f1_score': 0.14555256}
confusion matrix:
       0     1
0  15300  2767
1    403   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8601354, 'precision': 0.59577405, 'recall': 0.8277044, 'specificity': 0.8277044, 'f1': 0.6219508, 'auroc': 0.9000472, 'binary_precision': 0.20196079, 'binary_recall': 0.7923077, 'binary_specificity': 0.86310124, 'binary_f1_score': 0.32187498}
confusion matrix:
      0    1
0  5132  814
1    54  206
early stop counter: 11
val acc:0.8308430910110474, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 12,now: 2024-08-05 06:04:11.118612,epoch time: 0:09:47.508250,used: 1:59:08.260218,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92522913, 'precision': 0.9325621, 'recall': 0.92518175, 'specificity': 0.92518175, 'f1': 0.9249052, 'auroc': 0.99517226, 'binary_precision': 0.87642384, 'binary_recall': 0.9901835, 'binary_specificity': 0.86017996, 'binary_f1_score': 0.9298371}
confusion matrix:
       0      1
0  24762   4025
1    283  28546
---- Validation: 
scalar performance:
{'acc': 0.6257204, 'precision': 0.5056988, 'recall': 0.53837925, 'specificity': 0.53837925, 'f1': 0.42186344, 'auroc': 0.588825, 'binary_precision': 0.04308978, 'binary_recall': 0.44427934, 'binary_specificity': 0.63247913, 'binary_f1_score': 0.078560166}
confusion matrix:
       0     1
0  11427  6640
1    374   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4658395, 'precision': 0.53389204, 'recall': 0.70652926, 'specificity': 0.70652926, 'f1': 0.37309632, 'auroc': 0.90457916, 'binary_precision': 0.07080641, 'binary_recall': 0.9692308, 'binary_specificity': 0.44382778, 'binary_f1_score': 0.13197172}
confusion matrix:
      0     1
0  2639  3307
1     8   252
early stop counter: 12
val acc:0.6257203817367554, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 13,now: 2024-08-05 06:14:10.102508,epoch time: 0:09:58.983896,used: 2:09:07.244114,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9415614, 'precision': 0.9449245, 'recall': 0.94152826, 'specificity': 0.94152826, 'f1': 0.9414476, 'auroc': 0.9945395, 'binary_precision': 0.90643257, 'binary_recall': 0.9848769, 'binary_specificity': 0.89817965, 'binary_f1_score': 0.9440279}
confusion matrix:
       0      1
0  25855   2931
1    436  28394
---- Validation: 
scalar performance:
{'acc': 0.70426893, 'precision': 0.51208466, 'recall': 0.5719638, 'specificity': 0.5719638, 'f1': 0.45886126, 'auroc': 0.5775436, 'binary_precision': 0.053056728, 'binary_recall': 0.4294205, 'binary_specificity': 0.7145071, 'binary_f1_score': 0.094444446}
confusion matrix:
       0     1
0  12909  5158
1    384   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47647437, 'precision': 0.5321562, 'recall': 0.6973673, 'specificity': 0.6973673, 'f1': 0.37803078, 'auroc': 0.89405286, 'binary_precision': 0.07017544, 'binary_recall': 0.93846154, 'binary_specificity': 0.45627314, 'binary_f1_score': 0.13058603}
confusion matrix:
      0     1
0  2713  3233
1    16   244
early stop counter: 13
val acc:0.7042689323425293, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 14,now: 2024-08-05 06:24:05.583965,epoch time: 0:09:55.481457,used: 2:19:02.725571,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9524611, 'precision': 0.9543972, 'recall': 0.9524374, 'specificity': 0.9524374, 'f1': 0.9524087, 'auroc': 0.99482614, 'binary_precision': 0.9249186, 'binary_recall': 0.9849457, 'binary_specificity': 0.91992915, 'binary_f1_score': 0.9539888}
confusion matrix:
       0      1
0  26482   2305
1    434  28395
---- Validation: 
scalar performance:
{'acc': 0.8423159, 'precision': 0.5362148, 'recall': 0.63425994, 'specificity': 0.63425994, 'f1': 0.53520936, 'auroc': 0.6119009, 'binary_precision': 0.09738885, 'binary_recall': 0.410104, 'binary_specificity': 0.8584159, 'binary_f1_score': 0.15739949}
confusion matrix:
       0     1
0  15509  2558
1    397   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8791492, 'precision': 0.6098846, 'recall': 0.8413051, 'specificity': 0.8413051, 'f1': 0.6450425, 'auroc': 0.9109925, 'binary_precision': 0.22958058, 'binary_recall': 0.8, 'binary_specificity': 0.88261014, 'binary_f1_score': 0.3567753}
confusion matrix:
      0    1
0  5248  698
1    52  208
early stop counter: 14
val acc:0.8423159122467041, best validation acc: 0.9488794207572937, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 15,now: 2024-08-05 06:34:08.295009,epoch time: 0:10:02.711044,used: 2:29:05.436615,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_02_seed_1_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:29:05.436615 at 2024-08-05 06:34:08.295009
persisted model performance metric: 

scalar performance:
{'acc': 0.9693845, 'precision': 0.82872, 'recall': 0.75047153, 'specificity': 0.75047153, 'f1': 0.78372085, 'auroc': 0.8536359, 'binary_precision': 0.6785714, 'binary_recall': 0.51153845, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.5833333}
confusion matrix:
      0    1
0  5883   63
1   127  133
oracle model performance metric: 

scalar performance:
{'acc': 0.9693845, 'precision': 0.82872, 'recall': 0.75047153, 'specificity': 0.75047153, 'f1': 0.78372085, 'auroc': 0.8536359, 'binary_precision': 0.6785714, 'binary_recall': 0.51153845, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.5833333}
confusion matrix:
      0    1
0  5883   63
1   127  133
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522826 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool | 436736 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |  86090 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  11654 MiB |   5110 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  11498 MiB |   5076 MiB |
|       from small pool |    122 MiB |    124 MiB |    156 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1059 MiB |   1463 MiB | 479146 GiB | 479145 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 477677 GiB | 477676 GiB |
|       from small pool |      4 MiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3606    |    8349    |  107891 K  |  107887 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63245 K  |   63241 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3606    |    8349    |  107891 K  |  107887 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63245 K  |   63241 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     195    |      65    |
|       from large pool |      69    |      71    |     117    |      48    |
|       from small pool |      61    |      62    |      78    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3630    |   50643 K  |   50642 K  |
|       from large pool |      21    |      36    |   17923 K  |   17922 K  |
|       from small pool |      52    |    3610    |   32720 K  |   32719 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1582 MiB |   6564 MiB |  11654 MiB |  10072 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     90 MiB |    124 MiB |    156 MiB |     66 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107891 K  |  107891 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63245 K  |   63245 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107891 K  |  107891 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63245 K  |   63245 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     133    |     195    |     126    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      45    |      62    |      78    |      33    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50644 K  |   50644 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32721 K  |   32721 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1582 MiB |   6564 MiB |  11654 MiB |  10072 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     90 MiB |    124 MiB |    156 MiB |     66 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107891 K  |  107891 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63245 K  |   63245 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107891 K  |  107891 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63245 K  |   63245 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     133    |     195    |     126    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      45    |      62    |      78    |      33    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50644 K  |   50644 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32721 K  |   32721 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122

 Experiment start at: 2024-08-05 06:40:25.709006
before training, model accuracy: 0.054656196385622025
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9701221, 'precision': 0.97012234, 'recall': 0.97012216, 'specificity': 0.97012216, 'f1': 0.9701221, 'auroc': 0.9944541, 'binary_precision': 0.9704812, 'binary_recall': 0.9697489, 'binary_specificity': 0.9704954, 'binary_f1_score': 0.97011495}
confusion matrix:
       0      1
0  28288    860
1    882  28274
---- Validation: 
scalar performance:
{'acc': 0.92281467, 'precision': 0.5994423, 'recall': 0.7336691, 'specificity': 0.7336691, 'f1': 0.63275015, 'auroc': 0.82700336, 'binary_precision': 0.21519838, 'binary_recall': 0.53156143, 'binary_specificity': 0.93577677, 'binary_f1_score': 0.30636668}
confusion matrix:
       0     1
0  17004  1167
1    282   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93957365, 'precision': 0.67421734, 'recall': 0.83374125, 'specificity': 0.83374125, 'f1': 0.72396153, 'auroc': 0.8912507, 'binary_precision': 0.36024845, 'binary_recall': 0.71900827, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.47999996}
confusion matrix:
      0    1
0  5688  309
1    68  174
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 06:50:47.459254,epoch time: 0:10:21.750248,used: 0:10:21.750248,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96799535, 'precision': 0.96816957, 'recall': 0.96799374, 'specificity': 0.96799374, 'f1': 0.9679923, 'auroc': 0.9952961, 'binary_precision': 0.9591816, 'binary_recall': 0.97760403, 'binary_specificity': 0.9583834, 'binary_f1_score': 0.9683052}
confusion matrix:
       0      1
0  27934   1213
1    653  28504
---- Validation: 
scalar performance:
{'acc': 0.8651254, 'precision': 0.54670703, 'recall': 0.6733531, 'specificity': 0.6733531, 'f1': 0.55433637, 'auroc': 0.73982406, 'binary_precision': 0.113071375, 'binary_recall': 0.46843854, 'binary_specificity': 0.8782676, 'binary_f1_score': 0.18217055}
confusion matrix:
       0     1
0  15959  2212
1    320   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8656836, 'precision': 0.5952084, 'recall': 0.8409084, 'specificity': 0.8409084, 'f1': 0.6226449, 'auroc': 0.91146326, 'binary_precision': 0.1989899, 'binary_recall': 0.8140496, 'binary_specificity': 0.8677672, 'binary_f1_score': 0.3198052}
confusion matrix:
      0    1
0  5204  793
1    45  197
early stop counter: 1
val acc:0.8651254177093506, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 2,now: 2024-08-05 07:00:57.964575,epoch time: 0:10:10.505321,used: 0:20:32.255569,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9586478, 'precision': 0.96002614, 'recall': 0.9586421, 'specificity': 0.9586421, 'f1': 0.9586164, 'auroc': 0.9958491, 'binary_precision': 0.9348964, 'binary_recall': 0.985973, 'binary_specificity': 0.9313113, 'binary_f1_score': 0.95975566}
confusion matrix:
       0      1
0  27144   2002
1    409  28749
---- Validation: 
scalar performance:
{'acc': 0.85511106, 'precision': 0.54578245, 'recall': 0.68263483, 'specificity': 0.68263483, 'f1': 0.55062556, 'auroc': 0.77238286, 'binary_precision': 0.11037528, 'binary_recall': 0.49833888, 'binary_specificity': 0.86693084, 'binary_f1_score': 0.18072289}
confusion matrix:
       0     1
0  15753  2418
1    302   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8610354, 'precision': 0.59624964, 'recall': 0.858318, 'specificity': 0.858318, 'f1': 0.62287676, 'auroc': 0.91577744, 'binary_precision': 0.19923003, 'binary_recall': 0.8553719, 'binary_specificity': 0.861264, 'binary_f1_score': 0.32318503}
confusion matrix:
      0    1
0  5165  832
1    35  207
early stop counter: 2
val acc:0.8551110625267029, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 3,now: 2024-08-05 07:11:10.449544,epoch time: 0:10:12.484969,used: 0:30:44.740538,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9676523, 'precision': 0.96791434, 'recall': 0.96765065, 'specificity': 0.96765065, 'f1': 0.9676477, 'auroc': 0.9949766, 'binary_precision': 0.95687574, 'binary_recall': 0.97945535, 'binary_specificity': 0.955846, 'binary_f1_score': 0.9680339}
confusion matrix:
       0      1
0  27861   1287
1    599  28557
---- Validation: 
scalar performance:
{'acc': 0.8695467, 'precision': 0.54116035, 'recall': 0.64431804, 'specificity': 0.64431804, 'f1': 0.54741496, 'auroc': 0.62192166, 'binary_precision': 0.10415774, 'binary_recall': 0.4036545, 'binary_specificity': 0.8849816, 'binary_f1_score': 0.16558774}
confusion matrix:
       0     1
0  16081  2090
1    359   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84805256, 'precision': 0.58670866, 'recall': 0.8396681, 'specificity': 0.8396681, 'f1': 0.6062936, 'auroc': 0.9101045, 'binary_precision': 0.18140794, 'binary_recall': 0.8305785, 'binary_specificity': 0.8487577, 'binary_f1_score': 0.29777777}
confusion matrix:
      0    1
0  5090  907
1    41  201
early stop counter: 3
val acc:0.8695467114448547, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 4,now: 2024-08-05 07:21:22.213302,epoch time: 0:10:11.763758,used: 0:40:56.504296,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95360523, 'precision': 0.9557843, 'recall': 0.95359814, 'specificity': 0.95359814, 'f1': 0.9535492, 'auroc': 0.9961014, 'binary_precision': 0.9243207, 'binary_recall': 0.9881336, 'binary_specificity': 0.9190627, 'binary_f1_score': 0.9551625}
confusion matrix:
       0      1
0  26787   2359
1    346  28812
---- Validation: 
scalar performance:
{'acc': 0.675811, 'precision': 0.5093897, 'recall': 0.5659233, 'specificity': 0.5659233, 'f1': 0.4423333, 'auroc': 0.59172255, 'binary_precision': 0.04482072, 'binary_recall': 0.44850498, 'binary_specificity': 0.68334156, 'binary_f1_score': 0.08149714}
confusion matrix:
       0     1
0  12417  5754
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46513864, 'precision': 0.5310352, 'recall': 0.7039329, 'specificity': 0.7039329, 'f1': 0.36893314, 'auroc': 0.9181994, 'binary_precision': 0.06543106, 'binary_recall': 0.9628099, 'binary_specificity': 0.44505587, 'binary_f1_score': 0.12253484}
confusion matrix:
      0     1
0  2669  3328
1     9   233
early stop counter: 4
val acc:0.6758109927177429, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 5,now: 2024-08-05 07:31:47.343215,epoch time: 0:10:25.129913,used: 0:51:21.634209,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9549945, 'precision': 0.95638084, 'recall': 0.95498884, 'specificity': 0.95498884, 'f1': 0.95495987, 'auroc': 0.99454224, 'binary_precision': 0.9312788, 'binary_recall': 0.9825091, 'binary_specificity': 0.9274686, 'binary_f1_score': 0.9562083}
confusion matrix:
       0      1
0  27032   2114
1    510  28648
---- Validation: 
scalar performance:
{'acc': 0.7549672, 'precision': 0.51598865, 'recall': 0.59396386, 'specificity': 0.59396386, 'f1': 0.4788214, 'auroc': 0.56343955, 'binary_precision': 0.056369286, 'binary_recall': 0.42192692, 'binary_specificity': 0.76600075, 'binary_f1_score': 0.09945185}
confusion matrix:
       0     1
0  13919  4252
1    348   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59304374, 'precision': 0.535282, 'recall': 0.7327941, 'specificity': 0.7327941, 'f1': 0.43864968, 'auroc': 0.8716769, 'binary_precision': 0.07853211, 'binary_recall': 0.88429755, 'binary_specificity': 0.58129066, 'binary_f1_score': 0.14425345}
confusion matrix:
      0     1
0  3486  2511
1    28   214
early stop counter: 5
val acc:0.754967212677002, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 6,now: 2024-08-05 07:42:00.016461,epoch time: 0:10:12.673246,used: 1:01:34.307455,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95070666, 'precision': 0.95231473, 'recall': 0.95070153, 'specificity': 0.95070153, 'f1': 0.9506624, 'auroc': 0.99342096, 'binary_precision': 0.9253876, 'binary_recall': 0.98048496, 'binary_specificity': 0.9209181, 'binary_f1_score': 0.9521399}
confusion matrix:
       0      1
0  26842   2305
1    569  28588
---- Validation: 
scalar performance:
{'acc': 0.8461088, 'precision': 0.53401846, 'recall': 0.6386352, 'specificity': 0.6386352, 'f1': 0.53172696, 'auroc': 0.563974, 'binary_precision': 0.08999641, 'binary_recall': 0.41694352, 'binary_specificity': 0.8603269, 'binary_f1_score': 0.14803892}
confusion matrix:
       0     1
0  15633  2538
1    351   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77768874, 'precision': 0.5612821, 'recall': 0.807032, 'specificity': 0.807032, 'f1': 0.548314, 'auroc': 0.88738036, 'binary_precision': 0.1308833, 'binary_recall': 0.838843, 'binary_specificity': 0.77522093, 'binary_f1_score': 0.22643614}
confusion matrix:
      0     1
0  4649  1348
1    39   203
early stop counter: 6
val acc:0.8461087942123413, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 7,now: 2024-08-05 07:52:00.394094,epoch time: 0:10:00.377633,used: 1:11:34.685088,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96339875, 'precision': 0.9642445, 'recall': 0.96339506, 'specificity': 0.96339506, 'f1': 0.96338177, 'auroc': 0.99605566, 'binary_precision': 0.94447184, 'binary_recall': 0.9847035, 'binary_specificity': 0.94208664, 'binary_f1_score': 0.96416813}
confusion matrix:
       0      1
0  27459   1688
1    446  28711
---- Validation: 
scalar performance:
{'acc': 0.8221382, 'precision': 0.5279316, 'recall': 0.628662, 'specificity': 0.628662, 'f1': 0.51648396, 'auroc': 0.5813515, 'binary_precision': 0.078274265, 'binary_recall': 0.42192692, 'binary_specificity': 0.83539706, 'binary_f1_score': 0.13205096}
confusion matrix:
       0     1
0  15180  2991
1    348   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7770476, 'precision': 0.5611102, 'recall': 0.80669844, 'specificity': 0.80669844, 'f1': 0.54785043, 'auroc': 0.8993015, 'binary_precision': 0.13054663, 'binary_recall': 0.838843, 'binary_specificity': 0.77455395, 'binary_f1_score': 0.22593212}
confusion matrix:
      0     1
0  4645  1352
1    39   203
early stop counter: 7
val acc:0.8221381902694702, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 8,now: 2024-08-05 08:02:14.211701,epoch time: 0:10:13.817607,used: 1:21:48.502695,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96370745, 'precision': 0.964115, 'recall': 0.9637054, 'specificity': 0.9637054, 'f1': 0.96369946, 'auroc': 0.9944943, 'binary_precision': 0.9503964, 'binary_recall': 0.978495, 'binary_specificity': 0.9489159, 'binary_f1_score': 0.9642411}
confusion matrix:
       0      1
0  27659   1489
1    627  28529
---- Validation: 
scalar performance:
{'acc': 0.81281626, 'precision': 0.5262673, 'recall': 0.62625575, 'specificity': 0.62625575, 'f1': 0.5113838, 'auroc': 0.5675515, 'binary_precision': 0.07501459, 'binary_recall': 0.4269103, 'binary_specificity': 0.8256012, 'binary_f1_score': 0.12760676}
confusion matrix:
       0     1
0  15002  3169
1    345   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75236416, 'precision': 0.5580536, 'recall': 0.8117034, 'specificity': 0.8117034, 'f1': 0.53416044, 'auroc': 0.91678625, 'binary_precision': 0.12275623, 'binary_recall': 0.87603307, 'binary_specificity': 0.7473737, 'binary_f1_score': 0.21533774}
confusion matrix:
      0     1
0  4482  1515
1    30   212
early stop counter: 8
val acc:0.8128162622451782, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 9,now: 2024-08-05 08:12:32.197243,epoch time: 0:10:17.985542,used: 1:32:06.488237,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9574986, 'precision': 0.95860565, 'recall': 0.9574944, 'specificity': 0.9574944, 'f1': 0.9574727, 'auroc': 0.9949151, 'binary_precision': 0.93611664, 'binary_recall': 0.9820283, 'binary_specificity': 0.9329605, 'binary_f1_score': 0.95852304}
confusion matrix:
       0      1
0  27193   1954
1    524  28633
---- Validation: 
scalar performance:
{'acc': 0.83646727, 'precision': 0.5311504, 'recall': 0.6336548, 'specificity': 0.6336548, 'f1': 0.5250872, 'auroc': 0.5840521, 'binary_precision': 0.08451179, 'binary_recall': 0.41694352, 'binary_specificity': 0.850366, 'binary_f1_score': 0.14053752}
confusion matrix:
       0     1
0  15452  2719
1    351   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7690335, 'precision': 0.5593704, 'recall': 0.80451244, 'specificity': 0.80451244, 'f1': 0.54254365, 'auroc': 0.9015734, 'binary_precision': 0.12694462, 'binary_recall': 0.8429752, 'binary_specificity': 0.7660497, 'binary_f1_score': 0.2206598}
confusion matrix:
      0     1
0  4594  1403
1    38   204
early stop counter: 9
val acc:0.8364672660827637, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 10,now: 2024-08-05 08:22:53.343209,epoch time: 0:10:21.145966,used: 1:42:27.634203,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95466864, 'precision': 0.9565547, 'recall': 0.9546621, 'specificity': 0.9546621, 'f1': 0.9546213, 'auroc': 0.99581826, 'binary_precision': 0.9272616, 'binary_recall': 0.9867618, 'binary_specificity': 0.9225623, 'binary_f1_score': 0.9560869}
confusion matrix:
       0      1
0  26889   2257
1    386  28772
---- Validation: 
scalar performance:
{'acc': 0.75880253, 'precision': 0.51690626, 'recall': 0.59835416, 'specificity': 0.59835416, 'f1': 0.48131886, 'auroc': 0.56474316, 'binary_precision': 0.057882883, 'binary_recall': 0.4269103, 'binary_specificity': 0.76979804, 'binary_f1_score': 0.10194367}
confusion matrix:
       0     1
0  13988  4183
1    345   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61580384, 'precision': 0.541732, 'recall': 0.7723917, 'specificity': 0.7723917, 'f1': 0.4553964, 'auroc': 0.9133947, 'binary_precision': 0.08732287, 'binary_recall': 0.94214875, 'binary_specificity': 0.60263467, 'binary_f1_score': 0.15983175}
confusion matrix:
      0     1
0  3614  2383
1    14   228
early stop counter: 10
val acc:0.7588025331497192, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 11,now: 2024-08-05 08:32:59.161651,epoch time: 0:10:05.818442,used: 1:52:33.452645,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9446693, 'precision': 0.94756836, 'recall': 0.94466245, 'specificity': 0.94466245, 'f1': 0.944579, 'auroc': 0.99474657, 'binary_precision': 0.9115901, 'binary_recall': 0.98487496, 'binary_specificity': 0.9044499, 'binary_f1_score': 0.94681656}
confusion matrix:
       0      1
0  26362   2785
1    441  28716
---- Validation: 
scalar performance:
{'acc': 0.67623717, 'precision': 0.508524, 'recall': 0.559719, 'specificity': 0.559719, 'f1': 0.44147524, 'auroc': 0.57645893, 'binary_precision': 0.04366667, 'binary_recall': 0.43521595, 'binary_specificity': 0.6842221, 'binary_f1_score': 0.079369895}
confusion matrix:
       0     1
0  12433  5738
1    340   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5470428, 'precision': 0.53413296, 'recall': 0.7286929, 'specificity': 0.7286929, 'f1': 0.41489765, 'auroc': 0.8727561, 'binary_precision': 0.07387863, 'binary_recall': 0.92561984, 'binary_specificity': 0.5317659, 'binary_f1_score': 0.13683568}
confusion matrix:
      0     1
0  3189  2808
1    18   224
early stop counter: 11
val acc:0.676237165927887, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 12,now: 2024-08-05 08:43:09.861238,epoch time: 0:10:10.699587,used: 2:02:44.152232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9111382, 'precision': 0.9222479, 'recall': 0.9111271, 'specificity': 0.9111271, 'f1': 0.9105482, 'auroc': 0.9952378, 'binary_precision': 0.853791, 'binary_recall': 0.9922143, 'binary_specificity': 0.8300398, 'binary_f1_score': 0.91781276}
confusion matrix:
       0      1
0  24194   4954
1    227  28929
---- Validation: 
scalar performance:
{'acc': 0.46955734, 'precision': 0.49534142, 'recall': 0.46259207, 'specificity': 0.46259207, 'f1': 0.34194574, 'auroc': 0.5622475, 'binary_precision': 0.027665589, 'binary_recall': 0.4551495, 'binary_specificity': 0.47003466, 'binary_f1_score': 0.052160673}
confusion matrix:
      0     1
0  8541  9630
1   328   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.23641609, 'precision': 0.52367586, 'recall': 0.6008187, 'specificity': 0.6008187, 'f1': 0.21657029, 'auroc': 0.86593765, 'binary_precision': 0.04816147, 'binary_recall': 0.9958678, 'binary_specificity': 0.20576955, 'binary_f1_score': 0.09187953}
confusion matrix:
      0     1
0  1234  4763
1     1   241
early stop counter: 12
val acc:0.46955734491348267, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 13,now: 2024-08-05 08:53:20.085168,epoch time: 0:10:10.223930,used: 2:12:54.376162,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9470534, 'precision': 0.9505774, 'recall': 0.94704276, 'specificity': 0.94704276, 'f1': 0.94694877, 'auroc': 0.9970193, 'binary_precision': 0.91078967, 'binary_recall': 0.99122053, 'binary_specificity': 0.902865, 'binary_f1_score': 0.94930446}
confusion matrix:
       0      1
0  26314   2831
1    256  28903
---- Validation: 
scalar performance:
{'acc': 0.7170937, 'precision': 0.51272005, 'recall': 0.5824302, 'specificity': 0.5824302, 'f1': 0.46146202, 'auroc': 0.62556016, 'binary_precision': 0.05041054, 'binary_recall': 0.4385382, 'binary_specificity': 0.7263222, 'binary_f1_score': 0.090426445}
confusion matrix:
       0     1
0  13198  4973
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5722071, 'precision': 0.53657496, 'recall': 0.7437655, 'specificity': 0.7437655, 'f1': 0.42954844, 'auroc': 0.88922507, 'binary_precision': 0.078206465, 'binary_recall': 0.92975205, 'binary_specificity': 0.5577789, 'binary_f1_score': 0.144277}
confusion matrix:
      0     1
0  3345  2652
1    17   225
early stop counter: 13
val acc:0.7170937061309814, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 14,now: 2024-08-05 09:03:29.342590,epoch time: 0:10:09.257422,used: 2:23:03.633584,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9554061, 'precision': 0.9573618, 'recall': 0.9554005, 'specificity': 0.9554005, 'f1': 0.955358, 'auroc': 0.9963747, 'binary_precision': 0.9274975, 'binary_recall': 0.9880646, 'binary_specificity': 0.92273647, 'binary_f1_score': 0.95682347}
confusion matrix:
       0      1
0  26895   2252
1    348  28809
---- Validation: 
scalar performance:
{'acc': 0.7592287, 'precision': 0.5172309, 'recall': 0.6001804, 'specificity': 0.6001804, 'f1': 0.48188794, 'auroc': 0.6023346, 'binary_precision': 0.058385935, 'binary_recall': 0.43023255, 'binary_specificity': 0.77012825, 'binary_f1_score': 0.10281858}
confusion matrix:
       0     1
0  13994  4177
1    343   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46946627, 'precision': 0.5316084, 'recall': 0.7081667, 'specificity': 0.7081667, 'f1': 0.37170768, 'auroc': 0.8892051, 'binary_precision': 0.066176474, 'binary_recall': 0.96694213, 'binary_specificity': 0.44939137, 'binary_f1_score': 0.12387507}
confusion matrix:
      0     1
0  2695  3302
1     8   234
early stop counter: 14
val acc:0.7592287063598633, best validation acc: 0.922814667224884, corresponding to test acc:                         0.9395736455917358 / 0.9395736455917358
after epoch: 15,now: 2024-08-05 09:13:39.909722,epoch time: 0:10:10.567132,used: 2:33:14.200716,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067122
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:14.200716 at 2024-08-05 09:13:39.909722
persisted model performance metric: 

scalar performance:
{'acc': 0.93957365, 'precision': 0.67421734, 'recall': 0.83374125, 'specificity': 0.83374125, 'f1': 0.72396153, 'auroc': 0.8912507, 'binary_precision': 0.36024845, 'binary_recall': 0.71900827, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.47999996}
confusion matrix:
      0    1
0  5688  309
1    68  174
oracle model performance metric: 

scalar performance:
{'acc': 0.93957365, 'precision': 0.67421734, 'recall': 0.83374125, 'specificity': 0.83374125, 'f1': 0.72396153, 'auroc': 0.8912507, 'binary_precision': 0.36024845, 'binary_recall': 0.71900827, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.47999996}
confusion matrix:
      0    1
0  5688  309
1    68  174
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522827 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool | 436736 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |  86091 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  16616 MiB |  10072 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  16428 MiB |  10006 MiB |
|       from small pool |    122 MiB |    124 MiB |    188 MiB |     66 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1059 MiB |   1463 MiB | 730727 GiB | 730726 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 728433 GiB | 728432 GiB |
|       from small pool |      4 MiB |     27 MiB |   2293 GiB |   2293 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3618    |    8435    |  163864 K  |  163860 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95830 K  |   95827 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3618    |    8435    |  163864 K  |  163860 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95830 K  |   95827 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     256    |     126    |
|       from large pool |      69    |      71    |     162    |      93    |
|       from small pool |      61    |      62    |      94    |      33    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3675    |   77051 K  |   77051 K  |
|       from large pool |      21    |      36    |   27378 K  |   27378 K  |
|       from small pool |      54    |    3655    |   49672 K  |   49672 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool |  65536 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |      0 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1582 MiB |   6564 MiB |  16616 MiB |  15034 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  16428 MiB |  14936 MiB |
|       from small pool |     90 MiB |    124 MiB |    188 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 730727 GiB | 730727 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 728433 GiB | 728433 GiB |
|       from small pool |      0 KiB |     27 MiB |   2293 GiB |   2293 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8435    |  163864 K  |  163864 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95830 K  |   95830 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8435    |  163864 K  |  163864 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95830 K  |   95830 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     133    |     256    |     187    |
|       from large pool |      24    |      71    |     162    |     138    |
|       from small pool |      45    |      62    |      94    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3675    |   77052 K  |   77052 K  |
|       from large pool |       3    |      36    |   27378 K  |   27378 K  |
|       from small pool |       0    |    3655    |   49673 K  |   49673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 09:14:24 2024]
Finished job 0.
1 of 1 steps (100%) done
