Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 04:15:12 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361

 Experiment start at: 2024-07-31 04:22:32.548078
before training, model accuracy: 0.31048259139060974
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96546376, 'precision': 0.9662361, 'recall': 0.96548164, 'specificity': 0.96548164, 'f1': 0.96545035, 'auroc': 0.99387455, 'binary_precision': 0.98543197, 'binary_recall': 0.9449573, 'binary_specificity': 0.98600596, 'binary_f1_score': 0.9647703}
confusion matrix:
       0      1
0  28254    401
1   1580  27125
---- Validation: 
scalar performance:
{'acc': 0.95359725, 'precision': 0.65044725, 'recall': 0.6527028, 'specificity': 0.6527028, 'f1': 0.65156525, 'auroc': 0.8189497, 'binary_precision': 0.32465544, 'binary_recall': 0.32970452, 'binary_specificity': 0.97570115, 'binary_f1_score': 0.3271605}
confusion matrix:
       0    1
0  17708  441
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.81504184, 'recall': 0.8104205, 'specificity': 0.8104205, 'f1': 0.81271195, 'auroc': 0.8836826, 'binary_precision': 0.6459144, 'binary_recall': 0.6360153, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.6409266}
confusion matrix:
      0    1
0  5906   91
1    95  166
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 04:33:02.785528,epoch time: 0:10:30.237450,used: 0:10:30.237450,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9401325, 'precision': 0.94484127, 'recall': 0.94009674, 'specificity': 0.94009674, 'f1': 0.93997025, 'auroc': 0.99558866, 'binary_precision': 0.8992478, 'binary_recall': 0.99142855, 'binary_specificity': 0.88876486, 'binary_f1_score': 0.94309103}
confusion matrix:
       0      1
0  25472   3188
1    246  28454
---- Validation: 
scalar performance:
{'acc': 0.7785228, 'precision': 0.53816736, 'recall': 0.7045747, 'specificity': 0.7045747, 'f1': 0.51715136, 'auroc': 0.7522931, 'binary_precision': 0.09299098, 'binary_recall': 0.62519443, 'binary_specificity': 0.78395504, 'binary_f1_score': 0.16190092}
confusion matrix:
       0     1
0  14228  3921
1    241   402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6572387, 'precision': 0.54836047, 'recall': 0.78451395, 'specificity': 0.78451395, 'f1': 0.48328575, 'auroc': 0.9206928, 'binary_precision': 0.10185968, 'binary_recall': 0.9233717, 'binary_specificity': 0.64565617, 'binary_f1_score': 0.18347925}
confusion matrix:
      0     1
0  3872  2125
1    20   241
early stop counter: 1
val acc:0.778522789478302, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 2,now: 2024-07-31 04:43:06.016042,epoch time: 0:10:03.230514,used: 0:20:33.467964,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9758543, 'precision': 0.9759307, 'recall': 0.97584844, 'specificity': 0.97584844, 'f1': 0.9758531, 'auroc': 0.99687964, 'binary_precision': 0.9701287, 'binary_recall': 0.98199046, 'binary_specificity': 0.9697065, 'binary_f1_score': 0.9760236}
confusion matrix:
       0      1
0  27785    868
1    517  28190
---- Validation: 
scalar performance:
{'acc': 0.92331845, 'precision': 0.59095955, 'recall': 0.6827804, 'specificity': 0.6827804, 'f1': 0.6171526, 'auroc': 0.7918842, 'binary_precision': 0.203125, 'binary_recall': 0.42457232, 'binary_specificity': 0.9409885, 'binary_f1_score': 0.27478608}
confusion matrix:
       0     1
0  17078  1071
1    370   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90667945, 'precision': 0.63669527, 'recall': 0.85785997, 'specificity': 0.85785997, 'f1': 0.6837985, 'auroc': 0.9236016, 'binary_precision': 0.28263795, 'binary_recall': 0.8045977, 'binary_specificity': 0.9111222, 'binary_f1_score': 0.41832668}
confusion matrix:
      0    1
0  5464  533
1    51  210
early stop counter: 2
val acc:0.9233184456825256, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 3,now: 2024-07-31 04:53:07.746747,epoch time: 0:10:01.730705,used: 0:30:35.198669,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9753138, 'precision': 0.97547233, 'recall': 0.97530603, 'specificity': 0.97530603, 'f1': 0.97531146, 'auroc': 0.9973211, 'binary_precision': 0.9670055, 'binary_recall': 0.9842536, 'binary_specificity': 0.9663584, 'binary_f1_score': 0.97555333}
confusion matrix:
       0      1
0  27691    964
1    452  28253
---- Validation: 
scalar performance:
{'acc': 0.905066, 'precision': 0.564716, 'recall': 0.6560796, 'specificity': 0.6560796, 'f1': 0.5841879, 'auroc': 0.7428674, 'binary_precision': 0.15234613, 'binary_recall': 0.3888025, 'binary_specificity': 0.92335665, 'binary_f1_score': 0.21891418}
confusion matrix:
       0     1
0  16758  1391
1    393   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83573025, 'precision': 0.5888697, 'recall': 0.84832644, 'specificity': 0.84832644, 'f1': 0.60566634, 'auroc': 0.923265, 'binary_precision': 0.18488085, 'binary_recall': 0.86206895, 'binary_specificity': 0.83458394, 'binary_f1_score': 0.30446547}
confusion matrix:
      0    1
0  5005  992
1    36  225
early stop counter: 3
val acc:0.9050660133361816, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 4,now: 2024-07-31 05:03:10.910445,epoch time: 0:10:03.163698,used: 0:40:38.362367,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94857043, 'precision': 0.9511378, 'recall': 0.9485364, 'specificity': 0.9485364, 'f1': 0.94849443, 'auroc': 0.99575055, 'binary_precision': 0.917331, 'binary_recall': 0.9861005, 'binary_specificity': 0.9109723, 'binary_f1_score': 0.9504735}
confusion matrix:
       0      1
0  26103   2551
1    399  28307
---- Validation: 
scalar performance:
{'acc': 0.7936888, 'precision': 0.5237876, 'recall': 0.61566925, 'specificity': 0.61566925, 'f1': 0.5032656, 'auroc': 0.6559368, 'binary_precision': 0.072222225, 'binary_recall': 0.42457232, 'binary_specificity': 0.8067662, 'binary_f1_score': 0.12344563}
confusion matrix:
       0     1
0  14642  3507
1    370   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63950145, 'precision': 0.5480537, 'recall': 0.7880856, 'specificity': 0.7880856, 'f1': 0.47458982, 'auroc': 0.9272218, 'binary_precision': 0.09955841, 'binary_recall': 0.95019156, 'binary_specificity': 0.62597966, 'binary_f1_score': 0.18023255}
confusion matrix:
      0     1
0  3754  2243
1    13   248
early stop counter: 4
val acc:0.7936887741088867, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 5,now: 2024-07-31 05:13:14.495193,epoch time: 0:10:03.584748,used: 0:50:41.947115,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9533996, 'precision': 0.9555208, 'recall': 0.9533676, 'specificity': 0.9533676, 'f1': 0.9533429, 'auroc': 0.99577844, 'binary_precision': 0.9246705, 'binary_recall': 0.9873202, 'binary_specificity': 0.91941506, 'binary_f1_score': 0.954969}
confusion matrix:
       0      1
0  26344   2309
1    364  28343
---- Validation: 
scalar performance:
{'acc': 0.821573, 'precision': 0.5289019, 'recall': 0.6248549, 'specificity': 0.6248549, 'f1': 0.5187192, 'auroc': 0.6350608, 'binary_precision': 0.08204812, 'binary_recall': 0.41368586, 'binary_specificity': 0.83602405, 'binary_f1_score': 0.13693693}
confusion matrix:
       0     1
0  15173  2976
1    377   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6358262, 'precision': 0.545539, 'recall': 0.77334166, 'specificity': 0.77334166, 'f1': 0.47047532, 'auroc': 0.919201, 'binary_precision': 0.0964, 'binary_recall': 0.9233717, 'binary_specificity': 0.62331164, 'binary_f1_score': 0.17457443}
confusion matrix:
      0     1
0  3738  2259
1    20   241
early stop counter: 5
val acc:0.82157301902771, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 6,now: 2024-07-31 05:23:21.142071,epoch time: 0:10:06.646878,used: 1:00:48.593993,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.940795, 'precision': 0.9443644, 'recall': 0.94075763, 'specificity': 0.94075763, 'f1': 0.94067234, 'auroc': 0.9947072, 'binary_precision': 0.90474665, 'binary_recall': 0.9854376, 'binary_specificity': 0.89607763, 'binary_f1_score': 0.9433698}
confusion matrix:
       0      1
0  25678   2978
1    418  28286
---- Validation: 
scalar performance:
{'acc': 0.6126543, 'precision': 0.5035943, 'recall': 0.5256954, 'specificity': 0.5256954, 'f1': 0.41314158, 'auroc': 0.5667747, 'binary_precision': 0.03865406, 'binary_recall': 0.43234837, 'binary_specificity': 0.6190424, 'binary_f1_score': 0.07096362}
confusion matrix:
       0     1
0  11235  6914
1    365   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.44950464, 'precision': 0.53396726, 'recall': 0.70544374, 'specificity': 0.70544374, 'f1': 0.3636182, 'auroc': 0.87813795, 'binary_precision': 0.06949703, 'binary_recall': 0.98467433, 'binary_specificity': 0.42621312, 'binary_f1_score': 0.12983076}
confusion matrix:
      0     1
0  2556  3441
1     4   257
early stop counter: 6
val acc:0.6126543283462524, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 7,now: 2024-07-31 05:33:26.583976,epoch time: 0:10:05.441905,used: 1:10:54.035898,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9331416, 'precision': 0.9378716, 'recall': 0.9331, 'specificity': 0.9331, 'f1': 0.9329561, 'auroc': 0.993788, 'binary_precision': 0.89256173, 'binary_recall': 0.9849493, 'binary_specificity': 0.8812507, 'binary_f1_score': 0.9364824}
confusion matrix:
       0      1
0  25254   3403
1    432  28271
---- Validation: 
scalar performance:
{'acc': 0.61281395, 'precision': 0.50391996, 'recall': 0.5280282, 'specificity': 0.5280282, 'f1': 0.4135488, 'auroc': 0.5572492, 'binary_precision': 0.0390549, 'binary_recall': 0.43701398, 'binary_specificity': 0.6190424, 'binary_f1_score': 0.071701966}
confusion matrix:
       0     1
0  11235  6914
1    362   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3942154, 'precision': 0.5308721, 'recall': 0.6765959, 'specificity': 0.6765959, 'f1': 0.32884917, 'auroc': 0.8634539, 'binary_precision': 0.06355094, 'binary_recall': 0.98467433, 'binary_specificity': 0.36851758, 'binary_f1_score': 0.11939605}
confusion matrix:
      0     1
0  2210  3787
1     4   257
early stop counter: 7
val acc:0.6128139495849609, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 8,now: 2024-07-31 05:46:30.141086,epoch time: 0:13:03.557110,used: 1:23:57.593008,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95906556, 'precision': 0.96056306, 'recall': 0.9590409, 'specificity': 0.9590409, 'f1': 0.9590307, 'auroc': 0.9964999, 'binary_precision': 0.9345181, 'binary_recall': 0.98738897, 'binary_specificity': 0.93069273, 'binary_f1_score': 0.96022636}
confusion matrix:
       0      1
0  26669   1986
1    362  28343
---- Validation: 
scalar performance:
{'acc': 0.83312047, 'precision': 0.533007, 'recall': 0.63533354, 'specificity': 0.63533354, 'f1': 0.52766484, 'auroc': 0.6507699, 'binary_precision': 0.089562066, 'binary_recall': 0.4230171, 'binary_specificity': 0.84765, 'binary_f1_score': 0.14782609}
confusion matrix:
       0     1
0  15384  2765
1    371   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5361138, 'precision': 0.53831166, 'recall': 0.739639, 'specificity': 0.739639, 'f1': 0.41440222, 'auroc': 0.90829194, 'binary_precision': 0.0798346, 'binary_recall': 0.96168584, 'binary_specificity': 0.51759213, 'binary_f1_score': 0.14743024}
confusion matrix:
      0     1
0  3104  2893
1    10   251
early stop counter: 8
val acc:0.8331204652786255, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 9,now: 2024-07-31 05:56:33.250716,epoch time: 0:10:03.109630,used: 1:34:00.702638,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90998954, 'precision': 0.919621, 'recall': 0.9099368, 'specificity': 0.9099368, 'f1': 0.90946233, 'auroc': 0.9904375, 'binary_precision': 0.8562218, 'binary_recall': 0.98560977, 'binary_specificity': 0.8342638, 'binary_f1_score': 0.91637105}
confusion matrix:
       0      1
0  23910   4750
1    413  28287
---- Validation: 
scalar performance:
{'acc': 0.5297467, 'precision': 0.49691436, 'recall': 0.47677246, 'specificity': 0.47677246, 'f1': 0.37214833, 'auroc': 0.509732, 'binary_precision': 0.030913671, 'binary_recall': 0.41990668, 'binary_specificity': 0.53363824, 'binary_f1_score': 0.057587713}
confusion matrix:
      0     1
0  9685  8464
1   373   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.26637903, 'precision': 0.5255576, 'recall': 0.61172825, 'specificity': 0.61172825, 'f1': 0.240693, 'auroc': 0.8061213, 'binary_precision': 0.053239785, 'binary_recall': 0.9885057, 'binary_specificity': 0.23495081, 'binary_f1_score': 0.101037785}
confusion matrix:
      0     1
0  1409  4588
1     3   258
early stop counter: 9
val acc:0.5297467112541199, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 10,now: 2024-07-31 06:06:34.317760,epoch time: 0:10:01.067044,used: 1:44:01.769682,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94532776, 'precision': 0.9479443, 'recall': 0.9453038, 'specificity': 0.9453038, 'f1': 0.94524574, 'auroc': 0.99427783, 'binary_precision': 0.9138657, 'binary_recall': 0.98341346, 'binary_specificity': 0.9071942, 'binary_f1_score': 0.94736487}
confusion matrix:
       0      1
0  26002   2660
1    476  28222
---- Validation: 
scalar performance:
{'acc': 0.79533845, 'precision': 0.5251277, 'recall': 0.6217737, 'specificity': 0.6217737, 'f1': 0.5055896, 'auroc': 0.6227912, 'binary_precision': 0.07440872, 'binary_recall': 0.43545878, 'binary_specificity': 0.8080886, 'binary_f1_score': 0.12709942}
confusion matrix:
       0     1
0  14666  3483
1    363   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63438797, 'precision': 0.5465306, 'recall': 0.7799206, 'specificity': 0.7799206, 'f1': 0.47071502, 'auroc': 0.89669037, 'binary_precision': 0.0973381, 'binary_recall': 0.93869734, 'binary_specificity': 0.6211439, 'binary_f1_score': 0.1763859}
confusion matrix:
      0     1
0  3725  2272
1    16   245
early stop counter: 10
val acc:0.7953384518623352, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 11,now: 2024-07-31 06:16:38.461090,epoch time: 0:10:04.143330,used: 1:54:05.913012,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9677127, 'precision': 0.96843445, 'recall': 0.96769845, 'specificity': 0.96769845, 'f1': 0.9676995, 'auroc': 0.9969317, 'binary_precision': 0.95022976, 'binary_recall': 0.98717815, 'binary_specificity': 0.9482187, 'binary_f1_score': 0.9683516}
confusion matrix:
       0      1
0  27175   1484
1    368  28333
---- Validation: 
scalar performance:
{'acc': 0.844934, 'precision': 0.53670216, 'recall': 0.64144963, 'specificity': 0.64144963, 'f1': 0.5359635, 'auroc': 0.6267029, 'binary_precision': 0.096625224, 'binary_recall': 0.4230171, 'binary_specificity': 0.8598821, 'binary_f1_score': 0.15731637}
confusion matrix:
       0     1
0  15606  2543
1    371   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.682007, 'precision': 0.5514305, 'recall': 0.79377234, 'specificity': 0.79377234, 'f1': 0.49781483, 'auroc': 0.8996505, 'binary_precision': 0.1082918, 'binary_recall': 0.91570884, 'binary_specificity': 0.6718359, 'binary_f1_score': 0.1936791}
confusion matrix:
      0     1
0  4029  1968
1    22   239
early stop counter: 11
val acc:0.8449339866638184, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 12,now: 2024-07-31 06:28:36.511392,epoch time: 0:11:58.050302,used: 2:06:03.963314,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9181485, 'precision': 0.9267999, 'recall': 0.9180989, 'specificity': 0.9180989, 'f1': 0.9177251, 'auroc': 0.9946238, 'binary_precision': 0.86620903, 'binary_recall': 0.9891986, 'binary_specificity': 0.8469993, 'binary_f1_score': 0.9236275}
confusion matrix:
       0      1
0  24275   4385
1    310  28390
---- Validation: 
scalar performance:
{'acc': 0.60818434, 'precision': 0.5038808, 'recall': 0.5278815, 'specificity': 0.5278815, 'f1': 0.41165614, 'auroc': 0.5581012, 'binary_precision': 0.03896817, 'binary_recall': 0.44167963, 'binary_specificity': 0.6140834, 'binary_f1_score': 0.07161771}
confusion matrix:
       0     1
0  11145  7004
1    359   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.33157557, 'precision': 0.52675354, 'recall': 0.63841593, 'specificity': 0.63841593, 'f1': 0.2868619, 'auroc': 0.8154954, 'binary_precision': 0.05733634, 'binary_recall': 0.97318006, 'binary_specificity': 0.30365184, 'binary_f1_score': 0.10829247}
confusion matrix:
      0     1
0  1821  4176
1     7   254
early stop counter: 12
val acc:0.6081843376159668, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 13,now: 2024-07-31 06:38:42.992963,epoch time: 0:10:06.481571,used: 2:16:10.444885,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9566074, 'precision': 0.95844924, 'recall': 0.956581, 'specificity': 0.956581, 'f1': 0.9565619, 'auroc': 0.9966748, 'binary_precision': 0.92959917, 'binary_recall': 0.98812014, 'binary_specificity': 0.92504185, 'binary_f1_score': 0.95796674}
confusion matrix:
       0      1
0  26508   2148
1    341  28363
---- Validation: 
scalar performance:
{'acc': 0.7468604, 'precision': 0.5165854, 'recall': 0.5936757, 'specificity': 0.5936757, 'f1': 0.4782924, 'auroc': 0.6047292, 'binary_precision': 0.059151307, 'binary_recall': 0.42923796, 'binary_specificity': 0.7581134, 'binary_f1_score': 0.10397439}
confusion matrix:
       0     1
0  13759  4390
1    367   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51821667, 'precision': 0.5380605, 'recall': 0.7376303, 'specificity': 0.7376303, 'f1': 0.40467274, 'auroc': 0.91266656, 'binary_precision': 0.078125, 'binary_recall': 0.9770115, 'binary_specificity': 0.4982491, 'binary_f1_score': 0.14468086}
confusion matrix:
      0     1
0  2988  3009
1     6   255
early stop counter: 13
val acc:0.7468603849411011, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 14,now: 2024-07-31 06:48:47.310178,epoch time: 0:10:04.317215,used: 2:26:14.762100,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9482392, 'precision': 0.9513676, 'recall': 0.9482045, 'specificity': 0.9482045, 'f1': 0.9481465, 'auroc': 0.9959147, 'binary_precision': 0.9139989, 'binary_recall': 0.98968786, 'binary_specificity': 0.9067211, 'binary_f1_score': 0.9503387}
confusion matrix:
       0      1
0  25983   2673
1    296  28408
---- Validation: 
scalar performance:
{'acc': 0.7355257, 'precision': 0.5157192, 'recall': 0.59155786, 'specificity': 0.59155786, 'f1': 0.4732651, 'auroc': 0.61068773, 'binary_precision': 0.057475965, 'binary_recall': 0.43701398, 'binary_specificity': 0.74610174, 'binary_f1_score': 0.101590745}
confusion matrix:
       0     1
0  13541  4608
1    362   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48849472, 'precision': 0.5346858, 'recall': 0.7147932, 'specificity': 0.7147932, 'f1': 0.38617614, 'auroc': 0.91582155, 'binary_precision': 0.07292272, 'binary_recall': 0.96168584, 'binary_specificity': 0.4679006, 'binary_f1_score': 0.13556576}
confusion matrix:
      0     1
0  2806  3191
1    10   251
early stop counter: 14
val acc:0.7355257272720337, best validation acc: 0.9535972476005554, corresponding to test acc:                         0.9702780246734619 / 0.9702780246734619
after epoch: 15,now: 2024-07-31 06:58:52.177291,epoch time: 0:10:04.867113,used: 2:36:19.629213,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_22_32_seed_0_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:36:19.629213 at 2024-07-31 06:58:52.177291
persisted model performance metric: 

scalar performance:
{'acc': 0.970278, 'precision': 0.81504184, 'recall': 0.8104205, 'specificity': 0.8104205, 'f1': 0.81271195, 'auroc': 0.8836826, 'binary_precision': 0.6459144, 'binary_recall': 0.6360153, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.6409266}
confusion matrix:
      0    1
0  5906   91
1    95  166
oracle model performance metric: 

scalar performance:
{'acc': 0.970278, 'precision': 0.81504184, 'recall': 0.8104205, 'specificity': 0.8104205, 'f1': 0.81271195, 'auroc': 0.8836826, 'binary_precision': 0.6459144, 'binary_recall': 0.6360153, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.6409266}
confusion matrix:
      0    1
0  5906   91
1    95  166
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 540379 KiB |  11095 MiB | 510214 GiB | 510213 GiB |
|       from large pool | 450560 KiB |  11022 MiB | 509493 GiB | 509493 GiB |
|       from small pool |  89819 KiB |    125 MiB |    720 GiB |    720 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 540379 KiB |  11095 MiB | 510214 GiB | 510213 GiB |
|       from large pool | 450560 KiB |  11022 MiB | 509493 GiB | 509493 GiB |
|       from small pool |  89819 KiB |    125 MiB |    720 GiB |    720 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 525469 KiB |  10983 MiB | 507329 GiB | 507328 GiB |
|       from large pool | 436736 KiB |  10910 MiB | 506618 GiB | 506618 GiB |
|       from small pool |  88733 KiB |    124 MiB |    710 GiB |    710 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11292 MiB |  11292 MiB |  11292 MiB |      0 B   |
|       from large pool |  11166 MiB |  11166 MiB |  11166 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1712 MiB |   1999 MiB | 170561 GiB | 170559 GiB |
|       from large pool |   1702 MiB |   1996 MiB | 169809 GiB | 169807 GiB |
|       from small pool |     10 MiB |     11 MiB |    751 GiB |    751 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    8416    |   56350 K  |   56347 K  |
|       from large pool |      87    |     909    |   23726 K  |   23726 K  |
|       from small pool |    3642    |    8327    |   32624 K  |   32620 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    8416    |   56350 K  |   56347 K  |
|       from large pool |      87    |     909    |   23726 K  |   23726 K  |
|       from small pool |    3642    |    8327    |   32624 K  |   32620 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     234    |     234    |       0    |
|       from large pool |     171    |     171    |     171    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    3625    |   31412 K  |   31412 K  |
|       from large pool |      28    |      57    |   14650 K  |   14650 K  |
|       from small pool |      54    |    3596    |   16761 K  |   16761 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11095 MiB | 510214 GiB | 510214 GiB |
|       from large pool |  65536 KiB |  11022 MiB | 509493 GiB | 509493 GiB |
|       from small pool |      0 KiB |    125 MiB |    720 GiB |    720 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11095 MiB | 510214 GiB | 510214 GiB |
|       from large pool |  65536 KiB |  11022 MiB | 509493 GiB | 509493 GiB |
|       from small pool |      0 KiB |    125 MiB |    720 GiB |    720 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB | 507329 GiB | 507329 GiB |
|       from large pool |  65536 KiB |  10910 MiB | 506618 GiB | 506618 GiB |
|       from small pool |      0 KiB |    124 MiB |    710 GiB |    710 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2240 MiB |  11292 MiB |  11292 MiB |   9052 MiB |
|       from large pool |   2142 MiB |  11166 MiB |  11166 MiB |   9024 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1999 MiB | 170561 GiB | 170561 GiB |
|       from large pool | 116736 KiB |   1996 MiB | 169809 GiB | 169809 GiB |
|       from small pool |      0 KiB |     22 MiB |    751 GiB |    751 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   56350 K  |   56350 K  |
|       from large pool |       2    |     909    |   23726 K  |   23726 K  |
|       from small pool |       0    |    8327    |   32624 K  |   32624 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   56350 K  |   56350 K  |
|       from large pool |       2    |     909    |   23726 K  |   23726 K  |
|       from small pool |       0    |    8327    |   32624 K  |   32624 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     234    |     234    |     152    |
|       from large pool |      33    |     171    |     171    |     138    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3625    |   31413 K  |   31413 K  |
|       from large pool |       3    |      57    |   14650 K  |   14650 K  |
|       from small pool |       0    |    3596    |   16762 K  |   16762 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11095 MiB | 510214 GiB | 510214 GiB |
|       from large pool |  65536 KiB |  11022 MiB | 509493 GiB | 509493 GiB |
|       from small pool |      0 KiB |    125 MiB |    720 GiB |    720 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11095 MiB | 510214 GiB | 510214 GiB |
|       from large pool |  65536 KiB |  11022 MiB | 509493 GiB | 509493 GiB |
|       from small pool |      0 KiB |    125 MiB |    720 GiB |    720 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB | 507329 GiB | 507329 GiB |
|       from large pool |  65536 KiB |  10910 MiB | 506618 GiB | 506618 GiB |
|       from small pool |      0 KiB |    124 MiB |    710 GiB |    710 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2240 MiB |  11292 MiB |  11292 MiB |   9052 MiB |
|       from large pool |   2142 MiB |  11166 MiB |  11166 MiB |   9024 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1999 MiB | 170561 GiB | 170561 GiB |
|       from large pool | 116736 KiB |   1996 MiB | 169809 GiB | 169809 GiB |
|       from small pool |      0 KiB |     22 MiB |    751 GiB |    751 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   56350 K  |   56350 K  |
|       from large pool |       2    |     909    |   23726 K  |   23726 K  |
|       from small pool |       0    |    8327    |   32624 K  |   32624 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   56350 K  |   56350 K  |
|       from large pool |       2    |     909    |   23726 K  |   23726 K  |
|       from small pool |       0    |    8327    |   32624 K  |   32624 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     234    |     234    |     152    |
|       from large pool |      33    |     171    |     171    |     138    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3625    |   31413 K  |   31413 K  |
|       from large pool |       3    |      57    |   14650 K  |   14650 K  |
|       from small pool |       0    |    3596    |   16762 K  |   16762 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361

 Experiment start at: 2024-07-31 07:05:02.491517
before training, model accuracy: 0.14582662284374237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9650618, 'precision': 0.9651549, 'recall': 0.9650668, 'specificity': 0.9650668, 'f1': 0.96506035, 'auroc': 0.9930775, 'binary_precision': 0.97191226, 'binary_recall': 0.9578535, 'binary_specificity': 0.97228014, 'binary_f1_score': 0.9648317}
confusion matrix:
       0      1
0  27990    798
1   1215  27613
---- Validation: 
scalar performance:
{'acc': 0.9201174, 'precision': 0.598189, 'recall': 0.7032204, 'specificity': 0.7032204, 'f1': 0.6272531, 'auroc': 0.7915447, 'binary_precision': 0.21703297, 'binary_recall': 0.46953937, 'binary_specificity': 0.9369015, 'binary_f1_score': 0.296853}
confusion matrix:
       0     1
0  16927  1140
1    357   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92668384, 'precision': 0.653043, 'recall': 0.8054251, 'specificity': 0.8054251, 'f1': 0.6977911, 'auroc': 0.86405206, 'binary_precision': 0.32110092, 'binary_recall': 0.6730769, 'binary_specificity': 0.9377733, 'binary_f1_score': 0.43478262}
confusion matrix:
      0    1
0  5576  370
1    85  175
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 07:15:30.195741,epoch time: 0:10:27.704224,used: 0:10:27.704224,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97375727, 'precision': 0.9738498, 'recall': 0.9737623, 'specificity': 0.9737623, 'f1': 0.9737562, 'auroc': 0.994897, 'binary_precision': 0.9806447, 'binary_recall': 0.9666297, 'binary_specificity': 0.9808948, 'binary_f1_score': 0.97358674}
confusion matrix:
       0      1
0  28238    550
1    962  27866
---- Validation: 
scalar performance:
{'acc': 0.9279616, 'precision': 0.59470105, 'recall': 0.66151154, 'specificity': 0.66151154, 'f1': 0.6169755, 'auroc': 0.7388301, 'binary_precision': 0.21337849, 'binary_recall': 0.3744428, 'binary_specificity': 0.94858027, 'binary_f1_score': 0.27184469}
confusion matrix:
       0    1
0  17138  929
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93844664, 'precision': 0.68310696, 'recall': 0.8391485, 'specificity': 0.8391485, 'f1': 0.73294896, 'auroc': 0.90403116, 'binary_precision': 0.37848607, 'binary_recall': 0.7307692, 'binary_specificity': 0.94752777, 'binary_f1_score': 0.49868765}
confusion matrix:
      0    1
0  5634  312
1    70  190
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 07:25:46.296649,epoch time: 0:10:16.100908,used: 0:20:43.805132,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96238893, 'precision': 0.9634845, 'recall': 0.9623713, 'specificity': 0.9623713, 'f1': 0.9623656, 'auroc': 0.99619436, 'binary_precision': 0.9411317, 'binary_recall': 0.98654133, 'binary_specificity': 0.93820125, 'binary_f1_score': 0.9633016}
confusion matrix:
       0      1
0  27008   1779
1    388  28441
---- Validation: 
scalar performance:
{'acc': 0.77395946, 'precision': 0.52201587, 'recall': 0.6095376, 'specificity': 0.6095376, 'f1': 0.4955525, 'auroc': 0.65129924, 'binary_precision': 0.07020506, 'binary_recall': 0.43239227, 'binary_specificity': 0.7866829, 'binary_f1_score': 0.120797}
confusion matrix:
       0     1
0  14213  3854
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7089913, 'precision': 0.5568377, 'recall': 0.81135345, 'specificity': 0.81135345, 'f1': 0.51581055, 'auroc': 0.9339763, 'binary_precision': 0.11846002, 'binary_recall': 0.9230769, 'binary_specificity': 0.69963, 'binary_f1_score': 0.20997377}
confusion matrix:
      0     1
0  4160  1786
1    20   240
early stop counter: 1
val acc:0.7739594578742981, best validation acc: 0.9279615879058838, corresponding to test acc:                         0.9384466409683228 / 0.9384466409683228
after epoch: 3,now: 2024-07-31 07:35:57.134495,epoch time: 0:10:10.837846,used: 0:30:54.642978,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97198695, 'precision': 0.9727621, 'recall': 0.9720011, 'specificity': 0.9720011, 'f1': 0.97197604, 'auroc': 0.99489045, 'binary_precision': 0.99208015, 'binary_recall': 0.95160955, 'binary_specificity': 0.99239266, 'binary_f1_score': 0.9714235}
confusion matrix:
       0      1
0  28569    219
1   1395  27433
---- Validation: 
scalar performance:
{'acc': 0.9413554, 'precision': 0.6127794, 'recall': 0.641993, 'specificity': 0.641993, 'f1': 0.6253301, 'auroc': 0.62083334, 'binary_precision': 0.25116822, 'binary_recall': 0.31946507, 'binary_specificity': 0.96452093, 'binary_f1_score': 0.28122956}
confusion matrix:
       0    1
0  17426  641
1    458  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97212374, 'precision': 0.82901275, 'recall': 0.8181046, 'specificity': 0.8181046, 'f1': 0.82345575, 'auroc': 0.9065416, 'binary_precision': 0.67330676, 'binary_recall': 0.65, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.66144806}
confusion matrix:
      0    1
0  5864   82
1    91  169
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 07:46:07.115383,epoch time: 0:10:09.980888,used: 0:41:04.623866,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9466294, 'precision': 0.95004797, 'recall': 0.9465962, 'specificity': 0.9465962, 'f1': 0.94652504, 'auroc': 0.99578416, 'binary_precision': 0.9110147, 'binary_recall': 0.9900451, 'binary_specificity': 0.90314734, 'binary_f1_score': 0.94888717}
confusion matrix:
       0      1
0  25998   2788
1    287  28543
---- Validation: 
scalar performance:
{'acc': 0.56680894, 'precision': 0.50100505, 'recall': 0.507111, 'specificity': 0.507111, 'f1': 0.3930938, 'auroc': 0.5617939, 'binary_precision': 0.037060067, 'binary_recall': 0.44279346, 'binary_specificity': 0.5714286, 'binary_f1_score': 0.06839569}
confusion matrix:
       0     1
0  10324  7743
1    375   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38833386, 'precision': 0.53001696, 'recall': 0.66975987, 'specificity': 0.66975987, 'f1': 0.3249251, 'auroc': 0.92916024, 'binary_precision': 0.0628091, 'binary_recall': 0.97692305, 'binary_specificity': 0.3625967, 'binary_f1_score': 0.11802975}
confusion matrix:
      0     1
0  2156  3790
1     6   254
early stop counter: 1
val acc:0.5668089389801025, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 5,now: 2024-07-31 07:56:13.848634,epoch time: 0:10:06.733251,used: 0:51:11.357117,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9330568, 'precision': 0.93814343, 'recall': 0.9330176, 'specificity': 0.9330176, 'f1': 0.93285775, 'auroc': 0.9943496, 'binary_precision': 0.8911164, 'binary_recall': 0.98678416, 'binary_specificity': 0.87925106, 'binary_f1_score': 0.93651336}
confusion matrix:
       0      1
0  25311   3476
1    381  28448
---- Validation: 
scalar performance:
{'acc': 0.4840982, 'precision': 0.4949423, 'recall': 0.46349984, 'specificity': 0.46349984, 'f1': 0.35133868, 'auroc': 0.5482969, 'binary_precision': 0.03097299, 'binary_recall': 0.44130757, 'binary_specificity': 0.48569214, 'binary_f1_score': 0.057883453}
confusion matrix:
      0     1
0  8775  9292
1   376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.24315178, 'precision': 0.52524674, 'recall': 0.6013506, 'specificity': 0.6013506, 'f1': 0.22326577, 'auroc': 0.92149425, 'binary_precision': 0.052089643, 'binary_recall': 0.99230766, 'binary_specificity': 0.21039355, 'binary_f1_score': 0.0989833}
confusion matrix:
      0     1
0  1251  4695
1     2   258
early stop counter: 2
val acc:0.4840981960296631, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 6,now: 2024-07-31 08:06:25.293284,epoch time: 0:10:11.444650,used: 1:01:22.801767,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9107366, 'precision': 0.92114997, 'recall': 0.9106766, 'specificity': 0.9106766, 'f1': 0.9101727, 'auroc': 0.99426925, 'binary_precision': 0.8551168, 'binary_recall': 0.98921263, 'binary_specificity': 0.8321406, 'binary_f1_score': 0.91728985}
confusion matrix:
       0      1
0  23954   4832
1    311  28519
---- Validation: 
scalar performance:
{'acc': 0.4673426, 'precision': 0.49391973, 'recall': 0.45624053, 'specificity': 0.45624053, 'f1': 0.34272185, 'auroc': 0.5481607, 'binary_precision': 0.03018068, 'binary_recall': 0.44427934, 'binary_specificity': 0.4682017, 'binary_f1_score': 0.056521736}
confusion matrix:
      0     1
0  8459  9608
1   374   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.21382533, 'precision': 0.52529675, 'recall': 0.5897242, 'specificity': 0.5897242, 'f1': 0.20030308, 'auroc': 0.92689705, 'binary_precision': 0.0505935, 'binary_recall': 1.0, 'binary_specificity': 0.17944837, 'binary_f1_score': 0.09631413}
confusion matrix:
      0     1
0  1067  4879
1     0   260
early stop counter: 3
val acc:0.4673425853252411, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 7,now: 2024-07-31 08:16:36.699793,epoch time: 0:10:11.406509,used: 1:11:34.208276,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9306095, 'precision': 0.93574196, 'recall': 0.9305719, 'specificity': 0.9305719, 'f1': 0.9304005, 'auroc': 0.99344975, 'binary_precision': 0.88862455, 'binary_recall': 0.98473704, 'binary_specificity': 0.87640685, 'binary_f1_score': 0.9342153}
confusion matrix:
       0      1
0  25230   3558
1    440  28388
---- Validation: 
scalar performance:
{'acc': 0.6230523, 'precision': 0.5048452, 'recall': 0.5327039, 'specificity': 0.5327039, 'f1': 0.4198964, 'auroc': 0.55527914, 'binary_precision': 0.041995127, 'binary_recall': 0.43536404, 'binary_specificity': 0.63004375, 'binary_f1_score': 0.076601304}
confusion matrix:
       0     1
0  11383  6684
1    380   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3388656, 'precision': 0.527941, 'recall': 0.6457832, 'specificity': 0.6457832, 'f1': 0.292232, 'auroc': 0.8918879, 'binary_precision': 0.05858029, 'binary_recall': 0.9807692, 'binary_specificity': 0.31079718, 'binary_f1_score': 0.11055712}
confusion matrix:
      0     1
0  1848  4098
1     5   255
early stop counter: 4
val acc:0.6230522990226746, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 8,now: 2024-07-31 08:26:51.083333,epoch time: 0:10:14.383540,used: 1:21:48.591816,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9348098, 'precision': 0.9390425, 'recall': 0.93477577, 'specificity': 0.93477577, 'f1': 0.93464875, 'auroc': 0.99400824, 'binary_precision': 0.8961072, 'binary_recall': 0.9837658, 'binary_specificity': 0.88578576, 'binary_f1_score': 0.93789274}
confusion matrix:
       0      1
0  25500   3288
1    468  28360
---- Validation: 
scalar performance:
{'acc': 0.6324973, 'precision': 0.50541836, 'recall': 0.5361718, 'specificity': 0.5361718, 'f1': 0.42421982, 'auroc': 0.5660777, 'binary_precision': 0.042819306, 'binary_recall': 0.43239227, 'binary_specificity': 0.6399513, 'binary_f1_score': 0.07792208}
confusion matrix:
       0     1
0  11562  6505
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34176603, 'precision': 0.5284434, 'recall': 0.6491358, 'specificity': 0.6491358, 'f1': 0.29433215, 'auroc': 0.90771365, 'binary_precision': 0.05902698, 'binary_recall': 0.9846154, 'binary_specificity': 0.31365624, 'binary_f1_score': 0.111376986}
confusion matrix:
      0     1
0  1865  4081
1     4   256
early stop counter: 5
val acc:0.6324973106384277, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 9,now: 2024-07-31 08:37:02.226344,epoch time: 0:10:11.143011,used: 1:31:59.734827,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.89614, 'precision': 0.9093114, 'recall': 0.89607775, 'specificity': 0.89607775, 'f1': 0.89528704, 'auroc': 0.9920573, 'binary_precision': 0.8360598, 'binary_recall': 0.98570836, 'binary_specificity': 0.80644715, 'binary_f1_score': 0.9047377}
confusion matrix:
       0      1
0  23216   5572
1    412  28416
---- Validation: 
scalar performance:
{'acc': 0.52982926, 'precision': 0.49822146, 'recall': 0.48721713, 'specificity': 0.48721713, 'f1': 0.37466, 'auroc': 0.54674107, 'binary_precision': 0.034012828, 'binary_recall': 0.44130757, 'binary_specificity': 0.5331267, 'binary_f1_score': 0.06315789}
confusion matrix:
      0     1
0  9632  8435
1   376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.31421205, 'precision': 0.5280001, 'recall': 0.63843435, 'specificity': 0.63843435, 'f1': 0.27553135, 'auroc': 0.834321, 'binary_precision': 0.05718085, 'binary_recall': 0.99230766, 'binary_specificity': 0.28456104, 'binary_f1_score': 0.10813076}
confusion matrix:
      0     1
0  1692  4254
1     2   258
early stop counter: 6
val acc:0.5298292636871338, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 10,now: 2024-07-31 08:47:12.894266,epoch time: 0:10:10.667922,used: 1:42:10.402749,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.89147115, 'precision': 0.90593266, 'recall': 0.8913991, 'specificity': 0.8913991, 'f1': 0.8904829, 'auroc': 0.9917054, 'binary_precision': 0.82950467, 'binary_recall': 0.9857093, 'binary_specificity': 0.79708886, 'binary_f1_score': 0.9008861}
confusion matrix:
       0      1
0  22945   5841
1    412  28418
---- Validation: 
scalar performance:
{'acc': 0.55997866, 'precision': 0.49959585, 'recall': 0.49713123, 'specificity': 0.49713123, 'f1': 0.38887244, 'auroc': 0.5336546, 'binary_precision': 0.03545577, 'binary_recall': 0.4294205, 'binary_specificity': 0.564842, 'binary_f1_score': 0.06550317}
confusion matrix:
       0     1
0  10205  7862
1    384   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3116339, 'precision': 0.5278934, 'recall': 0.6370889, 'specificity': 0.6370889, 'f1': 0.2737168, 'auroc': 0.86535776, 'binary_precision': 0.0569788, 'binary_recall': 0.99230766, 'binary_specificity': 0.28187016, 'binary_f1_score': 0.10776942}
confusion matrix:
      0     1
0  1676  4270
1     2   258
early stop counter: 7
val acc:0.5599786639213562, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 11,now: 2024-07-31 08:57:20.488087,epoch time: 0:10:07.593821,used: 1:52:17.996570,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8786275, 'precision': 0.89780235, 'recall': 0.8785475, 'specificity': 0.8785475, 'f1': 0.87713075, 'auroc': 0.9907787, 'binary_precision': 0.810647, 'binary_recall': 0.9882757, 'binary_specificity': 0.7688193, 'binary_f1_score': 0.89069164}
confusion matrix:
       0      1
0  22132   6655
1    338  28491
---- Validation: 
scalar performance:
{'acc': 0.45704377, 'precision': 0.49325788, 'recall': 0.45161456, 'specificity': 0.45161456, 'f1': 0.33733484, 'auroc': 0.5260707, 'binary_precision': 0.02969709, 'binary_recall': 0.44576523, 'binary_specificity': 0.4574639, 'binary_f1_score': 0.055684455}
confusion matrix:
      0     1
0  8265  9802
1   373   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.1542056, 'precision': 0.5235978, 'recall': 0.55861086, 'specificity': 0.55861086, 'f1': 0.14999093, 'auroc': 0.87821096, 'binary_precision': 0.047195498, 'binary_recall': 1.0, 'binary_specificity': 0.11722166, 'binary_f1_score': 0.09013693}
confusion matrix:
     0     1
0  697  5249
1    0   260
early stop counter: 8
val acc:0.45704376697540283, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 12,now: 2024-07-31 09:07:29.421970,epoch time: 0:10:08.933883,used: 2:02:26.930453,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8937274, 'precision': 0.90690744, 'recall': 0.89366496, 'specificity': 0.89366496, 'f1': 0.89284897, 'auroc': 0.9909514, 'binary_precision': 0.83384794, 'binary_recall': 0.98359233, 'binary_specificity': 0.80373764, 'binary_f1_score': 0.90255123}
confusion matrix:
       0      1
0  23138   5650
1    473  28355
---- Validation: 
scalar performance:
{'acc': 0.43457845, 'precision': 0.49185807, 'recall': 0.4421093, 'specificity': 0.4421093, 'f1': 0.32543522, 'auroc': 0.53341043, 'binary_precision': 0.02877766, 'binary_recall': 0.45022288, 'binary_specificity': 0.4339957, 'binary_f1_score': 0.05409748}
confusion matrix:
      0      1
0  7841  10226
1   370    303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.2151144, 'precision': 0.5253362, 'recall': 0.5903969, 'specificity': 0.5903969, 'f1': 0.20134062, 'auroc': 0.82110727, 'binary_precision': 0.050672382, 'binary_recall': 1.0, 'binary_specificity': 0.1807938, 'binary_f1_score': 0.09645705}
confusion matrix:
      0     1
0  1075  4871
1     0   260
early stop counter: 9
val acc:0.43457844853401184, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 13,now: 2024-07-31 09:17:41.061089,epoch time: 0:10:11.639119,used: 2:12:38.569572,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8795647, 'precision': 0.897647, 'recall': 0.87948334, 'specificity': 0.87948334, 'f1': 0.87816346, 'auroc': 0.9894486, 'binary_precision': 0.8130416, 'binary_recall': 0.9860562, 'binary_specificity': 0.7729104, 'binary_f1_score': 0.8912298}
confusion matrix:
       0      1
0  22249   6537
1    402  28428
---- Validation: 
scalar performance:
{'acc': 0.40896478, 'precision': 0.48962906, 'recall': 0.42739487, 'specificity': 0.42739487, 'f1': 0.31114042, 'auroc': 0.5193702, 'binary_precision': 0.027351204, 'binary_recall': 0.4472511, 'binary_specificity': 0.4075386, 'binary_f1_score': 0.051549926}
confusion matrix:
      0      1
0  7363  10704
1   372    301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.15549469, 'precision': 0.52363205, 'recall': 0.55928355, 'specificity': 0.55928355, 'f1': 0.15113015, 'auroc': 0.84162354, 'binary_precision': 0.047264133, 'binary_recall': 1.0, 'binary_specificity': 0.1185671, 'binary_f1_score': 0.09026211}
confusion matrix:
     0     1
0  705  5241
1    0   260
early stop counter: 10
val acc:0.40896478295326233, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 14,now: 2024-07-31 09:27:54.914571,epoch time: 0:10:13.853482,used: 2:22:52.423054,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8840947, 'precision': 0.9010174, 'recall': 0.88401985, 'specificity': 0.88401985, 'f1': 0.8828444, 'auroc': 0.9913262, 'binary_precision': 0.81882036, 'binary_recall': 0.9866801, 'binary_specificity': 0.7813596, 'binary_f1_score': 0.8949471}
confusion matrix:
       0      1
0  22493   6294
1    384  28445
---- Validation: 
scalar performance:
{'acc': 0.4730523, 'precision': 0.4942387, 'recall': 0.45848644, 'specificity': 0.45848644, 'f1': 0.3456501, 'auroc': 0.53088653, 'binary_precision': 0.03041437, 'binary_recall': 0.44279346, 'binary_specificity': 0.47417945, 'binary_f1_score': 0.056919113}
confusion matrix:
      0     1
0  8567  9500
1   375   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.28005156, 'precision': 0.5270638, 'recall': 0.62244624, 'specificity': 0.62244624, 'f1': 0.25111052, 'auroc': 0.81302977, 'binary_precision': 0.054803215, 'binary_recall': 0.99615383, 'binary_specificity': 0.24873865, 'binary_f1_score': 0.10389089}
confusion matrix:
      0     1
0  1479  4467
1     1   259
early stop counter: 11
val acc:0.4730522930622101, best validation acc: 0.9413554072380066, corresponding to test acc:                         0.9721237421035767 / 0.9721237421035767
after epoch: 15,now: 2024-07-31 09:38:04.972137,epoch time: 0:10:10.057566,used: 2:33:02.480620,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_05_02_seed_1_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:02.480620 at 2024-07-31 09:38:04.972137
persisted model performance metric: 

scalar performance:
{'acc': 0.97212374, 'precision': 0.82901275, 'recall': 0.8181046, 'specificity': 0.8181046, 'f1': 0.82345575, 'auroc': 0.9065416, 'binary_precision': 0.67330676, 'binary_recall': 0.65, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.66144806}
confusion matrix:
      0    1
0  5864   82
1    91  169
oracle model performance metric: 

scalar performance:
{'acc': 0.97212374, 'precision': 0.82901275, 'recall': 0.8181046, 'specificity': 0.8181046, 'f1': 0.82345575, 'auroc': 0.9065416, 'binary_precision': 0.67330676, 'binary_recall': 0.65, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.66144806}
confusion matrix:
      0    1
0  5864   82
1    91  169
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 543503 KiB |  11095 MiB |   1003 TiB |   1003 TiB |
|       from large pool | 453696 KiB |  11022 MiB |   1002 TiB |   1002 TiB |
|       from small pool |  89807 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 543503 KiB |  11095 MiB |   1003 TiB |   1003 TiB |
|       from large pool | 453696 KiB |  11022 MiB |   1002 TiB |   1002 TiB |
|       from small pool |  89807 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 525466 KiB |  10983 MiB |    998 TiB |    998 TiB |
|       from large pool | 436736 KiB |  10910 MiB |    997 TiB |    997 TiB |
|       from small pool |  88730 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11284 MiB |  11292 MiB |  20336 MiB |   9052 MiB |
|       from large pool |  11160 MiB |  11166 MiB |  20184 MiB |   9024 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1301 MiB |   2399 MiB | 353942 GiB | 353940 GiB |
|       from large pool |   1294 MiB |   2396 MiB | 352416 GiB | 352415 GiB |
|       from small pool |      6 MiB |     22 MiB |   1525 GiB |   1525 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    8448    |  113358 K  |  113354 K  |
|       from large pool |      87    |     909    |   47810 K  |   47810 K  |
|       from small pool |    3618    |    8359    |   65548 K  |   65544 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    8448    |  113358 K  |  113354 K  |
|       from large pool |      87    |     909    |   47810 K  |   47810 K  |
|       from small pool |    3618    |    8359    |   65548 K  |   65544 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     225    |     234    |     377    |     152    |
|       from large pool |     163    |     171    |     301    |     138    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3632    |   62732 K  |   62732 K  |
|       from large pool |      21    |      57    |   29059 K  |   29059 K  |
|       from small pool |      54    |    3610    |   33672 K  |   33672 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11095 MiB |   1003 TiB |   1003 TiB |
|       from large pool |  65536 KiB |  11022 MiB |   1002 TiB |   1002 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11095 MiB |   1003 TiB |   1003 TiB |
|       from large pool |  65536 KiB |  11022 MiB |   1002 TiB |   1002 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB |    998 TiB |    998 TiB |
|       from large pool |  65536 KiB |  10910 MiB |    997 TiB |    997 TiB |
|       from small pool |      0 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11292 MiB |  20336 MiB |  18504 MiB |
|       from large pool |   1738 MiB |  11166 MiB |  20184 MiB |  18446 MiB |
|       from small pool |     94 MiB |    126 MiB |    152 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   2399 MiB | 353942 GiB | 353942 GiB |
|       from large pool | 116736 KiB |   2396 MiB | 352416 GiB | 352416 GiB |
|       from small pool |      0 KiB |     22 MiB |   1525 GiB |   1525 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  113358 K  |  113358 K  |
|       from large pool |       2    |     909    |   47810 K  |   47810 K  |
|       from small pool |       0    |    8359    |   65548 K  |   65548 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  113358 K  |  113358 K  |
|       from large pool |       2    |     909    |   47810 K  |   47810 K  |
|       from small pool |       0    |    8359    |   65548 K  |   65548 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     234    |     377    |     298    |
|       from large pool |      32    |     171    |     301    |     269    |
|       from small pool |      47    |      63    |      76    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3632    |   62733 K  |   62733 K  |
|       from large pool |       3    |      57    |   29059 K  |   29059 K  |
|       from small pool |       0    |    3610    |   33673 K  |   33673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11095 MiB |   1003 TiB |   1003 TiB |
|       from large pool |  65536 KiB |  11022 MiB |   1002 TiB |   1002 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11095 MiB |   1003 TiB |   1003 TiB |
|       from large pool |  65536 KiB |  11022 MiB |   1002 TiB |   1002 TiB |
|       from small pool |      0 KiB |    125 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB |    998 TiB |    998 TiB |
|       from large pool |  65536 KiB |  10910 MiB |    997 TiB |    997 TiB |
|       from small pool |      0 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11292 MiB |  20336 MiB |  18504 MiB |
|       from large pool |   1738 MiB |  11166 MiB |  20184 MiB |  18446 MiB |
|       from small pool |     94 MiB |    126 MiB |    152 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   2399 MiB | 353942 GiB | 353942 GiB |
|       from large pool | 116736 KiB |   2396 MiB | 352416 GiB | 352416 GiB |
|       from small pool |      0 KiB |     22 MiB |   1525 GiB |   1525 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  113358 K  |  113358 K  |
|       from large pool |       2    |     909    |   47810 K  |   47810 K  |
|       from small pool |       0    |    8359    |   65548 K  |   65548 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  113358 K  |  113358 K  |
|       from large pool |       2    |     909    |   47810 K  |   47810 K  |
|       from small pool |       0    |    8359    |   65548 K  |   65548 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     234    |     377    |     298    |
|       from large pool |      32    |     171    |     301    |     269    |
|       from small pool |      47    |      63    |      76    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3632    |   62733 K  |   62733 K  |
|       from large pool |       3    |      57    |   29059 K  |   29059 K  |
|       from small pool |       0    |    3610    |   33673 K  |   33673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361

 Experiment start at: 2024-07-31 09:44:42.714290
before training, model accuracy: 0.054656196385622025
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96020854, 'precision': 0.9621495, 'recall': 0.9602152, 'specificity': 0.9602152, 'f1': 0.9601671, 'auroc': 0.99321353, 'binary_precision': 0.9921514, 'binary_recall': 0.9277728, 'binary_specificity': 0.99265766, 'binary_f1_score': 0.95888275}
confusion matrix:
       0      1
0  28932    214
1   2106  27052
---- Validation: 
scalar performance:
{'acc': 0.9575454, 'precision': 0.6564028, 'recall': 0.6536379, 'specificity': 0.6536379, 'f1': 0.6550062, 'auroc': 0.81566834, 'binary_precision': 0.33502537, 'binary_recall': 0.32890365, 'binary_specificity': 0.97837216, 'binary_f1_score': 0.3319363}
confusion matrix:
       0    1
0  17778  393
1    404  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729123, 'precision': 0.8383404, 'recall': 0.7638427, 'specificity': 0.7638427, 'f1': 0.7960173, 'auroc': 0.85361135, 'binary_precision': 0.69518715, 'binary_recall': 0.5371901, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.60606056}
confusion matrix:
      0    1
0  5940   57
1   112  130
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 09:55:30.950600,epoch time: 0:10:48.236310,used: 0:10:48.236310,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9709454, 'precision': 0.97094667, 'recall': 0.97094524, 'specificity': 0.97094524, 'f1': 0.97094536, 'auroc': 0.9947257, 'binary_precision': 0.9702428, 'binary_recall': 0.97170687, 'binary_specificity': 0.97018355, 'binary_f1_score': 0.9709743}
confusion matrix:
       0      1
0  28276    869
1    825  28334
---- Validation: 
scalar performance:
{'acc': 0.8911735, 'precision': 0.5521734, 'recall': 0.6546866, 'specificity': 0.6546866, 'f1': 0.56659585, 'auroc': 0.6743596, 'binary_precision': 0.12571429, 'binary_recall': 0.40199336, 'binary_specificity': 0.90737987, 'binary_f1_score': 0.19153146}
confusion matrix:
       0     1
0  16488  1683
1    360   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87690336, 'precision': 0.6040388, 'recall': 0.85269284, 'specificity': 0.85269284, 'f1': 0.6372806, 'auroc': 0.90959877, 'binary_precision': 0.21598272, 'binary_recall': 0.8264463, 'binary_specificity': 0.87893945, 'binary_f1_score': 0.34246576}
confusion matrix:
      0    1
0  5271  726
1    42  200
early stop counter: 1
val acc:0.8911734819412231, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 2,now: 2024-07-31 10:06:12.645916,epoch time: 0:10:41.695316,used: 0:21:29.931626,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.952782, 'precision': 0.95438904, 'recall': 0.95277584, 'specificity': 0.95277584, 'f1': 0.9527397, 'auroc': 0.99456406, 'binary_precision': 0.9274175, 'binary_recall': 0.9824748, 'binary_specificity': 0.9230769, 'binary_f1_score': 0.9541526}
confusion matrix:
       0      1
0  26904   2242
1    511  28647
---- Validation: 
scalar performance:
{'acc': 0.6991957, 'precision': 0.5106482, 'recall': 0.5715786, 'specificity': 0.5715786, 'f1': 0.45246464, 'auroc': 0.5692278, 'binary_precision': 0.047046147, 'binary_recall': 0.43521595, 'binary_specificity': 0.70794123, 'binary_f1_score': 0.0849133}
confusion matrix:
       0     1
0  12864  5307
1    340   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53502166, 'precision': 0.5337652, 'recall': 0.72640526, 'specificity': 0.72640526, 'f1': 0.40844342, 'auroc': 0.92036444, 'binary_precision': 0.07264545, 'binary_recall': 0.9338843, 'binary_specificity': 0.51892614, 'binary_f1_score': 0.13480465}
confusion matrix:
      0     1
0  3112  2885
1    16   226
early stop counter: 2
val acc:0.6991956830024719, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 3,now: 2024-07-31 10:16:56.342284,epoch time: 0:10:43.696368,used: 0:32:13.627994,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9414963, 'precision': 0.94415164, 'recall': 0.941487, 'specificity': 0.941487, 'f1': 0.9414079, 'auroc': 0.99289083, 'binary_precision': 0.9098695, 'binary_recall': 0.98010904, 'binary_specificity': 0.902865, 'binary_f1_score': 0.9436841}
confusion matrix:
       0      1
0  26314   2831
1    580  28579
---- Validation: 
scalar performance:
{'acc': 0.7052149, 'precision': 0.50970024, 'recall': 0.5642483, 'specificity': 0.5642483, 'f1': 0.45347756, 'auroc': 0.5353203, 'binary_precision': 0.045856353, 'binary_recall': 0.41362128, 'binary_specificity': 0.71487534, 'binary_f1_score': 0.082559675}
confusion matrix:
       0     1
0  12990  5181
1    353   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4896618, 'precision': 0.5307836, 'recall': 0.70479286, 'specificity': 0.70479286, 'f1': 0.3823064, 'auroc': 0.90475476, 'binary_precision': 0.066843346, 'binary_recall': 0.93801653, 'binary_specificity': 0.47156912, 'binary_f1_score': 0.12479383}
confusion matrix:
      0     1
0  2828  3169
1    15   227
early stop counter: 3
val acc:0.7052149176597595, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 4,now: 2024-07-31 10:27:33.296955,epoch time: 0:10:36.954671,used: 0:42:50.582665,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93967825, 'precision': 0.94380856, 'recall': 0.9396733, 'specificity': 0.9396733, 'f1': 0.9395371, 'auroc': 0.9951275, 'binary_precision': 0.9010198, 'binary_recall': 0.98789227, 'binary_specificity': 0.8914543, 'binary_f1_score': 0.9424584}
confusion matrix:
       0      1
0  25985   3164
1    353  28802
---- Validation: 
scalar performance:
{'acc': 0.6260054, 'precision': 0.50492316, 'recall': 0.5369833, 'specificity': 0.5369833, 'f1': 0.41817385, 'auroc': 0.5497757, 'binary_precision': 0.038267877, 'binary_recall': 0.44186047, 'binary_specificity': 0.6321061, 'binary_f1_score': 0.07043559}
confusion matrix:
       0     1
0  11486  6685
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3149543, 'precision': 0.52446985, 'recall': 0.6317587, 'specificity': 0.6317587, 'f1': 0.27334222, 'auroc': 0.897171, 'binary_precision': 0.05239787, 'binary_recall': 0.9752066, 'binary_specificity': 0.28831083, 'binary_f1_score': 0.099452175}
confusion matrix:
      0     1
0  1729  4268
1     6   236
early stop counter: 4
val acc:0.6260054111480713, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 5,now: 2024-07-31 10:37:58.826343,epoch time: 0:10:25.529388,used: 0:53:16.112053,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96104896, 'precision': 0.9622717, 'recall': 0.96104455, 'specificity': 0.96104455, 'f1': 0.961023, 'auroc': 0.9960444, 'binary_precision': 0.9385398, 'binary_recall': 0.98672706, 'binary_specificity': 0.9353621, 'binary_f1_score': 0.9620304}
confusion matrix:
       0      1
0  27263   1884
1    387  28770
---- Validation: 
scalar performance:
{'acc': 0.7254035, 'precision': 0.5132672, 'recall': 0.58431363, 'specificity': 0.58431363, 'f1': 0.46509704, 'auroc': 0.5606301, 'binary_precision': 0.05142857, 'binary_recall': 0.43355483, 'binary_specificity': 0.7350724, 'binary_f1_score': 0.09194998}
confusion matrix:
       0     1
0  13357  4814
1    341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48821926, 'precision': 0.531895, 'recall': 0.7119734, 'specificity': 0.7119734, 'f1': 0.38225356, 'auroc': 0.91546535, 'binary_precision': 0.06768239, 'binary_recall': 0.95454544, 'binary_specificity': 0.46940136, 'binary_f1_score': 0.12640218}
confusion matrix:
      0     1
0  2815  3182
1    11   231
early stop counter: 5
val acc:0.7254034876823425, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 6,now: 2024-07-31 10:49:57.189400,epoch time: 0:11:58.363057,used: 1:05:14.475110,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94988334, 'precision': 0.9524571, 'recall': 0.9498756, 'specificity': 0.9498756, 'f1': 0.9498114, 'auroc': 0.99555564, 'binary_precision': 0.9183836, 'binary_recall': 0.98755056, 'binary_specificity': 0.9122006, 'binary_f1_score': 0.9517121}
confusion matrix:
       0      1
0  26587   2559
1    363  28795
---- Validation: 
scalar performance:
{'acc': 0.71459013, 'precision': 0.51184976, 'recall': 0.5771217, 'specificity': 0.5771217, 'f1': 0.45948648, 'auroc': 0.55934817, 'binary_precision': 0.049108837, 'binary_recall': 0.43023255, 'binary_specificity': 0.72401077, 'binary_f1_score': 0.08815521}
confusion matrix:
       0     1
0  13156  5015
1    343   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36287868, 'precision': 0.5265869, 'recall': 0.65668786, 'specificity': 0.65668786, 'f1': 0.305591, 'auroc': 0.8842312, 'binary_precision': 0.056123663, 'binary_recall': 0.9752066, 'binary_specificity': 0.3381691, 'binary_f1_score': 0.106138974}
confusion matrix:
      0     1
0  2028  3969
1     6   236
early stop counter: 6
val acc:0.7145901322364807, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 7,now: 2024-07-31 11:02:26.210329,epoch time: 0:12:29.020929,used: 1:17:43.496039,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97873217, 'precision': 0.9787525, 'recall': 0.97873175, 'specificity': 0.97873175, 'f1': 0.97873193, 'auroc': 0.9965746, 'binary_precision': 0.97566795, 'binary_recall': 0.9819591, 'binary_specificity': 0.97550434, 'binary_f1_score': 0.97880346}
confusion matrix:
       0      1
0  28434    714
1    526  28630
---- Validation: 
scalar performance:
{'acc': 0.9030523, 'precision': 0.5593511, 'recall': 0.65680754, 'specificity': 0.65680754, 'f1': 0.57749885, 'auroc': 0.58662003, 'binary_precision': 0.14007092, 'binary_recall': 0.3936877, 'binary_specificity': 0.91992736, 'binary_f1_score': 0.20662595}
confusion matrix:
       0     1
0  16716  1455
1    365   237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8030133, 'precision': 0.5706116, 'recall': 0.8301189, 'specificity': 0.8301189, 'f1': 0.5697189, 'auroc': 0.90713334, 'binary_precision': 0.14825374, 'binary_recall': 0.8595041, 'binary_specificity': 0.8007337, 'binary_f1_score': 0.25288752}
confusion matrix:
      0     1
0  4802  1195
1    34   208
early stop counter: 7
val acc:0.9030522704124451, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 8,now: 2024-07-31 11:13:43.272125,epoch time: 0:11:17.061796,used: 1:29:00.557835,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93482435, 'precision': 0.9401133, 'recall': 0.93481684, 'specificity': 0.93481684, 'f1': 0.93462723, 'auroc': 0.9960055, 'binary_precision': 0.8919011, 'binary_recall': 0.98960763, 'binary_specificity': 0.8800261, 'binary_f1_score': 0.93821746}
confusion matrix:
       0      1
0  25651   3497
1    303  28853
---- Validation: 
scalar performance:
{'acc': 0.7293986, 'precision': 0.5139687, 'recall': 0.5879834, 'specificity': 0.5879834, 'f1': 0.46738994, 'auroc': 0.6084125, 'binary_precision': 0.052557953, 'binary_recall': 0.43687707, 'binary_specificity': 0.7390898, 'binary_f1_score': 0.093828045}
confusion matrix:
       0     1
0  13430  4741
1    339   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45263663, 'precision': 0.5302835, 'recall': 0.69742966, 'specificity': 0.69742966, 'f1': 0.36142027, 'auroc': 0.89183164, 'binary_precision': 0.064028576, 'binary_recall': 0.9628099, 'binary_specificity': 0.43204936, 'binary_f1_score': 0.120072134}
confusion matrix:
      0     1
0  2591  3406
1     9   233
early stop counter: 8
val acc:0.7293986082077026, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 9,now: 2024-07-31 11:24:43.573913,epoch time: 0:11:00.301788,used: 1:40:00.859623,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9361279, 'precision': 0.9408028, 'recall': 0.9361191, 'specificity': 0.9361191, 'f1': 0.9359572, 'auroc': 0.9949135, 'binary_precision': 0.8954505, 'binary_recall': 0.9875845, 'binary_specificity': 0.8846536, 'binary_f1_score': 0.93926346}
confusion matrix:
       0      1
0  25785   3362
1    362  28795
---- Validation: 
scalar performance:
{'acc': 0.69685185, 'precision': 0.5105375, 'recall': 0.5711709, 'specificity': 0.5711709, 'f1': 0.45147696, 'auroc': 0.566748, 'binary_precision': 0.046838824, 'binary_recall': 0.43687707, 'binary_specificity': 0.7054648, 'binary_f1_score': 0.08460672}
confusion matrix:
       0     1
0  12819  5352
1    339   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55008817, 'precision': 0.5349715, 'recall': 0.73424244, 'specificity': 0.73424244, 'f1': 0.4171065, 'auroc': 0.86533487, 'binary_precision': 0.07490885, 'binary_recall': 0.9338843, 'binary_specificity': 0.5346006, 'binary_f1_score': 0.13869287}
confusion matrix:
      0     1
0  3206  2791
1    16   226
early stop counter: 9
val acc:0.6968518495559692, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 10,now: 2024-07-31 11:35:26.274361,epoch time: 0:10:42.700448,used: 1:50:43.560071,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92592275, 'precision': 0.93295914, 'recall': 0.9259053, 'specificity': 0.9259053, 'f1': 0.9256185, 'auroc': 0.9949522, 'binary_precision': 0.8778329, 'binary_recall': 0.98960906, 'binary_specificity': 0.8622015, 'binary_f1_score': 0.9303758}
confusion matrix:
       0      1
0  25128   4016
1    303  28857
---- Validation: 
scalar performance:
{'acc': 0.5699675, 'precision': 0.50091803, 'recall': 0.507233, 'specificity': 0.507233, 'f1': 0.39133945, 'auroc': 0.5618761, 'binary_precision': 0.03312086, 'binary_recall': 0.44019935, 'binary_specificity': 0.5742667, 'binary_f1_score': 0.061606415}
confusion matrix:
       0     1
0  10435  7736
1    337   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.31815997, 'precision': 0.52384204, 'recall': 0.6294607, 'specificity': 0.6294607, 'f1': 0.27531597, 'auroc': 0.81513673, 'binary_precision': 0.052232143, 'binary_recall': 0.96694213, 'binary_specificity': 0.2919793, 'binary_f1_score': 0.09911055}
confusion matrix:
      0     1
0  1751  4246
1     8   234
early stop counter: 10
val acc:0.56996750831604, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 11,now: 2024-07-31 11:45:51.058228,epoch time: 0:10:24.783867,used: 2:01:08.343938,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92635155, 'precision': 0.93373734, 'recall': 0.92634034, 'specificity': 0.92634034, 'f1': 0.92603534, 'auroc': 0.995312, 'binary_precision': 0.87718076, 'binary_recall': 0.9915629, 'binary_specificity': 0.8611178, 'binary_f1_score': 0.93087125}
confusion matrix:
       0      1
0  25099   4048
1    246  28911
---- Validation: 
scalar performance:
{'acc': 0.6009162, 'precision': 0.50322324, 'recall': 0.5248261, 'specificity': 0.5248261, 'f1': 0.40636984, 'auroc': 0.56497383, 'binary_precision': 0.03596444, 'binary_recall': 0.4435216, 'binary_specificity': 0.60613066, 'binary_f1_score': 0.06653377}
confusion matrix:
       0     1
0  11014  7157
1    335   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38066998, 'precision': 0.526745, 'recall': 0.661977, 'specificity': 0.661977, 'f1': 0.316845, 'auroc': 0.8888821, 'binary_precision': 0.057212714, 'binary_recall': 0.96694213, 'binary_specificity': 0.35701182, 'binary_f1_score': 0.10803324}
confusion matrix:
      0     1
0  2141  3856
1     8   234
early stop counter: 11
val acc:0.6009162068367004, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 12,now: 2024-07-31 11:56:39.169436,epoch time: 0:10:48.111208,used: 2:11:56.455146,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9109152, 'precision': 0.9216149, 'recall': 0.91090155, 'specificity': 0.91090155, 'f1': 0.91034436, 'auroc': 0.99510753, 'binary_precision': 0.8544927, 'binary_recall': 0.990534, 'binary_specificity': 0.8312691, 'binary_f1_score': 0.9174979}
confusion matrix:
       0      1
0  24229   4918
1    276  28881
---- Validation: 
scalar performance:
{'acc': 0.58152664, 'precision': 0.5023037, 'recall': 0.51802236, 'specificity': 0.51802236, 'f1': 0.3975091, 'auroc': 0.57661045, 'binary_precision': 0.034761418, 'binary_recall': 0.4501661, 'binary_specificity': 0.5858786, 'binary_f1_score': 0.06453917}
confusion matrix:
       0     1
0  10646  7525
1    331   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34011862, 'precision': 0.52519464, 'recall': 0.6428659, 'specificity': 0.6428659, 'f1': 0.29036492, 'auroc': 0.86882216, 'binary_precision': 0.054085154, 'binary_recall': 0.9710744, 'binary_specificity': 0.31465733, 'binary_f1_score': 0.10246348}
confusion matrix:
      0     1
0  1887  4110
1     7   235
early stop counter: 12
val acc:0.5815266370773315, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 13,now: 2024-07-31 12:07:01.537302,epoch time: 0:10:22.367866,used: 2:22:18.823012,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9370026, 'precision': 0.9422878, 'recall': 0.9369951, 'specificity': 0.9369951, 'f1': 0.93681306, 'auroc': 0.99674046, 'binary_precision': 0.8939736, 'binary_recall': 0.9916312, 'binary_specificity': 0.88235897, 'binary_f1_score': 0.94027346}
confusion matrix:
       0      1
0  25719   3429
1    244  28912
---- Validation: 
scalar performance:
{'acc': 0.6876365, 'precision': 0.5096659, 'recall': 0.56641054, 'specificity': 0.56641054, 'f1': 0.447051, 'auroc': 0.57293797, 'binary_precision': 0.045438837, 'binary_recall': 0.43687707, 'binary_specificity': 0.6959441, 'binary_f1_score': 0.082316115}
confusion matrix:
       0     1
0  12646  5525
1    339   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38435647, 'precision': 0.527264, 'recall': 0.66587734, 'specificity': 0.66587734, 'f1': 0.31935805, 'auroc': 0.9152984, 'binary_precision': 0.05775375, 'binary_recall': 0.9710744, 'binary_specificity': 0.36068034, 'binary_f1_score': 0.10902343}
confusion matrix:
      0     1
0  2163  3834
1     7   235
early stop counter: 13
val acc:0.6876364946365356, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 14,now: 2024-07-31 12:17:27.589898,epoch time: 0:10:26.052596,used: 2:32:44.875608,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.91237307, 'precision': 0.9237323, 'recall': 0.91235906, 'specificity': 0.91235906, 'f1': 0.9117799, 'auroc': 0.9961662, 'binary_precision': 0.85439754, 'binary_recall': 0.9942038, 'binary_specificity': 0.8305143, 'binary_f1_score': 0.91901404}
confusion matrix:
       0      1
0  24207   4940
1    169  28988
---- Validation: 
scalar performance:
{'acc': 0.60885316, 'precision': 0.5042012, 'recall': 0.5321382, 'specificity': 0.5321382, 'f1': 0.41058698, 'auroc': 0.60774326, 'binary_precision': 0.03720994, 'binary_recall': 0.4501661, 'binary_specificity': 0.6141104, 'binary_f1_score': 0.06873811}
confusion matrix:
       0     1
0  11159  7012
1    331   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.18704921, 'precision': 0.52277005, 'recall': 0.5771219, 'specificity': 0.5771219, 'f1': 0.1771884, 'auroc': 0.9078365, 'binary_precision': 0.045540083, 'binary_recall': 1.0, 'binary_specificity': 0.15424378, 'binary_f1_score': 0.08711303}
confusion matrix:
     0     1
0  925  5072
1    0   242
early stop counter: 14
val acc:0.6088531613349915, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9729123115539551 / 0.9729123115539551
after epoch: 15,now: 2024-07-31 12:27:58.965756,epoch time: 0:10:31.375858,used: 2:43:16.251466,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_09_44_42_seed_2_23775361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:43:16.251466 at 2024-07-31 12:27:58.965756
persisted model performance metric: 

scalar performance:
{'acc': 0.9729123, 'precision': 0.8383404, 'recall': 0.7638427, 'specificity': 0.7638427, 'f1': 0.7960173, 'auroc': 0.85361135, 'binary_precision': 0.69518715, 'binary_recall': 0.5371901, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.60606056}
confusion matrix:
      0    1
0  5940   57
1   112  130
oracle model performance metric: 

scalar performance:
{'acc': 0.9729123, 'precision': 0.8383404, 'recall': 0.7638427, 'specificity': 0.7638427, 'f1': 0.7960173, 'auroc': 0.85361135, 'binary_precision': 0.69518715, 'binary_recall': 0.5371901, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.60606056}
confusion matrix:
      0    1
0  5940   57
1   112  130
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 544085 KiB |  11098 MiB |   1532 TiB |   1532 TiB |
|       from large pool | 454272 KiB |  11024 MiB |   1530 TiB |   1530 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 544085 KiB |  11098 MiB |   1532 TiB |   1532 TiB |
|       from large pool | 454272 KiB |  11024 MiB |   1530 TiB |   1530 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 525468 KiB |  10983 MiB |   1523 TiB |   1523 TiB |
|       from large pool | 436736 KiB |  10910 MiB |   1521 TiB |   1521 TiB |
|       from small pool |  88732 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11286 MiB |  11292 MiB |  29790 MiB |  18504 MiB |
|       from large pool |  11162 MiB |  11166 MiB |  29608 MiB |  18446 MiB |
|       from small pool |    124 MiB |    126 MiB |    182 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1344 MiB |   2457 MiB | 572568 GiB | 572567 GiB |
|       from large pool |   1336 MiB |   2455 MiB | 570212 GiB | 570210 GiB |
|       from small pool |      8 MiB |     22 MiB |   2356 GiB |   2356 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    8534    |  172303 K  |  172299 K  |
|       from large pool |      87    |     909    |   72917 K  |   72917 K  |
|       from small pool |    3630    |    8445    |   99385 K  |   99382 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    8534    |  172303 K  |  172299 K  |
|       from large pool |      87    |     909    |   72917 K  |   72917 K  |
|       from small pool |    3630    |    8445    |   99385 K  |   99382 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     229    |     234    |     527    |     298    |
|       from large pool |     167    |     171    |     436    |     269    |
|       from small pool |      62    |      63    |      91    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    3678    |   94979 K  |   94978 K  |
|       from large pool |      24    |      57    |   43871 K  |   43871 K  |
|       from small pool |      54    |    3653    |   51107 K  |   51107 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11098 MiB |   1532 TiB |   1532 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   1530 TiB |   1530 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11098 MiB |   1532 TiB |   1532 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   1530 TiB |   1530 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB |   1523 TiB |   1523 TiB |
|       from large pool |  65536 KiB |  10910 MiB |   1521 TiB |   1521 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |  11292 MiB |  29790 MiB |  27914 MiB |
|       from large pool |   1780 MiB |  11166 MiB |  29608 MiB |  27828 MiB |
|       from small pool |     96 MiB |    126 MiB |    182 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   2457 MiB | 572568 GiB | 572568 GiB |
|       from large pool | 116736 KiB |   2455 MiB | 570212 GiB | 570212 GiB |
|       from small pool |      0 KiB |     24 MiB |   2356 GiB |   2356 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8534    |  172303 K  |  172303 K  |
|       from large pool |       2    |     909    |   72917 K  |   72917 K  |
|       from small pool |       0    |    8445    |   99385 K  |   99385 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8534    |  172303 K  |  172303 K  |
|       from large pool |       2    |     909    |   72917 K  |   72917 K  |
|       from small pool |       0    |    8445    |   99385 K  |   99385 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     234    |     527    |     444    |
|       from large pool |      35    |     171    |     436    |     401    |
|       from small pool |      48    |      63    |      91    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3678    |   94980 K  |   94980 K  |
|       from large pool |       3    |      57    |   43871 K  |   43871 K  |
|       from small pool |       0    |    3653    |   51108 K  |   51108 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 31 12:28:41 2024]
Finished job 0.
1 of 1 steps (100%) done
