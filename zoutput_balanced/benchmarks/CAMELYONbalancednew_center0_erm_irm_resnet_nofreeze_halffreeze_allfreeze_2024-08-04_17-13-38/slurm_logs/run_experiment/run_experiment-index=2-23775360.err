Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 04:15:44 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360

 Experiment start at: 2024-07-31 04:43:28.428959
before training, model accuracy: 0.31128156185150146
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9626743, 'precision': 0.96291435, 'recall': 0.9626657, 'specificity': 0.9626657, 'f1': 0.96266896, 'auroc': 0.99404186, 'binary_precision': 0.9525643, 'binary_recall': 0.97390425, 'binary_specificity': 0.95142716, 'binary_f1_score': 0.96311605}
confusion matrix:
       0      1
0  27266   1392
1    749  27953
---- Validation: 
scalar performance:
{'acc': 0.91613454, 'precision': 0.59255356, 'recall': 0.7150638, 'specificity': 0.7150638, 'f1': 0.6224437, 'auroc': 0.78880966, 'binary_precision': 0.20380953, 'binary_recall': 0.4992224, 'binary_specificity': 0.9309053, 'binary_f1_score': 0.28945}
confusion matrix:
       0     1
0  16895  1254
1    322   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92154044, 'precision': 0.65062964, 'recall': 0.8344642, 'specificity': 0.8344642, 'f1': 0.69897556, 'auroc': 0.8959397, 'binary_precision': 0.3133117, 'binary_recall': 0.7394636, 'binary_specificity': 0.92946476, 'binary_f1_score': 0.44013682}
confusion matrix:
      0    1
0  5574  423
1    68  193
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 05:38:36.367830,epoch time: 0:55:07.938871,used: 0:55:07.938871,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.951848, 'precision': 0.95421946, 'recall': 0.9518191, 'specificity': 0.9518191, 'f1': 0.9517828, 'auroc': 0.99540496, 'binary_precision': 0.9215992, 'binary_recall': 0.98780614, 'binary_specificity': 0.9158321, 'binary_f1_score': 0.9535548}
confusion matrix:
       0      1
0  26245   2412
1    350  28353
---- Validation: 
scalar performance:
{'acc': 0.8666454, 'precision': 0.5621373, 'recall': 0.72394514, 'specificity': 0.72394514, 'f1': 0.5767878, 'auroc': 0.79393744, 'binary_precision': 0.1413169, 'binary_recall': 0.57076204, 'binary_specificity': 0.87712824, 'binary_f1_score': 0.22654322}
confusion matrix:
       0     1
0  15919  2230
1    276   367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8785555, 'precision': 0.6121601, 'recall': 0.8560123, 'specificity': 0.8560123, 'f1': 0.64817905, 'auroc': 0.920871, 'binary_precision': 0.23258306, 'binary_recall': 0.8314176, 'binary_specificity': 0.88060695, 'binary_f1_score': 0.36348405}
confusion matrix:
      0    1
0  5281  716
1    44  217
early stop counter: 1
val acc:0.8666453957557678, best validation acc: 0.9161345362663269, corresponding to test acc:                         0.9215404391288757 / 0.9215404391288757
after epoch: 2,now: 2024-07-31 06:20:14.138827,epoch time: 0:41:37.770997,used: 1:36:45.709868,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9752615, 'precision': 0.97526914, 'recall': 0.9752601, 'specificity': 0.9752601, 'f1': 0.97526133, 'auroc': 0.99670875, 'binary_precision': 0.9735481, 'binary_recall': 0.9771096, 'binary_specificity': 0.97341055, 'binary_f1_score': 0.97532564}
confusion matrix:
       0      1
0  27896    762
1    657  28045
---- Validation: 
scalar performance:
{'acc': 0.93768626, 'precision': 0.60997826, 'recall': 0.6714674, 'specificity': 0.6714674, 'f1': 0.63246876, 'auroc': 0.7748784, 'binary_precision': 0.2421875, 'binary_recall': 0.38569206, 'binary_specificity': 0.95724285, 'binary_f1_score': 0.2975405}
confusion matrix:
       0    1
0  17373  776
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9354426, 'precision': 0.67882526, 'recall': 0.85454416, 'specificity': 0.85454416, 'f1': 0.731509, 'auroc': 0.9137199, 'binary_precision': 0.36832413, 'binary_recall': 0.7662835, 'binary_specificity': 0.94280475, 'binary_f1_score': 0.49751246}
confusion matrix:
      0    1
0  5654  343
1    61  200
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 07:09:06.646469,epoch time: 0:48:52.507642,used: 2:25:38.217510,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9703626, 'precision': 0.97061354, 'recall': 0.9703539, 'specificity': 0.9703539, 'f1': 0.97035825, 'auroc': 0.99642456, 'binary_precision': 0.95993733, 'binary_recall': 0.98174345, 'binary_specificity': 0.95896435, 'binary_f1_score': 0.97071797}
confusion matrix:
       0      1
0  27482   1176
1    524  28178
---- Validation: 
scalar performance:
{'acc': 0.91033417, 'precision': 0.5669232, 'recall': 0.6505564, 'specificity': 0.6505564, 'f1': 0.5867094, 'auroc': 0.70260066, 'binary_precision': 0.15723684, 'binary_recall': 0.3716952, 'binary_specificity': 0.9294176, 'binary_f1_score': 0.22098938}
confusion matrix:
       0     1
0  16868  1281
1    404   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483541, 'precision': 0.5949797, 'recall': 0.85308075, 'specificity': 0.85308075, 'f1': 0.6176689, 'auroc': 0.92013884, 'binary_precision': 0.1971831, 'binary_recall': 0.85823756, 'binary_specificity': 0.84792393, 'binary_f1_score': 0.3206872}
confusion matrix:
      0    1
0  5085  912
1    37  224
early stop counter: 1
val acc:0.9103341698646545, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 4,now: 2024-07-31 08:01:51.666838,epoch time: 0:52:45.020369,used: 3:18:23.237879,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96743375, 'precision': 0.96787, 'recall': 0.9674227, 'specificity': 0.9674227, 'f1': 0.9674256, 'auroc': 0.9963689, 'binary_precision': 0.95376605, 'binary_recall': 0.9825442, 'binary_specificity': 0.9523012, 'binary_f1_score': 0.9679412}
confusion matrix:
       0      1
0  27292   1367
1    501  28200
---- Validation: 
scalar performance:
{'acc': 0.8397722, 'precision': 0.5326287, 'recall': 0.62827647, 'specificity': 0.62827647, 'f1': 0.52894473, 'auroc': 0.6364266, 'binary_precision': 0.089459084, 'binary_recall': 0.40124416, 'binary_specificity': 0.85530883, 'binary_f1_score': 0.14629996}
confusion matrix:
       0     1
0  15523  2626
1    385   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70613617, 'precision': 0.55397964, 'recall': 0.7972003, 'specificity': 0.7972003, 'f1': 0.51136285, 'auroc': 0.9146892, 'binary_precision': 0.114369504, 'binary_recall': 0.8965517, 'binary_specificity': 0.6978489, 'binary_f1_score': 0.20286086}
confusion matrix:
      0     1
0  4185  1812
1    27   234
early stop counter: 2
val acc:0.8397722244262695, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 5,now: 2024-07-31 08:53:40.134756,epoch time: 0:51:48.467918,used: 4:10:11.705797,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9488494, 'precision': 0.9520112, 'recall': 0.9488145, 'specificity': 0.9488145, 'f1': 0.94875693, 'auroc': 0.99692106, 'binary_precision': 0.9144153, 'binary_recall': 0.9904891, 'binary_specificity': 0.90713984, 'binary_f1_score': 0.95093316}
confusion matrix:
       0      1
0  25995   2661
1    273  28431
---- Validation: 
scalar performance:
{'acc': 0.68630266, 'precision': 0.5098767, 'recall': 0.5638242, 'specificity': 0.5638242, 'f1': 0.44841966, 'auroc': 0.6161268, 'binary_precision': 0.047865015, 'binary_recall': 0.43234837, 'binary_specificity': 0.69530004, 'binary_f1_score': 0.08618819}
confusion matrix:
       0     1
0  12619  5530
1    365   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48785555, 'precision': 0.53554296, 'recall': 0.7199567, 'specificity': 0.7199567, 'f1': 0.3863681, 'auroc': 0.9245804, 'binary_precision': 0.07358053, 'binary_recall': 0.97318006, 'binary_specificity': 0.46673337, 'binary_f1_score': 0.13681659}
confusion matrix:
      0     1
0  2799  3198
1     7   254
early stop counter: 3
val acc:0.686302661895752, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 6,now: 2024-07-31 09:43:49.145853,epoch time: 0:50:09.011097,used: 5:00:20.716894,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9586646, 'precision': 0.96027017, 'recall': 0.95864, 'specificity': 0.95864, 'f1': 0.95862687, 'auroc': 0.9965679, 'binary_precision': 0.9332938, 'binary_recall': 0.9880156, 'binary_specificity': 0.92926437, 'binary_f1_score': 0.9598754}
confusion matrix:
       0      1
0  26629   2027
1    344  28360
---- Validation: 
scalar performance:
{'acc': 0.78219455, 'precision': 0.52067244, 'recall': 0.6044681, 'specificity': 0.6044681, 'f1': 0.4954212, 'auroc': 0.59560186, 'binary_precision': 0.0668006, 'binary_recall': 0.41368586, 'binary_specificity': 0.7952504, 'binary_f1_score': 0.115027025}
confusion matrix:
       0     1
0  14433  3716
1    377   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.577341, 'precision': 0.5388057, 'recall': 0.7409941, 'specificity': 0.7409941, 'f1': 0.4359737, 'auroc': 0.9063823, 'binary_precision': 0.083798885, 'binary_recall': 0.9195402, 'binary_specificity': 0.5624479, 'binary_f1_score': 0.1536}
confusion matrix:
      0     1
0  3373  2624
1    21   240
early stop counter: 4
val acc:0.7821945548057556, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 7,now: 2024-07-31 10:32:34.635766,epoch time: 0:48:45.489913,used: 5:49:06.206807,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96054745, 'precision': 0.96184117, 'recall': 0.9605254, 'specificity': 0.9605254, 'f1': 0.9605184, 'auroc': 0.9965626, 'binary_precision': 0.9376055, 'binary_recall': 0.9868311, 'binary_specificity': 0.9342197, 'binary_f1_score': 0.96158874}
confusion matrix:
       0      1
0  26771   1885
1    378  28326
---- Validation: 
scalar performance:
{'acc': 0.7319072, 'precision': 0.5141453, 'recall': 0.58293396, 'specificity': 0.58293396, 'f1': 0.4700142, 'auroc': 0.5808052, 'binary_precision': 0.055071875, 'binary_recall': 0.4230171, 'binary_specificity': 0.74285084, 'binary_f1_score': 0.097456105}
confusion matrix:
       0     1
0  13482  4667
1    371   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54857785, 'precision': 0.5393664, 'recall': 0.74614227, 'specificity': 0.74614227, 'f1': 0.42172694, 'auroc': 0.9198079, 'binary_precision': 0.08186562, 'binary_recall': 0.96168584, 'binary_specificity': 0.53059864, 'binary_f1_score': 0.15088668}
confusion matrix:
      0     1
0  3182  2815
1    10   251
early stop counter: 5
val acc:0.7319071888923645, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 8,now: 2024-07-31 11:27:04.848191,epoch time: 0:54:30.212425,used: 6:43:36.419232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92109483, 'precision': 0.9291816, 'recall': 0.9210327, 'specificity': 0.9210327, 'f1': 0.92071354, 'auroc': 0.99508417, 'binary_precision': 0.8704952, 'binary_recall': 0.9895492, 'binary_specificity': 0.85251623, 'binary_f1_score': 0.92621213}
confusion matrix:
       0      1
0  24428   4226
1    300  28406
---- Validation: 
scalar performance:
{'acc': 0.54267776, 'precision': 0.498395, 'recall': 0.48796737, 'specificity': 0.48796737, 'f1': 0.3790765, 'auroc': 0.5365518, 'binary_precision': 0.032459132, 'binary_recall': 0.42923796, 'binary_specificity': 0.5466968, 'binary_f1_score': 0.06035425}
confusion matrix:
      0     1
0  9922  8227
1   367   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.2817194, 'precision': 0.52658767, 'recall': 0.6215646, 'specificity': 0.6215646, 'f1': 0.25211883, 'auroc': 0.8433846, 'binary_precision': 0.054503366, 'binary_recall': 0.99233717, 'binary_specificity': 0.25079206, 'binary_f1_score': 0.103331335}
confusion matrix:
      0     1
0  1504  4493
1     2   259
early stop counter: 6
val acc:0.5426777601242065, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 9,now: 2024-07-31 12:19:49.604826,epoch time: 0:52:44.756635,used: 7:36:21.175867,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.92838216, 'precision': 0.9351047, 'recall': 0.92833674, 'specificity': 0.92833674, 'f1': 0.9280992, 'auroc': 0.99509203, 'binary_precision': 0.88120407, 'binary_recall': 0.9903836, 'binary_specificity': 0.8662898, 'binary_f1_score': 0.9326093}
confusion matrix:
       0      1
0  24827   3832
1    276  28425
---- Validation: 
scalar performance:
{'acc': 0.51516604, 'precision': 0.49582556, 'recall': 0.46847376, 'specificity': 0.46847376, 'f1': 0.36480355, 'auroc': 0.52003545, 'binary_precision': 0.029868977, 'binary_recall': 0.41835147, 'binary_specificity': 0.51859605, 'binary_f1_score': 0.055757076}
confusion matrix:
      0     1
0  9412  8737
1   374   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.20102268, 'precision': 0.52421904, 'recall': 0.58129257, 'specificity': 0.58129257, 'f1': 0.1897544, 'auroc': 0.89778924, 'binary_precision': 0.049439058, 'binary_recall': 0.99616855, 'binary_specificity': 0.16641654, 'binary_f1_score': 0.094202906}
confusion matrix:
     0     1
0  998  4999
1    1   260
early stop counter: 7
val acc:0.5151660442352295, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 10,now: 2024-07-31 13:07:41.318845,epoch time: 0:47:51.714019,used: 8:24:12.889886,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9715307, 'precision': 0.9718395, 'recall': 0.97152054, 'specificity': 0.97152054, 'f1': 0.97152555, 'auroc': 0.996612, 'binary_precision': 0.9599674, 'binary_recall': 0.984148, 'binary_specificity': 0.9588931, 'binary_f1_score': 0.9719073}
confusion matrix:
       0      1
0  27479   1178
1    455  28248
---- Validation: 
scalar performance:
{'acc': 0.8207748, 'precision': 0.5236968, 'recall': 0.60119, 'specificity': 0.60119, 'f1': 0.5113276, 'auroc': 0.5741526, 'binary_precision': 0.07355242, 'binary_recall': 0.36547434, 'binary_specificity': 0.8369056, 'binary_f1_score': 0.122459605}
confusion matrix:
       0     1
0  15189  2960
1    408   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5952381, 'precision': 0.54264474, 'recall': 0.76315844, 'specificity': 0.76315844, 'f1': 0.44812858, 'auroc': 0.9225494, 'binary_precision': 0.08929863, 'binary_recall': 0.9463602, 'binary_specificity': 0.57995665, 'binary_f1_score': 0.16319789}
confusion matrix:
      0     1
0  3478  2519
1    14   247
early stop counter: 8
val acc:0.8207747936248779, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 11,now: 2024-07-31 13:55:32.862829,epoch time: 0:47:51.543984,used: 9:12:04.433870,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9646269, 'precision': 0.96544516, 'recall': 0.9646088, 'specificity': 0.9646088, 'f1': 0.96461034, 'auroc': 0.99623954, 'binary_precision': 0.94614667, 'binary_recall': 0.98540324, 'binary_specificity': 0.94381434, 'binary_f1_score': 0.965376}
confusion matrix:
       0      1
0  27045   1610
1    419  28286
---- Validation: 
scalar performance:
{'acc': 0.84764796, 'precision': 0.53426754, 'recall': 0.6286036, 'specificity': 0.6286036, 'f1': 0.5332581, 'auroc': 0.58269244, 'binary_precision': 0.092809975, 'binary_recall': 0.3934681, 'binary_specificity': 0.8637391, 'binary_f1_score': 0.15019293}
confusion matrix:
       0     1
0  15676  2473
1    390   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63838285, 'precision': 0.5449803, 'recall': 0.7691786, 'specificity': 0.7691786, 'f1': 0.47116223, 'auroc': 0.91192913, 'binary_precision': 0.096045196, 'binary_recall': 0.9118774, 'binary_specificity': 0.6264799, 'binary_f1_score': 0.17378603}
confusion matrix:
      0     1
0  3757  2240
1    23   238
early stop counter: 9
val acc:0.8476479649543762, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 12,now: 2024-07-31 14:37:21.185002,epoch time: 0:41:48.322173,used: 9:53:52.756043,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9197873, 'precision': 0.9281155, 'recall': 0.9197339, 'specificity': 0.9197339, 'f1': 0.9193884, 'auroc': 0.99468625, 'binary_precision': 0.8685957, 'binary_recall': 0.98937356, 'binary_specificity': 0.8500942, 'binary_f1_score': 0.925059}
confusion matrix:
       0      1
0  24362   4296
1    305  28397
---- Validation: 
scalar performance:
{'acc': 0.58578116, 'precision': 0.50150776, 'recall': 0.5110327, 'specificity': 0.5110327, 'f1': 0.40014336, 'auroc': 0.5320961, 'binary_precision': 0.035997402, 'binary_recall': 0.43079317, 'binary_specificity': 0.59127223, 'binary_f1_score': 0.066442795}
confusion matrix:
       0     1
0  10731  7418
1    366   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39996803, 'precision': 0.531172, 'recall': 0.6795975, 'specificity': 0.6795975, 'f1': 0.3325429, 'auroc': 0.8771872, 'binary_precision': 0.06412175, 'binary_recall': 0.98467433, 'binary_specificity': 0.3745206, 'binary_f1_score': 0.1204029}
confusion matrix:
      0     1
0  2246  3751
1     4   257
early stop counter: 10
val acc:0.5857811570167542, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 13,now: 2024-07-31 15:19:26.213877,epoch time: 0:42:05.028875,used: 10:35:57.784918,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.89461297, 'precision': 0.91040766, 'recall': 0.89453095, 'specificity': 0.89453095, 'f1': 0.8935749, 'auroc': 0.9948782, 'binary_precision': 0.830104, 'binary_recall': 0.9925446, 'binary_specificity': 0.7965173, 'binary_f1_score': 0.9040857}
confusion matrix:
       0      1
0  22825   5831
1    214  28490
---- Validation: 
scalar performance:
{'acc': 0.52948064, 'precision': 0.49879, 'recall': 0.49088576, 'specificity': 0.49088576, 'f1': 0.37370598, 'auroc': 0.53992486, 'binary_precision': 0.03292697, 'binary_recall': 0.44945568, 'binary_specificity': 0.53231585, 'binary_f1_score': 0.06135881}
confusion matrix:
      0     1
0  9661  8488
1   354   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.22690956, 'precision': 0.52404135, 'recall': 0.59113467, 'specificity': 0.59113467, 'f1': 0.21043345, 'auroc': 0.8726133, 'binary_precision': 0.050657764, 'binary_recall': 0.9885057, 'binary_specificity': 0.19376355, 'binary_f1_score': 0.09637654}
confusion matrix:
      0     1
0  1162  4835
1     3   258
early stop counter: 11
val acc:0.5294806361198425, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 14,now: 2024-07-31 16:09:50.441193,epoch time: 0:50:24.227316,used: 11:26:22.012234,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8948919, 'precision': 0.90929884, 'recall': 0.89482653, 'specificity': 0.89482653, 'f1': 0.8939474, 'auroc': 0.9911926, 'binary_precision': 0.8326828, 'binary_recall': 0.9885714, 'binary_specificity': 0.80108166, 'binary_f1_score': 0.90395546}
confusion matrix:
       0      1
0  22959   5701
1    328  28372
---- Validation: 
scalar performance:
{'acc': 0.49755216, 'precision': 0.4967094, 'recall': 0.47510597, 'specificity': 0.47510597, 'f1': 0.35764977, 'auroc': 0.53445464, 'binary_precision': 0.03092014, 'binary_recall': 0.45101088, 'binary_specificity': 0.49920106, 'binary_f1_score': 0.05787268}
confusion matrix:
      0     1
0  9060  9089
1   353   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37040588, 'precision': 0.5300238, 'recall': 0.6660054, 'specificity': 0.6660054, 'f1': 0.3134826, 'auroc': 0.8699744, 'binary_precision': 0.061501786, 'binary_recall': 0.9885057, 'binary_specificity': 0.34350508, 'binary_f1_score': 0.11579893}
confusion matrix:
      0     1
0  2060  3937
1     3   258
early stop counter: 12
val acc:0.49755215644836426, best validation acc: 0.9376862645149231, corresponding to test acc:                         0.9354426264762878 / 0.9354426264762878
after epoch: 15,now: 2024-07-31 17:02:07.567765,epoch time: 0:52:17.126572,used: 12:18:39.138806,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_43_27_seed_0_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 12:18:39.138806 at 2024-07-31 17:02:07.567765
persisted model performance metric: 

scalar performance:
{'acc': 0.9354426, 'precision': 0.67882526, 'recall': 0.85454416, 'specificity': 0.85454416, 'f1': 0.731509, 'auroc': 0.9137199, 'binary_precision': 0.36832413, 'binary_recall': 0.7662835, 'binary_specificity': 0.94280475, 'binary_f1_score': 0.49751246}
confusion matrix:
      0    1
0  5654  343
1    61  200
oracle model performance metric: 

scalar performance:
{'acc': 0.9354426, 'precision': 0.67882526, 'recall': 0.85454416, 'specificity': 0.85454416, 'f1': 0.731509, 'auroc': 0.9137199, 'binary_precision': 0.36832413, 'binary_recall': 0.7662835, 'binary_specificity': 0.94280475, 'binary_f1_score': 0.49751246}
confusion matrix:
      0    1
0  5654  343
1    61  200
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool | 403328 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |  89819 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool | 403328 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |  89819 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB | 329616 GiB | 329615 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |  88733 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11486 MiB |  11486 MiB |  11486 MiB |      0 B   |
|       from large pool |  11360 MiB |  11360 MiB |  11360 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 752036 KiB |   1278 MiB | 126734 GiB | 126733 GiB |
|       from large pool | 741504 KiB |   1275 MiB | 125764 GiB | 125763 GiB |
|       from small pool |  10532 KiB |     11 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    8416    |   57547 K  |   57543 K  |
|       from large pool |      87    |     908    |   20828 K  |   20828 K  |
|       from small pool |    3642    |    8327    |   36719 K  |   36715 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    8416    |   57547 K  |   57543 K  |
|       from large pool |      87    |     908    |   20828 K  |   20828 K  |
|       from small pool |    3642    |    8327    |   36719 K  |   36715 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     406    |     406    |     406    |       0    |
|       from large pool |     343    |     343    |     343    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3617    |   31097 K  |   31097 K  |
|       from large pool |      19    |     188    |   13602 K  |   13602 K  |
|       from small pool |      54    |    3596    |   17494 K  |   17494 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 329616 GiB | 329616 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 328712 GiB | 328712 GiB |
|       from small pool |      0 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11486 MiB |  11486 MiB |  10270 MiB |
|       from large pool |   1118 MiB |  11360 MiB |  11360 MiB |  10242 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 126734 GiB | 126734 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 125764 GiB | 125764 GiB |
|       from small pool |      0 KiB |     22 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   57547 K  |   57547 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36719 K  |   36719 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   57547 K  |   57547 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36719 K  |   36719 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     406    |     406    |     327    |
|       from large pool |      30    |     343    |     343    |     313    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3617    |   31099 K  |   31099 K  |
|       from large pool |       4    |     188    |   13602 K  |   13602 K  |
|       from small pool |       0    |    3596    |   17496 K  |   17496 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 329616 GiB | 329616 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 328712 GiB | 328712 GiB |
|       from small pool |      0 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11486 MiB |  11486 MiB |  10270 MiB |
|       from large pool |   1118 MiB |  11360 MiB |  11360 MiB |  10242 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 126734 GiB | 126734 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 125764 GiB | 125764 GiB |
|       from small pool |      0 KiB |     22 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   57547 K  |   57547 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36719 K  |   36719 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   57547 K  |   57547 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36719 K  |   36719 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     406    |     406    |     327    |
|       from large pool |      30    |     343    |     343    |     313    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3617    |   31099 K  |   31099 K  |
|       from large pool |       4    |     188    |   13602 K  |   13602 K  |
|       from small pool |       0    |    3596    |   17496 K  |   17496 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360

 Experiment start at: 2024-07-31 17:32:47.512421
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96900165, 'precision': 0.9693463, 'recall': 0.9690112, 'specificity': 0.9690112, 'f1': 0.9689964, 'auroc': 0.9937774, 'binary_precision': 0.9822384, 'binary_recall': 0.9553212, 'binary_specificity': 0.9827011, 'binary_f1_score': 0.9685928}
confusion matrix:
       0      1
0  28290    498
1   1288  27540
---- Validation: 
scalar performance:
{'acc': 0.9449306, 'precision': 0.6483197, 'recall': 0.7125129, 'specificity': 0.7125129, 'f1': 0.67362607, 'auroc': 0.8250826, 'binary_precision': 0.31702346, 'binary_recall': 0.46210995, 'binary_specificity': 0.96291584, 'binary_f1_score': 0.37605804}
confusion matrix:
       0    1
0  17397  670
1    362  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94875926, 'precision': 0.7039091, 'recall': 0.79487765, 'specificity': 0.79487765, 'f1': 0.73959434, 'auroc': 0.8709811, 'binary_precision': 0.42447916, 'binary_recall': 0.6269231, 'binary_specificity': 0.96283215, 'binary_f1_score': 0.5062112}
confusion matrix:
      0    1
0  5725  221
1    97  163
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 18:27:38.947831,epoch time: 0:54:51.435410,used: 0:54:51.435410,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96244097, 'precision': 0.9630422, 'recall': 0.9624273, 'specificity': 0.9624273, 'f1': 0.962428, 'auroc': 0.9948101, 'binary_precision': 0.946547, 'binary_recall': 0.9802983, 'binary_specificity': 0.94455636, 'binary_f1_score': 0.96312696}
confusion matrix:
       0      1
0  27190   1596
1    568  28262
---- Validation: 
scalar performance:
{'acc': 0.8670224, 'precision': 0.55795044, 'recall': 0.6935657, 'specificity': 0.6935657, 'f1': 0.57111526, 'auroc': 0.7486183, 'binary_precision': 0.13634546, 'binary_recall': 0.50668645, 'binary_specificity': 0.880445, 'binary_f1_score': 0.21487083}
confusion matrix:
       0     1
0  15907  2160
1    332   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85449564, 'precision': 0.5969235, 'recall': 0.8468292, 'specificity': 0.8468292, 'f1': 0.6220332, 'auroc': 0.91344213, 'binary_precision': 0.20203893, 'binary_recall': 0.8384615, 'binary_specificity': 0.8551968, 'binary_f1_score': 0.32561615}
confusion matrix:
      0    1
0  5085  861
1    42  218
early stop counter: 1
val acc:0.8670223951339722, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 2,now: 2024-07-31 19:16:32.670760,epoch time: 0:48:53.722929,used: 1:43:45.158339,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9429846, 'precision': 0.94629145, 'recall': 0.9429548, 'specificity': 0.9429548, 'f1': 0.9428761, 'auroc': 0.99462044, 'binary_precision': 0.90804815, 'binary_recall': 0.9858818, 'binary_specificity': 0.9000278, 'binary_f1_score': 0.9453656}
confusion matrix:
       0      1
0  25910   2878
1    407  28421
---- Validation: 
scalar performance:
{'acc': 0.70506936, 'precision': 0.5144007, 'recall': 0.58596903, 'specificity': 0.58596903, 'f1': 0.4619519, 'auroc': 0.6265254, 'binary_precision': 0.05630713, 'binary_recall': 0.4576523, 'binary_specificity': 0.71428573, 'binary_f1_score': 0.10027674}
confusion matrix:
       0     1
0  12905  5162
1    365   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7304222, 'precision': 0.5595089, 'recall': 0.8133425, 'specificity': 0.8133425, 'f1': 0.5282006, 'auroc': 0.92351615, 'binary_precision': 0.12480085, 'binary_recall': 0.90384614, 'binary_specificity': 0.7228389, 'binary_f1_score': 0.21931873}
confusion matrix:
      0     1
0  4298  1648
1    25   235
early stop counter: 2
val acc:0.705069363117218, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 3,now: 2024-07-31 20:06:51.073863,epoch time: 0:50:18.403103,used: 2:34:03.561442,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96844625, 'precision': 0.96875906, 'recall': 0.96843654, 'specificity': 0.96843654, 'f1': 0.96844053, 'auroc': 0.995765, 'binary_precision': 0.9568394, 'binary_recall': 0.98120016, 'binary_specificity': 0.9556729, 'binary_f1_score': 0.96886665}
confusion matrix:
       0      1
0  27510   1276
1    542  28288
---- Validation: 
scalar performance:
{'acc': 0.84252936, 'precision': 0.5352509, 'recall': 0.63007903, 'specificity': 0.63007903, 'f1': 0.53393066, 'auroc': 0.62272394, 'binary_precision': 0.09581263, 'binary_recall': 0.4011887, 'binary_specificity': 0.8589694, 'binary_f1_score': 0.15468347}
confusion matrix:
       0     1
0  15519  2548
1    403   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82081854, 'precision': 0.5831885, 'recall': 0.8439662, 'specificity': 0.8439662, 'f1': 0.5932476, 'auroc': 0.9239476, 'binary_precision': 0.17331289, 'binary_recall': 0.86923075, 'binary_specificity': 0.8187016, 'binary_f1_score': 0.28900257}
confusion matrix:
      0     1
0  4868  1078
1    34   226
early stop counter: 3
val acc:0.8425293564796448, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 4,now: 2024-07-31 20:55:23.191361,epoch time: 0:48:32.117498,used: 3:22:35.678940,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9536587, 'precision': 0.9553311, 'recall': 0.9536357, 'specificity': 0.9536357, 'f1': 0.9536145, 'auroc': 0.9948777, 'binary_precision': 0.9279265, 'binary_recall': 0.9838016, 'binary_specificity': 0.9234697, 'binary_f1_score': 0.9550475}
confusion matrix:
       0      1
0  26583   2203
1    467  28363
---- Validation: 
scalar performance:
{'acc': 0.7858591, 'precision': 0.5222306, 'recall': 0.6056953, 'specificity': 0.6056953, 'f1': 0.49968877, 'auroc': 0.5977218, 'binary_precision': 0.07113508, 'binary_recall': 0.4115899, 'binary_specificity': 0.79980075, 'binary_f1_score': 0.12130501}
confusion matrix:
       0     1
0  14450  3617
1    396   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70673543, 'precision': 0.5551959, 'recall': 0.80282027, 'specificity': 0.80282027, 'f1': 0.5130459, 'auroc': 0.9250492, 'binary_precision': 0.11614173, 'binary_recall': 0.9076923, 'binary_specificity': 0.6979482, 'binary_f1_score': 0.20593369}
confusion matrix:
      0     1
0  4150  1796
1    24   236
early stop counter: 4
val acc:0.7858591079711914, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 5,now: 2024-07-31 21:47:46.173761,epoch time: 0:52:22.982400,used: 4:14:58.661340,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9043495, 'precision': 0.91636276, 'recall': 0.90428764, 'specificity': 0.90428764, 'f1': 0.9036449, 'auroc': 0.99270296, 'binary_precision': 0.8458207, 'binary_recall': 0.9891429, 'binary_specificity': 0.8194324, 'binary_f1_score': 0.91188467}
confusion matrix:
       0      1
0  23589   5198
1    313  28516
---- Validation: 
scalar performance:
{'acc': 0.4501601, 'precision': 0.49304223, 'recall': 0.4501903, 'specificity': 0.4501903, 'f1': 0.33386979, 'auroc': 0.5582529, 'binary_precision': 0.029598515, 'binary_recall': 0.45022288, 'binary_specificity': 0.45015773, 'binary_f1_score': 0.05554537}
confusion matrix:
      0     1
0  8133  9934
1   370   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3158234, 'precision': 0.52689654, 'recall': 0.6337583, 'specificity': 0.6337583, 'f1': 0.27631763, 'auroc': 0.88948286, 'binary_precision': 0.056717083, 'binary_recall': 0.9807692, 'binary_specificity': 0.2867474, 'binary_f1_score': 0.10723297}
confusion matrix:
      0     1
0  1705  4241
1     5   255
early stop counter: 5
val acc:0.45016008615493774, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 6,now: 2024-07-31 22:39:03.216146,epoch time: 0:51:17.042385,used: 5:06:15.703725,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95079494, 'precision': 0.9529976, 'recall': 0.9507684, 'specificity': 0.9507684, 'f1': 0.950733, 'auroc': 0.99480176, 'binary_precision': 0.9215998, 'binary_recall': 0.9855012, 'binary_specificity': 0.9160356, 'binary_f1_score': 0.95247996}
confusion matrix:
       0      1
0  26369   2417
1    418  28412
---- Validation: 
scalar performance:
{'acc': 0.760032, 'precision': 0.51903963, 'recall': 0.59873813, 'specificity': 0.59873813, 'f1': 0.48704678, 'auroc': 0.59928334, 'binary_precision': 0.06505915, 'binary_recall': 0.42496285, 'binary_specificity': 0.77251345, 'binary_f1_score': 0.11284277}
confusion matrix:
       0     1
0  13957  4110
1    387   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64276505, 'precision': 0.5480661, 'recall': 0.7859874, 'specificity': 0.7859874, 'f1': 0.47628662, 'auroc': 0.9348062, 'binary_precision': 0.1001226, 'binary_recall': 0.9423077, 'binary_specificity': 0.629667, 'binary_f1_score': 0.1810122}
confusion matrix:
      0     1
0  3744  2202
1    15   245
early stop counter: 6
val acc:0.7600319981575012, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 7,now: 2024-07-31 23:29:03.904825,epoch time: 0:50:00.688679,used: 5:56:16.392404,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9550472, 'precision': 0.95655775, 'recall': 0.95502734, 'specificity': 0.95502734, 'f1': 0.9550085, 'auroc': 0.9951847, 'binary_precision': 0.9304699, 'binary_recall': 0.9836617, 'binary_specificity': 0.9263929, 'binary_f1_score': 0.95632666}
confusion matrix:
       0      1
0  26669   2119
1    471  28357
---- Validation: 
scalar performance:
{'acc': 0.83591247, 'precision': 0.53447694, 'recall': 0.6323695, 'specificity': 0.6323695, 'f1': 0.5311406, 'auroc': 0.5755368, 'binary_precision': 0.09398242, 'binary_recall': 0.41307577, 'binary_specificity': 0.85166323, 'binary_f1_score': 0.15312585}
confusion matrix:
       0     1
0  15387  2680
1    395   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7151144, 'precision': 0.55551696, 'recall': 0.799837, 'specificity': 0.799837, 'f1': 0.5171057, 'auroc': 0.91643703, 'binary_precision': 0.11764706, 'binary_recall': 0.8923077, 'binary_specificity': 0.7073663, 'binary_f1_score': 0.2078853}
confusion matrix:
      0     1
0  4206  1740
1    28   232
early stop counter: 7
val acc:0.8359124660491943, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 8,now: 2024-08-01 00:18:09.640836,epoch time: 0:49:05.736011,used: 6:45:22.128415,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91191685, 'precision': 0.9223697, 'recall': 0.91185683, 'specificity': 0.91185683, 'f1': 0.9113599, 'auroc': 0.9944267, 'binary_precision': 0.85611486, 'binary_recall': 0.99042666, 'binary_specificity': 0.833287, 'binary_f1_score': 0.91838604}
confusion matrix:
       0      1
0  23987   4799
1    276  28554
---- Validation: 
scalar performance:
{'acc': 0.43735325, 'precision': 0.4918712, 'recall': 0.44211784, 'specificity': 0.44211784, 'f1': 0.32680774, 'auroc': 0.5392126, 'binary_precision': 0.028740572, 'binary_recall': 0.4472511, 'binary_specificity': 0.43698457, 'binary_f1_score': 0.05401041}
confusion matrix:
      0      1
0  7895  10172
1   372    301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.21624234, 'precision': 0.5248218, 'recall': 0.58914655, 'specificity': 0.58914655, 'f1': 0.20217742, 'auroc': 0.9045038, 'binary_precision': 0.050566185, 'binary_recall': 0.99615383, 'binary_specificity': 0.18213925, 'binary_f1_score': 0.09624675}
confusion matrix:
      0     1
0  1083  4863
1     1   259
early stop counter: 8
val acc:0.437353253364563, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 9,now: 2024-08-01 01:11:11.356717,epoch time: 0:53:01.715881,used: 7:38:23.844296,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8874792, 'precision': 0.90507054, 'recall': 0.8873997, 'specificity': 0.8873997, 'f1': 0.8862293, 'auroc': 0.9937427, 'binary_precision': 0.8208471, 'binary_recall': 0.9915366, 'binary_specificity': 0.78326267, 'binary_f1_score': 0.89815414}
confusion matrix:
       0      1
0  22547   6239
1    244  28586
---- Validation: 
scalar performance:
{'acc': 0.4628602, 'precision': 0.4940862, 'recall': 0.45749217, 'specificity': 0.45749217, 'f1': 0.34072393, 'auroc': 0.5678754, 'binary_precision': 0.03039696, 'binary_recall': 0.45170876, 'binary_specificity': 0.46327558, 'binary_f1_score': 0.05696084}
confusion matrix:
      0     1
0  8370  9697
1   369   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.16339026, 'precision': 0.5231001, 'recall': 0.561565, 'specificity': 0.561565, 'f1': 0.15801196, 'auroc': 0.90929466, 'binary_precision': 0.047522936, 'binary_recall': 0.99615383, 'binary_specificity': 0.12697612, 'binary_f1_score': 0.09071804}
confusion matrix:
     0     1
0  755  5191
1    1   259
early stop counter: 9
val acc:0.46286019682884216, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 10,now: 2024-08-01 02:01:26.768970,epoch time: 0:50:15.412253,used: 8:28:39.256549,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91075397, 'precision': 0.9212841, 'recall': 0.9106964, 'specificity': 0.9106964, 'f1': 0.9101844, 'auroc': 0.9942491, 'binary_precision': 0.85486144, 'binary_recall': 0.9896632, 'binary_specificity': 0.8317296, 'binary_f1_score': 0.91733646}
confusion matrix:
       0      1
0  23943   4844
1    298  28531
---- Validation: 
scalar performance:
{'acc': 0.46499467, 'precision': 0.49424344, 'recall': 0.45859915, 'specificity': 0.45859915, 'f1': 0.34185582, 'auroc': 0.545913, 'binary_precision': 0.030519024, 'binary_recall': 0.45170876, 'binary_specificity': 0.46548957, 'binary_f1_score': 0.057175096}
confusion matrix:
      0     1
0  8410  9657
1   369   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.26119885, 'precision': 0.5254578, 'recall': 0.60892975, 'specificity': 0.60892975, 'f1': 0.23691918, 'auroc': 0.89671546, 'binary_precision': 0.053110145, 'binary_recall': 0.98846155, 'binary_specificity': 0.22939791, 'binary_f1_score': 0.10080407}
confusion matrix:
      0     1
0  1364  4582
1     3   257
early stop counter: 10
val acc:0.4649946689605713, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 11,now: 2024-08-01 02:53:33.063771,epoch time: 0:52:06.294801,used: 9:20:45.551350,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.873004, 'precision': 0.8950728, 'recall': 0.8729179, 'specificity': 0.8729179, 'f1': 0.871187, 'auroc': 0.9927921, 'binary_precision': 0.8018804, 'binary_recall': 0.99105066, 'binary_specificity': 0.7547851, 'binary_f1_score': 0.886486}
confusion matrix:
       0      1
0  21728   7059
1    258  28571
---- Validation: 
scalar performance:
{'acc': 0.42342582, 'precision': 0.4910902, 'recall': 0.4370405, 'specificity': 0.4370405, 'f1': 0.31938192, 'auroc': 0.53572553, 'binary_precision': 0.0283054, 'binary_recall': 0.45170876, 'binary_specificity': 0.42237228, 'binary_f1_score': 0.053272583}
confusion matrix:
      0      1
0  7631  10436
1   369    304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.24057364, 'precision': 0.52614117, 'recall': 0.6036832, 'specificity': 0.6036832, 'f1': 0.22143564, 'auroc': 0.8910336, 'binary_precision': 0.052282326, 'binary_recall': 1.0, 'binary_specificity': 0.2073663, 'binary_f1_score': 0.09936939}
confusion matrix:
      0     1
0  1233  4713
1     0   260
early stop counter: 11
val acc:0.4234258234500885, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 12,now: 2024-08-01 03:46:34.845832,epoch time: 0:53:01.782061,used: 10:13:47.333411,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8977367, 'precision': 0.91166323, 'recall': 0.8976666, 'specificity': 0.8976666, 'f1': 0.8968527, 'auroc': 0.99319506, 'binary_precision': 0.8361372, 'binary_recall': 0.9895595, 'binary_specificity': 0.8057736, 'binary_f1_score': 0.9064019}
confusion matrix:
       0      1
0  23195   5591
1    301  28529
---- Validation: 
scalar performance:
{'acc': 0.47630736, 'precision': 0.49477345, 'recall': 0.46232042, 'specificity': 0.46232042, 'f1': 0.34758687, 'auroc': 0.55084646, 'binary_precision': 0.030893976, 'binary_recall': 0.4472511, 'binary_specificity': 0.47738972, 'binary_f1_score': 0.0577957}
confusion matrix:
      0     1
0  8625  9442
1   372   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.24540767, 'precision': 0.52629983, 'recall': 0.6062058, 'specificity': 0.6062058, 'f1': 0.22516884, 'auroc': 0.90419936, 'binary_precision': 0.052599635, 'binary_recall': 1.0, 'binary_specificity': 0.2124117, 'binary_f1_score': 0.099942334}
confusion matrix:
      0     1
0  1263  4683
1     0   260
early stop counter: 12
val acc:0.47630736231803894, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 13,now: 2024-08-01 04:18:10.002308,epoch time: 0:31:35.156476,used: 10:45:22.489887,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9344279, 'precision': 0.9393561, 'recall': 0.9343894, 'specificity': 0.9343894, 'f1': 0.9342395, 'auroc': 0.9946079, 'binary_precision': 0.8930062, 'binary_recall': 0.98723507, 'binary_specificity': 0.88154376, 'binary_f1_score': 0.9377595}
confusion matrix:
       0      1
0  25377   3410
1    368  28461
---- Validation: 
scalar performance:
{'acc': 0.69199574, 'precision': 0.51098573, 'recall': 0.5670291, 'specificity': 0.5670291, 'f1': 0.453078, 'auroc': 0.56571364, 'binary_precision': 0.051223375, 'binary_recall': 0.43239227, 'binary_specificity': 0.701666, 'binary_f1_score': 0.09159584}
confusion matrix:
       0     1
0  12677  5390
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6252014, 'precision': 0.5458717, 'recall': 0.7768215, 'specificity': 0.7768215, 'f1': 0.4658065, 'auroc': 0.9186467, 'binary_precision': 0.0958529, 'binary_recall': 0.9423077, 'binary_specificity': 0.61133534, 'binary_f1_score': 0.1740057}
confusion matrix:
      0     1
0  3635  2311
1    15   245
early stop counter: 13
val acc:0.6919957399368286, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 14,now: 2024-08-01 04:35:33.175259,epoch time: 0:17:23.172951,used: 11:02:45.662838,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9203693, 'precision': 0.9282615, 'recall': 0.9203199, 'specificity': 0.9203199, 'f1': 0.9199945, 'auroc': 0.9938345, 'binary_precision': 0.87030643, 'binary_recall': 0.98810226, 'binary_specificity': 0.85253763, 'binary_f1_score': 0.92547107}
confusion matrix:
       0      1
0  24542   4245
1    343  28486
---- Validation: 
scalar performance:
{'acc': 0.5454109, 'precision': 0.49944243, 'recall': 0.49601346, 'specificity': 0.49601346, 'f1': 0.3825259, 'auroc': 0.5640418, 'binary_precision': 0.035299692, 'binary_recall': 0.44279346, 'binary_specificity': 0.54923344, 'binary_f1_score': 0.06538673}
confusion matrix:
      0     1
0  9923  8144
1   375   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.35820174, 'precision': 0.5295662, 'recall': 0.659552, 'specificity': 0.659552, 'f1': 0.30553836, 'auroc': 0.8842436, 'binary_precision': 0.060656123, 'binary_recall': 0.98846155, 'binary_specificity': 0.33064246, 'binary_f1_score': 0.11429842}
confusion matrix:
      0     1
0  1966  3980
1     3   257
early stop counter: 14
val acc:0.5454108715057373, best validation acc: 0.9449306130409241, corresponding to test acc:                         0.9487592577934265 / 0.9487592577934265
after epoch: 15,now: 2024-08-01 04:53:03.700378,epoch time: 0:17:30.525119,used: 11:20:16.187957,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_17_32_46_seed_1_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 11:20:16.187957 at 2024-08-01 04:53:03.700378
persisted model performance metric: 

scalar performance:
{'acc': 0.94875926, 'precision': 0.7039091, 'recall': 0.79487765, 'specificity': 0.79487765, 'f1': 0.73959434, 'auroc': 0.8709811, 'binary_precision': 0.42447916, 'binary_recall': 0.6269231, 'binary_specificity': 0.96283215, 'binary_f1_score': 0.5062112}
confusion matrix:
      0    1
0  5725  221
1    97  163
oracle model performance metric: 

scalar performance:
{'acc': 0.94875926, 'precision': 0.7039091, 'recall': 0.79487765, 'specificity': 0.79487765, 'f1': 0.73959434, 'auroc': 0.8709811, 'binary_precision': 0.42447916, 'binary_recall': 0.6269231, 'binary_specificity': 0.96283215, 'binary_f1_score': 0.5062112}
confusion matrix:
      0    1
0  5725  221
1    97  163
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool | 403840 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |  89807 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool | 403840 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |  89807 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB | 664546 GiB | 664546 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |  88730 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11486 MiB |  21730 MiB |  10270 MiB |
|       from large pool |  11336 MiB |  11360 MiB |  21578 MiB |  10242 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 522160 KiB |   1278 MiB | 302944 GiB | 302944 GiB |
|       from large pool | 511616 KiB |   1275 MiB | 300975 GiB | 300975 GiB |
|       from small pool |  10544 KiB |     22 MiB |   1968 GiB |   1968 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    8448    |  115763 K  |  115759 K  |
|       from large pool |      87    |     908    |   41973 K  |   41973 K  |
|       from small pool |    3618    |    8359    |   73790 K  |   73786 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    8448    |  115763 K  |  115759 K  |
|       from large pool |      87    |     908    |   41973 K  |   41973 K  |
|       from small pool |    3618    |    8359    |   73790 K  |   73786 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     406    |     726    |     327    |
|       from large pool |     337    |     343    |     650    |     313    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3631    |   61844 K  |   61844 K  |
|       from large pool |      20    |     188    |   26688 K  |   26688 K  |
|       from small pool |      55    |    3610    |   35155 K  |   35155 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 664546 GiB | 664546 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |      0 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11486 MiB |  21730 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11360 MiB |  21578 MiB |  20684 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 302945 GiB | 302945 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 300976 GiB | 300976 GiB |
|       from small pool |      0 KiB |     26 MiB |   1969 GiB |   1969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  115763 K  |  115763 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73790 K  |   73790 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  115763 K  |  115763 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73790 K  |   73790 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     406    |     726    |     644    |
|       from large pool |      33    |     343    |     650    |     617    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   61845 K  |   61845 K  |
|       from large pool |       4    |     188    |   26688 K  |   26688 K  |
|       from small pool |       0    |    3610    |   35157 K  |   35157 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 664546 GiB | 664546 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |      0 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11486 MiB |  21730 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11360 MiB |  21578 MiB |  20684 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 302945 GiB | 302945 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 300976 GiB | 300976 GiB |
|       from small pool |      0 KiB |     26 MiB |   1969 GiB |   1969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  115763 K  |  115763 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73790 K  |   73790 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  115763 K  |  115763 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73790 K  |   73790 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     406    |     726    |     644    |
|       from large pool |      33    |     343    |     650    |     617    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   61845 K  |   61845 K  |
|       from large pool |       4    |     188    |   26688 K  |   26688 K  |
|       from small pool |       0    |    3610    |   35157 K  |   35157 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360

 Experiment start at: 2024-08-01 05:02:33.921201
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9716143, 'precision': 0.9718149, 'recall': 0.9716157, 'specificity': 0.9716157, 'f1': 0.9716114, 'auroc': 0.9947214, 'binary_precision': 0.9815781, 'binary_recall': 0.96127725, 'binary_specificity': 0.98195416, 'binary_f1_score': 0.97132164}
confusion matrix:
       0      1
0  28622    526
1   1129  28027
---- Validation: 
scalar performance:
{'acc': 0.9396474, 'precision': 0.6214378, 'recall': 0.7174698, 'specificity': 0.7174698, 'f1': 0.6530985, 'auroc': 0.8214539, 'binary_precision': 0.26059514, 'binary_recall': 0.48006645, 'binary_specificity': 0.95487314, 'binary_f1_score': 0.33781412}
confusion matrix:
       0    1
0  17351  820
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.735741, 'recall': 0.82037026, 'specificity': 0.82037026, 'f1': 0.7706636, 'auroc': 0.8921093, 'binary_precision': 0.48502994, 'binary_recall': 0.6694215, 'binary_specificity': 0.971319, 'binary_f1_score': 0.56250006}
confusion matrix:
      0    1
0  5825  172
1    80  162
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 05:20:57.708414,epoch time: 0:18:23.787213,used: 0:18:23.787213,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9737582, 'precision': 0.9738519, 'recall': 0.97375727, 'specificity': 0.97375727, 'f1': 0.9737569, 'auroc': 0.996312, 'binary_precision': 0.96722364, 'binary_recall': 0.98075867, 'binary_specificity': 0.96675587, 'binary_f1_score': 0.9739441}
confusion matrix:
       0      1
0  28179    969
1    561  28595
---- Validation: 
scalar performance:
{'acc': 0.90758, 'precision': 0.5779103, 'recall': 0.7105415, 'specificity': 0.7105415, 'f1': 0.604159, 'auroc': 0.79234064, 'binary_precision': 0.17348704, 'binary_recall': 0.5, 'binary_specificity': 0.92108303, 'binary_f1_score': 0.2575952}
confusion matrix:
       0     1
0  16737  1434
1    301   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92803335, 'precision': 0.65723974, 'recall': 0.8594621, 'specificity': 0.8594621, 'f1': 0.70991975, 'auroc': 0.91442895, 'binary_precision': 0.32367972, 'binary_recall': 0.78512394, 'binary_specificity': 0.9338002, 'binary_f1_score': 0.4583836}
confusion matrix:
      0    1
0  5600  397
1    52  190
early stop counter: 1
val acc:0.9075800180435181, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 2,now: 2024-08-01 05:39:07.610508,epoch time: 0:18:09.902094,used: 0:36:33.689307,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.974753, 'precision': 0.9749956, 'recall': 0.9747507, 'specificity': 0.9747507, 'f1': 0.9747497, 'auroc': 0.99686474, 'binary_precision': 0.9643121, 'binary_recall': 0.9860073, 'binary_specificity': 0.9634941, 'binary_f1_score': 0.975039}
confusion matrix:
       0      1
0  28082   1064
1    408  28750
---- Validation: 
scalar performance:
{'acc': 0.8473339, 'precision': 0.54119104, 'recall': 0.67058694, 'specificity': 0.67058694, 'f1': 0.5421321, 'auroc': 0.7286072, 'binary_precision': 0.101969056, 'binary_recall': 0.48172757, 'binary_specificity': 0.85944635, 'binary_f1_score': 0.16831109}
confusion matrix:
       0     1
0  15617  2554
1    312   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8647219, 'precision': 0.5985195, 'recall': 0.8602356, 'specificity': 0.8602356, 'f1': 0.6269355, 'auroc': 0.9210707, 'binary_precision': 0.20374016, 'binary_recall': 0.8553719, 'binary_specificity': 0.8650992, 'binary_f1_score': 0.3290938}
confusion matrix:
      0    1
0  5188  809
1    35  207
early stop counter: 2
val acc:0.8473339080810547, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 3,now: 2024-08-01 05:57:39.227424,epoch time: 0:18:31.616916,used: 0:55:05.306223,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9718373, 'precision': 0.9720932, 'recall': 0.9718349, 'specificity': 0.9718349, 'f1': 0.97183335, 'auroc': 0.99586535, 'binary_precision': 0.9611517, 'binary_recall': 0.9834351, 'binary_specificity': 0.9602347, 'binary_f1_score': 0.97216576}
confusion matrix:
       0      1
0  27987   1159
1    483  28675
---- Validation: 
scalar performance:
{'acc': 0.8026421, 'precision': 0.52414507, 'recall': 0.6210002, 'specificity': 0.6210002, 'f1': 0.5053294, 'auroc': 0.618592, 'binary_precision': 0.071053356, 'binary_recall': 0.4269103, 'binary_specificity': 0.81509, 'binary_f1_score': 0.121829815}
confusion matrix:
       0     1
0  14811  3360
1    345   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6925789, 'precision': 0.5474698, 'recall': 0.78457, 'specificity': 0.78457, 'f1': 0.49656847, 'auroc': 0.9060329, 'binary_precision': 0.10171103, 'binary_recall': 0.88429755, 'binary_specificity': 0.6848424, 'binary_f1_score': 0.1824382}
confusion matrix:
      0     1
0  4107  1890
1    28   214
early stop counter: 3
val acc:0.8026421070098877, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 4,now: 2024-08-01 06:15:37.781369,epoch time: 0:17:58.553945,used: 1:13:03.860168,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9691788, 'precision': 0.96955884, 'recall': 0.96917635, 'specificity': 0.96917635, 'f1': 0.96917236, 'auroc': 0.9963753, 'binary_precision': 0.95624334, 'binary_recall': 0.9833659, 'binary_specificity': 0.9549868, 'binary_f1_score': 0.9696149}
confusion matrix:
       0      1
0  27835   1312
1    485  28672
---- Validation: 
scalar performance:
{'acc': 0.8711447, 'precision': 0.5426577, 'recall': 0.6483557, 'specificity': 0.6483557, 'f1': 0.54986894, 'auroc': 0.6201786, 'binary_precision': 0.106880136, 'binary_recall': 0.410299, 'binary_specificity': 0.88641244, 'binary_f1_score': 0.16958462}
confusion matrix:
       0     1
0  16107  2064
1    355   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81599617, 'precision': 0.57628655, 'recall': 0.8428205, 'specificity': 0.8428205, 'f1': 0.581773, 'auroc': 0.92123055, 'binary_precision': 0.15888554, 'binary_recall': 0.8719008, 'binary_specificity': 0.8137402, 'binary_f1_score': 0.26878983}
confusion matrix:
      0     1
0  4880  1117
1    31   211
early stop counter: 4
val acc:0.871144711971283, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 5,now: 2024-08-01 06:33:31.458145,epoch time: 0:17:53.676776,used: 1:30:57.536944,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8936951, 'precision': 0.90952766, 'recall': 0.89367825, 'specificity': 0.89367825, 'f1': 0.89265466, 'auroc': 0.99409914, 'binary_precision': 0.8290481, 'binary_recall': 0.9919745, 'binary_specificity': 0.795382, 'binary_f1_score': 0.9032228}
confusion matrix:
       0      1
0  23183   5964
1    234  28923
---- Validation: 
scalar performance:
{'acc': 0.44052628, 'precision': 0.49340922, 'recall': 0.44759566, 'specificity': 0.44759566, 'f1': 0.32658693, 'auroc': 0.5478077, 'binary_precision': 0.026222605, 'binary_recall': 0.4551495, 'binary_specificity': 0.4400418, 'binary_f1_score': 0.049588274}
confusion matrix:
      0      1
0  7996  10175
1   328    274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.21077095, 'precision': 0.52342236, 'recall': 0.5894614, 'specificity': 0.5894614, 'f1': 0.19651654, 'auroc': 0.8461929, 'binary_precision': 0.046844754, 'binary_recall': 1.0, 'binary_specificity': 0.17892279, 'binary_f1_score': 0.089497045}
confusion matrix:
      0     1
0  1073  4924
1     0   242
early stop counter: 5
val acc:0.4405262768268585, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 6,now: 2024-08-01 06:51:51.641856,epoch time: 0:18:20.183711,used: 1:49:17.720655,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94978046, 'precision': 0.95196295, 'recall': 0.9497757, 'specificity': 0.9497757, 'f1': 0.9497194, 'auroc': 0.99416625, 'binary_precision': 0.9205901, 'binary_recall': 0.9844972, 'binary_specificity': 0.9150542, 'binary_f1_score': 0.9514718}
confusion matrix:
       0      1
0  26672   2476
1    452  28704
---- Validation: 
scalar performance:
{'acc': 0.75821656, 'precision': 0.5170905, 'recall': 0.5996576, 'specificity': 0.5996576, 'f1': 0.48136172, 'auroc': 0.5570617, 'binary_precision': 0.058136925, 'binary_recall': 0.43023255, 'binary_specificity': 0.7690826, 'binary_f1_score': 0.10243227}
confusion matrix:
       0     1
0  13975  4196
1    343   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58150345, 'precision': 0.53624684, 'recall': 0.74067026, 'specificity': 0.74067026, 'f1': 0.4338732, 'auroc': 0.8838793, 'binary_precision': 0.07861971, 'binary_recall': 0.91322315, 'binary_specificity': 0.5681174, 'binary_f1_score': 0.14477563}
confusion matrix:
      0     1
0  3407  2590
1    21   221
early stop counter: 6
val acc:0.7582165598869324, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 7,now: 2024-08-01 07:09:58.699708,epoch time: 0:18:07.057852,used: 2:07:24.778507,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93189144, 'precision': 0.9373579, 'recall': 0.9318819, 'specificity': 0.9318819, 'f1': 0.931677, 'auroc': 0.9945264, 'binary_precision': 0.888505, 'binary_recall': 0.98775595, 'binary_specificity': 0.8760078, 'binary_f1_score': 0.93550533}
confusion matrix:
       0      1
0  25533   3614
1    357  28800
---- Validation: 
scalar performance:
{'acc': 0.6576466, 'precision': 0.5072807, 'recall': 0.552525, 'specificity': 0.552525, 'f1': 0.43303704, 'auroc': 0.5602888, 'binary_precision': 0.04169945, 'binary_recall': 0.44019935, 'binary_specificity': 0.6648506, 'binary_f1_score': 0.07618226}
confusion matrix:
       0     1
0  12081  6090
1    337   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4377304, 'precision': 0.5300524, 'recall': 0.69364125, 'specificity': 0.69364125, 'f1': 0.35272196, 'auroc': 0.88655347, 'binary_precision': 0.0629015, 'binary_recall': 0.9710744, 'binary_specificity': 0.41620812, 'binary_f1_score': 0.11814983}
confusion matrix:
      0     1
0  2496  3501
1     7   235
early stop counter: 7
val acc:0.6576465964317322, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 8,now: 2024-08-01 07:27:52.856322,epoch time: 0:17:54.156614,used: 2:25:18.935121,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91058934, 'precision': 0.9200784, 'recall': 0.91057384, 'specificity': 0.91057384, 'f1': 0.91007936, 'auroc': 0.99259734, 'binary_precision': 0.8569938, 'binary_recall': 0.9856986, 'binary_specificity': 0.8354491, 'binary_f1_score': 0.91685146}
confusion matrix:
       0      1
0  24350   4796
1    417  28741
---- Validation: 
scalar performance:
{'acc': 0.5583018, 'precision': 0.5004559, 'recall': 0.5036161, 'specificity': 0.5036161, 'f1': 0.3859886, 'auroc': 0.5349093, 'binary_precision': 0.032579627, 'binary_recall': 0.4451827, 'binary_specificity': 0.56204945, 'binary_f1_score': 0.060715906}
confusion matrix:
       0     1
0  10213  7958
1    334   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45231608, 'precision': 0.5299538, 'recall': 0.6952802, 'specificity': 0.6952802, 'f1': 0.3610463, 'auroc': 0.8505472, 'binary_precision': 0.063753776, 'binary_recall': 0.9586777, 'binary_specificity': 0.43188262, 'binary_f1_score': 0.119556814}
confusion matrix:
      0     1
0  2590  3407
1    10   232
early stop counter: 8
val acc:0.5583018064498901, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 9,now: 2024-08-01 07:45:59.884549,epoch time: 0:18:07.028227,used: 2:43:25.963348,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9751132, 'precision': 0.97528565, 'recall': 0.9751116, 'specificity': 0.9751116, 'f1': 0.9751109, 'auroc': 0.99648595, 'binary_precision': 0.96627396, 'binary_recall': 0.9846006, 'binary_specificity': 0.96562254, 'binary_f1_score': 0.97535115}
confusion matrix:
       0      1
0  28145   1002
1    449  28708
---- Validation: 
scalar performance:
{'acc': 0.8663506, 'precision': 0.5360466, 'recall': 0.6274091, 'specificity': 0.6274091, 'f1': 0.5394837, 'auroc': 0.5874727, 'binary_precision': 0.09511677, 'binary_recall': 0.37209302, 'binary_specificity': 0.88272524, 'binary_f1_score': 0.1515049}
confusion matrix:
       0     1
0  16040  2131
1    378   224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92450714, 'precision': 0.64647704, 'recall': 0.83383495, 'specificity': 0.83383495, 'f1': 0.69502294, 'auroc': 0.9069363, 'binary_precision': 0.30427352, 'binary_recall': 0.7355372, 'binary_specificity': 0.9321327, 'binary_f1_score': 0.4304716}
confusion matrix:
      0    1
0  5590  407
1    64  178
early stop counter: 9
val acc:0.8663505911827087, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 10,now: 2024-08-01 08:04:09.233078,epoch time: 0:18:09.348529,used: 3:01:35.311877,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.93295485, 'precision': 0.9386983, 'recall': 0.9329431, 'specificity': 0.9329431, 'f1': 0.9327334, 'auroc': 0.9957049, 'binary_precision': 0.88855374, 'binary_recall': 0.9901228, 'binary_specificity': 0.8757634, 'binary_f1_score': 0.93659264}
confusion matrix:
       0      1
0  25525   3621
1    288  28870
---- Validation: 
scalar performance:
{'acc': 0.59100837, 'precision': 0.50305355, 'recall': 0.5237233, 'specificity': 0.5237233, 'f1': 0.4021653, 'auroc': 0.58524376, 'binary_precision': 0.035695538, 'binary_recall': 0.45182723, 'binary_specificity': 0.5956194, 'binary_f1_score': 0.06616395}
confusion matrix:
       0     1
0  10823  7348
1    330   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39429396, 'precision': 0.52742296, 'recall': 0.66906387, 'specificity': 0.66906387, 'f1': 0.32553875, 'auroc': 0.8852506, 'binary_precision': 0.058426965, 'binary_recall': 0.96694213, 'binary_specificity': 0.3711856, 'binary_f1_score': 0.110195436}
confusion matrix:
      0     1
0  2226  3771
1     8   234
early stop counter: 10
val acc:0.5910083651542664, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 11,now: 2024-08-01 08:22:04.337451,epoch time: 0:17:55.104373,used: 3:19:30.416250,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9652511, 'precision': 0.96610093, 'recall': 0.9652467, 'specificity': 0.9652467, 'f1': 0.965235, 'auroc': 0.9966673, 'binary_precision': 0.94625, 'binary_recall': 0.986556, 'binary_specificity': 0.9439374, 'binary_f1_score': 0.96598274}
confusion matrix:
       0      1
0  27512   1634
1    392  28766
---- Validation: 
scalar performance:
{'acc': 0.8396101, 'precision': 0.5329071, 'recall': 0.63929343, 'specificity': 0.63929343, 'f1': 0.5284159, 'auroc': 0.6306982, 'binary_precision': 0.08764122, 'binary_recall': 0.42524916, 'binary_specificity': 0.85333776, 'binary_f1_score': 0.14533067}
confusion matrix:
       0     1
0  15506  2665
1    346   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80365443, 'precision': 0.567982, 'recall': 0.81459045, 'specificity': 0.81459045, 'f1': 0.5666409, 'auroc': 0.8913706, 'binary_precision': 0.14461316, 'binary_recall': 0.8264463, 'binary_specificity': 0.8027347, 'binary_f1_score': 0.24615385}
confusion matrix:
      0     1
0  4814  1183
1    42   200
early stop counter: 11
val acc:0.8396100997924805, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 12,now: 2024-08-01 08:40:05.962283,epoch time: 0:18:01.624832,used: 3:37:32.041082,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9295589, 'precision': 0.9361479, 'recall': 0.9295483, 'specificity': 0.9295483, 'f1': 0.9292906, 'auroc': 0.9961395, 'binary_precision': 0.8825829, 'binary_recall': 0.99097985, 'binary_specificity': 0.8681168, 'binary_f1_score': 0.9336456}
confusion matrix:
       0      1
0  25303   3844
1    263  28894
---- Validation: 
scalar performance:
{'acc': 0.62328875, 'precision': 0.50472224, 'recall': 0.53558, 'specificity': 0.53558, 'f1': 0.4168866, 'auroc': 0.5759289, 'binary_precision': 0.037989147, 'binary_recall': 0.44186047, 'binary_specificity': 0.62929946, 'binary_f1_score': 0.06996318}
confusion matrix:
       0     1
0  11435  6736
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45327777, 'precision': 0.5290803, 'recall': 0.6898322, 'specificity': 0.6898322, 'f1': 0.3610818, 'auroc': 0.87328845, 'binary_precision': 0.063137576, 'binary_recall': 0.946281, 'binary_specificity': 0.43338335, 'binary_f1_score': 0.118376836}
confusion matrix:
      0     1
0  2599  3398
1    13   229
early stop counter: 12
val acc:0.6232887506484985, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 13,now: 2024-08-01 08:58:23.167688,epoch time: 0:18:17.205405,used: 3:55:49.246487,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9121158, 'precision': 0.922382, 'recall': 0.9120971, 'specificity': 0.9120971, 'f1': 0.91157585, 'auroc': 0.9935064, 'binary_precision': 0.8565918, 'binary_recall': 0.9900202, 'binary_specificity': 0.834174, 'binary_f1_score': 0.9184855}
confusion matrix:
       0      1
0  24312   4833
1    291  28868
---- Validation: 
scalar performance:
{'acc': 0.5741224, 'precision': 0.5003762, 'recall': 0.5029549, 'specificity': 0.5029549, 'f1': 0.39253414, 'auroc': 0.54420495, 'binary_precision': 0.032502845, 'binary_recall': 0.4269103, 'binary_specificity': 0.5789995, 'binary_f1_score': 0.060406625}
confusion matrix:
       0     1
0  10521  7650
1    345   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.31094727, 'precision': 0.523911, 'recall': 0.6276916, 'specificity': 0.6276916, 'f1': 0.27044666, 'auroc': 0.75819296, 'binary_precision': 0.051910758, 'binary_recall': 0.9710744, 'binary_specificity': 0.28430882, 'binary_f1_score': 0.09855315}
confusion matrix:
      0     1
0  1705  4292
1     7   235
early stop counter: 13
val acc:0.574122428894043, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 14,now: 2024-08-01 09:16:16.236590,epoch time: 0:17:53.068902,used: 4:13:42.315389,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94261116, 'precision': 0.9461509, 'recall': 0.942602, 'specificity': 0.942602, 'f1': 0.9424963, 'auroc': 0.9953341, 'binary_precision': 0.9064626, 'binary_recall': 0.9871047, 'binary_specificity': 0.89809924, 'binary_f1_score': 0.9450665}
confusion matrix:
       0      1
0  26176   2970
1    376  28782
---- Validation: 
scalar performance:
{'acc': 0.75805676, 'precision': 0.5178613, 'recall': 0.6043933, 'specificity': 0.6043933, 'f1': 0.48231477, 'auroc': 0.6383047, 'binary_precision': 0.059284117, 'binary_recall': 0.44019935, 'binary_specificity': 0.7685873, 'binary_f1_score': 0.10449527}
confusion matrix:
       0     1
0  13966  4205
1    337   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5975317, 'precision': 0.53866655, 'recall': 0.754956, 'specificity': 0.754956, 'f1': 0.44380713, 'auroc': 0.8757917, 'binary_precision': 0.08244387, 'binary_recall': 0.92561984, 'binary_specificity': 0.5842922, 'binary_f1_score': 0.1514025}
confusion matrix:
      0     1
0  3504  2493
1    18   224
early stop counter: 14
val acc:0.7580567598342896, best validation acc: 0.939647376537323, corresponding to test acc:                         0.9596089124679565 / 0.9596089124679565
after epoch: 15,now: 2024-08-01 09:34:20.041301,epoch time: 0:18:03.804711,used: 4:31:46.120100,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_01_05_02_33_seed_2_23775360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:31:46.120100 at 2024-08-01 09:34:20.041301
persisted model performance metric: 

scalar performance:
{'acc': 0.9596089, 'precision': 0.735741, 'recall': 0.82037026, 'specificity': 0.82037026, 'f1': 0.7706636, 'auroc': 0.8921093, 'binary_precision': 0.48502994, 'binary_recall': 0.6694215, 'binary_specificity': 0.971319, 'binary_f1_score': 0.56250006}
confusion matrix:
      0    1
0  5825  172
1    80  162
oracle model performance metric: 

scalar performance:
{'acc': 0.9596089, 'precision': 0.735741, 'recall': 0.82037026, 'specificity': 0.82037026, 'f1': 0.7706636, 'auroc': 0.8921093, 'binary_precision': 0.48502994, 'binary_recall': 0.6694215, 'binary_specificity': 0.971319, 'binary_f1_score': 0.56250006}
confusion matrix:
      0    1
0  5825  172
1    80  162
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491221 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool | 401408 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491221 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool | 401408 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10880 MiB |    990 TiB |    990 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    988 TiB |    988 TiB |
|       from small pool |  88732 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11504 MiB |  11504 MiB |  32242 MiB |  20738 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32064 MiB |  20684 MiB |
|       from small pool |    124 MiB |    126 MiB |    178 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 635178 KiB |   1278 MiB | 460382 GiB | 460382 GiB |
|       from large pool | 626688 KiB |   1275 MiB | 457363 GiB | 457362 GiB |
|       from small pool |   8490 KiB |     26 MiB |   3019 GiB |   3019 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    8534    |  175961 K  |  175957 K  |
|       from large pool |      87    |     908    |   64023 K  |   64023 K  |
|       from small pool |    3630    |    8445    |  111938 K  |  111934 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    8534    |  175961 K  |  175957 K  |
|       from large pool |      87    |     908    |   64023 K  |   64023 K  |
|       from small pool |    3630    |    8445    |  111938 K  |  111934 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     410    |     410    |    1054    |     644    |
|       from large pool |     348    |     348    |     965    |     617    |
|       from small pool |      62    |      63    |      89    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3679    |   92821 K  |   92821 K  |
|       from large pool |      24    |     203    |   39511 K  |   39511 K  |
|       from small pool |      47    |    3653    |   53309 K  |   53309 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool |  16640 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool |  16640 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    990 TiB |    990 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    988 TiB |    988 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1100 MiB |  11504 MiB |  32242 MiB |  31142 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32064 MiB |  31060 MiB |
|       from small pool |     96 MiB |    126 MiB |    178 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 460383 GiB | 460383 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 457363 GiB | 457363 GiB |
|       from small pool |      0 KiB |     26 MiB |   3019 GiB |   3019 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8534    |  175961 K  |  175961 K  |
|       from large pool |       2    |     908    |   64023 K  |   64023 K  |
|       from small pool |       0    |    8445    |  111938 K  |  111938 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8534    |  175961 K  |  175961 K  |
|       from large pool |       2    |     908    |   64023 K  |   64023 K  |
|       from small pool |       0    |    8445    |  111938 K  |  111938 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     410    |    1054    |     972    |
|       from large pool |      34    |     348    |     965    |     931    |
|       from small pool |      48    |      63    |      89    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3679    |   92822 K  |   92822 K  |
|       from large pool |       4    |     203    |   39511 K  |   39511 K  |
|       from small pool |       0    |    3653    |   53311 K  |   53311 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Aug  1 09:35:34 2024]
Finished job 0.
1 of 1 steps (100%) done
