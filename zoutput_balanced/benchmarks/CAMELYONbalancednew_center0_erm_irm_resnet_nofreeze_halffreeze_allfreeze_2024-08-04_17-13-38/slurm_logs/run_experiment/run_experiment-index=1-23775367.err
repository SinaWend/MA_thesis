Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 07:32:17 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367

 Experiment start at: 2024-07-31 07:43:11.971925
before training, model accuracy: 0.31128156185150146
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9671025, 'precision': 0.9675409, 'recall': 0.9671149, 'specificity': 0.9671149, 'f1': 0.9670954, 'auroc': 0.99456346, 'binary_precision': 0.9820594, 'binary_recall': 0.9516427, 'binary_specificity': 0.98258716, 'binary_f1_score': 0.9666118}
confusion matrix:
       0      1
0  28158    499
1   1388  27315
---- Validation: 
scalar performance:
{'acc': 0.9520541, 'precision': 0.65574044, 'recall': 0.68565637, 'specificity': 0.68565637, 'f1': 0.66917, 'auroc': 0.8304155, 'binary_precision': 0.33290157, 'binary_recall': 0.39968896, 'binary_specificity': 0.9716238, 'binary_f1_score': 0.36325088}
confusion matrix:
       0    1
0  17634  515
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.7901226, 'recall': 0.8197471, 'specificity': 0.8197471, 'f1': 0.8041195, 'auroc': 0.88334656, 'binary_precision': 0.5951557, 'binary_recall': 0.65900385, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.62545455}
confusion matrix:
      0    1
0  5880  117
1    89  172
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 08:00:53.016400,epoch time: 0:17:41.044475,used: 0:17:41.044475,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9657601, 'precision': 0.96597207, 'recall': 0.96575236, 'specificity': 0.96575236, 'f1': 0.96575576, 'auroc': 0.99475, 'binary_precision': 0.9562161, 'binary_recall': 0.9762726, 'binary_specificity': 0.9552322, 'binary_f1_score': 0.9661402}
confusion matrix:
       0      1
0  27376   1283
1    681  28020
---- Validation: 
scalar performance:
{'acc': 0.9207109, 'precision': 0.58385444, 'recall': 0.6709297, 'specificity': 0.6709297, 'f1': 0.60804296, 'auroc': 0.7540153, 'binary_precision': 0.1897436, 'binary_recall': 0.40279937, 'binary_specificity': 0.93906003, 'binary_f1_score': 0.25796813}
confusion matrix:
       0     1
0  17043  1106
1    384   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493129, 'precision': 0.5940478, 'recall': 0.84625167, 'specificity': 0.84625167, 'f1': 0.6167229, 'auroc': 0.91197896, 'binary_precision': 0.19607843, 'binary_recall': 0.8429119, 'binary_specificity': 0.84959143, 'binary_f1_score': 0.31814894}
confusion matrix:
      0    1
0  5095  902
1    41  220
early stop counter: 1
val acc:0.9207109212875366, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 2,now: 2024-07-31 08:17:39.582154,epoch time: 0:16:46.565754,used: 0:34:27.610229,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94076014, 'precision': 0.945083, 'recall': 0.940719, 'specificity': 0.940719, 'f1': 0.9406121, 'auroc': 0.9958086, 'binary_precision': 0.9014277, 'binary_recall': 0.989862, 'binary_specificity': 0.89157593, 'binary_f1_score': 0.94357735}
confusion matrix:
       0      1
0  25549   3107
1    291  28413
---- Validation: 
scalar performance:
{'acc': 0.7019476, 'precision': 0.52125126, 'recall': 0.6356785, 'specificity': 0.6356785, 'f1': 0.46777722, 'auroc': 0.7033113, 'binary_precision': 0.06386348, 'binary_recall': 0.5645412, 'binary_specificity': 0.7068158, 'binary_f1_score': 0.114746325}
confusion matrix:
       0     1
0  12828  5321
1    280   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42297858, 'precision': 0.53082144, 'recall': 0.6824418, 'specificity': 0.6824418, 'f1': 0.34632447, 'auroc': 0.9243728, 'binary_precision': 0.06538661, 'binary_recall': 0.9655172, 'binary_specificity': 0.39936635, 'binary_f1_score': 0.12247874}
confusion matrix:
      0     1
0  2395  3602
1     9   252
early stop counter: 2
val acc:0.7019476294517517, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 3,now: 2024-07-31 08:34:57.233716,epoch time: 0:17:17.651562,used: 0:51:45.261791,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96488845, 'precision': 0.96569157, 'recall': 0.96487117, 'specificity': 0.96487117, 'f1': 0.9648723, 'auroc': 0.9969188, 'binary_precision': 0.94656, 'binary_recall': 0.9854724, 'binary_specificity': 0.94426996, 'binary_f1_score': 0.9656244}
confusion matrix:
       0      1
0  27059   1597
1    417  28287
---- Validation: 
scalar performance:
{'acc': 0.8599404, 'precision': 0.5415429, 'recall': 0.6462184, 'specificity': 0.6462184, 'f1': 0.5463579, 'auroc': 0.7224613, 'binary_precision': 0.10613862, 'binary_recall': 0.41679627, 'binary_specificity': 0.8756405, 'binary_f1_score': 0.16919191}
confusion matrix:
       0     1
0  15892  2257
1    375   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82134867, 'precision': 0.5845293, 'recall': 0.8518167, 'specificity': 0.8518167, 'f1': 0.59508693, 'auroc': 0.9240668, 'binary_precision': 0.17513268, 'binary_recall': 0.88505745, 'binary_specificity': 0.818576, 'binary_f1_score': 0.29240507}
confusion matrix:
      0     1
0  4909  1088
1    30   231
early stop counter: 3
val acc:0.8599404096603394, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 4,now: 2024-07-31 08:52:13.849301,epoch time: 0:17:16.615585,used: 1:09:01.877376,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.95977587, 'recall': 0.95831096, 'specificity': 0.95831096, 'f1': 0.95829916, 'auroc': 0.9963157, 'binary_precision': 0.9342223, 'binary_recall': 0.9861687, 'binary_specificity': 0.9304533, 'binary_f1_score': 0.9594929}
confusion matrix:
       0      1
0  26664   1993
1    397  28306
---- Validation: 
scalar performance:
{'acc': 0.78591955, 'precision': 0.5220403, 'recall': 0.6101469, 'specificity': 0.6101469, 'f1': 0.49844527, 'auroc': 0.6369635, 'binary_precision': 0.0690974, 'binary_recall': 0.4214619, 'binary_specificity': 0.7988319, 'binary_f1_score': 0.118729465}
confusion matrix:
       0     1
0  14498  3651
1    372   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5738255, 'precision': 0.5396294, 'recall': 0.74648917, 'specificity': 0.74648917, 'f1': 0.43488482, 'auroc': 0.93237674, 'binary_precision': 0.08431237, 'binary_recall': 0.9348659, 'binary_specificity': 0.5581124, 'binary_f1_score': 0.15467511}
confusion matrix:
      0     1
0  3347  2650
1    17   244
early stop counter: 4
val acc:0.7859195470809937, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 5,now: 2024-07-31 09:09:36.654323,epoch time: 0:17:22.805022,used: 1:26:24.682398,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9618898, 'precision': 0.9629227, 'recall': 0.96187425, 'specificity': 0.96187425, 'f1': 0.9618676, 'auroc': 0.9963392, 'binary_precision': 0.9412215, 'binary_recall': 0.98536533, 'binary_specificity': 0.93838316, 'binary_f1_score': 0.9627876}
confusion matrix:
       0      1
0  26895   1766
1    420  28279
---- Validation: 
scalar performance:
{'acc': 0.8784057, 'precision': 0.5482049, 'recall': 0.64827764, 'specificity': 0.64827764, 'f1': 0.55926347, 'auroc': 0.72517705, 'binary_precision': 0.119555146, 'binary_recall': 0.40124416, 'binary_specificity': 0.89531106, 'binary_f1_score': 0.18421994}
confusion matrix:
       0     1
0  16249  1900
1    385   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8478747, 'precision': 0.59471786, 'recall': 0.85283065, 'specificity': 0.85283065, 'f1': 0.6171788, 'auroc': 0.92492735, 'binary_precision': 0.19666374, 'binary_recall': 0.85823756, 'binary_specificity': 0.84742373, 'binary_f1_score': 0.31999996}
confusion matrix:
      0    1
0  5082  915
1    37  224
early stop counter: 5
val acc:0.8784056901931763, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 6,now: 2024-07-31 09:26:53.139406,epoch time: 0:17:16.485083,used: 1:43:41.167481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9537134, 'precision': 0.9553549, 'recall': 0.95369256, 'specificity': 0.95369256, 'f1': 0.95367014, 'auroc': 0.9952971, 'binary_precision': 0.9281886, 'binary_recall': 0.9835889, 'binary_specificity': 0.92379624, 'binary_f1_score': 0.95508605}
confusion matrix:
       0      1
0  26476   2184
1    471  28229
---- Validation: 
scalar performance:
{'acc': 0.79789275, 'precision': 0.5237408, 'recall': 0.6133454, 'specificity': 0.6133454, 'f1': 0.504525, 'auroc': 0.5963868, 'binary_precision': 0.07237734, 'binary_recall': 0.41524106, 'binary_specificity': 0.81144965, 'binary_f1_score': 0.12326871}
confusion matrix:
       0     1
0  14727  3422
1    376   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7155641, 'precision': 0.55633724, 'recall': 0.8057841, 'specificity': 0.8057841, 'f1': 0.51808494, 'auroc': 0.9166173, 'binary_precision': 0.1185334, 'binary_recall': 0.90421456, 'binary_specificity': 0.70735365, 'binary_f1_score': 0.20959146}
confusion matrix:
      0     1
0  4242  1755
1    25   236
early stop counter: 6
val acc:0.7978927493095398, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 7,now: 2024-07-31 09:44:17.737266,epoch time: 0:17:24.597860,used: 2:01:05.765341,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90357393, 'precision': 0.9173454, 'recall': 0.9035043, 'specificity': 0.9035043, 'f1': 0.9027609, 'auroc': 0.9954593, 'binary_precision': 0.84172493, 'binary_recall': 0.99425125, 'binary_specificity': 0.8127574, 'binary_f1_score': 0.91165245}
confusion matrix:
       0      1
0  23292   5366
1    165  28537
---- Validation: 
scalar performance:
{'acc': 0.48286504, 'precision': 0.49738726, 'recall': 0.48025316, 'specificity': 0.48025316, 'f1': 0.35141465, 'auroc': 0.5889137, 'binary_precision': 0.031685416, 'binary_recall': 0.47744945, 'binary_specificity': 0.4830569, 'binary_f1_score': 0.05942702}
confusion matrix:
      0     1
0  8767  9382
1   336   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.22291467, 'precision': 0.52494055, 'recall': 0.5927149, 'specificity': 0.5927149, 'f1': 0.2074198, 'auroc': 0.92311674, 'binary_precision': 0.05076142, 'binary_recall': 0.99616855, 'binary_specificity': 0.1892613, 'binary_f1_score': 0.096600406}
confusion matrix:
      0     1
0  1135  4862
1     1   260
early stop counter: 7
val acc:0.48286503553390503, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 8,now: 2024-07-31 10:01:53.830333,epoch time: 0:17:36.093067,used: 2:18:41.858408,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9063459, 'precision': 0.9179279, 'recall': 0.906285, 'specificity': 0.906285, 'f1': 0.9056832, 'auroc': 0.9941611, 'binary_precision': 0.8485374, 'binary_recall': 0.9894429, 'binary_specificity': 0.8231271, 'binary_f1_score': 0.913589}
confusion matrix:
       0      1
0  23590   5069
1    303  28398
---- Validation: 
scalar performance:
{'acc': 0.50920606, 'precision': 0.49750534, 'recall': 0.48113936, 'specificity': 0.48113936, 'f1': 0.36358804, 'auroc': 0.54947746, 'binary_precision': 0.031659387, 'binary_recall': 0.45101088, 'binary_specificity': 0.51126784, 'binary_f1_score': 0.05916556}
confusion matrix:
      0     1
0  9279  8870
1   353   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.26925534, 'precision': 0.52655333, 'recall': 0.61689365, 'specificity': 0.61689365, 'f1': 0.24302138, 'auroc': 0.89556336, 'binary_precision': 0.053807948, 'binary_recall': 0.99616855, 'binary_specificity': 0.2376188, 'binary_f1_score': 0.10210093}
confusion matrix:
      0     1
0  1425  4572
1     1   260
early stop counter: 8
val acc:0.5092060565948486, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 9,now: 2024-07-31 10:19:18.593918,epoch time: 0:17:24.763585,used: 2:36:06.621993,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9002092, 'precision': 0.9141982, 'recall': 0.90013874, 'specificity': 0.90013874, 'f1': 0.8993479, 'auroc': 0.9948795, 'binary_precision': 0.83826995, 'binary_recall': 0.99195176, 'binary_specificity': 0.80832577, 'binary_f1_score': 0.9086586}
confusion matrix:
       0      1
0  23165   5493
1    231  28471
---- Validation: 
scalar performance:
{'acc': 0.5187846, 'precision': 0.49835756, 'recall': 0.48759842, 'specificity': 0.48759842, 'f1': 0.36860088, 'auroc': 0.56418574, 'binary_precision': 0.032502227, 'binary_recall': 0.4541213, 'binary_specificity': 0.52107555, 'binary_f1_score': 0.06066272}
confusion matrix:
      0     1
0  9457  8692
1   351   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.24113135, 'precision': 0.5255585, 'recall': 0.6022197, 'specificity': 0.6022197, 'f1': 0.22169241, 'auroc': 0.9082613, 'binary_precision': 0.051916935, 'binary_recall': 0.99616855, 'binary_specificity': 0.2082708, 'binary_f1_score': 0.098690465}
confusion matrix:
      0     1
0  1249  4748
1     1   260
early stop counter: 9
val acc:0.5187845826148987, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 10,now: 2024-07-31 10:36:27.992113,epoch time: 0:17:09.398195,used: 2:53:16.020188,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91365063, 'precision': 0.92421365, 'recall': 0.9135792, 'specificity': 0.9135792, 'f1': 0.91309965, 'auroc': 0.99576247, 'binary_precision': 0.8574998, 'binary_recall': 0.9923709, 'binary_specificity': 0.8347875, 'binary_f1_score': 0.9200187}
confusion matrix:
       0      1
0  23920   4734
1    219  28487
---- Validation: 
scalar performance:
{'acc': 0.55906767, 'precision': 0.50083303, 'recall': 0.5062034, 'specificity': 0.5062034, 'f1': 0.3883489, 'auroc': 0.5638983, 'binary_precision': 0.035153873, 'binary_recall': 0.44945568, 'binary_specificity': 0.56295115, 'binary_f1_score': 0.06520758}
confusion matrix:
       0     1
0  10217  7932
1    354   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.25519335, 'precision': 0.5260491, 'recall': 0.6095567, 'specificity': 0.6095567, 'f1': 0.23246011, 'auroc': 0.902479, 'binary_precision': 0.05284553, 'binary_recall': 0.99616855, 'binary_specificity': 0.22294481, 'binary_f1_score': 0.10036673}
confusion matrix:
      0     1
0  1337  4660
1     1   260
early stop counter: 10
val acc:0.5590676665306091, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 11,now: 2024-07-31 10:53:35.777559,epoch time: 0:17:07.785446,used: 3:10:23.805634,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92712694, 'precision': 0.93395734, 'recall': 0.92707455, 'specificity': 0.92707455, 'f1': 0.9268329, 'auroc': 0.9948646, 'binary_precision': 0.87972254, 'binary_recall': 0.98968786, 'binary_specificity': 0.8644612, 'binary_f1_score': 0.93147093}
confusion matrix:
       0      1
0  24772   3884
1    296  28408
---- Validation: 
scalar performance:
{'acc': 0.63378036, 'precision': 0.5058838, 'recall': 0.5411329, 'specificity': 0.5411329, 'f1': 0.42393082, 'auroc': 0.5602938, 'binary_precision': 0.041721758, 'binary_recall': 0.44167963, 'binary_specificity': 0.64058626, 'binary_f1_score': 0.076241605}
confusion matrix:
       0     1
0  11626  6523
1    359   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3988495, 'precision': 0.53012246, 'recall': 0.6735168, 'specificity': 0.6735168, 'f1': 0.33137417, 'auroc': 0.8985163, 'binary_precision': 0.06335744, 'binary_recall': 0.97318006, 'binary_specificity': 0.3738536, 'binary_f1_score': 0.118969545}
confusion matrix:
      0     1
0  2242  3755
1     7   254
early stop counter: 11
val acc:0.6337803602218628, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 12,now: 2024-07-31 11:11:14.994912,epoch time: 0:17:39.217353,used: 3:28:03.022987,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9408124, 'precision': 0.9452183, 'recall': 0.94077265, 'specificity': 0.94077265, 'f1': 0.9406619, 'auroc': 0.99621755, 'binary_precision': 0.90112853, 'binary_recall': 0.9903843, 'binary_specificity': 0.89116096, 'binary_f1_score': 0.9436505}
confusion matrix:
       0      1
0  25538   3119
1    276  28427
---- Validation: 
scalar performance:
{'acc': 0.6704981, 'precision': 0.508495, 'recall': 0.55639195, 'specificity': 0.55639195, 'f1': 0.44092473, 'auroc': 0.57118547, 'binary_precision': 0.04568528, 'binary_recall': 0.43390357, 'binary_specificity': 0.6788804, 'binary_f1_score': 0.08266667}
confusion matrix:
       0     1
0  12321  5828
1    364   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46324703, 'precision': 0.53543454, 'recall': 0.7162787, 'specificity': 0.7162787, 'f1': 0.37239516, 'auroc': 0.92503726, 'binary_precision': 0.071626104, 'binary_recall': 0.99233717, 'binary_specificity': 0.44022012, 'binary_f1_score': 0.13360845}
confusion matrix:
      0     1
0  2640  3357
1     2   259
early stop counter: 12
val acc:0.6704980731010437, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 13,now: 2024-07-31 11:28:33.895091,epoch time: 0:17:18.900179,used: 3:45:21.923166,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95163876, 'precision': 0.9543117, 'recall': 0.9516095, 'specificity': 0.9516095, 'f1': 0.9515653, 'auroc': 0.99652004, 'binary_precision': 0.91965556, 'binary_recall': 0.9898265, 'binary_specificity': 0.9133924, 'binary_f1_score': 0.9534517}
confusion matrix:
       0      1
0  26176   2482
1    292  28410
---- Validation: 
scalar performance:
{'acc': 0.72557473, 'precision': 0.5146051, 'recall': 0.5871561, 'specificity': 0.5871561, 'f1': 0.46836752, 'auroc': 0.5910985, 'binary_precision': 0.055533674, 'binary_recall': 0.43856922, 'binary_specificity': 0.73574305, 'binary_f1_score': 0.09858416}
confusion matrix:
       0     1
0  13353  4796
1    361   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5712688, 'precision': 0.53967637, 'recall': 0.74698746, 'specificity': 0.74698746, 'f1': 0.43363056, 'auroc': 0.9264263, 'binary_precision': 0.084134616, 'binary_recall': 0.93869734, 'binary_specificity': 0.55527765, 'binary_f1_score': 0.15442799}
confusion matrix:
      0     1
0  3330  2667
1    16   245
early stop counter: 13
val acc:0.7255747318267822, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 14,now: 2024-07-31 11:45:40.153108,epoch time: 0:17:06.258017,used: 4:02:28.181183,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.89086473, 'precision': 0.90744126, 'recall': 0.8907839, 'specificity': 0.8907839, 'f1': 0.88972867, 'auroc': 0.99290377, 'binary_precision': 0.825459, 'binary_recall': 0.9915688, 'binary_specificity': 0.78999895, 'binary_f1_score': 0.90092117}
confusion matrix:
       0      1
0  22639   6018
1    242  28461
---- Validation: 
scalar performance:
{'acc': 0.43843123, 'precision': 0.49336413, 'recall': 0.45049867, 'specificity': 0.45049867, 'f1': 0.32712606, 'auroc': 0.5355482, 'binary_precision': 0.028364744, 'binary_recall': 0.46345258, 'binary_specificity': 0.43754476, 'binary_f1_score': 0.05345771}
confusion matrix:
      0      1
0  7941  10208
1   345    298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.20645574, 'precision': 0.52439636, 'recall': 0.5841273, 'specificity': 0.5841273, 'f1': 0.1941928, 'auroc': 0.8934183, 'binary_precision': 0.049760766, 'binary_recall': 0.99616855, 'binary_specificity': 0.17208605, 'binary_f1_score': 0.09478673}
confusion matrix:
      0     1
0  1032  4965
1     1   260
early stop counter: 14
val acc:0.4384312331676483, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 15,now: 2024-07-31 12:02:50.447588,epoch time: 0:17:10.294480,used: 4:19:38.475663,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_43_11_seed_0_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:19:38.475663 at 2024-07-31 12:02:50.447588
persisted model performance metric: 

scalar performance:
{'acc': 0.96708214, 'precision': 0.7901226, 'recall': 0.8197471, 'specificity': 0.8197471, 'f1': 0.8041195, 'auroc': 0.88334656, 'binary_precision': 0.5951557, 'binary_recall': 0.65900385, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.62545455}
confusion matrix:
      0    1
0  5880  117
1    89  172
oracle model performance metric: 

scalar performance:
{'acc': 0.96708214, 'precision': 0.7901226, 'recall': 0.8197471, 'specificity': 0.8197471, 'f1': 0.8041195, 'auroc': 0.88334656, 'binary_precision': 0.5951557, 'binary_recall': 0.65900385, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.62545455}
confusion matrix:
      0    1
0  5880  117
1    89  172
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool | 403328 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |  89819 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool | 403328 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |  89819 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB | 329615 GiB | 329615 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |  88733 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11486 MiB |  11486 MiB |  11486 MiB |      0 B   |
|       from large pool |  11360 MiB |  11360 MiB |  11360 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 752036 KiB |   1278 MiB | 126734 GiB | 126733 GiB |
|       from large pool | 741504 KiB |   1275 MiB | 125764 GiB | 125763 GiB |
|       from small pool |  10532 KiB |     11 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    8416    |   57546 K  |   57542 K  |
|       from large pool |      87    |     908    |   20828 K  |   20828 K  |
|       from small pool |    3642    |    8327    |   36718 K  |   36714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    8416    |   57546 K  |   57542 K  |
|       from large pool |      87    |     908    |   20828 K  |   20828 K  |
|       from small pool |    3642    |    8327    |   36718 K  |   36714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     406    |     406    |     406    |       0    |
|       from large pool |     343    |     343    |     343    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3617    |   31097 K  |   31097 K  |
|       from large pool |      19    |     188    |   13602 K  |   13602 K  |
|       from small pool |      54    |    3596    |   17494 K  |   17494 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 329615 GiB | 329615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |      0 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11486 MiB |  11486 MiB |  10270 MiB |
|       from large pool |   1118 MiB |  11360 MiB |  11360 MiB |  10242 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 126734 GiB | 126734 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 125764 GiB | 125764 GiB |
|       from small pool |      0 KiB |     22 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     406    |     406    |     327    |
|       from large pool |      30    |     343    |     343    |     313    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3617    |   31098 K  |   31098 K  |
|       from large pool |       4    |     188    |   13602 K  |   13602 K  |
|       from small pool |       0    |    3596    |   17496 K  |   17496 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 329615 GiB | 329615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |      0 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11486 MiB |  11486 MiB |  10270 MiB |
|       from large pool |   1118 MiB |  11360 MiB |  11360 MiB |  10242 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 126734 GiB | 126734 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 125764 GiB | 125764 GiB |
|       from small pool |      0 KiB |     22 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     406    |     406    |     327    |
|       from large pool |      30    |     343    |     343    |     313    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3617    |   31098 K  |   31098 K  |
|       from large pool |       4    |     188    |   13602 K  |   13602 K  |
|       from small pool |       0    |    3596    |   17496 K  |   17496 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367

 Experiment start at: 2024-07-31 12:12:00.722157
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96495765, 'precision': 0.96505237, 'recall': 0.96496296, 'specificity': 0.96496296, 'f1': 0.9649561, 'auroc': 0.9932213, 'binary_precision': 0.9718741, 'binary_recall': 0.9576815, 'binary_specificity': 0.97224444, 'binary_f1_score': 0.96472555}
confusion matrix:
       0      1
0  27988    799
1   1220  27609
---- Validation: 
scalar performance:
{'acc': 0.9332444, 'precision': 0.6113572, 'recall': 0.6828483, 'specificity': 0.6828483, 'f1': 0.6363119, 'auroc': 0.78084725, 'binary_precision': 0.24514991, 'binary_recall': 0.41307577, 'binary_specificity': 0.9526208, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  17211  856
1    395  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9394135, 'precision': 0.6803641, 'recall': 0.8120682, 'specificity': 0.8120682, 'f1': 0.7249592, 'auroc': 0.86702573, 'binary_precision': 0.37553647, 'binary_recall': 0.6730769, 'binary_specificity': 0.9510595, 'binary_f1_score': 0.48209366}
confusion matrix:
      0    1
0  5655  291
1    85  175
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 12:29:47.269601,epoch time: 0:17:46.547444,used: 0:17:46.547444,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95745975, 'precision': 0.9583974, 'recall': 0.9574426, 'specificity': 0.9574426, 'f1': 0.9574368, 'auroc': 0.99442065, 'binary_precision': 0.93785477, 'binary_recall': 0.97991675, 'binary_specificity': 0.9349684, 'binary_f1_score': 0.95842445}
confusion matrix:
       0      1
0  26914   1872
1    579  28251
---- Validation: 
scalar performance:
{'acc': 0.8540555, 'precision': 0.5438705, 'recall': 0.6539385, 'specificity': 0.6539385, 'f1': 0.5486837, 'auroc': 0.71694386, 'binary_precision': 0.1112368, 'binary_recall': 0.4383358, 'binary_specificity': 0.86954117, 'binary_f1_score': 0.17744361}
confusion matrix:
       0     1
0  15710  2357
1    378   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8293587, 'precision': 0.58582914, 'recall': 0.842906, 'specificity': 0.842906, 'f1': 0.59962595, 'auroc': 0.91789377, 'binary_precision': 0.17911647, 'binary_recall': 0.8576923, 'binary_specificity': 0.82811975, 'binary_f1_score': 0.29634553}
confusion matrix:
      0     1
0  4924  1022
1    37   223
early stop counter: 1
val acc:0.8540555238723755, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 2,now: 2024-07-31 12:47:22.286577,epoch time: 0:17:35.016976,used: 0:35:21.564420,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9471501, 'precision': 0.950127, 'recall': 0.9471191, 'specificity': 0.9471191, 'f1': 0.94706, 'auroc': 0.99536824, 'binary_precision': 0.9137118, 'binary_recall': 0.98765177, 'binary_specificity': 0.9065865, 'binary_f1_score': 0.949244}
confusion matrix:
       0      1
0  26097   2689
1    356  28474
---- Validation: 
scalar performance:
{'acc': 0.6534685, 'precision': 0.5089819, 'recall': 0.55849224, 'specificity': 0.55849224, 'f1': 0.43628308, 'auroc': 0.6180321, 'binary_precision': 0.04770785, 'binary_recall': 0.45616642, 'binary_specificity': 0.66081804, 'binary_f1_score': 0.08638155}
confusion matrix:
       0     1
0  11939  6128
1    366   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52078635, 'precision': 0.53662664, 'recall': 0.72784805, 'specificity': 0.72784805, 'f1': 0.40517586, 'auroc': 0.9296812, 'binary_precision': 0.077258565, 'binary_recall': 0.95384616, 'binary_specificity': 0.50185, 'binary_f1_score': 0.14293948}
confusion matrix:
      0     1
0  2984  2962
1    12   248
early stop counter: 2
val acc:0.6534684896469116, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 3,now: 2024-07-31 13:04:48.738364,epoch time: 0:17:26.451787,used: 0:52:48.016207,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95237434, 'precision': 0.95422614, 'recall': 0.95235115, 'specificity': 0.95235115, 'f1': 0.95232403, 'auroc': 0.9951596, 'binary_precision': 0.92540526, 'binary_recall': 0.9841479, 'binary_specificity': 0.9205544, 'binary_f1_score': 0.95387304}
confusion matrix:
       0      1
0  26500   2287
1    457  28372
---- Validation: 
scalar performance:
{'acc': 0.7455176, 'precision': 0.5170109, 'recall': 0.59192586, 'specificity': 0.59192586, 'f1': 0.4795172, 'auroc': 0.5982363, 'binary_precision': 0.061456103, 'binary_recall': 0.42644873, 'binary_specificity': 0.757403, 'binary_f1_score': 0.10743028}
confusion matrix:
       0     1
0  13684  4383
1    386   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63889784, 'precision': 0.5454989, 'recall': 0.7710962, 'specificity': 0.7710962, 'f1': 0.47202158, 'auroc': 0.9229301, 'binary_precision': 0.09686609, 'binary_recall': 0.9153846, 'binary_specificity': 0.6268079, 'binary_f1_score': 0.17519324}
confusion matrix:
      0     1
0  3727  2219
1    22   238
early stop counter: 3
val acc:0.7455176115036011, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 4,now: 2024-07-31 13:22:16.942677,epoch time: 0:17:28.204313,used: 1:10:16.220520,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9178874, 'precision': 0.92619336, 'recall': 0.91783655, 'specificity': 0.91783655, 'f1': 0.9174786, 'auroc': 0.9938513, 'binary_precision': 0.8668778, 'binary_recall': 0.9875473, 'binary_specificity': 0.8481259, 'binary_f1_score': 0.9232865}
confusion matrix:
       0      1
0  24415   4372
1    359  28470
---- Validation: 
scalar performance:
{'acc': 0.5635005, 'precision': 0.50066024, 'recall': 0.5046799, 'specificity': 0.5046799, 'f1': 0.39137107, 'auroc': 0.5583052, 'binary_precision': 0.03666214, 'binary_recall': 0.44130757, 'binary_specificity': 0.56805223, 'binary_f1_score': 0.06770002}
confusion matrix:
       0     1
0  10263  7804
1    376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36255237, 'precision': 0.5308349, 'recall': 0.6673394, 'specificity': 0.6673394, 'f1': 0.30884364, 'auroc': 0.93765944, 'binary_precision': 0.06166983, 'binary_recall': 1.0, 'binary_specificity': 0.33467877, 'binary_f1_score': 0.11617516}
confusion matrix:
      0     1
0  1990  3956
1     0   260
early stop counter: 4
val acc:0.5635005235671997, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 5,now: 2024-07-31 13:39:41.853892,epoch time: 0:17:24.911215,used: 1:27:41.131735,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.91059774, 'precision': 0.92032075, 'recall': 0.91054237, 'specificity': 0.91054237, 'f1': 0.9100697, 'auroc': 0.99294496, 'binary_precision': 0.8565749, 'binary_recall': 0.98650664, 'binary_specificity': 0.8345781, 'binary_f1_score': 0.9169609}
confusion matrix:
       0      1
0  24025   4762
1    389  28440
---- Validation: 
scalar performance:
{'acc': 0.5567236, 'precision': 0.5003649, 'recall': 0.5025957, 'specificity': 0.5025957, 'f1': 0.38822228, 'auroc': 0.549773, 'binary_precision': 0.03632167, 'binary_recall': 0.44427934, 'binary_specificity': 0.56091213, 'binary_f1_score': 0.06715328}
confusion matrix:
       0     1
0  10134  7933
1    374   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3101837, 'precision': 0.5282306, 'recall': 0.6381711, 'specificity': 0.6381711, 'f1': 0.27280575, 'auroc': 0.92142224, 'binary_precision': 0.057061028, 'binary_recall': 0.99615383, 'binary_specificity': 0.28018835, 'binary_f1_score': 0.10793915}
confusion matrix:
      0     1
0  1666  4280
1     1   259
early stop counter: 5
val acc:0.5567235946655273, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 6,now: 2024-07-31 13:58:05.395253,epoch time: 0:18:23.541361,used: 1:46:04.673096,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95358926, 'precision': 0.95564497, 'recall': 0.9535661, 'specificity': 0.9535661, 'f1': 0.95353514, 'auroc': 0.99591124, 'binary_precision': 0.925213, 'binary_recall': 0.9870265, 'binary_specificity': 0.9201056, 'binary_f1_score': 0.9551206}
confusion matrix:
       0      1
0  26488   2300
1    374  28454
---- Validation: 
scalar performance:
{'acc': 0.7953575, 'precision': 0.5249664, 'recall': 0.61491305, 'specificity': 0.61491305, 'f1': 0.5063363, 'auroc': 0.58805895, 'binary_precision': 0.07591201, 'binary_recall': 0.4205052, 'binary_specificity': 0.80932087, 'binary_f1_score': 0.12860714}
confusion matrix:
       0     1
0  14622  3445
1    390   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66145664, 'precision': 0.549426, 'recall': 0.78838587, 'specificity': 0.78838587, 'f1': 0.48642477, 'auroc': 0.9208498, 'binary_precision': 0.103745155, 'binary_recall': 0.9269231, 'binary_specificity': 0.64984864, 'binary_f1_score': 0.18660472}
confusion matrix:
      0     1
0  3864  2082
1    19   241
early stop counter: 6
val acc:0.7953575253486633, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 7,now: 2024-07-31 14:15:28.768156,epoch time: 0:17:23.372903,used: 2:03:28.045999,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9069529, 'precision': 0.91729784, 'recall': 0.9068929, 'specificity': 0.9068929, 'f1': 0.9063636, 'auroc': 0.99246246, 'binary_precision': 0.85178524, 'binary_recall': 0.9855359, 'binary_specificity': 0.8282499, 'binary_f1_score': 0.9137923}
confusion matrix:
       0      1
0  23842   4944
1    417  28413
---- Validation: 
scalar performance:
{'acc': 0.6104589, 'precision': 0.5040359, 'recall': 0.52760315, 'specificity': 0.52760315, 'f1': 0.4140366, 'auroc': 0.55814195, 'binary_precision': 0.04087571, 'binary_recall': 0.4383358, 'binary_specificity': 0.6168705, 'binary_f1_score': 0.0747782}
confusion matrix:
       0     1
0  11145  6922
1    378   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.306961, 'precision': 0.5273022, 'recall': 0.6328113, 'specificity': 0.6328113, 'f1': 0.2703026, 'auroc': 0.90627766, 'binary_precision': 0.056421515, 'binary_recall': 0.98846155, 'binary_specificity': 0.27716112, 'binary_f1_score': 0.10674974}
confusion matrix:
      0     1
0  1648  4298
1     3   257
early stop counter: 7
val acc:0.6104589104652405, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 8,now: 2024-07-31 14:32:46.645668,epoch time: 0:17:17.877512,used: 2:20:45.923511,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9147112, 'precision': 0.92325336, 'recall': 0.9146595, 'specificity': 0.9146595, 'f1': 0.91427153, 'auroc': 0.99307036, 'binary_precision': 0.8633063, 'binary_recall': 0.98560476, 'binary_specificity': 0.8437142, 'binary_f1_score': 0.9204107}
confusion matrix:
       0      1
0  24288   4499
1    415  28414
---- Validation: 
scalar performance:
{'acc': 0.5900747, 'precision': 0.50306094, 'recall': 0.521323, 'specificity': 0.521323, 'f1': 0.40477598, 'auroc': 0.5611884, 'binary_precision': 0.03954802, 'binary_recall': 0.4472511, 'binary_specificity': 0.5953949, 'binary_f1_score': 0.07267021}
confusion matrix:
       0     1
0  10757  7310
1    372   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41556558, 'precision': 0.53246486, 'recall': 0.6894881, 'specificity': 0.6894881, 'f1': 0.34280223, 'auroc': 0.909237, 'binary_precision': 0.066220045, 'binary_recall': 0.98846155, 'binary_specificity': 0.39051464, 'binary_f1_score': 0.12412461}
confusion matrix:
      0     1
0  2322  3624
1     3   257
early stop counter: 8
val acc:0.5900747179985046, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 9,now: 2024-07-31 14:50:43.399536,epoch time: 0:17:56.753868,used: 2:38:42.677379,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9095564, 'precision': 0.9202104, 'recall': 0.90950114, 'specificity': 0.90950114, 'f1': 0.9089713, 'auroc': 0.99348205, 'binary_precision': 0.85347384, 'binary_recall': 0.9890384, 'binary_specificity': 0.82996386, 'binary_f1_score': 0.916269}
confusion matrix:
       0      1
0  23893   4895
1    316  28512
---- Validation: 
scalar performance:
{'acc': 0.5245998, 'precision': 0.4985429, 'recall': 0.4895119, 'specificity': 0.4895119, 'f1': 0.37264308, 'auroc': 0.5646831, 'binary_precision': 0.034373585, 'binary_recall': 0.45170876, 'binary_specificity': 0.527315, 'binary_f1_score': 0.063885674}
confusion matrix:
      0     1
0  9527  8540
1   369   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.28230745, 'precision': 0.5275774, 'recall': 0.62546253, 'specificity': 0.62546253, 'f1': 0.25286335, 'auroc': 0.9212103, 'binary_precision': 0.055154856, 'binary_recall': 1.0, 'binary_specificity': 0.250925, 'binary_f1_score': 0.10454363}
confusion matrix:
      0     1
0  1492  4454
1     0   260
early stop counter: 9
val acc:0.5245997905731201, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 10,now: 2024-07-31 15:08:21.185849,epoch time: 0:17:37.786313,used: 2:56:20.463692,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8792523, 'precision': 0.8988159, 'recall': 0.8791754, 'specificity': 0.8791754, 'f1': 0.87773764, 'auroc': 0.9928651, 'binary_precision': 0.8106588, 'binary_recall': 0.98987097, 'binary_specificity': 0.76847994, 'binary_f1_score': 0.89134616}
confusion matrix:
       0      1
0  22123   6665
1    292  28536
---- Validation: 
scalar performance:
{'acc': 0.44786552, 'precision': 0.49296945, 'recall': 0.44971555, 'specificity': 0.44971555, 'f1': 0.3327075, 'auroc': 0.55127734, 'binary_precision': 0.029566232, 'binary_recall': 0.45170876, 'binary_specificity': 0.44772238, 'binary_f1_score': 0.05549977}
confusion matrix:
      0     1
0  8089  9978
1   369   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.19722849, 'precision': 0.5247997, 'recall': 0.5810629, 'specificity': 0.5810629, 'f1': 0.1867635, 'auroc': 0.9185678, 'binary_precision': 0.04959939, 'binary_recall': 1.0, 'binary_specificity': 0.1621258, 'binary_f1_score': 0.094511084}
confusion matrix:
     0     1
0  964  4982
1    0   260
early stop counter: 10
val acc:0.4478655159473419, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 11,now: 2024-07-31 15:27:15.251509,epoch time: 0:18:54.065660,used: 3:15:14.529352,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8782109, 'precision': 0.8990207, 'recall': 0.8781277, 'specificity': 0.8781277, 'f1': 0.8765851, 'auroc': 0.9933312, 'binary_precision': 0.8080791, 'binary_recall': 0.99226475, 'binary_specificity': 0.7639907, 'binary_f1_score': 0.89075035}
confusion matrix:
       0      1
0  21993   6794
1    223  28606
---- Validation: 
scalar performance:
{'acc': 0.4425827, 'precision': 0.4928698, 'recall': 0.44912156, 'specificity': 0.44912156, 'f1': 0.33006653, 'auroc': 0.5568672, 'binary_precision': 0.029556176, 'binary_recall': 0.45616642, 'binary_specificity': 0.4420767, 'binary_f1_score': 0.055515368}
confusion matrix:
      0      1
0  7987  10080
1   366    307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.14212053, 'precision': 0.5232808, 'recall': 0.5523041, 'specificity': 0.5523041, 'f1': 0.13919166, 'auroc': 0.91445446, 'binary_precision': 0.046561606, 'binary_recall': 1.0, 'binary_specificity': 0.10460814, 'binary_f1_score': 0.08898015}
confusion matrix:
     0     1
0  622  5324
1    0   260
early stop counter: 11
val acc:0.4425826966762543, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 12,now: 2024-07-31 15:45:49.933286,epoch time: 0:18:34.681777,used: 3:33:49.211129,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.94102335, 'precision': 0.94517255, 'recall': 0.94098824, 'specificity': 0.94098824, 'f1': 0.9408823, 'auroc': 0.9953004, 'binary_precision': 0.90237653, 'binary_recall': 0.9891429, 'binary_specificity': 0.8928336, 'binary_f1_score': 0.94376963}
confusion matrix:
       0      1
0  25702   3085
1    313  28516
---- Validation: 
scalar performance:
{'acc': 0.7387407, 'precision': 0.51632357, 'recall': 0.5898417, 'specificity': 0.5898417, 'f1': 0.47630936, 'auroc': 0.58396804, 'binary_precision': 0.060195792, 'binary_recall': 0.4294205, 'binary_specificity': 0.7502629, 'binary_f1_score': 0.10559006}
confusion matrix:
       0     1
0  13555  4512
1    384   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6392201, 'precision': 0.54613155, 'recall': 0.7749424, 'specificity': 0.7749424, 'f1': 0.472772, 'auroc': 0.9194889, 'binary_precision': 0.097600654, 'binary_recall': 0.9230769, 'binary_specificity': 0.6268079, 'binary_f1_score': 0.1765355}
confusion matrix:
      0     1
0  3727  2219
1    20   240
early stop counter: 12
val acc:0.7387406826019287, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 13,now: 2024-07-31 16:04:25.333031,epoch time: 0:18:35.399745,used: 3:52:24.610874,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.86654747, 'precision': 0.89028704, 'recall': 0.86645335, 'specificity': 0.86645335, 'f1': 0.8644655, 'auroc': 0.9917996, 'binary_precision': 0.79422164, 'binary_recall': 0.9897329, 'binary_specificity': 0.7431738, 'binary_f1_score': 0.8812638}
confusion matrix:
       0      1
0  21393   7393
1    296  28534
---- Validation: 
scalar performance:
{'acc': 0.38863394, 'precision': 0.48874786, 'recall': 0.4225729, 'specificity': 0.4225729, 'f1': 0.30010295, 'auroc': 0.5491044, 'binary_precision': 0.027100509, 'binary_recall': 0.45913818, 'binary_specificity': 0.38600764, 'binary_f1_score': 0.051180124}
confusion matrix:
      0      1
0  6974  11093
1   364    309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.14340961, 'precision': 0.5233142, 'recall': 0.5529768, 'specificity': 0.5529768, 'f1': 0.14035398, 'auroc': 0.90919477, 'binary_precision': 0.046628408, 'binary_recall': 1.0, 'binary_specificity': 0.10595358, 'binary_f1_score': 0.089102134}
confusion matrix:
     0     1
0  630  5316
1    0   260
early stop counter: 13
val acc:0.38863393664360046, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 14,now: 2024-07-31 16:22:58.006625,epoch time: 0:18:32.673594,used: 4:10:57.284468,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8633019, 'precision': 0.8882272, 'recall': 0.86320955, 'specificity': 0.86320955, 'f1': 0.8610505, 'auroc': 0.99112254, 'binary_precision': 0.79003906, 'binary_recall': 0.9898713, 'binary_specificity': 0.73654777, 'binary_f1_score': 0.87873757}
confusion matrix:
       0      1
0  21203   7584
1    292  28537
---- Validation: 
scalar performance:
{'acc': 0.39493063, 'precision': 0.4891797, 'recall': 0.42512327, 'specificity': 0.42512327, 'f1': 0.3036477, 'auroc': 0.549837, 'binary_precision': 0.027300125, 'binary_recall': 0.4576523, 'binary_specificity': 0.39259422, 'binary_f1_score': 0.05152656}
confusion matrix:
      0      1
0  7093  10974
1   365    308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.1480825, 'precision': 0.52343607, 'recall': 0.5554154, 'specificity': 0.5554154, 'f1': 0.14454646, 'auroc': 0.8772552, 'binary_precision': 0.046872184, 'binary_recall': 1.0, 'binary_specificity': 0.11083081, 'binary_f1_score': 0.089547105}
confusion matrix:
     0     1
0  659  5287
1    0   260
early stop counter: 14
val acc:0.3949306309223175, best validation acc: 0.9332444071769714, corresponding to test acc:                         0.9394134879112244 / 0.9394134879112244
after epoch: 15,now: 2024-07-31 16:41:38.817093,epoch time: 0:18:40.810468,used: 4:29:38.094936,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_12_12_00_seed_1_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:29:38.094936 at 2024-07-31 16:41:38.817093
persisted model performance metric: 

scalar performance:
{'acc': 0.9394135, 'precision': 0.6803641, 'recall': 0.8120682, 'specificity': 0.8120682, 'f1': 0.7249592, 'auroc': 0.86702573, 'binary_precision': 0.37553647, 'binary_recall': 0.6730769, 'binary_specificity': 0.9510595, 'binary_f1_score': 0.48209366}
confusion matrix:
      0    1
0  5655  291
1    85  175
oracle model performance metric: 

scalar performance:
{'acc': 0.9394135, 'precision': 0.6803641, 'recall': 0.8120682, 'specificity': 0.8120682, 'f1': 0.7249592, 'auroc': 0.86702573, 'binary_precision': 0.37553647, 'binary_recall': 0.6730769, 'binary_specificity': 0.9510595, 'binary_f1_score': 0.48209366}
confusion matrix:
      0    1
0  5655  291
1    85  175
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool | 403840 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |  89807 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool | 403840 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |  89807 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB | 664546 GiB | 664546 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |  88730 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11486 MiB |  21730 MiB |  10270 MiB |
|       from large pool |  11336 MiB |  11360 MiB |  21578 MiB |  10242 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 522160 KiB |   1278 MiB | 302945 GiB | 302945 GiB |
|       from large pool | 511616 KiB |   1275 MiB | 300975 GiB | 300975 GiB |
|       from small pool |  10544 KiB |     22 MiB |   1969 GiB |   1969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    8448    |  115762 K  |  115758 K  |
|       from large pool |      87    |     908    |   41973 K  |   41973 K  |
|       from small pool |    3618    |    8359    |   73788 K  |   73785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    8448    |  115762 K  |  115758 K  |
|       from large pool |      87    |     908    |   41973 K  |   41973 K  |
|       from small pool |    3618    |    8359    |   73788 K  |   73785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     406    |     726    |     327    |
|       from large pool |     337    |     343    |     650    |     313    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    3631    |   61837 K  |   61837 K  |
|       from large pool |      20    |     188    |   26688 K  |   26688 K  |
|       from small pool |      57    |    3610    |   35148 K  |   35148 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 664546 GiB | 664546 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |      0 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11486 MiB |  21730 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11360 MiB |  21578 MiB |  20684 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 302945 GiB | 302945 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 300976 GiB | 300975 GiB |
|       from small pool |      0 KiB |     26 MiB |   1969 GiB |   1969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  115762 K  |  115762 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73788 K  |   73788 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  115762 K  |  115762 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73788 K  |   73788 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     406    |     726    |     644    |
|       from large pool |      33    |     343    |     650    |     617    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   61838 K  |   61838 K  |
|       from large pool |       4    |     188    |   26688 K  |   26688 K  |
|       from small pool |       0    |    3610    |   35150 K  |   35150 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 670778 GiB | 670778 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 664546 GiB | 664546 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |      0 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11486 MiB |  21730 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11360 MiB |  21578 MiB |  20684 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 302945 GiB | 302945 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 300976 GiB | 300975 GiB |
|       from small pool |      0 KiB |     26 MiB |   1969 GiB |   1969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  115762 K  |  115762 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73788 K  |   73788 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  115762 K  |  115762 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73788 K  |   73788 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     406    |     726    |     644    |
|       from large pool |      33    |     343    |     650    |     617    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   61838 K  |   61838 K  |
|       from large pool |       4    |     188    |   26688 K  |   26688 K  |
|       from small pool |       0    |    3610    |   35150 K  |   35150 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367

 Experiment start at: 2024-07-31 16:51:35.254150
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96785814, 'precision': 0.9678611, 'recall': 0.9678583, 'specificity': 0.9678583, 'f1': 0.9678581, 'auroc': 0.99452364, 'binary_precision': 0.96908635, 'binary_recall': 0.96656036, 'binary_specificity': 0.9691563, 'binary_f1_score': 0.96782166}
confusion matrix:
       0      1
0  28248    899
1    975  28182
---- Validation: 
scalar performance:
{'acc': 0.9084856, 'precision': 0.58071613, 'recall': 0.71823674, 'specificity': 0.71823674, 'f1': 0.6081941, 'auroc': 0.8139432, 'binary_precision': 0.17857143, 'binary_recall': 0.51495016, 'binary_specificity': 0.92152333, 'binary_f1_score': 0.2651839}
confusion matrix:
       0     1
0  16745  1426
1    292   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94887, 'precision': 0.69641596, 'recall': 0.82271504, 'specificity': 0.82271504, 'f1': 0.7415062, 'auroc': 0.9016044, 'binary_precision': 0.40586796, 'binary_recall': 0.6859504, 'binary_specificity': 0.95947975, 'binary_f1_score': 0.5099846}
confusion matrix:
      0    1
0  5754  243
1    76  166
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 17:11:02.294915,epoch time: 0:19:27.040765,used: 0:19:27.040765,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96664035, 'precision': 0.9667995, 'recall': 0.96663815, 'specificity': 0.96663815, 'f1': 0.9666374, 'auroc': 0.99486816, 'binary_precision': 0.95824075, 'binary_recall': 0.9758222, 'binary_specificity': 0.9574541, 'binary_f1_score': 0.96695155}
confusion matrix:
       0      1
0  27905   1240
1    705  28454
---- Validation: 
scalar performance:
{'acc': 0.8517019, 'precision': 0.5365734, 'recall': 0.64473665, 'specificity': 0.64473665, 'f1': 0.53677356, 'auroc': 0.7054461, 'binary_precision': 0.09472511, 'binary_recall': 0.42358804, 'binary_specificity': 0.8658852, 'binary_f1_score': 0.15482695}
confusion matrix:
       0     1
0  15734  2437
1    347   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83378744, 'precision': 0.584334, 'recall': 0.8560406, 'specificity': 0.8560406, 'f1': 0.5985191, 'auroc': 0.92542756, 'binary_precision': 0.17444718, 'binary_recall': 0.8801653, 'binary_specificity': 0.831916, 'binary_f1_score': 0.29118255}
confusion matrix:
      0     1
0  4989  1008
1    29   213
early stop counter: 1
val acc:0.8517019152641296, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 2,now: 2024-07-31 17:30:14.177580,epoch time: 0:19:11.882665,used: 0:38:38.923430,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9387006, 'precision': 0.942446, 'recall': 0.9386927, 'specificity': 0.9386927, 'f1': 0.93856984, 'auroc': 0.9939475, 'binary_precision': 0.90178096, 'binary_recall': 0.9846692, 'binary_specificity': 0.8927162, 'binary_f1_score': 0.9414041}
confusion matrix:
       0      1
0  26020   3127
1    447  28710
---- Validation: 
scalar performance:
{'acc': 0.78271985, 'precision': 0.5203864, 'recall': 0.60990596, 'specificity': 0.60990596, 'f1': 0.49387386, 'auroc': 0.6318749, 'binary_precision': 0.064176485, 'binary_recall': 0.42524916, 'binary_specificity': 0.79456276, 'binary_f1_score': 0.11152254}
confusion matrix:
       0     1
0  14438  3733
1    346   256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7026767, 'precision': 0.55064267, 'recall': 0.79973626, 'specificity': 0.79973626, 'f1': 0.5044428, 'auroc': 0.92557317, 'binary_precision': 0.10677718, 'binary_recall': 0.90495867, 'binary_specificity': 0.6945139, 'binary_f1_score': 0.19101614}
confusion matrix:
      0     1
0  4165  1832
1    23   219
early stop counter: 2
val acc:0.7827198505401611, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 3,now: 2024-07-31 17:49:54.925293,epoch time: 0:19:40.747713,used: 0:58:19.671143,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95681256, 'precision': 0.9581426, 'recall': 0.956807, 'specificity': 0.956807, 'f1': 0.95678085, 'auroc': 0.99466765, 'binary_precision': 0.93350905, 'binary_recall': 0.98370945, 'binary_specificity': 0.92990464, 'binary_f1_score': 0.9579521}
confusion matrix:
       0      1
0  27103   2043
1    475  28683
---- Validation: 
scalar performance:
{'acc': 0.78825974, 'precision': 0.52147084, 'recall': 0.61357075, 'specificity': 0.61357075, 'f1': 0.49712765, 'auroc': 0.586744, 'binary_precision': 0.06611783, 'binary_recall': 0.4269103, 'binary_specificity': 0.80023116, 'binary_f1_score': 0.11450212}
confusion matrix:
       0     1
0  14541  3630
1    345   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.702837, 'precision': 0.550979, 'recall': 0.8018024, 'specificity': 0.8018024, 'f1': 0.5048772, 'auroc': 0.9209064, 'binary_precision': 0.10721248, 'binary_recall': 0.90909094, 'binary_specificity': 0.6945139, 'binary_f1_score': 0.1918047}
confusion matrix:
      0     1
0  4165  1832
1    22   220
early stop counter: 3
val acc:0.788259744644165, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 4,now: 2024-07-31 18:09:38.492445,epoch time: 0:19:43.567152,used: 1:18:03.238295,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95796174, 'precision': 0.9597611, 'recall': 0.95795524, 'specificity': 0.95795524, 'f1': 0.9579201, 'auroc': 0.9964269, 'binary_precision': 0.93105006, 'binary_recall': 0.9891968, 'binary_specificity': 0.92671376, 'binary_f1_score': 0.95924306}
confusion matrix:
       0      1
0  27010   2136
1    315  28843
---- Validation: 
scalar performance:
{'acc': 0.773398, 'precision': 0.519311, 'recall': 0.6074997, 'specificity': 0.6074997, 'f1': 0.48937592, 'auroc': 0.60821503, 'binary_precision': 0.062110312, 'binary_recall': 0.43023255, 'binary_specificity': 0.7847669, 'binary_f1_score': 0.10854988}
confusion matrix:
       0     1
0  14260  3911
1    343   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53950953, 'precision': 0.53411776, 'recall': 0.72873974, 'specificity': 0.72873974, 'f1': 0.41102687, 'auroc': 0.9198406, 'binary_precision': 0.07330522, 'binary_recall': 0.9338843, 'binary_specificity': 0.52359515, 'binary_f1_score': 0.13593985}
confusion matrix:
      0     1
0  3140  2857
1    16   226
early stop counter: 4
val acc:0.7733979821205139, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 5,now: 2024-07-31 18:29:50.538487,epoch time: 0:20:12.046042,used: 1:38:15.284337,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9430742, 'precision': 0.946498, 'recall': 0.94306827, 'specificity': 0.94306827, 'f1': 0.9429643, 'auroc': 0.9945663, 'binary_precision': 0.9074337, 'binary_recall': 0.98682946, 'binary_specificity': 0.899307, 'binary_f1_score': 0.9454677}
confusion matrix:
       0      1
0  26213   2935
1    384  28772
---- Validation: 
scalar performance:
{'acc': 0.756512, 'precision': 0.51712, 'recall': 0.60038316, 'specificity': 0.60038316, 'f1': 0.4808219, 'auroc': 0.56914544, 'binary_precision': 0.05811623, 'binary_recall': 0.43355483, 'binary_specificity': 0.7672115, 'binary_f1_score': 0.10249362}
confusion matrix:
       0     1
0  13941  4230
1    341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49911845, 'precision': 0.53262866, 'recall': 0.7176429, 'specificity': 0.7176429, 'f1': 0.38865972, 'auroc': 0.9088794, 'binary_precision': 0.0690583, 'binary_recall': 0.95454544, 'binary_specificity': 0.48074037, 'binary_f1_score': 0.12879845}
confusion matrix:
      0     1
0  2883  3114
1    11   231
early stop counter: 5
val acc:0.7565119862556458, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 6,now: 2024-07-31 18:50:26.701561,epoch time: 0:20:36.163074,used: 1:58:51.447411,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9028197, 'precision': 0.91559935, 'recall': 0.9028047, 'specificity': 0.9028047, 'f1': 0.90206456, 'auroc': 0.992883, 'binary_precision': 0.8427642, 'binary_recall': 0.9904654, 'binary_specificity': 0.81514394, 'binary_f1_score': 0.9106648}
confusion matrix:
       0      1
0  23759   5388
1    278  28879
---- Validation: 
scalar performance:
{'acc': 0.5473819, 'precision': 0.5000482, 'recall': 0.50038433, 'specificity': 0.50038433, 'f1': 0.38094762, 'auroc': 0.53763676, 'binary_precision': 0.03212042, 'binary_recall': 0.4501661, 'binary_specificity': 0.5506026, 'binary_f1_score': 0.059962388}
confusion matrix:
       0     1
0  10005  8166
1    331   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.15451194, 'precision': 0.5219322, 'recall': 0.56019676, 'specificity': 0.56019676, 'f1': 0.14947766, 'auroc': 0.86589473, 'binary_precision': 0.043864418, 'binary_recall': 1.0, 'binary_specificity': 0.12039353, 'binary_f1_score': 0.08404237}
confusion matrix:
     0     1
0  722  5275
1    0   242
early stop counter: 6
val acc:0.5473818778991699, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 7,now: 2024-07-31 19:10:28.047316,epoch time: 0:20:01.345755,used: 2:18:52.793166,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9101948, 'precision': 0.9216453, 'recall': 0.9101807, 'specificity': 0.9101807, 'f1': 0.9095789, 'auroc': 0.9953211, 'binary_precision': 0.85220414, 'binary_recall': 0.9925575, 'binary_specificity': 0.8278039, 'binary_f1_score': 0.91704166}
confusion matrix:
       0      1
0  24128   5019
1    217  28940
---- Validation: 
scalar performance:
{'acc': 0.5340116, 'precision': 0.49998778, 'recall': 0.49990213, 'specificity': 0.49990213, 'f1': 0.37509397, 'auroc': 0.563198, 'binary_precision': 0.032054227, 'binary_recall': 0.46345514, 'binary_specificity': 0.5363491, 'binary_f1_score': 0.05996131}
confusion matrix:
      0     1
0  9746  8425
1   323   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.21077095, 'precision': 0.52342236, 'recall': 0.5894614, 'specificity': 0.5894614, 'f1': 0.19651654, 'auroc': 0.8776108, 'binary_precision': 0.046844754, 'binary_recall': 1.0, 'binary_specificity': 0.17892279, 'binary_f1_score': 0.089497045}
confusion matrix:
      0     1
0  1073  4924
1     0   242
early stop counter: 7
val acc:0.5340116024017334, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 8,now: 2024-07-31 19:31:52.478295,epoch time: 0:21:24.430979,used: 2:40:17.224145,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93418974, 'precision': 0.939153, 'recall': 0.9341806, 'specificity': 0.9341806, 'f1': 0.9340024, 'auroc': 0.99281406, 'binary_precision': 0.89250946, 'binary_recall': 0.98731005, 'binary_specificity': 0.88105124, 'binary_f1_score': 0.9375193}
confusion matrix:
       0      1
0  25680   3467
1    370  28787
---- Validation: 
scalar performance:
{'acc': 0.6855058, 'precision': 0.50855106, 'recall': 0.5588856, 'specificity': 0.5588856, 'f1': 0.44493476, 'auroc': 0.5490339, 'binary_precision': 0.04387474, 'binary_recall': 0.42358804, 'binary_specificity': 0.69418305, 'binary_f1_score': 0.079513565}
confusion matrix:
       0     1
0  12614  5557
1    347   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37185445, 'precision': 0.52562934, 'recall': 0.65342593, 'specificity': 0.65342593, 'f1': 0.31086877, 'auroc': 0.8620894, 'binary_precision': 0.056025114, 'binary_recall': 0.9586777, 'binary_specificity': 0.3481741, 'binary_f1_score': 0.10586356}
confusion matrix:
      0     1
0  2088  3909
1    10   232
early stop counter: 8
val acc:0.6855058073997498, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 9,now: 2024-07-31 19:52:12.649543,epoch time: 0:20:20.171248,used: 3:00:37.395393,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9363337, 'precision': 0.9414691, 'recall': 0.9363245, 'specificity': 0.9363245, 'f1': 0.9361471, 'auroc': 0.99546766, 'binary_precision': 0.89389765, 'binary_recall': 0.9902253, 'binary_specificity': 0.8824236, 'binary_f1_score': 0.93959904}
confusion matrix:
       0      1
0  25720   3427
1    285  28872
---- Validation: 
scalar performance:
{'acc': 0.7193842, 'precision': 0.51308966, 'recall': 0.58441645, 'specificity': 0.58441645, 'f1': 0.46273953, 'auroc': 0.5684935, 'binary_precision': 0.05100077, 'binary_recall': 0.44019935, 'binary_specificity': 0.7286335, 'binary_f1_score': 0.09141083}
confusion matrix:
       0     1
0  13240  4931
1    337   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37345728, 'precision': 0.52673715, 'recall': 0.66020787, 'specificity': 0.66020787, 'f1': 0.31233913, 'auroc': 0.8768577, 'binary_precision': 0.05680445, 'binary_recall': 0.9710744, 'binary_specificity': 0.34934133, 'binary_f1_score': 0.10733044}
confusion matrix:
      0     1
0  2095  3902
1     7   235
early stop counter: 9
val acc:0.7193841934204102, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 10,now: 2024-07-31 20:11:06.215719,epoch time: 0:18:53.566176,used: 3:19:30.961569,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9391637, 'precision': 0.9434849, 'recall': 0.93915355, 'specificity': 0.93915355, 'f1': 0.9390142, 'auroc': 0.99481946, 'binary_precision': 0.89975965, 'binary_recall': 0.9884766, 'binary_specificity': 0.8898305, 'binary_f1_score': 0.94203395}
confusion matrix:
       0      1
0  25935   3211
1    336  28822
---- Validation: 
scalar performance:
{'acc': 0.7610931, 'precision': 0.5174922, 'recall': 0.6011435, 'specificity': 0.6011435, 'f1': 0.4828601, 'auroc': 0.5725269, 'binary_precision': 0.058850262, 'binary_recall': 0.43023255, 'binary_specificity': 0.7720544, 'binary_f1_score': 0.10353788}
confusion matrix:
       0     1
0  14029  4142
1    343   259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48629588, 'precision': 0.5317681, 'recall': 0.7109729, 'specificity': 0.7109729, 'f1': 0.38111934, 'auroc': 0.88539654, 'binary_precision': 0.067445256, 'binary_recall': 0.95454544, 'binary_specificity': 0.46740037, 'binary_f1_score': 0.12598854}
confusion matrix:
      0     1
0  2803  3194
1    11   231
early stop counter: 10
val acc:0.7610930800437927, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 11,now: 2024-07-31 20:30:09.984767,epoch time: 0:19:03.769048,used: 3:38:34.730617,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8932835, 'precision': 0.90978956, 'recall': 0.8932594, 'specificity': 0.8932594, 'f1': 0.89219373, 'auroc': 0.9937459, 'binary_precision': 0.8276059, 'binary_recall': 0.9935869, 'binary_specificity': 0.7929319, 'binary_f1_score': 0.90303284}
confusion matrix:
       0      1
0  23110   6035
1    187  28972
---- Validation: 
scalar performance:
{'acc': 0.5329462, 'precision': 0.49941802, 'recall': 0.4953366, 'specificity': 0.4953366, 'f1': 0.37411597, 'auroc': 0.5599319, 'binary_precision': 0.031443655, 'binary_recall': 0.4551495, 'binary_specificity': 0.53552365, 'binary_f1_score': 0.058823533}
confusion matrix:
      0     1
0  9731  8440
1   328   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.16348773, 'precision': 0.52215713, 'recall': 0.56486577, 'specificity': 0.56486577, 'f1': 0.15726775, 'auroc': 0.8623277, 'binary_precision': 0.044314228, 'binary_recall': 1.0, 'binary_specificity': 0.12973154, 'binary_f1_score': 0.08486761}
confusion matrix:
     0     1
0  778  5219
1    0   242
early stop counter: 11
val acc:0.5329462289810181, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 12,now: 2024-07-31 20:49:45.126714,epoch time: 0:19:35.141947,used: 3:58:09.872564,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.89088225, 'precision': 0.9074727, 'recall': 0.8908615, 'specificity': 0.8908615, 'f1': 0.88975644, 'auroc': 0.9854646, 'binary_precision': 0.825304, 'binary_recall': 0.9917347, 'binary_specificity': 0.78998834, 'binary_f1_score': 0.90089726}
confusion matrix:
       0      1
0  23025   6121
1    241  28917
---- Validation: 
scalar performance:
{'acc': 0.48969266, 'precision': 0.4958486, 'recall': 0.4665689, 'specificity': 0.4665689, 'f1': 0.3517045, 'auroc': 0.52290213, 'binary_precision': 0.027970558, 'binary_recall': 0.44186047, 'binary_specificity': 0.4912773, 'binary_f1_score': 0.05261076}
confusion matrix:
      0     1
0  8927  9244
1   336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.15547363, 'precision': 0.5219561, 'recall': 0.560697, 'specificity': 0.560697, 'f1': 0.15031779, 'auroc': 0.68167293, 'binary_precision': 0.043912176, 'binary_recall': 1.0, 'binary_specificity': 0.12139403, 'binary_f1_score': 0.08413002}
confusion matrix:
     0     1
0  728  5269
1    0   242
early stop counter: 12
val acc:0.48969265818595886, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 13,now: 2024-07-31 21:09:13.712994,epoch time: 0:19:28.586280,used: 4:17:38.458844,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8862514, 'precision': 0.90453184, 'recall': 0.88622224, 'specificity': 0.88622224, 'f1': 0.88494617, 'auroc': 0.9911659, 'binary_precision': 0.8186061, 'binary_recall': 0.9924897, 'binary_specificity': 0.77995473, 'binary_f1_score': 0.89720064}
confusion matrix:
       0      1
0  22731   6413
1    219  28941
---- Validation: 
scalar performance:
{'acc': 0.50545996, 'precision': 0.4980565, 'recall': 0.48435032, 'specificity': 0.48435032, 'f1': 0.3607071, 'auroc': 0.543399, 'binary_precision': 0.030093094, 'binary_recall': 0.46179402, 'binary_specificity': 0.5069066, 'binary_f1_score': 0.056504063}
confusion matrix:
      0     1
0  9211  8960
1   324   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.18849175, 'precision': 0.5228087, 'recall': 0.5778723, 'specificity': 0.5778723, 'f1': 0.17838408, 'auroc': 0.6959714, 'binary_precision': 0.045617342, 'binary_recall': 1.0, 'binary_specificity': 0.15574454, 'binary_f1_score': 0.08725437}
confusion matrix:
     0     1
0  934  5063
1    0   242
early stop counter: 13
val acc:0.5054599642753601, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 14,now: 2024-07-31 21:28:43.960495,epoch time: 0:19:30.247501,used: 4:37:08.706345,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9169868, 'precision': 0.9265873, 'recall': 0.91696626, 'specificity': 0.91696626, 'f1': 0.9165144, 'auroc': 0.99475414, 'binary_precision': 0.8626603, 'binary_recall': 0.99194103, 'binary_specificity': 0.8419915, 'binary_f1_score': 0.92279464}
confusion matrix:
       0      1
0  24539   4605
1    235  28925
---- Validation: 
scalar performance:
{'acc': 0.63063973, 'precision': 0.50601655, 'recall': 0.5449985, 'specificity': 0.5449985, 'f1': 0.42118433, 'auroc': 0.56300443, 'binary_precision': 0.039691772, 'binary_recall': 0.45348838, 'binary_specificity': 0.6365087, 'binary_f1_score': 0.07299465}
confusion matrix:
       0     1
0  11566  6605
1    329   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.33995834, 'precision': 0.52555245, 'recall': 0.64476526, 'specificity': 0.64476526, 'f1': 0.2903867, 'auroc': 0.8270068, 'binary_precision': 0.05427783, 'binary_recall': 0.9752066, 'binary_specificity': 0.31432384, 'binary_f1_score': 0.10283225}
confusion matrix:
      0     1
0  1885  4112
1     6   236
early stop counter: 14
val acc:0.6306397318840027, best validation acc: 0.9084855914115906, corresponding to test acc:                         0.9488700032234192 / 0.9488700032234192
after epoch: 15,now: 2024-07-31 21:48:28.957172,epoch time: 0:19:44.996677,used: 4:56:53.703022,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_16_51_34_seed_2_23775367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:56:53.703022 at 2024-07-31 21:48:28.957172
persisted model performance metric: 

scalar performance:
{'acc': 0.94887, 'precision': 0.69641596, 'recall': 0.82271504, 'specificity': 0.82271504, 'f1': 0.7415062, 'auroc': 0.9016044, 'binary_precision': 0.40586796, 'binary_recall': 0.6859504, 'binary_specificity': 0.95947975, 'binary_f1_score': 0.5099846}
confusion matrix:
      0    1
0  5754  243
1    76  166
oracle model performance metric: 

scalar performance:
{'acc': 0.94887, 'precision': 0.69641596, 'recall': 0.82271504, 'specificity': 0.82271504, 'f1': 0.7415062, 'auroc': 0.9016044, 'binary_precision': 0.40586796, 'binary_recall': 0.6859504, 'binary_specificity': 0.95947975, 'binary_f1_score': 0.5099846}
confusion matrix:
      0    1
0  5754  243
1    76  166
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491221 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool | 401408 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491221 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool | 401408 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10880 MiB |    990 TiB |    990 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    988 TiB |    988 TiB |
|       from small pool |  88732 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11504 MiB |  11504 MiB |  32242 MiB |  20738 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32064 MiB |  20684 MiB |
|       from small pool |    124 MiB |    126 MiB |    178 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 637226 KiB |   1278 MiB | 460383 GiB | 460382 GiB |
|       from large pool | 626688 KiB |   1275 MiB | 457363 GiB | 457362 GiB |
|       from small pool |  10538 KiB |     26 MiB |   3020 GiB |   3020 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    8534    |  175960 K  |  175956 K  |
|       from large pool |      87    |     908    |   64023 K  |   64023 K  |
|       from small pool |    3630    |    8445    |  111936 K  |  111933 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    8534    |  175960 K  |  175956 K  |
|       from large pool |      87    |     908    |   64023 K  |   64023 K  |
|       from small pool |    3630    |    8445    |  111936 K  |  111933 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     410    |     410    |    1054    |     644    |
|       from large pool |     348    |     348    |     965    |     617    |
|       from small pool |      62    |      63    |      89    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3680    |   92813 K  |   92812 K  |
|       from large pool |      24    |     203    |   39511 K  |   39511 K  |
|       from small pool |      51    |    3654    |   53301 K  |   53301 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool |  16640 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool |  16640 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    990 TiB |    990 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    988 TiB |    988 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1102 MiB |  11504 MiB |  32242 MiB |  31140 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32064 MiB |  31060 MiB |
|       from small pool |     98 MiB |    126 MiB |    178 MiB |     80 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 460383 GiB | 460383 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 457363 GiB | 457363 GiB |
|       from small pool |      0 KiB |     26 MiB |   3020 GiB |   3020 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8534    |  175960 K  |  175960 K  |
|       from large pool |       2    |     908    |   64023 K  |   64023 K  |
|       from small pool |       0    |    8445    |  111936 K  |  111936 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8534    |  175960 K  |  175960 K  |
|       from large pool |       2    |     908    |   64023 K  |   64023 K  |
|       from small pool |       0    |    8445    |  111936 K  |  111936 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     410    |    1054    |     971    |
|       from large pool |      34    |     348    |     965    |     931    |
|       from small pool |      49    |      63    |      89    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3680    |   92814 K  |   92814 K  |
|       from large pool |       4    |     203    |   39511 K  |   39511 K  |
|       from small pool |       0    |    3654    |   53302 K  |   53302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 31 21:49:52 2024]
Finished job 0.
1 of 1 steps (100%) done
