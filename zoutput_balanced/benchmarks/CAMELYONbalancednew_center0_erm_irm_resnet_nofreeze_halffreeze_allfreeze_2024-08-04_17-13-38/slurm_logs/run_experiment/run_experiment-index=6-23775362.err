Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 04:15:12 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362

 Experiment start at: 2024-07-31 04:24:52.471730
before training, model accuracy: 0.31128156185150146
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9661088, 'precision': 0.96687555, 'recall': 0.96612656, 'specificity': 0.96612656, 'f1': 0.96609575, 'auroc': 0.99398565, 'binary_precision': 0.98601574, 'binary_recall': 0.9456889, 'binary_specificity': 0.9865643, 'binary_f1_score': 0.9654314}
confusion matrix:
       0      1
0  28270    385
1   1559  27146
---- Validation: 
scalar performance:
{'acc': 0.9548212, 'precision': 0.65610194, 'recall': 0.6525864, 'specificity': 0.6525864, 'f1': 0.654321, 'auroc': 0.82129073, 'binary_precision': 0.33598727, 'binary_recall': 0.3281493, 'binary_specificity': 0.97702354, 'binary_f1_score': 0.33202204}
confusion matrix:
       0    1
0  17732  417
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.81176746, 'recall': 0.80833805, 'specificity': 0.80833805, 'f1': 0.81004214, 'auroc': 0.8863857, 'binary_precision': 0.6395349, 'binary_recall': 0.6321839, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.6358382}
confusion matrix:
      0    1
0  5904   93
1    96  165
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 04:43:00.718578,epoch time: 0:18:08.246848,used: 0:18:08.246848,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9400279, 'precision': 0.9448068, 'recall': 0.93999183, 'specificity': 0.93999183, 'f1': 0.93986297, 'auroc': 0.9958093, 'binary_precision': 0.8988757, 'binary_recall': 0.9917073, 'binary_specificity': 0.88827634, 'binary_f1_score': 0.9430124}
confusion matrix:
       0      1
0  25458   3202
1    238  28462
---- Validation: 
scalar performance:
{'acc': 0.779321, 'precision': 0.5403723, 'recall': 0.71698886, 'specificity': 0.71698886, 'f1': 0.52028286, 'auroc': 0.76056314, 'binary_precision': 0.096313365, 'binary_recall': 0.65007776, 'binary_specificity': 0.78389996, 'binary_f1_score': 0.16777043}
confusion matrix:
       0     1
0  14227  3922
1    225   418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.621125, 'precision': 0.5440533, 'recall': 0.7675035, 'specificity': 0.7675035, 'f1': 0.46205372, 'auroc': 0.92021763, 'binary_precision': 0.093292214, 'binary_recall': 0.92720306, 'binary_specificity': 0.6078039, 'binary_f1_score': 0.16952714}
confusion matrix:
      0     1
0  3645  2352
1    19   242
early stop counter: 1
val acc:0.779321014881134, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 2,now: 2024-07-31 05:00:16.368225,epoch time: 0:17:15.649647,used: 0:35:23.896495,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9773536, 'precision': 0.97738683, 'recall': 0.9773498, 'specificity': 0.9773498, 'f1': 0.9773531, 'auroc': 0.9969796, 'binary_precision': 0.97362965, 'binary_recall': 0.9813286, 'binary_specificity': 0.973371, 'binary_f1_score': 0.977464}
confusion matrix:
       0      1
0  27890    763
1    536  28171
---- Validation: 
scalar performance:
{'acc': 0.9212431, 'precision': 0.5865826, 'recall': 0.6772056, 'specificity': 0.6772056, 'f1': 0.61176795, 'auroc': 0.7858031, 'binary_precision': 0.19474836, 'binary_recall': 0.41524106, 'binary_specificity': 0.9391702, 'binary_f1_score': 0.265144}
confusion matrix:
       0     1
0  17045  1104
1    376   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89677215, 'precision': 0.62729543, 'recall': 0.86002004, 'specificity': 0.86002004, 'f1': 0.67102575, 'auroc': 0.921133, 'binary_precision': 0.26322263, 'binary_recall': 0.8199234, 'binary_specificity': 0.90011674, 'binary_f1_score': 0.39851022}
confusion matrix:
      0    1
0  5398  599
1    47  214
early stop counter: 2
val acc:0.9212430715560913, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 3,now: 2024-07-31 05:17:28.442103,epoch time: 0:17:12.073878,used: 0:52:35.970373,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9778417, 'precision': 0.97787154, 'recall': 0.9778384, 'specificity': 0.9778384, 'f1': 0.9778412, 'auroc': 0.99726117, 'binary_precision': 0.97430843, 'binary_recall': 0.981606, 'binary_specificity': 0.97407085, 'binary_f1_score': 0.97794354}
confusion matrix:
       0      1
0  27912    743
1    528  28177
---- Validation: 
scalar performance:
{'acc': 0.9119306, 'precision': 0.56878155, 'recall': 0.6521329, 'specificity': 0.6521329, 'f1': 0.5890688, 'auroc': 0.72753954, 'binary_precision': 0.16085792, 'binary_recall': 0.3732504, 'binary_specificity': 0.9310155, 'binary_f1_score': 0.22482437}
confusion matrix:
       0     1
0  16897  1252
1    403   240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8557047, 'precision': 0.59733325, 'recall': 0.84775436, 'specificity': 0.84775436, 'f1': 0.6229083, 'auroc': 0.9212799, 'binary_precision': 0.20277777, 'binary_recall': 0.83908045, 'binary_specificity': 0.8564282, 'binary_f1_score': 0.32662192}
confusion matrix:
      0    1
0  5136  861
1    42  219
early stop counter: 3
val acc:0.9119306206703186, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 4,now: 2024-07-31 05:34:42.709522,epoch time: 0:17:14.267419,used: 1:09:50.237792,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94914573, 'precision': 0.9517093, 'recall': 0.9491117, 'specificity': 0.9491117, 'f1': 0.9490708, 'auroc': 0.99590075, 'binary_precision': 0.91790634, 'binary_recall': 0.986623, 'binary_specificity': 0.9116005, 'binary_f1_score': 0.951025}
confusion matrix:
       0      1
0  26121   2533
1    384  28322
---- Validation: 
scalar performance:
{'acc': 0.77607495, 'precision': 0.5208777, 'recall': 0.6080504, 'specificity': 0.6080504, 'f1': 0.49370188, 'auroc': 0.64992434, 'binary_precision': 0.066828676, 'binary_recall': 0.42768273, 'binary_specificity': 0.7884181, 'binary_f1_score': 0.11559479}
confusion matrix:
       0     1
0  14309  3840
1    368   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5861297, 'precision': 0.54229087, 'recall': 0.76207066, 'specificity': 0.76207066, 'f1': 0.4432779, 'auroc': 0.9243798, 'binary_precision': 0.08807924, 'binary_recall': 0.954023, 'binary_specificity': 0.57011837, 'binary_f1_score': 0.16126943}
confusion matrix:
      0     1
0  3419  2578
1    12   249
early stop counter: 4
val acc:0.7760749459266663, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 5,now: 2024-07-31 05:51:50.662484,epoch time: 0:17:07.952962,used: 1:26:58.190754,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9513947, 'precision': 0.9537039, 'recall': 0.9513613, 'specificity': 0.9513613, 'f1': 0.9513302, 'auroc': 0.9955908, 'binary_precision': 0.92157054, 'binary_recall': 0.9868673, 'binary_specificity': 0.9158552, 'binary_f1_score': 0.9531019}
confusion matrix:
       0      1
0  26242   2411
1    377  28330
---- Validation: 
scalar performance:
{'acc': 0.81369734, 'precision': 0.5276141, 'recall': 0.62377775, 'specificity': 0.62377775, 'f1': 0.51462835, 'auroc': 0.63518465, 'binary_precision': 0.079458505, 'binary_recall': 0.41990668, 'binary_specificity': 0.8276489, 'binary_f1_score': 0.13363029}
confusion matrix:
       0     1
0  15021  3128
1    373   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61425376, 'precision': 0.54267883, 'recall': 0.76025367, 'specificity': 0.76025367, 'f1': 0.45748854, 'auroc': 0.91630745, 'binary_precision': 0.091150776, 'binary_recall': 0.9195402, 'binary_specificity': 0.60096717, 'binary_f1_score': 0.16586038}
confusion matrix:
      0     1
0  3604  2393
1    21   240
early stop counter: 5
val acc:0.813697338104248, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 6,now: 2024-07-31 06:08:57.622397,epoch time: 0:17:06.959913,used: 1:44:05.150667,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93690723, 'precision': 0.9412135, 'recall': 0.93686604, 'specificity': 0.93686604, 'f1': 0.93674886, 'auroc': 0.9946085, 'binary_precision': 0.8978336, 'binary_recall': 0.98613435, 'binary_specificity': 0.88759774, 'binary_f1_score': 0.9399147}
confusion matrix:
       0      1
0  25435   3221
1    398  28306
---- Validation: 
scalar performance:
{'acc': 0.5734887, 'precision': 0.5012419, 'recall': 0.50916904, 'specificity': 0.50916904, 'f1': 0.39480448, 'auroc': 0.5580036, 'binary_precision': 0.035651296, 'binary_recall': 0.44012442, 'binary_specificity': 0.5782137, 'binary_f1_score': 0.06595968}
confusion matrix:
       0     1
0  10494  7655
1    360   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38926175, 'precision': 0.53061754, 'recall': 0.67401135, 'specificity': 0.67401135, 'f1': 0.32565263, 'auroc': 0.87974495, 'binary_precision': 0.06306749, 'binary_recall': 0.98467433, 'binary_specificity': 0.36334834, 'binary_f1_score': 0.11854245}
confusion matrix:
      0     1
0  2179  3818
1     4   257
early stop counter: 6
val acc:0.573488712310791, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 7,now: 2024-07-31 06:26:06.817929,epoch time: 0:17:09.195532,used: 2:01:14.346199,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92414576, 'precision': 0.9304492, 'recall': 0.9240973, 'specificity': 0.9240973, 'f1': 0.92386115, 'auroc': 0.99285424, 'binary_precision': 0.8785599, 'binary_recall': 0.9844964, 'binary_specificity': 0.86369824, 'binary_f1_score': 0.92851627}
confusion matrix:
       0      1
0  24751   3906
1    445  28258
---- Validation: 
scalar performance:
{'acc': 0.5448063, 'precision': 0.49964237, 'recall': 0.49731997, 'specificity': 0.49731997, 'f1': 0.3811395, 'auroc': 0.5441302, 'binary_precision': 0.033824395, 'binary_recall': 0.44634527, 'binary_specificity': 0.54829466, 'binary_f1_score': 0.06288344}
confusion matrix:
      0     1
0  9951  8198
1   356   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32470438, 'precision': 0.5275652, 'recall': 0.6403278, 'specificity': 0.6403278, 'f1': 0.28248584, 'auroc': 0.8436503, 'binary_precision': 0.05737888, 'binary_recall': 0.98467433, 'binary_specificity': 0.29598132, 'binary_f1_score': 0.10843882}
confusion matrix:
      0     1
0  1775  4222
1     4   257
early stop counter: 7
val acc:0.5448063015937805, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 8,now: 2024-07-31 06:43:14.240283,epoch time: 0:17:07.422354,used: 2:18:21.768553,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9522664, 'precision': 0.95455086, 'recall': 0.95223564, 'specificity': 0.95223564, 'f1': 0.952204, 'auroc': 0.99602497, 'binary_precision': 0.9225437, 'binary_recall': 0.9875283, 'binary_specificity': 0.91694295, 'binary_f1_score': 0.95393056}
confusion matrix:
       0      1
0  26275   2380
1    358  28347
---- Validation: 
scalar performance:
{'acc': 0.79650915, 'precision': 0.5246364, 'recall': 0.6186295, 'specificity': 0.6186295, 'f1': 0.5052985, 'auroc': 0.6314844, 'binary_precision': 0.07370678, 'binary_recall': 0.42768273, 'binary_specificity': 0.8095763, 'binary_f1_score': 0.12574303}
confusion matrix:
       0     1
0  14693  3456
1    368   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46021092, 'precision': 0.5346284, 'recall': 0.7110298, 'specificity': 0.7110298, 'f1': 0.3701841, 'auroc': 0.9085226, 'binary_precision': 0.0707794, 'binary_recall': 0.98467433, 'binary_specificity': 0.43738535, 'binary_f1_score': 0.13206576}
confusion matrix:
      0     1
0  2623  3374
1     4   257
early stop counter: 8
val acc:0.7965091466903687, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 9,now: 2024-07-31 07:00:10.697264,epoch time: 0:16:56.456981,used: 2:35:18.225534,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91004187, 'precision': 0.9199351, 'recall': 0.9099884, 'specificity': 0.9099884, 'f1': 0.9095011, 'auroc': 0.99078614, 'binary_precision': 0.8556536, 'binary_recall': 0.98665506, 'binary_specificity': 0.8333217, 'binary_f1_score': 0.91649675}
confusion matrix:
       0      1
0  23883   4777
1    383  28317
---- Validation: 
scalar performance:
{'acc': 0.48823968, 'precision': 0.49517876, 'recall': 0.46353427, 'specificity': 0.46353427, 'f1': 0.35214517, 'auroc': 0.50717485, 'binary_precision': 0.029467281, 'binary_recall': 0.43701398, 'binary_specificity': 0.49005455, 'binary_f1_score': 0.05521171}
confusion matrix:
      0     1
0  8894  9255
1   362   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.19303292, 'precision': 0.5239599, 'recall': 0.5771238, 'specificity': 0.5771238, 'f1': 0.18316005, 'auroc': 0.8187969, 'binary_precision': 0.04897344, 'binary_recall': 0.99616855, 'binary_specificity': 0.15807904, 'binary_f1_score': 0.09335727}
confusion matrix:
     0     1
0  948  5049
1    1   260
early stop counter: 9
val acc:0.48823967576026917, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 10,now: 2024-07-31 07:17:12.927660,epoch time: 0:17:02.230396,used: 2:52:20.455930,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9434972, 'precision': 0.9463551, 'recall': 0.94347215, 'specificity': 0.94347215, 'f1': 0.94340444, 'auroc': 0.993519, 'binary_precision': 0.91079557, 'binary_recall': 0.98337865, 'binary_specificity': 0.9035657, 'binary_f1_score': 0.9456965}
confusion matrix:
       0      1
0  25898   2764
1    477  28221
---- Validation: 
scalar performance:
{'acc': 0.7939017, 'precision': 0.5246967, 'recall': 0.6202798, 'specificity': 0.6202798, 'f1': 0.50455445, 'auroc': 0.6170734, 'binary_precision': 0.073653646, 'binary_recall': 0.43390357, 'binary_specificity': 0.806656, 'binary_f1_score': 0.12593095}
confusion matrix:
       0     1
0  14640  3509
1    364   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6204858, 'precision': 0.5442704, 'recall': 0.7690023, 'specificity': 0.7690023, 'f1': 0.46194208, 'auroc': 0.8983023, 'binary_precision': 0.093461536, 'binary_recall': 0.9310345, 'binary_specificity': 0.60697013, 'binary_f1_score': 0.16987066}
confusion matrix:
      0     1
0  3640  2357
1    18   243
early stop counter: 10
val acc:0.7939016819000244, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 11,now: 2024-07-31 07:34:09.251933,epoch time: 0:16:56.324273,used: 3:09:16.780203,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9647664, 'precision': 0.96575105, 'recall': 0.9647497, 'specificity': 0.9647497, 'f1': 0.96474683, 'auroc': 0.9969332, 'binary_precision': 0.9445185, 'binary_recall': 0.9875963, 'binary_specificity': 0.94190305, 'binary_f1_score': 0.9655771}
confusion matrix:
       0      1
0  26994   1665
1    356  28345
---- Validation: 
scalar performance:
{'acc': 0.83328015, 'precision': 0.5327222, 'recall': 0.6339161, 'specificity': 0.6339161, 'f1': 0.5273149, 'auroc': 0.62405694, 'binary_precision': 0.089108914, 'binary_recall': 0.41990668, 'binary_specificity': 0.8479255, 'binary_f1_score': 0.14701879}
confusion matrix:
       0     1
0  15389  2760
1    373   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6612336, 'precision': 0.5483285, 'recall': 0.7829336, 'specificity': 0.7829336, 'f1': 0.48511744, 'auroc': 0.90126157, 'binary_precision': 0.10226786, 'binary_recall': 0.91570884, 'binary_specificity': 0.6501584, 'binary_f1_score': 0.18398766}
confusion matrix:
      0     1
0  3899  2098
1    22   239
early stop counter: 11
val acc:0.8332801461219788, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 12,now: 2024-07-31 07:51:05.968289,epoch time: 0:16:56.716356,used: 3:26:13.496559,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91569036, 'precision': 0.92481923, 'recall': 0.9156393, 'specificity': 0.9156393, 'f1': 0.915228, 'auroc': 0.9943203, 'binary_precision': 0.8627189, 'binary_recall': 0.9888502, 'binary_specificity': 0.84242845, 'binary_f1_score': 0.9214884}
confusion matrix:
       0      1
0  24144   4516
1    320  28380
---- Validation: 
scalar performance:
{'acc': 0.6260111, 'precision': 0.50536674, 'recall': 0.53786075, 'specificity': 0.53786075, 'f1': 0.42032182, 'auroc': 0.56050146, 'binary_precision': 0.040977713, 'binary_recall': 0.44323483, 'binary_specificity': 0.63248664, 'binary_f1_score': 0.07501974}
confusion matrix:
       0     1
0  11479  6670
1    358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32646212, 'precision': 0.5272659, 'recall': 0.63941264, 'specificity': 0.63941264, 'f1': 0.28358307, 'auroc': 0.82742715, 'binary_precision': 0.057321988, 'binary_recall': 0.9808429, 'binary_specificity': 0.29798234, 'binary_f1_score': 0.10831395}
confusion matrix:
      0     1
0  1787  4210
1     5   256
early stop counter: 12
val acc:0.626011073589325, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 13,now: 2024-07-31 08:08:13.173891,epoch time: 0:17:07.205602,used: 3:43:20.702161,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9600767, 'precision': 0.9614825, 'recall': 0.96005374, 'specificity': 0.96005374, 'f1': 0.96004474, 'auroc': 0.9966825, 'binary_precision': 0.9362201, 'binary_recall': 0.98749304, 'binary_specificity': 0.93261445, 'binary_f1_score': 0.96117324}
confusion matrix:
       0      1
0  26725   1931
1    359  28345
---- Validation: 
scalar performance:
{'acc': 0.7703278, 'precision': 0.5196589, 'recall': 0.60357493, 'specificity': 0.60357493, 'f1': 0.49020022, 'auroc': 0.5981553, 'binary_precision': 0.06470728, 'binary_recall': 0.42457232, 'binary_specificity': 0.7825776, 'binary_f1_score': 0.112299465}
confusion matrix:
       0     1
0  14203  3946
1    370   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6006711, 'precision': 0.5443816, 'recall': 0.77332246, 'specificity': 0.77332246, 'f1': 0.4523198, 'auroc': 0.9161235, 'binary_precision': 0.09160584, 'binary_recall': 0.96168584, 'binary_specificity': 0.58495915, 'binary_f1_score': 0.16727757}
confusion matrix:
      0     1
0  3508  2489
1    10   251
early stop counter: 13
val acc:0.7703278064727783, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 14,now: 2024-07-31 08:25:17.765201,epoch time: 0:17:04.591310,used: 4:00:25.293471,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94796026, 'precision': 0.95108664, 'recall': 0.94792557, 'specificity': 0.94792557, 'f1': 0.94786704, 'auroc': 0.9959358, 'binary_precision': 0.9137415, 'binary_recall': 0.98940915, 'binary_specificity': 0.9064419, 'binary_f1_score': 0.9500711}
confusion matrix:
       0      1
0  25975   2681
1    304  28400
---- Validation: 
scalar performance:
{'acc': 0.7401554, 'precision': 0.51619494, 'recall': 0.5932046, 'specificity': 0.5932046, 'f1': 0.47548005, 'auroc': 0.59507215, 'binary_precision': 0.058333334, 'binary_recall': 0.43545878, 'binary_specificity': 0.75095046, 'binary_f1_score': 0.102884434}
confusion matrix:
       0     1
0  13629  4520
1    363   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51821667, 'precision': 0.5356978, 'recall': 0.7229717, 'specificity': 0.7229717, 'f1': 0.40302062, 'auroc': 0.91665435, 'binary_precision': 0.076046795, 'binary_recall': 0.9463602, 'binary_specificity': 0.49958313, 'binary_f1_score': 0.14078084}
confusion matrix:
      0     1
0  2996  3001
1    14   247
early stop counter: 14
val acc:0.7401553988456726, best validation acc: 0.9548212289810181, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 15,now: 2024-07-31 08:42:21.840956,epoch time: 0:17:04.075755,used: 4:17:29.369226,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_24_52_seed_0_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:17:29.369226 at 2024-07-31 08:42:21.840956
persisted model performance metric: 

scalar performance:
{'acc': 0.9697987, 'precision': 0.81176746, 'recall': 0.80833805, 'specificity': 0.80833805, 'f1': 0.81004214, 'auroc': 0.8863857, 'binary_precision': 0.6395349, 'binary_recall': 0.6321839, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.6358382}
confusion matrix:
      0    1
0  5904   93
1    96  165
oracle model performance metric: 

scalar performance:
{'acc': 0.9697987, 'precision': 0.81176746, 'recall': 0.80833805, 'specificity': 0.80833805, 'f1': 0.81004214, 'auroc': 0.8863857, 'binary_precision': 0.6395349, 'binary_recall': 0.6321839, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.6358382}
confusion matrix:
      0    1
0  5904   93
1    96  165
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool | 403328 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |  89819 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool | 403328 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |  89819 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB | 329615 GiB | 329615 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |  88733 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11486 MiB |  11486 MiB |  11486 MiB |      0 B   |
|       from large pool |  11360 MiB |  11360 MiB |  11360 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 749988 KiB |   1278 MiB | 126735 GiB | 126734 GiB |
|       from large pool | 741504 KiB |   1275 MiB | 125764 GiB | 125763 GiB |
|       from small pool |   8484 KiB |      9 MiB |    970 GiB |    970 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    8416    |   57546 K  |   57542 K  |
|       from large pool |      87    |     908    |   20828 K  |   20828 K  |
|       from small pool |    3642    |    8327    |   36718 K  |   36714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    8416    |   57546 K  |   57542 K  |
|       from large pool |      87    |     908    |   20828 K  |   20828 K  |
|       from small pool |    3642    |    8327    |   36718 K  |   36714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     406    |     406    |     406    |       0    |
|       from large pool |     343    |     343    |     343    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3617    |   31106 K  |   31106 K  |
|       from large pool |      19    |     188    |   13602 K  |   13602 K  |
|       from small pool |      55    |    3596    |   17503 K  |   17503 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 329615 GiB | 329615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |      0 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1214 MiB |  11486 MiB |  11486 MiB |  10272 MiB |
|       from large pool |   1118 MiB |  11360 MiB |  11360 MiB |  10242 MiB |
|       from small pool |     96 MiB |    126 MiB |    126 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 126735 GiB | 126735 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 125764 GiB | 125764 GiB |
|       from small pool |      0 KiB |     20 MiB |    971 GiB |    971 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     406    |     406    |     328    |
|       from large pool |      30    |     343    |     343    |     313    |
|       from small pool |      48    |      63    |      63    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3617    |   31107 K  |   31107 K  |
|       from large pool |       4    |     188    |   13602 K  |   13602 K  |
|       from small pool |       0    |    3596    |   17505 K  |   17505 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 333115 GiB | 333115 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 332200 GiB | 332200 GiB |
|       from small pool |      0 KiB |    125 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 329615 GiB | 329615 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 328712 GiB | 328711 GiB |
|       from small pool |      0 KiB |    124 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1214 MiB |  11486 MiB |  11486 MiB |  10272 MiB |
|       from large pool |   1118 MiB |  11360 MiB |  11360 MiB |  10242 MiB |
|       from small pool |     96 MiB |    126 MiB |    126 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 126735 GiB | 126735 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 125764 GiB | 125764 GiB |
|       from small pool |      0 KiB |     20 MiB |    971 GiB |    971 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8416    |   57546 K  |   57546 K  |
|       from large pool |       2    |     908    |   20828 K  |   20828 K  |
|       from small pool |       0    |    8327    |   36718 K  |   36718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     406    |     406    |     328    |
|       from large pool |      30    |     343    |     343    |     313    |
|       from small pool |      48    |      63    |      63    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3617    |   31107 K  |   31107 K  |
|       from large pool |       4    |     188    |   13602 K  |   13602 K  |
|       from small pool |       0    |    3596    |   17505 K  |   17505 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362

 Experiment start at: 2024-07-31 08:51:31.303304
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96490556, 'precision': 0.96499914, 'recall': 0.9649106, 'specificity': 0.9649106, 'f1': 0.96490407, 'auroc': 0.99305165, 'binary_precision': 0.9717705, 'binary_recall': 0.95768005, 'binary_specificity': 0.97214115, 'binary_f1_score': 0.9646739}
confusion matrix:
       0      1
0  27986    802
1   1220  27608
---- Validation: 
scalar performance:
{'acc': 0.92070436, 'precision': 0.5958549, 'recall': 0.6935111, 'specificity': 0.6935111, 'f1': 0.62350297, 'auroc': 0.7919059, 'binary_precision': 0.21312632, 'binary_recall': 0.448737, 'binary_specificity': 0.9382853, 'binary_f1_score': 0.2889952}
confusion matrix:
       0     1
0  16952  1115
1    371   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9273284, 'precision': 0.65505445, 'recall': 0.8094394, 'specificity': 0.8094394, 'f1': 0.7004478, 'auroc': 0.86406827, 'binary_precision': 0.32477063, 'binary_recall': 0.6807692, 'binary_specificity': 0.93810964, 'binary_f1_score': 0.4397515}
confusion matrix:
      0    1
0  5578  368
1    83  177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 09:09:23.668102,epoch time: 0:17:52.364798,used: 0:17:52.364798,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97353166, 'precision': 0.9736191, 'recall': 0.9735365, 'specificity': 0.9735365, 'f1': 0.97353065, 'auroc': 0.99487543, 'binary_precision': 0.98023003, 'binary_recall': 0.966595, 'binary_specificity': 0.980478, 'binary_f1_score': 0.9733648}
confusion matrix:
       0      1
0  28226    562
1    963  27865
---- Validation: 
scalar performance:
{'acc': 0.9300427, 'precision': 0.5989128, 'recall': 0.6640214, 'specificity': 0.6640214, 'f1': 0.6212557, 'auroc': 0.74599457, 'binary_precision': 0.22164048, 'binary_recall': 0.37741455, 'binary_specificity': 0.9506282, 'binary_f1_score': 0.2792743}
confusion matrix:
       0    1
0  17175  892
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9405414, 'precision': 0.68815196, 'recall': 0.8402417, 'specificity': 0.8402417, 'f1': 0.7378523, 'auroc': 0.9053617, 'binary_precision': 0.38854805, 'binary_recall': 0.7307692, 'binary_specificity': 0.94971406, 'binary_f1_score': 0.5073431}
confusion matrix:
      0    1
0  5647  299
1    70  190
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 09:26:37.202911,epoch time: 0:17:13.534809,used: 0:35:05.899607,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96329147, 'precision': 0.964306, 'recall': 0.9632745, 'specificity': 0.9632745, 'f1': 0.9632704, 'auroc': 0.9962515, 'binary_precision': 0.94278324, 'binary_recall': 0.98650664, 'binary_specificity': 0.9400424, 'binary_f1_score': 0.96414953}
confusion matrix:
       0      1
0  27061   1726
1    389  28440
---- Validation: 
scalar performance:
{'acc': 0.77630734, 'precision': 0.522979, 'recall': 0.61361635, 'specificity': 0.61361635, 'f1': 0.49758786, 'auroc': 0.6584208, 'binary_precision': 0.07179362, 'binary_recall': 0.4383358, 'binary_specificity': 0.78889686, 'binary_f1_score': 0.12337933}
confusion matrix:
       0     1
0  14253  3814
1    378   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72977763, 'precision': 0.56093705, 'recall': 0.82220113, 'specificity': 0.82220113, 'f1': 0.52950066, 'auroc': 0.9342059, 'binary_precision': 0.12651555, 'binary_recall': 0.9230769, 'binary_specificity': 0.7213253, 'binary_f1_score': 0.22253129}
confusion matrix:
      0     1
0  4289  1657
1    20   240
early stop counter: 1
val acc:0.7763073444366455, best validation acc: 0.9300426840782166, corresponding to test acc:                         0.9405413866043091 / 0.9405413866043091
after epoch: 3,now: 2024-07-31 09:44:05.003683,epoch time: 0:17:27.800772,used: 0:52:33.700379,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9729589, 'precision': 0.973725, 'recall': 0.972973, 'specificity': 0.972973, 'f1': 0.97294855, 'auroc': 0.99520004, 'binary_precision': 0.9929501, 'binary_recall': 0.95271957, 'binary_specificity': 0.99322635, 'binary_f1_score': 0.9724189}
confusion matrix:
       0      1
0  28593    195
1   1363  27465
---- Validation: 
scalar performance:
{'acc': 0.94546425, 'precision': 0.6239798, 'recall': 0.6412629, 'specificity': 0.6412629, 'f1': 0.6319416, 'auroc': 0.63445985, 'binary_precision': 0.27367055, 'binary_recall': 0.31352153, 'binary_specificity': 0.9690043, 'binary_f1_score': 0.29224378}
confusion matrix:
       0    1
0  17507  560
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.8379781, 'recall': 0.8205322, 'specificity': 0.8205322, 'f1': 0.82899714, 'auroc': 0.90907675, 'binary_precision': 0.6910569, 'binary_recall': 0.65384614, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.6719368}
confusion matrix:
      0    1
0  5870   76
1    90  170
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 10:01:30.417279,epoch time: 0:17:25.413596,used: 1:09:59.113975,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.946317, 'precision': 0.94983256, 'recall': 0.94628334, 'specificity': 0.94628334, 'f1': 0.9462091, 'auroc': 0.9960233, 'binary_precision': 0.910256, 'binary_recall': 0.9903573, 'binary_specificity': 0.9022094, 'binary_f1_score': 0.94861877}
confusion matrix:
       0      1
0  25971   2815
1    278  28552
---- Validation: 
scalar performance:
{'acc': 0.5714514, 'precision': 0.50124776, 'recall': 0.5088034, 'specificity': 0.5088034, 'f1': 0.39527345, 'auroc': 0.5658717, 'binary_precision': 0.037349094, 'binary_recall': 0.44130757, 'binary_specificity': 0.5762993, 'binary_f1_score': 0.06886956}
confusion matrix:
       0     1
0  10412  7655
1    376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.40315825, 'precision': 0.52981323, 'recall': 0.6719792, 'specificity': 0.6719792, 'f1': 0.3339881, 'auroc': 0.92984223, 'binary_precision': 0.06360872, 'binary_recall': 0.9653846, 'binary_specificity': 0.37857383, 'binary_f1_score': 0.11935331}
confusion matrix:
      0     1
0  2251  3695
1     9   251
early stop counter: 1
val acc:0.5714514255523682, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 5,now: 2024-07-31 10:18:50.472111,epoch time: 0:17:20.054832,used: 1:27:19.168807,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93421966, 'precision': 0.93920434, 'recall': 0.9341809, 'specificity': 0.9341809, 'f1': 0.93402845, 'auroc': 0.9946523, 'binary_precision': 0.8925962, 'binary_recall': 0.98733914, 'binary_specificity': 0.8810227, 'binary_f1_score': 0.9375803}
confusion matrix:
       0      1
0  25362   3425
1    365  28464
---- Validation: 
scalar performance:
{'acc': 0.491302, 'precision': 0.49556115, 'recall': 0.46795124, 'specificity': 0.46795124, 'f1': 0.35514897, 'auroc': 0.5496032, 'binary_precision': 0.031514384, 'binary_recall': 0.44279346, 'binary_specificity': 0.493109, 'binary_f1_score': 0.058840953}
confusion matrix:
      0     1
0  8909  9158
1   375   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.25475347, 'precision': 0.5256743, 'recall': 0.60740507, 'specificity': 0.60740507, 'f1': 0.23214051, 'auroc': 0.92296827, 'binary_precision': 0.05285802, 'binary_recall': 0.99230766, 'binary_specificity': 0.22250253, 'binary_f1_score': 0.10036958}
confusion matrix:
      0     1
0  1323  4623
1     2   258
early stop counter: 2
val acc:0.4913020133972168, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 6,now: 2024-07-31 10:36:07.060856,epoch time: 0:17:16.588745,used: 1:44:35.757552,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9139302, 'precision': 0.92355204, 'recall': 0.9138727, 'specificity': 0.9138727, 'f1': 0.9134306, 'auroc': 0.9944805, 'binary_precision': 0.8599041, 'binary_recall': 0.98914325, 'binary_specificity': 0.8386021, 'binary_f1_score': 0.92000705}
confusion matrix:
       0      1
0  24140   4646
1    313  28517
---- Validation: 
scalar performance:
{'acc': 0.47966915, 'precision': 0.49472043, 'recall': 0.46191812, 'specificity': 0.46191812, 'f1': 0.34911168, 'auroc': 0.54946816, 'binary_precision': 0.030804217, 'binary_recall': 0.44279346, 'binary_specificity': 0.48104277, 'binary_f1_score': 0.057601236}
confusion matrix:
      0     1
0  8691  9376
1   375   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.22526588, 'precision': 0.52565116, 'recall': 0.5956946, 'specificity': 0.5956946, 'f1': 0.2094425, 'auroc': 0.9283015, 'binary_precision': 0.051302288, 'binary_recall': 1.0, 'binary_specificity': 0.19138917, 'binary_f1_score': 0.09759759}
confusion matrix:
      0     1
0  1138  4808
1     0   260
early stop counter: 3
val acc:0.47966915369033813, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 7,now: 2024-07-31 10:53:41.486183,epoch time: 0:17:34.425327,used: 2:02:10.182879,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93217164, 'precision': 0.937164, 'recall': 0.9321346, 'specificity': 0.9321346, 'f1': 0.93197334, 'auroc': 0.99372005, 'binary_precision': 0.8906201, 'binary_recall': 0.9854655, 'binary_specificity': 0.8788037, 'binary_f1_score': 0.93564534}
confusion matrix:
       0      1
0  25299   3489
1    419  28409
---- Validation: 
scalar performance:
{'acc': 0.64994663, 'precision': 0.50714374, 'recall': 0.54665196, 'specificity': 0.54665196, 'f1': 0.43287247, 'auroc': 0.5570985, 'binary_precision': 0.04526495, 'binary_recall': 0.43536404, 'binary_specificity': 0.6579399, 'binary_f1_score': 0.082003914}
confusion matrix:
       0     1
0  11887  6180
1    380   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38366097, 'precision': 0.5294341, 'recall': 0.6654823, 'specificity': 0.6654823, 'f1': 0.3217498, 'auroc': 0.90472764, 'binary_precision': 0.06214689, 'binary_recall': 0.97307694, 'binary_specificity': 0.35788766, 'binary_f1_score': 0.11683214}
confusion matrix:
      0     1
0  2128  3818
1     7   253
early stop counter: 4
val acc:0.6499466300010681, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 8,now: 2024-07-31 11:11:57.961100,epoch time: 0:18:16.474917,used: 2:20:26.657796,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9384199, 'precision': 0.9422493, 'recall': 0.93838763, 'specificity': 0.93838763, 'f1': 0.93828315, 'auroc': 0.99432164, 'binary_precision': 0.90126985, 'binary_recall': 0.9848064, 'binary_specificity': 0.89196885, 'binary_f1_score': 0.9411882}
confusion matrix:
       0      1
0  25678   3110
1    438  28390
---- Validation: 
scalar performance:
{'acc': 0.6575774, 'precision': 0.5075049, 'recall': 0.54846364, 'specificity': 0.54846364, 'f1': 0.43619096, 'auroc': 0.56831765, 'binary_precision': 0.045857053, 'binary_recall': 0.4309064, 'binary_specificity': 0.66602093, 'binary_f1_score': 0.08289267}
confusion matrix:
       0     1
0  12033  6034
1    383   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39397356, 'precision': 0.53064865, 'recall': 0.674542, 'specificity': 0.674542, 'f1': 0.32871372, 'auroc': 0.90902865, 'binary_precision': 0.06357517, 'binary_recall': 0.9807692, 'binary_specificity': 0.36831483, 'binary_f1_score': 0.11940998}
confusion matrix:
      0     1
0  2190  3756
1     5   255
early stop counter: 5
val acc:0.657577395439148, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 9,now: 2024-07-31 11:29:34.070113,epoch time: 0:17:36.109013,used: 2:38:02.766809,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8972334, 'precision': 0.9101839, 'recall': 0.8971718, 'specificity': 0.8971718, 'f1': 0.8964054, 'auroc': 0.9922987, 'binary_precision': 0.8374731, 'binary_recall': 0.9859512, 'binary_specificity': 0.8083924, 'binary_f1_score': 0.905667}
confusion matrix:
       0      1
0  23272   5516
1    405  28423
---- Validation: 
scalar performance:
{'acc': 0.5410886, 'precision': 0.49873063, 'recall': 0.4909107, 'specificity': 0.4909107, 'f1': 0.38001177, 'auroc': 0.54495686, 'binary_precision': 0.034527306, 'binary_recall': 0.43684992, 'binary_specificity': 0.54497147, 'binary_f1_score': 0.063996516}
confusion matrix:
      0     1
0  9846  8221
1   379   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.33306476, 'precision': 0.5280486, 'recall': 0.6445949, 'specificity': 0.6445949, 'f1': 0.28838816, 'auroc': 0.8458586, 'binary_precision': 0.05830107, 'binary_recall': 0.9846154, 'binary_specificity': 0.3045745, 'binary_f1_score': 0.110083856}
confusion matrix:
      0     1
0  1811  4135
1     4   256
early stop counter: 6
val acc:0.5410885810852051, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 10,now: 2024-07-31 11:47:04.231190,epoch time: 0:17:30.161077,used: 2:55:32.927886,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8901867, 'precision': 0.9050107, 'recall': 0.8901137, 'specificity': 0.8901137, 'f1': 0.8891594, 'auroc': 0.9916717, 'binary_precision': 0.82771677, 'binary_recall': 0.9857093, 'binary_specificity': 0.7945182, 'binary_f1_score': 0.8998306}
confusion matrix:
       0      1
0  22871   5915
1    412  28418
---- Validation: 
scalar performance:
{'acc': 0.5577908, 'precision': 0.499638, 'recall': 0.4974271, 'specificity': 0.4974271, 'f1': 0.387989, 'auroc': 0.53128284, 'binary_precision': 0.035505123, 'binary_recall': 0.43239227, 'binary_specificity': 0.562462, 'binary_f1_score': 0.06562183}
confusion matrix:
       0     1
0  10162  7905
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32468578, 'precision': 0.5280571, 'recall': 0.64206123, 'specificity': 0.64206123, 'f1': 0.28272706, 'auroc': 0.8738525, 'binary_precision': 0.057817772, 'binary_recall': 0.98846155, 'binary_specificity': 0.29566094, 'binary_f1_score': 0.10924548}
confusion matrix:
      0     1
0  1758  4188
1     3   257
early stop counter: 7
val acc:0.5577908158302307, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 11,now: 2024-07-31 12:04:36.294436,epoch time: 0:17:32.063246,used: 3:13:04.991132,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.88569146, 'precision': 0.90267295, 'recall': 0.88561666, 'specificity': 0.88561666, 'f1': 0.88445926, 'auroc': 0.99120414, 'binary_precision': 0.82016295, 'binary_recall': 0.988241, 'binary_specificity': 0.7829923, 'binary_f1_score': 0.89639115}
confusion matrix:
       0      1
0  22540   6247
1    339  28490
---- Validation: 
scalar performance:
{'acc': 0.4995731, 'precision': 0.49595726, 'recall': 0.4708103, 'specificity': 0.4708103, 'f1': 0.35924196, 'auroc': 0.52474254, 'binary_precision': 0.031838227, 'binary_recall': 0.4398217, 'binary_specificity': 0.50179887, 'binary_f1_score': 0.059378132}
confusion matrix:
      0     1
0  9066  9001
1   377   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.18498227, 'precision': 0.5244453, 'recall': 0.57467204, 'specificity': 0.57467204, 'f1': 0.17655024, 'auroc': 0.8954187, 'binary_precision': 0.04889056, 'binary_recall': 1.0, 'binary_specificity': 0.1493441, 'binary_f1_score': 0.09322338}
confusion matrix:
     0     1
0  888  5058
1    0   260
early stop counter: 8
val acc:0.49957311153411865, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 12,now: 2024-07-31 12:23:10.847669,epoch time: 0:18:34.553233,used: 3:31:39.544365,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.898431, 'precision': 0.9104507, 'recall': 0.89837164, 'specificity': 0.89837164, 'f1': 0.89767206, 'auroc': 0.99140334, 'binary_precision': 0.8403852, 'binary_recall': 0.98386985, 'binary_specificity': 0.8128734, 'binary_f1_score': 0.9064848}
confusion matrix:
       0      1
0  23401   5387
1    465  28363
---- Validation: 
scalar performance:
{'acc': 0.47758806, 'precision': 0.49447012, 'recall': 0.46012354, 'specificity': 0.46012354, 'f1': 0.34794772, 'auroc': 0.53373206, 'binary_precision': 0.030583873, 'binary_recall': 0.44130757, 'binary_specificity': 0.4789395, 'binary_f1_score': 0.05720339}
confusion matrix:
      0     1
0  8653  9414
1   376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.26023203, 'precision': 0.5263381, 'recall': 0.61210316, 'specificity': 0.61210316, 'f1': 0.23637196, 'auroc': 0.84165215, 'binary_precision': 0.053413074, 'binary_recall': 0.99615383, 'binary_specificity': 0.22805247, 'binary_f1_score': 0.101389706}
confusion matrix:
      0     1
0  1356  4590
1     1   259
early stop counter: 9
val acc:0.47758805751800537, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 13,now: 2024-07-31 12:40:42.967891,epoch time: 0:17:32.120222,used: 3:49:11.664587,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8776208, 'precision': 0.8967468, 'recall': 0.877537, 'specificity': 0.877537, 'f1': 0.8761107, 'auroc': 0.9888751, 'binary_precision': 0.80982727, 'binary_recall': 0.9872702, 'binary_specificity': 0.7678038, 'binary_f1_score': 0.88978845}
confusion matrix:
       0      1
0  22102   6684
1    367  28463
---- Validation: 
scalar performance:
{'acc': 0.40298826, 'precision': 0.48923972, 'recall': 0.42501056, 'specificity': 0.42501056, 'f1': 0.30784354, 'auroc': 0.5117636, 'binary_precision': 0.027160715, 'binary_recall': 0.448737, 'binary_specificity': 0.4012841, 'binary_f1_score': 0.051221166}
confusion matrix:
      0      1
0  7250  10817
1   371    302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.15356107, 'precision': 0.5235806, 'recall': 0.55827445, 'specificity': 0.55827445, 'f1': 0.14942044, 'auroc': 0.84434605, 'binary_precision': 0.047161255, 'binary_recall': 1.0, 'binary_specificity': 0.11654894, 'binary_f1_score': 0.09007449}
confusion matrix:
     0     1
0  693  5253
1    0   260
early stop counter: 10
val acc:0.4029882550239563, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 14,now: 2024-07-31 12:58:13.064365,epoch time: 0:17:30.096474,used: 4:06:41.761061,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.88006806, 'precision': 0.8980427, 'recall': 0.8799906, 'specificity': 0.8799906, 'f1': 0.8786831, 'auroc': 0.9904189, 'binary_precision': 0.81363934, 'binary_recall': 0.98619443, 'binary_specificity': 0.7737868, 'binary_f1_score': 0.89164525}
confusion matrix:
       0      1
0  22275   6512
1    398  28431
---- Validation: 
scalar performance:
{'acc': 0.4576841, 'precision': 0.49300727, 'recall': 0.44980085, 'specificity': 0.44980085, 'f1': 0.33745536, 'auroc': 0.51430523, 'binary_precision': 0.029452598, 'binary_recall': 0.44130757, 'binary_specificity': 0.45829412, 'binary_f1_score': 0.055219855}
confusion matrix:
      0     1
0  8280  9787
1   376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.25894296, 'precision': 0.5262919, 'recall': 0.6114304, 'specificity': 0.6114304, 'f1': 0.2353997, 'auroc': 0.7877212, 'binary_precision': 0.053325098, 'binary_recall': 0.99615383, 'binary_specificity': 0.22670703, 'binary_f1_score': 0.101231195}
confusion matrix:
      0     1
0  1348  4598
1     1   259
early stop counter: 11
val acc:0.45768409967422485, best validation acc: 0.9454642534255981, corresponding to test acc:                         0.9732517004013062 / 0.9732517004013062
after epoch: 15,now: 2024-07-31 13:15:57.273496,epoch time: 0:17:44.209131,used: 4:24:25.970192,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_08_51_31_seed_1_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:24:25.970192 at 2024-07-31 13:15:57.273496
persisted model performance metric: 

scalar performance:
{'acc': 0.9732517, 'precision': 0.8379781, 'recall': 0.8205322, 'specificity': 0.8205322, 'f1': 0.82899714, 'auroc': 0.90907675, 'binary_precision': 0.6910569, 'binary_recall': 0.65384614, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.6719368}
confusion matrix:
      0    1
0  5870   76
1    90  170
oracle model performance metric: 

scalar performance:
{'acc': 0.9732517, 'precision': 0.8379781, 'recall': 0.8205322, 'specificity': 0.8205322, 'f1': 0.82899714, 'auroc': 0.90907675, 'binary_precision': 0.6910569, 'binary_recall': 0.65384614, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.6719368}
confusion matrix:
      0    1
0  5870   76
1    90  170
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10996 MiB | 670779 GiB | 670778 GiB |
|       from large pool | 403840 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |  89807 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10996 MiB | 670779 GiB | 670778 GiB |
|       from large pool | 403840 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |  89807 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB | 664547 GiB | 664546 GiB |
|       from large pool | 387840 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |  88730 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11486 MiB |  21732 MiB |  10272 MiB |
|       from large pool |  11336 MiB |  11360 MiB |  21578 MiB |  10242 MiB |
|       from small pool |    124 MiB |    126 MiB |    154 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 524208 KiB |   1278 MiB | 302958 GiB | 302957 GiB |
|       from large pool | 511616 KiB |   1275 MiB | 300976 GiB | 300975 GiB |
|       from small pool |  12592 KiB |     20 MiB |   1982 GiB |   1982 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    8448    |  115764 K  |  115760 K  |
|       from large pool |      87    |     908    |   41973 K  |   41973 K  |
|       from small pool |    3618    |    8359    |   73791 K  |   73787 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    8448    |  115764 K  |  115760 K  |
|       from large pool |      87    |     908    |   41973 K  |   41973 K  |
|       from small pool |    3618    |    8359    |   73791 K  |   73787 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     406    |     727    |     328    |
|       from large pool |     337    |     343    |     650    |     313    |
|       from small pool |      62    |      63    |      77    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    3631    |   61870 K  |   61870 K  |
|       from large pool |      20    |     188    |   26688 K  |   26688 K  |
|       from small pool |      60    |    3610    |   35182 K  |   35182 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 670779 GiB | 670779 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 670779 GiB | 670779 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 664547 GiB | 664547 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |      0 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    994 MiB |  11486 MiB |  21732 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11360 MiB |  21578 MiB |  20684 MiB |
|       from small pool |    100 MiB |    126 MiB |    154 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 302958 GiB | 302958 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 300976 GiB | 300976 GiB |
|       from small pool |      0 KiB |     40 MiB |   1982 GiB |   1982 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  115764 K  |  115764 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73791 K  |   73791 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  115764 K  |  115764 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73791 K  |   73791 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     406    |     727    |     644    |
|       from large pool |      33    |     343    |     650    |     617    |
|       from small pool |      50    |      63    |      77    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   61872 K  |   61872 K  |
|       from large pool |       4    |     188    |   26688 K  |   26688 K  |
|       from small pool |       0    |    3610    |   35183 K  |   35183 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB | 670779 GiB | 670779 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB | 670779 GiB | 670779 GiB |
|       from large pool |  16640 KiB |  10923 MiB | 668929 GiB | 668929 GiB |
|       from small pool |      0 KiB |    125 MiB |   1849 GiB |   1849 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB | 664547 GiB | 664547 GiB |
|       from large pool |  16640 KiB |  10808 MiB | 662719 GiB | 662719 GiB |
|       from small pool |      0 KiB |    124 MiB |   1827 GiB |   1827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    994 MiB |  11486 MiB |  21732 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11360 MiB |  21578 MiB |  20684 MiB |
|       from small pool |    100 MiB |    126 MiB |    154 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 302958 GiB | 302958 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 300976 GiB | 300976 GiB |
|       from small pool |      0 KiB |     40 MiB |   1982 GiB |   1982 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8448    |  115764 K  |  115764 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73791 K  |   73791 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8448    |  115764 K  |  115764 K  |
|       from large pool |       2    |     908    |   41973 K  |   41973 K  |
|       from small pool |       0    |    8359    |   73791 K  |   73791 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     406    |     727    |     644    |
|       from large pool |      33    |     343    |     650    |     617    |
|       from small pool |      50    |      63    |      77    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   61872 K  |   61872 K  |
|       from large pool |       4    |     188    |   26688 K  |   26688 K  |
|       from small pool |       0    |    3610    |   35183 K  |   35183 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362

 Experiment start at: 2024-07-31 13:25:22.751536
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9597798, 'precision': 0.9617251, 'recall': 0.9597865, 'specificity': 0.9597865, 'f1': 0.9597378, 'auroc': 0.993201, 'binary_precision': 0.9917471, 'binary_recall': 0.9272927, 'binary_specificity': 0.99228024, 'binary_f1_score': 0.9584375}
confusion matrix:
       0      1
0  28921    225
1   2120  27038
---- Validation: 
scalar performance:
{'acc': 0.9571725, 'precision': 0.6559581, 'recall': 0.6574605, 'specificity': 0.6574605, 'f1': 0.6567052, 'auroc': 0.8181431, 'binary_precision': 0.3338816, 'binary_recall': 0.3372093, 'binary_specificity': 0.97771174, 'binary_f1_score': 0.3355372}
confusion matrix:
       0    1
0  17766  405
1    399  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97323287, 'precision': 0.8421013, 'recall': 0.7640094, 'specificity': 0.7640094, 'f1': 0.79752076, 'auroc': 0.8520107, 'binary_precision': 0.7027027, 'binary_recall': 0.5371901, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.6088993}
confusion matrix:
      0    1
0  5942   55
1   112  130
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 13:43:56.215372,epoch time: 0:18:33.463836,used: 0:18:33.463836,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97049946, 'precision': 0.97050226, 'recall': 0.97049916, 'specificity': 0.97049916, 'f1': 0.9704994, 'auroc': 0.994642, 'binary_precision': 0.96941185, 'binary_recall': 0.97167253, 'binary_specificity': 0.9693258, 'binary_f1_score': 0.9705409}
confusion matrix:
       0      1
0  28251    894
1    826  28333
---- Validation: 
scalar performance:
{'acc': 0.89106697, 'precision': 0.551884, 'recall': 0.6538285, 'specificity': 0.6538285, 'f1': 0.5661716, 'auroc': 0.67590964, 'binary_precision': 0.1251948, 'binary_recall': 0.4003322, 'binary_specificity': 0.90732485, 'binary_f1_score': 0.19074}
confusion matrix:
       0     1
0  16487  1684
1    361   241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8783459, 'precision': 0.6051054, 'recall': 0.85344326, 'specificity': 0.85344326, 'f1': 0.63903487, 'auroc': 0.90727186, 'binary_precision': 0.21810251, 'binary_recall': 0.8264463, 'binary_specificity': 0.88044024, 'binary_f1_score': 0.34512514}
confusion matrix:
      0    1
0  5280  717
1    42  200
early stop counter: 1
val acc:0.8910669684410095, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 2,now: 2024-07-31 14:03:02.133866,epoch time: 0:19:05.918494,used: 0:37:39.382330,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95381105, 'precision': 0.9553408, 'recall': 0.9538051, 'specificity': 0.9538051, 'f1': 0.9537718, 'auroc': 0.99465, 'binary_precision': 0.92899984, 'binary_recall': 0.98274916, 'binary_specificity': 0.9248611, 'binary_f1_score': 0.9551189}
confusion matrix:
       0      1
0  26956   2190
1    503  28655
---- Validation: 
scalar performance:
{'acc': 0.7108613, 'precision': 0.5115817, 'recall': 0.57599854, 'specificity': 0.57599854, 'f1': 0.45782065, 'auroc': 0.5718155, 'binary_precision': 0.04863449, 'binary_recall': 0.43189368, 'binary_specificity': 0.72010344, 'binary_f1_score': 0.087424345}
confusion matrix:
       0     1
0  13085  5086
1    342   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.550569, 'precision': 0.53442204, 'recall': 0.7305271, 'specificity': 0.7305271, 'f1': 0.4169188, 'auroc': 0.91951346, 'binary_precision': 0.074418604, 'binary_recall': 0.92561984, 'binary_specificity': 0.53543437, 'binary_f1_score': 0.13776138}
confusion matrix:
      0     1
0  3211  2786
1    18   224
early stop counter: 2
val acc:0.710861325263977, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 3,now: 2024-07-31 14:21:19.414168,epoch time: 0:18:17.280302,used: 0:55:56.662632,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9387349, 'precision': 0.9417617, 'recall': 0.938725, 'specificity': 0.938725, 'f1': 0.9386288, 'auroc': 0.9926052, 'binary_precision': 0.90525514, 'binary_recall': 0.98007476, 'binary_specificity': 0.89737517, 'binary_f1_score': 0.9411803}
confusion matrix:
       0      1
0  26154   2991
1    581  28578
---- Validation: 
scalar performance:
{'acc': 0.70185906, 'precision': 0.50949293, 'recall': 0.56331784, 'specificity': 0.56331784, 'f1': 0.4520184, 'auroc': 0.53294635, 'binary_precision': 0.045495905, 'binary_recall': 0.4152824, 'binary_specificity': 0.71135324, 'binary_f1_score': 0.08200754}
confusion matrix:
       0     1
0  12926  5245
1    352   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49190575, 'precision': 0.5315374, 'recall': 0.70992553, 'specificity': 0.70992553, 'f1': 0.38402414, 'auroc': 0.90727115, 'binary_precision': 0.06763142, 'binary_recall': 0.946281, 'binary_specificity': 0.4735701, 'binary_f1_score': 0.12624036}
confusion matrix:
      0     1
0  2840  3157
1    13   229
early stop counter: 3
val acc:0.7018590569496155, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 4,now: 2024-07-31 14:41:11.019479,epoch time: 0:19:51.605311,used: 1:15:48.267943,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9383404, 'precision': 0.94269204, 'recall': 0.9383353, 'specificity': 0.9383353, 'f1': 0.938188, 'auroc': 0.99521077, 'binary_precision': 0.8988266, 'binary_recall': 0.98789227, 'binary_specificity': 0.8887783, 'binary_f1_score': 0.9412572}
confusion matrix:
       0      1
0  25907   3242
1    353  28802
---- Validation: 
scalar performance:
{'acc': 0.64076066, 'precision': 0.5058266, 'recall': 0.5429992, 'specificity': 0.5429992, 'f1': 0.42492092, 'auroc': 0.55467695, 'binary_precision': 0.03958021, 'binary_recall': 0.4385382, 'binary_specificity': 0.6474602, 'binary_f1_score': 0.072607264}
confusion matrix:
       0     1
0  11765  6406
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34973553, 'precision': 0.5267058, 'recall': 0.6538166, 'specificity': 0.6538166, 'f1': 0.29718605, 'auroc': 0.9035461, 'binary_precision': 0.055464927, 'binary_recall': 0.9834711, 'binary_specificity': 0.3241621, 'binary_f1_score': 0.10500772}
confusion matrix:
      0     1
0  1944  4053
1     4   238
early stop counter: 4
val acc:0.6407606601715088, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 5,now: 2024-07-31 15:01:03.540026,epoch time: 0:19:52.520547,used: 1:35:40.788490,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.960483, 'precision': 0.9618025, 'recall': 0.9604784, 'specificity': 0.9604784, 'f1': 0.96045446, 'auroc': 0.9961312, 'binary_precision': 0.93716013, 'binary_recall': 0.9871729, 'binary_specificity': 0.93378395, 'binary_f1_score': 0.96151656}
confusion matrix:
       0      1
0  27217   1930
1    374  28783
---- Validation: 
scalar performance:
{'acc': 0.73232836, 'precision': 0.514185, 'recall': 0.58869374, 'specificity': 0.58869374, 'f1': 0.46869272, 'auroc': 0.5638528, 'binary_precision': 0.05296139, 'binary_recall': 0.43521595, 'binary_specificity': 0.7421716, 'binary_f1_score': 0.09443143}
confusion matrix:
       0     1
0  13486  4685
1    340   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49911845, 'precision': 0.5323284, 'recall': 0.71566015, 'specificity': 0.71566015, 'f1': 0.38845623, 'auroc': 0.91510904, 'binary_precision': 0.06880048, 'binary_recall': 0.9504132, 'binary_specificity': 0.4809071, 'binary_f1_score': 0.12831242}
confusion matrix:
      0     1
0  2884  3113
1    12   230
early stop counter: 5
val acc:0.7323283553123474, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 6,now: 2024-07-31 15:19:06.644000,epoch time: 0:18:03.103974,used: 1:53:43.892464,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95106685, 'precision': 0.9535284, 'recall': 0.9510592, 'specificity': 0.9510592, 'f1': 0.9509998, 'auroc': 0.9957155, 'binary_precision': 0.9201674, 'binary_recall': 0.98785925, 'binary_specificity': 0.91425925, 'binary_f1_score': 0.95281255}
confusion matrix:
       0      1
0  26647   2499
1    354  28804
---- Validation: 
scalar performance:
{'acc': 0.7425025, 'precision': 0.5151609, 'recall': 0.5923433, 'specificity': 0.5923433, 'f1': 0.47348103, 'auroc': 0.5659312, 'binary_precision': 0.054713804, 'binary_recall': 0.43189368, 'binary_specificity': 0.7527929, 'binary_f1_score': 0.097123645}
confusion matrix:
       0     1
0  13679  4492
1    342   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39814073, 'precision': 0.5282801, 'recall': 0.67503035, 'specificity': 0.67503035, 'f1': 0.32828337, 'auroc': 0.8911129, 'binary_precision': 0.059222084, 'binary_recall': 0.9752066, 'binary_specificity': 0.3748541, 'binary_f1_score': 0.11166312}
confusion matrix:
      0     1
0  2248  3749
1     6   236
early stop counter: 6
val acc:0.7425025105476379, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 7,now: 2024-07-31 15:38:26.903492,epoch time: 0:19:20.259492,used: 2:13:04.151956,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97633094, 'precision': 0.97637874, 'recall': 0.9763303, 'specificity': 0.9763303, 'f1': 0.9763304, 'auroc': 0.99633497, 'binary_precision': 0.97164303, 'binary_recall': 0.98130745, 'binary_specificity': 0.9713531, 'binary_f1_score': 0.97645134}
confusion matrix:
       0      1
0  28313    835
1    545  28611
---- Validation: 
scalar performance:
{'acc': 0.8838225, 'precision': 0.5474515, 'recall': 0.6492833, 'specificity': 0.6492833, 'f1': 0.55893177, 'auroc': 0.5747068, 'binary_precision': 0.116561435, 'binary_recall': 0.3986711, 'binary_specificity': 0.8998954, 'binary_f1_score': 0.18038331}
confusion matrix:
       0     1
0  16352  1819
1    362   240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77272, 'precision': 0.5616684, 'recall': 0.81436104, 'specificity': 0.81436104, 'f1': 0.54680306, 'auroc': 0.899469, 'binary_precision': 0.13065326, 'binary_recall': 0.8595041, 'binary_specificity': 0.76921797, 'binary_f1_score': 0.2268266}
confusion matrix:
      0     1
0  4613  1384
1    34   208
early stop counter: 7
val acc:0.883822500705719, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 8,now: 2024-07-31 15:56:42.220728,epoch time: 0:18:15.317236,used: 2:31:19.469192,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93998694, 'precision': 0.94442374, 'recall': 0.93998015, 'specificity': 0.93998015, 'f1': 0.9398362, 'auroc': 0.9962901, 'binary_precision': 0.900053, 'binary_recall': 0.9899163, 'binary_specificity': 0.8900439, 'binary_f1_score': 0.9428483}
confusion matrix:
       0      1
0  25943   3205
1    294  28862
---- Validation: 
scalar performance:
{'acc': 0.7648751, 'precision': 0.51830244, 'recall': 0.6047032, 'specificity': 0.6047032, 'f1': 0.4851982, 'auroc': 0.6167683, 'binary_precision': 0.060221504, 'binary_recall': 0.43355483, 'binary_specificity': 0.7758516, 'binary_f1_score': 0.10575365}
confusion matrix:
       0     1
0  14098  4073
1    341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5114602, 'precision': 0.5334915, 'recall': 0.7240628, 'specificity': 0.7240628, 'f1': 0.3958744, 'auroc': 0.89672315, 'binary_precision': 0.07068543, 'binary_recall': 0.95454544, 'binary_specificity': 0.49358013, 'binary_f1_score': 0.13162392}
confusion matrix:
      0     1
0  2960  3037
1    11   231
early stop counter: 8
val acc:0.7648751139640808, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 9,now: 2024-07-31 16:14:46.442279,epoch time: 0:18:04.221551,used: 2:49:23.690743,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94641876, 'precision': 0.9495325, 'recall': 0.9464116, 'specificity': 0.9464116, 'f1': 0.94632524, 'auroc': 0.9955696, 'binary_precision': 0.91216236, 'binary_recall': 0.98799604, 'binary_specificity': 0.90482724, 'binary_f1_score': 0.94856596}
confusion matrix:
       0      1
0  26373   2774
1    350  28807
---- Validation: 
scalar performance:
{'acc': 0.7539019, 'precision': 0.51663435, 'recall': 0.5982318, 'specificity': 0.5982318, 'f1': 0.47930056, 'auroc': 0.57528853, 'binary_precision': 0.057293963, 'binary_recall': 0.43189368, 'binary_specificity': 0.76456994, 'binary_f1_score': 0.101167314}
confusion matrix:
       0     1
0  13893  4278
1    342   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6105145, 'precision': 0.5382201, 'recall': 0.74981296, 'specificity': 0.74981296, 'f1': 0.44965968, 'auroc': 0.87902695, 'binary_precision': 0.08307927, 'binary_recall': 0.90082645, 'binary_specificity': 0.5987994, 'binary_f1_score': 0.1521284}
confusion matrix:
      0     1
0  3591  2406
1    24   218
early stop counter: 9
val acc:0.7539018988609314, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 10,now: 2024-07-31 16:32:46.486419,epoch time: 0:18:00.044140,used: 3:07:23.734883,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92808384, 'precision': 0.93483496, 'recall': 0.92806673, 'specificity': 0.92806673, 'f1': 0.92780167, 'auroc': 0.9953971, 'binary_precision': 0.88072217, 'binary_recall': 0.9903292, 'binary_specificity': 0.86580426, 'binary_f1_score': 0.9323153}
confusion matrix:
       0      1
0  25233   3911
1    282  28878
---- Validation: 
scalar performance:
{'acc': 0.5891973, 'precision': 0.5018984, 'recall': 0.5147573, 'specificity': 0.5147573, 'f1': 0.40025234, 'auroc': 0.5692053, 'binary_precision': 0.034320146, 'binary_recall': 0.43521595, 'binary_specificity': 0.5942986, 'binary_f1_score': 0.063623115}
confusion matrix:
       0     1
0  10799  7372
1    340   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32633436, 'precision': 0.52345836, 'recall': 0.6297474, 'specificity': 0.6297474, 'f1': 0.28066707, 'auroc': 0.813874, 'binary_precision': 0.052429378, 'binary_recall': 0.9586777, 'binary_specificity': 0.30081707, 'binary_f1_score': 0.09942147}
confusion matrix:
      0     1
0  1804  4193
1    10   232
early stop counter: 10
val acc:0.5891972780227661, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 11,now: 2024-07-31 16:50:50.565728,epoch time: 0:18:04.079309,used: 3:25:27.814192,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92448205, 'precision': 0.93232757, 'recall': 0.9244705, 'specificity': 0.9244705, 'f1': 0.9241365, 'auroc': 0.9952675, 'binary_precision': 0.87413096, 'binary_recall': 0.991803, 'binary_specificity': 0.857138, 'binary_f1_score': 0.9292566}
confusion matrix:
       0      1
0  24983   4164
1    239  28918
---- Validation: 
scalar performance:
{'acc': 0.6135407, 'precision': 0.504013, 'recall': 0.53054446, 'specificity': 0.53054446, 'f1': 0.41226363, 'auroc': 0.5670284, 'binary_precision': 0.037021574, 'binary_recall': 0.44186047, 'binary_specificity': 0.6192284, 'binary_f1_score': 0.06831899}
confusion matrix:
       0     1
0  11252  6919
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4055137, 'precision': 0.5283246, 'recall': 0.67688286, 'specificity': 0.67688286, 'f1': 0.3327729, 'auroc': 0.8807791, 'binary_precision': 0.059690118, 'binary_recall': 0.9710744, 'binary_specificity': 0.38269135, 'binary_f1_score': 0.11246709}
confusion matrix:
      0     1
0  2295  3702
1     7   235
early stop counter: 11
val acc:0.6135407090187073, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 12,now: 2024-07-31 17:09:39.467967,epoch time: 0:18:48.902239,used: 3:44:16.716431,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9087027, 'precision': 0.92001885, 'recall': 0.90868855, 'specificity': 0.90868855, 'f1': 0.9080815, 'auroc': 0.99477386, 'binary_precision': 0.85111964, 'binary_recall': 0.99073976, 'binary_specificity': 0.8266374, 'binary_f1_score': 0.91563785}
confusion matrix:
       0      1
0  24094   5053
1    270  28887
---- Validation: 
scalar performance:
{'acc': 0.61615086, 'precision': 0.5043065, 'recall': 0.53269583, 'specificity': 0.53269583, 'f1': 0.41361442, 'auroc': 0.57655203, 'binary_precision': 0.037405435, 'binary_recall': 0.4435216, 'binary_specificity': 0.62187004, 'binary_f1_score': 0.06899225}
confusion matrix:
       0     1
0  11300  6871
1    335   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3955762, 'precision': 0.52815217, 'recall': 0.67369634, 'specificity': 0.67369634, 'f1': 0.3266593, 'auroc': 0.85342705, 'binary_precision': 0.058985252, 'binary_recall': 0.9752066, 'binary_specificity': 0.3721861, 'binary_f1_score': 0.11124204}
confusion matrix:
      0     1
0  2232  3765
1     6   236
early stop counter: 12
val acc:0.6161508560180664, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 13,now: 2024-07-31 17:29:02.030000,epoch time: 0:19:22.562033,used: 4:03:39.278464,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9385806, 'precision': 0.9436058, 'recall': 0.93857324, 'specificity': 0.93857324, 'f1': 0.9384054, 'auroc': 0.9966996, 'binary_precision': 0.8964256, 'binary_recall': 0.9917684, 'binary_specificity': 0.88537806, 'binary_f1_score': 0.94168985}
confusion matrix:
       0      1
0  25807   3341
1    240  28916
---- Validation: 
scalar performance:
{'acc': 0.7173068, 'precision': 0.512864, 'recall': 0.5833433, 'specificity': 0.5833433, 'f1': 0.4617172, 'auroc': 0.5733249, 'binary_precision': 0.05062082, 'binary_recall': 0.44019935, 'binary_specificity': 0.7264873, 'binary_f1_score': 0.09080007}
confusion matrix:
       0     1
0  13201  4970
1    337   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4340439, 'precision': 0.529847, 'recall': 0.69172364, 'specificity': 0.69172364, 'f1': 0.35046586, 'auroc': 0.91387916, 'binary_precision': 0.06251663, 'binary_recall': 0.9710744, 'binary_specificity': 0.41237286, 'binary_f1_score': 0.11747064}
confusion matrix:
      0     1
0  2473  3524
1     7   235
early stop counter: 13
val acc:0.7173067927360535, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 14,now: 2024-07-31 17:49:38.537409,epoch time: 0:20:36.507409,used: 4:24:15.785873,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9091143, 'precision': 0.9213971, 'recall': 0.9090997, 'specificity': 0.9090997, 'f1': 0.908445, 'auroc': 0.9961338, 'binary_precision': 0.84949607, 'binary_recall': 0.9944439, 'binary_specificity': 0.82375544, 'binary_f1_score': 0.91627294}
confusion matrix:
       0      1
0  24010   5137
1    162  28995
---- Validation: 
scalar performance:
{'acc': 0.6311724, 'precision': 0.50595033, 'recall': 0.54447067, 'specificity': 0.54447067, 'f1': 0.42132136, 'auroc': 0.6169575, 'binary_precision': 0.039615497, 'binary_recall': 0.45182723, 'binary_specificity': 0.6371141, 'binary_f1_score': 0.07284413}
confusion matrix:
       0     1
0  11577  6594
1    330   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.21974675, 'precision': 0.52314836, 'recall': 0.59214765, 'specificity': 0.59214765, 'f1': 0.20357648, 'auroc': 0.89982164, 'binary_precision': 0.04718089, 'binary_recall': 0.9958678, 'binary_specificity': 0.18842755, 'binary_f1_score': 0.090093456}
confusion matrix:
      0     1
0  1130  4867
1     1   241
early stop counter: 14
val acc:0.6311724185943604, best validation acc: 0.9571725130081177, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 15,now: 2024-07-31 18:09:38.492443,epoch time: 0:19:59.955034,used: 4:44:15.740907,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_13_25_22_seed_2_23775362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:44:15.740907 at 2024-07-31 18:09:38.492443
persisted model performance metric: 

scalar performance:
{'acc': 0.97323287, 'precision': 0.8421013, 'recall': 0.7640094, 'specificity': 0.7640094, 'f1': 0.79752076, 'auroc': 0.8520107, 'binary_precision': 0.7027027, 'binary_recall': 0.5371901, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.6088993}
confusion matrix:
      0    1
0  5942   55
1   112  130
oracle model performance metric: 

scalar performance:
{'acc': 0.97323287, 'precision': 0.8421013, 'recall': 0.7640094, 'specificity': 0.7640094, 'f1': 0.79752076, 'auroc': 0.8520107, 'binary_precision': 0.7027027, 'binary_recall': 0.5371901, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.6088993}
confusion matrix:
      0    1
0  5942   55
1   112  130
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491221 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool | 401408 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491221 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool | 401408 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |  89813 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10880 MiB |    990 TiB |    990 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    988 TiB |    988 TiB |
|       from small pool |  88732 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11504 MiB |  11504 MiB |  32242 MiB |  20738 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32064 MiB |  20684 MiB |
|       from small pool |    124 MiB |    126 MiB |    178 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 635178 KiB |   1278 MiB | 460396 GiB | 460395 GiB |
|       from large pool | 626688 KiB |   1275 MiB | 457363 GiB | 457363 GiB |
|       from small pool |   8490 KiB |     40 MiB |   3032 GiB |   3032 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    8534    |  175962 K  |  175958 K  |
|       from large pool |      87    |     908    |   64023 K  |   64023 K  |
|       from small pool |    3630    |    8445    |  111939 K  |  111935 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    8534    |  175962 K  |  175958 K  |
|       from large pool |      87    |     908    |   64023 K  |   64023 K  |
|       from small pool |    3630    |    8445    |  111939 K  |  111935 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     410    |     410    |    1054    |     644    |
|       from large pool |     348    |     348    |     965    |     617    |
|       from small pool |      62    |      63    |      89    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3680    |   92848 K  |   92848 K  |
|       from large pool |      24    |     203    |   39511 K  |   39511 K  |
|       from small pool |      47    |    3654    |   53336 K  |   53336 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool |  16640 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10996 MiB |   1001 TiB |   1001 TiB |
|       from large pool |  16640 KiB |  10923 MiB |    998 TiB |    998 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    990 TiB |    990 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    988 TiB |    988 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1100 MiB |  11504 MiB |  32242 MiB |  31142 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32064 MiB |  31060 MiB |
|       from small pool |     96 MiB |    126 MiB |    178 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1278 MiB | 460396 GiB | 460396 GiB |
|       from large pool |  50944 KiB |   1275 MiB | 457363 GiB | 457363 GiB |
|       from small pool |      0 KiB |     40 MiB |   3032 GiB |   3032 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8534    |  175962 K  |  175962 K  |
|       from large pool |       2    |     908    |   64023 K  |   64023 K  |
|       from small pool |       0    |    8445    |  111939 K  |  111939 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8534    |  175962 K  |  175962 K  |
|       from large pool |       2    |     908    |   64023 K  |   64023 K  |
|       from small pool |       0    |    8445    |  111939 K  |  111939 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     410    |    1054    |     972    |
|       from large pool |      34    |     348    |     965    |     931    |
|       from small pool |      48    |      63    |      89    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3680    |   92849 K  |   92849 K  |
|       from large pool |       4    |     203    |   39511 K  |   39511 K  |
|       from small pool |       0    |    3654    |   53337 K  |   53337 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 31 18:10:58 2024]
Finished job 0.
1 of 1 steps (100%) done
