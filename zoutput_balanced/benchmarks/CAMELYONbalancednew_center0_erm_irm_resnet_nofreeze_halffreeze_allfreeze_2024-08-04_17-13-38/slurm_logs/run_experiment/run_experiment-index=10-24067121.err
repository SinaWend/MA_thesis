Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug  5 01:21:43 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121

 Experiment start at: 2024-08-05 01:30:01.904216
before training, model accuracy: 0.31048259139060974
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96759063, 'precision': 0.9677389, 'recall': 0.9675976, 'specificity': 0.9675976, 'f1': 0.9675884, 'auroc': 0.9945972, 'binary_precision': 0.9762606, 'binary_recall': 0.9585395, 'binary_specificity': 0.9766557, 'binary_f1_score': 0.9673189}
confusion matrix:
       0      1
0  27989    669
1   1190  27512
---- Validation: 
scalar performance:
{'acc': 0.9447637, 'precision': 0.6402049, 'recall': 0.7111342, 'specificity': 0.7111342, 'f1': 0.6671599, 'auroc': 0.84063244, 'binary_precision': 0.29989868, 'binary_recall': 0.46034214, 'binary_specificity': 0.9619263, 'binary_f1_score': 0.36319017}
confusion matrix:
       0    1
0  17458  691
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7586905, 'recall': 0.82424164, 'specificity': 0.82424164, 'f1': 0.7872336, 'auroc': 0.8935834, 'binary_precision': 0.53172207, 'binary_recall': 0.6743295, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.5945946}
confusion matrix:
      0    1
0  5842  155
1    85  176
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 01:41:01.736462,epoch time: 0:10:59.832246,used: 0:10:59.832246,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9402545, 'precision': 0.94479716, 'recall': 0.9402089, 'specificity': 0.9402089, 'f1': 0.9400973, 'auroc': 0.9951868, 'binary_precision': 0.9000728, 'binary_recall': 0.9905943, 'binary_specificity': 0.88982344, 'binary_f1_score': 0.94316655}
confusion matrix:
       0      1
0  25497   3157
1    270  28436
---- Validation: 
scalar performance:
{'acc': 0.8069391, 'precision': 0.5495906, 'recall': 0.74478817, 'specificity': 0.74478817, 'f1': 0.54205877, 'auroc': 0.7933988, 'binary_precision': 0.11304122, 'binary_recall': 0.67807156, 'binary_specificity': 0.8115048, 'binary_f1_score': 0.19377778}
confusion matrix:
       0     1
0  14728  3421
1    207   436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72659, 'precision': 0.5591314, 'recall': 0.81520164, 'specificity': 0.81520164, 'f1': 0.52599984, 'auroc': 0.9169214, 'binary_precision': 0.12357217, 'binary_recall': 0.9118774, 'binary_specificity': 0.71852595, 'binary_f1_score': 0.21764976}
confusion matrix:
      0     1
0  4309  1688
1    23   238
early stop counter: 1
val acc:0.8069391250610352, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 2,now: 2024-08-05 01:50:56.993104,epoch time: 0:09:55.256642,used: 0:20:55.088888,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9696827, 'precision': 0.970132, 'recall': 0.9696694, 'specificity': 0.9696694, 'f1': 0.96967477, 'auroc': 0.9966719, 'binary_precision': 0.9558147, 'binary_recall': 0.98495036, 'binary_specificity': 0.95438844, 'binary_f1_score': 0.97016376}
confusion matrix:
       0      1
0  27348   1307
1    432  28273
---- Validation: 
scalar performance:
{'acc': 0.8829289, 'precision': 0.5600136, 'recall': 0.6851219, 'specificity': 0.6851219, 'f1': 0.57663107, 'auroc': 0.78646016, 'binary_precision': 0.1404157, 'binary_recall': 0.47278383, 'binary_specificity': 0.8974599, 'binary_f1_score': 0.21652421}
confusion matrix:
       0     1
0  16288  1861
1    339   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8528284, 'precision': 0.5985803, 'recall': 0.8609122, 'specificity': 0.8609122, 'f1': 0.6237571, 'auroc': 0.9230771, 'binary_precision': 0.20377019, 'binary_recall': 0.8697318, 'binary_specificity': 0.8520927, 'binary_f1_score': 0.3301818}
confusion matrix:
      0    1
0  5110  887
1    34  227
early stop counter: 2
val acc:0.8829289078712463, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 3,now: 2024-08-05 02:00:43.879934,epoch time: 0:09:46.886830,used: 0:30:41.975718,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96868896, 'precision': 0.9691081, 'recall': 0.96867865, 'specificity': 0.96867865, 'f1': 0.96868145, 'auroc': 0.9964092, 'binary_precision': 0.95525926, 'binary_recall': 0.9834843, 'binary_specificity': 0.953873, 'binary_f1_score': 0.96916634}
confusion matrix:
       0      1
0  27338   1322
1    474  28226
---- Validation: 
scalar performance:
{'acc': 0.8696254, 'precision': 0.5452107, 'recall': 0.6489823, 'specificity': 0.6489823, 'f1': 0.5535257, 'auroc': 0.69258773, 'binary_precision': 0.11339324, 'binary_recall': 0.41213062, 'binary_specificity': 0.8858339, 'binary_f1_score': 0.17785236}
confusion matrix:
       0     1
0  16077  2072
1    378   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80121446, 'precision': 0.5771519, 'recall': 0.8431438, 'specificity': 0.8431438, 'f1': 0.5782814, 'auroc': 0.92880607, 'binary_precision': 0.16033173, 'binary_recall': 0.8888889, 'binary_specificity': 0.7973987, 'binary_f1_score': 0.27166277}
confusion matrix:
      0     1
0  4782  1215
1    29   232
early stop counter: 3
val acc:0.8696253895759583, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 4,now: 2024-08-05 02:10:39.058282,epoch time: 0:09:55.178348,used: 0:40:37.154066,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94785565, 'precision': 0.9510254, 'recall': 0.9478251, 'specificity': 0.9478251, 'f1': 0.94776136, 'auroc': 0.9962516, 'binary_precision': 0.9133972, 'binary_recall': 0.9896171, 'binary_specificity': 0.906033, 'binary_f1_score': 0.9499808}
confusion matrix:
       0      1
0  25966   2693
1    298  28403
---- Validation: 
scalar performance:
{'acc': 0.7632503, 'precision': 0.52238524, 'recall': 0.6216624, 'specificity': 0.6216624, 'f1': 0.49138552, 'auroc': 0.6591163, 'binary_precision': 0.06848072, 'binary_recall': 0.4696734, 'binary_specificity': 0.7736514, 'binary_f1_score': 0.11953295}
confusion matrix:
       0     1
0  14041  4108
1    341   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.576542, 'precision': 0.5404726, 'recall': 0.7515712, 'specificity': 0.7515712, 'f1': 0.43694568, 'auroc': 0.93159485, 'binary_precision': 0.08538702, 'binary_recall': 0.9425287, 'binary_specificity': 0.56061363, 'binary_f1_score': 0.15658817}
confusion matrix:
      0     1
0  3362  2635
1    15   246
early stop counter: 4
val acc:0.7632502913475037, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 5,now: 2024-08-05 02:20:35.356402,epoch time: 0:09:56.298120,used: 0:50:33.452186,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.960129, 'precision': 0.9615376, 'recall': 0.96010506, 'specificity': 0.96010506, 'f1': 0.9600971, 'auroc': 0.9966295, 'binary_precision': 0.93625736, 'binary_recall': 0.98756313, 'binary_specificity': 0.932647, 'binary_f1_score': 0.9612261}
confusion matrix:
       0      1
0  26725   1930
1    357  28348
---- Validation: 
scalar performance:
{'acc': 0.846424, 'precision': 0.53633446, 'recall': 0.6384707, 'specificity': 0.6384707, 'f1': 0.53583276, 'auroc': 0.6730769, 'binary_precision': 0.09614692, 'binary_recall': 0.41524106, 'binary_specificity': 0.86170036, 'binary_f1_score': 0.15614034}
confusion matrix:
       0     1
0  15639  2510
1    376   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82086927, 'precision': 0.58467454, 'recall': 0.8533989, 'specificity': 0.8533989, 'f1': 0.59509605, 'auroc': 0.92873895, 'binary_precision': 0.17522658, 'binary_recall': 0.8888889, 'binary_specificity': 0.81790894, 'binary_f1_score': 0.29274446}
confusion matrix:
      0     1
0  4905  1092
1    29   232
early stop counter: 5
val acc:0.8464239835739136, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 6,now: 2024-08-05 02:30:30.144012,epoch time: 0:09:54.787610,used: 1:00:28.239796,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93769175, 'precision': 0.94212526, 'recall': 0.93765175, 'specificity': 0.93765175, 'f1': 0.93753123, 'auroc': 0.9952195, 'binary_precision': 0.8980516, 'binary_recall': 0.9875971, 'binary_specificity': 0.88770634, 'binary_f1_score': 0.9406982}
confusion matrix:
       0      1
0  25439   3218
1    356  28347
---- Validation: 
scalar performance:
{'acc': 0.5891337, 'precision': 0.50287724, 'recall': 0.521019, 'specificity': 0.521019, 'f1': 0.40289515, 'auroc': 0.5607796, 'binary_precision': 0.037627384, 'binary_recall': 0.44790047, 'binary_specificity': 0.59413743, 'binary_f1_score': 0.06942268}
confusion matrix:
       0     1
0  10783  7366
1    355   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38478747, 'precision': 0.5307284, 'recall': 0.6735091, 'specificity': 0.6735091, 'f1': 0.32289666, 'auroc': 0.9202588, 'binary_precision': 0.062850185, 'binary_recall': 0.9885057, 'binary_specificity': 0.35851258, 'binary_f1_score': 0.11818598}
confusion matrix:
      0     1
0  2150  3847
1     3   258
early stop counter: 6
val acc:0.5891336798667908, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 7,now: 2024-08-05 02:40:29.357568,epoch time: 0:09:59.213556,used: 1:10:27.453352,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.963947, 'precision': 0.9650068, 'recall': 0.9639305, 'specificity': 0.9639305, 'f1': 0.96392554, 'auroc': 0.9969058, 'binary_precision': 0.9429807, 'binary_recall': 0.98766553, 'binary_specificity': 0.9401954, 'binary_f1_score': 0.964806}
confusion matrix:
       0      1
0  26946   1714
1    354  28346
---- Validation: 
scalar performance:
{'acc': 0.83673906, 'precision': 0.53374755, 'recall': 0.6357068, 'specificity': 0.6357068, 'f1': 0.5296842, 'auroc': 0.63543093, 'binary_precision': 0.0910624, 'binary_recall': 0.41990668, 'binary_specificity': 0.85150695, 'binary_f1_score': 0.14966743}
confusion matrix:
       0     1
0  15454  2695
1    373   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72307444, 'precision': 0.5581112, 'recall': 0.81153506, 'specificity': 0.81153506, 'f1': 0.5233328, 'auroc': 0.9225826, 'binary_precision': 0.121788286, 'binary_recall': 0.90804595, 'binary_specificity': 0.7150242, 'binary_f1_score': 0.21477118}
confusion matrix:
      0     1
0  4288  1709
1    24   237
early stop counter: 7
val acc:0.8367390632629395, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 8,now: 2024-08-05 02:50:28.927382,epoch time: 0:09:59.569814,used: 1:20:27.023166,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9290446, 'precision': 0.93625426, 'recall': 0.92899764, 'specificity': 0.92899764, 'f1': 0.9287449, 'auroc': 0.9961754, 'binary_precision': 0.8803545, 'binary_recall': 0.993171, 'binary_specificity': 0.8648243, 'binary_f1_score': 0.93336606}
confusion matrix:
       0      1
0  24785   3874
1    196  28505
---- Validation: 
scalar performance:
{'acc': 0.69332695, 'precision': 0.51276046, 'recall': 0.5817118, 'specificity': 0.5817118, 'f1': 0.45444426, 'auroc': 0.63523734, 'binary_precision': 0.051977597, 'binary_recall': 0.46189734, 'binary_specificity': 0.7015263, 'binary_f1_score': 0.093440294}
confusion matrix:
       0     1
0  12732  5417
1    346   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48721635, 'precision': 0.5348969, 'recall': 0.71595854, 'specificity': 0.71595854, 'f1': 0.38560224, 'auroc': 0.9206749, 'binary_precision': 0.07300116, 'binary_recall': 0.9655172, 'binary_specificity': 0.46639988, 'binary_f1_score': 0.1357393}
confusion matrix:
      0     1
0  2797  3200
1     9   252
early stop counter: 8
val acc:0.6933269500732422, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 9,now: 2024-08-05 03:00:26.833537,epoch time: 0:09:57.906155,used: 1:30:24.929321,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9208159, 'precision': 0.92871594, 'recall': 0.9207521, 'specificity': 0.9207521, 'f1': 0.9204413, 'auroc': 0.99398196, 'binary_precision': 0.87075394, 'binary_recall': 0.9885045, 'binary_specificity': 0.8529997, 'binary_f1_score': 0.9259006}
confusion matrix:
       0      1
0  24441   4212
1    330  28377
---- Validation: 
scalar performance:
{'acc': 0.62015754, 'precision': 0.5054311, 'recall': 0.53858054, 'specificity': 0.53858054, 'f1': 0.41807404, 'auroc': 0.56415844, 'binary_precision': 0.0409894, 'binary_recall': 0.45101088, 'binary_specificity': 0.6261502, 'binary_f1_score': 0.07514901}
confusion matrix:
       0     1
0  11364  6785
1    353   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47075742, 'precision': 0.53347385, 'recall': 0.70553863, 'specificity': 0.70553863, 'f1': 0.3755091, 'auroc': 0.9050355, 'binary_precision': 0.07064453, 'binary_recall': 0.96168584, 'binary_specificity': 0.44939137, 'binary_f1_score': 0.13162035}
confusion matrix:
      0     1
0  2695  3302
1    10   251
early stop counter: 9
val acc:0.6201575398445129, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 10,now: 2024-08-05 03:10:19.681766,epoch time: 0:09:52.848229,used: 1:40:17.777550,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9656555, 'precision': 0.96641207, 'recall': 0.96563876, 'specificity': 0.96563876, 'f1': 0.96564066, 'auroc': 0.9964075, 'binary_precision': 0.9478357, 'binary_recall': 0.98561174, 'binary_specificity': 0.94566584, 'binary_f1_score': 0.96635467}
confusion matrix:
       0      1
0  27099   1557
1    413  28291
---- Validation: 
scalar performance:
{'acc': 0.8754257, 'precision': 0.5484592, 'recall': 0.6534853, 'specificity': 0.6534853, 'f1': 0.55914634, 'auroc': 0.6001819, 'binary_precision': 0.11962365, 'binary_recall': 0.41524106, 'binary_specificity': 0.8917296, 'binary_f1_score': 0.18573911}
confusion matrix:
       0     1
0  16184  1965
1    376   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7480025, 'precision': 0.5616124, 'recall': 0.8135476, 'specificity': 0.8135476, 'f1': 0.53803074, 'auroc': 0.9150821, 'binary_precision': 0.12992126, 'binary_recall': 0.88505745, 'binary_specificity': 0.7420377, 'binary_f1_score': 0.22658166}
confusion matrix:
      0     1
0  4450  1547
1    30   231
early stop counter: 10
val acc:0.8754256963729858, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 11,now: 2024-08-05 03:19:53.311245,epoch time: 0:09:33.629479,used: 1:49:51.407029,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96434796, 'precision': 0.9653592, 'recall': 0.964327, 'specificity': 0.964327, 'f1': 0.9643274, 'auroc': 0.99662167, 'binary_precision': 0.9438913, 'binary_recall': 0.98745906, 'binary_specificity': 0.94119495, 'binary_f1_score': 0.96518373}
confusion matrix:
       0      1
0  26969   1685
1    360  28346
---- Validation: 
scalar performance:
{'acc': 0.87255216, 'precision': 0.5452286, 'recall': 0.6452471, 'specificity': 0.6452471, 'f1': 0.5540924, 'auroc': 0.6223304, 'binary_precision': 0.11375661, 'binary_recall': 0.40124416, 'binary_specificity': 0.8892501, 'binary_f1_score': 0.17725867}
confusion matrix:
       0     1
0  16139  2010
1    385   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7876318, 'precision': 0.5719848, 'recall': 0.8323922, 'specificity': 0.8323922, 'f1': 0.56661695, 'auroc': 0.92897403, 'binary_precision': 0.15052356, 'binary_recall': 0.88122606, 'binary_specificity': 0.7835584, 'binary_f1_score': 0.25712687}
confusion matrix:
      0     1
0  4699  1298
1    31   230
early stop counter: 11
val acc:0.8725521564483643, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 12,now: 2024-08-05 03:29:44.276941,epoch time: 0:09:50.965696,used: 1:59:42.372725,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93906903, 'precision': 0.9438607, 'recall': 0.93902385, 'specificity': 0.93902385, 'f1': 0.93889976, 'auroc': 0.99620193, 'binary_precision': 0.8979605, 'binary_recall': 0.9908378, 'binary_specificity': 0.8872099, 'binary_f1_score': 0.94211566}
confusion matrix:
       0      1
0  25423   3232
1    263  28442
---- Validation: 
scalar performance:
{'acc': 0.74781823, 'precision': 0.5178684, 'recall': 0.60092205, 'specificity': 0.60092205, 'f1': 0.4802665, 'auroc': 0.5822398, 'binary_precision': 0.061080154, 'binary_recall': 0.44323483, 'binary_specificity': 0.7586093, 'binary_f1_score': 0.10736486}
confusion matrix:
       0     1
0  13768  4381
1    358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6310323, 'precision': 0.5461158, 'recall': 0.77816975, 'specificity': 0.77816975, 'f1': 0.4687189, 'auroc': 0.9182311, 'binary_precision': 0.0965327, 'binary_recall': 0.93869734, 'binary_specificity': 0.61764216, 'binary_f1_score': 0.17506252}
confusion matrix:
      0     1
0  3704  2293
1    16   245
early stop counter: 12
val acc:0.7478182315826416, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 13,now: 2024-08-05 03:39:32.835978,epoch time: 0:09:48.559037,used: 2:09:30.931762,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90744424, 'precision': 0.91912293, 'recall': 0.90736866, 'specificity': 0.90736866, 'f1': 0.9067836, 'auroc': 0.99455726, 'binary_precision': 0.8493863, 'binary_recall': 0.9907336, 'binary_specificity': 0.82400364, 'binary_f1_score': 0.91463125}
confusion matrix:
       0      1
0  23611   5043
1    266  28440
---- Validation: 
scalar performance:
{'acc': 0.5551298, 'precision': 0.501161, 'recall': 0.508665, 'specificity': 0.508665, 'f1': 0.38698056, 'auroc': 0.5612485, 'binary_precision': 0.03551222, 'binary_recall': 0.45878693, 'binary_specificity': 0.55854315, 'binary_f1_score': 0.06592179}
confusion matrix:
       0     1
0  10137  8012
1    348   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.35218918, 'precision': 0.52988434, 'recall': 0.6601653, 'specificity': 0.6601653, 'f1': 0.30161765, 'auroc': 0.9070785, 'binary_precision': 0.060282867, 'binary_recall': 0.99616855, 'binary_specificity': 0.3241621, 'binary_f1_score': 0.11368605}
confusion matrix:
      0     1
0  1944  4053
1     1   260
early stop counter: 13
val acc:0.5551298260688782, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 14,now: 2024-08-05 03:49:18.144330,epoch time: 0:09:45.308352,used: 2:19:16.240114,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9436541, 'precision': 0.9474722, 'recall': 0.9436204, 'specificity': 0.9436204, 'f1': 0.9435307, 'auroc': 0.9961945, 'binary_precision': 0.9063208, 'binary_recall': 0.9896868, 'binary_specificity': 0.897554, 'binary_f1_score': 0.94617105}
confusion matrix:
       0      1
0  25723   2936
1    296  28405
---- Validation: 
scalar performance:
{'acc': 0.6980098, 'precision': 0.51186645, 'recall': 0.5751355, 'specificity': 0.5751355, 'f1': 0.45509437, 'auroc': 0.5848952, 'binary_precision': 0.050874688, 'binary_recall': 0.44323483, 'binary_specificity': 0.7070362, 'binary_f1_score': 0.09127302}
confusion matrix:
       0     1
0  12832  5317
1    358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5286034, 'precision': 0.5376991, 'recall': 0.7357204, 'specificity': 0.7357204, 'f1': 0.4099798, 'auroc': 0.9242921, 'binary_precision': 0.07865873, 'binary_recall': 0.96168584, 'binary_specificity': 0.5097549, 'binary_f1_score': 0.14542294}
confusion matrix:
      0     1
0  3057  2940
1    10   251
early stop counter: 14
val acc:0.6980097889900208, best validation acc: 0.944763720035553, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 15,now: 2024-08-05 03:59:07.180992,epoch time: 0:09:49.036662,used: 2:29:05.276776,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_01_seed_0_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:29:05.276776 at 2024-08-05 03:59:07.180992
persisted model performance metric: 

scalar performance:
{'acc': 0.96164906, 'precision': 0.7586905, 'recall': 0.82424164, 'specificity': 0.82424164, 'f1': 0.7872336, 'auroc': 0.8935834, 'binary_precision': 0.53172207, 'binary_recall': 0.6743295, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.5945946}
confusion matrix:
      0    1
0  5842  155
1    85  176
oracle model performance metric: 

scalar performance:
{'acc': 0.96164906, 'precision': 0.7586905, 'recall': 0.82424164, 'specificity': 0.82424164, 'f1': 0.7872336, 'auroc': 0.8935834, 'binary_precision': 0.53172207, 'binary_recall': 0.6743295, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.5945946}
confusion matrix:
      0    1
0  5842  155
1    85  176
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 533599 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440491 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 533599 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440491 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522828 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool | 436736 KiB |   6277 MiB | 439102 GiB | 439102 GiB |
|       from small pool |  86092 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6564 MiB |   6564 MiB |   6564 MiB |      0 B   |
|       from large pool |   6440 MiB |   6440 MiB |   6440 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    932 MiB |   1266 MiB | 238382 GiB | 238381 GiB |
|       from large pool |    928 MiB |   1263 MiB | 237669 GiB | 237668 GiB |
|       from small pool |      4 MiB |     10 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3630    |    8317    |   53654 K  |   53650 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31488 K  |   31484 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3630    |    8317    |   53654 K  |   53650 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31488 K  |   31484 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     133    |     133    |       0    |
|       from large pool |      71    |      71    |      71    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3612    |   25028 K  |   25028 K  |
|       from large pool |      19    |      36    |    8794 K  |    8794 K  |
|       from small pool |      51    |    3594    |   16233 K  |   16233 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439102 GiB | 439102 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238382 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     27 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439102 GiB | 439102 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238382 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     27 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121

 Experiment start at: 2024-08-05 04:05:15.472866
before training, model accuracy: 0.14582662284374237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9644196, 'precision': 0.9644685, 'recall': 0.96442366, 'specificity': 0.96442366, 'f1': 0.9644189, 'auroc': 0.99293965, 'binary_precision': 0.96942925, 'binary_recall': 0.95913976, 'binary_specificity': 0.9697075, 'binary_f1_score': 0.96425706}
confusion matrix:
       0      1
0  27914    872
1   1178  27652
---- Validation: 
scalar performance:
{'acc': 0.9305763, 'precision': 0.61079025, 'recall': 0.69505465, 'specificity': 0.69505465, 'f1': 0.63844806, 'auroc': 0.8139185, 'binary_precision': 0.24304418, 'binary_recall': 0.44130757, 'binary_specificity': 0.9488017, 'binary_f1_score': 0.31345648}
confusion matrix:
       0    1
0  17142  925
1    376  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.7227061, 'recall': 0.8047563, 'specificity': 0.8047563, 'f1': 0.75627506, 'auroc': 0.8709999, 'binary_precision': 0.46132597, 'binary_recall': 0.6423077, 'binary_specificity': 0.96720487, 'binary_f1_score': 0.5369775}
confusion matrix:
      0    1
0  5751  195
1    93  167
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 04:15:25.185627,epoch time: 0:10:09.712761,used: 0:10:09.712761,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9711712, 'precision': 0.9711863, 'recall': 0.9711734, 'specificity': 0.9711734, 'f1': 0.9711711, 'auroc': 0.9946227, 'binary_precision': 0.9740369, 'binary_recall': 0.96819174, 'binary_specificity': 0.974155, 'binary_f1_score': 0.9711055}
confusion matrix:
       0      1
0  28043    744
1    917  27912
---- Validation: 
scalar performance:
{'acc': 0.90464246, 'precision': 0.5688972, 'recall': 0.6594314, 'specificity': 0.6594314, 'f1': 0.58929294, 'auroc': 0.7130698, 'binary_precision': 0.16160388, 'binary_recall': 0.39524516, 'binary_specificity': 0.92361766, 'binary_f1_score': 0.22940923}
confusion matrix:
       0     1
0  16687  1380
1    407   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91814375, 'precision': 0.6493058, 'recall': 0.848782, 'specificity': 0.848782, 'f1': 0.698796, 'auroc': 0.910913, 'binary_precision': 0.30923077, 'binary_recall': 0.77307695, 'binary_specificity': 0.92448705, 'binary_f1_score': 0.44175825}
confusion matrix:
      0    1
0  5497  449
1    59  201
early stop counter: 1
val acc:0.9046424627304077, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 2,now: 2024-08-05 04:25:21.526649,epoch time: 0:09:56.341022,used: 0:20:06.053783,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9461087, 'precision': 0.94891644, 'recall': 0.94607997, 'specificity': 0.94607997, 'f1': 0.9460219, 'auroc': 0.9943558, 'binary_precision': 0.91359574, 'binary_recall': 0.9855007, 'binary_specificity': 0.90665925, 'binary_f1_score': 0.94818693}
confusion matrix:
       0      1
0  26100   2687
1    418  28411
---- Validation: 
scalar performance:
{'acc': 0.6816969, 'precision': 0.5116189, 'recall': 0.5724169, 'specificity': 0.5724169, 'f1': 0.4500141, 'auroc': 0.62954533, 'binary_precision': 0.051829267, 'binary_recall': 0.45468053, 'binary_specificity': 0.6901533, 'binary_f1_score': 0.093051545}
confusion matrix:
       0     1
0  12469  5598
1    367   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5451176, 'precision': 0.53892416, 'recall': 0.7423847, 'specificity': 0.7423847, 'f1': 0.41971397, 'auroc': 0.93238306, 'binary_precision': 0.08134597, 'binary_recall': 0.9576923, 'binary_specificity': 0.527077, 'binary_f1_score': 0.14995484}
confusion matrix:
      0     1
0  3134  2812
1    11   249
early stop counter: 2
val acc:0.681696891784668, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 3,now: 2024-08-05 04:35:14.656875,epoch time: 0:09:53.130226,used: 0:29:59.184009,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9258539, 'precision': 0.93253684, 'recall': 0.92580867, 'specificity': 0.92580867, 'f1': 0.9255611, 'auroc': 0.9943259, 'binary_precision': 0.87895435, 'binary_recall': 0.9878594, 'binary_specificity': 0.86375797, 'binary_f1_score': 0.93023026}
confusion matrix:
       0      1
0  24865   3922
1    350  28479
---- Validation: 
scalar performance:
{'acc': 0.59855926, 'precision': 0.5039243, 'recall': 0.52715385, 'specificity': 0.52715385, 'f1': 0.40911818, 'auroc': 0.5969862, 'binary_precision': 0.040638413, 'binary_recall': 0.45022288, 'binary_specificity': 0.6040848, 'binary_f1_score': 0.07454792}
confusion matrix:
       0     1
0  10914  7153
1    370   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.40460846, 'precision': 0.5305532, 'recall': 0.676414, 'specificity': 0.676414, 'f1': 0.33522072, 'auroc': 0.93218327, 'binary_precision': 0.06419691, 'binary_recall': 0.97307694, 'binary_specificity': 0.3797511, 'binary_f1_score': 0.12044751}
confusion matrix:
      0     1
0  2258  3688
1     7   253
early stop counter: 3
val acc:0.5985592603683472, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 4,now: 2024-08-05 04:45:14.670181,epoch time: 0:10:00.013306,used: 0:39:59.197315,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95181894, 'precision': 0.9534484, 'recall': 0.9517982, 'specificity': 0.9517982, 'f1': 0.951774, 'auroc': 0.9942132, 'binary_precision': 0.9264388, 'binary_recall': 0.98164976, 'binary_specificity': 0.92194664, 'binary_f1_score': 0.9532455}
confusion matrix:
       0      1
0  26541   2247
1    529  28299
---- Validation: 
scalar performance:
{'acc': 0.7890075, 'precision': 0.523403, 'recall': 0.6101892, 'specificity': 0.6101892, 'f1': 0.50224864, 'auroc': 0.58382034, 'binary_precision': 0.07311996, 'binary_recall': 0.41753343, 'binary_specificity': 0.80284494, 'binary_f1_score': 0.124446414}
confusion matrix:
       0     1
0  14505  3562
1    392   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56944895, 'precision': 0.53994226, 'recall': 0.7477263, 'specificity': 0.7477263, 'f1': 0.4330502, 'auroc': 0.9250847, 'binary_precision': 0.08442453, 'binary_recall': 0.9423077, 'binary_specificity': 0.553145, 'binary_f1_score': 0.1549652}
confusion matrix:
      0     1
0  3289  2657
1    15   245
early stop counter: 4
val acc:0.7890074849128723, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 5,now: 2024-08-05 04:55:09.045636,epoch time: 0:09:54.375455,used: 0:49:53.572770,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94347054, 'precision': 0.9462823, 'recall': 0.9434403, 'specificity': 0.9434403, 'f1': 0.9433787, 'auroc': 0.99352396, 'binary_precision': 0.91104895, 'binary_recall': 0.9830038, 'binary_specificity': 0.9038769, 'binary_f1_score': 0.9456596}
confusion matrix:
       0      1
0  26019   2767
1    490  28340
---- Validation: 
scalar performance:
{'acc': 0.71974385, 'precision': 0.51364315, 'recall': 0.578559, 'specificity': 0.578559, 'f1': 0.46630242, 'auroc': 0.56334305, 'binary_precision': 0.055695713, 'binary_recall': 0.42644873, 'binary_specificity': 0.7306692, 'binary_f1_score': 0.09852386}
confusion matrix:
       0     1
0  13201  4866
1    386   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42184982, 'precision': 0.53087366, 'recall': 0.68173367, 'specificity': 0.68173367, 'f1': 0.345796, 'auroc': 0.9221506, 'binary_precision': 0.06553525, 'binary_recall': 0.9653846, 'binary_specificity': 0.39808273, 'binary_f1_score': 0.12273839}
confusion matrix:
      0     1
0  2367  3579
1     9   251
early stop counter: 5
val acc:0.7197438478469849, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 6,now: 2024-08-05 05:04:58.159869,epoch time: 0:09:49.114233,used: 0:59:42.687003,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95206195, 'precision': 0.9545926, 'recall': 0.95203483, 'specificity': 0.95203483, 'f1': 0.95199305, 'auroc': 0.99607754, 'binary_precision': 0.92085636, 'binary_recall': 0.9892123, 'binary_specificity': 0.9148574, 'binary_f1_score': 0.95381117}
confusion matrix:
       0      1
0  26336   2451
1    311  28518
---- Validation: 
scalar performance:
{'acc': 0.7128068, 'precision': 0.51305926, 'recall': 0.57639176, 'specificity': 0.57639176, 'f1': 0.46311557, 'auroc': 0.58706814, 'binary_precision': 0.05466238, 'binary_recall': 0.4294205, 'binary_specificity': 0.72336304, 'binary_f1_score': 0.09697987}
confusion matrix:
       0     1
0  13069  4998
1    384   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5385111, 'precision': 0.5383635, 'recall': 0.738937, 'specificity': 0.738937, 'f1': 0.41583103, 'auroc': 0.93574286, 'binary_precision': 0.08027079, 'binary_recall': 0.9576923, 'binary_specificity': 0.52018166, 'binary_f1_score': 0.1481261}
confusion matrix:
      0     1
0  3093  2853
1    11   249
early stop counter: 6
val acc:0.7128068208694458, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 7,now: 2024-08-05 05:14:48.908056,epoch time: 0:09:50.748187,used: 1:09:33.435190,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9195883, 'precision': 0.927735, 'recall': 0.9195381, 'specificity': 0.9195381, 'f1': 0.91919714, 'auroc': 0.99330795, 'binary_precision': 0.8688865, 'binary_recall': 0.98844916, 'binary_specificity': 0.850627, 'binary_f1_score': 0.9248195}
confusion matrix:
       0      1
0  24487   4300
1    333  28496
---- Validation: 
scalar performance:
{'acc': 0.62886876, 'precision': 0.5059624, 'recall': 0.54001206, 'specificity': 0.54001206, 'f1': 0.42338756, 'auroc': 0.56259644, 'binary_precision': 0.043459304, 'binary_recall': 0.44427934, 'binary_specificity': 0.63574475, 'binary_f1_score': 0.07917385}
confusion matrix:
       0     1
0  11486  6581
1    374   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3865614, 'precision': 0.53060335, 'recall': 0.6725129, 'specificity': 0.6725129, 'f1': 0.3240697, 'auroc': 0.94070935, 'binary_precision': 0.06306972, 'binary_recall': 0.9846154, 'binary_specificity': 0.36041036, 'binary_f1_score': 0.11854596}
confusion matrix:
      0     1
0  2143  3803
1     4   256
early stop counter: 7
val acc:0.6288687586784363, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 8,now: 2024-08-05 05:24:44.782563,epoch time: 0:09:55.874507,used: 1:19:29.309697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9352784, 'precision': 0.93982697, 'recall': 0.9352432, 'specificity': 0.9352432, 'f1': 0.935107, 'auroc': 0.9936041, 'binary_precision': 0.8952723, 'binary_recall': 0.9859859, 'binary_specificity': 0.8845005, 'binary_f1_score': 0.93844193}
confusion matrix:
       0      1
0  25463   3325
1    404  28424
---- Validation: 
scalar performance:
{'acc': 0.74658483, 'precision': 0.5178006, 'recall': 0.5960557, 'specificity': 0.5960557, 'f1': 0.48088962, 'auroc': 0.57623744, 'binary_precision': 0.06266095, 'binary_recall': 0.43387815, 'binary_specificity': 0.75823325, 'binary_f1_score': 0.109506845}
confusion matrix:
       0     1
0  13699  4368
1    381   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6131163, 'precision': 0.5438755, 'recall': 0.76683676, 'specificity': 0.76683676, 'f1': 0.45813367, 'auroc': 0.9227567, 'binary_precision': 0.092500955, 'binary_recall': 0.9346154, 'binary_specificity': 0.5990582, 'binary_f1_score': 0.16834085}
confusion matrix:
      0     1
0  3562  2384
1    17   243
early stop counter: 8
val acc:0.7465848326683044, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 9,now: 2024-08-05 05:34:42.657222,epoch time: 0:09:57.874659,used: 1:29:27.184356,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9199007, 'precision': 0.92802, 'recall': 0.9198506, 'specificity': 0.9198506, 'f1': 0.9195126, 'auroc': 0.9941934, 'binary_precision': 0.86925095, 'binary_recall': 0.98862255, 'binary_specificity': 0.8510786, 'binary_f1_score': 0.9251019}
confusion matrix:
       0      1
0  24500   4287
1    328  28501
---- Validation: 
scalar performance:
{'acc': 0.53831375, 'precision': 0.4995292, 'recall': 0.4966243, 'specificity': 0.4966243, 'f1': 0.37953386, 'auroc': 0.5607407, 'binary_precision': 0.035402354, 'binary_recall': 0.45170876, 'binary_specificity': 0.54153985, 'binary_f1_score': 0.06565875}
confusion matrix:
      0     1
0  9784  8283
1   369   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.23396713, 'precision': 0.5259274, 'recall': 0.60023546, 'specificity': 0.60023546, 'f1': 0.216292, 'auroc': 0.90296805, 'binary_precision': 0.051854808, 'binary_recall': 1.0, 'binary_specificity': 0.20047091, 'binary_f1_score': 0.098596886}
confusion matrix:
      0     1
0  1192  4754
1     0   260
early stop counter: 9
val acc:0.5383137464523315, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 10,now: 2024-08-05 05:44:37.646164,epoch time: 0:09:54.988942,used: 1:39:22.173298,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92882186, 'precision': 0.9347569, 'recall': 0.92877936, 'specificity': 0.92877936, 'f1': 0.92857325, 'auroc': 0.99433446, 'binary_precision': 0.88414216, 'binary_recall': 0.9870963, 'binary_specificity': 0.87046236, 'binary_f1_score': 0.932787}
confusion matrix:
       0      1
0  25058   3729
1    372  28457
---- Validation: 
scalar performance:
{'acc': 0.6171825, 'precision': 0.5048907, 'recall': 0.53323597, 'specificity': 0.53323597, 'f1': 0.4176189, 'auroc': 0.56156963, 'binary_precision': 0.041989572, 'binary_recall': 0.44279346, 'binary_specificity': 0.6236785, 'binary_f1_score': 0.07670528}
confusion matrix:
       0     1
0  11268  6799
1    375   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41347083, 'precision': 0.5313704, 'recall': 0.68287796, 'specificity': 0.68287796, 'f1': 0.341002, 'auroc': 0.9169358, 'binary_precision': 0.06532922, 'binary_recall': 0.97692305, 'binary_specificity': 0.38883284, 'binary_f1_score': 0.12246864}
confusion matrix:
      0     1
0  2312  3634
1     6   254
early stop counter: 10
val acc:0.6171824932098389, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 11,now: 2024-08-05 05:54:28.865945,epoch time: 0:09:51.219781,used: 1:49:13.393079,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9259581, 'precision': 0.93274003, 'recall': 0.92591465, 'specificity': 0.92591465, 'f1': 0.9256617, 'auroc': 0.9945357, 'binary_precision': 0.8787393, 'binary_recall': 0.98841405, 'binary_specificity': 0.8634153, 'binary_f1_score': 0.93035555}
confusion matrix:
       0      1
0  24856   3932
1    334  28494
---- Validation: 
scalar performance:
{'acc': 0.6340448, 'precision': 0.50565547, 'recall': 0.5376896, 'specificity': 0.5376896, 'f1': 0.42508134, 'auroc': 0.56580436, 'binary_precision': 0.043137833, 'binary_recall': 0.43387815, 'binary_specificity': 0.64150107, 'binary_f1_score': 0.07847353}
confusion matrix:
       0     1
0  11590  6477
1    381   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47921365, 'precision': 0.5353937, 'recall': 0.7171867, 'specificity': 0.7171867, 'f1': 0.3815676, 'auroc': 0.9023739, 'binary_precision': 0.0729885, 'binary_recall': 0.97692305, 'binary_specificity': 0.4574504, 'binary_f1_score': 0.13582888}
confusion matrix:
      0     1
0  2720  3226
1     6   254
early stop counter: 11
val acc:0.6340448260307312, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 12,now: 2024-08-05 06:04:19.418111,epoch time: 0:09:50.552166,used: 1:59:03.945245,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95400584, 'precision': 0.9562123, 'recall': 0.95398057, 'specificity': 0.95398057, 'f1': 0.9539483, 'auroc': 0.9957488, 'binary_precision': 0.92466664, 'binary_recall': 0.98862255, 'binary_specificity': 0.9193386, 'binary_f1_score': 0.9555757}
confusion matrix:
       0      1
0  26465   2322
1    328  28501
---- Validation: 
scalar performance:
{'acc': 0.809445, 'precision': 0.52868986, 'recall': 0.6250802, 'specificity': 0.6250802, 'f1': 0.51567775, 'auroc': 0.6061227, 'binary_precision': 0.08266129, 'binary_recall': 0.42644873, 'binary_specificity': 0.82371175, 'binary_f1_score': 0.1384801}
confusion matrix:
       0     1
0  14882  3185
1    386   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89526266, 'precision': 0.62767994, 'recall': 0.866265, 'specificity': 0.866265, 'f1': 0.67149454, 'auroc': 0.9242321, 'binary_precision': 0.2633495, 'binary_recall': 0.8346154, 'binary_specificity': 0.8979146, 'binary_f1_score': 0.40036902}
confusion matrix:
      0    1
0  5339  607
1    43  217
early stop counter: 12
val acc:0.8094450235366821, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 13,now: 2024-08-05 06:14:15.844186,epoch time: 0:09:56.426075,used: 2:09:00.371320,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92484725, 'precision': 0.9325621, 'recall': 0.92479634, 'specificity': 0.92479634, 'f1': 0.9245045, 'auroc': 0.99528193, 'binary_precision': 0.8749847, 'binary_recall': 0.99146724, 'binary_specificity': 0.85812545, 'binary_f1_score': 0.9295912}
confusion matrix:
       0      1
0  24702   4084
1    246  28584
---- Validation: 
scalar performance:
{'acc': 0.64978653, 'precision': 0.50810444, 'recall': 0.55300635, 'specificity': 0.55300635, 'f1': 0.4338837, 'auroc': 0.5821824, 'binary_precision': 0.046504464, 'binary_recall': 0.448737, 'binary_specificity': 0.6572757, 'binary_f1_score': 0.08427515}
confusion matrix:
       0     1
0  11875  6192
1    371   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4605221, 'precision': 0.5320008, 'recall': 0.69455934, 'specificity': 0.69455934, 'f1': 0.36895686, 'auroc': 0.9235816, 'binary_precision': 0.06895589, 'binary_recall': 0.95, 'binary_specificity': 0.43911874, 'binary_f1_score': 0.12857887}
confusion matrix:
      0     1
0  2611  3335
1    13   247
early stop counter: 13
val acc:0.6497865319252014, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 14,now: 2024-08-05 06:24:10.614645,epoch time: 0:09:54.770459,used: 2:18:55.141779,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9351743, 'precision': 0.9403328, 'recall': 0.9351349, 'specificity': 0.9351349, 'f1': 0.9349798, 'auroc': 0.9952972, 'binary_precision': 0.8928549, 'binary_recall': 0.9891429, 'binary_specificity': 0.8811269, 'binary_f1_score': 0.93853575}
confusion matrix:
       0      1
0  25365   3422
1    313  28516
---- Validation: 
scalar performance:
{'acc': 0.7357524, 'precision': 0.5161703, 'recall': 0.58972245, 'specificity': 0.58972245, 'f1': 0.47507823, 'auroc': 0.58126724, 'binary_precision': 0.059864227, 'binary_recall': 0.43239227, 'binary_specificity': 0.7470526, 'binary_f1_score': 0.10516806}
confusion matrix:
       0     1
0  13497  4570
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48936513, 'precision': 0.53609145, 'recall': 0.7224844, 'specificity': 0.7224844, 'f1': 0.38768137, 'auroc': 0.9122739, 'binary_precision': 0.07433421, 'binary_recall': 0.97692305, 'binary_specificity': 0.46804574, 'binary_f1_score': 0.1381561}
confusion matrix:
      0     1
0  2783  3163
1     6   254
early stop counter: 14
val acc:0.7357524037361145, best validation acc: 0.9305763244628906, corresponding to test acc:                         0.9535933136940002 / 0.9535933136940002
after epoch: 15,now: 2024-08-05 06:34:08.295004,epoch time: 0:09:57.680359,used: 2:28:52.822138,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_05_15_seed_1_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:28:52.822138 at 2024-08-05 06:34:08.295004
persisted model performance metric: 

scalar performance:
{'acc': 0.9535933, 'precision': 0.7227061, 'recall': 0.8047563, 'specificity': 0.8047563, 'f1': 0.75627506, 'auroc': 0.8709999, 'binary_precision': 0.46132597, 'binary_recall': 0.6423077, 'binary_specificity': 0.96720487, 'binary_f1_score': 0.5369775}
confusion matrix:
      0    1
0  5751  195
1    93  167
oracle model performance metric: 

scalar performance:
{'acc': 0.9535933, 'precision': 0.7227061, 'recall': 0.8047563, 'specificity': 0.8047563, 'f1': 0.75627506, 'auroc': 0.8709999, 'binary_precision': 0.46132597, 'binary_recall': 0.6423077, 'binary_specificity': 0.96720487, 'binary_f1_score': 0.5369775}
confusion matrix:
      0    1
0  5751  195
1    93  167
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522826 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool | 436736 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |  86090 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  11654 MiB |   5110 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  11498 MiB |   5076 MiB |
|       from small pool |    122 MiB |    124 MiB |    156 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1059 MiB |   1463 MiB | 479146 GiB | 479144 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 477676 GiB | 477675 GiB |
|       from small pool |      4 MiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3606    |    8349    |  107888 K  |  107885 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63242 K  |   63239 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3606    |    8349    |  107888 K  |  107885 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63242 K  |   63239 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     195    |      65    |
|       from large pool |      69    |      71    |     117    |      48    |
|       from small pool |      61    |      62    |      78    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3630    |   50640 K  |   50640 K  |
|       from large pool |      21    |      36    |   17922 K  |   17922 K  |
|       from small pool |      50    |    3610    |   32717 K  |   32717 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1582 MiB |   6564 MiB |  11654 MiB |  10072 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     90 MiB |    124 MiB |    156 MiB |     66 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     133    |     195    |     126    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      45    |      62    |      78    |      33    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50642 K  |   50642 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32719 K  |   32719 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1582 MiB |   6564 MiB |  11654 MiB |  10072 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     90 MiB |    124 MiB |    156 MiB |     66 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     133    |     195    |     126    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      45    |      62    |      78    |      33    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50642 K  |   50642 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32719 K  |   32719 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121

 Experiment start at: 2024-08-05 06:40:25.677071
before training, model accuracy: 0.054656196385622025
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9655427, 'precision': 0.96567845, 'recall': 0.9655409, 'specificity': 0.9655409, 'f1': 0.96554005, 'auroc': 0.9942977, 'binary_precision': 0.9577783, 'binary_recall': 0.974038, 'binary_specificity': 0.9570438, 'binary_f1_score': 0.9658397}
confusion matrix:
       0      1
0  27894   1252
1    757  28401
---- Validation: 
scalar performance:
{'acc': 0.8971395, 'precision': 0.57853377, 'recall': 0.74369466, 'specificity': 0.74369466, 'f1': 0.60509884, 'auroc': 0.8176762, 'binary_precision': 0.17217563, 'binary_recall': 0.5797342, 'binary_specificity': 0.90765506, 'binary_f1_score': 0.2655002}
confusion matrix:
       0     1
0  16493  1678
1    253   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92707163, 'precision': 0.650771, 'recall': 0.83516896, 'specificity': 0.83516896, 'f1': 0.6999827, 'auroc': 0.8960699, 'binary_precision': 0.31282952, 'binary_recall': 0.7355372, 'binary_specificity': 0.93480074, 'binary_f1_score': 0.43896425}
confusion matrix:
      0    1
0  5606  391
1    64  178
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 06:50:53.773417,epoch time: 0:10:28.096346,used: 0:10:28.096346,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95317644, 'precision': 0.9553211, 'recall': 0.95316935, 'specificity': 0.95316935, 'f1': 0.9531207, 'auroc': 0.9957377, 'binary_precision': 0.92412376, 'binary_recall': 0.9874477, 'binary_specificity': 0.9188911, 'binary_f1_score': 0.9547368}
confusion matrix:
       0      1
0  26782   2364
1    366  28792
---- Validation: 
scalar performance:
{'acc': 0.8078091, 'precision': 0.54236203, 'recall': 0.71842897, 'specificity': 0.71842897, 'f1': 0.5316916, 'auroc': 0.77351046, 'binary_precision': 0.09984025, 'binary_recall': 0.6229236, 'binary_specificity': 0.81393427, 'binary_f1_score': 0.17209728}
confusion matrix:
       0     1
0  14790  3381
1    227   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7623016, 'precision': 0.5623666, 'recall': 0.8287691, 'specificity': 0.8287691, 'f1': 0.5433764, 'auroc': 0.92273617, 'binary_precision': 0.12999403, 'binary_recall': 0.90082645, 'binary_specificity': 0.75671166, 'binary_f1_score': 0.22720166}
confusion matrix:
      0     1
0  4538  1459
1    24   218
early stop counter: 1
val acc:0.8078091144561768, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 2,now: 2024-08-05 07:01:01.226908,epoch time: 0:10:07.453491,used: 0:20:35.549837,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9650796, 'precision': 0.96551466, 'recall': 0.96507597, 'specificity': 0.96507597, 'f1': 0.9650712, 'auroc': 0.9955065, 'binary_precision': 0.9513429, 'binary_recall': 0.98031485, 'binary_specificity': 0.949837, 'binary_f1_score': 0.9656116}
confusion matrix:
       0      1
0  27683   1462
1    574  28585
---- Validation: 
scalar performance:
{'acc': 0.8816918, 'precision': 0.54925555, 'recall': 0.65942526, 'specificity': 0.65942526, 'f1': 0.56117904, 'auroc': 0.7006538, 'binary_precision': 0.11941702, 'binary_recall': 0.42192692, 'binary_specificity': 0.89692366, 'binary_f1_score': 0.18614878}
confusion matrix:
       0     1
0  16298  1873
1    348   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91841644, 'precision': 0.6453758, 'recall': 0.8703215, 'specificity': 0.8703215, 'f1': 0.6967937, 'auroc': 0.9153151, 'binary_precision': 0.29864255, 'binary_recall': 0.8181818, 'binary_specificity': 0.9224612, 'binary_f1_score': 0.43756908}
confusion matrix:
      0    1
0  5532  465
1    44  198
early stop counter: 2
val acc:0.8816918134689331, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 3,now: 2024-08-05 07:11:12.918457,epoch time: 0:10:11.691549,used: 0:30:47.241386,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9489572, 'precision': 0.95156705, 'recall': 0.94895065, 'specificity': 0.94895065, 'f1': 0.9488828, 'auroc': 0.9952674, 'binary_precision': 0.9172803, 'binary_recall': 0.9869328, 'binary_specificity': 0.91096854, 'binary_f1_score': 0.95083266}
confusion matrix:
       0      1
0  26552   2595
1    381  28776
---- Validation: 
scalar performance:
{'acc': 0.7109146, 'precision': 0.5115872, 'recall': 0.5760261, 'specificity': 0.5760261, 'f1': 0.45784658, 'auroc': 0.5677026, 'binary_precision': 0.048643593, 'binary_recall': 0.43189368, 'binary_specificity': 0.7201585, 'binary_f1_score': 0.087439045}
confusion matrix:
       0     1
0  13086  5085
1    342   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4027889, 'precision': 0.52687156, 'recall': 0.66753453, 'specificity': 0.66753453, 'f1': 0.33042902, 'auroc': 0.91269433, 'binary_precision': 0.058540296, 'binary_recall': 0.95454544, 'binary_specificity': 0.3805236, 'binary_f1_score': 0.11031519}
confusion matrix:
      0     1
0  2282  3715
1    11   231
early stop counter: 3
val acc:0.7109146118164062, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 4,now: 2024-08-05 07:21:28.675016,epoch time: 0:10:15.756559,used: 0:41:02.997945,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9154432, 'precision': 0.9243475, 'recall': 0.9154258, 'specificity': 0.9154258, 'f1': 0.91499496, 'auroc': 0.99382925, 'binary_precision': 0.86293775, 'binary_recall': 0.9878254, 'binary_specificity': 0.8430262, 'binary_f1_score': 0.92116797}
confusion matrix:
       0      1
0  24570   4575
1    355  28804
---- Validation: 
scalar performance:
{'acc': 0.61055773, 'precision': 0.50505567, 'recall': 0.53864014, 'specificity': 0.53864014, 'f1': 0.41216958, 'auroc': 0.5702257, 'binary_precision': 0.038265657, 'binary_recall': 0.46179402, 'binary_specificity': 0.6154862, 'binary_f1_score': 0.07067497}
confusion matrix:
       0     1
0  11184  6987
1    324   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32633436, 'precision': 0.52646476, 'recall': 0.64560926, 'specificity': 0.64560926, 'f1': 0.28165329, 'auroc': 0.9251716, 'binary_precision': 0.05404188, 'binary_recall': 0.9917355, 'binary_specificity': 0.29948306, 'binary_f1_score': 0.10249839}
confusion matrix:
      0     1
0  1796  4201
1     2   240
early stop counter: 4
val acc:0.6105577349662781, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 5,now: 2024-08-05 07:31:51.960839,epoch time: 0:10:23.285823,used: 0:51:26.283768,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9278437, 'precision': 0.9338965, 'recall': 0.92783356, 'specificity': 0.92783356, 'f1': 0.92759, 'auroc': 0.99394405, 'binary_precision': 0.8826922, 'binary_recall': 0.9868642, 'binary_specificity': 0.86880296, 'binary_f1_score': 0.931876}
confusion matrix:
       0      1
0  25323   3824
1    383  28774
---- Validation: 
scalar performance:
{'acc': 0.72130185, 'precision': 0.5133004, 'recall': 0.585407, 'specificity': 0.585407, 'f1': 0.46368542, 'auroc': 0.5625167, 'binary_precision': 0.051356588, 'binary_recall': 0.44019935, 'binary_specificity': 0.7306147, 'binary_f1_score': 0.09198195}
confusion matrix:
       0     1
0  13276  4895
1    337   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53293794, 'precision': 0.53419495, 'recall': 0.7292868, 'specificity': 0.7292868, 'f1': 0.40768653, 'auroc': 0.91781986, 'binary_precision': 0.07289003, 'binary_recall': 0.94214875, 'binary_specificity': 0.5164249, 'binary_f1_score': 0.13531157}
confusion matrix:
      0     1
0  3097  2900
1    14   228
early stop counter: 5
val acc:0.7213018536567688, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 6,now: 2024-08-05 07:42:10.064362,epoch time: 0:10:18.103523,used: 1:01:44.387291,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9291815, 'precision': 0.9353512, 'recall': 0.92916524, 'specificity': 0.92916524, 'f1': 0.9289279, 'auroc': 0.9942617, 'binary_precision': 0.8835933, 'binary_recall': 0.98864883, 'binary_specificity': 0.8696816, 'binary_f1_score': 0.93317366}
confusion matrix:
       0      1
0  25346   3798
1    331  28829
---- Validation: 
scalar performance:
{'acc': 0.6851329, 'precision': 0.50955003, 'recall': 0.56592035, 'specificity': 0.56592035, 'f1': 0.4459894, 'auroc': 0.565664, 'binary_precision': 0.045228712, 'binary_recall': 0.4385382, 'binary_specificity': 0.6933025, 'binary_f1_score': 0.08200031}
confusion matrix:
       0     1
0  12598  5573
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36688572, 'precision': 0.5264253, 'recall': 0.6567895, 'specificity': 0.6567895, 'f1': 0.3080694, 'auroc': 0.89914864, 'binary_precision': 0.056247007, 'binary_recall': 0.9710744, 'binary_specificity': 0.3425046, 'binary_f1_score': 0.106334835}
confusion matrix:
      0     1
0  2054  3943
1     7   235
early stop counter: 6
val acc:0.6851329207420349, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 7,now: 2024-08-05 07:52:13.823609,epoch time: 0:10:03.759247,used: 1:11:48.146538,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92499655, 'precision': 0.9321284, 'recall': 0.9249855, 'specificity': 0.9249855, 'f1': 0.92468446, 'auroc': 0.9945395, 'binary_precision': 0.87665653, 'binary_recall': 0.9891964, 'binary_specificity': 0.8607747, 'binary_f1_score': 0.92953247}
confusion matrix:
       0      1
0  25089   4058
1    315  28842
---- Validation: 
scalar performance:
{'acc': 0.6264849, 'precision': 0.5051715, 'recall': 0.538837, 'specificity': 0.538837, 'f1': 0.41863164, 'auroc': 0.5388553, 'binary_precision': 0.038583357, 'binary_recall': 0.4451827, 'binary_specificity': 0.63249135, 'binary_f1_score': 0.071012184}
confusion matrix:
       0     1
0  11493  6678
1    334   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.2264786, 'precision': 0.5238753, 'recall': 0.59763217, 'specificity': 0.59763217, 'f1': 0.20893934, 'auroc': 0.86737657, 'binary_precision': 0.047750592, 'binary_recall': 1.0, 'binary_specificity': 0.1952643, 'binary_f1_score': 0.09114878}
confusion matrix:
      0     1
0  1171  4826
1     0   242
early stop counter: 7
val acc:0.6264848709106445, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 8,now: 2024-08-05 08:02:23.464236,epoch time: 0:10:09.640627,used: 1:21:57.787165,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9434001, 'precision': 0.9469627, 'recall': 0.94339097, 'specificity': 0.94339097, 'f1': 0.9432863, 'auroc': 0.995456, 'binary_precision': 0.90711004, 'binary_recall': 0.98799646, 'binary_specificity': 0.8987854, 'binary_f1_score': 0.94582707}
confusion matrix:
       0      1
0  26196   2950
1    350  28808
---- Validation: 
scalar performance:
{'acc': 0.65279925, 'precision': 0.50699574, 'recall': 0.55082405, 'specificity': 0.55082405, 'f1': 0.43086404, 'auroc': 0.5596355, 'binary_precision': 0.0412531, 'binary_recall': 0.44186047, 'binary_specificity': 0.6597876, 'binary_f1_score': 0.07546099}
confusion matrix:
       0     1
0  11989  6182
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41577175, 'precision': 0.5275668, 'recall': 0.6742879, 'specificity': 0.6742879, 'f1': 0.33852953, 'auroc': 0.8758656, 'binary_precision': 0.059767142, 'binary_recall': 0.95454544, 'binary_specificity': 0.39403036, 'binary_f1_score': 0.11249086}
confusion matrix:
      0     1
0  2363  3634
1    11   231
early stop counter: 8
val acc:0.6527992486953735, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 9,now: 2024-08-05 08:12:32.197248,epoch time: 0:10:08.733012,used: 1:32:06.520177,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9281868, 'precision': 0.9349363, 'recall': 0.9281739, 'specificity': 0.9281739, 'f1': 0.92790556, 'auroc': 0.99520886, 'binary_precision': 0.88080645, 'binary_recall': 0.9904314, 'binary_specificity': 0.86591643, 'binary_f1_score': 0.9324078}
confusion matrix:
       0      1
0  25238   3908
1    279  28879
---- Validation: 
scalar performance:
{'acc': 0.66569006, 'precision': 0.5083963, 'recall': 0.5598921, 'specificity': 0.5598921, 'f1': 0.437369, 'auroc': 0.5830638, 'binary_precision': 0.043303285, 'binary_recall': 0.44684386, 'binary_specificity': 0.6729404, 'binary_f1_score': 0.0789551}
confusion matrix:
       0     1
0  12228  5943
1    333   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34861356, 'precision': 0.5266569, 'recall': 0.65323293, 'specificity': 0.65323293, 'f1': 0.29643905, 'auroc': 0.9072272, 'binary_precision': 0.055374593, 'binary_recall': 0.9834711, 'binary_specificity': 0.32299483, 'binary_f1_score': 0.104845814}
confusion matrix:
      0     1
0  1937  4060
1     4   238
early stop counter: 9
val acc:0.6656900644302368, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 10,now: 2024-08-05 08:22:56.772794,epoch time: 0:10:24.575546,used: 1:42:31.095723,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9502264, 'precision': 0.952877, 'recall': 0.95021987, 'specificity': 0.95021987, 'f1': 0.950153, 'auroc': 0.99610126, 'binary_precision': 0.91827303, 'binary_recall': 0.9884419, 'binary_specificity': 0.9119978, 'binary_f1_score': 0.9520663}
confusion matrix:
       0      1
0  26582   2565
1    337  28820
---- Validation: 
scalar performance:
{'acc': 0.766846, 'precision': 0.5191318, 'recall': 0.6089335, 'specificity': 0.6089335, 'f1': 0.48695278, 'auroc': 0.59283847, 'binary_precision': 0.061556328, 'binary_recall': 0.44019935, 'binary_specificity': 0.7776677, 'binary_f1_score': 0.10800897}
confusion matrix:
       0     1
0  14131  4040
1    337   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5363039, 'precision': 0.5335699, 'recall': 0.72508943, 'specificity': 0.72508943, 'f1': 0.40895778, 'auroc': 0.90214527, 'binary_precision': 0.07255724, 'binary_recall': 0.92975205, 'binary_specificity': 0.52042687, 'binary_f1_score': 0.13460964}
confusion matrix:
      0     1
0  3121  2876
1    17   225
early stop counter: 10
val acc:0.7668460011482239, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 11,now: 2024-08-05 08:33:01.826738,epoch time: 0:10:05.053944,used: 1:52:36.149667,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8924945, 'precision': 0.9087453, 'recall': 0.8924706, 'specificity': 0.8924706, 'f1': 0.89141095, 'auroc': 0.9941266, 'binary_precision': 0.8273042, 'binary_recall': 0.9921465, 'binary_specificity': 0.79279464, 'binary_f1_score': 0.902258}
confusion matrix:
       0      1
0  23106   6039
1    229  28930
---- Validation: 
scalar performance:
{'acc': 0.50636554, 'precision': 0.49821424, 'recall': 0.48562112, 'specificity': 0.48562112, 'f1': 0.36124927, 'auroc': 0.56584024, 'binary_precision': 0.03025046, 'binary_recall': 0.46345514, 'binary_specificity': 0.5077871, 'binary_f1_score': 0.05679389}
confusion matrix:
      0     1
0  9227  8944
1   323   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.20147459, 'precision': 0.5225838, 'recall': 0.5826429, 'specificity': 0.5826429, 'f1': 0.18896003, 'auroc': 0.87514377, 'binary_precision': 0.0461509, 'binary_recall': 0.9958678, 'binary_specificity': 0.16941804, 'binary_f1_score': 0.088213764}
confusion matrix:
      0     1
0  1016  4981
1     1   241
early stop counter: 11
val acc:0.5063655376434326, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 12,now: 2024-08-05 08:43:09.926062,epoch time: 0:10:08.099324,used: 2:02:44.248991,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92185783, 'precision': 0.93001914, 'recall': 0.92184603, 'specificity': 0.92184603, 'f1': 0.9214839, 'auroc': 0.99566925, 'binary_precision': 0.8708209, 'binary_recall': 0.9907055, 'binary_specificity': 0.8529866, 'binary_f1_score': 0.92690283}
confusion matrix:
       0      1
0  24862   4285
1    271  28886
---- Validation: 
scalar performance:
{'acc': 0.64198583, 'precision': 0.50657016, 'recall': 0.54845035, 'specificity': 0.54845035, 'f1': 0.4262224, 'auroc': 0.588249, 'binary_precision': 0.04054663, 'binary_recall': 0.44850498, 'binary_specificity': 0.6483958, 'binary_f1_score': 0.07436992}
confusion matrix:
       0     1
0  11782  6389
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4305177, 'precision': 0.5286993, 'recall': 0.6839411, 'specificity': 0.6839411, 'f1': 0.3477912, 'auroc': 0.89902115, 'binary_precision': 0.061456952, 'binary_recall': 0.9586777, 'binary_specificity': 0.4092046, 'binary_f1_score': 0.115509085}
confusion matrix:
      0     1
0  2454  3543
1    10   232
early stop counter: 12
val acc:0.6419858336448669, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 13,now: 2024-08-05 08:53:20.085164,epoch time: 0:10:10.159102,used: 2:12:54.408093,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9228869, 'precision': 0.93087655, 'recall': 0.9228776, 'specificity': 0.9228776, 'f1': 0.92252666, 'auroc': 0.99546254, 'binary_precision': 0.8722376, 'binary_recall': 0.9909453, 'binary_specificity': 0.85480994, 'binary_f1_score': 0.9278099}
confusion matrix:
       0      1
0  24916   4232
1    264  28892
---- Validation: 
scalar performance:
{'acc': 0.6904597, 'precision': 0.51062137, 'recall': 0.57268727, 'specificity': 0.57268727, 'f1': 0.44923493, 'auroc': 0.59809405, 'binary_precision': 0.04680703, 'binary_recall': 0.44684386, 'binary_specificity': 0.6985306, 'binary_f1_score': 0.084737755}
confusion matrix:
       0     1
0  12693  5478
1    333   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47106907, 'precision': 0.5307897, 'recall': 0.7030523, 'specificity': 0.7030523, 'f1': 0.37209648, 'auroc': 0.90022933, 'binary_precision': 0.065625, 'binary_recall': 0.95454544, 'binary_specificity': 0.45155913, 'binary_f1_score': 0.122807}
confusion matrix:
      0     1
0  2708  3289
1    11   231
early stop counter: 13
val acc:0.6904597282409668, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 14,now: 2024-08-05 09:03:26.144962,epoch time: 0:10:06.059798,used: 2:23:00.467891,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9076907, 'precision': 0.91980237, 'recall': 0.9076791, 'specificity': 0.9076791, 'f1': 0.90701836, 'auroc': 0.99444234, 'binary_precision': 0.84853107, 'binary_recall': 0.99259156, 'binary_specificity': 0.82276654, 'binary_f1_score': 0.9149253}
confusion matrix:
       0      1
0  23982   5166
1    216  28940
---- Validation: 
scalar performance:
{'acc': 0.61561817, 'precision': 0.50521433, 'recall': 0.53964806, 'specificity': 0.53964806, 'f1': 0.4143671, 'auroc': 0.5738294, 'binary_precision': 0.03851521, 'binary_recall': 0.45847178, 'binary_specificity': 0.6208244, 'binary_f1_score': 0.07106076}
confusion matrix:
       0     1
0  11281  6890
1    326   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4205802, 'precision': 0.52782947, 'recall': 0.67678916, 'specificity': 0.67678916, 'f1': 0.34150636, 'auroc': 0.9082398, 'binary_precision': 0.06023468, 'binary_recall': 0.95454544, 'binary_specificity': 0.39903286, 'binary_f1_score': 0.113318615}
confusion matrix:
      0     1
0  2393  3604
1    11   231
early stop counter: 14
val acc:0.6156181693077087, best validation acc: 0.8971394896507263, corresponding to test acc:                         0.9270716309547424 / 0.9270716309547424
after epoch: 15,now: 2024-08-05 09:13:36.064510,epoch time: 0:10:09.919548,used: 2:33:10.387439,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_06_40_25_seed_2_24067121
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:10.387439 at 2024-08-05 09:13:36.064510
persisted model performance metric: 

scalar performance:
{'acc': 0.92707163, 'precision': 0.650771, 'recall': 0.83516896, 'specificity': 0.83516896, 'f1': 0.6999827, 'auroc': 0.8960699, 'binary_precision': 0.31282952, 'binary_recall': 0.7355372, 'binary_specificity': 0.93480074, 'binary_f1_score': 0.43896425}
confusion matrix:
      0    1
0  5606  391
1    64  178
oracle model performance metric: 

scalar performance:
{'acc': 0.92707163, 'precision': 0.650771, 'recall': 0.83516896, 'specificity': 0.83516896, 'f1': 0.6999827, 'auroc': 0.8960699, 'binary_precision': 0.31282952, 'binary_recall': 0.7355372, 'binary_specificity': 0.93480074, 'binary_f1_score': 0.43896425}
confusion matrix:
      0    1
0  5606  391
1    64  178
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522827 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool | 436736 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |  86091 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  16616 MiB |  10072 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  16428 MiB |  10006 MiB |
|       from small pool |    122 MiB |    124 MiB |    188 MiB |     66 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1059 MiB |   1463 MiB | 730726 GiB | 730725 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 728432 GiB | 728431 GiB |
|       from small pool |      4 MiB |     27 MiB |   2294 GiB |   2294 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3618    |    8435    |  163861 K  |  163858 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95828 K  |   95824 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3618    |    8435    |  163861 K  |  163858 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95828 K  |   95824 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     256    |     126    |
|       from large pool |      69    |      71    |     162    |      93    |
|       from small pool |      61    |      62    |      94    |      33    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3675    |   77048 K  |   77048 K  |
|       from large pool |      21    |      36    |   27378 K  |   27378 K  |
|       from small pool |      54    |    3655    |   49669 K  |   49669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool |  65536 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |      0 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1582 MiB |   6564 MiB |  16616 MiB |  15034 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  16428 MiB |  14936 MiB |
|       from small pool |     90 MiB |    124 MiB |    188 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 730727 GiB | 730727 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 728433 GiB | 728433 GiB |
|       from small pool |      0 KiB |     27 MiB |   2294 GiB |   2294 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8435    |  163861 K  |  163861 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95828 K  |   95828 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8435    |  163861 K  |  163861 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95828 K  |   95828 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     133    |     256    |     187    |
|       from large pool |      24    |      71    |     162    |     138    |
|       from small pool |      45    |      62    |      94    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3675    |   77050 K  |   77050 K  |
|       from large pool |       3    |      36    |   27378 K  |   27378 K  |
|       from small pool |       0    |    3655    |   49671 K  |   49671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 09:14:21 2024]
Finished job 0.
1 of 1 steps (100%) done
