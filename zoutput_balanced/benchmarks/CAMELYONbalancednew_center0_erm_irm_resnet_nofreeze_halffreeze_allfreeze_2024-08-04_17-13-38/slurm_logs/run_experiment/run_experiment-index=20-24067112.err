Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 17:16:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/13.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=13
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112

 Experiment start at: 2024-08-04 17:30:20.497749
before training, model accuracy: 0.31048259139060974
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.75197, 'precision': 0.7739823, 'recall': 0.75184137, 'specificity': 0.75184137, 'f1': 0.74682236, 'auroc': 0.85387826, 'binary_precision': 0.6965493, 'binary_recall': 0.8937504, 'binary_specificity': 0.6099323, 'binary_f1_score': 0.78292316}
confusion matrix:
       0      1
0  17477  11177
1   3050  25656
---- Validation: 
scalar performance:
{'acc': 0.5268731, 'precision': 0.5145893, 'recall': 0.6102947, 'specificity': 0.6102947, 'f1': 0.38601023, 'auroc': 0.64439034, 'binary_precision': 0.04919108, 'binary_recall': 0.6998445, 'binary_specificity': 0.5207449, 'binary_f1_score': 0.09192115}
confusion matrix:
      0     1
0  9451  8698
1   193   450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49744326, 'precision': 0.5281805, 'recall': 0.6754862, 'specificity': 0.6754862, 'f1': 0.3867245, 'auroc': 0.7764808, 'binary_precision': 0.068004794, 'binary_recall': 0.8697318, 'binary_specificity': 0.48124063, 'binary_f1_score': 0.12614615}
confusion matrix:
      0     1
0  2886  3111
1    34   227
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 17:44:24.826923,epoch time: 0:14:04.329174,used: 0:14:04.329174,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8163703, 'precision': 0.8349184, 'recall': 0.81626767, 'specificity': 0.81626767, 'f1': 0.81375825, 'auroc': 0.914648, 'binary_precision': 0.7563191, 'binary_recall': 0.9339836, 'binary_specificity': 0.6985517, 'binary_f1_score': 0.83581436}
confusion matrix:
       0      1
0  20017   8638
1   1895  26810
---- Validation: 
scalar performance:
{'acc': 0.63495106, 'precision': 0.5191174, 'recall': 0.6354959, 'specificity': 0.6354959, 'f1': 0.4385764, 'auroc': 0.65093756, 'binary_precision': 0.058137883, 'binary_recall': 0.63608086, 'binary_specificity': 0.634911, 'binary_f1_score': 0.10653816}
confusion matrix:
       0     1
0  11523  6626
1    234   409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6514861, 'precision': 0.5338491, 'recall': 0.6972251, 'specificity': 0.6972251, 'f1': 0.46619287, 'auroc': 0.7531198, 'binary_precision': 0.084415585, 'binary_recall': 0.74712646, 'binary_specificity': 0.64732367, 'binary_f1_score': 0.15169196}
confusion matrix:
      0     1
0  3882  2115
1    66   195
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 17:54:40.274229,epoch time: 0:10:15.447306,used: 0:24:19.776480,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.82869595, 'precision': 0.852683, 'recall': 0.82857776, 'specificity': 0.82857776, 'f1': 0.82569695, 'auroc': 0.939304, 'binary_precision': 0.7609321, 'binary_recall': 0.95899814, 'binary_specificity': 0.6981573, 'binary_f1_score': 0.8485606}
confusion matrix:
       0      1
0  20005   8649
1   1177  27529
---- Validation: 
scalar performance:
{'acc': 0.6088229, 'precision': 0.52175415, 'recall': 0.65872175, 'specificity': 0.65872175, 'f1': 0.43003008, 'auroc': 0.6894337, 'binary_precision': 0.060073454, 'binary_recall': 0.7122862, 'binary_specificity': 0.6051573, 'binary_f1_score': 0.11080199}
confusion matrix:
       0     1
0  10983  7166
1    185   458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66331095, 'precision': 0.538135, 'recall': 0.7198858, 'specificity': 0.7198858, 'f1': 0.47577387, 'auroc': 0.80642235, 'binary_precision': 0.090505764, 'binary_recall': 0.7816092, 'binary_specificity': 0.6581624, 'binary_f1_score': 0.16222663}
confusion matrix:
      0     1
0  3947  2050
1    57   204
new oracle model saved
early stop counter: 1
val acc:0.6088228821754456, best validation acc: 0.6349510550498962, corresponding to test acc:                         0.6514860987663269 / 0.6633109450340271
after epoch: 3,now: 2024-08-04 18:04:55.317301,epoch time: 0:10:15.043072,used: 0:34:34.819552,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85903066, 'precision': 0.8602873, 'recall': 0.8590111, 'specificity': 0.8590111, 'f1': 0.85890293, 'auroc': 0.93710375, 'binary_precision': 0.8391746, 'binary_recall': 0.8885327, 'binary_specificity': 0.8294895, 'binary_f1_score': 0.86314857}
confusion matrix:
       0      1
0  23774   4887
1   3199  25500
---- Validation: 
scalar performance:
{'acc': 0.74483824, 'precision': 0.5238365, 'recall': 0.6376321, 'specificity': 0.6376321, 'f1': 0.4868107, 'auroc': 0.66489947, 'binary_precision': 0.06965174, 'binary_recall': 0.5225505, 'binary_specificity': 0.7527136, 'binary_f1_score': 0.12291933}
confusion matrix:
       0     1
0  13661  4488
1    307   336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8037712, 'precision': 0.54688025, 'recall': 0.6887294, 'specificity': 0.6887294, 'f1': 0.54073477, 'auroc': 0.75298184, 'binary_precision': 0.116574146, 'binary_recall': 0.5632184, 'binary_specificity': 0.81424046, 'binary_f1_score': 0.19316688}
confusion matrix:
      0     1
0  4883  1114
1   114   147
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 18:15:01.586744,epoch time: 0:10:06.269443,used: 0:44:41.088995,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86107045, 'precision': 0.87327003, 'recall': 0.8609948, 'specificity': 0.8609948, 'f1': 0.85990804, 'auroc': 0.9524107, 'binary_precision': 0.8059975, 'binary_recall': 0.95136565, 'binary_specificity': 0.770624, 'binary_f1_score': 0.8726692}
confusion matrix:
       0      1
0  22083   6573
1   1396  27308
---- Validation: 
scalar performance:
{'acc': 0.6938591, 'precision': 0.5239669, 'recall': 0.6562428, 'specificity': 0.6562428, 'f1': 0.46783048, 'auroc': 0.6723927, 'binary_precision': 0.0670959, 'binary_recall': 0.61586314, 'binary_specificity': 0.69662243, 'binary_f1_score': 0.12100841}
confusion matrix:
       0     1
0  12643  5506
1    247   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7574305, 'precision': 0.54624236, 'recall': 0.72135305, 'specificity': 0.72135305, 'f1': 0.5236628, 'auroc': 0.7972957, 'binary_precision': 0.11035338, 'binary_recall': 0.68199235, 'binary_specificity': 0.7607137, 'binary_f1_score': 0.18996798}
confusion matrix:
      0     1
0  4562  1435
1    83   178
early stop counter: 1
val acc:0.6938591003417969, best validation acc: 0.7448382377624512, corresponding to test acc:                         0.8037711977958679 / 0.8037711977958679
after epoch: 5,now: 2024-08-04 18:24:58.242322,epoch time: 0:09:56.655578,used: 0:54:37.744573,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8796897, 'precision': 0.8845868, 'recall': 0.8796484, 'specificity': 0.8796484, 'f1': 0.87929714, 'auroc': 0.9585533, 'binary_precision': 0.8413718, 'binary_recall': 0.9360301, 'binary_specificity': 0.8232667, 'binary_f1_score': 0.88618034}
confusion matrix:
       0      1
0  23594   5065
1   1836  26865
---- Validation: 
scalar performance:
{'acc': 0.7180183, 'precision': 0.5245577, 'recall': 0.6522491, 'specificity': 0.6522491, 'f1': 0.47783643, 'auroc': 0.6739824, 'binary_precision': 0.069207996, 'binary_recall': 0.5816485, 'binary_specificity': 0.7228497, 'binary_f1_score': 0.12369771}
confusion matrix:
       0     1
0  13119  5030
1    269   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78699267, 'precision': 0.54933107, 'recall': 0.7147894, 'specificity': 0.7147894, 'f1': 0.53827673, 'auroc': 0.79120916, 'binary_precision': 0.11823362, 'binary_recall': 0.6360153, 'binary_specificity': 0.7935634, 'binary_f1_score': 0.1993994}
confusion matrix:
      0     1
0  4759  1238
1    95   166
early stop counter: 2
val acc:0.7180182933807373, best validation acc: 0.7448382377624512, corresponding to test acc:                         0.8037711977958679 / 0.8037711977958679
after epoch: 6,now: 2024-08-04 18:34:47.934717,epoch time: 0:09:49.692395,used: 1:04:27.436968,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88854605, 'precision': 0.8909757, 'recall': 0.88851583, 'specificity': 0.88851583, 'f1': 0.88836706, 'auroc': 0.96176493, 'binary_precision': 0.86034566, 'binary_recall': 0.9278796, 'binary_specificity': 0.8491521, 'binary_f1_score': 0.8928374}
confusion matrix:
       0      1
0  24335   4323
1   2070  26632
---- Validation: 
scalar performance:
{'acc': 0.73706895, 'precision': 0.5246348, 'recall': 0.6456107, 'specificity': 0.6456107, 'f1': 0.48500547, 'auroc': 0.67086947, 'binary_precision': 0.07037185, 'binary_recall': 0.5474339, 'binary_specificity': 0.7437875, 'binary_f1_score': 0.12471213}
confusion matrix:
       0     1
0  13499  4650
1    291   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80009586, 'precision': 0.5504768, 'recall': 0.70879984, 'specificity': 0.70879984, 'f1': 0.54419947, 'auroc': 0.7919375, 'binary_precision': 0.121559635, 'binary_recall': 0.6091954, 'binary_specificity': 0.8084042, 'binary_f1_score': 0.20267686}
confusion matrix:
      0     1
0  4848  1149
1   102   159
early stop counter: 3
val acc:0.7370689511299133, best validation acc: 0.7448382377624512, corresponding to test acc:                         0.8037711977958679 / 0.8037711977958679
after epoch: 7,now: 2024-08-04 18:44:44.052251,epoch time: 0:09:56.117534,used: 1:14:23.554502,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8902371, 'precision': 0.89341676, 'recall': 0.8902011, 'specificity': 0.8902011, 'f1': 0.89000833, 'auroc': 0.96455437, 'binary_precision': 0.85824835, 'binary_recall': 0.9350939, 'binary_specificity': 0.8453083, 'binary_f1_score': 0.8950247}
confusion matrix:
       0      1
0  24224   4433
1   1863  26840
---- Validation: 
scalar performance:
{'acc': 0.7420711, 'precision': 0.5264735, 'recall': 0.65495086, 'specificity': 0.65495086, 'f1': 0.4891242, 'auroc': 0.6828618, 'binary_precision': 0.07328461, 'binary_recall': 0.5614308, 'binary_specificity': 0.74847096, 'binary_f1_score': 0.12964624}
confusion matrix:
       0     1
0  13584  4565
1    282   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8072867, 'precision': 0.5546856, 'recall': 0.7217133, 'specificity': 0.7217133, 'f1': 0.552002, 'auroc': 0.8015507, 'binary_precision': 0.12882954, 'binary_recall': 0.62835246, 'binary_specificity': 0.8150742, 'binary_f1_score': 0.21382007}
confusion matrix:
      0     1
0  4888  1109
1    97   164
new oracle model saved
early stop counter: 4
val acc:0.7420710921287537, best validation acc: 0.7448382377624512, corresponding to test acc:                         0.8037711977958679 / 0.8072866797447205
after epoch: 8,now: 2024-08-04 18:54:40.489002,epoch time: 0:09:56.436751,used: 1:24:19.991253,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9006102, 'precision': 0.9025687, 'recall': 0.9005798, 'specificity': 0.9005798, 'f1': 0.9004842, 'auroc': 0.9682746, 'binary_precision': 0.8747068, 'binary_recall': 0.9353771, 'binary_specificity': 0.86578256, 'binary_f1_score': 0.90402526}
confusion matrix:
       0      1
0  24809   3846
1   1855  26850
---- Validation: 
scalar performance:
{'acc': 0.76607066, 'precision': 0.5295942, 'recall': 0.66212547, 'specificity': 0.66212547, 'f1': 0.5016849, 'auroc': 0.67737734, 'binary_precision': 0.079354405, 'binary_recall': 0.5505443, 'binary_specificity': 0.77370656, 'binary_f1_score': 0.13871473}
confusion matrix:
       0     1
0  14042  4107
1    289   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82086927, 'precision': 0.5586566, 'recall': 0.72513556, 'specificity': 0.72513556, 'f1': 0.5614829, 'auroc': 0.80805856, 'binary_precision': 0.13682432, 'binary_recall': 0.62068963, 'binary_specificity': 0.82958144, 'binary_f1_score': 0.22422147}
confusion matrix:
      0     1
0  4975  1022
1    99   162
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 19:04:37.487237,epoch time: 0:09:56.998235,used: 1:34:16.989488,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8983438, 'precision': 0.9020014, 'recall': 0.8983056, 'specificity': 0.8983056, 'f1': 0.8981057, 'auroc': 0.96980774, 'binary_precision': 0.8638562, 'binary_recall': 0.945929, 'binary_specificity': 0.8506822, 'binary_f1_score': 0.90303165}
confusion matrix:
       0      1
0  24378   4279
1   1552  27151
---- Validation: 
scalar performance:
{'acc': 0.7697424, 'precision': 0.53206176, 'recall': 0.67452717, 'specificity': 0.67452717, 'f1': 0.50615793, 'auroc': 0.7159288, 'binary_precision': 0.08325792, 'binary_recall': 0.57231724, 'binary_specificity': 0.77673703, 'binary_f1_score': 0.14536835}
confusion matrix:
       0     1
0  14097  4052
1    275   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82949823, 'precision': 0.5660708, 'recall': 0.74796116, 'specificity': 0.74796116, 'f1': 0.57385796, 'auroc': 0.8215538, 'binary_precision': 0.14956522, 'binary_recall': 0.65900385, 'binary_specificity': 0.8369185, 'binary_f1_score': 0.24379873}
confusion matrix:
      0    1
0  5019  978
1    89  172
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-04 19:14:32.622324,epoch time: 0:09:55.135087,used: 1:44:12.124575,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9007496, 'precision': 0.9015404, 'recall': 0.90072966, 'specificity': 0.90072966, 'f1': 0.90069747, 'auroc': 0.96788055, 'binary_precision': 0.8839467, 'binary_recall': 0.92283845, 'binary_specificity': 0.8786208, 'binary_f1_score': 0.902974}
confusion matrix:
       0      1
0  25176   3478
1   2215  26491
---- Validation: 
scalar performance:
{'acc': 0.80475736, 'precision': 0.5302062, 'recall': 0.64240116, 'specificity': 0.64240116, 'f1': 0.5154067, 'auroc': 0.69489, 'binary_precision': 0.08296582, 'binary_recall': 0.4681182, 'binary_specificity': 0.8166841, 'binary_f1_score': 0.14095059}
confusion matrix:
       0     1
0  14822  3327
1    342   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8550655, 'precision': 0.5697325, 'recall': 0.72465444, 'specificity': 0.72465444, 'f1': 0.5854011, 'auroc': 0.78931165, 'binary_precision': 0.16, 'binary_recall': 0.58237547, 'binary_specificity': 0.86693347, 'binary_f1_score': 0.2510322}
confusion matrix:
      0    1
0  5199  798
1   109  152
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-04 19:24:38.353839,epoch time: 0:10:05.731515,used: 1:54:17.856090,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9140516, 'precision': 0.9140844, 'recall': 0.9140557, 'specificity': 0.9140557, 'f1': 0.9140504, 'auroc': 0.97273123, 'binary_precision': 0.9180028, 'binary_recall': 0.90949625, 'binary_specificity': 0.9186152, 'binary_f1_score': 0.9137297}
confusion matrix:
       0      1
0  26322   2332
1   2598  26108
---- Validation: 
scalar performance:
{'acc': 0.8270541, 'precision': 0.53178555, 'recall': 0.63444304, 'specificity': 0.63444304, 'f1': 0.52426875, 'auroc': 0.69436884, 'binary_precision': 0.087108016, 'binary_recall': 0.42768273, 'binary_specificity': 0.8412034, 'binary_f1_score': 0.14473684}
confusion matrix:
       0     1
0  15267  2882
1    368   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8641738, 'precision': 0.5721667, 'recall': 0.7184129, 'specificity': 0.7184129, 'f1': 0.59047997, 'auroc': 0.792731, 'binary_precision': 0.16572078, 'binary_recall': 0.55938697, 'binary_specificity': 0.8774387, 'binary_f1_score': 0.2556918}
confusion matrix:
      0    1
0  5262  735
1   115  146
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-04 19:34:38.036576,epoch time: 0:09:59.682737,used: 2:04:17.538827,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.90791494, 'precision': 0.9092499, 'recall': 0.9078891, 'specificity': 0.9078891, 'f1': 0.90783584, 'auroc': 0.97301376, 'binary_precision': 0.8861014, 'binary_recall': 0.93635476, 'binary_specificity': 0.87942344, 'binary_f1_score': 0.9105353}
confusion matrix:
       0      1
0  25199   3455
1   1827  26879
---- Validation: 
scalar performance:
{'acc': 0.7816092, 'precision': 0.5329714, 'recall': 0.67242014, 'specificity': 0.67242014, 'f1': 0.5114712, 'auroc': 0.724234, 'binary_precision': 0.08550898, 'binary_recall': 0.55520993, 'binary_specificity': 0.7896303, 'binary_f1_score': 0.14819427}
confusion matrix:
       0     1
0  14331  3818
1    286   357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84116334, 'precision': 0.5671146, 'recall': 0.7357242, 'specificity': 0.7357242, 'f1': 0.57853055, 'auroc': 0.823604, 'binary_precision': 0.15326396, 'binary_recall': 0.62068963, 'binary_specificity': 0.85075873, 'binary_f1_score': 0.24582702}
confusion matrix:
      0    1
0  5102  895
1    99  162
early stop counter: 1
val acc:0.7816091775894165, best validation acc: 0.8270540833473206, corresponding to test acc:                         0.8641738295555115 / 0.8641738295555115
after epoch: 13,now: 2024-08-04 19:44:31.187101,epoch time: 0:09:53.150525,used: 2:14:10.689352,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9066771, 'precision': 0.9075402, 'recall': 0.9066587, 'specificity': 0.9066587, 'f1': 0.90662485, 'auroc': 0.9717639, 'binary_precision': 0.88898516, 'binary_recall': 0.9295892, 'binary_specificity': 0.8837282, 'binary_f1_score': 0.9088339}
confusion matrix:
       0      1
0  25325   3332
1   2021  26682
---- Validation: 
scalar performance:
{'acc': 0.80395913, 'precision': 0.53364015, 'recall': 0.6607393, 'specificity': 0.6607393, 'f1': 0.51978266, 'auroc': 0.72132826, 'binary_precision': 0.08827511, 'binary_recall': 0.5069984, 'binary_specificity': 0.8144801, 'binary_f1_score': 0.150369}
confusion matrix:
       0     1
0  14782  3367
1    317   326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85730267, 'precision': 0.5758278, 'recall': 0.7459774, 'specificity': 0.7459774, 'f1': 0.5941924, 'auroc': 0.82748914, 'binary_precision': 0.17014614, 'binary_recall': 0.6245211, 'binary_specificity': 0.8674337, 'binary_f1_score': 0.26743233}
confusion matrix:
      0    1
0  5202  795
1    98  163
early stop counter: 2
val acc:0.8039591312408447, best validation acc: 0.8270540833473206, corresponding to test acc:                         0.8641738295555115 / 0.8641738295555115
after epoch: 14,now: 2024-08-04 19:54:23.732653,epoch time: 0:09:52.545552,used: 2:24:03.234904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92109483, 'precision': 0.9213637, 'recall': 0.92108566, 'specificity': 0.92108566, 'f1': 0.92108107, 'auroc': 0.977756, 'binary_precision': 0.91090184, 'binary_recall': 0.933626, 'binary_specificity': 0.9085453, 'binary_f1_score': 0.9221239}
confusion matrix:
       0      1
0  26038   2621
1   1905  26796
---- Validation: 
scalar performance:
{'acc': 0.8016709, 'precision': 0.534237, 'recall': 0.6655551, 'specificity': 0.6655551, 'f1': 0.5198474, 'auroc': 0.7274891, 'binary_precision': 0.08901919, 'binary_recall': 0.5194401, 'binary_specificity': 0.81167006, 'binary_f1_score': 0.15199089}
confusion matrix:
       0     1
0  14731  3418
1    309   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85075104, 'precision': 0.5756536, 'recall': 0.75721765, 'specificity': 0.75721765, 'f1': 0.59246445, 'auroc': 0.83159333, 'binary_precision': 0.1684729, 'binary_recall': 0.6551724, 'binary_specificity': 0.85926294, 'binary_f1_score': 0.26802507}
confusion matrix:
      0    1
0  5153  844
1    90  171
early stop counter: 3
val acc:0.8016709089279175, best validation acc: 0.8270540833473206, corresponding to test acc:                         0.8641738295555115 / 0.8641738295555115
after epoch: 15,now: 2024-08-04 20:04:14.130144,epoch time: 0:09:50.397491,used: 2:33:53.632395,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:53.632395 at 2024-08-04 20:04:14.130144
persisted model performance metric: 

scalar performance:
{'acc': 0.8641738, 'precision': 0.5721667, 'recall': 0.7184129, 'specificity': 0.7184129, 'f1': 0.59047997, 'auroc': 0.792731, 'binary_precision': 0.16572078, 'binary_recall': 0.55938697, 'binary_specificity': 0.8774387, 'binary_f1_score': 0.2556918}
confusion matrix:
      0    1
0  5262  735
1   115  146
oracle model performance metric: 

scalar performance:
{'acc': 0.8641738, 'precision': 0.5721667, 'recall': 0.7184129, 'specificity': 0.7184129, 'f1': 0.59047997, 'auroc': 0.792731, 'binary_precision': 0.16572078, 'binary_recall': 0.55938697, 'binary_specificity': 0.8774387, 'binary_f1_score': 0.2556918}
confusion matrix:
      0    1
0  5262  735
1   115  146
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/13.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 253875 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool | 216832 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 253875 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool | 216832 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 249984 KiB | 656104 KiB | 329569 GiB | 329569 GiB |
|       from large pool | 214016 KiB | 584512 KiB | 329440 GiB | 329440 GiB |
|       from small pool |  35968 KiB |  74336 KiB |    129 GiB |    129 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    808 MiB |    808 MiB |    808 MiB |      0 B   |
|       from large pool |    734 MiB |    734 MiB |    734 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  73804 KiB | 236211 KiB | 193574 GiB | 193574 GiB |
|       from large pool |  59648 KiB | 231040 KiB | 193429 GiB | 193429 GiB |
|       from small pool |  14156 KiB |  14156 KiB |    144 GiB |    144 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7939    |   43511 K  |   43508 K  |
|       from large pool |      36    |      76    |   15797 K  |   15797 K  |
|       from small pool |    3216    |    7901    |   27713 K  |   27710 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7939    |   43511 K  |   43508 K  |
|       from large pool |      36    |      76    |   15797 K  |   15797 K  |
|       from small pool |    3216    |    7901    |   27713 K  |   27710 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      54    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      55    |    3599    |   21832 K  |   21832 K  |
|       from large pool |       6    |      12    |    7767 K  |    7767 K  |
|       from small pool |      49    |    3593    |   14065 K  |   14065 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |      0 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |      0 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 329569 GiB | 329569 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 329440 GiB | 329440 GiB |
|       from small pool |      0 KiB |  74336 KiB |    129 GiB |    129 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 327680 KiB |    808 MiB |    808 MiB | 499712 KiB |
|       from large pool | 276480 KiB |    734 MiB |    734 MiB | 475136 KiB |
|       from small pool |  51200 KiB |     74 MiB |     74 MiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 236211 KiB | 193574 GiB | 193574 GiB |
|       from large pool |  47104 KiB | 231040 KiB | 193429 GiB | 193429 GiB |
|       from small pool |      0 KiB |  21751 KiB |    144 GiB |    144 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   43511 K  |   43511 K  |
|       from large pool |       2    |      76    |   15797 K  |   15797 K  |
|       from small pool |       0    |    7901    |   27713 K  |   27713 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   43511 K  |   43511 K  |
|       from large pool |       2    |      76    |   15797 K  |   15797 K  |
|       from small pool |       0    |    7901    |   27713 K  |   27713 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      54    |      54    |      19    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3599    |   21833 K  |   21833 K  |
|       from large pool |       2    |      12    |    7767 K  |    7767 K  |
|       from small pool |       0    |    3593    |   14066 K  |   14066 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |      0 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 330052 GiB | 330052 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 329912 GiB | 329912 GiB |
|       from small pool |      0 KiB |  75475 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 329569 GiB | 329569 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 329440 GiB | 329440 GiB |
|       from small pool |      0 KiB |  74336 KiB |    129 GiB |    129 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 327680 KiB |    808 MiB |    808 MiB | 499712 KiB |
|       from large pool | 276480 KiB |    734 MiB |    734 MiB | 475136 KiB |
|       from small pool |  51200 KiB |     74 MiB |     74 MiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 236211 KiB | 193574 GiB | 193574 GiB |
|       from large pool |  47104 KiB | 231040 KiB | 193429 GiB | 193429 GiB |
|       from small pool |      0 KiB |  21751 KiB |    144 GiB |    144 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   43511 K  |   43511 K  |
|       from large pool |       2    |      76    |   15797 K  |   15797 K  |
|       from small pool |       0    |    7901    |   27713 K  |   27713 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   43511 K  |   43511 K  |
|       from large pool |       2    |      76    |   15797 K  |   15797 K  |
|       from small pool |       0    |    7901    |   27713 K  |   27713 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      54    |      54    |      19    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3599    |   21833 K  |   21833 K  |
|       from large pool |       2    |      12    |    7767 K  |    7767 K  |
|       from small pool |       0    |    3593    |   14066 K  |   14066 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112

 Experiment start at: 2024-08-04 20:10:33.423277
before training, model accuracy: 0.14582662284374237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6630971, 'precision': 0.6966362, 'recall': 0.6629535, 'specificity': 0.6629535, 'f1': 0.6479713, 'auroc': 0.7841222, 'binary_precision': 0.61559993, 'binary_recall': 0.8697794, 'binary_specificity': 0.45612755, 'binary_f1_score': 0.72094196}
confusion matrix:
       0      1
0  13131  15657
1   3754  25074
---- Validation: 
scalar performance:
{'acc': 0.33948773, 'precision': 0.49189606, 'recall': 0.4478684, 'specificity': 0.4478684, 'f1': 0.27467182, 'auroc': 0.42446643, 'binary_precision': 0.030485358, 'binary_recall': 0.56463593, 'binary_specificity': 0.3311009, 'binary_f1_score': 0.057847466}
confusion matrix:
      0      1
0  5982  12085
1   293    380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5145021, 'precision': 0.4947094, 'recall': 0.4671104, 'specificity': 0.4671104, 'f1': 0.36939374, 'auroc': 0.4496646, 'binary_precision': 0.036375884, 'binary_recall': 0.41538462, 'binary_specificity': 0.5188362, 'binary_f1_score': 0.06689377}
confusion matrix:
      0     1
0  3085  2861
1   152   108
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 20:21:02.986224,epoch time: 0:10:29.562947,used: 0:10:29.562947,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8008713, 'precision': 0.8069771, 'recall': 0.8008198, 'specificity': 0.8008198, 'f1': 0.79985726, 'auroc': 0.8948693, 'binary_precision': 0.76386523, 'binary_recall': 0.8714142, 'binary_specificity': 0.73022544, 'binary_f1_score': 0.81410307}
confusion matrix:
       0      1
0  21021   7766
1   3707  25122
---- Validation: 
scalar performance:
{'acc': 0.68511206, 'precision': 0.5106124, 'recall': 0.5656049, 'specificity': 0.5656049, 'f1': 0.45010242, 'auroc': 0.56149346, 'binary_precision': 0.050550207, 'binary_recall': 0.43684992, 'binary_specificity': 0.6943599, 'binary_f1_score': 0.09061489}
confusion matrix:
       0     1
0  12545  5522
1    379   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77795684, 'precision': 0.5177762, 'recall': 0.573335, 'specificity': 0.573335, 'f1': 0.49484274, 'auroc': 0.63911617, 'binary_precision': 0.07, 'binary_recall': 0.35, 'binary_specificity': 0.79667, 'binary_f1_score': 0.11666667}
confusion matrix:
      0     1
0  4737  1209
1   169    91
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 20:31:02.833813,epoch time: 0:09:59.847589,used: 0:20:29.410536,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.844019, 'precision': 0.8466402, 'recall': 0.8439858, 'specificity': 0.8439858, 'f1': 0.84371454, 'auroc': 0.92831314, 'binary_precision': 0.8166874, 'binary_recall': 0.8874783, 'binary_specificity': 0.8004933, 'binary_f1_score': 0.8506125}
confusion matrix:
       0      1
0  23043   5743
1   3244  25586
---- Validation: 
scalar performance:
{'acc': 0.7742796, 'precision': 0.52084196, 'recall': 0.60326624, 'specificity': 0.60326624, 'f1': 0.49411693, 'auroc': 0.64704484, 'binary_precision': 0.06842999, 'binary_recall': 0.4190193, 'binary_specificity': 0.78751314, 'binary_f1_score': 0.11764707}
confusion matrix:
       0     1
0  14228  3839
1    391   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.858524, 'precision': 0.557854, 'recall': 0.6723887, 'specificity': 0.6723887, 'f1': 0.56985044, 'auroc': 0.74357873, 'binary_precision': 0.14153132, 'binary_recall': 0.46923077, 'binary_specificity': 0.8755466, 'binary_f1_score': 0.21746878}
confusion matrix:
      0    1
0  5206  740
1   138  122
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 20:41:07.845286,epoch time: 0:10:05.011473,used: 0:30:34.422009,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8549708, 'precision': 0.86101145, 'recall': 0.8549237, 'specificity': 0.8549237, 'f1': 0.8543499, 'auroc': 0.9414388, 'binary_precision': 0.8144951, 'binary_recall': 0.9195948, 'binary_specificity': 0.79025257, 'binary_f1_score': 0.86386}
confusion matrix:
       0      1
0  22749   6038
1   2318  26511
---- Validation: 
scalar performance:
{'acc': 0.71824974, 'precision': 0.51954234, 'recall': 0.6142627, 'specificity': 0.6142627, 'f1': 0.47300375, 'auroc': 0.6421094, 'binary_precision': 0.0639788, 'binary_recall': 0.5022288, 'binary_specificity': 0.72629654, 'binary_f1_score': 0.11349899}
confusion matrix:
       0     1
0  13122  4945
1    335   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217854, 'precision': 0.5566455, 'recall': 0.7139027, 'specificity': 0.7139027, 'f1': 0.5591723, 'auroc': 0.76515687, 'binary_precision': 0.13408305, 'binary_recall': 0.59615386, 'binary_specificity': 0.8316515, 'binary_f1_score': 0.21892656}
confusion matrix:
      0     1
0  4945  1001
1   105   155
early stop counter: 1
val acc:0.7182497382164001, best validation acc: 0.7742795944213867, corresponding to test acc:                         0.8585240244865417 / 0.8585240244865417
after epoch: 4,now: 2024-08-04 20:51:08.886326,epoch time: 0:10:01.041040,used: 0:40:35.463049,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86720705, 'precision': 0.8701563, 'recall': 0.86717606, 'specificity': 0.86717606, 'f1': 0.866935, 'auroc': 0.94785184, 'binary_precision': 0.83728856, 'binary_recall': 0.91178715, 'binary_specificity': 0.82256496, 'binary_f1_score': 0.87295127}
confusion matrix:
       0      1
0  23680   5108
1   2543  26285
---- Validation: 
scalar performance:
{'acc': 0.74364996, 'precision': 0.5215236, 'recall': 0.6181374, 'specificity': 0.6181374, 'f1': 0.48458773, 'auroc': 0.65885746, 'binary_precision': 0.06797741, 'binary_recall': 0.48291233, 'binary_specificity': 0.7533625, 'binary_f1_score': 0.11917859}
confusion matrix:
       0     1
0  13611  4456
1    348   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8401547, 'precision': 0.5650672, 'recall': 0.7271669, 'specificity': 0.7271669, 'f1': 0.57555383, 'auroc': 0.78068125, 'binary_precision': 0.1500956, 'binary_recall': 0.60384613, 'binary_specificity': 0.8504877, 'binary_f1_score': 0.24042878}
confusion matrix:
      0    1
0  5057  889
1   103  157
early stop counter: 2
val acc:0.743649959564209, best validation acc: 0.7742795944213867, corresponding to test acc:                         0.8585240244865417 / 0.8585240244865417
after epoch: 5,now: 2024-08-04 21:01:28.191630,epoch time: 0:10:19.305304,used: 0:50:54.768353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8705741, 'precision': 0.8742523, 'recall': 0.870538, 'specificity': 0.870538, 'f1': 0.8702474, 'auroc': 0.9518086, 'binary_precision': 0.8373319, 'binary_recall': 0.9200805, 'binary_specificity': 0.82099557, 'binary_f1_score': 0.87675804}
confusion matrix:
       0      1
0  23634   5153
1   2304  26525
---- Validation: 
scalar performance:
{'acc': 0.75144076, 'precision': 0.52030796, 'recall': 0.60858786, 'specificity': 0.60858786, 'f1': 0.48575777, 'auroc': 0.64267206, 'binary_precision': 0.06656515, 'binary_recall': 0.45468053, 'binary_specificity': 0.76249516, 'binary_f1_score': 0.11612903}
confusion matrix:
       0     1
0  13776  4291
1    367   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8179181, 'precision': 0.5535934, 'recall': 0.70452857, 'specificity': 0.70452857, 'f1': 0.5539897, 'auroc': 0.76468086, 'binary_precision': 0.1288396, 'binary_recall': 0.58076924, 'binary_specificity': 0.8282879, 'binary_f1_score': 0.21089387}
confusion matrix:
      0     1
0  4925  1021
1   109   151
early stop counter: 3
val acc:0.7514407634735107, best validation acc: 0.7742795944213867, corresponding to test acc:                         0.8585240244865417 / 0.8585240244865417
after epoch: 6,now: 2024-08-04 21:11:39.274309,epoch time: 0:10:11.082679,used: 1:01:05.851032,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8734553, 'precision': 0.87637126, 'recall': 0.87342477, 'specificity': 0.87342477, 'f1': 0.8732032, 'auroc': 0.9532956, 'binary_precision': 0.84341615, 'binary_recall': 0.9174067, 'binary_specificity': 0.8294428, 'binary_f1_score': 0.8788569}
confusion matrix:
       0      1
0  23878   4910
1   2381  26447
---- Validation: 
scalar performance:
{'acc': 0.77289224, 'precision': 0.5222363, 'recall': 0.6111299, 'specificity': 0.6111299, 'f1': 0.4954896, 'auroc': 0.65837955, 'binary_precision': 0.070486695, 'binary_recall': 0.43684992, 'binary_specificity': 0.78540987, 'binary_f1_score': 0.12138729}
confusion matrix:
       0     1
0  14190  3877
1    379   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8378988, 'precision': 0.56276774, 'recall': 0.7204727, 'specificity': 0.7204727, 'f1': 0.57187593, 'auroc': 0.77025664, 'binary_precision': 0.14611006, 'binary_recall': 0.5923077, 'binary_specificity': 0.84863776, 'binary_f1_score': 0.23439877}
confusion matrix:
      0    1
0  5046  900
1   106  154
early stop counter: 4
val acc:0.7728922367095947, best validation acc: 0.7742795944213867, corresponding to test acc:                         0.8585240244865417 / 0.8585240244865417
after epoch: 7,now: 2024-08-04 21:21:49.465221,epoch time: 0:10:10.190912,used: 1:11:16.041944,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8840773, 'precision': 0.8914449, 'recall': 0.88402975, 'specificity': 0.88402975, 'f1': 0.8835201, 'auroc': 0.967041, 'binary_precision': 0.83791536, 'binary_recall': 0.9525808, 'binary_specificity': 0.8154787, 'binary_f1_score': 0.8915764}
confusion matrix:
       0      1
0  23476   5312
1   1367  27461
---- Validation: 
scalar performance:
{'acc': 0.7554429, 'precision': 0.5327337, 'recall': 0.6778985, 'specificity': 0.6778985, 'f1': 0.502915, 'auroc': 0.7178453, 'binary_precision': 0.08492569, 'binary_recall': 0.5943536, 'binary_specificity': 0.7614435, 'binary_f1_score': 0.14861602}
confusion matrix:
       0     1
0  13757  4310
1    273   400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8443442, 'precision': 0.5712873, 'recall': 0.7477431, 'specificity': 0.7477431, 'f1': 0.58499503, 'auroc': 0.8095992, 'binary_precision': 0.16057692, 'binary_recall': 0.6423077, 'binary_specificity': 0.8531786, 'binary_f1_score': 0.25692308}
confusion matrix:
      0    1
0  5073  873
1    93  167
early stop counter: 5
val acc:0.7554429173469543, best validation acc: 0.7742795944213867, corresponding to test acc:                         0.8585240244865417 / 0.8585240244865417
after epoch: 8,now: 2024-08-04 21:31:52.090416,epoch time: 0:10:02.625195,used: 1:21:18.667139,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89662594, 'precision': 0.89745045, 'recall': 0.8966086, 'specificity': 0.8966086, 'f1': 0.8965693, 'auroc': 0.9657854, 'binary_precision': 0.87953806, 'binary_recall': 0.91932017, 'binary_specificity': 0.873897, 'binary_f1_score': 0.89898926}
confusion matrix:
       0      1
0  25156   3630
1   2326  26504
---- Validation: 
scalar performance:
{'acc': 0.80426896, 'precision': 0.53276575, 'recall': 0.64814544, 'specificity': 0.64814544, 'f1': 0.51957494, 'auroc': 0.7004622, 'binary_precision': 0.088711895, 'binary_recall': 0.47994056, 'binary_specificity': 0.8163503, 'binary_f1_score': 0.14974502}
confusion matrix:
       0     1
0  14749  3318
1    350   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8649694, 'precision': 0.57694507, 'recall': 0.7345998, 'specificity': 0.7345998, 'f1': 0.59718895, 'auroc': 0.7986351, 'binary_precision': 0.1738149, 'binary_recall': 0.5923077, 'binary_specificity': 0.87689203, 'binary_f1_score': 0.26876092}
confusion matrix:
      0    1
0  5214  732
1   106  154
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 21:41:52.916694,epoch time: 0:10:00.826278,used: 1:31:19.493417,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8932935, 'precision': 0.89691603, 'recall': 0.89325714, 'specificity': 0.89325714, 'f1': 0.89304304, 'auroc': 0.9682153, 'binary_precision': 0.85918796, 'binary_recall': 0.9409643, 'binary_specificity': 0.84554994, 'binary_f1_score': 0.89821863}
confusion matrix:
       0      1
0  24340   4446
1   1702  27128
---- Validation: 
scalar performance:
{'acc': 0.7564034, 'precision': 0.5255577, 'recall': 0.6361959, 'specificity': 0.6361959, 'f1': 0.49417698, 'auroc': 0.6921816, 'binary_precision': 0.07455181, 'binary_recall': 0.50668645, 'binary_specificity': 0.7657054, 'binary_f1_score': 0.12997903}
confusion matrix:
       0     1
0  13834  4233
1    332   341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83048666, 'precision': 0.5641864, 'recall': 0.73683345, 'specificity': 0.73683345, 'f1': 0.57170403, 'auroc': 0.81497836, 'binary_precision': 0.14705883, 'binary_recall': 0.63461536, 'binary_specificity': 0.8390515, 'binary_f1_score': 0.23878437}
confusion matrix:
      0    1
0  4989  957
1    95  165
early stop counter: 1
val acc:0.756403386592865, best validation acc: 0.8042689561843872, corresponding to test acc:                         0.8649693727493286 / 0.8649693727493286
after epoch: 10,now: 2024-08-04 21:52:09.990692,epoch time: 0:10:17.073998,used: 1:41:36.567415,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.89896905, 'precision': 0.8996116, 'recall': 0.8989538, 'specificity': 0.8989538, 'f1': 0.89892584, 'auroc': 0.9660125, 'binary_precision': 0.88377756, 'binary_recall': 0.9189386, 'binary_specificity': 0.87896895, 'binary_f1_score': 0.90101516}
confusion matrix:
       0      1
0  25302   3484
1   2337  26493
---- Validation: 
scalar performance:
{'acc': 0.78996795, 'precision': 0.5212846, 'recall': 0.59924304, 'specificity': 0.59924304, 'f1': 0.49972612, 'auroc': 0.6694062, 'binary_precision': 0.06986554, 'binary_recall': 0.39375928, 'binary_specificity': 0.80472684, 'binary_f1_score': 0.11867443}
confusion matrix:
       0     1
0  14539  3528
1    408   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8551402, 'precision': 0.57033354, 'recall': 0.7257924, 'specificity': 0.7257924, 'f1': 0.5862491, 'auroc': 0.7993227, 'binary_precision': 0.1611877, 'binary_recall': 0.5846154, 'binary_specificity': 0.8669694, 'binary_f1_score': 0.25270158}
confusion matrix:
      0    1
0  5155  791
1   108  152
early stop counter: 2
val acc:0.789967954158783, best validation acc: 0.8042689561843872, corresponding to test acc:                         0.8649693727493286 / 0.8649693727493286
after epoch: 11,now: 2024-08-04 22:02:32.392102,epoch time: 0:10:22.401410,used: 1:51:58.968825,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.90563387, 'precision': 0.9056356, 'recall': 0.9056347, 'specificity': 0.9056347, 'f1': 0.90563387, 'auroc': 0.9687928, 'binary_precision': 0.90667593, 'binary_recall': 0.9045059, 'binary_specificity': 0.9067635, 'binary_f1_score': 0.90558964}
confusion matrix:
       0      1
0  26103   2684
1   2753  26076
---- Validation: 
scalar performance:
{'acc': 0.8256137, 'precision': 0.5358946, 'recall': 0.64705575, 'specificity': 0.64705575, 'f1': 0.53023505, 'auroc': 0.71309114, 'binary_precision': 0.09541628, 'binary_recall': 0.45468053, 'binary_specificity': 0.839431, 'binary_f1_score': 0.15773195}
confusion matrix:
       0     1
0  15166  2901
1    367   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8788269, 'precision': 0.58878934, 'recall': 0.7510265, 'specificity': 0.7510265, 'f1': 0.61544704, 'auroc': 0.8188936, 'binary_precision': 0.19629629, 'binary_recall': 0.61153847, 'binary_specificity': 0.8905146, 'binary_f1_score': 0.29719627}
confusion matrix:
      0    1
0  5295  651
1   101  159
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-04 22:12:36.875976,epoch time: 0:10:04.483874,used: 2:02:03.452699,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.901208, 'precision': 0.90331775, 'recall': 0.90118295, 'specificity': 0.90118295, 'f1': 0.9010745, 'auroc': 0.97076166, 'binary_precision': 0.87432045, 'binary_recall': 0.9372832, 'binary_specificity': 0.8650827, 'binary_f1_score': 0.90470773}
confusion matrix:
       0      1
0  24904   3884
1   1808  27020
---- Validation: 
scalar performance:
{'acc': 0.78068304, 'precision': 0.53070855, 'recall': 0.65236425, 'specificity': 0.65236425, 'f1': 0.50916696, 'auroc': 0.7223271, 'binary_precision': 0.08379753, 'binary_recall': 0.51411587, 'binary_specificity': 0.7906127, 'binary_f1_score': 0.14410663}
confusion matrix:
       0     1
0  14284  3783
1    327   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8514341, 'precision': 0.5723298, 'recall': 0.7404092, 'specificity': 0.7404092, 'f1': 0.5881425, 'auroc': 0.8226371, 'binary_precision': 0.16361788, 'binary_recall': 0.61923075, 'binary_specificity': 0.86158764, 'binary_f1_score': 0.25884244}
confusion matrix:
      0    1
0  5123  823
1    99  161
early stop counter: 1
val acc:0.7806830406188965, best validation acc: 0.8256136775016785, corresponding to test acc:                         0.878826916217804 / 0.878826916217804
after epoch: 13,now: 2024-08-04 22:22:41.506738,epoch time: 0:10:04.630762,used: 2:12:08.083461,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.91242015, 'precision': 0.9127679, 'recall': 0.91240966, 'specificity': 0.91240966, 'f1': 0.9124002, 'auroc': 0.9732178, 'binary_precision': 0.9009677, 'binary_recall': 0.9268445, 'binary_specificity': 0.8979748, 'binary_f1_score': 0.91372293}
confusion matrix:
       0      1
0  25850   2937
1   2109  26720
---- Validation: 
scalar performance:
{'acc': 0.818143, 'precision': 0.5322546, 'recall': 0.63602865, 'specificity': 0.63602865, 'f1': 0.52310395, 'auroc': 0.7087072, 'binary_precision': 0.088969044, 'binary_recall': 0.4398217, 'binary_specificity': 0.8322356, 'binary_f1_score': 0.14800002}
confusion matrix:
       0     1
0  15036  3031
1    377   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8527232, 'precision': 0.5712631, 'recall': 0.73372597, 'specificity': 0.73372597, 'f1': 0.5869882, 'auroc': 0.79974836, 'binary_precision': 0.16219008, 'binary_recall': 0.60384613, 'binary_specificity': 0.8636058, 'binary_f1_score': 0.25570032}
confusion matrix:
      0    1
0  5135  811
1   103  157
early stop counter: 2
val acc:0.8181430101394653, best validation acc: 0.8256136775016785, corresponding to test acc:                         0.878826916217804 / 0.878826916217804
after epoch: 14,now: 2024-08-04 22:32:49.191496,epoch time: 0:10:07.684758,used: 2:22:15.768219,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.90591156, 'precision': 0.9076054, 'recall': 0.9058881, 'specificity': 0.9058881, 'f1': 0.90581006, 'auroc': 0.972673, 'binary_precision': 0.88151115, 'binary_recall': 0.9380485, 'binary_specificity': 0.87372774, 'binary_f1_score': 0.90890145}
confusion matrix:
       0      1
0  25152   3635
1   1786  27043
---- Validation: 
scalar performance:
{'acc': 0.7991996, 'precision': 0.53255904, 'recall': 0.6505232, 'specificity': 0.6505232, 'f1': 0.51769316, 'auroc': 0.71747667, 'binary_precision': 0.088, 'binary_recall': 0.49034175, 'binary_specificity': 0.8107046, 'binary_f1_score': 0.14921999}
confusion matrix:
       0     1
0  14647  3420
1    343   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85868514, 'precision': 0.5758894, 'recall': 0.7423543, 'specificity': 0.7423543, 'f1': 0.5945681, 'auroc': 0.8172773, 'binary_precision': 0.17075774, 'binary_recall': 0.61538464, 'binary_specificity': 0.8693239, 'binary_f1_score': 0.26733503}
confusion matrix:
      0    1
0  5169  777
1   100  160
early stop counter: 3
val acc:0.7991995811462402, best validation acc: 0.8256136775016785, corresponding to test acc:                         0.878826916217804 / 0.878826916217804
after epoch: 15,now: 2024-08-04 22:43:02.517916,epoch time: 0:10:13.326420,used: 2:32:29.094639,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_33_seed_1_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:32:29.094639 at 2024-08-04 22:43:02.517916
persisted model performance metric: 

scalar performance:
{'acc': 0.8788269, 'precision': 0.58878934, 'recall': 0.7510265, 'specificity': 0.7510265, 'f1': 0.61544704, 'auroc': 0.8188936, 'binary_precision': 0.19629629, 'binary_recall': 0.61153847, 'binary_specificity': 0.8905146, 'binary_f1_score': 0.29719627}
confusion matrix:
      0    1
0  5295  651
1   101  159
oracle model performance metric: 

scalar performance:
{'acc': 0.8788269, 'precision': 0.58878934, 'recall': 0.7510265, 'specificity': 0.7510265, 'f1': 0.61544704, 'auroc': 0.8188936, 'binary_precision': 0.19629629, 'binary_recall': 0.61153847, 'binary_specificity': 0.8905146, 'binary_f1_score': 0.29719627}
confusion matrix:
      0    1
0  5295  651
1   101  159
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 255143 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool | 218112 KiB | 591936 KiB | 663735 GiB | 663734 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 255143 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool | 218112 KiB | 591936 KiB | 663735 GiB | 663734 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 249982 KiB | 656104 KiB | 662037 GiB | 662037 GiB |
|       from large pool | 214016 KiB | 584512 KiB | 661777 GiB | 661777 GiB |
|       from small pool |  35966 KiB |  74336 KiB |    260 GiB |    260 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 768000 KiB |    808 MiB |   1238 MiB | 499712 KiB |
|       from large pool | 692224 KiB |    734 MiB |   1140 MiB | 475136 KiB |
|       from small pool |  75776 KiB |     74 MiB |     98 MiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50008 KiB | 251573 KiB | 366800 GiB | 366800 GiB |
|       from large pool |  37888 KiB | 250176 KiB | 366511 GiB | 366511 GiB |
|       from small pool |  12120 KiB |  21751 KiB |    289 GiB |    289 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7971    |   87320 K  |   87317 K  |
|       from large pool |      36    |      76    |   31734 K  |   31734 K  |
|       from small pool |    3192    |    7933    |   55586 K  |   55582 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7971    |   87320 K  |   87317 K  |
|       from large pool |      36    |      76    |   31734 K  |   31734 K  |
|       from small pool |    3192    |    7933    |   55586 K  |   55582 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      54    |      72    |      19    |
|       from large pool |      16    |      17    |      23    |       7    |
|       from small pool |      37    |      37    |      49    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |    3617    |   45250 K  |   45250 K  |
|       from large pool |       4    |      12    |   17024 K  |   17024 K  |
|       from small pool |      45    |    3612    |   28226 K  |   28226 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 663735 GiB | 663734 GiB |
|       from small pool |      0 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 663735 GiB | 663734 GiB |
|       from small pool |      0 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 662037 GiB | 662037 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 661777 GiB | 661777 GiB |
|       from small pool |      0 KiB |  74336 KiB |    260 GiB |    260 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 305152 KiB |    808 MiB |   1238 MiB |    940 MiB |
|       from large pool | 256000 KiB |    734 MiB |   1140 MiB |    890 MiB |
|       from small pool |  49152 KiB |     74 MiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 251573 KiB | 366800 GiB | 366800 GiB |
|       from large pool |  47104 KiB | 250176 KiB | 366511 GiB | 366511 GiB |
|       from small pool |      0 KiB |  21751 KiB |    289 GiB |    289 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   87320 K  |   87320 K  |
|       from large pool |       2    |      76    |   31734 K  |   31734 K  |
|       from small pool |       0    |    7933    |   55586 K  |   55586 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   87320 K  |   87320 K  |
|       from large pool |       2    |      76    |   31734 K  |   31734 K  |
|       from small pool |       0    |    7933    |   55586 K  |   55586 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      54    |      72    |      39    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3617    |   45252 K  |   45252 K  |
|       from large pool |       2    |      12    |   17024 K  |   17024 K  |
|       from small pool |       0    |    3612    |   28227 K  |   28227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 663735 GiB | 663734 GiB |
|       from small pool |      0 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 664015 GiB | 664015 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 663735 GiB | 663734 GiB |
|       from small pool |      0 KiB |  75475 KiB |    280 GiB |    280 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 662037 GiB | 662037 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 661777 GiB | 661777 GiB |
|       from small pool |      0 KiB |  74336 KiB |    260 GiB |    260 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 305152 KiB |    808 MiB |   1238 MiB |    940 MiB |
|       from large pool | 256000 KiB |    734 MiB |   1140 MiB |    890 MiB |
|       from small pool |  49152 KiB |     74 MiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 251573 KiB | 366800 GiB | 366800 GiB |
|       from large pool |  47104 KiB | 250176 KiB | 366511 GiB | 366511 GiB |
|       from small pool |      0 KiB |  21751 KiB |    289 GiB |    289 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   87320 K  |   87320 K  |
|       from large pool |       2    |      76    |   31734 K  |   31734 K  |
|       from small pool |       0    |    7933    |   55586 K  |   55586 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   87320 K  |   87320 K  |
|       from large pool |       2    |      76    |   31734 K  |   31734 K  |
|       from small pool |       0    |    7933    |   55586 K  |   55586 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      54    |      72    |      39    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3617    |   45252 K  |   45252 K  |
|       from large pool |       2    |      12    |   17024 K  |   17024 K  |
|       from small pool |       0    |    3612    |   28227 K  |   28227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112

 Experiment start at: 2024-08-04 22:49:27.745560
before training, model accuracy: 0.054656196385622025
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.74581504, 'precision': 0.75483334, 'recall': 0.74580216, 'specificity': 0.74580216, 'f1': 0.7435395, 'auroc': 0.842401, 'binary_precision': 0.70692843, 'binary_recall': 0.8398957, 'binary_specificity': 0.65170854, 'binary_f1_score': 0.76769704}
confusion matrix:
       0      1
0  18996  10152
1   4668  24488
---- Validation: 
scalar performance:
{'acc': 0.5145155, 'precision': 0.50831044, 'recall': 0.5669238, 'specificity': 0.5669238, 'f1': 0.3733974, 'auroc': 0.59502983, 'binary_precision': 0.040488016, 'binary_recall': 0.6229236, 'binary_specificity': 0.510924, 'binary_f1_score': 0.07603407}
confusion matrix:
      0     1
0  9284  8887
1   227   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52604586, 'precision': 0.5241981, 'recall': 0.662254, 'specificity': 0.662254, 'f1': 0.39656854, 'auroc': 0.7626973, 'binary_precision': 0.06308336, 'binary_recall': 0.80991733, 'binary_specificity': 0.5145906, 'binary_f1_score': 0.11704986}
confusion matrix:
      0     1
0  3086  2911
1    46   196
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 23:00:02.321944,epoch time: 0:10:34.576384,used: 0:10:34.576384,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8109392, 'precision': 0.82831335, 'recall': 0.8109195, 'specificity': 0.8109195, 'f1': 0.80839765, 'auroc': 0.9191336, 'binary_precision': 0.75283027, 'binary_recall': 0.9259526, 'binary_specificity': 0.6958864, 'binary_f1_score': 0.8304649}
confusion matrix:
       0      1
0  20283   8864
1   2159  26998
---- Validation: 
scalar performance:
{'acc': 0.5536675, 'precision': 0.5199972, 'recall': 0.66022575, 'specificity': 0.66022575, 'f1': 0.40166867, 'auroc': 0.7124485, 'binary_precision': 0.053507864, 'binary_recall': 0.77408636, 'binary_specificity': 0.5463651, 'binary_f1_score': 0.10009666}
confusion matrix:
      0     1
0  9928  8243
1   136   466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6845648, 'precision': 0.54099977, 'recall': 0.7466946, 'specificity': 0.7466946, 'f1': 0.48613226, 'auroc': 0.8317658, 'binary_precision': 0.09292453, 'binary_recall': 0.8140496, 'binary_specificity': 0.67933965, 'binary_f1_score': 0.1668078}
confusion matrix:
      0     1
0  4074  1923
1    45   197
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 23:10:19.010407,epoch time: 0:10:16.688463,used: 0:20:51.264847,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8455337, 'precision': 0.8518486, 'recall': 0.8455223, 'specificity': 0.8455223, 'f1': 0.84483445, 'auroc': 0.9347261, 'binary_precision': 0.80475485, 'binary_recall': 0.91250813, 'binary_specificity': 0.7785364, 'binary_f1_score': 0.85525084}
confusion matrix:
       0      1
0  22692   6455
1   2551  26606
---- Validation: 
scalar performance:
{'acc': 0.6444894, 'precision': 0.5179875, 'recall': 0.6340637, 'specificity': 0.6340637, 'f1': 0.43972903, 'auroc': 0.6747821, 'binary_precision': 0.054969218, 'binary_recall': 0.6229236, 'binary_specificity': 0.6452039, 'binary_f1_score': 0.10102371}
confusion matrix:
       0     1
0  11724  6447
1    227   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.757974, 'precision': 0.54543656, 'recall': 0.7333291, 'specificity': 0.7333291, 'f1': 0.52128047, 'auroc': 0.808469, 'binary_precision': 0.10621118, 'binary_recall': 0.7066116, 'binary_specificity': 0.76004666, 'binary_f1_score': 0.18466522}
confusion matrix:
      0     1
0  4558  1439
1    71   171
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 23:20:27.533504,epoch time: 0:10:08.523097,used: 0:30:59.787944,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8538522, 'precision': 0.85848165, 'recall': 0.85384053, 'specificity': 0.85384053, 'f1': 0.853376, 'auroc': 0.9405175, 'binary_precision': 0.81779546, 'binary_recall': 0.9106592, 'binary_specificity': 0.79702187, 'binary_f1_score': 0.8617328}
confusion matrix:
       0      1
0  23230   5916
1   2605  26553
---- Validation: 
scalar performance:
{'acc': 0.7293986, 'precision': 0.52369493, 'recall': 0.6522273, 'specificity': 0.6522273, 'f1': 0.4795622, 'auroc': 0.7056945, 'binary_precision': 0.06642138, 'binary_recall': 0.5697674, 'binary_specificity': 0.73468715, 'binary_f1_score': 0.1189733}
confusion matrix:
       0     1
0  13350  4821
1    259   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8139125, 'precision': 0.55357385, 'recall': 0.7267377, 'specificity': 0.7267377, 'f1': 0.55157447, 'auroc': 0.79660183, 'binary_precision': 0.12489796, 'binary_recall': 0.6322314, 'binary_specificity': 0.82124394, 'binary_f1_score': 0.20858896}
confusion matrix:
      0     1
0  4925  1072
1    89   153
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 23:30:36.338535,epoch time: 0:10:08.805031,used: 0:41:08.592975,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8685339, 'precision': 0.8706389, 'recall': 0.8685261, 'specificity': 0.8685261, 'f1': 0.86834526, 'auroc': 0.9494511, 'binary_precision': 0.8427583, 'binary_recall': 0.9062007, 'binary_specificity': 0.83085155, 'binary_f1_score': 0.8733288}
confusion matrix:
       0      1
0  24216   4930
1   2735  26423
---- Validation: 
scalar performance:
{'acc': 0.74948066, 'precision': 0.52282006, 'recall': 0.6385095, 'specificity': 0.6385095, 'f1': 0.4857458, 'auroc': 0.69749796, 'binary_precision': 0.06621536, 'binary_recall': 0.5199336, 'binary_specificity': 0.75708544, 'binary_f1_score': 0.11747044}
confusion matrix:
       0     1
0  13757  4414
1    289   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83667254, 'precision': 0.5581352, 'recall': 0.7207323, 'specificity': 0.7207323, 'f1': 0.5645668, 'auroc': 0.7974576, 'binary_precision': 0.13521127, 'binary_recall': 0.59504133, 'binary_specificity': 0.8464232, 'binary_f1_score': 0.22035195}
confusion matrix:
      0    1
0  5076  921
1    98  144
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 23:40:47.898241,epoch time: 0:10:11.559706,used: 0:51:20.152681,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.87301046, 'precision': 0.87863815, 'recall': 0.8729979, 'specificity': 0.8729979, 'f1': 0.87253416, 'auroc': 0.9555278, 'binary_precision': 0.8325283, 'binary_recall': 0.9339461, 'binary_specificity': 0.8120497, 'binary_f1_score': 0.88032585}
confusion matrix:
       0      1
0  23668   5478
1   1926  27232
---- Validation: 
scalar performance:
{'acc': 0.7129921, 'precision': 0.5200926, 'recall': 0.6333126, 'specificity': 0.6333126, 'f1': 0.46903425, 'auroc': 0.6819233, 'binary_precision': 0.06059493, 'binary_recall': 0.5481728, 'binary_specificity': 0.71845245, 'binary_f1_score': 0.109126985}
confusion matrix:
       0     1
0  13055  5116
1    272   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8030133, 'precision': 0.55250853, 'recall': 0.73296463, 'specificity': 0.73296463, 'f1': 0.5465633, 'auroc': 0.80682075, 'binary_precision': 0.121839084, 'binary_recall': 0.6570248, 'binary_specificity': 0.80890447, 'binary_f1_score': 0.20555915}
confusion matrix:
      0     1
0  4851  1146
1    83   159
early stop counter: 1
val acc:0.7129920721054077, best validation acc: 0.749480664730072, corresponding to test acc:                         0.8366725444793701 / 0.8366725444793701
after epoch: 6,now: 2024-08-04 23:51:05.060103,epoch time: 0:10:17.161862,used: 1:01:37.314543,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8862685, 'precision': 0.89091176, 'recall': 0.8862573, 'specificity': 0.8862573, 'f1': 0.8859277, 'auroc': 0.96394515, 'binary_precision': 0.8483593, 'binary_recall': 0.94073665, 'binary_specificity': 0.83177793, 'binary_f1_score': 0.8921631}
confusion matrix:
       0      1
0  24243   4903
1   1728  27430
---- Validation: 
scalar performance:
{'acc': 0.73845416, 'precision': 0.5262735, 'recall': 0.6657386, 'specificity': 0.6657386, 'f1': 0.48612, 'auroc': 0.7161256, 'binary_precision': 0.070574164, 'binary_recall': 0.5880399, 'binary_specificity': 0.74343735, 'binary_f1_score': 0.1260235}
confusion matrix:
       0     1
0  13509  4662
1    248   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80461615, 'precision': 0.5553155, 'recall': 0.7456948, 'specificity': 0.7456948, 'f1': 0.55075127, 'auroc': 0.8115318, 'binary_precision': 0.12624331, 'binary_recall': 0.6818182, 'binary_specificity': 0.80957144, 'binary_f1_score': 0.21304068}
confusion matrix:
      0     1
0  4855  1142
1    77   165
early stop counter: 2
val acc:0.7384541630744934, best validation acc: 0.749480664730072, corresponding to test acc:                         0.8366725444793701 / 0.8366725444793701
after epoch: 7,now: 2024-08-05 00:01:17.421493,epoch time: 0:10:12.361390,used: 1:11:49.675933,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89487857, 'precision': 0.89607346, 'recall': 0.8948729, 'specificity': 0.8948729, 'f1': 0.8947982, 'auroc': 0.96442896, 'binary_precision': 0.87437004, 'binary_recall': 0.92231977, 'binary_specificity': 0.86742604, 'binary_f1_score': 0.8977051}
confusion matrix:
       0      1
0  25282   3864
1   2265  26893
---- Validation: 
scalar performance:
{'acc': 0.7672189, 'precision': 0.5217357, 'recall': 0.62438405, 'specificity': 0.62438405, 'f1': 0.4905051, 'auroc': 0.6796739, 'binary_precision': 0.06549816, 'binary_recall': 0.4717608, 'binary_specificity': 0.77700734, 'binary_f1_score': 0.11502633}
confusion matrix:
       0     1
0  14119  4052
1    318   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82593364, 'precision': 0.5514489, 'recall': 0.7032497, 'specificity': 0.7032497, 'f1': 0.55247307, 'auroc': 0.777256, 'binary_precision': 0.12321428, 'binary_recall': 0.57024795, 'binary_specificity': 0.83625144, 'binary_f1_score': 0.20264317}
confusion matrix:
      0    1
0  5015  982
1   104  138
better model found
persisted
after epoch: 8,now: 2024-08-05 00:11:34.572586,epoch time: 0:10:17.151093,used: 1:22:06.827026,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8999897, 'precision': 0.89998984, 'recall': 0.8999898, 'specificity': 0.8999898, 'f1': 0.8999897, 'auroc': 0.9666351, 'binary_precision': 0.90024024, 'binary_recall': 0.89971536, 'binary_specificity': 0.9002642, 'binary_f1_score': 0.8999777}
confusion matrix:
       0      1
0  26240   2907
1   2924  26233
---- Validation: 
scalar performance:
{'acc': 0.8116444, 'precision': 0.5281625, 'recall': 0.6368931, 'specificity': 0.6368931, 'f1': 0.5136275, 'auroc': 0.7078624, 'binary_precision': 0.07796317, 'binary_recall': 0.4501661, 'binary_specificity': 0.8236201, 'binary_f1_score': 0.13290828}
confusion matrix:
       0     1
0  14966  3205
1    331   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87337714, 'precision': 0.5770554, 'recall': 0.7398251, 'specificity': 0.7398251, 'f1': 0.59893155, 'auroc': 0.8122312, 'binary_precision': 0.17224881, 'binary_recall': 0.59504133, 'binary_specificity': 0.884609, 'binary_f1_score': 0.26716143}
confusion matrix:
      0    1
0  5305  692
1    98  144
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-05 00:21:45.811341,epoch time: 0:10:11.238755,used: 1:32:18.065781,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9061814, 'precision': 0.9074873, 'recall': 0.9061756, 'specificity': 0.9061756, 'f1': 0.9061053, 'auroc': 0.9713131, 'binary_precision': 0.8844706, 'binary_recall': 0.9344605, 'binary_specificity': 0.87789065, 'binary_f1_score': 0.9087786}
confusion matrix:
       0      1
0  25587   3559
1   1911  27247
---- Validation: 
scalar performance:
{'acc': 0.7651947, 'precision': 0.52340287, 'recall': 0.63538414, 'specificity': 0.63538414, 'f1': 0.4919963, 'auroc': 0.6922187, 'binary_precision': 0.06789283, 'binary_recall': 0.49667773, 'binary_specificity': 0.7740906, 'binary_f1_score': 0.11945666}
confusion matrix:
       0     1
0  14066  4105
1    303   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82593364, 'precision': 0.55860317, 'recall': 0.7369563, 'specificity': 0.7369563, 'f1': 0.5620331, 'auroc': 0.82021654, 'binary_precision': 0.13431543, 'binary_recall': 0.6404959, 'binary_specificity': 0.8334167, 'binary_f1_score': 0.22206303}
confusion matrix:
      0    1
0  4998  999
1    87  155
early stop counter: 1
val acc:0.7651947140693665, best validation acc: 0.8116443753242493, corresponding to test acc:                         0.8733771443367004 / 0.8733771443367004
after epoch: 10,now: 2024-08-05 00:31:53.669687,epoch time: 0:10:07.858346,used: 1:42:25.924127,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91101813, 'precision': 0.91102624, 'recall': 0.9110178, 'specificity': 0.9110178, 'f1': 0.91101766, 'auroc': 0.9719298, 'binary_precision': 0.9092368, 'binary_recall': 0.9132284, 'binary_specificity': 0.9088071, 'binary_f1_score': 0.91122824}
confusion matrix:
       0      1
0  26489   2658
1   2530  26627
---- Validation: 
scalar performance:
{'acc': 0.82336336, 'precision': 0.5306318, 'recall': 0.6413406, 'specificity': 0.6413406, 'f1': 0.5205871, 'auroc': 0.7123194, 'binary_precision': 0.08271833, 'binary_recall': 0.44684386, 'binary_specificity': 0.8358373, 'binary_f1_score': 0.13959524}
confusion matrix:
       0     1
0  15188  2983
1    333   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87225515, 'precision': 0.5704385, 'recall': 0.7154486, 'specificity': 0.7154486, 'f1': 0.5895068, 'auroc': 0.8009528, 'binary_precision': 0.16117217, 'binary_recall': 0.54545456, 'binary_specificity': 0.88544273, 'binary_f1_score': 0.24882187}
confusion matrix:
      0    1
0  5310  687
1   110  132
better model found
persisted
after epoch: 11,now: 2024-08-05 00:42:02.549861,epoch time: 0:10:08.880174,used: 1:52:34.804301,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9155632, 'precision': 0.91609013, 'recall': 0.9155596, 'specificity': 0.9155596, 'f1': 0.91553605, 'auroc': 0.9749944, 'binary_precision': 0.90133476, 'binary_recall': 0.93332875, 'binary_specificity': 0.89779043, 'binary_f1_score': 0.9170528}
confusion matrix:
       0      1
0  26167   2979
1   1944  27214
---- Validation: 
scalar performance:
{'acc': 0.81297606, 'precision': 0.5380144, 'recall': 0.68897605, 'specificity': 0.68897605, 'f1': 0.52750933, 'auroc': 0.75005937, 'binary_precision': 0.09360156, 'binary_recall': 0.5564784, 'binary_specificity': 0.8214738, 'binary_f1_score': 0.16024874}
confusion matrix:
       0     1
0  14927  3244
1    267   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87401825, 'precision': 0.5812754, 'recall': 0.75602055, 'specificity': 0.75602055, 'f1': 0.6049395, 'auroc': 0.830132, 'binary_precision': 0.17924528, 'binary_recall': 0.6280992, 'binary_specificity': 0.88394195, 'binary_f1_score': 0.27889907}
confusion matrix:
      0    1
0  5301  696
1    90  152
new oracle model saved
early stop counter: 1
val acc:0.812976062297821, best validation acc: 0.8233633637428284, corresponding to test acc:                         0.8722551465034485 / 0.8740182518959045
after epoch: 12,now: 2024-08-05 00:52:12.220613,epoch time: 0:10:09.670752,used: 2:02:44.475053,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9157691, 'precision': 0.9165283, 'recall': 0.9157661, 'specificity': 0.9157661, 'f1': 0.91573036, 'auroc': 0.9756148, 'binary_precision': 0.8987796, 'binary_recall': 0.937097, 'binary_specificity': 0.8944353, 'binary_f1_score': 0.91753846}
confusion matrix:
       0      1
0  26071   3077
1   1834  27322
---- Validation: 
scalar performance:
{'acc': 0.803814, 'precision': 0.5321937, 'recall': 0.66416705, 'specificity': 0.66416705, 'f1': 0.51664764, 'auroc': 0.73186696, 'binary_precision': 0.08376115, 'binary_recall': 0.51495016, 'binary_specificity': 0.81338394, 'binary_f1_score': 0.14408553}
confusion matrix:
       0     1
0  14780  3391
1    292   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86680555, 'precision': 0.5748373, 'recall': 0.74433774, 'specificity': 0.74433774, 'f1': 0.5947174, 'auroc': 0.83410716, 'binary_precision': 0.16723163, 'binary_recall': 0.61157024, 'binary_specificity': 0.87710524, 'binary_f1_score': 0.26264417}
confusion matrix:
      0    1
0  5260  737
1    94  148
early stop counter: 2
val acc:0.8038139939308167, best validation acc: 0.8233633637428284, corresponding to test acc:                         0.8722551465034485 / 0.8740182518959045
after epoch: 13,now: 2024-08-05 01:02:25.990277,epoch time: 0:10:13.769664,used: 2:12:58.244717,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9247736, 'precision': 0.9247738, 'recall': 0.92477363, 'specificity': 0.92477363, 'f1': 0.92477363, 'auroc': 0.9785137, 'binary_precision': 0.9251339, 'binary_recall': 0.9243723, 'binary_specificity': 0.92517495, 'binary_f1_score': 0.924753}
confusion matrix:
       0      1
0  26967   2181
1   2205  26951
---- Validation: 
scalar performance:
{'acc': 0.84845257, 'precision': 0.53847647, 'recall': 0.6567099, 'specificity': 0.6567099, 'f1': 0.53861374, 'auroc': 0.73947084, 'binary_precision': 0.09759598, 'binary_recall': 0.45182723, 'binary_specificity': 0.86159265, 'binary_f1_score': 0.16051933}
confusion matrix:
       0     1
0  15656  2515
1    330   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.906235, 'precision': 0.60432816, 'recall': 0.7529515, 'specificity': 0.7529515, 'f1': 0.63821024, 'auroc': 0.8318602, 'binary_precision': 0.22647528, 'binary_recall': 0.58677685, 'binary_specificity': 0.9191262, 'binary_f1_score': 0.32681242}
confusion matrix:
      0    1
0  5512  485
1   100  142
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-05 01:12:48.809110,epoch time: 0:10:22.818833,used: 2:23:21.063550,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9181703, 'precision': 0.9182353, 'recall': 0.918169, 'specificity': 0.918169, 'f1': 0.9181669, 'auroc': 0.9761149, 'binary_precision': 0.91307294, 'binary_recall': 0.9243775, 'binary_specificity': 0.9119605, 'binary_f1_score': 0.9186904}
confusion matrix:
       0      1
0  26580   2566
1   2205  26953
---- Validation: 
scalar performance:
{'acc': 0.8464816, 'precision': 0.53217494, 'recall': 0.6299943, 'specificity': 0.6299943, 'f1': 0.52923185, 'auroc': 0.7346767, 'binary_precision': 0.08695652, 'binary_recall': 0.3986711, 'binary_specificity': 0.86131746, 'binary_f1_score': 0.14277215}
confusion matrix:
       0     1
0  15651  2520
1    362   240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89629745, 'precision': 0.58985245, 'recall': 0.73192036, 'specificity': 0.73192036, 'f1': 0.6184709, 'auroc': 0.8163166, 'binary_precision': 0.19910847, 'binary_recall': 0.553719, 'binary_specificity': 0.91012174, 'binary_f1_score': 0.29289615}
confusion matrix:
      0    1
0  5458  539
1   108  134
early stop counter: 1
val acc:0.8464816212654114, best validation acc: 0.8484525680541992, corresponding to test acc:                         0.9062349796295166 / 0.9062349796295166
after epoch: 15,now: 2024-08-05 01:23:10.226952,epoch time: 0:10:21.417842,used: 2:33:42.481392,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_49_27_seed_2_24067112
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:42.481392 at 2024-08-05 01:23:10.226952
persisted model performance metric: 

scalar performance:
{'acc': 0.906235, 'precision': 0.60432816, 'recall': 0.7529515, 'specificity': 0.7529515, 'f1': 0.63821024, 'auroc': 0.8318602, 'binary_precision': 0.22647528, 'binary_recall': 0.58677685, 'binary_specificity': 0.9191262, 'binary_f1_score': 0.32681242}
confusion matrix:
      0    1
0  5512  485
1   100  142
oracle model performance metric: 

scalar performance:
{'acc': 0.906235, 'precision': 0.60432816, 'recall': 0.7529515, 'specificity': 0.7529515, 'f1': 0.63821024, 'auroc': 0.8318602, 'binary_precision': 0.22647528, 'binary_recall': 0.58677685, 'binary_specificity': 0.9191262, 'binary_f1_score': 0.32681242}
confusion matrix:
      0    1
0  5512  485
1   100  142
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 255149 KiB | 664665 KiB |    983 TiB |    983 TiB |
|       from large pool | 218112 KiB | 591936 KiB |    983 TiB |    983 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 255149 KiB | 664665 KiB |    983 TiB |    983 TiB |
|       from large pool | 218112 KiB | 591936 KiB |    983 TiB |    983 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 249983 KiB | 656104 KiB |    980 TiB |    980 TiB |
|       from large pool | 214016 KiB | 584512 KiB |    979 TiB |    979 TiB |
|       from small pool |  35967 KiB |  74336 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 768000 KiB |    808 MiB |   1690 MiB |    940 MiB |
|       from large pool | 692224 KiB |    734 MiB |   1566 MiB |    890 MiB |
|       from small pool |  75776 KiB |     74 MiB |    124 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50002 KiB | 255687 KiB | 544542 GiB | 544542 GiB |
|       from large pool |  37888 KiB | 254684 KiB | 544107 GiB | 544107 GiB |
|       from small pool |  12114 KiB |  21751 KiB |    435 GiB |    435 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    8057    |  132116 K  |  132113 K  |
|       from large pool |      36    |      76    |   48104 K  |   48104 K  |
|       from small pool |    3204    |    8019    |   84012 K  |   84009 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    8057    |  132116 K  |  132113 K  |
|       from large pool |      36    |      76    |   48104 K  |   48104 K  |
|       from small pool |    3204    |    8019    |   84012 K  |   84009 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      54    |      92    |      39    |
|       from large pool |      16    |      17    |      30    |      14    |
|       from small pool |      37    |      37    |      62    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      50    |    3660    |   69173 K  |   69173 K  |
|       from large pool |       4    |      12    |   26506 K  |   26506 K  |
|       from small pool |      46    |    3655    |   42667 K  |   42667 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB |    983 TiB |    983 TiB |
|       from large pool |  65536 KiB | 591936 KiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB |    983 TiB |    983 TiB |
|       from large pool |  65536 KiB | 591936 KiB |    983 TiB |    983 TiB |
|       from small pool |      0 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB |    980 TiB |    980 TiB |
|       from large pool |  65536 KiB | 584512 KiB |    979 TiB |    979 TiB |
|       from small pool |      0 KiB |  74336 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 305152 KiB |    808 MiB |   1690 MiB |   1392 MiB |
|       from large pool | 256000 KiB |    734 MiB |   1566 MiB |   1316 MiB |
|       from small pool |  49152 KiB |     74 MiB |    124 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 255687 KiB | 544543 GiB | 544543 GiB |
|       from large pool |  47104 KiB | 254684 KiB | 544107 GiB | 544107 GiB |
|       from small pool |      0 KiB |  21751 KiB |    435 GiB |    435 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8057    |  132116 K  |  132116 K  |
|       from large pool |       2    |      76    |   48104 K  |   48104 K  |
|       from small pool |       0    |    8019    |   84012 K  |   84012 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8057    |  132116 K  |  132116 K  |
|       from large pool |       2    |      76    |   48104 K  |   48104 K  |
|       from small pool |       0    |    8019    |   84012 K  |   84012 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      54    |      92    |      59    |
|       from large pool |       9    |      17    |      30    |      21    |
|       from small pool |      24    |      37    |      62    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3660    |   69174 K  |   69174 K  |
|       from large pool |       2    |      12    |   26506 K  |   26506 K  |
|       from small pool |       0    |    3655    |   42668 K  |   42668 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 01:23:56 2024]
Finished job 0.
1 of 1 steps (100%) done
