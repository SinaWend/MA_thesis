Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 17:16:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110

 Experiment start at: 2024-08-04 17:30:20.536345
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.75188285, 'precision': 0.76264375, 'recall': 0.75178736, 'specificity': 0.75178736, 'f1': 0.7492677, 'auroc': 0.83951426, 'binary_precision': 0.7097157, 'binary_recall': 0.8532065, 'binary_specificity': 0.6503682, 'binary_f1_score': 0.7748742}
confusion matrix:
       0      1
0  18635  10018
1   4214  24493
---- Validation: 
scalar performance:
{'acc': 0.5052682, 'precision': 0.51240957, 'recall': 0.59385914, 'specificity': 0.59385914, 'f1': 0.37385678, 'auroc': 0.620108, 'binary_precision': 0.04643606, 'binary_recall': 0.688958, 'binary_specificity': 0.49876025, 'binary_f1_score': 0.08700776}
confusion matrix:
      0     1
0  9052  9097
1   200   443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.43879834, 'precision': 0.5245939, 'recall': 0.64855224, 'specificity': 0.64855224, 'f1': 0.35220638, 'auroc': 0.7697166, 'binary_precision': 0.06174171, 'binary_recall': 0.8773946, 'binary_specificity': 0.41970986, 'binary_f1_score': 0.115365244}
confusion matrix:
      0     1
0  2517  3480
1    32   229
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 17:48:29.263269,epoch time: 0:18:08.726924,used: 0:18:08.726924,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.81703275, 'precision': 0.82516766, 'recall': 0.81696934, 'specificity': 0.81696934, 'f1': 0.81586033, 'auroc': 0.90368533, 'binary_precision': 0.77393633, 'binary_recall': 0.89610845, 'binary_specificity': 0.7378302, 'binary_f1_score': 0.8305536}
confusion matrix:
       0      1
0  21144   7513
1   2982  25721
---- Validation: 
scalar performance:
{'acc': 0.6332482, 'precision': 0.5152183, 'recall': 0.6076124, 'specificity': 0.6076124, 'f1': 0.43376097, 'auroc': 0.6196548, 'binary_precision': 0.0533238, 'binary_recall': 0.5800933, 'binary_specificity': 0.6351314, 'binary_f1_score': 0.09766955}
confusion matrix:
       0     1
0  11527  6622
1    270   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63422817, 'precision': 0.52389514, 'recall': 0.6405799, 'specificity': 0.6405799, 'f1': 0.44859728, 'auroc': 0.7035861, 'binary_precision': 0.071428575, 'binary_recall': 0.6475096, 'binary_specificity': 0.6336502, 'binary_f1_score': 0.12866388}
confusion matrix:
      0     1
0  3800  2197
1    92   169
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 18:05:49.339566,epoch time: 0:17:20.076297,used: 0:35:28.803221,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84517086, 'precision': 0.8579515, 'recall': 0.84510165, 'specificity': 0.84510165, 'f1': 0.84375775, 'auroc': 0.941625, 'binary_precision': 0.7904966, 'binary_recall': 0.93958396, 'binary_specificity': 0.75061935, 'binary_f1_score': 0.85861653}
confusion matrix:
       0      1
0  21512   7147
1   1734  26967
---- Validation: 
scalar performance:
{'acc': 0.62734145, 'precision': 0.51748765, 'recall': 0.6248058, 'specificity': 0.6248058, 'f1': 0.4336874, 'auroc': 0.64630973, 'binary_precision': 0.05586592, 'binary_recall': 0.62208396, 'binary_specificity': 0.6275277, 'binary_f1_score': 0.10252466}
confusion matrix:
       0     1
0  11389  6760
1    243   400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6565996, 'precision': 0.53298986, 'recall': 0.6907314, 'specificity': 0.6907314, 'f1': 0.46753865, 'auroc': 0.7767345, 'binary_precision': 0.083774254, 'binary_recall': 0.72796935, 'binary_specificity': 0.6534934, 'binary_f1_score': 0.15025702}
confusion matrix:
      0     1
0  3919  2078
1    71   190
new oracle model saved
early stop counter: 1
val acc:0.6273414492607117, best validation acc: 0.6332482099533081, corresponding to test acc:                         0.6342281699180603 / 0.6565995812416077
after epoch: 3,now: 2024-08-04 18:22:35.586957,epoch time: 0:16:46.247391,used: 0:52:15.050612,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.86558574, 'precision': 0.869161, 'recall': 0.8655515, 'specificity': 0.8655515, 'f1': 0.8652517, 'auroc': 0.9449272, 'binary_precision': 0.8330054, 'binary_recall': 0.91473866, 'binary_specificity': 0.8163643, 'binary_f1_score': 0.87196094}
confusion matrix:
       0      1
0  23397   5263
1   2447  26253
---- Validation: 
scalar performance:
{'acc': 0.6857705, 'precision': 0.5211433, 'recall': 0.6393043, 'specificity': 0.6393043, 'f1': 0.461396, 'auroc': 0.647027, 'binary_precision': 0.06295681, 'binary_recall': 0.58942455, 'binary_specificity': 0.68918395, 'binary_f1_score': 0.11376257}
confusion matrix:
       0     1
0  12508  5641
1    264   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7428891, 'precision': 0.53765124, 'recall': 0.68444854, 'specificity': 0.68444854, 'f1': 0.50778943, 'auroc': 0.75525373, 'binary_precision': 0.09688995, 'binary_recall': 0.62068963, 'binary_specificity': 0.74820745, 'binary_f1_score': 0.1676151}
confusion matrix:
      0     1
0  4487  1510
1    99   162
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 18:39:25.343114,epoch time: 0:16:49.756157,used: 1:09:04.806769,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8664226, 'precision': 0.87101984, 'recall': 0.8663838, 'specificity': 0.8663838, 'f1': 0.86599874, 'auroc': 0.9466796, 'binary_precision': 0.829894, 'binary_recall': 0.9220209, 'binary_specificity': 0.81074667, 'binary_f1_score': 0.8735351}
confusion matrix:
       0      1
0  23236   5424
1   2238  26462
---- Validation: 
scalar performance:
{'acc': 0.74079394, 'precision': 0.52482283, 'recall': 0.64528906, 'specificity': 0.64528906, 'f1': 0.48659465, 'auroc': 0.6727731, 'binary_precision': 0.07084856, 'binary_recall': 0.5427683, 'binary_specificity': 0.74780977, 'binary_f1_score': 0.12533669}
confusion matrix:
       0     1
0  13572  4577
1    294   349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7994567, 'precision': 0.54873407, 'recall': 0.70113695, 'specificity': 0.70113695, 'f1': 0.54174083, 'auroc': 0.7679199, 'binary_precision': 0.11886503, 'binary_recall': 0.59386975, 'binary_specificity': 0.8084042, 'binary_f1_score': 0.19808307}
confusion matrix:
      0     1
0  4848  1149
1   106   155
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 18:56:13.373370,epoch time: 0:16:48.030256,used: 1:25:52.837025,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8761332, 'precision': 0.8783044, 'recall': 0.8761028, 'specificity': 0.8761028, 'f1': 0.8759489, 'auroc': 0.9537662, 'binary_precision': 0.8498445, 'binary_recall': 0.9139463, 'binary_specificity': 0.8382594, 'binary_f1_score': 0.88073057}
confusion matrix:
       0      1
0  24022   4635
1   2470  26233
---- Validation: 
scalar performance:
{'acc': 0.7665496, 'precision': 0.52528733, 'recall': 0.6368715, 'specificity': 0.6368715, 'f1': 0.4962821, 'auroc': 0.66288257, 'binary_precision': 0.0729927, 'binary_recall': 0.4976672, 'binary_specificity': 0.77607584, 'binary_f1_score': 0.12731251}
confusion matrix:
       0     1
0  14085  4064
1    323   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8100032, 'precision': 0.55004114, 'recall': 0.69747806, 'specificity': 0.69747806, 'f1': 0.54682565, 'auroc': 0.7569736, 'binary_precision': 0.12214984, 'binary_recall': 0.57471263, 'binary_specificity': 0.8202435, 'binary_f1_score': 0.2014775}
confusion matrix:
      0     1
0  4919  1078
1   111   150
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-04 19:13:12.089639,epoch time: 0:16:58.716269,used: 1:42:51.553294,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8793584, 'precision': 0.88357013, 'recall': 0.8793201, 'specificity': 0.8793201, 'f1': 0.8790186, 'auroc': 0.9574615, 'binary_precision': 0.84355974, 'binary_recall': 0.93167484, 'binary_specificity': 0.82696533, 'binary_f1_score': 0.88543046}
confusion matrix:
       0      1
0  23700   4959
1   1961  26740
---- Validation: 
scalar performance:
{'acc': 0.74675393, 'precision': 0.5223854, 'recall': 0.6281231, 'specificity': 0.6281231, 'f1': 0.48565537, 'auroc': 0.66111076, 'binary_precision': 0.06764706, 'binary_recall': 0.5007776, 'binary_specificity': 0.7554686, 'binary_f1_score': 0.11919305}
confusion matrix:
       0     1
0  13711  4438
1    321   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8037712, 'precision': 0.5512227, 'recall': 0.7088851, 'specificity': 0.7088851, 'f1': 0.546371, 'auroc': 0.78248, 'binary_precision': 0.12314887, 'binary_recall': 0.60536397, 'binary_specificity': 0.8124062, 'binary_f1_score': 0.20466322}
confusion matrix:
      0     1
0  4872  1125
1   103   158
early stop counter: 1
val acc:0.7467539310455322, best validation acc: 0.7665495872497559, corresponding to test acc:                         0.8100032210350037 / 0.8100032210350037
after epoch: 7,now: 2024-08-04 19:30:12.310143,epoch time: 0:17:00.220504,used: 1:59:51.773798,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89414227, 'precision': 0.8956214, 'recall': 0.8941199, 'specificity': 0.8941199, 'f1': 0.89403933, 'auroc': 0.96345353, 'binary_precision': 0.87161297, 'binary_recall': 0.9246368, 'binary_specificity': 0.86360306, 'binary_f1_score': 0.89734226}
confusion matrix:
       0      1
0  24750   3909
1   2163  26538
---- Validation: 
scalar performance:
{'acc': 0.7605896, 'precision': 0.5258302, 'recall': 0.6427866, 'specificity': 0.6427866, 'f1': 0.4949197, 'auroc': 0.66262734, 'binary_precision': 0.073451325, 'binary_recall': 0.5163297, 'binary_specificity': 0.7692435, 'binary_f1_score': 0.12860739}
confusion matrix:
       0     1
0  13961  4188
1    311   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032918, 'precision': 0.54990005, 'recall': 0.703138, 'specificity': 0.703138, 'f1': 0.5445021, 'auroc': 0.7754222, 'binary_precision': 0.12109375, 'binary_recall': 0.59386975, 'binary_specificity': 0.8124062, 'binary_f1_score': 0.20116808}
confusion matrix:
      0     1
0  4872  1125
1   106   155
early stop counter: 2
val acc:0.760589599609375, best validation acc: 0.7665495872497559, corresponding to test acc:                         0.8100032210350037 / 0.8100032210350037
after epoch: 8,now: 2024-08-04 19:47:01.571079,epoch time: 0:16:49.260936,used: 2:16:41.034734,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8973501, 'precision': 0.89803016, 'recall': 0.89733136, 'specificity': 0.89733136, 'f1': 0.897303, 'auroc': 0.96464753, 'binary_precision': 0.8818017, 'binary_recall': 0.91792655, 'binary_specificity': 0.8767362, 'binary_f1_score': 0.8995016}
confusion matrix:
       0      1
0  25122   3532
1   2356  26350
---- Validation: 
scalar performance:
{'acc': 0.79044276, 'precision': 0.5260117, 'recall': 0.6289898, 'specificity': 0.6289898, 'f1': 0.5052073, 'auroc': 0.6615385, 'binary_precision': 0.075496, 'binary_recall': 0.45567653, 'binary_specificity': 0.80230314, 'binary_f1_score': 0.12953138}
confusion matrix:
       0     1
0  14561  3588
1    350   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82917863, 'precision': 0.55900896, 'recall': 0.71664476, 'specificity': 0.71664476, 'f1': 0.5644071, 'auroc': 0.7778915, 'binary_precision': 0.13864043, 'binary_recall': 0.59386975, 'binary_specificity': 0.8394197, 'binary_f1_score': 0.22480059}
confusion matrix:
      0    1
0  5034  963
1   106  155
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 20:03:55.905633,epoch time: 0:16:54.334554,used: 2:33:35.369288,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9001569, 'precision': 0.9033539, 'recall': 0.9001228, 'specificity': 0.9001228, 'f1': 0.8999531, 'auroc': 0.97013617, 'binary_precision': 0.8676353, 'binary_recall': 0.94456834, 'binary_specificity': 0.8556773, 'binary_f1_score': 0.90446883}
confusion matrix:
       0      1
0  24522   4136
1   1591  27111
---- Validation: 
scalar performance:
{'acc': 0.7583546, 'precision': 0.53049296, 'recall': 0.6716317, 'specificity': 0.6716317, 'f1': 0.5000916, 'auroc': 0.70533323, 'binary_precision': 0.08013787, 'binary_recall': 0.5785381, 'binary_specificity': 0.7647253, 'binary_f1_score': 0.14077578}
confusion matrix:
       0     1
0  13879  4270
1    271   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79434323, 'precision': 0.55662227, 'recall': 0.74427736, 'specificity': 0.74427736, 'f1': 0.55008453, 'auroc': 0.8162057, 'binary_precision': 0.12987013, 'binary_recall': 0.6896552, 'binary_specificity': 0.7988995, 'binary_f1_score': 0.21857925}
confusion matrix:
      0     1
0  4791  1206
1    81   180
early stop counter: 1
val acc:0.7583546042442322, best validation acc: 0.7904427647590637, corresponding to test acc:                         0.8291786313056946 / 0.8291786313056946
after epoch: 10,now: 2024-08-04 20:21:11.244821,epoch time: 0:17:15.339188,used: 2:50:50.708476,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.911053, 'precision': 0.9110613, 'recall': 0.91105115, 'specificity': 0.91105115, 'f1': 0.9110522, 'auroc': 0.97099864, 'binary_precision': 0.9094158, 'binary_recall': 0.91321766, 'binary_specificity': 0.9088847, 'binary_f1_score': 0.91131276}
confusion matrix:
       0      1
0  26045   2611
1   2491  26213
---- Validation: 
scalar performance:
{'acc': 0.8219455, 'precision': 0.5343409, 'recall': 0.65054965, 'specificity': 0.65054965, 'f1': 0.5262909, 'auroc': 0.7048328, 'binary_precision': 0.09082652, 'binary_recall': 0.466563, 'binary_specificity': 0.8345363, 'binary_f1_score': 0.1520527}
confusion matrix:
       0     1
0  15146  3003
1    343   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85650367, 'precision': 0.5677891, 'recall': 0.71441084, 'specificity': 0.71441084, 'f1': 0.58304584, 'auroc': 0.79193044, 'binary_precision': 0.15715824, 'binary_recall': 0.55938697, 'binary_specificity': 0.8694347, 'binary_f1_score': 0.24537815}
confusion matrix:
      0    1
0  5214  783
1   115  146
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-04 20:37:49.527699,epoch time: 0:16:38.282878,used: 3:07:28.991354,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.90812415, 'precision': 0.9083549, 'recall': 0.9081329, 'specificity': 0.9081329, 'f1': 0.9081124, 'auroc': 0.9701004, 'binary_precision': 0.9182464, 'binary_recall': 0.89617085, 'binary_specificity': 0.9200949, 'binary_f1_score': 0.90707433}
confusion matrix:
       0      1
0  26369   2290
1   2980  25721
---- Validation: 
scalar performance:
{'acc': 0.829768, 'precision': 0.5335132, 'recall': 0.64034843, 'specificity': 0.64034843, 'f1': 0.52742386, 'auroc': 0.7093911, 'binary_precision': 0.09012187, 'binary_recall': 0.43701398, 'binary_specificity': 0.8436828, 'binary_f1_score': 0.14942834}
confusion matrix:
       0     1
0  15312  2837
1    362   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8724832, 'precision': 0.57936776, 'recall': 0.7300777, 'specificity': 0.7300777, 'f1': 0.60166717, 'auroc': 0.81154305, 'binary_precision': 0.17921147, 'binary_recall': 0.57471263, 'binary_specificity': 0.88544273, 'binary_f1_score': 0.27322403}
confusion matrix:
      0    1
0  5310  687
1   111  150
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-04 20:54:20.105300,epoch time: 0:16:30.577601,used: 3:23:59.568955,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9129881, 'precision': 0.91495335, 'recall': 0.91296184, 'specificity': 0.91296184, 'f1': 0.9128813, 'auroc': 0.9767971, 'binary_precision': 0.8865882, 'binary_recall': 0.9472859, 'binary_specificity': 0.87863773, 'binary_f1_score': 0.9159326}
confusion matrix:
       0      1
0  25180   3478
1   1513  27189
---- Validation: 
scalar performance:
{'acc': 0.7711792, 'precision': 0.5319508, 'recall': 0.67302084, 'specificity': 0.67302084, 'f1': 0.5065205, 'auroc': 0.7148175, 'binary_precision': 0.083200365, 'binary_recall': 0.5676516, 'binary_specificity': 0.77839, 'binary_f1_score': 0.14512923}
confusion matrix:
       0     1
0  14127  4022
1    278   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81112176, 'precision': 0.5609831, 'recall': 0.7475347, 'specificity': 0.7475347, 'f1': 0.56140924, 'auroc': 0.8217423, 'binary_precision': 0.13882352, 'binary_recall': 0.6781609, 'binary_specificity': 0.8169085, 'binary_f1_score': 0.23046875}
confusion matrix:
      0     1
0  4899  1098
1    84   177
early stop counter: 1
val acc:0.77117919921875, best validation acc: 0.8297680020332336, corresponding to test acc:                         0.8724831938743591 / 0.8724831938743591
after epoch: 13,now: 2024-08-04 21:10:41.108121,epoch time: 0:16:21.002821,used: 3:40:20.571776,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92105997, 'precision': 0.9213469, 'recall': 0.9210505, 'specificity': 0.9210505, 'f1': 0.9210453, 'auroc': 0.97740066, 'binary_precision': 0.91053295, 'binary_recall': 0.93400925, 'binary_specificity': 0.9080917, 'binary_f1_score': 0.9221217}
confusion matrix:
       0      1
0  26025   2634
1   1894  26807
---- Validation: 
scalar performance:
{'acc': 0.80443805, 'precision': 0.5385662, 'recall': 0.6864891, 'specificity': 0.6864891, 'f1': 0.5265465, 'auroc': 0.7318649, 'binary_precision': 0.09594883, 'binary_recall': 0.5598756, 'binary_specificity': 0.81310266, 'binary_f1_score': 0.16382253}
confusion matrix:
       0     1
0  14757  3392
1    283   360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85107064, 'precision': 0.5766587, 'recall': 0.7610491, 'specificity': 0.7610491, 'f1': 0.5939013, 'auroc': 0.83801925, 'binary_precision': 0.17010815, 'binary_recall': 0.66283524, 'binary_specificity': 0.85926294, 'binary_f1_score': 0.27073553}
confusion matrix:
      0    1
0  5153  844
1    88  173
early stop counter: 2
val acc:0.804438054561615, best validation acc: 0.8297680020332336, corresponding to test acc:                         0.8724831938743591 / 0.8724831938743591
after epoch: 14,now: 2024-08-04 21:27:18.053657,epoch time: 0:16:36.945536,used: 3:56:57.517312,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9130753, 'precision': 0.9140737, 'recall': 0.9130574, 'specificity': 0.9130574, 'f1': 0.9130204, 'auroc': 0.97535646, 'binary_precision': 0.8939238, 'binary_recall': 0.9375283, 'binary_specificity': 0.88858646, 'binary_f1_score': 0.915207}
confusion matrix:
       0      1
0  25466   3193
1   1793  26908
---- Validation: 
scalar performance:
{'acc': 0.7956045, 'precision': 0.5347835, 'recall': 0.6729152, 'specificity': 0.6729152, 'f1': 0.5185885, 'auroc': 0.7174972, 'binary_precision': 0.08936826, 'binary_recall': 0.54121304, 'binary_specificity': 0.80461735, 'binary_f1_score': 0.15340534}
confusion matrix:
       0     1
0  14603  3546
1    295   348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84100354, 'precision': 0.56746006, 'recall': 0.73747313, 'specificity': 0.73747313, 'f1': 0.5789519, 'auroc': 0.8158747, 'binary_precision': 0.15377359, 'binary_recall': 0.6245211, 'binary_specificity': 0.8504252, 'binary_f1_score': 0.24678273}
confusion matrix:
      0    1
0  5100  897
1    98  163
early stop counter: 3
val acc:0.7956045269966125, best validation acc: 0.8297680020332336, corresponding to test acc:                         0.8724831938743591 / 0.8724831938743591
after epoch: 15,now: 2024-08-04 21:44:25.822945,epoch time: 0:17:07.769288,used: 4:14:05.286600,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:14:05.286600 at 2024-08-04 21:44:25.822945
persisted model performance metric: 

scalar performance:
{'acc': 0.8724832, 'precision': 0.57936776, 'recall': 0.7300777, 'specificity': 0.7300777, 'f1': 0.60166717, 'auroc': 0.81154305, 'binary_precision': 0.17921147, 'binary_recall': 0.57471263, 'binary_specificity': 0.88544273, 'binary_f1_score': 0.27322403}
confusion matrix:
      0    1
0  5310  687
1   111  150
oracle model performance metric: 

scalar performance:
{'acc': 0.8724832, 'precision': 0.57936776, 'recall': 0.7300777, 'specificity': 0.7300777, 'f1': 0.60166717, 'auroc': 0.81154305, 'binary_precision': 0.17921147, 'binary_recall': 0.57471263, 'binary_specificity': 0.88544273, 'binary_f1_score': 0.27322403}
confusion matrix:
      0    1
0  5310  687
1   111  150
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool | 167936 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 563304 KiB | 200521 GiB | 200520 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 200245 GiB | 200245 GiB |
|       from small pool |  35968 KiB |  74337 KiB |    275 GiB |    275 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 737280 KiB | 737280 KiB | 737280 KiB |      0 B   |
|       from large pool | 661504 KiB | 661504 KiB | 661504 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  48972 KiB | 149589 KiB | 137458 GiB | 137458 GiB |
|       from large pool |  36864 KiB | 148352 KiB | 137145 GiB | 137145 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    313 GiB |    313 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7939    |   44493 K  |   44490 K  |
|       from large pool |      36    |      76    |   13725 K  |   13725 K  |
|       from small pool |    3216    |    7901    |   30767 K  |   30764 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7939    |   44493 K  |   44490 K  |
|       from large pool |      36    |      76    |   13725 K  |   13725 K  |
|       from small pool |    3216    |    7901    |   30767 K  |   30764 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      54    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    3599    |   23251 K  |   23251 K  |
|       from large pool |       7    |      11    |    8595 K  |    8595 K  |
|       from small pool |      46    |    3593    |   14656 K  |   14656 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |      0 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |      0 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 200521 GiB | 200521 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 200245 GiB | 200245 GiB |
|       from small pool |      0 KiB |  74337 KiB |    275 GiB |    275 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB | 737280 KiB | 737280 KiB | 483328 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149589 KiB | 137458 GiB | 137458 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 137145 GiB | 137145 GiB |
|       from small pool |      0 KiB |  19703 KiB |    313 GiB |    313 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   44493 K  |   44493 K  |
|       from large pool |       2    |      76    |   13725 K  |   13725 K  |
|       from small pool |       0    |    7901    |   30767 K  |   30767 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   44493 K  |   44493 K  |
|       from large pool |       2    |      76    |   13725 K  |   13725 K  |
|       from small pool |       0    |    7901    |   30767 K  |   30767 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      54    |      54    |      20    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3599    |   23253 K  |   23253 K  |
|       from large pool |       3    |      13    |    8595 K  |    8595 K  |
|       from small pool |       0    |    3593    |   14658 K  |   14658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |      0 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 574425 KiB | 202763 GiB | 202763 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 202477 GiB | 202477 GiB |
|       from small pool |      0 KiB |  75475 KiB |    285 GiB |    285 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 200521 GiB | 200521 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 200245 GiB | 200245 GiB |
|       from small pool |      0 KiB |  74337 KiB |    275 GiB |    275 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB | 737280 KiB | 737280 KiB | 483328 KiB |
|       from large pool | 204800 KiB | 661504 KiB | 661504 KiB | 456704 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 149589 KiB | 137458 GiB | 137458 GiB |
|       from large pool |  24320 KiB | 148352 KiB | 137145 GiB | 137145 GiB |
|       from small pool |      0 KiB |  19703 KiB |    313 GiB |    313 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7939    |   44493 K  |   44493 K  |
|       from large pool |       2    |      76    |   13725 K  |   13725 K  |
|       from small pool |       0    |    7901    |   30767 K  |   30767 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7939    |   44493 K  |   44493 K  |
|       from large pool |       2    |      76    |   13725 K  |   13725 K  |
|       from small pool |       0    |    7901    |   30767 K  |   30767 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      54    |      54    |      20    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3599    |   23253 K  |   23253 K  |
|       from large pool |       3    |      13    |    8595 K  |    8595 K  |
|       from small pool |       0    |    3593    |   14658 K  |   14658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110

 Experiment start at: 2024-08-04 21:54:41.939787
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.67601013, 'precision': 0.7048463, 'recall': 0.6758797, 'specificity': 0.6758797, 'f1': 0.66409135, 'auroc': 0.7917124, 'binary_precision': 0.62816274, 'binary_recall': 0.8637783, 'binary_specificity': 0.4879811, 'binary_f1_score': 0.72736573}
confusion matrix:
       0      1
0  14048  14740
1   3927  24901
---- Validation: 
scalar performance:
{'acc': 0.39055496, 'precision': 0.48973414, 'recall': 0.42929134, 'specificity': 0.42929134, 'f1': 0.30169436, 'auroc': 0.39912242, 'binary_precision': 0.027850993, 'binary_recall': 0.47102526, 'binary_specificity': 0.38755742, 'binary_f1_score': 0.05259229}
confusion matrix:
      0      1
0  7002  11065
1   356    317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49178216, 'precision': 0.48838595, 'recall': 0.42766887, 'specificity': 0.42766887, 'f1': 0.35401273, 'auroc': 0.4102021, 'binary_precision': 0.030194806, 'binary_recall': 0.3576923, 'binary_specificity': 0.49764547, 'binary_f1_score': 0.05568862}
confusion matrix:
      0     1
0  2959  2987
1   167    93
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 22:12:22.421422,epoch time: 0:17:40.481635,used: 0:17:40.481635,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.78230006, 'precision': 0.8044758, 'recall': 0.7822063, 'specificity': 0.7822063, 'f1': 0.778224, 'auroc': 0.9013709, 'binary_precision': 0.72247875, 'binary_recall': 0.9172332, 'binary_specificity': 0.64717937, 'binary_f1_score': 0.8082901}
confusion matrix:
       0      1
0  18631  10157
1   2386  26442
---- Validation: 
scalar performance:
{'acc': 0.5118463, 'precision': 0.5059533, 'recall': 0.5429801, 'specificity': 0.5429801, 'f1': 0.37310785, 'auroc': 0.540953, 'binary_precision': 0.04194141, 'binary_recall': 0.576523, 'binary_specificity': 0.5094371, 'binary_f1_score': 0.078194275}
confusion matrix:
      0     1
0  9204  8863
1   285   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6279407, 'precision': 0.5176687, 'recall': 0.60354733, 'specificity': 0.60354733, 'f1': 0.43972322, 'auroc': 0.63790995, 'binary_precision': 0.06385696, 'binary_recall': 0.5769231, 'binary_specificity': 0.63017154, 'binary_f1_score': 0.11498658}
confusion matrix:
      0     1
0  3747  2199
1   110   150
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 22:29:42.747718,epoch time: 0:17:20.326296,used: 0:35:00.807931,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8257602, 'precision': 0.8371756, 'recall': 0.8256899, 'specificity': 0.8256899, 'f1': 0.82425106, 'auroc': 0.9250412, 'binary_precision': 0.775326, 'binary_recall': 0.9177246, 'binary_specificity': 0.7336553, 'binary_f1_score': 0.8405369}
confusion matrix:
       0      1
0  21119   7667
1   2372  26458
---- Validation: 
scalar performance:
{'acc': 0.6919424, 'precision': 0.51407003, 'recall': 0.58631366, 'specificity': 0.58631366, 'f1': 0.4567176, 'auroc': 0.61089253, 'binary_precision': 0.05543933, 'binary_recall': 0.47251114, 'binary_specificity': 0.7001162, 'binary_f1_score': 0.09923545}
confusion matrix:
       0     1
0  12649  5418
1    355   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77441186, 'precision': 0.53941536, 'recall': 0.6744683, 'specificity': 0.6744683, 'f1': 0.5214662, 'auroc': 0.7272594, 'binary_precision': 0.10251046, 'binary_recall': 0.5653846, 'binary_specificity': 0.783552, 'binary_f1_score': 0.17355372}
confusion matrix:
      0     1
0  4659  1287
1   113   147
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 22:47:00.971931,epoch time: 0:17:18.224213,used: 0:52:19.032144,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8519682, 'precision': 0.8534684, 'recall': 0.85194564, 'specificity': 0.85194564, 'f1': 0.8518052, 'auroc': 0.9348364, 'binary_precision': 0.8306134, 'binary_recall': 0.884522, 'binary_specificity': 0.8193692, 'binary_f1_score': 0.8567205}
confusion matrix:
       0      1
0  23588   5200
1   3329  25499
---- Validation: 
scalar performance:
{'acc': 0.7502668, 'precision': 0.51808035, 'recall': 0.5965347, 'specificity': 0.5965347, 'f1': 0.48250738, 'auroc': 0.62769485, 'binary_precision': 0.06322215, 'binary_recall': 0.4309064, 'binary_specificity': 0.76216304, 'binary_f1_score': 0.11026616}
confusion matrix:
       0     1
0  13770  4297
1    383   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377377, 'precision': 0.5534186, 'recall': 0.6817699, 'specificity': 0.6817699, 'f1': 0.55927604, 'auroc': 0.7400502, 'binary_precision': 0.13129319, 'binary_recall': 0.51153845, 'binary_specificity': 0.85200137, 'binary_f1_score': 0.20895523}
confusion matrix:
      0    1
0  5066  880
1   127  133
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 23:04:26.609859,epoch time: 0:17:25.637928,used: 1:09:44.670072,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8579214, 'precision': 0.86434305, 'recall': 0.8578731, 'specificity': 0.8578731, 'f1': 0.85728085, 'auroc': 0.9454392, 'binary_precision': 0.8161546, 'binary_recall': 0.924243, 'binary_specificity': 0.79150313, 'binary_f1_score': 0.8668423}
confusion matrix:
       0      1
0  22785   6002
1   2184  26645
---- Validation: 
scalar performance:
{'acc': 0.71568835, 'precision': 0.51967865, 'recall': 0.6157954, 'specificity': 0.6157954, 'f1': 0.47222883, 'auroc': 0.6376536, 'binary_precision': 0.06405694, 'binary_recall': 0.50817233, 'binary_specificity': 0.7234184, 'binary_f1_score': 0.11377247}
confusion matrix:
       0     1
0  13070  4997
1    331   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7990654, 'precision': 0.5494491, 'recall': 0.70388496, 'specificity': 0.70388496, 'f1': 0.5426146, 'auroc': 0.7599938, 'binary_precision': 0.12009238, 'binary_recall': 0.6, 'binary_specificity': 0.80776995, 'binary_f1_score': 0.20012829}
confusion matrix:
      0     1
0  4803  1143
1   104   156
early stop counter: 1
val acc:0.7156883478164673, best validation acc: 0.7502667903900146, corresponding to test acc:                         0.8377376794815063 / 0.8377376794815063
after epoch: 5,now: 2024-08-04 23:21:40.666850,epoch time: 0:17:14.056991,used: 1:26:58.727063,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8730908, 'precision': 0.87522566, 'recall': 0.8730633, 'specificity': 0.8730633, 'f1': 0.8729042, 'auroc': 0.95161045, 'binary_precision': 0.8471044, 'binary_recall': 0.9107496, 'binary_specificity': 0.8353771, 'binary_f1_score': 0.87777483}
confusion matrix:
       0      1
0  24048   4739
1   2573  26256
---- Validation: 
scalar performance:
{'acc': 0.7564568, 'precision': 0.52544, 'recall': 0.63550836, 'specificity': 0.63550836, 'f1': 0.4940456, 'auroc': 0.6722058, 'binary_precision': 0.07438197, 'binary_recall': 0.50520056, 'binary_specificity': 0.76581615, 'binary_f1_score': 0.129672}
confusion matrix:
       0     1
0  13836  4231
1    333   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8254915, 'precision': 0.55722135, 'recall': 0.7121588, 'specificity': 0.7121588, 'f1': 0.56102663, 'auroc': 0.773868, 'binary_precision': 0.13551816, 'binary_recall': 0.5884615, 'binary_specificity': 0.835856, 'binary_f1_score': 0.22030237}
confusion matrix:
      0    1
0  4970  976
1   107  153
better model found
persisted
after epoch: 6,now: 2024-08-04 23:39:07.232733,epoch time: 0:17:26.565883,used: 1:44:25.292946,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88057137, 'precision': 0.8805728, 'recall': 0.88057065, 'specificity': 0.88057065, 'f1': 0.88057107, 'auroc': 0.9534991, 'binary_precision': 0.8799903, 'binary_recall': 0.881547, 'binary_specificity': 0.87959427, 'binary_f1_score': 0.88076794}
confusion matrix:
       0      1
0  25320   3466
1   3415  25415
---- Validation: 
scalar performance:
{'acc': 0.8188367, 'precision': 0.52597237, 'recall': 0.60706246, 'specificity': 0.60706246, 'f1': 0.51474243, 'auroc': 0.68385506, 'binary_precision': 0.07889851, 'binary_recall': 0.37890044, 'binary_specificity': 0.83522445, 'binary_f1_score': 0.1306018}
confusion matrix:
       0     1
0  15090  2977
1    418   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86932003, 'precision': 0.574045, 'recall': 0.71480244, 'specificity': 0.71480244, 'f1': 0.5938493, 'auroc': 0.7802795, 'binary_precision': 0.17005987, 'binary_recall': 0.54615384, 'binary_specificity': 0.88345104, 'binary_f1_score': 0.25936073}
confusion matrix:
      0    1
0  5253  693
1   118  142
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-04 23:57:20.056140,epoch time: 0:18:12.823407,used: 2:02:38.116353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8925472, 'precision': 0.8926754, 'recall': 0.8925407, 'specificity': 0.8925407, 'f1': 0.89253724, 'auroc': 0.9607692, 'binary_precision': 0.885761, 'binary_recall': 0.90152276, 'binary_specificity': 0.8835586, 'binary_f1_score': 0.8935724}
confusion matrix:
       0      1
0  25435   3352
1   2839  25990
---- Validation: 
scalar performance:
{'acc': 0.81472784, 'precision': 0.53044546, 'recall': 0.62996584, 'specificity': 0.62996584, 'f1': 0.5196371, 'auroc': 0.7007314, 'binary_precision': 0.08582421, 'binary_recall': 0.4309064, 'binary_specificity': 0.82902527, 'binary_f1_score': 0.14313918}
confusion matrix:
       0     1
0  14978  3089
1    383   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88108283, 'precision': 0.58529794, 'recall': 0.73197496, 'specificity': 0.73197496, 'f1': 0.61070246, 'auroc': 0.8007302, 'binary_precision': 0.19121447, 'binary_recall': 0.5692308, 'binary_specificity': 0.8947191, 'binary_f1_score': 0.28626695}
confusion matrix:
      0    1
0  5320  626
1   112  148
new oracle model saved
early stop counter: 1
val acc:0.8147278428077698, best validation acc: 0.8188366889953613, corresponding to test acc:                         0.8693200349807739 / 0.8810828328132629
after epoch: 8,now: 2024-08-05 00:15:17.588539,epoch time: 0:17:57.532399,used: 2:20:35.648752,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89537627, 'precision': 0.89553636, 'recall': 0.895369, 'specificity': 0.895369, 'f1': 0.8953644, 'auroc': 0.96142375, 'binary_precision': 0.8877589, 'binary_recall': 0.90537304, 'binary_specificity': 0.88536495, 'binary_f1_score': 0.8964794}
confusion matrix:
       0      1
0  25487   3300
1   2728  26101
---- Validation: 
scalar performance:
{'acc': 0.83319104, 'precision': 0.5270447, 'recall': 0.6030627, 'specificity': 0.6030627, 'f1': 0.5201763, 'auroc': 0.67304355, 'binary_precision': 0.081542134, 'binary_recall': 0.3551263, 'binary_specificity': 0.85099906, 'binary_f1_score': 0.13263041}
confusion matrix:
       0     1
0  15375  2692
1    434   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88511115, 'precision': 0.5803905, 'recall': 0.70465344, 'specificity': 0.70465344, 'f1': 0.60393125, 'auroc': 0.7640217, 'binary_precision': 0.18410042, 'binary_recall': 0.50769234, 'binary_specificity': 0.90161455, 'binary_f1_score': 0.27021495}
confusion matrix:
      0    1
0  5361  585
1   128  132
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-05 00:32:25.219075,epoch time: 0:17:07.630536,used: 2:37:43.279288,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.89296377, 'precision': 0.89459217, 'recall': 0.8929404, 'specificity': 0.8929404, 'f1': 0.8928491, 'auroc': 0.9646249, 'binary_precision': 0.8694249, 'binary_recall': 0.9250061, 'binary_specificity': 0.8608747, 'binary_f1_score': 0.8963547}
confusion matrix:
       0      1
0  24782   4005
1   2162  26667
---- Validation: 
scalar performance:
{'acc': 0.77620065, 'precision': 0.5290146, 'recall': 0.645748, 'specificity': 0.645748, 'f1': 0.5054446, 'auroc': 0.68268716, 'binary_precision': 0.08093311, 'binary_recall': 0.50520056, 'binary_specificity': 0.7862955, 'binary_f1_score': 0.1395158}
confusion matrix:
       0     1
0  14206  3861
1    333   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8359652, 'precision': 0.55933917, 'recall': 0.7084297, 'specificity': 0.7084297, 'f1': 0.56676906, 'auroc': 0.76681995, 'binary_precision': 0.14041746, 'binary_recall': 0.5692308, 'binary_specificity': 0.84762865, 'binary_f1_score': 0.22526637}
confusion matrix:
      0    1
0  5040  906
1   112  148
early stop counter: 1
val acc:0.7762006521224976, best validation acc: 0.8331910371780396, corresponding to test acc:                         0.8851111531257629 / 0.8851111531257629
after epoch: 10,now: 2024-08-05 00:49:43.532128,epoch time: 0:17:18.313053,used: 2:55:01.592341,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8952548, 'precision': 0.8988749, 'recall': 0.89522177, 'specificity': 0.89522177, 'f1': 0.8950109, 'auroc': 0.96874154, 'binary_precision': 0.86104864, 'binary_recall': 0.9427987, 'binary_specificity': 0.84764487, 'binary_f1_score': 0.9000712}
confusion matrix:
       0      1
0  24402   4386
1   1649  27179
---- Validation: 
scalar performance:
{'acc': 0.7603522, 'precision': 0.52699673, 'recall': 0.64253545, 'specificity': 0.64253545, 'f1': 0.49739295, 'auroc': 0.68049675, 'binary_precision': 0.076906025, 'binary_recall': 0.51560175, 'binary_specificity': 0.7694692, 'binary_f1_score': 0.13384762}
confusion matrix:
       0     1
0  13902  4165
1    326   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81260073, 'precision': 0.56009275, 'recall': 0.7403723, 'specificity': 0.7403723, 'f1': 0.56080985, 'auroc': 0.79926324, 'binary_precision': 0.13793103, 'binary_recall': 0.6615385, 'binary_specificity': 0.8192062, 'binary_f1_score': 0.22826807}
confusion matrix:
      0     1
0  4871  1075
1    88   172
early stop counter: 2
val acc:0.7603521943092346, best validation acc: 0.8331910371780396, corresponding to test acc:                         0.8851111531257629 / 0.8851111531257629
after epoch: 11,now: 2024-08-05 01:06:59.233723,epoch time: 0:17:15.701595,used: 3:12:17.293936,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9023535, 'precision': 0.9034761, 'recall': 0.9023353, 'specificity': 0.9023353, 'f1': 0.9022826, 'auroc': 0.9686707, 'binary_precision': 0.88236654, 'binary_recall': 0.9286458, 'binary_specificity': 0.8760247, 'binary_f1_score': 0.90491486}
confusion matrix:
       0      1
0  25219   3569
1   2057  26771
---- Validation: 
scalar performance:
{'acc': 0.7947172, 'precision': 0.532786, 'recall': 0.6546359, 'specificity': 0.6546359, 'f1': 0.51654965, 'auroc': 0.7140269, 'binary_precision': 0.08800623, 'binary_recall': 0.5037147, 'binary_specificity': 0.8055571, 'binary_f1_score': 0.14983425}
confusion matrix:
       0     1
0  14554  3513
1    334   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83902675, 'precision': 0.5662508, 'recall': 0.7339343, 'specificity': 0.7339343, 'f1': 0.5768409, 'auroc': 0.8071295, 'binary_precision': 0.15174364, 'binary_recall': 0.61923075, 'binary_specificity': 0.84863776, 'binary_f1_score': 0.24375471}
confusion matrix:
      0    1
0  5046  900
1    99  161
early stop counter: 3
val acc:0.7947171926498413, best validation acc: 0.8331910371780396, corresponding to test acc:                         0.8851111531257629 / 0.8851111531257629
after epoch: 12,now: 2024-08-05 01:24:22.836961,epoch time: 0:17:23.603238,used: 3:29:40.897174,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91408634, 'precision': 0.9140866, 'recall': 0.9140861, 'specificity': 0.9140861, 'f1': 0.9140863, 'auroc': 0.9736063, 'binary_precision': 0.91394794, 'binary_recall': 0.91439176, 'binary_specificity': 0.9137805, 'binary_f1_score': 0.9141698}
confusion matrix:
       0      1
0  26305   2482
1   2468  26361
---- Validation: 
scalar performance:
{'acc': 0.8019744, 'precision': 0.53307444, 'recall': 0.651247, 'specificity': 0.651247, 'f1': 0.51926446, 'auroc': 0.6975692, 'binary_precision': 0.08901515, 'binary_recall': 0.48885587, 'binary_specificity': 0.81363815, 'binary_f1_score': 0.15060654}
confusion matrix:
       0     1
0  14700  3367
1    344   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84273285, 'precision': 0.5717546, 'recall': 0.75241923, 'specificity': 0.75241923, 'f1': 0.5851995, 'auroc': 0.8148057, 'binary_precision': 0.16098484, 'binary_recall': 0.65384614, 'binary_specificity': 0.85099226, 'binary_f1_score': 0.25835866}
confusion matrix:
      0    1
0  5060  886
1    90  170
early stop counter: 4
val acc:0.8019744157791138, best validation acc: 0.8331910371780396, corresponding to test acc:                         0.8851111531257629 / 0.8851111531257629
after epoch: 13,now: 2024-08-05 01:41:49.151168,epoch time: 0:17:26.314207,used: 3:47:07.211381,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9136525, 'precision': 0.9137641, 'recall': 0.9136466, 'specificity': 0.9136466, 'f1': 0.91364574, 'auroc': 0.97311544, 'binary_precision': 0.90714824, 'binary_recall': 0.92178017, 'binary_specificity': 0.9055129, 'binary_f1_score': 0.91440564}
confusion matrix:
       0      1
0  26067   2720
1   2255  26574
---- Validation: 
scalar performance:
{'acc': 0.8020811, 'precision': 0.53036344, 'recall': 0.63771224, 'specificity': 0.63771224, 'f1': 0.51566905, 'auroc': 0.6950407, 'binary_precision': 0.08479212, 'binary_recall': 0.46062407, 'binary_specificity': 0.81480044, 'binary_f1_score': 0.14322014}
confusion matrix:
       0     1
0  14721  3346
1    363   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85787946, 'precision': 0.5745406, 'recall': 0.73825586, 'specificity': 0.73825586, 'f1': 0.59256065, 'auroc': 0.7972405, 'binary_precision': 0.1684435, 'binary_recall': 0.6076923, 'binary_specificity': 0.86881936, 'binary_f1_score': 0.26377296}
confusion matrix:
      0    1
0  5166  780
1   102  158
early stop counter: 5
val acc:0.8020811080932617, best validation acc: 0.8331910371780396, corresponding to test acc:                         0.8851111531257629 / 0.8851111531257629
after epoch: 14,now: 2024-08-05 01:59:07.302185,epoch time: 0:17:18.151017,used: 4:04:25.362398,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9150583, 'precision': 0.91649634, 'recall': 0.91503596, 'specificity': 0.91503596, 'f1': 0.91498184, 'auroc': 0.97671866, 'binary_precision': 0.8922134, 'binary_recall': 0.94432884, 'binary_specificity': 0.8857431, 'binary_f1_score': 0.91753167}
confusion matrix:
       0      1
0  25497   3289
1   1605  27225
---- Validation: 
scalar performance:
{'acc': 0.7872465, 'precision': 0.53099996, 'recall': 0.6500461, 'specificity': 0.6500461, 'f1': 0.51173955, 'auroc': 0.70884883, 'binary_precision': 0.08471178, 'binary_recall': 0.5022288, 'binary_specificity': 0.7978635, 'binary_f1_score': 0.14497104}
confusion matrix:
       0     1
0  14415  3652
1    335   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8524009, 'precision': 0.5732769, 'recall': 0.74275273, 'specificity': 0.74275273, 'f1': 0.58964986, 'auroc': 0.82697153, 'binary_precision': 0.16530612, 'binary_recall': 0.6230769, 'binary_specificity': 0.86242855, 'binary_f1_score': 0.26129034}
confusion matrix:
      0    1
0  5128  818
1    98  162
early stop counter: 6
val acc:0.7872465252876282, best validation acc: 0.8331910371780396, corresponding to test acc:                         0.8851111531257629 / 0.8851111531257629
after epoch: 15,now: 2024-08-05 02:16:22.180989,epoch time: 0:17:14.878804,used: 4:21:40.241202,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_21_54_41_seed_1_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:21:40.241202 at 2024-08-05 02:16:22.180989
persisted model performance metric: 

scalar performance:
{'acc': 0.88511115, 'precision': 0.5803905, 'recall': 0.70465344, 'specificity': 0.70465344, 'f1': 0.60393125, 'auroc': 0.7640217, 'binary_precision': 0.18410042, 'binary_recall': 0.50769234, 'binary_specificity': 0.90161455, 'binary_f1_score': 0.27021495}
confusion matrix:
      0    1
0  5361  585
1   128  132
oracle model performance metric: 

scalar performance:
{'acc': 0.88511115, 'precision': 0.5803905, 'recall': 0.70465344, 'specificity': 0.70465344, 'f1': 0.60393125, 'auroc': 0.7640217, 'binary_precision': 0.18410042, 'binary_recall': 0.50769234, 'binary_specificity': 0.90161455, 'binary_f1_score': 0.27021495}
confusion matrix:
      0    1
0  5361  585
1   128  132
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205607 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool | 168576 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205607 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool | 168576 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 563304 KiB | 402813 GiB | 402812 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 402260 GiB | 402260 GiB |
|       from small pool |  35966 KiB |  74337 KiB |    552 GiB |    552 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 757760 KiB | 757760 KiB |   1212 MiB | 483328 KiB |
|       from large pool | 681984 KiB | 681984 KiB |   1112 MiB | 456704 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  27864 KiB | 168117 KiB | 253495 GiB | 253495 GiB |
|       from large pool |  15744 KiB | 166720 KiB | 252882 GiB | 252882 GiB |
|       from small pool |  12120 KiB |  19703 KiB |    613 GiB |    613 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7971    |   89295 K  |   89292 K  |
|       from large pool |      36    |      76    |   27572 K  |   27572 K  |
|       from small pool |    3192    |    7933    |   61722 K  |   61719 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7971    |   89295 K  |   89292 K  |
|       from large pool |      36    |      76    |   27572 K  |   27572 K  |
|       from small pool |    3192    |    7933    |   61722 K  |   61719 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      75    |      20    |
|       from large pool |      18    |      18    |      25    |       7    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      50    |    3615    |   47278 K  |   47278 K  |
|       from large pool |       3    |      13    |   17871 K  |   17871 K  |
|       from small pool |      47    |    3612    |   29406 K  |   29406 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |      0 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |      0 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 402813 GiB | 402813 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 402260 GiB | 402260 GiB |
|       from small pool |      0 KiB |  74337 KiB |    552 GiB |    552 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 757760 KiB |   1212 MiB |    984 MiB |
|       from large pool | 184320 KiB | 681984 KiB |   1112 MiB |    932 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 168117 KiB | 253496 GiB | 253496 GiB |
|       from large pool |  24320 KiB | 166720 KiB | 252882 GiB | 252882 GiB |
|       from small pool |      0 KiB |  19715 KiB |    613 GiB |    613 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   89295 K  |   89295 K  |
|       from large pool |       2    |      76    |   27572 K  |   27572 K  |
|       from small pool |       0    |    7933    |   61722 K  |   61722 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   89295 K  |   89295 K  |
|       from large pool |       2    |      76    |   27572 K  |   27572 K  |
|       from small pool |       0    |    7933    |   61722 K  |   61722 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      55    |      75    |      42    |
|       from large pool |       9    |      18    |      25    |      16    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3615    |   47279 K  |   47279 K  |
|       from large pool |       3    |      13    |   17871 K  |   17871 K  |
|       from small pool |       0    |    3612    |   29407 K  |   29407 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |      0 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 574425 KiB | 407096 GiB | 407096 GiB |
|       from large pool |  16640 KiB | 501696 KiB | 406522 GiB | 406522 GiB |
|       from small pool |      0 KiB |  75475 KiB |    574 GiB |    574 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 402813 GiB | 402813 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 402260 GiB | 402260 GiB |
|       from small pool |      0 KiB |  74337 KiB |    552 GiB |    552 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 757760 KiB |   1212 MiB |    984 MiB |
|       from large pool | 184320 KiB | 681984 KiB |   1112 MiB |    932 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 168117 KiB | 253496 GiB | 253496 GiB |
|       from large pool |  24320 KiB | 166720 KiB | 252882 GiB | 252882 GiB |
|       from small pool |      0 KiB |  19715 KiB |    613 GiB |    613 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7971    |   89295 K  |   89295 K  |
|       from large pool |       2    |      76    |   27572 K  |   27572 K  |
|       from small pool |       0    |    7933    |   61722 K  |   61722 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7971    |   89295 K  |   89295 K  |
|       from large pool |       2    |      76    |   27572 K  |   27572 K  |
|       from small pool |       0    |    7933    |   61722 K  |   61722 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      55    |      75    |      42    |
|       from large pool |       9    |      18    |      25    |      16    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3615    |   47279 K  |   47279 K  |
|       from large pool |       3    |      13    |   17871 K  |   17871 K  |
|       from small pool |       0    |    3612    |   29407 K  |   29407 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110

 Experiment start at: 2024-08-05 02:27:09.765387
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.71399903, 'precision': 0.7408446, 'recall': 0.7139647, 'specificity': 0.7139647, 'f1': 0.7057797, 'auroc': 0.8253681, 'binary_precision': 0.660487, 'binary_recall': 0.8809589, 'binary_specificity': 0.5469704, 'binary_f1_score': 0.75495595}
confusion matrix:
       0      1
0  15942  13204
1   3471  25687
---- Validation: 
scalar performance:
{'acc': 0.44707826, 'precision': 0.5117852, 'recall': 0.59311974, 'specificity': 0.59311974, 'f1': 0.34236625, 'auroc': 0.6405187, 'binary_precision': 0.042228464, 'binary_recall': 0.7491694, 'binary_specificity': 0.43707004, 'binary_f1_score': 0.079950355}
confusion matrix:
      0      1
0  7942  10229
1   151    451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41737458, 'precision': 0.52062494, 'recall': 0.6315014, 'specificity': 0.6315014, 'f1': 0.33583975, 'auroc': 0.7712129, 'binary_precision': 0.05484125, 'binary_recall': 0.8636364, 'binary_specificity': 0.39936635, 'binary_f1_score': 0.10313348}
confusion matrix:
      0     1
0  2395  3602
1    33   209
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 02:46:09.656688,epoch time: 0:18:59.891301,used: 0:18:59.891301,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8311608, 'precision': 0.8347174, 'recall': 0.83115375, 'specificity': 0.83115375, 'f1': 0.830709, 'auroc': 0.91734076, 'binary_precision': 0.80024874, 'binary_recall': 0.88269997, 'binary_specificity': 0.77960753, 'binary_f1_score': 0.8394546}
confusion matrix:
       0      1
0  22724   6424
1   3420  25736
---- Validation: 
scalar performance:
{'acc': 0.6820434, 'precision': 0.5212447, 'recall': 0.65025055, 'specificity': 0.65025055, 'f1': 0.45849302, 'auroc': 0.7062819, 'binary_precision': 0.06073007, 'binary_recall': 0.61627907, 'binary_specificity': 0.6842221, 'binary_f1_score': 0.110564746}
confusion matrix:
       0     1
0  12433  5738
1    231   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7573329, 'precision': 0.5445994, 'recall': 0.72903013, 'specificity': 0.72903013, 'f1': 0.5200124, 'auroc': 0.7921585, 'binary_precision': 0.10496894, 'binary_recall': 0.6983471, 'binary_specificity': 0.7597132, 'binary_f1_score': 0.1825054}
confusion matrix:
      0     1
0  4556  1441
1    73   169
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-05 03:03:59.415673,epoch time: 0:17:49.758985,used: 0:36:49.650286,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8332876, 'precision': 0.84214944, 'recall': 0.833271, 'specificity': 0.833271, 'f1': 0.83219624, 'auroc': 0.92951846, 'binary_precision': 0.7871366, 'binary_recall': 0.9137458, 'binary_specificity': 0.7527963, 'binary_f1_score': 0.845729}
confusion matrix:
       0      1
0  21941   7205
1   2515  26643
---- Validation: 
scalar performance:
{'acc': 0.6391626, 'precision': 0.51991874, 'recall': 0.64978224, 'specificity': 0.64978224, 'f1': 0.43958554, 'auroc': 0.69595504, 'binary_precision': 0.057118256, 'binary_recall': 0.6611296, 'binary_specificity': 0.6384349, 'binary_f1_score': 0.105151914}
confusion matrix:
       0     1
0  11601  6570
1    204   398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69818884, 'precision': 0.5363825, 'recall': 0.71214396, 'specificity': 0.71214396, 'f1': 0.48683077, 'auroc': 0.78371966, 'binary_precision': 0.08830908, 'binary_recall': 0.72727275, 'binary_specificity': 0.69701517, 'binary_f1_score': 0.15749441}
confusion matrix:
      0     1
0  4180  1817
1    66   176
early stop counter: 1
val acc:0.6391626000404358, best validation acc: 0.6820433735847473, corresponding to test acc:                         0.7573329210281372 / 0.7573329210281372
after epoch: 3,now: 2024-08-05 03:21:45.071113,epoch time: 0:17:45.655440,used: 0:54:35.305726,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.86498356, 'precision': 0.86544645, 'recall': 0.86498046, 'specificity': 0.86498046, 'f1': 0.86494005, 'auroc': 0.94374067, 'binary_precision': 0.8524824, 'binary_recall': 0.88277256, 'binary_specificity': 0.8471884, 'binary_f1_score': 0.86736304}
confusion matrix:
       0      1
0  24693   4454
1   3418  25739
---- Validation: 
scalar performance:
{'acc': 0.78208065, 'precision': 0.5269477, 'recall': 0.6481221, 'specificity': 0.6481221, 'f1': 0.502421, 'auroc': 0.701998, 'binary_precision': 0.07420064, 'binary_recall': 0.50498337, 'binary_specificity': 0.7912608, 'binary_f1_score': 0.12938924}
confusion matrix:
       0     1
0  14378  3793
1    298   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.860234, 'precision': 0.56256443, 'recall': 0.70523, 'specificity': 0.70523, 'f1': 0.5764134, 'auroc': 0.7735812, 'binary_precision': 0.14606741, 'binary_recall': 0.5371901, 'binary_specificity': 0.87327, 'binary_f1_score': 0.22968197}
confusion matrix:
      0    1
0  5237  760
1   112  130
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-05 03:38:52.968142,epoch time: 0:17:07.897029,used: 1:11:43.202755,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8741424, 'precision': 0.87415427, 'recall': 0.874143, 'specificity': 0.874143, 'f1': 0.8741415, 'auroc': 0.9498645, 'binary_precision': 0.8763107, 'binary_recall': 0.87132174, 'binary_specificity': 0.8769643, 'binary_f1_score': 0.87380904}
confusion matrix:
       0      1
0  25560   3586
1   3752  25406
---- Validation: 
scalar performance:
{'acc': 0.78250676, 'precision': 0.5214791, 'recall': 0.6162203, 'specificity': 0.6162203, 'f1': 0.49526864, 'auroc': 0.67803216, 'binary_precision': 0.06585183, 'binary_recall': 0.4385382, 'binary_specificity': 0.7939024, 'binary_f1_score': 0.11450878}
confusion matrix:
       0     1
0  14426  3745
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507774, 'precision': 0.5588501, 'recall': 0.7042764, 'specificity': 0.7042764, 'f1': 0.5692035, 'auroc': 0.7826289, 'binary_precision': 0.13850997, 'binary_recall': 0.54545456, 'binary_specificity': 0.8630982, 'binary_f1_score': 0.22092052}
confusion matrix:
      0    1
0  5176  821
1   110  132
better model found
persisted
after epoch: 5,now: 2024-08-05 03:55:41.809899,epoch time: 0:16:48.841757,used: 1:28:32.044512,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8854624, 'precision': 0.8897903, 'recall': 0.88545334, 'specificity': 0.88545334, 'f1': 0.8851419, 'auroc': 0.9631039, 'binary_precision': 0.84876037, 'binary_recall': 0.93812805, 'binary_specificity': 0.8327787, 'binary_f1_score': 0.8912095}
confusion matrix:
       0      1
0  24273   4874
1   1804  27353
---- Validation: 
scalar performance:
{'acc': 0.73925316, 'precision': 0.52998793, 'recall': 0.69024277, 'specificity': 0.69024277, 'f1': 0.4910435, 'auroc': 0.74577284, 'binary_precision': 0.075874336, 'binary_recall': 0.63787377, 'binary_specificity': 0.7426118, 'binary_f1_score': 0.13561717}
confusion matrix:
       0     1
0  13494  4677
1    218   384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8284982, 'precision': 0.565275, 'recall': 0.76604867, 'specificity': 0.76604867, 'f1': 0.5716996, 'auroc': 0.84193474, 'binary_precision': 0.14493996, 'binary_recall': 0.6983471, 'binary_specificity': 0.8337502, 'binary_f1_score': 0.24005681}
confusion matrix:
      0    1
0  5000  997
1    73  169
early stop counter: 1
val acc:0.7392531633377075, best validation acc: 0.7825067639350891, corresponding to test acc:                         0.8507773876190186 / 0.8602340221405029
after epoch: 6,now: 2024-08-05 04:12:31.369942,epoch time: 0:16:49.560043,used: 1:45:21.604555,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88398737, 'precision': 0.8886039, 'recall': 0.8839799, 'specificity': 0.8839799, 'f1': 0.8836404, 'auroc': 0.9624517, 'binary_precision': 0.8462823, 'binary_recall': 0.93846893, 'binary_specificity': 0.8294909, 'binary_f1_score': 0.8899948}
confusion matrix:
       0      1
0  24178   4970
1   1794  27362
---- Validation: 
scalar performance:
{'acc': 0.7111277, 'precision': 0.5250592, 'recall': 0.6684867, 'specificity': 0.6684867, 'f1': 0.4743206, 'auroc': 0.71139693, 'binary_precision': 0.067312874, 'binary_recall': 0.6229236, 'binary_specificity': 0.7140499, 'binary_f1_score': 0.12149685}
confusion matrix:
       0     1
0  12975  5196
1    227   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7756051, 'precision': 0.5505853, 'recall': 0.7484486, 'specificity': 0.7484486, 'f1': 0.5343047, 'auroc': 0.81710964, 'binary_precision': 0.11553785, 'binary_recall': 0.71900827, 'binary_specificity': 0.77788895, 'binary_f1_score': 0.19908468}
confusion matrix:
      0     1
0  4665  1332
1    68   174
early stop counter: 2
val acc:0.7111276984214783, best validation acc: 0.7825067639350891, corresponding to test acc:                         0.8507773876190186 / 0.8602340221405029
after epoch: 7,now: 2024-08-05 04:29:19.790041,epoch time: 0:16:48.420099,used: 2:02:10.024654,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89909786, 'precision': 0.8991624, 'recall': 0.8990991, 'specificity': 0.8990991, 'f1': 0.899094, 'auroc': 0.9643416, 'binary_precision': 0.90429044, 'binary_recall': 0.8927224, 'binary_specificity': 0.90547585, 'binary_f1_score': 0.8984692}
confusion matrix:
       0      1
0  26391   2755
1   3128  26030
---- Validation: 
scalar performance:
{'acc': 0.81201726, 'precision': 0.5267107, 'recall': 0.62905526, 'specificity': 0.62905526, 'f1': 0.511749, 'auroc': 0.6949794, 'binary_precision': 0.07567411, 'binary_recall': 0.43355483, 'binary_specificity': 0.82455564, 'binary_f1_score': 0.12885706}
confusion matrix:
       0     1
0  14983  3188
1    341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86359996, 'precision': 0.56632596, 'recall': 0.7149118, 'specificity': 0.7149118, 'f1': 0.5822905, 'auroc': 0.8058926, 'binary_precision': 0.15279362, 'binary_recall': 0.553719, 'binary_specificity': 0.8761047, 'binary_f1_score': 0.23949955}
confusion matrix:
      0    1
0  5254  743
1   108  134
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-05 04:46:04.884575,epoch time: 0:16:45.094534,used: 2:18:55.119188,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9023566, 'precision': 0.9026984, 'recall': 0.90235364, 'specificity': 0.90235364, 'f1': 0.9023354, 'auroc': 0.96811795, 'binary_precision': 0.89101815, 'binary_recall': 0.916901, 'binary_specificity': 0.88780624, 'binary_f1_score': 0.90377426}
confusion matrix:
       0      1
0  25876   3270
1   2423  26735
---- Validation: 
scalar performance:
{'acc': 0.77078784, 'precision': 0.5255041, 'recall': 0.6455008, 'specificity': 0.6455008, 'f1': 0.49667203, 'auroc': 0.68274266, 'binary_precision': 0.07134584, 'binary_recall': 0.5116279, 'binary_specificity': 0.7793737, 'binary_f1_score': 0.1252287}
confusion matrix:
       0     1
0  14162  4009
1    294   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81984293, 'precision': 0.55145437, 'recall': 0.70999515, 'specificity': 0.70999515, 'f1': 0.5506414, 'auroc': 0.79178846, 'binary_precision': 0.12243151, 'binary_recall': 0.59090906, 'binary_specificity': 0.8290812, 'binary_f1_score': 0.20283689}
confusion matrix:
      0     1
0  4972  1025
1    99   143
early stop counter: 1
val acc:0.7707878351211548, best validation acc: 0.8120172619819641, corresponding to test acc:                         0.863599956035614 / 0.863599956035614
after epoch: 9,now: 2024-08-05 05:02:52.204276,epoch time: 0:16:47.319701,used: 2:35:42.438889,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9084625, 'precision': 0.90864086, 'recall': 0.90846074, 'specificity': 0.90846074, 'f1': 0.9084523, 'auroc': 0.97033226, 'binary_precision': 0.90014786, 'binary_recall': 0.9188874, 'binary_specificity': 0.8980341, 'binary_f1_score': 0.909421}
confusion matrix:
       0      1
0  26175   2972
1   2365  26792
---- Validation: 
scalar performance:
{'acc': 0.7909764, 'precision': 0.52765685, 'recall': 0.647096, 'specificity': 0.647096, 'f1': 0.50633293, 'auroc': 0.70646393, 'binary_precision': 0.07584269, 'binary_recall': 0.49335548, 'binary_specificity': 0.8008365, 'binary_f1_score': 0.1314741}
confusion matrix:
       0     1
0  14552  3619
1    305   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549447, 'precision': 0.56552535, 'recall': 0.7262715, 'specificity': 0.7262715, 'f1': 0.5793448, 'auroc': 0.81560206, 'binary_precision': 0.1499472, 'binary_recall': 0.58677685, 'binary_specificity': 0.8657662, 'binary_f1_score': 0.23885618}
confusion matrix:
      0    1
0  5192  805
1   100  142
early stop counter: 2
val acc:0.7909764051437378, best validation acc: 0.8120172619819641, corresponding to test acc:                         0.863599956035614 / 0.863599956035614
after epoch: 10,now: 2024-08-05 05:19:50.732116,epoch time: 0:16:58.527840,used: 2:52:40.966729,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9024424, 'precision': 0.90451777, 'recall': 0.90244853, 'specificity': 0.90244853, 'f1': 0.902318, 'auroc': 0.9689632, 'binary_precision': 0.9335353, 'binary_recall': 0.86661863, 'binary_specificity': 0.9382784, 'binary_f1_score': 0.8988332}
confusion matrix:
       0      1
0  27348   1799
1   3889  25268
---- Validation: 
scalar performance:
{'acc': 0.86113036, 'precision': 0.5354418, 'recall': 0.6303339, 'specificity': 0.6303339, 'f1': 0.53746104, 'auroc': 0.727295, 'binary_precision': 0.093636, 'binary_recall': 0.38372093, 'binary_specificity': 0.8769468, 'binary_f1_score': 0.15053764}
confusion matrix:
       0     1
0  15935  2236
1    371   231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8958166, 'precision': 0.5833832, 'recall': 0.7098601, 'specificity': 0.7098601, 'f1': 0.60921603, 'auroc': 0.79029465, 'binary_precision': 0.1880734, 'binary_recall': 0.5082645, 'binary_specificity': 0.91145575, 'binary_f1_score': 0.2745536}
confusion matrix:
      0    1
0  5466  531
1   119  123
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-05 05:36:48.726202,epoch time: 0:16:57.994086,used: 3:09:38.960815,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9078108, 'precision': 0.909999, 'recall': 0.907802, 'specificity': 0.907802, 'f1': 0.9076863, 'auroc': 0.97258353, 'binary_precision': 0.8801061, 'binary_recall': 0.94430536, 'binary_specificity': 0.8712987, 'binary_f1_score': 0.9110762}
confusion matrix:
       0      1
0  25394   3751
1   1624  27535
---- Validation: 
scalar performance:
{'acc': 0.7974218, 'precision': 0.5336149, 'recall': 0.6769261, 'specificity': 0.6769261, 'f1': 0.51646465, 'auroc': 0.7297591, 'binary_precision': 0.08547009, 'binary_recall': 0.5481728, 'binary_specificity': 0.8056794, 'binary_f1_score': 0.1478826}
confusion matrix:
       0     1
0  14640  3531
1    272   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8541433, 'precision': 0.5637374, 'recall': 0.71990645, 'specificity': 0.71990645, 'f1': 0.57670224, 'auroc': 0.80789495, 'binary_precision': 0.14693446, 'binary_recall': 0.57438016, 'binary_specificity': 0.86543274, 'binary_f1_score': 0.23400675}
confusion matrix:
      0    1
0  5190  807
1   103  139
early stop counter: 1
val acc:0.7974218130111694, best validation acc: 0.8611303567886353, corresponding to test acc:                         0.8958166241645813 / 0.8958166241645813
after epoch: 12,now: 2024-08-05 05:53:25.674973,epoch time: 0:16:36.948771,used: 3:26:15.909586,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.90407175, 'precision': 0.90837735, 'recall': 0.9040612, 'specificity': 0.9040612, 'f1': 0.9038166, 'auroc': 0.97528917, 'binary_precision': 0.8664966, 'binary_recall': 0.95538104, 'binary_specificity': 0.85274136, 'binary_f1_score': 0.90877056}
confusion matrix:
       0      1
0  24854   4292
1   1301  27857
---- Validation: 
scalar performance:
{'acc': 0.7228466, 'precision': 0.52843904, 'recall': 0.68738914, 'specificity': 0.68738914, 'f1': 0.48290232, 'auroc': 0.73424655, 'binary_precision': 0.072636075, 'binary_recall': 0.6495017, 'binary_specificity': 0.7252765, 'binary_f1_score': 0.13065998}
confusion matrix:
       0     1
0  13179  4992
1    211   391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7752845, 'precision': 0.5554569, 'recall': 0.7760402, 'specificity': 0.7760402, 'f1': 0.54022276, 'auroc': 0.8491622, 'binary_precision': 0.122395836, 'binary_recall': 0.7768595, 'binary_specificity': 0.77522093, 'binary_f1_score': 0.21147357}
confusion matrix:
      0     1
0  4649  1348
1    54   188
early stop counter: 2
val acc:0.7228466272354126, best validation acc: 0.8611303567886353, corresponding to test acc:                         0.8958166241645813 / 0.8958166241645813
after epoch: 13,now: 2024-08-05 06:10:18.470737,epoch time: 0:16:52.795764,used: 3:43:08.705350,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9250137, 'precision': 0.92505574, 'recall': 0.9250146, 'specificity': 0.9250146, 'f1': 0.925012, 'auroc': 0.9783474, 'binary_precision': 0.9293262, 'binary_recall': 0.9200192, 'binary_specificity': 0.93000996, 'binary_f1_score': 0.92464924}
confusion matrix:
       0      1
0  27107   2040
1   2332  26825
---- Validation: 
scalar performance:
{'acc': 0.8545251, 'precision': 0.5413441, 'recall': 0.663059, 'specificity': 0.663059, 'f1': 0.544216, 'auroc': 0.73048556, 'binary_precision': 0.10294666, 'binary_recall': 0.45847178, 'binary_specificity': 0.8676463, 'binary_f1_score': 0.1681389}
confusion matrix:
       0     1
0  15766  2405
1    326   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8905273, 'precision': 0.58045113, 'recall': 0.7130569, 'specificity': 0.7130569, 'f1': 0.6051743, 'auroc': 0.79112077, 'binary_precision': 0.18181819, 'binary_recall': 0.5206612, 'binary_specificity': 0.9054527, 'binary_f1_score': 0.26951873}
confusion matrix:
      0    1
0  5430  567
1   116  126
early stop counter: 3
val acc:0.854525089263916, best validation acc: 0.8611303567886353, corresponding to test acc:                         0.8958166241645813 / 0.8958166241645813
after epoch: 14,now: 2024-08-05 06:27:05.448793,epoch time: 0:16:46.978056,used: 3:59:55.683406,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.91940516, 'precision': 0.920928, 'recall': 0.919399, 'specificity': 0.919399, 'f1': 0.91933143, 'auroc': 0.9790493, 'binary_precision': 0.8956615, 'binary_recall': 0.9494478, 'binary_specificity': 0.8893502, 'binary_f1_score': 0.9217707}
confusion matrix:
       0      1
0  25921   3225
1   1474  27684
---- Validation: 
scalar performance:
{'acc': 0.77600807, 'precision': 0.5245142, 'recall': 0.6369548, 'specificity': 0.6369548, 'f1': 0.49714687, 'auroc': 0.69386196, 'binary_precision': 0.07015032, 'binary_recall': 0.4883721, 'binary_specificity': 0.7855374, 'binary_f1_score': 0.12267891}
confusion matrix:
       0     1
0  14274  3897
1    308   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8284982, 'precision': 0.56607354, 'recall': 0.77001417, 'specificity': 0.77001417, 'f1': 0.5727585, 'auroc': 0.8430386, 'binary_precision': 0.14615385, 'binary_recall': 0.7066116, 'binary_specificity': 0.8334167, 'binary_f1_score': 0.24220963}
confusion matrix:
      0    1
0  4998  999
1    71  171
early stop counter: 4
val acc:0.7760080695152283, best validation acc: 0.8611303567886353, corresponding to test acc:                         0.8958166241645813 / 0.8958166241645813
after epoch: 15,now: 2024-08-05 06:43:44.318855,epoch time: 0:16:38.870062,used: 4:16:34.553468,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_02_27_09_seed_2_24067110
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:16:34.553468 at 2024-08-05 06:43:44.318855
persisted model performance metric: 

scalar performance:
{'acc': 0.8958166, 'precision': 0.5833832, 'recall': 0.7098601, 'specificity': 0.7098601, 'f1': 0.60921603, 'auroc': 0.79029465, 'binary_precision': 0.1880734, 'binary_recall': 0.5082645, 'binary_specificity': 0.91145575, 'binary_f1_score': 0.2745536}
confusion matrix:
      0    1
0  5466  531
1   119  123
oracle model performance metric: 

scalar performance:
{'acc': 0.8958166, 'precision': 0.5833832, 'recall': 0.7098601, 'specificity': 0.7098601, 'f1': 0.60921603, 'auroc': 0.79029465, 'binary_precision': 0.1880734, 'binary_recall': 0.5082645, 'binary_specificity': 0.91145575, 'binary_f1_score': 0.2745536}
confusion matrix:
      0    1
0  5466  531
1   119  123
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205613 KiB | 630912 KiB | 616990 GiB | 616989 GiB |
|       from large pool | 168576 KiB | 558188 KiB | 616119 GiB | 616119 GiB |
|       from small pool |  37037 KiB |  75475 KiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205613 KiB | 630912 KiB | 616990 GiB | 616989 GiB |
|       from large pool | 168576 KiB | 558188 KiB | 616119 GiB | 616119 GiB |
|       from small pool |  37037 KiB |  75475 KiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 625043 KiB | 610610 GiB | 610610 GiB |
|       from large pool | 165120 KiB | 553452 KiB | 609772 GiB | 609772 GiB |
|       from small pool |  35967 KiB |  74337 KiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 757760 KiB | 757760 KiB |   1724 MiB |    984 MiB |
|       from large pool | 681984 KiB | 681984 KiB |   1598 MiB |    932 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  29906 KiB | 171839 KiB | 372633 GiB | 372633 GiB |
|       from large pool |  15744 KiB | 170836 KiB | 371714 GiB | 371714 GiB |
|       from small pool |  14162 KiB |  19715 KiB |    919 GiB |    919 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    8057    |  135104 K  |  135101 K  |
|       from large pool |      36    |      76    |   41795 K  |   41795 K  |
|       from small pool |    3204    |    8019    |   93309 K  |   93306 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    8057    |  135104 K  |  135101 K  |
|       from large pool |      36    |      76    |   41795 K  |   41795 K  |
|       from small pool |    3204    |    8019    |   93309 K  |   93306 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      97    |      42    |
|       from large pool |      18    |      18    |      34    |      16    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3658    |   71842 K  |   71842 K  |
|       from large pool |       3    |      13    |   27408 K  |   27408 K  |
|       from small pool |      49    |    3655    |   44433 K  |   44433 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 630912 KiB | 616990 GiB | 616990 GiB |
|       from large pool |  16640 KiB | 558188 KiB | 616119 GiB | 616119 GiB |
|       from small pool |      0 KiB |  75475 KiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 630912 KiB | 616990 GiB | 616990 GiB |
|       from large pool |  16640 KiB | 558188 KiB | 616119 GiB | 616119 GiB |
|       from small pool |      0 KiB |  75475 KiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 625043 KiB | 610610 GiB | 610610 GiB |
|       from large pool |  16640 KiB | 553452 KiB | 609772 GiB | 609772 GiB |
|       from small pool |      0 KiB |  74337 KiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB | 757760 KiB |   1724 MiB |   1494 MiB |
|       from large pool | 184320 KiB | 681984 KiB |   1598 MiB |   1418 MiB |
|       from small pool |  51200 KiB |  75776 KiB |    126 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 171839 KiB | 372633 GiB | 372633 GiB |
|       from large pool |  24320 KiB | 170836 KiB | 371714 GiB | 371714 GiB |
|       from small pool |      0 KiB |  21757 KiB |    919 GiB |    919 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8057    |  135104 K  |  135104 K  |
|       from large pool |       2    |      76    |   41795 K  |   41795 K  |
|       from small pool |       0    |    8019    |   93309 K  |   93309 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8057    |  135104 K  |  135104 K  |
|       from large pool |       2    |      76    |   41795 K  |   41795 K  |
|       from small pool |       0    |    8019    |   93309 K  |   93309 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      55    |      97    |      63    |
|       from large pool |       9    |      18    |      34    |      25    |
|       from small pool |      25    |      37    |      63    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3658    |   71843 K  |   71843 K  |
|       from large pool |       3    |      13    |   27408 K  |   27408 K  |
|       from small pool |       0    |    3655    |   44434 K  |   44434 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 06:44:59 2024]
Finished job 0.
1 of 1 steps (100%) done
