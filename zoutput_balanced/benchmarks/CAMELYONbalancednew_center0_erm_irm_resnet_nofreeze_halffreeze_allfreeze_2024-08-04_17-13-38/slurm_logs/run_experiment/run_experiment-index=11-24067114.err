Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 17:16:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114

 Experiment start at: 2024-08-04 17:30:20.514226
before training, model accuracy: 0.31048259139060974
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9698919, 'precision': 0.9699036, 'recall': 0.96989375, 'specificity': 0.96989375, 'f1': 0.9698918, 'auroc': 0.9949305, 'binary_precision': 0.9724314, 'binary_recall': 0.96724737, 'binary_specificity': 0.97254014, 'binary_f1_score': 0.9698325}
confusion matrix:
       0      1
0  27873    787
1    940  27760
---- Validation: 
scalar performance:
{'acc': 0.93869734, 'precision': 0.63247913, 'recall': 0.7342455, 'specificity': 0.7342455, 'f1': 0.6663668, 'auroc': 0.8158128, 'binary_precision': 0.2826644, 'binary_recall': 0.5147745, 'binary_specificity': 0.95371646, 'binary_f1_score': 0.3649394}
confusion matrix:
       0    1
0  17309  840
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9335251, 'precision': 0.67029023, 'recall': 0.82972324, 'specificity': 0.82972324, 'f1': 0.7189705, 'auroc': 0.88583183, 'binary_precision': 0.35349718, 'binary_recall': 0.71647507, 'binary_specificity': 0.94297147, 'binary_f1_score': 0.4734177}
confusion matrix:
      0    1
0  5655  342
1    74  187
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 17:44:17.139787,epoch time: 0:13:56.625561,used: 0:13:56.625561,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.960408, 'precision': 0.9615329, 'recall': 0.96038747, 'specificity': 0.96038747, 'f1': 0.9603825, 'auroc': 0.99594796, 'binary_precision': 0.9389551, 'binary_recall': 0.984915, 'binary_specificity': 0.93585986, 'binary_f1_score': 0.9613861}
confusion matrix:
       0      1
0  26818   1838
1    433  28271
---- Validation: 
scalar performance:
{'acc': 0.8652618, 'precision': 0.5690641, 'recall': 0.75848144, 'specificity': 0.75848144, 'f1': 0.58622265, 'auroc': 0.80544424, 'binary_precision': 0.15237394, 'binary_recall': 0.64385694, 'binary_specificity': 0.87310594, 'binary_f1_score': 0.24642856}
confusion matrix:
       0     1
0  15846  2303
1    229   414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.809364, 'precision': 0.5790873, 'recall': 0.8418989, 'specificity': 0.8418989, 'f1': 0.58380276, 'auroc': 0.9151875, 'binary_precision': 0.1647482, 'binary_recall': 0.8773946, 'binary_specificity': 0.8064032, 'binary_f1_score': 0.27740762}
confusion matrix:
      0     1
0  4836  1161
1    32   229
early stop counter: 1
val acc:0.8652617931365967, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 2,now: 2024-08-04 17:54:33.893336,epoch time: 0:10:16.753549,used: 0:24:13.379110,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93769175, 'precision': 0.9416524, 'recall': 0.9376539, 'specificity': 0.9376539, 'f1': 0.93754804, 'auroc': 0.9942802, 'binary_precision': 0.90002865, 'binary_recall': 0.9848796, 'binary_specificity': 0.8904282, 'binary_f1_score': 0.94054437}
confusion matrix:
       0      1
0  25517   3140
1    434  28269
---- Validation: 
scalar performance:
{'acc': 0.752235, 'precision': 0.5240991, 'recall': 0.63621116, 'specificity': 0.63621116, 'f1': 0.48977062, 'auroc': 0.70377684, 'binary_precision': 0.0704346, 'binary_recall': 0.5116641, 'binary_specificity': 0.76075816, 'binary_f1_score': 0.123823866}
confusion matrix:
       0     1
0  13807  4342
1    314   329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5699904, 'precision': 0.5389737, 'recall': 0.7426558, 'specificity': 0.7426558, 'f1': 0.432414, 'auroc': 0.9205682, 'binary_precision': 0.083333336, 'binary_recall': 0.9310345, 'binary_specificity': 0.5542771, 'binary_f1_score': 0.15297452}
confusion matrix:
      0     1
0  3324  2673
1    18   243
early stop counter: 2
val acc:0.7522349953651428, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 3,now: 2024-08-04 18:04:42.925074,epoch time: 0:10:09.031738,used: 0:34:22.410848,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97142607, 'precision': 0.97178394, 'recall': 0.97141707, 'specificity': 0.97141707, 'f1': 0.9714203, 'auroc': 0.9973154, 'binary_precision': 0.9589552, 'binary_recall': 0.98505175, 'binary_specificity': 0.9577823, 'binary_f1_score': 0.9718284}
confusion matrix:
       0      1
0  27451   1210
1    429  28270
---- Validation: 
scalar performance:
{'acc': 0.8887293, 'precision': 0.5561724, 'recall': 0.66037273, 'specificity': 0.66037273, 'f1': 0.57180786, 'auroc': 0.76499486, 'binary_precision': 0.13471241, 'binary_recall': 0.41524106, 'binary_specificity': 0.90550447, 'binary_f1_score': 0.20342858}
confusion matrix:
       0     1
0  16434  1715
1    376   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90667945, 'precision': 0.63970023, 'recall': 0.87251866, 'specificity': 0.87251866, 'f1': 0.68832535, 'auroc': 0.9287325, 'binary_precision': 0.28722003, 'binary_recall': 0.83524907, 'binary_specificity': 0.90978825, 'binary_f1_score': 0.42745098}
confusion matrix:
      0    1
0  5456  541
1    43  218
early stop counter: 3
val acc:0.8887292742729187, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 4,now: 2024-08-04 18:14:47.075147,epoch time: 0:10:04.150073,used: 0:44:26.560921,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9759589, 'precision': 0.97598064, 'recall': 0.9759562, 'specificity': 0.9759562, 'f1': 0.97595847, 'auroc': 0.99645233, 'binary_precision': 0.97296363, 'binary_recall': 0.9791667, 'binary_specificity': 0.97274566, 'binary_f1_score': 0.9760553}
confusion matrix:
       0      1
0  27875    781
1    598  28106
---- Validation: 
scalar performance:
{'acc': 0.92539376, 'precision': 0.58700496, 'recall': 0.6636033, 'specificity': 0.6636033, 'f1': 0.6102425, 'auroc': 0.69817054, 'binary_precision': 0.19664268, 'binary_recall': 0.38258165, 'binary_specificity': 0.944625, 'binary_f1_score': 0.25976768}
confusion matrix:
       0     1
0  17144  1005
1    397   246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9260147, 'precision': 0.6649789, 'recall': 0.871613, 'specificity': 0.871613, 'f1': 0.7191008, 'auroc': 0.92152524, 'binary_precision': 0.33865815, 'binary_recall': 0.8122605, 'binary_specificity': 0.9309655, 'binary_f1_score': 0.47801578}
confusion matrix:
      0    1
0  5583  414
1    49  212
early stop counter: 4
val acc:0.9253937602043152, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 5,now: 2024-08-04 18:24:32.615107,epoch time: 0:09:45.539960,used: 0:54:12.100881,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9444909, 'precision': 0.9480505, 'recall': 0.9444476, 'specificity': 0.9444476, 'f1': 0.94437665, 'auroc': 0.99598014, 'binary_precision': 0.90835786, 'binary_recall': 0.9888533, 'binary_specificity': 0.9000419, 'binary_f1_score': 0.9468979}
confusion matrix:
       0      1
0  25788   2864
1    320  28388
---- Validation: 
scalar performance:
{'acc': 0.6587378, 'precision': 0.5084299, 'recall': 0.557054, 'specificity': 0.557054, 'f1': 0.4364029, 'auroc': 0.60182434, 'binary_precision': 0.045382917, 'binary_recall': 0.44790047, 'binary_specificity': 0.6662075, 'binary_f1_score': 0.08241522}
confusion matrix:
       0     1
0  12091  6058
1    355   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49536592, 'precision': 0.535772, 'recall': 0.72204304, 'specificity': 0.72204304, 'f1': 0.39067245, 'auroc': 0.9301497, 'binary_precision': 0.07434616, 'binary_recall': 0.96934867, 'binary_specificity': 0.47473738, 'binary_f1_score': 0.13810042}
confusion matrix:
      0     1
0  2847  3150
1     8   253
early stop counter: 5
val acc:0.6587377786636353, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 6,now: 2024-08-04 18:34:21.952424,epoch time: 0:09:49.337317,used: 1:04:01.438198,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9577406, 'precision': 0.9590129, 'recall': 0.9577205, 'specificity': 0.9577205, 'f1': 0.9577099, 'auroc': 0.99563646, 'binary_precision': 0.93503743, 'binary_recall': 0.9839036, 'binary_specificity': 0.93153745, 'binary_f1_score': 0.9588483}
confusion matrix:
       0      1
0  26696   1962
1    462  28240
---- Validation: 
scalar performance:
{'acc': 0.82833123, 'precision': 0.5318129, 'recall': 0.6336041, 'specificity': 0.6336041, 'f1': 0.5246704, 'auroc': 0.6255513, 'binary_precision': 0.087248325, 'binary_recall': 0.42457232, 'binary_specificity': 0.8426359, 'binary_f1_score': 0.14475079}
confusion matrix:
       0     1
0  15293  2856
1    370   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67497605, 'precision': 0.5503423, 'recall': 0.7901039, 'specificity': 0.7901039, 'f1': 0.493484, 'auroc': 0.93014836, 'binary_precision': 0.106175035, 'binary_recall': 0.91570884, 'binary_specificity': 0.6644989, 'binary_f1_score': 0.19028664}
confusion matrix:
      0     1
0  3985  2012
1    22   239
early stop counter: 6
val acc:0.8283312320709229, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 7,now: 2024-08-04 18:44:14.975245,epoch time: 0:09:53.022821,used: 1:13:54.461019,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9527022, 'precision': 0.9543151, 'recall': 0.9526795, 'specificity': 0.9526795, 'f1': 0.95265853, 'auroc': 0.9946978, 'binary_precision': 0.9274366, 'binary_recall': 0.98233575, 'binary_specificity': 0.9230232, 'binary_f1_score': 0.9540971}
confusion matrix:
       0      1
0  26452   2206
1    507  28195
---- Validation: 
scalar performance:
{'acc': 0.7936888, 'precision': 0.52407706, 'recall': 0.6171694, 'specificity': 0.6171694, 'f1': 0.50365454, 'auroc': 0.5835377, 'binary_precision': 0.072674416, 'binary_recall': 0.42768273, 'binary_specificity': 0.806656, 'binary_f1_score': 0.12423763}
confusion matrix:
       0     1
0  14640  3509
1    368   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6567593, 'precision': 0.5488844, 'recall': 0.78792846, 'specificity': 0.78792846, 'f1': 0.48357272, 'auroc': 0.9275149, 'binary_precision': 0.102402024, 'binary_recall': 0.9310345, 'binary_specificity': 0.6448224, 'binary_f1_score': 0.18451026}
confusion matrix:
      0     1
0  3867  2130
1    18   243
early stop counter: 7
val acc:0.7936887741088867, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 8,now: 2024-08-04 18:54:08.948367,epoch time: 0:09:53.973122,used: 1:23:48.434141,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9102859, 'precision': 0.92031085, 'recall': 0.9102241, 'specificity': 0.9102241, 'f1': 0.9097388, 'auroc': 0.99313724, 'binary_precision': 0.8555988, 'binary_recall': 0.98735327, 'binary_specificity': 0.8330949, 'binary_f1_score': 0.91676646}
confusion matrix:
       0      1
0  23874   4783
1    363  28340
---- Validation: 
scalar performance:
{'acc': 0.5338974, 'precision': 0.49889296, 'recall': 0.49167228, 'specificity': 0.49167228, 'f1': 0.37573004, 'auroc': 0.5602166, 'binary_precision': 0.033026468, 'binary_recall': 0.44634527, 'binary_specificity': 0.5369993, 'binary_f1_score': 0.0615022}
confusion matrix:
      0     1
0  9746  8403
1   356   287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.295302, 'precision': 0.5275286, 'recall': 0.6304838, 'specificity': 0.6304838, 'f1': 0.26207134, 'auroc': 0.8964773, 'binary_precision': 0.055686444, 'binary_recall': 0.99616855, 'binary_specificity': 0.26479906, 'binary_f1_score': 0.10547668}
confusion matrix:
      0     1
0  1588  4409
1     1   260
early stop counter: 8
val acc:0.5338973999023438, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 9,now: 2024-08-04 19:04:08.219710,epoch time: 0:09:59.271343,used: 1:33:47.705484,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94295675, 'precision': 0.94620484, 'recall': 0.94291973, 'specificity': 0.94291973, 'f1': 0.9428494, 'auroc': 0.99483216, 'binary_precision': 0.9083523, 'binary_recall': 0.98543805, 'binary_specificity': 0.90040135, 'binary_f1_score': 0.94532627}
confusion matrix:
       0      1
0  25801   2854
1    418  28287
---- Validation: 
scalar performance:
{'acc': 0.6911984, 'precision': 0.51105046, 'recall': 0.5708591, 'specificity': 0.5708591, 'f1': 0.4516189, 'auroc': 0.5832615, 'binary_precision': 0.049581006, 'binary_recall': 0.44167963, 'binary_specificity': 0.70003855, 'binary_f1_score': 0.089153975}
confusion matrix:
       0     1
0  12705  5444
1    359   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52348995, 'precision': 0.5384704, 'recall': 0.7403817, 'specificity': 0.7403817, 'f1': 0.407798, 'auroc': 0.89930195, 'binary_precision': 0.078922935, 'binary_recall': 0.9770115, 'binary_specificity': 0.5037519, 'binary_f1_score': 0.14604811}
confusion matrix:
      0     1
0  3021  2976
1     6   255
early stop counter: 9
val acc:0.6911984086036682, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 10,now: 2024-08-04 19:14:00.922336,epoch time: 0:09:52.702626,used: 1:43:40.408110,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9089958, 'precision': 0.9198612, 'recall': 0.9089286, 'specificity': 0.9089286, 'f1': 0.90839326, 'auroc': 0.99368167, 'binary_precision': 0.8525279, 'binary_recall': 0.9892698, 'binary_specificity': 0.82858735, 'binary_f1_score': 0.91582274}
confusion matrix:
       0      1
0  23744   4912
1    308  28396
---- Validation: 
scalar performance:
{'acc': 0.51787996, 'precision': 0.49760026, 'recall': 0.4818797, 'specificity': 0.4818797, 'f1': 0.3675431, 'auroc': 0.5413198, 'binary_precision': 0.031712472, 'binary_recall': 0.44323483, 'binary_specificity': 0.52052456, 'binary_f1_score': 0.05919003}
confusion matrix:
      0     1
0  9447  8702
1   358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37535954, 'precision': 0.5309508, 'recall': 0.6722547, 'specificity': 0.6722547, 'f1': 0.31701982, 'auroc': 0.8930528, 'binary_precision': 0.06238004, 'binary_recall': 0.99616855, 'binary_specificity': 0.34834084, 'binary_f1_score': 0.11740799}
confusion matrix:
      0     1
0  2089  3908
1     1   260
early stop counter: 10
val acc:0.5178799629211426, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 11,now: 2024-08-04 19:24:00.905820,epoch time: 0:09:59.983484,used: 1:53:40.391594,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9074268, 'precision': 0.9187496, 'recall': 0.9073552, 'specificity': 0.9073552, 'f1': 0.9067859, 'auroc': 0.9935268, 'binary_precision': 0.8501092, 'binary_recall': 0.9894792, 'binary_specificity': 0.8252312, 'binary_f1_score': 0.9145147}
confusion matrix:
       0      1
0  23647   5008
1    302  28403
---- Validation: 
scalar performance:
{'acc': 0.5416667, 'precision': 0.49972612, 'recall': 0.49794468, 'specificity': 0.49794468, 'f1': 0.3798603, 'auroc': 0.54925436, 'binary_precision': 0.033918127, 'binary_recall': 0.45101088, 'binary_specificity': 0.5448785, 'binary_f1_score': 0.06309148}
confusion matrix:
      0     1
0  9889  8260
1   353   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34787473, 'precision': 0.52969325, 'recall': 0.65791416, 'specificity': 0.65791416, 'f1': 0.2987078, 'auroc': 0.8671615, 'binary_precision': 0.059907835, 'binary_recall': 0.99616855, 'binary_specificity': 0.31965983, 'binary_f1_score': 0.11301891}
confusion matrix:
      0     1
0  1917  4080
1     1   260
early stop counter: 11
val acc:0.5416666865348816, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 12,now: 2024-08-04 19:33:52.969890,epoch time: 0:09:52.064070,used: 2:03:32.455664,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9109658, 'precision': 0.92168546, 'recall': 0.91091305, 'specificity': 0.91091305, 'f1': 0.9103887, 'auroc': 0.9951476, 'binary_precision': 0.8546176, 'binary_recall': 0.99055713, 'binary_specificity': 0.83126897, 'binary_f1_score': 0.91757977}
confusion matrix:
       0      1
0  23825   4836
1    271  28428
---- Validation: 
scalar performance:
{'acc': 0.7037037, 'precision': 0.51247096, 'recall': 0.57808334, 'specificity': 0.57808334, 'f1': 0.45789933, 'auroc': 0.5793142, 'binary_precision': 0.05186533, 'binary_recall': 0.44323483, 'binary_specificity': 0.7129319, 'binary_f1_score': 0.092864126}
confusion matrix:
       0     1
0  12939  5210
1    358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42361778, 'precision': 0.5314969, 'recall': 0.68643993, 'specificity': 0.68643993, 'f1': 0.34704858, 'auroc': 0.9082638, 'binary_precision': 0.065905556, 'binary_recall': 0.97318006, 'binary_specificity': 0.39969984, 'binary_f1_score': 0.12345079}
confusion matrix:
      0     1
0  2397  3600
1     7   254
early stop counter: 12
val acc:0.7037037014961243, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 13,now: 2024-08-04 19:43:44.513182,epoch time: 0:09:51.543292,used: 2:13:23.998956,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9023536, 'precision': 0.91553974, 'recall': 0.90229154, 'specificity': 0.90229154, 'f1': 0.9015628, 'auroc': 0.9943466, 'binary_precision': 0.8416911, 'binary_recall': 0.9912892, 'binary_specificity': 0.8132938, 'binary_f1_score': 0.91038543}
confusion matrix:
       0      1
0  23309   5351
1    250  28450
---- Validation: 
scalar performance:
{'acc': 0.5822691, 'precision': 0.50268453, 'recall': 0.5197152, 'specificity': 0.5197152, 'f1': 0.39987224, 'auroc': 0.5705431, 'binary_precision': 0.03736038, 'binary_recall': 0.4525661, 'binary_specificity': 0.5868643, 'binary_f1_score': 0.069022775}
confusion matrix:
       0     1
0  10651  7498
1    352   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36705017, 'precision': 0.5298632, 'recall': 0.66425455, 'specificity': 0.66425455, 'f1': 0.31126636, 'auroc': 0.8650272, 'binary_precision': 0.061195444, 'binary_recall': 0.9885057, 'binary_specificity': 0.34000334, 'binary_f1_score': 0.11525574}
confusion matrix:
      0     1
0  2039  3958
1     3   258
early stop counter: 13
val acc:0.5822690725326538, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 14,now: 2024-08-04 19:53:39.599283,epoch time: 0:09:55.086101,used: 2:23:19.085057,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.86725944, 'precision': 0.89254284, 'recall': 0.8671533, 'specificity': 0.8671533, 'f1': 0.8650631, 'auroc': 0.9903953, 'binary_precision': 0.7931284, 'binary_recall': 0.9940078, 'binary_specificity': 0.7402987, 'binary_f1_score': 0.8822784}
confusion matrix:
       0      1
0  21214   7442
1    172  28532
---- Validation: 
scalar performance:
{'acc': 0.37728822, 'precision': 0.48903054, 'recall': 0.42184424, 'specificity': 0.42184424, 'f1': 0.29307476, 'auroc': 0.51413196, 'binary_precision': 0.025893852, 'binary_recall': 0.4696734, 'binary_specificity': 0.3740151, 'binary_f1_score': 0.049081746}
confusion matrix:
      0      1
0  6788  11361
1   341    302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.10386705, 'precision': 0.5208791, 'recall': 0.53060055, 'specificity': 0.53060055, 'f1': 0.103480175, 'auroc': 0.79167396, 'binary_precision': 0.044315662, 'binary_recall': 0.99616855, 'binary_specificity': 0.06503252, 'binary_f1_score': 0.0848564}
confusion matrix:
     0     1
0  390  5607
1    1   260
early stop counter: 14
val acc:0.37728822231292725, best validation acc: 0.938697338104248, corresponding to test acc:                         0.9335250854492188 / 0.9335250854492188
after epoch: 15,now: 2024-08-04 20:03:36.418445,epoch time: 0:09:56.819162,used: 2:33:15.904219,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:15.904219 at 2024-08-04 20:03:36.418445
persisted model performance metric: 

scalar performance:
{'acc': 0.9335251, 'precision': 0.67029023, 'recall': 0.82972324, 'specificity': 0.82972324, 'f1': 0.7189705, 'auroc': 0.88583183, 'binary_precision': 0.35349718, 'binary_recall': 0.71647507, 'binary_specificity': 0.94297147, 'binary_f1_score': 0.4734177}
confusion matrix:
      0    1
0  5655  342
1    74  187
oracle model performance metric: 

scalar performance:
{'acc': 0.9335251, 'precision': 0.67029023, 'recall': 0.82972324, 'specificity': 0.82972324, 'f1': 0.7189705, 'auroc': 0.88583183, 'binary_precision': 0.35349718, 'binary_recall': 0.71647507, 'binary_specificity': 0.94297147, 'binary_f1_score': 0.4734177}
confusion matrix:
      0    1
0  5655  342
1    74  187
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 533599 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440491 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 533599 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440491 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522828 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool | 436736 KiB |   6277 MiB | 439102 GiB | 439102 GiB |
|       from small pool |  86092 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6564 MiB |   6564 MiB |   6564 MiB |      0 B   |
|       from large pool |   6440 MiB |   6440 MiB |   6440 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    932 MiB |   1266 MiB | 238382 GiB | 238381 GiB |
|       from large pool |    928 MiB |   1263 MiB | 237669 GiB | 237668 GiB |
|       from small pool |      4 MiB |     10 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3630    |    8317    |   53654 K  |   53650 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31488 K  |   31484 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3630    |    8317    |   53654 K  |   53650 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31488 K  |   31484 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     133    |     133    |       0    |
|       from large pool |      71    |      71    |      71    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3612    |   25028 K  |   25028 K  |
|       from large pool |      19    |      36    |    8794 K  |    8794 K  |
|       from small pool |      51    |    3594    |   16233 K  |   16233 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439102 GiB | 439102 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238382 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     27 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439102 GiB | 439102 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238382 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     27 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114

 Experiment start at: 2024-08-04 20:10:19.702015
before training, model accuracy: 0.14582662284374237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9628749, 'precision': 0.96288574, 'recall': 0.9628767, 'specificity': 0.9628767, 'f1': 0.96287477, 'auroc': 0.99268425, 'binary_precision': 0.9653056, 'binary_recall': 0.96031636, 'binary_specificity': 0.965437, 'binary_f1_score': 0.96280456}
confusion matrix:
       0      1
0  27793    995
1   1144  27684
---- Validation: 
scalar performance:
{'acc': 0.93527216, 'precision': 0.6122868, 'recall': 0.67460144, 'specificity': 0.67460144, 'f1': 0.6350655, 'auroc': 0.7784722, 'binary_precision': 0.24766356, 'binary_recall': 0.39375928, 'binary_specificity': 0.9554436, 'binary_f1_score': 0.30407342}
confusion matrix:
       0    1
0  17262  805
1    408  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.7226814, 'recall': 0.79205155, 'specificity': 0.79205155, 'f1': 0.7519139, 'auroc': 0.85428727, 'binary_precision': 0.46242774, 'binary_recall': 0.61538464, 'binary_specificity': 0.96871847, 'binary_f1_score': 0.5280528}
confusion matrix:
      0    1
0  5760  186
1   100  160
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 20:21:43.196720,epoch time: 0:11:23.494705,used: 0:11:23.494705,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9359032, 'precision': 0.940977, 'recall': 0.9358642, 'specificity': 0.9358642, 'f1': 0.93571436, 'auroc': 0.9940571, 'binary_precision': 0.8938577, 'binary_recall': 0.98938566, 'binary_specificity': 0.8823427, 'binary_f1_score': 0.9391989}
confusion matrix:
       0      1
0  25400   3387
1    306  28523
---- Validation: 
scalar performance:
{'acc': 0.7108324, 'precision': 0.53111315, 'recall': 0.68909526, 'specificity': 0.68909526, 'f1': 0.48400173, 'auroc': 0.73344237, 'binary_precision': 0.079404466, 'binary_recall': 0.66567606, 'binary_specificity': 0.7125145, 'binary_f1_score': 0.1418844}
confusion matrix:
       0     1
0  12873  5194
1    225   448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68030936, 'precision': 0.5510434, 'recall': 0.79086846, 'specificity': 0.79086846, 'f1': 0.49676144, 'auroc': 0.91503143, 'binary_precision': 0.107825294, 'binary_recall': 0.9115385, 'binary_specificity': 0.67019844, 'binary_f1_score': 0.19283971}
confusion matrix:
      0     1
0  3985  1961
1    23   237
early stop counter: 1
val acc:0.710832417011261, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 2,now: 2024-08-04 20:31:41.574224,epoch time: 0:09:58.377504,used: 0:21:21.872209,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96705776, 'precision': 0.96741295, 'recall': 0.96704733, 'specificity': 0.96704733, 'f1': 0.967051, 'auroc': 0.9955623, 'binary_precision': 0.95471734, 'binary_recall': 0.98067987, 'binary_specificity': 0.95341486, 'binary_f1_score': 0.9675245}
confusion matrix:
       0      1
0  27445   1341
1    557  28273
---- Validation: 
scalar performance:
{'acc': 0.8752935, 'precision': 0.54866606, 'recall': 0.6456408, 'specificity': 0.6456408, 'f1': 0.5595174, 'auroc': 0.6914064, 'binary_precision': 0.121818185, 'binary_recall': 0.39821693, 'binary_specificity': 0.8930647, 'binary_f1_score': 0.18656455}
confusion matrix:
       0     1
0  16135  1932
1    405   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8454721, 'precision': 0.5929949, 'recall': 0.84763706, 'specificity': 0.84763706, 'f1': 0.61419713, 'auroc': 0.91912985, 'binary_precision': 0.19368975, 'binary_recall': 0.85, 'binary_specificity': 0.84527415, 'binary_f1_score': 0.31548893}
confusion matrix:
      0    1
0  5026  920
1    39  221
early stop counter: 2
val acc:0.875293493270874, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 3,now: 2024-08-04 20:41:40.947747,epoch time: 0:09:59.373523,used: 0:31:21.245732,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.936476, 'precision': 0.9408057, 'recall': 0.93643993, 'specificity': 0.93643993, 'f1': 0.936316, 'auroc': 0.9944413, 'binary_precision': 0.8973007, 'binary_recall': 0.9858823, 'binary_specificity': 0.8869976, 'binary_f1_score': 0.93950814}
confusion matrix:
       0      1
0  25534   3253
1    407  28422
---- Validation: 
scalar performance:
{'acc': 0.6223586, 'precision': 0.50468296, 'recall': 0.53162885, 'specificity': 0.53162885, 'f1': 0.41944915, 'auroc': 0.5854921, 'binary_precision': 0.04178592, 'binary_recall': 0.43387815, 'binary_specificity': 0.6293795, 'binary_f1_score': 0.07623026}
confusion matrix:
       0     1
0  11371  6696
1    381   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49935547, 'precision': 0.53529733, 'recall': 0.71850306, 'specificity': 0.71850306, 'f1': 0.39267695, 'auroc': 0.9281826, 'binary_precision': 0.07443946, 'binary_recall': 0.9576923, 'binary_specificity': 0.47931382, 'binary_f1_score': 0.13814147}
confusion matrix:
      0     1
0  2850  3096
1    11   249
early stop counter: 3
val acc:0.6223586201667786, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 4,now: 2024-08-04 20:51:35.121192,epoch time: 0:09:54.173445,used: 0:41:15.419177,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9295508, 'precision': 0.9349358, 'recall': 0.92951226, 'specificity': 0.92951226, 'f1': 0.9293277, 'auroc': 0.99394774, 'binary_precision': 0.8867135, 'binary_recall': 0.98504925, 'binary_specificity': 0.8739753, 'binary_f1_score': 0.9332983}
confusion matrix:
       0      1
0  25160   3628
1    431  28397
---- Validation: 
scalar performance:
{'acc': 0.5559765, 'precision': 0.49950606, 'recall': 0.4964862, 'specificity': 0.4964862, 'f1': 0.3870965, 'auroc': 0.54667723, 'binary_precision': 0.035358444, 'binary_recall': 0.43239227, 'binary_specificity': 0.5605801, 'binary_f1_score': 0.06537122}
confusion matrix:
       0     1
0  10128  7939
1    382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.2755398, 'precision': 0.52558696, 'recall': 0.6145748, 'specificity': 0.6145748, 'f1': 0.24749854, 'auroc': 0.9161595, 'binary_precision': 0.053917438, 'binary_recall': 0.9846154, 'binary_specificity': 0.24453413, 'binary_f1_score': 0.10223642}
confusion matrix:
      0     1
0  1454  4492
1     4   256
early stop counter: 4
val acc:0.5559765100479126, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 5,now: 2024-08-04 21:01:22.663966,epoch time: 0:09:47.542774,used: 0:51:02.961951,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88525754, 'precision': 0.90296304, 'recall': 0.8851849, 'specificity': 0.8851849, 'f1': 0.8839693, 'auroc': 0.99256206, 'binary_precision': 0.8186695, 'binary_recall': 0.98994035, 'binary_specificity': 0.78042936, 'binary_f1_score': 0.8961955}
confusion matrix:
       0      1
0  22467   6321
1    290  28538
---- Validation: 
scalar performance:
{'acc': 0.46873, 'precision': 0.49461696, 'recall': 0.46125168, 'specificity': 0.46125168, 'f1': 0.34390667, 'auroc': 0.5519272, 'binary_precision': 0.03082988, 'binary_recall': 0.45319465, 'binary_specificity': 0.46930867, 'binary_f1_score': 0.05773235}
confusion matrix:
      0     1
0  8479  9588
1   368   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.14695457, 'precision': 0.5225604, 'recall': 0.55298775, 'specificity': 0.55298775, 'f1': 0.14350237, 'auroc': 0.9197521, 'binary_precision': 0.046649855, 'binary_recall': 0.99615383, 'binary_specificity': 0.10982173, 'binary_f1_score': 0.089125946}
confusion matrix:
     0     1
0  653  5293
1    1   259
early stop counter: 5
val acc:0.46873000264167786, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 6,now: 2024-08-04 21:11:11.685087,epoch time: 0:09:49.021121,used: 1:00:51.983072,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9167245, 'precision': 0.9252895, 'recall': 0.9166753, 'specificity': 0.9166753, 'f1': 0.9162965, 'auroc': 0.99405265, 'binary_precision': 0.8651088, 'binary_recall': 0.9875468, 'binary_specificity': 0.8458038, 'binary_f1_score': 0.9222819}
confusion matrix:
       0      1
0  24349   4439
1    359  28469
---- Validation: 
scalar performance:
{'acc': 0.5643543, 'precision': 0.5011266, 'recall': 0.5079838, 'specificity': 0.5079838, 'f1': 0.39217663, 'auroc': 0.55971855, 'binary_precision': 0.037192635, 'binary_recall': 0.4472511, 'binary_specificity': 0.56871647, 'binary_f1_score': 0.06867442}
confusion matrix:
       0     1
0  10275  7792
1    372   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.23461166, 'precision': 0.5254413, 'recall': 0.5987328, 'specificity': 0.5987328, 'f1': 0.21671796, 'auroc': 0.8979262, 'binary_precision': 0.05171725, 'binary_recall': 0.99615383, 'binary_specificity': 0.20131181, 'binary_f1_score': 0.09832954}
confusion matrix:
      0     1
0  1197  4749
1     1   259
early stop counter: 6
val acc:0.5643543004989624, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 7,now: 2024-08-04 21:21:07.160157,epoch time: 0:09:55.475070,used: 1:10:47.458142,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.935209, 'precision': 0.9384332, 'recall': 0.9351763, 'specificity': 0.9351763, 'f1': 0.93508625, 'auroc': 0.9924443, 'binary_precision': 0.90102583, 'binary_recall': 0.97793967, 'binary_specificity': 0.89241296, 'binary_f1_score': 0.93790853}
confusion matrix:
       0      1
0  25689   3097
1    636  28194
---- Validation: 
scalar performance:
{'acc': 0.7227321, 'precision': 0.5130325, 'recall': 0.5743866, 'specificity': 0.5743866, 'f1': 0.46659935, 'auroc': 0.5439708, 'binary_precision': 0.05491045, 'binary_recall': 0.41456166, 'binary_specificity': 0.73421156, 'binary_f1_score': 0.09697602}
confusion matrix:
       0     1
0  13265  4802
1    394   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46728972, 'precision': 0.5324489, 'recall': 0.69809115, 'specificity': 0.69809115, 'f1': 0.37305853, 'auroc': 0.91340005, 'binary_precision': 0.06977401, 'binary_recall': 0.95, 'binary_specificity': 0.4461823, 'binary_f1_score': 0.13}
confusion matrix:
      0     1
0  2653  3293
1    13   247
early stop counter: 7
val acc:0.7227321267127991, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 8,now: 2024-08-04 21:31:06.114753,epoch time: 0:09:58.954596,used: 1:20:46.412738,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92778045, 'precision': 0.9335296, 'recall': 0.9277406, 'specificity': 0.9277406, 'f1': 0.92753565, 'auroc': 0.9940369, 'binary_precision': 0.8837788, 'binary_recall': 0.9852227, 'binary_specificity': 0.87025845, 'binary_f1_score': 0.93174773}
confusion matrix:
       0      1
0  25053   3735
1    426  28402
---- Validation: 
scalar performance:
{'acc': 0.6155283, 'precision': 0.50444263, 'recall': 0.53023225, 'specificity': 0.53023225, 'f1': 0.4164872, 'auroc': 0.5580925, 'binary_precision': 0.041420948, 'binary_recall': 0.4383358, 'binary_specificity': 0.6221287, 'binary_f1_score': 0.07568955}
confusion matrix:
       0     1
0  11240  6827
1    378   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.29036418, 'precision': 0.52578497, 'recall': 0.6204721, 'specificity': 0.6204721, 'f1': 0.25821424, 'auroc': 0.90744716, 'binary_precision': 0.054791577, 'binary_recall': 0.9807692, 'binary_specificity': 0.2601749, 'binary_f1_score': 0.103785105}
confusion matrix:
      0     1
0  1547  4399
1     5   255
early stop counter: 8
val acc:0.6155282855033875, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 9,now: 2024-08-04 21:41:05.397564,epoch time: 0:09:59.282811,used: 1:30:45.695549,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8790961, 'precision': 0.8991934, 'recall': 0.8790144, 'specificity': 0.8790144, 'f1': 0.8775385, 'auroc': 0.9925461, 'binary_precision': 0.80980587, 'binary_recall': 0.99115473, 'binary_specificity': 0.76687396, 'binary_f1_score': 0.89134985}
confusion matrix:
       0      1
0  22076   6711
1    255  28574
---- Validation: 
scalar performance:
{'acc': 0.37956244, 'precision': 0.4882714, 'recall': 0.42001402, 'specificity': 0.42001402, 'f1': 0.29503804, 'auroc': 0.53911126, 'binary_precision': 0.026947659, 'binary_recall': 0.46359584, 'binary_specificity': 0.37643218, 'binary_f1_score': 0.050934616}
confusion matrix:
      0      1
0  6801  11266
1   361    312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.10634869, 'precision': 0.5223906, 'recall': 0.53363603, 'specificity': 0.53363603, 'f1': 0.10589369, 'auroc': 0.9207885, 'binary_precision': 0.04478126, 'binary_recall': 1.0, 'binary_specificity': 0.06727212, 'binary_f1_score': 0.085723706}
confusion matrix:
     0     1
0  400  5546
1    0   260
early stop counter: 9
val acc:0.3795624375343323, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 10,now: 2024-08-04 21:51:01.613950,epoch time: 0:09:56.216386,used: 1:40:41.911935,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.88032836, 'precision': 0.8988203, 'recall': 0.88024616, 'specificity': 0.88024616, 'f1': 0.87890846, 'auroc': 0.99134547, 'binary_precision': 0.8131335, 'binary_recall': 0.98785985, 'binary_specificity': 0.77263254, 'binary_f1_score': 0.892021}
confusion matrix:
       0      1
0  22241   6545
1    350  28480
---- Validation: 
scalar performance:
{'acc': 0.44300961, 'precision': 0.4926025, 'recall': 0.44719714, 'specificity': 0.44719714, 'f1': 0.33008617, 'auroc': 0.5465456, 'binary_precision': 0.029306855, 'binary_recall': 0.45170876, 'binary_specificity': 0.44268554, 'binary_f1_score': 0.05504255}
confusion matrix:
      0      1
0  7998  10069
1   369    304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.20496294, 'precision': 0.52387124, 'recall': 0.58142126, 'specificity': 0.58142126, 'f1': 0.19298726, 'auroc': 0.8718033, 'binary_precision': 0.04971098, 'binary_recall': 0.99230766, 'binary_specificity': 0.17053482, 'binary_f1_score': 0.09467889}
confusion matrix:
      0     1
0  1014  4932
1     2   258
early stop counter: 10
val acc:0.443009614944458, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 11,now: 2024-08-04 22:00:42.111699,epoch time: 0:09:40.497749,used: 1:50:22.409684,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8636837, 'precision': 0.8885478, 'recall': 0.86359155, 'specificity': 0.86359155, 'f1': 0.861446, 'auroc': 0.990533, 'binary_precision': 0.7904401, 'binary_recall': 0.9900448, 'binary_specificity': 0.7371383, 'binary_f1_score': 0.8790539}
confusion matrix:
       0      1
0  21220   7567
1    287  28542
---- Validation: 
scalar performance:
{'acc': 0.40928495, 'precision': 0.49026355, 'recall': 0.43185252, 'specificity': 0.43185252, 'f1': 0.3117071, 'auroc': 0.5415572, 'binary_precision': 0.027881209, 'binary_recall': 0.45616642, 'binary_specificity': 0.4075386, 'binary_f1_score': 0.052550495}
confusion matrix:
      0      1
0  7363  10704
1   366    307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.114405416, 'precision': 0.52258515, 'recall': 0.53784055, 'specificity': 0.53784055, 'f1': 0.11357456, 'auroc': 0.886062, 'binary_precision': 0.04517026, 'binary_recall': 1.0, 'binary_specificity': 0.07568113, 'binary_f1_score': 0.08643617}
confusion matrix:
     0     1
0  450  5496
1    0   260
early stop counter: 11
val acc:0.40928494930267334, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 12,now: 2024-08-04 22:10:34.909592,epoch time: 0:09:52.797893,used: 2:00:15.207577,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.89174885, 'precision': 0.9054551, 'recall': 0.891685, 'specificity': 0.891685, 'f1': 0.8908148, 'auroc': 0.99042046, 'binary_precision': 0.8310813, 'binary_recall': 0.98355764, 'binary_specificity': 0.79981244, 'binary_f1_score': 0.9009135}
confusion matrix:
       0      1
0  23025   5763
1    474  28354
---- Validation: 
scalar performance:
{'acc': 0.53836715, 'precision': 0.4992337, 'recall': 0.49450618, 'specificity': 0.49450618, 'f1': 0.3792902, 'auroc': 0.54814476, 'binary_precision': 0.035081584, 'binary_recall': 0.4472511, 'binary_specificity': 0.5417612, 'binary_f1_score': 0.06505998}
confusion matrix:
      0     1
0  9788  8279
1   372   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.29874316, 'precision': 0.52614677, 'recall': 0.62484473, 'specificity': 0.62484473, 'f1': 0.26423562, 'auroc': 0.7986995, 'binary_precision': 0.05541069, 'binary_recall': 0.9807692, 'binary_specificity': 0.26892027, 'binary_f1_score': 0.10489511}
confusion matrix:
      0     1
0  1599  4347
1     5   255
early stop counter: 12
val acc:0.5383671522140503, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 13,now: 2024-08-04 22:20:30.184934,epoch time: 0:09:55.275342,used: 2:10:10.482919,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90054846, 'precision': 0.91280675, 'recall': 0.9004857, 'specificity': 0.9004857, 'f1': 0.89979434, 'auroc': 0.9923576, 'binary_precision': 0.8418529, 'binary_recall': 0.986576, 'binary_specificity': 0.81439537, 'binary_f1_score': 0.90848684}
confusion matrix:
       0      1
0  23444   5343
1    387  28442
---- Validation: 
scalar performance:
{'acc': 0.5004269, 'precision': 0.49671203, 'recall': 0.47625995, 'specificity': 0.47625995, 'f1': 0.36025333, 'auroc': 0.5532372, 'binary_precision': 0.03259817, 'binary_recall': 0.45022288, 'binary_specificity': 0.502297, 'binary_f1_score': 0.060794543}
confusion matrix:
      0     1
0  9075  8992
1   370   303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.2413793, 'precision': 0.524691, 'recall': 0.5985867, 'specificity': 0.5985867, 'f1': 0.22181569, 'auroc': 0.9040056, 'binary_precision': 0.05179363, 'binary_recall': 0.98846155, 'binary_specificity': 0.20871174, 'binary_f1_score': 0.09842972}
confusion matrix:
      0     1
0  1241  4705
1     3   257
early stop counter: 13
val acc:0.5004268884658813, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 14,now: 2024-08-04 22:30:33.314914,epoch time: 0:10:03.129980,used: 2:20:13.612899,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.89412665, 'precision': 0.908677, 'recall': 0.8940612, 'specificity': 0.8940612, 'f1': 0.8931644, 'auroc': 0.9929715, 'binary_precision': 0.8317375, 'binary_recall': 0.98834467, 'binary_specificity': 0.7997777, 'binary_f1_score': 0.90330356}
confusion matrix:
       0      1
0  23024   5764
1    336  28492
---- Validation: 
scalar performance:
{'acc': 0.5462113, 'precision': 0.49940023, 'recall': 0.4957133, 'specificity': 0.4957133, 'f1': 0.38283128, 'auroc': 0.56333196, 'binary_precision': 0.035252225, 'binary_recall': 0.44130757, 'binary_specificity': 0.550119, 'binary_f1_score': 0.06528907}
confusion matrix:
      0     1
0  9939  8128
1   376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38076055, 'precision': 0.5299676, 'recall': 0.66764665, 'specificity': 0.66764665, 'f1': 0.3201512, 'auroc': 0.87725747, 'binary_precision': 0.06230149, 'binary_recall': 0.9807692, 'binary_specificity': 0.35452405, 'binary_f1_score': 0.11716058}
confusion matrix:
      0     1
0  2108  3838
1     5   255
early stop counter: 14
val acc:0.546211302280426, best validation acc: 0.9352721571922302, corresponding to test acc:                         0.953915536403656 / 0.953915536403656
after epoch: 15,now: 2024-08-04 22:40:52.072201,epoch time: 0:10:18.757287,used: 2:30:32.370186,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_19_seed_1_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:30:32.370186 at 2024-08-04 22:40:52.072201
persisted model performance metric: 

scalar performance:
{'acc': 0.95391554, 'precision': 0.7226814, 'recall': 0.79205155, 'specificity': 0.79205155, 'f1': 0.7519139, 'auroc': 0.85428727, 'binary_precision': 0.46242774, 'binary_recall': 0.61538464, 'binary_specificity': 0.96871847, 'binary_f1_score': 0.5280528}
confusion matrix:
      0    1
0  5760  186
1   100  160
oracle model performance metric: 

scalar performance:
{'acc': 0.95391554, 'precision': 0.7226814, 'recall': 0.79205155, 'specificity': 0.79205155, 'f1': 0.7519139, 'auroc': 0.85428727, 'binary_precision': 0.46242774, 'binary_recall': 0.61538464, 'binary_specificity': 0.96871847, 'binary_f1_score': 0.5280528}
confusion matrix:
      0    1
0  5760  186
1   100  160
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522826 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool | 436736 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |  86090 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  11654 MiB |   5110 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  11498 MiB |   5076 MiB |
|       from small pool |    122 MiB |    124 MiB |    156 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1063 MiB |   1463 MiB | 479146 GiB | 479144 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 477676 GiB | 477675 GiB |
|       from small pool |      8 MiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3606    |    8349    |  107888 K  |  107885 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63242 K  |   63239 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3606    |    8349    |  107888 K  |  107885 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63242 K  |   63239 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     195    |      65    |
|       from large pool |      69    |      71    |     117    |      48    |
|       from small pool |      61    |      62    |      78    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3630    |   50634 K  |   50634 K  |
|       from large pool |      21    |      36    |   17922 K  |   17922 K  |
|       from small pool |      54    |    3610    |   32711 K  |   32711 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1586 MiB |   6564 MiB |  11654 MiB |  10068 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     94 MiB |    124 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     133    |     195    |     124    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      47    |      62    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50635 K  |   50635 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32712 K  |   32712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1586 MiB |   6564 MiB |  11654 MiB |  10068 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     94 MiB |    124 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     27 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     133    |     195    |     124    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      47    |      62    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50635 K  |   50635 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32712 K  |   32712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114

 Experiment start at: 2024-08-04 22:47:49.360350
before training, model accuracy: 0.054656196385622025
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96483946, 'precision': 0.96529114, 'recall': 0.96483684, 'specificity': 0.96483684, 'f1': 0.96483076, 'auroc': 0.99514085, 'binary_precision': 0.9508366, 'binary_recall': 0.9803821, 'binary_specificity': 0.9492915, 'binary_f1_score': 0.96538335}
confusion matrix:
       0      1
0  27669   1478
1    572  28585
---- Validation: 
scalar performance:
{'acc': 0.86746925, 'precision': 0.5708923, 'recall': 0.7829753, 'specificity': 0.7829753, 'f1': 0.589178, 'auroc': 0.84031093, 'binary_precision': 0.15330882, 'binary_recall': 0.692691, 'binary_specificity': 0.8732596, 'binary_f1_score': 0.25105357}
confusion matrix:
       0     1
0  15868  2303
1    185   417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8684084, 'precision': 0.59854764, 'recall': 0.85025674, 'specificity': 0.85025674, 'f1': 0.62787724, 'auroc': 0.90669715, 'binary_precision': 0.20489296, 'binary_recall': 0.8305785, 'binary_specificity': 0.869935, 'binary_f1_score': 0.32869992}
confusion matrix:
      0    1
0  5217  780
1    41  201
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 22:59:20.224256,epoch time: 0:11:30.863906,used: 0:11:30.863906,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97206026, 'precision': 0.97206175, 'recall': 0.9720601, 'specificity': 0.9720601, 'f1': 0.9720602, 'auroc': 0.9953935, 'binary_precision': 0.97123975, 'binary_recall': 0.97293866, 'binary_specificity': 0.9711816, 'binary_f1_score': 0.9720885}
confusion matrix:
       0      1
0  28308    840
1    789  28367
---- Validation: 
scalar performance:
{'acc': 0.91834015, 'precision': 0.57062435, 'recall': 0.65506816, 'specificity': 0.65506816, 'f1': 0.59191114, 'auroc': 0.6892712, 'binary_precision': 0.16292542, 'binary_recall': 0.37375414, 'binary_specificity': 0.9363822, 'binary_f1_score': 0.2269289}
confusion matrix:
       0     1
0  17015  1156
1    377   225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91969866, 'precision': 0.64836717, 'recall': 0.87693673, 'specificity': 0.87693673, 'f1': 0.7009499, 'auroc': 0.9236381, 'binary_precision': 0.30408472, 'binary_recall': 0.8305785, 'binary_specificity': 0.92329496, 'binary_f1_score': 0.4451827}
confusion matrix:
      0    1
0  5537  460
1    41  201
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 23:09:32.828763,epoch time: 0:10:12.604507,used: 0:21:43.468413,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9678924, 'precision': 0.9684001, 'recall': 0.96788794, 'specificity': 0.96788794, 'f1': 0.96788347, 'auroc': 0.99614584, 'binary_precision': 0.9530482, 'binary_recall': 0.9842936, 'binary_specificity': 0.9514823, 'binary_f1_score': 0.96841896}
confusion matrix:
       0      1
0  27730   1414
1    458  28702
---- Validation: 
scalar performance:
{'acc': 0.8553774, 'precision': 0.5409473, 'recall': 0.660287, 'specificity': 0.660287, 'f1': 0.5438689, 'auroc': 0.73397267, 'binary_precision': 0.1023711, 'binary_recall': 0.45182723, 'binary_specificity': 0.8687469, 'binary_f1_score': 0.16692238}
confusion matrix:
       0     1
0  15786  2385
1    330   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84260297, 'precision': 0.58773875, 'recall': 0.8566607, 'specificity': 0.8566607, 'f1': 0.60594684, 'auroc': 0.92683804, 'binary_precision': 0.18158348, 'binary_recall': 0.8719008, 'binary_specificity': 0.8414207, 'binary_f1_score': 0.3005698}
confusion matrix:
      0    1
0  5046  951
1    31  211
early stop counter: 1
val acc:0.8553773760795593, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 3,now: 2024-08-04 23:19:43.389872,epoch time: 0:10:10.561109,used: 0:31:54.029522,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9691102, 'precision': 0.9693227, 'recall': 0.9691076, 'specificity': 0.9691076, 'f1': 0.96910655, 'auroc': 0.9953053, 'binary_precision': 0.95939684, 'binary_recall': 0.9796975, 'binary_specificity': 0.95851773, 'binary_f1_score': 0.96944094}
confusion matrix:
       0      1
0  27936   1209
1    592  28567
---- Validation: 
scalar performance:
{'acc': 0.8767379, 'precision': 0.54444796, 'recall': 0.6480327, 'specificity': 0.6480327, 'f1': 0.55348694, 'auroc': 0.6011734, 'binary_precision': 0.11055505, 'binary_recall': 0.4036545, 'binary_specificity': 0.892411, 'binary_f1_score': 0.17357144}
confusion matrix:
       0     1
0  16216  1955
1    359   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79980767, 'precision': 0.5699058, 'recall': 0.8304342, 'specificity': 0.8304342, 'f1': 0.5676097, 'auroc': 0.921059, 'binary_precision': 0.14666666, 'binary_recall': 0.8636364, 'binary_specificity': 0.797232, 'binary_f1_score': 0.25074986}
confusion matrix:
      0     1
0  4781  1216
1    33   209
early stop counter: 2
val acc:0.8767378926277161, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 4,now: 2024-08-04 23:29:56.358990,epoch time: 0:10:12.969118,used: 0:42:06.998640,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9648052, 'precision': 0.9653012, 'recall': 0.9648029, 'specificity': 0.9648029, 'f1': 0.96479565, 'auroc': 0.9952622, 'binary_precision': 0.9501428, 'binary_recall': 0.98110163, 'binary_specificity': 0.9485042, 'binary_f1_score': 0.9653741}
confusion matrix:
       0      1
0  27647   1501
1    551  28605
---- Validation: 
scalar performance:
{'acc': 0.88158524, 'precision': 0.5471056, 'recall': 0.65133977, 'specificity': 0.65133977, 'f1': 0.5580961, 'auroc': 0.61821675, 'binary_precision': 0.11569464, 'binary_recall': 0.4053156, 'binary_specificity': 0.89736396, 'binary_f1_score': 0.18000737}
confusion matrix:
       0     1
0  16306  1865
1    358   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8579901, 'precision': 0.59521204, 'recall': 0.8606993, 'specificity': 0.8606993, 'f1': 0.62063044, 'auroc': 0.92520154, 'binary_precision': 0.19679849, 'binary_recall': 0.8636364, 'binary_specificity': 0.8577622, 'binary_f1_score': 0.32055214}
confusion matrix:
      0    1
0  5144  853
1    33  209
early stop counter: 3
val acc:0.8815852403640747, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 5,now: 2024-08-04 23:39:59.430387,epoch time: 0:10:03.071397,used: 0:52:10.070037,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9173642, 'precision': 0.9258387, 'recall': 0.91734964, 'specificity': 0.91734964, 'f1': 0.91694903, 'auroc': 0.9939226, 'binary_precision': 0.865817, 'binary_recall': 0.98785925, 'binary_specificity': 0.84684, 'binary_f1_score': 0.92282057}
confusion matrix:
       0      1
0  24682   4464
1    354  28804
---- Validation: 
scalar performance:
{'acc': 0.66627604, 'precision': 0.50878006, 'recall': 0.56260395, 'specificity': 0.56260395, 'f1': 0.43803415, 'auroc': 0.5589599, 'binary_precision': 0.04382149, 'binary_recall': 0.45182723, 'binary_specificity': 0.6733807, 'binary_f1_score': 0.07989426}
confusion matrix:
       0     1
0  12236  5935
1    330   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3849976, 'precision': 0.52830863, 'recall': 0.6721591, 'specificity': 0.6721591, 'f1': 0.3202157, 'auroc': 0.9296094, 'binary_precision': 0.058462296, 'binary_recall': 0.9834711, 'binary_specificity': 0.3608471, 'binary_f1_score': 0.11036401}
confusion matrix:
      0     1
0  2164  3833
1     4   238
early stop counter: 4
val acc:0.6662760376930237, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 6,now: 2024-08-04 23:49:58.373800,epoch time: 0:09:58.943413,used: 1:02:09.013450,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9280667, 'precision': 0.9348165, 'recall': 0.928056, 'specificity': 0.928056, 'f1': 0.9277853, 'auroc': 0.9958756, 'binary_precision': 0.88068444, 'binary_recall': 0.99032825, 'binary_specificity': 0.8657838, 'binary_f1_score': 0.9322937}
confusion matrix:
       0      1
0  25235   3912
1    282  28875
---- Validation: 
scalar performance:
{'acc': 0.68396103, 'precision': 0.50967145, 'recall': 0.5669211, 'specificity': 0.5669211, 'f1': 0.44570047, 'auroc': 0.56418204, 'binary_precision': 0.045369264, 'binary_recall': 0.44186047, 'binary_specificity': 0.69198173, 'binary_f1_score': 0.08228925}
confusion matrix:
       0     1
0  12574  5597
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41384837, 'precision': 0.52973163, 'recall': 0.6871666, 'specificity': 0.6871666, 'f1': 0.3384721, 'auroc': 0.92563426, 'binary_precision': 0.061166797, 'binary_recall': 0.9834711, 'binary_specificity': 0.3908621, 'binary_f1_score': 0.115170576}
confusion matrix:
      0     1
0  2344  3653
1     4   238
early stop counter: 5
val acc:0.683961033821106, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 7,now: 2024-08-05 00:00:07.436966,epoch time: 0:10:09.063166,used: 1:12:18.076616,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9496775, 'precision': 0.95221984, 'recall': 0.9496724, 'specificity': 0.9496724, 'f1': 0.9496063, 'auroc': 0.9957622, 'binary_precision': 0.9183472, 'binary_recall': 0.98713815, 'binary_specificity': 0.91220665, 'binary_f1_score': 0.95150095}
confusion matrix:
       0      1
0  26589   2559
1    375  28781
---- Validation: 
scalar performance:
{'acc': 0.7564055, 'precision': 0.5171054, 'recall': 0.6003281, 'specificity': 0.6003281, 'f1': 0.48076662, 'auroc': 0.58190644, 'binary_precision': 0.058090363, 'binary_recall': 0.43355483, 'binary_specificity': 0.7671014, 'binary_f1_score': 0.10245339}
confusion matrix:
       0     1
0  13939  4232
1    341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4386921, 'precision': 0.53010637, 'recall': 0.6941415, 'specificity': 0.6941415, 'f1': 0.35330948, 'auroc': 0.9239799, 'binary_precision': 0.06300268, 'binary_recall': 0.9710744, 'binary_specificity': 0.4172086, 'binary_f1_score': 0.11832831}
confusion matrix:
      0     1
0  2502  3495
1     7   235
early stop counter: 6
val acc:0.7564054727554321, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 8,now: 2024-08-05 00:10:18.882621,epoch time: 0:10:11.445655,used: 1:22:29.522271,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93372667, 'precision': 0.93900895, 'recall': 0.93371916, 'specificity': 0.93371916, 'f1': 0.9335259, 'auroc': 0.9954534, 'binary_precision': 0.89088774, 'binary_recall': 0.9885444, 'binary_specificity': 0.8788939, 'binary_f1_score': 0.9371789}
confusion matrix:
       0      1
0  25618   3530
1    334  28822
---- Validation: 
scalar performance:
{'acc': 0.63346297, 'precision': 0.50591105, 'recall': 0.5440478, 'specificity': 0.5440478, 'f1': 0.4221758, 'auroc': 0.5763513, 'binary_precision': 0.03959525, 'binary_recall': 0.44850498, 'binary_specificity': 0.63959056, 'binary_f1_score': 0.072766475}
confusion matrix:
       0     1
0  11622  6549
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3811508, 'precision': 0.5271077, 'recall': 0.66420984, 'specificity': 0.66420984, 'f1': 0.3173016, 'auroc': 0.91761535, 'binary_precision': 0.057471264, 'binary_recall': 0.9710744, 'binary_specificity': 0.35734534, 'binary_f1_score': 0.10851997}
confusion matrix:
      0     1
0  2143  3854
1     7   235
early stop counter: 7
val acc:0.6334629654884338, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 9,now: 2024-08-05 00:20:27.635627,epoch time: 0:10:08.753006,used: 1:32:38.275277,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9455955, 'precision': 0.9487553, 'recall': 0.94558835, 'specificity': 0.94558835, 'f1': 0.94549894, 'auroc': 0.9953488, 'binary_precision': 0.91114205, 'binary_recall': 0.98751587, 'binary_specificity': 0.9036608, 'binary_f1_score': 0.9477929}
confusion matrix:
       0      1
0  26339   2808
1    364  28793
---- Validation: 
scalar performance:
{'acc': 0.7788313, 'precision': 0.5204503, 'recall': 0.6119125, 'specificity': 0.6119125, 'f1': 0.49268675, 'auroc': 0.58865976, 'binary_precision': 0.064096265, 'binary_recall': 0.43355483, 'binary_specificity': 0.7902702, 'binary_f1_score': 0.11168163}
confusion matrix:
       0     1
0  14360  3811
1    341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7062029, 'precision': 0.55154645, 'recall': 0.80355334, 'specificity': 0.80355334, 'f1': 0.50697947, 'auroc': 0.92435133, 'binary_precision': 0.108321026, 'binary_recall': 0.90909094, 'binary_specificity': 0.6980157, 'binary_f1_score': 0.19357677}
confusion matrix:
      0     1
0  4186  1811
1    22   220
early stop counter: 8
val acc:0.7788313031196594, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 10,now: 2024-08-05 00:30:40.333698,epoch time: 0:10:12.698071,used: 1:42:50.973348,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9457327, 'precision': 0.9489551, 'recall': 0.9457269, 'specificity': 0.9457269, 'f1': 0.9456347, 'auroc': 0.99597216, 'binary_precision': 0.9109537, 'binary_recall': 0.9880642, 'binary_specificity': 0.9033896, 'binary_f1_score': 0.9479434}
confusion matrix:
       0      1
0  26332   2816
1    348  28808
---- Validation: 
scalar performance:
{'acc': 0.7724924, 'precision': 0.5197197, 'recall': 0.61024415, 'specificity': 0.61024415, 'f1': 0.48961782, 'auroc': 0.6109105, 'binary_precision': 0.062693685, 'binary_recall': 0.43687707, 'binary_specificity': 0.78361124, 'binary_f1_score': 0.10965187}
confusion matrix:
       0     1
0  14239  3932
1    339   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430678, 'precision': 0.5589197, 'recall': 0.8247123, 'specificity': 0.8247123, 'f1': 0.5312449, 'auroc': 0.92506653, 'binary_precision': 0.12257349, 'binary_recall': 0.91322315, 'binary_specificity': 0.7362014, 'binary_f1_score': 0.21613692}
confusion matrix:
      0     1
0  4415  1582
1    21   221
early stop counter: 9
val acc:0.7724924087524414, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 11,now: 2024-08-05 00:40:43.663565,epoch time: 0:10:03.329867,used: 1:52:54.303215,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9037973, 'precision': 0.91661733, 'recall': 0.9037763, 'specificity': 0.9037763, 'f1': 0.9030482, 'auroc': 0.9941262, 'binary_precision': 0.84359497, 'binary_recall': 0.9914606, 'binary_specificity': 0.81609195, 'binary_f1_score': 0.9115704}
confusion matrix:
       0      1
0  23785   5360
1    249  28910
---- Validation: 
scalar performance:
{'acc': 0.4967773, 'precision': 0.49750012, 'recall': 0.47986513, 'specificity': 0.47986513, 'f1': 0.35629618, 'auroc': 0.56136525, 'binary_precision': 0.029571323, 'binary_recall': 0.46179402, 'binary_specificity': 0.49793628, 'binary_f1_score': 0.055583324}
confusion matrix:
      0     1
0  9048  9123
1   324   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.18288188, 'precision': 0.522019, 'recall': 0.5729714, 'specificity': 0.5729714, 'f1': 0.17366257, 'auroc': 0.85839975, 'binary_precision': 0.045147996, 'binary_recall': 0.9958678, 'binary_specificity': 0.15007503, 'binary_f1_score': 0.08637993}
confusion matrix:
     0     1
0  900  5097
1    1   241
early stop counter: 10
val acc:0.4967772960662842, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 12,now: 2024-08-05 00:50:54.480807,epoch time: 0:10:10.817242,used: 2:03:05.120457,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92218375, 'precision': 0.9293982, 'recall': 0.9221748, 'specificity': 0.9221748, 'f1': 0.9218544, 'auroc': 0.99377203, 'binary_precision': 0.87377405, 'binary_recall': 0.98696667, 'binary_specificity': 0.857383, 'binary_f1_score': 0.9269275}
confusion matrix:
       0      1
0  24991   4157
1    380  28776
---- Validation: 
scalar performance:
{'acc': 0.60315347, 'precision': 0.50337994, 'recall': 0.5259818, 'specificity': 0.5259818, 'f1': 0.40743548, 'auroc': 0.5470425, 'binary_precision': 0.03616906, 'binary_recall': 0.4435216, 'binary_specificity': 0.608442, 'binary_f1_score': 0.06688377}
confusion matrix:
       0     1
0  11056  7115
1    335   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.31751883, 'precision': 0.5253467, 'recall': 0.6370582, 'specificity': 0.6370582, 'f1': 0.27535206, 'auroc': 0.8363848, 'binary_precision': 0.052983083, 'binary_recall': 0.9834711, 'binary_specificity': 0.29064533, 'binary_f1_score': 0.10054922}
confusion matrix:
      0     1
0  1743  4254
1     4   238
early stop counter: 11
val acc:0.6031534671783447, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 13,now: 2024-08-05 01:01:02.124410,epoch time: 0:10:07.643603,used: 2:13:12.764060,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9188049, 'precision': 0.9269895, 'recall': 0.918793, 'specificity': 0.918793, 'f1': 0.9184123, 'auroc': 0.99424464, 'binary_precision': 0.867916, 'binary_recall': 0.98799604, 'binary_specificity': 0.84959, 'binary_f1_score': 0.9240714}
confusion matrix:
       0      1
0  24763   4384
1    350  28807
---- Validation: 
scalar performance:
{'acc': 0.594524, 'precision': 0.5032965, 'recall': 0.5255394, 'specificity': 0.5255394, 'f1': 0.40384984, 'auroc': 0.5604894, 'binary_precision': 0.03600741, 'binary_recall': 0.45182723, 'binary_specificity': 0.59925157, 'binary_f1_score': 0.066699356}
confusion matrix:
       0     1
0  10889  7282
1    330   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.24491104, 'precision': 0.5225191, 'recall': 0.5992893, 'specificity': 0.5992893, 'f1': 0.2228144, 'auroc': 0.8213272, 'binary_precision': 0.048129424, 'binary_recall': 0.9834711, 'binary_specificity': 0.21510756, 'binary_f1_score': 0.091767885}
confusion matrix:
      0     1
0  1290  4707
1     4   238
early stop counter: 12
val acc:0.5945240259170532, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 14,now: 2024-08-05 01:11:12.386649,epoch time: 0:10:10.262239,used: 2:23:23.026299,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8845362, 'precision': 0.90324914, 'recall': 0.8845178, 'specificity': 0.8845178, 'f1': 0.8831774, 'auroc': 0.9930526, 'binary_precision': 0.8164244, 'binary_recall': 0.99221456, 'binary_specificity': 0.77682096, 'binary_f1_score': 0.8957765}
confusion matrix:
       0      1
0  22642   6505
1    227  28930
---- Validation: 
scalar performance:
{'acc': 0.49363446, 'precision': 0.4972984, 'recall': 0.47824168, 'specificity': 0.47824168, 'f1': 0.3546917, 'auroc': 0.56078655, 'binary_precision': 0.029386893, 'binary_recall': 0.46179402, 'binary_specificity': 0.49468935, 'binary_f1_score': 0.055257406}
confusion matrix:
      0     1
0  8989  9182
1   324   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.13062991, 'precision': 0.52135545, 'recall': 0.5477739, 'specificity': 0.5477739, 'f1': 0.12817602, 'auroc': 0.80490005, 'binary_precision': 0.042710908, 'binary_recall': 1.0, 'binary_specificity': 0.09554777, 'binary_f1_score': 0.08192282}
confusion matrix:
     0     1
0  573  5424
1    0   242
early stop counter: 13
val acc:0.4936344623565674, best validation acc: 0.9183401465415955, corresponding to test acc:                         0.9196986556053162 / 0.9196986556053162
after epoch: 15,now: 2024-08-05 01:21:22.702379,epoch time: 0:10:10.315730,used: 2:33:33.342029,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067114
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:33.342029 at 2024-08-05 01:21:22.702379
persisted model performance metric: 

scalar performance:
{'acc': 0.91969866, 'precision': 0.64836717, 'recall': 0.87693673, 'specificity': 0.87693673, 'f1': 0.7009499, 'auroc': 0.9236381, 'binary_precision': 0.30408472, 'binary_recall': 0.8305785, 'binary_specificity': 0.92329496, 'binary_f1_score': 0.4451827}
confusion matrix:
      0    1
0  5537  460
1    41  201
oracle model performance metric: 

scalar performance:
{'acc': 0.91969866, 'precision': 0.64836717, 'recall': 0.87693673, 'specificity': 0.87693673, 'f1': 0.7009499, 'auroc': 0.9236381, 'binary_precision': 0.30408472, 'binary_recall': 0.8305785, 'binary_specificity': 0.92329496, 'binary_f1_score': 0.4451827}
confusion matrix:
      0    1
0  5537  460
1    41  201
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522827 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool | 436736 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |  86091 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  16612 MiB |  10068 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  16428 MiB |  10006 MiB |
|       from small pool |    122 MiB |    124 MiB |    184 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1061 MiB |   1463 MiB | 730675 GiB | 730674 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 728433 GiB | 728432 GiB |
|       from small pool |      6 MiB |     27 MiB |   2242 GiB |   2242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3618    |    8435    |  163863 K  |  163859 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95829 K  |   95825 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3618    |    8435    |  163863 K  |  163859 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95829 K  |   95825 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     254    |     124    |
|       from large pool |      69    |      71    |     162    |      93    |
|       from small pool |      61    |      62    |      92    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3673    |   76905 K  |   76905 K  |
|       from large pool |      21    |      36    |   27378 K  |   27378 K  |
|       from small pool |      55    |    3653    |   49526 K  |   49526 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool |  65536 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |      0 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1584 MiB |   6564 MiB |  16612 MiB |  15028 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  16428 MiB |  14936 MiB |
|       from small pool |     92 MiB |    124 MiB |    184 MiB |     92 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 730676 GiB | 730676 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 728433 GiB | 728433 GiB |
|       from small pool |      0 KiB |     27 MiB |   2242 GiB |   2242 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8435    |  163863 K  |  163862 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95829 K  |   95829 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8435    |  163863 K  |  163862 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95829 K  |   95829 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |     133    |     254    |     184    |
|       from large pool |      24    |      71    |     162    |     138    |
|       from small pool |      46    |      62    |      92    |      46    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3673    |   76907 K  |   76907 K  |
|       from large pool |       3    |      36    |   27378 K  |   27378 K  |
|       from small pool |       0    |    3653    |   49528 K  |   49528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 01:22:07 2024]
Finished job 0.
1 of 1 steps (100%) done
