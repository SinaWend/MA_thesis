Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug  5 01:22:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123

 Experiment start at: 2024-08-05 01:30:00.811504
before training, model accuracy: 0.31048259139060974
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92377967, 'precision': 0.9238595, 'recall': 0.9237845, 'specificity': 0.9237845, 'f1': 0.9237766, 'auroc': 0.97686505, 'binary_precision': 0.9298537, 'binary_recall': 0.9168293, 'binary_specificity': 0.9307397, 'binary_f1_score': 0.9232955}
confusion matrix:
       0      1
0  26675   1985
1   2387  26313
---- Validation: 
scalar performance:
{'acc': 0.8433376, 'precision': 0.54240805, 'recall': 0.66837513, 'specificity': 0.66837513, 'f1': 0.5434829, 'auroc': 0.70411336, 'binary_precision': 0.10585817, 'binary_recall': 0.4805599, 'binary_specificity': 0.85619044, 'binary_f1_score': 0.17349803}
confusion matrix:
       0     1
0  15539  2610
1    334   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8739214, 'precision': 0.57404786, 'recall': 0.7070077, 'specificity': 0.7070077, 'f1': 0.5944354, 'auroc': 0.78377247, 'binary_precision': 0.17082295, 'binary_recall': 0.5249042, 'binary_specificity': 0.8891112, 'binary_f1_score': 0.25776106}
confusion matrix:
      0    1
0  5332  665
1   124  137
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 01:44:04.117531,epoch time: 0:14:03.306027,used: 0:14:03.306027,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93730825, 'precision': 0.93846023, 'recall': 0.9373289, 'specificity': 0.9373289, 'f1': 0.937269, 'auroc': 0.98367023, 'binary_precision': 0.9611358, 'binary_recall': 0.91157717, 'binary_specificity': 0.9630806, 'binary_f1_score': 0.9357008}
confusion matrix:
       0      1
0  27599   1058
1   2538  26165
---- Validation: 
scalar performance:
{'acc': 0.88867605, 'precision': 0.55635023, 'recall': 0.66109526, 'specificity': 0.66109526, 'f1': 0.5720554, 'auroc': 0.73272955, 'binary_precision': 0.1350126, 'binary_recall': 0.41679627, 'binary_specificity': 0.90539426, 'binary_f1_score': 0.2039574}
confusion matrix:
       0     1
0  16432  1717
1    375   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8975711, 'precision': 0.59525317, 'recall': 0.7248442, 'specificity': 0.7248442, 'f1': 0.6243675, 'auroc': 0.7955817, 'binary_precision': 0.21212122, 'binary_recall': 0.5363985, 'binary_specificity': 0.91328996, 'binary_f1_score': 0.3040174}
confusion matrix:
      0    1
0  5477  520
1   121  140
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-05 01:57:53.847037,epoch time: 0:13:49.729506,used: 0:27:53.035533,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9530858, 'precision': 0.9530935, 'recall': 0.95308745, 'specificity': 0.95308745, 'f1': 0.95308566, 'auroc': 0.9896047, 'binary_precision': 0.9551675, 'binary_recall': 0.9508745, 'binary_specificity': 0.95530045, 'binary_f1_score': 0.9530161}
confusion matrix:
       0      1
0  27377   1281
1   1410  27292
---- Validation: 
scalar performance:
{'acc': 0.87670285, 'precision': 0.56532466, 'recall': 0.7186513, 'specificity': 0.7186513, 'f1': 0.583251, 'auroc': 0.77186114, 'binary_precision': 0.14831933, 'binary_recall': 0.5489891, 'binary_specificity': 0.8883134, 'binary_f1_score': 0.23354284}
confusion matrix:
       0     1
0  16122  2027
1    290   353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89549375, 'precision': 0.60070086, 'recall': 0.7512454, 'specificity': 0.7512454, 'f1': 0.6324816, 'auroc': 0.8321059, 'binary_precision': 0.22048365, 'binary_recall': 0.59386975, 'binary_specificity': 0.90862095, 'binary_f1_score': 0.32157674}
confusion matrix:
      0    1
0  5449  548
1   106  155
early stop counter: 1
val acc:0.8767028450965881, best validation acc: 0.8886760473251343, corresponding to test acc:                         0.8975710868835449 / 0.8975710868835449
after epoch: 3,now: 2024-08-05 02:11:28.719641,epoch time: 0:13:34.872604,used: 0:41:27.908137,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95690376, 'precision': 0.9569148, 'recall': 0.95690167, 'specificity': 0.95690167, 'f1': 0.95690334, 'auroc': 0.99093163, 'binary_precision': 0.9548828, 'binary_recall': 0.9592071, 'binary_specificity': 0.9545962, 'binary_f1_score': 0.9570401}
confusion matrix:
       0      1
0  27353   1301
1   1171  27535
---- Validation: 
scalar performance:
{'acc': 0.8730843, 'precision': 0.5661676, 'recall': 0.72952884, 'specificity': 0.72952884, 'f1': 0.58379364, 'auroc': 0.7836113, 'binary_precision': 0.14907333, 'binary_recall': 0.5754277, 'binary_specificity': 0.88363, 'binary_f1_score': 0.23680001}
confusion matrix:
       0     1
0  16037  2112
1    273   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8993289, 'precision': 0.61214066, 'recall': 0.7825637, 'specificity': 0.7825637, 'f1': 0.648639, 'auroc': 0.8524971, 'binary_precision': 0.24050634, 'binary_recall': 0.6551724, 'binary_specificity': 0.90995497, 'binary_f1_score': 0.35185185}
confusion matrix:
      0    1
0  5457  540
1    90  171
new oracle model saved
early stop counter: 2
val acc:0.873084306716919, best validation acc: 0.8886760473251343, corresponding to test acc:                         0.8975710868835449 / 0.899328887462616
after epoch: 4,now: 2024-08-05 02:25:06.654603,epoch time: 0:13:37.934962,used: 0:55:05.843099,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9595886, 'precision': 0.959608, 'recall': 0.9595914, 'specificity': 0.9595914, 'f1': 0.9595883, 'auroc': 0.9920795, 'binary_precision': 0.96281487, 'binary_recall': 0.95617336, 'binary_specificity': 0.9630095, 'binary_f1_score': 0.9594826}
confusion matrix:
       0      1
0  27596   1060
1   1258  27446
---- Validation: 
scalar performance:
{'acc': 0.8892082, 'precision': 0.5768654, 'recall': 0.7386265, 'specificity': 0.7386265, 'f1': 0.6014257, 'auroc': 0.79468954, 'binary_precision': 0.17010546, 'binary_recall': 0.5769829, 'binary_specificity': 0.90027, 'binary_f1_score': 0.26274788}
confusion matrix:
       0     1
0  16339  1810
1    272   371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91019493, 'precision': 0.62034035, 'recall': 0.76990986, 'specificity': 0.76990986, 'f1': 0.65796924, 'auroc': 0.85215306, 'binary_precision': 0.25842696, 'binary_recall': 0.61685824, 'binary_specificity': 0.9229615, 'binary_f1_score': 0.3642534}
confusion matrix:
      0    1
0  5535  462
1   100  161
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-05 02:38:42.353463,epoch time: 0:13:35.698860,used: 1:08:41.541959,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95953625, 'precision': 0.95955986, 'recall': 0.9595334, 'specificity': 0.9595334, 'f1': 0.95953554, 'auroc': 0.9921124, 'binary_precision': 0.95646906, 'binary_recall': 0.96296686, 'binary_specificity': 0.9560999, 'binary_f1_score': 0.9597069}
confusion matrix:
       0      1
0  27398   1258
1   1063  27641
---- Validation: 
scalar performance:
{'acc': 0.8750532, 'precision': 0.57221466, 'recall': 0.7522998, 'specificity': 0.7522998, 'f1': 0.5927375, 'auroc': 0.79734826, 'binary_precision': 0.1594087, 'binary_recall': 0.62052876, 'binary_specificity': 0.88407075, 'binary_f1_score': 0.25365543}
confusion matrix:
       0     1
0  16045  2104
1    244   399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8894215, 'precision': 0.600594, 'recall': 0.77006507, 'specificity': 0.77006507, 'f1': 0.6326549, 'auroc': 0.84611845, 'binary_precision': 0.21830066, 'binary_recall': 0.63984674, 'binary_specificity': 0.90028346, 'binary_f1_score': 0.32553607}
confusion matrix:
      0    1
0  5399  598
1    94  167
early stop counter: 1
val acc:0.8750532269477844, best validation acc: 0.889208197593689, corresponding to test acc:                         0.9101949334144592 / 0.9101949334144592
after epoch: 6,now: 2024-08-05 02:52:09.715141,epoch time: 0:13:27.361678,used: 1:22:08.903637,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96263945, 'precision': 0.9627084, 'recall': 0.9626436, 'specificity': 0.9626436, 'f1': 0.96263826, 'auroc': 0.9926796, 'binary_precision': 0.96852505, 'binary_recall': 0.95640963, 'binary_specificity': 0.96887755, 'binary_f1_score': 0.9624292}
confusion matrix:
       0      1
0  27769    892
1   1251  27448
---- Validation: 
scalar performance:
{'acc': 0.90762025, 'precision': 0.5932603, 'recall': 0.7489087, 'specificity': 0.7489087, 'f1': 0.62527347, 'auroc': 0.8140895, 'binary_precision': 0.20250408, 'binary_recall': 0.5785381, 'binary_specificity': 0.9192793, 'binary_f1_score': 0.3}
confusion matrix:
       0     1
0  16684  1465
1    271   372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93080854, 'precision': 0.6551477, 'recall': 0.7843299, 'specificity': 0.7843299, 'f1': 0.6963417, 'auroc': 0.87234485, 'binary_precision': 0.32730925, 'binary_recall': 0.6245211, 'binary_specificity': 0.94413877, 'binary_f1_score': 0.42951253}
confusion matrix:
      0    1
0  5662  335
1    98  163
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-05 03:05:41.584612,epoch time: 0:13:31.869471,used: 1:35:40.773108,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9643654, 'precision': 0.9644258, 'recall': 0.96437013, 'specificity': 0.96437013, 'f1': 0.9643645, 'auroc': 0.99311566, 'binary_precision': 0.9699277, 'binary_recall': 0.9585061, 'binary_specificity': 0.97023416, 'binary_f1_score': 0.9641831}
confusion matrix:
       0      1
0  27804    853
1   1191  27512
---- Validation: 
scalar performance:
{'acc': 0.9009685, 'precision': 0.5873096, 'recall': 0.7477151, 'specificity': 0.7477151, 'f1': 0.61701685, 'auroc': 0.80263793, 'binary_precision': 0.19054878, 'binary_recall': 0.58320373, 'binary_specificity': 0.91222656, 'binary_f1_score': 0.28724626}
confusion matrix:
       0     1
0  16556  1593
1    268   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9293704, 'precision': 0.65309596, 'recall': 0.7872442, 'specificity': 0.7872442, 'f1': 0.69491243, 'auroc': 0.86664855, 'binary_precision': 0.32289627, 'binary_recall': 0.6321839, 'binary_specificity': 0.9423045, 'binary_f1_score': 0.42746115}
confusion matrix:
      0    1
0  5651  346
1    96  165
early stop counter: 1
val acc:0.9009684920310974, best validation acc: 0.9076202511787415, corresponding to test acc:                         0.9308085441589355 / 0.9308085441589355
after epoch: 8,now: 2024-08-05 03:19:04.738107,epoch time: 0:13:23.153495,used: 1:49:03.926603,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96492326, 'precision': 0.9651885, 'recall': 0.9649334, 'specificity': 0.9649334, 'f1': 0.96491885, 'auroc': 0.99389386, 'binary_precision': 0.9765067, 'binary_recall': 0.9528289, 'binary_specificity': 0.97703797, 'binary_f1_score': 0.96452254}
confusion matrix:
       0      1
0  27998    658
1   1354  27350
---- Validation: 
scalar performance:
{'acc': 0.91331416, 'precision': 0.5997657, 'recall': 0.7526066, 'specificity': 0.7526066, 'f1': 0.63391936, 'auroc': 0.811941, 'binary_precision': 0.21535797, 'binary_recall': 0.5800933, 'binary_specificity': 0.9251198, 'binary_f1_score': 0.31410527}
confusion matrix:
       0     1
0  16790  1359
1    270   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93767977, 'precision': 0.67261827, 'recall': 0.7970767, 'specificity': 0.7970767, 'f1': 0.71486557, 'auroc': 0.87263364, 'binary_precision': 0.36129034, 'binary_recall': 0.6436782, 'binary_specificity': 0.9504752, 'binary_f1_score': 0.46280992}
confusion matrix:
      0    1
0  5700  297
1    93  168
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-05 03:32:22.472719,epoch time: 0:13:17.734612,used: 2:02:21.661215,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96335423, 'precision': 0.9635085, 'recall': 0.9633604, 'specificity': 0.9633604, 'f1': 0.9633515, 'auroc': 0.9934999, 'binary_precision': 0.97213054, 'binary_recall': 0.9541099, 'binary_specificity': 0.9726109, 'binary_f1_score': 0.96303594}
confusion matrix:
       0      1
0  27876    785
1   1317  27382
---- Validation: 
scalar performance:
{'acc': 0.91730523, 'precision': 0.6040899, 'recall': 0.7524227, 'specificity': 0.7524227, 'f1': 0.63927275, 'auroc': 0.8163339, 'binary_precision': 0.2241066, 'binary_recall': 0.5754277, 'binary_specificity': 0.9294176, 'binary_f1_score': 0.32258067}
confusion matrix:
       0     1
0  16868  1281
1    273   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9395973, 'precision': 0.67077154, 'recall': 0.76692754, 'specificity': 0.76692754, 'f1': 0.7060906, 'auroc': 0.85521364, 'binary_precision': 0.36038187, 'binary_recall': 0.5785441, 'binary_specificity': 0.955311, 'binary_f1_score': 0.44411764}
confusion matrix:
      0    1
0  5729  268
1   110  151
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-05 03:45:54.175006,epoch time: 0:13:31.702287,used: 2:15:53.363502,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9668933, 'precision': 0.9669114, 'recall': 0.9668963, 'specificity': 0.9668963, 'f1': 0.9668931, 'auroc': 0.9940014, 'binary_precision': 0.9700509, 'binary_recall': 0.96359646, 'binary_specificity': 0.9701961, 'binary_f1_score': 0.96681285}
confusion matrix:
       0      1
0  27800    854
1   1045  27661
---- Validation: 
scalar performance:
{'acc': 0.9003831, 'precision': 0.58916295, 'recall': 0.7571628, 'specificity': 0.7571628, 'f1': 0.6197338, 'auroc': 0.8170701, 'binary_precision': 0.19351621, 'binary_recall': 0.60342145, 'binary_specificity': 0.91090417, 'binary_f1_score': 0.29305136}
confusion matrix:
       0     1
0  16532  1617
1    255   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9332055, 'precision': 0.6585495, 'recall': 0.7782512, 'specificity': 0.7782512, 'f1': 0.69829065, 'auroc': 0.86002386, 'binary_precision': 0.33473685, 'binary_recall': 0.6091954, 'binary_specificity': 0.947307, 'binary_f1_score': 0.43206522}
confusion matrix:
      0    1
0  5681  316
1   102  159
early stop counter: 1
val acc:0.9003831148147583, best validation acc: 0.9173052310943604, corresponding to test acc:                         0.9395973086357117 / 0.9395973086357117
after epoch: 11,now: 2024-08-05 03:59:17.946808,epoch time: 0:13:23.771802,used: 2:29:17.135304,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9684449, 'precision': 0.96857, 'recall': 0.9684507, 'specificity': 0.9684507, 'f1': 0.9684431, 'auroc': 0.99466944, 'binary_precision': 0.9764014, 'binary_recall': 0.9601394, 'binary_specificity': 0.97676206, 'binary_f1_score': 0.9682021}
confusion matrix:
       0      1
0  27994    666
1   1144  27556
---- Validation: 
scalar performance:
{'acc': 0.9151767, 'precision': 0.6004429, 'recall': 0.7475704, 'specificity': 0.7475704, 'f1': 0.6344533, 'auroc': 0.81104755, 'binary_precision': 0.21713266, 'binary_recall': 0.5676516, 'binary_specificity': 0.9274891, 'binary_f1_score': 0.3141136}
confusion matrix:
       0     1
0  16833  1316
1    278   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566953, 'precision': 0.6901983, 'recall': 0.7774251, 'specificity': 0.7774251, 'f1': 0.72413486, 'auroc': 0.8647108, 'binary_precision': 0.3984576, 'binary_recall': 0.59386975, 'binary_specificity': 0.9609805, 'binary_f1_score': 0.47692308}
confusion matrix:
      0    1
0  5763  234
1   106  155
new oracle model saved
early stop counter: 2
val acc:0.9151766896247864, best validation acc: 0.9173052310943604, corresponding to test acc:                         0.9395973086357117 / 0.9456695318222046
after epoch: 12,now: 2024-08-05 04:12:45.428194,epoch time: 0:13:27.481386,used: 2:42:44.616690,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96820086, 'precision': 0.96831083, 'recall': 0.9682068, 'specificity': 0.9682068, 'f1': 0.96819925, 'auroc': 0.9945165, 'binary_precision': 0.97568315, 'binary_recall': 0.96038604, 'binary_specificity': 0.9760276, 'binary_f1_score': 0.9679741}
confusion matrix:
       0      1
0  27971    687
1   1137  27565
---- Validation: 
scalar performance:
{'acc': 0.9199659, 'precision': 0.60897535, 'recall': 0.7590505, 'specificity': 0.7590505, 'f1': 0.64567447, 'auroc': 0.81855166, 'binary_precision': 0.23343654, 'binary_recall': 0.58631414, 'binary_specificity': 0.9317869, 'binary_f1_score': 0.33392385}
confusion matrix:
       0     1
0  16911  1238
1    266   377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9391179, 'precision': 0.6743046, 'recall': 0.7886654, 'specificity': 0.7886654, 'f1': 0.7144199, 'auroc': 0.8752198, 'binary_precision': 0.36547086, 'binary_recall': 0.6245211, 'binary_specificity': 0.95280975, 'binary_f1_score': 0.4611033}
confusion matrix:
      0    1
0  5714  283
1    98  163
better model found
persisted
after epoch: 13,now: 2024-08-05 04:26:19.181415,epoch time: 0:13:33.753221,used: 2:56:18.369911,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96677125, 'precision': 0.96703005, 'recall': 0.9667791, 'specificity': 0.9667791, 'f1': 0.9667671, 'auroc': 0.99444246, 'binary_precision': 0.97819024, 'binary_recall': 0.9548765, 'binary_specificity': 0.9786818, 'binary_f1_score': 0.96639276}
confusion matrix:
       0      1
0  28050    611
1   1295  27404
---- Validation: 
scalar performance:
{'acc': 0.92837375, 'precision': 0.61651397, 'recall': 0.74390197, 'specificity': 0.74390197, 'f1': 0.6524482, 'auroc': 0.81496453, 'binary_precision': 0.24982207, 'binary_recall': 0.5458787, 'binary_specificity': 0.94192517, 'binary_f1_score': 0.34277344}
confusion matrix:
       0     1
0  17095  1054
1    292   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.73351693, 'recall': 0.7759321, 'specificity': 0.7759321, 'f1': 0.7526833, 'auroc': 0.86902773, 'binary_precision': 0.48553056, 'binary_recall': 0.5785441, 'binary_specificity': 0.97332, 'binary_f1_score': 0.52797204}
confusion matrix:
      0    1
0  5837  160
1   110  151
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-08-05 04:39:51.834500,epoch time: 0:13:32.653085,used: 3:09:51.022996,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96928173, 'precision': 0.969338, 'recall': 0.96928585, 'specificity': 0.96928585, 'f1': 0.96928096, 'auroc': 0.9952431, 'binary_precision': 0.9746626, 'binary_recall': 0.9636598, 'binary_specificity': 0.97491187, 'binary_f1_score': 0.96913}
confusion matrix:
       0      1
0  27940    719
1   1043  27658
---- Validation: 
scalar performance:
{'acc': 0.9141124, 'precision': 0.6028143, 'recall': 0.7612704, 'specificity': 0.7612704, 'f1': 0.6382842, 'auroc': 0.8191961, 'binary_precision': 0.22081657, 'binary_recall': 0.59720063, 'binary_specificity': 0.92534024, 'binary_f1_score': 0.32241815}
confusion matrix:
       0     1
0  16794  1355
1    259   384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93192714, 'precision': 0.6553265, 'recall': 0.7757518, 'specificity': 0.7757518, 'f1': 0.6948473, 'auroc': 0.8711169, 'binary_precision': 0.32848233, 'binary_recall': 0.60536397, 'binary_specificity': 0.94613975, 'binary_f1_score': 0.425876}
confusion matrix:
      0    1
0  5674  323
1   103  158
early stop counter: 1
val acc:0.914112389087677, best validation acc: 0.9283737540245056, corresponding to test acc:                         0.9568552374839783 / 0.9568552374839783
after epoch: 15,now: 2024-08-05 04:53:32.081331,epoch time: 0:13:40.246831,used: 3:23:31.269827,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_00_seed_0_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:23:31.269827 at 2024-08-05 04:53:32.081331
persisted model performance metric: 

scalar performance:
{'acc': 0.95685524, 'precision': 0.73351693, 'recall': 0.7759321, 'specificity': 0.7759321, 'f1': 0.7526833, 'auroc': 0.86902773, 'binary_precision': 0.48553056, 'binary_recall': 0.5785441, 'binary_specificity': 0.97332, 'binary_f1_score': 0.52797204}
confusion matrix:
      0    1
0  5837  160
1   110  151
oracle model performance metric: 

scalar performance:
{'acc': 0.95685524, 'precision': 0.73351693, 'recall': 0.7759321, 'specificity': 0.7759321, 'f1': 0.7526833, 'auroc': 0.86902773, 'binary_precision': 0.48553056, 'binary_recall': 0.5785441, 'binary_specificity': 0.97332, 'binary_f1_score': 0.52797204}
confusion matrix:
      0    1
0  5837  160
1   110  151
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 253875 KiB | 664665 KiB | 400361 GiB | 400361 GiB |
|       from large pool | 216832 KiB | 591936 KiB | 400190 GiB | 400190 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    171 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 253875 KiB | 664665 KiB | 400361 GiB | 400361 GiB |
|       from large pool | 216832 KiB | 591936 KiB | 400190 GiB | 400190 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    171 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 249984 KiB | 656104 KiB | 399778 GiB | 399778 GiB |
|       from large pool | 214016 KiB | 584512 KiB | 399618 GiB | 399617 GiB |
|       from small pool |  35968 KiB |  74336 KiB |    160 GiB |    160 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    808 MiB |    808 MiB |    808 MiB |      0 B   |
|       from large pool |    734 MiB |    734 MiB |    734 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  71756 KiB | 230061 KiB | 242151 GiB | 242151 GiB |
|       from large pool |  59648 KiB | 228672 KiB | 241975 GiB | 241975 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    175 GiB |    175 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7919    |   49587 K  |   49584 K  |
|       from large pool |      36    |      76    |   19173 K  |   19172 K  |
|       from small pool |    3216    |    7882    |   30414 K  |   30411 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7919    |   49587 K  |   49584 K  |
|       from large pool |      36    |      76    |   19173 K  |   19172 K  |
|       from small pool |    3216    |    7882    |   30414 K  |   30411 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |      54    |      54    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3603    |   25827 K  |   25827 K  |
|       from large pool |       6    |      12    |   10169 K  |   10169 K  |
|       from small pool |      30    |    3597    |   15658 K  |   15657 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 400361 GiB | 400361 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 400190 GiB | 400190 GiB |
|       from small pool |      0 KiB |  75475 KiB |    171 GiB |    171 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 400361 GiB | 400361 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 400190 GiB | 400190 GiB |
|       from small pool |      0 KiB |  75475 KiB |    171 GiB |    171 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 399778 GiB | 399778 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 399618 GiB | 399617 GiB |
|       from small pool |      0 KiB |  74336 KiB |    160 GiB |    160 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 325632 KiB |    808 MiB |    808 MiB | 501760 KiB |
|       from large pool | 276480 KiB |    734 MiB |    734 MiB | 475136 KiB |
|       from small pool |  49152 KiB |     74 MiB |     74 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 230061 KiB | 242151 GiB | 242151 GiB |
|       from large pool |  47104 KiB | 228672 KiB | 241975 GiB | 241975 GiB |
|       from small pool |      0 KiB |  19703 KiB |    175 GiB |    175 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7919    |   49587 K  |   49587 K  |
|       from large pool |       2    |      76    |   19173 K  |   19173 K  |
|       from small pool |       0    |    7882    |   30414 K  |   30414 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7919    |   49587 K  |   49587 K  |
|       from large pool |       2    |      76    |   19173 K  |   19173 K  |
|       from small pool |       0    |    7882    |   30414 K  |   30414 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      54    |      54    |      20    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3603    |   25828 K  |   25828 K  |
|       from large pool |       2    |      12    |   10169 K  |   10169 K  |
|       from small pool |       0    |    3597    |   15659 K  |   15659 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 400361 GiB | 400361 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 400190 GiB | 400190 GiB |
|       from small pool |      0 KiB |  75475 KiB |    171 GiB |    171 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 400361 GiB | 400361 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 400190 GiB | 400190 GiB |
|       from small pool |      0 KiB |  75475 KiB |    171 GiB |    171 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 399778 GiB | 399778 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 399618 GiB | 399617 GiB |
|       from small pool |      0 KiB |  74336 KiB |    160 GiB |    160 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 325632 KiB |    808 MiB |    808 MiB | 501760 KiB |
|       from large pool | 276480 KiB |    734 MiB |    734 MiB | 475136 KiB |
|       from small pool |  49152 KiB |     74 MiB |     74 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 230061 KiB | 242151 GiB | 242151 GiB |
|       from large pool |  47104 KiB | 228672 KiB | 241975 GiB | 241975 GiB |
|       from small pool |      0 KiB |  19703 KiB |    175 GiB |    175 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7919    |   49587 K  |   49587 K  |
|       from large pool |       2    |      76    |   19173 K  |   19173 K  |
|       from small pool |       0    |    7882    |   30414 K  |   30414 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7919    |   49587 K  |   49587 K  |
|       from large pool |       2    |      76    |   19173 K  |   19173 K  |
|       from small pool |       0    |    7882    |   30414 K  |   30414 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      54    |      54    |      20    |
|       from large pool |      10    |      17    |      17    |       7    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3603    |   25828 K  |   25828 K  |
|       from large pool |       2    |      12    |   10169 K  |   10169 K  |
|       from small pool |       0    |    3597    |   15659 K  |   15659 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123

 Experiment start at: 2024-08-05 04:59:39.396002
before training, model accuracy: 0.14582662284374237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91682863, 'precision': 0.9169781, 'recall': 0.91683567, 'specificity': 0.91683567, 'f1': 0.9168221, 'auroc': 0.9736959, 'binary_precision': 0.9250575, 'binary_recall': 0.90728086, 'binary_specificity': 0.9263904, 'binary_f1_score': 0.9160829}
confusion matrix:
       0      1
0  26668   2119
1   2673  26156
---- Validation: 
scalar performance:
{'acc': 0.8554963, 'precision': 0.53959584, 'recall': 0.6353735, 'specificity': 0.6353735, 'f1': 0.543065, 'auroc': 0.6952459, 'binary_precision': 0.1042396, 'binary_recall': 0.39821693, 'binary_specificity': 0.87253004, 'binary_f1_score': 0.16522811}
confusion matrix:
       0     1
0  15764  2303
1    405   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8781824, 'precision': 0.57915646, 'recall': 0.71574944, 'specificity': 0.71574944, 'f1': 0.6019073, 'auroc': 0.7833217, 'binary_precision': 0.18041237, 'binary_recall': 0.53846157, 'binary_specificity': 0.8930373, 'binary_f1_score': 0.2702703}
confusion matrix:
      0    1
0  5310  636
1   120  140
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 05:13:35.280559,epoch time: 0:13:55.884557,used: 0:13:55.884557,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94312346, 'precision': 0.94340795, 'recall': 0.94313276, 'specificity': 0.94313276, 'f1': 0.9431151, 'auroc': 0.9852922, 'binary_precision': 0.9548238, 'binary_recall': 0.9303479, 'binary_specificity': 0.9559176, 'binary_f1_score': 0.942427}
confusion matrix:
       0      1
0  27518   1269
1   2008  26821
---- Validation: 
scalar performance:
{'acc': 0.87732124, 'precision': 0.5595198, 'recall': 0.68245584, 'specificity': 0.68245584, 'f1': 0.57507205, 'auroc': 0.74903035, 'binary_precision': 0.14058356, 'binary_recall': 0.47251114, 'binary_specificity': 0.8924005, 'binary_f1_score': 0.21669507}
confusion matrix:
       0     1
0  16123  1944
1    355   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89606833, 'precision': 0.6029515, 'recall': 0.7563462, 'specificity': 0.7563462, 'f1': 0.6355536, 'auroc': 0.825478, 'binary_precision': 0.22460657, 'binary_recall': 0.60384613, 'binary_specificity': 0.90884626, 'binary_f1_score': 0.32742438}
confusion matrix:
      0    1
0  5404  542
1   103  157
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-05 05:27:07.792138,epoch time: 0:13:32.511579,used: 0:27:28.396136,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9486601, 'precision': 0.9494284, 'recall': 0.94867456, 'specificity': 0.94867456, 'f1': 0.9486393, 'auroc': 0.9882947, 'binary_precision': 0.9681845, 'binary_recall': 0.9278826, 'binary_specificity': 0.96946645, 'binary_f1_score': 0.94760525}
confusion matrix:
       0      1
0  27909    879
1   2079  26749
---- Validation: 
scalar performance:
{'acc': 0.9065101, 'precision': 0.5801485, 'recall': 0.69044125, 'specificity': 0.69044125, 'f1': 0.6051188, 'auroc': 0.7732091, 'binary_precision': 0.18171091, 'binary_recall': 0.4576523, 'binary_specificity': 0.9232302, 'binary_f1_score': 0.2601351}
confusion matrix:
       0     1
0  16680  1387
1    365   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9171769, 'precision': 0.625648, 'recall': 0.7544891, 'specificity': 0.7544891, 'f1': 0.66211617, 'auroc': 0.83025694, 'binary_precision': 0.27075812, 'binary_recall': 0.5769231, 'binary_specificity': 0.9320552, 'binary_f1_score': 0.3685504}
confusion matrix:
      0    1
0  5542  404
1   110  150
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-05 05:40:48.314744,epoch time: 0:13:40.522606,used: 0:41:08.918742,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9536587, 'precision': 0.9536722, 'recall': 0.95366067, 'specificity': 0.95366067, 'f1': 0.95365846, 'auroc': 0.98952115, 'binary_precision': 0.9563185, 'binary_recall': 0.9508117, 'binary_specificity': 0.95650965, 'binary_f1_score': 0.95355713}
confusion matrix:
       0      1
0  27536   1252
1   1418  27410
---- Validation: 
scalar performance:
{'acc': 0.8842583, 'precision': 0.57355744, 'recall': 0.7232474, 'specificity': 0.7232474, 'f1': 0.59582126, 'auroc': 0.78552127, 'binary_precision': 0.16547406, 'binary_recall': 0.5497771, 'binary_specificity': 0.8967178, 'binary_f1_score': 0.25438294}
confusion matrix:
       0     1
0  16201  1866
1    303   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8946181, 'precision': 0.60341376, 'recall': 0.76294535, 'specificity': 0.76294535, 'f1': 0.6363651, 'auroc': 0.83802104, 'binary_precision': 0.22486034, 'binary_recall': 0.61923075, 'binary_specificity': 0.90665996, 'binary_f1_score': 0.32991806}
confusion matrix:
      0    1
0  5391  555
1    99  161
early stop counter: 1
val acc:0.8842582702636719, best validation acc: 0.9065101146697998, corresponding to test acc:                         0.9171769022941589 / 0.9171769022941589
after epoch: 4,now: 2024-08-05 05:54:23.604584,epoch time: 0:13:35.289840,used: 0:54:44.208582,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9594557, 'precision': 0.95949495, 'recall': 0.9594592, 'specificity': 0.9594592, 'f1': 0.959455, 'auroc': 0.9917587, 'binary_precision': 0.96392673, 'binary_recall': 0.9546984, 'binary_specificity': 0.96422, 'binary_f1_score': 0.9592904}
confusion matrix:
       0      1
0  27757   1030
1   1306  27523
---- Validation: 
scalar performance:
{'acc': 0.88153684, 'precision': 0.57688844, 'recall': 0.743294, 'specificity': 0.743294, 'f1': 0.60023904, 'auroc': 0.80113506, 'binary_precision': 0.17043033, 'binary_recall': 0.5943536, 'binary_specificity': 0.89223444, 'binary_f1_score': 0.26490062}
confusion matrix:
       0     1
0  16120  1947
1    273   400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89526266, 'precision': 0.6095747, 'recall': 0.78534955, 'specificity': 0.78534955, 'f1': 0.645226, 'auroc': 0.85321355, 'binary_precision': 0.23505434, 'binary_recall': 0.6653846, 'binary_specificity': 0.9053145, 'binary_f1_score': 0.34738958}
confusion matrix:
      0    1
0  5383  563
1    87  173
early stop counter: 2
val acc:0.8815368413925171, best validation acc: 0.9065101146697998, corresponding to test acc:                         0.9171769022941589 / 0.9171769022941589
after epoch: 5,now: 2024-08-05 06:07:42.152935,epoch time: 0:13:18.548351,used: 1:08:02.756933,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9581366, 'precision': 0.9585767, 'recall': 0.958148, 'specificity': 0.958148, 'f1': 0.9581273, 'auroc': 0.99166465, 'binary_precision': 0.97296524, 'binary_recall': 0.9425232, 'binary_specificity': 0.9737729, 'binary_f1_score': 0.9575023}
confusion matrix:
       0      1
0  28032    755
1   1657  27172
---- Validation: 
scalar performance:
{'acc': 0.9082711, 'precision': 0.59348655, 'recall': 0.73140943, 'specificity': 0.73140943, 'f1': 0.62421954, 'auroc': 0.7992486, 'binary_precision': 0.20518602, 'binary_recall': 0.5408618, 'binary_specificity': 0.92195714, 'binary_f1_score': 0.29750714}
confusion matrix:
       0     1
0  16657  1410
1    309   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92184985, 'precision': 0.6374913, 'recall': 0.7734786, 'specificity': 0.7734786, 'f1': 0.6771185, 'auroc': 0.8522012, 'binary_precision': 0.29281768, 'binary_recall': 0.61153847, 'binary_specificity': 0.9354188, 'binary_f1_score': 0.39601496}
confusion matrix:
      0    1
0  5562  384
1   101  159
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-05 06:21:21.318561,epoch time: 0:13:39.165626,used: 1:21:41.922559,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9597334, 'precision': 0.95982146, 'recall': 0.95973825, 'specificity': 0.95973825, 'f1': 0.95973176, 'auroc': 0.991933, 'binary_precision': 0.9663617, 'binary_recall': 0.9526849, 'binary_specificity': 0.9667917, 'binary_f1_score': 0.95947456}
confusion matrix:
       0      1
0  27832    956
1   1364  27464
---- Validation: 
scalar performance:
{'acc': 0.9053362, 'precision': 0.5936036, 'recall': 0.7420469, 'specificity': 0.7420469, 'f1': 0.62485313, 'auroc': 0.8058231, 'binary_precision': 0.20450886, 'binary_recall': 0.5661218, 'binary_specificity': 0.91797197, 'binary_f1_score': 0.30047318}
confusion matrix:
       0     1
0  16585  1482
1    292   381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9286175, 'precision': 0.6520412, 'recall': 0.78620535, 'specificity': 0.78620535, 'f1': 0.6936832, 'auroc': 0.8627702, 'binary_precision': 0.32093933, 'binary_recall': 0.63076925, 'binary_specificity': 0.94164145, 'binary_f1_score': 0.42542157}
confusion matrix:
      0    1
0  5599  347
1    96  164
new oracle model saved
early stop counter: 1
val acc:0.9053362011909485, best validation acc: 0.908271074295044, corresponding to test acc:                         0.9218498468399048 / 0.9286174774169922
after epoch: 7,now: 2024-08-05 06:34:59.286311,epoch time: 0:13:37.967750,used: 1:35:19.890309,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9651659, 'precision': 0.96518, 'recall': 0.9651681, 'specificity': 0.9651681, 'f1': 0.9651658, 'auroc': 0.99337673, 'binary_precision': 0.9679355, 'binary_recall': 0.96226156, 'binary_specificity': 0.96807474, 'binary_f1_score': 0.9650903}
confusion matrix:
       0      1
0  27867    919
1   1088  27742
---- Validation: 
scalar performance:
{'acc': 0.8905016, 'precision': 0.5859597, 'recall': 0.7579571, 'specificity': 0.7579571, 'f1': 0.6140968, 'auroc': 0.8029897, 'binary_precision': 0.18758495, 'binary_recall': 0.615156, 'binary_specificity': 0.90075827, 'binary_f1_score': 0.2875}
confusion matrix:
       0     1
0  16274  1793
1    259   414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90702546, 'precision': 0.62527025, 'recall': 0.80252206, 'specificity': 0.80252206, 'f1': 0.6663066, 'auroc': 0.87561584, 'binary_precision': 0.26518518, 'binary_recall': 0.68846154, 'binary_specificity': 0.9165826, 'binary_f1_score': 0.3828877}
confusion matrix:
      0    1
0  5450  496
1    81  179
early stop counter: 2
val acc:0.8905016183853149, best validation acc: 0.908271074295044, corresponding to test acc:                         0.9218498468399048 / 0.9286174774169922
after epoch: 8,now: 2024-08-05 06:48:48.169266,epoch time: 0:13:48.882955,used: 1:49:08.773264,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96221536, 'precision': 0.9626763, 'recall': 0.962227, 'specificity': 0.962227, 'f1': 0.9622066, 'auroc': 0.99325097, 'binary_precision': 0.97746325, 'binary_recall': 0.9463041, 'binary_specificity': 0.97814983, 'binary_f1_score': 0.96163136}
confusion matrix:
       0      1
0  28158    629
1   1548  27281
---- Validation: 
scalar performance:
{'acc': 0.9227321, 'precision': 0.61468405, 'recall': 0.7482078, 'specificity': 0.7482078, 'f1': 0.65068525, 'auroc': 0.81819904, 'binary_precision': 0.24656639, 'binary_recall': 0.5601783, 'binary_specificity': 0.93623734, 'binary_f1_score': 0.34241596}
confusion matrix:
       0     1
0  16915  1152
1    296   377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94956493, 'precision': 0.7042288, 'recall': 0.7787472, 'specificity': 0.7787472, 'f1': 0.73471427, 'auroc': 0.86187196, 'binary_precision': 0.4265928, 'binary_recall': 0.5923077, 'binary_specificity': 0.96518666, 'binary_f1_score': 0.4959742}
confusion matrix:
      0    1
0  5739  207
1   106  154
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-05 07:02:20.629455,epoch time: 0:13:32.460189,used: 2:02:41.233453,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96346503, 'precision': 0.9636626, 'recall': 0.963473, 'specificity': 0.963473, 'f1': 0.9634616, 'auroc': 0.9930358, 'binary_precision': 0.97342783, 'binary_recall': 0.95300037, 'binary_specificity': 0.9739457, 'binary_f1_score': 0.9631058}
confusion matrix:
       0      1
0  28036    750
1   1355  27475
---- Validation: 
scalar performance:
{'acc': 0.9151014, 'precision': 0.6063502, 'recall': 0.7528335, 'specificity': 0.7528335, 'f1': 0.6415476, 'auroc': 0.8231708, 'binary_precision': 0.2293632, 'binary_recall': 0.5780089, 'binary_specificity': 0.92765814, 'binary_f1_score': 0.32840863}
confusion matrix:
       0     1
0  16760  1307
1    284   389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93425715, 'precision': 0.6626469, 'recall': 0.78363156, 'specificity': 0.78363156, 'f1': 0.7030852, 'auroc': 0.8655741, 'binary_precision': 0.3425532, 'binary_recall': 0.61923075, 'binary_specificity': 0.9480323, 'binary_f1_score': 0.4410959}
confusion matrix:
      0    1
0  5637  309
1    99  161
early stop counter: 1
val acc:0.9151014089584351, best validation acc: 0.9227321147918701, corresponding to test acc:                         0.9495649337768555 / 0.9495649337768555
after epoch: 10,now: 2024-08-05 07:16:03.007230,epoch time: 0:13:42.377775,used: 2:16:23.611228,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9667106, 'precision': 0.9667679, 'recall': 0.9667069, 'specificity': 0.9667069, 'f1': 0.9667094, 'auroc': 0.99437726, 'binary_precision': 0.96176815, 'binary_recall': 0.97211045, 'binary_specificity': 0.9613033, 'binary_f1_score': 0.9669116}
confusion matrix:
       0      1
0  27674   1114
1    804  28024
---- Validation: 
scalar performance:
{'acc': 0.888794, 'precision': 0.59024984, 'recall': 0.78139067, 'specificity': 0.78139067, 'f1': 0.6201326, 'auroc': 0.82815707, 'binary_precision': 0.19419159, 'binary_recall': 0.66567606, 'binary_specificity': 0.8971052, 'binary_f1_score': 0.30067113}
confusion matrix:
       0     1
0  16208  1859
1    225   448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.910087, 'precision': 0.6333734, 'recall': 0.82250965, 'specificity': 0.82250965, 'f1': 0.6776115, 'auroc': 0.88367295, 'binary_precision': 0.2795858, 'binary_recall': 0.72692305, 'binary_specificity': 0.9180962, 'binary_f1_score': 0.40384617}
confusion matrix:
      0    1
0  5459  487
1    71  189
early stop counter: 2
val acc:0.8887940049171448, best validation acc: 0.9227321147918701, corresponding to test acc:                         0.9495649337768555 / 0.9495649337768555
after epoch: 11,now: 2024-08-05 07:30:26.622907,epoch time: 0:14:23.615677,used: 2:30:47.226905,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96792555, 'precision': 0.96793175, 'recall': 0.9679271, 'specificity': 0.9679271, 'f1': 0.9679255, 'auroc': 0.9944489, 'binary_precision': 0.96984047, 'binary_recall': 0.96593827, 'binary_specificity': 0.9699159, 'binary_f1_score': 0.96788543}
confusion matrix:
       0      1
0  27920    866
1    982  27848
---- Validation: 
scalar performance:
{'acc': 0.9003735, 'precision': 0.59739226, 'recall': 0.77452123, 'specificity': 0.77452123, 'f1': 0.63082147, 'auroc': 0.8271556, 'binary_precision': 0.20934762, 'binary_recall': 0.63893014, 'binary_specificity': 0.9101124, 'binary_f1_score': 0.31536487}
confusion matrix:
       0     1
0  16443  1624
1    243   430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9212053, 'precision': 0.6465089, 'recall': 0.815439, 'specificity': 0.815439, 'f1': 0.6922122, 'auroc': 0.8880255, 'binary_precision': 0.306914, 'binary_recall': 0.7, 'binary_specificity': 0.9308779, 'binary_f1_score': 0.4267292}
confusion matrix:
      0    1
0  5535  411
1    78  182
early stop counter: 3
val acc:0.9003735184669495, best validation acc: 0.9227321147918701, corresponding to test acc:                         0.9495649337768555 / 0.9495649337768555
after epoch: 12,now: 2024-08-05 07:44:12.589852,epoch time: 0:13:45.966945,used: 2:44:33.193850,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_59_39_seed_1_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 2:44:33.193850 at 2024-08-05 07:44:12.589852
persisted model performance metric: 

scalar performance:
{'acc': 0.94956493, 'precision': 0.7042288, 'recall': 0.7787472, 'specificity': 0.7787472, 'f1': 0.73471427, 'auroc': 0.86187196, 'binary_precision': 0.4265928, 'binary_recall': 0.5923077, 'binary_specificity': 0.96518666, 'binary_f1_score': 0.4959742}
confusion matrix:
      0    1
0  5739  207
1   106  154
oracle model performance metric: 

scalar performance:
{'acc': 0.94956493, 'precision': 0.7042288, 'recall': 0.7787472, 'specificity': 0.7787472, 'f1': 0.73471427, 'auroc': 0.86187196, 'binary_precision': 0.4265928, 'binary_recall': 0.5923077, 'binary_specificity': 0.96518666, 'binary_f1_score': 0.4959742}
confusion matrix:
      0    1
0  5739  207
1   106  154
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 255143 KiB | 664665 KiB | 723190 GiB | 723190 GiB |
|       from large pool | 218112 KiB | 591936 KiB | 722882 GiB | 722882 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    308 GiB |    308 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 255143 KiB | 664665 KiB | 723190 GiB | 723190 GiB |
|       from large pool | 218112 KiB | 591936 KiB | 722882 GiB | 722882 GiB |
|       from small pool |  37031 KiB |  75475 KiB |    308 GiB |    308 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 249982 KiB | 656104 KiB | 721175 GiB | 721175 GiB |
|       from large pool | 214016 KiB | 584512 KiB | 720885 GiB | 720885 GiB |
|       from small pool |  35966 KiB |  74336 KiB |    289 GiB |    289 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 768000 KiB |    808 MiB |   1240 MiB | 501760 KiB |
|       from large pool | 692224 KiB |    734 MiB |   1140 MiB | 475136 KiB |
|       from small pool |  75776 KiB |     74 MiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50008 KiB | 251573 KiB | 400343 GiB | 400343 GiB |
|       from large pool |  37888 KiB | 250176 KiB | 400027 GiB | 400027 GiB |
|       from small pool |  12120 KiB |  19703 KiB |    316 GiB |    316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7951    |   89435 K  |   89432 K  |
|       from large pool |      36    |      76    |   34587 K  |   34587 K  |
|       from small pool |    3192    |    7914    |   54848 K  |   54844 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7951    |   89435 K  |   89432 K  |
|       from large pool |      36    |      76    |   34587 K  |   34587 K  |
|       from small pool |    3192    |    7914    |   54848 K  |   54844 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      54    |      73    |      20    |
|       from large pool |      16    |      17    |      23    |       7    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3616    |   45961 K  |   45961 K  |
|       from large pool |       4    |      12    |   17708 K  |   17708 K  |
|       from small pool |      30    |    3612    |   28253 K  |   28253 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 723190 GiB | 723190 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 722882 GiB | 722882 GiB |
|       from small pool |      0 KiB |  75475 KiB |    308 GiB |    308 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 723190 GiB | 723190 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 722882 GiB | 722882 GiB |
|       from small pool |      0 KiB |  75475 KiB |    308 GiB |    308 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 721175 GiB | 721175 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 720885 GiB | 720885 GiB |
|       from small pool |      0 KiB |  74336 KiB |    289 GiB |    289 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 305152 KiB |    808 MiB |   1240 MiB |    942 MiB |
|       from large pool | 256000 KiB |    734 MiB |   1140 MiB |    890 MiB |
|       from small pool |  49152 KiB |     74 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 251573 KiB | 400343 GiB | 400343 GiB |
|       from large pool |  47104 KiB | 250176 KiB | 400027 GiB | 400027 GiB |
|       from small pool |      0 KiB |  19715 KiB |    316 GiB |    316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7951    |   89435 K  |   89435 K  |
|       from large pool |       2    |      76    |   34587 K  |   34587 K  |
|       from small pool |       0    |    7914    |   54848 K  |   54848 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7951    |   89435 K  |   89435 K  |
|       from large pool |       2    |      76    |   34587 K  |   34587 K  |
|       from small pool |       0    |    7914    |   54848 K  |   54848 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      54    |      73    |      40    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3616    |   45963 K  |   45963 K  |
|       from large pool |       2    |      12    |   17708 K  |   17708 K  |
|       from small pool |       0    |    3612    |   28254 K  |   28254 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB | 723190 GiB | 723190 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 722882 GiB | 722882 GiB |
|       from small pool |      0 KiB |  75475 KiB |    308 GiB |    308 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB | 723190 GiB | 723190 GiB |
|       from large pool |  65536 KiB | 591936 KiB | 722882 GiB | 722882 GiB |
|       from small pool |      0 KiB |  75475 KiB |    308 GiB |    308 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB | 721175 GiB | 721175 GiB |
|       from large pool |  65536 KiB | 584512 KiB | 720885 GiB | 720885 GiB |
|       from small pool |      0 KiB |  74336 KiB |    289 GiB |    289 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 305152 KiB |    808 MiB |   1240 MiB |    942 MiB |
|       from large pool | 256000 KiB |    734 MiB |   1140 MiB |    890 MiB |
|       from small pool |  49152 KiB |     74 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 251573 KiB | 400343 GiB | 400343 GiB |
|       from large pool |  47104 KiB | 250176 KiB | 400027 GiB | 400027 GiB |
|       from small pool |      0 KiB |  19715 KiB |    316 GiB |    316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7951    |   89435 K  |   89435 K  |
|       from large pool |       2    |      76    |   34587 K  |   34587 K  |
|       from small pool |       0    |    7914    |   54848 K  |   54848 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7951    |   89435 K  |   89435 K  |
|       from large pool |       2    |      76    |   34587 K  |   34587 K  |
|       from small pool |       0    |    7914    |   54848 K  |   54848 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      54    |      73    |      40    |
|       from large pool |       9    |      17    |      23    |      14    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3616    |   45963 K  |   45963 K  |
|       from large pool |       2    |      12    |   17708 K  |   17708 K  |
|       from small pool |       0    |    3612    |   28254 K  |   28254 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123

 Experiment start at: 2024-08-05 07:50:23.409691
before training, model accuracy: 0.054656196385622025
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9154775, 'precision': 0.9162556, 'recall': 0.9154805, 'specificity': 0.9154805, 'f1': 0.9154384, 'auroc': 0.97383773, 'binary_precision': 0.93428695, 'binary_recall': 0.89384687, 'binary_specificity': 0.93711406, 'binary_f1_score': 0.91361964}
confusion matrix:
       0      1
0  27315   1833
1   3095  26061
---- Validation: 
scalar performance:
{'acc': 0.8595856, 'precision': 0.5392404, 'recall': 0.64800596, 'specificity': 0.64800596, 'f1': 0.5424771, 'auroc': 0.7106404, 'binary_precision': 0.09992132, 'binary_recall': 0.42192692, 'binary_specificity': 0.87408507, 'binary_f1_score': 0.1615776}
confusion matrix:
       0     1
0  15883  2288
1    348   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8945344, 'precision': 0.58608735, 'recall': 0.7230723, 'specificity': 0.7230723, 'f1': 0.613152, 'auroc': 0.8033707, 'binary_precision': 0.1923077, 'binary_recall': 0.5371901, 'binary_specificity': 0.9089545, 'binary_f1_score': 0.2832244}
confusion matrix:
      0    1
0  5451  546
1   112  130
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 08:04:22.453982,epoch time: 0:13:59.044291,used: 0:13:59.044291,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9428684, 'precision': 0.9438492, 'recall': 0.94287324, 'specificity': 0.94287324, 'f1': 0.94283724, 'auroc': 0.98612094, 'binary_precision': 0.96476513, 'binary_recall': 0.919336, 'binary_specificity': 0.96641046, 'binary_f1_score': 0.94150287}
confusion matrix:
       0      1
0  28167    979
1   2352  26806
---- Validation: 
scalar performance:
{'acc': 0.9026261, 'precision': 0.56487066, 'recall': 0.67666364, 'specificity': 0.67666364, 'f1': 0.58542424, 'auroc': 0.7653432, 'binary_precision': 0.14971429, 'binary_recall': 0.43521595, 'binary_specificity': 0.91811126, 'binary_f1_score': 0.22278912}
confusion matrix:
       0     1
0  16683  1488
1    340   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9281936, 'precision': 0.6308918, 'recall': 0.74454653, 'specificity': 0.74454653, 'f1': 0.6663554, 'auroc': 0.827865, 'binary_precision': 0.28085107, 'binary_recall': 0.54545456, 'binary_specificity': 0.9436385, 'binary_f1_score': 0.37078652}
confusion matrix:
      0    1
0  5659  338
1   110  132
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-05 08:18:19.280677,epoch time: 0:13:56.826695,used: 0:27:55.870986,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9512898, 'precision': 0.9512913, 'recall': 0.95129, 'specificity': 0.95129, 'f1': 0.9512898, 'auroc': 0.98892426, 'binary_precision': 0.9521682, 'binary_recall': 0.95033956, 'binary_specificity': 0.95224047, 'binary_f1_score': 0.95125306}
confusion matrix:
       0      1
0  27754   1392
1   1448  27710
---- Validation: 
scalar performance:
{'acc': 0.8837692, 'precision': 0.56260306, 'recall': 0.7094844, 'specificity': 0.7094844, 'f1': 0.58060974, 'auroc': 0.77016497, 'binary_precision': 0.14253394, 'binary_recall': 0.5232558, 'binary_specificity': 0.895713, 'binary_f1_score': 0.22403982}
confusion matrix:
       0     1
0  16276  1895
1    287   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8959769, 'precision': 0.5962731, 'recall': 0.75752926, 'specificity': 0.75752926, 'f1': 0.62775373, 'auroc': 0.8483815, 'binary_precision': 0.20970044, 'binary_recall': 0.607438, 'binary_specificity': 0.9076205, 'binary_f1_score': 0.31177095}
confusion matrix:
      0    1
0  5443  554
1    95  147
early stop counter: 1
val acc:0.8837692141532898, best validation acc: 0.902626097202301, corresponding to test acc:                         0.9281936287879944 / 0.9281936287879944
after epoch: 3,now: 2024-08-05 08:32:10.876640,epoch time: 0:13:51.595963,used: 0:41:47.466949,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9543942, 'precision': 0.9547477, 'recall': 0.9543966, 'specificity': 0.9543966, 'f1': 0.9543855, 'auroc': 0.9905766, 'binary_precision': 0.9674688, 'binary_recall': 0.940426, 'binary_specificity': 0.9683672, 'binary_f1_score': 0.9537557}
confusion matrix:
       0      1
0  28225    922
1   1737  27420
---- Validation: 
scalar performance:
{'acc': 0.90720713, 'precision': 0.5786336, 'recall': 0.7143642, 'specificity': 0.7143642, 'f1': 0.6052416, 'auroc': 0.789814, 'binary_precision': 0.17465754, 'binary_recall': 0.50830567, 'binary_specificity': 0.9204227, 'binary_f1_score': 0.25998303}
confusion matrix:
       0     1
0  16725  1446
1    296   306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92322487, 'precision': 0.6270095, 'recall': 0.7598066, 'specificity': 0.7598066, 'f1': 0.6648421, 'auroc': 0.83847916, 'binary_precision': 0.2716763, 'binary_recall': 0.58264464, 'binary_specificity': 0.9369685, 'binary_f1_score': 0.37056506}
confusion matrix:
      0    1
0  5619  378
1   101  141
better model found
persisted
after epoch: 4,now: 2024-08-05 08:45:52.441159,epoch time: 0:13:41.564519,used: 0:55:29.031468,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9571556, 'precision': 0.9574758, 'recall': 0.9571583, 'specificity': 0.9571583, 'f1': 0.95714825, 'auroc': 0.9912174, 'binary_precision': 0.9696308, 'binary_recall': 0.9438919, 'binary_specificity': 0.9704248, 'binary_f1_score': 0.9565882}
confusion matrix:
       0      1
0  28284    862
1   1636  27522
---- Validation: 
scalar performance:
{'acc': 0.90976405, 'precision': 0.5851514, 'recall': 0.73094285, 'specificity': 0.73094285, 'f1': 0.61459076, 'auroc': 0.8060329, 'binary_precision': 0.18656716, 'binary_recall': 0.5398671, 'binary_specificity': 0.9220186, 'binary_f1_score': 0.27730376}
confusion matrix:
       0     1
0  16754  1417
1    277   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9275525, 'precision': 0.6360432, 'recall': 0.7680059, 'specificity': 0.7680059, 'f1': 0.67534083, 'auroc': 0.85018593, 'binary_precision': 0.28915662, 'binary_recall': 0.59504133, 'binary_specificity': 0.9409705, 'binary_f1_score': 0.38918915}
confusion matrix:
      0    1
0  5643  354
1    98  144
better model found
persisted
after epoch: 5,now: 2024-08-05 08:59:46.949404,epoch time: 0:13:54.508245,used: 1:09:23.539713,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9605516, 'precision': 0.9607639, 'recall': 0.9605534, 'specificity': 0.9605534, 'f1': 0.96054715, 'auroc': 0.99211717, 'binary_precision': 0.9706965, 'binary_recall': 0.94978905, 'binary_specificity': 0.9713178, 'binary_f1_score': 0.96012896}
confusion matrix:
       0      1
0  28311    836
1   1464  27693
---- Validation: 
scalar performance:
{'acc': 0.9200447, 'precision': 0.593579, 'recall': 0.72420776, 'specificity': 0.72420776, 'f1': 0.62497187, 'auroc': 0.8106562, 'binary_precision': 0.20408164, 'binary_recall': 0.51495016, 'binary_specificity': 0.9334654, 'binary_f1_score': 0.29231495}
confusion matrix:
       0     1
0  16962  1209
1    292   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9418176, 'precision': 0.66443413, 'recall': 0.7615471, 'specificity': 0.7615471, 'f1': 0.69974256, 'auroc': 0.84918493, 'binary_precision': 0.34683543, 'binary_recall': 0.5661157, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.43014127}
confusion matrix:
      0    1
0  5739  258
1   105  137
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-05 09:13:36.263050,epoch time: 0:13:49.313646,used: 1:23:12.853359,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96161497, 'precision': 0.9618441, 'recall': 0.9616173, 'specificity': 0.9616173, 'f1': 0.9616104, 'auroc': 0.99320734, 'binary_precision': 0.9721813, 'binary_recall': 0.95044243, 'binary_specificity': 0.97279215, 'binary_f1_score': 0.96118903}
confusion matrix:
       0      1
0  28353    793
1   1445  27713
---- Validation: 
scalar performance:
{'acc': 0.90976405, 'precision': 0.5868051, 'recall': 0.7373673, 'specificity': 0.7373673, 'f1': 0.61702967, 'auroc': 0.81086636, 'binary_precision': 0.18941979, 'binary_recall': 0.55315614, 'binary_specificity': 0.92157835, 'binary_f1_score': 0.28220338}
confusion matrix:
       0     1
0  16746  1425
1    269   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9285142, 'precision': 0.63981044, 'recall': 0.7764371, 'specificity': 0.7764371, 'f1': 0.6804595, 'auroc': 0.8533075, 'binary_precision': 0.296, 'binary_recall': 0.61157024, 'binary_specificity': 0.94130397, 'binary_f1_score': 0.39892182}
confusion matrix:
      0    1
0  5645  352
1    94  148
early stop counter: 1
val acc:0.9097640514373779, best validation acc: 0.9200447201728821, corresponding to test acc:                         0.941817581653595 / 0.941817581653595
after epoch: 7,now: 2024-08-05 09:27:27.623937,epoch time: 0:13:51.360887,used: 1:37:04.214246,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9653025, 'precision': 0.965317, 'recall': 0.96530306, 'specificity': 0.96530306, 'f1': 0.9653023, 'auroc': 0.9937295, 'binary_precision': 0.96795666, 'binary_recall': 0.962479, 'binary_specificity': 0.9681271, 'binary_f1_score': 0.96521}
confusion matrix:
       0      1
0  28218    929
1   1094  28063
---- Validation: 
scalar performance:
{'acc': 0.9098173, 'precision': 0.59476346, 'recall': 0.7695167, 'specificity': 0.7695167, 'f1': 0.6288195, 'auroc': 0.83315194, 'binary_precision': 0.20304845, 'binary_recall': 0.6196013, 'binary_specificity': 0.91943204, 'binary_f1_score': 0.30586305}
confusion matrix:
       0     1
0  16707  1464
1    229   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94053537, 'precision': 0.667769, 'recall': 0.7906212, 'specificity': 0.7906212, 'f1': 0.70946884, 'auroc': 0.87179816, 'binary_precision': 0.35103926, 'binary_recall': 0.6280992, 'binary_specificity': 0.95314324, 'binary_f1_score': 0.45037034}
confusion matrix:
      0    1
0  5716  281
1    90  152
early stop counter: 2
val acc:0.9098172783851624, best validation acc: 0.9200447201728821, corresponding to test acc:                         0.941817581653595 / 0.941817581653595
after epoch: 8,now: 2024-08-05 09:42:54.953793,epoch time: 0:15:27.329856,used: 1:52:31.544102,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96449643, 'precision': 0.96449715, 'recall': 0.9644966, 'specificity': 0.9644966, 'f1': 0.96449643, 'auroc': 0.99381435, 'binary_precision': 0.965143, 'binary_recall': 0.9638191, 'binary_specificity': 0.96517414, 'binary_f1_score': 0.96448064}
confusion matrix:
       0      1
0  28130   1015
1   1055  28104
---- Validation: 
scalar performance:
{'acc': 0.89921695, 'precision': 0.58476007, 'recall': 0.76404095, 'specificity': 0.76404095, 'f1': 0.6142952, 'auroc': 0.8290936, 'binary_precision': 0.18320236, 'binary_recall': 0.6196013, 'binary_specificity': 0.9084805, 'binary_f1_score': 0.28279}
confusion matrix:
       0     1
0  16508  1663
1    229   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91713417, 'precision': 0.6281332, 'recall': 0.7982758, 'specificity': 0.7982758, 'f1': 0.67041415, 'auroc': 0.8647636, 'binary_precision': 0.27045074, 'binary_recall': 0.6694215, 'binary_specificity': 0.9271302, 'binary_f1_score': 0.3852556}
confusion matrix:
      0    1
0  5560  437
1    80  162
early stop counter: 3
val acc:0.8992169499397278, best validation acc: 0.9200447201728821, corresponding to test acc:                         0.941817581653595 / 0.941817581653595
after epoch: 9,now: 2024-08-05 10:03:09.455397,epoch time: 0:20:14.501604,used: 2:12:46.045706,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_07_50_23_seed_2_24067123
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 2:12:46.045706 at 2024-08-05 10:03:09.455397
persisted model performance metric: 

scalar performance:
{'acc': 0.9418176, 'precision': 0.66443413, 'recall': 0.7615471, 'specificity': 0.7615471, 'f1': 0.69974256, 'auroc': 0.84918493, 'binary_precision': 0.34683543, 'binary_recall': 0.5661157, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.43014127}
confusion matrix:
      0    1
0  5739  258
1   105  137
oracle model performance metric: 

scalar performance:
{'acc': 0.9418176, 'precision': 0.66443413, 'recall': 0.7615471, 'specificity': 0.7615471, 'f1': 0.69974256, 'auroc': 0.84918493, 'binary_precision': 0.34683543, 'binary_recall': 0.5661157, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.43014127}
confusion matrix:
      0    1
0  5739  258
1   105  137
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 255149 KiB | 664665 KiB |    945 TiB |    945 TiB |
|       from large pool | 218112 KiB | 591936 KiB |    945 TiB |    945 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 255149 KiB | 664665 KiB |    945 TiB |    945 TiB |
|       from large pool | 218112 KiB | 591936 KiB |    945 TiB |    945 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 249983 KiB | 656104 KiB |    942 TiB |    942 TiB |
|       from large pool | 214016 KiB | 584512 KiB |    942 TiB |    942 TiB |
|       from small pool |  35967 KiB |  74336 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 768000 KiB |    808 MiB |   1692 MiB |    942 MiB |
|       from large pool | 692224 KiB |    734 MiB |   1566 MiB |    890 MiB |
|       from small pool |  75776 KiB |     74 MiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  52050 KiB | 255687 KiB | 520728 GiB | 520728 GiB |
|       from large pool |  37888 KiB | 254684 KiB | 520306 GiB | 520306 GiB |
|       from small pool |  14162 KiB |  19715 KiB |    421 GiB |    421 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    8037    |  119720 K  |  119717 K  |
|       from large pool |      36    |      76    |   46309 K  |   46309 K  |
|       from small pool |    3204    |    8000    |   73411 K  |   73407 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    8037    |  119720 K  |  119717 K  |
|       from large pool |      36    |      76    |   46309 K  |   46309 K  |
|       from small pool |    3204    |    8000    |   73411 K  |   73407 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      54    |      93    |      40    |
|       from large pool |      16    |      17    |      30    |      14    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3659    |   61217 K  |   61217 K  |
|       from large pool |       4    |      12    |   23439 K  |   23439 K  |
|       from small pool |      33    |    3655    |   37777 K  |   37777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB | 664665 KiB |    945 TiB |    945 TiB |
|       from large pool |  65536 KiB | 591936 KiB |    945 TiB |    945 TiB |
|       from small pool |      0 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB | 664665 KiB |    945 TiB |    945 TiB |
|       from large pool |  65536 KiB | 591936 KiB |    945 TiB |    945 TiB |
|       from small pool |      0 KiB |  75475 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB | 656104 KiB |    942 TiB |    942 TiB |
|       from large pool |  65536 KiB | 584512 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  74336 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 307200 KiB |    808 MiB |   1692 MiB |   1392 MiB |
|       from large pool | 256000 KiB |    734 MiB |   1566 MiB |   1316 MiB |
|       from small pool |  51200 KiB |     74 MiB |    126 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47104 KiB | 255687 KiB | 520728 GiB | 520728 GiB |
|       from large pool |  47104 KiB | 254684 KiB | 520306 GiB | 520306 GiB |
|       from small pool |      0 KiB |  21757 KiB |    421 GiB |    421 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8037    |  119720 K  |  119720 K  |
|       from large pool |       2    |      76    |   46309 K  |   46309 K  |
|       from small pool |       0    |    8000    |   73411 K  |   73411 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8037    |  119720 K  |  119720 K  |
|       from large pool |       2    |      76    |   46309 K  |   46309 K  |
|       from small pool |       0    |    8000    |   73411 K  |   73411 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      54    |      93    |      59    |
|       from large pool |       9    |      17    |      30    |      21    |
|       from small pool |      25    |      37    |      63    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3659    |   61218 K  |   61218 K  |
|       from large pool |       2    |      12    |   23439 K  |   23439 K  |
|       from small pool |       0    |    3655    |   37778 K  |   37778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 10:04:00 2024]
Finished job 0.
1 of 1 steps (100%) done
