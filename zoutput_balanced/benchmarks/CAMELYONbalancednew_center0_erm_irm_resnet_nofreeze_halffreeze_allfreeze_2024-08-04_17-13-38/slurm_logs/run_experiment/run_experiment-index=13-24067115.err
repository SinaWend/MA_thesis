Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 17:16:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115

 Experiment start at: 2024-08-04 17:30:20.507068
before training, model accuracy: 0.31048259139060974
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96011156, 'precision': 0.9606174, 'recall': 0.9600984, 'specificity': 0.9600984, 'f1': 0.9600998, 'auroc': 0.9936669, 'binary_precision': 0.94555205, 'binary_recall': 0.97651815, 'binary_specificity': 0.9436787, 'binary_f1_score': 0.9607856}
confusion matrix:
       0      1
0  27043   1614
1    674  28029
---- Validation: 
scalar performance:
{'acc': 0.9156024, 'precision': 0.6040636, 'recall': 0.7597917, 'specificity': 0.7597917, 'f1': 0.6397604, 'auroc': 0.80216205, 'binary_precision': 0.2234604, 'binary_recall': 0.592535, 'binary_specificity': 0.9270483, 'binary_f1_score': 0.3245315}
confusion matrix:
       0     1
0  16825  1324
1    262   381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8887824, 'precision': 0.61573327, 'recall': 0.837528, 'specificity': 0.837528, 'f1': 0.6542884, 'auroc': 0.90382934, 'binary_precision': 0.24199288, 'binary_recall': 0.7816092, 'binary_specificity': 0.89344674, 'binary_f1_score': 0.36956522}
confusion matrix:
      0    1
0  5358  639
1    57  204
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 17:44:16.237771,epoch time: 0:13:55.730703,used: 0:13:55.730703,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9543236, 'precision': 0.9563978, 'recall': 0.954299, 'specificity': 0.954299, 'f1': 0.9542699, 'auroc': 0.99567986, 'binary_precision': 0.92581224, 'binary_recall': 0.987875, 'binary_specificity': 0.92072296, 'binary_f1_score': 0.95583725}
confusion matrix:
       0      1
0  26387   2272
1    348  28353
---- Validation: 
scalar performance:
{'acc': 0.8082163, 'precision': 0.5504879, 'recall': 0.74844956, 'specificity': 0.74844956, 'f1': 0.54368556, 'auroc': 0.78633344, 'binary_precision': 0.1145535, 'binary_recall': 0.6842924, 'binary_specificity': 0.81260675, 'binary_f1_score': 0.19625334}
confusion matrix:
       0     1
0  14748  3401
1    203   440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73090446, 'precision': 0.56002635, 'recall': 0.8174528, 'specificity': 0.8174528, 'f1': 0.5288797, 'auroc': 0.9192227, 'binary_precision': 0.12532912, 'binary_recall': 0.9118774, 'binary_specificity': 0.7230282, 'binary_f1_score': 0.22037037}
confusion matrix:
      0     1
0  4336  1661
1    23   238
early stop counter: 1
val acc:0.8082162737846375, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 2,now: 2024-08-04 17:54:29.141387,epoch time: 0:10:12.903616,used: 0:24:08.634319,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.951447, 'precision': 0.95350015, 'recall': 0.951419, 'specificity': 0.951419, 'f1': 0.9513899, 'auroc': 0.99514985, 'binary_precision': 0.923195, 'binary_recall': 0.984915, 'binary_specificity': 0.917923, 'binary_f1_score': 0.9530568}
confusion matrix:
       0      1
0  26304   2352
1    433  28271
---- Validation: 
scalar performance:
{'acc': 0.66512346, 'precision': 0.51404667, 'recall': 0.59486246, 'specificity': 0.59486246, 'f1': 0.4452321, 'auroc': 0.6573305, 'binary_precision': 0.05286483, 'binary_recall': 0.5194401, 'binary_specificity': 0.67028487, 'binary_f1_score': 0.09596322}
confusion matrix:
       0     1
0  12165  5984
1    309   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5105465, 'precision': 0.5356989, 'recall': 0.7226343, 'specificity': 0.7226343, 'f1': 0.39890242, 'auroc': 0.9252697, 'binary_precision': 0.07545455, 'binary_recall': 0.954023, 'binary_specificity': 0.49124563, 'binary_f1_score': 0.13984835}
confusion matrix:
      0     1
0  2946  3051
1    12   249
early stop counter: 2
val acc:0.665123462677002, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 3,now: 2024-08-04 18:04:40.797587,epoch time: 0:10:11.656200,used: 0:34:20.290519,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90251046, 'precision': 0.91569006, 'recall': 0.9024422, 'specificity': 0.9024422, 'f1': 0.9017207, 'auroc': 0.9942794, 'binary_precision': 0.84186393, 'binary_recall': 0.99139434, 'binary_specificity': 0.81349015, 'binary_f1_score': 0.9105309}
confusion matrix:
       0      1
0  23313   5345
1    247  28455
---- Validation: 
scalar performance:
{'acc': 0.47302043, 'precision': 0.4992916, 'recall': 0.49465793, 'specificity': 0.49465793, 'f1': 0.3482202, 'auroc': 0.5956489, 'binary_precision': 0.03354826, 'binary_recall': 0.5178849, 'binary_specificity': 0.47143093, 'binary_f1_score': 0.063014485}
confusion matrix:
      0     1
0  8556  9593
1   310   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.24304889, 'precision': 0.52562463, 'recall': 0.60322016, 'specificity': 0.60322016, 'f1': 0.22317326, 'auroc': 0.9298634, 'binary_precision': 0.052041635, 'binary_recall': 0.99616855, 'binary_specificity': 0.2102718, 'binary_f1_score': 0.09891573}
confusion matrix:
      0     1
0  1261  4736
1     1   260
early stop counter: 3
val acc:0.47302043437957764, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 4,now: 2024-08-04 18:14:47.600427,epoch time: 0:10:06.802840,used: 0:44:27.093359,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95334727, 'precision': 0.955354, 'recall': 0.95332193, 'specificity': 0.95332193, 'f1': 0.953294, 'auroc': 0.99568176, 'binary_precision': 0.92531705, 'binary_recall': 0.98637724, 'binary_specificity': 0.92026657, 'binary_f1_score': 0.954872}
confusion matrix:
       0      1
0  26373   2285
1    391  28311
---- Validation: 
scalar performance:
{'acc': 0.6868348, 'precision': 0.5098145, 'recall': 0.5633496, 'specificity': 0.5633496, 'f1': 0.44854167, 'auroc': 0.6191689, 'binary_precision': 0.04779158, 'binary_recall': 0.43079317, 'binary_specificity': 0.6959061, 'binary_f1_score': 0.08603821}
confusion matrix:
       0     1
0  12630  5519
1    366   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42505592, 'precision': 0.5322176, 'recall': 0.690855, 'specificity': 0.690855, 'f1': 0.34827334, 'auroc': 0.93054193, 'binary_precision': 0.06651078, 'binary_recall': 0.9808429, 'binary_specificity': 0.4008671, 'binary_f1_score': 0.124574214}
confusion matrix:
      0     1
0  2404  3593
1     5   256
early stop counter: 4
val acc:0.6868348121643066, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 5,now: 2024-08-04 18:24:36.177167,epoch time: 0:09:48.576740,used: 0:54:15.670099,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9469665, 'precision': 0.95017755, 'recall': 0.9469328, 'specificity': 0.9469328, 'f1': 0.94686896, 'auroc': 0.99656296, 'binary_precision': 0.9123574, 'binary_recall': 0.98902553, 'binary_specificity': 0.90484, 'binary_f1_score': 0.94914573}
confusion matrix:
       0      1
0  25930   2727
1    315  28388
---- Validation: 
scalar performance:
{'acc': 0.71546406, 'precision': 0.51197785, 'recall': 0.57292104, 'specificity': 0.57292104, 'f1': 0.46151826, 'auroc': 0.63398516, 'binary_precision': 0.051487416, 'binary_recall': 0.41990668, 'binary_specificity': 0.72593534, 'binary_f1_score': 0.09172754}
confusion matrix:
       0     1
0  13175  4974
1    373   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5659955, 'precision': 0.5391812, 'recall': 0.7442361, 'specificity': 0.7442361, 'f1': 0.4305545, 'auroc': 0.9170058, 'binary_precision': 0.08319185, 'binary_recall': 0.93869734, 'binary_specificity': 0.5497749, 'binary_f1_score': 0.15283841}
confusion matrix:
      0     1
0  3297  2700
1    16   245
early stop counter: 5
val acc:0.7154640555381775, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 6,now: 2024-08-04 18:34:29.427000,epoch time: 0:09:53.249833,used: 1:04:08.919932,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9271967, 'precision': 0.9335569, 'recall': 0.92714816, 'specificity': 0.92714816, 'f1': 0.92692304, 'auroc': 0.9946202, 'binary_precision': 0.8812448, 'binary_recall': 0.9875971, 'binary_specificity': 0.8666992, 'binary_f1_score': 0.93139476}
confusion matrix:
       0      1
0  24837   3820
1    356  28347
---- Validation: 
scalar performance:
{'acc': 0.55401236, 'precision': 0.4991737, 'recall': 0.49383548, 'specificity': 0.49383548, 'f1': 0.3846365, 'auroc': 0.5398089, 'binary_precision': 0.033293124, 'binary_recall': 0.42923796, 'binary_specificity': 0.558433, 'binary_f1_score': 0.06179335}
confusion matrix:
       0     1
0  10135  8014
1    367   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3306168, 'precision': 0.5285754, 'recall': 0.6470774, 'specificity': 0.6470774, 'f1': 0.28680825, 'auroc': 0.88603, 'binary_precision': 0.05825461, 'binary_recall': 0.99233717, 'binary_specificity': 0.30181757, 'binary_f1_score': 0.11004886}
confusion matrix:
      0     1
0  1810  4187
1     2   259
early stop counter: 6
val acc:0.5540123581886292, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 7,now: 2024-08-04 18:44:25.664740,epoch time: 0:09:56.237740,used: 1:14:05.157672,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94008017, 'precision': 0.9443778, 'recall': 0.9400511, 'specificity': 0.9400511, 'f1': 0.93993217, 'auroc': 0.99586165, 'binary_precision': 0.90082514, 'binary_recall': 0.98912776, 'binary_specificity': 0.8909744, 'binary_f1_score': 0.9429136}
confusion matrix:
       0      1
0  25538   3125
1    312  28385
---- Validation: 
scalar performance:
{'acc': 0.7311622, 'precision': 0.5155381, 'recall': 0.5915489, 'specificity': 0.5915489, 'f1': 0.4715074, 'auroc': 0.62157166, 'binary_precision': 0.057062488, 'binary_recall': 0.44167963, 'binary_specificity': 0.74141824, 'binary_f1_score': 0.10106762}
confusion matrix:
       0     1
0  13456  4693
1    359   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5488974, 'precision': 0.5388101, 'recall': 0.7426443, 'specificity': 0.7426443, 'f1': 0.42147008, 'auroc': 0.91980857, 'binary_precision': 0.08137255, 'binary_recall': 0.954023, 'binary_specificity': 0.5312656, 'binary_f1_score': 0.14995484}
confusion matrix:
      0     1
0  3186  2811
1    12   249
early stop counter: 7
val acc:0.7311621904373169, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 8,now: 2024-08-04 18:54:22.447289,epoch time: 0:09:56.782549,used: 1:24:01.940221,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8625349, 'precision': 0.88922966, 'recall': 0.86243445, 'specificity': 0.86243445, 'f1': 0.86011326, 'auroc': 0.9899973, 'binary_precision': 0.7874879, 'binary_recall': 0.99334544, 'binary_specificity': 0.73152345, 'binary_f1_score': 0.8785185}
confusion matrix:
       0      1
0  20964   7694
1    191  28511
---- Validation: 
scalar performance:
{'acc': 0.37473392, 'precision': 0.48818994, 'recall': 0.41602153, 'specificity': 0.41602153, 'f1': 0.29123613, 'auroc': 0.5049085, 'binary_precision': 0.025301307, 'binary_recall': 0.46034214, 'binary_specificity': 0.3717009, 'binary_f1_score': 0.047966294}
confusion matrix:
      0      1
0  6746  11403
1   347    296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.11936721, 'precision': 0.5215057, 'recall': 0.5386879, 'specificity': 0.5386879, 'f1': 0.11820696, 'auroc': 0.8245427, 'binary_precision': 0.045060657, 'binary_recall': 0.99616855, 'binary_specificity': 0.08120727, 'binary_f1_score': 0.08622118}
confusion matrix:
     0     1
0  487  5510
1    1   260
early stop counter: 8
val acc:0.37473392486572266, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 9,now: 2024-08-04 19:04:25.793049,epoch time: 0:10:03.345760,used: 1:34:05.285981,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90209204, 'precision': 0.91527057, 'recall': 0.9020207, 'specificity': 0.9020207, 'f1': 0.9012976, 'auroc': 0.9938189, 'binary_precision': 0.84149337, 'binary_recall': 0.9910114, 'binary_specificity': 0.81303, 'binary_f1_score': 0.9101526}
confusion matrix:
       0      1
0  23299   5358
1    258  28445
---- Validation: 
scalar performance:
{'acc': 0.4675926, 'precision': 0.4950385, 'recall': 0.4625957, 'specificity': 0.4625957, 'f1': 0.34241462, 'auroc': 0.5611669, 'binary_precision': 0.029547738, 'binary_recall': 0.45723173, 'binary_specificity': 0.46795967, 'binary_f1_score': 0.05550835}
confusion matrix:
      0     1
0  8493  9656
1   349   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.23809524, 'precision': 0.52545416, 'recall': 0.6006355, 'specificity': 0.6006355, 'f1': 0.21933949, 'auroc': 0.885339, 'binary_precision': 0.05172071, 'binary_recall': 0.99616855, 'binary_specificity': 0.20510255, 'binary_f1_score': 0.098335855}
confusion matrix:
      0     1
0  1230  4767
1     1   260
early stop counter: 9
val acc:0.46759259700775146, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 10,now: 2024-08-04 19:14:19.860990,epoch time: 0:09:54.067941,used: 1:43:59.353922,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9273187, 'precision': 0.9341357, 'recall': 0.9272729, 'specificity': 0.9272729, 'f1': 0.92702687, 'auroc': 0.9956194, 'binary_precision': 0.87991697, 'binary_recall': 0.98982614, 'binary_specificity': 0.8647196, 'binary_f1_score': 0.93164116}
confusion matrix:
       0      1
0  24782   3877
1    292  28409
---- Validation: 
scalar performance:
{'acc': 0.64511496, 'precision': 0.5075736, 'recall': 0.55225146, 'specificity': 0.55225146, 'f1': 0.43020263, 'auroc': 0.572013, 'binary_precision': 0.044037532, 'binary_recall': 0.4525661, 'binary_specificity': 0.65193677, 'binary_f1_score': 0.08026479}
confusion matrix:
       0     1
0  11832  6317
1    352   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3657718, 'precision': 0.5301515, 'recall': 0.6654199, 'specificity': 0.6654199, 'f1': 0.3105558, 'auroc': 0.93066907, 'binary_precision': 0.06128727, 'binary_recall': 0.99233717, 'binary_specificity': 0.3385026, 'binary_f1_score': 0.11544462}
confusion matrix:
      0     1
0  2030  3967
1     2   259
early stop counter: 10
val acc:0.6451149582862854, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 11,now: 2024-08-04 19:24:24.235962,epoch time: 0:10:04.374972,used: 1:54:03.728894,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.91903764, 'precision': 0.92809784, 'recall': 0.91898704, 'specificity': 0.91898704, 'f1': 0.91860044, 'auroc': 0.9957994, 'binary_precision': 0.8659932, 'binary_recall': 0.99163765, 'binary_specificity': 0.84633636, 'binary_f1_score': 0.9245663}
confusion matrix:
       0      1
0  24256   4404
1    240  28460
---- Validation: 
scalar performance:
{'acc': 0.63793105, 'precision': 0.50643647, 'recall': 0.5447819, 'specificity': 0.5447819, 'f1': 0.42615524, 'auroc': 0.5900179, 'binary_precision': 0.04247735, 'binary_recall': 0.44479004, 'binary_specificity': 0.64477384, 'binary_f1_score': 0.07754881}
confusion matrix:
       0     1
0  11702  6447
1    357   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3456376, 'precision': 0.5292318, 'recall': 0.6549146, 'specificity': 0.6549146, 'f1': 0.29706684, 'auroc': 0.9217676, 'binary_precision': 0.05951287, 'binary_recall': 0.99233717, 'binary_specificity': 0.31749207, 'binary_f1_score': 0.11229134}
confusion matrix:
      0     1
0  1904  4093
1     2   259
early stop counter: 11
val acc:0.6379310488700867, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 12,now: 2024-08-04 19:34:16.610306,epoch time: 0:09:52.374344,used: 2:03:56.103238,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9276325, 'precision': 0.9331656, 'recall': 0.9275931, 'specificity': 0.9275931, 'f1': 0.92739606, 'auroc': 0.9928484, 'binary_precision': 0.8843829, 'binary_recall': 0.98400694, 'binary_specificity': 0.87117934, 'binary_f1_score': 0.9315389}
confusion matrix:
       0      1
0  24968   3692
1    459  28241
---- Validation: 
scalar performance:
{'acc': 0.718178, 'precision': 0.5140913, 'recall': 0.5855769, 'specificity': 0.5855769, 'f1': 0.46509933, 'auroc': 0.58516353, 'binary_precision': 0.054566342, 'binary_recall': 0.44323483, 'binary_specificity': 0.7279189, 'binary_f1_score': 0.09717014}
confusion matrix:
       0     1
0  13211  4938
1    358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4114733, 'precision': 0.5324366, 'recall': 0.68926513, 'specificity': 0.68926513, 'f1': 0.34018475, 'auroc': 0.9146502, 'binary_precision': 0.06573604, 'binary_recall': 0.99233717, 'binary_specificity': 0.3861931, 'binary_f1_score': 0.12330398}
confusion matrix:
      0     1
0  2316  3681
1     2   259
early stop counter: 12
val acc:0.7181779742240906, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 13,now: 2024-08-04 19:44:09.037408,epoch time: 0:09:52.427102,used: 2:13:48.530340,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9088738, 'precision': 0.91937655, 'recall': 0.90880764, 'specificity': 0.90880764, 'f1': 0.90828985, 'auroc': 0.99373204, 'binary_precision': 0.8532182, 'binary_recall': 0.9878414, 'binary_specificity': 0.82977384, 'binary_f1_score': 0.9156078}
confusion matrix:
       0      1
0  23778   4878
1    349  28355
---- Validation: 
scalar performance:
{'acc': 0.6095679, 'precision': 0.5045062, 'recall': 0.5323481, 'specificity': 0.5323481, 'f1': 0.4128654, 'auroc': 0.56372166, 'binary_precision': 0.039741475, 'binary_recall': 0.44945568, 'binary_specificity': 0.6152405, 'binary_f1_score': 0.0730259}
confusion matrix:
       0     1
0  11166  6983
1    354   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42793223, 'precision': 0.5326999, 'recall': 0.6941881, 'specificity': 0.6941881, 'f1': 0.35023618, 'auroc': 0.9114455, 'binary_precision': 0.06704931, 'binary_recall': 0.98467433, 'binary_specificity': 0.40370184, 'binary_f1_score': 0.12554958}
confusion matrix:
      0     1
0  2421  3576
1     4   257
early stop counter: 13
val acc:0.6095678806304932, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 14,now: 2024-08-04 19:54:05.854048,epoch time: 0:09:56.816640,used: 2:23:45.346980,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8868027, 'precision': 0.9040274, 'recall': 0.88671994, 'specificity': 0.88671994, 'f1': 0.8855676, 'auroc': 0.9923005, 'binary_precision': 0.82080543, 'binary_recall': 0.98989654, 'binary_specificity': 0.7835433, 'binary_f1_score': 0.89745575}
confusion matrix:
       0      1
0  22454   6203
1    290  28413
---- Validation: 
scalar performance:
{'acc': 0.50319284, 'precision': 0.49739248, 'recall': 0.4802764, 'specificity': 0.4802764, 'f1': 0.360779, 'auroc': 0.55575407, 'binary_precision': 0.03157668, 'binary_recall': 0.45567653, 'binary_specificity': 0.5048763, 'binary_f1_score': 0.059060674}
confusion matrix:
      0     1
0  9163  8986
1   350   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.18584213, 'precision': 0.52372783, 'recall': 0.57337195, 'specificity': 0.57337195, 'f1': 0.17715514, 'auroc': 0.85684204, 'binary_precision': 0.048561823, 'binary_recall': 0.99616855, 'binary_specificity': 0.1505753, 'binary_f1_score': 0.09260908}
confusion matrix:
     0     1
0  903  5094
1    1   260
early stop counter: 14
val acc:0.5031928420066833, best validation acc: 0.9156023859977722, corresponding to test acc:                         0.8887823820114136 / 0.8887823820114136
after epoch: 15,now: 2024-08-04 20:04:04.335015,epoch time: 0:09:58.480967,used: 2:33:43.827947,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_17_30_20_seed_0_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:43.827947 at 2024-08-04 20:04:04.335015
persisted model performance metric: 

scalar performance:
{'acc': 0.8887824, 'precision': 0.61573327, 'recall': 0.837528, 'specificity': 0.837528, 'f1': 0.6542884, 'auroc': 0.90382934, 'binary_precision': 0.24199288, 'binary_recall': 0.7816092, 'binary_specificity': 0.89344674, 'binary_f1_score': 0.36956522}
confusion matrix:
      0    1
0  5358  639
1    57  204
oracle model performance metric: 

scalar performance:
{'acc': 0.8887824, 'precision': 0.61573327, 'recall': 0.837528, 'specificity': 0.837528, 'f1': 0.6542884, 'auroc': 0.90382934, 'binary_precision': 0.24199288, 'binary_recall': 0.7816092, 'binary_specificity': 0.89344674, 'binary_f1_score': 0.36956522}
confusion matrix:
      0    1
0  5358  639
1    57  204
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 533599 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440491 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 533599 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool | 446432 KiB |   6319 MiB | 440492 GiB | 440491 GiB |
|       from small pool |  87167 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522828 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool | 436736 KiB |   6277 MiB | 439102 GiB | 439102 GiB |
|       from small pool |  86092 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6564 MiB |   6564 MiB |   6564 MiB |      0 B   |
|       from large pool |   6440 MiB |   6440 MiB |   6440 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    932 MiB |   1266 MiB | 238382 GiB | 238381 GiB |
|       from large pool |    928 MiB |   1263 MiB | 237669 GiB | 237668 GiB |
|       from small pool |      4 MiB |     10 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3630    |    8317    |   53654 K  |   53650 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31488 K  |   31484 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3630    |    8317    |   53654 K  |   53650 K  |
|       from large pool |      87    |     730    |   22165 K  |   22165 K  |
|       from small pool |    3543    |    8228    |   31488 K  |   31484 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     133    |     133    |       0    |
|       from large pool |      71    |      71    |      71    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3612    |   25028 K  |   25028 K  |
|       from large pool |      19    |      36    |    8794 K  |    8794 K  |
|       from small pool |      51    |    3594    |   16233 K  |   16233 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439102 GiB | 439102 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238382 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     22 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6391 MiB | 441183 GiB | 441183 GiB |
|       from large pool |  65536 KiB |   6319 MiB | 440492 GiB | 440492 GiB |
|       from small pool |      0 KiB |    122 MiB |    691 GiB |    691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB | 439784 GiB | 439784 GiB |
|       from large pool |  65536 KiB |   6277 MiB | 439102 GiB | 439102 GiB |
|       from small pool |      0 KiB |    121 MiB |    681 GiB |    681 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1454 MiB |   6564 MiB |   6564 MiB |   5110 MiB |
|       from large pool |   1364 MiB |   6440 MiB |   6440 MiB |   5076 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1266 MiB | 238383 GiB | 238382 GiB |
|       from large pool | 116736 KiB |   1263 MiB | 237669 GiB | 237669 GiB |
|       from small pool |      0 KiB |     22 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   53654 K  |   53654 K  |
|       from large pool |       2    |     730    |   22165 K  |   22165 K  |
|       from small pool |       0    |    8228    |   31488 K  |   31488 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     133    |     133    |      65    |
|       from large pool |      23    |      71    |      71    |      48    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   25029 K  |   25029 K  |
|       from large pool |       3    |      36    |    8794 K  |    8794 K  |
|       from small pool |       0    |    3594    |   16235 K  |   16235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115

 Experiment start at: 2024-08-04 20:10:18.708549
before training, model accuracy: 0.14582662284374237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9529992, 'precision': 0.9560195, 'recall': 0.9530289, 'specificity': 0.9530289, 'f1': 0.9529233, 'auroc': 0.9909905, 'binary_precision': 0.99331445, 'binary_recall': 0.9122065, 'binary_specificity': 0.99385136, 'binary_f1_score': 0.95103425}
confusion matrix:
       0      1
0  28610    177
1   2531  26298
---- Validation: 
scalar performance:
{'acc': 0.9566702, 'precision': 0.644758, 'recall': 0.58413106, 'specificity': 0.58413106, 'f1': 0.60511, 'auroc': 0.77764547, 'binary_precision': 0.3194805, 'binary_recall': 0.18276374, 'binary_specificity': 0.9854984, 'binary_f1_score': 0.23251417}
confusion matrix:
       0    1
0  17805  262
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.7737696, 'recall': 0.74543715, 'specificity': 0.74543715, 'f1': 0.758729, 'auroc': 0.8396944, 'binary_precision': 0.5689655, 'binary_recall': 0.50769234, 'binary_specificity': 0.98318195, 'binary_f1_score': 0.5365854}
confusion matrix:
      0    1
0  5846  100
1   128  132
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 20:21:42.578806,epoch time: 0:11:23.870257,used: 0:11:23.870257,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9704249, 'precision': 0.9707054, 'recall': 0.97041655, 'specificity': 0.97041655, 'f1': 0.97042006, 'auroc': 0.9953599, 'binary_precision': 0.9593862, 'binary_recall': 0.9824823, 'binary_specificity': 0.9583507, 'binary_f1_score': 0.9707969}
confusion matrix:
       0      1
0  27589   1199
1    505  28323
---- Validation: 
scalar performance:
{'acc': 0.88303095, 'precision': 0.5716293, 'recall': 0.7183193, 'specificity': 0.7183193, 'f1': 0.59294456, 'auroc': 0.77080023, 'binary_precision': 0.16199377, 'binary_recall': 0.5408618, 'binary_specificity': 0.8957768, 'binary_f1_score': 0.24931507}
confusion matrix:
       0     1
0  16184  1883
1    309   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377377, 'precision': 0.5872267, 'recall': 0.8344058, 'specificity': 0.8344058, 'f1': 0.60421884, 'auroc': 0.911847, 'binary_precision': 0.18320611, 'binary_recall': 0.83076924, 'binary_specificity': 0.8380424, 'binary_f1_score': 0.30020845}
confusion matrix:
      0    1
0  4983  963
1    44  216
early stop counter: 1
val acc:0.8830309510231018, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 2,now: 2024-08-04 20:31:42.906082,epoch time: 0:10:00.327276,used: 0:21:24.197533,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92946404, 'precision': 0.93471754, 'recall': 0.92942405, 'specificity': 0.92942405, 'f1': 0.9292458, 'auroc': 0.99331343, 'binary_precision': 0.8871104, 'binary_recall': 0.98428667, 'binary_specificity': 0.8745614, 'binary_f1_score': 0.93317556}
confusion matrix:
       0      1
0  25176   3611
1    453  28376
---- Validation: 
scalar performance:
{'acc': 0.46905017, 'precision': 0.4932515, 'recall': 0.45140398, 'specificity': 0.45140398, 'f1': 0.3430153, 'auroc': 0.53877485, 'binary_precision': 0.029516177, 'binary_recall': 0.43239227, 'binary_specificity': 0.47041568, 'binary_f1_score': 0.055260155}
confusion matrix:
      0     1
0  8499  9568
1   382   291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3781824, 'precision': 0.52983725, 'recall': 0.6663012, 'specificity': 0.6663012, 'f1': 0.3184677, 'auroc': 0.9079053, 'binary_precision': 0.062058896, 'binary_recall': 0.9807692, 'binary_specificity': 0.35183316, 'binary_f1_score': 0.116731524}
confusion matrix:
      0     1
0  2092  3854
1     5   255
early stop counter: 2
val acc:0.46905016899108887, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 3,now: 2024-08-04 20:41:46.424162,epoch time: 0:10:03.518080,used: 0:31:27.715613,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92691267, 'precision': 0.9323322, 'recall': 0.92687386, 'specificity': 0.92687386, 'f1': 0.92667836, 'auroc': 0.9929584, 'binary_precision': 0.8841005, 'binary_recall': 0.98275983, 'binary_specificity': 0.8709879, 'binary_f1_score': 0.93082315}
confusion matrix:
       0      1
0  25074   3714
1    497  28331
---- Validation: 
scalar performance:
{'acc': 0.6189968, 'precision': 0.5032522, 'recall': 0.5220174, 'specificity': 0.5220174, 'f1': 0.4165969, 'auroc': 0.55469894, 'binary_precision': 0.039977238, 'binary_recall': 0.41753343, 'binary_specificity': 0.6265014, 'binary_f1_score': 0.072968066}
confusion matrix:
       0     1
0  11319  6748
1    392   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4258782, 'precision': 0.53207195, 'recall': 0.68935287, 'specificity': 0.68935287, 'f1': 0.34880903, 'auroc': 0.91373324, 'binary_precision': 0.066649176, 'binary_recall': 0.97692305, 'binary_specificity': 0.40178272, 'binary_f1_score': 0.12478507}
confusion matrix:
      0     1
0  2389  3557
1     6   254
early stop counter: 3
val acc:0.618996798992157, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 4,now: 2024-08-04 20:51:42.602806,epoch time: 0:09:56.178644,used: 0:41:23.894257,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94105804, 'precision': 0.94274664, 'recall': 0.9410356, 'specificity': 0.9410356, 'f1': 0.9409996, 'auroc': 0.9910809, 'binary_precision': 0.91558546, 'binary_recall': 0.97179925, 'binary_specificity': 0.910272, 'binary_f1_score': 0.94285524}
confusion matrix:
       0      1
0  26204   2583
1    813  28016
---- Validation: 
scalar performance:
{'acc': 0.67086446, 'precision': 0.508078, 'recall': 0.55106306, 'specificity': 0.55106306, 'f1': 0.4418493, 'auroc': 0.5363626, 'binary_precision': 0.0468415, 'binary_recall': 0.42199108, 'binary_specificity': 0.6801351, 'binary_f1_score': 0.08432304}
confusion matrix:
       0     1
0  12288  5779
1    389   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37238157, 'precision': 0.5291999, 'recall': 0.66143495, 'specificity': 0.66143495, 'f1': 0.314524, 'auroc': 0.90467477, 'binary_precision': 0.06130823, 'binary_recall': 0.97692305, 'binary_specificity': 0.34594685, 'binary_f1_score': 0.115375884}
confusion matrix:
      0     1
0  2057  3889
1     6   254
early stop counter: 4
val acc:0.670864462852478, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 5,now: 2024-08-04 21:01:33.253780,epoch time: 0:09:50.650974,used: 0:51:14.545231,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8935886, 'precision': 0.90805805, 'recall': 0.8935232, 'specificity': 0.8935232, 'f1': 0.89262533, 'auroc': 0.99160814, 'binary_precision': 0.83139145, 'binary_recall': 0.9876162, 'binary_specificity': 0.7994303, 'binary_f1_score': 0.90279514}
confusion matrix:
       0      1
0  23014   5774
1    357  28471
---- Validation: 
scalar performance:
{'acc': 0.466222, 'precision': 0.49403587, 'recall': 0.4570899, 'specificity': 0.4570899, 'f1': 0.3422805, 'auroc': 0.51422983, 'binary_precision': 0.030306082, 'binary_recall': 0.4472511, 'binary_specificity': 0.46692866, 'binary_f1_score': 0.05676568}
confusion matrix:
      0     1
0  8436  9631
1   372   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.11633903, 'precision': 0.5226323, 'recall': 0.53884965, 'specificity': 0.53884965, 'f1': 0.11540185, 'auroc': 0.9225043, 'binary_precision': 0.045264624, 'binary_recall': 1.0, 'binary_specificity': 0.077699296, 'binary_f1_score': 0.08660893}
confusion matrix:
     0     1
0  462  5484
1    0   260
early stop counter: 5
val acc:0.46622198820114136, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 6,now: 2024-08-04 21:11:27.517604,epoch time: 0:09:54.263824,used: 1:01:08.809055,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92243475, 'precision': 0.92882895, 'recall': 0.92239034, 'specificity': 0.92239034, 'f1': 0.9221389, 'auroc': 0.9922471, 'binary_precision': 0.8766467, 'binary_recall': 0.9833501, 'binary_specificity': 0.8614305, 'binary_f1_score': 0.9269377}
confusion matrix:
       0      1
0  24798   3989
1    480  28349
---- Validation: 
scalar performance:
{'acc': 0.5766809, 'precision': 0.5019424, 'recall': 0.5136614, 'specificity': 0.5136614, 'f1': 0.39813134, 'auroc': 0.5342604, 'binary_precision': 0.03816794, 'binary_recall': 0.44576523, 'binary_specificity': 0.5815575, 'binary_f1_score': 0.07031524}
confusion matrix:
       0     1
0  10507  7560
1    373   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.26651627, 'precision': 0.5270158, 'recall': 0.61722165, 'specificity': 0.61722165, 'f1': 0.24118009, 'auroc': 0.928861, 'binary_precision': 0.054031588, 'binary_recall': 1.0, 'binary_specificity': 0.23444332, 'binary_f1_score': 0.102523655}
confusion matrix:
      0     1
0  1394  4552
1     0   260
early stop counter: 6
val acc:0.5766808986663818, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 7,now: 2024-08-04 21:21:24.152998,epoch time: 0:09:56.635394,used: 1:11:05.444449,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9656345, 'precision': 0.9662852, 'recall': 0.9656204, 'specificity': 0.9656204, 'f1': 0.96562177, 'auroc': 0.9958879, 'binary_precision': 0.94905674, 'binary_recall': 0.98414844, 'binary_specificity': 0.94709235, 'binary_f1_score': 0.9662841}
confusion matrix:
       0      1
0  27263   1523
1    457  28373
---- Validation: 
scalar performance:
{'acc': 0.78607255, 'precision': 0.5235455, 'recall': 0.6122434, 'specificity': 0.6122434, 'f1': 0.5015029, 'auroc': 0.5921962, 'binary_precision': 0.073183216, 'binary_recall': 0.42496285, 'binary_specificity': 0.799524, 'binary_f1_score': 0.12486357}
confusion matrix:
       0     1
0  14445  3622
1    387   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5794392, 'precision': 0.5411985, 'recall': 0.75477886, 'specificity': 0.75477886, 'f1': 0.43913183, 'auroc': 0.9328773, 'binary_precision': 0.08655876, 'binary_recall': 0.9461538, 'binary_specificity': 0.56340396, 'binary_f1_score': 0.15860735}
confusion matrix:
      0     1
0  3350  2596
1    14   246
early stop counter: 7
val acc:0.7860725522041321, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 8,now: 2024-08-04 21:31:25.540483,epoch time: 0:10:01.387485,used: 1:21:06.831934,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9401555, 'precision': 0.9435841, 'recall': 0.9401251, 'specificity': 0.9401251, 'f1': 0.9400368, 'auroc': 0.9944664, 'binary_precision': 0.9047589, 'binary_recall': 0.9839739, 'binary_specificity': 0.89627624, 'binary_f1_score': 0.9427052}
confusion matrix:
       0      1
0  25802   2986
1    462  28366
---- Validation: 
scalar performance:
{'acc': 0.68420494, 'precision': 0.5102923, 'recall': 0.5637039, 'specificity': 0.5637039, 'f1': 0.44938987, 'auroc': 0.5569517, 'binary_precision': 0.050094355, 'binary_recall': 0.43387815, 'binary_specificity': 0.69352967, 'binary_f1_score': 0.089818515}
confusion matrix:
       0     1
0  12530  5537
1    381   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4015469, 'precision': 0.53171384, 'recall': 0.68217224, 'specificity': 0.68217224, 'f1': 0.33387908, 'auroc': 0.9396651, 'binary_precision': 0.06476814, 'binary_recall': 0.98846155, 'binary_specificity': 0.37588295, 'binary_f1_score': 0.12157048}
confusion matrix:
      0     1
0  2235  3711
1     3   257
early stop counter: 8
val acc:0.6842049360275269, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 9,now: 2024-08-04 21:41:27.325376,epoch time: 0:10:01.784893,used: 1:31:08.616827,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.886351, 'precision': 0.90321785, 'recall': 0.8862765, 'specificity': 0.8862765, 'f1': 0.8851359, 'auroc': 0.9917965, 'binary_precision': 0.8209316, 'binary_recall': 0.98848385, 'binary_specificity': 0.7840692, 'binary_f1_score': 0.89695007}
confusion matrix:
       0      1
0  22571   6216
1    332  28497
---- Validation: 
scalar performance:
{'acc': 0.51360726, 'precision': 0.49755692, 'recall': 0.48238033, 'specificity': 0.48238033, 'f1': 0.366904, 'auroc': 0.5487202, 'binary_precision': 0.033384923, 'binary_recall': 0.448737, 'binary_specificity': 0.5160237, 'binary_f1_score': 0.062146313}
confusion matrix:
      0     1
0  9323  8744
1   371   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.19690622, 'precision': 0.5247902, 'recall': 0.5808947, 'specificity': 0.5808947, 'f1': 0.18649721, 'auroc': 0.92036664, 'binary_precision': 0.049580473, 'binary_recall': 1.0, 'binary_specificity': 0.16178943, 'binary_f1_score': 0.094476745}
confusion matrix:
     0     1
0  962  4984
1    0   260
early stop counter: 9
val acc:0.5136072635650635, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 10,now: 2024-08-04 21:51:25.107407,epoch time: 0:09:57.782031,used: 1:41:06.398858,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9127673, 'precision': 0.92275053, 'recall': 0.91270864, 'specificity': 0.91270864, 'f1': 0.9122409, 'auroc': 0.9943011, 'binary_precision': 0.85797644, 'binary_recall': 0.9894554, 'binary_specificity': 0.83596194, 'binary_f1_score': 0.9190373}
confusion matrix:
       0      1
0  24064   4722
1    304  28526
---- Validation: 
scalar performance:
{'acc': 0.5316969, 'precision': 0.49845496, 'recall': 0.48890102, 'specificity': 0.48890102, 'f1': 0.3756847, 'auroc': 0.5529501, 'binary_precision': 0.034256812, 'binary_recall': 0.44279346, 'binary_specificity': 0.53500855, 'binary_f1_score': 0.063593686}
confusion matrix:
      0     1
0  9666  8401
1   375   298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.26973897, 'precision': 0.5271286, 'recall': 0.61890346, 'specificity': 0.61890346, 'f1': 0.24358433, 'auroc': 0.93496966, 'binary_precision': 0.054257095, 'binary_recall': 1.0, 'binary_specificity': 0.23780693, 'binary_f1_score': 0.102929525}
confusion matrix:
      0     1
0  1414  4532
1     0   260
early stop counter: 10
val acc:0.5316969156265259, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 11,now: 2024-08-04 22:01:07.687588,epoch time: 0:09:42.580181,used: 1:50:48.979039,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9187205, 'precision': 0.9264649, 'recall': 0.9186691, 'specificity': 0.9186691, 'f1': 0.91834307, 'auroc': 0.9934087, 'binary_precision': 0.86918634, 'binary_recall': 0.98595214, 'binary_specificity': 0.8513861, 'binary_f1_score': 0.9238945}
confusion matrix:
       0      1
0  24508   4278
1    405  28425
---- Validation: 
scalar performance:
{'acc': 0.5877268, 'precision': 0.5023694, 'recall': 0.51652896, 'specificity': 0.51652896, 'f1': 0.40311855, 'auroc': 0.5511101, 'binary_precision': 0.038718116, 'binary_recall': 0.4398217, 'binary_specificity': 0.59323627, 'binary_f1_score': 0.071170956}
confusion matrix:
       0     1
0  10718  7349
1    377   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.33242023, 'precision': 0.5276445, 'recall': 0.6424196, 'specificity': 0.6424196, 'f1': 0.28782308, 'auroc': 0.8915005, 'binary_precision': 0.058046892, 'binary_recall': 0.9807692, 'binary_specificity': 0.30406997, 'binary_f1_score': 0.109606706}
confusion matrix:
      0     1
0  1808  4138
1     5   255
early stop counter: 11
val acc:0.5877267718315125, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 12,now: 2024-08-04 22:11:02.458198,epoch time: 0:09:54.770610,used: 2:00:43.749649,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.88400793, 'precision': 0.9018767, 'recall': 0.88393474, 'specificity': 0.88393474, 'f1': 0.88268995, 'auroc': 0.9913243, 'binary_precision': 0.8173091, 'binary_recall': 0.9893159, 'binary_specificity': 0.77855355, 'binary_f1_score': 0.8951242}
confusion matrix:
       0      1
0  22413   6375
1    308  28520
---- Validation: 
scalar performance:
{'acc': 0.40453574, 'precision': 0.4893675, 'recall': 0.42581314, 'specificity': 0.42581314, 'f1': 0.30871606, 'auroc': 0.5156404, 'binary_precision': 0.02723174, 'binary_recall': 0.448737, 'binary_specificity': 0.40288925, 'binary_f1_score': 0.051347442}
confusion matrix:
      0      1
0  7279  10788
1   371    302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.18063165, 'precision': 0.5243218, 'recall': 0.57240164, 'specificity': 0.57240164, 'f1': 0.17287458, 'auroc': 0.9261043, 'binary_precision': 0.048643593, 'binary_recall': 1.0, 'binary_specificity': 0.14480323, 'binary_f1_score': 0.09277431}
confusion matrix:
     0     1
0  861  5085
1    0   260
early stop counter: 12
val acc:0.4045357406139374, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 13,now: 2024-08-04 22:20:58.635055,epoch time: 0:09:56.176857,used: 2:10:39.926506,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93206745, 'precision': 0.9376464, 'recall': 0.93202835, 'specificity': 0.93202835, 'f1': 0.931846, 'auroc': 0.99481314, 'binary_precision': 0.88840735, 'binary_recall': 0.98837936, 'binary_specificity': 0.87567735, 'binary_f1_score': 0.9357307}
confusion matrix:
       0      1
0  25209   3579
1    335  28493
---- Validation: 
scalar performance:
{'acc': 0.6252935, 'precision': 0.5054522, 'recall': 0.5367273, 'specificity': 0.5367273, 'f1': 0.42143053, 'auroc': 0.5691298, 'binary_precision': 0.042776898, 'binary_recall': 0.44130757, 'binary_specificity': 0.632147, 'binary_f1_score': 0.0779937}
confusion matrix:
       0     1
0  11421  6646
1    376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4015469, 'precision': 0.5313815, 'recall': 0.68033326, 'specificity': 0.68033326, 'f1': 0.33372664, 'auroc': 0.92752385, 'binary_precision': 0.064548664, 'binary_recall': 0.9846154, 'binary_specificity': 0.37605113, 'binary_f1_score': 0.121154755}
confusion matrix:
      0     1
0  2236  3710
1     4   256
early stop counter: 13
val acc:0.625293493270874, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 14,now: 2024-08-04 22:31:05.404525,epoch time: 0:10:06.769470,used: 2:20:46.695976,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8484622, 'precision': 0.88021016, 'recall': 0.8483519, 'specificity': 0.8483519, 'f1': 0.84520245, 'auroc': 0.98981917, 'binary_precision': 0.77053326, 'binary_recall': 0.99281996, 'binary_specificity': 0.7038838, 'binary_f1_score': 0.867666}
confusion matrix:
       0      1
0  20262   8524
1    207  28623
---- Validation: 
scalar performance:
{'acc': 0.344397, 'precision': 0.48488468, 'recall': 0.40106106, 'specificity': 0.40106106, 'f1': 0.27409357, 'auroc': 0.5425217, 'binary_precision': 0.02541888, 'binary_recall': 0.46210995, 'binary_specificity': 0.34001216, 'binary_f1_score': 0.04818717}
confusion matrix:
      0      1
0  6143  11924
1   362    311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.114405416, 'precision': 0.52258515, 'recall': 0.53784055, 'specificity': 0.53784055, 'f1': 0.11357456, 'auroc': 0.90340406, 'binary_precision': 0.04517026, 'binary_recall': 1.0, 'binary_specificity': 0.07568113, 'binary_f1_score': 0.08643617}
confusion matrix:
     0     1
0  450  5496
1    0   260
early stop counter: 14
val acc:0.34439700841903687, best validation acc: 0.9566702246665955, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 15,now: 2024-08-04 22:41:16.197930,epoch time: 0:10:10.793405,used: 2:30:57.489381,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_20_10_18_seed_1_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:30:57.489381 at 2024-08-04 22:41:16.197930
persisted model performance metric: 

scalar performance:
{'acc': 0.96326137, 'precision': 0.7737696, 'recall': 0.74543715, 'specificity': 0.74543715, 'f1': 0.758729, 'auroc': 0.8396944, 'binary_precision': 0.5689655, 'binary_recall': 0.50769234, 'binary_specificity': 0.98318195, 'binary_f1_score': 0.5365854}
confusion matrix:
      0    1
0  5846  100
1   128  132
oracle model performance metric: 

scalar performance:
{'acc': 0.96326137, 'precision': 0.7737696, 'recall': 0.74543715, 'specificity': 0.74543715, 'f1': 0.758729, 'auroc': 0.8396944, 'binary_precision': 0.5689655, 'binary_recall': 0.50769234, 'binary_specificity': 0.98318195, 'binary_f1_score': 0.5365854}
confusion matrix:
      0    1
0  5846  100
1   128  132
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535347 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool | 448192 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522826 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool | 436736 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |  86090 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  11654 MiB |   5110 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  11498 MiB |   5076 MiB |
|       from small pool |    122 MiB |    124 MiB |    156 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1065 MiB |   1463 MiB | 479146 GiB | 479144 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 477676 GiB | 477675 GiB |
|       from small pool |     10 MiB |     22 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3606    |    8349    |  107888 K  |  107885 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63242 K  |   63239 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3606    |    8349    |  107888 K  |  107885 K  |
|       from large pool |      87    |     730    |   44646 K  |   44646 K  |
|       from small pool |    3519    |    8260    |   63242 K  |   63239 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     195    |      65    |
|       from large pool |      69    |      71    |     117    |      48    |
|       from small pool |      61    |      62    |      78    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    3630    |   50627 K  |   50627 K  |
|       from large pool |      21    |      36    |   17922 K  |   17922 K  |
|       from small pool |      61    |    3610    |   32704 K  |   32704 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1588 MiB |   6564 MiB |  11654 MiB |  10066 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     96 MiB |    124 MiB |    156 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     24 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |     133    |     195    |     123    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      48    |      62    |      78    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50628 K  |   50628 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32705 K  |   32705 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |    868 TiB |    868 TiB |
|       from large pool |  65536 KiB |   6322 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |    864 TiB |    864 TiB |
|       from large pool |  65536 KiB |   6277 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1588 MiB |   6564 MiB |  11654 MiB |  10066 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  11498 MiB |  10006 MiB |
|       from small pool |     96 MiB |    124 MiB |    156 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 479146 GiB | 479146 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 477677 GiB | 477677 GiB |
|       from small pool |      0 KiB |     24 MiB |   1469 GiB |   1469 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  107888 K  |  107888 K  |
|       from large pool |       2    |     730    |   44646 K  |   44646 K  |
|       from small pool |       0    |    8260    |   63242 K  |   63242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |     133    |     195    |     123    |
|       from large pool |      24    |      71    |     117    |      93    |
|       from small pool |      48    |      62    |      78    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3630    |   50628 K  |   50628 K  |
|       from large pool |       3    |      36    |   17923 K  |   17923 K  |
|       from small pool |       0    |    3610    |   32705 K  |   32705 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115

 Experiment start at: 2024-08-04 22:47:49.360380
before training, model accuracy: 0.054656196385622025
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.969316, 'precision': 0.96984935, 'recall': 0.96931946, 'specificity': 0.96931946, 'f1': 0.9693074, 'auroc': 0.99456227, 'binary_precision': 0.985731, 'binary_recall': 0.95243156, 'binary_specificity': 0.98620737, 'binary_f1_score': 0.96879524}
confusion matrix:
       0      1
0  28744    402
1   1387  27771
---- Validation: 
scalar performance:
{'acc': 0.9394876, 'precision': 0.62371457, 'recall': 0.7262208, 'specificity': 0.7262208, 'f1': 0.6569496, 'auroc': 0.8267126, 'binary_precision': 0.26455027, 'binary_recall': 0.49833888, 'binary_specificity': 0.9541027, 'binary_f1_score': 0.34562212}
confusion matrix:
       0    1
0  17337  834
1    302  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469466, 'precision': 0.68994397, 'recall': 0.81774914, 'specificity': 0.81774914, 'f1': 0.734859, 'auroc': 0.89453596, 'binary_precision': 0.39328536, 'binary_recall': 0.677686, 'binary_specificity': 0.95781225, 'binary_f1_score': 0.49772382}
confusion matrix:
      0    1
0  5744  253
1    78  164
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 22:59:18.725418,epoch time: 0:11:29.365038,used: 0:11:29.365038,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9313426, 'precision': 0.93674946, 'recall': 0.93133116, 'specificity': 0.93133116, 'f1': 0.9311282, 'auroc': 0.99387443, 'binary_precision': 0.8882064, 'binary_recall': 0.98693323, 'binary_specificity': 0.8757291, 'binary_f1_score': 0.9349708}
confusion matrix:
       0      1
0  25524   3622
1    381  28777
---- Validation: 
scalar performance:
{'acc': 0.74015874, 'precision': 0.5197729, 'recall': 0.6224515, 'specificity': 0.6224515, 'f1': 0.4785495, 'auroc': 0.6635795, 'binary_precision': 0.061345916, 'binary_recall': 0.49667773, 'binary_specificity': 0.7482252, 'binary_f1_score': 0.10920379}
confusion matrix:
       0     1
0  13596  4575
1    303   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5853502, 'precision': 0.5386637, 'recall': 0.75655043, 'specificity': 0.75655043, 'f1': 0.43783012, 'auroc': 0.91464674, 'binary_precision': 0.0813995, 'binary_recall': 0.94214875, 'binary_specificity': 0.5709521, 'binary_f1_score': 0.14985211}
confusion matrix:
      0     1
0  3424  2573
1    14   228
early stop counter: 1
val acc:0.74015873670578, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 2,now: 2024-08-04 23:09:31.501101,epoch time: 0:10:12.775683,used: 0:21:42.140721,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9776516, 'precision': 0.9776603, 'recall': 0.97765195, 'specificity': 0.97765195, 'f1': 0.9776516, 'auroc': 0.9959507, 'binary_precision': 0.9797451, 'binary_recall': 0.9754776, 'binary_specificity': 0.9798264, 'binary_f1_score': 0.9776067}
confusion matrix:
       0      1
0  28559    588
1    715  28442
---- Validation: 
scalar performance:
{'acc': 0.9204709, 'precision': 0.573354, 'recall': 0.6569719, 'specificity': 0.6569719, 'f1': 0.5952269, 'auroc': 0.69817126, 'binary_precision': 0.16827998, 'binary_recall': 0.3754153, 'binary_specificity': 0.9385284, 'binary_f1_score': 0.23239075}
confusion matrix:
       0     1
0  17054  1117
1    376   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8754608, 'precision': 0.60497105, 'recall': 0.8618562, 'specificity': 0.8618562, 'f1': 0.63829637, 'auroc': 0.92463106, 'binary_precision': 0.21693122, 'binary_recall': 0.8471074, 'binary_specificity': 0.876605, 'binary_f1_score': 0.3454086}
confusion matrix:
      0    1
0  5257  740
1    37  205
early stop counter: 2
val acc:0.9204708933830261, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 3,now: 2024-08-04 23:19:43.120332,epoch time: 0:10:11.619231,used: 0:31:53.759952,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9362822, 'precision': 0.9397199, 'recall': 0.93627316, 'specificity': 0.93627316, 'f1': 0.9361566, 'auroc': 0.99194205, 'binary_precision': 0.90089184, 'binary_recall': 0.98045135, 'binary_specificity': 0.89209497, 'binary_f1_score': 0.9389894}
confusion matrix:
       0      1
0  26001   3145
1    570  28588
---- Validation: 
scalar performance:
{'acc': 0.7001012, 'precision': 0.51026666, 'recall': 0.5688342, 'specificity': 0.5688342, 'f1': 0.45232886, 'auroc': 0.54092854, 'binary_precision': 0.046536796, 'binary_recall': 0.42857143, 'binary_specificity': 0.7090969, 'binary_f1_score': 0.083957046}
confusion matrix:
       0     1
0  12885  5286
1    344   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38211253, 'precision': 0.5264776, 'recall': 0.66074467, 'specificity': 0.66074467, 'f1': 0.3176226, 'auroc': 0.91485, 'binary_precision': 0.057121843, 'binary_recall': 0.9628099, 'binary_specificity': 0.35867935, 'binary_f1_score': 0.1078454}
confusion matrix:
      0     1
0  2151  3846
1     9   233
early stop counter: 3
val acc:0.7001011967658997, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 4,now: 2024-08-04 23:30:05.171274,epoch time: 0:10:22.050942,used: 0:42:15.810894,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9212061, 'precision': 0.9286264, 'recall': 0.92119706, 'specificity': 0.92119706, 'f1': 0.9208625, 'auroc': 0.9925547, 'binary_precision': 0.8722643, 'binary_recall': 0.98696667, 'binary_specificity': 0.85542744, 'binary_f1_score': 0.9260773}
confusion matrix:
       0      1
0  24934   4214
1    380  28776
---- Validation: 
scalar performance:
{'acc': 0.5311884, 'precision': 0.49940524, 'recall': 0.49523157, 'specificity': 0.49523157, 'f1': 0.37333483, 'auroc': 0.54212576, 'binary_precision': 0.031432163, 'binary_recall': 0.45681062, 'binary_specificity': 0.53365254, 'binary_f1_score': 0.058817238}
confusion matrix:
      0     1
0  9697  8474
1   327   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.21269435, 'precision': 0.5234769, 'recall': 0.5904619, 'specificity': 0.5904619, 'f1': 0.19805335, 'auroc': 0.90786886, 'binary_precision': 0.046953823, 'binary_recall': 1.0, 'binary_specificity': 0.18092379, 'binary_f1_score': 0.08969607}
confusion matrix:
      0     1
0  1085  4912
1     0   242
early stop counter: 4
val acc:0.531188428401947, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 5,now: 2024-08-04 23:40:11.332877,epoch time: 0:10:06.161603,used: 0:52:21.972497,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94928306, 'precision': 0.9512759, 'recall': 0.9492774, 'specificity': 0.9492774, 'f1': 0.94922656, 'auroc': 0.99427795, 'binary_precision': 0.9213303, 'binary_recall': 0.9824742, 'binary_specificity': 0.91608053, 'binary_f1_score': 0.95092034}
confusion matrix:
       0      1
0  26701   2446
1    511  28646
---- Validation: 
scalar performance:
{'acc': 0.7183721, 'precision': 0.5128582, 'recall': 0.58309054, 'specificity': 0.58309054, 'f1': 0.46209013, 'auroc': 0.5672554, 'binary_precision': 0.050642624, 'binary_recall': 0.4385382, 'binary_specificity': 0.72764295, 'binary_f1_score': 0.09079965}
confusion matrix:
       0     1
0  13222  4949
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4648181, 'precision': 0.5304007, 'recall': 0.69980067, 'specificity': 0.69980067, 'f1': 0.3683683, 'auroc': 0.9016347, 'binary_precision': 0.064905874, 'binary_recall': 0.95454544, 'binary_specificity': 0.44505587, 'binary_f1_score': 0.12154697}
confusion matrix:
      0     1
0  2669  3328
1    11   231
early stop counter: 5
val acc:0.718372106552124, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 6,now: 2024-08-04 23:50:12.254715,epoch time: 0:10:00.921838,used: 1:02:22.894335,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9144313, 'precision': 0.9231641, 'recall': 0.91441405, 'specificity': 0.91441405, 'f1': 0.91398513, 'auroc': 0.99279964, 'binary_precision': 0.862434, 'binary_recall': 0.9862135, 'binary_specificity': 0.84261453, 'binary_f1_score': 0.9201798}
confusion matrix:
       0      1
0  24558   4587
1    402  28757
---- Validation: 
scalar performance:
{'acc': 0.5042348, 'precision': 0.49708042, 'recall': 0.47649002, 'specificity': 0.47649002, 'f1': 0.35933322, 'auroc': 0.54641426, 'binary_precision': 0.029103106, 'binary_recall': 0.44684386, 'binary_specificity': 0.5061362, 'binary_f1_score': 0.054647032}
confusion matrix:
      0     1
0  9197  8974
1   333   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.23385158, 'precision': 0.52259725, 'recall': 0.5955192, 'specificity': 0.5955192, 'f1': 0.2144296, 'auroc': 0.790314, 'binary_precision': 0.04764753, 'binary_recall': 0.9876033, 'binary_specificity': 0.20343505, 'binary_f1_score': 0.0909091}
confusion matrix:
      0     1
0  1220  4777
1     3   239
early stop counter: 6
val acc:0.504234790802002, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 7,now: 2024-08-05 00:00:22.130326,epoch time: 0:10:09.875611,used: 1:12:32.769946,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8946899, 'precision': 0.9072315, 'recall': 0.8946749, 'specificity': 0.8946749, 'f1': 0.8938702, 'auroc': 0.9864143, 'binary_precision': 0.8358087, 'binary_recall': 0.9824056, 'binary_specificity': 0.80694413, 'binary_f1_score': 0.90319735}
confusion matrix:
       0      1
0  23520   5627
1    513  28644
---- Validation: 
scalar performance:
{'acc': 0.54413253, 'precision': 0.49883133, 'recall': 0.4906754, 'specificity': 0.4906754, 'f1': 0.37842482, 'auroc': 0.5049026, 'binary_precision': 0.030785562, 'binary_recall': 0.43355483, 'binary_specificity': 0.54779595, 'binary_f1_score': 0.057488985}
confusion matrix:
      0     1
0  9954  8217
1   341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32697546, 'precision': 0.52536064, 'recall': 0.63999456, 'specificity': 0.63999456, 'f1': 0.28172264, 'auroc': 0.8249557, 'binary_precision': 0.053486798, 'binary_recall': 0.9793388, 'binary_specificity': 0.30065033, 'binary_f1_score': 0.10143378}
confusion matrix:
      0     1
0  1803  4194
1     5   237
early stop counter: 7
val acc:0.5441325306892395, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 8,now: 2024-08-05 00:10:30.931149,epoch time: 0:10:08.800823,used: 1:22:41.570769,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92465353, 'precision': 0.931304, 'recall': 0.9246386, 'specificity': 0.9246386, 'f1': 0.92436016, 'auroc': 0.99279016, 'binary_precision': 0.87780696, 'binary_recall': 0.9866936, 'binary_specificity': 0.86258364, 'binary_f1_score': 0.92907083}
confusion matrix:
       0      1
0  25140   4005
1    388  28771
---- Validation: 
scalar performance:
{'acc': 0.5537208, 'precision': 0.49975306, 'recall': 0.49803746, 'specificity': 0.49803746, 'f1': 0.38337895, 'auroc': 0.5323225, 'binary_precision': 0.031791907, 'binary_recall': 0.4385382, 'binary_specificity': 0.5575367, 'binary_f1_score': 0.05928587}
confusion matrix:
       0     1
0  10131  8040
1    338   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.30197147, 'precision': 0.5243206, 'recall': 0.62698805, 'specificity': 0.62698805, 'f1': 0.26440075, 'auroc': 0.8715342, 'binary_precision': 0.051667757, 'binary_recall': 0.9793388, 'binary_specificity': 0.2746373, 'binary_f1_score': 0.09815697}
confusion matrix:
      0     1
0  1647  4350
1     5   237
early stop counter: 8
val acc:0.5537207722663879, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 9,now: 2024-08-05 00:20:40.777809,epoch time: 0:10:09.846660,used: 1:32:51.417429,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91588914, 'precision': 0.92511284, 'recall': 0.9158765, 'specificity': 0.9158765, 'f1': 0.91542876, 'auroc': 0.99406606, 'binary_precision': 0.862537, 'binary_recall': 0.9895051, 'binary_specificity': 0.8422479, 'binary_f1_score': 0.9216689}
confusion matrix:
       0      1
0  24549   4598
1    306  28851
---- Validation: 
scalar performance:
{'acc': 0.5327864, 'precision': 0.49920726, 'recall': 0.4936479, 'specificity': 0.4936479, 'f1': 0.3738568, 'auroc': 0.5547942, 'binary_precision': 0.03121772, 'binary_recall': 0.45182723, 'binary_specificity': 0.5354686, 'binary_f1_score': 0.05840043}
confusion matrix:
      0     1
0  9730  8441
1   330   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.20115404, 'precision': 0.5231535, 'recall': 0.5844589, 'specificity': 0.5844589, 'f1': 0.18876533, 'auroc': 0.8873864, 'binary_precision': 0.046306927, 'binary_recall': 1.0, 'binary_specificity': 0.16891779, 'binary_f1_score': 0.08851499}
confusion matrix:
      0     1
0  1013  4984
1     0   242
early stop counter: 9
val acc:0.5327864289283752, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 10,now: 2024-08-05 00:30:53.992482,epoch time: 0:10:13.214673,used: 1:43:04.632102,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9360593, 'precision': 0.9411402, 'recall': 0.93604827, 'specificity': 0.93604827, 'f1': 0.9358735, 'auroc': 0.9957992, 'binary_precision': 0.89384836, 'binary_recall': 0.98967695, 'binary_specificity': 0.8824195, 'binary_f1_score': 0.9393249}
confusion matrix:
       0      1
0  25719   3427
1    301  28857
---- Validation: 
scalar performance:
{'acc': 0.6623875, 'precision': 0.50822735, 'recall': 0.55898917, 'specificity': 0.55898917, 'f1': 0.43592313, 'auroc': 0.5905562, 'binary_precision': 0.04302103, 'binary_recall': 0.44850498, 'binary_specificity': 0.66947335, 'binary_f1_score': 0.07851119}
confusion matrix:
       0     1
0  12165  6006
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.33723354, 'precision': 0.5261678, 'recall': 0.64731336, 'specificity': 0.64731336, 'f1': 0.28880903, 'auroc': 0.9165906, 'binary_precision': 0.054474708, 'binary_recall': 0.9834711, 'binary_specificity': 0.3111556, 'binary_f1_score': 0.10323141}
confusion matrix:
      0     1
0  1866  4131
1     4   238
early stop counter: 10
val acc:0.662387490272522, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 11,now: 2024-08-05 00:41:05.050806,epoch time: 0:10:11.058324,used: 1:53:15.690426,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8846906, 'precision': 0.90305895, 'recall': 0.8846686, 'specificity': 0.8846686, 'f1': 0.8833575, 'auroc': 0.99319273, 'binary_precision': 0.8170666, 'binary_recall': 0.9913917, 'binary_specificity': 0.7779455, 'binary_f1_score': 0.8958272}
confusion matrix:
       0      1
0  22674   6472
1    251  28907
---- Validation: 
scalar performance:
{'acc': 0.48005113, 'precision': 0.49672234, 'recall': 0.47363415, 'specificity': 0.47363415, 'f1': 0.3479422, 'auroc': 0.55881757, 'binary_precision': 0.02890649, 'binary_recall': 0.4667774, 'binary_specificity': 0.4804909, 'binary_f1_score': 0.054441538}
confusion matrix:
      0     1
0  8731  9440
1   321   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.16685367, 'precision': 0.52224267, 'recall': 0.56661665, 'specificity': 0.56661665, 'f1': 0.16015978, 'auroc': 0.9096952, 'binary_precision': 0.044485293, 'binary_recall': 1.0, 'binary_specificity': 0.13323328, 'binary_f1_score': 0.085181266}
confusion matrix:
     0     1
0  799  5198
1    0   242
early stop counter: 11
val acc:0.4800511300563812, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 12,now: 2024-08-05 00:51:16.559891,epoch time: 0:10:11.509085,used: 2:03:27.199511,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9025967, 'precision': 0.9154985, 'recall': 0.90258163, 'specificity': 0.90258163, 'f1': 0.90183234, 'auroc': 0.9942145, 'binary_precision': 0.84232473, 'binary_recall': 0.9906712, 'binary_specificity': 0.81449205, 'binary_f1_score': 0.9104951}
confusion matrix:
       0      1
0  23740   5407
1    272  28885
---- Validation: 
scalar performance:
{'acc': 0.52863157, 'precision': 0.49974152, 'recall': 0.49792606, 'specificity': 0.49792606, 'f1': 0.3725103, 'auroc': 0.5687802, 'binary_precision': 0.03179289, 'binary_recall': 0.4651163, 'binary_specificity': 0.5307358, 'binary_f1_score': 0.05951748}
confusion matrix:
      0     1
0  9644  8527
1   322   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.27712774, 'precision': 0.5241744, 'recall': 0.6180304, 'specificity': 0.6180304, 'f1': 0.24684691, 'auroc': 0.9048789, 'binary_precision': 0.050358195, 'binary_recall': 0.9876033, 'binary_specificity': 0.24845757, 'binary_f1_score': 0.095829986}
confusion matrix:
      0     1
0  1490  4507
1     3   239
early stop counter: 12
val acc:0.5286315679550171, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 13,now: 2024-08-05 01:01:25.552402,epoch time: 0:10:08.992511,used: 2:13:36.192022,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9143798, 'precision': 0.923318, 'recall': 0.9143673, 'specificity': 0.9143673, 'f1': 0.91392374, 'auroc': 0.99315816, 'binary_precision': 0.861849, 'binary_recall': 0.9870014, 'binary_specificity': 0.8417333, 'binary_f1_score': 0.92018926}
confusion matrix:
       0      1
0  24534   4613
1    379  28778
---- Validation: 
scalar performance:
{'acc': 0.5346508, 'precision': 0.4991265, 'recall': 0.4930049, 'specificity': 0.4930049, 'f1': 0.37459725, 'auroc': 0.5585836, 'binary_precision': 0.031127507, 'binary_recall': 0.44850498, 'binary_specificity': 0.5375048, 'binary_f1_score': 0.058214746}
confusion matrix:
      0     1
0  9767  8404
1   332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.23497355, 'precision': 0.52362967, 'recall': 0.6000683, 'specificity': 0.6000683, 'f1': 0.2154582, 'auroc': 0.87791085, 'binary_precision': 0.048075005, 'binary_recall': 0.9958678, 'binary_specificity': 0.2042688, 'binary_f1_score': 0.09172217}
confusion matrix:
      0     1
0  1225  4772
1     1   241
early stop counter: 13
val acc:0.5346508026123047, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 14,now: 2024-08-05 01:11:35.955963,epoch time: 0:10:10.403561,used: 2:23:46.595583,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9085483, 'precision': 0.91943413, 'recall': 0.9085317, 'specificity': 0.9085317, 'f1': 0.9079486, 'auroc': 0.9924407, 'binary_precision': 0.8519142, 'binary_recall': 0.9890596, 'binary_specificity': 0.8280038, 'binary_f1_score': 0.9153785}
confusion matrix:
       0      1
0  24133   5013
1    319  28839
---- Validation: 
scalar performance:
{'acc': 0.54807436, 'precision': 0.49918592, 'recall': 0.49351463, 'specificity': 0.49351463, 'f1': 0.38044134, 'auroc': 0.54341567, 'binary_precision': 0.031168213, 'binary_recall': 0.43521595, 'binary_specificity': 0.5518133, 'binary_f1_score': 0.058170512}
confusion matrix:
       0     1
0  10027  8144
1    340   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.22519635, 'precision': 0.52331936, 'recall': 0.5949824, 'specificity': 0.5949824, 'f1': 0.20785925, 'auroc': 0.83601063, 'binary_precision': 0.047497045, 'binary_recall': 0.9958678, 'binary_specificity': 0.19409704, 'binary_f1_score': 0.09066968}
confusion matrix:
      0     1
0  1164  4833
1     1   241
early stop counter: 14
val acc:0.5480743646621704, best validation acc: 0.9394875764846802, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 15,now: 2024-08-05 01:21:45.869099,epoch time: 0:10:09.913136,used: 2:33:56.508719,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_04_22_47_49_seed_2_24067115
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 2:33:56.508719 at 2024-08-05 01:21:45.869099
persisted model performance metric: 

scalar performance:
{'acc': 0.9469466, 'precision': 0.68994397, 'recall': 0.81774914, 'specificity': 0.81774914, 'f1': 0.734859, 'auroc': 0.89453596, 'binary_precision': 0.39328536, 'binary_recall': 0.677686, 'binary_specificity': 0.95781225, 'binary_f1_score': 0.49772382}
confusion matrix:
      0    1
0  5744  253
1    78  164
oracle model performance metric: 

scalar performance:
{'acc': 0.9469466, 'precision': 0.68994397, 'recall': 0.81774914, 'specificity': 0.81774914, 'f1': 0.734859, 'auroc': 0.89453596, 'binary_precision': 0.39328536, 'binary_recall': 0.677686, 'binary_specificity': 0.95781225, 'binary_f1_score': 0.49772382}
confusion matrix:
      0    1
0  5744  253
1    78  164
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 535353 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool | 448192 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 522827 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool | 436736 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |  86091 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6544 MiB |   6564 MiB |  16610 MiB |  10066 MiB |
|       from large pool |   6422 MiB |   6440 MiB |  16428 MiB |  10006 MiB |
|       from small pool |    122 MiB |    124 MiB |    182 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1059 MiB |   1463 MiB | 730677 GiB | 730676 GiB |
|       from large pool |   1054 MiB |   1461 MiB | 728432 GiB | 728431 GiB |
|       from small pool |      4 MiB |     24 MiB |   2244 GiB |   2244 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3618    |    8435    |  163861 K  |  163858 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95828 K  |   95824 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3618    |    8435    |  163861 K  |  163858 K  |
|       from large pool |      87    |     730    |   68033 K  |   68033 K  |
|       from small pool |    3531    |    8346    |   95828 K  |   95824 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     133    |     253    |     123    |
|       from large pool |      69    |      71    |     162    |      93    |
|       from small pool |      61    |      62    |      91    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3673    |   76905 K  |   76905 K  |
|       from large pool |      21    |      36    |   27378 K  |   27378 K  |
|       from small pool |      53    |    3653    |   49526 K  |   49526 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   6394 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  65536 KiB |   6322 MiB |   1320 TiB |   1320 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   6348 MiB |   1316 TiB |   1316 TiB |
|       from large pool |  65536 KiB |   6277 MiB |   1314 TiB |   1314 TiB |
|       from small pool |      0 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1582 MiB |   6564 MiB |  16610 MiB |  15028 MiB |
|       from large pool |   1492 MiB |   6440 MiB |  16428 MiB |  14936 MiB |
|       from small pool |     90 MiB |    124 MiB |    182 MiB |     92 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1463 MiB | 730678 GiB | 730678 GiB |
|       from large pool | 116736 KiB |   1461 MiB | 728433 GiB | 728433 GiB |
|       from small pool |      0 KiB |     24 MiB |   2245 GiB |   2245 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8435    |  163861 K  |  163861 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95828 K  |   95828 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8435    |  163861 K  |  163861 K  |
|       from large pool |       2    |     730    |   68033 K  |   68033 K  |
|       from small pool |       0    |    8346    |   95828 K  |   95828 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     133    |     253    |     184    |
|       from large pool |      24    |      71    |     162    |     138    |
|       from small pool |      45    |      62    |      91    |      46    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3673    |   76906 K  |   76906 K  |
|       from large pool |       3    |      36    |   27378 K  |   27378 K  |
|       from small pool |       0    |    3653    |   49528 K  |   49528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 01:22:30 2024]
Finished job 0.
1 of 1 steps (100%) done
