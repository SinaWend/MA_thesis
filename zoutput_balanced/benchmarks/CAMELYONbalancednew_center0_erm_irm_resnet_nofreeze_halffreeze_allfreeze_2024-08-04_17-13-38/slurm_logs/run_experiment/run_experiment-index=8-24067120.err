Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug  5 01:21:43 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120

 Experiment start at: 2024-08-05 01:30:54.171141
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96572524, 'precision': 0.96644974, 'recall': 0.9657426, 'specificity': 0.9657426, 'f1': 0.9657128, 'auroc': 0.9938288, 'binary_precision': 0.9850524, 'binary_recall': 0.94586307, 'binary_specificity': 0.98562205, 'binary_f1_score': 0.96506}
confusion matrix:
       0      1
0  28243    412
1   1554  27151
---- Validation: 
scalar performance:
{'acc': 0.9520541, 'precision': 0.64734113, 'recall': 0.6616546, 'specificity': 0.6616546, 'f1': 0.65410984, 'auroc': 0.8131708, 'binary_precision': 0.31779662, 'binary_recall': 0.34992224, 'binary_specificity': 0.97338694, 'binary_f1_score': 0.33308658}
confusion matrix:
       0    1
0  17666  483
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.79167944, 'recall': 0.81616575, 'specificity': 0.81616575, 'f1': 0.8033643, 'auroc': 0.88516927, 'binary_precision': 0.59859157, 'binary_recall': 0.651341, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.62385327}
confusion matrix:
      0    1
0  5883  114
1    91  170
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 01:43:55.081935,epoch time: 0:13:00.910794,used: 0:13:00.910794,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94088215, 'precision': 0.9454994, 'recall': 0.94084674, 'specificity': 0.94084674, 'f1': 0.94072527, 'auroc': 0.99571574, 'binary_precision': 0.9003195, 'binary_recall': 0.99163765, 'binary_specificity': 0.89005584, 'binary_f1_score': 0.94377476}
confusion matrix:
       0      1
0  25509   3151
1    240  28460
---- Validation: 
scalar performance:
{'acc': 0.78293955, 'precision': 0.5402808, 'recall': 0.71361184, 'specificity': 0.71361184, 'f1': 0.52145797, 'auroc': 0.7585879, 'binary_precision': 0.09652419, 'binary_recall': 0.63919127, 'binary_specificity': 0.7880324, 'binary_f1_score': 0.16772087}
confusion matrix:
       0     1
0  14302  3847
1    232   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65036756, 'precision': 0.5477172, 'recall': 0.7827611, 'specificity': 0.7827611, 'f1': 0.47943518, 'auroc': 0.9218626, 'binary_precision': 0.10037329, 'binary_recall': 0.92720306, 'binary_specificity': 0.63831913, 'binary_f1_score': 0.18113774}
confusion matrix:
      0     1
0  3828  2169
1    19   242
early stop counter: 1
val acc:0.7829395532608032, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 2,now: 2024-08-05 01:56:22.224245,epoch time: 0:12:27.142310,used: 0:25:28.053104,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9765516, 'precision': 0.9765742, 'recall': 0.97654855, 'specificity': 0.97654855, 'f1': 0.9765512, 'auroc': 0.99667203, 'binary_precision': 0.97352207, 'binary_recall': 0.9797959, 'binary_specificity': 0.97330123, 'binary_f1_score': 0.9766489}
confusion matrix:
       0      1
0  27888    765
1    580  28127
---- Validation: 
scalar performance:
{'acc': 0.9262452, 'precision': 0.5920048, 'recall': 0.67454493, 'specificity': 0.67454493, 'f1': 0.6169876, 'auroc': 0.7823919, 'binary_precision': 0.20585907, 'binary_recall': 0.4043546, 'binary_specificity': 0.9447352, 'binary_f1_score': 0.27282268}
confusion matrix:
       0     1
0  17146  1003
1    383   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91147333, 'precision': 0.64190984, 'recall': 0.85669655, 'specificity': 0.85669655, 'f1': 0.69044197, 'auroc': 0.9215195, 'binary_precision': 0.29337093, 'binary_recall': 0.79693484, 'binary_specificity': 0.91645825, 'binary_f1_score': 0.42886597}
confusion matrix:
      0    1
0  5496  501
1    53  208
early stop counter: 2
val acc:0.9262452125549316, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 3,now: 2024-08-05 02:08:47.527873,epoch time: 0:12:25.303628,used: 0:37:53.356732,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9765167, 'precision': 0.97652847, 'recall': 0.9765147, 'specificity': 0.9765147, 'f1': 0.9765165, 'auroc': 0.99693227, 'binary_precision': 0.9743723, 'binary_recall': 0.978819, 'binary_specificity': 0.97421044, 'binary_f1_score': 0.97659063}
confusion matrix:
       0      1
0  27916    739
1    608  28097
---- Validation: 
scalar performance:
{'acc': 0.92571306, 'precision': 0.58446383, 'recall': 0.65551805, 'specificity': 0.65551805, 'f1': 0.6063959, 'auroc': 0.71644354, 'binary_precision': 0.19215044, 'binary_recall': 0.36547434, 'binary_specificity': 0.94556177, 'binary_f1_score': 0.25187567}
confusion matrix:
       0    1
0  17161  988
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89533395, 'precision': 0.6269871, 'recall': 0.8647667, 'specificity': 0.8647667, 'f1': 0.6706052, 'auroc': 0.9185199, 'binary_precision': 0.2620773, 'binary_recall': 0.8314176, 'binary_specificity': 0.89811575, 'binary_f1_score': 0.39853078}
confusion matrix:
      0    1
0  5386  611
1    44  217
early stop counter: 3
val acc:0.925713062286377, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 4,now: 2024-08-05 02:21:14.252796,epoch time: 0:12:26.724923,used: 0:50:20.081655,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9538703, 'precision': 0.95564055, 'recall': 0.95384216, 'specificity': 0.95384216, 'f1': 0.9538233, 'auroc': 0.99575126, 'binary_precision': 0.9274654, 'binary_recall': 0.98484635, 'binary_specificity': 0.922838, 'binary_f1_score': 0.95529497}
confusion matrix:
       0      1
0  26443   2211
1    435  28271
---- Validation: 
scalar performance:
{'acc': 0.7853874, 'precision': 0.52180237, 'recall': 0.6091213, 'specificity': 0.6091213, 'f1': 0.4979565, 'auroc': 0.6502042, 'binary_precision': 0.06870229, 'binary_recall': 0.41990668, 'binary_specificity': 0.79833597, 'binary_f1_score': 0.11808441}
confusion matrix:
       0     1
0  14489  3660
1    373   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6219239, 'precision': 0.5461878, 'recall': 0.7807467, 'specificity': 0.7807467, 'f1': 0.46437606, 'auroc': 0.9318286, 'binary_precision': 0.09565885, 'binary_recall': 0.954023, 'binary_specificity': 0.6074704, 'binary_f1_score': 0.17388266}
confusion matrix:
      0     1
0  3643  2354
1    12   249
early stop counter: 4
val acc:0.785387396812439, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 5,now: 2024-08-05 02:33:41.355237,epoch time: 0:12:27.102441,used: 1:02:47.184096,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9567643, 'precision': 0.95816576, 'recall': 0.9567384, 'specificity': 0.9567384, 'f1': 0.9567294, 'auroc': 0.995141, 'binary_precision': 0.93306035, 'binary_recall': 0.98421985, 'binary_specificity': 0.929257, 'binary_f1_score': 0.95795757}
confusion matrix:
       0      1
0  26626   2027
1    453  28254
---- Validation: 
scalar performance:
{'acc': 0.84520006, 'precision': 0.53539884, 'recall': 0.6355869, 'specificity': 0.6355869, 'f1': 0.534216, 'auroc': 0.62626487, 'binary_precision': 0.09448819, 'binary_recall': 0.41057542, 'binary_specificity': 0.8605984, 'binary_f1_score': 0.15362236}
confusion matrix:
       0     1
0  15619  2530
1    379   264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70949185, 'precision': 0.55520093, 'recall': 0.8026159, 'specificity': 0.8026159, 'f1': 0.5141657, 'auroc': 0.92631185, 'binary_precision': 0.11631346, 'binary_recall': 0.90421456, 'binary_specificity': 0.7010172, 'binary_f1_score': 0.20611353}
confusion matrix:
      0     1
0  4204  1793
1    25   236
early stop counter: 5
val acc:0.8452000617980957, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 6,now: 2024-08-05 02:46:11.435079,epoch time: 0:12:30.079842,used: 1:15:17.263938,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93973154, 'precision': 0.9431567, 'recall': 0.9396949, 'specificity': 0.9396949, 'f1': 0.9396113, 'auroc': 0.99415684, 'binary_precision': 0.90440494, 'binary_recall': 0.98352146, 'binary_specificity': 0.89586824, 'binary_f1_score': 0.9423055}
confusion matrix:
       0      1
0  25672   2984
1    473  28231
---- Validation: 
scalar performance:
{'acc': 0.6065347, 'precision': 0.5031326, 'recall': 0.52252716, 'specificity': 0.52252716, 'f1': 0.4102132, 'auroc': 0.5637216, 'binary_precision': 0.038045708, 'binary_recall': 0.43234837, 'binary_specificity': 0.61270595, 'binary_f1_score': 0.06993711}
confusion matrix:
       0     1
0  11120  7029
1    365   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45957175, 'precision': 0.5339723, 'recall': 0.70703167, 'specificity': 0.70703167, 'f1': 0.3694383, 'auroc': 0.88388586, 'binary_precision': 0.070228584, 'binary_recall': 0.9770115, 'binary_specificity': 0.43705186, 'binary_f1_score': 0.13103801}
confusion matrix:
      0     1
0  2621  3376
1     6   255
early stop counter: 6
val acc:0.6065347194671631, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 7,now: 2024-08-05 02:58:41.062254,epoch time: 0:12:29.627175,used: 1:27:46.891113,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93228734, 'precision': 0.9367212, 'recall': 0.93224704, 'specificity': 0.93224704, 'f1': 0.93211067, 'auroc': 0.9930689, 'binary_precision': 0.8929171, 'binary_recall': 0.98251057, 'binary_specificity': 0.88198346, 'binary_f1_score': 0.93557376}
confusion matrix:
       0      1
0  25275   3382
1    502  28201
---- Validation: 
scalar performance:
{'acc': 0.59967005, 'precision': 0.5032422, 'recall': 0.52347356, 'specificity': 0.52347356, 'f1': 0.407562, 'auroc': 0.55642796, 'binary_precision': 0.038131043, 'binary_recall': 0.44167963, 'binary_specificity': 0.6052675, 'binary_f1_score': 0.070201464}
confusion matrix:
       0     1
0  10985  7164
1    359   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4268137, 'precision': 0.53231764, 'recall': 0.6917721, 'specificity': 0.6917721, 'f1': 0.34937358, 'auroc': 0.88517886, 'binary_precision': 0.066701405, 'binary_recall': 0.9808429, 'binary_specificity': 0.40270135, 'binary_f1_score': 0.12490852}
confusion matrix:
      0     1
0  2415  3582
1     5   256
early stop counter: 7
val acc:0.5996700525283813, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 8,now: 2024-08-05 03:11:12.703803,epoch time: 0:12:31.641549,used: 1:40:18.532662,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9673989, 'precision': 0.9680425, 'recall': 0.9673829, 'specificity': 0.9673829, 'f1': 0.96738684, 'auroc': 0.99684024, 'binary_precision': 0.9509023, 'binary_recall': 0.9857516, 'binary_specificity': 0.9490141, 'binary_f1_score': 0.96801347}
confusion matrix:
       0      1
0  27194   1461
1    409  28296
---- Validation: 
scalar performance:
{'acc': 0.8727118, 'precision': 0.5461009, 'recall': 0.64833003, 'specificity': 0.64833003, 'f1': 0.5553505, 'auroc': 0.69089925, 'binary_precision': 0.11526617, 'binary_recall': 0.407465, 'binary_specificity': 0.889195, 'binary_f1_score': 0.17969821}
confusion matrix:
       0     1
0  16138  2011
1    381   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71093, 'precision': 0.5566893, 'recall': 0.8106956, 'specificity': 0.8106956, 'f1': 0.51640695, 'auroc': 0.9284265, 'binary_precision': 0.1183432, 'binary_recall': 0.9195402, 'binary_specificity': 0.70185095, 'binary_f1_score': 0.20969857}
confusion matrix:
      0     1
0  4209  1788
1    21   240
early stop counter: 8
val acc:0.8727117776870728, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 9,now: 2024-08-05 03:23:38.710902,epoch time: 0:12:26.007099,used: 1:52:44.539761,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9208159, 'precision': 0.9278536, 'recall': 0.92077124, 'specificity': 0.92077124, 'f1': 0.92048323, 'auroc': 0.9917271, 'binary_precision': 0.87315416, 'binary_recall': 0.9848084, 'binary_specificity': 0.8567341, 'binary_f1_score': 0.92562634}
confusion matrix:
       0      1
0  24554   4106
1    436  28264
---- Validation: 
scalar performance:
{'acc': 0.5485845, 'precision': 0.4993016, 'recall': 0.49477565, 'specificity': 0.49477565, 'f1': 0.38244572, 'auroc': 0.5328822, 'binary_precision': 0.03344442, 'binary_recall': 0.43701398, 'binary_specificity': 0.5525373, 'binary_f1_score': 0.06213378}
confusion matrix:
       0     1
0  10028  8121
1    362   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34787473, 'precision': 0.5289705, 'recall': 0.65424955, 'specificity': 0.65424955, 'f1': 0.29845214, 'auroc': 0.8453343, 'binary_precision': 0.059501845, 'binary_recall': 0.9885057, 'binary_specificity': 0.31999332, 'binary_f1_score': 0.11224712}
confusion matrix:
      0     1
0  1919  4078
1     3   258
early stop counter: 9
val acc:0.548584520816803, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 10,now: 2024-08-05 03:36:18.908714,epoch time: 0:12:40.197812,used: 2:05:24.737573,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94335777, 'precision': 0.9460615, 'recall': 0.9433334, 'specificity': 0.9433334, 'f1': 0.9432696, 'auroc': 0.9937855, 'binary_precision': 0.91148984, 'binary_recall': 0.982159, 'binary_specificity': 0.9045077, 'binary_f1_score': 0.9455058}
confusion matrix:
       0      1
0  25925   2737
1    512  28186
---- Validation: 
scalar performance:
{'acc': 0.80246913, 'precision': 0.52660817, 'recall': 0.6254654, 'specificity': 0.6254654, 'f1': 0.50982744, 'auroc': 0.62869954, 'binary_precision': 0.07715624, 'binary_recall': 0.43545878, 'binary_specificity': 0.81547195, 'binary_f1_score': 0.13108613}
confusion matrix:
       0     1
0  14800  3349
1    363   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6657079, 'precision': 0.5486715, 'recall': 0.7834358, 'specificity': 0.7834358, 'f1': 0.48753238, 'auroc': 0.9040874, 'binary_precision': 0.103164285, 'binary_recall': 0.9118774, 'binary_specificity': 0.6549942, 'binary_f1_score': 0.18535824}
confusion matrix:
      0     1
0  3928  2069
1    23   238
early stop counter: 10
val acc:0.8024691343307495, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 11,now: 2024-08-05 03:48:46.064639,epoch time: 0:12:27.155925,used: 2:17:51.893498,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9683926, 'precision': 0.968855, 'recall': 0.9683812, 'specificity': 0.9683812, 'f1': 0.9683842, 'auroc': 0.9966681, 'binary_precision': 0.95431197, 'binary_recall': 0.98393786, 'binary_specificity': 0.9528246, 'binary_f1_score': 0.9688985}
confusion matrix:
       0      1
0  27307   1352
1    461  28240
---- Validation: 
scalar performance:
{'acc': 0.8845785, 'precision': 0.55210304, 'recall': 0.6529735, 'specificity': 0.6529735, 'f1': 0.56561124, 'auroc': 0.63148236, 'binary_precision': 0.12707722, 'binary_recall': 0.4043546, 'binary_specificity': 0.9015924, 'binary_f1_score': 0.19338045}
confusion matrix:
       0     1
0  16363  1786
1    383   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8237456, 'precision': 0.58484983, 'recall': 0.84940267, 'specificity': 0.84940267, 'f1': 0.59635854, 'auroc': 0.9175303, 'binary_precision': 0.17615385, 'binary_recall': 0.8773946, 'binary_specificity': 0.8214107, 'binary_f1_score': 0.29340166}
confusion matrix:
      0     1
0  4926  1071
1    32   229
early stop counter: 11
val acc:0.88457852602005, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 12,now: 2024-08-05 04:01:17.292654,epoch time: 0:12:31.228015,used: 2:30:23.121513,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9204149, 'precision': 0.9279971, 'recall': 0.92036855, 'specificity': 0.92036855, 'f1': 0.92005503, 'auroc': 0.99404514, 'binary_precision': 0.8712049, 'binary_recall': 0.9868293, 'binary_specificity': 0.8539079, 'binary_f1_score': 0.9254195}
confusion matrix:
       0      1
0  24473   4187
1    378  28322
---- Validation: 
scalar performance:
{'acc': 0.6265432, 'precision': 0.50540906, 'recall': 0.53813624, 'specificity': 0.53813624, 'f1': 0.42057705, 'auroc': 0.5659918, 'binary_precision': 0.041036718, 'binary_recall': 0.44323483, 'binary_specificity': 0.6330376, 'binary_f1_score': 0.07511861}
confusion matrix:
       0     1
0  11489  6660
1    358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38910195, 'precision': 0.52993906, 'recall': 0.6702633, 'specificity': 0.6702633, 'f1': 0.32525665, 'auroc': 0.83024716, 'binary_precision': 0.06262279, 'binary_recall': 0.9770115, 'binary_specificity': 0.36351508, 'binary_f1_score': 0.11770136}
confusion matrix:
      0     1
0  2180  3817
1     6   255
early stop counter: 12
val acc:0.6265432238578796, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 13,now: 2024-08-05 04:13:45.759903,epoch time: 0:12:28.467249,used: 2:42:51.588762,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95906556, 'precision': 0.9604364, 'recall': 0.95904285, 'specificity': 0.95904285, 'f1': 0.9590336, 'auroc': 0.9962462, 'binary_precision': 0.9355212, 'binary_recall': 0.98616916, 'binary_specificity': 0.93191653, 'binary_f1_score': 0.9601777}
confusion matrix:
       0      1
0  26705   1951
1    397  28307
---- Validation: 
scalar performance:
{'acc': 0.75963175, 'precision': 0.51853806, 'recall': 0.6010376, 'specificity': 0.6010376, 'f1': 0.48515984, 'auroc': 0.60530895, 'binary_precision': 0.06255646, 'binary_recall': 0.43079317, 'binary_specificity': 0.77128214, 'binary_f1_score': 0.109248675}
confusion matrix:
       0     1
0  13998  4151
1    366   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6267178, 'precision': 0.54705036, 'recall': 0.7850803, 'specificity': 0.7850803, 'f1': 0.4674912, 'auroc': 0.9210844, 'binary_precision': 0.097087376, 'binary_recall': 0.9578544, 'binary_specificity': 0.6123062, 'binary_f1_score': 0.17630465}
confusion matrix:
      0     1
0  3672  2325
1    11   250
early stop counter: 13
val acc:0.7596317529678345, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 14,now: 2024-08-05 04:26:28.803417,epoch time: 0:12:43.043514,used: 2:55:34.632276,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95943165, 'precision': 0.96074617, 'recall': 0.9594095, 'specificity': 0.9594095, 'f1': 0.95940125, 'auroc': 0.9961134, 'binary_precision': 0.9363441, 'binary_recall': 0.9859601, 'binary_specificity': 0.93285877, 'binary_f1_score': 0.9605118}
confusion matrix:
       0      1
0  26732   1924
1    403  28301
---- Validation: 
scalar performance:
{'acc': 0.79219884, 'precision': 0.52378726, 'recall': 0.616398, 'specificity': 0.616398, 'f1': 0.5027921, 'auroc': 0.6073482, 'binary_precision': 0.07214061, 'binary_recall': 0.42768273, 'binary_specificity': 0.80511326, 'binary_f1_score': 0.1234568}
confusion matrix:
       0     1
0  14612  3537
1    368   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6505273, 'precision': 0.5477387, 'recall': 0.7828445, 'specificity': 0.7828445, 'f1': 0.47953117, 'auroc': 0.9169853, 'binary_precision': 0.10041494, 'binary_recall': 0.92720306, 'binary_specificity': 0.6384859, 'binary_f1_score': 0.18120554}
confusion matrix:
      0     1
0  3829  2168
1    19   242
early stop counter: 14
val acc:0.7921988368034363, best validation acc: 0.9520540833473206, corresponding to test acc:                         0.9672419428825378 / 0.9672419428825378
after epoch: 15,now: 2024-08-05 04:38:55.575691,epoch time: 0:12:26.772274,used: 3:08:01.404550,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_01_30_53_seed_0_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:08:01.404550 at 2024-08-05 04:38:55.575691
persisted model performance metric: 

scalar performance:
{'acc': 0.96724194, 'precision': 0.79167944, 'recall': 0.81616575, 'specificity': 0.81616575, 'f1': 0.8033643, 'auroc': 0.88516927, 'binary_precision': 0.59859157, 'binary_recall': 0.651341, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.62385327}
confusion matrix:
      0    1
0  5883  114
1    91  170
oracle model performance metric: 

scalar performance:
{'acc': 0.96724194, 'precision': 0.79167944, 'recall': 0.81616575, 'specificity': 0.81616575, 'f1': 0.8033643, 'auroc': 0.88516927, 'binary_precision': 0.59859157, 'binary_recall': 0.651341, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.62385327}
confusion matrix:
      0    1
0  5883  114
1    91  170
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 487263 KiB |   6374 MiB | 573360 GiB | 573360 GiB |
|       from large pool | 400096 KiB |   6302 MiB | 572661 GiB | 572661 GiB |
|       from small pool |  87167 KiB |    122 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 487263 KiB |   6374 MiB | 573360 GiB | 573360 GiB |
|       from large pool | 400096 KiB |   6302 MiB | 572661 GiB | 572661 GiB |
|       from small pool |  87167 KiB |    122 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 473932 KiB |   6326 MiB | 570868 GiB | 570868 GiB |
|       from large pool | 387840 KiB |   6255 MiB | 570179 GiB | 570178 GiB |
|       from small pool |  86092 KiB |    121 MiB |    689 GiB |    689 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6468 MiB |   6468 MiB |   6468 MiB |      0 B   |
|       from large pool |   6344 MiB |   6344 MiB |   6344 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1106 MiB |   1503 MiB | 232881 GiB | 232880 GiB |
|       from large pool |   1101 MiB |   1500 MiB | 232162 GiB | 232161 GiB |
|       from small pool |      4 MiB |      8 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3630    |    8317    |   54111 K  |   54107 K  |
|       from large pool |      87    |     730    |   22513 K  |   22513 K  |
|       from small pool |    3543    |    8228    |   31597 K  |   31593 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3630    |    8317    |   54111 K  |   54107 K  |
|       from large pool |      87    |     730    |   22513 K  |   22513 K  |
|       from small pool |    3543    |    8228    |   31597 K  |   31593 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     124    |     124    |       0    |
|       from large pool |      62    |      62    |      62    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3614    |   23283 K  |   23283 K  |
|       from large pool |      21    |      34    |    7034 K  |    7034 K  |
|       from small pool |      50    |    3594    |   16249 K  |   16249 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6374 MiB | 573360 GiB | 573360 GiB |
|       from large pool |  16640 KiB |   6302 MiB | 572661 GiB | 572661 GiB |
|       from small pool |      0 KiB |    122 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6374 MiB | 573360 GiB | 573360 GiB |
|       from large pool |  16640 KiB |   6302 MiB | 572661 GiB | 572661 GiB |
|       from small pool |      0 KiB |    122 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6326 MiB | 570868 GiB | 570868 GiB |
|       from large pool |  16640 KiB |   6255 MiB | 570179 GiB | 570179 GiB |
|       from small pool |      0 KiB |    121 MiB |    689 GiB |    689 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1582 MiB |   6468 MiB |   6468 MiB |   4886 MiB |
|       from large pool |   1492 MiB |   6344 MiB |   6344 MiB |   4852 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1503 MiB | 232882 GiB | 232882 GiB |
|       from large pool | 134912 KiB |   1500 MiB | 232163 GiB | 232162 GiB |
|       from small pool |      0 KiB |     22 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   54111 K  |   54111 K  |
|       from large pool |       2    |     730    |   22513 K  |   22513 K  |
|       from small pool |       0    |    8228    |   31597 K  |   31597 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   54111 K  |   54111 K  |
|       from large pool |       2    |     730    |   22513 K  |   22513 K  |
|       from small pool |       0    |    8228    |   31597 K  |   31597 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     124    |     124    |      56    |
|       from large pool |      23    |      62    |      62    |      39    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3614    |   23284 K  |   23284 K  |
|       from large pool |       4    |      34    |    7034 K  |    7034 K  |
|       from small pool |       0    |    3594    |   16250 K  |   16250 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6374 MiB | 573360 GiB | 573360 GiB |
|       from large pool |  16640 KiB |   6302 MiB | 572661 GiB | 572661 GiB |
|       from small pool |      0 KiB |    122 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6374 MiB | 573360 GiB | 573360 GiB |
|       from large pool |  16640 KiB |   6302 MiB | 572661 GiB | 572661 GiB |
|       from small pool |      0 KiB |    122 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6326 MiB | 570868 GiB | 570868 GiB |
|       from large pool |  16640 KiB |   6255 MiB | 570179 GiB | 570179 GiB |
|       from small pool |      0 KiB |    121 MiB |    689 GiB |    689 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1582 MiB |   6468 MiB |   6468 MiB |   4886 MiB |
|       from large pool |   1492 MiB |   6344 MiB |   6344 MiB |   4852 MiB |
|       from small pool |     90 MiB |    124 MiB |    124 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1503 MiB | 232882 GiB | 232882 GiB |
|       from large pool | 134912 KiB |   1500 MiB | 232163 GiB | 232162 GiB |
|       from small pool |      0 KiB |     22 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8317    |   54111 K  |   54111 K  |
|       from large pool |       2    |     730    |   22513 K  |   22513 K  |
|       from small pool |       0    |    8228    |   31597 K  |   31597 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8317    |   54111 K  |   54111 K  |
|       from large pool |       2    |     730    |   22513 K  |   22513 K  |
|       from small pool |       0    |    8228    |   31597 K  |   31597 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     124    |     124    |      56    |
|       from large pool |      23    |      62    |      62    |      39    |
|       from small pool |      45    |      62    |      62    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3614    |   23284 K  |   23284 K  |
|       from large pool |       4    |      34    |    7034 K  |    7034 K  |
|       from small pool |       0    |    3594    |   16250 K  |   16250 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120

 Experiment start at: 2024-08-05 04:46:15.373993
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9653395, 'precision': 0.965475, 'recall': 0.9653455, 'specificity': 0.9653455, 'f1': 0.9653373, 'auroc': 0.9930357, 'binary_precision': 0.97359407, 'binary_recall': 0.95667404, 'binary_specificity': 0.97401696, 'binary_f1_score': 0.96505994}
confusion matrix:
       0      1
0  28040    748
1   1249  27579
---- Validation: 
scalar performance:
{'acc': 0.92097116, 'precision': 0.59873426, 'recall': 0.70151746, 'specificity': 0.70151746, 'f1': 0.6276184, 'auroc': 0.7953545, 'binary_precision': 0.21827057, 'binary_recall': 0.46508172, 'binary_specificity': 0.9379532, 'binary_f1_score': 0.2971049}
confusion matrix:
       0     1
0  16946  1121
1    360   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.926845, 'precision': 0.6537517, 'recall': 0.8073482, 'specificity': 0.8073482, 'f1': 0.6988034, 'auroc': 0.8639984, 'binary_precision': 0.32234433, 'binary_recall': 0.6769231, 'binary_specificity': 0.9377733, 'binary_f1_score': 0.43672457}
confusion matrix:
      0    1
0  5576  370
1    84  176
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 04:59:19.974609,epoch time: 0:13:04.600616,used: 0:13:04.600616,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97403497, 'precision': 0.97413987, 'recall': 0.97404027, 'specificity': 0.97404027, 'f1': 0.9740337, 'auroc': 0.99477506, 'binary_precision': 0.9813667, 'binary_recall': 0.96645623, 'binary_specificity': 0.9816243, 'binary_f1_score': 0.97385436}
confusion matrix:
       0      1
0  28259    529
1    967  27861
---- Validation: 
scalar performance:
{'acc': 0.93105656, 'precision': 0.60319614, 'recall': 0.6709846, 'specificity': 0.6709846, 'f1': 0.62654996, 'auroc': 0.7501143, 'binary_precision': 0.22969432, 'binary_recall': 0.3907875, 'binary_specificity': 0.9511817, 'binary_f1_score': 0.28932893}
confusion matrix:
       0    1
0  17185  882
1    410  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93280697, 'precision': 0.6725019, 'recall': 0.8454003, 'specificity': 0.8454003, 'f1': 0.72366935, 'auroc': 0.90392697, 'binary_precision': 0.35648996, 'binary_recall': 0.75, 'binary_specificity': 0.94080055, 'binary_f1_score': 0.48327145}
confusion matrix:
      0    1
0  5594  352
1    65  195
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-05 05:11:53.437072,epoch time: 0:12:33.462463,used: 0:25:38.063079,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9633956, 'precision': 0.9644074, 'recall': 0.96337867, 'specificity': 0.96337867, 'f1': 0.9633746, 'auroc': 0.99625206, 'binary_precision': 0.9429121, 'binary_recall': 0.986576, 'binary_specificity': 0.9401813, 'binary_f1_score': 0.96424997}
confusion matrix:
       0      1
0  27065   1722
1    387  28442
---- Validation: 
scalar performance:
{'acc': 0.7752401, 'precision': 0.52441585, 'recall': 0.62164605, 'specificity': 0.62164605, 'f1': 0.49911934, 'auroc': 0.6746403, 'binary_precision': 0.07392246, 'binary_recall': 0.45616642, 'binary_specificity': 0.7871257, 'binary_f1_score': 0.1272275}
confusion matrix:
       0     1
0  14221  3846
1    366   307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70673543, 'precision': 0.5561167, 'recall': 0.8083372, 'specificity': 0.8083372, 'f1': 0.5140292, 'auroc': 0.93174076, 'binary_precision': 0.11727183, 'binary_recall': 0.91923076, 'binary_specificity': 0.69744366, 'binary_f1_score': 0.20800695}
confusion matrix:
      0     1
0  4147  1799
1    21   239
early stop counter: 1
val acc:0.7752401232719421, best validation acc: 0.931056559085846, corresponding to test acc:                         0.9328069686889648 / 0.9328069686889648
after epoch: 3,now: 2024-08-05 05:24:27.420797,epoch time: 0:12:33.983725,used: 0:38:12.046804,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97356635, 'precision': 0.9742826, 'recall': 0.97357994, 'specificity': 0.97357994, 'f1': 0.973557, 'auroc': 0.99535644, 'binary_precision': 0.99288785, 'binary_recall': 0.95400304, 'binary_specificity': 0.99315685, 'binary_f1_score': 0.97305715}
confusion matrix:
       0      1
0  28591    197
1   1326  27502
---- Validation: 
scalar performance:
{'acc': 0.94615793, 'precision': 0.6285303, 'recall': 0.6466295, 'specificity': 0.6466295, 'f1': 0.6368648, 'auroc': 0.654363, 'binary_precision': 0.2823834, 'binary_recall': 0.32392272, 'binary_specificity': 0.96933633, 'binary_f1_score': 0.3017301}
confusion matrix:
       0    1
0  17513  554
1    455  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722849, 'precision': 0.82854253, 'recall': 0.8237057, 'specificity': 0.8237057, 'f1': 0.82610404, 'auroc': 0.90553445, 'binary_precision': 0.671875, 'binary_recall': 0.6615385, 'binary_specificity': 0.98587286, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5862   84
1    88  172
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-05 05:37:01.639823,epoch time: 0:12:34.219026,used: 0:50:46.265830,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.950361, 'precision': 0.9530657, 'recall': 0.9503316, 'specificity': 0.9503316, 'f1': 0.9502845, 'auroc': 0.99581337, 'binary_precision': 0.9182503, 'binary_recall': 0.9888311, 'binary_specificity': 0.91183215, 'binary_f1_score': 0.9522346}
confusion matrix:
       0      1
0  26248   2538
1    322  28508
---- Validation: 
scalar performance:
{'acc': 0.603095, 'precision': 0.5036606, 'recall': 0.5252146, 'specificity': 0.5252146, 'f1': 0.41068664, 'auroc': 0.5697154, 'binary_precision': 0.040358745, 'binary_recall': 0.44130757, 'binary_specificity': 0.6091216, 'binary_f1_score': 0.07395419}
confusion matrix:
       0     1
0  11005  7062
1    376   297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4605221, 'precision': 0.5335477, 'recall': 0.7037543, 'specificity': 0.7037543, 'f1': 0.3698598, 'auroc': 0.93198186, 'binary_precision': 0.0701559, 'binary_recall': 0.9692308, 'binary_specificity': 0.43827784, 'binary_f1_score': 0.13084114}
confusion matrix:
      0     1
0  2606  3340
1     8   252
early stop counter: 1
val acc:0.6030949950218201, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 5,now: 2024-08-05 05:49:38.666810,epoch time: 0:12:37.026987,used: 1:03:23.292817,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9400514, 'precision': 0.94414335, 'recall': 0.9400165, 'specificity': 0.9400165, 'f1': 0.9399097, 'auroc': 0.99491596, 'binary_precision': 0.9016938, 'binary_recall': 0.9878941, 'binary_specificity': 0.89213884, 'binary_f1_score': 0.9428278}
confusion matrix:
       0      1
0  25682   3105
1    349  28480
---- Validation: 
scalar performance:
{'acc': 0.51568836, 'precision': 0.4974081, 'recall': 0.48131388, 'specificity': 0.48131388, 'f1': 0.3677054, 'auroc': 0.5580479, 'binary_precision': 0.033218533, 'binary_recall': 0.44427934, 'binary_specificity': 0.5183484, 'binary_f1_score': 0.061815176}
confusion matrix:
      0     1
0  9365  8702
1   374   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.31131163, 'precision': 0.52709055, 'recall': 0.6332428, 'specificity': 0.6332428, 'f1': 0.27326378, 'auroc': 0.92539036, 'binary_precision': 0.056562085, 'binary_recall': 0.9846154, 'binary_specificity': 0.28187016, 'binary_f1_score': 0.10697868}
confusion matrix:
      0     1
0  1676  4270
1     4   256
early stop counter: 2
val acc:0.5156883597373962, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 6,now: 2024-08-05 06:02:22.078613,epoch time: 0:12:43.411803,used: 1:16:06.704620,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9209421, 'precision': 0.92875236, 'recall': 0.9208907, 'specificity': 0.9208907, 'f1': 0.92057383, 'auroc': 0.9944465, 'binary_precision': 0.8710752, 'binary_recall': 0.9882761, 'binary_specificity': 0.8535052, 'binary_f1_score': 0.9259819}
confusion matrix:
       0      1
0  24569   4217
1    338  28492
---- Validation: 
scalar performance:
{'acc': 0.49172893, 'precision': 0.49569094, 'recall': 0.46888787, 'specificity': 0.46888787, 'f1': 0.35544962, 'auroc': 0.5526192, 'binary_precision': 0.031640213, 'binary_recall': 0.44427934, 'binary_specificity': 0.49349642, 'binary_f1_score': 0.059073403}
confusion matrix:
      0     1
0  8916  9151
1   374   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.24814695, 'precision': 0.52639055, 'recall': 0.6076354, 'specificity': 0.6076354, 'f1': 0.2272731, 'auroc': 0.92776394, 'binary_precision': 0.05278116, 'binary_recall': 1.0, 'binary_specificity': 0.21527077, 'binary_f1_score': 0.100269966}
confusion matrix:
      0     1
0  1280  4666
1     0   260
early stop counter: 3
val acc:0.49172893166542053, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 7,now: 2024-08-05 06:15:03.325273,epoch time: 0:12:41.246660,used: 1:28:47.951280,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9380207, 'precision': 0.9420184, 'recall': 0.93798774, 'specificity': 0.93798774, 'f1': 0.937877, 'auroc': 0.9943856, 'binary_precision': 0.90015525, 'binary_recall': 0.98543084, 'binary_specificity': 0.89054465, 'binary_f1_score': 0.9408648}
confusion matrix:
       0      1
0  25637   3151
1    420  28408
---- Validation: 
scalar performance:
{'acc': 0.63110995, 'precision': 0.50562066, 'recall': 0.537598, 'specificity': 0.537598, 'f1': 0.4238974, 'auroc': 0.5612443, 'binary_precision': 0.043057997, 'binary_recall': 0.43684992, 'binary_specificity': 0.63834614, 'binary_f1_score': 0.07838955}
confusion matrix:
       0     1
0  11533  6534
1    379   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32452464, 'precision': 0.52728605, 'recall': 0.63829917, 'specificity': 0.63829917, 'f1': 0.28237748, 'auroc': 0.89357877, 'binary_precision': 0.057406574, 'binary_recall': 0.9807692, 'binary_specificity': 0.29582912, 'binary_f1_score': 0.10846448}
confusion matrix:
      0     1
0  1759  4187
1     5   255
early stop counter: 4
val acc:0.6311099529266357, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 8,now: 2024-08-05 06:27:42.011609,epoch time: 0:12:38.686336,used: 1:41:26.637616,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94093657, 'precision': 0.9440591, 'recall': 0.9409075, 'specificity': 0.9409075, 'f1': 0.9408299, 'auroc': 0.9940741, 'binary_precision': 0.90699536, 'binary_recall': 0.98272514, 'binary_specificity': 0.8990899, 'binary_f1_score': 0.94334286}
confusion matrix:
       0      1
0  25883   2905
1    498  28330
---- Validation: 
scalar performance:
{'acc': 0.6681964, 'precision': 0.5084931, 'recall': 0.55397093, 'specificity': 0.55397093, 'f1': 0.44132984, 'auroc': 0.5722518, 'binary_precision': 0.04734694, 'binary_recall': 0.4309064, 'binary_specificity': 0.67703545, 'binary_f1_score': 0.085319206}
confusion matrix:
       0     1
0  12232  5835
1    383   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41637126, 'precision': 0.5315323, 'recall': 0.68439156, 'specificity': 0.68439156, 'f1': 0.34283423, 'auroc': 0.8983635, 'binary_precision': 0.06563307, 'binary_recall': 0.97692305, 'binary_specificity': 0.39186007, 'binary_f1_score': 0.12300241}
confusion matrix:
      0     1
0  2330  3616
1     6   254
early stop counter: 5
val acc:0.6681963801383972, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 9,now: 2024-08-05 06:40:17.099767,epoch time: 0:12:35.088158,used: 1:54:01.725774,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90924394, 'precision': 0.91880655, 'recall': 0.90919155, 'specificity': 0.90919155, 'f1': 0.90871525, 'auroc': 0.99282897, 'binary_precision': 0.8556959, 'binary_recall': 0.98466766, 'binary_specificity': 0.83371544, 'binary_f1_score': 0.9156627}
confusion matrix:
       0      1
0  24001   4787
1    442  28386
---- Validation: 
scalar performance:
{'acc': 0.59354323, 'precision': 0.5028147, 'recall': 0.51954556, 'specificity': 0.51954556, 'f1': 0.40594628, 'auroc': 0.5614083, 'binary_precision': 0.03927813, 'binary_recall': 0.4398217, 'binary_specificity': 0.5992694, 'binary_f1_score': 0.07211597}
confusion matrix:
       0     1
0  10827  7240
1    377   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39139542, 'precision': 0.5311883, 'recall': 0.6768746, 'specificity': 0.6768746, 'f1': 0.32734758, 'auroc': 0.8563113, 'binary_precision': 0.06375589, 'binary_recall': 0.98846155, 'binary_specificity': 0.3652876, 'binary_f1_score': 0.1197856}
confusion matrix:
      0     1
0  2172  3774
1     3   257
early stop counter: 6
val acc:0.5935432314872742, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 10,now: 2024-08-05 06:53:08.880614,epoch time: 0:12:51.780847,used: 2:06:53.506621,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9105457, 'precision': 0.919596, 'recall': 0.9104897, 'specificity': 0.9104897, 'f1': 0.9100526, 'auroc': 0.99232554, 'binary_precision': 0.8581629, 'binary_recall': 0.9838363, 'binary_specificity': 0.83714306, 'binary_f1_score': 0.91671246}
confusion matrix:
       0      1
0  24098   4688
1    466  28364
---- Validation: 
scalar performance:
{'acc': 0.6265208, 'precision': 0.5047082, 'recall': 0.53164166, 'specificity': 0.53164166, 'f1': 0.42111337, 'auroc': 0.5504271, 'binary_precision': 0.04185979, 'binary_recall': 0.4294205, 'binary_specificity': 0.63386285, 'binary_f1_score': 0.076283485}
confusion matrix:
       0     1
0  11452  6615
1    384   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42475024, 'precision': 0.5320072, 'recall': 0.6887642, 'specificity': 0.6887642, 'f1': 0.3481026, 'auroc': 0.86670804, 'binary_precision': 0.06652698, 'binary_recall': 0.97692305, 'binary_specificity': 0.40060544, 'binary_f1_score': 0.124570884}
confusion matrix:
      0     1
0  2382  3564
1     6   254
early stop counter: 7
val acc:0.6265208125114441, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 11,now: 2024-08-05 07:05:47.359503,epoch time: 0:12:38.478889,used: 2:19:31.985510,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.88121355, 'precision': 0.899665, 'recall': 0.8811352, 'specificity': 0.8811352, 'f1': 0.879811, 'auroc': 0.99006045, 'binary_precision': 0.8139728, 'binary_recall': 0.9885185, 'binary_specificity': 0.77375203, 'binary_f1_score': 0.8927945}
confusion matrix:
       0      1
0  22274   6513
1    331  28498
---- Validation: 
scalar performance:
{'acc': 0.46611527, 'precision': 0.49392876, 'recall': 0.45631927, 'specificity': 0.45631927, 'f1': 0.34214902, 'auroc': 0.5292605, 'binary_precision': 0.030205397, 'binary_recall': 0.44576523, 'binary_specificity': 0.46687332, 'binary_f1_score': 0.056577086}
confusion matrix:
      0     1
0  8435  9632
1   373   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.16081212, 'precision': 0.5237747, 'recall': 0.5620585, 'specificity': 0.5620585, 'f1': 0.155804, 'auroc': 0.89830756, 'binary_precision': 0.047549378, 'binary_recall': 1.0, 'binary_specificity': 0.124117054, 'binary_f1_score': 0.09078212}
confusion matrix:
     0     1
0  738  5208
1    0   260
early stop counter: 8
val acc:0.466115266084671, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 12,now: 2024-08-05 07:18:23.258354,epoch time: 0:12:35.898851,used: 2:32:07.884361,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9050958, 'precision': 0.91519964, 'recall': 0.9050417, 'specificity': 0.9050417, 'f1': 0.9045065, 'auroc': 0.9913963, 'binary_precision': 0.85060334, 'binary_recall': 0.982968, 'binary_specificity': 0.8271155, 'binary_f1_score': 0.912008}
confusion matrix:
       0      1
0  23811   4977
1    491  28337
---- Validation: 
scalar performance:
{'acc': 0.47353256, 'precision': 0.49437293, 'recall': 0.45945078, 'specificity': 0.45945078, 'f1': 0.34597868, 'auroc': 0.53723013, 'binary_precision': 0.03053825, 'binary_recall': 0.44427934, 'binary_specificity': 0.47462225, 'binary_f1_score': 0.05714832}
confusion matrix:
      0     1
0  8575  9492
1   374   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.25153077, 'precision': 0.5255549, 'recall': 0.60572326, 'specificity': 0.60572326, 'f1': 0.22968967, 'auroc': 0.8148124, 'binary_precision': 0.05264232, 'binary_recall': 0.99230766, 'binary_specificity': 0.21913892, 'binary_f1_score': 0.09998062}
confusion matrix:
      0     1
0  1303  4643
1     2   258
early stop counter: 9
val acc:0.4735325574874878, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 13,now: 2024-08-05 07:31:12.190470,epoch time: 0:12:48.932116,used: 2:44:56.816477,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88350457, 'precision': 0.8999419, 'recall': 0.8834272, 'specificity': 0.8834272, 'f1': 0.8822801, 'auroc': 0.9890716, 'binary_precision': 0.8190526, 'binary_recall': 0.9847381, 'binary_specificity': 0.7821163, 'binary_f1_score': 0.8942859}
confusion matrix:
       0      1
0  22514   6272
1    440  28390
---- Validation: 
scalar performance:
{'acc': 0.4113127, 'precision': 0.4899212, 'recall': 0.42932782, 'specificity': 0.42932782, 'f1': 0.31251952, 'auroc': 0.5137555, 'binary_precision': 0.027547205, 'binary_recall': 0.448737, 'binary_specificity': 0.40991864, 'binary_f1_score': 0.051907875}
confusion matrix:
      0      1
0  7406  10661
1   371    302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.15662262, 'precision': 0.5228795, 'recall': 0.55803317, 'specificity': 0.55803317, 'f1': 0.15208487, 'auroc': 0.79667324, 'binary_precision': 0.047159504, 'binary_recall': 0.99615383, 'binary_specificity': 0.11991255, 'binary_f1_score': 0.09005562}
confusion matrix:
     0     1
0  713  5233
1    1   259
early stop counter: 10
val acc:0.41131269931793213, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 14,now: 2024-08-05 07:44:16.109938,epoch time: 0:13:03.919468,used: 2:58:00.735945,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8842683, 'precision': 0.90160775, 'recall': 0.8841926, 'specificity': 0.8841926, 'f1': 0.88299084, 'auroc': 0.99174464, 'binary_precision': 0.81834114, 'binary_recall': 0.9880329, 'binary_specificity': 0.78035223, 'binary_f1_score': 0.8952165}
confusion matrix:
       0      1
0  22464   6323
1    345  28484
---- Validation: 
scalar performance:
{'acc': 0.46910352, 'precision': 0.49404895, 'recall': 0.4571538, 'specificity': 0.4571538, 'f1': 0.34365022, 'auroc': 0.54034466, 'binary_precision': 0.030281547, 'binary_recall': 0.44427934, 'binary_specificity': 0.47002822, 'binary_f1_score': 0.056698587}
confusion matrix:
      0     1
0  8492  9575
1   374   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.268611, 'precision': 0.5261943, 'recall': 0.61463684, 'specificity': 0.61463684, 'f1': 0.24255686, 'auroc': 0.769315, 'binary_precision': 0.053806048, 'binary_recall': 0.99230766, 'binary_specificity': 0.23696603, 'binary_f1_score': 0.10207715}
confusion matrix:
      0     1
0  1409  4537
1     2   258
early stop counter: 11
val acc:0.46910351514816284, best validation acc: 0.9461579322814941, corresponding to test acc:                         0.9722849130630493 / 0.9722849130630493
after epoch: 15,now: 2024-08-05 07:57:17.993841,epoch time: 0:13:01.883903,used: 3:11:02.619848,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_04_46_14_seed_1_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:11:02.619848 at 2024-08-05 07:57:17.993841
persisted model performance metric: 

scalar performance:
{'acc': 0.9722849, 'precision': 0.82854253, 'recall': 0.8237057, 'specificity': 0.8237057, 'f1': 0.82610404, 'auroc': 0.90553445, 'binary_precision': 0.671875, 'binary_recall': 0.6615385, 'binary_specificity': 0.98587286, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5862   84
1    88  172
oracle model performance metric: 

scalar performance:
{'acc': 0.9722849, 'precision': 0.82854253, 'recall': 0.8237057, 'specificity': 0.8237057, 'f1': 0.82610404, 'auroc': 0.90553445, 'binary_precision': 0.671875, 'binary_recall': 0.6615385, 'binary_specificity': 0.98587286, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5862   84
1    88  172
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 484691 KiB |   6374 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 397536 KiB |   6302 MiB |   1125 TiB |   1125 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 484691 KiB |   6374 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 397536 KiB |   6302 MiB |   1125 TiB |   1125 TiB |
|       from small pool |  87155 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 473930 KiB |   6326 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 387840 KiB |   6255 MiB |   1120 TiB |   1120 TiB |
|       from small pool |  86090 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6466 MiB |   6468 MiB |  11352 MiB |   4886 MiB |
|       from large pool |   6344 MiB |   6344 MiB |  11196 MiB |   4852 MiB |
|       from small pool |    122 MiB |    124 MiB |    156 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1188 MiB |   1582 MiB | 472968 GiB | 472967 GiB |
|       from large pool |   1181 MiB |   1579 MiB | 471505 GiB | 471504 GiB |
|       from small pool |      6 MiB |     22 MiB |   1462 GiB |   1462 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3606    |    8349    |  108803 K  |  108800 K  |
|       from large pool |      87    |     730    |   45339 K  |   45339 K  |
|       from small pool |    3519    |    8260    |   63464 K  |   63460 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3606    |    8349    |  108803 K  |  108800 K  |
|       from large pool |      87    |     730    |   45339 K  |   45339 K  |
|       from small pool |    3519    |    8260    |   63464 K  |   63460 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     124    |     179    |      56    |
|       from large pool |      62    |      62    |     101    |      39    |
|       from small pool |      61    |      62    |      78    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3630    |   48898 K  |   48898 K  |
|       from large pool |      21    |      34    |   16207 K  |   16207 K  |
|       from small pool |      54    |    3610    |   32690 K  |   32690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6374 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |   6302 MiB |   1125 TiB |   1125 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6374 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |   6302 MiB |   1125 TiB |   1125 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6326 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |   6255 MiB |   1120 TiB |   1120 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1662 MiB |   6468 MiB |  11352 MiB |   9690 MiB |
|       from large pool |   1570 MiB |   6344 MiB |  11196 MiB |   9626 MiB |
|       from small pool |     92 MiB |    124 MiB |    156 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1582 MiB | 472968 GiB | 472968 GiB |
|       from large pool | 134912 KiB |   1579 MiB | 471505 GiB | 471505 GiB |
|       from small pool |      0 KiB |     22 MiB |   1462 GiB |   1462 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  108803 K  |  108803 K  |
|       from large pool |       2    |     730    |   45339 K  |   45339 K  |
|       from small pool |       0    |    8260    |   63464 K  |   63464 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  108803 K  |  108803 K  |
|       from large pool |       2    |     730    |   45339 K  |   45339 K  |
|       from small pool |       0    |    8260    |   63464 K  |   63464 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     124    |     179    |     110    |
|       from large pool |      23    |      62    |     101    |      78    |
|       from small pool |      46    |      62    |      78    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3630    |   48899 K  |   48899 K  |
|       from large pool |       4    |      34    |   16207 K  |   16207 K  |
|       from small pool |       0    |    3610    |   32691 K  |   32691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6374 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |   6302 MiB |   1125 TiB |   1125 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6374 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |   6302 MiB |   1125 TiB |   1125 TiB |
|       from small pool |      0 KiB |    122 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6326 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |   6255 MiB |   1120 TiB |   1120 TiB |
|       from small pool |      0 KiB |    121 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1662 MiB |   6468 MiB |  11352 MiB |   9690 MiB |
|       from large pool |   1570 MiB |   6344 MiB |  11196 MiB |   9626 MiB |
|       from small pool |     92 MiB |    124 MiB |    156 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1582 MiB | 472968 GiB | 472968 GiB |
|       from large pool | 134912 KiB |   1579 MiB | 471505 GiB | 471505 GiB |
|       from small pool |      0 KiB |     22 MiB |   1462 GiB |   1462 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8349    |  108803 K  |  108803 K  |
|       from large pool |       2    |     730    |   45339 K  |   45339 K  |
|       from small pool |       0    |    8260    |   63464 K  |   63464 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8349    |  108803 K  |  108803 K  |
|       from large pool |       2    |     730    |   45339 K  |   45339 K  |
|       from small pool |       0    |    8260    |   63464 K  |   63464 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     124    |     179    |     110    |
|       from large pool |      23    |      62    |     101    |      78    |
|       from small pool |      46    |      62    |      78    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3630    |   48899 K  |   48899 K  |
|       from large pool |       4    |      34    |   16207 K  |   16207 K  |
|       from small pool |       0    |    3610    |   32691 K  |   32691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120

 Experiment start at: 2024-08-05 08:04:47.698409
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9608775, 'precision': 0.9626576, 'recall': 0.96088386, 'specificity': 0.96088386, 'f1': 0.96084017, 'auroc': 0.99317086, 'binary_precision': 0.99140674, 'binary_recall': 0.92983055, 'binary_specificity': 0.99193716, 'binary_f1_score': 0.95963186}
confusion matrix:
       0      1
0  28911    235
1   2046  27112
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9574389, 'precision': 0.66348004, 'recall': 0.6752652, 'specificity': 0.6752652, 'f1': 0.6691377, 'auroc': 0.81793845, 'binary_precision': 0.3477589, 'binary_recall': 0.37375414, 'binary_specificity': 0.9767762, 'binary_f1_score': 0.36028823}
confusion matrix:
       0    1
0  17749  422
1    377  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.82774305, 'recall': 0.77144015, 'specificity': 0.77144015, 'f1': 0.79666865, 'auroc': 0.85355765, 'binary_precision': 0.67336684, 'binary_recall': 0.553719, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.6077097}
confusion matrix:
      0    1
0  5932   65
1   108  134
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-05 08:18:14.716509,epoch time: 0:13:27.018100,used: 0:13:27.018100,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97109973, 'precision': 0.97109973, 'recall': 0.97109973, 'specificity': 0.97109973, 'f1': 0.97109973, 'auroc': 0.9948061, 'binary_precision': 0.97105825, 'binary_recall': 0.97115815, 'binary_specificity': 0.9710413, 'binary_f1_score': 0.9711082}
confusion matrix:
       0      1
0  28301    844
1    841  28318
---- Validation: 
scalar performance:
{'acc': 0.89234537, 'precision': 0.55291396, 'recall': 0.655292, 'specificity': 0.655292, 'f1': 0.56776917, 'auroc': 0.68009037, 'binary_precision': 0.12716763, 'binary_recall': 0.40199336, 'binary_specificity': 0.9085906, 'binary_f1_score': 0.19321358}
confusion matrix:
       0     1
0  16510  1661
1    360   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8813912, 'precision': 0.607827, 'recall': 0.8570101, 'specificity': 0.8570101, 'f1': 0.64336765, 'auroc': 0.90818346, 'binary_precision': 0.22333333, 'binary_recall': 0.8305785, 'binary_specificity': 0.88344175, 'binary_f1_score': 0.35201403}
confusion matrix:
      0    1
0  5298  699
1    41  201
early stop counter: 1
val acc:0.8923453688621521, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 2,now: 2024-08-05 08:31:10.542352,epoch time: 0:12:55.825843,used: 0:26:22.843943,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9567268, 'precision': 0.9577492, 'recall': 0.95672196, 'specificity': 0.95672196, 'f1': 0.95670235, 'auroc': 0.99451566, 'binary_precision': 0.9361674, 'binary_recall': 0.98031414, 'binary_specificity': 0.9331298, 'binary_f1_score': 0.9577323}
confusion matrix:
       0      1
0  27197   1949
1    574  28584
---- Validation: 
scalar performance:
{'acc': 0.730464, 'precision': 0.5138435, 'recall': 0.58692765, 'specificity': 0.58692765, 'f1': 0.4676059, 'auroc': 0.57607543, 'binary_precision': 0.052409638, 'binary_recall': 0.43355483, 'binary_specificity': 0.7403005, 'binary_f1_score': 0.09351487}
confusion matrix:
       0     1
0  13452  4719
1    341   261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58406794, 'precision': 0.5367801, 'recall': 0.74398696, 'specificity': 0.74398696, 'f1': 0.43558872, 'auroc': 0.91950107, 'binary_precision': 0.07937075, 'binary_recall': 0.91735536, 'binary_specificity': 0.5706186, 'binary_f1_score': 0.14610069}
confusion matrix:
      0     1
0  3422  2575
1    20   222
early stop counter: 2
val acc:0.730463981628418, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 3,now: 2024-08-05 08:44:04.715644,epoch time: 0:12:54.173292,used: 0:39:17.017235,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9467961, 'precision': 0.94864035, 'recall': 0.94678843, 'specificity': 0.94678843, 'f1': 0.9467407, 'auroc': 0.99274886, 'binary_precision': 0.9199355, 'binary_recall': 0.97880584, 'binary_specificity': 0.91477096, 'binary_f1_score': 0.948458}
confusion matrix:
       0      1
0  26661   2484
1    618  28541
---- Validation: 
scalar performance:
{'acc': 0.7240185, 'precision': 0.51200545, 'recall': 0.5763707, 'specificity': 0.5763707, 'f1': 0.46302086, 'auroc': 0.5430179, 'binary_precision': 0.04957702, 'binary_recall': 0.41860464, 'binary_specificity': 0.7341368, 'binary_f1_score': 0.088654354}
confusion matrix:
       0     1
0  13340  4831
1    350   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5220388, 'precision': 0.5324787, 'recall': 0.7176691, 'specificity': 0.7176691, 'f1': 0.40073523, 'auroc': 0.9106827, 'binary_precision': 0.07053292, 'binary_recall': 0.92975205, 'binary_specificity': 0.50558615, 'binary_f1_score': 0.1311189}
confusion matrix:
      0     1
0  3032  2965
1    17   225
early stop counter: 3
val acc:0.7240185141563416, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 4,now: 2024-08-05 08:56:58.200220,epoch time: 0:12:53.484576,used: 0:52:10.501811,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9466932, 'precision': 0.9497091, 'recall': 0.946689, 'specificity': 0.946689, 'f1': 0.9466033, 'auroc': 0.9954975, 'binary_precision': 0.912907, 'binary_recall': 0.9876179, 'binary_specificity': 0.90576005, 'binary_f1_score': 0.948794}
confusion matrix:
       0      1
0  26402   2747
1    361  28794
---- Validation: 
scalar performance:
{'acc': 0.65247965, 'precision': 0.50707936, 'recall': 0.551462, 'specificity': 0.551462, 'f1': 0.4308365, 'auroc': 0.5640822, 'binary_precision': 0.041356876, 'binary_recall': 0.4435216, 'binary_specificity': 0.6594024, 'binary_f1_score': 0.07565883}
confusion matrix:
       0     1
0  11982  6189
1    335   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37746432, 'precision': 0.5276125, 'recall': 0.66625774, 'specificity': 0.66625774, 'f1': 0.31522018, 'auroc': 0.907114, 'binary_precision': 0.057580177, 'binary_recall': 0.9793388, 'binary_specificity': 0.3531766, 'binary_f1_score': 0.10876549}
confusion matrix:
      0     1
0  2118  3879
1     5   237
early stop counter: 4
val acc:0.6524796485900879, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 5,now: 2024-08-05 09:10:36.398160,epoch time: 0:13:38.197940,used: 1:05:48.699751,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96626306, 'precision': 0.9669889, 'recall': 0.96625966, 'specificity': 0.96625966, 'f1': 0.9662497, 'auroc': 0.9963494, 'binary_precision': 0.9486206, 'binary_recall': 0.9859382, 'binary_specificity': 0.9465811, 'binary_f1_score': 0.9669194}
confusion matrix:
       0      1
0  27590   1557
1    410  28747
---- Validation: 
scalar performance:
{'acc': 0.7600277, 'precision': 0.5174754, 'recall': 0.6013962, 'specificity': 0.6013962, 'f1': 0.48247835, 'auroc': 0.5791366, 'binary_precision': 0.05878363, 'binary_recall': 0.43189368, 'binary_specificity': 0.7708987, 'binary_f1_score': 0.10348259}
confusion matrix:
       0     1
0  14008  4163
1    342   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56531495, 'precision': 0.5368481, 'recall': 0.74612856, 'specificity': 0.74612856, 'f1': 0.42631984, 'auroc': 0.9213284, 'binary_precision': 0.077922076, 'binary_recall': 0.94214875, 'binary_specificity': 0.5501084, 'binary_f1_score': 0.14393939}
confusion matrix:
      0     1
0  3299  2698
1    14   228
early stop counter: 5
val acc:0.7600277066230774, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 6,now: 2024-08-05 09:23:31.463964,epoch time: 0:12:55.065804,used: 1:18:43.765555,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95523465, 'precision': 0.95689756, 'recall': 0.95522845, 'specificity': 0.95522845, 'f1': 0.95519346, 'auroc': 0.99542725, 'binary_precision': 0.92938477, 'binary_recall': 0.9853557, 'binary_specificity': 0.9251012, 'binary_f1_score': 0.9565522}
confusion matrix:
       0      1
0  26963   2183
1    427  28731
---- Validation: 
scalar performance:
{'acc': 0.76311725, 'precision': 0.5176459, 'recall': 0.6013861, 'specificity': 0.6013861, 'f1': 0.4837436, 'auroc': 0.56974673, 'binary_precision': 0.059160743, 'binary_recall': 0.42857143, 'binary_specificity': 0.7742007, 'binary_f1_score': 0.10396938}
confusion matrix:
       0     1
0  14068  4103
1    344   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48773843, 'precision': 0.5318632, 'recall': 0.71172327, 'specificity': 0.71172327, 'f1': 0.3819701, 'auroc': 0.9023609, 'binary_precision': 0.06762295, 'binary_recall': 0.95454544, 'binary_specificity': 0.46890113, 'binary_f1_score': 0.12629852}
confusion matrix:
      0     1
0  2812  3185
1    11   231
early stop counter: 6
val acc:0.763117253780365, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 7,now: 2024-08-05 09:36:30.528338,epoch time: 0:12:59.064374,used: 1:31:42.829929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.977017, 'precision': 0.9770472, 'recall': 0.97701645, 'specificity': 0.97701645, 'f1': 0.9770167, 'auroc': 0.996474, 'binary_precision': 0.9732866, 'binary_recall': 0.9809645, 'binary_specificity': 0.9730685, 'binary_f1_score': 0.9771105}
confusion matrix:
       0      1
0  28363    785
1    555  28601
---- Validation: 
scalar performance:
{'acc': 0.8829702, 'precision': 0.5474187, 'recall': 0.6504491, 'specificity': 0.6504491, 'f1': 0.5587576, 'auroc': 0.5953632, 'binary_precision': 0.11640212, 'binary_recall': 0.40199336, 'binary_specificity': 0.89890486, 'binary_f1_score': 0.18052965}
confusion matrix:
       0     1
0  16334  1837
1    360   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78730565, 'precision': 0.5656991, 'recall': 0.8219482, 'specificity': 0.8219482, 'f1': 0.5575273, 'auroc': 0.9042786, 'binary_precision': 0.13857429, 'binary_recall': 0.8595041, 'binary_specificity': 0.7843922, 'binary_f1_score': 0.23866896}
confusion matrix:
      0     1
0  4704  1293
1    34   208
early stop counter: 7
val acc:0.8829702138900757, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 8,now: 2024-08-05 09:50:06.426895,epoch time: 0:13:35.898557,used: 1:45:18.728486,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9427998, 'precision': 0.94661033, 'recall': 0.9427935, 'specificity': 0.9427935, 'f1': 0.942677, 'auroc': 0.99633825, 'binary_precision': 0.9053914, 'binary_recall': 0.988956, 'binary_specificity': 0.896631, 'binary_f1_score': 0.94533056}
confusion matrix:
       0      1
0  26135   3013
1    322  28834
---- Validation: 
scalar performance:
{'acc': 0.73994565, 'precision': 0.5150991, 'recall': 0.5926286, 'specificity': 0.5926286, 'f1': 0.4725157, 'auroc': 0.62104464, 'binary_precision': 0.054537885, 'binary_recall': 0.43521595, 'binary_specificity': 0.75004125, 'binary_f1_score': 0.09692934}
confusion matrix:
       0     1
0  13629  4542
1    340   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.499439, 'precision': 0.5335517, 'recall': 0.72375786, 'specificity': 0.72375786, 'f1': 0.3894568, 'auroc': 0.8924999, 'binary_precision': 0.069871604, 'binary_recall': 0.96694213, 'binary_specificity': 0.48057362, 'binary_f1_score': 0.13032581}
confusion matrix:
      0     1
0  2882  3115
1     8   234
early stop counter: 8
val acc:0.739945650100708, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 9,now: 2024-08-05 10:06:56.756261,epoch time: 0:16:50.329366,used: 2:02:09.057852,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9445321, 'precision': 0.947726, 'recall': 0.9445249, 'specificity': 0.9445249, 'f1': 0.9444324, 'auroc': 0.9954326, 'binary_precision': 0.90995353, 'binary_recall': 0.98672706, 'binary_specificity': 0.9023227, 'binary_f1_score': 0.9467865}
confusion matrix:
       0      1
0  26300   2847
1    387  28770
---- Validation: 
scalar performance:
{'acc': 0.71954405, 'precision': 0.5128642, 'recall': 0.5828929, 'specificity': 0.5828929, 'f1': 0.462515, 'auroc': 0.58136463, 'binary_precision': 0.05068414, 'binary_recall': 0.43687707, 'binary_specificity': 0.7289087, 'binary_f1_score': 0.090830594}
confusion matrix:
       0     1
0  13245  4926
1    339   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55922425, 'precision': 0.53397095, 'recall': 0.7270984, 'specificity': 0.7270984, 'f1': 0.42092502, 'auroc': 0.8496059, 'binary_precision': 0.07462686, 'binary_recall': 0.90909094, 'binary_specificity': 0.5451059, 'binary_f1_score': 0.13793102}
confusion matrix:
      0     1
0  3269  2728
1    22   220
early stop counter: 9
val acc:0.7195440530776978, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 10,now: 2024-08-05 10:48:21.182057,epoch time: 0:41:24.425796,used: 2:43:33.483648,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94412047, 'precision': 0.9476307, 'recall': 0.94410837, 'specificity': 0.94410837, 'f1': 0.94400966, 'auroc': 0.996068, 'binary_precision': 0.9080597, 'binary_recall': 0.9883402, 'binary_specificity': 0.8998765, 'binary_f1_score': 0.94650066}
confusion matrix:
       0      1
0  26226   2918
1    340  28820
---- Validation: 
scalar performance:
{'acc': 0.67240185, 'precision': 0.5087517, 'recall': 0.5617531, 'specificity': 0.5617531, 'f1': 0.44030905, 'auroc': 0.59350663, 'binary_precision': 0.04390003, 'binary_recall': 0.4435216, 'binary_specificity': 0.67998457, 'binary_f1_score': 0.07989228}
confusion matrix:
       0     1
0  12356  5815
1    335   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.40487257, 'precision': 0.52763623, 'recall': 0.6725839, 'specificity': 0.6725839, 'f1': 0.3320533, 'auroc': 0.84412456, 'binary_precision': 0.05918212, 'binary_recall': 0.9628099, 'binary_specificity': 0.38235784, 'binary_f1_score': 0.11150993}
confusion matrix:
      0     1
0  2293  3704
1     9   233
early stop counter: 10
val acc:0.6724018454551697, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 11,now: 2024-08-05 11:34:41.664807,epoch time: 0:46:20.482750,used: 3:29:53.966398,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9233672, 'precision': 0.93140054, 'recall': 0.92335546, 'specificity': 0.92335546, 'f1': 0.9230073, 'auroc': 0.9950793, 'binary_precision': 0.87257415, 'binary_recall': 0.9915629, 'binary_specificity': 0.855148, 'binary_f1_score': 0.92827094}
confusion matrix:
       0      1
0  24925   4222
1    246  28911
---- Validation: 
scalar performance:
{'acc': 0.59841263, 'precision': 0.5033599, 'recall': 0.52594197, 'specificity': 0.52594197, 'f1': 0.4054972, 'auroc': 0.5721874, 'binary_precision': 0.03611074, 'binary_recall': 0.44850498, 'binary_specificity': 0.603379, 'binary_f1_score': 0.066839956}
confusion matrix:
       0     1
0  10964  7207
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3752204, 'precision': 0.52682155, 'recall': 0.661125, 'specificity': 0.661125, 'f1': 0.31347978, 'auroc': 0.8704753, 'binary_precision': 0.05695589, 'binary_recall': 0.9710744, 'binary_specificity': 0.35117558, 'binary_f1_score': 0.10760073}
confusion matrix:
      0     1
0  2106  3891
1     7   235
early stop counter: 11
val acc:0.5984126329421997, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 12,now: 2024-08-05 12:17:46.754938,epoch time: 0:43:05.090131,used: 4:12:59.056529,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91259605, 'precision': 0.92266756, 'recall': 0.9125828, 'specificity': 0.9125828, 'f1': 0.9120704, 'auroc': 0.99464214, 'binary_precision': 0.85746545, 'binary_recall': 0.9897452, 'binary_specificity': 0.8354204, 'binary_f1_score': 0.918869}
confusion matrix:
       0      1
0  24350   4797
1    299  28858
---- Validation: 
scalar performance:
{'acc': 0.566292, 'precision': 0.5010821, 'recall': 0.5085466, 'specificity': 0.5085466, 'f1': 0.3899598, 'auroc': 0.5724904, 'binary_precision': 0.03330032, 'binary_recall': 0.44684386, 'binary_specificity': 0.5702493, 'binary_f1_score': 0.06198157}
confusion matrix:
       0     1
0  10362  7809
1    333   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.32521236, 'precision': 0.52528596, 'recall': 0.6390774, 'specificity': 0.6390774, 'f1': 0.28051826, 'auroc': 0.81666934, 'binary_precision': 0.053354345, 'binary_recall': 0.9793388, 'binary_specificity': 0.29881608, 'binary_f1_score': 0.10119557}
confusion matrix:
      0     1
0  1792  4205
1     5   237
early stop counter: 12
val acc:0.5662919878959656, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 13,now: 2024-08-05 12:55:43.210397,epoch time: 0:37:56.455459,used: 4:50:55.511988,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.94341725, 'precision': 0.94737744, 'recall': 0.9434108, 'specificity': 0.9434108, 'f1': 0.9432912, 'auroc': 0.9965173, 'binary_precision': 0.9053202, 'binary_recall': 0.9904308, 'binary_specificity': 0.89639086, 'binary_f1_score': 0.94596493}
confusion matrix:
       0      1
0  26128   3020
1    279  28877
---- Validation: 
scalar performance:
{'acc': 0.7193842, 'precision': 0.51284677, 'recall': 0.58281034, 'specificity': 0.58281034, 'f1': 0.46243638, 'auroc': 0.58872616, 'binary_precision': 0.050654855, 'binary_recall': 0.43687707, 'binary_specificity': 0.7287436, 'binary_f1_score': 0.09078357}
confusion matrix:
       0     1
0  13242  4929
1    339   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39717904, 'precision': 0.528232, 'recall': 0.6745301, 'specificity': 0.6745301, 'f1': 0.32767478, 'auroc': 0.90320367, 'binary_precision': 0.05913305, 'binary_recall': 0.9752066, 'binary_specificity': 0.3738536, 'binary_f1_score': 0.11150484}
confusion matrix:
      0     1
0  2242  3755
1     6   236
early stop counter: 13
val acc:0.7193841934204102, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 14,now: 2024-08-05 13:35:55.566348,epoch time: 0:40:12.355951,used: 5:31:07.867939,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.908514, 'precision': 0.9207027, 'recall': 0.90849936, 'specificity': 0.90849936, 'f1': 0.90784436, 'auroc': 0.9954746, 'binary_precision': 0.84913677, 'binary_recall': 0.9935864, 'binary_specificity': 0.82341236, 'binary_f1_score': 0.91569996}
confusion matrix:
       0      1
0  24000   5147
1    187  28970
---- Validation: 
scalar performance:
{'acc': 0.63298357, 'precision': 0.5057675, 'recall': 0.5429971, 'specificity': 0.5429971, 'f1': 0.4218309, 'auroc': 0.6194352, 'binary_precision': 0.039408144, 'binary_recall': 0.44684386, 'binary_specificity': 0.6391503, 'binary_f1_score': 0.07242864}
confusion matrix:
       0     1
0  11614  6557
1    333   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.20644334, 'precision': 0.5233006, 'recall': 0.5872103, 'specificity': 0.5872103, 'f1': 0.19304247, 'auroc': 0.8835473, 'binary_precision': 0.046601195, 'binary_recall': 1.0, 'binary_specificity': 0.17442055, 'binary_f1_score': 0.08905244}
confusion matrix:
      0     1
0  1046  4951
1     0   242
early stop counter: 14
val acc:0.6329835653305054, best validation acc: 0.9574388861656189, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 15,now: 2024-08-05 14:16:18.936950,epoch time: 0:40:23.370602,used: 6:11:31.238541,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_05_08_04_47_seed_2_24067120
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 6:11:31.238541 at 2024-08-05 14:16:18.936950
persisted model performance metric: 

scalar performance:
{'acc': 0.9722712, 'precision': 0.82774305, 'recall': 0.77144015, 'specificity': 0.77144015, 'f1': 0.79666865, 'auroc': 0.85355765, 'binary_precision': 0.67336684, 'binary_recall': 0.553719, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.6077097}
confusion matrix:
      0    1
0  5932   65
1   108  134
oracle model performance metric: 

scalar performance:
{'acc': 0.9722712, 'precision': 0.82774305, 'recall': 0.77144015, 'specificity': 0.77144015, 'f1': 0.79666865, 'auroc': 0.85355765, 'binary_precision': 0.67336684, 'binary_recall': 0.553719, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.6077097}
confusion matrix:
      0    1
0  5932   65
1   108  134
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_erm_irm_resnet_halffreeze_allfreeze_2024-08-04_17-13-38/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 484697 KiB |   6374 MiB |   1714 TiB |   1714 TiB |
|       from large pool | 397536 KiB |   6302 MiB |   1712 TiB |   1712 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 484697 KiB |   6374 MiB |   1714 TiB |   1714 TiB |
|       from large pool | 397536 KiB |   6302 MiB |   1712 TiB |   1712 TiB |
|       from small pool |  87161 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 473931 KiB |   6326 MiB |   1705 TiB |   1705 TiB |
|       from large pool | 387840 KiB |   6255 MiB |   1703 TiB |   1703 TiB |
|       from small pool |  86091 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6466 MiB |   6468 MiB |  16156 MiB |   9690 MiB |
|       from large pool |   6344 MiB |   6344 MiB |  15970 MiB |   9626 MiB |
|       from small pool |    122 MiB |    124 MiB |    186 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1188 MiB |   1582 MiB | 723954 GiB | 723952 GiB |
|       from large pool |   1181 MiB |   1579 MiB | 721688 GiB | 721687 GiB |
|       from small pool |      6 MiB |     22 MiB |   2265 GiB |   2265 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3618    |    8435    |  165230 K  |  165226 K  |
|       from large pool |      87    |     730    |   69067 K  |   69067 K  |
|       from small pool |    3531    |    8346    |   96162 K  |   96159 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3618    |    8435    |  165230 K  |  165226 K  |
|       from large pool |      87    |     730    |   69067 K  |   69067 K  |
|       from small pool |    3531    |    8346    |   96162 K  |   96159 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     124    |     233    |     110    |
|       from large pool |      62    |      62    |     140    |      78    |
|       from small pool |      61    |      62    |      93    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    3673    |   75344 K  |   75344 K  |
|       from large pool |      21    |      34    |   25716 K  |   25716 K  |
|       from small pool |      55    |    3653    |   49627 K  |   49627 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6374 MiB |   1714 TiB |   1714 TiB |
|       from large pool |  16640 KiB |   6302 MiB |   1712 TiB |   1712 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6374 MiB |   1714 TiB |   1714 TiB |
|       from large pool |  16640 KiB |   6302 MiB |   1712 TiB |   1712 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6326 MiB |   1705 TiB |   1705 TiB |
|       from large pool |  16640 KiB |   6255 MiB |   1703 TiB |   1703 TiB |
|       from small pool |      0 KiB |    121 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1662 MiB |   6468 MiB |  16156 MiB |  14494 MiB |
|       from large pool |   1570 MiB |   6344 MiB |  15970 MiB |  14400 MiB |
|       from small pool |     92 MiB |    124 MiB |    186 MiB |     94 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1582 MiB | 723954 GiB | 723954 GiB |
|       from large pool | 134912 KiB |   1579 MiB | 721688 GiB | 721688 GiB |
|       from small pool |      0 KiB |     25 MiB |   2265 GiB |   2265 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8435    |  165230 K  |  165230 K  |
|       from large pool |       2    |     730    |   69067 K  |   69067 K  |
|       from small pool |       0    |    8346    |   96162 K  |   96162 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8435    |  165230 K  |  165230 K  |
|       from large pool |       2    |     730    |   69067 K  |   69067 K  |
|       from small pool |       0    |    8346    |   96162 K  |   96162 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     124    |     233    |     164    |
|       from large pool |      23    |      62    |     140    |     117    |
|       from small pool |      46    |      62    |      93    |      47    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3673    |   75345 K  |   75345 K  |
|       from large pool |       4    |      34    |   25716 K  |   25716 K  |
|       from small pool |       0    |    3653    |   49629 K  |   49629 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug  5 14:17:13 2024]
Finished job 0.
1 of 1 steps (100%) done
