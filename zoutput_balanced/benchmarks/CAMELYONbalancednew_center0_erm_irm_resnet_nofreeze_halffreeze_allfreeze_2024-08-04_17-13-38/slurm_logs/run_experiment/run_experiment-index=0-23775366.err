Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 04:38:47 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366

 Experiment start at: 2024-07-31 04:46:45.097384
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.993288, 'precision': 0.9933009, 'recall': 0.9932903, 'specificity': 0.9932903, 'f1': 0.99328804, 'auroc': 0.999619, 'binary_precision': 0.99604136, 'binary_recall': 0.990524, 'binary_specificity': 0.9960567, 'binary_f1_score': 0.993275}
confusion matrix:
       0      1
0  28543    113
1    272  28432
---- Validation: 
scalar performance:
{'acc': 0.96078116, 'precision': 0.70799536, 'recall': 0.7306775, 'specificity': 0.7306775, 'f1': 0.71867216, 'auroc': 0.89552283, 'binary_precision': 0.43435755, 'binary_recall': 0.4836703, 'binary_specificity': 0.97768474, 'binary_f1_score': 0.45768946}
confusion matrix:
       0    1
0  17744  405
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.80240774, 'recall': 0.82999253, 'specificity': 0.82999253, 'f1': 0.81552064, 'auroc': 0.90643024, 'binary_precision': 0.6188811, 'binary_recall': 0.6781609, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.6471664}
confusion matrix:
      0    1
0  5888  109
1    84  177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 05:04:39.026129,epoch time: 0:17:53.928745,used: 0:17:53.928745,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99527544, 'precision': 0.9952923, 'recall': 0.99527794, 'specificity': 0.99527794, 'f1': 0.9952755, 'auroc': 0.99983346, 'binary_precision': 0.99838734, 'binary_recall': 0.9921611, 'binary_specificity': 0.9983948, 'binary_f1_score': 0.99526453}
confusion matrix:
       0      1
0  28611     46
1    225  28478
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.73262024, 'recall': 0.61312056, 'specificity': 0.61312056, 'f1': 0.6501031, 'auroc': 0.9019997, 'binary_precision': 0.49185666, 'binary_recall': 0.2348367, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.31789473}
confusion matrix:
       0    1
0  17993  156
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.88415295, 'recall': 0.74237597, 'specificity': 0.74237597, 'f1': 0.79569566, 'auroc': 0.89484686, 'binary_precision': 0.79012346, 'binary_recall': 0.49042144, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.60520095}
confusion matrix:
      0    1
0  5963   34
1   133  128
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 05:22:11.346819,epoch time: 0:17:32.320690,used: 0:35:26.249435,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99717575, 'precision': 0.99717575, 'recall': 0.9971762, 'specificity': 0.9971762, 'f1': 0.9971757, 'auroc': 0.9999397, 'binary_precision': 0.9976289, 'binary_recall': 0.9967253, 'binary_specificity': 0.99762696, 'binary_f1_score': 0.9971769}
confusion matrix:
       0      1
0  28587     68
1     94  28611
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.74917454, 'recall': 0.68653715, 'specificity': 0.68653715, 'f1': 0.7128722, 'auroc': 0.9213566, 'binary_precision': 0.5199161, 'binary_recall': 0.38569206, 'binary_specificity': 0.98738223, 'binary_f1_score': 0.44285712}
confusion matrix:
       0    1
0  17920  229
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.82037324, 'recall': 0.7154708, 'specificity': 0.7154708, 'f1': 0.7565347, 'auroc': 0.8984964, 'binary_precision': 0.6647399, 'binary_recall': 0.44061303, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.52995396}
confusion matrix:
      0    1
0  5939   58
1   146  115
better model found
persisted
after epoch: 3,now: 2024-07-31 05:39:37.128390,epoch time: 0:17:25.781571,used: 0:52:52.031006,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99755925, 'precision': 0.9975598, 'recall': 0.9975598, 'specificity': 0.9975598, 'f1': 0.9975593, 'auroc': 0.9999006, 'binary_precision': 0.99825543, 'binary_recall': 0.99686414, 'binary_specificity': 0.99825543, 'binary_f1_score': 0.9975593}
confusion matrix:
       0      1
0  28610     50
1     90  28610
---- Validation: 
scalar performance:
{'acc': 0.96397406, 'precision': 0.72188675, 'recall': 0.6745763, 'specificity': 0.6745763, 'f1': 0.6950773, 'auroc': 0.89928186, 'binary_precision': 0.46613547, 'binary_recall': 0.36391914, 'binary_specificity': 0.98523337, 'binary_f1_score': 0.40873364}
confusion matrix:
       0    1
0  17881  268
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8501406, 'recall': 0.6714948, 'specificity': 0.6714948, 'f1': 0.7273424, 'auroc': 0.89875317, 'binary_precision': 0.728, 'binary_recall': 0.348659, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4715026}
confusion matrix:
      0   1
0  5963  34
1   170  91
early stop counter: 1
val acc:0.9639740586280823, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.9674017429351807 / 0.9733141660690308
after epoch: 4,now: 2024-07-31 05:57:02.919143,epoch time: 0:17:25.790753,used: 1:10:17.821759,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99836123, 'precision': 0.99836135, 'recall': 0.9983617, 'specificity': 0.9983617, 'f1': 0.99836123, 'auroc': 0.9999719, 'binary_precision': 0.99891883, 'binary_recall': 0.99780524, 'binary_specificity': 0.9989182, 'binary_f1_score': 0.9983617}
confusion matrix:
       0      1
0  28624     31
1     63  28642
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.72743946, 'recall': 0.601732, 'specificity': 0.601732, 'f1': 0.63812065, 'auroc': 0.9059828, 'binary_precision': 0.4822695, 'binary_recall': 0.21150856, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.29405406}
confusion matrix:
       0    1
0  18003  146
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.76847756, 'recall': 0.6407581, 'specificity': 0.6407581, 'f1': 0.68238115, 'auroc': 0.89188826, 'binary_precision': 0.5671642, 'binary_recall': 0.29118773, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.38481012}
confusion matrix:
      0   1
0  5939  58
1   185  76
early stop counter: 2
val acc:0.9652511477470398, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.9674017429351807 / 0.9733141660690308
after epoch: 5,now: 2024-07-31 06:14:30.797767,epoch time: 0:17:27.878624,used: 1:27:45.700383,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9976987, 'precision': 0.9977052, 'recall': 0.99770045, 'specificity': 0.99770045, 'f1': 0.9976987, 'auroc': 0.9999397, 'binary_precision': 0.99972016, 'binary_recall': 0.99568003, 'binary_specificity': 0.9997208, 'binary_f1_score': 0.997696}
confusion matrix:
       0      1
0  28648      8
1    124  28580
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.79899526, 'recall': 0.53883135, 'specificity': 0.53883135, 'f1': 0.5620046, 'auroc': 0.92365927, 'binary_precision': 0.6296296, 'binary_recall': 0.07931571, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.14088397}
confusion matrix:
       0   1
0  18119  30
1    592  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.56254, 'recall': 0.5014988, 'specificity': 0.5014988, 'f1': 0.4929281, 'auroc': 0.88928676, 'binary_precision': 0.16666667, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0074906363}
confusion matrix:
      0  1
0  5992  5
1   260  1
better model found
persisted
after epoch: 6,now: 2024-07-31 06:32:01.481333,epoch time: 0:17:30.683566,used: 1:45:16.383949,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99785566, 'precision': 0.99786246, 'recall': 0.99785715, 'specificity': 0.99785715, 'f1': 0.99785566, 'auroc': 0.99996996, 'binary_precision': 0.99989504, 'binary_recall': 0.995819, 'binary_specificity': 0.99989533, 'binary_f1_score': 0.99785286}
confusion matrix:
       0      1
0  28656      3
1    120  28581
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7050842, 'recall': 0.5230313, 'specificity': 0.5230313, 'f1': 0.5346502, 'auroc': 0.8772764, 'binary_precision': 0.44285715, 'binary_recall': 0.048211507, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.086956516}
confusion matrix:
       0   1
0  18110  39
1    612  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7927695, 'recall': 0.5279853, 'specificity': 0.5279853, 'f1': 0.54220724, 'auroc': 0.8774117, 'binary_precision': 0.625, 'binary_recall': 0.057471264, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.10526315}
confusion matrix:
      0   1
0  5988   9
1   246  15
early stop counter: 1
val acc:0.9653576016426086, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9576541781425476 / 0.9733141660690308
after epoch: 7,now: 2024-07-31 06:49:23.977743,epoch time: 0:17:22.496410,used: 2:02:38.880359,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99848324, 'precision': 0.9984857, 'recall': 0.99848425, 'specificity': 0.99848425, 'f1': 0.99848324, 'auroc': 0.9999366, 'binary_precision': 0.99979043, 'binary_recall': 0.9971779, 'binary_specificity': 0.9997906, 'binary_f1_score': 0.99848247}
confusion matrix:
       0      1
0  28652      6
1     81  28621
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7707237, 'recall': 0.5635832, 'specificity': 0.5635832, 'f1': 0.59787667, 'auroc': 0.8988591, 'binary_precision': 0.5714286, 'binary_recall': 0.13063763, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.21265823}
confusion matrix:
       0   1
0  18086  63
1    559  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9699584, 'precision': 0.9499643, 'recall': 0.65084076, 'specificity': 0.65084076, 'f1': 0.7205998, 'auroc': 0.905735, 'binary_precision': 0.92941177, 'binary_recall': 0.30268198, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.45664737}
confusion matrix:
      0   1
0  5991   6
1   182  79
early stop counter: 2
val acc:0.9669008255004883, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9576541781425476 / 0.9733141660690308
after epoch: 8,now: 2024-07-31 07:06:48.585708,epoch time: 0:17:24.607965,used: 2:20:03.488324,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9986576, 'precision': 0.9986594, 'recall': 0.99865854, 'specificity': 0.99865854, 'f1': 0.9986576, 'auroc': 0.99997437, 'binary_precision': 0.9998254, 'binary_recall': 0.99749154, 'binary_specificity': 0.99982554, 'binary_f1_score': 0.9986571}
confusion matrix:
       0      1
0  28652      5
1     72  28631
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.76642406, 'recall': 0.5536947, 'specificity': 0.5536947, 'f1': 0.5838122, 'auroc': 0.8904041, 'binary_precision': 0.56349206, 'binary_recall': 0.11041991, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.1846554}
confusion matrix:
       0   1
0  18094  55
1    572  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.83818096, 'recall': 0.54705894, 'specificity': 0.54705894, 'f1': 0.574394, 'auroc': 0.9049593, 'binary_precision': 0.71428573, 'binary_recall': 0.09578544, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.16891892}
confusion matrix:
      0   1
0  5987  10
1   236  25
early stop counter: 3
val acc:0.9666347503662109, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9576541781425476 / 0.9733141660690308
after epoch: 9,now: 2024-07-31 07:24:23.785391,epoch time: 0:17:35.199683,used: 2:37:38.688007,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_04_46_44_seed_0_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 2:37:38.688007 at 2024-07-31 07:24:23.785391
persisted model performance metric: 

scalar performance:
{'acc': 0.9576542, 'precision': 0.56254, 'recall': 0.5014988, 'specificity': 0.5014988, 'f1': 0.4929281, 'auroc': 0.88928676, 'binary_precision': 0.16666667, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0074906363}
confusion matrix:
      0  1
0  5992  5
1   260  1
oracle model performance metric: 

scalar performance:
{'acc': 0.97331417, 'precision': 0.88415295, 'recall': 0.74237597, 'specificity': 0.74237597, 'f1': 0.79569566, 'auroc': 0.89484686, 'binary_precision': 0.79012346, 'binary_recall': 0.49042144, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.60520095}
confusion matrix:
      0    1
0  5963   34
1   133  128
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 487579 KiB |   1836 MiB | 531185 GiB | 531185 GiB |
|       from large pool | 397760 KiB |   1766 MiB | 529864 GiB | 529864 GiB |
|       from small pool |  89819 KiB |    124 MiB |   1321 GiB |   1321 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 487579 KiB |   1836 MiB | 531185 GiB | 531185 GiB |
|       from large pool | 397760 KiB |   1766 MiB | 529864 GiB | 529864 GiB |
|       from small pool |  89819 KiB |    124 MiB |   1321 GiB |   1321 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |   1821 MiB | 528396 GiB | 528395 GiB |
|       from large pool | 387840 KiB |   1750 MiB | 527081 GiB | 527080 GiB |
|       from small pool |  88733 KiB |    123 MiB |   1314 GiB |   1314 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1968 MiB |   1968 MiB |   1968 MiB |      0 B   |
|       from large pool |   1842 MiB |   1842 MiB |   1842 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 724836 KiB |    833 MiB | 237675 GiB | 237675 GiB |
|       from large pool | 718400 KiB |    828 MiB | 236230 GiB | 236230 GiB |
|       from small pool |   6436 KiB |     12 MiB |   1445 GiB |   1445 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    8396    |   48315 K  |   48312 K  |
|       from large pool |      87    |     178    |   20568 K  |   20568 K  |
|       from small pool |    3642    |    8308    |   27747 K  |   27743 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    8396    |   48315 K  |   48312 K  |
|       from large pool |      87    |     178    |   20568 K  |   20568 K  |
|       from small pool |    3642    |    8308    |   27747 K  |   27743 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      97    |      97    |      97    |       0    |
|       from large pool |      34    |      34    |      34    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    3614    |   19504 K  |   19504 K  |
|       from large pool |      20    |      25    |    7363 K  |    7363 K  |
|       from small pool |      33    |    3594    |   12141 K  |   12141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1836 MiB | 531185 GiB | 531185 GiB |
|       from large pool |  16640 KiB |   1766 MiB | 529864 GiB | 529864 GiB |
|       from small pool |      0 KiB |    124 MiB |   1321 GiB |   1321 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1836 MiB | 531185 GiB | 531185 GiB |
|       from large pool |  16640 KiB |   1766 MiB | 529864 GiB | 529864 GiB |
|       from small pool |      0 KiB |    124 MiB |   1321 GiB |   1321 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB | 528396 GiB | 528396 GiB |
|       from large pool |  16640 KiB |   1750 MiB | 527081 GiB | 527081 GiB |
|       from small pool |      0 KiB |    123 MiB |   1314 GiB |   1314 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |   1968 MiB |   1968 MiB |    784 MiB |
|       from large pool |   1090 MiB |   1842 MiB |   1842 MiB |    752 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    833 MiB | 237676 GiB | 237676 GiB |
|       from large pool | 134912 KiB |    828 MiB | 236231 GiB | 236231 GiB |
|       from small pool |      0 KiB |     26 MiB |   1445 GiB |   1445 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8396    |   48315 K  |   48315 K  |
|       from large pool |       2    |     178    |   20568 K  |   20568 K  |
|       from small pool |       0    |    8308    |   27747 K  |   27747 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8396    |   48315 K  |   48315 K  |
|       from large pool |       2    |     178    |   20568 K  |   20568 K  |
|       from small pool |       0    |    8308    |   27747 K  |   27747 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      97    |      97    |      27    |
|       from large pool |      23    |      34    |      34    |      11    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3614    |   19506 K  |   19506 K  |
|       from large pool |       4    |      27    |    7363 K  |    7363 K  |
|       from small pool |       0    |    3594    |   12142 K  |   12142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1836 MiB | 531185 GiB | 531185 GiB |
|       from large pool |  16640 KiB |   1766 MiB | 529864 GiB | 529864 GiB |
|       from small pool |      0 KiB |    124 MiB |   1321 GiB |   1321 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1836 MiB | 531185 GiB | 531185 GiB |
|       from large pool |  16640 KiB |   1766 MiB | 529864 GiB | 529864 GiB |
|       from small pool |      0 KiB |    124 MiB |   1321 GiB |   1321 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB | 528396 GiB | 528396 GiB |
|       from large pool |  16640 KiB |   1750 MiB | 527081 GiB | 527081 GiB |
|       from small pool |      0 KiB |    123 MiB |   1314 GiB |   1314 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |   1968 MiB |   1968 MiB |    784 MiB |
|       from large pool |   1090 MiB |   1842 MiB |   1842 MiB |    752 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    833 MiB | 237676 GiB | 237676 GiB |
|       from large pool | 134912 KiB |    828 MiB | 236231 GiB | 236231 GiB |
|       from small pool |      0 KiB |     26 MiB |   1445 GiB |   1445 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8396    |   48315 K  |   48315 K  |
|       from large pool |       2    |     178    |   20568 K  |   20568 K  |
|       from small pool |       0    |    8308    |   27747 K  |   27747 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8396    |   48315 K  |   48315 K  |
|       from large pool |       2    |     178    |   20568 K  |   20568 K  |
|       from small pool |       0    |    8308    |   27747 K  |   27747 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      97    |      97    |      27    |
|       from large pool |      23    |      34    |      34    |      11    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3614    |   19506 K  |   19506 K  |
|       from large pool |       4    |      27    |    7363 K  |    7363 K  |
|       from small pool |       0    |    3594    |   12142 K  |   12142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366

 Experiment start at: 2024-07-31 07:31:26.086972
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99375176, 'precision': 0.9937545, 'recall': 0.9937528, 'specificity': 0.9937528, 'f1': 0.9937517, 'auroc': 0.99966514, 'binary_precision': 0.9951304, 'binary_recall': 0.99236906, 'binary_specificity': 0.9951365, 'binary_f1_score': 0.9937478}
confusion matrix:
       0      1
0  28646    140
1    220  28610
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.7311362, 'recall': 0.71754766, 'specificity': 0.71754766, 'f1': 0.7241104, 'auroc': 0.9072608, 'binary_precision': 0.48259494, 'binary_recall': 0.45319465, 'binary_specificity': 0.9819007, 'binary_f1_score': 0.46743295}
confusion matrix:
       0    1
0  17740  327
1    368  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9737351, 'precision': 0.85608816, 'recall': 0.79136074, 'specificity': 0.79136074, 'f1': 0.8201387, 'auroc': 0.88899195, 'binary_precision': 0.7298578, 'binary_recall': 0.5923077, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.6539278}
confusion matrix:
      0    1
0  5889   57
1   106  154
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 07:49:17.340457,epoch time: 0:17:51.253485,used: 0:17:51.253485,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9963725, 'precision': 0.9963834, 'recall': 0.99637425, 'specificity': 0.99637425, 'f1': 0.9963725, 'auroc': 0.999827, 'binary_precision': 0.9988844, 'binary_recall': 0.9938601, 'binary_specificity': 0.99888843, 'binary_f1_score': 0.99636596}
confusion matrix:
       0      1
0  28756     32
1    177  28651
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7300639, 'recall': 0.6234922, 'specificity': 0.6234922, 'f1': 0.65893316, 'auroc': 0.8937883, 'binary_precision': 0.48732394, 'binary_recall': 0.25705793, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.33657584}
confusion matrix:
       0    1
0  17885  182
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97212374, 'precision': 0.89656603, 'recall': 0.71328235, 'specificity': 0.71328235, 'f1': 0.7749165, 'auroc': 0.8810035, 'binary_precision': 0.81751823, 'binary_recall': 0.43076923, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.56423175}
confusion matrix:
      0    1
0  5921   25
1   148  112
better model found
persisted
after epoch: 2,now: 2024-07-31 08:06:48.997941,epoch time: 0:17:31.657484,used: 0:35:22.910969,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99684113, 'precision': 0.99685204, 'recall': 0.996843, 'specificity': 0.996843, 'f1': 0.99684113, 'auroc': 0.9998604, 'binary_precision': 0.9993724, 'binary_recall': 0.9943113, 'binary_specificity': 0.99937475, 'binary_f1_score': 0.9968354}
confusion matrix:
       0      1
0  28769     18
1    164  28665
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7405628, 'recall': 0.5802483, 'specificity': 0.5802483, 'f1': 0.6164319, 'auroc': 0.8771537, 'binary_precision': 0.51141554, 'binary_recall': 0.16641901, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.25112107}
confusion matrix:
       0    1
0  17960  107
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8597534, 'recall': 0.54740417, 'specificity': 0.54740417, 'f1': 0.5752986, 'auroc': 0.8633551, 'binary_precision': 0.75757575, 'binary_recall': 0.09615385, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5938   8
1   235  25
better model found
persisted
after epoch: 3,now: 2024-07-31 08:24:27.513311,epoch time: 0:17:38.515370,used: 0:53:01.426339,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99671966, 'precision': 0.9967361, 'recall': 0.996722, 'specificity': 0.996722, 'f1': 0.99671966, 'auroc': 0.999878, 'binary_precision': 0.9997906, 'binary_recall': 0.99365246, 'binary_specificity': 0.99979156, 'binary_f1_score': 0.9967121}
confusion matrix:
       0      1
0  28780      6
1    183  28647
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.75005937, 'recall': 0.51653415, 'specificity': 0.51653415, 'f1': 0.52301073, 'auroc': 0.9159792, 'binary_precision': 0.53488374, 'binary_recall': 0.034175333, 'binary_specificity': 0.998893, 'binary_f1_score': 0.064245805}
confusion matrix:
       0   1
0  18047  20
1    650  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.5700859, 'recall': 0.50308937, 'specificity': 0.50308937, 'f1': 0.4963843, 'auroc': 0.876246, 'binary_precision': 0.18181819, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.014760148}
confusion matrix:
      0  1
0  5937  9
1   258  2
early stop counter: 1
val acc:0.9642475843429565, best validation acc: 0.9643543362617493, corresponding to test acc:                         0.9608443379402161 / 0.9737350940704346
after epoch: 4,now: 2024-07-31 08:42:00.738879,epoch time: 0:17:33.225568,used: 1:10:34.651907,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9982644, 'precision': 0.998266, 'recall': 0.9982652, 'specificity': 0.9982652, 'f1': 0.99826443, 'auroc': 0.9999536, 'binary_precision': 0.9993742, 'binary_recall': 0.99715567, 'binary_specificity': 0.99937475, 'binary_f1_score': 0.9982637}
confusion matrix:
       0      1
0  28769     18
1     82  28747
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7772362, 'recall': 0.5824537, 'specificity': 0.5824537, 'f1': 0.6225961, 'auroc': 0.89203346, 'binary_precision': 0.5846154, 'binary_recall': 0.16939078, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.2626728}
confusion matrix:
       0    1
0  17986   81
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8890975, 'recall': 0.6142074, 'specificity': 0.6142074, 'f1': 0.6707816, 'auroc': 0.8797404, 'binary_precision': 0.8108108, 'binary_recall': 0.23076923, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.35928142}
confusion matrix:
      0   1
0  5932  14
1   200  60
better model found
persisted
after epoch: 5,now: 2024-07-31 08:59:31.591521,epoch time: 0:17:30.852642,used: 1:28:05.504549,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99849, 'precision': 0.99849284, 'recall': 0.9984909, 'specificity': 0.9984909, 'f1': 0.99849004, 'auroc': 0.9999763, 'binary_precision': 0.9998609, 'binary_recall': 0.99712086, 'binary_specificity': 0.99986106, 'binary_f1_score': 0.998489}
confusion matrix:
       0      1
0  28784      4
1     83  28745
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7965694, 'recall': 0.55810696, 'specificity': 0.55810696, 'f1': 0.5911372, 'auroc': 0.90874386, 'binary_precision': 0.625, 'binary_recall': 0.11887073, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.1997503}
confusion matrix:
       0   1
0  18019  48
1    593  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8988037, 'recall': 0.5762504, 'specificity': 0.5762504, 'f1': 0.62045175, 'auroc': 0.89685714, 'binary_precision': 0.8333333, 'binary_recall': 0.15384616, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.2597403}
confusion matrix:
      0   1
0  5938   8
1   220  40
early stop counter: 1
val acc:0.96579509973526, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9655172228813171 / 0.9737350940704346
after epoch: 6,now: 2024-07-31 09:17:04.505833,epoch time: 0:17:32.914312,used: 1:45:38.418861,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99847263, 'precision': 0.99847454, 'recall': 0.9984735, 'specificity': 0.9984735, 'f1': 0.9984727, 'auroc': 0.99995524, 'binary_precision': 0.9996523, 'binary_recall': 0.9972945, 'binary_specificity': 0.9996526, 'binary_f1_score': 0.99847203}
confusion matrix:
       0      1
0  28776     10
1     78  28752
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7864177, 'recall': 0.55001765, 'specificity': 0.55001765, 'f1': 0.5788311, 'auroc': 0.8944142, 'binary_precision': 0.6052632, 'binary_recall': 0.102526, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.17534941}
confusion matrix:
       0   1
0  18022  45
1    604  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.71311843, 'recall': 0.5474773, 'specificity': 0.5474773, 'f1': 0.5713658, 'auroc': 0.8737705, 'binary_precision': 0.4642857, 'binary_recall': 0.1, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.16455697}
confusion matrix:
      0   1
0  5916  30
1   234  26
early stop counter: 2
val acc:0.9653682112693787, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9655172228813171 / 0.9737350940704346
after epoch: 7,now: 2024-07-31 09:34:50.756757,epoch time: 0:17:46.250924,used: 2:03:24.669785,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99871564, 'precision': 0.9987156, 'recall': 0.99871576, 'specificity': 0.99871576, 'f1': 0.99871564, 'auroc': 0.99998057, 'binary_precision': 0.9989242, 'binary_recall': 0.9985084, 'binary_specificity': 0.9989232, 'binary_f1_score': 0.99871624}
confusion matrix:
       0      1
0  28757     31
1     43  28785
---- Validation: 
scalar performance:
{'acc': 0.9688367, 'precision': 0.8237034, 'recall': 0.625489, 'specificity': 0.625489, 'f1': 0.6773562, 'auroc': 0.9472896, 'binary_precision': 0.6745098, 'binary_recall': 0.25557205, 'binary_specificity': 0.995406, 'binary_f1_score': 0.37068966}
confusion matrix:
       0    1
0  17984   83
1    501  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.8880783, 'recall': 0.67883515, 'specificity': 0.67883515, 'f1': 0.74148476, 'auroc': 0.923394, 'binary_precision': 0.8034188, 'binary_recall': 0.36153847, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.49867377}
confusion matrix:
      0   1
0  5923  23
1   166  94
better model found
persisted
after epoch: 8,now: 2024-07-31 09:52:52.568133,epoch time: 0:18:01.811376,used: 2:21:26.481161,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.999028, 'precision': 0.9990288, 'recall': 0.9990287, 'specificity': 0.9990287, 'f1': 0.999028, 'auroc': 0.9999659, 'binary_precision': 0.999861, 'binary_recall': 0.99819624, 'binary_specificity': 0.99986106, 'binary_f1_score': 0.9990279}
confusion matrix:
       0      1
0  28783      4
1     52  28777
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.8396921, 'recall': 0.58047825, 'specificity': 0.58047825, 'f1': 0.62455606, 'auroc': 0.9310663, 'binary_precision': 0.7096774, 'binary_recall': 0.16344725, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.2657005}
confusion matrix:
       0    1
0  18022   45
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.84822494, 'recall': 0.6550855, 'specificity': 0.6550855, 'f1': 0.711159, 'auroc': 0.8986353, 'binary_precision': 0.7256637, 'binary_recall': 0.31538463, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.4396783}
confusion matrix:
      0   1
0  5915  31
1   178  82
early stop counter: 1
val acc:0.9675560593605042, best validation acc: 0.9688367247581482, corresponding to test acc:                         0.9695456027984619 / 0.9737350940704346
after epoch: 9,now: 2024-07-31 10:10:33.210374,epoch time: 0:17:40.642241,used: 2:39:07.123402,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99913216, 'precision': 0.99913275, 'recall': 0.99913275, 'specificity': 0.99913275, 'f1': 0.99913216, 'auroc': 0.9999782, 'binary_precision': 0.99989575, 'binary_recall': 0.9983697, 'binary_specificity': 0.9998958, 'binary_f1_score': 0.9991321}
confusion matrix:
       0      1
0  28784      3
1     47  28782
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.86779946, 'recall': 0.5462795, 'specificity': 0.5462795, 'f1': 0.57488006, 'auroc': 0.90698695, 'binary_precision': 0.76829267, 'binary_recall': 0.0936107, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.1668874}
confusion matrix:
       0   1
0  18048  19
1    610  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.88985217, 'recall': 0.5837745, 'specificity': 0.5837745, 'f1': 0.630787, 'auroc': 0.90874344, 'binary_precision': 0.8148148, 'binary_recall': 0.16923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.28025478}
confusion matrix:
      0   1
0  5936  10
1   216  44
early stop counter: 2
val acc:0.966435432434082, best validation acc: 0.9688367247581482, corresponding to test acc:                         0.9695456027984619 / 0.9737350940704346
after epoch: 10,now: 2024-07-31 10:28:21.386863,epoch time: 0:17:48.176489,used: 2:56:55.299891,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99899334, 'precision': 0.99899423, 'recall': 0.998994, 'specificity': 0.998994, 'f1': 0.9989933, 'auroc': 0.99998915, 'binary_precision': 0.999861, 'binary_recall': 0.99812686, 'binary_specificity': 0.99986106, 'binary_f1_score': 0.99899316}
confusion matrix:
       0      1
0  28783      4
1     54  28775
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7947231, 'recall': 0.53122693, 'specificity': 0.53122693, 'f1': 0.5490234, 'auroc': 0.9170253, 'binary_precision': 0.6231884, 'binary_recall': 0.06389301, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.11590295}
confusion matrix:
       0   1
0  18041  26
1    630  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.8002621, 'recall': 0.5300124, 'specificity': 0.5300124, 'f1': 0.5457091, 'auroc': 0.8965654, 'binary_precision': 0.64, 'binary_recall': 0.06153846, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.112280704}
confusion matrix:
      0   1
0  5937   9
1   244  16
early stop counter: 3
val acc:0.9649946689605713, best validation acc: 0.9688367247581482, corresponding to test acc:                         0.9695456027984619 / 0.9737350940704346
after epoch: 11,now: 2024-07-31 10:46:05.729378,epoch time: 0:17:44.342515,used: 3:14:39.642406,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_07_31_25_seed_1_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 3:14:39.642406 at 2024-07-31 10:46:05.729378
persisted model performance metric: 

scalar performance:
{'acc': 0.9695456, 'precision': 0.8880783, 'recall': 0.67883515, 'specificity': 0.67883515, 'f1': 0.74148476, 'auroc': 0.923394, 'binary_precision': 0.8034188, 'binary_recall': 0.36153847, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.49867377}
confusion matrix:
      0   1
0  5923  23
1   166  94
oracle model performance metric: 

scalar performance:
{'acc': 0.9737351, 'precision': 0.85608816, 'recall': 0.79136074, 'specificity': 0.79136074, 'f1': 0.8201387, 'auroc': 0.88899195, 'binary_precision': 0.7298578, 'binary_recall': 0.5923077, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.6539278}
confusion matrix:
      0    1
0  5889   57
1   106  154
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 486735 KiB |   1836 MiB |   1152 TiB |   1152 TiB |
|       from large pool | 396928 KiB |   1766 MiB |   1149 TiB |   1149 TiB |
|       from small pool |  89807 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 486735 KiB |   1836 MiB |   1152 TiB |   1152 TiB |
|       from large pool | 396928 KiB |   1766 MiB |   1149 TiB |   1149 TiB |
|       from small pool |  89807 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |   1821 MiB |   1147 TiB |   1147 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   1144 TiB |   1144 TiB |
|       from small pool |  88730 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2014 MiB |   2014 MiB |   2798 MiB |    784 MiB |
|       from large pool |   1890 MiB |   1890 MiB |   2642 MiB |    752 MiB |
|       from small pool |    124 MiB |    126 MiB |    156 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    980 MiB |    985 MiB | 570885 GiB | 570884 GiB |
|       from large pool |    974 MiB |    976 MiB | 567687 GiB | 567686 GiB |
|       from small pool |      6 MiB |     26 MiB |   3197 GiB |   3197 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    8428    |  107462 K  |  107458 K  |
|       from large pool |      87    |     178    |   45755 K  |   45755 K  |
|       from small pool |    3618    |    8340    |   61707 K  |   61703 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    8428    |  107462 K  |  107458 K  |
|       from large pool |      87    |     178    |   45755 K  |   45755 K  |
|       from small pool |    3618    |    8340    |   61707 K  |   61703 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |      97    |     118    |      27    |
|       from large pool |      29    |      34    |      40    |      11    |
|       from small pool |      62    |      63    |      78    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    3631    |   43412 K  |   43412 K  |
|       from large pool |      21    |      27    |   16271 K  |   16270 K  |
|       from small pool |      30    |    3610    |   27141 K  |   27141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1836 MiB |   1152 TiB |   1152 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1149 TiB |   1149 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1836 MiB |   1152 TiB |   1152 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1149 TiB |   1149 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1147 TiB |   1147 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1144 TiB |   1144 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1456 MiB |   2014 MiB |   2798 MiB |   1342 MiB |
|       from large pool |   1362 MiB |   1890 MiB |   2642 MiB |   1280 MiB |
|       from small pool |     94 MiB |    126 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1036 MiB | 570885 GiB | 570885 GiB |
|       from large pool | 134912 KiB |   1016 MiB | 567688 GiB | 567687 GiB |
|       from small pool |      0 KiB |     26 MiB |   3197 GiB |   3197 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8428    |  107462 K  |  107462 K  |
|       from large pool |       2    |     178    |   45755 K  |   45755 K  |
|       from small pool |       0    |    8340    |   61707 K  |   61707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8428    |  107462 K  |  107462 K  |
|       from large pool |       2    |     178    |   45755 K  |   45755 K  |
|       from small pool |       0    |    8340    |   61707 K  |   61707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      97    |     118    |      46    |
|       from large pool |      25    |      34    |      40    |      15    |
|       from small pool |      47    |      63    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   43413 K  |   43413 K  |
|       from large pool |       4    |      27    |   16271 K  |   16271 K  |
|       from small pool |       0    |    3610    |   27142 K  |   27142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1836 MiB |   1152 TiB |   1152 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1149 TiB |   1149 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1836 MiB |   1152 TiB |   1152 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1149 TiB |   1149 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1147 TiB |   1147 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1144 TiB |   1144 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1456 MiB |   2014 MiB |   2798 MiB |   1342 MiB |
|       from large pool |   1362 MiB |   1890 MiB |   2642 MiB |   1280 MiB |
|       from small pool |     94 MiB |    126 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1036 MiB | 570885 GiB | 570885 GiB |
|       from large pool | 134912 KiB |   1016 MiB | 567688 GiB | 567687 GiB |
|       from small pool |      0 KiB |     26 MiB |   3197 GiB |   3197 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8428    |  107462 K  |  107462 K  |
|       from large pool |       2    |     178    |   45755 K  |   45755 K  |
|       from small pool |       0    |    8340    |   61707 K  |   61707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8428    |  107462 K  |  107462 K  |
|       from large pool |       2    |     178    |   45755 K  |   45755 K  |
|       from small pool |       0    |    8340    |   61707 K  |   61707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      97    |     118    |      46    |
|       from large pool |      25    |      34    |      40    |      15    |
|       from small pool |      47    |      63    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3631    |   43413 K  |   43413 K  |
|       from large pool |       4    |      27    |   16271 K  |   16271 K  |
|       from small pool |       0    |    3610    |   27142 K  |   27142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_53_23_seed_2_23775366

 Experiment start at: 2024-07-31 10:53:24.025275
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9933967, 'precision': 0.99343747, 'recall': 0.9933973, 'specificity': 0.9933973, 'f1': 0.9933965, 'auroc': 0.99967563, 'binary_precision': 0.9979577, 'binary_recall': 0.98881876, 'binary_specificity': 0.9979758, 'binary_f1_score': 0.9933672}
confusion matrix:
       0      1
0  29089     59
1    326  28830
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9690513, 'precision': 0.75317025, 'recall': 0.65717226, 'specificity': 0.65717226, 'f1': 0.69288135, 'auroc': 0.9113471, 'binary_precision': 0.52845526, 'binary_recall': 0.32392028, 'binary_specificity': 0.9904243, 'binary_f1_score': 0.4016478}
confusion matrix:
       0    1
0  17997  174
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97435486, 'precision': 0.88773286, 'recall': 0.7249382, 'specificity': 0.7249382, 'f1': 0.782861, 'auroc': 0.88267773, 'binary_precision': 0.79710144, 'binary_recall': 0.45454547, 'binary_specificity': 0.995331, 'binary_f1_score': 0.57894737}
confusion matrix:
      0    1
0  5969   28
1   132  110
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 11:13:26.590798,epoch time: 0:20:02.565523,used: 0:20:02.565523,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_53_23_seed_2_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99668974, 'precision': 0.9966942, 'recall': 0.9966899, 'specificity': 0.9966899, 'f1': 0.99668974, 'auroc': 0.99986887, 'binary_precision': 0.998211, 'binary_recall': 0.9951639, 'binary_specificity': 0.998216, 'binary_f1_score': 0.99668515}
confusion matrix:
       0      1
0  29096     52
1    141  29015
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.7092094, 'recall': 0.636083, 'specificity': 0.636083, 'f1': 0.6640527, 'auroc': 0.88632727, 'binary_precision': 0.44186047, 'binary_recall': 0.28405315, 'binary_specificity': 0.9881129, 'binary_f1_score': 0.34580383}
confusion matrix:
       0    1
0  17955  216
1    431  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.80896413, 'recall': 0.73218393, 'specificity': 0.73218393, 'f1': 0.764549, 'auroc': 0.8810531, 'binary_precision': 0.6388889, 'binary_recall': 0.4752066, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.5450237}
confusion matrix:
      0    1
0  5932   65
1   127  115
early stop counter: 1
val acc:0.965535581111908, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9743548631668091 / 0.9743548631668091
after epoch: 2,now: 2024-07-31 11:31:51.594893,epoch time: 0:18:25.004095,used: 0:38:27.569618,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_53_23_seed_2_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99765027, 'precision': 0.9976555, 'recall': 0.9976505, 'specificity': 0.9976505, 'f1': 0.99765027, 'auroc': 0.99990344, 'binary_precision': 0.99931175, 'binary_recall': 0.9959871, 'binary_specificity': 0.99931383, 'binary_f1_score': 0.99764663}
confusion matrix:
       0      1
0  29128     20
1    117  29039
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7474568, 'recall': 0.61754775, 'specificity': 0.61754775, 'f1': 0.6572855, 'auroc': 0.9072961, 'binary_precision': 0.519573, 'binary_recall': 0.24252492, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.33069083}
confusion matrix:
       0    1
0  18036  135
1    456  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.7926611, 'recall': 0.74944496, 'specificity': 0.74944496, 'f1': 0.76913464, 'auroc': 0.88701344, 'binary_precision': 0.60487807, 'binary_recall': 0.5123967, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.55480987}
confusion matrix:
      0    1
0  5916   81
1   118  124
early stop counter: 2
val acc:0.9685186147689819, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9743548631668091 / 0.9743548631668091
after epoch: 3,now: 2024-07-31 11:49:38.082316,epoch time: 0:17:46.487423,used: 0:56:14.057041,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_53_23_seed_2_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9978561, 'precision': 0.9978604, 'recall': 0.9978564, 'specificity': 0.9978564, 'f1': 0.997856, 'auroc': 0.99992216, 'binary_precision': 0.99938077, 'binary_recall': 0.9963303, 'binary_specificity': 0.99938244, 'binary_f1_score': 0.9978532}
confusion matrix:
       0      1
0  29128     18
1    107  29051
---- Validation: 
scalar performance:
{'acc': 0.965216, 'precision': 0.6681994, 'recall': 0.554007, 'specificity': 0.554007, 'f1': 0.5783482, 'auroc': 0.87699735, 'binary_precision': 0.36507937, 'binary_recall': 0.114617944, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.1744627}
confusion matrix:
       0    1
0  18051  120
1    533   69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9724315, 'precision': 0.87927294, 'recall': 0.6981621, 'specificity': 0.6981621, 'f1': 0.75792694, 'auroc': 0.88012016, 'binary_precision': 0.7822581, 'binary_recall': 0.40082645, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.5300547}
confusion matrix:
      0   1
0  5970  27
1   145  97
early stop counter: 3
val acc:0.9652159810066223, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9743548631668091 / 0.9743548631668091
after epoch: 4,now: 2024-07-31 12:07:43.953212,epoch time: 0:18:05.870896,used: 1:14:19.927937,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_10_53_23_seed_2_23775366
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 1:14:19.927937 at 2024-07-31 12:07:43.953212
persisted model performance metric: 

scalar performance:
{'acc': 0.97435486, 'precision': 0.88773286, 'recall': 0.7249382, 'specificity': 0.7249382, 'f1': 0.782861, 'auroc': 0.88267773, 'binary_precision': 0.79710144, 'binary_recall': 0.45454547, 'binary_specificity': 0.995331, 'binary_f1_score': 0.57894737}
confusion matrix:
      0    1
0  5969   28
1   132  110
oracle model performance metric: 

scalar performance:
{'acc': 0.97435486, 'precision': 0.88773286, 'recall': 0.7249382, 'specificity': 0.7249382, 'f1': 0.782861, 'auroc': 0.88267773, 'binary_precision': 0.79710144, 'binary_recall': 0.45454547, 'binary_specificity': 0.995331, 'binary_f1_score': 0.57894737}
confusion matrix:
      0    1
0  5969   28
1   132  110
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-31_02-47-01/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 484053 KiB |   1836 MiB |   1388 TiB |   1388 TiB |
|       from large pool | 394240 KiB |   1766 MiB |   1385 TiB |   1385 TiB |
|       from small pool |  89813 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 484053 KiB |   1836 MiB |   1388 TiB |   1388 TiB |
|       from large pool | 394240 KiB |   1766 MiB |   1385 TiB |   1385 TiB |
|       from small pool |  89813 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |   1821 MiB |   1382 TiB |   1382 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   1379 TiB |   1379 TiB |
|       from small pool |  88732 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2030 MiB |   2030 MiB |   3372 MiB |   1342 MiB |
|       from large pool |   1906 MiB |   1906 MiB |   3186 MiB |   1280 MiB |
|       from small pool |    124 MiB |    126 MiB |    186 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    973 MiB |   1036 MiB | 705887 GiB | 705886 GiB |
|       from large pool |    967 MiB |   1016 MiB | 702034 GiB | 702033 GiB |
|       from small pool |      6 MiB |     26 MiB |   3853 GiB |   3853 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    8514    |  129465 K  |  129461 K  |
|       from large pool |      87    |     178    |   55126 K  |   55126 K  |
|       from small pool |    3630    |    8426    |   74338 K  |   74335 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    8514    |  129465 K  |  129461 K  |
|       from large pool |      87    |     178    |   55126 K  |   55126 K  |
|       from small pool |    3630    |    8426    |   74338 K  |   74335 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |      97    |     137    |      46    |
|       from large pool |      29    |      34    |      44    |      15    |
|       from small pool |      62    |      63    |      93    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3672    |   52563 K  |   52563 K  |
|       from large pool |      20    |      27    |   20055 K  |   20055 K  |
|       from small pool |      32    |    3652    |   32507 K  |   32507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1836 MiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1385 TiB |   1385 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1836 MiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1385 TiB |   1385 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1382 TiB |   1382 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1379 TiB |   1379 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1446 MiB |   2030 MiB |   3372 MiB |   1926 MiB |
|       from large pool |   1352 MiB |   1906 MiB |   3186 MiB |   1834 MiB |
|       from small pool |     94 MiB |    126 MiB |    186 MiB |     92 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1036 MiB | 705888 GiB | 705888 GiB |
|       from large pool | 134912 KiB |   1016 MiB | 702034 GiB | 702034 GiB |
|       from small pool |      0 KiB |     29 MiB |   3853 GiB |   3853 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8514    |  129465 K  |  129465 K  |
|       from large pool |       2    |     178    |   55126 K  |   55126 K  |
|       from small pool |       0    |    8426    |   74338 K  |   74338 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8514    |  129465 K  |  129465 K  |
|       from large pool |       2    |     178    |   55126 K  |   55126 K  |
|       from small pool |       0    |    8426    |   74338 K  |   74338 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      97    |     137    |      66    |
|       from large pool |      24    |      34    |      44    |      20    |
|       from small pool |      47    |      63    |      93    |      46    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3672    |   52564 K  |   52564 K  |
|       from large pool |       4    |      27    |   20055 K  |   20055 K  |
|       from small pool |       0    |    3652    |   32508 K  |   32508 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 31 12:08:34 2024]
Finished job 0.
1 of 1 steps (100%) done
