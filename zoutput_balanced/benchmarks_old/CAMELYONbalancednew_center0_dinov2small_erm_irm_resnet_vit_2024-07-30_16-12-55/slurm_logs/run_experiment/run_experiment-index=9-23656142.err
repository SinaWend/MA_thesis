Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 30 16:26:08 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142

 Experiment start at: 2024-07-30 16:36:54.366941
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.9563758969306946
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9904463, 'precision': 0.9904564, 'recall': 0.99044466, 'specificity': 0.99044466, 'f1': 0.9904462, 'auroc': 0.99953175, 'binary_precision': 0.9884116, 'binary_recall': 0.99254405, 'binary_specificity': 0.9883453, 'binary_f1_score': 0.99047357}
confusion matrix:
       0      1
0  28324    334
1    214  28488
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9572691, 'precision': 0.6777077, 'recall': 0.6801056, 'specificity': 0.6801056, 'f1': 0.67889744, 'auroc': 0.9086691, 'binary_precision': 0.37730062, 'binary_recall': 0.38258165, 'binary_specificity': 0.9776296, 'binary_f1_score': 0.37992278}
confusion matrix:
       0    1
0  17743  406
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9336849, 'precision': 0.6691647, 'recall': 0.82247734, 'specificity': 0.82247734, 'f1': 0.71663284, 'auroc': 0.88533473, 'binary_precision': 0.35192308, 'binary_recall': 0.7011494, 'binary_specificity': 0.9438052, 'binary_f1_score': 0.46862996}
confusion matrix:
      0    1
0  5660  337
1    78  183
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-30 17:03:01.522113,epoch time: 0:26:07.155172,used: 0:26:07.155172,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99375874, 'precision': 0.9937781, 'recall': 0.99376154, 'specificity': 0.99376154, 'f1': 0.9937587, 'auroc': 0.9997556, 'binary_precision': 0.99708897, 'binary_recall': 0.99041945, 'binary_specificity': 0.9971036, 'binary_f1_score': 0.993743}
confusion matrix:
       0      1
0  28573     83
1    275  28429
---- Validation: 
scalar performance:
{'acc': 0.9613133, 'precision': 0.6934678, 'recall': 0.6439466, 'specificity': 0.6439466, 'f1': 0.6646068, 'auroc': 0.91186494, 'binary_precision': 0.4113924, 'binary_recall': 0.30326593, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.3491495}
confusion matrix:
       0    1
0  17870  279
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95142215, 'precision': 0.70475644, 'recall': 0.74194765, 'specificity': 0.74194765, 'f1': 0.72153974, 'auroc': 0.8784988, 'binary_precision': 0.43086818, 'binary_recall': 0.51341, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.4685315}
confusion matrix:
      0    1
0  5820  177
1   127  134
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-30 17:27:24.264257,epoch time: 0:24:22.742144,used: 0:50:29.897316,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9905335, 'precision': 0.9906983, 'recall': 0.990541, 'specificity': 0.990541, 'f1': 0.9905328, 'auroc': 0.9998194, 'binary_precision': 0.9998935, 'binary_recall': 0.9811866, 'binary_specificity': 0.99989533, 'binary_f1_score': 0.9904518}
confusion matrix:
       0      1
0  28654      3
1    540  28163
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.802668, 'recall': 0.5479973, 'specificity': 0.5479973, 'f1': 0.57654566, 'auroc': 0.9157152, 'binary_precision': 0.6363636, 'binary_recall': 0.09797823, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.16981132}
confusion matrix:
       0   1
0  18113  36
1    580  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9101227, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-30 17:50:50.216372,epoch time: 0:23:25.952115,used: 1:13:55.849431,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99663526, 'precision': 0.9966467, 'recall': 0.9966373, 'specificity': 0.9966373, 'f1': 0.99663526, 'auroc': 0.999895, 'binary_precision': 0.9992295, 'binary_recall': 0.9940422, 'binary_specificity': 0.99923235, 'binary_f1_score': 0.9966291}
confusion matrix:
       0      1
0  28636     22
1    171  28531
---- Validation: 
scalar performance:
{'acc': 0.9707322, 'precision': 0.79618394, 'recall': 0.690826, 'specificity': 0.690826, 'f1': 0.7310655, 'auroc': 0.92221296, 'binary_precision': 0.6136919, 'binary_recall': 0.3903577, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.4771863}
confusion matrix:
       0    1
0  17991  158
1    392  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.91718, 'recall': 0.5133266, 'specificity': 0.5133266, 'f1': 0.5156116, 'auroc': 0.9398566, 'binary_precision': 0.875, 'binary_recall': 0.026819924, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.052044608}
confusion matrix:
      0  1
0  5996  1
1   254  7
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-30 18:16:13.080777,epoch time: 0:25:22.864405,used: 1:39:18.713836,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9960948, 'precision': 0.99610937, 'recall': 0.9960974, 'specificity': 0.9960974, 'f1': 0.9960948, 'auroc': 0.99985063, 'binary_precision': 0.9990188, 'binary_recall': 0.99317193, 'binary_specificity': 0.99902284, 'binary_f1_score': 0.9960868}
confusion matrix:
       0      1
0  28627     28
1    196  28509
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.7829071, 'recall': 0.6630526, 'specificity': 0.6630526, 'f1': 0.7053923, 'auroc': 0.9493286, 'binary_precision': 0.5890411, 'binary_recall': 0.33437014, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.42658728}
confusion matrix:
       0    1
0  17999  150
1    428  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.66707385, 'recall': 0.5106605, 'specificity': 0.5106605, 'f1': 0.5108346, 'auroc': 0.94289047, 'binary_precision': 0.375, 'binary_recall': 0.022988506, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0433213}
confusion matrix:
      0   1
0  5987  10
1   255   6
early stop counter: 1
val acc:0.9692422151565552, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9592521786689758
after epoch: 5,now: 2024-07-30 18:42:20.209865,epoch time: 0:26:07.129088,used: 2:05:25.842924,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9972455, 'precision': 0.99725175, 'recall': 0.9972471, 'specificity': 0.9972471, 'f1': 0.99724543, 'auroc': 0.99988925, 'binary_precision': 0.99923044, 'binary_recall': 0.99526185, 'binary_specificity': 0.9992323, 'binary_f1_score': 0.9972422}
confusion matrix:
       0      1
0  28635     22
1    136  28567
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.75883275, 'recall': 0.6109193, 'specificity': 0.6109193, 'f1': 0.6525678, 'auroc': 0.91850203, 'binary_precision': 0.54444444, 'binary_recall': 0.22861587, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.32201535}
confusion matrix:
       0    1
0  18026  123
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7103529, 'recall': 0.51091063, 'specificity': 0.51091063, 'f1': 0.511197, 'auroc': 0.9289768, 'binary_precision': 0.46153846, 'binary_recall': 0.022988506, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.04379562}
confusion matrix:
      0  1
0  5990  7
1   255  6
early stop counter: 2
val acc:0.9670604467391968, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9592521786689758
after epoch: 6,now: 2024-07-30 19:11:56.949622,epoch time: 0:29:36.739757,used: 2:35:02.582681,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9968445, 'precision': 0.9968474, 'recall': 0.9968456, 'specificity': 0.9968456, 'f1': 0.99684453, 'auroc': 0.9998764, 'binary_precision': 0.99825305, 'binary_recall': 0.99543583, 'binary_specificity': 0.9982553, 'binary_f1_score': 0.9968425}
confusion matrix:
       0      1
0  28608     50
1    131  28571
---- Validation: 
scalar performance:
{'acc': 0.96439976, 'precision': 0.7257452, 'recall': 0.6755467, 'specificity': 0.6755467, 'f1': 0.69714314, 'auroc': 0.92962134, 'binary_precision': 0.47379032, 'binary_recall': 0.36547434, 'binary_specificity': 0.98561907, 'binary_f1_score': 0.41264266}
confusion matrix:
       0    1
0  17888  261
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.6157137, 'recall': 0.5050801, 'specificity': 0.5050801, 'f1': 0.5001669, 'auroc': 0.9474187, 'binary_precision': 0.27272728, 'binary_recall': 0.011494253, 'binary_specificity': 0.998666, 'binary_f1_score': 0.022058824}
confusion matrix:
      0  1
0  5989  8
1   258  3
early stop counter: 3
val acc:0.9643997550010681, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9592521786689758
after epoch: 7,now: 2024-07-30 19:39:05.831035,epoch time: 0:27:08.881413,used: 3:02:11.464094,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9950837, 'precision': 0.9951072, 'recall': 0.9950814, 'specificity': 0.9950814, 'f1': 0.99508363, 'auroc': 0.99990314, 'binary_precision': 0.99186516, 'binary_recall': 0.99836236, 'binary_specificity': 0.9918004, 'binary_f1_score': 0.99510324}
confusion matrix:
       0      1
0  28425    235
1     47  28653
---- Validation: 
scalar performance:
{'acc': 0.9447105, 'precision': 0.6616331, 'recall': 0.79511285, 'specificity': 0.79511285, 'f1': 0.70540607, 'auroc': 0.938686, 'binary_precision': 0.33663365, 'binary_recall': 0.63452566, 'binary_specificity': 0.95570004, 'binary_f1_score': 0.43989217}
confusion matrix:
       0    1
0  17345  804
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7596798, 'recall': 0.7453679, 'specificity': 0.7453679, 'f1': 0.7522932, 'auroc': 0.94043505, 'binary_precision': 0.5406504, 'binary_recall': 0.5095785, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.5246548}
confusion matrix:
      0    1
0  5884  113
1   128  133
new oracle model saved
early stop counter: 4
val acc:0.9447104930877686, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 8,now: 2024-07-30 20:06:14.904066,epoch time: 0:27:09.073031,used: 3:29:20.537125,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99766386, 'precision': 0.997669, 'recall': 0.9976653, 'specificity': 0.9976653, 'f1': 0.99766386, 'auroc': 0.99990225, 'binary_precision': 0.9994755, 'binary_recall': 0.9958541, 'binary_specificity': 0.99947655, 'binary_f1_score': 0.9976614}
confusion matrix:
       0      1
0  28642     15
1    119  28584
---- Validation: 
scalar performance:
{'acc': 0.9707322, 'precision': 0.806266, 'recall': 0.66607416, 'specificity': 0.66607416, 'f1': 0.71358126, 'auroc': 0.96111846, 'binary_precision': 0.6355685, 'binary_recall': 0.33903578, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.44219068}
confusion matrix:
       0    1
0  18024  125
1    425  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.66686, 'recall': 0.50533026, 'specificity': 0.50533026, 'f1': 0.5004151, 'auroc': 0.9294692, 'binary_precision': 0.375, 'binary_recall': 0.011494253, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.022304833}
confusion matrix:
      0  1
0  5992  5
1   258  3
early stop counter: 5
val acc:0.9707322120666504, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 9,now: 2024-07-30 20:29:50.818482,epoch time: 0:23:35.914416,used: 3:52:56.451541,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99843097, 'precision': 0.99843097, 'recall': 0.9984313, 'specificity': 0.9984313, 'f1': 0.99843097, 'auroc': 0.9999382, 'binary_precision': 0.99884933, 'binary_recall': 0.99801415, 'binary_specificity': 0.99884844, 'binary_f1_score': 0.99843156}
confusion matrix:
       0      1
0  28624     33
1     57  28646
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.7718124, 'recall': 0.79700327, 'specificity': 0.79700327, 'f1': 0.7837883, 'auroc': 0.961427, 'binary_precision': 0.55744684, 'binary_recall': 0.61119753, 'binary_specificity': 0.98280895, 'binary_f1_score': 0.5830861}
confusion matrix:
       0    1
0  17837  312
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.70714766, 'recall': 0.5181566, 'specificity': 0.5181566, 'f1': 0.5245861, 'auroc': 0.9292686, 'binary_precision': 0.45454547, 'binary_recall': 0.038314175, 'binary_specificity': 0.997999, 'binary_f1_score': 0.07067138}
confusion matrix:
      0   1
0  5985  12
1   251  10
early stop counter: 6
val acc:0.9700936675071716, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 10,now: 2024-07-30 20:55:55.390515,epoch time: 0:26:04.572033,used: 4:19:01.023574,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99755925, 'precision': 0.9975605, 'recall': 0.99755883, 'specificity': 0.99755883, 'f1': 0.99755925, 'auroc': 0.9999721, 'binary_precision': 0.99693775, 'binary_recall': 0.9981882, 'binary_specificity': 0.9969294, 'binary_f1_score': 0.9975625}
confusion matrix:
       0      1
0  28571     88
1     52  28649
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.73319167, 'recall': 0.67671, 'specificity': 0.67671, 'f1': 0.70062226, 'auroc': 0.93181473, 'binary_precision': 0.48861283, 'binary_recall': 0.36702955, 'binary_specificity': 0.9863904, 'binary_f1_score': 0.41918293}
confusion matrix:
       0    1
0  17902  247
1    407  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6459533, 'recall': 0.50349796, 'specificity': 0.50349796, 'f1': 0.4967551, 'auroc': 0.9394864, 'binary_precision': 0.33333334, 'binary_recall': 0.007662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.014981273}
confusion matrix:
      0  1
0  5993  4
1   259  2
early stop counter: 7
val acc:0.9651979804039001, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 11,now: 2024-07-30 21:20:32.002009,epoch time: 0:24:36.611494,used: 4:43:37.635068,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9945955, 'precision': 0.9946326, 'recall': 0.9945925, 'specificity': 0.9945925, 'f1': 0.9945954, 'auroc': 0.9999521, 'binary_precision': 0.9905318, 'binary_recall': 0.9987457, 'binary_specificity': 0.9904393, 'binary_f1_score': 0.99462175}
confusion matrix:
       0      1
0  28385    274
1     36  28665
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.7602445, 'recall': 0.78939867, 'specificity': 0.78939867, 'f1': 0.7739601, 'auroc': 0.96402085, 'binary_precision': 0.53481895, 'binary_recall': 0.59720063, 'binary_specificity': 0.98159677, 'binary_f1_score': 0.564291}
confusion matrix:
       0    1
0  17815  334
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.6183761, 'recall': 0.5084947, 'specificity': 0.5084947, 'f1': 0.5069299, 'auroc': 0.93822885, 'binary_precision': 0.2777778, 'binary_recall': 0.019157087, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.035842292}
confusion matrix:
      0   1
0  5984  13
1   256   5
early stop counter: 8
val acc:0.9684439897537231, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 12,now: 2024-07-30 21:44:52.018993,epoch time: 0:24:20.016984,used: 5:07:57.652052,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9956067, 'precision': 0.9956405, 'recall': 0.99561, 'specificity': 0.99561, 'f1': 0.9956066, 'auroc': 0.9998825, 'binary_precision': 0.9999297, 'binary_recall': 0.9912898, 'binary_specificity': 0.9999302, 'binary_f1_score': 0.995591}
confusion matrix:
       0      1
0  28656      2
1    250  28452
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.822088, 'recall': 0.5832988, 'specificity': 0.5832988, 'f1': 0.62742364, 'auroc': 0.95209056, 'binary_precision': 0.6728395, 'binary_recall': 0.16951789, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.27080747}
confusion matrix:
       0    1
0  18096   53
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9062574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 9
val acc:0.9687632918357849, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 13,now: 2024-07-30 22:10:55.371349,epoch time: 0:26:03.352356,used: 5:34:01.004408,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99796027, 'precision': 0.9979602, 'recall': 0.99796057, 'specificity': 0.99796057, 'f1': 0.9979602, 'auroc': 0.9999515, 'binary_precision': 0.99832654, 'binary_recall': 0.99759614, 'binary_specificity': 0.99832493, 'binary_f1_score': 0.99796116}
confusion matrix:
       0      1
0  28608     48
1     69  28635
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.7583966, 'recall': 0.69225585, 'specificity': 0.69225585, 'f1': 0.7199675, 'auroc': 0.95050013, 'binary_precision': 0.53797466, 'binary_recall': 0.39657855, 'binary_specificity': 0.9879332, 'binary_f1_score': 0.45658013}
confusion matrix:
       0    1
0  17930  219
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.9573837, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
early stop counter: 10
val acc:0.9676989912986755, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 14,now: 2024-07-30 22:36:38.284465,epoch time: 0:25:42.913116,used: 5:59:43.917524,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9962343, 'precision': 0.99624085, 'recall': 0.9962331, 'specificity': 0.9962331, 'f1': 0.9962343, 'auroc': 0.9999321, 'binary_precision': 0.9946171, 'binary_recall': 0.9978746, 'binary_specificity': 0.9945916, 'binary_f1_score': 0.9962432}
confusion matrix:
       0      1
0  28504    155
1     61  28640
---- Validation: 
scalar performance:
{'acc': 0.95572585, 'precision': 0.7074131, 'recall': 0.87957144, 'specificity': 0.87957144, 'f1': 0.76445913, 'auroc': 0.958024, 'binary_precision': 0.42222223, 'binary_recall': 0.7978227, 'binary_specificity': 0.96132016, 'binary_f1_score': 0.55220664}
confusion matrix:
       0    1
0  17447  702
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8020665, 'recall': 0.58595484, 'specificity': 0.58595484, 'f1': 0.62824726, 'auroc': 0.9381897, 'binary_precision': 0.6388889, 'binary_recall': 0.17624521, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.2762763}
confusion matrix:
      0   1
0  5971  26
1   215  46
early stop counter: 11
val acc:0.9557258486747742, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9614893198013306
after epoch: 15,now: 2024-07-30 23:01:02.182276,epoch time: 0:24:23.897811,used: 6:24:07.815335,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.992887, 'precision': 0.99295855, 'recall': 0.99289155, 'specificity': 0.99289155, 'f1': 0.9928868, 'auroc': 0.9997019, 'binary_precision': 0.99908274, 'binary_recall': 0.98669034, 'binary_specificity': 0.99909276, 'binary_f1_score': 0.99284786}
confusion matrix:
       0      1
0  28633     26
1    382  28319
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.7980203, 'recall': 0.6407438, 'specificity': 0.6407438, 'f1': 0.68880796, 'auroc': 0.9174688, 'binary_precision': 0.6208054, 'binary_recall': 0.28771386, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.3931987}
confusion matrix:
       0    1
0  18036  113
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.94796085, 'recall': 0.5534731, 'specificity': 0.5534731, 'f1': 0.58660847, 'auroc': 0.92134666, 'binary_precision': 0.93333334, 'binary_recall': 0.107279696, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.19243987}
confusion matrix:
      0   1
0  5995   2
1   233  28
new oracle model saved
early stop counter: 12
val acc:0.9696147441864014, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9624480605125427
after epoch: 16,now: 2024-07-30 23:24:07.789505,epoch time: 0:23:05.607229,used: 6:47:13.422564,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.996583, 'precision': 0.9966014, 'recall': 0.9965855, 'specificity': 0.9965855, 'f1': 0.996583, 'auroc': 0.99993026, 'binary_precision': 0.99982464, 'binary_recall': 0.99334544, 'binary_specificity': 0.99982554, 'binary_f1_score': 0.9965746}
confusion matrix:
       0      1
0  28653      5
1    191  28511
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.78247416, 'recall': 0.6206087, 'specificity': 0.6206087, 'f1': 0.66624326, 'auroc': 0.9588535, 'binary_precision': 0.59107804, 'binary_recall': 0.24727838, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.34868422}
confusion matrix:
       0    1
0  18039  110
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9572409, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 13
val acc:0.9683908224105835, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9624480605125427
after epoch: 17,now: 2024-07-30 23:47:05.721204,epoch time: 0:22:57.931699,used: 7:10:11.354263,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9975941, 'precision': 0.99760276, 'recall': 0.9975961, 'specificity': 0.9975961, 'f1': 0.9975941, 'auroc': 0.9999341, 'binary_precision': 0.999895, 'binary_recall': 0.99529684, 'binary_specificity': 0.99989533, 'binary_f1_score': 0.9975906}
confusion matrix:
       0      1
0  28653      3
1    135  28569
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.8400475, 'recall': 0.617988, 'specificity': 0.617988, 'f1': 0.6713325, 'auroc': 0.9369836, 'binary_precision': 0.70642203, 'binary_recall': 0.23950233, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.3577236}
confusion matrix:
       0    1
0  18085   64
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9581699, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
early stop counter: 14
val acc:0.9705725908279419, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9624480605125427
after epoch: 18,now: 2024-07-31 00:10:03.539616,epoch time: 0:22:57.818412,used: 7:33:09.172675,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9988319, 'precision': 0.99883246, 'recall': 0.99883264, 'specificity': 0.99883264, 'f1': 0.998832, 'auroc': 0.9999578, 'binary_precision': 0.9996162, 'binary_recall': 0.99804914, 'binary_specificity': 0.99961615, 'binary_f1_score': 0.99883205}
confusion matrix:
       0      1
0  28644     11
1     56  28649
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.79480684, 'recall': 0.63002264, 'specificity': 0.63002264, 'f1': 0.67777157, 'auroc': 0.9384527, 'binary_precision': 0.6151079, 'binary_recall': 0.2659409, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.3713355}
confusion matrix:
       0    1
0  18042  107
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9544184, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 15
val acc:0.9691889882087708, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9624480605125427
after epoch: 19,now: 2024-07-31 00:32:58.128690,epoch time: 0:22:54.589074,used: 7:56:03.761749,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9981346, 'precision': 0.9981377, 'recall': 0.9981358, 'specificity': 0.9981358, 'f1': 0.9981347, 'auroc': 0.9999447, 'binary_precision': 0.99961567, 'binary_recall': 0.9966555, 'binary_specificity': 0.99961615, 'binary_f1_score': 0.9981335}
confusion matrix:
       0      1
0  28645     11
1     96  28608
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.822376, 'recall': 0.61996263, 'specificity': 0.61996263, 'f1': 0.67135054, 'auroc': 0.93443525, 'binary_precision': 0.67094016, 'binary_recall': 0.24416797, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.35803878}
confusion matrix:
       0    1
0  18072   77
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.9441651, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
early stop counter: 16
val acc:0.9700404405593872, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9592521786689758 / 0.9624480605125427
after epoch: 20,now: 2024-07-31 00:55:37.035457,epoch time: 0:22:38.906767,used: 8:18:42.668516,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_53_seed_0_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 8:18:42.668516 at 2024-07-31 00:55:37.035457
persisted model performance metric: 

scalar performance:
{'acc': 0.9592522, 'precision': 0.91718, 'recall': 0.5133266, 'specificity': 0.5133266, 'f1': 0.5156116, 'auroc': 0.9398566, 'binary_precision': 0.875, 'binary_recall': 0.026819924, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.052044608}
confusion matrix:
      0  1
0  5996  1
1   254  7
oracle model performance metric: 

scalar performance:
{'acc': 0.96244806, 'precision': 0.94796085, 'recall': 0.5534731, 'specificity': 0.5534731, 'f1': 0.58660847, 'auroc': 0.92134666, 'binary_precision': 0.93333334, 'binary_recall': 0.107279696, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.19243987}
confusion matrix:
      0   1
0  5995   2
1   233  28
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15802 MiB | 504036 GiB | 504034 GiB |
|       from large pool |   1652 MiB |  15777 MiB | 496722 GiB | 496721 GiB |
|       from small pool |      6 MiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15802 MiB | 504036 GiB | 504034 GiB |
|       from large pool |   1652 MiB |  15777 MiB | 496722 GiB | 496721 GiB |
|       from small pool |      6 MiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB | 502480 GiB | 502479 GiB |
|       from large pool |   1647 MiB |  15745 MiB | 495182 GiB | 495181 GiB |
|       from small pool |      5 MiB |     25 MiB |   7297 GiB |   7297 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16628 MiB |  16628 MiB |  16628 MiB |      0 B   |
|       from large pool |  16600 MiB |  16600 MiB |  16600 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436974 KiB |    850 MiB | 218532 GiB | 218532 GiB |
|       from large pool | 417040 KiB |    849 MiB | 211216 GiB | 211216 GiB |
|       from small pool |  19934 KiB |     21 MiB |   7316 GiB |   7316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    8053    |   84786 K  |   84783 K  |
|       from large pool |     247    |     989    |   29619 K  |   29618 K  |
|       from small pool |    3119    |    7804    |   55167 K  |   55164 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    8053    |   84786 K  |   84783 K  |
|       from large pool |     247    |     989    |   29619 K  |   29618 K  |
|       from small pool |    3119    |    7804    |   55167 K  |   55164 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |     617    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |    3718    |   47881 K  |   47881 K  |
|       from large pool |     112    |     508    |   22611 K  |   22611 K  |
|       from small pool |      34    |    3605    |   25269 K  |   25269 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB | 504036 GiB | 504036 GiB |
|       from large pool |  16640 KiB |  15777 MiB | 496722 GiB | 496722 GiB |
|       from small pool |      0 KiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB | 504036 GiB | 504036 GiB |
|       from large pool |  16640 KiB |  15777 MiB | 496722 GiB | 496722 GiB |
|       from small pool |      0 KiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 502480 GiB | 502480 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 495182 GiB | 495182 GiB |
|       from small pool |      0 KiB |     25 MiB |   7297 GiB |   7297 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 218533 GiB | 218533 GiB |
|       from large pool |  24320 KiB |    849 MiB | 211217 GiB | 211217 GiB |
|       from small pool |      0 KiB |     25 MiB |   7316 GiB |   7316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8053    |   84786 K  |   84786 K  |
|       from large pool |       2    |     989    |   29619 K  |   29619 K  |
|       from small pool |       0    |    7804    |   55167 K  |   55167 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8053    |   84786 K  |   84786 K  |
|       from large pool |       2    |     989    |   29619 K  |   29619 K  |
|       from small pool |       0    |    7804    |   55167 K  |   55167 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3718    |   47882 K  |   47882 K  |
|       from large pool |       2    |     508    |   22612 K  |   22612 K  |
|       from small pool |       0    |    3605    |   25270 K  |   25270 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB | 504036 GiB | 504036 GiB |
|       from large pool |  16640 KiB |  15777 MiB | 496722 GiB | 496722 GiB |
|       from small pool |      0 KiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB | 504036 GiB | 504036 GiB |
|       from large pool |  16640 KiB |  15777 MiB | 496722 GiB | 496722 GiB |
|       from small pool |      0 KiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 502480 GiB | 502480 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 495182 GiB | 495182 GiB |
|       from small pool |      0 KiB |     25 MiB |   7297 GiB |   7297 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 218533 GiB | 218533 GiB |
|       from large pool |  24320 KiB |    849 MiB | 211217 GiB | 211217 GiB |
|       from small pool |      0 KiB |     25 MiB |   7316 GiB |   7316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8053    |   84786 K  |   84786 K  |
|       from large pool |       2    |     989    |   29619 K  |   29619 K  |
|       from small pool |       0    |    7804    |   55167 K  |   55167 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8053    |   84786 K  |   84786 K  |
|       from large pool |       2    |     989    |   29619 K  |   29619 K  |
|       from small pool |       0    |    7804    |   55167 K  |   55167 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3718    |   47882 K  |   47882 K  |
|       from large pool |       2    |     508    |   22612 K  |   22612 K  |
|       from small pool |       0    |    3605    |   25270 K  |   25270 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_01_05_13_seed_1_23656142

 Experiment start at: 2024-07-31 01:05:13.946686
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.04785691574215889
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9829561, 'precision': 0.9835024, 'recall': 0.98296785, 'specificity': 0.98296785, 'f1': 0.9829516, 'auroc': 0.9990716, 'binary_precision': 0.9999282, 'binary_recall': 0.96600527, 'binary_specificity': 0.9999305, 'binary_f1_score': 0.98267406}
confusion matrix:
       0      1
0  28786      2
1    980  27848
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7275367, 'recall': 0.5171387, 'specificity': 0.5171387, 'f1': 0.52407295, 'auroc': 0.92327964, 'binary_precision': 0.48979592, 'binary_recall': 0.035661217, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.06648199}
confusion matrix:
       0   1
0  18042  25
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7650658, 'recall': 0.50744003, 'specificity': 0.50744003, 'f1': 0.5043185, 'auroc': 0.9166285, 'binary_precision': 0.5714286, 'binary_recall': 0.015384615, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.029962547}
confusion matrix:
      0  1
0  5943  3
1   256  4
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 01:28:52.990151,epoch time: 0:23:39.043465,used: 0:23:39.043465,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_01_05_13_seed_1_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99541795, 'precision': 0.99544394, 'recall': 0.9954208, 'specificity': 0.9954208, 'f1': 0.9954179, 'auroc': 0.99975634, 'binary_precision': 0.99923104, 'binary_recall': 0.99160594, 'binary_specificity': 0.99923575, 'binary_f1_score': 0.9954039}
confusion matrix:
       0      1
0  28764     22
1    242  28588
---- Validation: 
scalar performance:
{'acc': 0.9674493, 'precision': 0.7851852, 'recall': 0.6412206, 'specificity': 0.6412206, 'f1': 0.68663925, 'auroc': 0.9311807, 'binary_precision': 0.5963303, 'binary_recall': 0.2897474, 'binary_specificity': 0.99269384, 'binary_f1_score': 0.39000002}
confusion matrix:
       0    1
0  17935  132
1    478  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.5175508, 'recall': 0.500914, 'specificity': 0.500914, 'f1': 0.49250063, 'auroc': 0.92494565, 'binary_precision': 0.07692308, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.007326007}
confusion matrix:
      0   1
0  5934  12
1   259   1
better model found
persisted
after epoch: 2,now: 2024-07-31 01:51:44.962654,epoch time: 0:22:51.972503,used: 0:46:31.015968,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_01_05_13_seed_1_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9962337, 'precision': 0.99625254, 'recall': 0.9962362, 'specificity': 0.9962362, 'f1': 0.99623364, 'auroc': 0.99986017, 'binary_precision': 0.9995112, 'binary_recall': 0.9929587, 'binary_specificity': 0.9995136, 'binary_f1_score': 0.99622416}
confusion matrix:
       0      1
0  28772     14
1    203  28627
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.73254097, 'recall': 0.64783895, 'specificity': 0.64783895, 'f1': 0.67968285, 'auroc': 0.9183152, 'binary_precision': 0.49052134, 'binary_recall': 0.307578, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.3780822}
confusion matrix:
       0    1
0  17852  215
1    466  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8142085, 'recall': 0.5451448, 'specificity': 0.5451448, 'f1': 0.5708467, 'auroc': 0.931424, 'binary_precision': 0.6666667, 'binary_recall': 0.092307694, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.16216217}
confusion matrix:
      0   1
0  5934  12
1   236  24
new oracle model saved
early stop counter: 1
val acc:0.9636605978012085, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9563325643539429 / 0.9600386619567871
after epoch: 3,now: 2024-07-31 02:14:43.224223,epoch time: 0:22:58.261569,used: 1:09:29.277537,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_01_05_13_seed_1_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9910268, 'precision': 0.99103296, 'recall': 0.9910282, 'specificity': 0.9910282, 'f1': 0.99102676, 'auroc': 0.9992313, 'binary_precision': 0.9929656, 'binary_recall': 0.9890735, 'binary_specificity': 0.9929829, 'binary_f1_score': 0.99101573}
confusion matrix:
       0      1
0  28585    202
1    315  28514
---- Validation: 
scalar performance:
{'acc': 0.93484527, 'precision': 0.65280294, 'recall': 0.82458615, 'specificity': 0.82458615, 'f1': 0.701503, 'auroc': 0.9331156, 'binary_precision': 0.31708944, 'binary_recall': 0.70579493, 'binary_specificity': 0.94337744, 'binary_f1_score': 0.43758637}
confusion matrix:
       0     1
0  17044  1023
1    198   475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9250725, 'precision': 0.6561665, 'recall': 0.832169, 'specificity': 0.832169, 'f1': 0.7047518, 'auroc': 0.910923, 'binary_precision': 0.32478634, 'binary_recall': 0.7307692, 'binary_specificity': 0.9335688, 'binary_f1_score': 0.44970414}
confusion matrix:
      0    1
0  5551  395
1    70  190
early stop counter: 2
val acc:0.9348452687263489, best validation acc: 0.9674493074417114, corresponding to test acc:                         0.9563325643539429 / 0.9600386619567871
after epoch: 4,now: 2024-07-31 02:37:39.992450,epoch time: 0:22:56.768227,used: 1:32:26.045764,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_01_05_13_seed_1_23656142
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 23656142 ON supergpu02 CANCELLED AT 2024-07-31T02:41:49 ***
