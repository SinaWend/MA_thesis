Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 30 16:27:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143

 Experiment start at: 2024-07-30 16:36:57.735042
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.9563758969306946
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9913703, 'precision': 0.9913944, 'recall': 0.9913728, 'specificity': 0.9913728, 'f1': 0.9913702, 'auroc': 0.99938715, 'binary_precision': 0.9950156, 'binary_recall': 0.98770034, 'binary_specificity': 0.99504536, 'binary_f1_score': 0.9913445}
confusion matrix:
       0      1
0  28518    142
1    353  28347
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96631545, 'precision': 0.744312, 'recall': 0.6780386, 'specificity': 0.6780386, 'f1': 0.7054154, 'auroc': 0.9055543, 'binary_precision': 0.51077586, 'binary_recall': 0.36858475, 'binary_specificity': 0.98749244, 'binary_f1_score': 0.42818427}
confusion matrix:
       0    1
0  17922  227
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.79871094, 'recall': 0.725631, 'specificity': 0.725631, 'f1': 0.75647855, 'auroc': 0.90802646, 'binary_precision': 0.62051284, 'binary_recall': 0.46360153, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.5307018}
confusion matrix:
      0    1
0  5923   74
1   140  121
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-30 17:03:59.842304,epoch time: 0:27:02.107262,used: 0:27:02.107262,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9930091, 'precision': 0.9930231, 'recall': 0.99300724, 'specificity': 0.99300724, 'f1': 0.993009, 'auroc': 0.999747, 'binary_precision': 0.99056995, 'binary_recall': 0.9955054, 'binary_specificity': 0.9905091, 'binary_f1_score': 0.9930315}
confusion matrix:
       0      1
0  28387    272
1    129  28572
---- Validation: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.6909699, 'recall': 0.71065885, 'specificity': 0.71065885, 'f1': 0.70026386, 'auroc': 0.92553174, 'binary_precision': 0.4016854, 'binary_recall': 0.44479004, 'binary_specificity': 0.97652763, 'binary_f1_score': 0.4221402}
confusion matrix:
       0    1
0  17723  426
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.7965826, 'recall': 0.7998415, 'specificity': 0.7998415, 'f1': 0.798202, 'auroc': 0.9277638, 'binary_precision': 0.6098485, 'binary_recall': 0.61685824, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.61333334}
confusion matrix:
      0    1
0  5894  103
1   100  161
new oracle model saved
early stop counter: 1
val acc:0.9583333134651184, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9658037424087524 / 0.9675615429878235
after epoch: 2,now: 2024-07-30 17:29:45.147279,epoch time: 0:25:45.304975,used: 0:52:47.412237,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9899756, 'precision': 0.9899756, 'recall': 0.9899757, 'specificity': 0.9899757, 'f1': 0.9899756, 'auroc': 0.999434, 'binary_precision': 0.99010247, 'binary_recall': 0.98986095, 'binary_specificity': 0.99009037, 'binary_f1_score': 0.9899817}
confusion matrix:
       0      1
0  28375    284
1    291  28410
---- Validation: 
scalar performance:
{'acc': 0.96322906, 'precision': 0.7321494, 'recall': 0.83920264, 'specificity': 0.83920264, 'f1': 0.7743262, 'auroc': 0.9532317, 'binary_precision': 0.4748954, 'binary_recall': 0.7060653, 'binary_specificity': 0.97234005, 'binary_f1_score': 0.5678549}
confusion matrix:
       0    1
0  17647  502
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.9093801, 'recall': 0.6292677, 'specificity': 0.6292677, 'f1': 0.6909946, 'auroc': 0.9401991, 'binary_precision': 0.85, 'binary_recall': 0.2605364, 'binary_specificity': 0.997999, 'binary_f1_score': 0.398827}
confusion matrix:
      0   1
0  5985  12
1   193  68
early stop counter: 2
val acc:0.9632290601730347, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9658037424087524 / 0.9675615429878235
after epoch: 3,now: 2024-07-30 17:53:34.800752,epoch time: 0:23:49.653473,used: 1:16:37.065710,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9963215, 'precision': 0.9963219, 'recall': 0.99632215, 'specificity': 0.99632215, 'f1': 0.9963215, 'auroc': 0.9998031, 'binary_precision': 0.9970693, 'binary_recall': 0.99557567, 'binary_specificity': 0.9970686, 'binary_f1_score': 0.9963219}
confusion matrix:
       0      1
0  28571     84
1    127  28578
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.7587174, 'recall': 0.83734715, 'specificity': 0.83734715, 'f1': 0.7922269, 'auroc': 0.95477426, 'binary_precision': 0.5283019, 'binary_recall': 0.6967341, 'binary_specificity': 0.9779602, 'binary_f1_score': 0.600939}
confusion matrix:
       0    1
0  17749  400
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8380296, 'recall': 0.63168174, 'specificity': 0.63168174, 'f1': 0.6853954, 'auroc': 0.9377227, 'binary_precision': 0.7070707, 'binary_recall': 0.26819924, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.38888893}
confusion matrix:
      0   1
0  5968  29
1   191  70
better model found
persisted
after epoch: 4,now: 2024-07-30 18:25:10.974447,epoch time: 0:31:36.173695,used: 1:48:13.239405,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99478734, 'precision': 0.9948288, 'recall': 0.99479127, 'specificity': 0.99479127, 'f1': 0.9947873, 'auroc': 0.999823, 'binary_precision': 0.9995779, 'binary_recall': 0.9900014, 'binary_specificity': 0.9995812, 'binary_f1_score': 0.99476665}
confusion matrix:
       0      1
0  28644     12
1    287  28417
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.80823874, 'recall': 0.59529966, 'specificity': 0.59529966, 'f1': 0.6413559, 'auroc': 0.9549204, 'binary_precision': 0.6443299, 'binary_recall': 0.19440125, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.2986858}
confusion matrix:
       0    1
0  18080   69
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.9350314, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
better model found
persisted
after epoch: 5,now: 2024-07-30 18:56:09.399956,epoch time: 0:30:58.425509,used: 2:19:11.664914,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9973501, 'precision': 0.99735165, 'recall': 0.9973509, 'specificity': 0.9973509, 'f1': 0.99735004, 'auroc': 0.9998939, 'binary_precision': 0.9984287, 'binary_recall': 0.9962719, 'binary_specificity': 0.99842983, 'binary_f1_score': 0.9973491}
confusion matrix:
       0      1
0  28614     45
1    107  28594
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7428732, 'recall': 0.7468784, 'specificity': 0.7468784, 'f1': 0.7448575, 'auroc': 0.9413656, 'binary_precision': 0.5030581, 'binary_recall': 0.5116641, 'binary_specificity': 0.9820927, 'binary_f1_score': 0.50732464}
confusion matrix:
       0    1
0  17824  325
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.6839974, 'recall': 0.56096536, 'specificity': 0.56096536, 'f1': 0.5871712, 'auroc': 0.9228681, 'binary_precision': 0.4047619, 'binary_recall': 0.1302682, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.19710144}
confusion matrix:
      0   1
0  5947  50
1   227  34
early stop counter: 1
val acc:0.9659961462020874, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9581335783004761 / 0.9675615429878235
after epoch: 6,now: 2024-07-30 19:26:27.755884,epoch time: 0:30:18.355928,used: 2:49:30.020842,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9938982, 'precision': 0.9939001, 'recall': 0.9938992, 'specificity': 0.9938992, 'f1': 0.99389815, 'auroc': 0.999809, 'binary_precision': 0.9951107, 'binary_recall': 0.99268395, 'binary_specificity': 0.99511445, 'binary_f1_score': 0.9938958}
confusion matrix:
       0      1
0  28516    140
1    210  28494
---- Validation: 
scalar performance:
{'acc': 0.9542891, 'precision': 0.6438918, 'recall': 0.62980926, 'specificity': 0.62980926, 'f1': 0.6364277, 'auroc': 0.90395284, 'binary_precision': 0.3131488, 'binary_recall': 0.281493, 'binary_specificity': 0.9781255, 'binary_f1_score': 0.2964783}
confusion matrix:
       0    1
0  17752  397
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7541858, 'recall': 0.6420068, 'specificity': 0.6420068, 'f1': 0.6802737, 'auroc': 0.91993827, 'binary_precision': 0.53846157, 'binary_recall': 0.29501915, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.3811881}
confusion matrix:
      0   1
0  5931  66
1   184  77
early stop counter: 2
val acc:0.9542890787124634, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9581335783004761 / 0.9675615429878235
after epoch: 7,now: 2024-07-30 19:56:54.409522,epoch time: 0:30:26.653638,used: 3:19:56.674480,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9969491, 'precision': 0.9969548, 'recall': 0.99695086, 'specificity': 0.99695086, 'f1': 0.9969491, 'auroc': 0.99986804, 'binary_precision': 0.9988809, 'binary_recall': 0.9950185, 'binary_specificity': 0.99888325, 'binary_f1_score': 0.99694604}
confusion matrix:
       0      1
0  28622     32
1    143  28563
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.7885978, 'recall': 0.6055801, 'specificity': 0.6055801, 'f1': 0.6511172, 'auroc': 0.93623424, 'binary_precision': 0.6043478, 'binary_recall': 0.21617419, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.31844214}
confusion matrix:
       0    1
0  18058   91
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6042133, 'recall': 0.5016656, 'specificity': 0.5016656, 'f1': 0.49303976, 'auroc': 0.94505537, 'binary_precision': 0.25, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0075471695}
confusion matrix:
      0  1
0  5994  3
1   260  1
early stop counter: 3
val acc:0.9683375954627991, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9581335783004761 / 0.9675615429878235
after epoch: 8,now: 2024-07-30 20:28:33.342775,epoch time: 0:31:38.933253,used: 3:51:35.607733,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9975941, 'precision': 0.9975984, 'recall': 0.9975955, 'specificity': 0.9975955, 'f1': 0.9975941, 'auroc': 0.99991655, 'binary_precision': 0.9992659, 'binary_recall': 0.99592376, 'binary_specificity': 0.9992672, 'binary_f1_score': 0.99759203}
confusion matrix:
       0      1
0  28636     21
1    117  28586
---- Validation: 
scalar performance:
{'acc': 0.9752022, 'precision': 0.85567594, 'recall': 0.7148918, 'specificity': 0.7148918, 'f1': 0.7665311, 'auroc': 0.9667211, 'binary_precision': 0.7310705, 'binary_recall': 0.43545878, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.545809}
confusion matrix:
       0    1
0  18046  103
1    363  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8685657, 'recall': 0.5132432, 'specificity': 0.5132432, 'f1': 0.51547354, 'auroc': 0.9482987, 'binary_precision': 0.7777778, 'binary_recall': 0.026819924, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.051851854}
confusion matrix:
      0  1
0  5995  2
1   254  7
better model found
persisted
after epoch: 9,now: 2024-07-30 20:57:27.252627,epoch time: 0:28:53.909852,used: 4:20:29.517585,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9973675, 'precision': 0.99737215, 'recall': 0.99736905, 'specificity': 0.99736905, 'f1': 0.9973675, 'auroc': 0.9998863, 'binary_precision': 0.999126, 'binary_recall': 0.99561054, 'binary_specificity': 0.99912757, 'binary_f1_score': 0.9973652}
confusion matrix:
       0      1
0  28630     25
1    126  28579
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.791793, 'recall': 0.6807998, 'specificity': 0.6807998, 'f1': 0.72206855, 'auroc': 0.94689286, 'binary_precision': 0.605598, 'binary_recall': 0.37013996, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.45945945}
confusion matrix:
       0    1
0  17994  155
1    405  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8595127, 'recall': 0.5698807, 'specificity': 0.5698807, 'f1': 0.60968745, 'auroc': 0.9339136, 'binary_precision': 0.75510204, 'binary_recall': 0.14176245, 'binary_specificity': 0.997999, 'binary_f1_score': 0.23870967}
confusion matrix:
      0   1
0  5985  12
1   224  37
early stop counter: 1
val acc:0.9702000617980957, best validation acc: 0.975202202796936, corresponding to test acc:                         0.959092378616333 / 0.9675615429878235
after epoch: 10,now: 2024-07-30 21:26:47.779734,epoch time: 0:29:20.527107,used: 4:49:50.044692,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99687934, 'precision': 0.9968958, 'recall': 0.9968815, 'specificity': 0.9968815, 'f1': 0.99687934, 'auroc': 0.9999451, 'binary_precision': 0.9999299, 'binary_recall': 0.99383277, 'binary_specificity': 0.9999302, 'binary_f1_score': 0.99687195}
confusion matrix:
       0      1
0  28658      2
1    177  28523
---- Validation: 
scalar performance:
{'acc': 0.9713708, 'precision': 0.84124076, 'recall': 0.6371526, 'specificity': 0.6371526, 'f1': 0.6924447, 'auroc': 0.954018, 'binary_precision': 0.7075099, 'binary_recall': 0.27838257, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.39955357}
confusion matrix:
       0    1
0  18075   74
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.94760966, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
early stop counter: 2
val acc:0.9713708162307739, best validation acc: 0.975202202796936, corresponding to test acc:                         0.959092378616333 / 0.9675615429878235
after epoch: 11,now: 2024-07-30 21:56:04.747307,epoch time: 0:29:16.967573,used: 5:19:07.012265,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99635637, 'precision': 0.996362, 'recall': 0.9963579, 'specificity': 0.9963579, 'f1': 0.99635637, 'auroc': 0.99984926, 'binary_precision': 0.99825144, 'binary_recall': 0.9944607, 'binary_specificity': 0.9982552, 'binary_f1_score': 0.9963525}
confusion matrix:
       0      1
0  28606     50
1    159  28545
---- Validation: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.7145046, 'recall': 0.8644202, 'specificity': 0.8644202, 'f1': 0.767257, 'auroc': 0.961777, 'binary_precision': 0.4376114, 'binary_recall': 0.7636081, 'binary_specificity': 0.96523225, 'binary_f1_score': 0.5563739}
confusion matrix:
       0    1
0  17518  631
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8996485, 'recall': 0.6215215, 'specificity': 0.6215215, 'f1': 0.680727, 'auroc': 0.9525163, 'binary_precision': 0.83116883, 'binary_recall': 0.24521072, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.37869823}
confusion matrix:
      0   1
0  5984  13
1   197  64
early stop counter: 3
val acc:0.9583333134651184, best validation acc: 0.975202202796936, corresponding to test acc:                         0.959092378616333 / 0.9675615429878235
after epoch: 12,now: 2024-07-30 22:25:18.747739,epoch time: 0:29:14.000432,used: 5:48:21.012697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9978208, 'precision': 0.99782085, 'recall': 0.99782115, 'specificity': 0.99782115, 'f1': 0.99782073, 'auroc': 0.999931, 'binary_precision': 0.9982565, 'binary_recall': 0.99738705, 'binary_specificity': 0.99825525, 'binary_f1_score': 0.9978215}
confusion matrix:
       0      1
0  28607     50
1     75  28628
---- Validation: 
scalar performance:
{'acc': 0.9779161, 'precision': 0.851861, 'recall': 0.78755206, 'specificity': 0.78755206, 'f1': 0.81619084, 'auroc': 0.9631345, 'binary_precision': 0.7183908, 'binary_recall': 0.58320373, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.64377683}
confusion matrix:
       0    1
0  18002  147
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8370436, 'recall': 0.5188236, 'specificity': 0.5188236, 'f1': 0.52594787, 'auroc': 0.92673576, 'binary_precision': 0.71428573, 'binary_recall': 0.038314175, 'binary_specificity': 0.999333, 'binary_f1_score': 0.07272727}
confusion matrix:
      0   1
0  5993   4
1   251  10
better model found
persisted
after epoch: 13,now: 2024-07-30 22:55:32.837022,epoch time: 0:30:14.089283,used: 6:18:35.101980,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9982392, 'precision': 0.99824405, 'recall': 0.99824053, 'specificity': 0.99824053, 'f1': 0.99823916, 'auroc': 0.99996495, 'binary_precision': 1.0, 'binary_recall': 0.99648106, 'binary_specificity': 1.0, 'binary_f1_score': 0.99823743}
confusion matrix:
       0      1
0  28658      0
1    101  28601
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.80719614, 'recall': 0.57166225, 'specificity': 0.57166225, 'f1': 0.6109713, 'auroc': 0.9624003, 'binary_precision': 0.6438356, 'binary_recall': 0.14618973, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.23827629}
confusion matrix:
       0   1
0  18097  52
1    549  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9622135, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 1
val acc:0.9680182933807373, best validation acc: 0.9779161214828491, corresponding to test acc:                         0.9592521786689758 / 0.9675615429878235
after epoch: 14,now: 2024-07-30 23:24:06.834455,epoch time: 0:28:33.997433,used: 6:47:09.099413,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9949616, 'precision': 0.99498147, 'recall': 0.99495935, 'specificity': 0.99495935, 'f1': 0.99496156, 'auroc': 0.9998839, 'binary_precision': 0.9920341, 'binary_recall': 0.9979444, 'binary_specificity': 0.9919743, 'binary_f1_score': 0.99498045}
confusion matrix:
       0      1
0  28428    230
1     59  28643
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.7683222, 'recall': 0.8404238, 'specificity': 0.8404238, 'f1': 0.79960835, 'auroc': 0.9596766, 'binary_precision': 0.5473301, 'binary_recall': 0.7013997, 'binary_specificity': 0.9794479, 'binary_f1_score': 0.6148603}
confusion matrix:
       0    1
0  17776  373
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8170396, 'recall': 0.6124413, 'specificity': 0.6124413, 'f1': 0.66144574, 'auroc': 0.9467176, 'binary_precision': 0.6666667, 'binary_recall': 0.22988506, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.34188035}
confusion matrix:
      0   1
0  5967  30
1   201  60
early stop counter: 2
val acc:0.9699339866638184, best validation acc: 0.9779161214828491, corresponding to test acc:                         0.9592521786689758 / 0.9675615429878235
after epoch: 15,now: 2024-07-30 23:51:29.780535,epoch time: 0:27:22.946080,used: 7:14:32.045493,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9977162, 'precision': 0.99771714, 'recall': 0.9977158, 'specificity': 0.9977158, 'f1': 0.9977162, 'auroc': 0.99993396, 'binary_precision': 0.9971808, 'binary_recall': 0.9982579, 'binary_specificity': 0.99717367, 'binary_f1_score': 0.99771905}
confusion matrix:
       0      1
0  28578     81
1     50  28651
---- Validation: 
scalar performance:
{'acc': 0.97121114, 'precision': 0.7971182, 'recall': 0.7083252, 'specificity': 0.7083252, 'f1': 0.744195, 'auroc': 0.9684255, 'binary_precision': 0.6143498, 'binary_recall': 0.42612752, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.50321394}
confusion matrix:
       0    1
0  17977  172
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.88822913, 'recall': 0.54172873, 'specificity': 0.54172873, 'f1': 0.5664118, 'auroc': 0.9486086, 'binary_precision': 0.8148148, 'binary_recall': 0.08429119, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15277778}
confusion matrix:
      0   1
0  5992   5
1   239  22
early stop counter: 3
val acc:0.9712111353874207, best validation acc: 0.9779161214828491, corresponding to test acc:                         0.9592521786689758 / 0.9675615429878235
after epoch: 16,now: 2024-07-31 00:18:43.228477,epoch time: 0:27:13.447942,used: 7:41:45.493435,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9983089, 'precision': 0.9983103, 'recall': 0.99830985, 'specificity': 0.99830985, 'f1': 0.9983089, 'auroc': 0.99994475, 'binary_precision': 0.9993716, 'binary_recall': 0.99724776, 'binary_specificity': 0.9993719, 'binary_f1_score': 0.99830854}
confusion matrix:
       0      1
0  28638     18
1     79  28625
---- Validation: 
scalar performance:
{'acc': 0.97482973, 'precision': 0.83382237, 'recall': 0.7402008, 'specificity': 0.7402008, 'f1': 0.77871275, 'auroc': 0.961539, 'binary_precision': 0.6855895, 'binary_recall': 0.48833594, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.5703905}
confusion matrix:
       0    1
0  18005  144
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7651576, 'recall': 0.50741273, 'specificity': 0.50741273, 'f1': 0.5043114, 'auroc': 0.9616246, 'binary_precision': 0.5714286, 'binary_recall': 0.01532567, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.029850746}
confusion matrix:
      0  1
0  5994  3
1   257  4
early stop counter: 4
val acc:0.9748297333717346, best validation acc: 0.9779161214828491, corresponding to test acc:                         0.9592521786689758 / 0.9675615429878235
after epoch: 17,now: 2024-07-31 00:41:58.167030,epoch time: 0:23:14.938553,used: 8:05:00.431988,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9981695, 'precision': 0.9981716, 'recall': 0.9981705, 'specificity': 0.9981705, 'f1': 0.9981694, 'auroc': 0.99994767, 'binary_precision': 0.99944115, 'binary_recall': 0.99689937, 'binary_specificity': 0.9994416, 'binary_f1_score': 0.99816865}
confusion matrix:
       0      1
0  28640     16
1     89  28615
---- Validation: 
scalar performance:
{'acc': 0.9757876, 'precision': 0.81461227, 'recall': 0.8254529, 'specificity': 0.8254529, 'f1': 0.8199317, 'auroc': 0.96986914, 'binary_precision': 0.6411411, 'binary_recall': 0.66407466, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.6524064}
confusion matrix:
       0    1
0  17910  239
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.90783304, 'recall': 0.5551387, 'specificity': 0.5551387, 'f1': 0.5886086, 'auroc': 0.9594898, 'binary_precision': 0.85294116, 'binary_recall': 0.11111111, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.19661018}
confusion matrix:
      0   1
0  5992   5
1   232  29
early stop counter: 5
val acc:0.9757875800132751, best validation acc: 0.9779161214828491, corresponding to test acc:                         0.9592521786689758 / 0.9675615429878235
after epoch: 18,now: 2024-07-31 01:04:46.587704,epoch time: 0:22:48.420674,used: 8:27:48.852662,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9981869, 'precision': 0.9981905, 'recall': 0.99818814, 'specificity': 0.99818814, 'f1': 0.9981869, 'auroc': 0.9999516, 'binary_precision': 0.9997554, 'binary_recall': 0.99662054, 'binary_specificity': 0.99975574, 'binary_f1_score': 0.9981855}
confusion matrix:
       0      1
0  28650      7
1     97  28606
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.8649409, 'recall': 0.62145656, 'specificity': 0.62145656, 'f1': 0.67814994, 'auroc': 0.9509574, 'binary_precision': 0.75598085, 'binary_recall': 0.24572317, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.37089205}
confusion matrix:
       0    1
0  18098   51
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9543814, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 6
val acc:0.971477210521698, best validation acc: 0.9779161214828491, corresponding to test acc:                         0.9592521786689758 / 0.9675615429878235
after epoch: 19,now: 2024-07-31 01:27:33.977705,epoch time: 0:22:47.390001,used: 8:50:36.242663,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9971409, 'precision': 0.99715483, 'recall': 0.99714315, 'specificity': 0.99714315, 'f1': 0.9971409, 'auroc': 0.9998905, 'binary_precision': 1.0, 'binary_recall': 0.9942863, 'binary_specificity': 1.0, 'binary_f1_score': 0.997135}
confusion matrix:
       0      1
0  28657      0
1    164  28539
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.91831374, 'recall': 0.5796525, 'specificity': 0.5796525, 'f1': 0.62762076, 'auroc': 0.97094655, 'binary_precision': 0.8655462, 'binary_recall': 0.16018662, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.2703412}
confusion matrix:
       0    1
0  18133   16
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9606928, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 7
val acc:0.9704129695892334, best validation acc: 0.9779161214828491, corresponding to test acc:                         0.9592521786689758 / 0.9675615429878235
after epoch: 20,now: 2024-07-31 01:50:01.299155,epoch time: 0:22:27.321450,used: 9:13:03.564113,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_16_36_57_seed_0_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 9:13:03.564113 at 2024-07-31 01:50:01.299155
persisted model performance metric: 

scalar performance:
{'acc': 0.9592522, 'precision': 0.8370436, 'recall': 0.5188236, 'specificity': 0.5188236, 'f1': 0.52594787, 'auroc': 0.92673576, 'binary_precision': 0.71428573, 'binary_recall': 0.038314175, 'binary_specificity': 0.999333, 'binary_f1_score': 0.07272727}
confusion matrix:
      0   1
0  5993   4
1   251  10
oracle model performance metric: 

scalar performance:
{'acc': 0.96756154, 'precision': 0.7965826, 'recall': 0.7998415, 'specificity': 0.7998415, 'f1': 0.798202, 'auroc': 0.9277638, 'binary_precision': 0.6098485, 'binary_recall': 0.61685824, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.61333334}
confusion matrix:
      0    1
0  5894  103
1   100  161
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_resnet_vit_2024-07-30_16-12-55/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15802 MiB | 504035 GiB | 504033 GiB |
|       from large pool |   1652 MiB |  15777 MiB | 496721 GiB | 496720 GiB |
|       from small pool |      6 MiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15802 MiB | 504035 GiB | 504033 GiB |
|       from large pool |   1652 MiB |  15777 MiB | 496721 GiB | 496720 GiB |
|       from small pool |      6 MiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB | 502479 GiB | 502478 GiB |
|       from large pool |   1647 MiB |  15745 MiB | 495181 GiB | 495180 GiB |
|       from small pool |      5 MiB |     25 MiB |   7297 GiB |   7297 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16628 MiB |  16628 MiB |  16628 MiB |      0 B   |
|       from large pool |  16600 MiB |  16600 MiB |  16600 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436974 KiB |    850 MiB | 218531 GiB | 218531 GiB |
|       from large pool | 417040 KiB |    849 MiB | 211215 GiB | 211215 GiB |
|       from small pool |  19934 KiB |     21 MiB |   7316 GiB |   7316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    8053    |   84785 K  |   84782 K  |
|       from large pool |     247    |     989    |   29618 K  |   29618 K  |
|       from small pool |    3119    |    7804    |   55166 K  |   55163 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    8053    |   84785 K  |   84782 K  |
|       from large pool |     247    |     989    |   29618 K  |   29618 K  |
|       from small pool |    3119    |    7804    |   55166 K  |   55163 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |     617    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     150    |    3720    |   47722 K  |   47721 K  |
|       from large pool |     112    |     508    |   22611 K  |   22611 K  |
|       from small pool |      38    |    3607    |   25110 K  |   25110 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB | 504035 GiB | 504035 GiB |
|       from large pool |  16640 KiB |  15777 MiB | 496721 GiB | 496721 GiB |
|       from small pool |      0 KiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB | 504035 GiB | 504035 GiB |
|       from large pool |  16640 KiB |  15777 MiB | 496721 GiB | 496721 GiB |
|       from small pool |      0 KiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 502479 GiB | 502479 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 495181 GiB | 495181 GiB |
|       from small pool |      0 KiB |     25 MiB |   7297 GiB |   7297 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 218532 GiB | 218532 GiB |
|       from large pool |  24320 KiB |    849 MiB | 211216 GiB | 211216 GiB |
|       from small pool |      0 KiB |     24 MiB |   7316 GiB |   7316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8053    |   84785 K  |   84785 K  |
|       from large pool |       2    |     989    |   29618 K  |   29618 K  |
|       from small pool |       0    |    7804    |   55166 K  |   55166 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8053    |   84785 K  |   84785 K  |
|       from large pool |       2    |     989    |   29618 K  |   29618 K  |
|       from small pool |       0    |    7804    |   55166 K  |   55166 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3720    |   47723 K  |   47723 K  |
|       from large pool |       2    |     508    |   22611 K  |   22611 K  |
|       from small pool |       0    |    3607    |   25111 K  |   25111 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB | 504035 GiB | 504035 GiB |
|       from large pool |  16640 KiB |  15777 MiB | 496721 GiB | 496721 GiB |
|       from small pool |      0 KiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB | 504035 GiB | 504035 GiB |
|       from large pool |  16640 KiB |  15777 MiB | 496721 GiB | 496721 GiB |
|       from small pool |      0 KiB |     26 MiB |   7313 GiB |   7313 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 502479 GiB | 502479 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 495181 GiB | 495181 GiB |
|       from small pool |      0 KiB |     25 MiB |   7297 GiB |   7297 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 218532 GiB | 218532 GiB |
|       from large pool |  24320 KiB |    849 MiB | 211216 GiB | 211216 GiB |
|       from small pool |      0 KiB |     24 MiB |   7316 GiB |   7316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8053    |   84785 K  |   84785 K  |
|       from large pool |       2    |     989    |   29618 K  |   29618 K  |
|       from small pool |       0    |    7804    |   55166 K  |   55166 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8053    |   84785 K  |   84785 K  |
|       from large pool |       2    |     989    |   29618 K  |   29618 K  |
|       from small pool |       0    |    7804    |   55166 K  |   55166 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3720    |   47723 K  |   47723 K  |
|       from large pool |       2    |     508    |   22611 K  |   22611 K  |
|       from small pool |       0    |    3607    |   25111 K  |   25111 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_02_00_02_seed_1_23656143

 Experiment start at: 2024-07-31 02:00:02.573586
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.04785691574215889
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9912524, 'precision': 0.99125236, 'recall': 0.9912526, 'specificity': 0.9912526, 'f1': 0.9912524, 'auroc': 0.9994093, 'binary_precision': 0.99149746, 'binary_recall': 0.991016, 'binary_specificity': 0.99148923, 'binary_f1_score': 0.99125665}
confusion matrix:
       0      1
0  28542    245
1    259  28570
---- Validation: 
scalar performance:
{'acc': 0.955016, 'precision': 0.67992896, 'recall': 0.6919938, 'specificity': 0.6919938, 'f1': 0.6857356, 'auroc': 0.9015704, 'binary_precision': 0.38194445, 'binary_recall': 0.40861812, 'binary_specificity': 0.97536945, 'binary_f1_score': 0.3948313}
confusion matrix:
       0    1
0  17622  445
1    398  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.73982036, 'recall': 0.6326593, 'specificity': 0.6326593, 'f1': 0.66885257, 'auroc': 0.9003228, 'binary_precision': 0.5106383, 'binary_recall': 0.2769231, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.35910225}
confusion matrix:
      0   1
0  5877  69
1   188  72
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 02:23:48.646743,epoch time: 0:23:46.073157,used: 0:23:46.073157,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_02_00_02_seed_1_23656143
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
slurmstepd: error: *** JOB 23656143 ON supergpu02 CANCELLED AT 2024-07-31T02:41:50 ***
