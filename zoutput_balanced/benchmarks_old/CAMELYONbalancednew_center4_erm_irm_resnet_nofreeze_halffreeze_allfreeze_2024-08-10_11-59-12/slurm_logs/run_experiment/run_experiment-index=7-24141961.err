Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 11:59:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141961

 Experiment start at: 2024-08-10 12:07:30.871476
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99208385, 'precision': 0.9920966, 'recall': 0.9920856, 'specificity': 0.9920856, 'f1': 0.9920838, 'auroc': 0.9996397, 'binary_precision': 0.9947634, 'binary_recall': 0.989386, 'binary_specificity': 0.9947851, 'binary_f1_score': 0.9920674}
confusion matrix:
       0      1
0  25180    132
1    269  25075
---- Validation: 
scalar performance:
{'acc': 0.9750962, 'precision': 0.73984766, 'recall': 0.8086492, 'specificity': 0.8086492, 'f1': 0.76956666, 'auroc': 0.92708546, 'binary_precision': 0.48884758, 'binary_recall': 0.63373494, 'binary_specificity': 0.9835634, 'binary_f1_score': 0.5519412}
confusion matrix:
       0    1
0  16456  275
1    152  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92050624, 'precision': 0.6331516, 'recall': 0.5184883, 'specificity': 0.5184883, 'f1': 0.51822203, 'auroc': 0.8528108, 'binary_precision': 0.34, 'binary_recall': 0.04404145, 'binary_specificity': 0.9929351, 'binary_f1_score': 0.07798165}
confusion matrix:
      0   1
0  9276  66
1   738  34
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 12:29:33.552190,epoch time: 0:22:02.680714,used: 0:22:02.680714,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99482787, 'precision': 0.994859, 'recall': 0.99483013, 'specificity': 0.99483013, 'f1': 0.99482775, 'auroc': 0.9997314, 'binary_precision': 0.99892575, 'binary_recall': 0.9907268, 'binary_specificity': 0.9989334, 'binary_f1_score': 0.9948093}
confusion matrix:
       0      1
0  25287     27
1    235  25107
---- Validation: 
scalar performance:
{'acc': 0.9782457, 'precision': 0.77568406, 'recall': 0.71509326, 'specificity': 0.71509326, 'f1': 0.74138904, 'auroc': 0.9189801, 'binary_precision': 0.5652174, 'binary_recall': 0.43855423, 'binary_specificity': 0.9916323, 'binary_f1_score': 0.4938942}
confusion matrix:
       0    1
0  16591  140
1    233  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9224837, 'precision': 0.64099205, 'recall': 0.50826997, 'specificity': 0.50826997, 'f1': 0.49823588, 'auroc': 0.82375455, 'binary_precision': 0.35714287, 'binary_recall': 0.019430052, 'binary_specificity': 0.99710983, 'binary_f1_score': 0.03685504}
confusion matrix:
      0   1
0  9315  27
1   757  15
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 12:50:52.143745,epoch time: 0:21:18.591555,used: 0:43:21.272269,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9963282, 'precision': 0.9963401, 'recall': 0.99633014, 'specificity': 0.99633014, 'f1': 0.9963281, 'auroc': 0.9999176, 'binary_precision': 0.9989688, 'binary_recall': 0.9936876, 'binary_specificity': 0.9989727, 'binary_f1_score': 0.99632114}
confusion matrix:
       0      1
0  25283     26
1    160  25187
---- Validation: 
scalar performance:
{'acc': 0.9780707, 'precision': 0.77530766, 'recall': 0.69972944, 'specificity': 0.69972944, 'f1': 0.7310958, 'auroc': 0.91676193, 'binary_precision': 0.5652174, 'binary_recall': 0.40722892, 'binary_specificity': 0.99223, 'binary_f1_score': 0.47338933}
confusion matrix:
       0    1
0  16601  130
1    246  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.8164547, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
new oracle model saved
early stop counter: 1
val acc:0.9780706763267517, best validation acc: 0.9782456755638123, corresponding to test acc:                         0.9224836826324463 / 0.9236701726913452
after epoch: 3,now: 2024-08-10 13:11:54.620841,epoch time: 0:21:02.477096,used: 1:04:23.749365,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9969994, 'precision': 0.9970046, 'recall': 0.9970004, 'specificity': 0.9970004, 'f1': 0.9969993, 'auroc': 0.999931, 'binary_precision': 0.99877244, 'binary_recall': 0.9952255, 'binary_specificity': 0.9987753, 'binary_f1_score': 0.9969958}
confusion matrix:
       0      1
0  25282     31
1    121  25222
---- Validation: 
scalar performance:
{'acc': 0.9796454, 'precision': 0.7935478, 'recall': 0.7346094, 'specificity': 0.7346094, 'f1': 0.76057017, 'auroc': 0.9356435, 'binary_precision': 0.6, 'binary_recall': 0.47710842, 'binary_specificity': 0.99211043, 'binary_f1_score': 0.5315437}
confusion matrix:
       0    1
0  16599  132
1    217  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9242634, 'precision': 0.89965117, 'recall': 0.5044802, 'specificity': 0.5044802, 'f1': 0.48928085, 'auroc': 0.8483063, 'binary_precision': 0.875, 'binary_recall': 0.0090673575, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.017948719}
confusion matrix:
      0  1
0  9341  1
1   765  7
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-10 13:33:08.415146,epoch time: 0:21:13.794305,used: 1:25:37.543670,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99727577, 'precision': 0.9972823, 'recall': 0.9972769, 'specificity': 0.9972769, 'f1': 0.9972757, 'auroc': 0.9999379, 'binary_precision': 0.9992473, 'binary_recall': 0.9953044, 'binary_specificity': 0.9992494, 'binary_f1_score': 0.99727196}
confusion matrix:
       0      1
0  25294     19
1    119  25224
---- Validation: 
scalar performance:
{'acc': 0.98057854, 'precision': 0.81627727, 'recall': 0.71511376, 'specificity': 0.71511376, 'f1': 0.7554758, 'auroc': 0.9357697, 'binary_precision': 0.6464286, 'binary_recall': 0.4361446, 'binary_specificity': 0.99408287, 'binary_f1_score': 0.5208633}
confusion matrix:
       0    1
0  16632   99
1    234  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92406565, 'precision': 0.8787264, 'recall': 0.5031848, 'specificity': 0.5031848, 'f1': 0.48668382, 'auroc': 0.80274826, 'binary_precision': 0.8333333, 'binary_recall': 0.006476684, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.01285347}
confusion matrix:
      0  1
0  9341  1
1   767  5
better model found
persisted
after epoch: 5,now: 2024-08-10 13:54:19.158106,epoch time: 0:21:10.742960,used: 1:46:48.286630,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9977693, 'precision': 0.9977751, 'recall': 0.9977699, 'specificity': 0.9977699, 'f1': 0.99776924, 'auroc': 0.9999229, 'binary_precision': 0.9995643, 'binary_recall': 0.99597424, 'binary_specificity': 0.99956554, 'binary_f1_score': 0.997766}
confusion matrix:
       0      1
0  25308     11
1    102  25235
---- Validation: 
scalar performance:
{'acc': 0.9801703, 'precision': 0.86062694, 'recall': 0.6385338, 'specificity': 0.6385338, 'f1': 0.6977557, 'auroc': 0.9292662, 'binary_precision': 0.7388535, 'binary_recall': 0.27951807, 'binary_specificity': 0.9975495, 'binary_f1_score': 0.4055944}
confusion matrix:
       0    1
0  16690   41
1    299  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.83017075, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 1
val acc:0.9801703095436096, best validation acc: 0.9805785417556763, corresponding to test acc:                         0.9240656495094299 / 0.9242634177207947
after epoch: 6,now: 2024-08-10 14:15:07.587686,epoch time: 0:20:48.429580,used: 2:07:36.716210,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99798644, 'precision': 0.9979919, 'recall': 0.9979875, 'specificity': 0.9979875, 'f1': 0.99798644, 'auroc': 0.99992824, 'binary_precision': 0.999802, 'binary_recall': 0.9961725, 'binary_specificity': 0.9998025, 'binary_f1_score': 0.99798393}
confusion matrix:
       0      1
0  25308      5
1     97  25246
---- Validation: 
scalar performance:
{'acc': 0.979762, 'precision': 0.87772655, 'recall': 0.6148259, 'specificity': 0.6148259, 'f1': 0.6729673, 'auroc': 0.93181264, 'binary_precision': 0.7741935, 'binary_recall': 0.2313253, 'binary_specificity': 0.9983265, 'binary_f1_score': 0.3562152}
confusion matrix:
       0   1
0  16703  28
1    319  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.71085584, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 2
val acc:0.9797620177268982, best validation acc: 0.9805785417556763, corresponding to test acc:                         0.9240656495094299 / 0.9242634177207947
after epoch: 7,now: 2024-08-10 14:35:56.104106,epoch time: 0:20:48.516420,used: 2:28:25.232630,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9980259, 'precision': 0.9980318, 'recall': 0.99802685, 'specificity': 0.99802685, 'f1': 0.9980259, 'auroc': 0.9999552, 'binary_precision': 0.99988115, 'binary_recall': 0.9961722, 'binary_specificity': 0.9998815, 'binary_f1_score': 0.9980233}
confusion matrix:
       0      1
0  25312      3
1     97  25244
---- Validation: 
scalar performance:
{'acc': 0.9780124, 'precision': 0.81446433, 'recall': 0.5986552, 'specificity': 0.5986552, 'f1': 0.6472692, 'auroc': 0.91825175, 'binary_precision': 0.6484375, 'binary_recall': 0.2, 'binary_specificity': 0.9973104, 'binary_f1_score': 0.30570903}
confusion matrix:
       0   1
0  16686  45
1    332  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.76847446, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 3
val acc:0.9780123829841614, best validation acc: 0.9805785417556763, corresponding to test acc:                         0.9240656495094299 / 0.9242634177207947
after epoch: 8,now: 2024-08-10 14:56:29.595499,epoch time: 0:20:33.491393,used: 2:48:58.724023,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_30_seed_0_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 2:48:58.724023 at 2024-08-10 14:56:29.595499
persisted model performance metric: 

scalar performance:
{'acc': 0.92406565, 'precision': 0.8787264, 'recall': 0.5031848, 'specificity': 0.5031848, 'f1': 0.48668382, 'auroc': 0.80274826, 'binary_precision': 0.8333333, 'binary_recall': 0.006476684, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.01285347}
confusion matrix:
      0  1
0  9341  1
1   767  5
oracle model performance metric: 

scalar performance:
{'acc': 0.9242634, 'precision': 0.89965117, 'recall': 0.5044802, 'specificity': 0.5044802, 'f1': 0.48928085, 'auroc': 0.8483063, 'binary_precision': 0.875, 'binary_recall': 0.0090673575, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.017948719}
confusion matrix:
      0  1
0  9341  1
1   765  7
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 469886 KiB |    815 MiB | 159646 GiB | 159645 GiB |
|       from large pool | 396288 KiB |    722 MiB | 158890 GiB | 158889 GiB |
|       from small pool |  73598 KiB |    109 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 469886 KiB |    815 MiB | 159646 GiB | 159645 GiB |
|       from large pool | 396288 KiB |    722 MiB | 158890 GiB | 158889 GiB |
|       from small pool |  73598 KiB |    109 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459821 KiB |    802 MiB | 158302 GiB | 158302 GiB |
|       from large pool | 387840 KiB |    714 MiB | 157552 GiB | 157552 GiB |
|       from small pool |  71981 KiB |    107 MiB |    750 GiB |    750 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1028 MiB |   1028 MiB |   1028 MiB |      0 B   |
|       from large pool |    918 MiB |    918 MiB |    918 MiB |      0 B   |
|       from small pool |    110 MiB |    110 MiB |    110 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 263297 KiB | 319898 KiB | 127623 GiB | 127623 GiB |
|       from large pool | 254976 KiB | 310592 KiB | 126859 GiB | 126859 GiB |
|       from small pool |   8321 KiB |  12168 KiB |    764 GiB |    764 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4959    |    7342    |   33432 K  |   33427 K  |
|       from large pool |      87    |     130    |   12165 K  |   12164 K  |
|       from small pool |    4872    |    7254    |   21267 K  |   21262 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4959    |    7342    |   33432 K  |   33427 K  |
|       from large pool |      87    |     130    |   12165 K  |   12164 K  |
|       from small pool |    4872    |    7254    |   21267 K  |   21262 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |      76    |      76    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      55    |      55    |      55    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      48    |    3192    |   15098 K  |   15098 K  |
|       from large pool |      16    |      21    |    5445 K  |    5445 K  |
|       from small pool |      32    |    3176    |    9653 K  |    9653 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |    815 MiB | 159646 GiB | 159646 GiB |
|       from large pool |  16640 KiB |    722 MiB | 158890 GiB | 158890 GiB |
|       from small pool |      0 KiB |    109 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |    815 MiB | 159646 GiB | 159646 GiB |
|       from large pool |  16640 KiB |    722 MiB | 158890 GiB | 158890 GiB |
|       from small pool |      0 KiB |    109 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |    802 MiB | 158302 GiB | 158302 GiB |
|       from large pool |  16640 KiB |    714 MiB | 157552 GiB | 157552 GiB |
|       from small pool |      0 KiB |    107 MiB |    750 GiB |    750 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 733184 KiB |   1028 MiB |   1028 MiB | 319488 KiB |
|       from large pool | 651264 KiB |    918 MiB |    918 MiB | 288768 KiB |
|       from small pool |  81920 KiB |    110 MiB |    110 MiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB | 450325 KiB | 127624 GiB | 127623 GiB |
|       from large pool | 134912 KiB | 436928 KiB | 126859 GiB | 126859 GiB |
|       from small pool |      0 KiB |  18911 KiB |    764 GiB |    764 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7342    |   33432 K  |   33432 K  |
|       from large pool |       2    |     130    |   12165 K  |   12165 K  |
|       from small pool |       0    |    7254    |   21267 K  |   21267 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7342    |   33432 K  |   33432 K  |
|       from large pool |       2    |     130    |   12165 K  |   12165 K  |
|       from small pool |       0    |    7254    |   21267 K  |   21267 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |      76    |      76    |      19    |
|       from large pool |      17    |      21    |      21    |       4    |
|       from small pool |      40    |      55    |      55    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3192    |   15100 K  |   15100 K  |
|       from large pool |       4    |      23    |    5445 K  |    5445 K  |
|       from small pool |       0    |    3176    |    9655 K  |    9655 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |    815 MiB | 159646 GiB | 159646 GiB |
|       from large pool |  16640 KiB |    722 MiB | 158890 GiB | 158890 GiB |
|       from small pool |      0 KiB |    109 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |    815 MiB | 159646 GiB | 159646 GiB |
|       from large pool |  16640 KiB |    722 MiB | 158890 GiB | 158890 GiB |
|       from small pool |      0 KiB |    109 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |    802 MiB | 158302 GiB | 158302 GiB |
|       from large pool |  16640 KiB |    714 MiB | 157552 GiB | 157552 GiB |
|       from small pool |      0 KiB |    107 MiB |    750 GiB |    750 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 733184 KiB |   1028 MiB |   1028 MiB | 319488 KiB |
|       from large pool | 651264 KiB |    918 MiB |    918 MiB | 288768 KiB |
|       from small pool |  81920 KiB |    110 MiB |    110 MiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB | 450325 KiB | 127624 GiB | 127623 GiB |
|       from large pool | 134912 KiB | 436928 KiB | 126859 GiB | 126859 GiB |
|       from small pool |      0 KiB |  18911 KiB |    764 GiB |    764 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7342    |   33432 K  |   33432 K  |
|       from large pool |       2    |     130    |   12165 K  |   12165 K  |
|       from small pool |       0    |    7254    |   21267 K  |   21267 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7342    |   33432 K  |   33432 K  |
|       from large pool |       2    |     130    |   12165 K  |   12165 K  |
|       from small pool |       0    |    7254    |   21267 K  |   21267 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |      76    |      76    |      19    |
|       from large pool |      17    |      21    |      21    |       4    |
|       from small pool |      40    |      55    |      55    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3192    |   15100 K  |   15100 K  |
|       from large pool |       4    |      23    |    5445 K  |    5445 K  |
|       from small pool |       0    |    3176    |    9655 K  |    9655 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961

 Experiment start at: 2024-08-10 15:05:32.976227
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9916588, 'precision': 0.9917191, 'recall': 0.9916636, 'specificity': 0.9916636, 'f1': 0.9916587, 'auroc': 0.9993917, 'binary_precision': 0.99737525, 'binary_recall': 0.98592603, 'binary_specificity': 0.99740106, 'binary_f1_score': 0.9916176}
confusion matrix:
       0      1
0  25329     66
1    358  25079
---- Validation: 
scalar performance:
{'acc': 0.97780764, 'precision': 0.7751607, 'recall': 0.76145947, 'specificity': 0.76145947, 'f1': 0.7681219, 'auroc': 0.9054644, 'binary_precision': 0.5623472, 'binary_recall': 0.5336427, 'binary_specificity': 0.9892763, 'binary_f1_score': 0.547619}
confusion matrix:
       0    1
0  16513  179
1    201  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92438805, 'precision': 0.462469, 'recall': 0.49967858, 'specificity': 0.49967858, 'f1': 0.4803543, 'auroc': 0.9003546, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99935716, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9328  6
1   757  0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 15:27:26.880968,epoch time: 0:21:53.904741,used: 0:21:53.904741,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9961245, 'precision': 0.99613214, 'recall': 0.996126, 'specificity': 0.996126, 'f1': 0.99612445, 'auroc': 0.999879, 'binary_precision': 0.9982626, 'binary_recall': 0.9939844, 'binary_specificity': 0.9982676, 'binary_f1_score': 0.9961189}
confusion matrix:
       0      1
0  25354     44
1    153  25281
---- Validation: 
scalar performance:
{'acc': 0.97260994, 'precision': 0.72112995, 'recall': 0.72262913, 'specificity': 0.72262913, 'f1': 0.72187674, 'auroc': 0.90784436, 'binary_precision': 0.4562212, 'binary_recall': 0.45939675, 'binary_specificity': 0.9858615, 'binary_f1_score': 0.45780346}
confusion matrix:
       0    1
0  16456  236
1    233  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.81053865, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
new oracle model saved
early stop counter: 1
val acc:0.9726099371910095, best validation acc: 0.9778076410293579, corresponding to test acc:                         0.92438805103302 / 0.9249826669692993
after epoch: 2,now: 2024-08-10 15:48:46.924067,epoch time: 0:21:20.043099,used: 0:43:13.947840,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9971278, 'precision': 0.9971339, 'recall': 0.9971291, 'specificity': 0.9971291, 'f1': 0.9971278, 'auroc': 0.9998892, 'binary_precision': 0.9990527, 'binary_recall': 0.9952031, 'binary_specificity': 0.9990551, 'binary_f1_score': 0.99712414}
confusion matrix:
       0      1
0  25375     24
1    122  25311
---- Validation: 
scalar performance:
{'acc': 0.9799685, 'precision': 0.81538224, 'recall': 0.72414315, 'specificity': 0.72414315, 'f1': 0.761549, 'auroc': 0.9201404, 'binary_precision': 0.6447368, 'binary_recall': 0.45475638, 'binary_specificity': 0.99352986, 'binary_f1_score': 0.5333333}
confusion matrix:
       0    1
0  16584  108
1    235  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.7669746, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
better model found
persisted
after epoch: 3,now: 2024-08-10 16:09:38.998209,epoch time: 0:20:52.074142,used: 1:04:06.021982,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99714744, 'precision': 0.99715567, 'recall': 0.99714947, 'specificity': 0.99714947, 'f1': 0.99714744, 'auroc': 0.9999324, 'binary_precision': 0.99940765, 'binary_recall': 0.99488956, 'binary_specificity': 0.9994093, 'binary_f1_score': 0.99714345}
confusion matrix:
       0      1
0  25379     15
1    130  25308
---- Validation: 
scalar performance:
{'acc': 0.97301877, 'precision': 0.72368973, 'recall': 0.7115374, 'specificity': 0.7115374, 'f1': 0.71742916, 'auroc': 0.91301, 'binary_precision': 0.46191648, 'binary_recall': 0.4361949, 'binary_specificity': 0.98687994, 'binary_f1_score': 0.44868737}
confusion matrix:
       0    1
0  16473  219
1    243  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92528, 'precision': 0.96262884, 'recall': 0.5019815, 'specificity': 0.5019815, 'f1': 0.4845364, 'auroc': 0.8157759, 'binary_precision': 1.0, 'binary_recall': 0.003963012, 'binary_specificity': 1.0, 'binary_f1_score': 0.007894737}
confusion matrix:
      0  1
0  9334  0
1   754  3
new oracle model saved
early stop counter: 1
val acc:0.9730187654495239, best validation acc: 0.9799684882164001, corresponding to test acc:                         0.9249826669692993 / 0.925279974937439
after epoch: 4,now: 2024-08-10 16:30:36.998471,epoch time: 0:20:58.000262,used: 1:25:04.022244,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99809176, 'precision': 0.9980931, 'recall': 0.99809253, 'specificity': 0.99809253, 'f1': 0.99809176, 'auroc': 0.9999299, 'binary_precision': 0.9991333, 'binary_recall': 0.9970514, 'binary_specificity': 0.9991337, 'binary_f1_score': 0.9980913}
confusion matrix:
       0      1
0  25374     22
1     75  25361
---- Validation: 
scalar performance:
{'acc': 0.9768148, 'precision': 0.76500803, 'recall': 0.74399817, 'specificity': 0.74399817, 'f1': 0.75403607, 'auroc': 0.93238723, 'binary_precision': 0.5429293, 'binary_recall': 0.4988399, 'binary_specificity': 0.9891565, 'binary_f1_score': 0.5199516}
confusion matrix:
       0    1
0  16511  181
1    216  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.71257555, 'recall': 0.50121385, 'specificity': 0.50121385, 'f1': 0.4831389, 'auroc': 0.7379681, 'binary_precision': 0.5, 'binary_recall': 0.002642008, 'binary_specificity': 0.9997857, 'binary_f1_score': 0.0052562417}
confusion matrix:
      0  1
0  9332  2
1   755  2
early stop counter: 2
val acc:0.9768148064613342, best validation acc: 0.9799684882164001, corresponding to test acc:                         0.9249826669692993 / 0.925279974937439
after epoch: 5,now: 2024-08-10 16:51:26.268899,epoch time: 0:20:49.270428,used: 1:45:53.292672,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99828845, 'precision': 0.9982894, 'recall': 0.9982892, 'specificity': 0.9982892, 'f1': 0.9982885, 'auroc': 0.99993074, 'binary_precision': 0.99921227, 'binary_recall': 0.9973661, 'binary_specificity': 0.99921244, 'binary_f1_score': 0.99828833}
confusion matrix:
       0      1
0  25375     20
1     67  25370
---- Validation: 
scalar performance:
{'acc': 0.98002684, 'precision': 0.813406, 'recall': 0.73208404, 'specificity': 0.73208404, 'f1': 0.7662856, 'auroc': 0.9365803, 'binary_precision': 0.64037853, 'binary_recall': 0.4709977, 'binary_specificity': 0.9931704, 'binary_f1_score': 0.54278076}
confusion matrix:
       0    1
0  16578  114
1    228  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92508173, 'precision': 0.96253717, 'recall': 0.5006605, 'specificity': 0.5006605, 'f1': 0.4818588, 'auroc': 0.82219565, 'binary_precision': 1.0, 'binary_recall': 0.001321004, 'binary_specificity': 1.0, 'binary_f1_score': 0.0026385225}
confusion matrix:
      0  1
0  9334  0
1   756  1
better model found
persisted
after epoch: 6,now: 2024-08-10 17:12:25.941843,epoch time: 0:20:59.672944,used: 2:06:52.965616,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9986032, 'precision': 0.9986048, 'recall': 0.9986042, 'specificity': 0.9986042, 'f1': 0.9986032, 'auroc': 0.9999297, 'binary_precision': 0.9997242, 'binary_recall': 0.9974841, 'binary_specificity': 0.9997243, 'binary_f1_score': 0.99860287}
confusion matrix:
       0      1
0  25387      7
1     64  25374
---- Validation: 
scalar performance:
{'acc': 0.97973484, 'precision': 0.8242942, 'recall': 0.6946397, 'specificity': 0.6946397, 'f1': 0.7422827, 'auroc': 0.9331757, 'binary_precision': 0.6640625, 'binary_recall': 0.39443156, 'binary_specificity': 0.99484783, 'binary_f1_score': 0.49490538}
confusion matrix:
       0    1
0  16606   86
1    261  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.80111694, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 1
val acc:0.9797348380088806, best validation acc: 0.9800268411636353, corresponding to test acc:                         0.925081729888916 / 0.925279974937439
after epoch: 7,now: 2024-08-10 17:33:22.291532,epoch time: 0:20:56.349689,used: 2:27:49.315305,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99822944, 'precision': 0.9982333, 'recall': 0.9982308, 'specificity': 0.9982308, 'f1': 0.99822944, 'auroc': 0.99996024, 'binary_precision': 0.9998422, 'binary_recall': 0.9966191, 'binary_specificity': 0.99984246, 'binary_f1_score': 0.998228}
confusion matrix:
       0      1
0  25391      4
1     86  25351
---- Validation: 
scalar performance:
{'acc': 0.9808445, 'precision': 0.8321204, 'recall': 0.72459245, 'specificity': 0.72459245, 'f1': 0.7673305, 'auroc': 0.94093496, 'binary_precision': 0.6782007, 'binary_recall': 0.45475638, 'binary_specificity': 0.99442846, 'binary_f1_score': 0.54444444}
confusion matrix:
       0    1
0  16599   93
1    235  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.86480653, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
better model found
persisted
after epoch: 8,now: 2024-08-10 17:54:11.041492,epoch time: 0:20:48.749960,used: 2:48:38.065265,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99893767, 'precision': 0.998938, 'recall': 0.9989382, 'specificity': 0.9989382, 'f1': 0.99893767, 'auroc': 0.99998, 'binary_precision': 0.9996063, 'binary_recall': 0.99827015, 'binary_specificity': 0.99960625, 'binary_f1_score': 0.9989378}
confusion matrix:
       0      1
0  25386     10
1     44  25392
---- Validation: 
scalar performance:
{'acc': 0.97891724, 'precision': 0.8225013, 'recall': 0.6637066, 'specificity': 0.6637066, 'f1': 0.71564794, 'auroc': 0.9330523, 'binary_precision': 0.662037, 'binary_recall': 0.33178654, 'binary_specificity': 0.9956266, 'binary_f1_score': 0.4420402}
confusion matrix:
       0    1
0  16619   73
1    288  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.84346616, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 1
val acc:0.9789172410964966, best validation acc: 0.9808444976806641, corresponding to test acc:                         0.9249826669692993 / 0.925279974937439
after epoch: 9,now: 2024-08-10 18:15:09.933856,epoch time: 0:20:58.892364,used: 3:09:36.957629,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9986819, 'precision': 0.9986838, 'recall': 0.998683, 'specificity': 0.998683, 'f1': 0.9986819, 'auroc': 0.9999734, 'binary_precision': 0.9998818, 'binary_recall': 0.9974841, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9986815}
confusion matrix:
       0      1
0  25391      3
1     64  25374
---- Validation: 
scalar performance:
{'acc': 0.9799685, 'precision': 0.86758673, 'recall': 0.6506841, 'specificity': 0.6506841, 'f1': 0.711431, 'auroc': 0.94253045, 'binary_precision': 0.75287354, 'binary_recall': 0.30394432, 'binary_specificity': 0.9974239, 'binary_f1_score': 0.43305784}
confusion matrix:
       0    1
0  16649   43
1    300  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.8340293, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 2
val acc:0.9799684882164001, best validation acc: 0.9808444976806641, corresponding to test acc:                         0.9249826669692993 / 0.925279974937439
after epoch: 10,now: 2024-08-10 18:36:07.800791,epoch time: 0:20:57.866935,used: 3:30:34.824564,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99870163, 'precision': 0.998703, 'recall': 0.9987024, 'specificity': 0.9987024, 'f1': 0.9987016, 'auroc': 0.9999646, 'binary_precision': 0.9997636, 'binary_recall': 0.99764115, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.9987012}
confusion matrix:
       0      1
0  25390      6
1     60  25376
---- Validation: 
scalar performance:
{'acc': 0.98125327, 'precision': 0.90702313, 'recall': 0.6592541, 'specificity': 0.6592541, 'f1': 0.7263859, 'auroc': 0.9455711, 'binary_precision': 0.8313253, 'binary_recall': 0.3201856, 'binary_specificity': 0.99832255, 'binary_f1_score': 0.46231154}
confusion matrix:
       0    1
0  16664   28
1    293  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92488354, 'precision': 0.4624876, 'recall': 0.49994645, 'specificity': 0.49994645, 'f1': 0.48048806, 'auroc': 0.8804804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9333  1
1   757  0
better model found
persisted
after epoch: 11,now: 2024-08-10 18:56:47.084876,epoch time: 0:20:39.284085,used: 3:51:14.108649,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99917376, 'precision': 0.9991742, 'recall': 0.9991743, 'specificity': 0.9991743, 'f1': 0.99917376, 'auroc': 0.9999521, 'binary_precision': 0.99988186, 'binary_recall': 0.99846673, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9991738}
confusion matrix:
       0      1
0  25393      3
1     39  25397
---- Validation: 
scalar performance:
{'acc': 0.9816621, 'precision': 0.8820297, 'recall': 0.6877172, 'specificity': 0.6877172, 'f1': 0.75001574, 'auroc': 0.9355206, 'binary_precision': 0.7799043, 'binary_recall': 0.37819025, 'binary_specificity': 0.9972442, 'binary_f1_score': 0.50937504}
confusion matrix:
       0    1
0  16646   46
1    268  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92458624, 'precision': 0.46247646, 'recall': 0.49978572, 'specificity': 0.49978572, 'f1': 0.48040783, 'auroc': 0.8688444, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99957144, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9330  4
1   757  0
better model found
persisted
after epoch: 12,now: 2024-08-10 19:17:34.829225,epoch time: 0:20:47.744349,used: 4:12:01.852998,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99925244, 'precision': 0.99925244, 'recall': 0.9992528, 'specificity': 0.9992528, 'f1': 0.99925244, 'auroc': 0.9999871, 'binary_precision': 0.9996852, 'binary_recall': 0.99882066, 'binary_specificity': 0.999685, 'binary_f1_score': 0.9992528}
confusion matrix:
       0      1
0  25386      8
1     30  25408
---- Validation: 
scalar performance:
{'acc': 0.9816037, 'precision': 0.84737086, 'recall': 0.72611195, 'specificity': 0.72611195, 'f1': 0.77315986, 'auroc': 0.9444193, 'binary_precision': 0.70863307, 'binary_recall': 0.45707658, 'binary_specificity': 0.99514735, 'binary_f1_score': 0.5557123}
confusion matrix:
       0    1
0  16611   81
1    234  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92458624, 'precision': 0.46247646, 'recall': 0.49978572, 'specificity': 0.49978572, 'f1': 0.48040783, 'auroc': 0.7869678, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99957144, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9330  4
1   757  0
early stop counter: 1
val acc:0.9816036820411682, best validation acc: 0.9816620945930481, corresponding to test acc:                         0.9245862364768982 / 0.925279974937439
after epoch: 13,now: 2024-08-10 19:38:04.766633,epoch time: 0:20:29.937408,used: 4:32:31.790406,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99925244, 'precision': 0.9992528, 'recall': 0.999253, 'specificity': 0.999253, 'f1': 0.99925244, 'auroc': 0.9999907, 'binary_precision': 0.99992126, 'binary_recall': 0.9985847, 'binary_specificity': 0.99992126, 'binary_f1_score': 0.99925256}
confusion matrix:
       0      1
0  25394      2
1     36  25400
---- Validation: 
scalar performance:
{'acc': 0.9790924, 'precision': 0.8312431, 'recall': 0.6581458, 'specificity': 0.6581458, 'f1': 0.7123401, 'auroc': 0.90927666, 'binary_precision': 0.67980295, 'binary_recall': 0.3201856, 'binary_specificity': 0.9961059, 'binary_f1_score': 0.43533123}
confusion matrix:
       0    1
0  16627   65
1    293  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.46249133, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4805148, 'auroc': 0.7853848, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9334  0
1   757  0
early stop counter: 2
val acc:0.9790924191474915, best validation acc: 0.9816620945930481, corresponding to test acc:                         0.9245862364768982 / 0.925279974937439
after epoch: 14,now: 2024-08-10 19:58:48.354321,epoch time: 0:20:43.587688,used: 4:53:15.378094,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99919343, 'precision': 0.99919343, 'recall': 0.99919343, 'specificity': 0.99919343, 'f1': 0.99919343, 'auroc': 0.9999834, 'binary_precision': 0.9991744, 'binary_recall': 0.9992137, 'binary_specificity': 0.9991731, 'binary_f1_score': 0.9991941}
confusion matrix:
       0      1
0  25376     21
1     20  25415
---- Validation: 
scalar performance:
{'acc': 0.975822, 'precision': 0.7538697, 'recall': 0.7412287, 'specificity': 0.7412287, 'f1': 0.7473749, 'auroc': 0.9354459, 'binary_precision': 0.5207824, 'binary_recall': 0.49419954, 'binary_specificity': 0.9882578, 'binary_f1_score': 0.5071429}
confusion matrix:
       0    1
0  16496  196
1    218  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92508173, 'precision': 0.7959126, 'recall': 0.50126743, 'specificity': 0.50126743, 'f1': 0.4831691, 'auroc': 0.80546904, 'binary_precision': 0.6666667, 'binary_recall': 0.002642008, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0052631577}
confusion matrix:
      0  1
0  9333  1
1   755  2
early stop counter: 3
val acc:0.9758219718933105, best validation acc: 0.9816620945930481, corresponding to test acc:                         0.9245862364768982 / 0.925279974937439
after epoch: 15,now: 2024-08-10 20:19:30.092030,epoch time: 0:20:41.737709,used: 5:13:57.115803,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_15_05_32_seed_1_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 5:13:57.115803 at 2024-08-10 20:19:30.092030
persisted model performance metric: 

scalar performance:
{'acc': 0.92458624, 'precision': 0.46247646, 'recall': 0.49978572, 'specificity': 0.49978572, 'f1': 0.48040783, 'auroc': 0.8688444, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99957144, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9330  4
1   757  0
oracle model performance metric: 

scalar performance:
{'acc': 0.92528, 'precision': 0.96262884, 'recall': 0.5019815, 'specificity': 0.5019815, 'f1': 0.4845364, 'auroc': 0.8157759, 'binary_precision': 1.0, 'binary_recall': 0.003963012, 'binary_specificity': 1.0, 'binary_f1_score': 0.007894737}
confusion matrix:
      0  1
0  9334  0
1   754  3
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 471000 KiB |    826 MiB | 455988 GiB | 455988 GiB |
|       from large pool | 397408 KiB |    722 MiB | 453815 GiB | 453815 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2172 GiB |   2172 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 471000 KiB |    826 MiB | 455988 GiB | 455988 GiB |
|       from large pool | 397408 KiB |    722 MiB | 453815 GiB | 453815 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2172 GiB |   2172 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |    813 MiB | 452818 GiB | 452818 GiB |
|       from large pool | 387840 KiB |    714 MiB | 450662 GiB | 450661 GiB |
|       from small pool |  71980 KiB |    107 MiB |   2156 GiB |   2156 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1144 MiB |   1144 MiB |   1456 MiB | 319488 KiB |
|       from large pool |   1036 MiB |   1036 MiB |   1318 MiB | 288768 KiB |
|       from small pool |    108 MiB |    110 MiB |    138 MiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 350247 KiB | 450325 KiB | 378472 GiB | 378472 GiB |
|       from large pool | 341920 KiB | 436928 KiB | 376255 GiB | 376254 GiB |
|       from small pool |   8327 KiB |  18911 KiB |   2217 GiB |   2217 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7364    |   95669 K  |   95664 K  |
|       from large pool |      87    |     130    |   34825 K  |   34825 K  |
|       from small pool |    4860    |    7276    |   60843 K  |   60838 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7364    |   95669 K  |   95664 K  |
|       from large pool |      87    |     130    |   34825 K  |   34825 K  |
|       from small pool |    4860    |    7276    |   60843 K  |   60838 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |      93    |      19    |
|       from large pool |      20    |      21    |      24    |       4    |
|       from small pool |      54    |      55    |      69    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      46    |    3200    |   41428 K  |   41428 K  |
|       from large pool |      14    |      23    |   13715 K  |   13715 K  |
|       from small pool |      32    |    3186    |   27712 K  |   27712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |    826 MiB | 455988 GiB | 455988 GiB |
|       from large pool |  16640 KiB |    722 MiB | 453815 GiB | 453815 GiB |
|       from small pool |      0 KiB |    109 MiB |   2172 GiB |   2172 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |    826 MiB | 455988 GiB | 455988 GiB |
|       from large pool |  16640 KiB |    722 MiB | 453815 GiB | 453815 GiB |
|       from small pool |      0 KiB |    109 MiB |   2172 GiB |   2172 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |    813 MiB | 452818 GiB | 452818 GiB |
|       from large pool |  16640 KiB |    714 MiB | 450662 GiB | 450661 GiB |
|       from small pool |      0 KiB |    107 MiB |   2156 GiB |   2156 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   1144 MiB |   1456 MiB | 669696 KiB |
|       from large pool |    722 MiB |   1036 MiB |   1318 MiB | 610304 KiB |
|       from small pool |     80 MiB |    110 MiB |    138 MiB |  59392 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB | 450325 KiB | 378473 GiB | 378472 GiB |
|       from large pool | 134912 KiB | 436928 KiB | 376255 GiB | 376255 GiB |
|       from small pool |      0 KiB |  18911 KiB |   2217 GiB |   2217 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7364    |   95669 K  |   95669 K  |
|       from large pool |       2    |     130    |   34825 K  |   34825 K  |
|       from small pool |       0    |    7276    |   60843 K  |   60843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7364    |   95669 K  |   95669 K  |
|       from large pool |       2    |     130    |   34825 K  |   34825 K  |
|       from small pool |       0    |    7276    |   60843 K  |   60843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |      76    |      93    |      36    |
|       from large pool |      17    |      21    |      24    |       7    |
|       from small pool |      40    |      55    |      69    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3200    |   41430 K  |   41430 K  |
|       from large pool |       4    |      23    |   13715 K  |   13715 K  |
|       from small pool |       0    |    3186    |   27714 K  |   27714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |    826 MiB | 455988 GiB | 455988 GiB |
|       from large pool |  16640 KiB |    722 MiB | 453815 GiB | 453815 GiB |
|       from small pool |      0 KiB |    109 MiB |   2172 GiB |   2172 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |    826 MiB | 455988 GiB | 455988 GiB |
|       from large pool |  16640 KiB |    722 MiB | 453815 GiB | 453815 GiB |
|       from small pool |      0 KiB |    109 MiB |   2172 GiB |   2172 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |    813 MiB | 452818 GiB | 452818 GiB |
|       from large pool |  16640 KiB |    714 MiB | 450662 GiB | 450661 GiB |
|       from small pool |      0 KiB |    107 MiB |   2156 GiB |   2156 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   1144 MiB |   1456 MiB | 669696 KiB |
|       from large pool |    722 MiB |   1036 MiB |   1318 MiB | 610304 KiB |
|       from small pool |     80 MiB |    110 MiB |    138 MiB |  59392 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB | 450325 KiB | 378473 GiB | 378472 GiB |
|       from large pool | 134912 KiB | 436928 KiB | 376255 GiB | 376255 GiB |
|       from small pool |      0 KiB |  18911 KiB |   2217 GiB |   2217 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7364    |   95669 K  |   95669 K  |
|       from large pool |       2    |     130    |   34825 K  |   34825 K  |
|       from small pool |       0    |    7276    |   60843 K  |   60843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7364    |   95669 K  |   95669 K  |
|       from large pool |       2    |     130    |   34825 K  |   34825 K  |
|       from small pool |       0    |    7276    |   60843 K  |   60843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |      76    |      93    |      36    |
|       from large pool |      17    |      21    |      24    |       7    |
|       from small pool |      40    |      55    |      69    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3200    |   41430 K  |   41430 K  |
|       from large pool |       4    |      23    |   13715 K  |   13715 K  |
|       from small pool |       0    |    3186    |   27714 K  |   27714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961

 Experiment start at: 2024-08-10 20:28:26.198973
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9918756, 'precision': 0.9919529, 'recall': 0.9918766, 'specificity': 0.9918766, 'f1': 0.9918753, 'auroc': 0.9996455, 'binary_precision': 0.99815875, 'binary_recall': 0.98557174, 'binary_specificity': 0.9981814, 'binary_f1_score': 0.9918253}
confusion matrix:
       0      1
0  25797     47
1    373  25479
---- Validation: 
scalar performance:
{'acc': 0.9779257, 'precision': 0.76957554, 'recall': 0.7519394, 'specificity': 0.7519394, 'f1': 0.7604372, 'auroc': 0.9180023, 'binary_precision': 0.55128205, 'binary_recall': 0.51435405, 'binary_specificity': 0.9895247, 'binary_f1_score': 0.5321782}
confusion matrix:
       0    1
0  16531  175
1    203  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92043203, 'precision': 0.6573785, 'recall': 0.5059864, 'specificity': 0.5059864, 'f1': 0.49259362, 'auroc': 0.855389, 'binary_precision': 0.39285713, 'binary_recall': 0.013801756, 'binary_specificity': 0.99817103, 'binary_f1_score': 0.026666667}
confusion matrix:
      0   1
0  9278  17
1   786  11
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 20:50:08.713592,epoch time: 0:21:42.514619,used: 0:21:42.514619,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9964407, 'precision': 0.99644196, 'recall': 0.9964409, 'specificity': 0.9964409, 'f1': 0.99644077, 'auroc': 0.9998738, 'binary_precision': 0.99728775, 'binary_recall': 0.99559045, 'binary_specificity': 0.9972913, 'binary_f1_score': 0.9964384}
confusion matrix:
       0      1
0  25773     70
1    114  25739
---- Validation: 
scalar performance:
{'acc': 0.97132677, 'precision': 0.7148427, 'recall': 0.80453706, 'specificity': 0.80453706, 'f1': 0.75121605, 'auroc': 0.9124573, 'binary_precision': 0.4390651, 'binary_recall': 0.62918663, 'binary_specificity': 0.9798875, 'binary_f1_score': 0.51720744}
confusion matrix:
       0    1
0  16370  336
1    155  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92261195, 'precision': 0.87807906, 'recall': 0.5123319, 'specificity': 0.5123319, 'f1': 0.5041932, 'auroc': 0.5613607, 'binary_precision': 0.8333333, 'binary_recall': 0.025094103, 'binary_specificity': 0.99956965, 'binary_f1_score': 0.04872107}
confusion matrix:
      0   1
0  9291   4
1   777  20
new oracle model saved
early stop counter: 1
val acc:0.9713267683982849, best validation acc: 0.977925717830658, corresponding to test acc:                         0.9204320311546326 / 0.9226119518280029
after epoch: 2,now: 2024-08-10 21:11:21.148593,epoch time: 0:21:12.435001,used: 0:42:54.949620,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.996963, 'precision': 0.99696493, 'recall': 0.9969634, 'specificity': 0.9969634, 'f1': 0.996963, 'auroc': 0.99984646, 'binary_precision': 0.99802333, 'binary_recall': 0.9959004, 'binary_specificity': 0.9980263, 'binary_f1_score': 0.99696076}
confusion matrix:
       0      1
0  25789     51
1    106  25750
---- Validation: 
scalar performance:
{'acc': 0.9755898, 'precision': 0.74544907, 'recall': 0.8113868, 'specificity': 0.8113868, 'f1': 0.7741852, 'auroc': 0.92963994, 'binary_precision': 0.5, 'binary_recall': 0.638756, 'binary_specificity': 0.9840177, 'binary_f1_score': 0.56092435}
confusion matrix:
       0    1
0  16439  267
1    151  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9216211, 'precision': 0.86087084, 'recall': 0.50491124, 'specificity': 0.50491124, 'f1': 0.4895025, 'auroc': 0.6533592, 'binary_precision': 0.8, 'binary_recall': 0.010037641, 'binary_specificity': 0.9997848, 'binary_f1_score': 0.019826517}
confusion matrix:
      0  1
0  9293  2
1   789  8
early stop counter: 2
val acc:0.9755898118019104, best validation acc: 0.977925717830658, corresponding to test acc:                         0.9204320311546326 / 0.9226119518280029
after epoch: 3,now: 2024-08-10 21:32:48.879542,epoch time: 0:21:27.730949,used: 1:04:22.680569,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9971758, 'precision': 0.9971882, 'recall': 0.9971764, 'specificity': 0.9971764, 'f1': 0.9971758, 'auroc': 0.9999497, 'binary_precision': 0.99972785, 'binary_recall': 0.99462366, 'binary_specificity': 0.9997291, 'binary_f1_score': 0.99716926}
confusion matrix:
       0      1
0  25835      7
1    139  25715
---- Validation: 
scalar performance:
{'acc': 0.9790937, 'precision': 0.837019, 'recall': 0.62775, 'specificity': 0.62775, 'f1': 0.68283767, 'auroc': 0.92082065, 'binary_precision': 0.6923077, 'binary_recall': 0.2583732, 'binary_specificity': 0.99712676, 'binary_f1_score': 0.37630662}
confusion matrix:
       0    1
0  16658   48
1    310  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.46051326, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.479445, 'auroc': 0.7023175, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9295  0
1   797  0
better model found
persisted
after epoch: 4,now: 2024-08-10 21:54:27.592335,epoch time: 0:21:38.712793,used: 1:26:01.393362,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9976401, 'precision': 0.9976493, 'recall': 0.9976405, 'specificity': 0.9976405, 'f1': 0.99764, 'auroc': 0.9998952, 'binary_precision': 0.9998446, 'binary_recall': 0.9954357, 'binary_specificity': 0.9998452, 'binary_f1_score': 0.9976353}
confusion matrix:
       0      1
0  25839      4
1    118  25735
---- Validation: 
scalar performance:
{'acc': 0.9786849, 'precision': 0.82214975, 'recall': 0.62754047, 'specificity': 0.62754047, 'f1': 0.6804657, 'auroc': 0.9096642, 'binary_precision': 0.6625767, 'binary_recall': 0.2583732, 'binary_specificity': 0.9967078, 'binary_f1_score': 0.3717728}
confusion matrix:
       0    1
0  16651   55
1    310  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.46051326, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.479445, 'auroc': 0.7678449, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9295  0
1   797  0
early stop counter: 1
val acc:0.9786849021911621, best validation acc: 0.9790936708450317, corresponding to test acc:                         0.9210265278816223 / 0.9226119518280029
after epoch: 5,now: 2024-08-10 22:15:40.580256,epoch time: 0:21:12.987921,used: 1:47:14.381283,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99812365, 'precision': 0.9981284, 'recall': 0.998124, 'specificity': 0.998124, 'f1': 0.99812365, 'auroc': 0.9999674, 'binary_precision': 0.9997284, 'binary_recall': 0.9965189, 'binary_specificity': 0.9997291, 'binary_f1_score': 0.9981211}
confusion matrix:
       0      1
0  25835      7
1     90  25764
---- Validation: 
scalar performance:
{'acc': 0.9802032, 'precision': 0.8194373, 'recall': 0.6982932, 'specificity': 0.6982932, 'f1': 0.74384016, 'auroc': 0.9206854, 'binary_precision': 0.6536965, 'binary_recall': 0.40191388, 'binary_specificity': 0.9946726, 'binary_f1_score': 0.49777773}
confusion matrix:
       0    1
0  16617   89
1    250  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.46051326, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.479445, 'auroc': 0.7283923, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9295  0
1   797  0
better model found
persisted
after epoch: 6,now: 2024-08-10 22:36:45.070911,epoch time: 0:21:04.490655,used: 2:08:18.871938,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9981043, 'precision': 0.99810886, 'recall': 0.99810445, 'specificity': 0.99810445, 'f1': 0.99810433, 'auroc': 0.99998295, 'binary_precision': 0.9996508, 'binary_recall': 0.9965572, 'binary_specificity': 0.9996518, 'binary_f1_score': 0.9981016}
confusion matrix:
       0      1
0  25836      9
1     89  25762
---- Validation: 
scalar performance:
{'acc': 0.9801448, 'precision': 0.8165386, 'recall': 0.701762, 'specificity': 0.701762, 'f1': 0.74566853, 'auroc': 0.9363541, 'binary_precision': 0.64772725, 'binary_recall': 0.4090909, 'binary_specificity': 0.99443316, 'binary_f1_score': 0.5014663}
confusion matrix:
       0    1
0  16613   93
1    247  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.46051326, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.479445, 'auroc': 0.7744932, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9295  0
1   797  0
early stop counter: 1
val acc:0.9801447987556458, best validation acc: 0.9802032113075256, corresponding to test acc:                         0.9210265278816223 / 0.9226119518280029
after epoch: 7,now: 2024-08-10 22:57:32.128204,epoch time: 0:20:47.057293,used: 2:29:05.929231,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99852985, 'precision': 0.9985321, 'recall': 0.99853015, 'specificity': 0.99853015, 'f1': 0.9985299, 'auroc': 0.99997497, 'binary_precision': 0.99965113, 'binary_recall': 0.9974085, 'binary_specificity': 0.99965173, 'binary_f1_score': 0.9985286}
confusion matrix:
       0      1
0  25833      9
1     67  25787
---- Validation: 
scalar performance:
{'acc': 0.980612, 'precision': 0.8272953, 'recall': 0.7008352, 'specificity': 0.7008352, 'f1': 0.7480322, 'auroc': 0.9304283, 'binary_precision': 0.6692913, 'binary_recall': 0.40669855, 'binary_specificity': 0.9949719, 'binary_f1_score': 0.50595236}
confusion matrix:
       0    1
0  16622   84
1    248  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.46051326, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.479445, 'auroc': 0.84240896, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9295  0
1   797  0
better model found
persisted
after epoch: 8,now: 2024-08-10 23:18:34.993626,epoch time: 0:21:02.865422,used: 2:50:08.794653,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99851054, 'precision': 0.9985133, 'recall': 0.9985107, 'specificity': 0.9985107, 'f1': 0.9985105, 'auroc': 0.99997985, 'binary_precision': 0.99972856, 'binary_recall': 0.9972923, 'binary_specificity': 0.99972916, 'binary_f1_score': 0.99850893}
confusion matrix:
       0      1
0  25837      7
1     70  25782
---- Validation: 
scalar performance:
{'acc': 0.98008645, 'precision': 0.8276557, 'recall': 0.67840725, 'specificity': 0.67840725, 'f1': 0.7297631, 'auroc': 0.9262535, 'binary_precision': 0.6711111, 'binary_recall': 0.36124402, 'binary_specificity': 0.9955705, 'binary_f1_score': 0.46967342}
confusion matrix:
       0    1
0  16632   74
1    267  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.46051326, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.479445, 'auroc': 0.7705232, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9295  0
1   797  0
early stop counter: 1
val acc:0.9800864458084106, best validation acc: 0.9806119799613953, corresponding to test acc:                         0.9210265278816223 / 0.9226119518280029
after epoch: 9,now: 2024-08-10 23:39:46.138568,epoch time: 0:21:11.144942,used: 3:11:19.939595,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9989748, 'precision': 0.99897575, 'recall': 0.9989749, 'specificity': 0.9989749, 'f1': 0.9989748, 'auroc': 0.99997544, 'binary_precision': 0.99972886, 'binary_recall': 0.9982208, 'binary_specificity': 0.9997291, 'binary_f1_score': 0.99897426}
confusion matrix:
       0      1
0  25835      7
1     46  25808
---- Validation: 
scalar performance:
{'acc': 0.9799112, 'precision': 0.8360288, 'recall': 0.6596576, 'specificity': 0.6596576, 'f1': 0.71475583, 'auroc': 0.91551507, 'binary_precision': 0.68877554, 'binary_recall': 0.32296652, 'binary_specificity': 0.9963486, 'binary_f1_score': 0.4397394}
confusion matrix:
       0    1
0  16645   61
1    283  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.46051326, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.479445, 'auroc': 0.7749667, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9295  0
1   797  0
early stop counter: 2
val acc:0.979911208152771, best validation acc: 0.9806119799613953, corresponding to test acc:                         0.9210265278816223 / 0.9226119518280029
after epoch: 10,now: 2024-08-11 00:00:36.829847,epoch time: 0:20:50.691279,used: 3:32:10.630874,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9985879, 'precision': 0.9985916, 'recall': 0.9985882, 'specificity': 0.9985882, 'f1': 0.9985879, 'auroc': 0.99997735, 'binary_precision': 1.0, 'binary_recall': 0.99717635, 'binary_specificity': 1.0, 'binary_f1_score': 0.9985862}
confusion matrix:
       0      1
0  25843      0
1     73  25780
---- Validation: 
scalar performance:
{'acc': 0.9808456, 'precision': 0.8566733, 'recall': 0.6694664, 'specificity': 0.6694664, 'f1': 0.72802305, 'auroc': 0.9404262, 'binary_precision': 0.72959185, 'binary_recall': 0.34210527, 'binary_specificity': 0.9968275, 'binary_f1_score': 0.46579808}
confusion matrix:
       0    1
0  16653   53
1    275  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.46051326, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.479445, 'auroc': 0.8024001, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9295  0
1   797  0
better model found
persisted
after epoch: 11,now: 2024-08-11 00:21:39.559531,epoch time: 0:21:02.729684,used: 3:53:13.360558,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9987233, 'precision': 0.9987254, 'recall': 0.9987234, 'specificity': 0.9987234, 'f1': 0.9987233, 'auroc': 0.99998736, 'binary_precision': 0.9997674, 'binary_recall': 0.99767894, 'binary_specificity': 0.99976784, 'binary_f1_score': 0.99872214}
confusion matrix:
       0      1
0  25840      6
1     60  25790
---- Validation: 
scalar performance:
{'acc': 0.9802032, 'precision': 0.8530258, 'recall': 0.6516435, 'specificity': 0.6516435, 'f1': 0.7100893, 'auroc': 0.93149245, 'binary_precision': 0.72316384, 'binary_recall': 0.30622008, 'binary_specificity': 0.9970669, 'binary_f1_score': 0.4302521}
confusion matrix:
       0    1
0  16657   49
1    290  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.46051326, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.479445, 'auroc': 0.83198726, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9295  0
1   797  0
early stop counter: 1
val acc:0.9802032113075256, best validation acc: 0.98084557056427, corresponding to test acc:                         0.9210265278816223 / 0.9226119518280029
after epoch: 12,now: 2024-08-11 00:42:40.603089,epoch time: 0:21:01.043558,used: 4:14:14.404116,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9986653, 'precision': 0.99866766, 'recall': 0.99866545, 'specificity': 0.99866545, 'f1': 0.9986652, 'auroc': 0.9999795, 'binary_precision': 0.99980617, 'binary_recall': 0.99752444, 'binary_specificity': 0.9998065, 'binary_f1_score': 0.99866396}
confusion matrix:
       0      1
0  25838      5
1     64  25789
---- Validation: 
scalar performance:
{'acc': 0.98160475, 'precision': 0.8872782, 'recall': 0.66635674, 'specificity': 0.66635674, 'f1': 0.730614, 'auroc': 0.91886246, 'binary_precision': 0.79096043, 'binary_recall': 0.33492824, 'binary_specificity': 0.9977852, 'binary_f1_score': 0.47058824}
confusion matrix:
       0    1
0  16669   37
1    278  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92092746, 'precision': 0.46050936, 'recall': 0.4999462, 'specificity': 0.4999462, 'f1': 0.47941816, 'auroc': 0.7886062, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998924, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9294  1
1   797  0
better model found
persisted
after epoch: 13,now: 2024-08-11 01:03:37.545512,epoch time: 0:20:56.942423,used: 4:35:11.346539,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9988587, 'precision': 0.998859, 'recall': 0.9988587, 'specificity': 0.9988587, 'f1': 0.99885875, 'auroc': 0.9999833, 'binary_precision': 0.99922574, 'binary_recall': 0.9984912, 'binary_specificity': 0.9992262, 'binary_f1_score': 0.9988584}
confusion matrix:
       0      1
0  25827     20
1     39  25810
---- Validation: 
scalar performance:
{'acc': 0.9802032, 'precision': 0.80141246, 'recall': 0.7484417, 'specificity': 0.7484417, 'f1': 0.7722051, 'auroc': 0.9362141, 'binary_precision': 0.61516035, 'binary_recall': 0.5047847, 'binary_specificity': 0.9920986, 'binary_f1_score': 0.55453354}
confusion matrix:
       0    1
0  16574  132
1    207  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9201348, 'precision': 0.5606034, 'recall': 0.50123656, 'specificity': 0.50123656, 'f1': 0.48289138, 'auroc': 0.7572315, 'binary_precision': 0.2, 'binary_recall': 0.0037641155, 'binary_specificity': 0.99870896, 'binary_f1_score': 0.0073891627}
confusion matrix:
      0   1
0  9283  12
1   794   3
early stop counter: 1
val acc:0.9802032113075256, best validation acc: 0.9816047549247742, corresponding to test acc:                         0.9209274649620056 / 0.9226119518280029
after epoch: 14,now: 2024-08-11 01:24:38.773674,epoch time: 0:21:01.228162,used: 4:56:12.574701,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9989748, 'precision': 0.9989759, 'recall': 0.998975, 'specificity': 0.998975, 'f1': 0.9989748, 'auroc': 0.99998987, 'binary_precision': 0.99976754, 'binary_recall': 0.9981821, 'binary_specificity': 0.99976784, 'binary_f1_score': 0.9989742}
confusion matrix:
       0      1
0  25836      6
1     47  25807
---- Validation: 
scalar performance:
{'acc': 0.9799112, 'precision': 0.84201336, 'recall': 0.65266013, 'specificity': 0.65266013, 'f1': 0.7091736, 'auroc': 0.94045734, 'binary_precision': 0.70108694, 'binary_recall': 0.30861244, 'binary_specificity': 0.9967078, 'binary_f1_score': 0.42857143}
confusion matrix:
       0    1
0  16651   55
1    289  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91944116, 'precision': 0.5287578, 'recall': 0.50086004, 'specificity': 0.50086004, 'f1': 0.48267153, 'auroc': 0.72507787, 'binary_precision': 0.13636364, 'binary_recall': 0.0037641155, 'binary_specificity': 0.9979559, 'binary_f1_score': 0.007326007}
confusion matrix:
      0   1
0  9276  19
1   794   3
early stop counter: 2
val acc:0.979911208152771, best validation acc: 0.9816047549247742, corresponding to test acc:                         0.9209274649620056 / 0.9226119518280029
after epoch: 15,now: 2024-08-11 01:45:38.727941,epoch time: 0:20:59.954267,used: 5:17:12.528968,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_28_26_seed_2_24141961
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 5:17:12.528968 at 2024-08-11 01:45:38.727941
persisted model performance metric: 

scalar performance:
{'acc': 0.92092746, 'precision': 0.46050936, 'recall': 0.4999462, 'specificity': 0.4999462, 'f1': 0.47941816, 'auroc': 0.7886062, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998924, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9294  1
1   797  0
oracle model performance metric: 

scalar performance:
{'acc': 0.92261195, 'precision': 0.87807906, 'recall': 0.5123319, 'specificity': 0.5123319, 'f1': 0.5041932, 'auroc': 0.5613607, 'binary_precision': 0.8333333, 'binary_recall': 0.025094103, 'binary_specificity': 0.99956965, 'binary_f1_score': 0.04872107}
confusion matrix:
      0   1
0  9291   4
1   777  20
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 471320 KiB |    831 MiB | 756720 GiB | 756719 GiB |
|       from large pool | 397728 KiB |    724 MiB | 753107 GiB | 753107 GiB |
|       from small pool |  73592 KiB |    109 MiB |   3612 GiB |   3612 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 471320 KiB |    831 MiB | 756720 GiB | 756719 GiB |
|       from large pool | 397728 KiB |    724 MiB | 753107 GiB | 753107 GiB |
|       from small pool |  73592 KiB |    109 MiB |   3612 GiB |   3612 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |    818 MiB | 751483 GiB | 751482 GiB |
|       from large pool | 387840 KiB |    714 MiB | 747897 GiB | 747897 GiB |
|       from small pool |  71980 KiB |    107 MiB |   3585 GiB |   3585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1094 MiB |   1144 MiB |   1748 MiB | 669696 KiB |
|       from large pool |    986 MiB |   1036 MiB |   1582 MiB | 610304 KiB |
|       from small pool |    108 MiB |    110 MiB |    166 MiB |  59392 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 480999 KiB | 480999 KiB | 698263 GiB | 698262 GiB |
|       from large pool | 472672 KiB | 472672 KiB | 694576 GiB | 694576 GiB |
|       from small pool |   8327 KiB |  18911 KiB |   3686 GiB |   3686 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7472    |  158756 K  |  158752 K  |
|       from large pool |      87    |     130    |   57812 K  |   57812 K  |
|       from small pool |    4860    |    7384    |  100944 K  |  100939 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7472    |  158756 K  |  158752 K  |
|       from large pool |      87    |     130    |   57812 K  |   57812 K  |
|       from small pool |    4860    |    7384    |  100944 K  |  100939 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      73    |      76    |     109    |      36    |
|       from large pool |      19    |      21    |      26    |       7    |
|       from small pool |      54    |      55    |      83    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |    3256    |   70418 K  |   70418 K  |
|       from large pool |      17    |      23    |   24405 K  |   24405 K  |
|       from small pool |      32    |    3239    |   46013 K  |   46013 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |    831 MiB | 756720 GiB | 756720 GiB |
|       from large pool |  16640 KiB |    724 MiB | 753107 GiB | 753107 GiB |
|       from small pool |      0 KiB |    109 MiB |   3612 GiB |   3612 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |    831 MiB | 756720 GiB | 756720 GiB |
|       from large pool |  16640 KiB |    724 MiB | 753107 GiB | 753107 GiB |
|       from small pool |      0 KiB |    109 MiB |   3612 GiB |   3612 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |    818 MiB | 751483 GiB | 751483 GiB |
|       from large pool |  16640 KiB |    714 MiB | 747897 GiB | 747897 GiB |
|       from small pool |      0 KiB |    107 MiB |   3585 GiB |   3585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |   1144 MiB |   1748 MiB |    818 MiB |
|       from large pool |    850 MiB |   1036 MiB |   1582 MiB |    732 MiB |
|       from small pool |     80 MiB |    110 MiB |    166 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB | 571383 KiB | 698263 GiB | 698263 GiB |
|       from large pool | 134912 KiB | 558144 KiB | 694577 GiB | 694577 GiB |
|       from small pool |      0 KiB |  18911 KiB |   3686 GiB |   3686 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7472    |  158756 K  |  158756 K  |
|       from large pool |       2    |     130    |   57812 K  |   57812 K  |
|       from small pool |       0    |    7384    |  100944 K  |  100944 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7472    |  158756 K  |  158756 K  |
|       from large pool |       2    |     130    |   57812 K  |   57812 K  |
|       from small pool |       0    |    7384    |  100944 K  |  100944 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |      76    |     109    |      51    |
|       from large pool |      18    |      21    |      26    |       8    |
|       from small pool |      40    |      55    |      83    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3256    |   70420 K  |   70420 K  |
|       from large pool |       4    |      23    |   24405 K  |   24405 K  |
|       from small pool |       0    |    3239    |   46015 K  |   46015 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 01:47:28 2024]
Finished job 0.
1 of 1 steps (100%) done
