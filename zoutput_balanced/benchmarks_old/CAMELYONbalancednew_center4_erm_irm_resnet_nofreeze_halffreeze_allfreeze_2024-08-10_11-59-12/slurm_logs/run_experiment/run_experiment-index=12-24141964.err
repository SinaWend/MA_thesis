Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug 10 11:59:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964

 Experiment start at: 2024-08-10 12:07:47.006329
before training, model accuracy: 0.6347637176513672
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96849334, 'precision': 0.9688494, 'recall': 0.9685027, 'specificity': 0.9685027, 'f1': 0.96848786, 'auroc': 0.99428177, 'binary_precision': 0.9819392, 'binary_recall': 0.9545867, 'binary_specificity': 0.9824187, 'binary_f1_score': 0.9680698}
confusion matrix:
       0      1
0  24866    445
1   1151  24194
---- Validation: 
scalar performance:
{'acc': 0.9678642, 'precision': 0.68166023, 'recall': 0.7379722, 'specificity': 0.7379722, 'f1': 0.7056488, 'auroc': 0.8695662, 'binary_precision': 0.3759124, 'binary_recall': 0.49638554, 'binary_specificity': 0.9795589, 'binary_f1_score': 0.42782968}
confusion matrix:
       0    1
0  16389  342
1    209  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9184299, 'precision': 0.6790143, 'recall': 0.58272046, 'specificity': 0.58272046, 'f1': 0.6078001, 'auroc': 0.86755395, 'binary_precision': 0.4222874, 'binary_recall': 0.1865285, 'binary_specificity': 0.9789124, 'binary_f1_score': 0.25876012}
confusion matrix:
      0    1
0  9145  197
1   628  144
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 12:24:17.950585,epoch time: 0:16:30.944256,used: 0:16:30.944256,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96728915, 'precision': 0.96772695, 'recall': 0.96727896, 'specificity': 0.96727896, 'f1': 0.967281, 'auroc': 0.9963205, 'binary_precision': 0.95358455, 'binary_recall': 0.9824423, 'binary_specificity': 0.95211565, 'binary_f1_score': 0.9677984}
confusion matrix:
       0      1
0  24099   1212
1    445  24900
---- Validation: 
scalar performance:
{'acc': 0.9590575, 'precision': 0.6611479, 'recall': 0.82040477, 'specificity': 0.82040477, 'f1': 0.71124333, 'auroc': 0.90667737, 'binary_precision': 0.3305785, 'binary_recall': 0.67469877, 'binary_specificity': 0.9661108, 'binary_f1_score': 0.44374007}
confusion matrix:
       0    1
0  16164  567
1    135  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9158592, 'precision': 0.6761254, 'recall': 0.6068772, 'specificity': 0.6068772, 'f1': 0.63026184, 'auroc': 0.8850806, 'binary_precision': 0.41280353, 'binary_recall': 0.24222799, 'binary_specificity': 0.97152644, 'binary_f1_score': 0.30530614}
confusion matrix:
      0    1
0  9076  266
1   585  187
early stop counter: 1
val acc:0.9590575098991394, best validation acc: 0.9678642153739929, corresponding to test acc:                         0.9184299111366272 / 0.9184299111366272
after epoch: 2,now: 2024-08-10 12:39:49.141872,epoch time: 0:15:31.191287,used: 0:32:02.135543,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98414797, 'precision': 0.9842303, 'recall': 0.9841527, 'specificity': 0.9841527, 'f1': 0.9841474, 'auroc': 0.9982083, 'binary_precision': 0.9907226, 'binary_recall': 0.97747177, 'binary_specificity': 0.99083364, 'binary_f1_score': 0.98405254}
confusion matrix:
       0      1
0  25078    232
1    571  24775
---- Validation: 
scalar performance:
{'acc': 0.9736965, 'precision': 0.72922903, 'recall': 0.8055821, 'specificity': 0.8055821, 'f1': 0.7614746, 'auroc': 0.91994965, 'binary_precision': 0.46774194, 'binary_recall': 0.62891567, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.5364851}
confusion matrix:
       0    1
0  16434  297
1    154  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9185288, 'precision': 0.6643425, 'recall': 0.55663157, 'specificity': 0.55663157, 'f1': 0.5762024, 'auroc': 0.9044682, 'binary_precision': 0.3968254, 'binary_recall': 0.12953368, 'binary_specificity': 0.9837294, 'binary_f1_score': 0.1953125}
confusion matrix:
      0    1
0  9190  152
1   672  100
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-10 12:55:09.869942,epoch time: 0:15:20.728070,used: 0:47:22.863613,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9740801, 'precision': 0.974635, 'recall': 0.9740701, 'specificity': 0.9740701, 'f1': 0.9740721, 'auroc': 0.9982006, 'binary_precision': 0.9585528, 'binary_recall': 0.9910429, 'binary_specificity': 0.9570972, 'binary_f1_score': 0.97452706}
confusion matrix:
       0      1
0  24227   1086
1    227  25116
---- Validation: 
scalar performance:
{'acc': 0.94395196, 'precision': 0.62894964, 'recall': 0.8443879, 'specificity': 0.8443879, 'f1': 0.6802341, 'auroc': 0.91906995, 'binary_precision': 0.26465517, 'binary_recall': 0.739759, 'binary_specificity': 0.9490168, 'binary_f1_score': 0.38984126}
confusion matrix:
       0    1
0  15878  853
1    108  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92070395, 'precision': 0.6676116, 'recall': 0.5370139, 'specificity': 0.5370139, 'f1': 0.548961, 'auroc': 0.87874556, 'binary_precision': 0.40625, 'binary_recall': 0.08419689, 'binary_specificity': 0.98983085, 'binary_f1_score': 0.13948497}
confusion matrix:
      0   1
0  9247  95
1   707  65
new oracle model saved
early stop counter: 1
val acc:0.9439519643783569, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.9207039475440979
after epoch: 4,now: 2024-08-10 13:10:39.272305,epoch time: 0:15:29.402363,used: 1:02:52.265976,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98485863, 'precision': 0.9849186, 'recall': 0.98485565, 'specificity': 0.98485565, 'f1': 0.9848581, 'auroc': 0.99872637, 'binary_precision': 0.97966194, 'binary_recall': 0.9902928, 'binary_specificity': 0.9794185, 'binary_f1_score': 0.98494864}
confusion matrix:
       0      1
0  24793    521
1    246  25096
---- Validation: 
scalar performance:
{'acc': 0.9507757, 'precision': 0.6415019, 'recall': 0.8361351, 'specificity': 0.8361351, 'f1': 0.69369215, 'auroc': 0.9168906, 'binary_precision': 0.29032257, 'binary_recall': 0.71566266, 'binary_specificity': 0.9566075, 'binary_f1_score': 0.41307372}
confusion matrix:
       0    1
0  16005  726
1    118  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9213961, 'precision': 0.65761495, 'recall': 0.52253485, 'specificity': 0.52253485, 'f1': 0.52517486, 'auroc': 0.8967109, 'binary_precision': 0.3883495, 'binary_recall': 0.051813472, 'binary_specificity': 0.9932563, 'binary_f1_score': 0.09142857}
confusion matrix:
      0   1
0  9279  63
1   732  40
new oracle model saved
early stop counter: 2
val acc:0.950775682926178, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.9213960766792297
after epoch: 5,now: 2024-08-10 13:26:02.853949,epoch time: 0:15:23.581644,used: 1:18:15.847620,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9545365, 'precision': 0.95775306, 'recall': 0.95450675, 'specificity': 0.95450675, 'f1': 0.9544543, 'auroc': 0.9985173, 'binary_precision': 0.91955864, 'binary_recall': 0.99629134, 'binary_specificity': 0.91272223, 'binary_f1_score': 0.95638835}
confusion matrix:
       0      1
0  23101   2209
1     94  25252
---- Validation: 
scalar performance:
{'acc': 0.845445, 'precision': 0.5563477, 'recall': 0.8373853, 'specificity': 0.8373853, 'f1': 0.5602503, 'auroc': 0.8961011, 'binary_precision': 0.11768731, 'binary_recall': 0.82891566, 'binary_specificity': 0.845855, 'binary_f1_score': 0.20611145}
confusion matrix:
       0     1
0  14152  2579
1     71   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234724, 'precision': 0.68720526, 'recall': 0.50524026, 'specificity': 0.50524026, 'f1': 0.4914521, 'auroc': 0.84953296, 'binary_precision': 0.45, 'binary_recall': 0.0116580315, 'binary_specificity': 0.9988225, 'binary_f1_score': 0.022727273}
confusion matrix:
      0   1
0  9331  11
1   763   9
new oracle model saved
early stop counter: 3
val acc:0.8454449772834778, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.9234724044799805
after epoch: 6,now: 2024-08-10 13:41:17.760383,epoch time: 0:15:14.906434,used: 1:33:30.754054,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9667956, 'precision': 0.9684155, 'recall': 0.96677715, 'specificity': 0.96677715, 'f1': 0.96676594, 'auroc': 0.99884665, 'binary_precision': 0.94102734, 'binary_recall': 0.9960543, 'binary_specificity': 0.9375, 'binary_f1_score': 0.96775925}
confusion matrix:
       0      1
0  23730   1582
1    100  25244
---- Validation: 
scalar performance:
{'acc': 0.90306777, 'precision': 0.5847495, 'recall': 0.85633695, 'specificity': 0.85633695, 'f1': 0.6176523, 'auroc': 0.91561854, 'binary_precision': 0.17475222, 'binary_recall': 0.8072289, 'binary_specificity': 0.905445, 'binary_f1_score': 0.28730702}
confusion matrix:
       0     1
0  15149  1582
1     80   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.7127184, 'recall': 0.5124771, 'specificity': 0.5124771, 'f1': 0.50591594, 'auroc': 0.8670366, 'binary_precision': 0.5, 'binary_recall': 0.027202072, 'binary_specificity': 0.9977521, 'binary_f1_score': 0.05159705}
confusion matrix:
      0   1
0  9321  21
1   751  21
new oracle model saved
early stop counter: 4
val acc:0.9030677676200867, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.9236701726913452
after epoch: 7,now: 2024-08-10 13:56:45.019485,epoch time: 0:15:27.259102,used: 1:48:58.013156,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96160376, 'precision': 0.96382785, 'recall': 0.9615833, 'specificity': 0.9615833, 'f1': 0.96155643, 'auroc': 0.99872124, 'binary_precision': 0.93185675, 'binary_recall': 0.9960936, 'binary_specificity': 0.92707306, 'binary_f1_score': 0.962905}
confusion matrix:
       0      1
0  23467   1846
1     99  25244
---- Validation: 
scalar performance:
{'acc': 0.87029046, 'precision': 0.56265295, 'recall': 0.82544255, 'specificity': 0.82544255, 'f1': 0.57715434, 'auroc': 0.8882574, 'binary_precision': 0.13156822, 'binary_recall': 0.7783133, 'binary_specificity': 0.8725719, 'binary_f1_score': 0.2250871}
confusion matrix:
       0     1
0  14599  2132
1     92   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92544985, 'precision': 0.7818562, 'recall': 0.5259176, 'specificity': 0.5259176, 'f1': 0.5306763, 'auroc': 0.8833149, 'binary_precision': 0.6363636, 'binary_recall': 0.054404143, 'binary_specificity': 0.997431, 'binary_f1_score': 0.10023866}
confusion matrix:
      0   1
0  9318  24
1   730  42
new oracle model saved
early stop counter: 5
val acc:0.8702904582023621, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.9254498481750488
after epoch: 8,now: 2024-08-10 14:12:12.598310,epoch time: 0:15:27.578825,used: 2:04:25.591981,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9728759, 'precision': 0.97388625, 'recall': 0.97286135, 'specificity': 0.97286135, 'f1': 0.9728608, 'auroc': 0.999024, 'binary_precision': 0.9521618, 'binary_recall': 0.99581754, 'binary_specificity': 0.94990516, 'binary_f1_score': 0.9735005}
confusion matrix:
       0      1
0  24044   1268
1    106  25238
---- Validation: 
scalar performance:
{'acc': 0.9162487, 'precision': 0.59646565, 'recall': 0.8630909, 'specificity': 0.8630909, 'f1': 0.6367615, 'auroc': 0.9168066, 'binary_precision': 0.19810763, 'binary_recall': 0.8072289, 'binary_specificity': 0.9189528, 'binary_f1_score': 0.31813866}
confusion matrix:
       0     1
0  15375  1356
1     80   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238679, 'precision': 0.96192646, 'recall': 0.5012953, 'specificity': 0.5012953, 'f1': 0.4827937, 'auroc': 0.87013555, 'binary_precision': 1.0, 'binary_recall': 0.0025906735, 'binary_specificity': 1.0, 'binary_f1_score': 0.005167959}
confusion matrix:
      0  1
0  9342  0
1   770  2
early stop counter: 6
val acc:0.9162486791610718, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.9254498481750488
after epoch: 9,now: 2024-08-10 14:27:46.578227,epoch time: 0:15:33.979917,used: 2:19:59.571898,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9444291, 'precision': 0.94961905, 'recall': 0.9443995, 'specificity': 0.9443995, 'f1': 0.94426566, 'auroc': 0.99871576, 'binary_precision': 0.90145063, 'binary_recall': 0.99802697, 'binary_specificity': 0.8907719, 'binary_f1_score': 0.9472836}
confusion matrix:
       0      1
0  22549   2765
1     50  25292
---- Validation: 
scalar performance:
{'acc': 0.82386565, 'precision': 0.55106646, 'recall': 0.8369024, 'specificity': 0.8369024, 'f1': 0.5453384, 'auroc': 0.90211654, 'binary_precision': 0.106614314, 'binary_recall': 0.8506024, 'binary_specificity': 0.82320243, 'binary_f1_score': 0.18947934}
confusion matrix:
       0     1
0  13773  2958
1     62   353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92406565, 'precision': 0.7678673, 'recall': 0.5067497, 'specificity': 0.5067497, 'f1': 0.49416894, 'auroc': 0.8602053, 'binary_precision': 0.6111111, 'binary_recall': 0.014248705, 'binary_specificity': 0.9992507, 'binary_f1_score': 0.027848102}
confusion matrix:
      0   1
0  9335   7
1   761  11
early stop counter: 7
val acc:0.8238656520843506, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.9254498481750488
after epoch: 10,now: 2024-08-10 14:43:09.384651,epoch time: 0:15:22.806424,used: 2:35:22.378322,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.93943465, 'precision': 0.9456964, 'recall': 0.9394019, 'specificity': 0.9394019, 'f1': 0.93921804, 'auroc': 0.9988575, 'binary_precision': 0.89300585, 'binary_recall': 0.99857944, 'binary_specificity': 0.8802244, 'binary_f1_score': 0.9428465}
confusion matrix:
       0      1
0  22282   3032
1     36  25306
---- Validation: 
scalar performance:
{'acc': 0.66003734, 'precision': 0.52696425, 'recall': 0.7623559, 'specificity': 0.7623559, 'f1': 0.450045, 'auroc': 0.8477626, 'binary_precision': 0.058833115, 'binary_recall': 0.86987954, 'binary_specificity': 0.65483236, 'binary_f1_score': 0.11021218}
confusion matrix:
       0     1
0  10956  5775
1     54   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9257465, 'precision': 0.79212844, 'recall': 0.52726644, 'specificity': 0.52726644, 'f1': 0.53307676, 'auroc': 0.80735207, 'binary_precision': 0.6567164, 'binary_recall': 0.05699482, 'binary_specificity': 0.99753803, 'binary_f1_score': 0.10488678}
confusion matrix:
      0   1
0  9319  23
1   728  44
new oracle model saved
early stop counter: 8
val acc:0.6600373387336731, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.925746500492096
after epoch: 11,now: 2024-08-10 14:58:51.009095,epoch time: 0:15:41.624444,used: 2:51:04.002766,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.935901, 'precision': 0.942914, 'recall': 0.93586624, 'specificity': 0.93586624, 'f1': 0.9356427, 'auroc': 0.99866426, 'binary_precision': 0.887319, 'binary_recall': 0.9986978, 'binary_specificity': 0.87303466, 'binary_f1_score': 0.9397197}
confusion matrix:
       0      1
0  22100   3214
1     33  25309
---- Validation: 
scalar performance:
{'acc': 0.69748044, 'precision': 0.5311441, 'recall': 0.7874166, 'specificity': 0.7874166, 'f1': 0.47042745, 'auroc': 0.87796175, 'binary_precision': 0.066497095, 'binary_recall': 0.8819277, 'binary_specificity': 0.69290537, 'binary_f1_score': 0.12366954}
confusion matrix:
       0     1
0  11593  5138
1     49   366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.925351, 'precision': 0.7753075, 'recall': 0.5264582, 'specificity': 0.5264582, 'f1': 0.5316578, 'auroc': 0.8666196, 'binary_precision': 0.6231884, 'binary_recall': 0.055699483, 'binary_specificity': 0.9972169, 'binary_f1_score': 0.102259226}
confusion matrix:
      0   1
0  9316  26
1   729  43
early stop counter: 9
val acc:0.6974804401397705, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.925746500492096
after epoch: 12,now: 2024-08-10 15:14:33.297136,epoch time: 0:15:42.288041,used: 3:06:46.290807,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96324223, 'precision': 0.9652541, 'recall': 0.9632267, 'specificity': 0.9632267, 'f1': 0.96320164, 'auroc': 0.9986391, 'binary_precision': 0.9347778, 'binary_recall': 0.9960142, 'binary_specificity': 0.93043923, 'binary_f1_score': 0.9644249}
confusion matrix:
       0      1
0  23555   1761
1    101  25239
---- Validation: 
scalar performance:
{'acc': 0.86854076, 'precision': 0.5532001, 'recall': 0.770499, 'specificity': 0.770499, 'f1': 0.5628508, 'auroc': 0.86648905, 'binary_precision': 0.115754284, 'binary_recall': 0.66746986, 'binary_specificity': 0.8735282, 'binary_f1_score': 0.19729345}
confusion matrix:
       0     1
0  14615  2116
1    138   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92396677, 'precision': 0.86201406, 'recall': 0.50253713, 'specificity': 0.50253713, 'f1': 0.48538035, 'auroc': 0.82567364, 'binary_precision': 0.8, 'binary_recall': 0.005181347, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.01029601}
confusion matrix:
      0  1
0  9341  1
1   768  4
early stop counter: 10
val acc:0.8685407638549805, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.925746500492096
after epoch: 13,now: 2024-08-10 15:30:05.657174,epoch time: 0:15:32.360038,used: 3:22:18.650845,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9377764, 'precision': 0.9441946, 'recall': 0.9377408, 'specificity': 0.9377408, 'f1': 0.93754727, 'auroc': 0.99851364, 'binary_precision': 0.8909482, 'binary_recall': 0.9977509, 'binary_specificity': 0.8777308, 'binary_f1_score': 0.9413298}
confusion matrix:
       0      1
0  22218   3095
1     57  25286
---- Validation: 
scalar performance:
{'acc': 0.6891987, 'precision': 0.5283538, 'recall': 0.76437396, 'specificity': 0.76437396, 'f1': 0.46377754, 'auroc': 0.8366389, 'binary_precision': 0.06234414, 'binary_recall': 0.8433735, 'binary_specificity': 0.68537444, 'binary_f1_score': 0.1161055}
confusion matrix:
       0     1
0  11467  5264
1     65   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9244611, 'precision': 0.75471056, 'recall': 0.5170643, 'specificity': 0.5170643, 'f1': 0.5144638, 'auroc': 0.8392378, 'binary_precision': 0.5833333, 'binary_recall': 0.03626943, 'binary_specificity': 0.9978591, 'binary_f1_score': 0.06829268}
confusion matrix:
      0   1
0  9322  20
1   744  28
early stop counter: 11
val acc:0.6891986727714539, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.925746500492096
after epoch: 14,now: 2024-08-10 15:45:38.801286,epoch time: 0:15:33.144112,used: 3:37:51.794957,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9416851, 'precision': 0.9475385, 'recall': 0.9416513, 'specificity': 0.9416513, 'f1': 0.94149065, 'auroc': 0.999035, 'binary_precision': 0.8965041, 'binary_recall': 0.99873734, 'binary_specificity': 0.88456523, 'binary_f1_score': 0.9448633}
confusion matrix:
       0      1
0  22391   2922
1     32  25311
---- Validation: 
scalar performance:
{'acc': 0.7380147, 'precision': 0.53400636, 'recall': 0.7893874, 'specificity': 0.7893874, 'f1': 0.49022925, 'auroc': 0.86398804, 'binary_precision': 0.07326774, 'binary_recall': 0.8433735, 'binary_specificity': 0.73540133, 'binary_f1_score': 0.1348228}
confusion matrix:
       0     1
0  12304  4427
1     65   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230769, 'precision': 0.70521957, 'recall': 0.54364574, 'specificity': 0.54364574, 'f1': 0.5597603, 'auroc': 0.86255807, 'binary_precision': 0.48051947, 'binary_recall': 0.09585492, 'binary_specificity': 0.99143654, 'binary_f1_score': 0.1598272}
confusion matrix:
      0   1
0  9262  80
1   698  74
early stop counter: 12
val acc:0.7380146980285645, best validation acc: 0.9736964702606201, corresponding to test acc:                         0.9185287952423096 / 0.925746500492096
after epoch: 15,now: 2024-08-10 16:01:15.174391,epoch time: 0:15:36.373105,used: 3:53:28.168062,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_12_07_46_seed_0_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:53:28.168062 at 2024-08-10 16:01:15.174391
persisted model performance metric: 

scalar performance:
{'acc': 0.9185288, 'precision': 0.6643425, 'recall': 0.55663157, 'specificity': 0.55663157, 'f1': 0.5762024, 'auroc': 0.9044682, 'binary_precision': 0.3968254, 'binary_recall': 0.12953368, 'binary_specificity': 0.9837294, 'binary_f1_score': 0.1953125}
confusion matrix:
      0    1
0  9190  152
1   672  100
oracle model performance metric: 

scalar performance:
{'acc': 0.9257465, 'precision': 0.79212844, 'recall': 0.52726644, 'specificity': 0.52726644, 'f1': 0.53307676, 'auroc': 0.80735207, 'binary_precision': 0.6567164, 'binary_recall': 0.05699482, 'binary_specificity': 0.99753803, 'binary_f1_score': 0.10488678}
confusion matrix:
      0   1
0  9319  23
1   728  44
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 474110 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool | 400512 KiB |   3177 MiB | 239141 GiB | 239140 GiB |
|       from small pool |  73598 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459821 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 235333 GiB | 235332 GiB |
|       from small pool |  71981 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3464 MiB |   3464 MiB |   3464 MiB |      0 B   |
|       from large pool |   3354 MiB |   3354 MiB |   3354 MiB |      0 B   |
|       from small pool |    110 MiB |    110 MiB |    110 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    793 MiB |   1030 MiB | 173229 GiB | 173228 GiB |
|       from large pool |    782 MiB |   1027 MiB | 172554 GiB | 172553 GiB |
|       from small pool |     10 MiB |     11 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4959    |    7362    |   50037 K  |   50032 K  |
|       from large pool |      87    |     529    |   17451 K  |   17450 K  |
|       from small pool |    4872    |    7273    |   32585 K  |   32581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4959    |    7362    |   50037 K  |   50032 K  |
|       from large pool |      87    |     529    |   17451 K  |   17450 K  |
|       from small pool |    4872    |    7273    |   32585 K  |   32581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     115    |     115    |       0    |
|       from large pool |      60    |      60    |      60    |       0    |
|       from small pool |      55    |      55    |      55    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    3198    |   23898 K  |   23898 K  |
|       from large pool |      24    |      33    |    8227 K  |    8227 K  |
|       from small pool |      51    |    3175    |   15671 K  |   15671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1256 MiB |   3464 MiB |   3464 MiB |   2208 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     82 MiB |    110 MiB |    110 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173229 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     17 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32585 K  |   32585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32585 K  |   32585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     115    |     115    |      52    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      41    |      55    |      55    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23900 K  |   23900 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15673 K  |   15673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 239815 GiB | 239815 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 239141 GiB | 239141 GiB |
|       from small pool |      0 KiB |    109 MiB |    674 GiB |    674 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 235997 GiB | 235997 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 235333 GiB | 235333 GiB |
|       from small pool |      0 KiB |    107 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1256 MiB |   3464 MiB |   3464 MiB |   2208 MiB |
|       from large pool |   1174 MiB |   3354 MiB |   3354 MiB |   2180 MiB |
|       from small pool |     82 MiB |    110 MiB |    110 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1030 MiB | 173229 GiB | 173229 GiB |
|       from large pool |  50944 KiB |   1027 MiB | 172554 GiB | 172554 GiB |
|       from small pool |      0 KiB |     17 MiB |    675 GiB |    675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32585 K  |   32585 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7362    |   50037 K  |   50037 K  |
|       from large pool |       2    |     529    |   17451 K  |   17451 K  |
|       from small pool |       0    |    7273    |   32585 K  |   32585 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     115    |     115    |      52    |
|       from large pool |      22    |      60    |      60    |      38    |
|       from small pool |      41    |      55    |      55    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3198    |   23900 K  |   23900 K  |
|       from large pool |       4    |      33    |    8227 K  |    8227 K  |
|       from small pool |       0    |    3175    |   15673 K  |   15673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964

 Experiment start at: 2024-08-10 16:11:11.384267
before training, model accuracy: 0.20374591648578644
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96637946, 'precision': 0.9668884, 'recall': 0.96639323, 'specificity': 0.96639323, 'f1': 0.96637094, 'auroc': 0.99270636, 'binary_precision': 0.9825118, 'binary_recall': 0.9497189, 'binary_specificity': 0.9830675, 'binary_f1_score': 0.9658371}
confusion matrix:
       0      1
0  24965    430
1   1279  24158
---- Validation: 
scalar performance:
{'acc': 0.97325236, 'precision': 0.7200338, 'recall': 0.66193116, 'specificity': 0.66193116, 'f1': 0.6861937, 'auroc': 0.7854321, 'binary_precision': 0.45714286, 'binary_recall': 0.33410674, 'binary_specificity': 0.9897556, 'binary_f1_score': 0.386059}
confusion matrix:
       0    1
0  16521  171
1    287  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.921316, 'precision': 0.6962788, 'recall': 0.60483843, 'specificity': 0.60483843, 'f1': 0.6327224, 'auroc': 0.87863195, 'binary_precision': 0.45244217, 'binary_recall': 0.2324967, 'binary_specificity': 0.9771802, 'binary_f1_score': 0.3071553}
confusion matrix:
      0    1
0  9121  213
1   581  176
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 16:27:58.356882,epoch time: 0:16:46.972615,used: 0:16:46.972615,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96543515, 'precision': 0.96655166, 'recall': 0.965418, 'specificity': 0.965418, 'f1': 0.9654136, 'auroc': 0.9974325, 'binary_precision': 0.94390494, 'binary_recall': 0.98973817, 'binary_specificity': 0.94109774, 'binary_f1_score': 0.9662784}
confusion matrix:
       0      1
0  23902   1496
1    261  25173
---- Validation: 
scalar performance:
{'acc': 0.880862, 'precision': 0.57213193, 'recall': 0.841701, 'specificity': 0.841701, 'f1': 0.59400916, 'auroc': 0.8965096, 'binary_precision': 0.15006524, 'binary_recall': 0.80046403, 'binary_specificity': 0.8829379, 'binary_f1_score': 0.25274724}
confusion matrix:
       0     1
0  14738  1954
1     86   345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197304, 'precision': 0.71356434, 'recall': 0.72900987, 'specificity': 0.72900987, 'f1': 0.72092897, 'auroc': 0.9017581, 'binary_precision': 0.46756425, 'binary_recall': 0.50462353, 'binary_specificity': 0.9533962, 'binary_f1_score': 0.48538756}
confusion matrix:
      0    1
0  8899  435
1   375  382
early stop counter: 1
val acc:0.8808619976043701, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.9213160276412964
after epoch: 2,now: 2024-08-10 16:43:32.852245,epoch time: 0:15:34.495363,used: 0:32:21.467978,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97320586, 'precision': 0.9735173, 'recall': 0.97319543, 'specificity': 0.97319543, 'f1': 0.97320104, 'auroc': 0.9972794, 'binary_precision': 0.9615783, 'binary_recall': 0.9858474, 'binary_specificity': 0.9605434, 'binary_f1_score': 0.97356164}
confusion matrix:
       0      1
0  24393   1002
1    360  25077
---- Validation: 
scalar performance:
{'acc': 0.93003565, 'precision': 0.6110817, 'recall': 0.8431897, 'specificity': 0.8431897, 'f1': 0.65702695, 'auroc': 0.90200925, 'binary_precision': 0.22897527, 'binary_recall': 0.75174016, 'binary_specificity': 0.93463933, 'binary_f1_score': 0.35102925}
confusion matrix:
       0     1
0  15601  1091
1    107   324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9187395, 'precision': 0.63162327, 'recall': 0.5348621, 'specificity': 0.5348621, 'f1': 0.545282, 'auroc': 0.8980578, 'binary_precision': 0.33333334, 'binary_recall': 0.083223246, 'binary_specificity': 0.986501, 'binary_f1_score': 0.13319238}
confusion matrix:
      0    1
0  9208  126
1   694   63
early stop counter: 2
val acc:0.9300356507301331, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.9213160276412964
after epoch: 3,now: 2024-08-10 16:58:59.581039,epoch time: 0:15:26.728794,used: 0:47:48.196772,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9414345, 'precision': 0.9464346, 'recall': 0.941393, 'specificity': 0.941393, 'f1': 0.9412663, 'auroc': 0.99625194, 'binary_precision': 0.89938474, 'binary_recall': 0.99418145, 'binary_specificity': 0.8886045, 'binary_f1_score': 0.94441026}
confusion matrix:
       0      1
0  22567   2829
1    148  25288
---- Validation: 
scalar performance:
{'acc': 0.8081528, 'precision': 0.5478918, 'recall': 0.82248986, 'specificity': 0.82248986, 'f1': 0.53577507, 'auroc': 0.8909352, 'binary_precision': 0.100950785, 'binary_recall': 0.837587, 'binary_specificity': 0.8073928, 'binary_f1_score': 0.18018469}
confusion matrix:
       0     1
0  13477  3215
1     70   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231989, 'precision': 0.6151903, 'recall': 0.50753284, 'specificity': 0.50753284, 'f1': 0.49743873, 'auroc': 0.89155227, 'binary_precision': 0.3043478, 'binary_recall': 0.018494055, 'binary_specificity': 0.99657166, 'binary_f1_score': 0.034869235}
confusion matrix:
      0   1
0  9302  32
1   743  14
new oracle model saved
early stop counter: 3
val acc:0.8081527948379517, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.9231988787651062
after epoch: 4,now: 2024-08-10 17:14:18.581810,epoch time: 0:15:19.000771,used: 1:03:07.197543,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9730288, 'precision': 0.9735227, 'recall': 0.97301555, 'specificity': 0.97301555, 'f1': 0.9730212, 'auroc': 0.99797416, 'binary_precision': 0.95843494, 'binary_recall': 0.9889924, 'binary_specificity': 0.95703876, 'binary_f1_score': 0.97347397}
confusion matrix:
       0      1
0  24304   1091
1    280  25157
---- Validation: 
scalar performance:
{'acc': 0.91508496, 'precision': 0.5919693, 'recall': 0.82761043, 'specificity': 0.82761043, 'f1': 0.6292128, 'auroc': 0.89629734, 'binary_precision': 0.1913096, 'binary_recall': 0.73549885, 'binary_specificity': 0.919722, 'binary_f1_score': 0.30363983}
confusion matrix:
       0     1
0  15352  1340
1    114   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92418987, 'precision': 0.51250374, 'recall': 0.5001784, 'specificity': 0.5001784, 'f1': 0.48160255, 'auroc': 0.8801136, 'binary_precision': 0.1, 'binary_recall': 0.001321004, 'binary_specificity': 0.9990358, 'binary_f1_score': 0.002607562}
confusion matrix:
      0  1
0  9325  9
1   756  1
new oracle model saved
early stop counter: 4
val acc:0.915084958076477, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.9241898655891418
after epoch: 5,now: 2024-08-10 17:29:46.689134,epoch time: 0:15:28.107324,used: 1:18:35.304867,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9722222, 'precision': 0.97305655, 'recall': 0.9722058, 'specificity': 0.9722058, 'f1': 0.9722092, 'auroc': 0.99829674, 'binary_precision': 0.95338565, 'binary_recall': 0.99304134, 'binary_specificity': 0.9513703, 'binary_f1_score': 0.97280955}
confusion matrix:
       0      1
0  24161   1235
1    177  25259
---- Validation: 
scalar performance:
{'acc': 0.9054488, 'precision': 0.58863, 'recall': 0.85205156, 'specificity': 0.85205156, 'f1': 0.62346333, 'auroc': 0.9115182, 'binary_precision': 0.18303095, 'binary_recall': 0.7958237, 'binary_specificity': 0.9082794, 'binary_f1_score': 0.2976139}
confusion matrix:
       0     1
0  15161  1531
1     88   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92339706, 'precision': 0.5307402, 'recall': 0.50096375, 'specificity': 0.50096375, 'f1': 0.48393148, 'auroc': 0.8965279, 'binary_precision': 0.13636364, 'binary_recall': 0.003963012, 'binary_specificity': 0.99796444, 'binary_f1_score': 0.007702182}
confusion matrix:
      0   1
0  9315  19
1   754   3
early stop counter: 5
val acc:0.9054487943649292, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.9241898655891418
after epoch: 6,now: 2024-08-10 17:45:17.137936,epoch time: 0:15:30.448802,used: 1:34:05.753669,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96272033, 'precision': 0.96463186, 'recall': 0.96269524, 'specificity': 0.96269524, 'f1': 0.96268046, 'auroc': 0.9981899, 'binary_precision': 0.93502605, 'binary_recall': 0.99461395, 'binary_specificity': 0.9307765, 'binary_f1_score': 0.9638999}
confusion matrix:
       0      1
0  23638   1758
1    137  25299
---- Validation: 
scalar performance:
{'acc': 0.8539975, 'precision': 0.56223005, 'recall': 0.8460041, 'specificity': 0.8460041, 'f1': 0.57175076, 'auroc': 0.90539336, 'binary_precision': 0.12934431, 'binary_recall': 0.837587, 'binary_specificity': 0.85442126, 'binary_f1_score': 0.2240844}
confusion matrix:
       0     1
0  14262  2430
1     70   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92458624, 'precision': 0.61260295, 'recall': 0.5016065, 'specificity': 0.5016065, 'f1': 0.4843131, 'auroc': 0.8693906, 'binary_precision': 0.3, 'binary_recall': 0.003963012, 'binary_specificity': 0.99925005, 'binary_f1_score': 0.007822685}
confusion matrix:
      0  1
0  9327  7
1   754  3
new oracle model saved
early stop counter: 6
val acc:0.853997528553009, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.9245862364768982
after epoch: 7,now: 2024-08-10 18:01:00.671774,epoch time: 0:15:43.533838,used: 1:49:49.287507,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9359852, 'precision': 0.94276524, 'recall': 0.9359342, 'specificity': 0.9359342, 'f1': 0.93573403, 'auroc': 0.9975476, 'binary_precision': 0.88818115, 'binary_recall': 0.99768054, 'binary_specificity': 0.8741878, 'binary_f1_score': 0.9397519}
confusion matrix:
       0      1
0  22200   3195
1     59  25378
---- Validation: 
scalar performance:
{'acc': 0.72808504, 'precision': 0.53626513, 'recall': 0.80515516, 'specificity': 0.80515516, 'f1': 0.48971927, 'auroc': 0.89267915, 'binary_precision': 0.07656845, 'binary_recall': 0.8863109, 'binary_specificity': 0.7239995, 'binary_f1_score': 0.14095941}
confusion matrix:
       0     1
0  12085  4607
1     49   382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92528, 'precision': 0.75704205, 'recall': 0.50623006, 'specificity': 0.50623006, 'f1': 0.49349493, 'auroc': 0.84916973, 'binary_precision': 0.5882353, 'binary_recall': 0.01321004, 'binary_specificity': 0.99925005, 'binary_f1_score': 0.025839793}
confusion matrix:
      0   1
0  9327   7
1   747  10
new oracle model saved
early stop counter: 7
val acc:0.7280850410461426, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.925279974937439
after epoch: 8,now: 2024-08-10 18:16:31.635295,epoch time: 0:15:30.963521,used: 2:05:20.251028,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9594743, 'precision': 0.96186244, 'recall': 0.95944476, 'specificity': 0.95944476, 'f1': 0.95941997, 'auroc': 0.99784696, 'binary_precision': 0.9288571, 'binary_recall': 0.99524313, 'binary_specificity': 0.9236464, 'binary_f1_score': 0.9609049}
confusion matrix:
       0      1
0  23456   1939
1    121  25316
---- Validation: 
scalar performance:
{'acc': 0.8690066, 'precision': 0.5672481, 'recall': 0.8435312, 'specificity': 0.8435312, 'f1': 0.58361167, 'auroc': 0.899008, 'binary_precision': 0.1399046, 'binary_recall': 0.81670535, 'binary_specificity': 0.87035704, 'binary_f1_score': 0.238887}
confusion matrix:
       0     1
0  14528  2164
1     79   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.7125335, 'recall': 0.50060695, 'specificity': 0.50060695, 'f1': 0.48183033, 'auroc': 0.8373817, 'binary_precision': 0.5, 'binary_recall': 0.001321004, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0026350461}
confusion matrix:
      0  1
0  9333  1
1   756  1
early stop counter: 8
val acc:0.8690065741539001, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.925279974937439
after epoch: 9,now: 2024-08-10 18:32:01.698760,epoch time: 0:15:30.063465,used: 2:20:50.314493,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96478593, 'precision': 0.966371, 'recall': 0.964762, 'specificity': 0.964762, 'f1': 0.9647547, 'auroc': 0.998034, 'binary_precision': 0.93938833, 'binary_recall': 0.99374926, 'binary_specificity': 0.93577474, 'binary_f1_score': 0.9658044}
confusion matrix:
       0      1
0  23764   1631
1    159  25278
---- Validation: 
scalar performance:
{'acc': 0.9035216, 'precision': 0.57634926, 'recall': 0.79342604, 'specificity': 0.79342604, 'f1': 0.60478586, 'auroc': 0.8888607, 'binary_precision': 0.16177285, 'binary_recall': 0.6774942, 'binary_specificity': 0.9093578, 'binary_f1_score': 0.26118067}
confusion matrix:
       0     1
0  15179  1513
1    139   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92488354, 'precision': 0.4624876, 'recall': 0.49994645, 'specificity': 0.49994645, 'f1': 0.48048806, 'auroc': 0.8425748, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9333  1
1   757  0
early stop counter: 9
val acc:0.9035215973854065, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.925279974937439
after epoch: 10,now: 2024-08-10 18:47:44.960061,epoch time: 0:15:43.261301,used: 2:36:33.575794,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9566218, 'precision': 0.9593582, 'recall': 0.95659304, 'specificity': 0.95659304, 'f1': 0.9565551, 'auroc': 0.9973966, 'binary_precision': 0.92409086, 'binary_recall': 0.9950462, 'binary_specificity': 0.91813993, 'binary_f1_score': 0.95825684}
confusion matrix:
       0      1
0  23318   2079
1    126  25309
---- Validation: 
scalar performance:
{'acc': 0.8388717, 'precision': 0.5536193, 'recall': 0.8167733, 'specificity': 0.8167733, 'f1': 0.5545474, 'auroc': 0.8793422, 'binary_precision': 0.11354582, 'binary_recall': 0.79350346, 'binary_specificity': 0.8400431, 'binary_f1_score': 0.19866395}
confusion matrix:
       0     1
0  14022  2670
1     89   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92508173, 'precision': 0.7959126, 'recall': 0.50126743, 'specificity': 0.50126743, 'f1': 0.4831691, 'auroc': 0.7945621, 'binary_precision': 0.6666667, 'binary_recall': 0.002642008, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0052631577}
confusion matrix:
      0  1
0  9333  1
1   755  2
early stop counter: 10
val acc:0.8388717174530029, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.925279974937439
after epoch: 11,now: 2024-08-10 19:03:18.473032,epoch time: 0:15:33.512971,used: 2:52:07.088765,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9559726, 'precision': 0.9590622, 'recall': 0.9559405, 'specificity': 0.9559405, 'f1': 0.95589614, 'auroc': 0.9980986, 'binary_precision': 0.92159784, 'binary_recall': 0.99681556, 'binary_specificity': 0.91506535, 'binary_f1_score': 0.95773214}
confusion matrix:
       0      1
0  23239   2157
1     81  25355
---- Validation: 
scalar performance:
{'acc': 0.868189, 'precision': 0.56738704, 'recall': 0.8465023, 'specificity': 0.8465023, 'f1': 0.58357096, 'auroc': 0.8964555, 'binary_precision': 0.13998422, 'binary_recall': 0.8236659, 'binary_specificity': 0.86933863, 'binary_f1_score': 0.23929895}
confusion matrix:
       0     1
0  14511  2181
1     76   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92498267, 'precision': 0.7125335, 'recall': 0.50060695, 'specificity': 0.50060695, 'f1': 0.48183033, 'auroc': 0.85664034, 'binary_precision': 0.5, 'binary_recall': 0.001321004, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.0026350461}
confusion matrix:
      0  1
0  9333  1
1   756  1
early stop counter: 11
val acc:0.8681889772415161, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.925279974937439
after epoch: 12,now: 2024-08-10 19:18:52.426090,epoch time: 0:15:33.953058,used: 3:07:41.041823,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9560906, 'precision': 0.95884776, 'recall': 0.9560633, 'specificity': 0.9560633, 'f1': 0.95602274, 'auroc': 0.9978535, 'binary_precision': 0.92345595, 'binary_recall': 0.99469215, 'binary_specificity': 0.91743445, 'binary_f1_score': 0.9577513}
confusion matrix:
       0      1
0  23301   2097
1    135  25299
---- Validation: 
scalar performance:
{'acc': 0.81627053, 'precision': 0.5501104, 'recall': 0.8277837, 'specificity': 0.8277837, 'f1': 0.54175574, 'auroc': 0.88540745, 'binary_precision': 0.10526316, 'binary_recall': 0.83990717, 'binary_specificity': 0.8156602, 'binary_f1_score': 0.1870801}
confusion matrix:
       0     1
0  13615  3077
1     69   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92508173, 'precision': 0.96253717, 'recall': 0.5006605, 'specificity': 0.5006605, 'f1': 0.4818588, 'auroc': 0.826198, 'binary_precision': 1.0, 'binary_recall': 0.001321004, 'binary_specificity': 1.0, 'binary_f1_score': 0.0026385225}
confusion matrix:
      0  1
0  9334  0
1   756  1
early stop counter: 12
val acc:0.8162705302238464, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.925279974937439
after epoch: 13,now: 2024-08-10 19:34:22.573073,epoch time: 0:15:30.146983,used: 3:23:11.188806,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9573694, 'precision': 0.9600371, 'recall': 0.9573351, 'specificity': 0.9573351, 'f1': 0.9573052, 'auroc': 0.99798, 'binary_precision': 0.9252302, 'binary_recall': 0.99524355, 'binary_specificity': 0.9194266, 'binary_f1_score': 0.95896065}
confusion matrix:
       0      1
0  23347   2046
1    121  25318
---- Validation: 
scalar performance:
{'acc': 0.87613153, 'precision': 0.5628236, 'recall': 0.7985897, 'specificity': 0.7985897, 'f1': 0.5791557, 'auroc': 0.8752782, 'binary_precision': 0.13388215, 'binary_recall': 0.71693736, 'binary_specificity': 0.88024205, 'binary_f1_score': 0.22562979}
confusion matrix:
       0     1
0  14693  1999
1    122   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92528, 'precision': 0.79608876, 'recall': 0.5038023, 'specificity': 0.5038023, 'f1': 0.48841593, 'auroc': 0.831853, 'binary_precision': 0.6666667, 'binary_recall': 0.007926024, 'binary_specificity': 0.9996786, 'binary_f1_score': 0.015665796}
confusion matrix:
      0  1
0  9331  3
1   751  6
early stop counter: 13
val acc:0.876131534576416, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.925279974937439
after epoch: 14,now: 2024-08-10 19:50:20.219596,epoch time: 0:15:57.646523,used: 3:39:08.835329,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9412378, 'precision': 0.9470086, 'recall': 0.9411932, 'specificity': 0.9411932, 'f1': 0.9410434, 'auroc': 0.99831986, 'binary_precision': 0.89641535, 'binary_recall': 0.997877, 'binary_specificity': 0.8845094, 'binary_f1_score': 0.9444289}
confusion matrix:
       0      1
0  22463   2933
1     54  25382
---- Validation: 
scalar performance:
{'acc': 0.77211934, 'precision': 0.54400957, 'recall': 0.8345217, 'specificity': 0.8345217, 'f1': 0.51695794, 'auroc': 0.8977332, 'binary_precision': 0.09135861, 'binary_recall': 0.900232, 'binary_specificity': 0.7688114, 'binary_f1_score': 0.16588286}
confusion matrix:
       0     1
0  12833  3859
1     43   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92567635, 'precision': 0.90729904, 'recall': 0.5052305, 'specificity': 0.5052305, 'f1': 0.49112993, 'auroc': 0.8754573, 'binary_precision': 0.8888889, 'binary_recall': 0.010568032, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.02088773}
confusion matrix:
      0  1
0  9333  1
1   749  8
new oracle model saved
early stop counter: 14
val acc:0.7721193432807922, best validation acc: 0.9732523560523987, corresponding to test acc:                         0.9213160276412964 / 0.9256763458251953
after epoch: 15,now: 2024-08-10 20:06:08.259035,epoch time: 0:15:48.039439,used: 3:54:56.874768,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_16_11_11_seed_1_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 3:54:56.874768 at 2024-08-10 20:06:08.259035
persisted model performance metric: 

scalar performance:
{'acc': 0.921316, 'precision': 0.6962788, 'recall': 0.60483843, 'specificity': 0.60483843, 'f1': 0.6327224, 'auroc': 0.87863195, 'binary_precision': 0.45244217, 'binary_recall': 0.2324967, 'binary_specificity': 0.9771802, 'binary_f1_score': 0.3071553}
confusion matrix:
      0    1
0  9121  213
1   581  176
oracle model performance metric: 

scalar performance:
{'acc': 0.92567635, 'precision': 0.90729904, 'recall': 0.5052305, 'specificity': 0.5052305, 'f1': 0.49112993, 'auroc': 0.8754573, 'binary_precision': 0.8888889, 'binary_recall': 0.010568032, 'binary_specificity': 0.9998929, 'binary_f1_score': 0.02088773}
confusion matrix:
      0  1
0  9333  1
1   749  8
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 472248 KiB |   3238 MiB | 482772 GiB | 482771 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481409 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 472248 KiB |   3238 MiB | 482772 GiB | 482771 GiB |
|       from large pool | 398656 KiB |   3177 MiB | 481410 GiB | 481409 GiB |
|       from small pool |  73592 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 474901 GiB | 474900 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 473559 GiB | 473559 GiB |
|       from small pool |  71980 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3462 MiB |   3464 MiB |   5670 MiB |   2208 MiB |
|       from large pool |   3354 MiB |   3354 MiB |   5534 MiB |   2180 MiB |
|       from small pool |    108 MiB |    110 MiB |    136 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    806 MiB |   1050 MiB | 354697 GiB | 354696 GiB |
|       from large pool |    796 MiB |   1046 MiB | 353334 GiB | 353333 GiB |
|       from small pool |     10 MiB |     17 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7384    |  100575 K  |  100570 K  |
|       from large pool |      87    |     529    |   35137 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65438 K  |   65433 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7384    |  100575 K  |  100570 K  |
|       from large pool |      87    |     529    |   35137 K  |   35136 K  |
|       from small pool |    4860    |    7295    |   65438 K  |   65433 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     111    |     115    |     163    |      52    |
|       from large pool |      57    |      60    |      95    |      38    |
|       from small pool |      54    |      55    |      68    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3211    |   47819 K  |   47818 K  |
|       from large pool |      26    |      33    |   16342 K  |   16342 K  |
|       from small pool |      48    |    3186    |   31476 K  |   31476 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473559 GiB | 473559 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5670 MiB |   4402 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    136 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354697 GiB | 354697 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353334 GiB | 353334 GiB |
|       from small pool |      0 KiB |     17 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100575 K  |  100575 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65438 K  |   65438 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100575 K  |  100575 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65438 K  |   65438 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     163    |      98    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      68    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47821 K  |   47821 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31478 K  |   31478 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 482772 GiB | 482772 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 481410 GiB | 481410 GiB |
|       from small pool |      0 KiB |    109 MiB |   1362 GiB |   1362 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 474901 GiB | 474901 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 473559 GiB | 473559 GiB |
|       from small pool |      0 KiB |    107 MiB |   1341 GiB |   1341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1268 MiB |   3464 MiB |   5670 MiB |   4402 MiB |
|       from large pool |   1186 MiB |   3354 MiB |   5534 MiB |   4348 MiB |
|       from small pool |     82 MiB |    110 MiB |    136 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 354697 GiB | 354697 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 353334 GiB | 353334 GiB |
|       from small pool |      0 KiB |     17 MiB |   1363 GiB |   1363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7384    |  100575 K  |  100575 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65438 K  |   65438 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7384    |  100575 K  |  100575 K  |
|       from large pool |       2    |     529    |   35137 K  |   35137 K  |
|       from small pool |       0    |    7295    |   65438 K  |   65438 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     115    |     163    |      98    |
|       from large pool |      24    |      60    |      95    |      71    |
|       from small pool |      41    |      55    |      68    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3211    |   47821 K  |   47821 K  |
|       from large pool |       4    |      33    |   16342 K  |   16342 K  |
|       from small pool |       0    |    3186    |   31478 K  |   31478 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964

 Experiment start at: 2024-08-10 20:16:03.989060
before training, model accuracy: 0.10721363127231598
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9642332, 'precision': 0.96426535, 'recall': 0.9642318, 'specificity': 0.9642318, 'f1': 0.96423256, 'auroc': 0.99379563, 'binary_precision': 0.96048796, 'binary_recall': 0.9683258, 'binary_specificity': 0.9601378, 'binary_f1_score': 0.964391}
confusion matrix:
       0      1
0  24809   1030
1    819  25038
---- Validation: 
scalar performance:
{'acc': 0.90960056, 'precision': 0.5815402, 'recall': 0.8090552, 'specificity': 0.8090552, 'f1': 0.6135373, 'auroc': 0.8680562, 'binary_precision': 0.17112923, 'binary_recall': 0.7033493, 'binary_specificity': 0.9147612, 'binary_f1_score': 0.27528092}
confusion matrix:
       0     1
0  15282  1424
1    124   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9010107, 'precision': 0.689548, 'recall': 0.7678842, 'specificity': 0.7678842, 'f1': 0.7191498, 'auroc': 0.8587643, 'binary_precision': 0.41396934, 'binary_recall': 0.6097867, 'binary_specificity': 0.9259817, 'binary_f1_score': 0.4931507}
confusion matrix:
      0    1
0  8607  688
1   311  486
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-10 20:32:45.093122,epoch time: 0:16:41.104062,used: 0:16:41.104062,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9812171, 'precision': 0.9812331, 'recall': 0.98121667, 'specificity': 0.98121667, 'f1': 0.98121697, 'auroc': 0.9976703, 'binary_precision': 0.9784992, 'binary_recall': 0.98406315, 'binary_specificity': 0.97837025, 'binary_f1_score': 0.9812733}
confusion matrix:
       0      1
0  25285    559
1    412  25440
---- Validation: 
scalar performance:
{'acc': 0.95304835, 'precision': 0.6475512, 'recall': 0.8336552, 'specificity': 0.8336552, 'f1': 0.6997977, 'auroc': 0.89645314, 'binary_precision': 0.3026585, 'binary_recall': 0.708134, 'binary_specificity': 0.95917636, 'binary_f1_score': 0.42406878}
confusion matrix:
       0    1
0  16024  682
1    122  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9168649, 'precision': 0.7035911, 'recall': 0.6491606, 'specificity': 0.6491606, 'f1': 0.67082995, 'auroc': 0.8508101, 'binary_precision': 0.4631579, 'binary_recall': 0.33124214, 'binary_specificity': 0.9670791, 'binary_f1_score': 0.38624725}
confusion matrix:
      0    1
0  8989  306
1   533  264
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-10 20:48:27.455312,epoch time: 0:15:42.362190,used: 0:32:23.466252,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98485374, 'precision': 0.9848599, 'recall': 0.9848534, 'specificity': 0.9848534, 'f1': 0.98485374, 'auroc': 0.998309, 'binary_precision': 0.98319393, 'binary_recall': 0.98657846, 'binary_specificity': 0.98312825, 'binary_f1_score': 0.9848833}
confusion matrix:
       0      1
0  25406    436
1    347  25507
---- Validation: 
scalar performance:
{'acc': 0.9496613, 'precision': 0.6432158, 'recall': 0.8529116, 'specificity': 0.8529116, 'f1': 0.6975812, 'auroc': 0.91064686, 'binary_precision': 0.29291046, 'binary_recall': 0.75119615, 'binary_specificity': 0.9546271, 'binary_f1_score': 0.42147654}
confusion matrix:
       0    1
0  15948  758
1    104  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91696393, 'precision': 0.6648849, 'recall': 0.54597354, 'specificity': 0.54597354, 'f1': 0.56165105, 'auroc': 0.8682734, 'binary_precision': 0.40191388, 'binary_recall': 0.105395235, 'binary_specificity': 0.9865519, 'binary_f1_score': 0.166998}
confusion matrix:
      0    1
0  9170  125
1   713   84
new oracle model saved
early stop counter: 1
val acc:0.9496613144874573, best validation acc: 0.9530483484268188, corresponding to test acc:                         0.9168648719787598 / 0.9169639348983765
after epoch: 3,now: 2024-08-10 21:04:16.933773,epoch time: 0:15:49.478461,used: 0:48:12.944713,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9704232, 'precision': 0.9712365, 'recall': 0.97041845, 'specificity': 0.97041845, 'f1': 0.9704102, 'auroc': 0.99794185, 'binary_precision': 0.95171773, 'binary_recall': 0.9911426, 'binary_specificity': 0.9496943, 'binary_f1_score': 0.9710301}
confusion matrix:
       0      1
0  24542   1300
1    229  25625
---- Validation: 
scalar performance:
{'acc': 0.89278203, 'precision': 0.5788215, 'recall': 0.8564152, 'specificity': 0.8564152, 'f1': 0.6067808, 'auroc': 0.91683817, 'binary_precision': 0.16270219, 'binary_recall': 0.8181818, 'binary_specificity': 0.8946486, 'binary_f1_score': 0.27142856}
confusion matrix:
       0     1
0  14946  1760
1     76   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9179548, 'precision': 0.6203505, 'recall': 0.51381856, 'specificity': 0.51381856, 'f1': 0.5091637, 'auroc': 0.8705647, 'binary_precision': 0.31764707, 'binary_recall': 0.033877037, 'binary_specificity': 0.9937601, 'binary_f1_score': 0.061224487}
confusion matrix:
      0   1
0  9237  58
1   770  27
new oracle model saved
early stop counter: 2
val acc:0.8927820324897766, best validation acc: 0.9530483484268188, corresponding to test acc:                         0.9168648719787598 / 0.9179548025131226
after epoch: 4,now: 2024-08-10 21:20:18.706750,epoch time: 0:16:01.772977,used: 1:04:14.717690,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98224235, 'precision': 0.9822892, 'recall': 0.9822412, 'specificity': 0.9822412, 'f1': 0.98224187, 'auroc': 0.99833727, 'binary_precision': 0.97759134, 'binary_recall': 0.98712, 'binary_specificity': 0.97736245, 'binary_f1_score': 0.9823325}
confusion matrix:
       0      1
0  25257    585
1    333  25521
---- Validation: 
scalar performance:
{'acc': 0.9611656, 'precision': 0.66903305, 'recall': 0.81798923, 'specificity': 0.81798923, 'f1': 0.7180594, 'auroc': 0.9077258, 'binary_precision': 0.34658384, 'binary_recall': 0.66746414, 'binary_specificity': 0.9685143, 'binary_f1_score': 0.4562551}
confusion matrix:
       0    1
0  16180  526
1    139  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92003566, 'precision': 0.57175237, 'recall': 0.5017563, 'specificity': 0.5017563, 'f1': 0.4840757, 'auroc': 0.8636701, 'binary_precision': 0.22222222, 'binary_recall': 0.0050188205, 'binary_specificity': 0.9984938, 'binary_f1_score': 0.009815951}
confusion matrix:
      0   1
0  9281  14
1   793   4
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-10 21:36:29.772240,epoch time: 0:16:11.065490,used: 1:20:25.783180,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9547934, 'precision': 0.95787585, 'recall': 0.9547871, 'specificity': 0.9547871, 'f1': 0.9547168, 'auroc': 0.9982377, 'binary_precision': 0.9203461, 'binary_recall': 0.9957837, 'binary_specificity': 0.91379046, 'binary_f1_score': 0.9565799}
confusion matrix:
       0      1
0  23616   2228
1    109  25743
---- Validation: 
scalar performance:
{'acc': 0.8386475, 'precision': 0.55570155, 'recall': 0.8426656, 'specificity': 0.8426656, 'f1': 0.5571005, 'auroc': 0.9127516, 'binary_precision': 0.11595152, 'binary_recall': 0.84689, 'binary_specificity': 0.83844125, 'binary_f1_score': 0.2039758}
confusion matrix:
       0     1
0  14007  2699
1     64   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210265, 'precision': 0.71202594, 'recall': 0.5206482, 'specificity': 0.5206482, 'f1': 0.5207953, 'auroc': 0.8352702, 'binary_precision': 0.5, 'binary_recall': 0.045169387, 'binary_specificity': 0.99612695, 'binary_f1_score': 0.08285385}
confusion matrix:
      0   1
0  9259  36
1   761  36
new oracle model saved
early stop counter: 1
val acc:0.8386474847793579, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9210265278816223
after epoch: 6,now: 2024-08-10 21:52:38.789926,epoch time: 0:16:09.017686,used: 1:36:34.800866,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9636529, 'precision': 0.96559477, 'recall': 0.96364665, 'specificity': 0.96364665, 'f1': 0.96361464, 'auroc': 0.998747, 'binary_precision': 0.9355741, 'binary_recall': 0.9958999, 'binary_specificity': 0.9313934, 'binary_f1_score': 0.964795}
confusion matrix:
       0      1
0  24070   1773
1    106  25747
---- Validation: 
scalar performance:
{'acc': 0.87356925, 'precision': 0.56775516, 'recall': 0.84656847, 'specificity': 0.84656847, 'f1': 0.5855665, 'auroc': 0.9112369, 'binary_precision': 0.14068285, 'binary_recall': 0.8181818, 'binary_specificity': 0.8749551, 'binary_f1_score': 0.24008423}
confusion matrix:
       0     1
0  14617  2089
1     76   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9205311, 'precision': 0.64499676, 'recall': 0.503746, 'specificity': 0.503746, 'f1': 0.48787418, 'auroc': 0.7966138, 'binary_precision': 0.36842105, 'binary_recall': 0.008782936, 'binary_specificity': 0.99870896, 'binary_f1_score': 0.017156864}
confusion matrix:
      0   1
0  9283  12
1   790   7
early stop counter: 2
val acc:0.8735692501068115, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9210265278816223
after epoch: 7,now: 2024-08-10 22:08:42.520606,epoch time: 0:16:03.730680,used: 1:52:38.531546,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9359138, 'precision': 0.94243956, 'recall': 0.93590206, 'specificity': 0.93590206, 'f1': 0.9356754, 'auroc': 0.99743783, 'binary_precision': 0.8887547, 'binary_recall': 0.99659616, 'binary_specificity': 0.87520796, 'binary_f1_score': 0.93959117}
confusion matrix:
       0      1
0  22618   3225
1     88  25765
---- Validation: 
scalar performance:
{'acc': 0.8089231, 'precision': 0.5470334, 'recall': 0.8250991, 'specificity': 0.8250991, 'f1': 0.53448784, 'auroc': 0.88560593, 'binary_precision': 0.09893198, 'binary_recall': 0.84210527, 'binary_specificity': 0.8080929, 'binary_f1_score': 0.17706238}
confusion matrix:
       0     1
0  13500  3206
1     66   352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9216211, 'precision': 0.7292242, 'recall': 0.52785367, 'specificity': 0.52785367, 'f1': 0.53361964, 'auroc': 0.8477474, 'binary_precision': 0.53333336, 'binary_recall': 0.060225848, 'binary_specificity': 0.99548143, 'binary_f1_score': 0.108229995}
confusion matrix:
      0   1
0  9253  42
1   749  48
new oracle model saved
early stop counter: 3
val acc:0.8089231252670288, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9216210842132568
after epoch: 8,now: 2024-08-10 22:25:09.444613,epoch time: 0:16:26.924007,used: 2:09:05.455553,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93765473, 'precision': 0.94395965, 'recall': 0.9376478, 'specificity': 0.9376478, 'f1': 0.93743193, 'auroc': 0.99791384, 'binary_precision': 0.8910819, 'binary_recall': 0.9972148, 'binary_specificity': 0.87808084, 'binary_f1_score': 0.94116575}
confusion matrix:
       0      1
0  22694   3151
1     72  25779
---- Validation: 
scalar performance:
{'acc': 0.847232, 'precision': 0.5593164, 'recall': 0.8517302, 'specificity': 0.8517302, 'f1': 0.56513476, 'auroc': 0.9113406, 'binary_precision': 0.12285518, 'binary_recall': 0.8564593, 'binary_specificity': 0.8470011, 'binary_f1_score': 0.21488594}
confusion matrix:
       0     1
0  14150  2556
1     60   358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9225129, 'precision': 0.81876165, 'recall': 0.5151459, 'specificity': 0.5151459, 'f1': 0.50984347, 'auroc': 0.8749658, 'binary_precision': 0.71428573, 'binary_recall': 0.03136763, 'binary_specificity': 0.99892414, 'binary_f1_score': 0.060096156}
confusion matrix:
      0   1
0  9285  10
1   772  25
new oracle model saved
early stop counter: 4
val acc:0.8472319841384888, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9225128889083862
after epoch: 9,now: 2024-08-10 22:41:32.544115,epoch time: 0:16:23.099502,used: 2:25:28.555055,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9557993, 'precision': 0.95881414, 'recall': 0.9557915, 'specificity': 0.9557915, 'f1': 0.955726, 'auroc': 0.99857736, 'binary_precision': 0.9216704, 'binary_recall': 0.9962867, 'binary_specificity': 0.9152962, 'binary_f1_score': 0.9575271}
confusion matrix:
       0      1
0  23654   2189
1     96  25757
---- Validation: 
scalar performance:
{'acc': 0.86486804, 'precision': 0.5643704, 'recall': 0.846774, 'specificity': 0.846774, 'f1': 0.5780696, 'auroc': 0.90918255, 'binary_precision': 0.13369398, 'binary_recall': 0.8277512, 'binary_specificity': 0.86579674, 'binary_f1_score': 0.23020625}
confusion matrix:
       0     1
0  14464  2242
1     72   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92201746, 'precision': 0.8896252, 'recall': 0.50742066, 'specificity': 0.50742066, 'f1': 0.49448478, 'auroc': 0.8575718, 'binary_precision': 0.85714287, 'binary_recall': 0.015056462, 'binary_specificity': 0.9997848, 'binary_f1_score': 0.029593095}
confusion matrix:
      0   1
0  9293   2
1   785  12
early stop counter: 5
val acc:0.8648680448532104, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9225128889083862
after epoch: 10,now: 2024-08-10 22:57:55.179124,epoch time: 0:16:22.635009,used: 2:41:51.190064,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94216186, 'precision': 0.94764566, 'recall': 0.9421576, 'specificity': 0.9421576, 'f1': 0.9419838, 'auroc': 0.9983512, 'binary_precision': 0.89811915, 'binary_recall': 0.9974855, 'binary_specificity': 0.8868297, 'binary_f1_score': 0.945198}
confusion matrix:
       0      1
0  22921   2925
1     65  25785
---- Validation: 
scalar performance:
{'acc': 0.8489839, 'precision': 0.5579657, 'recall': 0.8386332, 'specificity': 0.8386332, 'f1': 0.56380206, 'auroc': 0.9003272, 'binary_precision': 0.12097902, 'binary_recall': 0.8277512, 'binary_specificity': 0.84951514, 'binary_f1_score': 0.21110432}
confusion matrix:
       0     1
0  14192  2514
1     72   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9216211, 'precision': 0.8047464, 'recall': 0.5066319, 'specificity': 0.5066319, 'f1': 0.493113, 'auroc': 0.83861566, 'binary_precision': 0.6875, 'binary_recall': 0.013801756, 'binary_specificity': 0.99946207, 'binary_f1_score': 0.02706027}
confusion matrix:
      0   1
0  9290   5
1   786  11
early stop counter: 6
val acc:0.848983883857727, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9225128889083862
after epoch: 11,now: 2024-08-10 23:14:09.425500,epoch time: 0:16:14.246376,used: 2:58:05.436440,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95224, 'precision': 0.9559661, 'recall': 0.95222604, 'specificity': 0.95222604, 'f1': 0.95214117, 'auroc': 0.99817455, 'binary_precision': 0.9148249, 'binary_recall': 0.99737006, 'binary_specificity': 0.907082, 'binary_f1_score': 0.95431584}
confusion matrix:
       0      1
0  23439   2401
1     68  25788
---- Validation: 
scalar performance:
{'acc': 0.850619, 'precision': 0.55619836, 'recall': 0.8231438, 'specificity': 0.8231438, 'f1': 0.5618181, 'auroc': 0.8816899, 'binary_precision': 0.11840228, 'binary_recall': 0.79425836, 'binary_specificity': 0.8520292, 'binary_f1_score': 0.20608318}
confusion matrix:
       0     1
0  14234  2472
1     86   332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92112565, 'precision': 0.72288185, 'recall': 0.506363, 'specificity': 0.506363, 'f1': 0.49289596, 'auroc': 0.85686994, 'binary_precision': 0.52380955, 'binary_recall': 0.013801756, 'binary_specificity': 0.99892414, 'binary_f1_score': 0.026894864}
confusion matrix:
      0   1
0  9285  10
1   786  11
early stop counter: 7
val acc:0.8506190180778503, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9225128889083862
after epoch: 12,now: 2024-08-10 23:30:22.369507,epoch time: 0:16:12.944007,used: 3:14:18.380447,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9531685, 'precision': 0.9567267, 'recall': 0.95316684, 'specificity': 0.95316684, 'f1': 0.953077, 'auroc': 0.99859923, 'binary_precision': 0.91642374, 'binary_recall': 0.997292, 'binary_specificity': 0.90904164, 'binary_f1_score': 0.95514923}
confusion matrix:
       0      1
0  23496   2351
1     70  25779
---- Validation: 
scalar performance:
{'acc': 0.86889744, 'precision': 0.56514204, 'recall': 0.8418416, 'specificity': 0.8418416, 'f1': 0.58040303, 'auroc': 0.89644885, 'binary_precision': 0.13562027, 'binary_recall': 0.8133971, 'binary_specificity': 0.8702861, 'binary_f1_score': 0.23247863}
confusion matrix:
       0     1
0  14539  2167
1     78   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221165, 'precision': 0.8559202, 'recall': 0.5091951, 'specificity': 0.5091951, 'f1': 0.49809116, 'auroc': 0.88482034, 'binary_precision': 0.7894737, 'binary_recall': 0.018820576, 'binary_specificity': 0.99956965, 'binary_f1_score': 0.036764704}
confusion matrix:
      0   1
0  9291   4
1   782  15
early stop counter: 8
val acc:0.8688974380493164, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9225128889083862
after epoch: 13,now: 2024-08-10 23:46:48.834041,epoch time: 0:16:26.464534,used: 3:30:44.844981,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.94073045, 'precision': 0.94663596, 'recall': 0.94071937, 'specificity': 0.94071937, 'f1': 0.9405329, 'auroc': 0.99861723, 'binary_precision': 0.8953267, 'binary_recall': 0.99818206, 'binary_specificity': 0.8832566, 'binary_f1_score': 0.94396085}
confusion matrix:
       0      1
0  22826   3017
1     47  25806
---- Validation: 
scalar performance:
{'acc': 0.80541927, 'precision': 0.5476764, 'recall': 0.83496577, 'specificity': 0.83496577, 'f1': 0.5340703, 'auroc': 0.9030396, 'binary_precision': 0.09950522, 'binary_recall': 0.8660287, 'binary_specificity': 0.8039028, 'binary_f1_score': 0.178501}
confusion matrix:
       0     1
0  13430  3276
1     56   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9214229, 'precision': 0.7333159, 'recall': 0.5145542, 'specificity': 0.5145542, 'f1': 0.5091555, 'auroc': 0.83024466, 'binary_precision': 0.54347825, 'binary_recall': 0.03136763, 'binary_specificity': 0.99774075, 'binary_f1_score': 0.059311982}
confusion matrix:
      0   1
0  9274  21
1   772  25
early stop counter: 9
val acc:0.8054192662239075, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9225128889083862
after epoch: 14,now: 2024-08-11 00:03:03.956198,epoch time: 0:16:15.122157,used: 3:46:59.967138,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.89770967, 'precision': 0.91461664, 'recall': 0.89769405, 'specificity': 0.89769405, 'f1': 0.89665353, 'auroc': 0.9977648, 'binary_precision': 0.8309302, 'binary_recall': 0.99864614, 'binary_specificity': 0.79674196, 'binary_f1_score': 0.907101}
confusion matrix:
       0      1
0  20591   5253
1     35  25817
---- Validation: 
scalar performance:
{'acc': 0.6609437, 'precision': 0.5310337, 'recall': 0.80057275, 'specificity': 0.80057275, 'f1': 0.45502725, 'auroc': 0.9020708, 'binary_precision': 0.06407767, 'binary_recall': 0.94736844, 'binary_specificity': 0.65377706, 'binary_f1_score': 0.12003636}
confusion matrix:
       0     1
0  10922  5784
1     22   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197384, 'precision': 0.688967, 'recall': 0.53428787, 'specificity': 0.53428787, 'f1': 0.54441386, 'auroc': 0.84133494, 'binary_precision': 0.45185184, 'binary_recall': 0.07653701, 'binary_specificity': 0.9920387, 'binary_f1_score': 0.13090128}
confusion matrix:
      0   1
0  9221  74
1   736  61
early stop counter: 10
val acc:0.6609436869621277, best validation acc: 0.9611656069755554, corresponding to test acc:                         0.9200356602668762 / 0.9225128889083862
after epoch: 15,now: 2024-08-11 00:19:12.378351,epoch time: 0:16:08.422153,used: 4:03:08.389291,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_10_20_16_03_seed_2_24141964
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:03:08.389291 at 2024-08-11 00:19:12.378351
persisted model performance metric: 

scalar performance:
{'acc': 0.92003566, 'precision': 0.57175237, 'recall': 0.5017563, 'specificity': 0.5017563, 'f1': 0.4840757, 'auroc': 0.8636701, 'binary_precision': 0.22222222, 'binary_recall': 0.0050188205, 'binary_specificity': 0.9984938, 'binary_f1_score': 0.009815951}
confusion matrix:
      0   1
0  9281  14
1   793   4
oracle model performance metric: 

scalar performance:
{'acc': 0.9225129, 'precision': 0.81876165, 'recall': 0.5151459, 'specificity': 0.5151459, 'f1': 0.50984347, 'auroc': 0.8749658, 'binary_precision': 0.71428573, 'binary_recall': 0.03136763, 'binary_specificity': 0.99892414, 'binary_f1_score': 0.060096156}
confusion matrix:
      0   1
0  9285  10
1   772  25
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_erm_irm_resnet_nofreeze_halffreeze_allfreeze_2024-08-10_11-59-12/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 470488 KiB |   3238 MiB | 732912 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 470488 KiB |   3238 MiB | 732912 GiB | 732911 GiB |
|       from large pool | 396896 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |  73592 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 459820 KiB |   3197 MiB | 722604 GiB | 722603 GiB |
|       from large pool | 387840 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |  71980 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3482 MiB |   3482 MiB |   7884 MiB |   4402 MiB |
|       from large pool |   3374 MiB |   3374 MiB |   7722 MiB |   4348 MiB |
|       from small pool |    108 MiB |    110 MiB |    162 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 440871 KiB |   1050 MiB | 539869 GiB | 539869 GiB |
|       from large pool | 430496 KiB |   1046 MiB | 537780 GiB | 537779 GiB |
|       from small pool |  10375 KiB |     17 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4947    |    7492    |  152706 K  |  152701 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99184 K  |   99179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4947    |    7492    |  152706 K  |  152701 K  |
|       from large pool |      87    |     529    |   53521 K  |   53521 K  |
|       from small pool |    4860    |    7403    |   99184 K  |   99179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     115    |     210    |      98    |
|       from large pool |      58    |      60    |     129    |      71    |
|       from small pool |      54    |      55    |      81    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3258    |   72538 K  |   72538 K  |
|       from large pool |      19    |      33    |   24786 K  |   24786 K  |
|       from small pool |      49    |    3240    |   47752 K  |   47752 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3238 MiB | 732912 GiB | 732912 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3238 MiB | 732912 GiB | 732912 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 730824 GiB | 730824 GiB |
|       from small pool |      0 KiB |    109 MiB |   2087 GiB |   2087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3197 MiB | 722604 GiB | 722604 GiB |
|       from large pool |  16640 KiB |   3137 MiB | 720547 GiB | 720547 GiB |
|       from small pool |      0 KiB |    107 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    890 MiB |   3482 MiB |   7884 MiB |   6994 MiB |
|       from large pool |    808 MiB |   3374 MiB |   7722 MiB |   6914 MiB |
|       from small pool |     82 MiB |    110 MiB |    162 MiB |     80 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1050 MiB | 539869 GiB | 539869 GiB |
|       from large pool |  50944 KiB |   1046 MiB | 537780 GiB | 537780 GiB |
|       from small pool |      0 KiB |     18 MiB |   2089 GiB |   2089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7492    |  152706 K  |  152706 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99184 K  |   99184 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7492    |  152706 K  |  152706 K  |
|       from large pool |       2    |     529    |   53521 K  |   53521 K  |
|       from small pool |       0    |    7403    |   99184 K  |   99184 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     115    |     210    |     149    |
|       from large pool |      20    |      60    |     129    |     109    |
|       from small pool |      41    |      55    |      81    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3258    |   72540 K  |   72540 K  |
|       from large pool |       4    |      33    |   24786 K  |   24786 K  |
|       from small pool |       0    |    3240    |   47754 K  |   47754 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 00:21:07 2024]
Finished job 0.
1 of 1 steps (100%) done
